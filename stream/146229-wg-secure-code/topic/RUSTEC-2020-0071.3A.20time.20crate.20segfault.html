<html>
<head><meta charset="utf-8"><title>RUSTEC-2020-0071: time crate segfault · wg-secure-code · Zulip Chat Archive</title></head>
<h2>Stream: <a href="https://zulip-archive.rust-lang.org/stream/146229-wg-secure-code/index.html">wg-secure-code</a></h2>
<h3>Topic: <a href="https://zulip-archive.rust-lang.org/stream/146229-wg-secure-code/topic/RUSTEC-2020-0071.3A.20time.20crate.20segfault.html">RUSTEC-2020-0071: time crate segfault</a></h3>

<hr>

<base href="https://rust-lang.zulipchat.com">

<head><link href="https://zulip-archive.rust-lang.org/style.css" rel="stylesheet"></head>

<a name="257963888"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/146229-wg-secure-code/topic/RUSTEC-2020-0071%3A%20time%20crate%20segfault/near/257963888" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tony Arcieri <a href="https://zulip-archive.rust-lang.org/stream/146229-wg-secure-code/topic/RUSTEC-2020-0071.3A.20time.20crate.20segfault.html#257963888">(Oct 18 2021 at 01:17)</a>:</h4>
<p>with <a href="https://github.com/rust-lang/rust/issues/1078">#1078</a> landed this is kind of crazy to watch: <a href="https://github.com/time-rs/time/issues/293">https://github.com/time-rs/time/issues/293</a></p>



<a name="257963952"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/146229-wg-secure-code/topic/RUSTEC-2020-0071%3A%20time%20crate%20segfault/near/257963952" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tony Arcieri <a href="https://zulip-archive.rust-lang.org/stream/146229-wg-secure-code/topic/RUSTEC-2020-0071.3A.20time.20crate.20segfault.html#257963952">(Oct 18 2021 at 01:18)</a>:</h4>
<p><a href="/user_uploads/4715/z13vlBvSYMH4nPqrS66R3pA_/Screen-Shot-2021-10-17-at-7.18.24-PM.png">Screen-Shot-2021-10-17-at-7.18.24-PM.png</a></p>
<div class="message_inline_image"><a href="/user_uploads/4715/z13vlBvSYMH4nPqrS66R3pA_/Screen-Shot-2021-10-17-at-7.18.24-PM.png" title="Screen-Shot-2021-10-17-at-7.18.24-PM.png"><img src="/user_uploads/4715/z13vlBvSYMH4nPqrS66R3pA_/Screen-Shot-2021-10-17-at-7.18.24-PM.png"></a></div>



<a name="257964953"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/146229-wg-secure-code/topic/RUSTEC-2020-0071%3A%20time%20crate%20segfault/near/257964953" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tony Arcieri <a href="https://zulip-archive.rust-lang.org/stream/146229-wg-secure-code/topic/RUSTEC-2020-0071.3A.20time.20crate.20segfault.html#257964953">(Oct 18 2021 at 01:36)</a>:</h4>
<p>see also <a href="https://github.com/rustsec/rustsec/issues/450">https://github.com/rustsec/rustsec/issues/450</a></p>



<a name="257965079"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/146229-wg-secure-code/topic/RUSTEC-2020-0071%3A%20time%20crate%20segfault/near/257965079" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Nelson <a href="https://zulip-archive.rust-lang.org/stream/146229-wg-secure-code/topic/RUSTEC-2020-0071.3A.20time.20crate.20segfault.html#257965079">(Oct 18 2021 at 01:39)</a>:</h4>
<p>Oh wow, that started <em>24 hours ago</em></p>



<a name="257965083"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/146229-wg-secure-code/topic/RUSTEC-2020-0071%3A%20time%20crate%20segfault/near/257965083" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Nelson <a href="https://zulip-archive.rust-lang.org/stream/146229-wg-secure-code/topic/RUSTEC-2020-0071.3A.20time.20crate.20segfault.html#257965083">(Oct 18 2021 at 01:39)</a>:</h4>
<p>That's crazy</p>



<a name="257972027"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/146229-wg-secure-code/topic/RUSTEC-2020-0071%3A%20time%20crate%20segfault/near/257972027" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tony Arcieri <a href="https://zulip-archive.rust-lang.org/stream/146229-wg-secure-code/topic/RUSTEC-2020-0071.3A.20time.20crate.20segfault.html#257972027">(Oct 18 2021 at 03:35)</a>:</h4>
<p><code>chrono</code> uses time 0.1.x for which there's no patch available</p>



<a name="257972032"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/146229-wg-secure-code/topic/RUSTEC-2020-0071%3A%20time%20crate%20segfault/near/257972032" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tony Arcieri <a href="https://zulip-archive.rust-lang.org/stream/146229-wg-secure-code/topic/RUSTEC-2020-0071.3A.20time.20crate.20segfault.html#257972032">(Oct 18 2021 at 03:35)</a>:</h4>
<p>so it's effectively flagging anything that uses <code>chrono</code></p>



<a name="257972172"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/146229-wg-secure-code/topic/RUSTEC-2020-0071%3A%20time%20crate%20segfault/near/257972172" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tony Arcieri <a href="https://zulip-archive.rust-lang.org/stream/146229-wg-secure-code/topic/RUSTEC-2020-0071.3A.20time.20crate.20segfault.html#257972172">(Oct 18 2021 at 03:37)</a>:</h4>
<p><span class="user-mention" data-user-id="127617">@Shnatsel</span> I see <code>rustsec</code> is getting flagged because you added <code>chrono</code> for OSV export. Do you actually need it for anything that <code>humantime</code> doesn't provide?</p>



<a name="257972229"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/146229-wg-secure-code/topic/RUSTEC-2020-0071%3A%20time%20crate%20segfault/near/257972229" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tony Arcieri <a href="https://zulip-archive.rust-lang.org/stream/146229-wg-secure-code/topic/RUSTEC-2020-0071.3A.20time.20crate.20segfault.html#257972229">(Oct 18 2021 at 03:38)</a>:</h4>
<p>right now it seems we're using two time libraries, and one has an unpatchable vulnerability...</p>



<a name="257972316"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/146229-wg-secure-code/topic/RUSTEC-2020-0071%3A%20time%20crate%20segfault/near/257972316" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tony Arcieri <a href="https://zulip-archive.rust-lang.org/stream/146229-wg-secure-code/topic/RUSTEC-2020-0071.3A.20time.20crate.20segfault.html#257972316">(Oct 18 2021 at 03:40)</a>:</h4>
<p>something also tells me this will renew interest in false-positive elimination</p>



<a name="258022769"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/146229-wg-secure-code/topic/RUSTEC-2020-0071%3A%20time%20crate%20segfault/near/258022769" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Shnatsel <a href="https://zulip-archive.rust-lang.org/stream/146229-wg-secure-code/topic/RUSTEC-2020-0071.3A.20time.20crate.20segfault.html#258022769">(Oct 18 2021 at 12:46)</a>:</h4>
<p><span class="user-mention silent" data-user-id="132721">Tony Arcieri</span> <a href="#narrow/stream/146229-wg-secure-code/topic/RUSTEC-2020-0071.3A.20time.20crate.20segfault/near/257972172">said</a>:</p>
<blockquote>
<p><span class="user-mention silent" data-user-id="127617">Shnatsel</span> I see <code>rustsec</code> is getting flagged because you added <code>chrono</code> for OSV export. Do you actually need it for anything that <code>humantime</code> doesn't provide?</p>
</blockquote>
<p>I think I added it for rfc3339 support, but now that I look at it, <code>humantime</code> also seems to provide that. I guess we just have to try converting and see.</p>



<a name="258033624"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/146229-wg-secure-code/topic/RUSTEC-2020-0071%3A%20time%20crate%20segfault/near/258033624" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tony Arcieri <a href="https://zulip-archive.rust-lang.org/stream/146229-wg-secure-code/topic/RUSTEC-2020-0071.3A.20time.20crate.20segfault.html#258033624">(Oct 18 2021 at 14:03)</a>:</h4>
<p>looks like <code>chrono</code> would still be impacted even if the <code>time</code> crate were upgraded: <a href="https://github.com/chronotope/chrono/issues/602#issuecomment-940445390">https://github.com/chronotope/chrono/issues/602#issuecomment-940445390</a></p>



<a name="258033715"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/146229-wg-secure-code/topic/RUSTEC-2020-0071%3A%20time%20crate%20segfault/near/258033715" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tony Arcieri <a href="https://zulip-archive.rust-lang.org/stream/146229-wg-secure-code/topic/RUSTEC-2020-0071.3A.20time.20crate.20segfault.html#258033715">(Oct 18 2021 at 14:04)</a>:</h4>
<p>also people asking if <code>chrono</code> is maintained: <a href="https://github.com/kube-rs/kube-rs/issues/650">https://github.com/kube-rs/kube-rs/issues/650</a></p>



<a name="258034739"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/146229-wg-secure-code/topic/RUSTEC-2020-0071%3A%20time%20crate%20segfault/near/258034739" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tony Arcieri <a href="https://zulip-archive.rust-lang.org/stream/146229-wg-secure-code/topic/RUSTEC-2020-0071.3A.20time.20crate.20segfault.html#258034739">(Oct 18 2021 at 14:11)</a>:</h4>
<p>see also <a href="https://www.reddit.com/r/rust/comments/qamgyh/is_the_chrono_crate_unmaintained/">https://www.reddit.com/r/rust/comments/qamgyh/is_the_chrono_crate_unmaintained/</a></p>



<a name="258049632"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/146229-wg-secure-code/topic/RUSTEC-2020-0071%3A%20time%20crate%20segfault/near/258049632" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tony Arcieri <a href="https://zulip-archive.rust-lang.org/stream/146229-wg-secure-code/topic/RUSTEC-2020-0071.3A.20time.20crate.20segfault.html#258049632">(Oct 18 2021 at 15:43)</a>:</h4>
<p>might make sense to file a separate vulnerability for <a href="https://github.com/rust-lang/chrono/issues/602">chrono#602</a></p>



<a name="258050334"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/146229-wg-secure-code/topic/RUSTEC-2020-0071%3A%20time%20crate%20segfault/near/258050334" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tony Arcieri <a href="https://zulip-archive.rust-lang.org/stream/146229-wg-secure-code/topic/RUSTEC-2020-0071.3A.20time.20crate.20segfault.html#258050334">(Oct 18 2021 at 15:48)</a>:</h4>
<p>also <a href="https://github.com/chronotope/chrono/issues/499">https://github.com/chronotope/chrono/issues/499</a></p>



<a name="258052166"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/146229-wg-secure-code/topic/RUSTEC-2020-0071%3A%20time%20crate%20segfault/near/258052166" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tony Arcieri <a href="https://zulip-archive.rust-lang.org/stream/146229-wg-secure-code/topic/RUSTEC-2020-0071.3A.20time.20crate.20segfault.html#258052166">(Oct 18 2021 at 15:58)</a>:</h4>
<p><a href="https://github.com/rustsec/advisory-db/pull/1082">https://github.com/rustsec/advisory-db/pull/1082</a></p>



<a name="258052256"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/146229-wg-secure-code/topic/RUSTEC-2020-0071%3A%20time%20crate%20segfault/near/258052256" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Quy Nguyen <a href="https://zulip-archive.rust-lang.org/stream/146229-wg-secure-code/topic/RUSTEC-2020-0071.3A.20time.20crate.20segfault.html#258052256">(Oct 18 2021 at 15:59)</a>:</h4>
<p>The main issue with this is that <code>std::env::set_var</code> is safe but isn't actually thread-safe by C standards. I wonder why the policy mentioned here <a href="https://github.com/rustsec/advisory-db/issues/926">https://github.com/rustsec/advisory-db/issues/926</a> wasn't followed? It seems like Rust stdlib isn't willing to fix a soundness bug, which is a big shame.</p>



<a name="258052665"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/146229-wg-secure-code/topic/RUSTEC-2020-0071%3A%20time%20crate%20segfault/near/258052665" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tony Arcieri <a href="https://zulip-archive.rust-lang.org/stream/146229-wg-secure-code/topic/RUSTEC-2020-0071.3A.20time.20crate.20segfault.html#258052665">(Oct 18 2021 at 16:01)</a>:</h4>
<p><span class="user-mention" data-user-id="303115">@Quy Nguyen</span> see followup here: <a href="https://github.com/rustsec/advisory-db/issues/926#issuecomment-864853363">https://github.com/rustsec/advisory-db/issues/926#issuecomment-864853363</a></p>



<a name="258053404"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/146229-wg-secure-code/topic/RUSTEC-2020-0071%3A%20time%20crate%20segfault/near/258053404" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Quy Nguyen <a href="https://zulip-archive.rust-lang.org/stream/146229-wg-secure-code/topic/RUSTEC-2020-0071.3A.20time.20crate.20segfault.html#258053404">(Oct 18 2021 at 16:06)</a>:</h4>
<p>Hmm. So would flate2-rs be marked as vulnerable ? I'm kinda sad how this and a desire for security leads to a bunch of issue spam for something that really is only solvable by the stdlib.</p>



<a name="258053684"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/146229-wg-secure-code/topic/RUSTEC-2020-0071%3A%20time%20crate%20segfault/near/258053684" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tony Arcieri <a href="https://zulip-archive.rust-lang.org/stream/146229-wg-secure-code/topic/RUSTEC-2020-0071.3A.20time.20crate.20segfault.html#258053684">(Oct 18 2021 at 16:08)</a>:</h4>
<p>If it's impacting real world usage, I think it deserves an advisory</p>



<a name="258054219"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/146229-wg-secure-code/topic/RUSTEC-2020-0071%3A%20time%20crate%20segfault/near/258054219" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tony Arcieri <a href="https://zulip-archive.rust-lang.org/stream/146229-wg-secure-code/topic/RUSTEC-2020-0071.3A.20time.20crate.20segfault.html#258054219">(Oct 18 2021 at 16:10)</a>:</h4>
<p>the (prospective?) solution for the <code>time</code> crate is to reimplement <code>localtime_r</code> in pure Rust</p>



<hr><p>Last updated: Apr 12 2022 at 20:01 UTC</p>
</html>