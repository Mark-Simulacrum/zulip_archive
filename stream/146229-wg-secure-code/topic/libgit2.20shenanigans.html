<html>
<head><meta charset="utf-8"><title>libgit2 shenanigans · wg-secure-code · Zulip Chat Archive</title></head>
<h2>Stream: <a href="https://zulip-archive.rust-lang.org/stream/146229-wg-secure-code/index.html">wg-secure-code</a></h2>
<h3>Topic: <a href="https://zulip-archive.rust-lang.org/stream/146229-wg-secure-code/topic/libgit2.20shenanigans.html">libgit2 shenanigans</a></h3>

<hr>

<base href="https://rust-lang.zulipchat.com">

<head><link href="https://zulip-archive.rust-lang.org/style.css" rel="stylesheet"></head>

<a name="252940596"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/146229-wg-secure-code/topic/libgit2%20shenanigans/near/252940596" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tony Arcieri <a href="https://zulip-archive.rust-lang.org/stream/146229-wg-secure-code/topic/libgit2.20shenanigans.html#252940596">(Sep 11 2021 at 22:43)</a>:</h4>
<p>I'm wondering if it might make sense to switch (back) to HTTP as a way to fetch the advisory DB <a href="https://github.com/rustsec/rustsec/issues/431">https://github.com/rustsec/rustsec/issues/431</a></p>



<a name="252940607"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/146229-wg-secure-code/topic/libgit2%20shenanigans/near/252940607" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tony Arcieri <a href="https://zulip-archive.rust-lang.org/stream/146229-wg-secure-code/topic/libgit2.20shenanigans.html#252940607">(Sep 11 2021 at 22:43)</a>:</h4>
<p>getting rid of the C code and OpenSSL sounds nice</p>



<a name="252940770"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/146229-wg-secure-code/topic/libgit2%20shenanigans/near/252940770" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Shnatsel <a href="https://zulip-archive.rust-lang.org/stream/146229-wg-secure-code/topic/libgit2.20shenanigans.html#252940770">(Sep 11 2021 at 22:47)</a>:</h4>
<p>Yeah, using rustls in place of OpenSSL is tempting. HTTP fetching would be somewhat inefficient, but with the entire DB being at 300kb right now (zipped) I don't think we'll hit any practical snags anytime soon</p>



<a name="252940856"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/146229-wg-secure-code/topic/libgit2%20shenanigans/near/252940856" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Shnatsel <a href="https://zulip-archive.rust-lang.org/stream/146229-wg-secure-code/topic/libgit2.20shenanigans.html#252940856">(Sep 11 2021 at 22:48)</a>:</h4>
<p>For the HTTP client I suggest <code>attohttpc</code>. It has Happy Eyeballs and optional native-tls support that <code>ureq</code> lacks.</p>



<a name="252940874"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/146229-wg-secure-code/topic/libgit2%20shenanigans/near/252940874" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Shnatsel <a href="https://zulip-archive.rust-lang.org/stream/146229-wg-secure-code/topic/libgit2.20shenanigans.html#252940874">(Sep 11 2021 at 22:49)</a>:</h4>
<p>And we really don't need <code>async</code> in the likes of <code>reqwest</code> etc.</p>



<a name="252941230"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/146229-wg-secure-code/topic/libgit2%20shenanigans/near/252941230" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Shnatsel <a href="https://zulip-archive.rust-lang.org/stream/146229-wg-secure-code/topic/libgit2.20shenanigans.html#252941230">(Sep 11 2021 at 22:56)</a>:</h4>
<p>Optional native-tls is useful for platforms that are not supported by rustls</p>



<a name="252941823"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/146229-wg-secure-code/topic/libgit2%20shenanigans/near/252941823" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tony Arcieri <a href="https://zulip-archive.rust-lang.org/stream/146229-wg-secure-code/topic/libgit2.20shenanigans.html#252941823">(Sep 11 2021 at 23:07)</a>:</h4>
<p>with a <code>rustsec-admin</code> controlled build process, we can just splat the whole database out into a single flat file</p>



<a name="252941828"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/146229-wg-secure-code/topic/libgit2%20shenanigans/near/252941828" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tony Arcieri <a href="https://zulip-archive.rust-lang.org/stream/146229-wg-secure-code/topic/libgit2.20shenanigans.html#252941828">(Sep 11 2021 at 23:07)</a>:</h4>
<p>that's actually how it used to work</p>



<a name="252941831"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/146229-wg-secure-code/topic/libgit2%20shenanigans/near/252941831" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Shnatsel <a href="https://zulip-archive.rust-lang.org/stream/146229-wg-secure-code/topic/libgit2.20shenanigans.html#252941831">(Sep 11 2021 at 23:07)</a>:</h4>
<p>Github already does it for us</p>



<a name="252941839"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/146229-wg-secure-code/topic/libgit2%20shenanigans/near/252941839" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Shnatsel <a href="https://zulip-archive.rust-lang.org/stream/146229-wg-secure-code/topic/libgit2.20shenanigans.html#252941839">(Sep 11 2021 at 23:07)</a>:</h4>
<p><a href="https://github.com/rustsec/rustsec/archive/refs/heads/main.zip">https://github.com/rustsec/rustsec/archive/refs/heads/main.zip</a></p>



<a name="252941887"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/146229-wg-secure-code/topic/libgit2%20shenanigans/near/252941887" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Shnatsel <a href="https://zulip-archive.rust-lang.org/stream/146229-wg-secure-code/topic/libgit2.20shenanigans.html#252941887">(Sep 11 2021 at 23:08)</a>:</h4>
<p>There is probably even some CDN key with which we can check if it has changed since last request or not</p>



<a name="252942025"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/146229-wg-secure-code/topic/libgit2%20shenanigans/near/252942025" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Shnatsel <a href="https://zulip-archive.rust-lang.org/stream/146229-wg-secure-code/topic/libgit2.20shenanigans.html#252942025">(Sep 11 2021 at 23:11)</a>:</h4>
<p>The CDN that <a href="http://crates.io">crates.io</a> uses allows checking if the content stayed the same since our last request via something called <code>etag</code>. We use that in <code>cargo supply-chain</code>: <br>
<a href="https://github.com/rust-secure-code/cargo-supply-chain/blob/bd8bc42b8ecd6b74f8641cb2f4c6d3bec7e42716/src/crates_cache.rs#L137">https://github.com/rust-secure-code/cargo-supply-chain/blob/bd8bc42b8ecd6b74f8641cb2f4c6d3bec7e42716/src/crates_cache.rs#L137</a></p>



<a name="252942228"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/146229-wg-secure-code/topic/libgit2%20shenanigans/near/252942228" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Shnatsel <a href="https://zulip-archive.rust-lang.org/stream/146229-wg-secure-code/topic/libgit2.20shenanigans.html#252942228">(Sep 11 2021 at 23:15)</a>:</h4>
<p><span class="user-mention" data-user-id="132721">@Tony Arcieri</span> I see you made some <code>rustsec</code> changes, I assume another release is imminent? Could you also rename the OSV feature to <code>osv-export</code> in both places where it's used before you push the release? I'm lazy and don't want to set up a development environment from scratch just to change a string in two places.</p>



<a name="252942240"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/146229-wg-secure-code/topic/libgit2%20shenanigans/near/252942240" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tony Arcieri <a href="https://zulip-archive.rust-lang.org/stream/146229-wg-secure-code/topic/libgit2.20shenanigans.html#252942240">(Sep 11 2021 at 23:15)</a>:</h4>
<p>aah, umm can you send a PR?</p>



<a name="252942686"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/146229-wg-secure-code/topic/libgit2%20shenanigans/near/252942686" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Shnatsel <a href="https://zulip-archive.rust-lang.org/stream/146229-wg-secure-code/topic/libgit2.20shenanigans.html#252942686">(Sep 11 2021 at 23:24)</a>:</h4>
<p>Probably! I'll do that.</p>



<a name="252943349"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/146229-wg-secure-code/topic/libgit2%20shenanigans/near/252943349" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Shnatsel <a href="https://zulip-archive.rust-lang.org/stream/146229-wg-secure-code/topic/libgit2.20shenanigans.html#252943349">(Sep 11 2021 at 23:39)</a>:</h4>
<p>OK done: <a href="https://github.com/rustsec/rustsec/pull/434">https://github.com/rustsec/rustsec/pull/434</a></p>



<hr><p>Last updated: Apr 12 2022 at 20:01 UTC</p>
</html>