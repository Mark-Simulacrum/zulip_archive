<html>
<head><meta charset="utf-8"><title>auto closure wrappers Â· new members Â· Zulip Chat Archive</title></head>
<h2>Stream: <a href="https://zulip-archive.rust-lang.org/stream/122652-new-members/index.html">new members</a></h2>
<h3>Topic: <a href="https://zulip-archive.rust-lang.org/stream/122652-new-members/topic/auto.20closure.20wrappers.html">auto closure wrappers</a></h3>

<hr>

<base href="https://rust-lang.zulipchat.com">

<head><link href="https://zulip-archive.rust-lang.org/style.css" rel="stylesheet"></head>

<a name="259362340"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122652-new%20members/topic/auto%20closure%20wrappers/near/259362340" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Nelson <a href="https://zulip-archive.rust-lang.org/stream/122652-new-members/topic/auto.20closure.20wrappers.html#259362340">(Oct 28 2021 at 09:33)</a>:</h4>
<p>This seems like a lot of magic for something that's already possible :/ especially since <code>move o::method</code> already has an existing and conflicting meaning</p>



<a name="259362516"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122652-new%20members/topic/auto%20closure%20wrappers/near/259362516" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Nelson <a href="https://zulip-archive.rust-lang.org/stream/122652-new-members/topic/auto.20closure.20wrappers.html#259362516">(Oct 28 2021 at 09:35)</a>:</h4>
<p><del>Note that <code>apply(o::method)</code> already works as long as the type signatures match up, it only breaks when the closure is doing autorefs</del> nevermind, misread</p>



<a name="259362683"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122652-new%20members/topic/auto%20closure%20wrappers/near/259362683" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Nelson <a href="https://zulip-archive.rust-lang.org/stream/122652-new-members/topic/auto.20closure.20wrappers.html#259362683">(Oct 28 2021 at 09:36)</a>:</h4>
<p>Also note that <code>o</code> could already be in scope as a type, so changing it to resolve to a variable in scope instead would be a breaking change</p>



<a name="259364007"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122652-new%20members/topic/auto%20closure%20wrappers/near/259364007" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Davydov Daniil <a href="https://zulip-archive.rust-lang.org/stream/122652-new-members/topic/auto.20closure.20wrappers.html#259364007">(Oct 28 2021 at 09:50)</a>:</h4>
<p><span class="user-mention silent" data-user-id="232545">Joshua Nelson</span> <a href="#narrow/stream/122652-new-members/topic/auto.20closure.20wrappers/near/259362683">said</a>:</p>
<blockquote>
<p>Also note that <code>o</code> could already be in scope as a type, so changing it to resolve to a variable in scope instead would be a breaking change</p>
</blockquote>
<p>Right! It seems the only non-breaking unambiguous use of this sugar might be to resolve to <code>self</code>.</p>
<div class="codehilite"><pre><span></span><code>struct FooBarBaz{
    fn foo(&amp;self, x:u8){}
    fn bar&lt;F: Fn(u8)&gt;(&amp;self, f:F){ f(0u8); }
    fn baz(&amp;self){
        self.bar(self::foo);
    }
}
</code></pre></div>



<a name="259364378"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122652-new%20members/topic/auto%20closure%20wrappers/near/259364378" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Nelson <a href="https://zulip-archive.rust-lang.org/stream/122652-new-members/topic/auto.20closure.20wrappers.html#259364378">(Oct 28 2021 at 09:54)</a>:</h4>
<p>No, <code>self</code> already has a meaning in a type context, it's the current module</p>



<a name="259365625"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122652-new%20members/topic/auto%20closure%20wrappers/near/259365625" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Davydov Daniil <a href="https://zulip-archive.rust-lang.org/stream/122652-new-members/topic/auto.20closure.20wrappers.html#259365625">(Oct 28 2021 at 10:07)</a>:</h4>
<p>I see. Can we just add more magic to '.' operator to auto generate closure? So the first example becomes <code>x.apply(o.method)</code>? <br>
+: <del>Its still coerces with the type with the same name in scope though.</del> '.' operator not applicable to modules\types</p>



<a name="259365980"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122652-new%20members/topic/auto%20closure%20wrappers/near/259365980" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Nelson <a href="https://zulip-archive.rust-lang.org/stream/122652-new-members/topic/auto.20closure.20wrappers.html#259365980">(Oct 28 2021 at 10:10)</a>:</h4>
<p>That's ambiguous if there's a <code>method</code> field on the struct.</p>
<p>Also, I'm not sure how useful this change is, the closure isn't <em>that</em> noisy. I haven't seen people using point free notation a lot, I don't think it's something we need to encourage</p>



<a name="259366081"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122652-new%20members/topic/auto%20closure%20wrappers/near/259366081" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Nelson <a href="https://zulip-archive.rust-lang.org/stream/122652-new-members/topic/auto.20closure.20wrappers.html#259366081">(Oct 28 2021 at 10:11)</a>:</h4>
<p><span class="user-mention" data-user-id="453750">@Davydov Daniil</span> I don't understand your edit, <code>o.method</code> and <code>o::method</code> resolve different items for <code>o</code></p>



<a name="259366675"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122652-new%20members/topic/auto%20closure%20wrappers/near/259366675" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Nelson <a href="https://zulip-archive.rust-lang.org/stream/122652-new-members/topic/auto.20closure.20wrappers.html#259366675">(Oct 28 2021 at 10:17)</a>:</h4>
<p>I guess we could make it behave differently depending on whether a <code>method</code> field exists or not, but that seems confusing / inconsistent</p>



<a name="259370697"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122652-new%20members/topic/auto%20closure%20wrappers/near/259370697" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Davydov Daniil <a href="https://zulip-archive.rust-lang.org/stream/122652-new-members/topic/auto.20closure.20wrappers.html#259370697">(Oct 28 2021 at 10:57)</a>:</h4>
<p>I'm missing this sugar when writing functional-style code, where less characters usually leads to better 'meaning density'(sorry, can't phrase it better) per character. <br>
Also, it's seems intuitive that <code>obj.method</code> should resolve to something.</p>



<a name="259370866"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122652-new%20members/topic/auto%20closure%20wrappers/near/259370866" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> FÃ©lix Saparelli <a href="https://zulip-archive.rust-lang.org/stream/122652-new-members/topic/auto.20closure.20wrappers.html#259370866">(Oct 28 2021 at 10:59)</a>:</h4>
<p>Specifically about "are there any related discussions": yes. There's been a lot of discussion on currying and auto-closures over the years on IRLO and elsewhere, even <a href="https://github.com/rust-lang/rfcs/pull/191">going back to pre-1.0</a>. Most recently I recall a little bit of discussion <a href="https://twitter.com/fasterthanlime/status/1447307106202312708">on twitter</a> with the exact syntax you're into. General impression I have is that:</p>
<div class="inline-preview-twitter"><div class="twitter-tweet"><a href="https://twitter.com/fasterthanlime/status/1447307106202312708"><img class="twitter-avatar" src="https://uploads.zulipusercontent.net/bade379ef25ea9325a0b92fe1f438f895b6b914a/68747470733a2f2f7062732e7477696d672e636f6d2f70726f66696c655f696d616765732f3933363332343335383634393430353434302f6b52524f56336b665f6e6f726d616c2e6a7067"></a><p>idk I'm kinda tired of writing

`takes_closure(|arg| s.stuff(arg))`

can we make

`takes_closure(s.stuff)`

work in more cases? surely that won't terribly break anything else right?</p><span>- fasterthanlime ðŸŒŒ (@fasterthanlime)</span></div></div><ul>
<li>this is something that is vaguely but consistently wanted, but:</li>
<li>there's lots of opinions but not a lot of consensus</li>
<li>the technical feasibility is in the air (probably requires HKT in some form)</li>
<li>this is not something that is sorely needed, it's a possible quality-of-life improvement that can already be reasonably approximated with not a lot more syntax (ie even though it could be another <code>?</code> moment, it's not going to be prioritised unless it's demonstrably significantly better)</li>
</ul>



<hr><p>Last updated: Apr 12 2022 at 20:01 UTC</p>
</html>