<html>
<head><meta charset="utf-8"><title>Will asks for help · new members · Zulip Chat Archive</title></head>
<h2>Stream: <a href="https://zulip-archive.rust-lang.org/stream/122652-new-members/index.html">new members</a></h2>
<h3>Topic: <a href="https://zulip-archive.rust-lang.org/stream/122652-new-members/topic/Will.20asks.20for.20help.html">Will asks for help</a></h3>

<hr>

<base href="https://rust-lang.zulipchat.com">

<head><link href="https://zulip-archive.rust-lang.org/style.css" rel="stylesheet"></head>

<a name="275918520"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122652-new%20members/topic/Will%20asks%20for%20help/near/275918520" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Will <a href="https://zulip-archive.rust-lang.org/stream/122652-new-members/topic/Will.20asks.20for.20help.html#275918520">(Mar 19 2022 at 16:47)</a>:</h4>
<p>I have a very silly question. I followed the steps for building the rust project ("./x.py build &amp;&amp; ./x.py install") and got:</p>
<p><code>error: failed to add native library /Users/w/Dropbox/Codin/rust/rust/build/aarch64-apple-darwin/llvm/build/lib/libLLVMX86TargetMCA.a: file too small to be an archive</code></p>
<p>I have no sense of where to look next to debug.</p>
<p>Machine: macOS 11.5.1 Macbook Air 2021 M1</p>



<a name="275918706"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122652-new%20members/topic/Will%20asks%20for%20help/near/275918706" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jubilee <a href="https://zulip-archive.rust-lang.org/stream/122652-new-members/topic/Will.20asks.20for.20help.html#275918706">(Mar 19 2022 at 16:51)</a>:</h4>
<p>it is a very bad idea to build rustc inside a Dropbox or OneDrive folder.</p>



<a name="275918935"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122652-new%20members/topic/Will%20asks%20for%20help/near/275918935" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jubilee <a href="https://zulip-archive.rust-lang.org/stream/122652-new-members/topic/Will.20asks.20for.20help.html#275918935">(Mar 19 2022 at 16:56)</a>:</h4>
<p>Once you move it out of Dropbox, you should set up your config.toml to not attempt to rebuild LLVM.</p>



<a name="275919610"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122652-new%20members/topic/Will%20asks%20for%20help/near/275919610" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Will <a href="https://zulip-archive.rust-lang.org/stream/122652-new-members/topic/Will.20asks.20for.20help.html#275919610">(Mar 19 2022 at 17:11)</a>:</h4>
<p>How does one tell config.toml not to rebuild llvm?</p>



<a name="275921884"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122652-new%20members/topic/Will%20asks%20for%20help/near/275921884" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jubilee <a href="https://zulip-archive.rust-lang.org/stream/122652-new-members/topic/Will.20asks.20for.20help.html#275921884">(Mar 19 2022 at 18:05)</a>:</h4>
<div class="codehilite" data-code-language="TOML"><pre><span></span><code><span class="c1"># Whether to use Rust CI built LLVM instead of locally building it.</span><span class="w"></span>
<span class="c1">#</span><span class="w"></span>
<span class="c1"># Unless you're developing for a target where Rust CI doesn't build a compiler</span><span class="w"></span>
<span class="c1"># toolchain or changing LLVM locally, you probably want to set this to true.</span><span class="w"></span>
<span class="c1">#</span><span class="w"></span>
<span class="c1"># This is false by default so that distributions don't unexpectedly download</span><span class="w"></span>
<span class="c1"># LLVM from the internet.</span><span class="w"></span>
<span class="c1">#</span><span class="w"></span>
<span class="c1"># All tier 1 targets are currently supported; set this to `"if-available"` if</span><span class="w"></span>
<span class="c1"># you are not sure whether you're on a tier 1 target.</span><span class="w"></span>
<span class="c1">#</span><span class="w"></span>
<span class="c1"># We also currently only support this when building LLVM for the build triple.</span><span class="w"></span>
<span class="c1">#</span><span class="w"></span>
<span class="c1"># Note that many of the LLVM options are not currently supported for</span><span class="w"></span>
<span class="c1"># downloading. Currently only the "assertions" option can be toggled.</span><span class="w"></span>
<span class="n">download-ci-llvm</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">true</span><span class="w"></span>
</code></pre></div>



<a name="275922012"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122652-new%20members/topic/Will%20asks%20for%20help/near/275922012" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jubilee <a href="https://zulip-archive.rust-lang.org/stream/122652-new-members/topic/Will.20asks.20for.20help.html#275922012">(Mar 19 2022 at 18:08)</a>:</h4>
<p><span class="user-mention silent" data-user-id="487284">Will</span> <a href="#narrow/stream/122652-new-members/topic/Will.20asks.20for.20help/near/275918520">said</a>:</p>
<blockquote>
<p>I have a very silly question. I followed the steps for building the rust project ("./x.py build &amp;&amp; ./x.py install") and got:</p>
</blockquote>
<p>Those instructions in the README are for people using the compiler, not people developing and contributing to the compiler. You probably want <a href="https://rustc-dev-guide.rust-lang.org/">https://rustc-dev-guide.rust-lang.org/</a></p>



<a name="275923330"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122652-new%20members/topic/Will%20asks%20for%20help/near/275923330" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Will <a href="https://zulip-archive.rust-lang.org/stream/122652-new-members/topic/Will.20asks.20for.20help.html#275923330">(Mar 19 2022 at 18:38)</a>:</h4>
<p>I took the folder out of dropbox and got the same error.</p>



<a name="275923375"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122652-new%20members/topic/Will%20asks%20for%20help/near/275923375" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jubilee <a href="https://zulip-archive.rust-lang.org/stream/122652-new-members/topic/Will.20asks.20for.20help.html#275923375">(Mar 19 2022 at 18:39)</a>:</h4>
<p>Yes, I didn't recommend that because it would fix your issue, I recommended that because it almost invariably incurs huge network latency and weird bugs.</p>



<a name="275923648"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122652-new%20members/topic/Will%20asks%20for%20help/near/275923648" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jubilee <a href="https://zulip-archive.rust-lang.org/stream/122652-new-members/topic/Will.20asks.20for.20help.html#275923648">(Mar 19 2022 at 18:45)</a>:</h4>
<p>You probably want to <code>rm -rf ./build</code> and then start again from <code>x.py setup</code></p>



<a name="275923956"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122652-new%20members/topic/Will%20asks%20for%20help/near/275923956" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jubilee <a href="https://zulip-archive.rust-lang.org/stream/122652-new-members/topic/Will.20asks.20for.20help.html#275923956">(Mar 19 2022 at 18:52)</a>:</h4>
<p>Building the entire compiler causes amounts of disk I/O that it starts to incur notable actual physical wear and tear once you do it a few hundred or a few thousand times. As you might imagine, it finds edge cases in Dropbox's sync processes even faster.</p>



<a name="275925750"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122652-new%20members/topic/Will%20asks%20for%20help/near/275925750" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Will <a href="https://zulip-archive.rust-lang.org/stream/122652-new-members/topic/Will.20asks.20for.20help.html#275925750">(Mar 19 2022 at 19:37)</a>:</h4>
<p>I did that and got the same error</p>



<a name="275926098"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122652-new%20members/topic/Will%20asks%20for%20help/near/275926098" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Will <a href="https://zulip-archive.rust-lang.org/stream/122652-new-members/topic/Will.20asks.20for.20help.html#275926098">(Mar 19 2022 at 19:44)</a>:</h4>
<p>Any idea how to fix it?</p>



<a name="275933815"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122652-new%20members/topic/Will%20asks%20for%20help/near/275933815" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jubilee <a href="https://zulip-archive.rust-lang.org/stream/122652-new-members/topic/Will.20asks.20for.20help.html#275933815">(Mar 19 2022 at 22:36)</a>:</h4>
<p>The error you describe should not occur at all because it should not get as far as building LLVM and thus the archive file should not matter.</p>



<a name="275933851"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122652-new%20members/topic/Will%20asks%20for%20help/near/275933851" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jubilee <a href="https://zulip-archive.rust-lang.org/stream/122652-new-members/topic/Will.20asks.20for.20help.html#275933851">(Mar 19 2022 at 22:37)</a>:</h4>
<p>And you should have given an answer to <code>x.py setup</code> for anything <strong>but</strong> <code>x.py setup codegen</code>.</p>



<a name="275934922"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122652-new%20members/topic/Will%20asks%20for%20help/near/275934922" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jubilee <a href="https://zulip-archive.rust-lang.org/stream/122652-new-members/topic/Will.20asks.20for.20help.html#275934922">(Mar 19 2022 at 23:06)</a>:</h4>
<p>So I could help, but now we're getting into the territory of "what is your <code>config.toml</code> exactly?" and "can you paste the entire build log?" and "what is the output of <code>git status</code>?"</p>



<a name="276936803"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122652-new%20members/topic/Will%20asks%20for%20help/near/276936803" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pnkfelix <a href="https://zulip-archive.rust-lang.org/stream/122652-new-members/topic/Will.20asks.20for.20help.html#276936803">(Mar 28 2022 at 22:03)</a>:</h4>
<p><span class="user-mention silent" data-user-id="487284">Will</span> <a href="#narrow/stream/122652-new-members/topic/Will.20asks.20for.20help/near/275925750">said</a>:</p>
<blockquote>
<p>I did that and got the same error</p>
</blockquote>
<p>Hey Will, did you manage to resolve your issue on your own? Jubilee wasn't wrong about the territory that we're getting into (e.g. pasting the exact <code>config.toml</code> you have), but that doesn't mean we don't want to help you get your checkout into a working state.</p>



<a name="276940687"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122652-new%20members/topic/Will%20asks%20for%20help/near/276940687" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Eric Huss <a href="https://zulip-archive.rust-lang.org/stream/122652-new-members/topic/Will.20asks.20for.20help.html#276940687">(Mar 28 2022 at 22:59)</a>:</h4>
<p>This is very likely a Rosetta2 issue. It can be tricky to resolve what piece in the chain is causing it to switch.  I wonder if there is some way to detect this situation in rustbuild and present a better error?</p>



<a name="276949703"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122652-new%20members/topic/Will%20asks%20for%20help/near/276949703" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Nelson <a href="https://zulip-archive.rust-lang.org/stream/122652-new-members/topic/Will.20asks.20for.20help.html#276949703">(Mar 29 2022 at 01:44)</a>:</h4>
<p>What is Rosetta2?</p>



<a name="276949900"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122652-new%20members/topic/Will%20asks%20for%20help/near/276949900" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Michael Goulet (compiler-errors) <a href="https://zulip-archive.rust-lang.org/stream/122652-new-members/topic/Will.20asks.20for.20help.html#276949900">(Mar 29 2022 at 01:49)</a>:</h4>
<p>rosetta2 is the binary translator that new apple machines use to execute x86-64 programs on aarch64</p>



<a name="277039435"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122652-new%20members/topic/Will%20asks%20for%20help/near/277039435" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jubilee <a href="https://zulip-archive.rust-lang.org/stream/122652-new-members/topic/Will.20asks.20for.20help.html#277039435">(Mar 29 2022 at 17:28)</a>:</h4>
<p>oh dear.</p>



<a name="277039822"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122652-new%20members/topic/Will%20asks%20for%20help/near/277039822" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jubilee <a href="https://zulip-archive.rust-lang.org/stream/122652-new-members/topic/Will.20asks.20for.20help.html#277039822">(Mar 29 2022 at 17:30)</a>:</h4>
<p>yes, I have been frankly considering getting an Apple machine just to poke at these kinds of issues. "the cost is now high" is not a disinterest in paying it, just an observation that now it requires a lot more effort (like copying a bunch of data).</p>



<a name="277414861"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122652-new%20members/topic/Will%20asks%20for%20help/near/277414861" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Gianni Salinetti <a href="https://zulip-archive.rust-lang.org/stream/122652-new-members/topic/Will.20asks.20for.20help.html#277414861">(Apr 01 2022 at 13:09)</a>:</h4>
<p>Hi all, I'm a new member of the Rust community</p>



<hr><p>Last updated: Apr 12 2022 at 20:01 UTC</p>
</html>