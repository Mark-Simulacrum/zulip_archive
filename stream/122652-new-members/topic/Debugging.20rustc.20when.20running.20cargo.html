<html>
<head><meta charset="utf-8"><title>Debugging rustc when running cargo · new members · Zulip Chat Archive</title></head>
<h2>Stream: <a href="https://zulip-archive.rust-lang.org/stream/122652-new-members/index.html">new members</a></h2>
<h3>Topic: <a href="https://zulip-archive.rust-lang.org/stream/122652-new-members/topic/Debugging.20rustc.20when.20running.20cargo.html">Debugging rustc when running cargo</a></h3>

<hr>

<base href="https://rust-lang.zulipchat.com">

<head><link href="https://zulip-archive.rust-lang.org/style.css" rel="stylesheet"></head>

<a name="254445589"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122652-new%20members/topic/Debugging%20rustc%20when%20running%20cargo/near/254445589" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Celina V. <a href="https://zulip-archive.rust-lang.org/stream/122652-new-members/topic/Debugging.20rustc.20when.20running.20cargo.html#254445589">(Sep 22 2021 at 21:57)</a>:</h4>
<p>Hi Everyone,</p>
<p>I've recently joined the RMC (rust model checker) project which is developed on the top of rustc. I'm still learning my way around rustc and I was wondering if it's possible to run rustc in a debugger while executing cargo build.</p>
<p>Thanks,</p>



<a name="254447360"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122652-new%20members/topic/Debugging%20rustc%20when%20running%20cargo/near/254447360" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Eric Huss <a href="https://zulip-archive.rust-lang.org/stream/122652-new-members/topic/Debugging.20rustc.20when.20running.20cargo.html#254447360">(Sep 22 2021 at 22:11)</a>:</h4>
<p>I would just run <code>cargo +stage1 build -v</code>, and then copy the arguments for the crate you want to debug.  Then, launch the debugger with the appropriate <code>rustc</code> and then paste the arguments to the run command.</p>



<a name="254450328"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122652-new%20members/topic/Debugging%20rustc%20when%20running%20cargo/near/254450328" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Celina V. <a href="https://zulip-archive.rust-lang.org/stream/122652-new-members/topic/Debugging.20rustc.20when.20running.20cargo.html#254450328">(Sep 22 2021 at 22:35)</a>:</h4>
<p>That's what I've been doing too. Happy to know I wasn't far off.</p>
<p>I was also trying to override the rustc command used by cargo and replace it with a little script that runs rustc inside gdb instead. Everything runs smoothly but gdb never enters the interactive prompt. I assume it has to do with how cargo is spawning the rustc process.</p>
<div class="codehilite"><pre><span></span><code>RUSTC=$RUSTC_PATH/scripts/rustc-gdb cargo build -v
   Compiling simple-lib v0.1.0 (~/rustc/src/test/simple-lib)
     Running `~/rustc/scripts/rustc-gdb --crate-name simple_lib --edition=2018 src/lib.rs --error-format=json --json=diagnostic-rendered-ansi --crate-type lib --emit=dep-info,metadata,link -C embed-bitcode=no -C debuginfo=2 -C metadata=b022fae5f78c955f -C extra-filename=-b022fae5f78c955f --out-dir ~/rustc/src/test/simple-lib/target/debug/deps -C incremental=~/rustc/src/test/simple-lib/target/debug/incremental -L dependency=~/rustc/src/test/simple-lib/target/debug/deps`
gdb --args ~/rustc/build/x86_64-unknown-linux-gnu/stage1/bin/rustc --crate-name simple_lib --edition=2018 src/lib.rs --error-format=json --json=diagnostic-rendered-ansi --crate-type lib --emit=dep-info,metadata,link -C embed-bitcode=no -C debuginfo=2 -C metadata=b022fae5f78c955f -C extra-filename=-b022fae5f78c955f --out-dir ~/rustc/src/test/simple-lib/target/debug/deps -C incremental=~/rustc/src/test/simple-lib/target/debug/incremental -L dependency=~/rustc/src/test/simple-lib/target/debug/deps
GNU gdb (Ubuntu 8.1.1-0ubuntu1) 8.1.1
Copyright (C) 2018 Free Software Foundation, Inc.
License GPLv3+: GNU GPL version 3 or later &lt;http://gnu.org/licenses/gpl.html&gt;
This is free software: you are free to change and redistribute it.
There is NO WARRANTY, to the extent permitted by law.  Type &quot;show copying&quot;
and &quot;show warranty&quot; for details.
This GDB was configured as &quot;x86_64-linux-gnu&quot;.
Type &quot;show configuration&quot; for configuration details.
For bug reporting instructions, please see:
&lt;http://www.gnu.org/software/gdb/bugs/&gt;.
Find the GDB manual and other documentation resources online at:
&lt;http://www.gnu.org/software/gdb/documentation/&gt;.
For help, type &quot;help&quot;.
Type &quot;apropos word&quot; to search for commands related to &quot;word&quot;...
Reading symbols from ~/rustc/build/x86_64-unknown-linux-gnu/stage1/bin/rustc...done.
warning: Missing auto-load script at offset 0 in section .debug_gdb_scripts
of file ~/rustc/build/x86_64-unknown-linux-gnu/stage1/bin/rustc.
Use `info auto-load python-scripts [REGEXP]&#39; to list them.
(gdb) quit
    Finished dev [unoptimized + debuginfo] target(s) in 0.12s
</code></pre></div>



<a name="254451769"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122652-new%20members/topic/Debugging%20rustc%20when%20running%20cargo/near/254451769" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> bjorn3 <a href="https://zulip-archive.rust-lang.org/stream/122652-new-members/topic/Debugging.20rustc.20when.20running.20cargo.html#254451769">(Sep 22 2021 at 22:48)</a>:</h4>
<p>AFAIK rustc doesn't forward stdin to the spawned rustc processes.</p>



<a name="254454405"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122652-new%20members/topic/Debugging%20rustc%20when%20running%20cargo/near/254454405" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Celina V. <a href="https://zulip-archive.rust-lang.org/stream/122652-new-members/topic/Debugging.20rustc.20when.20running.20cargo.html#254454405">(Sep 22 2021 at 23:11)</a>:</h4>
<p>That answers my question. Thanks!</p>



<a name="254580348"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122652-new%20members/topic/Debugging%20rustc%20when%20running%20cargo/near/254580348" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Josh Triplett <a href="https://zulip-archive.rust-lang.org/stream/122652-new-members/topic/Debugging.20rustc.20when.20running.20cargo.html#254580348">(Sep 23 2021 at 18:17)</a>:</h4>
<p>I wonder if it would be useful to have a command line option that makes the compiler print its process ID to standard error and then stop itself and wait for GDB to be attached.</p>



<a name="254590363"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122652-new%20members/topic/Debugging%20rustc%20when%20running%20cargo/near/254590363" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Nelson <a href="https://zulip-archive.rust-lang.org/stream/122652-new-members/topic/Debugging.20rustc.20when.20running.20cargo.html#254590363">(Sep 23 2021 at 19:24)</a>:</h4>
<p>that would be incredible</p>



<a name="254590373"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122652-new%20members/topic/Debugging%20rustc%20when%20running%20cargo/near/254590373" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Nelson <a href="https://zulip-archive.rust-lang.org/stream/122652-new-members/topic/Debugging.20rustc.20when.20running.20cargo.html#254590373">(Sep 23 2021 at 19:24)</a>:</h4>
<p>in node this is <code>--inspect-brk</code> I think</p>



<a name="254607360"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122652-new%20members/topic/Debugging%20rustc%20when%20running%20cargo/near/254607360" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Josh Triplett <a href="https://zulip-archive.rust-lang.org/stream/122652-new-members/topic/Debugging.20rustc.20when.20running.20cargo.html#254607360">(Sep 23 2021 at 21:19)</a>:</h4>
<p>Happy to review a PR for that.</p>



<hr><p>Last updated: Apr 12 2022 at 20:01 UTC</p>
</html>