<html>
<head><meta charset="utf-8"><title>-C lto and -C lto-fat are different? · new members · Zulip Chat Archive</title></head>
<h2>Stream: <a href="https://zulip-archive.rust-lang.org/stream/122652-new-members/index.html">new members</a></h2>
<h3>Topic: <a href="https://zulip-archive.rust-lang.org/stream/122652-new-members/topic/-C.20lto.20and.20-C.20lto-fat.20are.20different.3F.html">-C lto and -C lto-fat are different?</a></h3>

<hr>

<base href="https://rust-lang.zulipchat.com">

<head><link href="https://zulip-archive.rust-lang.org/style.css" rel="stylesheet"></head>

<a name="268895781"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122652-new%20members/topic/-C%20lto%20and%20-C%20lto-fat%20are%20different%3F/near/268895781" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Nazar Mokrynskyi <a href="https://zulip-archive.rust-lang.org/stream/122652-new-members/topic/-C.20lto.20and.20-C.20lto-fat.20are.20different.3F.html#268895781">(Jan 21 2022 at 19:59)</a>:</h4>
<p>I noticed that when building WASM binaries at least the resulting size is different when using <code>-C lto</code> and <code>-C lto=fat</code> even though Cargo documentation suggests they are identical. Any hints why that is the case?</p>



<a name="268900445"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122652-new%20members/topic/-C%20lto%20and%20-C%20lto-fat%20are%20different%3F/near/268900445" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Amanieu <a href="https://zulip-archive.rust-lang.org/stream/122652-new-members/topic/-C.20lto.20and.20-C.20lto-fat.20are.20different.3F.html#268900445">(Jan 21 2022 at 20:42)</a>:</h4>
<p>I think -C lto defaults to -C lto=thin.</p>



<a name="268900712"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122652-new%20members/topic/-C%20lto%20and%20-C%20lto-fat%20are%20different%3F/near/268900712" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> matthiaskrgr <a href="https://zulip-archive.rust-lang.org/stream/122652-new-members/topic/-C.20lto.20and.20-C.20lto-fat.20are.20different.3F.html#268900712">(Jan 21 2022 at 20:44)</a>:</h4>
<p>there might be differences what kind of data is included in the object files<br>
<a href="https://github.com/rust-lang/cargo/blob/master/src/cargo/core/compiler/lto.rs#L8">https://github.com/rust-lang/cargo/blob/master/src/cargo/core/compiler/lto.rs#L8</a></p>



<a name="268900792"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122652-new%20members/topic/-C%20lto%20and%20-C%20lto-fat%20are%20different%3F/near/268900792" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> matthiaskrgr <a href="https://zulip-archive.rust-lang.org/stream/122652-new-members/topic/-C.20lto.20and.20-C.20lto-fat.20are.20different.3F.html#268900792">(Jan 21 2022 at 20:45)</a>:</h4>
<p>I remember reading something about some kind of omni-lto that supports both thin and monolithic lto at the same time, but I don't remember if rust supports that <span aria-label="thinking" class="emoji emoji-1f914" role="img" title="thinking">:thinking:</span></p>



<a name="268901724"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122652-new%20members/topic/-C%20lto%20and%20-C%20lto-fat%20are%20different%3F/near/268901724" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Nazar Mokrynskyi <a href="https://zulip-archive.rust-lang.org/stream/122652-new-members/topic/-C.20lto.20and.20-C.20lto-fat.20are.20different.3F.html#268901724">(Jan 21 2022 at 20:53)</a>:</h4>
<p>I thought so too, but documentation says that <code>true</code> and <code>"fat"</code> are the same: <a href="https://doc.rust-lang.org/cargo/reference/profiles.html#lto">https://doc.rust-lang.org/cargo/reference/profiles.html#lto</a></p>



<a name="268903519"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122652-new%20members/topic/-C%20lto%20and%20-C%20lto-fat%20are%20different%3F/near/268903519" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> bjorn3 <a href="https://zulip-archive.rust-lang.org/stream/122652-new-members/topic/-C.20lto.20and.20-C.20lto-fat.20are.20different.3F.html#268903519">(Jan 21 2022 at 21:08)</a>:</h4>
<p>Fat lto seems to be the default for <code>-Clto</code>: <a href="https://github.com/rust-lang/rust/blob/cbaeec14f90b59a91a6b0f17fc046c66fa811892/compiler/rustc_session/src/session.rs#L602">https://github.com/rust-lang/rust/blob/cbaeec14f90b59a91a6b0f17fc046c66fa811892/compiler/rustc_session/src/session.rs#L602</a></p>



<a name="268904053"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122652-new%20members/topic/-C%20lto%20and%20-C%20lto-fat%20are%20different%3F/near/268904053" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Nazar Mokrynskyi <a href="https://zulip-archive.rust-lang.org/stream/122652-new-members/topic/-C.20lto.20and.20-C.20lto-fat.20are.20different.3F.html#268904053">(Jan 21 2022 at 21:13)</a>:</h4>
<p>Is there anything else that I can check to see why is the actual difference happening?<br>
I can reproduce binaries of a different size reliably.</p>



<hr><p>Last updated: Apr 12 2022 at 20:01 UTC</p>
</html>