<html>
<head><meta charset="utf-8"><title>Cron Job Failure 2022-03-12 · miri · Zulip Chat Archive</title></head>
<h2>Stream: <a href="https://zulip-archive.rust-lang.org/stream/269128-miri/index.html">miri</a></h2>
<h3>Topic: <a href="https://zulip-archive.rust-lang.org/stream/269128-miri/topic/Cron.20Job.20Failure.202022-03-12.html">Cron Job Failure 2022-03-12</a></h3>

<hr>

<base href="https://rust-lang.zulipchat.com">

<head><link href="https://zulip-archive.rust-lang.org/style.css" rel="stylesheet"></head>

<a name="275073333"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/269128-miri/topic/Cron%20Job%20Failure%202022-03-12/near/275073333" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> miri-test-libstd <a href="https://zulip-archive.rust-lang.org/stream/269128-miri/topic/Cron.20Job.20Failure.202022-03-12.html#275073333">(Mar 12 2022 at 03:10)</a>:</h4>
<p>Dear <span class="user-mention" data-user-id="120791">@RalfJ</span>,</p>
<p>The standard library test suite is failing under Miri. Would you mind investigating this issue?</p>
<p>Thanks in advance!<br>
Sincerely,<br>
The Miri Cronjobs Bot</p>



<a name="275100810"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/269128-miri/topic/Cron%20Job%20Failure%202022-03-12/near/275100810" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> RalfJ <a href="https://zulip-archive.rust-lang.org/stream/269128-miri/topic/Cron.20Job.20Failure.202022-03-12.html#275100810">(Mar 12 2022 at 14:55)</a>:</h4>
<p>I did expect the SIMD doctests to fail (a Miri update still needs to propagate to the rustc repo), but the failures are unexpected... the int &lt;-&gt; ptr transmutes in portable-simd are actually causing -Zmiri-check-number-validity to fail. <em>oops</em></p>



<a name="275100885"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/269128-miri/topic/Cron%20Job%20Failure%202022-03-12/near/275100885" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> RalfJ <a href="https://zulip-archive.rust-lang.org/stream/269128-miri/topic/Cron.20Job.20Failure.202022-03-12.html#275100885">(Mar 12 2022 at 14:56)</a>:</h4>
<p><span class="user-mention" data-user-id="281757">@Jubilee</span> would it make any sense to use simd_cast instead of transmute here? not sure of vectorized ptr &lt;-&gt; int cast are a thing in LLVM...</p>



<a name="275101555"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/269128-miri/topic/Cron%20Job%20Failure%202022-03-12/near/275101555" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> miri cronjobs <a href="https://zulip-archive.rust-lang.org/stream/269128-miri/topic/Cron.20Job.20Failure.202022-03-12.html#275101555">(Mar 12 2022 at 15:10)</a>:</h4>
<p>Dear <span class="user-mention" data-user-id="120791">@RalfJ</span> and <span class="user-mention" data-user-id="124288">@oli</span></p>
<p>It would appear that the Miri cron job build failed. Would you mind investigating this issue?</p>
<p>Thanks in advance!<br>
Sincerely,<br>
The Miri Cronjobs Bot</p>



<a name="275103588"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/269128-miri/topic/Cron%20Job%20Failure%202022-03-12/near/275103588" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jubilee <a href="https://zulip-archive.rust-lang.org/stream/269128-miri/topic/Cron.20Job.20Failure.202022-03-12.html#275103588">(Mar 12 2022 at 15:54)</a>:</h4>
<p><span class="user-mention silent" data-user-id="120791">RalfJ</span> <a href="#narrow/stream/269128-miri/topic/Cron.20Job.20Failure.202022-03-12/near/275100885">said</a>:</p>
<blockquote>
<p><span class="user-mention silent" data-user-id="281757">Jubilee</span> would it make any sense to use simd_cast instead of transmute here? not sure of vectorized ptr &lt;-&gt; int cast are a thing in LLVM...</p>
</blockquote>
<p>I don't believe <code>simd_cast</code> actually implements inttoptr or ptrttoint.</p>



<a name="275103695"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/269128-miri/topic/Cron%20Job%20Failure%202022-03-12/near/275103695" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jubilee <a href="https://zulip-archive.rust-lang.org/stream/269128-miri/topic/Cron.20Job.20Failure.202022-03-12.html#275103695">(Mar 12 2022 at 15:57)</a>:</h4>
<p>If I was going to fix this, it would be by getting off my ass and allowing vectorized gep to exist (since that works).</p>



<a name="275186155"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/269128-miri/topic/Cron%20Job%20Failure%202022-03-12/near/275186155" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> RalfJ <a href="https://zulip-archive.rust-lang.org/stream/269128-miri/topic/Cron.20Job.20Failure.202022-03-12.html#275186155">(Mar 14 2022 at 01:36)</a>:</h4>
<p><span class="user-mention silent" data-user-id="281757">Jubilee</span> <a href="#narrow/stream/269128-miri/topic/Cron.20Job.20Failure.202022-03-12/near/275103588">said</a>:</p>
<blockquote>
<p><span class="user-mention silent" data-user-id="120791">RalfJ</span> <a href="#narrow/stream/269128-miri/topic/Cron.20Job.20Failure.202022-03-12/near/275100885">said</a>:</p>
<blockquote>
<p><span class="user-mention silent" data-user-id="281757">Jubilee</span> would it make any sense to use simd_cast instead of transmute here? not sure of vectorized ptr &lt;-&gt; int cast are a thing in LLVM...</p>
</blockquote>
<p>I don't believe <code>simd_cast</code> actually implements inttoptr or ptrttoint.</p>
</blockquote>
<p>it would easily do that in Miri <span aria-label="joy" class="emoji emoji-1f602" role="img" title="joy">:joy:</span> but I guess not in LLVM</p>



<a name="275186198"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/269128-miri/topic/Cron%20Job%20Failure%202022-03-12/near/275186198" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> RalfJ <a href="https://zulip-archive.rust-lang.org/stream/269128-miri/topic/Cron.20Job.20Failure.202022-03-12.html#275186198">(Mar 14 2022 at 01:36)</a>:</h4>
<p>vectorized GEP would of course be even better :)</p>



<hr><p>Last updated: Apr 12 2022 at 20:01 UTC</p>
</html>