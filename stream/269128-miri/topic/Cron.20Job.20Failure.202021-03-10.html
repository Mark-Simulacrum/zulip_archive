<html>
<head><meta charset="utf-8"><title>Cron Job Failure 2021-03-10 · miri · Zulip Chat Archive</title></head>
<h2>Stream: <a href="https://zulip-archive.rust-lang.org/stream/269128-miri/index.html">miri</a></h2>
<h3>Topic: <a href="https://zulip-archive.rust-lang.org/stream/269128-miri/topic/Cron.20Job.20Failure.202021-03-10.html">Cron Job Failure 2021-03-10</a></h3>

<hr>

<base href="https://rust-lang.zulipchat.com">

<head><link href="https://zulip-archive.rust-lang.org/style.css" rel="stylesheet"></head>

<a name="229613734"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/269128-miri/topic/Cron%20Job%20Failure%202021-03-10/near/229613734" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> miri cronjobs <a href="https://zulip-archive.rust-lang.org/stream/269128-miri/topic/Cron.20Job.20Failure.202021-03-10.html#229613734">(Mar 10 2021 at 07:24)</a>:</h4>
<p>Dear <span class="user-mention" data-user-id="120791">@RalfJ</span> and <span class="user-mention" data-user-id="124288">@oli</span></p>
<p>It would appear that the Miri cron job build failed. Would you mind investigating this issue?</p>
<p>Thanks in advance!<br>
Sincerely,<br>
The Miri Cronjobs Bot</p>



<a name="229618725"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/269128-miri/topic/Cron%20Job%20Failure%202021-03-10/near/229618725" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> RalfJ <a href="https://zulip-archive.rust-lang.org/stream/269128-miri/topic/Cron.20Job.20Failure.202021-03-10.html#229618725">(Mar 10 2021 at 08:15)</a>:</h4>
<p>Something broke string formatting...</p>



<a name="229618757"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/269128-miri/topic/Cron%20Job%20Failure%202021-03-10/near/229618757" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> RalfJ <a href="https://zulip-archive.rust-lang.org/stream/269128-miri/topic/Cron.20Job.20Failure.202021-03-10.html#229618757">(Mar 10 2021 at 08:15)</a>:</h4>
<p>Probably <a href="https://github.com/rust-lang/rust/issues/77511">#77511</a> but I dont see it yet</p>



<a name="229619129"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/269128-miri/topic/Cron%20Job%20Failure%202021-03-10/near/229619129" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> RalfJ <a href="https://zulip-archive.rust-lang.org/stream/269128-miri/topic/Cron.20Job.20Failure.202021-03-10.html#229619129">(Mar 10 2021 at 08:19)</a>:</h4>
<p>ah got it</p>



<a name="229619456"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/269128-miri/topic/Cron%20Job%20Failure%202021-03-10/near/229619456" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> RalfJ <a href="https://zulip-archive.rust-lang.org/stream/269128-miri/topic/Cron.20Job.20Failure.202021-03-10.html#229619456">(Mar 10 2021 at 08:22)</a>:</h4>
<p><a href="https://github.com/rust-lang/rust/pull/82967">https://github.com/rust-lang/rust/pull/82967</a></p>



<a name="229635630"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/269128-miri/topic/Cron%20Job%20Failure%202021-03-10/near/229635630" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> oli <a href="https://zulip-archive.rust-lang.org/stream/269128-miri/topic/Cron.20Job.20Failure.202021-03-10.html#229635630">(Mar 10 2021 at 10:40)</a>:</h4>
<p>The changes you made make sense, but I don't see how they affect the tests that you added to rustc</p>



<a name="229807766"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/269128-miri/topic/Cron%20Job%20Failure%202021-03-10/near/229807766" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> RalfJ <a href="https://zulip-archive.rust-lang.org/stream/269128-miri/topic/Cron.20Job.20Failure.202021-03-10.html#229807766">(Mar 11 2021 at 07:47)</a>:</h4>
<p><span class="user-mention silent" data-user-id="124288">oli</span> <a href="#narrow/stream/269128-miri/topic/Cron.20Job.20Failure.202021-03-10/near/229635630">said</a>:</p>
<blockquote>
<p>The changes you made make sense, but I don't see how they affect the tests that you added to rustc</p>
</blockquote>
<p>they affect only the first test</p>



<a name="229807822"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/269128-miri/topic/Cron%20Job%20Failure%202021-03-10/near/229807822" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> RalfJ <a href="https://zulip-archive.rust-lang.org/stream/269128-miri/topic/Cron.20Job.20Failure.202021-03-10.html#229807822">(Mar 11 2021 at 07:48)</a>:</h4>
<p>before, the <code>size</code> passed to <code>check_ptr_access</code> was the element size; now it is <code>elem_size * count</code></p>



<a name="229807828"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/269128-miri/topic/Cron%20Job%20Failure%202021-03-10/near/229807828" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> RalfJ <a href="https://zulip-archive.rust-lang.org/stream/269128-miri/topic/Cron.20Job.20Failure.202021-03-10.html#229807828">(Mar 11 2021 at 07:48)</a>:</h4>
<p>That was the bug</p>



<a name="229824942"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/269128-miri/topic/Cron%20Job%20Failure%202021-03-10/near/229824942" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> oli <a href="https://zulip-archive.rust-lang.org/stream/269128-miri/topic/Cron.20Job.20Failure.202021-03-10.html#229824942">(Mar 11 2021 at 10:13)</a>:</h4>
<p>right, but the tests only test the <code>0</code> case</p>



<a name="229826477"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/269128-miri/topic/Cron%20Job%20Failure%202021-03-10/near/229826477" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> hyd-dev <a href="https://zulip-archive.rust-lang.org/stream/269128-miri/topic/Cron.20Job.20Failure.202021-03-10.html#229826477">(Mar 11 2021 at 10:26)</a>:</h4>
<p>The <code>()</code> pointers are casted to <code>*const i32</code>, so <code>size</code> is 4, before the PR, it checks access for 4 bytes, after the PR, it checks for <code>4 * 0</code> (which is 0) bytes, which allows the <code>copy_nonoverlapping</code> operation?</p>



<a name="229827181"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/269128-miri/topic/Cron%20Job%20Failure%202021-03-10/near/229827181" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> oli <a href="https://zulip-archive.rust-lang.org/stream/269128-miri/topic/Cron.20Job.20Failure.202021-03-10.html#229827181">(Mar 11 2021 at 10:33)</a>:</h4>
<p>oh I see. I was looking at it from the wrong direction, thanks!</p>



<a name="229889288"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/269128-miri/topic/Cron%20Job%20Failure%202021-03-10/near/229889288" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> RalfJ <a href="https://zulip-archive.rust-lang.org/stream/269128-miri/topic/Cron.20Job.20Failure.202021-03-10.html#229889288">(Mar 11 2021 at 17:20)</a>:</h4>
<p>Exactly. The 0 case was the buggy one.<br>
(I guess we could also test to make sure that with count=2, we do indeed check 2*size many bytes... but it seems hard to get that wrong and get the 0 right.)</p>



<hr><p>Last updated: Apr 12 2022 at 20:01 UTC</p>
</html>