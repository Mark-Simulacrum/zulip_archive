<html>
<head><meta charset="utf-8"><title>specialization or negative impls? · wg-traits/negative-impls · Zulip Chat Archive</title></head>
<h2>Stream: <a href="https://zulip-archive.rust-lang.org/stream/315151-wg-traits/negative-impls/index.html">wg-traits/negative-impls</a></h2>
<h3>Topic: <a href="https://zulip-archive.rust-lang.org/stream/315151-wg-traits/negative-impls/topic/specialization.20or.20negative.20impls.3F.html">specialization or negative impls?</a></h3>

<hr>

<base href="https://rust-lang.zulipchat.com">

<head><link href="https://zulip-archive.rust-lang.org/style.css" rel="stylesheet"></head>

<a name="274460725"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/315151-wg-traits/negative-impls/topic/specialization%20or%20negative%20impls%3F/near/274460725" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jubilee <a href="https://zulip-archive.rust-lang.org/stream/315151-wg-traits/negative-impls/topic/specialization.20or.20negative.20impls.3F.html#274460725">(Mar 07 2022 at 21:30)</a>:</h4>
<p>Hello, I am currently trying to write this impl:</p>
<div class="codehilite" data-code-language="Rust"><pre><span></span><code><span class="k">impl</span><span class="o">&lt;</span><span class="n">T</span><span class="p">,</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="n">N</span>: <span class="kt">usize</span><span class="o">&gt;</span><span class="w"> </span><span class="nb">From</span><span class="o">&lt;</span><span class="n">Mask</span><span class="o">&lt;</span><span class="n">U</span><span class="p">,</span><span class="w"> </span><span class="n">N</span><span class="o">&gt;&gt;</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">Mask</span><span class="o">&lt;</span><span class="n">T</span><span class="p">,</span><span class="w"> </span><span class="n">N</span><span class="o">&gt;</span><span class="w"></span>
<span class="k">where</span><span class="w"></span>
<span class="w">    </span><span class="n">T</span>: <span class="nc">MaskElement</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">U</span>: <span class="nc">MaskElement</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">LaneCount</span><span class="o">&lt;</span><span class="n">N</span><span class="o">&gt;</span>: <span class="nc">SupportedLaneCount</span><span class="p">,</span><span class="w"></span>
<span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="k">fn</span> <span class="nf">from</span><span class="p">(</span><span class="n">value</span>: <span class="nc">Mask</span><span class="o">&lt;</span><span class="n">U</span><span class="p">,</span><span class="w"> </span><span class="n">N</span><span class="o">&gt;</span><span class="p">)</span><span class="w"> </span>-&gt; <span class="nc">Mask</span><span class="o">&lt;</span><span class="n">T</span><span class="p">,</span><span class="w"> </span><span class="n">N</span><span class="o">&gt;</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">        </span><span class="n">Mask</span>::<span class="n">from</span><span class="p">(</span><span class="n">value</span><span class="p">.</span><span class="mf">0.</span><span class="n">convert</span><span class="p">())</span><span class="w"></span>
<span class="w">    </span><span class="p">}</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>
</code></pre></div>
<p>But this conflicts with the <code>From&lt;T&gt; for T</code> blanket impl.<br>
I have worked through various different features and variants of this but it seems nothing resolves correctly.<br>
Is this within scope for a feature that is in development?</p>



<a name="274462211"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/315151-wg-traits/negative-impls/topic/specialization%20or%20negative%20impls%3F/near/274462211" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jane Lusby [she/her] <a href="https://zulip-archive.rust-lang.org/stream/315151-wg-traits/negative-impls/topic/specialization.20or.20negative.20impls.3F.html#274462211">(Mar 07 2022 at 21:42)</a>:</h4>
<p>I don't know of a way to do this with negative impls, for similar stuff in error handling land I'm under the impression that this needs lattice specialization which is not currently being worked on</p>



<a name="274462275"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/315151-wg-traits/negative-impls/topic/specialization%20or%20negative%20impls%3F/near/274462275" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jane Lusby [she/her] <a href="https://zulip-archive.rust-lang.org/stream/315151-wg-traits/negative-impls/topic/specialization.20or.20negative.20impls.3F.html#274462275">(Mar 07 2022 at 21:43)</a>:</h4>
<p>does this need to be done via the <code>From</code> trait?</p>



<a name="274473101"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/315151-wg-traits/negative-impls/topic/specialization%20or%20negative%20impls%3F/near/274473101" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jubilee <a href="https://zulip-archive.rust-lang.org/stream/315151-wg-traits/negative-impls/topic/specialization.20or.20negative.20impls.3F.html#274473101">(Mar 07 2022 at 23:16)</a>:</h4>
<p>I don't think it absolutely has to IMO.</p>



<a name="274473135"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/315151-wg-traits/negative-impls/topic/specialization%20or%20negative%20impls%3F/near/274473135" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jubilee <a href="https://zulip-archive.rust-lang.org/stream/315151-wg-traits/negative-impls/topic/specialization.20or.20negative.20impls.3F.html#274473135">(Mar 07 2022 at 23:16)</a>:</h4>
<p>Anyways I can take this elsewhere if here is inappropriate.<br>
Though... what is "lattice specialization", exactly?</p>



<a name="274473157"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/315151-wg-traits/negative-impls/topic/specialization%20or%20negative%20impls%3F/near/274473157" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jane Lusby [she/her] <a href="https://zulip-archive.rust-lang.org/stream/315151-wg-traits/negative-impls/topic/specialization.20or.20negative.20impls.3F.html#274473157">(Mar 07 2022 at 23:17)</a>:</h4>
<p>its specializing precise overlaps of two implementations</p>



<a name="274473172"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/315151-wg-traits/negative-impls/topic/specialization%20or%20negative%20impls%3F/near/274473172" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jubilee <a href="https://zulip-archive.rust-lang.org/stream/315151-wg-traits/negative-impls/topic/specialization.20or.20negative.20impls.3F.html#274473172">(Mar 07 2022 at 23:17)</a>:</h4>
<p>Ahhh.</p>



<a name="274473214"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/315151-wg-traits/negative-impls/topic/specialization%20or%20negative%20impls%3F/near/274473214" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jane Lusby [she/her] <a href="https://zulip-archive.rust-lang.org/stream/315151-wg-traits/negative-impls/topic/specialization.20or.20negative.20impls.3F.html#274473214">(Mar 07 2022 at 23:17)</a>:</h4>
<p>the language of the specialization RFC says it was ruled out and not planned, but when I've talked to niko about it he has said he still hopes we end up getting it</p>



<a name="274563767"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/315151-wg-traits/negative-impls/topic/specialization%20or%20negative%20impls%3F/near/274563767" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/315151-wg-traits/negative-impls/topic/specialization.20or.20negative.20impls.3F.html#274563767">(Mar 08 2022 at 16:16)</a>:</h4>
<p>I plan to basically do a "do-over" with the specialization RFC, and I think it's essential that we have some form of lattice-like specializaiton, though maybe not in the first iteration, yes</p>



<a name="274563794"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/315151-wg-traits/negative-impls/topic/specialization%20or%20negative%20impls%3F/near/274563794" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/315151-wg-traits/negative-impls/topic/specialization.20or.20negative.20impls.3F.html#274563794">(Mar 08 2022 at 16:16)</a>:</h4>
<p>(I've been digging a bit into some related research on default logics, but haven't gotten too far yet)</p>



<hr><p>Last updated: Apr 12 2022 at 20:01 UTC</p>
</html>