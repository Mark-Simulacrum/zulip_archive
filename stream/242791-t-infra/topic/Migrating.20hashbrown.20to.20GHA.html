<html>
<head><meta charset="utf-8"><title>Migrating hashbrown to GHA · t-infra · Zulip Chat Archive</title></head>
<h2>Stream: <a href="https://rust-lang.github.io/zulip_archive/stream/242791-t-infra/index.html">t-infra</a></h2>
<h3>Topic: <a href="https://rust-lang.github.io/zulip_archive/stream/242791-t-infra/topic/Migrating.20hashbrown.20to.20GHA.html">Migrating hashbrown to GHA</a></h3>

<hr>

<base href="https://rust-lang.zulipchat.com">

<head><link href="https://rust-lang.github.io/zulip_archive/style.css" rel="stylesheet"></head>

<a name="240462662"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/242791-t-infra/topic/Migrating%20hashbrown%20to%20GHA/near/240462662" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Amanieu <a href="https://rust-lang.github.io/zulip_archive/stream/242791-t-infra/topic/Migrating.20hashbrown.20to.20GHA.html#240462662">(May 27 2021 at 12:58)</a>:</h4>
<p>I'm currently migrating rust-lang/hashbrown to GHA from Travis. Could someone review <a href="https://github.com/rust-lang/hashbrown/pull/270">https://github.com/rust-lang/hashbrown/pull/270</a> to see if I'm missing anything or to suggest improvements?</p>



<a name="240468705"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/242791-t-infra/topic/Migrating%20hashbrown%20to%20GHA/near/240468705" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> flip1995 <a href="https://rust-lang.github.io/zulip_archive/stream/242791-t-infra/topic/Migrating.20hashbrown.20to.20GHA.html#240468705">(May 27 2021 at 13:40)</a>:</h4>
<p>For bors to work with GHA, you'll have to add something like this: <a href="https://github.com/rust-lang/rust-clippy/blob/5cb49bcb986f983d5d25a990b3ed92079d62efe6/.github/workflows/clippy_bors.yml#L249-L273">https://github.com/rust-lang/rust-clippy/blob/5cb49bcb986f983d5d25a990b3ed92079d62efe6/.github/workflows/clippy_bors.yml#L249-L273</a></p>



<a name="240468846"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/242791-t-infra/topic/Migrating%20hashbrown%20to%20GHA/near/240468846" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Pietro Albini <a href="https://rust-lang.github.io/zulip_archive/stream/242791-t-infra/topic/Migrating.20hashbrown.20to.20GHA.html#240468846">(May 27 2021 at 13:41)</a>:</h4>
<p>yeah, and then <a href="https://github.com/rust-lang/homu/blob/master/cfg.production.toml">https://github.com/rust-lang/homu/blob/master/cfg.production.toml</a> needs to be updated to listen for "bors build finished"</p>



<a name="240604453"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/242791-t-infra/topic/Migrating%20hashbrown%20to%20GHA/near/240604453" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Amanieu <a href="https://rust-lang.github.io/zulip_archive/stream/242791-t-infra/topic/Migrating.20hashbrown.20to.20GHA.html#240604453">(May 28 2021 at 13:35)</a>:</h4>
<p>Could someone merge <a href="https://github.com/rust-lang/homu/pull/143">https://github.com/rust-lang/homu/pull/143</a>?</p>



<a name="240605895"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/242791-t-infra/topic/Migrating%20hashbrown%20to%20GHA/near/240605895" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Pietro Albini <a href="https://rust-lang.github.io/zulip_archive/stream/242791-t-infra/topic/Migrating.20hashbrown.20to.20GHA.html#240605895">(May 28 2021 at 13:46)</a>:</h4>
<p>done!</p>



<a name="240607309"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/242791-t-infra/topic/Migrating%20hashbrown%20to%20GHA/near/240607309" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Amanieu <a href="https://rust-lang.github.io/zulip_archive/stream/242791-t-infra/topic/Migrating.20hashbrown.20to.20GHA.html#240607309">(May 28 2021 at 13:56)</a>:</h4>
<p>Thanks a lot for the help!</p>



<a name="240610235"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/242791-t-infra/topic/Migrating%20hashbrown%20to%20GHA/near/240610235" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Amanieu <a href="https://rust-lang.github.io/zulip_archive/stream/242791-t-infra/topic/Migrating.20hashbrown.20to.20GHA.html#240610235">(May 28 2021 at 14:18)</a>:</h4>
<p>Does homu need to be restarted to pick up the new configuration?</p>



<a name="240610352"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/242791-t-infra/topic/Migrating%20hashbrown%20to%20GHA/near/240610352" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Amanieu <a href="https://rust-lang.github.io/zulip_archive/stream/242791-t-infra/topic/Migrating.20hashbrown.20to.20GHA.html#240610352">(May 28 2021 at 14:19)</a>:</h4>
<p>It seems to not be picking up the action being finished: <a href="https://github.com/rust-lang/hashbrown/pull/270">https://github.com/rust-lang/hashbrown/pull/270</a> <a href="https://github.com/rust-lang/hashbrown/actions/runs/885814962">https://github.com/rust-lang/hashbrown/actions/runs/885814962</a></p>



<a name="240610985"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/242791-t-infra/topic/Migrating%20hashbrown%20to%20GHA/near/240610985" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> flip1995 <a href="https://rust-lang.github.io/zulip_archive/stream/242791-t-infra/topic/Migrating.20hashbrown.20to.20GHA.html#240610985">(May 28 2021 at 14:23)</a>:</h4>
<p>You named the dummy-bors-job "bors test finished", but in rust-lang/homu, you put <code>bors build finished</code> <a href="https://github.com/rust-lang/homu/blob/9b8efe5f5c231f98c83bc5b50acaf3a6d2511e48/cfg.production.toml#L308">here</a>. Changing that line to <code>bors test finished</code> or changing the workflow dummy job name to <code>bors build finished</code> should fix that.</p>



<a name="240611117"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/242791-t-infra/topic/Migrating%20hashbrown%20to%20GHA/near/240611117" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> flip1995 <a href="https://rust-lang.github.io/zulip_archive/stream/242791-t-infra/topic/Migrating.20hashbrown.20to.20GHA.html#240611117">(May 28 2021 at 14:24)</a>:</h4>
<p>If you should decide to rename the dummy job in the workflow file, remember to change both names, the success dummy job, as well as the failure dummy job.</p>



<a name="240612308"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/242791-t-infra/topic/Migrating%20hashbrown%20to%20GHA/near/240612308" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Amanieu <a href="https://rust-lang.github.io/zulip_archive/stream/242791-t-infra/topic/Migrating.20hashbrown.20to.20GHA.html#240612308">(May 28 2021 at 14:33)</a>:</h4>
<p>I see</p>



<a name="240614194"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/242791-t-infra/topic/Migrating%20hashbrown%20to%20GHA/near/240614194" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> flip1995 <a href="https://rust-lang.github.io/zulip_archive/stream/242791-t-infra/topic/Migrating.20hashbrown.20to.20GHA.html#240614194">(May 28 2021 at 14:47)</a>:</h4>
<p>What you also might want to consider is to restrict the number of jobs running on a PR vs on bors.  E.g. only run miri, clippy_fmt, and one permutation of OS+arch+compiler (e.g. x86 linux on stable). And then on the bors job run everything. I'm not sure what the capacity of the rust-lang GHAs currently is and if this matters for the org, though..</p>



<a name="240635485"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/242791-t-infra/topic/Migrating%20hashbrown%20to%20GHA/near/240635485" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nagisa <a href="https://rust-lang.github.io/zulip_archive/stream/242791-t-infra/topic/Migrating.20hashbrown.20to.20GHA.html#240635485">(May 28 2021 at 17:25)</a>:</h4>
<p>hashbrown checks take 3-4 minutes to run, I don't see much reason to limit tasks we run on pr vs bors.</p>



<hr><p>Last updated: Aug 07 2021 at 22:04 UTC</p>
</html>