<html>
<head><meta charset="utf-8"><title>symbolic links · t-infra · Zulip Chat Archive</title></head>
<h2>Stream: <a href="https://zulip-archive.rust-lang.org/stream/242791-t-infra/index.html">t-infra</a></h2>
<h3>Topic: <a href="https://zulip-archive.rust-lang.org/stream/242791-t-infra/topic/symbolic.20links.html">symbolic links</a></h3>

<hr>

<base href="https://rust-lang.zulipchat.com">

<head><link href="https://zulip-archive.rust-lang.org/style.css" rel="stylesheet"></head>

<a name="277923671"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/242791-t-infra/topic/symbolic%20links/near/277923671" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Eric Huss <a href="https://zulip-archive.rust-lang.org/stream/242791-t-infra/topic/symbolic.20links.html#277923671">(Apr 05 2022 at 18:29)</a>:</h4>
<p>Does anyone know if there would be any concerns with using symbolic links in the rust-lang/rust repository? My concern is that on Windows you have to have Developer Mode enabled for them to work, and git must have <code>core.symlinks</code> set to true.  These are enabled in GitHub Actions, but I'm concerned about developer environments and other distributors.</p>
<p>Currently there are some symlinks in <code>llvm-project</code> (and a few other unimportant places), but none of them are used by the rust build. So I think if cargo started using them, it would be the first instance where they are required.</p>



<a name="277928300"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/242791-t-infra/topic/symbolic%20links/near/277928300" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> The 8472 <a href="https://zulip-archive.rust-lang.org/stream/242791-t-infra/topic/symbolic.20links.html#277928300">(Apr 05 2022 at 19:00)</a>:</h4>
<p>I think we have had people file windows issues that implied they didn't have developer mode enabled.</p>



<a name="277928491"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/242791-t-infra/topic/symbolic%20links/near/277928491" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> The 8472 <a href="https://zulip-archive.rust-lang.org/stream/242791-t-infra/topic/symbolic.20links.html#277928491">(Apr 05 2022 at 19:01)</a>:</h4>
<p>And windows 7 is still supported, of sorts.</p>



<a name="277929439"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/242791-t-infra/topic/symbolic%20links/near/277929439" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Chris Denton <a href="https://zulip-archive.rust-lang.org/stream/242791-t-infra/topic/symbolic.20links.html#277929439">(Apr 05 2022 at 19:07)</a>:</h4>
<p>If we add symlinks I'd at least like some good documentation explaining how to set everything up on Windows. And what to do if people run into issues. Actually it might be useful to have this documentation either way.</p>



<a name="277929470"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/242791-t-infra/topic/symbolic%20links/near/277929470" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Chris Denton <a href="https://zulip-archive.rust-lang.org/stream/242791-t-infra/topic/symbolic.20links.html#277929470">(Apr 05 2022 at 19:07)</a>:</h4>
<blockquote>
<p>And windows 7 is still supported, of sorts.</p>
</blockquote>
<p>Hm, we support Windows 7 as a target but I'm not sure if we support it as a dev environment? I mean, we don't don't support it but...</p>



<a name="277935157"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/242791-t-infra/topic/symbolic%20links/near/277935157" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wesley Wiser <a href="https://zulip-archive.rust-lang.org/stream/242791-t-infra/topic/symbolic.20links.html#277935157">(Apr 05 2022 at 19:57)</a>:</h4>
<p><span class="user-mention" data-user-id="120518">@Eric Huss</span> could you expand a bit on how you want to use symbolic links? Is this about checking in content to our git repository that is a symbol link ("any concerns with using symbolic links in the rust-lang/rust repository")? Or is this about cargo using them somehow ("if cargo started using them, ...")?</p>



<a name="277935353"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/242791-t-infra/topic/symbolic%20links/near/277935353" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wesley Wiser <a href="https://zulip-archive.rust-lang.org/stream/242791-t-infra/topic/symbolic.20links.html#277935353">(Apr 05 2022 at 19:58)</a>:</h4>
<p>In general, I would be less concerned about the former than the later as the number of people contributing to rust-lang/rust is much smaller than the overall number of Rust developers.</p>



<a name="277935677"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/242791-t-infra/topic/symbolic%20links/near/277935677" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wesley Wiser <a href="https://zulip-archive.rust-lang.org/stream/242791-t-infra/topic/symbolic.20links.html#277935677">(Apr 05 2022 at 20:00)</a>:</h4>
<p>I'm pretty sure Developer Mode can be disabled via Group Policy settings so users in environments with a less-than-friendly IT department (which, frankly, is waaay too many developers) might not have the option to enable it at all.</p>



<a name="277943502"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/242791-t-infra/topic/symbolic%20links/near/277943502" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Eric Huss <a href="https://zulip-archive.rust-lang.org/stream/242791-t-infra/topic/symbolic.20links.html#277943502">(Apr 05 2022 at 21:07)</a>:</h4>
<p>Right now it is proposed for cargo's testsuite, checking the symlinks in directly to rust-lang/cargo. We are looking to add "snapshot" tests, which include hundreds of cargo projects. Some are identical, so they are added as symlinks to a shared project.  I think this would only affect someone running working on cargo itself or running <code>./x.py test src/tools/cargo</code>.</p>
<p>I suspect this is unlikely to be an issue for rust-lang/rust distributions. I would be surprised if there is anyone except the rust-lang CI running cargo's test suite on Windows.</p>
<p>I guess this is probably more of a concern for cargo contributors. I don't have a sense of how likely that would be a problem.  I seem to recall my default <code>core.symlinks</code> was false at some point, which has me a bit worried.  The docs say the current default is true.</p>



<a name="277976895"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/242791-t-infra/topic/symbolic%20links/near/277976895" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Josh Triplett <a href="https://zulip-archive.rust-lang.org/stream/242791-t-infra/topic/symbolic.20links.html#277976895">(Apr 06 2022 at 05:22)</a>:</h4>
<p>Do symlinks still require Developer Mode on Windows 11?</p>



<a name="277985659"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/242791-t-infra/topic/symbolic%20links/near/277985659" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Chris Denton <a href="https://zulip-archive.rust-lang.org/stream/242791-t-infra/topic/symbolic.20links.html#277985659">(Apr 06 2022 at 07:39)</a>:</h4>
<p>Yes, either Developer Mode has to be enabled or the user must have the <code>SeCreateSymbolicLinkPrivilege</code> privilege (which is only given to administrators by default). The reasoning given is that legacy applications may not securely handle symlinks.</p>



<a name="277985947"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/242791-t-infra/topic/symbolic%20links/near/277985947" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Pietro Albini <a href="https://zulip-archive.rust-lang.org/stream/242791-t-infra/topic/symbolic.20links.html#277985947">(Apr 06 2022 at 07:43)</a>:</h4>
<p><a href="https://github.com/rust-lang/rust/security/advisories/GHSA-r9cc-f5pr-p3j2">I mean...</a> <span aria-label="sweat smile" class="emoji emoji-1f605" role="img" title="sweat smile">:sweat_smile:</span></p>



<a name="278007041"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/242791-t-infra/topic/symbolic%20links/near/278007041" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Connor Horman <a href="https://zulip-archive.rust-lang.org/stream/242791-t-infra/topic/symbolic.20links.html#278007041">(Apr 06 2022 at 11:03)</a>:</h4>
<p><span class="user-mention silent" data-user-id="260325">Chris Denton</span> <a href="#narrow/stream/242791-t-infra/topic/symbolic.20links/near/277985659">said</a>:</p>
<blockquote>
<p>Yes, either Developer Mode has to be enabled or the user must have the <code>SeCreateSymbolicLinkPrivilege</code> privilege (which is only given to administrators by default). The reasoning given is that legacy applications may not securely handle symlinks.</p>
</blockquote>
<p>I don't think that's either confined to windows applications, or even legacy applications.</p>



<a name="278059524"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/242791-t-infra/topic/symbolic%20links/near/278059524" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wesley Wiser <a href="https://zulip-archive.rust-lang.org/stream/242791-t-infra/topic/symbolic.20links.html#278059524">(Apr 06 2022 at 17:37)</a>:</h4>
<p><span class="user-mention silent" data-user-id="120518">Eric Huss</span> <a href="#narrow/stream/242791-t-infra/topic/symbolic.20links/near/277943502">said</a>:</p>
<blockquote>
<p>Right now it is proposed for cargo's testsuite, checking the symlinks in directly to rust-lang/cargo. We are looking to add "snapshot" tests, which include hundreds of cargo projects. Some are identical, so they are added as symlinks to a shared project.  I think this would only affect someone running working on cargo itself or running <code>./x.py test src/tools/cargo</code>.</p>
</blockquote>
<p>Makes sense! Large-scale snapshot testing in cargo sounds like a really good idea and the use case fits very well. </p>
<blockquote>
<p>I guess this is probably more of a concern for cargo contributors. I don't have a sense of how likely that would be a problem.  I seem to recall my default <code>core.symlinks</code> was false at some point, which has me a bit worried.  The docs say the current default is true.</p>
</blockquote>
<p>At least based on a few things I've seen, it sounds like <code>core.symlinks</code> on Windows doesn't force the use of symlinks, it just allows the detection code to run. Ie: <code>core.symlinks = false</code> =&gt; never try to use symlinks, <code>core.symlinks = true</code> =&gt; test to see if symlinks can be used on this filesystem, Windows version, Dev Mode enabled, etc. </p>
<ul>
<li><a href="https://github.com/desktop/desktop/issues/7083">https://github.com/desktop/desktop/issues/7083</a></li>
<li><a href="https://stackoverflow.com/questions/58587005/why-does-git-clone-override-global-core-symlinks-on-windows">https://stackoverflow.com/questions/58587005/why-does-git-clone-override-global-core-symlinks-on-windows</a></li>
</ul>



<a name="278060417"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/242791-t-infra/topic/symbolic%20links/near/278060417" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Eric Huss <a href="https://zulip-archive.rust-lang.org/stream/242791-t-infra/topic/symbolic.20links.html#278060417">(Apr 06 2022 at 17:44)</a>:</h4>
<p>Thanks for the info!  <span class="user-mention" data-user-id="424212">@Ed Page</span> clarified that the snapshot tool will detect if symlinks are not enabled and will follow the file instead, which means this is probably a non-issue.  I think everything should "just work" even if they are disabled. Sorry for the noise, I didn't fully understand how it all works.</p>



<a name="278061001"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/242791-t-infra/topic/symbolic%20links/near/278061001" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wesley Wiser <a href="https://zulip-archive.rust-lang.org/stream/242791-t-infra/topic/symbolic.20links.html#278061001">(Apr 06 2022 at 17:49)</a>:</h4>
<p>No problem! I learned some new things myself <span aria-label="smile" class="emoji emoji-1f642" role="img" title="smile">:smile:</span></p>



<hr><p>Last updated: Apr 12 2022 at 20:01 UTC</p>
</html>