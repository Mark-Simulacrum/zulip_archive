<html>
<head><meta charset="utf-8"><title>promote-release · t-infra · Zulip Chat Archive</title></head>
<h2>Stream: <a href="https://zulip-archive.rust-lang.org/stream/242791-t-infra/index.html">t-infra</a></h2>
<h3>Topic: <a href="https://zulip-archive.rust-lang.org/stream/242791-t-infra/topic/promote-release.html">promote-release</a></h3>

<hr>

<base href="https://rust-lang.zulipchat.com">

<head><link href="https://zulip-archive.rust-lang.org/style.css" rel="stylesheet"></head>

<a name="209393429"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/242791-t-infra/topic/promote-release/near/209393429" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Pietro Albini <a href="https://zulip-archive.rust-lang.org/stream/242791-t-infra/topic/promote-release.html#209393429">(Sep 08 2020 at 14:26)</a>:</h4>
<p><span class="user-mention" data-user-id="116122">@simulacrum</span> fyi I'm splitting up <code>promote-release</code> out of the RCS repository and adding a way to run it locally without becoming crazy</p>



<a name="209393450"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/242791-t-infra/topic/promote-release/near/209393450" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> simulacrum <a href="https://zulip-archive.rust-lang.org/stream/242791-t-infra/topic/promote-release.html#209393450">(Sep 08 2020 at 14:26)</a>:</h4>
<p>okay</p>



<a name="209393662"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/242791-t-infra/topic/promote-release/near/209393662" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Pietro Albini <a href="https://zulip-archive.rust-lang.org/stream/242791-t-infra/topic/promote-release.html#209393662">(Sep 08 2020 at 14:28)</a>:</h4>
<p>the ideal outcome is that to run a release locally you can do:</p>
<div class="codehilite"><pre><span></span><code>cargo build
docker-compose up
docker-compose run local start
</code></pre></div>


<p>and you'd get a release at <code>http://localhost:9000/dist</code></p>



<a name="209393975"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/242791-t-infra/topic/promote-release/near/209393975" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> simulacrum <a href="https://zulip-archive.rust-lang.org/stream/242791-t-infra/topic/promote-release.html#209393975">(Sep 08 2020 at 14:29)</a>:</h4>
<p>wait, why do we need a web server</p>



<a name="209394063"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/242791-t-infra/topic/promote-release/near/209394063" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> simulacrum <a href="https://zulip-archive.rust-lang.org/stream/242791-t-infra/topic/promote-release.html#209394063">(Sep 08 2020 at 14:30)</a>:</h4>
<p>and docker? promote-release was rather simple</p>



<a name="209416274"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/242791-t-infra/topic/promote-release/near/209416274" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Pietro Albini <a href="https://zulip-archive.rust-lang.org/stream/242791-t-infra/topic/promote-release.html#209416274">(Sep 08 2020 at 17:11)</a>:</h4>
<p><span class="user-mention" data-user-id="116122">@simulacrum</span> well, promote-release would still be a normal rust binary, with very little changes to it</p>



<a name="209416317"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/242791-t-infra/topic/promote-release/near/209416317" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Pietro Albini <a href="https://zulip-archive.rust-lang.org/stream/242791-t-infra/topic/promote-release.html#209416317">(Sep 08 2020 at 17:11)</a>:</h4>
<p>but to test it locally without aws creds you need to at least have minio locally and configured properly, and a disposable gpg key</p>



<a name="209416351"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/242791-t-infra/topic/promote-release/near/209416351" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> simulacrum <a href="https://zulip-archive.rust-lang.org/stream/242791-t-infra/topic/promote-release.html#209416351">(Sep 08 2020 at 17:11)</a>:</h4>
<p>Ah, okay, I see</p>



<a name="209416364"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/242791-t-infra/topic/promote-release/near/209416364" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Pietro Albini <a href="https://zulip-archive.rust-lang.org/stream/242791-t-infra/topic/promote-release.html#209416364">(Sep 08 2020 at 17:11)</a>:</h4>
<p>and all of that is way easier to setup with docker :)</p>



<a name="209416369"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/242791-t-infra/topic/promote-release/near/209416369" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> simulacrum <a href="https://zulip-archive.rust-lang.org/stream/242791-t-infra/topic/promote-release.html#209416369">(Sep 08 2020 at 17:11)</a>:</h4>
<p>Then seems fine</p>



<a name="209416466"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/242791-t-infra/topic/promote-release/near/209416466" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Pietro Albini <a href="https://zulip-archive.rust-lang.org/stream/242791-t-infra/topic/promote-release.html#209416466">(Sep 08 2020 at 17:12)</a>:</h4>
<p>the web server is just minio :)</p>



<a name="210014648"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/242791-t-infra/topic/promote-release/near/210014648" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Pietro Albini <a href="https://zulip-archive.rust-lang.org/stream/242791-t-infra/topic/promote-release.html#210014648">(Sep 14 2020 at 14:41)</a>:</h4>
<p><span class="user-mention" data-user-id="116122">@simulacrum</span> would you be up to review some PRs to promote-release?</p>



<a name="210014701"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/242791-t-infra/topic/promote-release/near/210014701" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Pietro Albini <a href="https://zulip-archive.rust-lang.org/stream/242791-t-infra/topic/promote-release.html#210014701">(Sep 14 2020 at 14:41)</a>:</h4>
<p>I'm good merging the code to master myself, but I kinda prefer all code landing there to be reviewed by another person</p>



<a name="210014829"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/242791-t-infra/topic/promote-release/near/210014829" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Pietro Albini <a href="https://zulip-archive.rust-lang.org/stream/242791-t-infra/topic/promote-release.html#210014829">(Sep 14 2020 at 14:42)</a>:</h4>
<p>(this PR is mostly busywork, 2015-&gt;2018, "custom <code>try!</code>"-&gt;anyhow, toml::Value-&gt;serde::Deserialize)</p>



<a name="210015467"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/242791-t-infra/topic/promote-release/near/210015467" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> simulacrum <a href="https://zulip-archive.rust-lang.org/stream/242791-t-infra/topic/promote-release.html#210015467">(Sep 14 2020 at 14:46)</a>:</h4>
<p>yes I can do that</p>



<a name="210016792"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/242791-t-infra/topic/promote-release/near/210016792" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Pietro Albini <a href="https://zulip-archive.rust-lang.org/stream/242791-t-infra/topic/promote-release.html#210016792">(Sep 14 2020 at 14:53)</a>:</h4>
<p><span class="user-mention" data-user-id="116122">@simulacrum</span> <a href="https://github.com/rust-lang/promote-release/pull/1">https://github.com/rust-lang/promote-release/pull/1</a></p>



<a name="210053140"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/242791-t-infra/topic/promote-release/near/210053140" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Pietro Albini <a href="https://zulip-archive.rust-lang.org/stream/242791-t-infra/topic/promote-release.html#210053140">(Sep 14 2020 at 19:39)</a>:</h4>
<p><span class="user-mention" data-user-id="116122">@simulacrum</span> I'm wondering... now that we have the <code>rust-dev</code> component, could we dunno, upload a compiled <code>build-manifest</code> to it?</p>



<a name="210053196"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/242791-t-infra/topic/promote-release/near/210053196" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> simulacrum <a href="https://zulip-archive.rust-lang.org/stream/242791-t-infra/topic/promote-release.html#210053196">(Sep 14 2020 at 19:40)</a>:</h4>
<p>yeah we could</p>



<a name="210053204"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/242791-t-infra/topic/promote-release/near/210053204" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Pietro Albini <a href="https://zulip-archive.rust-lang.org/stream/242791-t-infra/topic/promote-release.html#210053204">(Sep 14 2020 at 19:40)</a>:</h4>
<p>it'd be extremely nice not to have to use <code>./x.py</code> in the release process</p>



<a name="210053238"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/242791-t-infra/topic/promote-release/near/210053238" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Pietro Albini <a href="https://zulip-archive.rust-lang.org/stream/242791-t-infra/topic/promote-release.html#210053238">(Sep 14 2020 at 19:40)</a>:</h4>
<p>besides, why is cmake required for a release :/</p>



<a name="210053249"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/242791-t-infra/topic/promote-release/near/210053249" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> simulacrum <a href="https://zulip-archive.rust-lang.org/stream/242791-t-infra/topic/promote-release.html#210053249">(Sep 14 2020 at 19:40)</a>:</h4>
<p>cmake is probably not</p>



<a name="210053272"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/242791-t-infra/topic/promote-release/near/210053272" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> simulacrum <a href="https://zulip-archive.rust-lang.org/stream/242791-t-infra/topic/promote-release.html#210053272">(Sep 14 2020 at 19:41)</a>:</h4>
<p>just x.py doesn't expect you to build (almost) nothing</p>



<a name="210053301"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/242791-t-infra/topic/promote-release/near/210053301" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> simulacrum <a href="https://zulip-archive.rust-lang.org/stream/242791-t-infra/topic/promote-release.html#210053301">(Sep 14 2020 at 19:41)</a>:</h4>
<p>I'd be fine with uploading it and downloading it directly</p>



<a name="210059132"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/242791-t-infra/topic/promote-release/near/210059132" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Pietro Albini <a href="https://zulip-archive.rust-lang.org/stream/242791-t-infra/topic/promote-release.html#210059132">(Sep 14 2020 at 20:32)</a>:</h4>
<p>is it intended that we're uploading both .gz and .xz to ci-artifacts.rlo?</p>



<a name="210059175"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/242791-t-infra/topic/promote-release/near/210059175" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Pietro Albini <a href="https://zulip-archive.rust-lang.org/stream/242791-t-infra/topic/promote-release.html#210059175">(Sep 14 2020 at 20:32)</a>:</h4>
<p>iirc that wasn't supposed to happen</p>



<a name="210062934"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/242791-t-infra/topic/promote-release/near/210062934" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Pietro Albini <a href="https://zulip-archive.rust-lang.org/stream/242791-t-infra/topic/promote-release.html#210062934">(Sep 14 2020 at 21:02)</a>:</h4>
<p>YAY I got a full release process working locally <span aria-label="tada" class="emoji emoji-1f389" role="img" title="tada">:tada:</span></p>



<a name="210062976"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/242791-t-infra/topic/promote-release/near/210062976" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Pietro Albini <a href="https://zulip-archive.rust-lang.org/stream/242791-t-infra/topic/promote-release.html#210062976">(Sep 14 2020 at 21:03)</a>:</h4>
<p>there are some quirks I need to iron out, but I hope/plan to send a PR tomorrow with the changes</p>



<a name="210066030"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/242791-t-infra/topic/promote-release/near/210066030" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> simulacrum <a href="https://zulip-archive.rust-lang.org/stream/242791-t-infra/topic/promote-release.html#210066030">(Sep 14 2020 at 21:33)</a>:</h4>
<p>yeah I think so</p>



<a name="210066036"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/242791-t-infra/topic/promote-release/near/210066036" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> simulacrum <a href="https://zulip-archive.rust-lang.org/stream/242791-t-infra/topic/promote-release.html#210066036">(Sep 14 2020 at 21:33)</a>:</h4>
<p>well, like, not <em>intended</em></p>



<a name="210066079"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/242791-t-infra/topic/promote-release/near/210066079" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> simulacrum <a href="https://zulip-archive.rust-lang.org/stream/242791-t-infra/topic/promote-release.html#210066079">(Sep 14 2020 at 21:34)</a>:</h4>
<p>but I don't think release promotion re-archives them?</p>



<a name="210066125"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/242791-t-infra/topic/promote-release/near/210066125" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> simulacrum <a href="https://zulip-archive.rust-lang.org/stream/242791-t-infra/topic/promote-release.html#210066125">(Sep 14 2020 at 21:34)</a>:</h4>
<p>/me should actually go look</p>



<a name="210066161"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/242791-t-infra/topic/promote-release/near/210066161" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> simulacrum <a href="https://zulip-archive.rust-lang.org/stream/242791-t-infra/topic/promote-release.html#210066161">(Sep 14 2020 at 21:34)</a>:</h4>
<p>oh hm, no it does <a href="https://github.com/rust-lang/promote-release/blob/master/src/main.rs#L337">https://github.com/rust-lang/promote-release/blob/master/src/main.rs#L337</a></p>



<a name="210066183"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/242791-t-infra/topic/promote-release/near/210066183" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> simulacrum <a href="https://zulip-archive.rust-lang.org/stream/242791-t-infra/topic/promote-release.html#210066183">(Sep 14 2020 at 21:34)</a>:</h4>
<p>yeah I don't know, we shouldn't technically depend on gzip in ci-artifacts</p>



<a name="210066219"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/242791-t-infra/topic/promote-release/near/210066219" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> simulacrum <a href="https://zulip-archive.rust-lang.org/stream/242791-t-infra/topic/promote-release.html#210066219">(Sep 14 2020 at 21:35)</a>:</h4>
<p>it'll save ~60% on size too probably</p>



<a name="210067298"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/242791-t-infra/topic/promote-release/near/210067298" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> simulacrum <a href="https://zulip-archive.rust-lang.org/stream/242791-t-infra/topic/promote-release.html#210067298">(Sep 14 2020 at 21:46)</a>:</h4>
<p>we probably want an announcement somewhere about this and we should consider it'll probably at least double the time our release promotion takes</p>



<a name="210095623"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/242791-t-infra/topic/promote-release/near/210095623" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Josh Triplett <a href="https://zulip-archive.rust-lang.org/stream/242791-t-infra/topic/promote-release.html#210095623">(Sep 15 2020 at 06:52)</a>:</h4>
<p><span class="user-mention" data-user-id="116122">@simulacrum</span> In an ideal world, we'd have <code>.gz</code> and <code>.zst</code>, since the latter compresses better than <code>xz</code>, and has much better performance.</p>



<a name="210099012"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/242791-t-infra/topic/promote-release/near/210099012" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Daniel Silverstone <a href="https://zulip-archive.rust-lang.org/stream/242791-t-infra/topic/promote-release.html#210099012">(Sep 15 2020 at 07:40)</a>:</h4>
<p>Should we look to adding zstd support to rustup so that it can be used in channels?</p>



<a name="210099542"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/242791-t-infra/topic/promote-release/near/210099542" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Josh Triplett <a href="https://zulip-archive.rust-lang.org/stream/242791-t-infra/topic/promote-release.html#210099542">(Sep 15 2020 at 07:47)</a>:</h4>
<p><span class="user-mention" data-user-id="223910">@Daniel Silverstone</span> Far be it from me to suggest that it should be a priority, but I think it should be on the todo list. :)</p>



<a name="210099595"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/242791-t-infra/topic/promote-release/near/210099595" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Josh Triplett <a href="https://zulip-archive.rust-lang.org/stream/242791-t-infra/topic/promote-release.html#210099595">(Sep 15 2020 at 07:47)</a>:</h4>
<p>It'd save decompression time, and give us the option of not putting a lot of CPU time into compressing random CI builds but spending a lot of time compressing release builds.</p>



<a name="210100521"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/242791-t-infra/topic/promote-release/near/210100521" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Daniel Silverstone <a href="https://zulip-archive.rust-lang.org/stream/242791-t-infra/topic/promote-release.html#210100521">(Sep 15 2020 at 07:58)</a>:</h4>
<p><span class="user-mention silent" data-user-id="239881">Josh Triplett</span> <a href="#narrow/stream/242791-t-infra/topic/promote-release/near/210099542">said</a>:</p>
<blockquote>
<p><span class="user-mention silent" data-user-id="223910">Daniel Silverstone</span> Far be it from me to suggest that it should be a priority, but I think it should be on the todo list. <span aria-label="smile" class="emoji emoji-1f642" role="img" title="smile">:smile:</span></p>
</blockquote>
<p>Looks like it is on the list to some extent -- <a href="https://github.com/rust-lang/rustup/issues/1858">https://github.com/rust-lang/rustup/issues/1858</a></p>
<p>Perhaps I should break out an "Add support for <code>.zst</code>" issue, and then once that's done, we can consider if there's a way to support detecting (or just expressing a preference) for which to donwload <span aria-label="grinning" class="emoji emoji-1f600" role="img" title="grinning">:grinning:</span></p>



<a name="210100882"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/242791-t-infra/topic/promote-release/near/210100882" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Josh Triplett <a href="https://zulip-archive.rust-lang.org/stream/242791-t-infra/topic/promote-release.html#210100882">(Sep 15 2020 at 08:02)</a>:</h4>
<p>That sounds reasonable. :)</p>



<a name="210101261"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/242791-t-infra/topic/promote-release/near/210101261" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Pietro Albini <a href="https://zulip-archive.rust-lang.org/stream/242791-t-infra/topic/promote-release.html#210101261">(Sep 15 2020 at 08:06)</a>:</h4>
<p>well, yes, but unless we want to remove <code>.xz</code> from new builds that would increase our storage costs a lot</p>



<a name="210101456"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/242791-t-infra/topic/promote-release/near/210101456" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Josh Triplett <a href="https://zulip-archive.rust-lang.org/stream/242791-t-infra/topic/promote-release.html#210101456">(Sep 15 2020 at 08:09)</a>:</h4>
<p><span class="user-mention" data-user-id="121055">@Pietro Albini</span> That wouldn't be as much of a problem if rustup switched to doing a self-update <em>before</em> doing a channel update.</p>



<a name="210101472"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/242791-t-infra/topic/promote-release/near/210101472" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Josh Triplett <a href="https://zulip-archive.rust-lang.org/stream/242791-t-infra/topic/promote-release.html#210101472">(Sep 15 2020 at 08:09)</a>:</h4>
<p>But in any case, it's something we could do eventually.</p>



<a name="210101555"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/242791-t-infra/topic/promote-release/near/210101555" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Josh Triplett <a href="https://zulip-archive.rust-lang.org/stream/242791-t-infra/topic/promote-release.html#210101555">(Sep 15 2020 at 08:10)</a>:</h4>
<p><span class="user-mention" data-user-id="121055">@Pietro Albini</span> Where's the script that does the actual creation of the <code>.xz</code> for a release?</p>



<a name="210101582"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/242791-t-infra/topic/promote-release/near/210101582" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Pietro Albini <a href="https://zulip-archive.rust-lang.org/stream/242791-t-infra/topic/promote-release.html#210101582">(Sep 15 2020 at 08:10)</a>:</h4>
<p>(isn't it really late there? <span aria-label="sweat smile" class="emoji emoji-1f605" role="img" title="sweat smile">:sweat_smile:</span>)</p>



<a name="210101617"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/242791-t-infra/topic/promote-release/near/210101617" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Pietro Albini <a href="https://zulip-archive.rust-lang.org/stream/242791-t-infra/topic/promote-release.html#210101617">(Sep 15 2020 at 08:11)</a>:</h4>
<p><span class="user-mention" data-user-id="239881">@Josh Triplett</span> somewhere in rustbuild</p>



<a name="210101651"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/242791-t-infra/topic/promote-release/near/210101651" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Pietro Albini <a href="https://zulip-archive.rust-lang.org/stream/242791-t-infra/topic/promote-release.html#210101651">(Sep 15 2020 at 08:11)</a>:</h4>
<p>simulacrum would know exactly where</p>



<a name="210102350"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/242791-t-infra/topic/promote-release/near/210102350" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Josh Triplett <a href="https://zulip-archive.rust-lang.org/stream/242791-t-infra/topic/promote-release.html#210102350">(Sep 15 2020 at 08:20)</a>:</h4>
<p>Quick informal side-by-side comparison on my laptop:</p>
<ul>
<li>gzip took 4.890s to decompress <code>rust-1.46.0-x86_64-unknown-linux-gnu.tar.gz</code></li>
<li>xz took 9.242s to decompress <code>rust-1.46.0-x86_64-unknown-linux-gnu.tar.xz</code></li>
<li>zstd took 0.890s to decompress <code>rust-1.46.0-x86_64-unknown-linux-gnu.tar.zst</code></li>
</ul>



<a name="210102531"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/242791-t-infra/topic/promote-release/near/210102531" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Josh Triplett <a href="https://zulip-archive.rust-lang.org/stream/242791-t-infra/topic/promote-release.html#210102531">(Sep 15 2020 at 08:22)</a>:</h4>
<p>Also, sizes:</p>
<ul>
<li>gzip: 220885103</li>
<li>xz: 127200200</li>
<li>zstd: 102771544</li>
</ul>



<a name="210103084"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/242791-t-infra/topic/promote-release/near/210103084" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Daniel Silverstone <a href="https://zulip-archive.rust-lang.org/stream/242791-t-infra/topic/promote-release.html#210103084">(Sep 15 2020 at 08:28)</a>:</h4>
<p><span class="user-mention silent" data-user-id="239881">Josh Triplett</span> <a href="#narrow/stream/242791-t-infra/topic/promote-release/near/210101456">said</a>:</p>
<blockquote>
<p><span class="user-mention silent" data-user-id="121055">Pietro Albini</span> That wouldn't be as much of a problem if rustup switched to doing a self-update <em>before</em> doing a channel update.</p>
</blockquote>
<p>It's hard to do that because on Windows we can't actually self-update without exiting the parent process (it's a total fuster-cluck of locking on Windows).</p>
<p>However if we got <code>.zst</code> support into the next release of rustup, it wouldn't be unreasonable to add support and perhaps drop the gzip. Dunno.  Rustup prefers <code>.xz</code> I believe, for network bandwidth reasons, so even non-updated systems likely wouldn't mind the loss of <code>.gz</code></p>



<a name="210103205"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/242791-t-infra/topic/promote-release/near/210103205" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Josh Triplett <a href="https://zulip-archive.rust-lang.org/stream/242791-t-infra/topic/promote-release.html#210103205">(Sep 15 2020 at 08:30)</a>:</h4>
<p>We could also drop the .gz from nightlies first, and keep them for a while for releases for anyone who might be using them.</p>



<a name="210103409"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/242791-t-infra/topic/promote-release/near/210103409" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Josh Triplett <a href="https://zulip-archive.rust-lang.org/stream/242791-t-infra/topic/promote-release.html#210103409">(Sep 15 2020 at 08:33)</a>:</h4>
<p><span class="user-mention" data-user-id="223910">@Daniel Silverstone</span> I'm familiar with that issue. I'm wondering, how feasible would it be for rustup on Windows to do an A/B scheme? <code>rustup.exe</code> does nothing except checking both <code>rustup-A.exe</code> and <code>rustup-B.exe</code> to see which is more up to date (if both exist) and runs whichever one is newer (or whichever one exists), and when self-updating, always write the one you aren't.</p>



<a name="210103485"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/242791-t-infra/topic/promote-release/near/210103485" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Josh Triplett <a href="https://zulip-archive.rust-lang.org/stream/242791-t-infra/topic/promote-release.html#210103485">(Sep 15 2020 at 08:34)</a>:</h4>
<p>And optionally, if you're up-to-date and newer than the other one, delete the other one to save space.</p>



<a name="210103543"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/242791-t-infra/topic/promote-release/near/210103543" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Josh Triplett <a href="https://zulip-archive.rust-lang.org/stream/242791-t-infra/topic/promote-release.html#210103543">(Sep 15 2020 at 08:35)</a>:</h4>
<p>(This is, in any case, getting off-topic for this topic, and should probably be moved to a topic on <code>rustup self-update</code>.)</p>



<a name="210103637"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/242791-t-infra/topic/promote-release/near/210103637" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Daniel Silverstone <a href="https://zulip-archive.rust-lang.org/stream/242791-t-infra/topic/promote-release.html#210103637">(Sep 15 2020 at 08:36)</a>:</h4>
<p>In the meantime, I've filed <a href="https://github.com/rust-lang/rustup/issues/2488">https://github.com/rust-lang/rustup/issues/2488</a> so you can link that in any proposal to add zstd compression to the channels <span aria-label="grinning" class="emoji emoji-1f600" role="img" title="grinning">:grinning:</span></p>



<a name="210143674"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/242791-t-infra/topic/promote-release/near/210143674" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> cuviper <a href="https://zulip-archive.rust-lang.org/stream/242791-t-infra/topic/promote-release.html#210143674">(Sep 15 2020 at 15:16)</a>:</h4>
<p><span class="user-mention" data-user-id="239881">@Josh Triplett</span> the tarballs are created by src/tools/rust-installer</p>



<a name="210143824"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/242791-t-infra/topic/promote-release/near/210143824" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> cuviper <a href="https://zulip-archive.rust-lang.org/stream/242791-t-infra/topic/promote-release.html#210143824">(Sep 15 2020 at 15:16)</a>:</h4>
<p>I guess src/tools/build-manifest also needs to reference the new files</p>



<a name="210270765"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/242791-t-infra/topic/promote-release/near/210270765" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Pietro Albini <a href="https://zulip-archive.rust-lang.org/stream/242791-t-infra/topic/promote-release.html#210270765">(Sep 16 2020 at 14:36)</a>:</h4>
<p>opened a PR to be able to run the release process locally: <a href="https://github.com/rust-lang/promote-release/pull/2">https://github.com/rust-lang/promote-release/pull/2</a></p>



<a name="210270798"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/242791-t-infra/topic/promote-release/near/210270798" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Pietro Albini <a href="https://zulip-archive.rust-lang.org/stream/242791-t-infra/topic/promote-release.html#210270798">(Sep 16 2020 at 14:36)</a>:</h4>
<p><span class="user-mention" data-user-id="116122">@simulacrum</span> it'd also be nice to know if it actually works away from my computer</p>



<a name="210270824"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/242791-t-infra/topic/promote-release/near/210270824" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> simulacrum <a href="https://zulip-archive.rust-lang.org/stream/242791-t-infra/topic/promote-release.html#210270824">(Sep 16 2020 at 14:36)</a>:</h4>
<p>I can try and run it</p>



<a name="210270849"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/242791-t-infra/topic/promote-release/near/210270849" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Pietro Albini <a href="https://zulip-archive.rust-lang.org/stream/242791-t-infra/topic/promote-release.html#210270849">(Sep 16 2020 at 14:36)</a>:</h4>
<p>thanks <span aria-label="heart" class="emoji emoji-2764" role="img" title="heart">:heart:</span></p>



<a name="210271647"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/242791-t-infra/topic/promote-release/near/210271647" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> simulacrum <a href="https://zulip-archive.rust-lang.org/stream/242791-t-infra/topic/promote-release.html#210271647">(Sep 16 2020 at 14:41)</a>:</h4>
<p><span class="user-mention" data-user-id="121055">@Pietro Albini</span> hm, can I access minio in the browser? Do we dump access/secret keys somewhere?</p>



<a name="210271691"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/242791-t-infra/topic/promote-release/near/210271691" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Pietro Albini <a href="https://zulip-archive.rust-lang.org/stream/242791-t-infra/topic/promote-release.html#210271691">(Sep 16 2020 at 14:41)</a>:</h4>
<p><span class="user-mention" data-user-id="116122">@simulacrum</span> yes, you can access it</p>



<a name="210271708"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/242791-t-infra/topic/promote-release/near/210271708" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Pietro Albini <a href="https://zulip-archive.rust-lang.org/stream/242791-t-infra/topic/promote-release.html#210271708">(Sep 16 2020 at 14:41)</a>:</h4>
<p><a href="http://localhost:9000">http://localhost:9000</a></p>



<a name="210271739"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/242791-t-infra/topic/promote-release/near/210271739" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Pietro Albini <a href="https://zulip-archive.rust-lang.org/stream/242791-t-infra/topic/promote-release.html#210271739">(Sep 16 2020 at 14:42)</a>:</h4>
<p>access_key / secret_key</p>



<a name="210271789"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/242791-t-infra/topic/promote-release/near/210271789" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Pietro Albini <a href="https://zulip-archive.rust-lang.org/stream/242791-t-infra/topic/promote-release.html#210271789">(Sep 16 2020 at 14:42)</a>:</h4>
<p>I should probably show them somewhere</p>



<a name="210271823"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/242791-t-infra/topic/promote-release/near/210271823" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> simulacrum <a href="https://zulip-archive.rust-lang.org/stream/242791-t-infra/topic/promote-release.html#210271823">(Sep 16 2020 at 14:42)</a>:</h4>
<p>maybe we can just disable the login?</p>



<a name="210271839"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/242791-t-infra/topic/promote-release/near/210271839" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> simulacrum <a href="https://zulip-archive.rust-lang.org/stream/242791-t-infra/topic/promote-release.html#210271839">(Sep 16 2020 at 14:42)</a>:</h4>
<p>seems to be working though</p>



<a name="210271883"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/242791-t-infra/topic/promote-release/near/210271883" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Pietro Albini <a href="https://zulip-archive.rust-lang.org/stream/242791-t-infra/topic/promote-release.html#210271883">(Sep 16 2020 at 14:42)</a>:</h4>
<p><span aria-label="tada" class="emoji emoji-1f389" role="img" title="tada">:tada:</span></p>



<a name="210271918"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/242791-t-infra/topic/promote-release/near/210271918" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> simulacrum <a href="https://zulip-archive.rust-lang.org/stream/242791-t-infra/topic/promote-release.html#210271918">(Sep 16 2020 at 14:43)</a>:</h4>
<p>I'll review the PR in detail later</p>



<a name="210271929"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/242791-t-infra/topic/promote-release/near/210271929" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Pietro Albini <a href="https://zulip-archive.rust-lang.org/stream/242791-t-infra/topic/promote-release.html#210271929">(Sep 16 2020 at 14:43)</a>:</h4>
<p>this will be so useful when making changes to promote-release</p>



<a name="210278535"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/242791-t-infra/topic/promote-release/near/210278535" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Pietro Albini <a href="https://zulip-archive.rust-lang.org/stream/242791-t-infra/topic/promote-release.html#210278535">(Sep 16 2020 at 15:26)</a>:</h4>
<p><span class="user-mention silent" data-user-id="116122">simulacrum</span> <a href="#narrow/stream/242791-t-infra/topic/promote-release/near/210271823">said</a>:</p>
<blockquote>
<p>maybe we can just disable the login?</p>
</blockquote>
<p>unfortunately we can't</p>



<a name="210278546"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/242791-t-infra/topic/promote-release/near/210278546" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Pietro Albini <a href="https://zulip-archive.rust-lang.org/stream/242791-t-infra/topic/promote-release.html#210278546">(Sep 16 2020 at 15:26)</a>:</h4>
<p>I'll add documentation though</p>



<a name="211270807"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/242791-t-infra/topic/promote-release/near/211270807" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Pietro Albini <a href="https://zulip-archive.rust-lang.org/stream/242791-t-infra/topic/promote-release.html#211270807">(Sep 25 2020 at 15:11)</a>:</h4>
<p><span class="user-mention" data-user-id="116122">@simulacrum</span> did a rough plan on how we could migrate <code>promote-release</code> away from RCS, now that we can't really use autograph anymore</p>



<a name="211270823"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/242791-t-infra/topic/promote-release/near/211270823" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Pietro Albini <a href="https://zulip-archive.rust-lang.org/stream/242791-t-infra/topic/promote-release.html#211270823">(Sep 25 2020 at 15:11)</a>:</h4>
<p><a href="https://paper.dropbox.com/doc/Release-process-change--A8SJRA_PpB~vTHOO_HlsQKQ_Ag-jwX9rKZj4QXydvwHGMcoD">https://paper.dropbox.com/doc/Release-process-change--A8SJRA_PpB~vTHOO_HlsQKQ_Ag-jwX9rKZj4QXydvwHGMcoD</a></p>



<a name="211270830"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/242791-t-infra/topic/promote-release/near/211270830" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Pietro Albini <a href="https://zulip-archive.rust-lang.org/stream/242791-t-infra/topic/promote-release.html#211270830">(Sep 25 2020 at 15:11)</a>:</h4>
<p>the setup for storing the gpg key might be overkill <em>shrugs</em></p>



<a name="211271553"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/242791-t-infra/topic/promote-release/near/211271553" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Pietro Albini <a href="https://zulip-archive.rust-lang.org/stream/242791-t-infra/topic/promote-release.html#211271553">(Sep 25 2020 at 15:17)</a>:</h4>
<p><span class="user-mention" data-user-id="116122">@simulacrum</span> re: ecs/efs, the problem with that is IO bandwidth</p>



<a name="211271619"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/242791-t-infra/topic/promote-release/near/211271619" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Pietro Albini <a href="https://zulip-archive.rust-lang.org/stream/242791-t-infra/topic/promote-release.html#211271619">(Sep 25 2020 at 15:17)</a>:</h4>
<p>efs bases that on the amount of data you store, and last time I looked at it we'd get like &lt;1MB/s with the amount of data we plan to write to that filesystem</p>



<a name="211271662"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/242791-t-infra/topic/promote-release/near/211271662" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Pietro Albini <a href="https://zulip-archive.rust-lang.org/stream/242791-t-infra/topic/promote-release.html#211271662">(Sep 25 2020 at 15:17)</a>:</h4>
<p><a href="/user_uploads/4715/7fbTXVl3j-jxT7dRmfzGbx49/2020-09-25-17-17-38.png">2020-09-25-17-17-38.png</a> <br>
and this is how much IO we have during a release</p>
<div class="message_inline_image"><a href="/user_uploads/4715/7fbTXVl3j-jxT7dRmfzGbx49/2020-09-25-17-17-38.png" title="2020-09-25-17-17-38.png"><img src="/user_uploads/4715/7fbTXVl3j-jxT7dRmfzGbx49/2020-09-25-17-17-38.png"></a></div>



<a name="211271788"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/242791-t-infra/topic/promote-release/near/211271788" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> simulacrum <a href="https://zulip-archive.rust-lang.org/stream/242791-t-infra/topic/promote-release.html#211271788">(Sep 25 2020 at 15:18)</a>:</h4>
<p>AWS claims throughput is high (10+ GB/s) but I don't know how true that is</p>



<a name="211271818"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/242791-t-infra/topic/promote-release/near/211271818" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> simulacrum <a href="https://zulip-archive.rust-lang.org/stream/242791-t-infra/topic/promote-release.html#211271818">(Sep 25 2020 at 15:18)</a>:</h4>
<p>oh I guess you need enormous file systems for that</p>



<a name="211271838"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/242791-t-infra/topic/promote-release/near/211271838" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> simulacrum <a href="https://zulip-archive.rust-lang.org/stream/242791-t-infra/topic/promote-release.html#211271838">(Sep 25 2020 at 15:19)</a>:</h4>
<div class="codehilite"><pre><span></span><code>Burst to 100 MiB/s for up to 72 minutes each day, or
Drive up to 5 MiB/s continuously
</code></pre></div>



<a name="211271859"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/242791-t-infra/topic/promote-release/near/211271859" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> simulacrum <a href="https://zulip-archive.rust-lang.org/stream/242791-t-infra/topic/promote-release.html#211271859">(Sep 25 2020 at 15:19)</a>:</h4>
<p>for 100GB</p>



<a name="211271872"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/242791-t-infra/topic/promote-release/near/211271872" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> simulacrum <a href="https://zulip-archive.rust-lang.org/stream/242791-t-infra/topic/promote-release.html#211271872">(Sep 25 2020 at 15:19)</a>:</h4>
<p>okay let's just go with codebuild for now</p>



<a name="211271889"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/242791-t-infra/topic/promote-release/near/211271889" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Pietro Albini <a href="https://zulip-archive.rust-lang.org/stream/242791-t-infra/topic/promote-release.html#211271889">(Sep 25 2020 at 15:19)</a>:</h4>
<p>yep that's the problem</p>



<a name="211272058"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/242791-t-infra/topic/promote-release/near/211272058" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> simulacrum <a href="https://zulip-archive.rust-lang.org/stream/242791-t-infra/topic/promote-release.html#211272058">(Sep 25 2020 at 15:20)</a>:</h4>
<p>yeah seems fine</p>



<a name="211272069"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/242791-t-infra/topic/promote-release/near/211272069" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> simulacrum <a href="https://zulip-archive.rust-lang.org/stream/242791-t-infra/topic/promote-release.html#211272069">(Sep 25 2020 at 15:20)</a>:</h4>
<p>modulo the lambda function but I don't care <em>too</em> much about it</p>



<a name="211272223"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/242791-t-infra/topic/promote-release/near/211272223" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Pietro Albini <a href="https://zulip-archive.rust-lang.org/stream/242791-t-infra/topic/promote-release.html#211272223">(Sep 25 2020 at 15:22)</a>:</h4>
<p>so, the lambda function is for the dev-stable release</p>



<a name="211272282"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/242791-t-infra/topic/promote-release/near/211272282" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Pietro Albini <a href="https://zulip-archive.rust-lang.org/stream/242791-t-infra/topic/promote-release.html#211272282">(Sep 25 2020 at 15:22)</a>:</h4>
<p>which currently runs every hour</p>



<a name="211272344"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/242791-t-infra/topic/promote-release/near/211272344" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> simulacrum <a href="https://zulip-archive.rust-lang.org/stream/242791-t-infra/topic/promote-release.html#211272344">(Sep 25 2020 at 15:22)</a>:</h4>
<p>so how expensive would spinning up the codebuild thing for ~1 minute be ?</p>



<a name="211272423"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/242791-t-infra/topic/promote-release/near/211272423" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> simulacrum <a href="https://zulip-archive.rust-lang.org/stream/242791-t-infra/topic/promote-release.html#211272423">(Sep 25 2020 at 15:23)</a>:</h4>
<p>or even just maintaining a fargate tiny task that has nothing but a cronjob for now</p>



<a name="211272465"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/242791-t-infra/topic/promote-release/near/211272465" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Pietro Albini <a href="https://zulip-archive.rust-lang.org/stream/242791-t-infra/topic/promote-release.html#211272465">(Sep 25 2020 at 15:23)</a>:</h4>
<p><a href="https://aws.amazon.com/codebuild/pricing/">https://aws.amazon.com/codebuild/pricing/</a></p>



<a name="211272475"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/242791-t-infra/topic/promote-release/near/211272475" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> simulacrum <a href="https://zulip-archive.rust-lang.org/stream/242791-t-infra/topic/promote-release.html#211272475">(Sep 25 2020 at 15:23)</a>:</h4>
<p>like, I'm just worried that there's additional complexity here that doesn't seem really necessary</p>



<a name="211272487"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/242791-t-infra/topic/promote-release/near/211272487" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> simulacrum <a href="https://zulip-archive.rust-lang.org/stream/242791-t-infra/topic/promote-release.html#211272487">(Sep 25 2020 at 15:23)</a>:</h4>
<p>(another alternative is github actions triggering it)</p>



<a name="211272507"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/242791-t-infra/topic/promote-release/near/211272507" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> simulacrum <a href="https://zulip-archive.rust-lang.org/stream/242791-t-infra/topic/promote-release.html#211272507">(Sep 25 2020 at 15:23)</a>:</h4>
<p>lambda functions are just very opaque compared to docker containers anyone can run imo</p>



<a name="211272515"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/242791-t-infra/topic/promote-release/near/211272515" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Pietro Albini <a href="https://zulip-archive.rust-lang.org/stream/242791-t-infra/topic/promote-release.html#211272515">(Sep 25 2020 at 15:23)</a>:</h4>
<p>yeah I was thinking about that</p>



<a name="211272684"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/242791-t-infra/topic/promote-release/near/211272684" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> simulacrum <a href="https://zulip-archive.rust-lang.org/stream/242791-t-infra/topic/promote-release.html#211272684">(Sep 25 2020 at 15:25)</a>:</h4>
<p>but realistically, presuming we can run for around a minute to detect whether we need a build, on the general.large type, it'll take $15/month by my accounting</p>



<a name="211272730"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/242791-t-infra/topic/promote-release/near/211272730" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> simulacrum <a href="https://zulip-archive.rust-lang.org/stream/242791-t-infra/topic/promote-release.html#211272730">(Sep 25 2020 at 15:25)</a>:</h4>
<p>but maybe that's too optimistic</p>



<a name="211272773"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/242791-t-infra/topic/promote-release/near/211272773" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Pietro Albini <a href="https://zulip-archive.rust-lang.org/stream/242791-t-infra/topic/promote-release.html#211272773">(Sep 25 2020 at 15:25)</a>:</h4>
<p>I think to download the docker image and do a full clone of rust-lang/rust it might take more</p>



<a name="211272847"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/242791-t-infra/topic/promote-release/near/211272847" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Pietro Albini <a href="https://zulip-archive.rust-lang.org/stream/242791-t-infra/topic/promote-release.html#211272847">(Sep 25 2020 at 15:26)</a>:</h4>
<p>(granted, we could change promote-release not do to that clone for the check)</p>



<a name="211272903"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/242791-t-infra/topic/promote-release/near/211272903" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> simulacrum <a href="https://zulip-archive.rust-lang.org/stream/242791-t-infra/topic/promote-release.html#211272903">(Sep 25 2020 at 15:26)</a>:</h4>
<p>I'm just against an opaque lambda that's not in our version control</p>



<a name="211272921"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/242791-t-infra/topic/promote-release/near/211272921" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Pietro Albini <a href="https://zulip-archive.rust-lang.org/stream/242791-t-infra/topic/promote-release.html#211272921">(Sep 25 2020 at 15:26)</a>:</h4>
<p>oh the lambda would be on version control</p>



<a name="211272951"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/242791-t-infra/topic/promote-release/near/211272951" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> simulacrum <a href="https://zulip-archive.rust-lang.org/stream/242791-t-infra/topic/promote-release.html#211272951">(Sep 25 2020 at 15:26)</a>:</h4>
<p>like, I want it in promote-release repo or simpleinfra or something</p>



<a name="211272974"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/242791-t-infra/topic/promote-release/near/211272974" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Pietro Albini <a href="https://zulip-archive.rust-lang.org/stream/242791-t-infra/topic/promote-release.html#211272974">(Sep 25 2020 at 15:27)</a>:</h4>
<p>for example <a href="https://github.com/rust-lang/simpleinfra/blob/master/terraform/team-repo/lambdas/start-sync-team/index.js">https://github.com/rust-lang/simpleinfra/blob/master/terraform/team-repo/lambdas/start-sync-team/index.js</a></p>



<a name="211273016"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/242791-t-infra/topic/promote-release/near/211273016" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> simulacrum <a href="https://zulip-archive.rust-lang.org/stream/242791-t-infra/topic/promote-release.html#211273016">(Sep 25 2020 at 15:27)</a>:</h4>
<p>okay if it's <em>that</em> simple then I'm fine with it</p>



<a name="211273023"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/242791-t-infra/topic/promote-release/near/211273023" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> simulacrum <a href="https://zulip-archive.rust-lang.org/stream/242791-t-infra/topic/promote-release.html#211273023">(Sep 25 2020 at 15:27)</a>:</h4>
<p>I expected a lot more</p>



<a name="211273190"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/242791-t-infra/topic/promote-release/near/211273190" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Pietro Albini <a href="https://zulip-archive.rust-lang.org/stream/242791-t-infra/topic/promote-release.html#211273190">(Sep 25 2020 at 15:28)</a>:</h4>
<p>this one doesn't do any checking, it just starts the codebuild</p>



<a name="211273306"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/242791-t-infra/topic/promote-release/near/211273306" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> simulacrum <a href="https://zulip-archive.rust-lang.org/stream/242791-t-infra/topic/promote-release.html#211273306">(Sep 25 2020 at 15:29)</a>:</h4>
<p>I think we should try to do it via lambda, you seem confident in that approach, and we can migrate to something else if that ends up being painful</p>



<a name="211273368"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/242791-t-infra/topic/promote-release/near/211273368" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Pietro Albini <a href="https://zulip-archive.rust-lang.org/stream/242791-t-infra/topic/promote-release.html#211273368">(Sep 25 2020 at 15:29)</a>:</h4>
<p><span aria-label="thumbs up" class="emoji emoji-1f44d" role="img" title="thumbs up">:thumbs_up:</span></p>



<a name="211273456"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/242791-t-infra/topic/promote-release/near/211273456" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Pietro Albini <a href="https://zulip-archive.rust-lang.org/stream/242791-t-infra/topic/promote-release.html#211273456">(Sep 25 2020 at 15:30)</a>:</h4>
<p><span class="user-mention" data-user-id="116122">@simulacrum</span> actually, there are two variants:</p>
<ul>
<li>have github actions invoke a lambda when a new commit is pushed to stable</li>
<li>run the lambda every n minutes</li>
</ul>



<a name="211273543"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/242791-t-infra/topic/promote-release/near/211273543" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> simulacrum <a href="https://zulip-archive.rust-lang.org/stream/242791-t-infra/topic/promote-release.html#211273543">(Sep 25 2020 at 15:30)</a>:</h4>
<p>I'd prefer to just run it every N, less moving parts</p>



<a name="211273550"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/242791-t-infra/topic/promote-release/near/211273550" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Pietro Albini <a href="https://zulip-archive.rust-lang.org/stream/242791-t-infra/topic/promote-release.html#211273550">(Sep 25 2020 at 15:30)</a>:</h4>
<p>yeah</p>



<a name="211273580"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/242791-t-infra/topic/promote-release/near/211273580" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Pietro Albini <a href="https://zulip-archive.rust-lang.org/stream/242791-t-infra/topic/promote-release.html#211273580">(Sep 25 2020 at 15:30)</a>:</h4>
<p>if we move the check to the lambda we could run it like every 5 or 15 minutes</p>



<a name="211273644"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/242791-t-infra/topic/promote-release/near/211273644" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> simulacrum <a href="https://zulip-archive.rust-lang.org/stream/242791-t-infra/topic/promote-release.html#211273644">(Sep 25 2020 at 15:31)</a>:</h4>
<p>(fwiw I'd be totally fine manually triggering dev-static builds too, or kicking it on triagebot, but I think it's super cheap for lambda to run quite often)</p>



<a name="211688294"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/242791-t-infra/topic/promote-release/near/211688294" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Pietro Albini <a href="https://zulip-archive.rust-lang.org/stream/242791-t-infra/topic/promote-release.html#211688294">(Sep 29 2020 at 21:41)</a>:</h4>
<p><span class="user-mention" data-user-id="116122">@simulacrum</span> hmm, is this much fallout expected from changing the channel? <a href="https://github.com/rust-lang/rust/pull/77336">https://github.com/rust-lang/rust/pull/77336</a></p>



<a name="211688335"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/242791-t-infra/topic/promote-release/near/211688335" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Pietro Albini <a href="https://zulip-archive.rust-lang.org/stream/242791-t-infra/topic/promote-release.html#211688335">(Sep 29 2020 at 21:41)</a>:</h4>
<p>the change in that PR will only appear and affect stable</p>



<a name="211688343"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/242791-t-infra/topic/promote-release/near/211688343" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Pietro Albini <a href="https://zulip-archive.rust-lang.org/stream/242791-t-infra/topic/promote-release.html#211688343">(Sep 29 2020 at 21:41)</a>:</h4>
<p>and I'd love to test it before... well... stable</p>



<a name="211688398"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/242791-t-infra/topic/promote-release/near/211688398" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> simulacrum <a href="https://zulip-archive.rust-lang.org/stream/242791-t-infra/topic/promote-release.html#211688398">(Sep 29 2020 at 21:42)</a>:</h4>
<p>hm what fallout are you talking about?</p>



<a name="211688448"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/242791-t-infra/topic/promote-release/near/211688448" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Pietro Albini <a href="https://zulip-archive.rust-lang.org/stream/242791-t-infra/topic/promote-release.html#211688448">(Sep 29 2020 at 21:42)</a>:</h4>
<p>the CI failures</p>



<a name="211688472"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/242791-t-infra/topic/promote-release/near/211688472" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Pietro Albini <a href="https://zulip-archive.rust-lang.org/stream/242791-t-infra/topic/promote-release.html#211688472">(Sep 29 2020 at 21:42)</a>:</h4>
<p>both for the try build and the PR build</p>



<a name="211688559"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/242791-t-infra/topic/promote-release/near/211688559" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> simulacrum <a href="https://zulip-archive.rust-lang.org/stream/242791-t-infra/topic/promote-release.html#211688559">(Sep 29 2020 at 21:43)</a>:</h4>
<p>I would not expect any fallout from that pr...</p>



<a name="211688717"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/242791-t-infra/topic/promote-release/near/211688717" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> simulacrum <a href="https://zulip-archive.rust-lang.org/stream/242791-t-infra/topic/promote-release.html#211688717">(Sep 29 2020 at 21:44)</a>:</h4>
<p>PR failure looks ... weird? maybe a rebase bug or something?</p>



<a name="211688749"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/242791-t-infra/topic/promote-release/near/211688749" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> simulacrum <a href="https://zulip-archive.rust-lang.org/stream/242791-t-infra/topic/promote-release.html#211688749">(Sep 29 2020 at 21:45)</a>:</h4>
<p>like, the changes in this PR shouldn't cause random ui tests to change spans</p>



<a name="211688765"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/242791-t-infra/topic/promote-release/near/211688765" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> simulacrum <a href="https://zulip-archive.rust-lang.org/stream/242791-t-infra/topic/promote-release.html#211688765">(Sep 29 2020 at 21:45)</a>:</h4>
<p>and the try build failed because rls is failing tests I guess?</p>



<a name="211688795"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/242791-t-infra/topic/promote-release/near/211688795" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> simulacrum <a href="https://zulip-archive.rust-lang.org/stream/242791-t-infra/topic/promote-release.html#211688795">(Sep 29 2020 at 21:45)</a>:</h4>
<p>which is actually a problem given we're t-1 week from release, roughyl</p>



<a name="211688799"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/242791-t-infra/topic/promote-release/near/211688799" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> simulacrum <a href="https://zulip-archive.rust-lang.org/stream/242791-t-infra/topic/promote-release.html#211688799">(Sep 29 2020 at 21:45)</a>:</h4>
<p>er, failing to build</p>



<a name="211688866"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/242791-t-infra/topic/promote-release/near/211688866" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Pietro Albini <a href="https://zulip-archive.rust-lang.org/stream/242791-t-infra/topic/promote-release.html#211688866">(Sep 29 2020 at 21:46)</a>:</h4>
<p>oh yeah rls failing tests</p>



<a name="211688871"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/242791-t-infra/topic/promote-release/near/211688871" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Pietro Albini <a href="https://zulip-archive.rust-lang.org/stream/242791-t-infra/topic/promote-release.html#211688871">(Sep 29 2020 at 21:46)</a>:</h4>
<p>I forgot about toolstate</p>



<a name="211688876"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/242791-t-infra/topic/promote-release/near/211688876" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Pietro Albini <a href="https://zulip-archive.rust-lang.org/stream/242791-t-infra/topic/promote-release.html#211688876">(Sep 29 2020 at 21:46)</a>:</h4>
<p>whelp it's late here</p>



<a name="211688910"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/242791-t-infra/topic/promote-release/near/211688910" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> simulacrum <a href="https://zulip-archive.rust-lang.org/stream/242791-t-infra/topic/promote-release.html#211688910">(Sep 29 2020 at 21:46)</a>:</h4>
<p>I would try to duplicate the pr builder failure on a separate pr that just adjusts the channel, I suspect pre-existing bug</p>



<a name="211745771"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/242791-t-infra/topic/promote-release/near/211745771" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Pietro Albini <a href="https://zulip-archive.rust-lang.org/stream/242791-t-infra/topic/promote-release.html#211745771">(Sep 30 2020 at 11:24)</a>:</h4>
<p>YAY we got a dev-static nightly release running on CodeBuild <span aria-label="tada" class="emoji emoji-1f389" role="img" title="tada">:tada:</span></p>



<a name="212063241"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/242791-t-infra/topic/promote-release/near/212063241" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Pietro Albini <a href="https://zulip-archive.rust-lang.org/stream/242791-t-infra/topic/promote-release.html#212063241">(Oct 02 2020 at 11:44)</a>:</h4>
<p>configured aws to run promote-release dev nightly in cron every day</p>



<a name="212063243"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/242791-t-infra/topic/promote-release/near/212063243" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Pietro Albini <a href="https://zulip-archive.rust-lang.org/stream/242791-t-infra/topic/promote-release.html#212063243">(Oct 02 2020 at 11:44)</a>:</h4>
<p><a href="https://github.com/rust-lang/simpleinfra/blob/9c0d3a445aea6ae7d3b85a29279a3b58414fac91/terraform/releases/environments.tf#L23-L25">https://github.com/rust-lang/simpleinfra/blob/9c0d3a445aea6ae7d3b85a29279a3b58414fac91/terraform/releases/environments.tf#L23-L25</a></p>



<a name="212063293"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/242791-t-infra/topic/promote-release/near/212063293" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Pietro Albini <a href="https://zulip-archive.rust-lang.org/stream/242791-t-infra/topic/promote-release.html#212063293">(Oct 02 2020 at 11:45)</a>:</h4>
<p>if tonight this works, I'm tempted to start switching all releases to go through the new setup</p>



<a name="212081438"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/242791-t-infra/topic/promote-release/near/212081438" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Nelson <a href="https://zulip-archive.rust-lang.org/stream/242791-t-infra/topic/promote-release.html#212081438">(Oct 02 2020 at 14:27)</a>:</h4>
<p>how does it work currently?</p>



<a name="212542142"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/242791-t-infra/topic/promote-release/near/212542142" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Pietro Albini <a href="https://zulip-archive.rust-lang.org/stream/242791-t-infra/topic/promote-release.html#212542142">(Oct 07 2020 at 11:00)</a>:</h4>
<p><span class="user-mention" data-user-id="232545">@Joshua Nelson</span> right now there is plan cron on the RCS server</p>



<a name="212854350"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/242791-t-infra/topic/promote-release/near/212854350" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Pietro Albini <a href="https://zulip-archive.rust-lang.org/stream/242791-t-infra/topic/promote-release.html#212854350">(Oct 09 2020 at 17:30)</a>:</h4>
<p><span class="user-mention" data-user-id="116122">@simulacrum</span> so, I'm looking into creating a build-manifest dist component</p>



<a name="212854368"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/242791-t-infra/topic/promote-release/near/212854368" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Pietro Albini <a href="https://zulip-archive.rust-lang.org/stream/242791-t-infra/topic/promote-release.html#212854368">(Oct 09 2020 at 17:30)</a>:</h4>
<p>which should avoid the need to clone rust-lang/rust or invoke ./x.py at all during the release process</p>



<a name="212854387"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/242791-t-infra/topic/promote-release/near/212854387" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> simulacrum <a href="https://zulip-archive.rust-lang.org/stream/242791-t-infra/topic/promote-release.html#212854387">(Oct 09 2020 at 17:30)</a>:</h4>
<p>ok</p>



<a name="212854397"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/242791-t-infra/topic/promote-release/near/212854397" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> simulacrum <a href="https://zulip-archive.rust-lang.org/stream/242791-t-infra/topic/promote-release.html#212854397">(Oct 09 2020 at 17:30)</a>:</h4>
<p>seems fine</p>



<a name="212854401"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/242791-t-infra/topic/promote-release/near/212854401" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Pietro Albini <a href="https://zulip-archive.rust-lang.org/stream/242791-t-infra/topic/promote-release.html#212854401">(Oct 09 2020 at 17:31)</a>:</h4>
<p>what do you think is the best way to only run it on the dist-x86_64-linux builder?</p>



<a name="212854417"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/242791-t-infra/topic/promote-release/near/212854417" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Pietro Albini <a href="https://zulip-archive.rust-lang.org/stream/242791-t-infra/topic/promote-release.html#212854417">(Oct 09 2020 at 17:31)</a>:</h4>
<p>I see for the rust-src component we added an explicit <code>dist-src</code> config option</p>



<a name="212854427"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/242791-t-infra/topic/promote-release/near/212854427" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Pietro Albini <a href="https://zulip-archive.rust-lang.org/stream/242791-t-infra/topic/promote-release.html#212854427">(Oct 09 2020 at 17:31)</a>:</h4>
<p>but that seems... overkill?</p>



<a name="212854465"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/242791-t-infra/topic/promote-release/near/212854465" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Pietro Albini <a href="https://zulip-archive.rust-lang.org/stream/242791-t-infra/topic/promote-release.html#212854465">(Oct 09 2020 at 17:31)</a>:</h4>
<p>like ideally I'd change the <code>SCRIPT</code> to be <code>./x.py dist --include-defaults src/tools/build-manifest</code></p>



<a name="212854518"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/242791-t-infra/topic/promote-release/near/212854518" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> simulacrum <a href="https://zulip-archive.rust-lang.org/stream/242791-t-infra/topic/promote-release.html#212854518">(Oct 09 2020 at 17:32)</a>:</h4>
<p>yeah, so I've definitely wanted a --include-default</p>



<a name="212854536"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/242791-t-infra/topic/promote-release/near/212854536" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> simulacrum <a href="https://zulip-archive.rust-lang.org/stream/242791-t-infra/topic/promote-release.html#212854536">(Oct 09 2020 at 17:32)</a>:</h4>
<p>but you can also just <code>x.py dist &amp;&amp; x.py dist src/tools/build-manifest</code></p>



<a name="212856871"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/242791-t-infra/topic/promote-release/near/212856871" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Pietro Albini <a href="https://zulip-archive.rust-lang.org/stream/242791-t-infra/topic/promote-release.html#212856871">(Oct 09 2020 at 17:55)</a>:</h4>
<p><span class="user-mention" data-user-id="116122">@simulacrum</span> ok implemented <code>--include-default-paths</code></p>



<a name="212856889"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/242791-t-infra/topic/promote-release/near/212856889" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Pietro Albini <a href="https://zulip-archive.rust-lang.org/stream/242791-t-infra/topic/promote-release.html#212856889">(Oct 09 2020 at 17:55)</a>:</h4>
<p>should I remove <code>DIST_SRC=1</code> and migrate it to that?</p>



<a name="212856935"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/242791-t-infra/topic/promote-release/near/212856935" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> simulacrum <a href="https://zulip-archive.rust-lang.org/stream/242791-t-infra/topic/promote-release.html#212856935">(Oct 09 2020 at 17:55)</a>:</h4>
<p>I think that makes sense</p>



<a name="212856962"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/242791-t-infra/topic/promote-release/near/212856962" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> simulacrum <a href="https://zulip-archive.rust-lang.org/stream/242791-t-infra/topic/promote-release.html#212856962">(Oct 09 2020 at 17:55)</a>:</h4>
<p>we'll want to ping <span class="user-mention" data-user-id="138448">@cuviper</span> at least -- I suspect distros don't use it though</p>



<a name="212856964"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/242791-t-infra/topic/promote-release/near/212856964" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Pietro Albini <a href="https://zulip-archive.rust-lang.org/stream/242791-t-infra/topic/promote-release.html#212856964">(Oct 09 2020 at 17:55)</a>:</h4>
<p>the only disadvantage I could think of is that <code>./x.py dist</code> will not build it anymore</p>



<a name="212857240"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/242791-t-infra/topic/promote-release/near/212857240" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> cuviper <a href="https://zulip-archive.rust-lang.org/stream/242791-t-infra/topic/promote-release.html#212857240">(Oct 09 2020 at 17:58)</a>:</h4>
<p>I use <code>./x.py install</code>, and I do want <code>rust-src</code> for IDE use</p>



<a name="212857280"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/242791-t-infra/topic/promote-release/near/212857280" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> cuviper <a href="https://zulip-archive.rust-lang.org/stream/242791-t-infra/topic/promote-release.html#212857280">(Oct 09 2020 at 17:58)</a>:</h4>
<p>(it's a little sad that <code>install</code> bothers to create dist tarballs, but that's another story)</p>



<a name="212857440"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/242791-t-infra/topic/promote-release/near/212857440" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Pietro Albini <a href="https://zulip-archive.rust-lang.org/stream/242791-t-infra/topic/promote-release.html#212857440">(Oct 09 2020 at 18:00)</a>:</h4>
<p>wait I <em>think</em> this is for the other src component</p>



<a name="212857464"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/242791-t-infra/topic/promote-release/near/212857464" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> simulacrum <a href="https://zulip-archive.rust-lang.org/stream/242791-t-infra/topic/promote-release.html#212857464">(Oct 09 2020 at 18:00)</a>:</h4>
<p>anyway seems fine to just make a note in the bootstrap changelog, we don't need to bump the version though</p>



<a name="212857532"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/242791-t-infra/topic/promote-release/near/212857532" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> cuviper <a href="https://zulip-archive.rust-lang.org/stream/242791-t-infra/topic/promote-release.html#212857532">(Oct 09 2020 at 18:01)</a>:</h4>
<p>there's <code>rust-src</code> for standard library sources, and <code>rustc-VERSION-src</code> for building the compiler, but I think they're in the same bootstrap target</p>



<a name="212857589"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/242791-t-infra/topic/promote-release/near/212857589" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Pietro Albini <a href="https://zulip-archive.rust-lang.org/stream/242791-t-infra/topic/promote-release.html#212857589">(Oct 09 2020 at 18:01)</a>:</h4>
<p>ok this is a mess</p>



<a name="212857698"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/242791-t-infra/topic/promote-release/near/212857698" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Pietro Albini <a href="https://zulip-archive.rust-lang.org/stream/242791-t-infra/topic/promote-release.html#212857698">(Oct 09 2020 at 18:02)</a>:</h4>
<p><code>rust-src</code> is created with <code>./x.py dist src</code>, and completly ignored <code>DIST_SRC</code></p>



<a name="212857735"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/242791-t-infra/topic/promote-release/near/212857735" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Pietro Albini <a href="https://zulip-archive.rust-lang.org/stream/242791-t-infra/topic/promote-release.html#212857735">(Oct 09 2020 at 18:02)</a>:</h4>
<p><code>rustc-VERSION-src</code> is <em>also</em> created with <code>./x.py dist src</code>, but followed <code>DIST_SRC</code></p>



<a name="212857738"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/242791-t-infra/topic/promote-release/near/212857738" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> cuviper <a href="https://zulip-archive.rust-lang.org/stream/242791-t-infra/topic/promote-release.html#212857738">(Oct 09 2020 at 18:02)</a>:</h4>
<p><code>rust-src</code> is a manifest component for rustup, but I don't think <code>rustc-VERSION-src</code> is</p>



<a name="212857739"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/242791-t-infra/topic/promote-release/near/212857739" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Pietro Albini <a href="https://zulip-archive.rust-lang.org/stream/242791-t-infra/topic/promote-release.html#212857739">(Oct 09 2020 at 18:02)</a>:</h4>
<p>:/</p>



<a name="212858145"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/242791-t-infra/topic/promote-release/near/212858145" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Pietro Albini <a href="https://zulip-archive.rust-lang.org/stream/242791-t-infra/topic/promote-release.html#212858145">(Oct 09 2020 at 18:06)</a>:</h4>
<p>ok I'll avoid removing <code>DIST_SRC</code> for now</p>



<a name="212858167"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/242791-t-infra/topic/promote-release/near/212858167" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Pietro Albini <a href="https://zulip-archive.rust-lang.org/stream/242791-t-infra/topic/promote-release.html#212858167">(Oct 09 2020 at 18:06)</a>:</h4>
<p>but I kinda expect to revisit this soonish</p>



<a name="213014086"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/242791-t-infra/topic/promote-release/near/213014086" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Pietro Albini <a href="https://zulip-archive.rust-lang.org/stream/242791-t-infra/topic/promote-release.html#213014086">(Oct 12 2020 at 09:09)</a>:</h4>
<p>ok, got some partial great news! with the parallelism I implemented for hashing and signing in <code>promote-release</code>, the release process got from 40 minutes to 33 minutes!</p>



<a name="213014411"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/242791-t-infra/topic/promote-release/near/213014411" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Pietro Albini <a href="https://zulip-archive.rust-lang.org/stream/242791-t-infra/topic/promote-release.html#213014411">(Oct 12 2020 at 09:13)</a>:</h4>
<p>stopping cloning the git repository and building promote-release <a href="https://github.com/rust-lang/rust/pull/77762">https://github.com/rust-lang/rust/pull/77762</a> should remove another 9 minutes</p>



<a name="213014461"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/242791-t-infra/topic/promote-release/near/213014461" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Pietro Albini <a href="https://zulip-archive.rust-lang.org/stream/242791-t-infra/topic/promote-release.html#213014461">(Oct 12 2020 at 09:13)</a>:</h4>
<p>and then, when we have practically no more single thread task, we can just throw cores at the problem and see how good it performs with, dunno, a 8 core VM instead of a 2 core VM</p>



<a name="213016014"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/242791-t-infra/topic/promote-release/near/213016014" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Daniel Silverstone <a href="https://zulip-archive.rust-lang.org/stream/242791-t-infra/topic/promote-release.html#213016014">(Oct 12 2020 at 09:29)</a>:</h4>
<p>That sounds great!</p>



<a name="213016401"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/242791-t-infra/topic/promote-release/near/213016401" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Pietro Albini <a href="https://zulip-archive.rust-lang.org/stream/242791-t-infra/topic/promote-release.html#213016401">(Oct 12 2020 at 09:33)</a>:</h4>
<p>actually, looking at the CPU graph it looks like we can speed it up by increasing the internal parallelism</p>



<a name="213016436"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/242791-t-infra/topic/promote-release/near/213016436" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Pietro Albini <a href="https://zulip-archive.rust-lang.org/stream/242791-t-infra/topic/promote-release.html#213016436">(Oct 12 2020 at 09:33)</a>:</h4>
<p>(right now we run a rayon pool of <code>num_cpus()</code>, but since there is IO involved in all parallel tasks we can add a couple more threads)</p>



<a name="213018895"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/242791-t-infra/topic/promote-release/near/213018895" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Daniel Silverstone <a href="https://zulip-archive.rust-lang.org/stream/242791-t-infra/topic/promote-release.html#213018895">(Oct 12 2020 at 09:58)</a>:</h4>
<p>It'll need careful tuning there because IO isn't free so issuing even more of it might result in slowdown instead of speedup if it fights.</p>



<a name="213019905"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/242791-t-infra/topic/promote-release/near/213019905" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Pietro Albini <a href="https://zulip-archive.rust-lang.org/stream/242791-t-infra/topic/promote-release.html#213019905">(Oct 12 2020 at 10:10)</a>:</h4>
<p><span class="user-mention" data-user-id="223910">@Daniel Silverstone</span> yeah I plan to set an environment variable and try tweaking it</p>



<a name="213085910"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/242791-t-infra/topic/promote-release/near/213085910" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Josh Triplett <a href="https://zulip-archive.rust-lang.org/stream/242791-t-infra/topic/promote-release.html#213085910">(Oct 12 2020 at 20:59)</a>:</h4>
<p><span class="user-mention silent" data-user-id="223910">Daniel Silverstone</span> <a href="#narrow/stream/242791-t-infra/topic/promote-release/near/213018895">said</a>:</p>
<blockquote>
<p>It'll need careful tuning there because IO isn't free so issuing even more of it might result in slowdown instead of speedup if it fights.</p>
</blockquote>
<p>True, but most modern storage hardware craves more requests at once. :)</p>



<a name="213119354"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/242791-t-infra/topic/promote-release/near/213119354" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Daniel Silverstone <a href="https://zulip-archive.rust-lang.org/stream/242791-t-infra/topic/promote-release.html#213119354">(Oct 13 2020 at 07:24)</a>:</h4>
<p><span class="user-mention silent" data-user-id="239881">Josh Triplett</span> <a href="#narrow/stream/242791-t-infra/topic/promote-release/near/213085910">said</a>:</p>
<blockquote>
<p>True, but most modern storage hardware craves more requests at once. <span aria-label="smile" class="emoji emoji-1f642" role="img" title="smile">:smile:</span></p>
</blockquote>
<p>Aye, though in my experience clouds can sometimes act counterintuitively due to how they scheduled IO among guests.  Either way I'm sure Pietro will work out the optimal approach for our environment.</p>



<a name="213895929"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/242791-t-infra/topic/promote-release/near/213895929" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Pietro Albini <a href="https://zulip-archive.rust-lang.org/stream/242791-t-infra/topic/promote-release.html#213895929">(Oct 20 2020 at 09:48)</a>:</h4>
<p><span class="user-group-mention" data-user-group-id="2943">@T-infra</span> switched nightly releases to run on the new codebuild setup!</p>



<a name="213895958"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/242791-t-infra/topic/promote-release/near/213895958" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Pietro Albini <a href="https://zulip-archive.rust-lang.org/stream/242791-t-infra/topic/promote-release.html#213895958">(Oct 20 2020 at 09:49)</a>:</h4>
<p>I tested downloading the latest nightly from a build done on <a href="http://dev-static.rust-lang.org">dev-static.rust-lang.org</a> and everything seems to work</p>



<a name="214555918"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/242791-t-infra/topic/promote-release/near/214555918" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Pietro Albini <a href="https://zulip-archive.rust-lang.org/stream/242791-t-infra/topic/promote-release.html#214555918">(Oct 26 2020 at 10:18)</a>:</h4>
<p><span class="user-group-mention" data-user-group-id="2943">@T-infra</span> switched beta releases to run on the new codebuild setup!</p>



<a name="214876717"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/242791-t-infra/topic/promote-release/near/214876717" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Pietro Albini <a href="https://zulip-archive.rust-lang.org/stream/242791-t-infra/topic/promote-release.html#214876717">(Oct 28 2020 at 18:07)</a>:</h4>
<p><span class="user-mention" data-user-id="116122">@simulacrum</span> I'm wondering, should I update the release process docs to use the new <code>promote-release</code>?</p>



<a name="214876730"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/242791-t-infra/topic/promote-release/near/214876730" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Pietro Albini <a href="https://zulip-archive.rust-lang.org/stream/242791-t-infra/topic/promote-release.html#214876730">(Oct 28 2020 at 18:08)</a>:</h4>
<p>i.e. should we use it for 1.48 stable?</p>



<a name="214877907"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/242791-t-infra/topic/promote-release/near/214877907" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> simulacrum <a href="https://zulip-archive.rust-lang.org/stream/242791-t-infra/topic/promote-release.html#214877907">(Oct 28 2020 at 18:17)</a>:</h4>
<p>I think we should</p>



<a name="214877966"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/242791-t-infra/topic/promote-release/near/214877966" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> simulacrum <a href="https://zulip-archive.rust-lang.org/stream/242791-t-infra/topic/promote-release.html#214877966">(Oct 28 2020 at 18:18)</a>:</h4>
<p>Either 1.48 or 1.50 will be the first release I think</p>



<a name="214877984"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/242791-t-infra/topic/promote-release/near/214877984" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> simulacrum <a href="https://zulip-archive.rust-lang.org/stream/242791-t-infra/topic/promote-release.html#214877984">(Oct 28 2020 at 18:18)</a>:</h4>
<p>I don't want to do it on December 31st</p>



<a name="214878533"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/242791-t-infra/topic/promote-release/near/214878533" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Pietro Albini <a href="https://zulip-archive.rust-lang.org/stream/242791-t-infra/topic/promote-release.html#214878533">(Oct 28 2020 at 18:23)</a>:</h4>
<p>then 1.48 it is</p>



<a name="215619241"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/242791-t-infra/topic/promote-release/near/215619241" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Pietro Albini <a href="https://zulip-archive.rust-lang.org/stream/242791-t-infra/topic/promote-release.html#215619241">(Nov 04 2020 at 18:03)</a>:</h4>
<p>powering down RCS</p>



<a name="215844088"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/242791-t-infra/topic/promote-release/near/215844088" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Pietro Albini <a href="https://zulip-archive.rust-lang.org/stream/242791-t-infra/topic/promote-release.html#215844088">(Nov 06 2020 at 13:19)</a>:</h4>
<p>so, recompressing over 2 cores took 90 minutes</p>



<a name="215844336"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/242791-t-infra/topic/promote-release/near/215844336" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Pietro Albini <a href="https://zulip-archive.rust-lang.org/stream/242791-t-infra/topic/promote-release.html#215844336">(Nov 06 2020 at 13:21)</a>:</h4>
<p>once the release is finished I'll try doing a build with 8 cores instead of 2</p>



<a name="215844427"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/242791-t-infra/topic/promote-release/near/215844427" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Pietro Albini <a href="https://zulip-archive.rust-lang.org/stream/242791-t-infra/topic/promote-release.html#215844427">(Nov 06 2020 at 13:22)</a>:</h4>
<p>(unfortunately the next step is straight from 8 cores to 72 cores, which might be a bit excessive <span aria-label="sweat smile" class="emoji emoji-1f605" role="img" title="sweat smile">:sweat_smile:</span>)</p>



<a name="215848503"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/242791-t-infra/topic/promote-release/near/215848503" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Pietro Albini <a href="https://zulip-archive.rust-lang.org/stream/242791-t-infra/topic/promote-release.html#215848503">(Nov 06 2020 at 13:57)</a>:</h4>
<p>bumped the builder to BUILD_GENERAL1_LARGE (8 cores), will do another nightly dev release to see how it performs</p>



<a name="215848563"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/242791-t-infra/topic/promote-release/near/215848563" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Pietro Albini <a href="https://zulip-archive.rust-lang.org/stream/242791-t-infra/topic/promote-release.html#215848563">(Nov 06 2020 at 13:57)</a>:</h4>
<p>the one with recompression over 2 cores took 2 hours to complete the full release</p>



<a name="215857877"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/242791-t-infra/topic/promote-release/near/215857877" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Pietro Albini <a href="https://zulip-archive.rust-lang.org/stream/242791-t-infra/topic/promote-release.html#215857877">(Nov 06 2020 at 15:04)</a>:</h4>
<p>ok, with 8 cores it took 42 minutes to do a full release with recompression</p>



<a name="215857995"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/242791-t-infra/topic/promote-release/near/215857995" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Pietro Albini <a href="https://zulip-archive.rust-lang.org/stream/242791-t-infra/topic/promote-release.html#215857995">(Nov 06 2020 at 15:05)</a>:</h4>
<p><span class="user-mention" data-user-id="116122">@simulacrum</span> I think it's more than acceptable if that also means removing <code>.gz</code> from ci2</p>



<a name="215858416"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/242791-t-infra/topic/promote-release/near/215858416" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> simulacrum <a href="https://zulip-archive.rust-lang.org/stream/242791-t-infra/topic/promote-release.html#215858416">(Nov 06 2020 at 15:08)</a>:</h4>
<p>seems fine yeah</p>



<a name="215858436"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/242791-t-infra/topic/promote-release/near/215858436" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> simulacrum <a href="https://zulip-archive.rust-lang.org/stream/242791-t-infra/topic/promote-release.html#215858436">(Nov 06 2020 at 15:09)</a>:</h4>
<p>releases are around an hour right now</p>



<a name="215858488"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/242791-t-infra/topic/promote-release/near/215858488" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> simulacrum <a href="https://zulip-archive.rust-lang.org/stream/242791-t-infra/topic/promote-release.html#215858488">(Nov 06 2020 at 15:09)</a>:</h4>
<p><span class="user-mention" data-user-id="121055">@Pietro Albini</span> one idea might be that stable releases, which we actually wait for, might be a case of throwing 72 cores at it</p>



<a name="215858504"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/242791-t-infra/topic/promote-release/near/215858504" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> simulacrum <a href="https://zulip-archive.rust-lang.org/stream/242791-t-infra/topic/promote-release.html#215858504">(Nov 06 2020 at 15:09)</a>:</h4>
<p>but for nightlies/betas, we could just do 8 (or even 2)</p>



<a name="215858516"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/242791-t-infra/topic/promote-release/near/215858516" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> simulacrum <a href="https://zulip-archive.rust-lang.org/stream/242791-t-infra/topic/promote-release.html#215858516">(Nov 06 2020 at 15:09)</a>:</h4>
<p>since realistically timing matters much less there</p>



<a name="215860597"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/242791-t-infra/topic/promote-release/near/215860597" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Pietro Albini <a href="https://zulip-archive.rust-lang.org/stream/242791-t-infra/topic/promote-release.html#215860597">(Nov 06 2020 at 15:24)</a>:</h4>
<p><span class="user-mention" data-user-id="116122">@simulacrum</span> I guess we can</p>



<a name="215860629"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/242791-t-infra/topic/promote-release/near/215860629" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> simulacrum <a href="https://zulip-archive.rust-lang.org/stream/242791-t-infra/topic/promote-release.html#215860629">(Nov 06 2020 at 15:24)</a>:</h4>
<p>I wouldn't do that yet though -- too complicated</p>



<a name="215860684"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/242791-t-infra/topic/promote-release/near/215860684" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Pietro Albini <a href="https://zulip-archive.rust-lang.org/stream/242791-t-infra/topic/promote-release.html#215860684">(Nov 06 2020 at 15:25)</a>:</h4>
<p>it's not actually complicated, we could set an override when we start the release in <code>start-release.py</code></p>



<a name="215860758"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/242791-t-infra/topic/promote-release/near/215860758" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Pietro Albini <a href="https://zulip-archive.rust-lang.org/stream/242791-t-infra/topic/promote-release.html#215860758">(Nov 06 2020 at 15:25)</a>:</h4>
<p>but I don't think it's worth throwing that many cores to shrink 20 minutes into dunno, 5?</p>



<a name="215860872"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/242791-t-infra/topic/promote-release/near/215860872" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Pietro Albini <a href="https://zulip-archive.rust-lang.org/stream/242791-t-infra/topic/promote-release.html#215860872">(Nov 06 2020 at 15:26)</a>:</h4>
<p>especially as we <em>might</em> reach into IO bottlenecks if we start doing 72 recompressions in parallel</p>



<a name="215869268"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/242791-t-infra/topic/promote-release/near/215869268" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> simulacrum <a href="https://zulip-archive.rust-lang.org/stream/242791-t-infra/topic/promote-release.html#215869268">(Nov 06 2020 at 16:25)</a>:</h4>
<p>wait, 20 minutes?</p>



<a name="215869285"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/242791-t-infra/topic/promote-release/near/215869285" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> simulacrum <a href="https://zulip-archive.rust-lang.org/stream/242791-t-infra/topic/promote-release.html#215869285">(Nov 06 2020 at 16:26)</a>:</h4>
<p>You said 42?</p>



<a name="215870198"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/242791-t-infra/topic/promote-release/near/215870198" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Pietro Albini <a href="https://zulip-archive.rust-lang.org/stream/242791-t-infra/topic/promote-release.html#215870198">(Nov 06 2020 at 16:32)</a>:</h4>
<p><span class="user-mention" data-user-id="116122">@simulacrum</span> recompression is 20 minutes, the whole release process is 42 minutes</p>



<a name="215870213"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/242791-t-infra/topic/promote-release/near/215870213" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> simulacrum <a href="https://zulip-archive.rust-lang.org/stream/242791-t-infra/topic/promote-release.html#215870213">(Nov 06 2020 at 16:32)</a>:</h4>
<p>aha, ok</p>



<a name="215870226"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/242791-t-infra/topic/promote-release/near/215870226" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> simulacrum <a href="https://zulip-archive.rust-lang.org/stream/242791-t-infra/topic/promote-release.html#215870226">(Nov 06 2020 at 16:32)</a>:</h4>
<p>yeah then definitely not worth it</p>



<a name="215877578"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/242791-t-infra/topic/promote-release/near/215877578" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Pietro Albini <a href="https://zulip-archive.rust-lang.org/stream/242791-t-infra/topic/promote-release.html#215877578">(Nov 06 2020 at 17:26)</a>:</h4>
<p>reverted the builders to be of the smaller size until we actually start recompressing stuff</p>



<a name="215881932"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/242791-t-infra/topic/promote-release/near/215881932" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Daniel Silverstone <a href="https://zulip-archive.rust-lang.org/stream/242791-t-infra/topic/promote-release.html#215881932">(Nov 06 2020 at 18:01)</a>:</h4>
<p><span class="user-mention" data-user-id="121055">@Pietro Albini</span> Is there a chance you might be able to do a similar test run at some point to benchmark compression with zstd?</p>



<a name="215882147"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/242791-t-infra/topic/promote-release/near/215882147" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Pietro Albini <a href="https://zulip-archive.rust-lang.org/stream/242791-t-infra/topic/promote-release.html#215882147">(Nov 06 2020 at 18:03)</a>:</h4>
<p><span class="user-mention" data-user-id="223910">@Daniel Silverstone</span> from xz to zstd?</p>



<hr><p>Last updated: Apr 12 2022 at 20:01 UTC</p>
</html>