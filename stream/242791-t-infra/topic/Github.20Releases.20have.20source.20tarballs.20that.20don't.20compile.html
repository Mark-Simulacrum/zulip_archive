<html>
<head><meta charset="utf-8"><title>Github Releases have source tarballs that don&#x27;t compile · t-infra · Zulip Chat Archive</title></head>
<h2>Stream: <a href="https://rust-lang.github.io/zulip_archive/stream/242791-t-infra/index.html">t-infra</a></h2>
<h3>Topic: <a href="https://rust-lang.github.io/zulip_archive/stream/242791-t-infra/topic/Github.20Releases.20have.20source.20tarballs.20that.20don&#x27;t.20compile.html">Github Releases have source tarballs that don&#x27;t compile</a></h3>

<hr>

<base href="https://rust-lang.zulipchat.com">

<head><link href="https://rust-lang.github.io/zulip_archive/style.css" rel="stylesheet"></head>

<a name="246040057"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/242791-t-infra/topic/Github%20Releases%20have%20source%20tarballs%20that%20don%27t%20compile/near/246040057" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Nelson <a href="https://rust-lang.github.io/zulip_archive/stream/242791-t-infra/topic/Github.20Releases.20have.20source.20tarballs.20that.20don&#x27;t.20compile.html#246040057">(Jul 15 2021 at 00:49)</a>:</h4>
<p>They don't include submodules, which makes <code>x.py --help</code> immediately error. Is there a way to use the officall tarball instead, which include submodules? Or barring that, just omit uploading them altogether?</p>
<p>Specifically I'm talking about the ones linked on <a href="https://github.com/rust-lang/rust/releases/tag/1.53.0">https://github.com/rust-lang/rust/releases/tag/1.53.0</a>, e.g. <a href="https://github.com/rust-lang/rust/archive/refs/tags/1.53.0.zip">https://github.com/rust-lang/rust/archive/refs/tags/1.53.0.zip</a></p>



<a name="246040150"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/242791-t-infra/topic/Github%20Releases%20have%20source%20tarballs%20that%20don%27t%20compile/near/246040150" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> cuviper <a href="https://rust-lang.github.io/zulip_archive/stream/242791-t-infra/topic/Github.20Releases.20have.20source.20tarballs.20that.20don&#x27;t.20compile.html#246040150">(Jul 15 2021 at 00:51)</a>:</h4>
<p>I don't think <strong>we</strong> are uploading those -- they look like github's regular <code>/archive/</code> links, which works for any ref</p>



<a name="246040160"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/242791-t-infra/topic/Github%20Releases%20have%20source%20tarballs%20that%20don%27t%20compile/near/246040160" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> cuviper <a href="https://rust-lang.github.io/zulip_archive/stream/242791-t-infra/topic/Github.20Releases.20have.20source.20tarballs.20that.20don&#x27;t.20compile.html#246040160">(Jul 15 2021 at 00:51)</a>:</h4>
<p>but yes, if possible we should link to the real dist-src</p>



<a name="246040200"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/242791-t-infra/topic/Github%20Releases%20have%20source%20tarballs%20that%20don%27t%20compile/near/246040200" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Nelson <a href="https://rust-lang.github.io/zulip_archive/stream/242791-t-infra/topic/Github.20Releases.20have.20source.20tarballs.20that.20don&#x27;t.20compile.html#246040200">(Jul 15 2021 at 00:52)</a>:</h4>
<p>yeah, I think github is generating them itself</p>



<a name="246040202"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/242791-t-infra/topic/Github%20Releases%20have%20source%20tarballs%20that%20don%27t%20compile/near/246040202" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Nelson <a href="https://rust-lang.github.io/zulip_archive/stream/242791-t-infra/topic/Github.20Releases.20have.20source.20tarballs.20that.20don&#x27;t.20compile.html#246040202">(Jul 15 2021 at 00:52)</a>:</h4>
<p>but it would be nice to tell it not to somehow</p>



<a name="246040235"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/242791-t-infra/topic/Github%20Releases%20have%20source%20tarballs%20that%20don%27t%20compile/near/246040235" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> cuviper <a href="https://rust-lang.github.io/zulip_archive/stream/242791-t-infra/topic/Github.20Releases.20have.20source.20tarballs.20that.20don&#x27;t.20compile.html#246040235">(Jul 15 2021 at 00:53)</a>:</h4>
<p>I wonder if the release "reaction" emojis are new? 1.53 has way more than 1.52, and I see none before</p>



<a name="246040240"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/242791-t-infra/topic/Github%20Releases%20have%20source%20tarballs%20that%20don%27t%20compile/near/246040240" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> cuviper <a href="https://rust-lang.github.io/zulip_archive/stream/242791-t-infra/topic/Github.20Releases.20have.20source.20tarballs.20that.20don&#x27;t.20compile.html#246040240">(Jul 15 2021 at 00:53)</a>:</h4>
<p>&lt;/tangent&gt;</p>



<a name="246040284"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/242791-t-infra/topic/Github%20Releases%20have%20source%20tarballs%20that%20don%27t%20compile/near/246040284" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Nelson <a href="https://rust-lang.github.io/zulip_archive/stream/242791-t-infra/topic/Github.20Releases.20have.20source.20tarballs.20that.20don&#x27;t.20compile.html#246040284">(Jul 15 2021 at 00:54)</a>:</h4>
<p>it might be people just didn't know about the releases before</p>



<a name="246040289"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/242791-t-infra/topic/Github%20Releases%20have%20source%20tarballs%20that%20don%27t%20compile/near/246040289" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Nelson <a href="https://rust-lang.github.io/zulip_archive/stream/242791-t-infra/topic/Github.20Releases.20have.20source.20tarballs.20that.20don&#x27;t.20compile.html#246040289">(Jul 15 2021 at 00:54)</a>:</h4>
<p>we only started them in what, 1.51?</p>



<a name="246040302"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/242791-t-infra/topic/Github%20Releases%20have%20source%20tarballs%20that%20don%27t%20compile/near/246040302" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> cuviper <a href="https://rust-lang.github.io/zulip_archive/stream/242791-t-infra/topic/Github.20Releases.20have.20source.20tarballs.20that.20don&#x27;t.20compile.html#246040302">(Jul 15 2021 at 00:54)</a>:</h4>
<p>oh maybe that was fairly recent, but it was done retroactively</p>



<a name="246040698"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/242791-t-infra/topic/Github%20Releases%20have%20source%20tarballs%20that%20don%27t%20compile/near/246040698" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Taylor Yu [they/she] <a href="https://rust-lang.github.io/zulip_archive/stream/242791-t-infra/topic/Github.20Releases.20have.20source.20tarballs.20that.20don&#x27;t.20compile.html#246040698">(Jul 15 2021 at 01:01)</a>:</h4>
<p><span class="user-mention silent" data-user-id="232545">Joshua Nelson</span> <a href="#narrow/stream/242791-t-infra/topic/Github.20Releases.20have.20source.20tarballs.20that.20don't.20compile/near/246040200">said</a>:</p>
<blockquote>
<p>yeah, I think github is generating them itself</p>
</blockquote>
<p>i still can't find an obvious way to suppress those github auto-generated downloads. maybe the best we can do is have <code>x.py</code> recognize the situation and provide a pointer to the official source tarballs? (missing <code>.git</code> directories <em>and</em> missing version stamp files?)</p>



<a name="246040758"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/242791-t-infra/topic/Github%20Releases%20have%20source%20tarballs%20that%20don%27t%20compile/near/246040758" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Nelson <a href="https://rust-lang.github.io/zulip_archive/stream/242791-t-infra/topic/Github.20Releases.20have.20source.20tarballs.20that.20don&#x27;t.20compile.html#246040758">(Jul 15 2021 at 01:02)</a>:</h4>
<p>what do you mean by missing version stamp files? <code>src/stage0.txt</code> exists on every commit in the tree</p>



<a name="246040773"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/242791-t-infra/topic/Github%20Releases%20have%20source%20tarballs%20that%20don%27t%20compile/near/246040773" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Nelson <a href="https://rust-lang.github.io/zulip_archive/stream/242791-t-infra/topic/Github.20Releases.20have.20source.20tarballs.20that.20don&#x27;t.20compile.html#246040773">(Jul 15 2021 at 01:02)</a>:</h4>
<p>(well, ever since we started using it; I don't know when that was)</p>



<a name="246040798"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/242791-t-infra/topic/Github%20Releases%20have%20source%20tarballs%20that%20don%27t%20compile/near/246040798" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Taylor Yu [they/she] <a href="https://rust-lang.github.io/zulip_archive/stream/242791-t-infra/topic/Github.20Releases.20have.20source.20tarballs.20that.20don&#x27;t.20compile.html#246040798">(Jul 15 2021 at 01:04)</a>:</h4>
<p>trying to figure out which those are. i thought there were a few files that exist in the tarball that aren't checked into the tree. <code>git-commit-hash</code> maybe?</p>



<a name="246040849"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/242791-t-infra/topic/Github%20Releases%20have%20source%20tarballs%20that%20don%27t%20compile/near/246040849" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Nelson <a href="https://rust-lang.github.io/zulip_archive/stream/242791-t-infra/topic/Github.20Releases.20have.20source.20tarballs.20that.20don&#x27;t.20compile.html#246040849">(Jul 15 2021 at 01:04)</a>:</h4>
<p>I tink "missing .git and no files in src/llvm-project" might be a good heuristic. But I would be a little concerned about getting it wrong; I guess the worst that happens is someone complains.</p>



<a name="246040854"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/242791-t-infra/topic/Github%20Releases%20have%20source%20tarballs%20that%20don%27t%20compile/near/246040854" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Nelson <a href="https://rust-lang.github.io/zulip_archive/stream/242791-t-infra/topic/Github.20Releases.20have.20source.20tarballs.20that.20don&#x27;t.20compile.html#246040854">(Jul 15 2021 at 01:04)</a>:</h4>
<p>I don't know what file that is. I think it's in the build directory which doesn't help, that means it's generated by x.py and will never exist at first.</p>



<a name="246040890"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/242791-t-infra/topic/Github%20Releases%20have%20source%20tarballs%20that%20don%27t%20compile/near/246040890" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Taylor Yu [they/she] <a href="https://rust-lang.github.io/zulip_archive/stream/242791-t-infra/topic/Github.20Releases.20have.20source.20tarballs.20that.20don&#x27;t.20compile.html#246040890">(Jul 15 2021 at 01:05)</a>:</h4>
<div class="codehilite"><pre><span></span><code>-rw-r--r--  0 1001   1001       40 Jun 16 23:33 rustc-1.53.0-src/git-commit-hash
</code></pre></div>



<a name="246041056"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/242791-t-infra/topic/Github%20Releases%20have%20source%20tarballs%20that%20don%27t%20compile/near/246041056" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Taylor Yu [they/she] <a href="https://rust-lang.github.io/zulip_archive/stream/242791-t-infra/topic/Github.20Releases.20have.20source.20tarballs.20that.20don&#x27;t.20compile.html#246041056">(Jul 15 2021 at 01:09)</a>:</h4>
<p>also</p>
<div class="codehilite"><pre><span></span><code>-rw-r--r--  0 1001   1001       29 Jun 16 23:33 rustc-1.53.0-src/version
</code></pre></div>
<p>i think maybe they're both created by the <code>dist</code> target?</p>



<a name="246041066"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/242791-t-infra/topic/Github%20Releases%20have%20source%20tarballs%20that%20don%27t%20compile/near/246041066" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Nelson <a href="https://rust-lang.github.io/zulip_archive/stream/242791-t-infra/topic/Github.20Releases.20have.20source.20tarballs.20that.20don&#x27;t.20compile.html#246041066">(Jul 15 2021 at 01:09)</a>:</h4>
<p>ah that makes sense, I think dist copies things into a new tarball</p>



<a name="246041434"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/242791-t-infra/topic/Github%20Releases%20have%20source%20tarballs%20that%20don%27t%20compile/near/246041434" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Taylor Yu [they/she] <a href="https://rust-lang.github.io/zulip_archive/stream/242791-t-infra/topic/Github.20Releases.20have.20source.20tarballs.20that.20don&#x27;t.20compile.html#246041434">(Jul 15 2021 at 01:18)</a>:</h4>
<p>even adding a note at the bottom of the github version of the release notes saying "the linked sources zip and tar files below are auto-generated by github and not suitable for building from source" might help; not sure how well that will render, though.</p>



<a name="246202995"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/242791-t-infra/topic/Github%20Releases%20have%20source%20tarballs%20that%20don%27t%20compile/near/246202995" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> apiraino <a href="https://rust-lang.github.io/zulip_archive/stream/242791-t-infra/topic/Github.20Releases.20have.20source.20tarballs.20that.20don&#x27;t.20compile.html#246202995">(Jul 16 2021 at 09:40)</a>:</h4>
<p><span class="user-mention silent" data-user-id="138448">cuviper</span> <a href="#narrow/stream/242791-t-infra/topic/Github.20Releases.20have.20source.20tarballs.20that.20don't.20compile/near/246040235">said</a>:</p>
<blockquote>
<p>I wonder if the release "reaction" emojis are new? 1.53 has way more than 1.52, and I see none before</p>
</blockquote>
<p><span class="user-mention" data-user-id="138448">@cuviper</span> correct, it's a new github "feature" (if we want to call it like that)<br>
<a href="https://github.blog/2021-07-13-whats-new-github-changelog-june-2021/#github-releases">https://github.blog/2021-07-13-whats-new-github-changelog-june-2021/#github-releases</a></p>



<hr><p>Last updated: Aug 07 2021 at 22:04 UTC</p>
</html>