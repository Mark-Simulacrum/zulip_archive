<html>
<head><meta charset="utf-8"><title>Promote aarch64-apple-ios-sim to Tier 2 · t-infra · Zulip Chat Archive</title></head>
<h2>Stream: <a href="https://rust-lang.github.io/zulip_archive/stream/242791-t-infra/index.html">t-infra</a></h2>
<h3>Topic: <a href="https://rust-lang.github.io/zulip_archive/stream/242791-t-infra/topic/Promote.20aarch64-apple-ios-sim.20to.20Tier.202.html">Promote aarch64-apple-ios-sim to Tier 2</a></h3>

<hr>

<base href="https://rust-lang.zulipchat.com">

<head><link href="https://rust-lang.github.io/zulip_archive/style.css" rel="stylesheet"></head>

<a name="227329554"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/242791-t-infra/topic/Promote%20aarch64-apple-ios-sim%20to%20Tier%202/near/227329554" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jan-Erik (badboy) <a href="https://rust-lang.github.io/zulip_archive/stream/242791-t-infra/topic/Promote.20aarch64-apple-ios-sim.20to.20Tier.202.html#227329554">(Feb 22 2021 at 20:09)</a>:</h4>
<p>A new target landed just yesterday or so: aarch64-apple-ios-sim.<br>
How likely is it we can promote that to Tier 2 and start shipping libstd for it?<br>
(I filed an <a href="https://github.com/rust-lang/rust/issues/82412">issue</a>, but was told might be easier to ask here first)</p>



<a name="227332684"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/242791-t-infra/topic/Promote%20aarch64-apple-ios-sim%20to%20Tier%202/near/227332684" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Nelson <a href="https://rust-lang.github.io/zulip_archive/stream/242791-t-infra/topic/Promote.20aarch64-apple-ios-sim.20to.20Tier.202.html#227332684">(Feb 22 2021 at 20:32)</a>:</h4>
<p>See also <a href="https://github.com/rust-lang/rfcs/pull/2803">https://github.com/rust-lang/rfcs/pull/2803</a></p>



<a name="227333144"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/242791-t-infra/topic/Promote%20aarch64-apple-ios-sim%20to%20Tier%202/near/227333144" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jan-Erik (badboy) <a href="https://rust-lang.github.io/zulip_archive/stream/242791-t-infra/topic/Promote.20aarch64-apple-ios-sim.20to.20Tier.202.html#227333144">(Feb 22 2021 at 20:36)</a>:</h4>
<p>hah, forgot that that exists</p>



<a name="227333167"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/242791-t-infra/topic/Promote%20aarch64-apple-ios-sim%20to%20Tier%202/near/227333167" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jan-Erik (badboy) <a href="https://rust-lang.github.io/zulip_archive/stream/242791-t-infra/topic/Promote.20aarch64-apple-ios-sim.20to.20Tier.202.html#227333167">(Feb 22 2021 at 20:36)</a>:</h4>
<blockquote>
<p>Rust developers regularly ask how they can raise an existing target to tier 2</p>
</blockquote>
<p>Yup, guess that's me.</p>



<a name="227333203"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/242791-t-infra/topic/Promote%20aarch64-apple-ios-sim%20to%20Tier%202/near/227333203" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Nelson <a href="https://rust-lang.github.io/zulip_archive/stream/242791-t-infra/topic/Promote.20aarch64-apple-ios-sim.20to.20Tier.202.html#227333203">(Feb 22 2021 at 20:36)</a>:</h4>
<p>also, by "shipping libstd", I assume that means you only want "target tier 2" and not "host tier 2"? i.e. you don't need to be able to run <code>rustc</code> on iOS?</p>



<a name="227333226"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/242791-t-infra/topic/Promote%20aarch64-apple-ios-sim%20to%20Tier%202/near/227333226" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jan-Erik (badboy) <a href="https://rust-lang.github.io/zulip_archive/stream/242791-t-infra/topic/Promote.20aarch64-apple-ios-sim.20to.20Tier.202.html#227333226">(Feb 22 2021 at 20:37)</a>:</h4>
<p>This is just the simulator target. I definitely don't need rustc.</p>



<a name="227333297"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/242791-t-infra/topic/Promote%20aarch64-apple-ios-sim%20to%20Tier%202/near/227333297" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jan-Erik (badboy) <a href="https://rust-lang.github.io/zulip_archive/stream/242791-t-infra/topic/Promote.20aarch64-apple-ios-sim.20to.20Tier.202.html#227333297">(Feb 22 2021 at 20:37)</a>:</h4>
<p>If we get a stable <code>-Z build-std</code> sooner that would probably be enough for me too</p>



<a name="227515421"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/242791-t-infra/topic/Promote%20aarch64-apple-ios-sim%20to%20Tier%202/near/227515421" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Degausser <a href="https://rust-lang.github.io/zulip_archive/stream/242791-t-infra/topic/Promote.20aarch64-apple-ios-sim.20to.20Tier.202.html#227515421">(Feb 23 2021 at 22:24)</a>:</h4>
<p>This would be awesome I still need to use my <code>cargo</code> from <code>x.py</code> since running the <code>-Z build-std</code> causes this error for me when building for the simulator: </p>
<p><a href="https://gist.github.com/deg4uss3r/4e3570f4582c937218d0499313a3e4ab">https://gist.github.com/deg4uss3r/4e3570f4582c937218d0499313a3e4ab</a></p>
<p>Anyone knows why I'd love some help here.. but it's very consistent in my workspace and I cannot seem to recreate it in a simple project :/</p>



<a name="227521684"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/242791-t-infra/topic/Promote%20aarch64-apple-ios-sim%20to%20Tier%202/near/227521684" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Nelson <a href="https://rust-lang.github.io/zulip_archive/stream/242791-t-infra/topic/Promote.20aarch64-apple-ios-sim.20to.20Tier.202.html#227521684">(Feb 23 2021 at 23:15)</a>:</h4>
<p><span class="user-mention silent" data-user-id="264486">Degausser</span> <a href="#narrow/stream/242791-t-infra/topic/Promote.20aarch64-apple-ios-sim.20to.20Tier.202/near/227515421">said</a>:</p>
<blockquote>
<p>This would be awesome I still need to use my <code>cargo</code> from <code>x.py</code> since running the <code>-Z build-std</code> causes this error for me when building for the simulator: </p>
<p><a href="https://gist.github.com/deg4uss3r/4e3570f4582c937218d0499313a3e4ab">https://gist.github.com/deg4uss3r/4e3570f4582c937218d0499313a3e4ab</a></p>
<p>Anyone knows why I'd love some help here.. but it's very consistent in my workspace and I cannot seem to recreate it in a simple project :/</p>
</blockquote>
<p>that sounds like a bug in build-std - consider opening a cargo issue</p>



<a name="227522175"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/242791-t-infra/topic/Promote%20aarch64-apple-ios-sim%20to%20Tier%202/near/227522175" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Degausser <a href="https://rust-lang.github.io/zulip_archive/stream/242791-t-infra/topic/Promote.20aarch64-apple-ios-sim.20to.20Tier.202.html#227522175">(Feb 23 2021 at 23:20)</a>:</h4>
<p>Thanks  <span class="user-mention" data-user-id="232545">@Joshua Nelson</span>  I'll look into doing that tomorrow, I _have_ to have my toolchain linked and use my <code>cargo</code> to build so I'm not sure what exact steps I need for it to reproduce, but I think promoting to tier2 would fix having the toolchain build for <code>aarch64-apple-darwin</code> and <code>aarch64-apple-ios-sim</code> (at least that's what I do in my <code>config.toml</code>, then link the stage 2 to a toolchain)</p>



<a name="227523531"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/242791-t-infra/topic/Promote%20aarch64-apple-ios-sim%20to%20Tier%202/near/227523531" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Nelson <a href="https://rust-lang.github.io/zulip_archive/stream/242791-t-infra/topic/Promote.20aarch64-apple-ios-sim.20to.20Tier.202.html#227523531">(Feb 23 2021 at 23:33)</a>:</h4>
<p>tier2 doesn't have anything to do with x.py. It just uploads prebuilt artifacts to <a href="http://static.rust-lang.org">static.rust-lang.org</a>. They still have to be built at some point.</p>



<a name="227524309"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/242791-t-infra/topic/Promote%20aarch64-apple-ios-sim%20to%20Tier%202/near/227524309" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Degausser <a href="https://rust-lang.github.io/zulip_archive/stream/242791-t-infra/topic/Promote.20aarch64-apple-ios-sim.20to.20Tier.202.html#227524309">(Feb 23 2021 at 23:41)</a>:</h4>
<p>hmmm I have to figure out what exactly is needed but it seems that packing <code>libstd</code> should work <span aria-label="thinking" class="emoji emoji-1f914" role="img" title="thinking">:thinking:</span></p>



<a name="227572439"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/242791-t-infra/topic/Promote%20aarch64-apple-ios-sim%20to%20Tier%202/near/227572439" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jan-Erik (badboy) <a href="https://rust-lang.github.io/zulip_archive/stream/242791-t-infra/topic/Promote.20aarch64-apple-ios-sim.20to.20Tier.202.html#227572439">(Feb 24 2021 at 09:45)</a>:</h4>
<p><span class="user-mention silent" data-user-id="264486">Degausser</span> <a href="#narrow/stream/242791-t-infra/topic/Promote.20aarch64-apple-ios-sim.20to.20Tier.202/near/227515421">said</a>:</p>
<blockquote>
<p>Anyone knows why I'd love some help here.. but it's very consistent in my workspace and I cannot seem to recreate it in a simple project :/</p>
</blockquote>
<p>Can you try running your build with the environment variable <code>CARGO_FEATURE_STD</code> set?</p>
<p>E.g. <code>CARGO_FEATURE_STD=1 cargo +nightly build -Z build-std --target aarch64-apple-ios-sim ....</code></p>



<a name="227572635"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/242791-t-infra/topic/Promote%20aarch64-apple-ios-sim%20to%20Tier%202/near/227572635" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jan-Erik (badboy) <a href="https://rust-lang.github.io/zulip_archive/stream/242791-t-infra/topic/Promote.20aarch64-apple-ios-sim.20to.20Tier.202.html#227572635">(Feb 24 2021 at 09:47)</a>:</h4>
<p>or are you building with no_std to begin with?</p>



<a name="227572923"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/242791-t-infra/topic/Promote%20aarch64-apple-ios-sim%20to%20Tier%202/near/227572923" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jan-Erik (badboy) <a href="https://rust-lang.github.io/zulip_archive/stream/242791-t-infra/topic/Promote.20aarch64-apple-ios-sim.20to.20Tier.202.html#227572923">(Feb 24 2021 at 09:49)</a>:</h4>
<p>(for context: indexmap sets a default value only if it detects a libstd, see <a href="https://github.com/bluss/indexmap/blob/master/src/map.rs#L70-L79">this part of the code</a>. It tries to auto-detect libstd, but I guess that might break with build-std?)</p>



<a name="227622611"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/242791-t-infra/topic/Promote%20aarch64-apple-ios-sim%20to%20Tier%202/near/227622611" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Degausser <a href="https://rust-lang.github.io/zulip_archive/stream/242791-t-infra/topic/Promote.20aarch64-apple-ios-sim.20to.20Tier.202.html#227622611">(Feb 24 2021 at 16:05)</a>:</h4>
<p>This worked!</p>



<a name="227634785"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/242791-t-infra/topic/Promote%20aarch64-apple-ios-sim%20to%20Tier%202/near/227634785" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jan-Erik (badboy) <a href="https://rust-lang.github.io/zulip_archive/stream/242791-t-infra/topic/Promote.20aarch64-apple-ios-sim.20to.20Tier.202.html#227634785">(Feb 24 2021 at 17:08)</a>:</h4>
<p>which part? setting the environment variable?</p>



<a name="227638982"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/242791-t-infra/topic/Promote%20aarch64-apple-ios-sim%20to%20Tier%202/near/227638982" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jan-Erik (badboy) <a href="https://rust-lang.github.io/zulip_archive/stream/242791-t-infra/topic/Promote.20aarch64-apple-ios-sim.20to.20Tier.202.html#227638982">(Feb 24 2021 at 17:31)</a>:</h4>
<p>(might be a known issue: <a href="https://github.com/cuviper/autocfg/issues/12">https://github.com/cuviper/autocfg/issues/12</a> -- not sure why you stumbled upon it though, I wasn't able to reproduce it other than with the failing command you provided and reading the code)</p>



<a name="227691096"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/242791-t-infra/topic/Promote%20aarch64-apple-ios-sim%20to%20Tier%202/near/227691096" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Degausser <a href="https://rust-lang.github.io/zulip_archive/stream/242791-t-infra/topic/Promote.20aarch64-apple-ios-sim.20to.20Tier.202.html#227691096">(Feb 24 2021 at 23:11)</a>:</h4>
<p>Yes that env variable worked for me (<code>CARGO_FEATURE_STD=1</code>). That's really odd, but thank you so much for knowing about that!</p>



<hr><p>Last updated: Aug 07 2021 at 22:04 UTC</p>
</html>