<html>
<head><meta charset="utf-8"><title>Crater timeouts? · t-infra · Zulip Chat Archive</title></head>
<h2>Stream: <a href="https://zulip-archive.rust-lang.org/stream/242791-t-infra/index.html">t-infra</a></h2>
<h3>Topic: <a href="https://zulip-archive.rust-lang.org/stream/242791-t-infra/topic/Crater.20timeouts.3F.html">Crater timeouts?</a></h3>

<hr>

<base href="https://rust-lang.zulipchat.com">

<head><link href="https://zulip-archive.rust-lang.org/style.css" rel="stylesheet"></head>

<a name="265746221"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/242791-t-infra/topic/Crater%20timeouts%3F/near/265746221" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Notification Bot <a href="https://zulip-archive.rust-lang.org/stream/242791-t-infra/topic/Crater.20timeouts.3F.html#265746221">(Dec 21 2021 at 23:14)</a>:</h4>
<p><span class="user-mention silent" data-user-id="120827">(Saethlin) Ben Kimock</span> has marked this topic as unresolved.</p>



<a name="265864604"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/242791-t-infra/topic/Crater%20timeouts%3F/near/265864604" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> (Saethlin) Ben Kimock <a href="https://zulip-archive.rust-lang.org/stream/242791-t-infra/topic/Crater.20timeouts.3F.html#265864604">(Dec 22 2021 at 23:06)</a>:</h4>
<p>Do crater jobs run builds with 1 or multiple CPUs/jobs?</p>
<p>I tried to run crater myself to see, but it doesn't build it just OOMS.</p>



<a name="265864868"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/242791-t-infra/topic/Crater%20timeouts%3F/near/265864868" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Pietro Albini <a href="https://zulip-archive.rust-lang.org/stream/242791-t-infra/topic/Crater.20timeouts.3F.html#265864868">(Dec 22 2021 at 23:10)</a>:</h4>
<p>they spawn as many jobs as your CPU cores</p>



<a name="265871879"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/242791-t-infra/topic/Crater%20timeouts%3F/near/265871879" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> (Saethlin) Ben Kimock <a href="https://zulip-archive.rust-lang.org/stream/242791-t-infra/topic/Crater.20timeouts.3F.html#265871879">(Dec 23 2021 at 00:46)</a>:</h4>
<p>That makes sense, but I'm thinking about interpreting the crater build logs. Are those builds done with one or multiple jobs?</p>



<a name="265875758"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/242791-t-infra/topic/Crater%20timeouts%3F/near/265875758" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> simulacrum <a href="https://zulip-archive.rust-lang.org/stream/242791-t-infra/topic/Crater.20timeouts.3F.html#265875758">(Dec 23 2021 at 01:58)</a>:</h4>
<p>Multiple jobs, typically whatever the core count is on that machine</p>



<a name="265875770"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/242791-t-infra/topic/Crater%20timeouts%3F/near/265875770" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> simulacrum <a href="https://zulip-archive.rust-lang.org/stream/242791-t-infra/topic/Crater.20timeouts.3F.html#265875770">(Dec 23 2021 at 01:59)</a>:</h4>
<p>(some of our build machines have more vCPUs, some less)</p>



<a name="265885057"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/242791-t-infra/topic/Crater%20timeouts%3F/near/265885057" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> (Saethlin) Ben Kimock <a href="https://zulip-archive.rust-lang.org/stream/242791-t-infra/topic/Crater.20timeouts.3F.html#265885057">(Dec 23 2021 at 05:29)</a>:</h4>
<p>Ah. That explains some things. Is there an inconsistent memory limit on each too? Perhaps "whatever that VM happens to have"?</p>



<a name="265898871"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/242791-t-infra/topic/Crater%20timeouts%3F/near/265898871" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Pietro Albini <a href="https://zulip-archive.rust-lang.org/stream/242791-t-infra/topic/Crater.20timeouts.3F.html#265898871">(Dec 23 2021 at 09:33)</a>:</h4>
<p>there is a hard cap of I think 1.5gb?</p>



<a name="265898960"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/242791-t-infra/topic/Crater%20timeouts%3F/near/265898960" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Pietro Albini <a href="https://zulip-archive.rust-lang.org/stream/242791-t-infra/topic/Crater.20timeouts.3F.html#265898960">(Dec 23 2021 at 09:34)</a>:</h4>
<p>the machines have enough capacity for each crate to reach the quota without the host ram running out</p>



<a name="265963690"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/242791-t-infra/topic/Crater%20timeouts%3F/near/265963690" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> (Saethlin) Ben Kimock <a href="https://zulip-archive.rust-lang.org/stream/242791-t-infra/topic/Crater.20timeouts.3F.html#265963690">(Dec 23 2021 at 23:48)</a>:</h4>
<p>It looks to me like about a third of all the build-fail cases could be root-caused to the combination of too low a memory limit for the provided build parallelism. Has there been any kind of triaging or study done on the jobs that exit due to SIGKILL before? I just want to make sure I'm not repeating previous work or something.</p>



<a name="265963735"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/242791-t-infra/topic/Crater%20timeouts%3F/near/265963735" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> simulacrum <a href="https://zulip-archive.rust-lang.org/stream/242791-t-infra/topic/Crater.20timeouts.3F.html#265963735">(Dec 23 2021 at 23:49)</a>:</h4>
<p>Not to my knowledge. In general making cargo / rustc better handle low memory and reduce parallelism (i.e., not just for crater) would be great.</p>



<a name="266455228"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/242791-t-infra/topic/Crater%20timeouts%3F/near/266455228" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> (Saethlin) Ben Kimock <a href="https://zulip-archive.rust-lang.org/stream/242791-t-infra/topic/Crater.20timeouts.3F.html#266455228">(Dec 30 2021 at 20:14)</a>:</h4>
<p>Is there somewhere I can query for all crater logs from a particular crate? I'm looking at a few crates that were recently classified as "fixed" but I'm convinced they all just have flaky tests and I'm not hugely keen on clicking through the crater site.</p>



<a name="266458637"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/242791-t-infra/topic/Crater%20timeouts%3F/near/266458637" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Josh Triplett <a href="https://zulip-archive.rust-lang.org/stream/242791-t-infra/topic/Crater.20timeouts.3F.html#266458637">(Dec 30 2021 at 21:11)</a>:</h4>
<p>That does seem like it'd be a useful axis to navigate along.</p>



<a name="266463875"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/242791-t-infra/topic/Crater%20timeouts%3F/near/266463875" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> simulacrum <a href="https://zulip-archive.rust-lang.org/stream/242791-t-infra/topic/Crater.20timeouts.3F.html#266463875">(Dec 30 2021 at 22:37)</a>:</h4>
<p>No index is readily available, but e.g. beta crater runs are fairly deterministic in terms of naming scheme and so the result files for those should be at readily discoverable places.</p>
<p>If you plan to collect a bunch of crates, though, the tarballs are likely a better path - it'll be faster to download just a couple larger files, most likely.</p>



<a name="266480779"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/242791-t-infra/topic/Crater%20timeouts%3F/near/266480779" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> (Saethlin) Ben Kimock <a href="https://zulip-archive.rust-lang.org/stream/242791-t-infra/topic/Crater.20timeouts.3F.html#266480779">(Dec 31 2021 at 04:34)</a>:</h4>
<p>Hm yeah I think for now I'll just manually punch in URLs and get some shell scripts with fd and rg going</p>



<hr><p>Last updated: Apr 12 2022 at 20:01 UTC</p>
</html>