<html>
<head><meta charset="utf-8"><title>nightly docker image publishing · t-infra · Zulip Chat Archive</title></head>
<h2>Stream: <a href="https://zulip-archive.rust-lang.org/stream/242791-t-infra/index.html">t-infra</a></h2>
<h3>Topic: <a href="https://zulip-archive.rust-lang.org/stream/242791-t-infra/topic/nightly.20docker.20image.20publishing.html">nightly docker image publishing</a></h3>

<hr>

<base href="https://rust-lang.zulipchat.com">

<head><link href="https://zulip-archive.rust-lang.org/style.css" rel="stylesheet"></head>

<a name="248778853"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/242791-t-infra/topic/nightly%20docker%20image%20publishing/near/248778853" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Steven Fackler <a href="https://zulip-archive.rust-lang.org/stream/242791-t-infra/topic/nightly.20docker.20image.20publishing.html#248778853">(Aug 08 2021 at 16:52)</a>:</h4>
<p>The rustlang/rust:nightly Docker image was previously built by Docker Hub's automated build system, but that is no longer available on their default free tier. It seems like Docker does have some kind of open source program we can potentially use to gain access to it again, or we can instead create a service account and publish from GitHub Actions. <span class="user-mention" data-user-id="116122">@simulacrum</span> do you have a preference here?</p>



<a name="248778879"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/242791-t-infra/topic/nightly%20docker%20image%20publishing/near/248778879" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> simulacrum <a href="https://zulip-archive.rust-lang.org/stream/242791-t-infra/topic/nightly.20docker.20image.20publishing.html#248778879">(Aug 08 2021 at 16:53)</a>:</h4>
<p>Generally speaking I think I would lean towards GHA, and we might consider using github's native registry -- that should be simpler credential wise. But if we want to maintain the <a href="http://docker.io">docker.io</a> version shouldn't be a big deal to arrange for the right credentials</p>



<a name="248778931"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/242791-t-infra/topic/nightly%20docker%20image%20publishing/near/248778931" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Steven Fackler <a href="https://zulip-archive.rust-lang.org/stream/242791-t-infra/topic/nightly.20docker.20image.20publishing.html#248778931">(Aug 08 2021 at 16:54)</a>:</h4>
<p>Yeah according to their docs we'd basically just make a new user and add it to the rustlang team. Do you have a preference on the email address to use? <a href="mailto:infra@rust-lang.org">infra@rust-lang.org</a> or something? <a href="https://docs.docker.com/docker-hub/service-accounts/#creating-a-new-service-account">https://docs.docker.com/docker-hub/service-accounts/#creating-a-new-service-account</a></p>



<a name="248778940"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/242791-t-infra/topic/nightly%20docker%20image%20publishing/near/248778940" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Steven Fackler <a href="https://zulip-archive.rust-lang.org/stream/242791-t-infra/topic/nightly.20docker.20image.20publishing.html#248778940">(Aug 08 2021 at 16:55)</a>:</h4>
<p>Definitely up to publish to github's registry as well, but I do think we'll want to keep publishing to docker hub</p>



<a name="248778958"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/242791-t-infra/topic/nightly%20docker%20image%20publishing/near/248778958" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> simulacrum <a href="https://zulip-archive.rust-lang.org/stream/242791-t-infra/topic/nightly.20docker.20image.20publishing.html#248778958">(Aug 08 2021 at 16:55)</a>:</h4>
<p>hm</p>



<a name="248778974"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/242791-t-infra/topic/nightly%20docker%20image%20publishing/near/248778974" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> simulacrum <a href="https://zulip-archive.rust-lang.org/stream/242791-t-infra/topic/nightly.20docker.20image.20publishing.html#248778974">(Aug 08 2021 at 16:55)</a>:</h4>
<p>Could you file an issue on rust-lang/infra-team? I'd like to make sure the credentials end up in our 1pass so can create the account, likely not right this minute though</p>



<a name="248779016"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/242791-t-infra/topic/nightly%20docker%20image%20publishing/near/248779016" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Steven Fackler <a href="https://zulip-archive.rust-lang.org/stream/242791-t-infra/topic/nightly.20docker.20image.20publishing.html#248779016">(Aug 08 2021 at 16:56)</a>:</h4>
<p>Will do!</p>



<a name="248779030"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/242791-t-infra/topic/nightly%20docker%20image%20publishing/near/248779030" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Steven Fackler <a href="https://zulip-archive.rust-lang.org/stream/242791-t-infra/topic/nightly.20docker.20image.20publishing.html#248779030">(Aug 08 2021 at 16:56)</a>:</h4>
<p>I'll get the images publishing to the github registry in the meantime since I don't think that should need any extra creds</p>



<a name="248779061"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/242791-t-infra/topic/nightly%20docker%20image%20publishing/near/248779061" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Steven Fackler <a href="https://zulip-archive.rust-lang.org/stream/242791-t-infra/topic/nightly.20docker.20image.20publishing.html#248779061">(Aug 08 2021 at 16:58)</a>:</h4>
<p><a href="https://github.com/rust-lang/infra-team/issues/48">https://github.com/rust-lang/infra-team/issues/48</a></p>



<a name="248779101"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/242791-t-infra/topic/nightly%20docker%20image%20publishing/near/248779101" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> simulacrum <a href="https://zulip-archive.rust-lang.org/stream/242791-t-infra/topic/nightly.20docker.20image.20publishing.html#248779101">(Aug 08 2021 at 16:58)</a>:</h4>
<p>seems good</p>



<a name="248779124"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/242791-t-infra/topic/nightly%20docker%20image%20publishing/near/248779124" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Steven Fackler <a href="https://zulip-archive.rust-lang.org/stream/242791-t-infra/topic/nightly.20docker.20image.20publishing.html#248779124">(Aug 08 2021 at 16:59)</a>:</h4>
<p>Oh, it actually seems like we need a GitHub account to publish to their registry as well. Do we already have a GH service account with the correct rights?</p>



<a name="248779128"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/242791-t-infra/topic/nightly%20docker%20image%20publishing/near/248779128" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Steven Fackler <a href="https://zulip-archive.rust-lang.org/stream/242791-t-infra/topic/nightly.20docker.20image.20publishing.html#248779128">(Aug 08 2021 at 16:59)</a>:</h4>
<p><a href="https://docs.github.com/en/actions/guides/publishing-docker-images#publishing-images-to-github-packages">https://docs.github.com/en/actions/guides/publishing-docker-images#publishing-images-to-github-packages</a></p>



<a name="248780771"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/242791-t-infra/topic/nightly%20docker%20image%20publishing/near/248780771" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> simulacrum <a href="https://zulip-archive.rust-lang.org/stream/242791-t-infra/topic/nightly.20docker.20image.20publishing.html#248780771">(Aug 08 2021 at 17:44)</a>:</h4>
<p>It looks like you can do the <a href="http://github.actor">github.actor</a> thing?</p>



<a name="248780777"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/242791-t-infra/topic/nightly%20docker%20image%20publishing/near/248780777" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> simulacrum <a href="https://zulip-archive.rust-lang.org/stream/242791-t-infra/topic/nightly.20docker.20image.20publishing.html#248780777">(Aug 08 2021 at 17:45)</a>:</h4>
<p><span class="user-mention" data-user-id="243558">@Steven Fackler</span> <a href="https://github.com/rust-lang/crates-build-env/blob/master/.github/workflows/main.yml">https://github.com/rust-lang/crates-build-env/blob/master/.github/workflows/main.yml</a> could be an example</p>



<a name="248780810"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/242791-t-infra/topic/nightly%20docker%20image%20publishing/near/248780810" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Steven Fackler <a href="https://zulip-archive.rust-lang.org/stream/242791-t-infra/topic/nightly.20docker.20image.20publishing.html#248780810">(Aug 08 2021 at 17:45)</a>:</h4>
<p>Ah! I didn't realize secrets.GITHUB_TOKEN was provided automatically from the environment</p>



<a name="248780871"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/242791-t-infra/topic/nightly%20docker%20image%20publishing/near/248780871" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> simulacrum <a href="https://zulip-archive.rust-lang.org/stream/242791-t-infra/topic/nightly.20docker.20image.20publishing.html#248780871">(Aug 08 2021 at 17:46)</a>:</h4>
<p>yep, it's automatically configured for all github action runs</p>



<a name="248781172"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/242791-t-infra/topic/nightly%20docker%20image%20publishing/near/248781172" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Steven Fackler <a href="https://zulip-archive.rust-lang.org/stream/242791-t-infra/topic/nightly.20docker.20image.20publishing.html#248781172">(Aug 08 2021 at 17:54)</a>:</h4>
<p>woot <a href="https://github.com/rust-lang/docker-rust-nightly/pkgs/container/rust">https://github.com/rust-lang/docker-rust-nightly/pkgs/container/rust</a></p>



<hr><p>Last updated: Apr 12 2022 at 20:01 UTC</p>
</html>