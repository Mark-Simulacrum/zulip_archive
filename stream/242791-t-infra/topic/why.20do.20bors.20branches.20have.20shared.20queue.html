<html>
<head><meta charset="utf-8"><title>why do bors branches have shared queue · t-infra · Zulip Chat Archive</title></head>
<h2>Stream: <a href="https://zulip-archive.rust-lang.org/stream/242791-t-infra/index.html">t-infra</a></h2>
<h3>Topic: <a href="https://zulip-archive.rust-lang.org/stream/242791-t-infra/topic/why.20do.20bors.20branches.20have.20shared.20queue.html">why do bors branches have shared queue</a></h3>

<hr>

<base href="https://rust-lang.zulipchat.com">

<head><link href="https://zulip-archive.rust-lang.org/style.css" rel="stylesheet"></head>

<a name="267139564"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/242791-t-infra/topic/why%20do%20bors%20branches%20have%20shared%20queue/near/267139564" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Noah Lev <a href="https://zulip-archive.rust-lang.org/stream/242791-t-infra/topic/why.20do.20bors.20branches.20have.20shared.20queue.html#267139564">(Jan 07 2022 at 01:25)</a>:</h4>
<p>Why do PRs targeting different branches share the same bors queue? E.g., beta backports are behind a bunch of PRs in the queue (there are even more that are not shown in the image):</p>
<p><a href="/user_uploads/4715/dyUMTaocnc1Xgwk0RETHz4xL/image.png">image.png</a> </p>
<div class="message_inline_image"><a href="/user_uploads/4715/dyUMTaocnc1Xgwk0RETHz4xL/image.png" title="image.png"><img src="/user_uploads/4715/dyUMTaocnc1Xgwk0RETHz4xL/image.png"></a></div><p>Why is this? Is this just a limitation of bors?</p>



<a name="267139715"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/242791-t-infra/topic/why%20do%20bors%20branches%20have%20shared%20queue/near/267139715" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Eric Huss <a href="https://zulip-archive.rust-lang.org/stream/242791-t-infra/topic/why.20do.20bors.20branches.20have.20shared.20queue.html#267139715">(Jan 07 2022 at 01:27)</a>:</h4>
<p>they are sharing the same pool of hardware to run the tests. At least for rust-lang/rust, I don't think there is enough capacity to do it in parallel.</p>



<a name="267144259"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/242791-t-infra/topic/why%20do%20bors%20branches%20have%20shared%20queue/near/267144259" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Noah Lev <a href="https://zulip-archive.rust-lang.org/stream/242791-t-infra/topic/why.20do.20bors.20branches.20have.20shared.20queue.html#267144259">(Jan 07 2022 at 02:35)</a>:</h4>
<p>Hmm, I see. Does bors support parallel queues or no?</p>



<a name="267144387"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/242791-t-infra/topic/why%20do%20bors%20branches%20have%20shared%20queue/near/267144387" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Aaron Hill <a href="https://zulip-archive.rust-lang.org/stream/242791-t-infra/topic/why.20do.20bors.20branches.20have.20shared.20queue.html#267144387">(Jan 07 2022 at 02:36)</a>:</h4>
<p>I don't think so</p>



<a name="267144437"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/242791-t-infra/topic/why%20do%20bors%20branches%20have%20shared%20queue/near/267144437" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Aaron Hill <a href="https://zulip-archive.rust-lang.org/stream/242791-t-infra/topic/why.20do.20bors.20branches.20have.20shared.20queue.html#267144437">(Jan 07 2022 at 02:38)</a>:</h4>
<p>and beta builds are quite infrequent, so I think a much better use of any spare capacity would be 'speculative' builds</p>



<a name="267144508"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/242791-t-infra/topic/why%20do%20bors%20branches%20have%20shared%20queue/near/267144508" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Aaron Hill <a href="https://zulip-archive.rust-lang.org/stream/242791-t-infra/topic/why.20do.20bors.20branches.20have.20shared.20queue.html#267144508">(Jan 07 2022 at 02:38)</a>:</h4>
<p>that is, we start building the next item on the queue on the assumption that the current one is going to pass</p>



<a name="267144565"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/242791-t-infra/topic/why%20do%20bors%20branches%20have%20shared%20queue/near/267144565" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Aaron Hill <a href="https://zulip-archive.rust-lang.org/stream/242791-t-infra/topic/why.20do.20bors.20branches.20have.20shared.20queue.html#267144565">(Jan 07 2022 at 02:39)</a>:</h4>
<p>Or if we don't have <em>that</em> much capacity, then start doing more (reproducible build tests, debug assertions, etc)</p>



<a name="267145235"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/242791-t-infra/topic/why%20do%20bors%20branches%20have%20shared%20queue/near/267145235" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> The 8472 <a href="https://zulip-archive.rust-lang.org/stream/242791-t-infra/topic/why.20do.20bors.20branches.20have.20shared.20queue.html#267145235">(Jan 07 2022 at 02:50)</a>:</h4>
<p>apple builders are the bottleneck, they take 3 hours</p>



<a name="267145273"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/242791-t-infra/topic/why%20do%20bors%20branches%20have%20shared%20queue/near/267145273" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> The 8472 <a href="https://zulip-archive.rust-lang.org/stream/242791-t-infra/topic/why.20do.20bors.20branches.20have.20shared.20queue.html#267145273">(Jan 07 2022 at 02:51)</a>:</h4>
<p>and when caches get invalidated they take more than the timeout, partially populate the caches and then the next run passes</p>



<a name="267212272"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/242791-t-infra/topic/why%20do%20bors%20branches%20have%20shared%20queue/near/267212272" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Patrick Poitras <a href="https://zulip-archive.rust-lang.org/stream/242791-t-infra/topic/why.20do.20bors.20branches.20have.20shared.20queue.html#267212272">(Jan 07 2022 at 16:51)</a>:</h4>
<p><span class="user-mention" data-user-id="330154">@The 8472</span> Do we know why they take longer than other branches? We've had a bunch of timeouts from those runners before too</p>



<a name="267213566"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/242791-t-infra/topic/why%20do%20bors%20branches%20have%20shared%20queue/near/267213566" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Pietro Albini <a href="https://zulip-archive.rust-lang.org/stream/242791-t-infra/topic/why.20do.20bors.20branches.20have.20shared.20queue.html#267213566">(Jan 07 2022 at 17:01)</a>:</h4>
<p>they have half the cores</p>



<a name="267213591"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/242791-t-infra/topic/why%20do%20bors%20branches%20have%20shared%20queue/near/267213591" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Pietro Albini <a href="https://zulip-archive.rust-lang.org/stream/242791-t-infra/topic/why.20do.20bors.20branches.20have.20shared.20queue.html#267213591">(Jan 07 2022 at 17:01)</a>:</h4>
<p>and github actions doesn't have more powerful runners available</p>



<a name="267233554"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/242791-t-infra/topic/why%20do%20bors%20branches%20have%20shared%20queue/near/267233554" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Noah Lev <a href="https://zulip-archive.rust-lang.org/stream/242791-t-infra/topic/why.20do.20bors.20branches.20have.20shared.20queue.html#267233554">(Jan 07 2022 at 19:42)</a>:</h4>
<p>GitHub has some way to use custom hardware, right? Is there any way T-infra could get better Mac runners and hook them up to GHA? (I'm sure it'd be a lot of work, so I fully understand if the answer is "no".)</p>



<a name="267233769"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/242791-t-infra/topic/why%20do%20bors%20branches%20have%20shared%20queue/near/267233769" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jake Goulding <a href="https://zulip-archive.rust-lang.org/stream/242791-t-infra/topic/why.20do.20bors.20branches.20have.20shared.20queue.html#267233769">(Jan 07 2022 at 19:44)</a>:</h4>
<p>"way" - yes. "interest" - no</p>



<a name="267233976"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/242791-t-infra/topic/why%20do%20bors%20branches%20have%20shared%20queue/near/267233976" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jake Goulding <a href="https://zulip-archive.rust-lang.org/stream/242791-t-infra/topic/why.20do.20bors.20branches.20have.20shared.20queue.html#267233976">(Jan 07 2022 at 19:46)</a>:</h4>
<p>See also...</p>
<ul>
<li>##<strong>t-infra&gt;M1 macs for macOS runners</strong></li>
</ul>



<a name="267241726"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/242791-t-infra/topic/why%20do%20bors%20branches%20have%20shared%20queue/near/267241726" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Patrick Poitras <a href="https://zulip-archive.rust-lang.org/stream/242791-t-infra/topic/why.20do.20bors.20branches.20have.20shared.20queue.html#267241726">(Jan 07 2022 at 20:55)</a>:</h4>
<p>Are build times for the CI tracked anywhere?</p>



<a name="267243926"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/242791-t-infra/topic/why%20do%20bors%20branches%20have%20shared%20queue/near/267243926" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jake Goulding <a href="https://zulip-archive.rust-lang.org/stream/242791-t-infra/topic/why.20do.20bors.20branches.20have.20shared.20queue.html#267243926">(Jan 07 2022 at 21:16)</a>:</h4>
<p>See this recent comment <a href="https://github.com/rust-lang/rust/pull/92622#issuecomment-1006982237">https://github.com/rust-lang/rust/pull/92622#issuecomment-1006982237</a></p>



<hr><p>Last updated: Apr 12 2022 at 20:01 UTC</p>
</html>