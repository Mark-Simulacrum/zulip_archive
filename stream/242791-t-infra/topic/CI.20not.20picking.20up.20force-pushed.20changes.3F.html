<html>
<head><meta charset="utf-8"><title>CI not picking up force-pushed changes? · t-infra · Zulip Chat Archive</title></head>
<h2>Stream: <a href="https://zulip-archive.rust-lang.org/stream/242791-t-infra/index.html">t-infra</a></h2>
<h3>Topic: <a href="https://zulip-archive.rust-lang.org/stream/242791-t-infra/topic/CI.20not.20picking.20up.20force-pushed.20changes.3F.html">CI not picking up force-pushed changes?</a></h3>

<hr>

<base href="https://rust-lang.zulipchat.com">

<head><link href="https://zulip-archive.rust-lang.org/style.css" rel="stylesheet"></head>

<a name="275352884"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/242791-t-infra/topic/CI%20not%20picking%20up%20force-pushed%20changes%3F/near/275352884" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Simon Sapin <a href="https://zulip-archive.rust-lang.org/stream/242791-t-infra/topic/CI.20not.20picking.20up.20force-pushed.20changes.3F.html#275352884">(Mar 15 2022 at 10:13)</a>:</h4>
<p>I got a test failure on CI for a PR, amended my commit to fix it, force-pushed, but the second CI run seems to be testing the same PR again without the latest changes. Has anyone seen something like this before? <a href="https://github.com/rust-lang/rust/pull/94954#issuecomment-1067770666">https://github.com/rust-lang/rust/pull/94954#issuecomment-1067770666</a></p>



<a name="275353152"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/242791-t-infra/topic/CI%20not%20picking%20up%20force-pushed%20changes%3F/near/275353152" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Simon Sapin <a href="https://zulip-archive.rust-lang.org/stream/242791-t-infra/topic/CI.20not.20picking.20up.20force-pushed.20changes.3F.html#275353152">(Mar 15 2022 at 10:16)</a>:</h4>
<p>In <a href="https://github.com/rust-lang/rust/runs/5551345546?check_suite_focus=true#step:3:45">https://github.com/rust-lang/rust/runs/5551345546?check_suite_focus=true#step:3:45</a> it looks like CI is fetching <code>bda03e9cea4acef4df0e2a088b9af7fd09179d01</code> to <code>refs/remotes/pull/94954/merge</code> but that looks wrong:</p>
<div class="codehilite"><pre><span></span><code>$ git ls-remote origin refs/pull/94954/merge
66513a7c015e88307887eb7a981f63e66d419dcd    refs/pull/94954/merge
</code></pre></div>



<a name="275354816"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/242791-t-infra/topic/CI%20not%20picking%20up%20force-pushed%20changes%3F/near/275354816" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Simon Sapin <a href="https://zulip-archive.rust-lang.org/stream/242791-t-infra/topic/CI.20not.20picking.20up.20force-pushed.20changes.3F.html#275354816">(Mar 15 2022 at 10:32)</a>:</h4>
<p>I made a dummy push and the third CI run appears to be checking out the correct commit. Could there be a race condition between pushes and CI triggers?</p>



<a name="275379730"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/242791-t-infra/topic/CI%20not%20picking%20up%20force-pushed%20changes%3F/near/275379730" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> simulacrum <a href="https://zulip-archive.rust-lang.org/stream/242791-t-infra/topic/CI.20not.20picking.20up.20force-pushed.20changes.3F.html#275379730">(Mar 15 2022 at 14:26)</a>:</h4>
<p>I think I've seen this before, though typically it's ~impossible to reproduce, and it's pretty rare.</p>



<a name="275379761"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/242791-t-infra/topic/CI%20not%20picking%20up%20force-pushed%20changes%3F/near/275379761" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Eric Huss <a href="https://zulip-archive.rust-lang.org/stream/242791-t-infra/topic/CI.20not.20picking.20up.20force-pushed.20changes.3F.html#275379761">(Mar 15 2022 at 14:26)</a>:</h4>
<p>According to <a href="https://github.com/rust-lang/rust/compare/c0489e05bee563e89dc918faac260bfc35114e32..de147317a4e89f441378263e1abf84b34df26788">https://github.com/rust-lang/rust/compare/c0489e05bee563e89dc918faac260bfc35114e32..de147317a4e89f441378263e1abf84b34df26788</a>, the first force-push appears to be empty.  The second force-push looks to be correct (<a href="https://github.com/rust-lang/rust/compare/c0befc497aa045cf828ad88cbe9ce44b0ce3d7b2..ab13ccfbe87c88ca464f18f5b0f4d88fcc0b1fac">https://github.com/rust-lang/rust/compare/c0befc497aa045cf828ad88cbe9ce44b0ce3d7b2..ab13ccfbe87c88ca464f18f5b0f4d88fcc0b1fac</a>).</p>



<a name="275380076"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/242791-t-infra/topic/CI%20not%20picking%20up%20force-pushed%20changes%3F/near/275380076" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Eric Huss <a href="https://zulip-archive.rust-lang.org/stream/242791-t-infra/topic/CI.20not.20picking.20up.20force-pushed.20changes.3F.html#275380076">(Mar 15 2022 at 14:28)</a>:</h4>
<p>The commits <a href="https://github.com/rust-lang/rust/commit/c0489e05bee563e89dc918faac260bfc35114e32">c0489e05bee563e89dc918faac260bfc35114e32</a> and <a href="https://github.com/rust-lang/rust/commit/de147317a4e89f441378263e1abf84b34df26788">de147317a4e89f441378263e1abf84b34df26788</a> look to be identical except for the timestamp.</p>



<a name="275386105"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/242791-t-infra/topic/CI%20not%20picking%20up%20force-pushed%20changes%3F/near/275386105" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Simon Sapin <a href="https://zulip-archive.rust-lang.org/stream/242791-t-infra/topic/CI.20not.20picking.20up.20force-pushed.20changes.3F.html#275386105">(Mar 15 2022 at 15:11)</a>:</h4>
<p>I think I messed up the contents of the force-push, but still saw CI run with an unexpected merge commit hash</p>



<a name="275386145"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/242791-t-infra/topic/CI%20not%20picking%20up%20force-pushed%20changes%3F/near/275386145" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Simon Sapin <a href="https://zulip-archive.rust-lang.org/stream/242791-t-infra/topic/CI.20not.20picking.20up.20force-pushed.20changes.3F.html#275386145">(Mar 15 2022 at 15:11)</a>:</h4>
<p>Anyway, it’s green now</p>



<hr><p>Last updated: Apr 12 2022 at 20:01 UTC</p>
</html>