<html>
<head><meta charset="utf-8"><title>psql rds · t-infra · Zulip Chat Archive</title></head>
<h2>Stream: <a href="https://zulip-archive.rust-lang.org/stream/242791-t-infra/index.html">t-infra</a></h2>
<h3>Topic: <a href="https://zulip-archive.rust-lang.org/stream/242791-t-infra/topic/psql.20rds.html">psql rds</a></h3>

<hr>

<base href="https://rust-lang.zulipchat.com">

<head><link href="https://zulip-archive.rust-lang.org/style.css" rel="stylesheet"></head>

<a name="207866379"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/242791-t-infra/topic/psql%20rds/near/207866379" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Pietro Albini <a href="https://zulip-archive.rust-lang.org/stream/242791-t-infra/topic/psql.20rds.html#207866379">(Aug 24 2020 at 16:47)</a>:</h4>
<p><a href="/user_uploads/4715/GOqu1QJGXTdeuG-k_GbojBpq/2020-08-24-18-46-31.png">2020-08-24-18-46-31.png</a></p>
<div class="message_inline_image"><a href="/user_uploads/4715/GOqu1QJGXTdeuG-k_GbojBpq/2020-08-24-18-46-31.png" title="2020-08-24-18-46-31.png"><img src="/user_uploads/4715/GOqu1QJGXTdeuG-k_GbojBpq/2020-08-24-18-46-31.png"></a></div>



<a name="207866389"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/242791-t-infra/topic/psql%20rds/near/207866389" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Pietro Albini <a href="https://zulip-archive.rust-lang.org/stream/242791-t-infra/topic/psql.20rds.html#207866389">(Aug 24 2020 at 16:47)</a>:</h4>
<p><span class="user-mention" data-user-id="116122">@simulacrum</span> ^</p>



<a name="207866425"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/242791-t-infra/topic/psql%20rds/near/207866425" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> simulacrum <a href="https://zulip-archive.rust-lang.org/stream/242791-t-infra/topic/psql.20rds.html#207866425">(Aug 24 2020 at 16:47)</a>:</h4>
<p>Seems great!</p>



<a name="207866436"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/242791-t-infra/topic/psql%20rds/near/207866436" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Pietro Albini <a href="https://zulip-archive.rust-lang.org/stream/242791-t-infra/topic/psql.20rds.html#207866436">(Aug 24 2020 at 16:47)</a>:</h4>
<p>it fetches the creds from parameter store, ssh into the bastion and runs psql on it</p>



<a name="207866469"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/242791-t-infra/topic/psql%20rds/near/207866469" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Pietro Albini <a href="https://zulip-archive.rust-lang.org/stream/242791-t-infra/topic/psql.20rds.html#207866469">(Aug 24 2020 at 16:47)</a>:</h4>
<p>so there are no problems with port forwarding and having multiple forwards with the same port</p>



<a name="207866470"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/242791-t-infra/topic/psql%20rds/near/207866470" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> simulacrum <a href="https://zulip-archive.rust-lang.org/stream/242791-t-infra/topic/psql.20rds.html#207866470">(Aug 24 2020 at 16:48)</a>:</h4>
<p>Hm though I would hope we could run psql locally, or upgrade bastion</p>



<a name="207866528"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/242791-t-infra/topic/psql%20rds/near/207866528" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Pietro Albini <a href="https://zulip-archive.rust-lang.org/stream/242791-t-infra/topic/psql.20rds.html#207866528">(Aug 24 2020 at 16:48)</a>:</h4>
<p>well we should upgrade the bastion</p>



<a name="207866553"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/242791-t-infra/topic/psql%20rds/near/207866553" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Pietro Albini <a href="https://zulip-archive.rust-lang.org/stream/242791-t-infra/topic/psql.20rds.html#207866553">(Aug 24 2020 at 16:48)</a>:</h4>
<p>I tried with running psql locally, but ssh doesn't like having multiple forwards to the same ip:port</p>



<a name="207866566"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/242791-t-infra/topic/psql%20rds/near/207866566" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> simulacrum <a href="https://zulip-archive.rust-lang.org/stream/242791-t-infra/topic/psql.20rds.html#207866566">(Aug 24 2020 at 16:48)</a>:</h4>
<p>Yeah :/</p>



<a name="207866591"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/242791-t-infra/topic/psql%20rds/near/207866591" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> simulacrum <a href="https://zulip-archive.rust-lang.org/stream/242791-t-infra/topic/psql.20rds.html#207866591">(Aug 24 2020 at 16:48)</a>:</h4>
<p>r=me on the PR then with this tool included</p>



<a name="207866593"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/242791-t-infra/topic/psql%20rds/near/207866593" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Pietro Albini <a href="https://zulip-archive.rust-lang.org/stream/242791-t-infra/topic/psql.20rds.html#207866593">(Aug 24 2020 at 16:48)</a>:</h4>
<p>and that would've been <em>bad</em> since we practically leak forwards with the terraform setup</p>



<a name="207866628"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/242791-t-infra/topic/psql%20rds/near/207866628" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> simulacrum <a href="https://zulip-archive.rust-lang.org/stream/242791-t-infra/topic/psql.20rds.html#207866628">(Aug 24 2020 at 16:49)</a>:</h4>
<p>Bastion upgrade isn't urgent, the version mismatch won't matter for 99% of things</p>



<a name="207866738"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/242791-t-infra/topic/psql%20rds/near/207866738" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Pietro Albini <a href="https://zulip-archive.rust-lang.org/stream/242791-t-infra/topic/psql.20rds.html#207866738">(Aug 24 2020 at 16:50)</a>:</h4>
<p>I see it breaks <code>\d table_name</code> which is kinda annoying</p>



<a name="207866817"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/242791-t-infra/topic/psql%20rds/near/207866817" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> simulacrum <a href="https://zulip-archive.rust-lang.org/stream/242791-t-infra/topic/psql.20rds.html#207866817">(Aug 24 2020 at 16:50)</a>:</h4>
<p>Hm well, I mean, it shouldn't be too hard to upgrade bastion - we're deploying that with uh the tool right? Not manual config</p>



<a name="207866845"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/242791-t-infra/topic/psql%20rds/near/207866845" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Pietro Albini <a href="https://zulip-archive.rust-lang.org/stream/242791-t-infra/topic/psql.20rds.html#207866845">(Aug 24 2020 at 16:51)</a>:</h4>
<p>yeah it's using ansible</p>



<a name="207866892"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/242791-t-infra/topic/psql%20rds/near/207866892" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Pietro Albini <a href="https://zulip-archive.rust-lang.org/stream/242791-t-infra/topic/psql.20rds.html#207866892">(Aug 24 2020 at 16:51)</a>:</h4>
<p>I guess I could do it in the coming days</p>



<a name="207867036"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/242791-t-infra/topic/psql%20rds/near/207867036" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> simulacrum <a href="https://zulip-archive.rust-lang.org/stream/242791-t-infra/topic/psql.20rds.html#207867036">(Aug 24 2020 at 16:52)</a>:</h4>
<p>I don't personally use \d table name much I think</p>



<a name="207868855"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/242791-t-infra/topic/psql%20rds/near/207868855" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Nelson <a href="https://zulip-archive.rust-lang.org/stream/242791-t-infra/topic/psql.20rds.html#207868855">(Aug 24 2020 at 17:09)</a>:</h4>
<p>/me uses \d a lot, but is also not on the infra team</p>



<a name="207869070"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/242791-t-infra/topic/psql%20rds/near/207869070" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Pietro Albini <a href="https://zulip-archive.rust-lang.org/stream/242791-t-infra/topic/psql.20rds.html#207869070">(Aug 24 2020 at 17:11)</a>:</h4>
<p>gah <code>sshd</code> doesn't support <code>Include</code> in ubuntu 18.04</p>



<a name="207869084"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/242791-t-infra/topic/psql%20rds/near/207869084" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Pietro Albini <a href="https://zulip-archive.rust-lang.org/stream/242791-t-infra/topic/psql.20rds.html#207869084">(Aug 24 2020 at 17:11)</a>:</h4>
<p>I guess I'll upgrade the bastion tomorrow...</p>



<a name="207869111"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/242791-t-infra/topic/psql%20rds/near/207869111" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Pietro Albini <a href="https://zulip-archive.rust-lang.org/stream/242791-t-infra/topic/psql.20rds.html#207869111">(Aug 24 2020 at 17:11)</a>:</h4>
<p>(I need include to allow passing the psql password as an environment variable)</p>



<a name="207931698"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/242791-t-infra/topic/psql%20rds/near/207931698" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Pietro Albini <a href="https://zulip-archive.rust-lang.org/stream/242791-t-infra/topic/psql.20rds.html#207931698">(Aug 25 2020 at 07:24)</a>:</h4>
<p>recreating the bastion from scratch</p>



<a name="207932685"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/242791-t-infra/topic/psql%20rds/near/207932685" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Pietro Albini <a href="https://zulip-archive.rust-lang.org/stream/242791-t-infra/topic/psql.20rds.html#207932685">(Aug 25 2020 at 07:39)</a>:</h4>
<p><span class="user-mention" data-user-id="116122">@simulacrum</span> <span class="user-mention" data-user-id="116155">@Jake Goulding</span> <span class="user-mention" data-user-id="117568">@Aidan Hobson Sayers</span> <span class="user-mention" data-user-id="232545">@Joshua Nelson</span> recreated the bastion with ubuntu 20.04, which recreated the ssh host key</p>



<hr><p>Last updated: Apr 12 2022 at 20:01 UTC</p>
</html>