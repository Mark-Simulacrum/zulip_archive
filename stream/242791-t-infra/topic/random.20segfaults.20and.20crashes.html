<html>
<head><meta charset="utf-8"><title>random segfaults and crashes · t-infra · Zulip Chat Archive</title></head>
<h2>Stream: <a href="https://zulip-archive.rust-lang.org/stream/242791-t-infra/index.html">t-infra</a></h2>
<h3>Topic: <a href="https://zulip-archive.rust-lang.org/stream/242791-t-infra/topic/random.20segfaults.20and.20crashes.html">random segfaults and crashes</a></h3>

<hr>

<base href="https://rust-lang.zulipchat.com">

<head><link href="https://zulip-archive.rust-lang.org/style.css" rel="stylesheet"></head>

<a name="261355416"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/242791-t-infra/topic/random%20segfaults%20and%20crashes/near/261355416" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> matthiaskrgr <a href="https://zulip-archive.rust-lang.org/stream/242791-t-infra/topic/random.20segfaults.20and.20crashes.html#261355416">(Nov 13 2021 at 11:22)</a>:</h4>
<p><a href="https://github.com/rust-lang/rust/issues/90812">https://github.com/rust-lang/rust/issues/90812</a><br>
any ideas what could cause this?</p>



<a name="261356971"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/242791-t-infra/topic/random%20segfaults%20and%20crashes/near/261356971" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> The 8472 <a href="https://zulip-archive.rust-lang.org/stream/242791-t-infra/topic/random.20segfaults.20and.20crashes.html#261356971">(Nov 13 2021 at 12:02)</a>:</h4>
<p>one of the crashes has a glibc malloc validation failing, i.e. it's some flavor of heap corruption</p>



<a name="261357059"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/242791-t-infra/topic/random%20segfaults%20and%20crashes/near/261357059" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> The 8472 <a href="https://zulip-archive.rust-lang.org/stream/242791-t-infra/topic/random.20segfaults.20and.20crashes.html#261357059">(Nov 13 2021 at 12:05)</a>:</h4>
<p>but they're happening in stage 0 and stage 1 rustc</p>



<a name="261357147"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/242791-t-infra/topic/random%20segfaults%20and%20crashes/near/261357147" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> The 8472 <a href="https://zulip-archive.rust-lang.org/stream/242791-t-infra/topic/random.20segfaults.20and.20crashes.html#261357147">(Nov 13 2021 at 12:06)</a>:</h4>
<p>If this only started happening recently then it might be a native lib that got updated. or something that landed and got backported to beta too</p>



<a name="261357432"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/242791-t-infra/topic/random%20segfaults%20and%20crashes/near/261357432" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> The 8472 <a href="https://zulip-archive.rust-lang.org/stream/242791-t-infra/topic/random.20segfaults.20and.20crashes.html#261357432">(Nov 13 2021 at 12:14)</a>:</h4>
<p>Last beta commit was 12 days ago, so that shouldn't be it.</p>



<a name="261357676"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/242791-t-infra/topic/random%20segfaults%20and%20crashes/near/261357676" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Hans Kratz <a href="https://zulip-archive.rust-lang.org/stream/242791-t-infra/topic/random.20segfaults.20and.20crashes.html#261357676">(Nov 13 2021 at 12:21)</a>:</h4>
<p>It would be great if we had a lightweight Rust library with which we could capture the stacktraces of all threads on segfaults. AFAICS there is currently only crashpad and friends.</p>



<a name="261357783"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/242791-t-infra/topic/random%20segfaults%20and%20crashes/near/261357783" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> The 8472 <a href="https://zulip-archive.rust-lang.org/stream/242791-t-infra/topic/random.20segfaults.20and.20crashes.html#261357783">(Nov 13 2021 at 12:24)</a>:</h4>
<p>it says core dumped. getting the core dumps as CI artifacts would help too</p>



<a name="261357895"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/242791-t-infra/topic/random%20segfaults%20and%20crashes/near/261357895" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Hans Kratz <a href="https://zulip-archive.rust-lang.org/stream/242791-t-infra/topic/random.20segfaults.20and.20crashes.html#261357895">(Nov 13 2021 at 12:27)</a>:</h4>
<p>The lone core file is usually not enough. You also need the binary and all dynamic libraries + debug information.</p>



<a name="261358022"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/242791-t-infra/topic/random%20segfaults%20and%20crashes/near/261358022" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> The 8472 <a href="https://zulip-archive.rust-lang.org/stream/242791-t-infra/topic/random.20segfaults.20and.20crashes.html#261358022">(Nov 13 2021 at 12:30)</a>:</h4>
<p>The needed files could be enumerated from the core format and bundled along with it. But yeah, the money option would be to keep the CI runner going after a crash and let someone SSH into it to just gdb the core dump there.</p>



<a name="261358091"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/242791-t-infra/topic/random%20segfaults%20and%20crashes/near/261358091" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Pietro Albini <a href="https://zulip-archive.rust-lang.org/stream/242791-t-infra/topic/random.20segfaults.20and.20crashes.html#261358091">(Nov 13 2021 at 12:32)</a>:</h4>
<p><span class="user-mention silent" data-user-id="330154">The 8472</span> <a href="#narrow/stream/242791-t-infra/topic/random.20segfaults.20and.20crashes/near/261358022">said</a>:</p>
<blockquote>
<p>The needed files could be enumerated from the core format and bundled along with it. But yeah, the money option would be to keep the CI runner going after a crash and let someone SSH into it to just gdb the core dump there.</p>
</blockquote>
<p>runners have credentials in them, we don't really want to let people ssh into them</p>



<a name="261358154"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/242791-t-infra/topic/random%20segfaults%20and%20crashes/near/261358154" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> The 8472 <a href="https://zulip-archive.rust-lang.org/stream/242791-t-infra/topic/random.20segfaults.20and.20crashes.html#261358154">(Nov 13 2021 at 12:34)</a>:</h4>
<p>well, then core dumps would also be a problem since they'd contain the environment variables</p>



<a name="261408377"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/242791-t-infra/topic/random%20segfaults%20and%20crashes/near/261408377" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> matthiaskrgr <a href="https://zulip-archive.rust-lang.org/stream/242791-t-infra/topic/random.20segfaults.20and.20crashes.html#261408377">(Nov 14 2021 at 09:38)</a>:</h4>
<p>cc <a href="#narrow/stream/122651-general/topic/rustc.20SIGSEGV.20during.20'Building.20stage1.20std.20artifacts">https://rust-lang.zulipchat.com/#narrow/stream/122651-general/topic/rustc.20SIGSEGV.20during.20'Building.20stage1.20std.20artifacts</a>'</p>



<a name="261913296"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/242791-t-infra/topic/random%20segfaults%20and%20crashes/near/261913296" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Hans Kratz <a href="https://zulip-archive.rust-lang.org/stream/242791-t-infra/topic/random.20segfaults.20and.20crashes.html#261913296">(Nov 18 2021 at 11:08)</a>:</h4>
<p>We haven't seen this for two days now. Anyone any idea why it started happening and subsequently stopped?</p>



<hr><p>Last updated: Apr 12 2022 at 20:01 UTC</p>
</html>