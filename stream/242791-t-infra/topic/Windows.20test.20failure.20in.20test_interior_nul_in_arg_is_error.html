<html>
<head><meta charset="utf-8"><title>Windows test failure in test_interior_nul_in_arg_is_error · t-infra · Zulip Chat Archive</title></head>
<h2>Stream: <a href="https://zulip-archive.rust-lang.org/stream/242791-t-infra/index.html">t-infra</a></h2>
<h3>Topic: <a href="https://zulip-archive.rust-lang.org/stream/242791-t-infra/topic/Windows.20test.20failure.20in.20test_interior_nul_in_arg_is_error.html">Windows test failure in test_interior_nul_in_arg_is_error</a></h3>

<hr>

<base href="https://rust-lang.zulipchat.com">

<head><link href="https://zulip-archive.rust-lang.org/style.css" rel="stylesheet"></head>

<a name="265793972"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/242791-t-infra/topic/Windows%20test%20failure%20in%20test_interior_nul_in_arg_is_error/near/265793972" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> RalfJ <a href="https://zulip-archive.rust-lang.org/stream/242791-t-infra/topic/Windows.20test.20failure.20in.20test_interior_nul_in_arg_is_error.html#265793972">(Dec 22 2021 at 11:34)</a>:</h4>
<p>A lot of PRs seem to fail bors with the same error currently:<br>
<a href="https://github.com/rust-lang/rust/pulls?q=is%3Apr+is%3Aopen+test_interior_nul_in_arg_is_error">https://github.com/rust-lang/rust/pulls?q=is%3Apr+is%3Aopen+test_interior_nul_in_arg_is_error</a></p>



<a name="265818549"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/242791-t-infra/topic/Windows%20test%20failure%20in%20test_interior_nul_in_arg_is_error/near/265818549" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Chris Denton <a href="https://zulip-archive.rust-lang.org/stream/242791-t-infra/topic/Windows.20test.20failure.20in.20test_interior_nul_in_arg_is_error.html#265818549">(Dec 22 2021 at 15:42)</a>:</h4>
<p>Hm, looking at those tests I'd guess the most likely explanation is that <code>rustc</code> is not in the test's PATH for some reason.</p>



<a name="265827778"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/242791-t-infra/topic/Windows%20test%20failure%20in%20test_interior_nul_in_arg_is_error/near/265827778" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Eric Huss <a href="https://zulip-archive.rust-lang.org/stream/242791-t-infra/topic/Windows.20test.20failure.20in.20test_interior_nul_in_arg_is_error.html#265827778">(Dec 22 2021 at 17:05)</a>:</h4>
<p>Closed the tree</p>



<a name="265830422"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/242791-t-infra/topic/Windows%20test%20failure%20in%20test_interior_nul_in_arg_is_error/near/265830422" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Eric Huss <a href="https://zulip-archive.rust-lang.org/stream/242791-t-infra/topic/Windows.20test.20failure.20in.20test_interior_nul_in_arg_is_error.html#265830422">(Dec 22 2021 at 17:28)</a>:</h4>
<p>Does anyone know how these tests work at all?  How does <code>rustc</code> get into PATH?</p>



<a name="265831294"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/242791-t-infra/topic/Windows%20test%20failure%20in%20test_interior_nul_in_arg_is_error/near/265831294" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Chris Denton <a href="https://zulip-archive.rust-lang.org/stream/242791-t-infra/topic/Windows.20test.20failure.20in.20test_interior_nul_in_arg_is_error.html#265831294">(Dec 22 2021 at 17:36)</a>:</h4>
<p>I would just add that all we need is some application that will be in PATH on every supported platform. This would need to be something supplied by Rust for non-POSIX systems. A simple implementation of, e.g. echo would do it.</p>



<a name="265831416"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/242791-t-infra/topic/Windows%20test%20failure%20in%20test_interior_nul_in_arg_is_error/near/265831416" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> simulacrum <a href="https://zulip-archive.rust-lang.org/stream/242791-t-infra/topic/Windows.20test.20failure.20in.20test_interior_nul_in_arg_is_error.html#265831416">(Dec 22 2021 at 17:37)</a>:</h4>
<p>Hm, it seems like it may be easiest to compile hello world and put that into path ourselves for these tests if we need that kind of guarantee...</p>



<a name="265831522"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/242791-t-infra/topic/Windows%20test%20failure%20in%20test_interior_nul_in_arg_is_error/near/265831522" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Eric Huss <a href="https://zulip-archive.rust-lang.org/stream/242791-t-infra/topic/Windows.20test.20failure.20in.20test_interior_nul_in_arg_is_error.html#265831522">(Dec 22 2021 at 17:38)</a>:</h4>
<p>For a unit test, I think that would be a bit awkward.  We do that in cargo's testsuite, but it is not very clean.  (We have a dummy "echo" binary.)</p>



<a name="265831817"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/242791-t-infra/topic/Windows%20test%20failure%20in%20test_interior_nul_in_arg_is_error/near/265831817" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> simulacrum <a href="https://zulip-archive.rust-lang.org/stream/242791-t-infra/topic/Windows.20test.20failure.20in.20test_interior_nul_in_arg_is_error.html#265831817">(Dec 22 2021 at 17:41)</a>:</h4>
<p>Yeah, that would likely mean wanting to move it to a UI test. Obviously, that has its own difficulties (e.g., with private item access etc)</p>



<a name="265831835"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/242791-t-infra/topic/Windows%20test%20failure%20in%20test_interior_nul_in_arg_is_error/near/265831835" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> simulacrum <a href="https://zulip-archive.rust-lang.org/stream/242791-t-infra/topic/Windows.20test.20failure.20in.20test_interior_nul_in_arg_is_error.html#265831835">(Dec 22 2021 at 17:41)</a>:</h4>
<p>it should be fine to have some cfg's though if necessary to get something that "should" be in PATH...</p>



<a name="265833163"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/242791-t-infra/topic/Windows%20test%20failure%20in%20test_interior_nul_in_arg_is_error/near/265833163" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Chris Denton <a href="https://zulip-archive.rust-lang.org/stream/242791-t-infra/topic/Windows.20test.20failure.20in.20test_interior_nul_in_arg_is_error.html#265833163">(Dec 22 2021 at 17:54)</a>:</h4>
<p>The complicating factor would be the Windows resolver tests. Those tests need something that's in PATH but not in system directories.</p>



<a name="265833398"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/242791-t-infra/topic/Windows%20test%20failure%20in%20test_interior_nul_in_arg_is_error/near/265833398" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Eric Huss <a href="https://zulip-archive.rust-lang.org/stream/242791-t-infra/topic/Windows.20test.20failure.20in.20test_interior_nul_in_arg_is_error.html#265833398">(Dec 22 2021 at 17:56)</a>:</h4>
<p>Does it need a valid executable?  If not, it could just create a temp directory, add an empty file, and check how it resolves.</p>



<a name="265833452"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/242791-t-infra/topic/Windows%20test%20failure%20in%20test_interior_nul_in_arg_is_error/near/265833452" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Chris Denton <a href="https://zulip-archive.rust-lang.org/stream/242791-t-infra/topic/Windows.20test.20failure.20in.20test_interior_nul_in_arg_is_error.html#265833452">(Dec 22 2021 at 17:57)</a>:</h4>
<p>Yeah, that'll work.</p>



<a name="265835138"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/242791-t-infra/topic/Windows%20test%20failure%20in%20test_interior_nul_in_arg_is_error/near/265835138" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Eric Huss <a href="https://zulip-archive.rust-lang.org/stream/242791-t-infra/topic/Windows.20test.20failure.20in.20test_interior_nul_in_arg_is_error.html#265835138">(Dec 22 2021 at 18:10)</a>:</h4>
<p>It looks like there was a new windows image release: <a href="https://github.com/actions/virtual-environments/releases/tag/win19%2F20211219.1">https://github.com/actions/virtual-environments/releases/tag/win19%2F20211219.1</a></p>



<a name="265835162"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/242791-t-infra/topic/Windows%20test%20failure%20in%20test_interior_nul_in_arg_is_error/near/265835162" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Eric Huss <a href="https://zulip-archive.rust-lang.org/stream/242791-t-infra/topic/Windows.20test.20failure.20in.20test_interior_nul_in_arg_is_error.html#265835162">(Dec 22 2021 at 18:10)</a>:</h4>
<p>Which updated the OS version from build 2300 to 2366</p>



<a name="265835169"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/242791-t-infra/topic/Windows%20test%20failure%20in%20test_interior_nul_in_arg_is_error/near/265835169" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Eric Huss <a href="https://zulip-archive.rust-lang.org/stream/242791-t-infra/topic/Windows.20test.20failure.20in.20test_interior_nul_in_arg_is_error.html#265835169">(Dec 22 2021 at 18:10)</a>:</h4>
<p>What a weird thing for windows to change.</p>



<a name="265835677"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/242791-t-infra/topic/Windows%20test%20failure%20in%20test_interior_nul_in_arg_is_error/near/265835677" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Eric Huss <a href="https://zulip-archive.rust-lang.org/stream/242791-t-infra/topic/Windows.20test.20failure.20in.20test_interior_nul_in_arg_is_error.html#265835677">(Dec 22 2021 at 18:15)</a>:</h4>
<p>i'm going to be gone for a couple hours, so i wont be able to follow up until later</p>



<a name="265841435"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/242791-t-infra/topic/Windows%20test%20failure%20in%20test_interior_nul_in_arg_is_error/near/265841435" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Chris Denton <a href="https://zulip-archive.rust-lang.org/stream/242791-t-infra/topic/Windows.20test.20failure.20in.20test_interior_nul_in_arg_is_error.html#265841435">(Dec 22 2021 at 19:13)</a>:</h4>
<p>I PR'd <a href="https://github.com/rust-lang/rust/issues/92201">#92201</a> which should hopefully get the queue moving again.</p>



<a name="265860622"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/242791-t-infra/topic/Windows%20test%20failure%20in%20test_interior_nul_in_arg_is_error/near/265860622" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Eric Huss <a href="https://zulip-archive.rust-lang.org/stream/242791-t-infra/topic/Windows.20test.20failure.20in.20test_interior_nul_in_arg_is_error.html#265860622">(Dec 22 2021 at 22:20)</a>:</h4>
<p>Thanks <span class="user-mention" data-user-id="260325">@Chris Denton</span>!</p>



<hr><p>Last updated: Apr 12 2022 at 20:01 UTC</p>
</html>