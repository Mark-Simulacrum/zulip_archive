<html>
<head><meta charset="utf-8"><title>Improve defaults in x.py compiler-team#326 · t-compiler/major changes · Zulip Chat Archive</title></head>
<h2>Stream: <a href="https://zulip-archive.rust-lang.org/stream/233931-t-compiler/major-changes/index.html">t-compiler/major changes</a></h2>
<h3>Topic: <a href="https://zulip-archive.rust-lang.org/stream/233931-t-compiler/major-changes/topic/Improve.20defaults.20in.20x.2Epy.20compiler-team.23326.html">Improve defaults in x.py compiler-team#326</a></h3>

<hr>

<base href="https://rust-lang.zulipchat.com">

<head><link href="https://zulip-archive.rust-lang.org/style.css" rel="stylesheet"></head>

<a name="202697308"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/233931-t-compiler/major%20changes/topic/Improve%20defaults%20in%20x.py%20compiler-team%23326/near/202697308" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Nelson <a href="https://zulip-archive.rust-lang.org/stream/233931-t-compiler/major-changes/topic/Improve.20defaults.20in.20x.2Epy.20compiler-team.23326.html#202697308">(Jul 02 2020 at 14:40)</a>:</h4>
<blockquote>
<p>That the compiler built with --stage 1 (or without, since the proposal makes it the default) won't be able to compile code that requires the standard library?</p>
</blockquote>
<p>That is the current behavior: the stage2 compiler (stage1 artifact) will not have a working libcore. My proposal is to always build libstd+libcore at the same time as the compiler, since the current situation of compiler without libcore is not very useful.</p>



<a name="202702672"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/233931-t-compiler/major%20changes/topic/Improve%20defaults%20in%20x.py%20compiler-team%23326/near/202702672" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> mark-i-m <a href="https://zulip-archive.rust-lang.org/stream/233931-t-compiler/major-changes/topic/Improve.20defaults.20in.20x.2Epy.20compiler-team.23326.html#202702672">(Jul 02 2020 at 15:20)</a>:</h4>
<p>My major concern here is that we would be defaulting to technically unsound builds, right? e.g. a stage 1 compiler might not always work correctly</p>



<a name="202705822"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/233931-t-compiler/major%20changes/topic/Improve%20defaults%20in%20x.py%20compiler-team%23326/near/202705822" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> simulacrum <a href="https://zulip-archive.rust-lang.org/stream/233931-t-compiler/major-changes/topic/Improve.20defaults.20in.20x.2Epy.20compiler-team.23326.html#202705822">(Jul 02 2020 at 15:42)</a>:</h4>
<p>no, it should always work correctly</p>



<a name="202705910"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/233931-t-compiler/major%20changes/topic/Improve%20defaults%20in%20x.py%20compiler-team%23326/near/202705910" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> simulacrum <a href="https://zulip-archive.rust-lang.org/stream/233931-t-compiler/major-changes/topic/Improve.20defaults.20in.20x.2Epy.20compiler-team.23326.html#202705910">(Jul 02 2020 at 15:43)</a>:</h4>
<p>it's just that you're not perfectly matching what users see -- in particular, if you break the compiler (codegen, mostly) in such a way that std isn't affected but the compiler itself is you could miss that</p>



<a name="202705941"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/233931-t-compiler/major%20changes/topic/Improve%20defaults%20in%20x.py%20compiler-team%23326/near/202705941" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> simulacrum <a href="https://zulip-archive.rust-lang.org/stream/233931-t-compiler/major-changes/topic/Improve.20defaults.20in.20x.2Epy.20compiler-team.23326.html#202705941">(Jul 02 2020 at 15:43)</a>:</h4>
<p>but since CI will still be checking stage2, this isn't all that big a concern imo</p>



<a name="202705979"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/233931-t-compiler/major%20changes/topic/Improve%20defaults%20in%20x.py%20compiler-team%23326/near/202705979" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> simulacrum <a href="https://zulip-archive.rust-lang.org/stream/233931-t-compiler/major-changes/topic/Improve.20defaults.20in.20x.2Epy.20compiler-team.23326.html#202705979">(Jul 02 2020 at 15:43)</a>:</h4>
<p>it used to be that stage2 was needed for proc macros because they linked against the compiler itself, but that's also no longer true</p>



<a name="202742796"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/233931-t-compiler/major%20changes/topic/Improve%20defaults%20in%20x.py%20compiler-team%23326/near/202742796" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> mark-i-m <a href="https://zulip-archive.rust-lang.org/stream/233931-t-compiler/major-changes/topic/Improve.20defaults.20in.20x.2Epy.20compiler-team.23326.html#202742796">(Jul 02 2020 at 20:49)</a>:</h4>
<p>That's good to know, but I feel like I've seen tests fail at stage 1 and not on stage 2 before (though it's been a while since that happened last)</p>



<a name="202743193"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/233931-t-compiler/major%20changes/topic/Improve%20defaults%20in%20x.py%20compiler-team%23326/near/202743193" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> simulacrum <a href="https://zulip-archive.rust-lang.org/stream/233931-t-compiler/major-changes/topic/Improve.20defaults.20in.20x.2Epy.20compiler-team.23326.html#202743193">(Jul 02 2020 at 20:52)</a>:</h4>
<p>that should only be if the test does e.g. <code>extern crate rustc_metadata;</code> or similar. Everything else is almost certainly a bug these days</p>



<a name="202743410"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/233931-t-compiler/major%20changes/topic/Improve%20defaults%20in%20x.py%20compiler-team%23326/near/202743410" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> mark-i-m <a href="https://zulip-archive.rust-lang.org/stream/233931-t-compiler/major-changes/topic/Improve.20defaults.20in.20x.2Epy.20compiler-team.23326.html#202743410">(Jul 02 2020 at 20:55)</a>:</h4>
<p>Ok, I will be on the watch for that next time I build locally</p>



<a name="202744442"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/233931-t-compiler/major%20changes/topic/Improve%20defaults%20in%20x.py%20compiler-team%23326/near/202744442" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/233931-t-compiler/major-changes/topic/Improve.20defaults.20in.20x.2Epy.20compiler-team.23326.html#202744442">(Jul 02 2020 at 21:05)</a>:</h4>
<p>I feel pretty good about these defaults.</p>



<a name="202745715"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/233931-t-compiler/major%20changes/topic/Improve%20defaults%20in%20x.py%20compiler-team%23326/near/202745715" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Nelson <a href="https://zulip-archive.rust-lang.org/stream/233931-t-compiler/major-changes/topic/Improve.20defaults.20in.20x.2Epy.20compiler-team.23326.html#202745715">(Jul 02 2020 at 21:17)</a>:</h4>
<p>There was some feedback in <a href="https://github.com/rust-lang/rust/pull/73964#issuecomment-653134345">https://github.com/rust-lang/rust/pull/73964#issuecomment-653134345</a> that <code>debug = true</code> makes the fast path for "run all the tests" slightly slower. Personally I would find it hard to debug things without <code>RUST_LOG=debug</code> but since this is only a default I'm fine <del>changing it</del> keeping it as is.</p>



<a name="202762667"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/233931-t-compiler/major%20changes/topic/Improve%20defaults%20in%20x.py%20compiler-team%23326/near/202762667" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Josh Triplett <a href="https://zulip-archive.rust-lang.org/stream/233931-t-compiler/major-changes/topic/Improve.20defaults.20in.20x.2Epy.20compiler-team.23326.html#202762667">(Jul 03 2020 at 02:06)</a>:</h4>
<p>Is there some way we could compile in enough support for <code>RUST_LOG=debug</code> without actually having debug symbols?</p>



<a name="202762678"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/233931-t-compiler/major%20changes/topic/Improve%20defaults%20in%20x.py%20compiler-team%23326/near/202762678" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Josh Triplett <a href="https://zulip-archive.rust-lang.org/stream/233931-t-compiler/major-changes/topic/Improve.20defaults.20in.20x.2Epy.20compiler-team.23326.html#202762678">(Jul 03 2020 at 02:07)</a>:</h4>
<p>Otherwise this seems great to me. I would just like to further reduce build time and link time, if we can.</p>



<a name="202768616"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/233931-t-compiler/major%20changes/topic/Improve%20defaults%20in%20x.py%20compiler-team%23326/near/202768616" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Nelson <a href="https://zulip-archive.rust-lang.org/stream/233931-t-compiler/major-changes/topic/Improve.20defaults.20in.20x.2Epy.20compiler-team.23326.html#202768616">(Jul 03 2020 at 04:50)</a>:</h4>
<p><span class="user-mention" data-user-id="239881">@Josh Triplett</span> we could set <code>debug = true</code> and <code>debuginfo = 0</code>. That would still have debug assertions but I think that's a good thing, if you're breaking invariants during tests you should know about it.</p>
<p>It would be great to have some statistics on how much time debuginfo = 1 adds to the build, if it's 10 seconds out of a 5 minute build I doubt there would be much opposition.</p>



<a name="202768626"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/233931-t-compiler/major%20changes/topic/Improve%20defaults%20in%20x.py%20compiler-team%23326/near/202768626" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Nelson <a href="https://zulip-archive.rust-lang.org/stream/233931-t-compiler/major-changes/topic/Improve.20defaults.20in.20x.2Epy.20compiler-team.23326.html#202768626">(Jul 03 2020 at 04:51)</a>:</h4>
<p>Also see my comment on the PR - debuginfo 1 takes a lot less time than debuginfo 2</p>



<a name="202773430"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/233931-t-compiler/major%20changes/topic/Improve%20defaults%20in%20x.py%20compiler-team%23326/near/202773430" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Josh Triplett <a href="https://zulip-archive.rust-lang.org/stream/233931-t-compiler/major-changes/topic/Improve.20defaults.20in.20x.2Epy.20compiler-team.23326.html#202773430">(Jul 03 2020 at 06:53)</a>:</h4>
<p>I'm actually less concerned about the time (given comments that it's apparently negligible) and more concerned about memory usage during the build.</p>



<a name="202773474"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/233931-t-compiler/major%20changes/topic/Improve%20defaults%20in%20x.py%20compiler-team%23326/near/202773474" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Josh Triplett <a href="https://zulip-archive.rust-lang.org/stream/233931-t-compiler/major-changes/topic/Improve.20defaults.20in.20x.2Epy.20compiler-team.23326.html#202773474">(Jul 03 2020 at 06:54)</a>:</h4>
<p>I'm hoping debug 1 will be an improvement in that regard.</p>



<a name="202797048"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/233931-t-compiler/major%20changes/topic/Improve%20defaults%20in%20x.py%20compiler-team%23326/near/202797048" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> simulacrum <a href="https://zulip-archive.rust-lang.org/stream/233931-t-compiler/major-changes/topic/Improve.20defaults.20in.20x.2Epy.20compiler-team.23326.html#202797048">(Jul 03 2020 at 12:11)</a>:</h4>
<p>debug asserts are a pretty big performance hit last I checked, which is why we have a separate debug-assertions-std now (but just compiler asserts are still a 50% hit in performance IIRC)</p>



<a name="202801178"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/233931-t-compiler/major%20changes/topic/Improve%20defaults%20in%20x.py%20compiler-team%23326/near/202801178" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Nelson <a href="https://zulip-archive.rust-lang.org/stream/233931-t-compiler/major-changes/topic/Improve.20defaults.20in.20x.2Epy.20compiler-team.23326.html#202801178">(Jul 03 2020 at 12:59)</a>:</h4>
<p>Ok, it sounds like debug = true is not the best change for everyone (or at least, not a clear win the way the other changes are). I'll remove it from the MCP and my PR.</p>



<a name="203203673"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/233931-t-compiler/major%20changes/topic/Improve%20defaults%20in%20x.py%20compiler-team%23326/near/203203673" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Nelson <a href="https://zulip-archive.rust-lang.org/stream/233931-t-compiler/major-changes/topic/Improve.20defaults.20in.20x.2Epy.20compiler-team.23326.html#203203673">(Jul 07 2020 at 21:12)</a>:</h4>
<p>This has gone a few days without discussion or a second ... Did I miss a concern someone had? If not, what are the next steps?</p>



<a name="203206492"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/233931-t-compiler/major%20changes/topic/Improve%20defaults%20in%20x.py%20compiler-team%23326/near/203206492" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Josh Triplett <a href="https://zulip-archive.rust-lang.org/stream/233931-t-compiler/major-changes/topic/Improve.20defaults.20in.20x.2Epy.20compiler-team.23326.html#203206492">(Jul 07 2020 at 21:37)</a>:</h4>
<p>I think the next step would be to convert the draft PR to a non-draft PR, and suggest that someone on the team do an "rfcbot merge" to confirm consensus.</p>



<a name="203206709"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/233931-t-compiler/major%20changes/topic/Improve%20defaults%20in%20x.py%20compiler-team%23326/near/203206709" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Nelson <a href="https://zulip-archive.rust-lang.org/stream/233931-t-compiler/major-changes/topic/Improve.20defaults.20in.20x.2Epy.20compiler-team.23326.html#203206709">(Jul 07 2020 at 21:39)</a>:</h4>
<p>Neat, that means I need to fix the test failures first then <span aria-label="laughing" class="emoji emoji-1f606" role="img" title="laughing">:laughing:</span> thanks!</p>



<a name="203206724"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/233931-t-compiler/major%20changes/topic/Improve%20defaults%20in%20x.py%20compiler-team%23326/near/203206724" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Josh Triplett <a href="https://zulip-archive.rust-lang.org/stream/233931-t-compiler/major-changes/topic/Improve.20defaults.20in.20x.2Epy.20compiler-team.23326.html#203206724">(Jul 07 2020 at 21:40)</a>:</h4>
<p>Also, a request: could you please change the PR/commit title, to something like "Improve defaults in x.py", rather than using "sane"? I don't think it's appropriate to use terms like "sane" in this context, both because they're pejorative to the past code (implying it's "insane" rather than just suboptimal), and because analogies to mental health are problematic for various reasons. (This is something I'm still working on myself, but I try to catch it and deal with it when I notice it.)</p>



<a name="203206801"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/233931-t-compiler/major%20changes/topic/Improve%20defaults%20in%20x.py%20compiler-team%23326/near/203206801" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Nelson <a href="https://zulip-archive.rust-lang.org/stream/233931-t-compiler/major-changes/topic/Improve.20defaults.20in.20x.2Epy.20compiler-team.23326.html#203206801">(Jul 07 2020 at 21:40)</a>:</h4>
<p>Will do</p>



<a name="203206819"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/233931-t-compiler/major%20changes/topic/Improve%20defaults%20in%20x.py%20compiler-team%23326/near/203206819" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Josh Triplett <a href="https://zulip-archive.rust-lang.org/stream/233931-t-compiler/major-changes/topic/Improve.20defaults.20in.20x.2Epy.20compiler-team.23326.html#203206819">(Jul 07 2020 at 21:40)</a>:</h4>
<p>Thank you, I appreciate it. :)</p>



<a name="203206828"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/233931-t-compiler/major%20changes/topic/Improve%20defaults%20in%20x.py%20compiler-team%23326/near/203206828" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Josh Triplett <a href="https://zulip-archive.rust-lang.org/stream/233931-t-compiler/major-changes/topic/Improve.20defaults.20in.20x.2Epy.20compiler-team.23326.html#203206828">(Jul 07 2020 at 21:40)</a>:</h4>
<p>And thanks for working on this!</p>



<a name="203206883"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/233931-t-compiler/major%20changes/topic/Improve%20defaults%20in%20x.py%20compiler-team%23326/near/203206883" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Nelson <a href="https://zulip-archive.rust-lang.org/stream/233931-t-compiler/major-changes/topic/Improve.20defaults.20in.20x.2Epy.20compiler-team.23326.html#203206883">(Jul 07 2020 at 21:41)</a>:</h4>
<p>Oh hmm editing zulip streams does not work the way I thought it did haha</p>



<a name="203206928"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/233931-t-compiler/major%20changes/topic/Improve%20defaults%20in%20x.py%20compiler-team%23326/near/203206928" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Josh Triplett <a href="https://zulip-archive.rust-lang.org/stream/233931-t-compiler/major-changes/topic/Improve.20defaults.20in.20x.2Epy.20compiler-team.23326.html#203206928">(Jul 07 2020 at 21:41)</a>:</h4>
<p>(As an aside, I'm so thankful for the Rust community providing the comfort and safety to be able to raise things like that without a high probability of backlash.)</p>



<a name="203207055"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/233931-t-compiler/major%20changes/topic/Improve%20defaults%20in%20x.py%20compiler-team%23326/near/203207055" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Josh Triplett <a href="https://zulip-archive.rust-lang.org/stream/233931-t-compiler/major-changes/topic/Improve.20defaults.20in.20x.2Epy.20compiler-team.23326.html#203207055">(Jul 07 2020 at 21:42)</a>:</h4>
<p><span class="user-mention" data-user-id="232545">@Joshua Nelson</span> I can edit the rustbot message to link to the right stream.</p>



<a name="203207080"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/233931-t-compiler/major%20changes/topic/Improve%20defaults%20in%20x.py%20compiler-team%23326/near/203207080" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Nelson <a href="https://zulip-archive.rust-lang.org/stream/233931-t-compiler/major-changes/topic/Improve.20defaults.20in.20x.2Epy.20compiler-team.23326.html#203207080">(Jul 07 2020 at 21:42)</a>:</h4>
<p>No, I mean it split this channel into two streams</p>



<a name="203207089"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/233931-t-compiler/major%20changes/topic/Improve%20defaults%20in%20x.py%20compiler-team%23326/near/203207089" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Josh Triplett <a href="https://zulip-archive.rust-lang.org/stream/233931-t-compiler/major-changes/topic/Improve.20defaults.20in.20x.2Epy.20compiler-team.23326.html#203207089">(Jul 07 2020 at 21:43)</a>:</h4>
<p>Oh, that's strange.</p>



<a name="203207104"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/233931-t-compiler/major%20changes/topic/Improve%20defaults%20in%20x.py%20compiler-team%23326/near/203207104" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Nelson <a href="https://zulip-archive.rust-lang.org/stream/233931-t-compiler/major-changes/topic/Improve.20defaults.20in.20x.2Epy.20compiler-team.23326.html#203207104">(Jul 07 2020 at 21:43)</a>:</h4>
<p>the other one I can't edit, I think because I hadn't commented yet?</p>



<a name="203209700"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/233931-t-compiler/major%20changes/topic/Improve%20defaults%20in%20x.py%20compiler-team%23326/near/203209700" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/233931-t-compiler/major-changes/topic/Improve.20defaults.20in.20x.2Epy.20compiler-team.23326.html#203209700">(Jul 07 2020 at 22:10)</a>:</h4>
<p>fwiw I don't think we need an fcp merge here to get total team consensus</p>



<a name="203209707"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/233931-t-compiler/major%20changes/topic/Improve%20defaults%20in%20x.py%20compiler-team%23326/near/203209707" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/233931-t-compiler/major-changes/topic/Improve.20defaults.20in.20x.2Epy.20compiler-team.23326.html#203209707">(Jul 07 2020 at 22:10)</a>:</h4>
<p>I think a rustbot second suffices</p>



<a name="203209712"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/233931-t-compiler/major%20changes/topic/Improve%20defaults%20in%20x.py%20compiler-team%23326/near/203209712" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/233931-t-compiler/major-changes/topic/Improve.20defaults.20in.20x.2Epy.20compiler-team.23326.html#203209712">(Jul 07 2020 at 22:10)</a>:</h4>
<p>also, I'm glad you raised the "sane" question, I wanted to bring it up ...</p>



<a name="203209773"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/233931-t-compiler/major%20changes/topic/Improve%20defaults%20in%20x.py%20compiler-team%23326/near/203209773" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> triagebot <a href="https://zulip-archive.rust-lang.org/stream/233931-t-compiler/major-changes/topic/Improve.20defaults.20in.20x.2Epy.20compiler-team.23326.html#203209773">(Jul 07 2020 at 22:11)</a>:</h4>
<p><span class="user-group-mention" data-user-group-id="492">@T-compiler</span>: Proposal <a href="https://github.com/rust-lang/compiler-team/issues/326#issuecomment-655162912">#326</a> has been seconded, and will be approved in 10 days if no objections are raised.</p>



<a name="203210583"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/233931-t-compiler/major%20changes/topic/Improve%20defaults%20in%20x.py%20compiler-team%23326/near/203210583" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Josh Triplett <a href="https://zulip-archive.rust-lang.org/stream/233931-t-compiler/major-changes/topic/Improve.20defaults.20in.20x.2Epy.20compiler-team.23326.html#203210583">(Jul 07 2020 at 22:20)</a>:</h4>
<p><span class="user-mention" data-user-id="116009">@nikomatsakis</span> Where is the repo for rustbot and the MCP automation? I'd like to file an issue regarding title changes.</p>



<a name="203211822"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/233931-t-compiler/major%20changes/topic/Improve%20defaults%20in%20x.py%20compiler-team%23326/near/203211822" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Nelson <a href="https://zulip-archive.rust-lang.org/stream/233931-t-compiler/major-changes/topic/Improve.20defaults.20in.20x.2Epy.20compiler-team.23326.html#203211822">(Jul 07 2020 at 22:37)</a>:</h4>
<p>unfortunately github doesn't let me change the name of the branch without making an entirely new PR :/</p>



<a name="203211836"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/233931-t-compiler/major%20changes/topic/Improve%20defaults%20in%20x.py%20compiler-team%23326/near/203211836" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> lqd <a href="https://zulip-archive.rust-lang.org/stream/233931-t-compiler/major-changes/topic/Improve.20defaults.20in.20x.2Epy.20compiler-team.23326.html#203211836">(Jul 07 2020 at 22:37)</a>:</h4>
<p>the repo is <a href="https://github.com/rust-lang/triagebot/">https://github.com/rust-lang/triagebot/</a> I think</p>



<a name="203776250"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/233931-t-compiler/major%20changes/topic/Improve%20defaults%20in%20x.py%20compiler-team%23326/near/203776250" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Nelson <a href="https://zulip-archive.rust-lang.org/stream/233931-t-compiler/major-changes/topic/Improve.20defaults.20in.20x.2Epy.20compiler-team.23326.html#203776250">(Jul 13 2020 at 21:51)</a>:</h4>
<p>so <span class="user-mention" data-user-id="121055">@Pietro Albini</span> <span class="user-mention" data-user-id="116122">@simulacrum</span> how much is this going to break CI? I can probably figure out most of the straight-up failures if I debug enough, but I'm worried I'm going to break stable releases or something</p>



<a name="203776300"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/233931-t-compiler/major%20changes/topic/Improve%20defaults%20in%20x.py%20compiler-team%23326/near/203776300" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Nelson <a href="https://zulip-archive.rust-lang.org/stream/233931-t-compiler/major-changes/topic/Improve.20defaults.20in.20x.2Epy.20compiler-team.23326.html#203776300">(Jul 13 2020 at 21:51)</a>:</h4>
<p>should I just <code>sed -i s/x.py/x.py --stage 2/g src/ci/*</code>?</p>



<a name="203776422"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/233931-t-compiler/major%20changes/topic/Improve%20defaults%20in%20x.py%20compiler-team%23326/near/203776422" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> simulacrum <a href="https://zulip-archive.rust-lang.org/stream/233931-t-compiler/major-changes/topic/Improve.20defaults.20in.20x.2Epy.20compiler-team.23326.html#203776422">(Jul 13 2020 at 21:53)</a>:</h4>
<p>That sounds fine to me as a start. We should note any problems fairly early on -- try builds and the like -- and we're coming up on the end of a cycle so we'll have a full 12 weeks to get it all nailed down if we land it fairly soon.</p>



<a name="203776451"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/233931-t-compiler/major%20changes/topic/Improve%20defaults%20in%20x.py%20compiler-team%23326/near/203776451" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Nelson <a href="https://zulip-archive.rust-lang.org/stream/233931-t-compiler/major-changes/topic/Improve.20defaults.20in.20x.2Epy.20compiler-team.23326.html#203776451">(Jul 13 2020 at 21:53)</a>:</h4>
<div class="codehilite"><pre><span></span><code>$ rg x.py src/ci --no-filename --no-heading | wc -l
90
</code></pre></div>


<p>:whistles:</p>



<a name="203776512"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/233931-t-compiler/major%20changes/topic/Improve%20defaults%20in%20x.py%20compiler-team%23326/near/203776512" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Nelson <a href="https://zulip-archive.rust-lang.org/stream/233931-t-compiler/major-changes/topic/Improve.20defaults.20in.20x.2Epy.20compiler-team.23326.html#203776512">(Jul 13 2020 at 21:54)</a>:</h4>
<p>oh nice, I forgot about try builds</p>



<a name="203776744"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/233931-t-compiler/major%20changes/topic/Improve%20defaults%20in%20x.py%20compiler-team%23326/near/203776744" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Nelson <a href="https://zulip-archive.rust-lang.org/stream/233931-t-compiler/major-changes/topic/Improve.20defaults.20in.20x.2Epy.20compiler-team.23326.html#203776744">(Jul 13 2020 at 21:57)</a>:</h4>
<p>going to let <a href="https://github.com/rust-lang/rust/pull/73964/checks?check_run_id=866988967">https://github.com/rust-lang/rust/pull/73964/checks?check_run_id=866988967</a> run to make sure all the defaults for <code>--stage 1</code> work then I'll push a commit changing it all to use <code>--stage 2</code></p>



<a name="203781364"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/233931-t-compiler/major%20changes/topic/Improve%20defaults%20in%20x.py%20compiler-team%23326/near/203781364" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Nelson <a href="https://zulip-archive.rust-lang.org/stream/233931-t-compiler/major-changes/topic/Improve.20defaults.20in.20x.2Epy.20compiler-team.23326.html#203781364">(Jul 13 2020 at 22:54)</a>:</h4>
<p><span class="user-mention" data-user-id="116122">@simulacrum</span> bootstrap tests are failing because they expect --stage 2 to be the default. Do you want me to update them to match --stage 1 or to pass --stage 2 explicitly?</p>



<a name="203782646"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/233931-t-compiler/major%20changes/topic/Improve%20defaults%20in%20x.py%20compiler-team%23326/near/203782646" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Nelson <a href="https://zulip-archive.rust-lang.org/stream/233931-t-compiler/major-changes/topic/Improve.20defaults.20in.20x.2Epy.20compiler-team.23326.html#203782646">(Jul 13 2020 at 23:12)</a>:</h4>
<p>(going to pass --stage 2 unless I hear otherwise, you'll see it again in the PR)</p>



<a name="203784274"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/233931-t-compiler/major%20changes/topic/Improve%20defaults%20in%20x.py%20compiler-team%23326/near/203784274" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Nelson <a href="https://zulip-archive.rust-lang.org/stream/233931-t-compiler/major-changes/topic/Improve.20defaults.20in.20x.2Epy.20compiler-team.23326.html#203784274">(Jul 13 2020 at 23:39)</a>:</h4>
<p>I guess this means <code>x.py</code> now needs a way to specify 'build rustc but not anything else', right now there's no way to build stage2 rustc without passing <code>test --stage 2</code>.</p>



<a name="203788282"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/233931-t-compiler/major%20changes/topic/Improve%20defaults%20in%20x.py%20compiler-team%23326/near/203788282" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Nelson <a href="https://zulip-archive.rust-lang.org/stream/233931-t-compiler/major-changes/topic/Improve.20defaults.20in.20x.2Epy.20compiler-team.23326.html#203788282">(Jul 14 2020 at 00:44)</a>:</h4>
<p>I just realized I didn't address rustdoc at all in the MCP - are people ok with not building rustdoc by default? Or should I leave that as is, so that <code>x.py build</code> will build both <code>src/libstd</code> and <code>src/tools/rustdoc</code>?</p>



<a name="203788320"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/233931-t-compiler/major%20changes/topic/Improve%20defaults%20in%20x.py%20compiler-team%23326/near/203788320" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Nelson <a href="https://zulip-archive.rust-lang.org/stream/233931-t-compiler/major-changes/topic/Improve.20defaults.20in.20x.2Epy.20compiler-team.23326.html#203788320">(Jul 14 2020 at 00:45)</a>:</h4>
<p>personally I think it makes sense not to build it unless it was explicitly requested but I don't feel strongly about it</p>



<a name="203827207"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/233931-t-compiler/major%20changes/topic/Improve%20defaults%20in%20x.py%20compiler-team%23326/near/203827207" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> simulacrum <a href="https://zulip-archive.rust-lang.org/stream/233931-t-compiler/major-changes/topic/Improve.20defaults.20in.20x.2Epy.20compiler-team.23326.html#203827207">(Jul 14 2020 at 12:32)</a>:</h4>
<p>yeah I'd expect to pass stage 2 there, though we may want some stage 1 tests as well</p>



<a name="203889226"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/233931-t-compiler/major%20changes/topic/Improve%20defaults%20in%20x.py%20compiler-team%23326/near/203889226" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Santiago Pastorino <a href="https://zulip-archive.rust-lang.org/stream/233931-t-compiler/major-changes/topic/Improve.20defaults.20in.20x.2Epy.20compiler-team.23326.html#203889226">(Jul 14 2020 at 21:14)</a>:</h4>
<p>hey <span class="user-mention" data-user-id="232545">@Joshua Nelson</span> I was wondering the following from your proposal ...</p>



<a name="203889263"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/233931-t-compiler/major%20changes/topic/Improve%20defaults%20in%20x.py%20compiler-team%23326/near/203889263" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Santiago Pastorino <a href="https://zulip-archive.rust-lang.org/stream/233931-t-compiler/major-changes/topic/Improve.20defaults.20in.20x.2Epy.20compiler-team.23326.html#203889263">(Jul 14 2020 at 21:14)</a>:</h4>
<div class="codehilite"><pre><span></span><code>The proposed new behavior is as follows:

    x.py build --stage 0:
        stage0 libstd

This is suitable for contributors only working on the standard library,
as it means rustc never has to be compiled.

    x.py build --stage 1:
        stage0 libstd
        stage1 rustc
        stage1 libstd

This is suitable for contributors working on the compiler. It ensures
that you have a working rustc and libstd without having to pass
src/libstd in addition.

    x.py build --stage 2:
        stage0 libstd
        stage1 rustc
        stage1 libstd
        stage2 rustc
        stage2 libstd
        stage2 rustdoc, tools, etc.
</code></pre></div>



<a name="203889279"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/233931-t-compiler/major%20changes/topic/Improve%20defaults%20in%20x.py%20compiler-team%23326/near/203889279" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Santiago Pastorino <a href="https://zulip-archive.rust-lang.org/stream/233931-t-compiler/major-changes/topic/Improve.20defaults.20in.20x.2Epy.20compiler-team.23326.html#203889279">(Jul 14 2020 at 21:14)</a>:</h4>
<p>this seems more clear in my opinion to what we have</p>



<a name="203889302"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/233931-t-compiler/major%20changes/topic/Improve%20defaults%20in%20x.py%20compiler-team%23326/near/203889302" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Santiago Pastorino <a href="https://zulip-archive.rust-lang.org/stream/233931-t-compiler/major-changes/topic/Improve.20defaults.20in.20x.2Epy.20compiler-team.23326.html#203889302">(Jul 14 2020 at 21:14)</a>:</h4>
<p>but I wonder something else here ...</p>



<a name="203889396"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/233931-t-compiler/major%20changes/topic/Improve%20defaults%20in%20x.py%20compiler-team%23326/near/203889396" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Santiago Pastorino <a href="https://zulip-archive.rust-lang.org/stream/233931-t-compiler/major-changes/topic/Improve.20defaults.20in.20x.2Epy.20compiler-team.23326.html#203889396">(Jul 14 2020 at 21:15)</a>:</h4>
<p>I guess I may not be understanding well what we mean by some stage N or I may have a different idea</p>



<a name="203889455"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/233931-t-compiler/major%20changes/topic/Improve%20defaults%20in%20x.py%20compiler-team%23326/near/203889455" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Santiago Pastorino <a href="https://zulip-archive.rust-lang.org/stream/233931-t-compiler/major-changes/topic/Improve.20defaults.20in.20x.2Epy.20compiler-team.23326.html#203889455">(Jul 14 2020 at 21:16)</a>:</h4>
<p>but couldn't this be more like ...</p>



<a name="203889520"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/233931-t-compiler/major%20changes/topic/Improve%20defaults%20in%20x.py%20compiler-team%23326/near/203889520" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Santiago Pastorino <a href="https://zulip-archive.rust-lang.org/stream/233931-t-compiler/major-changes/topic/Improve.20defaults.20in.20x.2Epy.20compiler-team.23326.html#203889520">(Jul 14 2020 at 21:17)</a>:</h4>
<div class="codehilite"><pre><span></span><code>The proposed new behavior is as follows:

    x.py build --stage 0 (doesn&#39;t make sense, stage 0 is beta compiler and std)

    x.py build --stage 1:
        stage1 libstd
        stage1 rustc

    x.py build --stage 2:
        stage1 libstd
        stage1 rustc
        stage2 libstd
        stage2 rustc
</code></pre></div>



<a name="203889570"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/233931-t-compiler/major%20changes/topic/Improve%20defaults%20in%20x.py%20compiler-team%23326/near/203889570" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Santiago Pastorino <a href="https://zulip-archive.rust-lang.org/stream/233931-t-compiler/major-changes/topic/Improve.20defaults.20in.20x.2Epy.20compiler-team.23326.html#203889570">(Jul 14 2020 at 21:17)</a>:</h4>
<p>I know that if you do this the typical workflow would change a bit, but on the other hand things are more clear</p>



<a name="203889584"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/233931-t-compiler/major%20changes/topic/Improve%20defaults%20in%20x.py%20compiler-team%23326/near/203889584" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Santiago Pastorino <a href="https://zulip-archive.rust-lang.org/stream/233931-t-compiler/major-changes/topic/Improve.20defaults.20in.20x.2Epy.20compiler-team.23326.html#203889584">(Jul 14 2020 at 21:17)</a>:</h4>
<p>and you would need stage 3</p>



<a name="203889662"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/233931-t-compiler/major%20changes/topic/Improve%20defaults%20in%20x.py%20compiler-team%23326/near/203889662" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Santiago Pastorino <a href="https://zulip-archive.rust-lang.org/stream/233931-t-compiler/major-changes/topic/Improve.20defaults.20in.20x.2Epy.20compiler-team.23326.html#203889662">(Jul 14 2020 at 21:18)</a>:</h4>
<p>just in case, to be clear, more than suggesting an alternative or discussing it, I want to understand why do we have what we have :)</p>



<a name="203889678"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/233931-t-compiler/major%20changes/topic/Improve%20defaults%20in%20x.py%20compiler-team%23326/near/203889678" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Nelson <a href="https://zulip-archive.rust-lang.org/stream/233931-t-compiler/major-changes/topic/Improve.20defaults.20in.20x.2Epy.20compiler-team.23326.html#203889678">(Jul 14 2020 at 21:18)</a>:</h4>
<blockquote>
<p>stage 0 is beta compiler and std</p>
</blockquote>
<p>This depends how you number it. Currently numbering is split between 'what it is' and 'what compiler it was built by'</p>



<a name="203889702"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/233931-t-compiler/major%20changes/topic/Improve%20defaults%20in%20x.py%20compiler-team%23326/near/203889702" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Nelson <a href="https://zulip-archive.rust-lang.org/stream/233931-t-compiler/major-changes/topic/Improve.20defaults.20in.20x.2Epy.20compiler-team.23326.html#203889702">(Jul 14 2020 at 21:18)</a>:</h4>
<p>if you say <code>build --stage 0 src/libstd</code>, that means build libstd with the beta compiler</p>



<a name="203889714"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/233931-t-compiler/major%20changes/topic/Improve%20defaults%20in%20x.py%20compiler-team%23326/near/203889714" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Nelson <a href="https://zulip-archive.rust-lang.org/stream/233931-t-compiler/major-changes/topic/Improve.20defaults.20in.20x.2Epy.20compiler-team.23326.html#203889714">(Jul 14 2020 at 21:18)</a>:</h4>
<p>it does not mean use the distributed beta libstd</p>



<a name="203889776"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/233931-t-compiler/major%20changes/topic/Improve%20defaults%20in%20x.py%20compiler-team%23326/near/203889776" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Nelson <a href="https://zulip-archive.rust-lang.org/stream/233931-t-compiler/major-changes/topic/Improve.20defaults.20in.20x.2Epy.20compiler-team.23326.html#203889776">(Jul 14 2020 at 21:19)</a>:</h4>
<blockquote>
<p>doesn't make sense</p>
</blockquote>
<p>I don't see why not? You can build libstd without building the compiler first, that's what I expect people contributing to libstd do</p>



<a name="203889980"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/233931-t-compiler/major%20changes/topic/Improve%20defaults%20in%20x.py%20compiler-team%23326/near/203889980" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Santiago Pastorino <a href="https://zulip-archive.rust-lang.org/stream/233931-t-compiler/major-changes/topic/Improve.20defaults.20in.20x.2Epy.20compiler-team.23326.html#203889980">(Jul 14 2020 at 21:20)</a>:</h4>
<p>I meant, if you give <code>--stage N </code> the meaning of build the stage N compiler, stage 0 doesn't make sense because it already exists</p>



<a name="203889983"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/233931-t-compiler/major%20changes/topic/Improve%20defaults%20in%20x.py%20compiler-team%23326/near/203889983" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Nelson <a href="https://zulip-archive.rust-lang.org/stream/233931-t-compiler/major-changes/topic/Improve.20defaults.20in.20x.2Epy.20compiler-team.23326.html#203889983">(Jul 14 2020 at 21:20)</a>:</h4>
<blockquote>
<p>and you would need stage 3</p>
</blockquote>
<p>Yeah I missed that in the MCP, it's in the PR. I'll update the description.</p>



<a name="203890016"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/233931-t-compiler/major%20changes/topic/Improve%20defaults%20in%20x.py%20compiler-team%23326/near/203890016" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Santiago Pastorino <a href="https://zulip-archive.rust-lang.org/stream/233931-t-compiler/major-changes/topic/Improve.20defaults.20in.20x.2Epy.20compiler-team.23326.html#203890016">(Jul 14 2020 at 21:21)</a>:</h4>
<p><span class="user-mention silent" data-user-id="232545">Joshua Nelson</span> <a href="#narrow/stream/233931-t-compiler.2Fmajor-changes/topic/Improve.20defaults.20in.20x.2Epy.20compiler-team.23326/near/203889983">said</a>:</p>
<blockquote>
<blockquote>
<p>and you would need stage 3</p>
</blockquote>
<p>Yeah I missed that in the MCP, it's in the PR. I'll update the description.</p>
</blockquote>
<p>what I meant here is that in my schema stage 3 is really needed</p>



<a name="203890036"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/233931-t-compiler/major%20changes/topic/Improve%20defaults%20in%20x.py%20compiler-team%23326/near/203890036" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Nelson <a href="https://zulip-archive.rust-lang.org/stream/233931-t-compiler/major-changes/topic/Improve.20defaults.20in.20x.2Epy.20compiler-team.23326.html#203890036">(Jul 14 2020 at 21:21)</a>:</h4>
<p>that's not the current meaning of --stage N though</p>



<a name="203890045"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/233931-t-compiler/major%20changes/topic/Improve%20defaults%20in%20x.py%20compiler-team%23326/near/203890045" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Santiago Pastorino <a href="https://zulip-archive.rust-lang.org/stream/233931-t-compiler/major-changes/topic/Improve.20defaults.20in.20x.2Epy.20compiler-team.23326.html#203890045">(Jul 14 2020 at 21:21)</a>:</h4>
<p>yes I know</p>



<a name="203890048"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/233931-t-compiler/major%20changes/topic/Improve%20defaults%20in%20x.py%20compiler-team%23326/near/203890048" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Santiago Pastorino <a href="https://zulip-archive.rust-lang.org/stream/233931-t-compiler/major-changes/topic/Improve.20defaults.20in.20x.2Epy.20compiler-team.23326.html#203890048">(Jul 14 2020 at 21:21)</a>:</h4>
<p>I was just trying to understand</p>



<a name="203890060"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/233931-t-compiler/major%20changes/topic/Improve%20defaults%20in%20x.py%20compiler-team%23326/near/203890060" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Santiago Pastorino <a href="https://zulip-archive.rust-lang.org/stream/233931-t-compiler/major-changes/topic/Improve.20defaults.20in.20x.2Epy.20compiler-team.23326.html#203890060">(Jul 14 2020 at 21:21)</a>:</h4>
<p>the problem I have is ...</p>



<a name="203890156"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/233931-t-compiler/major%20changes/topic/Improve%20defaults%20in%20x.py%20compiler-team%23326/near/203890156" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Santiago Pastorino <a href="https://zulip-archive.rust-lang.org/stream/233931-t-compiler/major-changes/topic/Improve.20defaults.20in.20x.2Epy.20compiler-team.23326.html#203890156">(Jul 14 2020 at 21:22)</a>:</h4>
<p>if you give <code>--stage 1</code> the meaning of use stage 1 compiler to produce artifacts, shouldn't those artifacts be stage 2 artifacts and be named like so?</p>



<a name="203890204"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/233931-t-compiler/major%20changes/topic/Improve%20defaults%20in%20x.py%20compiler-team%23326/near/203890204" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Nelson <a href="https://zulip-archive.rust-lang.org/stream/233931-t-compiler/major-changes/topic/Improve.20defaults.20in.20x.2Epy.20compiler-team.23326.html#203890204">(Jul 14 2020 at 21:22)</a>:</h4>
<p>I don't propose in this MCP to change the meaning of --stage N (even though I think it's a good change)</p>



<a name="203890208"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/233931-t-compiler/major%20changes/topic/Improve%20defaults%20in%20x.py%20compiler-team%23326/near/203890208" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Santiago Pastorino <a href="https://zulip-archive.rust-lang.org/stream/233931-t-compiler/major-changes/topic/Improve.20defaults.20in.20x.2Epy.20compiler-team.23326.html#203890208">(Jul 14 2020 at 21:23)</a>:</h4>
<p>I think one of the most confusing things is giving <code>--stage 1</code> the meaning of use stage 1 compiler to produce artifacts and then name those artifacts with the number 1</p>



<a name="203890243"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/233931-t-compiler/major%20changes/topic/Improve%20defaults%20in%20x.py%20compiler-team%23326/near/203890243" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Nelson <a href="https://zulip-archive.rust-lang.org/stream/233931-t-compiler/major-changes/topic/Improve.20defaults.20in.20x.2Epy.20compiler-team.23326.html#203890243">(Jul 14 2020 at 21:23)</a>:</h4>
<p>I'm only saying "don't build rustc by default for <code>x.py build</code>"</p>



<a name="203890260"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/233931-t-compiler/major%20changes/topic/Improve%20defaults%20in%20x.py%20compiler-team%23326/near/203890260" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Santiago Pastorino <a href="https://zulip-archive.rust-lang.org/stream/233931-t-compiler/major-changes/topic/Improve.20defaults.20in.20x.2Epy.20compiler-team.23326.html#203890260">(Jul 14 2020 at 21:23)</a>:</h4>
<p><span class="user-mention silent" data-user-id="232545">Joshua Nelson</span> <a href="#narrow/stream/233931-t-compiler.2Fmajor-changes/topic/Improve.20defaults.20in.20x.2Epy.20compiler-team.23326/near/203890204">said</a>:</p>
<blockquote>
<p>I don't propose in this MCP to change the meaning of --stage N (even though I think it's a good change)</p>
</blockquote>
<p><span aria-label="+1" class="emoji emoji-1f44d" role="img" title="+1">:+1:</span>, again, I'm not trying to discuss your proposal :)</p>



<a name="203890271"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/233931-t-compiler/major%20changes/topic/Improve%20defaults%20in%20x.py%20compiler-team%23326/near/203890271" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Santiago Pastorino <a href="https://zulip-archive.rust-lang.org/stream/233931-t-compiler/major-changes/topic/Improve.20defaults.20in.20x.2Epy.20compiler-team.23326.html#203890271">(Jul 14 2020 at 21:23)</a>:</h4>
<p>was just interested in understanding a bit better this</p>



<a name="203890283"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/233931-t-compiler/major%20changes/topic/Improve%20defaults%20in%20x.py%20compiler-team%23326/near/203890283" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Santiago Pastorino <a href="https://zulip-archive.rust-lang.org/stream/233931-t-compiler/major-changes/topic/Improve.20defaults.20in.20x.2Epy.20compiler-team.23326.html#203890283">(Jul 14 2020 at 21:23)</a>:</h4>
<p><span class="user-mention silent" data-user-id="232545">Joshua Nelson</span> <a href="#narrow/stream/233931-t-compiler.2Fmajor-changes/topic/Improve.20defaults.20in.20x.2Epy.20compiler-team.23326/near/203890243">said</a>:</p>
<blockquote>
<p>I'm only saying "don't build rustc by default for <code>x.py build</code>"</p>
</blockquote>
<p><span aria-label="+1" class="emoji emoji-1f44d" role="img" title="+1">:+1:</span></p>



<a name="203890299"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/233931-t-compiler/major%20changes/topic/Improve%20defaults%20in%20x.py%20compiler-team%23326/near/203890299" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Nelson <a href="https://zulip-archive.rust-lang.org/stream/233931-t-compiler/major-changes/topic/Improve.20defaults.20in.20x.2Epy.20compiler-team.23326.html#203890299">(Jul 14 2020 at 21:23)</a>:</h4>
<p>oh I see what you mean</p>



<a name="203890355"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/233931-t-compiler/major%20changes/topic/Improve%20defaults%20in%20x.py%20compiler-team%23326/near/203890355" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Nelson <a href="https://zulip-archive.rust-lang.org/stream/233931-t-compiler/major-changes/topic/Improve.20defaults.20in.20x.2Epy.20compiler-team.23326.html#203890355">(Jul 14 2020 at 21:24)</a>:</h4>
<p>yeah I named them confusingly</p>



<a name="203890365"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/233931-t-compiler/major%20changes/topic/Improve%20defaults%20in%20x.py%20compiler-team%23326/near/203890365" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Nelson <a href="https://zulip-archive.rust-lang.org/stream/233931-t-compiler/major-changes/topic/Improve.20defaults.20in.20x.2Epy.20compiler-team.23326.html#203890365">(Jul 14 2020 at 21:24)</a>:</h4>
<p>should I say 'stage 1 artifacts' instead?</p>



<a name="203890421"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/233931-t-compiler/major%20changes/topic/Improve%20defaults%20in%20x.py%20compiler-team%23326/near/203890421" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Nelson <a href="https://zulip-archive.rust-lang.org/stream/233931-t-compiler/major-changes/topic/Improve.20defaults.20in.20x.2Epy.20compiler-team.23326.html#203890421">(Jul 14 2020 at 21:24)</a>:</h4>
<p>currently I use 'stage1 rustc' to mean the thing in <code>stage1/bin/rustc</code> but 'stage1 libstd' to mean the thing built by stage1 rustc</p>



<a name="203890474"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/233931-t-compiler/major%20changes/topic/Improve%20defaults%20in%20x.py%20compiler-team%23326/near/203890474" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Santiago Pastorino <a href="https://zulip-archive.rust-lang.org/stream/233931-t-compiler/major-changes/topic/Improve.20defaults.20in.20x.2Epy.20compiler-team.23326.html#203890474">(Jul 14 2020 at 21:25)</a>:</h4>
<p>yeah to be honest I'm not really sure what currently happens :)</p>



<a name="203890507"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/233931-t-compiler/major%20changes/topic/Improve%20defaults%20in%20x.py%20compiler-team%23326/near/203890507" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Santiago Pastorino <a href="https://zulip-archive.rust-lang.org/stream/233931-t-compiler/major-changes/topic/Improve.20defaults.20in.20x.2Epy.20compiler-team.23326.html#203890507">(Jul 14 2020 at 21:25)</a>:</h4>
<p>it's a bit confusing to me, didn't spend time trying to understand properly</p>



<a name="203890542"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/233931-t-compiler/major%20changes/topic/Improve%20defaults%20in%20x.py%20compiler-team%23326/near/203890542" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Santiago Pastorino <a href="https://zulip-archive.rust-lang.org/stream/233931-t-compiler/major-changes/topic/Improve.20defaults.20in.20x.2Epy.20compiler-team.23326.html#203890542">(Jul 14 2020 at 21:26)</a>:</h4>
<p>but what I think should look better is ...</p>



<a name="203890632"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/233931-t-compiler/major%20changes/topic/Improve%20defaults%20in%20x.py%20compiler-team%23326/near/203890632" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Nelson <a href="https://zulip-archive.rust-lang.org/stream/233931-t-compiler/major-changes/topic/Improve.20defaults.20in.20x.2Epy.20compiler-team.23326.html#203890632">(Jul 14 2020 at 21:26)</a>:</h4>
<p>Yeah it is definitely confusing, I had a discussion about this yesterday in <a href="#narrow/stream/182449-t-compiler.2Fhelp/topic/freeze.20stage0">https://rust-lang.zulipchat.com/#narrow/stream/182449-t-compiler.2Fhelp/topic/freeze.20stage0</a></p>



<a name="203890655"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/233931-t-compiler/major%20changes/topic/Improve%20defaults%20in%20x.py%20compiler-team%23326/near/203890655" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Santiago Pastorino <a href="https://zulip-archive.rust-lang.org/stream/233931-t-compiler/major-changes/topic/Improve.20defaults.20in.20x.2Epy.20compiler-team.23326.html#203890655">(Jul 14 2020 at 21:26)</a>:</h4>
<p>if you want to give <code>--stage 0</code> the meaning of use stage 0 to produce artifacts, maybe a more explicit name for that should be better, like <code>--use-stage 0</code></p>



<a name="203890677"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/233931-t-compiler/major%20changes/topic/Improve%20defaults%20in%20x.py%20compiler-team%23326/near/203890677" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Santiago Pastorino <a href="https://zulip-archive.rust-lang.org/stream/233931-t-compiler/major-changes/topic/Improve.20defaults.20in.20x.2Epy.20compiler-team.23326.html#203890677">(Jul 14 2020 at 21:26)</a>:</h4>
<p>and then your proposal be something like ...</p>



<a name="203890763"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/233931-t-compiler/major%20changes/topic/Improve%20defaults%20in%20x.py%20compiler-team%23326/near/203890763" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Nelson <a href="https://zulip-archive.rust-lang.org/stream/233931-t-compiler/major-changes/topic/Improve.20defaults.20in.20x.2Epy.20compiler-team.23326.html#203890763">(Jul 14 2020 at 21:27)</a>:</h4>
<p>Ooh I definitely like the name <code>--use-stage</code> better</p>



<a name="203890774"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/233931-t-compiler/major%20changes/topic/Improve%20defaults%20in%20x.py%20compiler-team%23326/near/203890774" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Santiago Pastorino <a href="https://zulip-archive.rust-lang.org/stream/233931-t-compiler/major-changes/topic/Improve.20defaults.20in.20x.2Epy.20compiler-team.23326.html#203890774">(Jul 14 2020 at 21:27)</a>:</h4>
<div class="codehilite"><pre><span></span><code>The proposed new behavior is as follows:

    x.py build --use-stage 0:
        stage1 libstd

This is suitable for contributors only working on the standard library,
as it means rustc never has to be compiled.

    x.py build --use-stage 1:
        stage1 libstd
        stage1 rustc
        stage2 libstd

This is suitable for contributors working on the compiler. It ensures
that you have a working rustc and libstd without having to pass
src/libstd in addition.

    x.py build --use-stage 2:
        stage1 libstd
        stage1 rustc
        stage2 libstd
        stage2 rustc
        stage3 libstd
        stage3 rustdoc, tools, etc.
</code></pre></div>



<a name="203890780"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/233931-t-compiler/major%20changes/topic/Improve%20defaults%20in%20x.py%20compiler-team%23326/near/203890780" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Nelson <a href="https://zulip-archive.rust-lang.org/stream/233931-t-compiler/major-changes/topic/Improve.20defaults.20in.20x.2Epy.20compiler-team.23326.html#203890780">(Jul 14 2020 at 21:28)</a>:</h4>
<p>as opposed to currently I think people assume it means <code>--build-stage</code>, which is not correct</p>



<a name="203890829"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/233931-t-compiler/major%20changes/topic/Improve%20defaults%20in%20x.py%20compiler-team%23326/near/203890829" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Santiago Pastorino <a href="https://zulip-archive.rust-lang.org/stream/233931-t-compiler/major-changes/topic/Improve.20defaults.20in.20x.2Epy.20compiler-team.23326.html#203890829">(Jul 14 2020 at 21:28)</a>:</h4>
<p>right</p>



<a name="203890869"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/233931-t-compiler/major%20changes/topic/Improve%20defaults%20in%20x.py%20compiler-team%23326/near/203890869" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Santiago Pastorino <a href="https://zulip-archive.rust-lang.org/stream/233931-t-compiler/major-changes/topic/Improve.20defaults.20in.20x.2Epy.20compiler-team.23326.html#203890869">(Jul 14 2020 at 21:28)</a>:</h4>
<p>it can also have a shorter way like <code>-s 1</code></p>



<a name="203890877"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/233931-t-compiler/major%20changes/topic/Improve%20defaults%20in%20x.py%20compiler-team%23326/near/203890877" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Santiago Pastorino <a href="https://zulip-archive.rust-lang.org/stream/233931-t-compiler/major-changes/topic/Improve.20defaults.20in.20x.2Epy.20compiler-team.23326.html#203890877">(Jul 14 2020 at 21:28)</a>:</h4>
<p>unsure if there's something like that currently</p>



<a name="203890894"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/233931-t-compiler/major%20changes/topic/Improve%20defaults%20in%20x.py%20compiler-team%23326/near/203890894" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Nelson <a href="https://zulip-archive.rust-lang.org/stream/233931-t-compiler/major-changes/topic/Improve.20defaults.20in.20x.2Epy.20compiler-team.23326.html#203890894">(Jul 14 2020 at 21:29)</a>:</h4>
<p>I'll make a PR adding that alias separately I think, and then we can use <code>--use-stage</code> in documentation</p>



<a name="203890922"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/233931-t-compiler/major%20changes/topic/Improve%20defaults%20in%20x.py%20compiler-team%23326/near/203890922" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Nelson <a href="https://zulip-archive.rust-lang.org/stream/233931-t-compiler/major-changes/topic/Improve.20defaults.20in.20x.2Epy.20compiler-team.23326.html#203890922">(Jul 14 2020 at 21:29)</a>:</h4>
<p>there's no -s shorthand I know of currently</p>



<a name="203891053"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/233931-t-compiler/major%20changes/topic/Improve%20defaults%20in%20x.py%20compiler-team%23326/near/203891053" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Santiago Pastorino <a href="https://zulip-archive.rust-lang.org/stream/233931-t-compiler/major-changes/topic/Improve.20defaults.20in.20x.2Epy.20compiler-team.23326.html#203891053">(Jul 14 2020 at 21:31)</a>:</h4>
<p><span class="user-mention silent" data-user-id="116266">Santiago Pastorino</span> <a href="#narrow/stream/233931-t-compiler.2Fmajor-changes/topic/Improve.20defaults.20in.20x.2Epy.20compiler-team.23326/near/203890774">said</a>:</p>
<blockquote>
<div class="codehilite"><pre><span></span><code>The proposed new behavior is as follows:

    x.py build --use-stage 0:
        stage1 libstd

This is suitable for contributors only working on the standard library,
as it means rustc never has to be compiled.

    x.py build --use-stage 1:
        stage1 libstd
        stage1 rustc
        stage2 libstd

This is suitable for contributors working on the compiler. It ensures
that you have a working rustc and libstd without having to pass
src/libstd in addition.

    x.py build --use-stage 2:
        stage1 libstd
        stage1 rustc
        stage2 libstd
        stage2 rustc
        stage3 libstd
        stage3 rustdoc, tools, etc.
</code></pre></div>


</blockquote>
<p><span class="user-mention" data-user-id="232545">@Joshua Nelson</span> what do you think about <span aria-label="point up" class="emoji emoji-1f446" role="img" title="point up">:point_up:</span> ?, do you think it make sense?</p>



<a name="203891072"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/233931-t-compiler/major%20changes/topic/Improve%20defaults%20in%20x.py%20compiler-team%23326/near/203891072" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Nelson <a href="https://zulip-archive.rust-lang.org/stream/233931-t-compiler/major-changes/topic/Improve.20defaults.20in.20x.2Epy.20compiler-team.23326.html#203891072">(Jul 14 2020 at 21:31)</a>:</h4>
<p>I don't want to change the terminology though</p>



<a name="203891092"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/233931-t-compiler/major%20changes/topic/Improve%20defaults%20in%20x.py%20compiler-team%23326/near/203891092" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Santiago Pastorino <a href="https://zulip-archive.rust-lang.org/stream/233931-t-compiler/major-changes/topic/Improve.20defaults.20in.20x.2Epy.20compiler-team.23326.html#203891092">(Jul 14 2020 at 21:31)</a>:</h4>
<p>yeah, I'm not talking about your PR</p>



<a name="203891115"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/233931-t-compiler/major%20changes/topic/Improve%20defaults%20in%20x.py%20compiler-team%23326/near/203891115" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Santiago Pastorino <a href="https://zulip-archive.rust-lang.org/stream/233931-t-compiler/major-changes/topic/Improve.20defaults.20in.20x.2Epy.20compiler-team.23326.html#203891115">(Jul 14 2020 at 21:31)</a>:</h4>
<p>maybe like something for the future</p>



<a name="203891136"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/233931-t-compiler/major%20changes/topic/Improve%20defaults%20in%20x.py%20compiler-team%23326/near/203891136" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Santiago Pastorino <a href="https://zulip-archive.rust-lang.org/stream/233931-t-compiler/major-changes/topic/Improve.20defaults.20in.20x.2Epy.20compiler-team.23326.html#203891136">(Jul 14 2020 at 21:31)</a>:</h4>
<p>but I want to know if what I'm saying even make sense to others</p>



<a name="203891143"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/233931-t-compiler/major%20changes/topic/Improve%20defaults%20in%20x.py%20compiler-team%23326/near/203891143" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Nelson <a href="https://zulip-archive.rust-lang.org/stream/233931-t-compiler/major-changes/topic/Improve.20defaults.20in.20x.2Epy.20compiler-team.23326.html#203891143">(Jul 14 2020 at 21:32)</a>:</h4>
<p>cc <span class="user-mention" data-user-id="119009">@eddyb</span> he feels strongly about stage naming</p>



<a name="203891187"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/233931-t-compiler/major%20changes/topic/Improve%20defaults%20in%20x.py%20compiler-team%23326/near/203891187" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Santiago Pastorino <a href="https://zulip-archive.rust-lang.org/stream/233931-t-compiler/major-changes/topic/Improve.20defaults.20in.20x.2Epy.20compiler-team.23326.html#203891187">(Jul 14 2020 at 21:32)</a>:</h4>
<p>and if so, why don't we have an schema like that</p>



<a name="203891220"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/233931-t-compiler/major%20changes/topic/Improve%20defaults%20in%20x.py%20compiler-team%23326/near/203891220" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Nelson <a href="https://zulip-archive.rust-lang.org/stream/233931-t-compiler/major-changes/topic/Improve.20defaults.20in.20x.2Epy.20compiler-team.23326.html#203891220">(Jul 14 2020 at 21:32)</a>:</h4>
<p><span class="user-mention" data-user-id="119009">@eddyb</span>  what do you think about keeping the behavior as discussed but we change the names we use for things?</p>



<a name="203891243"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/233931-t-compiler/major%20changes/topic/Improve%20defaults%20in%20x.py%20compiler-team%23326/near/203891243" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Nelson <a href="https://zulip-archive.rust-lang.org/stream/233931-t-compiler/major-changes/topic/Improve.20defaults.20in.20x.2Epy.20compiler-team.23326.html#203891243">(Jul 14 2020 at 21:32)</a>:</h4>
<p>^ see the chart <span class="user-mention silent" data-user-id="116266">Santiago Pastorino</span> wrote above</p>



<a name="203891254"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/233931-t-compiler/major%20changes/topic/Improve%20defaults%20in%20x.py%20compiler-team%23326/near/203891254" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> eddyb <a href="https://zulip-archive.rust-lang.org/stream/233931-t-compiler/major-changes/topic/Improve.20defaults.20in.20x.2Epy.20compiler-team.23326.html#203891254">(Jul 14 2020 at 21:32)</a>:</h4>
<p><span class="user-mention" data-user-id="116266">@Santiago Pastorino</span> I think you're falling into the same  trap.... <code>stageN</code> directories are <em>not</em> the stages</p>



<a name="203891286"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/233931-t-compiler/major%20changes/topic/Improve%20defaults%20in%20x.py%20compiler-team%23326/near/203891286" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Santiago Pastorino <a href="https://zulip-archive.rust-lang.org/stream/233931-t-compiler/major-changes/topic/Improve.20defaults.20in.20x.2Epy.20compiler-team.23326.html#203891286">(Jul 14 2020 at 21:33)</a>:</h4>
<p>right :)</p>



<a name="203891290"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/233931-t-compiler/major%20changes/topic/Improve%20defaults%20in%20x.py%20compiler-team%23326/near/203891290" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> eddyb <a href="https://zulip-archive.rust-lang.org/stream/233931-t-compiler/major-changes/topic/Improve.20defaults.20in.20x.2Epy.20compiler-team.23326.html#203891290">(Jul 14 2020 at 21:33)</a>:</h4>
<p>if we changed something, the first thing is to make those as clear as possible</p>



<a name="203891312"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/233931-t-compiler/major%20changes/topic/Improve%20defaults%20in%20x.py%20compiler-team%23326/near/203891312" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Santiago Pastorino <a href="https://zulip-archive.rust-lang.org/stream/233931-t-compiler/major-changes/topic/Improve.20defaults.20in.20x.2Epy.20compiler-team.23326.html#203891312">(Jul 14 2020 at 21:33)</a>:</h4>
<p><span class="user-mention silent" data-user-id="119009">eddyb</span> <a href="#narrow/stream/233931-t-compiler.2Fmajor-changes/topic/Improve.20defaults.20in.20x.2Epy.20compiler-team.23326/near/203891254">said</a>:</p>
<blockquote>
<p><span class="user-mention silent" data-user-id="116266">Santiago Pastorino</span> I think you're falling into the same  trap.... <code>stageN</code> directories are <em>not</em> the stages</p>
</blockquote>
<p>yeah I know, but isn't that confusing?</p>



<a name="203891344"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/233931-t-compiler/major%20changes/topic/Improve%20defaults%20in%20x.py%20compiler-team%23326/near/203891344" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> eddyb <a href="https://zulip-archive.rust-lang.org/stream/233931-t-compiler/major-changes/topic/Improve.20defaults.20in.20x.2Epy.20compiler-team.23326.html#203891344">(Jul 14 2020 at 21:33)</a>:</h4>
<p>so <code>--stage 1</code> currently really is "build stage1" where "stage1" is <code>stage1-*</code> and <code>stage1</code> just happens to be where we put the sysroot</p>



<a name="203891420"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/233931-t-compiler/major%20changes/topic/Improve%20defaults%20in%20x.py%20compiler-team%23326/near/203891420" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Santiago Pastorino <a href="https://zulip-archive.rust-lang.org/stream/233931-t-compiler/major-changes/topic/Improve.20defaults.20in.20x.2Epy.20compiler-team.23326.html#203891420">(Jul 14 2020 at 21:34)</a>:</h4>
<p>ok, so, it's build stage1? or is it build with stage1?</p>



<a name="203891434"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/233931-t-compiler/major%20changes/topic/Improve%20defaults%20in%20x.py%20compiler-team%23326/near/203891434" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> eddyb <a href="https://zulip-archive.rust-lang.org/stream/233931-t-compiler/major-changes/topic/Improve.20defaults.20in.20x.2Epy.20compiler-team.23326.html#203891434">(Jul 14 2020 at 21:34)</a>:</h4>
<p>it's the former, and <code>stage1</code> is a badly named directory</p>



<a name="203891452"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/233931-t-compiler/major%20changes/topic/Improve%20defaults%20in%20x.py%20compiler-team%23326/near/203891452" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> eddyb <a href="https://zulip-archive.rust-lang.org/stream/233931-t-compiler/major-changes/topic/Improve.20defaults.20in.20x.2Epy.20compiler-team.23326.html#203891452">(Jul 14 2020 at 21:34)</a>:</h4>
<p><code>stage1/bin/rustc</code> is an <em>input</em> to stage1</p>



<a name="203891464"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/233931-t-compiler/major%20changes/topic/Improve%20defaults%20in%20x.py%20compiler-team%23326/near/203891464" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Santiago Pastorino <a href="https://zulip-archive.rust-lang.org/stream/233931-t-compiler/major-changes/topic/Improve.20defaults.20in.20x.2Epy.20compiler-team.23326.html#203891464">(Jul 14 2020 at 21:34)</a>:</h4>
<p>isn't that different to what <span class="user-mention" data-user-id="232545">@Joshua Nelson</span> was saying then?</p>



<a name="203891468"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/233931-t-compiler/major%20changes/topic/Improve%20defaults%20in%20x.py%20compiler-team%23326/near/203891468" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> eddyb <a href="https://zulip-archive.rust-lang.org/stream/233931-t-compiler/major-changes/topic/Improve.20defaults.20in.20x.2Epy.20compiler-team.23326.html#203891468">(Jul 14 2020 at 21:34)</a>:</h4>
<p><code>stage1</code> is the stage1 sysroot, but improperly labelled</p>



<a name="203891489"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/233931-t-compiler/major%20changes/topic/Improve%20defaults%20in%20x.py%20compiler-team%23326/near/203891489" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Nelson <a href="https://zulip-archive.rust-lang.org/stream/233931-t-compiler/major-changes/topic/Improve.20defaults.20in.20x.2Epy.20compiler-team.23326.html#203891489">(Jul 14 2020 at 21:35)</a>:</h4>
<p>wait now I'm confused :(</p>



<a name="203891496"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/233931-t-compiler/major%20changes/topic/Improve%20defaults%20in%20x.py%20compiler-team%23326/near/203891496" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> eddyb <a href="https://zulip-archive.rust-lang.org/stream/233931-t-compiler/major-changes/topic/Improve.20defaults.20in.20x.2Epy.20compiler-team.23326.html#203891496">(Jul 14 2020 at 21:35)</a>:</h4>
<p>I would call that directory <code>stage1-sysroot</code> or <code>stage0to1</code></p>



<a name="203891513"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/233931-t-compiler/major%20changes/topic/Improve%20defaults%20in%20x.py%20compiler-team%23326/near/203891513" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> eddyb <a href="https://zulip-archive.rust-lang.org/stream/233931-t-compiler/major-changes/topic/Improve.20defaults.20in.20x.2Epy.20compiler-team.23326.html#203891513">(Jul 14 2020 at 21:35)</a>:</h4>
<p>it's not stage1 as much as it's used by/to build stage1</p>



<a name="203891535"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/233931-t-compiler/major%20changes/topic/Improve%20defaults%20in%20x.py%20compiler-team%23326/near/203891535" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> eddyb <a href="https://zulip-archive.rust-lang.org/stream/233931-t-compiler/major-changes/topic/Improve.20defaults.20in.20x.2Epy.20compiler-team.23326.html#203891535">(Jul 14 2020 at 21:35)</a>:</h4>
<p>it's the least stage1 directory out of all the ones with that prefix :P</p>



<a name="203891538"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/233931-t-compiler/major%20changes/topic/Improve%20defaults%20in%20x.py%20compiler-team%23326/near/203891538" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Nelson <a href="https://zulip-archive.rust-lang.org/stream/233931-t-compiler/major-changes/topic/Improve.20defaults.20in.20x.2Epy.20compiler-team.23326.html#203891538">(Jul 14 2020 at 21:35)</a>:</h4>
<p>so --use-stage is not correct? I thought <code>--stage N src/libstd</code> means 'build libstd with stage N'</p>



<a name="203891551"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/233931-t-compiler/major%20changes/topic/Improve%20defaults%20in%20x.py%20compiler-team%23326/near/203891551" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> eddyb <a href="https://zulip-archive.rust-lang.org/stream/233931-t-compiler/major-changes/topic/Improve.20defaults.20in.20x.2Epy.20compiler-team.23326.html#203891551">(Jul 14 2020 at 21:35)</a>:</h4>
<p>it's build <em>at</em> stage N</p>



<a name="203891553"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/233931-t-compiler/major%20changes/topic/Improve%20defaults%20in%20x.py%20compiler-team%23326/near/203891553" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> eddyb <a href="https://zulip-archive.rust-lang.org/stream/233931-t-compiler/major-changes/topic/Improve.20defaults.20in.20x.2Epy.20compiler-team.23326.html#203891553">(Jul 14 2020 at 21:35)</a>:</h4>
<p>so it builds <code>stageN-std</code></p>



<a name="203891617"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/233931-t-compiler/major%20changes/topic/Improve%20defaults%20in%20x.py%20compiler-team%23326/near/203891617" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> eddyb <a href="https://zulip-archive.rust-lang.org/stream/233931-t-compiler/major-changes/topic/Improve.20defaults.20in.20x.2Epy.20compiler-team.23326.html#203891617">(Jul 14 2020 at 21:36)</a>:</h4>
<p>the newer directories with dashes in them fit much better overall than the old nonsense</p>



<a name="203891629"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/233931-t-compiler/major%20changes/topic/Improve%20defaults%20in%20x.py%20compiler-team%23326/near/203891629" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> eddyb <a href="https://zulip-archive.rust-lang.org/stream/233931-t-compiler/major-changes/topic/Improve.20defaults.20in.20x.2Epy.20compiler-team.23326.html#203891629">(Jul 14 2020 at 21:36)</a>:</h4>
<p>and by newer I mean post-makefiles :P</p>



<a name="203891646"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/233931-t-compiler/major%20changes/topic/Improve%20defaults%20in%20x.py%20compiler-team%23326/near/203891646" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Nelson <a href="https://zulip-archive.rust-lang.org/stream/233931-t-compiler/major-changes/topic/Improve.20defaults.20in.20x.2Epy.20compiler-team.23326.html#203891646">(Jul 14 2020 at 21:36)</a>:</h4>
<p>so then ... stage0 libstd and stage0 beta compiler are part of the same stage ???</p>



<a name="203891668"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/233931-t-compiler/major%20changes/topic/Improve%20defaults%20in%20x.py%20compiler-team%23326/near/203891668" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> eddyb <a href="https://zulip-archive.rust-lang.org/stream/233931-t-compiler/major-changes/topic/Improve.20defaults.20in.20x.2Epy.20compiler-team.23326.html#203891668">(Jul 14 2020 at 21:37)</a>:</h4>
<p>"stage0 beta compiler" isn't a thing</p>



<a name="203891697"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/233931-t-compiler/major%20changes/topic/Improve%20defaults%20in%20x.py%20compiler-team%23326/near/203891697" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> eddyb <a href="https://zulip-archive.rust-lang.org/stream/233931-t-compiler/major-changes/topic/Improve.20defaults.20in.20x.2Epy.20compiler-team.23326.html#203891697">(Jul 14 2020 at 21:37)</a>:</h4>
<p><code>stage0</code>, just like <code>stage1</code>, is the <em>inputs</em> to that stage</p>



<a name="203891720"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/233931-t-compiler/major%20changes/topic/Improve%20defaults%20in%20x.py%20compiler-team%23326/near/203891720" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Nelson <a href="https://zulip-archive.rust-lang.org/stream/233931-t-compiler/major-changes/topic/Improve.20defaults.20in.20x.2Epy.20compiler-team.23326.html#203891720">(Jul 14 2020 at 21:37)</a>:</h4>
<p>ok, so then stage0 libstd and the first rustc built by beta are the same stage</p>



<a name="203891727"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/233931-t-compiler/major%20changes/topic/Improve%20defaults%20in%20x.py%20compiler-team%23326/near/203891727" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> eddyb <a href="https://zulip-archive.rust-lang.org/stream/233931-t-compiler/major-changes/topic/Improve.20defaults.20in.20x.2Epy.20compiler-team.23326.html#203891727">(Jul 14 2020 at 21:37)</a>:</h4>
<p>correct</p>



<a name="203891793"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/233931-t-compiler/major%20changes/topic/Improve%20defaults%20in%20x.py%20compiler-team%23326/near/203891793" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> eddyb <a href="https://zulip-archive.rust-lang.org/stream/233931-t-compiler/major-changes/topic/Improve.20defaults.20in.20x.2Epy.20compiler-team.23326.html#203891793">(Jul 14 2020 at 21:38)</a>:</h4>
<p><code>stage0/bin/rustc</code> is the compiler that will be used to build stage0, and unlike renaming <code>stage1</code> to<code>stage0to1</code>, there isn't something to rename <code>stage0</code> to, with the same scheme, lol</p>



<a name="203891806"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/233931-t-compiler/major%20changes/topic/Improve%20defaults%20in%20x.py%20compiler-team%23326/near/203891806" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Santiago Pastorino <a href="https://zulip-archive.rust-lang.org/stream/233931-t-compiler/major-changes/topic/Improve.20defaults.20in.20x.2Epy.20compiler-team.23326.html#203891806">(Jul 14 2020 at 21:38)</a>:</h4>
<p>I guess what I feel is that there are kind of different meanings of what really stage means flying around</p>



<a name="203891807"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/233931-t-compiler/major%20changes/topic/Improve%20defaults%20in%20x.py%20compiler-team%23326/near/203891807" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Nelson <a href="https://zulip-archive.rust-lang.org/stream/233931-t-compiler/major-changes/topic/Improve.20defaults.20in.20x.2Epy.20compiler-team.23326.html#203891807">(Jul 14 2020 at 21:38)</a>:</h4>
<p>I understand those are the current directory names (stage0-std, stage0-rustc and all that), but can you explain again why it makes sense to consider those both part of the same stage?</p>



<a name="203891812"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/233931-t-compiler/major%20changes/topic/Improve%20defaults%20in%20x.py%20compiler-team%23326/near/203891812" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> eddyb <a href="https://zulip-archive.rust-lang.org/stream/233931-t-compiler/major-changes/topic/Improve.20defaults.20in.20x.2Epy.20compiler-team.23326.html#203891812">(Jul 14 2020 at 21:38)</a>:</h4>
<p>short of <code>stage0-sysroot</code> (which is already taken up because we need two sysroots lol)</p>



<a name="203891834"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/233931-t-compiler/major%20changes/topic/Improve%20defaults%20in%20x.py%20compiler-team%23326/near/203891834" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> eddyb <a href="https://zulip-archive.rust-lang.org/stream/233931-t-compiler/major-changes/topic/Improve.20defaults.20in.20x.2Epy.20compiler-team.23326.html#203891834">(Jul 14 2020 at 21:39)</a>:</h4>
<p><span class="user-mention" data-user-id="232545">@Joshua Nelson</span> because the only difference is which crate is being compiled</p>



<a name="203891861"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/233931-t-compiler/major%20changes/topic/Improve%20defaults%20in%20x.py%20compiler-team%23326/near/203891861" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> eddyb <a href="https://zulip-archive.rust-lang.org/stream/233931-t-compiler/major-changes/topic/Improve.20defaults.20in.20x.2Epy.20compiler-team.23326.html#203891861">(Jul 14 2020 at 21:39)</a>:</h4>
<p>you could imagine <code>src/librustc_*</code> just explicitly depending on <code>src/libstd</code></p>



<a name="203891869"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/233931-t-compiler/major%20changes/topic/Improve%20defaults%20in%20x.py%20compiler-team%23326/near/203891869" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> eddyb <a href="https://zulip-archive.rust-lang.org/stream/233931-t-compiler/major-changes/topic/Improve.20defaults.20in.20x.2Epy.20compiler-team.23326.html#203891869">(Jul 14 2020 at 21:39)</a>:</h4>
<p>it's all one big compilation</p>



<a name="203891954"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/233931-t-compiler/major%20changes/topic/Improve%20defaults%20in%20x.py%20compiler-team%23326/near/203891954" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> eddyb <a href="https://zulip-archive.rust-lang.org/stream/233931-t-compiler/major-changes/topic/Improve.20defaults.20in.20x.2Epy.20compiler-team.23326.html#203891954">(Jul 14 2020 at 21:40)</a>:</h4>
<p>you don't switch from one stage to the next without changing the compiler... that's "staging"</p>



<a name="203891964"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/233931-t-compiler/major%20changes/topic/Improve%20defaults%20in%20x.py%20compiler-team%23326/near/203891964" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Nelson <a href="https://zulip-archive.rust-lang.org/stream/233931-t-compiler/major-changes/topic/Improve.20defaults.20in.20x.2Epy.20compiler-team.23326.html#203891964">(Jul 14 2020 at 21:40)</a>:</h4>
<p>ok, they belong to each other because they're linked together?</p>



<a name="203891967"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/233931-t-compiler/major%20changes/topic/Improve%20defaults%20in%20x.py%20compiler-team%23326/near/203891967" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> eddyb <a href="https://zulip-archive.rust-lang.org/stream/233931-t-compiler/major-changes/topic/Improve.20defaults.20in.20x.2Epy.20compiler-team.23326.html#203891967">(Jul 14 2020 at 21:40)</a>:</h4>
<p>think of, idk, a rocket</p>



<a name="203891979"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/233931-t-compiler/major%20changes/topic/Improve%20defaults%20in%20x.py%20compiler-team%23326/near/203891979" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> eddyb <a href="https://zulip-archive.rust-lang.org/stream/233931-t-compiler/major-changes/topic/Improve.20defaults.20in.20x.2Epy.20compiler-team.23326.html#203891979">(Jul 14 2020 at 21:40)</a>:</h4>
<p><span class="user-mention silent" data-user-id="232545">Joshua Nelson</span> <a href="#narrow/stream/233931-t-compiler.2Fmajor-changes/topic/Improve.20defaults.20in.20x.2Epy.20compiler-team.23326/near/203891964">said</a>:</p>
<blockquote>
<p>ok, they belong to each other because they're linked together?</p>
</blockquote>
<p>yes! and that has a lot of implications</p>



<a name="203892012"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/233931-t-compiler/major%20changes/topic/Improve%20defaults%20in%20x.py%20compiler-team%23326/near/203892012" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> eddyb <a href="https://zulip-archive.rust-lang.org/stream/233931-t-compiler/major-changes/topic/Improve.20defaults.20in.20x.2Epy.20compiler-team.23326.html#203892012">(Jul 14 2020 at 21:41)</a>:</h4>
<p>the sections of the rocket are the "stages", whereas the engine would be the compiler</p>



<a name="203892021"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/233931-t-compiler/major%20changes/topic/Improve%20defaults%20in%20x.py%20compiler-team%23326/near/203892021" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> eddyb <a href="https://zulip-archive.rust-lang.org/stream/233931-t-compiler/major-changes/topic/Improve.20defaults.20in.20x.2Epy.20compiler-team.23326.html#203892021">(Jul 14 2020 at 21:41)</a>:</h4>
<p>the engines are more or less between the stages</p>



<a name="203892063"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/233931-t-compiler/major%20changes/topic/Improve%20defaults%20in%20x.py%20compiler-team%23326/near/203892063" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Nelson <a href="https://zulip-archive.rust-lang.org/stream/233931-t-compiler/major-changes/topic/Improve.20defaults.20in.20x.2Epy.20compiler-team.23326.html#203892063">(Jul 14 2020 at 21:41)</a>:</h4>
<p>so then you would say there is no stage3</p>



<a name="203892065"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/233931-t-compiler/major%20changes/topic/Improve%20defaults%20in%20x.py%20compiler-team%23326/near/203892065" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> eddyb <a href="https://zulip-archive.rust-lang.org/stream/233931-t-compiler/major-changes/topic/Improve.20defaults.20in.20x.2Epy.20compiler-team.23326.html#203892065">(Jul 14 2020 at 21:41)</a>:</h4>
<p>so you have <code>stage0/bin/rustc</code> as the bottom-most engine, followed by an entire stage0, then this repeats for each stage</p>



<a name="203892129"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/233931-t-compiler/major%20changes/topic/Improve%20defaults%20in%20x.py%20compiler-team%23326/near/203892129" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> eddyb <a href="https://zulip-archive.rust-lang.org/stream/233931-t-compiler/major-changes/topic/Improve.20defaults.20in.20x.2Epy.20compiler-team.23326.html#203892129">(Jul 14 2020 at 21:42)</a>:</h4>
<p>no, not unless you build <code>stage3-std</code> and maybe <code>stage3-rustc</code> (which you could trivially use to link <code>stage4/bin/rustc</code>)</p>



<a name="203892139"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/233931-t-compiler/major%20changes/topic/Improve%20defaults%20in%20x.py%20compiler-team%23326/near/203892139" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Nelson <a href="https://zulip-archive.rust-lang.org/stream/233931-t-compiler/major-changes/topic/Improve.20defaults.20in.20x.2Epy.20compiler-team.23326.html#203892139">(Jul 14 2020 at 21:42)</a>:</h4>
<p>right</p>



<a name="203892143"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/233931-t-compiler/major%20changes/topic/Improve%20defaults%20in%20x.py%20compiler-team%23326/near/203892143" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Nelson <a href="https://zulip-archive.rust-lang.org/stream/233931-t-compiler/major-changes/topic/Improve.20defaults.20in.20x.2Epy.20compiler-team.23326.html#203892143">(Jul 14 2020 at 21:42)</a>:</h4>
<p>ok I will update the numbering in the MCP to match that</p>



<a name="203892151"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/233931-t-compiler/major%20changes/topic/Improve%20defaults%20in%20x.py%20compiler-team%23326/near/203892151" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> eddyb <a href="https://zulip-archive.rust-lang.org/stream/233931-t-compiler/major-changes/topic/Improve.20defaults.20in.20x.2Epy.20compiler-team.23326.html#203892151">(Jul 14 2020 at 21:42)</a>:</h4>
<p>we could have it so instead of <code>stage1/bin/rustc</code> you use <code>stage0-output/bin/rustc</code></p>



<a name="203892154"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/233931-t-compiler/major%20changes/topic/Improve%20defaults%20in%20x.py%20compiler-team%23326/near/203892154" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> eddyb <a href="https://zulip-archive.rust-lang.org/stream/233931-t-compiler/major-changes/topic/Improve.20defaults.20in.20x.2Epy.20compiler-team.23326.html#203892154">(Jul 14 2020 at 21:42)</a>:</h4>
<p>maybe that would make it more obvious</p>



<a name="203892160"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/233931-t-compiler/major%20changes/topic/Improve%20defaults%20in%20x.py%20compiler-team%23326/near/203892160" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> eddyb <a href="https://zulip-archive.rust-lang.org/stream/233931-t-compiler/major-changes/topic/Improve.20defaults.20in.20x.2Epy.20compiler-team.23326.html#203892160">(Jul 14 2020 at 21:42)</a>:</h4>
<p>and then hide the sysroot better or something</p>



<a name="203892188"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/233931-t-compiler/major%20changes/topic/Improve%20defaults%20in%20x.py%20compiler-team%23326/near/203892188" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Nelson <a href="https://zulip-archive.rust-lang.org/stream/233931-t-compiler/major-changes/topic/Improve.20defaults.20in.20x.2Epy.20compiler-team.23326.html#203892188">(Jul 14 2020 at 21:43)</a>:</h4>
<p>personally I think <code>stage1</code> is silly and we should use <code>stage0-rustc</code> directly</p>



<a name="203892195"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/233931-t-compiler/major%20changes/topic/Improve%20defaults%20in%20x.py%20compiler-team%23326/near/203892195" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> eddyb <a href="https://zulip-archive.rust-lang.org/stream/233931-t-compiler/major-changes/topic/Improve.20defaults.20in.20x.2Epy.20compiler-team.23326.html#203892195">(Jul 14 2020 at 21:43)</a>:</h4>
<p>it's only confusing because there's "segments" and "points" between them (that are the output of one segment and the input of the next)</p>



<a name="203892198"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/233931-t-compiler/major%20changes/topic/Improve%20defaults%20in%20x.py%20compiler-team%23326/near/203892198" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Nelson <a href="https://zulip-archive.rust-lang.org/stream/233931-t-compiler/major-changes/topic/Improve.20defaults.20in.20x.2Epy.20compiler-team.23326.html#203892198">(Jul 14 2020 at 21:43)</a>:</h4>
<p>then you don't have people getting confused like this</p>



<a name="203892205"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/233931-t-compiler/major%20changes/topic/Improve%20defaults%20in%20x.py%20compiler-team%23326/near/203892205" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> eddyb <a href="https://zulip-archive.rust-lang.org/stream/233931-t-compiler/major-changes/topic/Improve.20defaults.20in.20x.2Epy.20compiler-team.23326.html#203892205">(Jul 14 2020 at 21:43)</a>:</h4>
<p>oh yeah I definitely agree</p>



<a name="203892232"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/233931-t-compiler/major%20changes/topic/Improve%20defaults%20in%20x.py%20compiler-team%23326/near/203892232" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> eddyb <a href="https://zulip-archive.rust-lang.org/stream/233931-t-compiler/major-changes/topic/Improve.20defaults.20in.20x.2Epy.20compiler-team.23326.html#203892232">(Jul 14 2020 at 21:44)</a>:</h4>
<p>I was saying elsewhere that I'd prefer if we symlink'd <code>stage0-rustc/$HOST/release/rustc</code> directly into the rustup toolchain dir or w/e</p>



<a name="203892285"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/233931-t-compiler/major%20changes/topic/Improve%20defaults%20in%20x.py%20compiler-team%23326/near/203892285" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> eddyb <a href="https://zulip-archive.rust-lang.org/stream/233931-t-compiler/major-changes/topic/Improve.20defaults.20in.20x.2Epy.20compiler-team.23326.html#203892285">(Jul 14 2020 at 21:44)</a>:</h4>
<p>I much prefer the dashed directories</p>



<a name="203892314"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/233931-t-compiler/major%20changes/topic/Improve%20defaults%20in%20x.py%20compiler-team%23326/near/203892314" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> eddyb <a href="https://zulip-archive.rust-lang.org/stream/233931-t-compiler/major-changes/topic/Improve.20defaults.20in.20x.2Epy.20compiler-team.23326.html#203892314">(Jul 14 2020 at 21:44)</a>:</h4>
<p>partly because of what I remember from the makefile days, cursed be their memory</p>



<a name="203892478"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/233931-t-compiler/major%20changes/topic/Improve%20defaults%20in%20x.py%20compiler-team%23326/near/203892478" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Nelson <a href="https://zulip-archive.rust-lang.org/stream/233931-t-compiler/major-changes/topic/Improve.20defaults.20in.20x.2Epy.20compiler-team.23326.html#203892478">(Jul 14 2020 at 21:46)</a>:</h4>
<p>and remind me why rustdoc is off-by-one? it links against the previous compiler or something?</p>



<a name="203892724"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/233931-t-compiler/major%20changes/topic/Improve%20defaults%20in%20x.py%20compiler-team%23326/near/203892724" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> eddyb <a href="https://zulip-archive.rust-lang.org/stream/233931-t-compiler/major-changes/topic/Improve.20defaults.20in.20x.2Epy.20compiler-team.23326.html#203892724">(Jul 14 2020 at 21:49)</a>:</h4>
<p>yeah, IMO running the tests should build the previous stage of tools, that way building rustdoc itself shouldn't need an off by one</p>



<a name="203892841"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/233931-t-compiler/major%20changes/topic/Improve%20defaults%20in%20x.py%20compiler-team%23326/near/203892841" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> eddyb <a href="https://zulip-archive.rust-lang.org/stream/233931-t-compiler/major-changes/topic/Improve.20defaults.20in.20x.2Epy.20compiler-team.23326.html#203892841">(Jul 14 2020 at 21:50)</a>:</h4>
<p>basically today <code>x.py test --stage N src/test/ui/rustdoc</code> depends on <code>x.py build --stage N src/tools/rustdoc</code> and the latter uses <code>x.py build --stage N-1</code> compiler libs, not <code>x.py build --stage N</code> compiler libs, so it feels wrong</p>



<a name="203892856"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/233931-t-compiler/major%20changes/topic/Improve%20defaults%20in%20x.py%20compiler-team%23326/near/203892856" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> eddyb <a href="https://zulip-archive.rust-lang.org/stream/233931-t-compiler/major-changes/topic/Improve.20defaults.20in.20x.2Epy.20compiler-team.23326.html#203892856">(Jul 14 2020 at 21:50)</a>:</h4>
<p>instead we could have <code>x.py test --stage N src/test/ui/rustdoc</code> depend on <code>x.py build --stage N-1 src/tools/rustdoc</code></p>



<a name="203892887"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/233931-t-compiler/major%20changes/topic/Improve%20defaults%20in%20x.py%20compiler-team%23326/near/203892887" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Nelson <a href="https://zulip-archive.rust-lang.org/stream/233931-t-compiler/major-changes/topic/Improve.20defaults.20in.20x.2Epy.20compiler-team.23326.html#203892887">(Jul 14 2020 at 21:51)</a>:</h4>
<p>ok, so how does this new numbering look</p>



<a name="203892917"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/233931-t-compiler/major%20changes/topic/Improve%20defaults%20in%20x.py%20compiler-team%23326/near/203892917" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Nelson <a href="https://zulip-archive.rust-lang.org/stream/233931-t-compiler/major-changes/topic/Improve.20defaults.20in.20x.2Epy.20compiler-team.23326.html#203892917">(Jul 14 2020 at 21:51)</a>:</h4>
<p><a href="https://gist.github.com/jyn514/e3da90ee203d5eb9194255afef428d2c">https://gist.github.com/jyn514/e3da90ee203d5eb9194255afef428d2c</a></p>



<a name="203892930"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/233931-t-compiler/major%20changes/topic/Improve%20defaults%20in%20x.py%20compiler-team%23326/near/203892930" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Nelson <a href="https://zulip-archive.rust-lang.org/stream/233931-t-compiler/major-changes/topic/Improve.20defaults.20in.20x.2Epy.20compiler-team.23326.html#203892930">(Jul 14 2020 at 21:51)</a>:</h4>
<p>rustdoc is the one I'm not sure about</p>



<a name="203893456"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/233931-t-compiler/major%20changes/topic/Improve%20defaults%20in%20x.py%20compiler-team%23326/near/203893456" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Nelson <a href="https://zulip-archive.rust-lang.org/stream/233931-t-compiler/major-changes/topic/Improve.20defaults.20in.20x.2Epy.20compiler-team.23326.html#203893456">(Jul 14 2020 at 21:57)</a>:</h4>
<p>err actually that was off a bit, I updated it</p>



<a name="203894277"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/233931-t-compiler/major%20changes/topic/Improve%20defaults%20in%20x.py%20compiler-team%23326/near/203894277" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Nelson <a href="https://zulip-archive.rust-lang.org/stream/233931-t-compiler/major-changes/topic/Improve.20defaults.20in.20x.2Epy.20compiler-team.23326.html#203894277">(Jul 14 2020 at 22:06)</a>:</h4>
<p>Updated the MCP to use the revised numbering</p>



<a name="203895170"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/233931-t-compiler/major%20changes/topic/Improve%20defaults%20in%20x.py%20compiler-team%23326/near/203895170" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> eddyb <a href="https://zulip-archive.rust-lang.org/stream/233931-t-compiler/major-changes/topic/Improve.20defaults.20in.20x.2Epy.20compiler-team.23326.html#203895170">(Jul 14 2020 at 22:17)</a>:</h4>
<p>I would use the same numbering for rustc and rustdoc</p>



<a name="203895194"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/233931-t-compiler/major%20changes/topic/Improve%20defaults%20in%20x.py%20compiler-team%23326/near/203895194" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> eddyb <a href="https://zulip-archive.rust-lang.org/stream/233931-t-compiler/major-changes/topic/Improve.20defaults.20in.20x.2Epy.20compiler-team.23326.html#203895194">(Jul 14 2020 at 22:17)</a>:</h4>
<p>so that only libstd is on the last stage</p>



<a name="203895323"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/233931-t-compiler/major%20changes/topic/Improve%20defaults%20in%20x.py%20compiler-team%23326/near/203895323" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Nelson <a href="https://zulip-archive.rust-lang.org/stream/233931-t-compiler/major-changes/topic/Improve.20defaults.20in.20x.2Epy.20compiler-team.23326.html#203895323">(Jul 14 2020 at 22:19)</a>:</h4>
<p>even though what you're calling <code>stage1 rustdoc</code> is built with <code>build --stage 2 src/tools/rustdoc</code>?</p>



<a name="203895344"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/233931-t-compiler/major%20changes/topic/Improve%20defaults%20in%20x.py%20compiler-team%23326/near/203895344" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> eddyb <a href="https://zulip-archive.rust-lang.org/stream/233931-t-compiler/major-changes/topic/Improve.20defaults.20in.20x.2Epy.20compiler-team.23326.html#203895344">(Jul 14 2020 at 22:19)</a>:</h4>
<p>I think the current <code>build</code> behavior for rustdoc is wrong</p>



<a name="203895410"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/233931-t-compiler/major%20changes/topic/Improve%20defaults%20in%20x.py%20compiler-team%23326/near/203895410" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> eddyb <a href="https://zulip-archive.rust-lang.org/stream/233931-t-compiler/major-changes/topic/Improve.20defaults.20in.20x.2Epy.20compiler-team.23326.html#203895410">(Jul 14 2020 at 22:20)</a>:</h4>
<p>either that or all the other tools are wrong and we have to find a good way to handle all of them</p>



<a name="203895420"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/233931-t-compiler/major%20changes/topic/Improve%20defaults%20in%20x.py%20compiler-team%23326/near/203895420" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> eddyb <a href="https://zulip-archive.rust-lang.org/stream/233931-t-compiler/major-changes/topic/Improve.20defaults.20in.20x.2Epy.20compiler-team.23326.html#203895420">(Jul 14 2020 at 22:20)</a>:</h4>
<p>but technically <code>rustdoc</code> is in the minority with its behavior</p>



<a name="203895433"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/233931-t-compiler/major%20changes/topic/Improve%20defaults%20in%20x.py%20compiler-team%23326/near/203895433" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Nelson <a href="https://zulip-archive.rust-lang.org/stream/233931-t-compiler/major-changes/topic/Improve.20defaults.20in.20x.2Epy.20compiler-team.23326.html#203895433">(Jul 14 2020 at 22:20)</a>:</h4>
<p>Sure, it's definitely it's the odd man out</p>



<a name="203895441"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/233931-t-compiler/major%20changes/topic/Improve%20defaults%20in%20x.py%20compiler-team%23326/near/203895441" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Nelson <a href="https://zulip-archive.rust-lang.org/stream/233931-t-compiler/major-changes/topic/Improve.20defaults.20in.20x.2Epy.20compiler-team.23326.html#203895441">(Jul 14 2020 at 22:20)</a>:</h4>
<p>but I think we should keep consistency with x.py</p>



<a name="203895447"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/233931-t-compiler/major%20changes/topic/Improve%20defaults%20in%20x.py%20compiler-team%23326/near/203895447" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> eddyb <a href="https://zulip-archive.rust-lang.org/stream/233931-t-compiler/major-changes/topic/Improve.20defaults.20in.20x.2Epy.20compiler-team.23326.html#203895447">(Jul 14 2020 at 22:20)</a>:</h4>
<p>and it would make your gist read much better</p>



<a name="203895465"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/233931-t-compiler/major%20changes/topic/Improve%20defaults%20in%20x.py%20compiler-team%23326/near/203895465" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> eddyb <a href="https://zulip-archive.rust-lang.org/stream/233931-t-compiler/major-changes/topic/Improve.20defaults.20in.20x.2Epy.20compiler-team.23326.html#203895465">(Jul 14 2020 at 22:21)</a>:</h4>
<p>to what end? it just introduces confusion</p>



<a name="203895482"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/233931-t-compiler/major%20changes/topic/Improve%20defaults%20in%20x.py%20compiler-team%23326/near/203895482" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> eddyb <a href="https://zulip-archive.rust-lang.org/stream/233931-t-compiler/major-changes/topic/Improve.20defaults.20in.20x.2Epy.20compiler-team.23326.html#203895482">(Jul 14 2020 at 22:21)</a>:</h4>
<p>also note that <code>x.py build</code> will build other tools as well, if they're enabled in <code>config.toml</code></p>



<a name="203895494"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/233931-t-compiler/major%20changes/topic/Improve%20defaults%20in%20x.py%20compiler-team%23326/near/203895494" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Nelson <a href="https://zulip-archive.rust-lang.org/stream/233931-t-compiler/major-changes/topic/Improve.20defaults.20in.20x.2Epy.20compiler-team.23326.html#203895494">(Jul 14 2020 at 22:21)</a>:</h4>
<p>ok, I'll say <code>stageN tools</code> then</p>



<a name="203895496"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/233931-t-compiler/major%20changes/topic/Improve%20defaults%20in%20x.py%20compiler-team%23326/near/203895496" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> eddyb <a href="https://zulip-archive.rust-lang.org/stream/233931-t-compiler/major-changes/topic/Improve.20defaults.20in.20x.2Epy.20compiler-team.23326.html#203895496">(Jul 14 2020 at 22:21)</a>:</h4>
<p>and in your gist, they're like <code>rustc</code> not like <code>rustdoc</code></p>



<a name="203895499"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/233931-t-compiler/major%20changes/topic/Improve%20defaults%20in%20x.py%20compiler-team%23326/near/203895499" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> eddyb <a href="https://zulip-archive.rust-lang.org/stream/233931-t-compiler/major-changes/topic/Improve.20defaults.20in.20x.2Epy.20compiler-team.23326.html#203895499">(Jul 14 2020 at 22:21)</a>:</h4>
<p>thanks ^_^</p>



<a name="203895507"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/233931-t-compiler/major%20changes/topic/Improve%20defaults%20in%20x.py%20compiler-team%23326/near/203895507" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Nelson <a href="https://zulip-archive.rust-lang.org/stream/233931-t-compiler/major-changes/topic/Improve.20defaults.20in.20x.2Epy.20compiler-team.23326.html#203895507">(Jul 14 2020 at 22:21)</a>:</h4>
<p>where N is the stage of the compiler they're linked to</p>



<a name="203895729"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/233931-t-compiler/major%20changes/topic/Improve%20defaults%20in%20x.py%20compiler-team%23326/near/203895729" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Nelson <a href="https://zulip-archive.rust-lang.org/stream/233931-t-compiler/major-changes/topic/Improve.20defaults.20in.20x.2Epy.20compiler-team.23326.html#203895729">(Jul 14 2020 at 22:25)</a>:</h4>
<p>wait no now I'm confused again</p>



<a name="203895751"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/233931-t-compiler/major%20changes/topic/Improve%20defaults%20in%20x.py%20compiler-team%23326/near/203895751" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Nelson <a href="https://zulip-archive.rust-lang.org/stream/233931-t-compiler/major-changes/topic/Improve.20defaults.20in.20x.2Epy.20compiler-team.23326.html#203895751">(Jul 14 2020 at 22:25)</a>:</h4>
<p>If I say <code>x.py build --stage 1 src/tools/cargo</code>, does that build rustc once or twice?</p>



<a name="203895780"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/233931-t-compiler/major%20changes/topic/Improve%20defaults%20in%20x.py%20compiler-team%23326/near/203895780" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> eddyb <a href="https://zulip-archive.rust-lang.org/stream/233931-t-compiler/major-changes/topic/Improve.20defaults.20in.20x.2Epy.20compiler-team.23326.html#203895780">(Jul 14 2020 at 22:25)</a>:</h4>
<p>good question</p>



<a name="203895805"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/233931-t-compiler/major%20changes/topic/Improve%20defaults%20in%20x.py%20compiler-team%23326/near/203895805" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> eddyb <a href="https://zulip-archive.rust-lang.org/stream/233931-t-compiler/major-changes/topic/Improve.20defaults.20in.20x.2Epy.20compiler-team.23326.html#203895805">(Jul 14 2020 at 22:26)</a>:</h4>
<p>Cargo doesn't depend on rustc libraries, so probably only once</p>



<a name="203895853"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/233931-t-compiler/major%20changes/topic/Improve%20defaults%20in%20x.py%20compiler-team%23326/near/203895853" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> eddyb <a href="https://zulip-archive.rust-lang.org/stream/233931-t-compiler/major-changes/topic/Improve.20defaults.20in.20x.2Epy.20compiler-team.23326.html#203895853">(Jul 14 2020 at 22:26)</a>:</h4>
<p>(i.e. <code>x.py build --stage 1 src/libstd</code> + Cargo build)</p>



<a name="203895868"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/233931-t-compiler/major%20changes/topic/Improve%20defaults%20in%20x.py%20compiler-team%23326/near/203895868" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> eddyb <a href="https://zulip-archive.rust-lang.org/stream/233931-t-compiler/major-changes/topic/Improve.20defaults.20in.20x.2Epy.20compiler-team.23326.html#203895868">(Jul 14 2020 at 22:26)</a>:</h4>
<p>cc <span class="user-mention" data-user-id="116122">@simulacrum</span></p>



<a name="203895875"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/233931-t-compiler/major%20changes/topic/Improve%20defaults%20in%20x.py%20compiler-team%23326/near/203895875" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Nelson <a href="https://zulip-archive.rust-lang.org/stream/233931-t-compiler/major-changes/topic/Improve.20defaults.20in.20x.2Epy.20compiler-team.23326.html#203895875">(Jul 14 2020 at 22:26)</a>:</h4>
<p>so in the case of tools, it really is --use-stage</p>



<a name="203895900"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/233931-t-compiler/major%20changes/topic/Improve%20defaults%20in%20x.py%20compiler-team%23326/near/203895900" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Nelson <a href="https://zulip-archive.rust-lang.org/stream/233931-t-compiler/major-changes/topic/Improve.20defaults.20in.20x.2Epy.20compiler-team.23326.html#203895900">(Jul 14 2020 at 22:26)</a>:</h4>
<p>It's only for things that link to rustc that it's --build-stage</p>



<a name="203895939"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/233931-t-compiler/major%20changes/topic/Improve%20defaults%20in%20x.py%20compiler-team%23326/near/203895939" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> eddyb <a href="https://zulip-archive.rust-lang.org/stream/233931-t-compiler/major-changes/topic/Improve.20defaults.20in.20x.2Epy.20compiler-team.23326.html#203895939">(Jul 14 2020 at 22:27)</a>:</h4>
<p>I mean, you might be conflating a few things? the various steps still have dependencies</p>



<a name="203895974"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/233931-t-compiler/major%20changes/topic/Improve%20defaults%20in%20x.py%20compiler-team%23326/near/203895974" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> simulacrum <a href="https://zulip-archive.rust-lang.org/stream/233931-t-compiler/major-changes/topic/Improve.20defaults.20in.20x.2Epy.20compiler-team.23326.html#203895974">(Jul 14 2020 at 22:27)</a>:</h4>
<p>Should be correct - not sure if entirely the case today (cargo tests <em>do</em> have rustc sysroot deps, currently)</p>



<a name="203896028"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/233931-t-compiler/major%20changes/topic/Improve%20defaults%20in%20x.py%20compiler-team%23326/near/203896028" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> eddyb <a href="https://zulip-archive.rust-lang.org/stream/233931-t-compiler/major-changes/topic/Improve.20defaults.20in.20x.2Epy.20compiler-team.23326.html#203896028">(Jul 14 2020 at 22:28)</a>:</h4>
<p>so the difference is Cargo depends on std but clippy depends on rustc (and transitively on std)</p>



<a name="203896044"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/233931-t-compiler/major%20changes/topic/Improve%20defaults%20in%20x.py%20compiler-team%23326/near/203896044" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> eddyb <a href="https://zulip-archive.rust-lang.org/stream/233931-t-compiler/major-changes/topic/Improve.20defaults.20in.20x.2Epy.20compiler-team.23326.html#203896044">(Jul 14 2020 at 22:28)</a>:</h4>
<p>all of these dependencies are satisfied within/"at" the stage provided in <code>--stage</code></p>



<a name="203896067"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/233931-t-compiler/major%20changes/topic/Improve%20defaults%20in%20x.py%20compiler-team%23326/near/203896067" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Nelson <a href="https://zulip-archive.rust-lang.org/stream/233931-t-compiler/major-changes/topic/Improve.20defaults.20in.20x.2Epy.20compiler-team.23326.html#203896067">(Jul 14 2020 at 22:28)</a>:</h4>
<p>maybe I should just omit the tools altogether lol</p>



<a name="203896075"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/233931-t-compiler/major%20changes/topic/Improve%20defaults%20in%20x.py%20compiler-team%23326/near/203896075" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Nelson <a href="https://zulip-archive.rust-lang.org/stream/233931-t-compiler/major-changes/topic/Improve.20defaults.20in.20x.2Epy.20compiler-team.23326.html#203896075">(Jul 14 2020 at 22:28)</a>:</h4>
<p>I'm not changing how they behave</p>



<a name="203896099"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/233931-t-compiler/major%20changes/topic/Improve%20defaults%20in%20x.py%20compiler-team%23326/near/203896099" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> eddyb <a href="https://zulip-archive.rust-lang.org/stream/233931-t-compiler/major-changes/topic/Improve.20defaults.20in.20x.2Epy.20compiler-team.23326.html#203896099">(Jul 14 2020 at 22:29)</a>:</h4>
<p>you'd only need to change <code>rustdoc</code> for them to appear sensible <em>shrug</em></p>



<a name="203896139"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/233931-t-compiler/major%20changes/topic/Improve%20defaults%20in%20x.py%20compiler-team%23326/near/203896139" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> eddyb <a href="https://zulip-archive.rust-lang.org/stream/233931-t-compiler/major-changes/topic/Improve.20defaults.20in.20x.2Epy.20compiler-team.23326.html#203896139">(Jul 14 2020 at 22:29)</a>:</h4>
<p><span class="user-mention" data-user-id="116122">@simulacrum</span> wait what why would Cargo tests want to do that</p>



<a name="203896152"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/233931-t-compiler/major%20changes/topic/Improve%20defaults%20in%20x.py%20compiler-team%23326/near/203896152" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> simulacrum <a href="https://zulip-archive.rust-lang.org/stream/233931-t-compiler/major-changes/topic/Improve.20defaults.20in.20x.2Epy.20compiler-team.23326.html#203896152">(Jul 14 2020 at 22:29)</a>:</h4>
<p>The difference between std-dep tools and rustc-dep tools, including rustc itself in some sense is one of the core confusions I think with stage-naming</p>



<a name="203896169"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/233931-t-compiler/major%20changes/topic/Improve%20defaults%20in%20x.py%20compiler-team%23326/near/203896169" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> eddyb <a href="https://zulip-archive.rust-lang.org/stream/233931-t-compiler/major-changes/topic/Improve.20defaults.20in.20x.2Epy.20compiler-team.23326.html#203896169">(Jul 14 2020 at 22:29)</a>:</h4>
<p>surely it's not for proc macros?</p>



<a name="203896177"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/233931-t-compiler/major%20changes/topic/Improve%20defaults%20in%20x.py%20compiler-team%23326/near/203896177" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> simulacrum <a href="https://zulip-archive.rust-lang.org/stream/233931-t-compiler/major-changes/topic/Improve.20defaults.20in.20x.2Epy.20compiler-team.23326.html#203896177">(Jul 14 2020 at 22:29)</a>:</h4>
<p><span class="user-mention" data-user-id="119009">@eddyb</span> I don't think it's "want" more so just no one's purged all of that</p>



<a name="203896193"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/233931-t-compiler/major%20changes/topic/Improve%20defaults%20in%20x.py%20compiler-team%23326/near/203896193" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> simulacrum <a href="https://zulip-archive.rust-lang.org/stream/233931-t-compiler/major-changes/topic/Improve.20defaults.20in.20x.2Epy.20compiler-team.23326.html#203896193">(Jul 14 2020 at 22:29)</a>:</h4>
<p>No it's like plugin testing or something</p>



<a name="203896251"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/233931-t-compiler/major%20changes/topic/Improve%20defaults%20in%20x.py%20compiler-team%23326/near/203896251" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> eddyb <a href="https://zulip-archive.rust-lang.org/stream/233931-t-compiler/major-changes/topic/Improve.20defaults.20in.20x.2Epy.20compiler-team.23326.html#203896251">(Jul 14 2020 at 22:30)</a>:</h4>
<p>I wonder why Cargo wanted to ever test that :/</p>



<a name="203896270"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/233931-t-compiler/major%20changes/topic/Improve%20defaults%20in%20x.py%20compiler-team%23326/near/203896270" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> eddyb <a href="https://zulip-archive.rust-lang.org/stream/233931-t-compiler/major-changes/topic/Improve.20defaults.20in.20x.2Epy.20compiler-team.23326.html#203896270">(Jul 14 2020 at 22:30)</a>:</h4>
<p>maybe it has something to do with Servo <em>shrug</em></p>



<a name="203896295"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/233931-t-compiler/major%20changes/topic/Improve%20defaults%20in%20x.py%20compiler-team%23326/near/203896295" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> simulacrum <a href="https://zulip-archive.rust-lang.org/stream/233931-t-compiler/major-changes/topic/Improve.20defaults.20in.20x.2Epy.20compiler-team.23326.html#203896295">(Jul 14 2020 at 22:30)</a>:</h4>
<p>It can probably be removed/replaced today</p>



<a name="203896406"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/233931-t-compiler/major%20changes/topic/Improve%20defaults%20in%20x.py%20compiler-team%23326/near/203896406" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Nelson <a href="https://zulip-archive.rust-lang.org/stream/233931-t-compiler/major-changes/topic/Improve.20defaults.20in.20x.2Epy.20compiler-team.23326.html#203896406">(Jul 14 2020 at 22:32)</a>:</h4>
<p>/me is more confused than when he started</p>



<a name="203896504"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/233931-t-compiler/major%20changes/topic/Improve%20defaults%20in%20x.py%20compiler-team%23326/near/203896504" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> eddyb <a href="https://zulip-archive.rust-lang.org/stream/233931-t-compiler/major-changes/topic/Improve.20defaults.20in.20x.2Epy.20compiler-team.23326.html#203896504">(Jul 14 2020 at 22:33)</a>:</h4>
<p>this is what you get from touching staging,</p>



<a name="203896511"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/233931-t-compiler/major%20changes/topic/Improve%20defaults%20in%20x.py%20compiler-team%23326/near/203896511" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Nelson <a href="https://zulip-archive.rust-lang.org/stream/233931-t-compiler/major-changes/topic/Improve.20defaults.20in.20x.2Epy.20compiler-team.23326.html#203896511">(Jul 14 2020 at 22:33)</a>:</h4>
<p>I'm going to leave the MCP the same pending me figuring out what's going on</p>



<a name="203896526"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/233931-t-compiler/major%20changes/topic/Improve%20defaults%20in%20x.py%20compiler-team%23326/near/203896526" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Nelson <a href="https://zulip-archive.rust-lang.org/stream/233931-t-compiler/major-changes/topic/Improve.20defaults.20in.20x.2Epy.20compiler-team.23326.html#203896526">(Jul 14 2020 at 22:33)</a>:</h4>
<p>I don't think the numbering of the tools affects it much anyway</p>



<a name="203896531"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/233931-t-compiler/major%20changes/topic/Improve%20defaults%20in%20x.py%20compiler-team%23326/near/203896531" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> eddyb <a href="https://zulip-archive.rust-lang.org/stream/233931-t-compiler/major-changes/topic/Improve.20defaults.20in.20x.2Epy.20compiler-team.23326.html#203896531">(Jul 14 2020 at 22:34)</a>:</h4>
<p>I kept wanting to make things clearer for years but dreaded what you're going through :P</p>



<a name="203896595"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/233931-t-compiler/major%20changes/topic/Improve%20defaults%20in%20x.py%20compiler-team%23326/near/203896595" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Nelson <a href="https://zulip-archive.rust-lang.org/stream/233931-t-compiler/major-changes/topic/Improve.20defaults.20in.20x.2Epy.20compiler-team.23326.html#203896595">(Jul 14 2020 at 22:34)</a>:</h4>
<p>I'm not even trying to make them clearer, just less painful lol</p>



<a name="203896601"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/233931-t-compiler/major%20changes/topic/Improve%20defaults%20in%20x.py%20compiler-team%23326/near/203896601" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> eddyb <a href="https://zulip-archive.rust-lang.org/stream/233931-t-compiler/major-changes/topic/Improve.20defaults.20in.20x.2Epy.20compiler-team.23326.html#203896601">(Jul 14 2020 at 22:34)</a>:</h4>
<p>or what I'm going through trying to explain why some things make sense to me, and failing most of the time</p>



<a name="203896636"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/233931-t-compiler/major%20changes/topic/Improve%20defaults%20in%20x.py%20compiler-team%23326/near/203896636" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Nelson <a href="https://zulip-archive.rust-lang.org/stream/233931-t-compiler/major-changes/topic/Improve.20defaults.20in.20x.2Epy.20compiler-team.23326.html#203896636">(Jul 14 2020 at 22:35)</a>:</h4>
<p>the end goal is like <span class="user-mention" data-user-id="255061">@LeSeulArtichaut</span> said, to make it so that <code>x.py build</code> 'just works' and people don't have to think about it</p>



<a name="203896714"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/233931-t-compiler/major%20changes/topic/Improve%20defaults%20in%20x.py%20compiler-team%23326/near/203896714" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> eddyb <a href="https://zulip-archive.rust-lang.org/stream/233931-t-compiler/major-changes/topic/Improve.20defaults.20in.20x.2Epy.20compiler-team.23326.html#203896714">(Jul 14 2020 at 22:36)</a>:</h4>
<p>the simplest way IMO is to just say that x.py by default does minimal, instead of maximal, work. and only <code>./configure &amp;&amp; make</code> retains the maximal behavior</p>



<a name="203896733"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/233931-t-compiler/major%20changes/topic/Improve%20defaults%20in%20x.py%20compiler-team%23326/near/203896733" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Nelson <a href="https://zulip-archive.rust-lang.org/stream/233931-t-compiler/major-changes/topic/Improve.20defaults.20in.20x.2Epy.20compiler-team.23326.html#203896733">(Jul 14 2020 at 22:36)</a>:</h4>
<p>/me forgot to update configure and make in the PR</p>



<a name="203896751"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/233931-t-compiler/major%20changes/topic/Improve%20defaults%20in%20x.py%20compiler-team%23326/near/203896751" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> eddyb <a href="https://zulip-archive.rust-lang.org/stream/233931-t-compiler/major-changes/topic/Improve.20defaults.20in.20x.2Epy.20compiler-team.23326.html#203896751">(Jul 14 2020 at 22:37)</a>:</h4>
<p>so <code>x.py build</code> and <code>x.py build --stage 1</code> and <code>x.py build src/libstd</code> and <code>x.py build --stage 1 src/libstd</code> would all do the same thing</p>



<a name="203896766"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/233931-t-compiler/major%20changes/topic/Improve%20defaults%20in%20x.py%20compiler-team%23326/near/203896766" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> eddyb <a href="https://zulip-archive.rust-lang.org/stream/233931-t-compiler/major-changes/topic/Improve.20defaults.20in.20x.2Epy.20compiler-team.23326.html#203896766">(Jul 14 2020 at 22:37)</a>:</h4>
<p>i.e. if you don't pass a stage, it's 1, if you don't pass a filter, it's src/libstd</p>



<a name="203896782"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/233931-t-compiler/major%20changes/topic/Improve%20defaults%20in%20x.py%20compiler-team%23326/near/203896782" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> eddyb <a href="https://zulip-archive.rust-lang.org/stream/233931-t-compiler/major-changes/topic/Improve.20defaults.20in.20x.2Epy.20compiler-team.23326.html#203896782">(Jul 14 2020 at 22:37)</a>:</h4>
<p>anything more explicit doesn't change at all</p>



<a name="203896797"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/233931-t-compiler/major%20changes/topic/Improve%20defaults%20in%20x.py%20compiler-team%23326/near/203896797" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Nelson <a href="https://zulip-archive.rust-lang.org/stream/233931-t-compiler/major-changes/topic/Improve.20defaults.20in.20x.2Epy.20compiler-team.23326.html#203896797">(Jul 14 2020 at 22:37)</a>:</h4>
<p>That's not actually the current behavior, it will still build rustdoc by default</p>



<a name="203896846"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/233931-t-compiler/major%20changes/topic/Improve%20defaults%20in%20x.py%20compiler-team%23326/near/203896846" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Nelson <a href="https://zulip-archive.rust-lang.org/stream/233931-t-compiler/major-changes/topic/Improve.20defaults.20in.20x.2Epy.20compiler-team.23326.html#203896846">(Jul 14 2020 at 22:38)</a>:</h4>
<p>Because I forgot to mention it in the original MCP</p>



<a name="203896852"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/233931-t-compiler/major%20changes/topic/Improve%20defaults%20in%20x.py%20compiler-team%23326/near/203896852" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> eddyb <a href="https://zulip-archive.rust-lang.org/stream/233931-t-compiler/major-changes/topic/Improve.20defaults.20in.20x.2Epy.20compiler-team.23326.html#203896852">(Jul 14 2020 at 22:38)</a>:</h4>
<p>lol</p>



<a name="203896876"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/233931-t-compiler/major%20changes/topic/Improve%20defaults%20in%20x.py%20compiler-team%23326/near/203896876" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> eddyb <a href="https://zulip-archive.rust-lang.org/stream/233931-t-compiler/major-changes/topic/Improve.20defaults.20in.20x.2Epy.20compiler-team.23326.html#203896876">(Jul 14 2020 at 22:38)</a>:</h4>
<p>maybe that should be treated just like all the other tools and you have to put it into <code>config.toml</code> that you want <code>rustdoc</code></p>



<a name="203896889"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/233931-t-compiler/major%20changes/topic/Improve%20defaults%20in%20x.py%20compiler-team%23326/near/203896889" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> eddyb <a href="https://zulip-archive.rust-lang.org/stream/233931-t-compiler/major-changes/topic/Improve.20defaults.20in.20x.2Epy.20compiler-team.23326.html#203896889">(Jul 14 2020 at 22:38)</a>:</h4>
<p>or maybe it can be default <em>shrug</em></p>



<a name="203896903"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/233931-t-compiler/major%20changes/topic/Improve%20defaults%20in%20x.py%20compiler-team%23326/near/203896903" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Nelson <a href="https://zulip-archive.rust-lang.org/stream/233931-t-compiler/major-changes/topic/Improve.20defaults.20in.20x.2Epy.20compiler-team.23326.html#203896903">(Jul 14 2020 at 22:39)</a>:</h4>
<p>I would be happy with making rustdoc more like other tools</p>



<a name="203896911"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/233931-t-compiler/major%20changes/topic/Improve%20defaults%20in%20x.py%20compiler-team%23326/near/203896911" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Nelson <a href="https://zulip-archive.rust-lang.org/stream/233931-t-compiler/major-changes/topic/Improve.20defaults.20in.20x.2Epy.20compiler-team.23326.html#203896911">(Jul 14 2020 at 22:39)</a>:</h4>
<p>but I think that's a different MCP</p>



<a name="203896916"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/233931-t-compiler/major%20changes/topic/Improve%20defaults%20in%20x.py%20compiler-team%23326/near/203896916" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> eddyb <a href="https://zulip-archive.rust-lang.org/stream/233931-t-compiler/major-changes/topic/Improve.20defaults.20in.20x.2Epy.20compiler-team.23326.html#203896916">(Jul 14 2020 at 22:39)</a>:</h4>
<p>but ideally <code>x.py build --stage 1 src/libstd</code> would also build the same tools (at stage 0)</p>



<a name="203896925"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/233931-t-compiler/major%20changes/topic/Improve%20defaults%20in%20x.py%20compiler-team%23326/near/203896925" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> eddyb <a href="https://zulip-archive.rust-lang.org/stream/233931-t-compiler/major-changes/topic/Improve.20defaults.20in.20x.2Epy.20compiler-team.23326.html#203896925">(Jul 14 2020 at 22:39)</a>:</h4>
<p>at least that's the simple approach for this in my view</p>



<a name="203897006"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/233931-t-compiler/major%20changes/topic/Improve%20defaults%20in%20x.py%20compiler-team%23326/near/203897006" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Nelson <a href="https://zulip-archive.rust-lang.org/stream/233931-t-compiler/major-changes/topic/Improve.20defaults.20in.20x.2Epy.20compiler-team.23326.html#203897006">(Jul 14 2020 at 22:40)</a>:</h4>
<p>at this point I think the code speaks more clearly than I can <a href="https://github.com/rust-lang/rust/pull/73964/commits/41a339d1c8753a655a691f605d29c20fba856e46">https://github.com/rust-lang/rust/pull/73964/commits/41a339d1c8753a655a691f605d29c20fba856e46</a></p>



<a name="203897028"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/233931-t-compiler/major%20changes/topic/Improve%20defaults%20in%20x.py%20compiler-team%23326/near/203897028" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Nelson <a href="https://zulip-archive.rust-lang.org/stream/233931-t-compiler/major-changes/topic/Improve.20defaults.20in.20x.2Epy.20compiler-team.23326.html#203897028">(Jul 14 2020 at 22:40)</a>:</h4>
<p>(not sure about the <code>all_crates</code> change but I figure someone will notice if it breaks things)</p>



<a name="204243226"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/233931-t-compiler/major%20changes/topic/Improve%20defaults%20in%20x.py%20compiler-team%23326/near/204243226" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> tmandry <a href="https://zulip-archive.rust-lang.org/stream/233931-t-compiler/major-changes/topic/Improve.20defaults.20in.20x.2Epy.20compiler-team.23326.html#204243226">(Jul 17 2020 at 18:42)</a>:</h4>
<p>Since I didn't see it mentioned in the MCP: will the default stage for the <code>dist</code> and <code>install</code> commands also change?</p>



<a name="204243300"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/233931-t-compiler/major%20changes/topic/Improve%20defaults%20in%20x.py%20compiler-team%23326/near/204243300" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> tmandry <a href="https://zulip-archive.rust-lang.org/stream/233931-t-compiler/major-changes/topic/Improve.20defaults.20in.20x.2Epy.20compiler-team.23326.html#204243300">(Jul 17 2020 at 18:43)</a>:</h4>
<p>this would break people who are using x.py to build and distribute rust themselves (like we do on fuchsia)</p>



<a name="204243337"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/233931-t-compiler/major%20changes/topic/Improve%20defaults%20in%20x.py%20compiler-team%23326/near/204243337" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> tmandry <a href="https://zulip-archive.rust-lang.org/stream/233931-t-compiler/major-changes/topic/Improve.20defaults.20in.20x.2Epy.20compiler-team.23326.html#204243337">(Jul 17 2020 at 18:43)</a>:</h4>
<p>which I'm fine with, but <code>--stage 1</code> doesn't seem like the right default for those commands to me</p>



<a name="204243761"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/233931-t-compiler/major%20changes/topic/Improve%20defaults%20in%20x.py%20compiler-team%23326/near/204243761" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> tmandry <a href="https://zulip-archive.rust-lang.org/stream/233931-t-compiler/major-changes/topic/Improve.20defaults.20in.20x.2Epy.20compiler-team.23326.html#204243761">(Jul 17 2020 at 18:46)</a>:</h4>
<p>Also FYI: rustbot's link to this stream on the MCP issue was broken</p>



<a name="204247026"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/233931-t-compiler/major%20changes/topic/Improve%20defaults%20in%20x.py%20compiler-team%23326/near/204247026" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Noah Lev <a href="https://zulip-archive.rust-lang.org/stream/233931-t-compiler/major-changes/topic/Improve.20defaults.20in.20x.2Epy.20compiler-team.23326.html#204247026">(Jul 17 2020 at 19:13)</a>:</h4>
<p><span class="user-mention" data-user-id="116883">@tmandry</span> I filed an issue: <a href="https://github.com/rust-lang/triagebot/issues/701">rust-lang/triagebot#701</a></p>



<a name="204264500"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/233931-t-compiler/major%20changes/topic/Improve%20defaults%20in%20x.py%20compiler-team%23326/near/204264500" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Nelson <a href="https://zulip-archive.rust-lang.org/stream/233931-t-compiler/major-changes/topic/Improve.20defaults.20in.20x.2Epy.20compiler-team.23326.html#204264500">(Jul 17 2020 at 21:58)</a>:</h4>
<blockquote>
<p>Since I didn't see it mentioned in the MCP: will the default stage for the <code>dist</code> and <code>install</code> commands also change?</p>
</blockquote>
<p>Hmm that's a good point. I don't see any reason they should change, since it seems very rare to want to install the stage 1 compiler. I'll clarify that in the MCP.</p>



<a name="204265048"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/233931-t-compiler/major%20changes/topic/Improve%20defaults%20in%20x.py%20compiler-team%23326/near/204265048" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Nelson <a href="https://zulip-archive.rust-lang.org/stream/233931-t-compiler/major-changes/topic/Improve.20defaults.20in.20x.2Epy.20compiler-team.23326.html#204265048">(Jul 17 2020 at 22:05)</a>:</h4>
<p>ok here are the subcommands that look relevant:</p>
<ul>
<li>build</li>
<li>test</li>
<li>bench</li>
<li>doc</li>
<li>dist</li>
<li>install</li>
<li>run</li>
</ul>
<p>I have no idea what <code>run</code> does except for the suggestion of <code>expand-yaml-anchors</code> (cc <span class="user-mention" data-user-id="121055">@Pietro Albini</span> who wrote that command - <code>-h -v</code> doesn't show the available paths). Anyone have suggestions?<br>
The default for <code>dist</code> and <code>install</code> seems like it should stay at 2.<br>
The default for <code>build</code> and <code>test</code> should change to 1 (that's kind of the point of the MCP :P).<br>
I think <code>doc</code> should actually be 0, since normally when you document things you're just fixing a typo. For this release cycle only that will have very different results between beta and nightly (due to <a href="https://github.com/rust-lang/rust/pull/73101">https://github.com/rust-lang/rust/pull/73101</a>) but in general I think stage 0 is a good default.<br>
Presumably <code>bench</code> should use stage 2 since it's measuring performance? I've never used it before.</p>



<a name="204278971"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/233931-t-compiler/major%20changes/topic/Improve%20defaults%20in%20x.py%20compiler-team%23326/near/204278971" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> eddyb <a href="https://zulip-archive.rust-lang.org/stream/233931-t-compiler/major-changes/topic/Improve.20defaults.20in.20x.2Epy.20compiler-team.23326.html#204278971">(Jul 18 2020 at 02:18)</a>:</h4>
<p>that sounds about right</p>



<a name="204278991"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/233931-t-compiler/major%20changes/topic/Improve%20defaults%20in%20x.py%20compiler-team%23326/near/204278991" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> eddyb <a href="https://zulip-archive.rust-lang.org/stream/233931-t-compiler/major-changes/topic/Improve.20defaults.20in.20x.2Epy.20compiler-team.23326.html#204278991">(Jul 18 2020 at 02:18)</a>:</h4>
<p><span class="user-mention" data-user-id="116883">@tmandry</span> FWIW you should probably use <code>./configure</code> and <code>make</code> to get the "distro-facing" stable interface</p>



<a name="204279013"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/233931-t-compiler/major%20changes/topic/Improve%20defaults%20in%20x.py%20compiler-team%23326/near/204279013" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> eddyb <a href="https://zulip-archive.rust-lang.org/stream/233931-t-compiler/major-changes/topic/Improve.20defaults.20in.20x.2Epy.20compiler-team.23326.html#204279013">(Jul 18 2020 at 02:19)</a>:</h4>
<p>worst case, if you need some special <code>config.toml</code> settings (not exposed otherwise), you can still pass them to <code>./configure</code> with <code>--set</code> I believe</p>



<a name="204279698"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/233931-t-compiler/major%20changes/topic/Improve%20defaults%20in%20x.py%20compiler-team%23326/near/204279698" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> tmandry <a href="https://zulip-archive.rust-lang.org/stream/233931-t-compiler/major-changes/topic/Improve.20defaults.20in.20x.2Epy.20compiler-team.23326.html#204279698">(Jul 18 2020 at 02:36)</a>:</h4>
<p><span class="user-mention" data-user-id="119009">@eddyb</span> thanks, good to know.</p>



<a name="204281607"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/233931-t-compiler/major%20changes/topic/Improve%20defaults%20in%20x.py%20compiler-team%23326/near/204281607" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Nelson <a href="https://zulip-archive.rust-lang.org/stream/233931-t-compiler/major-changes/topic/Improve.20defaults.20in.20x.2Epy.20compiler-team.23326.html#204281607">(Jul 18 2020 at 03:34)</a>:</h4>
<p>updated the MCP with the stage changes</p>



<a name="204282056"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/233931-t-compiler/major%20changes/topic/Improve%20defaults%20in%20x.py%20compiler-team%23326/near/204282056" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Nelson <a href="https://zulip-archive.rust-lang.org/stream/233931-t-compiler/major-changes/topic/Improve.20defaults.20in.20x.2Epy.20compiler-team.23326.html#204282056">(Jul 18 2020 at 03:47)</a>:</h4>
<p>btw <span class="user-mention" data-user-id="116883">@tmandry</span> thanks for bringing it up, I would never have thought of x.py dist <span aria-label="sweat smile" class="emoji emoji-1f605" role="img" title="sweat smile">:sweat_smile:</span></p>



<a name="204285765"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/233931-t-compiler/major%20changes/topic/Improve%20defaults%20in%20x.py%20compiler-team%23326/near/204285765" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> comex <a href="https://zulip-archive.rust-lang.org/stream/233931-t-compiler/major-changes/topic/Improve.20defaults.20in.20x.2Epy.20compiler-team.23326.html#204285765">(Jul 18 2020 at 05:39)</a>:</h4>
<p>The confusing naming is something that's really confused me when I've dabbled with rustc, and this seems like a significant improvement!</p>



<a name="204296522"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/233931-t-compiler/major%20changes/topic/Improve%20defaults%20in%20x.py%20compiler-team%23326/near/204296522" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jake Goulding <a href="https://zulip-archive.rust-lang.org/stream/233931-t-compiler/major-changes/topic/Improve.20defaults.20in.20x.2Epy.20compiler-team.23326.html#204296522">(Jul 18 2020 at 11:18)</a>:</h4>
<blockquote>
<p>since it seems very rare to want to install the stage 1 compiler</p>
</blockquote>
<p><span class="user-mention" data-user-id="232545">@Joshua Nelson</span> that's actually <em>all</em> I've been doing recently... <a href="https://github.com/shepmaster/rust/blob/silicon/silicon/README.md">https://github.com/shepmaster/rust/blob/silicon/silicon/README.md</a></p>
<p>Is there a "translation guide" from the old style to the new style commands?</p>



<a name="204296573"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/233931-t-compiler/major%20changes/topic/Improve%20defaults%20in%20x.py%20compiler-team%23326/near/204296573" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> eddyb <a href="https://zulip-archive.rust-lang.org/stream/233931-t-compiler/major-changes/topic/Improve.20defaults.20in.20x.2Epy.20compiler-team.23326.html#204296573">(Jul 18 2020 at 11:19)</a>:</h4>
<p>ideally we can just keep them (the <code>dist</code>/<code>install</code> commands) behaving the same</p>



<a name="204296624"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/233931-t-compiler/major%20changes/topic/Improve%20defaults%20in%20x.py%20compiler-team%23326/near/204296624" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> eddyb <a href="https://zulip-archive.rust-lang.org/stream/233931-t-compiler/major-changes/topic/Improve.20defaults.20in.20x.2Epy.20compiler-team.23326.html#204296624">(Jul 18 2020 at 11:20)</a>:</h4>
<p>as for <code>x.py build</code> commands, depends how explicit they were - if you pass both <code>--stage</code> and e.g. <code>src/libstd</code> (or some other path), I'm against that changing behavior</p>



<a name="204296697"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/233931-t-compiler/major%20changes/topic/Improve%20defaults%20in%20x.py%20compiler-team%23326/near/204296697" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> eddyb <a href="https://zulip-archive.rust-lang.org/stream/233931-t-compiler/major-changes/topic/Improve.20defaults.20in.20x.2Epy.20compiler-team.23326.html#204296697">(Jul 18 2020 at 11:22)</a>:</h4>
<p><span class="user-mention" data-user-id="116155">@Jake Goulding</span> all the <code>x.py</code> commands I can see in that README look explicit enough to not need any changes</p>



<a name="204296710"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/233931-t-compiler/major%20changes/topic/Improve%20defaults%20in%20x.py%20compiler-team%23326/near/204296710" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> eddyb <a href="https://zulip-archive.rust-lang.org/stream/233931-t-compiler/major-changes/topic/Improve.20defaults.20in.20x.2Epy.20compiler-team.23326.html#204296710">(Jul 18 2020 at 11:23)</a>:</h4>
<p>like, I think you will be able to shorten:<br>
<code>../../x.py build -i --stage 1 src/libstd</code><br>
to:<br>
<code>../../x.py build -i</code><br>
but you won't have to</p>



<a name="204299174"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/233931-t-compiler/major%20changes/topic/Improve%20defaults%20in%20x.py%20compiler-team%23326/near/204299174" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Nelson <a href="https://zulip-archive.rust-lang.org/stream/233931-t-compiler/major-changes/topic/Improve.20defaults.20in.20x.2Epy.20compiler-team.23326.html#204299174">(Jul 18 2020 at 12:41)</a>:</h4>
<p>Currently the MCP says rustdoc will also be built by default. I don't feel strongly about that, though.</p>



<a name="204299179"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/233931-t-compiler/major%20changes/topic/Improve%20defaults%20in%20x.py%20compiler-team%23326/near/204299179" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Nelson <a href="https://zulip-archive.rust-lang.org/stream/233931-t-compiler/major-changes/topic/Improve.20defaults.20in.20x.2Epy.20compiler-team.23326.html#204299179">(Jul 18 2020 at 12:41)</a>:</h4>
<p>So you would still need <code>src/libstd</code> to avoid building rustdoc</p>



<a name="204299240"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/233931-t-compiler/major%20changes/topic/Improve%20defaults%20in%20x.py%20compiler-team%23326/near/204299240" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Nelson <a href="https://zulip-archive.rust-lang.org/stream/233931-t-compiler/major-changes/topic/Improve.20defaults.20in.20x.2Epy.20compiler-team.23326.html#204299240">(Jul 18 2020 at 12:43)</a>:</h4>
<blockquote>
<p>The confusing naming is something that's really confused me when I've dabbled with rustc, and this seems like a significant improvement!</p>
</blockquote>
<p>Thank you! This doesn't actually change the numbering, it just makes the defaults somewhat better. Changing the numbering is another whole can of worms <span aria-label="laughing" class="emoji emoji-1f606" role="img" title="laughing">:laughing:</span></p>



<a name="204379903"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/233931-t-compiler/major%20changes/topic/Improve%20defaults%20in%20x.py%20compiler-team%23326/near/204379903" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Nelson <a href="https://zulip-archive.rust-lang.org/stream/233931-t-compiler/major-changes/topic/Improve.20defaults.20in.20x.2Epy.20compiler-team.23326.html#204379903">(Jul 20 2020 at 01:50)</a>:</h4>
<p>It's been 12 days since <span class="user-mention silent" data-user-id="116009">nikomatsakis</span> seconded the MCP - the description says it should have been accepted after 10 days. Is there a bug in the automation maybe?</p>



<a name="204397482"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/233931-t-compiler/major%20changes/topic/Improve%20defaults%20in%20x.py%20compiler-team%23326/near/204397482" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Yuki Okushi <a href="https://zulip-archive.rust-lang.org/stream/233931-t-compiler/major-changes/topic/Improve.20defaults.20in.20x.2Epy.20compiler-team.23326.html#204397482">(Jul 20 2020 at 08:30)</a>:</h4>
<p><span class="user-mention silent" data-user-id="232545">Joshua Nelson</span> <a href="#narrow/stream/233931-t-compiler.2Fmajor-changes/topic/Improve.20defaults.20in.20x.2Epy.20compiler-team.23326/near/204379903">said</a>:</p>
<blockquote>
<p>It's been 12 days since <span class="user-mention silent" data-user-id="116009">nikomatsakis</span> seconded the MCP - the description says it should have been accepted after 10 days. Is there a bug in the automation maybe?</p>
</blockquote>
<p>it isn't a _bug_ but missing functionality. currently someone has to add <code>major-change-accepted</code> manually iirc</p>



<a name="204472254"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/233931-t-compiler/major%20changes/topic/Improve%20defaults%20in%20x.py%20compiler-team%23326/near/204472254" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Santiago Pastorino <a href="https://zulip-archive.rust-lang.org/stream/233931-t-compiler/major-changes/topic/Improve.20defaults.20in.20x.2Epy.20compiler-team.23326.html#204472254">(Jul 20 2020 at 20:30)</a>:</h4>
<p>I usually manually accept MCPs just before our thursday's meetings</p>



<a name="204472390"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/233931-t-compiler/major%20changes/topic/Improve%20defaults%20in%20x.py%20compiler-team%23326/near/204472390" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Nelson <a href="https://zulip-archive.rust-lang.org/stream/233931-t-compiler/major-changes/topic/Improve.20defaults.20in.20x.2Epy.20compiler-team.23326.html#204472390">(Jul 20 2020 at 20:31)</a>:</h4>
<p>got it, thanks :) I'll try to contain my impatience <span aria-label="laughing" class="emoji emoji-1f606" role="img" title="laughing">:laughing:</span></p>



<a name="204682877"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/233931-t-compiler/major%20changes/topic/Improve%20defaults%20in%20x.py%20compiler-team%23326/near/204682877" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> triagebot <a href="https://zulip-archive.rust-lang.org/stream/233931-t-compiler/major-changes/topic/Improve.20defaults.20in.20x.2Epy.20compiler-team.23326.html#204682877">(Jul 22 2020 at 15:39)</a>:</h4>
<p>This proposal has been accepted: <a href="https://github.com/rust-lang/compiler-team/issues/326">#326</a>.</p>



<a name="204998652"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/233931-t-compiler/major%20changes/topic/Improve%20defaults%20in%20x.py%20compiler-team%23326/near/204998652" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Nelson <a href="https://zulip-archive.rust-lang.org/stream/233931-t-compiler/major-changes/topic/Improve.20defaults.20in.20x.2Epy.20compiler-team.23326.html#204998652">(Jul 25 2020 at 10:35)</a>:</h4>
<p><span class="user-mention" data-user-id="116122">@simulacrum</span> this is just waiting for your review of the implementation I think :) <a href="https://github.com/rust-lang/rust/pull/73964">https://github.com/rust-lang/rust/pull/73964</a></p>



<a name="206924772"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/233931-t-compiler/major%20changes/topic/Improve%20defaults%20in%20x.py%20compiler-team%23326/near/206924772" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Nelson <a href="https://zulip-archive.rust-lang.org/stream/233931-t-compiler/major-changes/topic/Improve.20defaults.20in.20x.2Epy.20compiler-team.23326.html#206924772">(Aug 14 2020 at 12:39)</a>:</h4>
<p><span class="user-mention silent" data-user-id="119009">eddyb</span> <a href="#narrow/stream/233931-t-compiler.2Fmajor-changes/topic/Improve.20defaults.20in.20x.2Epy.20compiler-team.23326/near/203896751">said</a>:</p>
<blockquote>
<p>so <code>x.py build</code> and <code>x.py build --stage 1</code> and <code>x.py build src/libstd</code> and <code>x.py build --stage 1 src/libstd</code> would all do the same thing</p>
</blockquote>
<p><span class="user-mention silent" data-user-id="119009">eddyb</span> <a href="#narrow/stream/233931-t-compiler.2Fmajor-changes/topic/Improve.20defaults.20in.20x.2Epy.20compiler-team.23326/near/204296710">said</a>:</p>
<blockquote>
<p>like, I think you will be able to shorten:<br>
<code>../../x.py build -i --stage 1 src/libstd</code><br>
to:<br>
<code>../../x.py build -i</code><br>
but you won't have to</p>
</blockquote>
<p>so ... I think this is a great idea (and <span class="user-mention" data-user-id="120791">@RalfJ</span> agreed on <a href="https://github.com/rust-lang/blog.rust-lang.org/pull/666#discussion_r470428415">https://github.com/rust-lang/blog.rust-lang.org/pull/666#discussion_r470428415</a>) but it didn't make it into the MCP. Is it ok if I make a follow-up MR with the implementation? Or should I open a new MCP for changing that default?</p>



<a name="206924821"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/233931-t-compiler/major%20changes/topic/Improve%20defaults%20in%20x.py%20compiler-team%23326/near/206924821" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Nelson <a href="https://zulip-archive.rust-lang.org/stream/233931-t-compiler/major-changes/topic/Improve.20defaults.20in.20x.2Epy.20compiler-team.23326.html#206924821">(Aug 14 2020 at 12:40)</a>:</h4>
<p>to be clear, the current default is that <code>x.py build</code> and <code>x.py build --stage 1 library/std src/tools/*</code> are the same</p>



<a name="208965510"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/233931-t-compiler/major%20changes/topic/Improve%20defaults%20in%20x.py%20compiler-team%23326/near/208965510" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Nelson <a href="https://zulip-archive.rust-lang.org/stream/233931-t-compiler/major-changes/topic/Improve.20defaults.20in.20x.2Epy.20compiler-team.23326.html#208965510">(Sep 03 2020 at 13:22)</a>:</h4>
<p>heh, this makes me really glad I made the change: <a href="https://github.com/rust-lang/compiler-team/issues/326#issuecomment-686464359">https://github.com/rust-lang/compiler-team/issues/326#issuecomment-686464359</a></p>



<hr><p>Last updated: Apr 12 2022 at 20:01 UTC</p>
</html>