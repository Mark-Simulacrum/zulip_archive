<html>
<head><meta charset="utf-8"><title>Move Rust provided objects, libraries and  compiler-team#310 · t-compiler/major changes · Zulip Chat Archive</title></head>
<h2>Stream: <a href="https://zulip-archive.rust-lang.org/stream/233931-t-compiler/major-changes/index.html">t-compiler/major changes</a></h2>
<h3>Topic: <a href="https://zulip-archive.rust-lang.org/stream/233931-t-compiler/major-changes/topic/Move.20Rust.20provided.20objects.2C.20libraries.20and.20.20compiler-team.23310.html">Move Rust provided objects, libraries and  compiler-team#310</a></h3>

<hr>

<base href="https://rust-lang.zulipchat.com">

<head><link href="https://zulip-archive.rust-lang.org/style.css" rel="stylesheet"></head>

<a name="202677492"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/233931-t-compiler/major%20changes/topic/Move%20Rust%20provided%20objects%2C%20libraries%20and%20%20compiler-team%23310/near/202677492" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> triagebot <a href="https://zulip-archive.rust-lang.org/stream/233931-t-compiler/major-changes/topic/Move.20Rust.20provided.20objects.2C.20libraries.20and.20.20compiler-team.23310.html#202677492">(Jul 02 2020 at 11:53)</a>:</h4>
<p>A new proposal has been announced: <a href="https://github.com/rust-lang/compiler-team/issues/310">#310</a>. It will be<br>
                announced at the next meeting to try and draw attention to it,<br>
                but usually MCPs are not discussed during triage meetings. If<br>
                you think this would benefit from discussion amongst the<br>
                team, consider proposing a design meeting.</p>



<a name="204088262"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/233931-t-compiler/major%20changes/topic/Move%20Rust%20provided%20objects%2C%20libraries%20and%20%20compiler-team%23310/near/204088262" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/233931-t-compiler/major-changes/topic/Move.20Rust.20provided.20objects.2C.20libraries.20and.20.20compiler-team.23310.html#204088262">(Jul 16 2020 at 14:09)</a>:</h4>
<p>I'd be willing to second this proposal but I don't really know much about it. I'm curious to hear from <span class="user-mention" data-user-id="116015">@Alex Crichton</span> as I saw that the WASI target was mentioned; I might expect <span class="user-mention" data-user-id="123856">@Vadim Petrochenkov</span> to have an opinion as well.</p>



<a name="204088563"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/233931-t-compiler/major%20changes/topic/Move%20Rust%20provided%20objects%2C%20libraries%20and%20%20compiler-team%23310/near/204088563" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Alex Crichton <a href="https://zulip-archive.rust-lang.org/stream/233931-t-compiler/major-changes/topic/Move.20Rust.20provided.20objects.2C.20libraries.20and.20.20compiler-team.23310.html#204088563">(Jul 16 2020 at 14:12)</a>:</h4>
<p>It sounds like a reasonable proposal to me, it would indeed be nice if using our precompiled artifacts worked very easily with both external toolchains as well as with bundled support in rustc itself. The main thing I think needs to keep working is rustc by default works on platforms missing the libraries (e.g. missing mingw compiler/objects), but I suspect everyone feels the same way about that :)</p>



<a name="204089842"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/233931-t-compiler/major%20changes/topic/Move%20Rust%20provided%20objects%2C%20libraries%20and%20%20compiler-team%23310/near/204089842" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> triagebot <a href="https://zulip-archive.rust-lang.org/stream/233931-t-compiler/major-changes/topic/Move.20Rust.20provided.20objects.2C.20libraries.20and.20.20compiler-team.23310.html#204089842">(Jul 16 2020 at 14:21)</a>:</h4>
<p><span class="user-group-mention" data-user-group-id="492">@T-compiler</span>: Proposal <a href="https://github.com/rust-lang/compiler-team/issues/310#issuecomment-659445025">#310</a> has been seconded, and will be approved in 10 days if no objections are raised.</p>



<a name="204089878"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/233931-t-compiler/major%20changes/topic/Move%20Rust%20provided%20objects%2C%20libraries%20and%20%20compiler-team%23310/near/204089878" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/233931-t-compiler/major-changes/topic/Move.20Rust.20provided.20objects.2C.20libraries.20and.20.20compiler-team.23310.html#204089878">(Jul 16 2020 at 14:21)</a>:</h4>
<p>OK. Well let's kick off FCP and see if anyone has any concerns in the meantime..</p>



<a name="204098938"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/233931-t-compiler/major%20changes/topic/Move%20Rust%20provided%20objects%2C%20libraries%20and%20%20compiler-team%23310/near/204098938" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> mati865 <a href="https://zulip-archive.rust-lang.org/stream/233931-t-compiler/major-changes/topic/Move.20Rust.20provided.20objects.2C.20libraries.20and.20.20compiler-team.23310.html#204098938">(Jul 16 2020 at 15:23)</a>:</h4>
<p><span class="user-mention silent" data-user-id="116015">Alex Crichton</span> <a href="#narrow/stream/233931-t-compiler.2Fmajor-changes/topic/Move.20Rust.20provided.20objects.2C.20libraries.20and.20.20compiler-team.23310/near/204088563">said</a>:</p>
<blockquote>
<p>The main thing I think needs to keep working is rustc by default works on platforms missing the libraries (e.g. missing mingw compiler/objects), but I suspect everyone feels the same way about that :)</p>
</blockquote>
<p>I'm happy to answer any questions.<br>
Whether binaries/libs/objects from <code>self-contained</code> directory are taken into account is controlled by <a href="https://github.com/rust-lang/rust/blob/125c58caebc67c32ec45ac6c0581b596fd532082/src/librustc_codegen_ssa/back/link.rs#L1286">crt_objects_fallback</a>. So nothing really changes for end users yet, rustlib looks a bit cleaner with less irrelevant things laying next to Rust stuff.</p>
<p>This might require another MCP but the goal is to have heuristic for every affected target that can be overridden by currently unstable <code>link-self-contained=yes/no</code> option.<br>
I'm going to prepare heuristic for MinGW, <span class="user-mention" data-user-id="123856">@Vadim Petrochenkov</span> was experimenting with musl. Would be great if somebody experienced with WASM could weight in.</p>



<a name="206232861"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/233931-t-compiler/major%20changes/topic/Move%20Rust%20provided%20objects%2C%20libraries%20and%20%20compiler-team%23310/near/206232861" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> RalfJ <a href="https://zulip-archive.rust-lang.org/stream/233931-t-compiler/major-changes/topic/Move.20Rust.20provided.20objects.2C.20libraries.20and.20.20compiler-team.23310.html#206232861">(Aug 07 2020 at 08:09)</a>:</h4>
<p>Please ping me when this gets implemented, it is likely that xargo will need adjustment to keep working for those targets.</p>



<hr><p>Last updated: Apr 12 2022 at 20:01 UTC</p>
</html>