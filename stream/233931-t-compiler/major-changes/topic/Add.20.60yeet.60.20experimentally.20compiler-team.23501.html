<html>
<head><meta charset="utf-8"><title>Add `yeet` experimentally compiler-team#501 · t-compiler/major changes · Zulip Chat Archive</title></head>
<h2>Stream: <a href="https://zulip-archive.rust-lang.org/stream/233931-t-compiler/major-changes/index.html">t-compiler/major changes</a></h2>
<h3>Topic: <a href="https://zulip-archive.rust-lang.org/stream/233931-t-compiler/major-changes/topic/Add.20.60yeet.60.20experimentally.20compiler-team.23501.html">Add `yeet` experimentally compiler-team#501</a></h3>

<hr>

<base href="https://rust-lang.zulipchat.com">

<head><link href="https://zulip-archive.rust-lang.org/style.css" rel="stylesheet"></head>

<a name="276746612"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/233931-t-compiler/major%20changes/topic/Add%20%60yeet%60%20experimentally%20compiler-team%23501/near/276746612" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> triagebot <a href="https://zulip-archive.rust-lang.org/stream/233931-t-compiler/major-changes/topic/Add.20.60yeet.60.20experimentally.20compiler-team.23501.html#276746612">(Mar 26 2022 at 21:25)</a>:</h4>
<p>A new proposal has been announced: <a href="https://github.com/rust-lang/compiler-team/issues/501">Add <code>yeet</code> experimentally #501</a>. It will be announced at the next meeting to try and draw attention to it, but usually MCPs are not discussed during triage meetings. If you think this would benefit from discussion amongst the team, consider proposing a design meeting.</p>



<a name="276746854"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/233931-t-compiler/major%20changes/topic/Add%20%60yeet%60%20experimentally%20compiler-team%23501/near/276746854" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> oli <a href="https://zulip-archive.rust-lang.org/stream/233931-t-compiler/major-changes/topic/Add.20.60yeet.60.20experimentally.20compiler-team.23501.html#276746854">(Mar 26 2022 at 21:30)</a>:</h4>
<p>Ooooh yes. I want to second but I feel like I'd just be doing it for mir interpret and the funny keyword</p>



<a name="276746889"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/233931-t-compiler/major%20changes/topic/Add%20%60yeet%60%20experimentally%20compiler-team%23501/near/276746889" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> oli <a href="https://zulip-archive.rust-lang.org/stream/233931-t-compiler/major-changes/topic/Add.20.60yeet.60.20experimentally.20compiler-team.23501.html#276746889">(Mar 26 2022 at 21:31)</a>:</h4>
<p>I would've thought this to be a lang team MCP as the compiler change seems trivial and well motivated if the language change is ok</p>



<a name="276750946"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/233931-t-compiler/major%20changes/topic/Add%20%60yeet%60%20experimentally%20compiler-team%23501/near/276750946" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> scottmcm <a href="https://zulip-archive.rust-lang.org/stream/233931-t-compiler/major-changes/topic/Add.20.60yeet.60.20experimentally.20compiler-team.23501.html#276750946">(Mar 26 2022 at 23:04)</a>:</h4>
<p>I'll ask in the lang meeting what people would expect there.  There's sortof a <em>de facto</em> initiative around the area (<a href="https://github.com/rust-lang/lang-team/blob/327d9db5f66e0a61328a13bf0d4e48216949a52f/design-meeting-minutes/2022-03-09-lang-roadmap.md#q-which-active-initiatives-are-missing">https://github.com/rust-lang/lang-team/blob/327d9db5f66e0a61328a13bf0d4e48216949a52f/design-meeting-minutes/2022-03-09-lang-roadmap.md#q-which-active-initiatives-are-missing</a>), but maybe it should be <em>de jure</em> before opening a PR.</p>



<a name="276759601"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/233931-t-compiler/major%20changes/topic/Add%20%60yeet%60%20experimentally%20compiler-team%23501/near/276759601" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Esteban Küber <a href="https://zulip-archive.rust-lang.org/stream/233931-t-compiler/major-changes/topic/Add.20.60yeet.60.20experimentally.20compiler-team.23501.html#276759601">(Mar 27 2022 at 02:47)</a>:</h4>
<p>Using a compound keyword so that whatever syntax you use can't be ambiguous with identifiers <span aria-label="clap" class="emoji emoji-1f44f" role="img" title="clap">:clap:</span></p>



<a name="276768859"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/233931-t-compiler/major%20changes/topic/Add%20%60yeet%60%20experimentally%20compiler-team%23501/near/276768859" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> scottmcm <a href="https://zulip-archive.rust-lang.org/stream/233931-t-compiler/major-changes/topic/Add.20.60yeet.60.20experimentally.20compiler-team.23501.html#276768859">(Mar 27 2022 at 06:09)</a>:</h4>
<p>I'm glad you like it, <span class="user-mention" data-user-id="119031">@Esteban Küber</span>, but I think it's simpler than that.  I'm just hiding it behind <code>do</code>, which is already a keyword.  (<code>try {</code> used to be spelled <code>do catch {</code> on nightly for the same reason.) </p>
<p>Ideally I'd use <code>k#yeet</code> or similar, thanks to <a href="https://github.com/rust-lang/rfcs/issues/3101">rfcs#3101</a>, but I don't know how to reliably feature-gate something that I think would have tokenizer impact, so I think this is better when it's just at "might be removed at any point" experimentation level.</p>



<a name="277160277"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/233931-t-compiler/major%20changes/topic/Add%20%60yeet%60%20experimentally%20compiler-team%23501/near/277160277" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mara <a href="https://zulip-archive.rust-lang.org/stream/233931-t-compiler/major-changes/topic/Add.20.60yeet.60.20experimentally.20compiler-team.23501.html#277160277">(Mar 30 2022 at 15:13)</a>:</h4>
<p><span class="user-mention" data-user-id="125270">@scottmcm</span> <a href="#narrow/stream/233931-t-compiler.2Fmajor-changes/topic/Add.20.60yeet.60.20experimentally.20compiler-team.23501/near/276768859">said</a>:</p>
<blockquote>
<p>Ideally I'd use <code>k#yeet</code> or similar, thanks to <a href="https://github.com/rust-lang/rfcs/issues/3101">rfcs#3101</a>, but I don't know how to reliably feature-gate something that I think would have tokenizer impact, so I think this is better when it's just at "might be removed at any point" experimentation level.</p>
</blockquote>
<p>using <code>k#</code> for this seems better to me. we reserved prefixes like that specifically for things like this. it does mean adding it to the tokenizer, but if that's tricky, then we should probably fix that instead of (ab)using the <code>do</code> keyword.</p>



<a name="277170420"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/233931-t-compiler/major%20changes/topic/Add%20%60yeet%60%20experimentally%20compiler-team%23501/near/277170420" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> scottmcm <a href="https://zulip-archive.rust-lang.org/stream/233931-t-compiler/major-changes/topic/Add.20.60yeet.60.20experimentally.20compiler-team.23501.html#277170420">(Mar 30 2022 at 16:27)</a>:</h4>
<p><strong>Compiler folks</strong>: Is there anyone who would be willing to give me mentoring instructions on how to make a feature-gated change to do <code>k#yeet</code> on nightly?  Or, more simply, give a good idea on how pervasive or complicated (or easy) such a change would be?</p>



<a name="277172540"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/233931-t-compiler/major%20changes/topic/Add%20%60yeet%60%20experimentally%20compiler-team%23501/near/277172540" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Nelson <a href="https://zulip-archive.rust-lang.org/stream/233931-t-compiler/major-changes/topic/Add.20.60yeet.60.20experimentally.20compiler-team.23501.html#277172540">(Mar 30 2022 at 16:41)</a>:</h4>
<p>I would look for where the existing feature gating for <code>k#keyword</code> is, change it to add a new feature gate, and check that gate in the same place. I expect it will be either in rustc_lexer or rustc_parser.</p>



<a name="277172759"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/233931-t-compiler/major%20changes/topic/Add%20%60yeet%60%20experimentally%20compiler-team%23501/near/277172759" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Nelson <a href="https://zulip-archive.rust-lang.org/stream/233931-t-compiler/major-changes/topic/Add.20.60yeet.60.20experimentally.20compiler-team.23501.html#277172759">(Mar 30 2022 at 16:42)</a>:</h4>
<p>Probably the easiest way to find it is to trigger the feature error on playground and the search for the error name</p>



<a name="277173203"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/233931-t-compiler/major%20changes/topic/Add%20%60yeet%60%20experimentally%20compiler-team%23501/near/277173203" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> cuviper <a href="https://zulip-archive.rust-lang.org/stream/233931-t-compiler/major-changes/topic/Add.20.60yeet.60.20experimentally.20compiler-team.23501.html#277173203">(Mar 30 2022 at 16:45)</a>:</h4>
<p>AKA break it until you make it</p>



<a name="277176665"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/233931-t-compiler/major%20changes/topic/Add%20%60yeet%60%20experimentally%20compiler-team%23501/near/277176665" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> scottmcm <a href="https://zulip-archive.rust-lang.org/stream/233931-t-compiler/major-changes/topic/Add.20.60yeet.60.20experimentally.20compiler-team.23501.html#277176665">(Mar 30 2022 at 17:06)</a>:</h4>
<p><span class="user-mention silent" data-user-id="232545">Joshua Nelson</span> <a href="#narrow/stream/233931-t-compiler.2Fmajor-changes/topic/Add.20.60yeet.60.20experimentally.20compiler-team.23501/near/277172540">said</a>:</p>
<blockquote>
<p>I would look for where the existing feature gating for <code>k#keyword</code> is</p>
</blockquote>
<p>There isn't any feature gating for it, though, AFAIK.  It's just a hard tokenization error.</p>
<p>I could probably figure how to make it <em>work</em>; I'm most unsure about how to keep it from being stable -- especially inside <code>#[cfg]</code> and such.</p>



<a name="277177911"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/233931-t-compiler/major%20changes/topic/Add%20%60yeet%60%20experimentally%20compiler-team%23501/near/277177911" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Nelson <a href="https://zulip-archive.rust-lang.org/stream/233931-t-compiler/major-changes/topic/Add.20.60yeet.60.20experimentally.20compiler-team.23501.html#277177911">(Mar 30 2022 at 17:15)</a>:</h4>
<p>Why would it be a hard error inside a <code>cfg</code>? I would expect it to error only if it's compiled</p>



<a name="277178018"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/233931-t-compiler/major%20changes/topic/Add%20%60yeet%60%20experimentally%20compiler-team%23501/near/277178018" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Nelson <a href="https://zulip-archive.rust-lang.org/stream/233931-t-compiler/major-changes/topic/Add.20.60yeet.60.20experimentally.20compiler-team.23501.html#277178018">(Mar 30 2022 at 17:16)</a>:</h4>
<p>That prevents things like <code>#[cfg(nightly)] k#yeet "foo";</code></p>



<a name="277180765"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/233931-t-compiler/major%20changes/topic/Add%20%60yeet%60%20experimentally%20compiler-team%23501/near/277180765" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Nelson <a href="https://zulip-archive.rust-lang.org/stream/233931-t-compiler/major-changes/topic/Add.20.60yeet.60.20experimentally.20compiler-team.23501.html#277180765">(Mar 30 2022 at 17:37)</a>:</h4>
<p>Anyway, <span class="user-mention" data-user-id="125270">@scottmcm</span> <a href="https://doc.rust-lang.org/beta/nightly-rustc/rustc_feature/index.html">https://doc.rust-lang.org/beta/nightly-rustc/rustc_feature/index.html</a> mentions rustc_ast_passes/src/feature_gate.rs, look around there</p>



<a name="277180965"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/233931-t-compiler/major%20changes/topic/Add%20%60yeet%60%20experimentally%20compiler-team%23501/near/277180965" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> bjorn3 <a href="https://zulip-archive.rust-lang.org/stream/233931-t-compiler/major-changes/topic/Add.20.60yeet.60.20experimentally.20compiler-team.23501.html#277180965">(Mar 30 2022 at 17:39)</a>:</h4>
<p>Cfg'ed code still needs to be parsed to know where it ends. <code>#[cfg(nightly)]</code> only really works nicely on <code>mod</code> items with external source.</p>



<a name="277181178"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/233931-t-compiler/major%20changes/topic/Add%20%60yeet%60%20experimentally%20compiler-team%23501/near/277181178" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> scottmcm <a href="https://zulip-archive.rust-lang.org/stream/233931-t-compiler/major-changes/topic/Add.20.60yeet.60.20experimentally.20compiler-team.23501.html#277181178">(Mar 30 2022 at 17:41)</a>:</h4>
<p><span class="user-mention silent" data-user-id="232545">Joshua Nelson</span> <a href="#narrow/stream/233931-t-compiler.2Fmajor-changes/topic/Add.20.60yeet.60.20experimentally.20compiler-team.23501/near/277180765">said</a>:</p>
<blockquote>
<p>Anyway, <span class="user-mention silent" data-user-id="125270">scottmcm</span> <a href="https://doc.rust-lang.org/beta/nightly-rustc/rustc_feature/index.html">https://doc.rust-lang.org/beta/nightly-rustc/rustc_feature/index.html</a> mentions rustc_ast_passes/src/feature_gate.rs, look around there</p>
</blockquote>
<p>Yeah, my MVP does that already &lt;<a href="https://github.com/scottmcm/rust/commit/do-yeet#diff-0e671850197410b3d51dfa88222d5b28bb9dded13f6dc7c3b85903412250d02dR616">https://github.com/scottmcm/rust/commit/do-yeet#diff-0e671850197410b3d51dfa88222d5b28bb9dded13f6dc7c3b85903412250d02dR616</a>&gt;, but it's for the AST.</p>
<p>That doesn't do things like "you can't use it in a <code>macro_rules!</code> macro", AFAIK.</p>



<a name="277540824"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/233931-t-compiler/major%20changes/topic/Add%20%60yeet%60%20experimentally%20compiler-team%23501/near/277540824" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nagisa <a href="https://zulip-archive.rust-lang.org/stream/233931-t-compiler/major-changes/topic/Add.20.60yeet.60.20experimentally.20compiler-team.23501.html#277540824">(Apr 02 2022 at 17:15)</a>:</h4>
<p>Am I wrong in remembering that prefix for arbitrary keywords is <code>r#</code> not <code>k#</code>?</p>



<a name="277540836"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/233931-t-compiler/major%20changes/topic/Add%20%60yeet%60%20experimentally%20compiler-team%23501/near/277540836" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nagisa <a href="https://zulip-archive.rust-lang.org/stream/233931-t-compiler/major-changes/topic/Add.20.60yeet.60.20experimentally.20compiler-team.23501.html#277540836">(Apr 02 2022 at 17:15)</a>:</h4>
<p>oh, it might be the other way around, to make a keyword into an identifier (e.g. <code>r#type</code>…)</p>



<a name="277541718"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/233931-t-compiler/major%20changes/topic/Add%20%60yeet%60%20experimentally%20compiler-team%23501/near/277541718" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Connor Horman <a href="https://zulip-archive.rust-lang.org/stream/233931-t-compiler/major-changes/topic/Add.20.60yeet.60.20experimentally.20compiler-team.23501.html#277541718">(Apr 02 2022 at 17:37)</a>:</h4>
<p>Yeah, <code>r#</code> is raw identifier prefix.</p>



<hr><p>Last updated: Apr 12 2022 at 20:01 UTC</p>
</html>