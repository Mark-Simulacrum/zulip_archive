<html>
<head><meta charset="utf-8"><title>clippy.toml · general · Zulip Chat Archive</title></head>
<h2>Stream: <a href="https://zulip-archive.rust-lang.org/stream/122651-general/index.html">general</a></h2>
<h3>Topic: <a href="https://zulip-archive.rust-lang.org/stream/122651-general/topic/clippy.2Etoml.html">clippy.toml</a></h3>

<hr>

<base href="https://rust-lang.zulipchat.com">

<head><link href="https://zulip-archive.rust-lang.org/style.css" rel="stylesheet"></head>

<a name="261738026"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122651-general/topic/clippy.toml/near/261738026" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nnethercote <a href="https://zulip-archive.rust-lang.org/stream/122651-general/topic/clippy.2Etoml.html#261738026">(Nov 17 2021 at 02:56)</a>:</h4>
<p>I am trying to test the <code>disallowed-types</code> lint provided by clippy. I have this <code>clippy.toml</code> file in the root of my project:</p>
<div class="codehilite"><pre><span></span><code>disallowed-types = [&quot;std::collections::HashMap&quot;]
</code></pre></div>



<a name="261738043"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122651-general/topic/clippy.toml/near/261738043" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nnethercote <a href="https://zulip-archive.rust-lang.org/stream/122651-general/topic/clippy.2Etoml.html#261738043">(Nov 17 2021 at 02:56)</a>:</h4>
<p>But it's not working. I think the <code>clippy.toml</code> file isn't even being read -- if I add deliberate syntax errors to it, <code>cargo clippy</code> runs without complaint.</p>



<a name="261738048"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122651-general/topic/clippy.toml/near/261738048" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nnethercote <a href="https://zulip-archive.rust-lang.org/stream/122651-general/topic/clippy.2Etoml.html#261738048">(Nov 17 2021 at 02:56)</a>:</h4>
<p>I feel like I'm missing something obvious.</p>



<a name="261738075"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122651-general/topic/clippy.toml/near/261738075" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nnethercote <a href="https://zulip-archive.rust-lang.org/stream/122651-general/topic/clippy.2Etoml.html#261738075">(Nov 17 2021 at 02:57)</a>:</h4>
<p>My <code>src/main.rs</code> just looks like this:</p>
<div class="codehilite"><pre><span></span><code>use std::collections::HashMap;
fn main() {
    let mut x: HashMap&lt;u32, u32&gt; = HashMap::new();
    x.insert(0, 1);
    println!(&quot;Hello, world!&quot;);
}
</code></pre></div>



<a name="261738604"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122651-general/topic/clippy.toml/near/261738604" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Thomas Tapia <a href="https://zulip-archive.rust-lang.org/stream/122651-general/topic/clippy.2Etoml.html#261738604">(Nov 17 2021 at 03:05)</a>:</h4>
<p>hi, i need info about thread library</p>



<a name="261741197"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122651-general/topic/clippy.toml/near/261741197" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Eric Huss <a href="https://zulip-archive.rust-lang.org/stream/122651-general/topic/clippy.2Etoml.html#261741197">(Nov 17 2021 at 04:02)</a>:</h4>
<p><span class="user-mention" data-user-id="120989">@nnethercote</span> Two things:</p>
<ol>
<li><code>disallowed-type</code> is an allow-by-default lint (because it is in nursery status).  You need to add <code>#![warn(clippy::disallowed_type)]</code> to the top of <a href="http://main.rs">main.rs</a>.</li>
<li>Adding syntax errors probably means you are looking at cached output. Clippy does not rerun unless one of the source files changes. Unfortunately cargo does not know about clippy.toml.  It might be feasible to have clippy tell cargo to track that file (via dep-info), but I don't know how feasible that is.</li>
</ol>



<a name="261741218"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122651-general/topic/clippy.toml/near/261741218" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nnethercote <a href="https://zulip-archive.rust-lang.org/stream/122651-general/topic/clippy.2Etoml.html#261741218">(Nov 17 2021 at 04:02)</a>:</h4>
<p>It works! Thank you <span aria-label="smile" class="emoji emoji-1f642" role="img" title="smile">:smile:</span></p>



<a name="261741424"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122651-general/topic/clippy.toml/near/261741424" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nnethercote <a href="https://zulip-archive.rust-lang.org/stream/122651-general/topic/clippy.2Etoml.html#261741424">(Nov 17 2021 at 04:07)</a>:</h4>
<p>Hmm, the lint name is <code>disallowed_type</code>, but the entry in the <code>clippy.toml</code> file is <code>disallowed-types</code>. A curious inconsistency</p>



<a name="261741873"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122651-general/topic/clippy.toml/near/261741873" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Nelson <a href="https://zulip-archive.rust-lang.org/stream/122651-general/topic/clippy.2Etoml.html#261741873">(Nov 17 2021 at 04:16)</a>:</h4>
<p>The lint name should be plural, that should be fixed in clippy</p>



<a name="261742560"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122651-general/topic/clippy.toml/near/261742560" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nnethercote <a href="https://zulip-archive.rust-lang.org/stream/122651-general/topic/clippy.2Etoml.html#261742560">(Nov 17 2021 at 04:31)</a>:</h4>
<p>"should be" as in "needs to be"?</p>



<a name="261742568"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122651-general/topic/clippy.toml/near/261742568" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nnethercote <a href="https://zulip-archive.rust-lang.org/stream/122651-general/topic/clippy.2Etoml.html#261742568">(Nov 17 2021 at 04:31)</a>:</h4>
<p>(as opposed to "has been")</p>



<a name="261742749"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122651-general/topic/clippy.toml/near/261742749" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nnethercote <a href="https://zulip-archive.rust-lang.org/stream/122651-general/topic/clippy.2Etoml.html#261742749">(Nov 17 2021 at 04:35)</a>:</h4>
<p>i.e. should I file an issue?</p>



<a name="261742828"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122651-general/topic/clippy.toml/near/261742828" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nnethercote <a href="https://zulip-archive.rust-lang.org/stream/122651-general/topic/clippy.2Etoml.html#261742828">(Nov 17 2021 at 04:36)</a>:</h4>
<p>I'll ask in <a class="stream" data-stream-id="257328" href="/#narrow/stream/257328-clippy">#clippy</a></p>



<a name="261743151"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122651-general/topic/clippy.toml/near/261743151" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Nelson <a href="https://zulip-archive.rust-lang.org/stream/122651-general/topic/clippy.2Etoml.html#261743151">(Nov 17 2021 at 04:43)</a>:</h4>
<p>"should be" as in "it's inconsistent with the lint policy, which says lints should be plural"</p>



<a name="261743160"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122651-general/topic/clippy.toml/near/261743160" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Nelson <a href="https://zulip-archive.rust-lang.org/stream/122651-general/topic/clippy.2Etoml.html#261743160">(Nov 17 2021 at 04:43)</a>:</h4>
<p>But not as in "it will break things if not fixed"</p>



<hr><p>Last updated: Apr 12 2022 at 20:01 UTC</p>
</html>