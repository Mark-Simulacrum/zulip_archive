<html>
<head><meta charset="utf-8"><title>rustc SIGSEGV during &#x27;Building stage1 std artifacts&#x27; · general · Zulip Chat Archive</title></head>
<h2>Stream: <a href="https://zulip-archive.rust-lang.org/stream/122651-general/index.html">general</a></h2>
<h3>Topic: <a href="https://zulip-archive.rust-lang.org/stream/122651-general/topic/rustc.20SIGSEGV.20during.20&#x27;Building.20stage1.20std.20artifacts&#x27;.html">rustc SIGSEGV during &#x27;Building stage1 std artifacts&#x27;</a></h3>

<hr>

<base href="https://rust-lang.zulipchat.com">

<head><link href="https://zulip-archive.rust-lang.org/style.css" rel="stylesheet"></head>

<a name="261392764"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122651-general/topic/rustc%20SIGSEGV%20during%20%27Building%20stage1%20std%20artifacts%27/near/261392764" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> RalfJ <a href="https://zulip-archive.rust-lang.org/stream/122651-general/topic/rustc.20SIGSEGV.20during.20&#x27;Building.20stage1.20std.20artifacts&#x27;.html#261392764">(Nov 14 2021 at 02:14)</a>:</h4>
<p>I am getting SIGSEGVs when building rustc during the stage 1 std build:</p>
<div class="codehilite"><pre><span></span><code>/home/r/src/rust/rustc/build/x86_64-unknown-linux-gnu/stage1/lib/librustc_driver-47d0b6818de97398.so(+0x73cac3)[0x7fd19f513ac3]
/lib/x86_64-linux-gnu/libc.so.6(+0x3cef0)[0x7fd19eaa0ef0]
/home/r/src/rust/rustc/build/x86_64-unknown-linux-gnu/stage1/lib/librustc_driver-47d0b6818de97398.so(_RNvMs1Q_NtNtCseIS259k75xz_12rustc_middle2ty7contextNtB6_6TyCtxt13intern_layout+0x24)[0x7fd1a1501b84]
/home/r/src/rust/rustc/build/x86_64-unknown-linux-gnu/stage1/lib/librustc_driver-47d0b6818de97398.so(+0xade075)[0x7fd19f8b5075]
[a lot of errors like this]
/home/r/src/rust/rustc/build/x86_64-unknown-linux-gnu/stage1/lib/librustc_driver-47d0b6818de97398.so(+0xb851a4)[0x7fd19f95c1a4]
/home/r/src/rust/rustc/build/x86_64-unknown-linux-gnu/stage1/lib/librustc_driver-47d0b6818de97398.so(+0xb9202e)[0x7fd19f96902e]
/home/r/src/rust/rustc/build/x86_64-unknown-linux-gnu/stage1/lib/librustc_driver-47d0b6818de97398.so(+0xbd7c45)[0x7fd19f9aec45]
/home/r/src/rust/rustc/build/x86_64-unknown-linux-gnu/stage1/lib/librustc_driver-47d0b6818de97398.so(+0xb851a4)[0x7fd19f95c1a4]
rustc exited with signal: 11 (core dumped)
error: could not compile `core`

Caused by:
  process didn&#39;t exit successfully: `/home/r/src/rust/rustc/build/bootstrap/debug/rustc --crate-name core --edition=2018 library/core/src/lib.rs --error-format=json --json=diagnostic-rendered-ansi,artifacts --crate-type lib --emit=dep-info,metadata,link -C opt-level=3 -C embed-bitcode=no -C codegen-units=8 -C debuginfo=1 -C metadata=d2ad3ad0cb571346 -C extra-filename=-d2ad3ad0cb571346 --out-dir /home/r/src/rust/rustc/build/x86_64-unknown-linux-gnu/stage1-std/x86_64-unknown-linux-gnu/release/deps --target x86_64-unknown-linux-gnu -C incremental=/home/r/src/rust/rustc/build/x86_64-unknown-linux-gnu/stage1-std/x86_64-unknown-linux-gnu/release/incremental -L dependency=/home/r/src/rust/rustc/build/x86_64-unknown-linux-gnu/stage1-std/x86_64-unknown-linux-gnu/release/deps -L dependency=/home/r/src/rust/rustc/build/x86_64-unknown-linux-gnu/stage1-std/release/deps -Zsymbol-mangling-version=legacy -Zmacro-backtrace &#39;-Clink-args=-Wl,-rpath,$ORIGIN/../lib&#39; -Zsave-analysis -Cprefer-dynamic -Cllvm-args=-import-instr-limit=10 -Cembed-bitcode=yes &#39;-Zcrate-attr=doc(html_root_url=&quot;https://doc.rust-lang.org/nightly/&quot;)&#39; -Z binary-dep-depinfo` (exit status: 254)
Build completed unsuccessfully in 0:00:32
</code></pre></div>
<p>This is when doing <code>nice ./x.py test src/test/ui --test-args 89765 --bless</code>. The command previously worked fine, but now after switching back to the master branch and working on a different patch it always fails. I assume incremental is borked and somehow not able to fix itself?<br>
At this point all I want is to build rustc again but even <code>rm build/x86_64-unknown-linux-gnu/stage1* -rf</code> does not help... is there anything I can do short of <code>./x.py clean</code> (which I was trying to avoid due to the loooooong rebuild times)?</p>



<a name="261392918"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122651-general/topic/rustc%20SIGSEGV%20during%20%27Building%20stage1%20std%20artifacts%27/near/261392918" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> RalfJ <a href="https://zulip-archive.rust-lang.org/stream/122651-general/topic/rustc.20SIGSEGV.20during.20&#x27;Building.20stage1.20std.20artifacts&#x27;.html#261392918">(Nov 14 2021 at 02:19)</a>:</h4>
<p>switching between branches used to work just fine, so even if this is borked incremental then there is a regression here since... the last time I did rustc work, i.e., quite a few months ago^^</p>



<a name="261392922"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122651-general/topic/rustc%20SIGSEGV%20during%20%27Building%20stage1%20std%20artifacts%27/near/261392922" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> RalfJ <a href="https://zulip-archive.rust-lang.org/stream/122651-general/topic/rustc.20SIGSEGV.20during.20&#x27;Building.20stage1.20std.20artifacts&#x27;.html#261392922">(Nov 14 2021 at 02:19)</a>:</h4>
<p>Cc <span class="user-mention" data-user-id="232545">@Joshua Nelson</span> have you seen this failure before?</p>



<a name="261393138"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122651-general/topic/rustc%20SIGSEGV%20during%20%27Building%20stage1%20std%20artifacts%27/near/261393138" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Nelson <a href="https://zulip-archive.rust-lang.org/stream/122651-general/topic/rustc.20SIGSEGV.20during.20&#x27;Building.20stage1.20std.20artifacts&#x27;.html#261393138">(Nov 14 2021 at 02:25)</a>:</h4>
<p>CI has been failing with a similar error recently</p>



<a name="261393139"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122651-general/topic/rustc%20SIGSEGV%20during%20%27Building%20stage1%20std%20artifacts%27/near/261393139" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> simulacrum <a href="https://zulip-archive.rust-lang.org/stream/122651-general/topic/rustc.20SIGSEGV.20during.20&#x27;Building.20stage1.20std.20artifacts&#x27;.html#261393139">(Nov 14 2021 at 02:25)</a>:</h4>
<p>we're seeing the same thing on CI as of recently</p>



<a name="261393143"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122651-general/topic/rustc%20SIGSEGV%20during%20%27Building%20stage1%20std%20artifacts%27/near/261393143" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Nelson <a href="https://zulip-archive.rust-lang.org/stream/122651-general/topic/rustc.20SIGSEGV.20during.20&#x27;Building.20stage1.20std.20artifacts&#x27;.html#261393143">(Nov 14 2021 at 02:25)</a>:</h4>
<p>I wouldn't expect it to be related to incremental</p>



<a name="261393146"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122651-general/topic/rustc%20SIGSEGV%20during%20%27Building%20stage1%20std%20artifacts%27/near/261393146" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> simulacrum <a href="https://zulip-archive.rust-lang.org/stream/122651-general/topic/rustc.20SIGSEGV.20during.20&#x27;Building.20stage1.20std.20artifacts&#x27;.html#261393146">(Nov 14 2021 at 02:25)</a>:</h4>
<p>so in some sense this is great news</p>



<a name="261393205"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122651-general/topic/rustc%20SIGSEGV%20during%20%27Building%20stage1%20std%20artifacts%27/near/261393205" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> simulacrum <a href="https://zulip-archive.rust-lang.org/stream/122651-general/topic/rustc.20SIGSEGV.20during.20&#x27;Building.20stage1.20std.20artifacts&#x27;.html#261393205">(Nov 14 2021 at 02:27)</a>:</h4>
<p><span class="user-mention" data-user-id="120791">@RalfJ</span> it'd be great to snapshot your build directory as a first step -- but if we have a reproducer of any kind, it'd be useful to comment on <a href="https://github.com/rust-lang/rust/issues/90812">https://github.com/rust-lang/rust/issues/90812</a></p>



<a name="261393271"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122651-general/topic/rustc%20SIGSEGV%20during%20%27Building%20stage1%20std%20artifacts%27/near/261393271" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> simulacrum <a href="https://zulip-archive.rust-lang.org/stream/122651-general/topic/rustc.20SIGSEGV.20during.20&#x27;Building.20stage1.20std.20artifacts&#x27;.html#261393271">(Nov 14 2021 at 02:29)</a>:</h4>
<p>I am personally quite suspicious of <a href="https://github.com/rust-lang/rust/pull/89167">https://github.com/rust-lang/rust/pull/89167</a> doing <em>something</em> to cause these</p>



<a name="261393346"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122651-general/topic/rustc%20SIGSEGV%20during%20%27Building%20stage1%20std%20artifacts%27/near/261393346" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Nelson <a href="https://zulip-archive.rust-lang.org/stream/122651-general/topic/rustc.20SIGSEGV.20during.20&#x27;Building.20stage1.20std.20artifacts&#x27;.html#261393346">(Nov 14 2021 at 02:31)</a>:</h4>
<p>Hmm, I thought I remembered seeing this before simd landed</p>



<a name="261393353"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122651-general/topic/rustc%20SIGSEGV%20during%20%27Building%20stage1%20std%20artifacts%27/near/261393353" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> simulacrum <a href="https://zulip-archive.rust-lang.org/stream/122651-general/topic/rustc.20SIGSEGV.20during.20&#x27;Building.20stage1.20std.20artifacts&#x27;.html#261393353">(Nov 14 2021 at 02:31)</a>:</h4>
<p>the so far earliest known is pointing at that PR, but yeah, if we can find something earlier seems good</p>



<a name="261394202"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122651-general/topic/rustc%20SIGSEGV%20during%20%27Building%20stage1%20std%20artifacts%27/near/261394202" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> RalfJ <a href="https://zulip-archive.rust-lang.org/stream/122651-general/topic/rustc.20SIGSEGV.20during.20&#x27;Building.20stage1.20std.20artifacts&#x27;.html#261394202">(Nov 14 2021 at 02:55)</a>:</h4>
<p><span class="user-mention silent" data-user-id="116122">simulacrum</span> <a href="#narrow/stream/122651-general/topic/rustc.20SIGSEGV.20during.20'Building.20stage1.20std.20artifacts'/near/261393205">said</a>:</p>
<blockquote>
<p><span class="user-mention silent" data-user-id="120791">RalfJ</span> it'd be great to snapshot your build directory as a first step -- but if we have a reproducer of any kind, it'd be useful to comment on <a href="https://github.com/rust-lang/rust/issues/90812">https://github.com/rust-lang/rust/issues/90812</a></p>
</blockquote>
<p>okay, I am putting it in a tarball</p>



<a name="261394209"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122651-general/topic/rustc%20SIGSEGV%20during%20%27Building%20stage1%20std%20artifacts%27/near/261394209" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> RalfJ <a href="https://zulip-archive.rust-lang.org/stream/122651-general/topic/rustc.20SIGSEGV.20during.20&#x27;Building.20stage1.20std.20artifacts&#x27;.html#261394209">(Nov 14 2021 at 02:55)</a>:</h4>
<p>I dont really have any time to investigate this though... and I doubt this tarball is going to be useful on another machine</p>



<a name="261394264"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122651-general/topic/rustc%20SIGSEGV%20during%20%27Building%20stage1%20std%20artifacts%27/near/261394264" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> RalfJ <a href="https://zulip-archive.rust-lang.org/stream/122651-general/topic/rustc.20SIGSEGV.20during.20&#x27;Building.20stage1.20std.20artifacts&#x27;.html#261394264">(Nov 14 2021 at 02:56)</a>:</h4>
<p>I saw that issue come up when I put the error I got into GH search, but since it only mentioned CI I didnt trust the hit...</p>



<a name="261394269"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122651-general/topic/rustc%20SIGSEGV%20during%20%27Building%20stage1%20std%20artifacts%27/near/261394269" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> RalfJ <a href="https://zulip-archive.rust-lang.org/stream/122651-general/topic/rustc.20SIGSEGV.20during.20&#x27;Building.20stage1.20std.20artifacts&#x27;.html#261394269">(Nov 14 2021 at 02:56)</a>:</h4>
<p>uh wtf, in my 2nd build dir this is also happening even though I did <code>x.py clean</code> first...</p>



<a name="261394275"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122651-general/topic/rustc%20SIGSEGV%20during%20%27Building%20stage1%20std%20artifacts%27/near/261394275" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> RalfJ <a href="https://zulip-archive.rust-lang.org/stream/122651-general/topic/rustc.20SIGSEGV.20during.20&#x27;Building.20stage1.20std.20artifacts&#x27;.html#261394275">(Nov 14 2021 at 02:57)</a>:</h4>
<p>maybe its a race condition, not something that depends on earlier state?</p>



<a name="261394336"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122651-general/topic/rustc%20SIGSEGV%20during%20%27Building%20stage1%20std%20artifacts%27/near/261394336" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> RalfJ <a href="https://zulip-archive.rust-lang.org/stream/122651-general/topic/rustc.20SIGSEGV.20during.20&#x27;Building.20stage1.20std.20artifacts&#x27;.html#261394336">(Nov 14 2021 at 02:58)</a>:</h4>
<p>the only thing I did after the clean is <code>nice ./x.py test src/test/ui --test-args 89765 --bless</code></p>



<a name="261394341"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122651-general/topic/rustc%20SIGSEGV%20during%20%27Building%20stage1%20std%20artifacts%27/near/261394341" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> RalfJ <a href="https://zulip-archive.rust-lang.org/stream/122651-general/topic/rustc.20SIGSEGV.20during.20&#x27;Building.20stage1.20std.20artifacts&#x27;.html#261394341">(Nov 14 2021 at 02:58)</a>:</h4>
<p>but I doubt that can reproduce the problem, since then more people would run into it^^</p>



<a name="261394808"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122651-general/topic/rustc%20SIGSEGV%20during%20%27Building%20stage1%20std%20artifacts%27/near/261394808" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> RalfJ <a href="https://zulip-archive.rust-lang.org/stream/122651-general/topic/rustc.20SIGSEGV.20during.20&#x27;Building.20stage1.20std.20artifacts&#x27;.html#261394808">(Nov 14 2021 at 03:10)</a>:</h4>
<p>now I did an extra <code>rm build/x86_64-unknown-linux-gnu/ -rf</code> and I am still getting this. I just want to finish this PR and go to bed, but it seems I cant :(</p>



<a name="261395525"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122651-general/topic/rustc%20SIGSEGV%20during%20%27Building%20stage1%20std%20artifacts%27/near/261395525" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> RalfJ <a href="https://zulip-archive.rust-lang.org/stream/122651-general/topic/rustc.20SIGSEGV.20during.20&#x27;Building.20stage1.20std.20artifacts&#x27;.html#261395525">(Nov 14 2021 at 03:29)</a>:</h4>
<p>very interesting, rustc master builds fine but my local commit 4869098d160 keeps failing...</p>



<a name="261395584"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122651-general/topic/rustc%20SIGSEGV%20during%20%27Building%20stage1%20std%20artifacts%27/near/261395584" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> RalfJ <a href="https://zulip-archive.rust-lang.org/stream/122651-general/topic/rustc.20SIGSEGV.20during.20&#x27;Building.20stage1.20std.20artifacts&#x27;.html#261395584">(Nov 14 2021 at 03:30)</a>:</h4>
<p>that commit does nothing interesting, you can find it at <a href="https://github.com/RalfJung/rust/commit/4869098d160">https://github.com/RalfJung/rust/commit/4869098d160</a></p>



<a name="261395649"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122651-general/topic/rustc%20SIGSEGV%20during%20%27Building%20stage1%20std%20artifacts%27/near/261395649" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> RalfJ <a href="https://zulip-archive.rust-lang.org/stream/122651-general/topic/rustc.20SIGSEGV.20during.20&#x27;Building.20stage1.20std.20artifacts&#x27;.html#261395649">(Nov 14 2021 at 03:32)</a>:</h4>
<p>In the same build dir, without cleaning in between, I</p>
<ul>
<li>ran my x.py command on master (<a href="https://github.com/rust-lang/rust/commit/1b12d01903293453dd94aa170c82caf94415629f">1b12d01903293453dd94aa170c82caf94415629f</a>), and it worked</li>
<li>git reset to that commit, build again, and it failed</li>
<li>git reset back to master, build again, and it worked</li>
</ul>
<p>wtf</p>



<a name="261395811"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122651-general/topic/rustc%20SIGSEGV%20during%20%27Building%20stage1%20std%20artifacts%27/near/261395811" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> simulacrum <a href="https://zulip-archive.rust-lang.org/stream/122651-general/topic/rustc.20SIGSEGV.20during.20&#x27;Building.20stage1.20std.20artifacts&#x27;.html#261395811">(Nov 14 2021 at 03:37)</a>:</h4>
<p>I might suggest running under valgrind? But feels slow - it might help uncover root cause of whatever is going on since it looks like memory corruption of some sort</p>



<a name="261396025"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122651-general/topic/rustc%20SIGSEGV%20during%20%27Building%20stage1%20std%20artifacts%27/near/261396025" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> RalfJ <a href="https://zulip-archive.rust-lang.org/stream/122651-general/topic/rustc.20SIGSEGV.20during.20&#x27;Building.20stage1.20std.20artifacts&#x27;.html#261396025">(Nov 14 2021 at 03:43)</a>:</h4>
<p>The problematic commit also <a href="https://github.com/rust-lang/rust/pull/90895#issuecomment-968199091">fails on CI</a>.</p>



<a name="261396067"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122651-general/topic/rustc%20SIGSEGV%20during%20%27Building%20stage1%20std%20artifacts%27/near/261396067" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> RalfJ <a href="https://zulip-archive.rust-lang.org/stream/122651-general/topic/rustc.20SIGSEGV.20during.20&#x27;Building.20stage1.20std.20artifacts&#x27;.html#261396067">(Nov 14 2021 at 03:44)</a>:</h4>
<p>how do I run rustc (invoked from x.py) under valgrind?</p>



<a name="261396076"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122651-general/topic/rustc%20SIGSEGV%20during%20%27Building%20stage1%20std%20artifacts%27/near/261396076" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> simulacrum <a href="https://zulip-archive.rust-lang.org/stream/122651-general/topic/rustc.20SIGSEGV.20during.20&#x27;Building.20stage1.20std.20artifacts&#x27;.html#261396076">(Nov 14 2021 at 03:44)</a>:</h4>
<p>Hm</p>



<a name="261396084"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122651-general/topic/rustc%20SIGSEGV%20during%20%27Building%20stage1%20std%20artifacts%27/near/261396084" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> RalfJ <a href="https://zulip-archive.rust-lang.org/stream/122651-general/topic/rustc.20SIGSEGV.20during.20&#x27;Building.20stage1.20std.20artifacts&#x27;.html#261396084">(Nov 14 2021 at 03:44)</a>:</h4>
<p>as I said I dont have time to really dig into this -- I can copy-paste commands you send me, but maybe if you have a Linux box (Debian testing, in case it matters) you could try reproducing with the commit that reliably cuases the issue for me?</p>



<a name="261396087"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122651-general/topic/rustc%20SIGSEGV%20during%20%27Building%20stage1%20std%20artifacts%27/near/261396087" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> simulacrum <a href="https://zulip-archive.rust-lang.org/stream/122651-general/topic/rustc.20SIGSEGV.20during.20&#x27;Building.20stage1.20std.20artifacts&#x27;.html#261396087">(Nov 14 2021 at 03:45)</a>:</h4>
<p>Yeah, I'll try tomorrow morning</p>



<a name="261396094"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122651-general/topic/rustc%20SIGSEGV%20during%20%27Building%20stage1%20std%20artifacts%27/near/261396094" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> simulacrum <a href="https://zulip-archive.rust-lang.org/stream/122651-general/topic/rustc.20SIGSEGV.20during.20&#x27;Building.20stage1.20std.20artifacts&#x27;.html#261396094">(Nov 14 2021 at 03:45)</a>:</h4>
<p>CI failing on it too is promising</p>



<a name="261396098"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122651-general/topic/rustc%20SIGSEGV%20during%20%27Building%20stage1%20std%20artifacts%27/near/261396098" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> RalfJ <a href="https://zulip-archive.rust-lang.org/stream/122651-general/topic/rustc.20SIGSEGV.20during.20&#x27;Building.20stage1.20std.20artifacts&#x27;.html#261396098">(Nov 14 2021 at 03:45)</a>:</h4>
<p>yeah</p>



<a name="261396101"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122651-general/topic/rustc%20SIGSEGV%20during%20%27Building%20stage1%20std%20artifacts%27/near/261396101" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> RalfJ <a href="https://zulip-archive.rust-lang.org/stream/122651-general/topic/rustc.20SIGSEGV.20during.20&#x27;Building.20stage1.20std.20artifacts&#x27;.html#261396101">(Nov 14 2021 at 03:45)</a>:</h4>
<p>meanwhile Ill just see what happens when I cherry-pick this commit on slightly older rustc master</p>



<a name="261396103"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122651-general/topic/rustc%20SIGSEGV%20during%20%27Building%20stage1%20std%20artifacts%27/near/261396103" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> RalfJ <a href="https://zulip-archive.rust-lang.org/stream/122651-general/topic/rustc.20SIGSEGV.20during.20&#x27;Building.20stage1.20std.20artifacts&#x27;.html#261396103">(Nov 14 2021 at 03:45)</a>:</h4>
<p>(right before and right after the core::simd PR)</p>



<a name="261396170"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122651-general/topic/rustc%20SIGSEGV%20during%20%27Building%20stage1%20std%20artifacts%27/near/261396170" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> simulacrum <a href="https://zulip-archive.rust-lang.org/stream/122651-general/topic/rustc.20SIGSEGV.20during.20&#x27;Building.20stage1.20std.20artifacts&#x27;.html#261396170">(Nov 14 2021 at 03:46)</a>:</h4>
<p>Thanks</p>



<a name="261396237"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122651-general/topic/rustc%20SIGSEGV%20during%20%27Building%20stage1%20std%20artifacts%27/near/261396237" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> RalfJ <a href="https://zulip-archive.rust-lang.org/stream/122651-general/topic/rustc.20SIGSEGV.20during.20&#x27;Building.20stage1.20std.20artifacts&#x27;.html#261396237">(Nov 14 2021 at 03:48)</a>:</h4>
<p><a href="https://github.com/RalfJung/rust/commit/22df292893a3e927af4f87dc8e9f7df92bd85d1b">https://github.com/RalfJung/rust/commit/22df292893a3e927af4f87dc8e9f7df92bd85d1b</a> also fails here and thats before the portable SIMD PR</p>



<a name="261396243"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122651-general/topic/rustc%20SIGSEGV%20during%20%27Building%20stage1%20std%20artifacts%27/near/261396243" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> RalfJ <a href="https://zulip-archive.rust-lang.org/stream/122651-general/topic/rustc.20SIGSEGV.20during.20&#x27;Building.20stage1.20std.20artifacts&#x27;.html#261396243">(Nov 14 2021 at 03:48)</a>:</h4>
<p>I did a <code>./x.py clean</code> before trying the build</p>



<a name="261396333"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122651-general/topic/rustc%20SIGSEGV%20during%20%27Building%20stage1%20std%20artifacts%27/near/261396333" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> simulacrum <a href="https://zulip-archive.rust-lang.org/stream/122651-general/topic/rustc.20SIGSEGV.20during.20&#x27;Building.20stage1.20std.20artifacts&#x27;.html#261396333">(Nov 14 2021 at 03:51)</a>:</h4>
<p>I guess maybe try going earlier? I think our start point is probably around the 10th - but also I can [try to] do this tomorrow, I know it's late for you :)</p>



<a name="261396491"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122651-general/topic/rustc%20SIGSEGV%20during%20%27Building%20stage1%20std%20artifacts%27/near/261396491" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Eric Huss <a href="https://zulip-archive.rust-lang.org/stream/122651-general/topic/rustc.20SIGSEGV.20during.20&#x27;Building.20stage1.20std.20artifacts&#x27;.html#261396491">(Nov 14 2021 at 03:55)</a>:</h4>
<p>I'm able to reproduce using Ralf's PR.  The seg fault happened while interning some value.</p>



<a name="261396509"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122651-general/topic/rustc%20SIGSEGV%20during%20%27Building%20stage1%20std%20artifacts%27/near/261396509" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Eric Huss <a href="https://zulip-archive.rust-lang.org/stream/122651-general/topic/rustc.20SIGSEGV.20during.20&#x27;Building.20stage1.20std.20artifacts&#x27;.html#261396509">(Nov 14 2021 at 03:55)</a>:</h4>
<p>I reverted <a href="https://github.com/rust-lang/rust/issues/89167">#89167</a> and it didn't help.</p>



<a name="261396588"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122651-general/topic/rustc%20SIGSEGV%20during%20%27Building%20stage1%20std%20artifacts%27/near/261396588" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Eric Huss <a href="https://zulip-archive.rust-lang.org/stream/122651-general/topic/rustc.20SIGSEGV.20during.20&#x27;Building.20stage1.20std.20artifacts&#x27;.html#261396588">(Nov 14 2021 at 03:57)</a>:</h4>
<p>Is there some way to demangle the rustc symbols?  It looks like the new scheme was enabled for the compiler, but tools like gdb don't handle it.  Symbols like <code>_RINvXs0_NtNtNtCsk9xi4cc0683_4core4iter8adapters3mapINtB6_3MapINtNtNtBc_3ops5range5RangejENCNvYINtNtNtCsffFzDEjmlmy_16rustc_const_eval9interpret8validity15ValidityVisitorNtNtCscV2rBcrSvbv_19rustc_mir_transform10const_prop16ConstPropMachineEINtNtB1z_7visitor12ValueVisitorB2H_E10walk_value0ENtNtNtBa_6traits8iterator8Iterator4folduNCINvNvB4D_8for_each4callINtNtBc_6result6ResultNtNtB1z_7operand4OpTyNtNtNtNtCsgFSsypdB2z9_12rustc_middle3mir9interpret5error15InterpErrorInfoENCNvXs_NtNtCshGwxOtNdG9E_5alloc3vec11spec_extendINtB7I_3VecB5G_EINtB7G_10SpecExtendB5G_BN_E11spec_extend0E0EB2L_</code> are a bit hard to read.</p>



<a name="261396820"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122651-general/topic/rustc%20SIGSEGV%20during%20%27Building%20stage1%20std%20artifacts%27/near/261396820" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> RalfJ <a href="https://zulip-archive.rust-lang.org/stream/122651-general/topic/rustc.20SIGSEGV.20during.20&#x27;Building.20stage1.20std.20artifacts&#x27;.html#261396820">(Nov 14 2021 at 04:01)</a>:</h4>
<p><span class="user-mention silent" data-user-id="116122">simulacrum</span> <a href="#narrow/stream/122651-general/topic/rustc.20SIGSEGV.20during.20'Building.20stage1.20std.20artifacts'/near/261396333">said</a>:</p>
<blockquote>
<p>I know it's late for you :)</p>
</blockquote>
<p>(FWIW I live in Boston these days so it's not so late yet ;)</p>



<a name="261396881"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122651-general/topic/rustc%20SIGSEGV%20during%20%27Building%20stage1%20std%20artifacts%27/near/261396881" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> RalfJ <a href="https://zulip-archive.rust-lang.org/stream/122651-general/topic/rustc.20SIGSEGV.20during.20&#x27;Building.20stage1.20std.20artifacts&#x27;.html#261396881">(Nov 14 2021 at 04:02)</a>:</h4>
<p>cherry-picked it on top of <a href="https://github.com/rust-lang/rust/commit/14a2fd640e0df9ee8cc1e04280b0c3aff93c42da">14a2fd640e0df9ee8cc1e04280b0c3aff93c42da</a>, same error still</p>



<a name="261398907"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122651-general/topic/rustc%20SIGSEGV%20during%20%27Building%20stage1%20std%20artifacts%27/near/261398907" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Eric Huss <a href="https://zulip-archive.rust-lang.org/stream/122651-general/topic/rustc.20SIGSEGV.20during.20&#x27;Building.20stage1.20std.20artifacts&#x27;.html#261398907">(Nov 14 2021 at 04:57)</a>:</h4>
<p><span class="user-mention" data-user-id="120791">@RalfJ</span> I don't think your PR is related to the CI issues.  It looks like it is entering an infinite loop, overflowing the stack.  it seems to be stuck on <code>read_discriminant_value</code> of <code>panicking::AssertKind</code>.</p>



<a name="261400014"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122651-general/topic/rustc%20SIGSEGV%20during%20%27Building%20stage1%20std%20artifacts%27/near/261400014" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Gary Guo <a href="https://zulip-archive.rust-lang.org/stream/122651-general/topic/rustc.20SIGSEGV.20during.20&#x27;Building.20stage1.20std.20artifacts&#x27;.html#261400014">(Nov 14 2021 at 05:28)</a>:</h4>
<p>Good point, I almost forget that we are using segmented stacks so stack overflow exhibits as segfault</p>



<a name="261404712"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122651-general/topic/rustc%20SIGSEGV%20during%20%27Building%20stage1%20std%20artifacts%27/near/261404712" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> cuviper <a href="https://zulip-archive.rust-lang.org/stream/122651-general/topic/rustc.20SIGSEGV.20during.20&#x27;Building.20stage1.20std.20artifacts&#x27;.html#261404712">(Nov 14 2021 at 07:52)</a>:</h4>
<p>We could probably expose the functions that tell the segv handler where the stack guard is.</p>



<a name="261408374"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122651-general/topic/rustc%20SIGSEGV%20during%20%27Building%20stage1%20std%20artifacts%27/near/261408374" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> matthiaskrgr <a href="https://zulip-archive.rust-lang.org/stream/122651-general/topic/rustc.20SIGSEGV.20during.20&#x27;Building.20stage1.20std.20artifacts&#x27;.html#261408374">(Nov 14 2021 at 09:38)</a>:</h4>
<p>cc <a href="#narrow/stream/242791-t-infra/topic/random.20segfaults.20and.20crashes">https://rust-lang.zulipchat.com/#narrow/stream/242791-t-infra/topic/random.20segfaults.20and.20crashes</a></p>



<a name="261408785"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122651-general/topic/rustc%20SIGSEGV%20during%20%27Building%20stage1%20std%20artifacts%27/near/261408785" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nagisa <a href="https://zulip-archive.rust-lang.org/stream/122651-general/topic/rustc.20SIGSEGV.20during.20&#x27;Building.20stage1.20std.20artifacts&#x27;.html#261408785">(Nov 14 2021 at 09:50)</a>:</h4>
<p>Even without segmented stacks the segv handler is a best effort kinda thing and may fail to report a stack overflow.</p>



<a name="261408796"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122651-general/topic/rustc%20SIGSEGV%20during%20%27Building%20stage1%20std%20artifacts%27/near/261408796" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nagisa <a href="https://zulip-archive.rust-lang.org/stream/122651-general/topic/rustc.20SIGSEGV.20during.20&#x27;Building.20stage1.20std.20artifacts&#x27;.html#261408796">(Nov 14 2021 at 09:50)</a>:</h4>
<p>I don't think it makes sense to expose the rust runtime's handler; rather stacker could set up one such handler by itself.</p>



<a name="261409006"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122651-general/topic/rustc%20SIGSEGV%20during%20%27Building%20stage1%20std%20artifacts%27/near/261409006" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nagisa <a href="https://zulip-archive.rust-lang.org/stream/122651-general/topic/rustc.20SIGSEGV.20during.20&#x27;Building.20stage1.20std.20artifacts&#x27;.html#261409006">(Nov 14 2021 at 09:57)</a>:</h4>
<p>I filled myself an issue at <a href="https://github.com/rust-lang/stacker/issues/59">https://github.com/rust-lang/stacker/issues/59</a></p>



<a name="261413459"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122651-general/topic/rustc%20SIGSEGV%20during%20%27Building%20stage1%20std%20artifacts%27/near/261413459" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> tm <a href="https://zulip-archive.rust-lang.org/stream/122651-general/topic/rustc.20SIGSEGV.20during.20&#x27;Building.20stage1.20std.20artifacts&#x27;.html#261413459">(Nov 14 2021 at 11:52)</a>:</h4>
<p>rustc-driver also install its own sigsegv handler to print stacktrace</p>



<a name="261413639"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122651-general/topic/rustc%20SIGSEGV%20during%20%27Building%20stage1%20std%20artifacts%27/near/261413639" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> tm <a href="https://zulip-archive.rust-lang.org/stream/122651-general/topic/rustc.20SIGSEGV.20during.20&#x27;Building.20stage1.20std.20artifacts&#x27;.html#261413639">(Nov 14 2021 at 11:57)</a>:</h4>
<p>Anyway, this issue is separate since the validation in the failing commit is circular, i.e., reading discriminant checks validity of variant, which reads the discriminant, which checks validity ...</p>



<a name="261423074"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122651-general/topic/rustc%20SIGSEGV%20during%20%27Building%20stage1%20std%20artifacts%27/near/261423074" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> RalfJ <a href="https://zulip-archive.rust-lang.org/stream/122651-general/topic/rustc.20SIGSEGV.20during.20&#x27;Building.20stage1.20std.20artifacts&#x27;.html#261423074">(Nov 14 2021 at 15:29)</a>:</h4>
<p><span class="user-mention silent" data-user-id="120518">Eric Huss</span> <a href="#narrow/stream/122651-general/topic/rustc.20SIGSEGV.20during.20'Building.20stage1.20std.20artifacts'/near/261398907">said</a>:</p>
<blockquote>
<p><span class="user-mention silent" data-user-id="120791">RalfJ</span> I don't think your PR is related to the CI issues.  It looks like it is entering an infinite loop, overflowing the stack.  it seems to be stuck on <code>read_discriminant_value</code> of <code>panicking::AssertKind</code>.</p>
</blockquote>
<p>oh I see... d'oh. yeah that makes sense.</p>



<a name="261423213"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122651-general/topic/rustc%20SIGSEGV%20during%20%27Building%20stage1%20std%20artifacts%27/near/261423213" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> RalfJ <a href="https://zulip-archive.rust-lang.org/stream/122651-general/topic/rustc.20SIGSEGV.20during.20&#x27;Building.20stage1.20std.20artifacts&#x27;.html#261423213">(Nov 14 2021 at 15:32)</a>:</h4>
<p>but then why is it printing all those weird other things?</p>
<div class="codehilite"><pre><span></span><code>/home/r/src/rust/rustc/build/x86_64-unknown-linux-gnu/stage1/lib/librustc_driver-47d0b6818de97398.so(+0x73cac3)[0x7fd19f513ac3]
/lib/x86_64-linux-gnu/libc.so.6(+0x3cef0)[0x7fd19eaa0ef0]
/home/r/src/rust/rustc/build/x86_64-unknown-linux-gnu/stage1/lib/librustc_driver-47d0b6818de97398.so(_RNvMs1Q_NtNtCseIS259k75xz_12rustc_middle2ty7contextNtB6_6TyCtxt13intern_layout+0x24)[0x7fd1a1501b84]
/home/r/src/rust/rustc/build/x86_64-unknown-linux-gnu/stage1/lib/librustc_driver-47d0b6818de97398.so(+0xade075)[0x7fd19f8b5075]
</code></pre></div>



<a name="261423346"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122651-general/topic/rustc%20SIGSEGV%20during%20%27Building%20stage1%20std%20artifacts%27/near/261423346" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Eric Huss <a href="https://zulip-archive.rust-lang.org/stream/122651-general/topic/rustc.20SIGSEGV.20during.20&#x27;Building.20stage1.20std.20artifacts&#x27;.html#261423346">(Nov 14 2021 at 15:36)</a>:</h4>
<p><span class="user-mention" data-user-id="120791">@RalfJ</span> I believe there is a sigsegv signal handler in rustc that attempts to dump the stack.  However, it seems to be failing to get the symbols.</p>



<a name="261423370"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122651-general/topic/rustc%20SIGSEGV%20during%20%27Building%20stage1%20std%20artifacts%27/near/261423370" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> RalfJ <a href="https://zulip-archive.rust-lang.org/stream/122651-general/topic/rustc.20SIGSEGV.20during.20&#x27;Building.20stage1.20std.20artifacts&#x27;.html#261423370">(Nov 14 2021 at 15:38)</a>:</h4>
<p>also IMO if this is supposed to be a stack dump it should say so</p>



<a name="261423420"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122651-general/topic/rustc%20SIGSEGV%20during%20%27Building%20stage1%20std%20artifacts%27/near/261423420" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> RalfJ <a href="https://zulip-archive.rust-lang.org/stream/122651-general/topic/rustc.20SIGSEGV.20during.20&#x27;Building.20stage1.20std.20artifacts&#x27;.html#261423420">(Nov 14 2021 at 15:38)</a>:</h4>
<p>like, it should say "Stack dump:\n" and then print all this random-looking stuff</p>



<a name="261443582"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122651-general/topic/rustc%20SIGSEGV%20during%20%27Building%20stage1%20std%20artifacts%27/near/261443582" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nnethercote <a href="https://zulip-archive.rust-lang.org/stream/122651-general/topic/rustc.20SIGSEGV.20during.20&#x27;Building.20stage1.20std.20artifacts&#x27;.html#261443582">(Nov 14 2021 at 23:12)</a>:</h4>
<p><span class="user-mention" data-user-id="120518">@Eric Huss</span> run it through rustfilt: <code>&lt;core::iter::adapters::map::Map&lt;core::ops::range::Range&lt;usize&gt;, &lt;rustc_const_eval::interpret::validity::ValidityVisitor&lt;rustc_mir_transform::const_prop::ConstPropMachine&gt; as rustc_const_eval::interpret::visitor::ValueVisitor&lt;rustc_mir_transform::const_prop::ConstPropMachine&gt;&gt;::walk_value::{closure#0}&gt; as core::iter::traits::iterator::Iterator&gt;::fold::&lt;(), core::iter::traits::iterator::Iterator::for_each::call&lt;core::result::Result&lt;rustc_const_eval::interpret::operand::OpTy, rustc_middle::mir::interpret::error::InterpErrorInfo&gt;, &lt;alloc::vec::Vec&lt;core::result::Result&lt;rustc_const_eval::interpret::operand::OpTy, rustc_middle::mir::interpret::error::InterpErrorInfo&gt;&gt; as alloc::vec::spec_extend::SpecExtend&lt;core::result::Result&lt;rustc_const_eval::interpret::operand::OpTy, rustc_middle::mir::interpret::error::InterpErrorInfo&gt;, core::iter::adapters::map::Map&lt;core::ops::range::Range&lt;usize&gt;, &lt;rustc_const_eval::interpret::validity::ValidityVisitor&lt;rustc_mir_transform::const_prop::ConstPropMachine&gt; as rustc_const_eval::interpret::visitor::ValueVisitor&lt;rustc_mir_transform::const_prop::ConstPropMachine&gt;&gt;::walk_value::{closure#0}&gt;&gt;&gt;::spec_extend::{closure#0}&gt;::{closure#0}&gt;</code></p>



<a name="261443587"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122651-general/topic/rustc%20SIGSEGV%20during%20%27Building%20stage1%20std%20artifacts%27/near/261443587" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nnethercote <a href="https://zulip-archive.rust-lang.org/stream/122651-general/topic/rustc.20SIGSEGV.20during.20&#x27;Building.20stage1.20std.20artifacts&#x27;.html#261443587">(Nov 14 2021 at 23:12)</a>:</h4>
<p>Quite the mouthful</p>



<a name="261444077"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122651-general/topic/rustc%20SIGSEGV%20during%20%27Building%20stage1%20std%20artifacts%27/near/261444077" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Eric Huss <a href="https://zulip-archive.rust-lang.org/stream/122651-general/topic/rustc.20SIGSEGV.20during.20&#x27;Building.20stage1.20std.20artifacts&#x27;.html#261444077">(Nov 14 2021 at 23:22)</a>:</h4>
<p><span class="user-mention" data-user-id="120989">@nnethercote</span> Thanks!</p>



<hr><p>Last updated: Apr 12 2022 at 20:01 UTC</p>
</html>