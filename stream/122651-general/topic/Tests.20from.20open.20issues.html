<html>
<head><meta charset="utf-8"><title>Tests from open issues · general · Zulip Chat Archive</title></head>
<h2>Stream: <a href="https://zulip-archive.rust-lang.org/stream/122651-general/index.html">general</a></h2>
<h3>Topic: <a href="https://zulip-archive.rust-lang.org/stream/122651-general/topic/Tests.20from.20open.20issues.html">Tests from open issues</a></h3>

<hr>

<base href="https://rust-lang.zulipchat.com">

<head><link href="https://zulip-archive.rust-lang.org/style.css" rel="stylesheet"></head>

<a name="260826162"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122651-general/topic/Tests%20from%20open%20issues/near/260826162" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jack Huey <a href="https://zulip-archive.rust-lang.org/stream/122651-general/topic/Tests.20from.20open.20issues.html#260826162">(Nov 09 2021 at 16:59)</a>:</h4>
<p>So a thought has crossed my mind a few times for a while now, and figured I'd finally open a thread about it.</p>
<p>So, for ICEs, there's <a href="https://github.com/rust-lang/glacier">glacier</a>, which will automatically detect when they no longer ICE. But what about a more generalized collection of tests, to better detect/track changes to behavior. I'm just thinking of all the times where I've fixed a bug and then later tests just get marked as <code>needs-test</code> because they were fixed (sometimes a while after).</p>



<a name="260826356"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122651-general/topic/Tests%20from%20open%20issues/near/260826356" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jack Huey <a href="https://zulip-archive.rust-lang.org/stream/122651-general/topic/Tests.20from.20open.20issues.html#260826356">(Nov 09 2021 at 17:00)</a>:</h4>
<p>It is a bit more difficult. For ICEs, it's easy to track ICE -&gt; no ICE. For tests, we might expect a fail -&gt; pass, a diagnostic change, or maybe even just a fail -&gt; fail (not necessarily a fix, but just a change in why things fail)</p>



<a name="260826666"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122651-general/topic/Tests%20from%20open%20issues/near/260826666" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Nelson <a href="https://zulip-archive.rust-lang.org/stream/122651-general/topic/Tests.20from.20open.20issues.html#260826666">(Nov 09 2021 at 17:02)</a>:</h4>
<p>one option is to write the test before fixing the bug - that seems pretty easy for anyone to do even if they don't have a lot of knowledge about the compiler</p>



<a name="260826706"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122651-general/topic/Tests%20from%20open%20issues/near/260826706" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Nelson <a href="https://zulip-archive.rust-lang.org/stream/122651-general/topic/Tests.20from.20open.20issues.html#260826706">(Nov 09 2021 at 17:03)</a>:</h4>
<p>not sure how to track that in the issue though</p>



<a name="260826736"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122651-general/topic/Tests%20from%20open%20issues/near/260826736" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Nelson <a href="https://zulip-archive.rust-lang.org/stream/122651-general/topic/Tests.20from.20open.20issues.html#260826736">(Nov 09 2021 at 17:03)</a>:</h4>
<p>adding <code>ignore-test</code> seems prone to failure</p>



<a name="260828948"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122651-general/topic/Tests%20from%20open%20issues/near/260828948" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jack Huey <a href="https://zulip-archive.rust-lang.org/stream/122651-general/topic/Tests.20from.20open.20issues.html#260828948">(Nov 09 2021 at 17:18)</a>:</h4>
<p>Yeah, that's one option I considered</p>



<a name="260829003"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122651-general/topic/Tests%20from%20open%20issues/near/260829003" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jack Huey <a href="https://zulip-archive.rust-lang.org/stream/122651-general/topic/Tests.20from.20open.20issues.html#260829003">(Nov 09 2021 at 17:18)</a>:</h4>
<p>Ideally we <em>don't</em> ignore the test, but actually track the changes there</p>



<a name="260829108"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122651-general/topic/Tests%20from%20open%20issues/near/260829108" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jack Huey <a href="https://zulip-archive.rust-lang.org/stream/122651-general/topic/Tests.20from.20open.20issues.html#260829108">(Nov 09 2021 at 17:19)</a>:</h4>
<p>I mean, I guess theoretically, the tests could just go in a folder and be marked <code>// check-fail</code> or such</p>



<a name="260829196"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122651-general/topic/Tests%20from%20open%20issues/near/260829196" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jack Huey <a href="https://zulip-archive.rust-lang.org/stream/122651-general/topic/Tests.20from.20open.20issues.html#260829196">(Nov 09 2021 at 17:20)</a>:</h4>
<p>and commented that "This test should pass" or "This test should fail with X error"</p>



<a name="260829201"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122651-general/topic/Tests%20from%20open%20issues/near/260829201" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jack Huey <a href="https://zulip-archive.rust-lang.org/stream/122651-general/topic/Tests.20from.20open.20issues.html#260829201">(Nov 09 2021 at 17:20)</a>:</h4>
<p>etc.</p>



<a name="260830384"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122651-general/topic/Tests%20from%20open%20issues/near/260830384" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Nelson <a href="https://zulip-archive.rust-lang.org/stream/122651-general/topic/Tests.20from.20open.20issues.html#260830384">(Nov 09 2021 at 17:29)</a>:</h4>
<p><span class="user-mention silent" data-user-id="232957">Jack Huey</span> <a href="#narrow/stream/122651-general/topic/Tests.20from.20open.20issues/near/260829108">said</a>:</p>
<blockquote>
<p>I mean, I guess theoretically, the tests could just go in a folder and be marked <code>// check-fail</code> or such</p>
</blockquote>
<p>ooh I like this idea</p>



<a name="260830415"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122651-general/topic/Tests%20from%20open%20issues/near/260830415" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Nelson <a href="https://zulip-archive.rust-lang.org/stream/122651-general/topic/Tests.20from.20open.20issues.html#260830415">(Nov 09 2021 at 17:29)</a>:</h4>
<p>and that makes it impossible to forget to update it; at very least you wouldn't end up with duplicate tests</p>



<a name="260830556"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122651-general/topic/Tests%20from%20open%20issues/near/260830556" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Nelson <a href="https://zulip-archive.rust-lang.org/stream/122651-general/topic/Tests.20from.20open.20issues.html#260830556">(Nov 09 2021 at 17:30)</a>:</h4>
<p>I think we can do this even without changes to compile-test, just add ERROR annotations like normal and a comment at the top that it can be changed to <code>// check-pass</code> eventually</p>



<a name="260831229"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122651-general/topic/Tests%20from%20open%20issues/near/260831229" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jack Huey <a href="https://zulip-archive.rust-lang.org/stream/122651-general/topic/Tests.20from.20open.20issues.html#260831229">(Nov 09 2021 at 17:36)</a>:</h4>
<p>I think it might be nice(r) to make things kinds of tests most "drop-in", at least in the sense of not having to add the ERROR annotations. My reasoning is that it lowers the "barrier of entry" to adding these tests and the maintenance burden of the tests in general, which is especially important if the intent is more accurately track them.</p>



<a name="260831365"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122651-general/topic/Tests%20from%20open%20issues/near/260831365" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Nelson <a href="https://zulip-archive.rust-lang.org/stream/122651-general/topic/Tests.20from.20open.20issues.html#260831365">(Nov 09 2021 at 17:37)</a>:</h4>
<p>hmm, do you find you have to update the annotations a lot? I haven't found that to be a giant burden, but that might just be because I mostly work on rustdoc</p>



<a name="260831395"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122651-general/topic/Tests%20from%20open%20issues/near/260831395" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Nelson <a href="https://zulip-archive.rust-lang.org/stream/122651-general/topic/Tests.20from.20open.20issues.html#260831395">(Nov 09 2021 at 17:37)</a>:</h4>
<p>I don't think the annotations are a ton of work compared to actually writing the test and making sure it's valid</p>



<a name="260831493"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122651-general/topic/Tests%20from%20open%20issues/near/260831493" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Nelson <a href="https://zulip-archive.rust-lang.org/stream/122651-general/topic/Tests.20from.20open.20issues.html#260831493">(Nov 09 2021 at 17:38)</a>:</h4>
<p>(and it makes it less likely someone will <code>--bless</code> it without actually looking at the changes)</p>



<a name="260858708"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122651-general/topic/Tests%20from%20open%20issues/near/260858708" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jack Huey <a href="https://zulip-archive.rust-lang.org/stream/122651-general/topic/Tests.20from.20open.20issues.html#260858708">(Nov 09 2021 at 20:50)</a>:</h4>
<p>Not a terrible point. I suppose it's always possible to later add an annotation or logic to exclude these types of tests</p>



<a name="260858744"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122651-general/topic/Tests%20from%20open%20issues/near/260858744" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jack Huey <a href="https://zulip-archive.rust-lang.org/stream/122651-general/topic/Tests.20from.20open.20issues.html#260858744">(Nov 09 2021 at 20:50)</a>:</h4>
<p>err, exclude requiring ERROR annotations</p>



<a name="260859592"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122651-general/topic/Tests%20from%20open%20issues/near/260859592" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jack Huey <a href="https://zulip-archive.rust-lang.org/stream/122651-general/topic/Tests.20from.20open.20issues.html#260859592">(Nov 09 2021 at 20:57)</a>:</h4>
<p>If I get some time anytime soon, I might write a draft implementation and a MCP. I do think this could be useful.</p>



<a name="260859770"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122651-general/topic/Tests%20from%20open%20issues/near/260859770" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jack Huey <a href="https://zulip-archive.rust-lang.org/stream/122651-general/topic/Tests.20from.20open.20issues.html#260859770">(Nov 09 2021 at 20:58)</a>:</h4>
<p>I do think the question of "Do these tests live in the rustc test suite or elsewhere?" is a valid question</p>



<hr><p>Last updated: Apr 12 2022 at 20:01 UTC</p>
</html>