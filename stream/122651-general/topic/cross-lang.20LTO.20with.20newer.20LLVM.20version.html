<html>
<head><meta charset="utf-8"><title>cross-lang LTO with newer LLVM version · general · Zulip Chat Archive</title></head>
<h2>Stream: <a href="https://zulip-archive.rust-lang.org/stream/122651-general/index.html">general</a></h2>
<h3>Topic: <a href="https://zulip-archive.rust-lang.org/stream/122651-general/topic/cross-lang.20LTO.20with.20newer.20LLVM.20version.html">cross-lang LTO with newer LLVM version</a></h3>

<hr>

<base href="https://rust-lang.zulipchat.com">

<head><link href="https://zulip-archive.rust-lang.org/style.css" rel="stylesheet"></head>

<a name="273138876"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122651-general/topic/cross-lang%20LTO%20with%20newer%20LLVM%20version/near/273138876" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Collin Baker <a href="https://zulip-archive.rust-lang.org/stream/122651-general/topic/cross-lang.20LTO.20with.20newer.20LLVM.20version.html#273138876">(Feb 24 2022 at 19:39)</a>:</h4>
<p>is it possible for rustc to do cross-language LTO with libraries built with a much newer LLVM version?</p>



<a name="273138936"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122651-general/topic/cross-lang%20LTO%20with%20newer%20LLVM%20version/near/273138936" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Collin Baker <a href="https://zulip-archive.rust-lang.org/stream/122651-general/topic/cross-lang.20LTO.20with.20newer.20LLVM.20version.html#273138936">(Feb 24 2022 at 19:39)</a>:</h4>
<p>this suggests pointing it to the newer LLVM's <a href="http://libLTO.so">libLTO.so</a> would do the trick: <a href="https://doc.rust-lang.org/rustc/linker-plugin-lto.html#explicitly-specifying-the-linker-plugin-to-be-used-by-rustc">https://doc.rust-lang.org/rustc/linker-plugin-lto.html#explicitly-specifying-the-linker-plugin-to-be-used-by-rustc</a></p>



<a name="273139079"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122651-general/topic/cross-lang%20LTO%20with%20newer%20LLVM%20version/near/273139079" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Collin Baker <a href="https://zulip-archive.rust-lang.org/stream/122651-general/topic/cross-lang.20LTO.20with.20newer.20LLVM.20version.html#273139079">(Feb 24 2022 at 19:40)</a>:</h4>
<p>but even passing <code>-Clinker-plugin-lto=".../libLTO.so"</code> I still get the error:</p>



<a name="273139085"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122651-general/topic/cross-lang%20LTO%20with%20newer%20LLVM%20version/near/273139085" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Collin Baker <a href="https://zulip-archive.rust-lang.org/stream/122651-general/topic/cross-lang.20LTO.20with.20newer.20LLVM.20version.html#273139085">(Feb 24 2022 at 19:40)</a>:</h4>
<p><code>error: failed to build archive: Not an int attribute (Producer: 'LLVM15.0.0git' Reader: 'LLVM 13.0.0-rust-1.59.0-beta')</code></p>



<a name="273141226"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122651-general/topic/cross-lang%20LTO%20with%20newer%20LLVM%20version/near/273141226" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Eh2406 <a href="https://zulip-archive.rust-lang.org/stream/122651-general/topic/cross-lang.20LTO.20with.20newer.20LLVM.20version.html#273141226">(Feb 24 2022 at 19:55)</a>:</h4>
<p>My understanding is that the version of LLVM used to build Rustc and used for your other languages need to match. But I'm not an expert.</p>



<hr><p>Last updated: Apr 12 2022 at 20:01 UTC</p>
</html>