<html>
<head><meta charset="utf-8"><title>keyboard crate · general · Zulip Chat Archive</title></head>
<h2>Stream: <a href="https://zulip-archive.rust-lang.org/stream/122651-general/index.html">general</a></h2>
<h3>Topic: <a href="https://zulip-archive.rust-lang.org/stream/122651-general/topic/keyboard.20crate.html">keyboard crate</a></h3>

<hr>

<base href="https://rust-lang.zulipchat.com">

<head><link href="https://zulip-archive.rust-lang.org/style.css" rel="stylesheet"></head>

<a name="275165376"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122651-general/topic/keyboard%20crate/near/275165376" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mendel Rubin <a href="https://zulip-archive.rust-lang.org/stream/122651-general/topic/keyboard.20crate.html#275165376">(Mar 13 2022 at 17:25)</a>:</h4>
<p>is there a good crate for keyboard input that cross platform that doesnt require you to press enter after your input that also accepts up and down and other keyboard modifiers?</p>



<a name="275167887"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122651-general/topic/keyboard%20crate/near/275167887" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> LegionMammal978 <a href="https://zulip-archive.rust-lang.org/stream/122651-general/topic/keyboard.20crate.html#275167887">(Mar 13 2022 at 18:23)</a>:</h4>
<p>The <a href="https://docs.rs/console">console</a> crate has a <a href="https://docs.rs/console/latest/console/struct.Term.html#method.read_key"><code>Term::read_key()</code></a> method; does that work for your use case?</p>



<a name="275168702"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122651-general/topic/keyboard%20crate/near/275168702" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mendel Rubin <a href="https://zulip-archive.rust-lang.org/stream/122651-general/topic/keyboard.20crate.html#275168702">(Mar 13 2022 at 18:43)</a>:</h4>
<p>can you give an example</p>



<a name="275169174"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122651-general/topic/keyboard%20crate/near/275169174" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mendel Rubin <a href="https://zulip-archive.rust-lang.org/stream/122651-general/topic/keyboard.20crate.html#275169174">(Mar 13 2022 at 18:54)</a>:</h4>
<p>The docs for it are a little confusing, and I'm also new to rust</p>



<a name="275191162"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122651-general/topic/keyboard%20crate/near/275191162" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> LegionMammal978 <a href="https://zulip-archive.rust-lang.org/stream/122651-general/topic/keyboard.20crate.html#275191162">(Mar 14 2022 at 03:41)</a>:</h4>
<p>A basic example would be something like this, which reads the key in a loop:</p>
<div class="codehilite" data-code-language="Rust"><pre><span></span><code><span class="k">use</span><span class="w"> </span><span class="n">console</span>::<span class="p">{</span><span class="n">Key</span><span class="p">,</span><span class="w"> </span><span class="n">Term</span><span class="p">};</span><span class="w"></span>

<span class="k">fn</span> <span class="nf">main</span><span class="p">()</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="kd">let</span><span class="w"> </span><span class="n">term</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Term</span>::<span class="n">stdout</span><span class="p">();</span><span class="w"></span>
<span class="w">    </span><span class="k">while</span><span class="w"> </span><span class="kd">let</span><span class="w"> </span><span class="nb">Ok</span><span class="p">(</span><span class="n">key</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">term</span><span class="p">.</span><span class="n">read_key</span><span class="p">()</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">        </span><span class="k">match</span><span class="w"> </span><span class="n">key</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">            </span><span class="n">Key</span>::<span class="n">ArrowUp</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="fm">println!</span><span class="p">(</span><span class="s">"got up arrow"</span><span class="p">),</span><span class="w"></span>
<span class="w">            </span><span class="n">Key</span>::<span class="n">ArrowDown</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="fm">println!</span><span class="p">(</span><span class="s">"got down arrow"</span><span class="p">),</span><span class="w"></span>
<span class="w">            </span><span class="n">Key</span>::<span class="n">Char</span><span class="p">(</span><span class="n">c</span><span class="p">)</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="fm">println!</span><span class="p">(</span><span class="s">"got character '{c}'"</span><span class="p">),</span><span class="w"></span>
<span class="w">            </span><span class="n">_</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="fm">println!</span><span class="p">(</span><span class="s">"got unknown key {key:?}"</span><span class="p">),</span><span class="w"></span>
<span class="w">        </span><span class="p">}</span><span class="w"></span>
<span class="w">    </span><span class="p">}</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>
</code></pre></div>
<p>It uses a <code>match</code> statement to distinguish which kind of key is being pressed. Note, however, that this crate can have unexpected output if the user is pressing Ctrl or Alt.</p>



<a name="275238591"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122651-general/topic/keyboard%20crate/near/275238591" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mendel Rubin <a href="https://zulip-archive.rust-lang.org/stream/122651-general/topic/keyboard.20crate.html#275238591">(Mar 14 2022 at 13:56)</a>:</h4>
<p>Thank you, does this also capture the enter key?</p>



<a name="275253638"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122651-general/topic/keyboard%20crate/near/275253638" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> LegionMammal978 <a href="https://zulip-archive.rust-lang.org/stream/122651-general/topic/keyboard.20crate.html#275253638">(Mar 14 2022 at 15:37)</a>:</h4>
<p>Yes, you can match the return value against <code>Key::Enter</code>. You can try compiling and running my example program; it prints out the  <code>Key</code> values that can be used in the <code>match</code> statement.</p>



<a name="275263075"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122651-general/topic/keyboard%20crate/near/275263075" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mendel Rubin <a href="https://zulip-archive.rust-lang.org/stream/122651-general/topic/keyboard.20crate.html#275263075">(Mar 14 2022 at 16:37)</a>:</h4>
<p>Ok, but do you know a way to just wait for input for just like a second and not until a key is pressed?</p>



<a name="275271512"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122651-general/topic/keyboard%20crate/near/275271512" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> LegionMammal978 <a href="https://zulip-archive.rust-lang.org/stream/122651-general/topic/keyboard.20crate.html#275271512">(Mar 14 2022 at 17:35)</a>:</h4>
<p>That's actually a bit tricky; the easiest way I know to do that is with the event functionality of the <a href="https://docs.rs/crossterm">crossterm</a> crate. Its API is difficult to use without messing up the terminal, so I'd put it in a wrapper function:</p>
<div class="codehilite" data-code-language="Rust"><pre><span></span><code><span class="k">use</span><span class="w"> </span><span class="n">crossterm</span>::<span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="n">event</span>::<span class="p">{</span><span class="bp">self</span><span class="p">,</span><span class="w"> </span><span class="n">Event</span><span class="p">,</span><span class="w"> </span><span class="n">KeyCode</span><span class="p">,</span><span class="w"> </span><span class="n">KeyEvent</span><span class="p">,</span><span class="w"> </span><span class="n">KeyModifiers</span><span class="p">},</span><span class="w"></span>
<span class="w">    </span><span class="n">terminal</span><span class="p">,</span><span class="w"></span>
<span class="p">};</span><span class="w"></span>
<span class="k">use</span><span class="w"> </span><span class="n">std</span>::<span class="n">time</span>::<span class="p">{</span><span class="n">Duration</span><span class="p">,</span><span class="w"> </span><span class="n">Instant</span><span class="p">};</span><span class="w"></span>

<span class="k">fn</span> <span class="nf">read_key</span><span class="p">(</span><span class="n">timeout</span>: <span class="nc">Duration</span><span class="p">)</span><span class="w"> </span>-&gt; <span class="nb">Option</span><span class="o">&lt;</span><span class="n">KeyEvent</span><span class="o">&gt;</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="k">struct</span> <span class="nc">RawModeGuard</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="k">impl</span><span class="w"> </span><span class="nb">Drop</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">RawModeGuard</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">        </span><span class="k">fn</span> <span class="nf">drop</span><span class="p">(</span><span class="o">&amp;</span><span class="k">mut</span><span class="w"> </span><span class="bp">self</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">            </span><span class="n">terminal</span>::<span class="n">disable_raw_mode</span><span class="p">().</span><span class="n">unwrap</span><span class="p">();</span><span class="w"></span>
<span class="w">        </span><span class="p">}</span><span class="w"></span>
<span class="w">    </span><span class="p">}</span><span class="w"></span>
<span class="w">    </span><span class="n">terminal</span>::<span class="n">enable_raw_mode</span><span class="p">().</span><span class="n">unwrap</span><span class="p">();</span><span class="w"></span>
<span class="w">    </span><span class="kd">let</span><span class="w"> </span><span class="n">_guard</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">RawModeGuard</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="kd">let</span><span class="w"> </span><span class="n">start</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Instant</span>::<span class="n">now</span><span class="p">();</span><span class="w"></span>
<span class="w">    </span><span class="kd">let</span><span class="w"> </span><span class="k">mut</span><span class="w"> </span><span class="n">offset</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Duration</span>::<span class="n">ZERO</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="k">while</span><span class="w"> </span><span class="n">offset</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="n">timeout</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">event</span>::<span class="n">poll</span><span class="p">(</span><span class="n">timeout</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">offset</span><span class="p">).</span><span class="n">unwrap</span><span class="p">()</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="kd">let</span><span class="w"> </span><span class="n">Event</span>::<span class="n">Key</span><span class="p">(</span><span class="n">event</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">event</span>::<span class="n">read</span><span class="p">().</span><span class="n">unwrap</span><span class="p">()</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">            </span><span class="k">return</span><span class="w"> </span><span class="nb">Some</span><span class="p">(</span><span class="n">event</span><span class="p">);</span><span class="w"></span>
<span class="w">        </span><span class="p">}</span><span class="w"></span>
<span class="w">        </span><span class="n">offset</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">start</span><span class="p">.</span><span class="n">elapsed</span><span class="p">();</span><span class="w"></span>
<span class="w">    </span><span class="p">}</span><span class="w"></span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="nb">None</span><span class="p">;</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="k">fn</span> <span class="nf">main</span><span class="p">()</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="k">loop</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">        </span><span class="k">match</span><span class="w"> </span><span class="n">read_key</span><span class="p">(</span><span class="n">Duration</span>::<span class="n">from_secs</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">            </span><span class="nb">Some</span><span class="p">(</span><span class="n">KeyEvent</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">                </span><span class="n">code</span>: <span class="nc">KeyCode</span>::<span class="n">Char</span><span class="p">(</span><span class="sc">'c'</span><span class="p">),</span><span class="w"></span>
<span class="w">                </span><span class="n">modifiers</span>: <span class="nc">KeyModifiers</span>::<span class="n">CONTROL</span><span class="p">,</span><span class="w"></span>
<span class="w">            </span><span class="p">})</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="k">break</span><span class="p">,</span><span class="w"></span>
<span class="w">            </span><span class="nb">Some</span><span class="p">(</span><span class="n">key</span><span class="p">)</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="fm">println!</span><span class="p">(</span><span class="s">"got key: {key:?}"</span><span class="p">),</span><span class="w"></span>
<span class="w">            </span><span class="nb">None</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="fm">println!</span><span class="p">(</span><span class="s">"timeout"</span><span class="p">),</span><span class="w"></span>
<span class="w">        </span><span class="p">}</span><span class="w"></span>
<span class="w">    </span><span class="p">}</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>
</code></pre></div>
<p>Note that this solution additionally captures modifiers such as Ctrl, Shift, and Alt (as well as arrows and enter), so special handling is needed to support Ctrl-C.</p>



<a name="275280950"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122651-general/topic/keyboard%20crate/near/275280950" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mendel Rubin <a href="https://zulip-archive.rust-lang.org/stream/122651-general/topic/keyboard.20crate.html#275280950">(Mar 14 2022 at 18:45)</a>:</h4>
<p>ty</p>



<hr><p>Last updated: Apr 12 2022 at 20:01 UTC</p>
</html>