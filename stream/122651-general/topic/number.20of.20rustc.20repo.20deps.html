<html>
<head><meta charset="utf-8"><title>number of rustc repo deps · general · Zulip Chat Archive</title></head>
<h2>Stream: <a href="https://zulip-archive.rust-lang.org/stream/122651-general/index.html">general</a></h2>
<h3>Topic: <a href="https://zulip-archive.rust-lang.org/stream/122651-general/topic/number.20of.20rustc.20repo.20deps.html">number of rustc repo deps</a></h3>

<hr>

<base href="https://rust-lang.zulipchat.com">

<head><link href="https://zulip-archive.rust-lang.org/style.css" rel="stylesheet"></head>

<a name="267299695"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122651-general/topic/number%20of%20rustc%20repo%20deps/near/267299695" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> matthiaskrgr <a href="https://zulip-archive.rust-lang.org/stream/122651-general/topic/number.20of.20rustc.20repo.20deps.html#267299695">(Jan 08 2022 at 14:59)</a>:</h4>
<p>just for fun, I made a graph of the number of deps in rustcs Cargo.lock over the last couple of years <span aria-label="upside down" class="emoji emoji-1f643" role="img" title="upside down">:upside_down:</span> <br>
<a href="/user_uploads/4715/gNZy-QjZrWoSvpdHGIzlQV9C/rustc_deps.png">rustc_deps.png</a></p>
<div class="message_inline_image"><a href="/user_uploads/4715/gNZy-QjZrWoSvpdHGIzlQV9C/rustc_deps.png" title="rustc_deps.png"><img src="/user_uploads/4715/gNZy-QjZrWoSvpdHGIzlQV9C/rustc_deps.png"></a></div>



<a name="267299757"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122651-general/topic/number%20of%20rustc%20repo%20deps/near/267299757" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> matthiaskrgr <a href="https://zulip-archive.rust-lang.org/stream/122651-general/topic/number.20of.20rustc.20repo.20deps.html#267299757">(Jan 08 2022 at 15:00)</a>:</h4>
<p><a href="/user_uploads/4715/HfFlGoVOcSAMVfFX1_UvkGld/rustc_deps_chart.ods">rustc_deps_chart.ods</a> <br>
data</p>



<a name="267299819"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122651-general/topic/number%20of%20rustc%20repo%20deps/near/267299819" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> matthiaskrgr <a href="https://zulip-archive.rust-lang.org/stream/122651-general/topic/number.20of.20rustc.20repo.20deps.html#267299819">(Jan 08 2022 at 15:01)</a>:</h4>
<p>source of the data</p>
<div class="codehilite" data-code-language="Bash"><pre><span></span><code><span class="ch">#!/bin/bash</span>

<span class="nb">echo</span> <span class="s2">"date num_deps"</span>
<span class="k">for</span> rev <span class="k">in</span> <span class="sb">`</span>git log --reverse --format<span class="o">=</span><span class="s2">"%h"</span> Cargo.lock<span class="sb">`</span><span class="p">;</span> <span class="k">do</span>
<span class="nv">num_deps</span><span class="o">=</span><span class="sb">`</span>git show <span class="si">${</span><span class="nv">rev</span><span class="si">}</span>:Cargo.lock <span class="p">|</span> grep package <span class="p">|</span> wc -l<span class="sb">`</span>
<span class="nv">date</span><span class="o">=</span><span class="sb">`</span>git log --format<span class="o">=</span>%cs  <span class="si">${</span><span class="nv">rev</span><span class="si">}</span> -1  <span class="p">|</span> grep -o <span class="s2">".*"</span><span class="sb">`</span>
<span class="nb">echo</span> <span class="s2">"</span><span class="si">${</span><span class="nv">date</span><span class="si">}</span><span class="s2"> </span><span class="si">${</span><span class="nv">num_deps</span><span class="si">}</span><span class="s2">"</span>
<span class="k">done</span><span class="p">;</span>
</code></pre></div>



<a name="267299879"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122651-general/topic/number%20of%20rustc%20repo%20deps/near/267299879" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> matthiaskrgr <a href="https://zulip-archive.rust-lang.org/stream/122651-general/topic/number.20of.20rustc.20repo.20deps.html#267299879">(Jan 08 2022 at 15:02)</a>:</h4>
<p>surprisingly the number of dependencies stayed mostly steady since end of 2020, I didn't expect that :)</p>



<a name="267301076"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122651-general/topic/number%20of%20rustc%20repo%20deps/near/267301076" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> bjorn3 <a href="https://zulip-archive.rust-lang.org/stream/122651-general/topic/number.20of.20rustc.20repo.20deps.html#267301076">(Jan 08 2022 at 15:29)</a>:</h4>
<p>Can you also check just those depended on by rustc itself and not any tools? Something like <code>cargo tree -p rustc-main --prefix none | sed "s/ (.*)//" | sort | uniq | grep -v "v0.0.0" | wc -l</code> should list the amount of dependencies of the rustc executable excluding all internal rustc crates.</p>



<a name="267301565"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122651-general/topic/number%20of%20rustc%20repo%20deps/near/267301565" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> bjorn3 <a href="https://zulip-archive.rust-lang.org/stream/122651-general/topic/number.20of.20rustc.20repo.20deps.html#267301565">(Jan 08 2022 at 15:40)</a>:</h4>
<div class="codehilite" data-code-language="Bash"><pre><span></span><code>git checkout master<span class="p">;</span>
<span class="nb">echo</span> <span class="s2">"date num_deps"</span>
<span class="k">for</span> rev <span class="k">in</span> <span class="sb">`</span>git log --format<span class="o">=</span><span class="s2">"%h"</span> Cargo.lock<span class="sb">`</span><span class="p">;</span> <span class="k">do</span>
git checkout -- Cargo.lock <span class="m">2</span>&gt;<span class="p">&amp;</span><span class="m">1</span> &gt;/dev/null <span class="o">&amp;&amp;</span> git checkout -q <span class="si">${</span><span class="nv">rev</span><span class="si">}</span> <span class="m">2</span>&gt;<span class="p">&amp;</span><span class="m">1</span> &gt;/dev/null <span class="o">&amp;&amp;</span> git submodule update --init src/tools/<span class="o">{</span>clippy,miri,rls,rustfmt<span class="o">}</span> <span class="m">2</span>&gt;<span class="p">&amp;</span><span class="m">1</span> &gt;/dev/null
<span class="nv">num_deps</span><span class="o">=</span><span class="sb">`</span>cargo tree -p rustc-main --prefix none <span class="m">2</span>&gt;/dev/null<span class="p">|</span> sed <span class="s2">"s/ (.*)//"</span> <span class="p">|</span> sort <span class="p">|</span> uniq <span class="p">|</span> grep -v <span class="s2">"v0.0.0"</span> <span class="p">|</span> wc -l<span class="sb">`</span>
<span class="nv">date</span><span class="o">=</span><span class="sb">`</span>git log --format<span class="o">=</span>%cs  <span class="si">${</span><span class="nv">rev</span><span class="si">}</span> -1  <span class="p">|</span> grep -o <span class="s2">".*"</span><span class="sb">`</span>
<span class="nb">echo</span> <span class="s2">"</span><span class="si">${</span><span class="nv">date</span><span class="si">}</span><span class="s2"> </span><span class="si">${</span><span class="nv">num_deps</span><span class="si">}</span><span class="s2">"</span>
<span class="k">done</span><span class="p">;</span>
</code></pre></div>
<p>results in </p>
<div class="codehilite"><pre><span></span><code>date num_deps
2022-01-01 124
2022-01-01 124
2022-01-01 124
2022-01-01 124
2021-12-31 124
2021-12-31 124
2021-12-30 124
2021-12-28 124
2021-12-28 127
2021-12-28 127
2021-12-24 124
2021-12-23 124
2021-12-22 124
2021-12-22 126
2021-12-16 127
2021-12-15 127
2021-12-15 126
2021-12-15 127
2021-12-14 127
2021-12-14 127
2021-12-12 127
2021-12-12 126
2021-12-08 126
2021-12-08 126
2021-12-08 126
2021-12-08 126
2021-12-07 126
2021-12-06 126
2021-12-06 127
2021-12-06 126
2021-12-03 126
2021-11-28 126
2021-11-27 126
2021-11-26 126
2021-11-23 126
2021-11-22 121
2021-11-10 121
2021-11-10 121
2021-11-10 121
2021-11-09 121
2021-11-04 121
2021-11-04 121
2021-11-02 121
2021-11-02 121
2021-11-01 121
2021-10-31 121
^C
</code></pre></div>



<a name="267302895"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122651-general/topic/number%20of%20rustc%20repo%20deps/near/267302895" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Patrick Poitras <a href="https://zulip-archive.rust-lang.org/stream/122651-general/topic/number.20of.20rustc.20repo.20deps.html#267302895">(Jan 08 2022 at 16:11)</a>:</h4>
<p>What's the big dip around June 2020?</p>



<hr><p>Last updated: Apr 12 2022 at 20:01 UTC</p>
</html>