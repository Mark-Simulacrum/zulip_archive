<html>
<head><meta charset="utf-8"><title>✔ rustc compile error only when using `cargo doc`? · general · Zulip Chat Archive</title></head>
<h2>Stream: <a href="https://zulip-archive.rust-lang.org/stream/122651-general/index.html">general</a></h2>
<h3>Topic: <a href="https://zulip-archive.rust-lang.org/stream/122651-general/topic/.E2.9C.94.20rustc.20compile.20error.20only.20when.20using.20.60cargo.20doc.60.3F.html">✔ rustc compile error only when using `cargo doc`?</a></h3>

<hr>

<base href="https://rust-lang.zulipchat.com">

<head><link href="https://zulip-archive.rust-lang.org/style.css" rel="stylesheet"></head>

<a name="277080017"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122651-general/topic/%E2%9C%94%20rustc%20compile%20error%20only%20when%20using%20%60cargo%20doc%60%3F/near/277080017" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Darrow O&#x27;Lykos [Rust Philly] <a href="https://zulip-archive.rust-lang.org/stream/122651-general/topic/.E2.9C.94.20rustc.20compile.20error.20only.20when.20using.20.60cargo.20doc.60.3F.html#277080017">(Mar 30 2022 at 00:04)</a>:</h4>
<p>WOW. I just deleted <code>target/</code> and re-ran <code>cargo doc -p rome_formatter --no-deps --open</code>, and things are OK.</p>



<a name="277080162"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122651-general/topic/%E2%9C%94%20rustc%20compile%20error%20only%20when%20using%20%60cargo%20doc%60%3F/near/277080162" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Darrow O&#x27;Lykos [Rust Philly] <a href="https://zulip-archive.rust-lang.org/stream/122651-general/topic/.E2.9C.94.20rustc.20compile.20error.20only.20when.20using.20.60cargo.20doc.60.3F.html#277080162">(Mar 30 2022 at 00:06)</a>:</h4>
<p>While I know I <strong>should've</strong> thought to do this earlier (<em>the source code writing equivalent of "turning it off and on again"</em>), does anyone have any beautiful compiler wisdom to throw my way-- Why do you think this happened? What was it about my merging of a git branch that somehow tricked the Rust compiler (into doing &lt;something&gt;) that caused it to get confused about the existence of an import?</p>



<a name="277080271"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122651-general/topic/%E2%9C%94%20rustc%20compile%20error%20only%20when%20using%20%60cargo%20doc%60%3F/near/277080271" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Darrow O&#x27;Lykos [Rust Philly] <a href="https://zulip-archive.rust-lang.org/stream/122651-general/topic/.E2.9C.94.20rustc.20compile.20error.20only.20when.20using.20.60cargo.20doc.60.3F.html#277080271">(Mar 30 2022 at 00:09)</a>:</h4>
<p>OH I KNOW</p>



<a name="277080292"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122651-general/topic/%E2%9C%94%20rustc%20compile%20error%20only%20when%20using%20%60cargo%20doc%60%3F/near/277080292" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Darrow O&#x27;Lykos [Rust Philly] <a href="https://zulip-archive.rust-lang.org/stream/122651-general/topic/.E2.9C.94.20rustc.20compile.20error.20only.20when.20using.20.60cargo.20doc.60.3F.html#277080292">(Mar 30 2022 at 00:10)</a>:</h4>
<p>Maybe:</p>



<a name="277080597"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122651-general/topic/%E2%9C%94%20rustc%20compile%20error%20only%20when%20using%20%60cargo%20doc%60%3F/near/277080597" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Darrow O&#x27;Lykos [Rust Philly] <a href="https://zulip-archive.rust-lang.org/stream/122651-general/topic/.E2.9C.94.20rustc.20compile.20error.20only.20when.20using.20.60cargo.20doc.60.3F.html#277080597">(Mar 30 2022 at 00:15)</a>:</h4>
<p>Well I have a guess:</p>
<p>I bet it was that the branch I merged added this new import to <code>rome_js_syntax</code>, but for some reason <code>cargo doc</code> was not re-building <code>rome_rowan</code> and using some stale view of it. In this case, the import would <em>not</em> be found by <code>rustc</code>.</p>
<p>As for why it not re-build <code>rome_rowan</code>, I'm not sure. Perhaps it was some combination of  using the <code>-p</code> and <code>--no-deps</code> flags for <code>cargo doc</code>, which did something to limit any re-building to only source code changes within <code>rome_js_syntax</code> (and thus ignoring any source code changes in <code>rome_js_syntax</code>). Just a guess though. I'm not sure.</p>
<p>Deleting <code>target/</code> had to have wiped some stale bit of data that was stopping the rebuild of <code>rome_js_syntax</code>.</p>
<p>Happy I'm unblocked though. :)</p>



<a name="277080898"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122651-general/topic/%E2%9C%94%20rustc%20compile%20error%20only%20when%20using%20%60cargo%20doc%60%3F/near/277080898" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Notification Bot <a href="https://zulip-archive.rust-lang.org/stream/122651-general/topic/.E2.9C.94.20rustc.20compile.20error.20only.20when.20using.20.60cargo.20doc.60.3F.html#277080898">(Mar 30 2022 at 00:20)</a>:</h4>
<p><span class="user-mention silent" data-user-id="440090">Darrow O'Lykos [Rust Philly]</span> has marked this topic as resolved.</p>



<a name="277090625"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122651-general/topic/%E2%9C%94%20rustc%20compile%20error%20only%20when%20using%20%60cargo%20doc%60%3F/near/277090625" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Nelson <a href="https://zulip-archive.rust-lang.org/stream/122651-general/topic/.E2.9C.94.20rustc.20compile.20error.20only.20when.20using.20.60cargo.20doc.60.3F.html#277090625">(Mar 30 2022 at 03:26)</a>:</h4>
<p>It's possible you hit some cargo bug. Not sure what went wrong without seeing CARGO_LOG, but wiping target/ removed the info that could have tracked this down. Anyway, glad it's working for you now.</p>



<a name="277098585"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122651-general/topic/%E2%9C%94%20rustc%20compile%20error%20only%20when%20using%20%60cargo%20doc%60%3F/near/277098585" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Laurențiu <a href="https://zulip-archive.rust-lang.org/stream/122651-general/topic/.E2.9C.94.20rustc.20compile.20error.20only.20when.20using.20.60cargo.20doc.60.3F.html#277098585">(Mar 30 2022 at 06:18)</a>:</h4>
<p>I'm seeing a lot of weird errors after switching branches while <code>cargo check</code> is running. It might be the same issue (and nor specific to <code>cargo doc</code>).</p>



<hr><p>Last updated: Apr 12 2022 at 20:01 UTC</p>
</html>