<html>
<head><meta charset="utf-8"><title>My crate builds in 1 minute on host vs 35min in docker · general · Zulip Chat Archive</title></head>
<h2>Stream: <a href="https://zulip-archive.rust-lang.org/stream/122651-general/index.html">general</a></h2>
<h3>Topic: <a href="https://zulip-archive.rust-lang.org/stream/122651-general/topic/My.20crate.20builds.20in.201.20minute.20on.20host.20vs.2035min.20in.20docker.html">My crate builds in 1 minute on host vs 35min in docker</a></h3>

<hr>

<base href="https://rust-lang.zulipchat.com">

<head><link href="https://zulip-archive.rust-lang.org/style.css" rel="stylesheet"></head>

<a name="267802993"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122651-general/topic/My%20crate%20builds%20in%201%20minute%20on%20host%20vs%2035min%20in%20docker/near/267802993" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wojciech Niedźwiedź <a href="https://zulip-archive.rust-lang.org/stream/122651-general/topic/My.20crate.20builds.20in.201.20minute.20on.20host.20vs.2035min.20in.20docker.html#267802993">(Jan 12 2022 at 23:33)</a>:</h4>
<p>I have a problem, my crate builds in 1 minute when building on host, but then inside docker it builds for 35 minutes WITH cache. I tried building with -Z timings but it only says that the binary itself is what takes up 99.9% of the time... any help?</p>



<a name="267803028"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122651-general/topic/My%20crate%20builds%20in%201%20minute%20on%20host%20vs%2035min%20in%20docker/near/267803028" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wojciech Niedźwiedź <a href="https://zulip-archive.rust-lang.org/stream/122651-general/topic/My.20crate.20builds.20in.201.20minute.20on.20host.20vs.2035min.20in.20docker.html#267803028">(Jan 12 2022 at 23:33)</a>:</h4>
<p><a href="/user_uploads/4715/jQpBQaC8IjpRK9L03rEL4oqc/image.png">image.png</a> <br>
<a href="/user_uploads/4715/U9FQfKnGyoyowNPeztL2dTzV/image.png">image.png</a></p>
<div class="message_inline_image"><a href="/user_uploads/4715/jQpBQaC8IjpRK9L03rEL4oqc/image.png" title="image.png"><img src="/user_uploads/4715/jQpBQaC8IjpRK9L03rEL4oqc/image.png"></a></div><div class="message_inline_image"><a href="/user_uploads/4715/U9FQfKnGyoyowNPeztL2dTzV/image.png" title="image.png"><img src="/user_uploads/4715/U9FQfKnGyoyowNPeztL2dTzV/image.png"></a></div>



<a name="267803124"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122651-general/topic/My%20crate%20builds%20in%201%20minute%20on%20host%20vs%2035min%20in%20docker/near/267803124" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wojciech Niedźwiedź <a href="https://zulip-archive.rust-lang.org/stream/122651-general/topic/My.20crate.20builds.20in.201.20minute.20on.20host.20vs.2035min.20in.20docker.html#267803124">(Jan 12 2022 at 23:34)</a>:</h4>
<p>visually it looks like it build pretty quickly, and then it hangs after printing all the warning messages</p>



<a name="267804334"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122651-general/topic/My%20crate%20builds%20in%201%20minute%20on%20host%20vs%2035min%20in%20docker/near/267804334" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> cuviper <a href="https://zulip-archive.rust-lang.org/stream/122651-general/topic/My.20crate.20builds.20in.201.20minute.20on.20host.20vs.2035min.20in.20docker.html#267804334">(Jan 12 2022 at 23:47)</a>:</h4>
<p>is that committing the <code>target/</code> directory in docker, perhaps?</p>



<a name="267804418"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122651-general/topic/My%20crate%20builds%20in%201%20minute%20on%20host%20vs%2035min%20in%20docker/near/267804418" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> cuviper <a href="https://zulip-archive.rust-lang.org/stream/122651-general/topic/My.20crate.20builds.20in.201.20minute.20on.20host.20vs.2035min.20in.20docker.html#267804418">(Jan 12 2022 at 23:48)</a>:</h4>
<p>that can be quite large -- but even then that extra time does seem extreme</p>



<a name="267804986"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122651-general/topic/My%20crate%20builds%20in%201%20minute%20on%20host%20vs%2035min%20in%20docker/near/267804986" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wojciech Niedźwiedź <a href="https://zulip-archive.rust-lang.org/stream/122651-general/topic/My.20crate.20builds.20in.201.20minute.20on.20host.20vs.2035min.20in.20docker.html#267804986">(Jan 12 2022 at 23:53)</a>:</h4>
<p>no I'm using <code>.dockerignore</code> to get rid of it</p>



<a name="267804996"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122651-general/topic/My%20crate%20builds%20in%201%20minute%20on%20host%20vs%2035min%20in%20docker/near/267804996" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wojciech Niedźwiedź <a href="https://zulip-archive.rust-lang.org/stream/122651-general/topic/My.20crate.20builds.20in.201.20minute.20on.20host.20vs.2035min.20in.20docker.html#267804996">(Jan 12 2022 at 23:54)</a>:</h4>
<p>but</p>



<a name="267805037"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122651-general/topic/My%20crate%20builds%20in%201%20minute%20on%20host%20vs%2035min%20in%20docker/near/267805037" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wojciech Niedźwiedź <a href="https://zulip-archive.rust-lang.org/stream/122651-general/topic/My.20crate.20builds.20in.201.20minute.20on.20host.20vs.2035min.20in.20docker.html#267805037">(Jan 12 2022 at 23:54)</a>:</h4>
<p>I have actually fixed it</p>



<a name="267805045"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122651-general/topic/My%20crate%20builds%20in%201%20minute%20on%20host%20vs%2035min%20in%20docker/near/267805045" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wojciech Niedźwiedź <a href="https://zulip-archive.rust-lang.org/stream/122651-general/topic/My.20crate.20builds.20in.201.20minute.20on.20host.20vs.2035min.20in.20docker.html#267805045">(Jan 12 2022 at 23:54)</a>:</h4>
<p>just now</p>



<a name="267805048"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122651-general/topic/My%20crate%20builds%20in%201%20minute%20on%20host%20vs%2035min%20in%20docker/near/267805048" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wojciech Niedźwiedź <a href="https://zulip-archive.rust-lang.org/stream/122651-general/topic/My.20crate.20builds.20in.201.20minute.20on.20host.20vs.2035min.20in.20docker.html#267805048">(Jan 12 2022 at 23:54)</a>:</h4>
<p>after 2 months</p>



<a name="267805075"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122651-general/topic/My%20crate%20builds%20in%201%20minute%20on%20host%20vs%2035min%20in%20docker/near/267805075" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wojciech Niedźwiedź <a href="https://zulip-archive.rust-lang.org/stream/122651-general/topic/My.20crate.20builds.20in.201.20minute.20on.20host.20vs.2035min.20in.20docker.html#267805075">(Jan 12 2022 at 23:54)</a>:</h4>
<p>I've upgraded the toolchain to 1.60 and used docker buildkit</p>



<a name="267805087"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122651-general/topic/My%20crate%20builds%20in%201%20minute%20on%20host%20vs%2035min%20in%20docker/near/267805087" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wojciech Niedźwiedź <a href="https://zulip-archive.rust-lang.org/stream/122651-general/topic/My.20crate.20builds.20in.201.20minute.20on.20host.20vs.2035min.20in.20docker.html#267805087">(Jan 12 2022 at 23:54)</a>:</h4>
<p>I've been also using cargo-chef before</p>



<a name="267805098"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122651-general/topic/My%20crate%20builds%20in%201%20minute%20on%20host%20vs%2035min%20in%20docker/near/267805098" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wojciech Niedźwiedź <a href="https://zulip-archive.rust-lang.org/stream/122651-general/topic/My.20crate.20builds.20in.201.20minute.20on.20host.20vs.2035min.20in.20docker.html#267805098">(Jan 12 2022 at 23:54)</a>:</h4>
<p>but now it's &lt;20 seconds with cache :D</p>



<hr><p>Last updated: Apr 12 2022 at 20:01 UTC</p>
</html>