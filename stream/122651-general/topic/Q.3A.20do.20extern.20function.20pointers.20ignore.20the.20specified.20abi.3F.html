<html>
<head><meta charset="utf-8"><title>Q: do extern function pointers ignore the specified abi? · general · Zulip Chat Archive</title></head>
<h2>Stream: <a href="https://zulip-archive.rust-lang.org/stream/122651-general/index.html">general</a></h2>
<h3>Topic: <a href="https://zulip-archive.rust-lang.org/stream/122651-general/topic/Q.3A.20do.20extern.20function.20pointers.20ignore.20the.20specified.20abi.3F.html">Q: do extern function pointers ignore the specified abi?</a></h3>

<hr>

<base href="https://rust-lang.zulipchat.com">

<head><link href="https://zulip-archive.rust-lang.org/style.css" rel="stylesheet"></head>

<a name="258307258"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122651-general/topic/Q%3A%20do%20extern%20function%20pointers%20ignore%20the%20specified%20abi%3F/near/258307258" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Timothy Roberts <a href="https://zulip-archive.rust-lang.org/stream/122651-general/topic/Q.3A.20do.20extern.20function.20pointers.20ignore.20the.20specified.20abi.3F.html#258307258">(Oct 20 2021 at 03:32)</a>:</h4>
<p>Hi, I've been hacking on uefi-rs lately and came across something weird. Whenever I've seen documentation around extern function pointers, they either have the abi specified or state that "C" is the default. However, I've been experimenting with changing the specified abi in uefi-rs's function pointers and it doesn't seem to affect execution in any way. They're originally "efiapi", but I've tried "C", "cdecl", and even "stdcall" and everything still runs, at least on an x86-64 VM. Do extern fn pointers care about the specified abi?</p>



<a name="258311023"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122651-general/topic/Q%3A%20do%20extern%20function%20pointers%20ignore%20the%20specified%20abi%3F/near/258311023" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Timothy Roberts <a href="https://zulip-archive.rust-lang.org/stream/122651-general/topic/Q.3A.20do.20extern.20function.20pointers.20ignore.20the.20specified.20abi.3F.html#258311023">(Oct 20 2021 at 04:34)</a>:</h4>
<p>To clarify, the function pointers in question point to functions provided by the UEFI firmware implementation, which in this test is OVMF, written in C and supposedly following the "win64" abi. The rust target is "x86_64-unknown-uefi".</p>



<a name="258314754"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122651-general/topic/Q%3A%20do%20extern%20function%20pointers%20ignore%20the%20specified%20abi%3F/near/258314754" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lokathor <a href="https://zulip-archive.rust-lang.org/stream/122651-general/topic/Q.3A.20do.20extern.20function.20pointers.20ignore.20the.20specified.20abi.3F.html#258314754">(Oct 20 2021 at 05:32)</a>:</h4>
<p>Without knowing the precise details of the ABI, it's entirely <em>possible</em> that for the arguments and return type that you're using the ABIs are effectively identical and so you won't see problems.</p>



<a name="258320289"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122651-general/topic/Q%3A%20do%20extern%20function%20pointers%20ignore%20the%20specified%20abi%3F/near/258320289" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Gary Guo <a href="https://zulip-archive.rust-lang.org/stream/122651-general/topic/Q.3A.20do.20extern.20function.20pointers.20ignore.20the.20specified.20abi.3F.html#258320289">(Oct 20 2021 at 06:51)</a>:</h4>
<p>On x86_64 there are sysv64 and win64 abi that are explicit, and the rest probably just follow target default, which is win64 on uefi platform.</p>



<a name="258325544"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122651-general/topic/Q%3A%20do%20extern%20function%20pointers%20ignore%20the%20specified%20abi%3F/near/258325544" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Josh Triplett <a href="https://zulip-archive.rust-lang.org/stream/122651-general/topic/Q.3A.20do.20extern.20function.20pointers.20ignore.20the.20specified.20abi.3F.html#258325544">(Oct 20 2021 at 07:42)</a>:</h4>
<p><span class="user-mention" data-user-id="451918">@Timothy Roberts</span> On the <code>x86_64-unknown-uefi</code> target, <code>extern "C"</code> should be the UEFI ABI.</p>



<hr><p>Last updated: Apr 12 2022 at 20:01 UTC</p>
</html>