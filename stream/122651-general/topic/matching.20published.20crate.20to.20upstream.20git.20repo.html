<html>
<head><meta charset="utf-8"><title>matching published crate to upstream git repo · general · Zulip Chat Archive</title></head>
<h2>Stream: <a href="https://zulip-archive.rust-lang.org/stream/122651-general/index.html">general</a></h2>
<h3>Topic: <a href="https://zulip-archive.rust-lang.org/stream/122651-general/topic/matching.20published.20crate.20to.20upstream.20git.20repo.html">matching published crate to upstream git repo</a></h3>

<hr>

<base href="https://rust-lang.zulipchat.com">

<head><link href="https://zulip-archive.rust-lang.org/style.css" rel="stylesheet"></head>

<a name="255828694"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122651-general/topic/matching%20published%20crate%20to%20upstream%20git%20repo/near/255828694" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Eric Seppanen <a href="https://zulip-archive.rust-lang.org/stream/122651-general/topic/matching.20published.20crate.20to.20upstream.20git.20repo.html#255828694">(Oct 02 2021 at 01:07)</a>:</h4>
<p>Hi everyone!</p>
<p>For the last few weeks I've been satisfying my own curiosity by investigating how easy or hard it is to match the published crate contents against the upstream git repo.  I had a lot of fun poking around and learned some interesting things... and I want to publish my commentary as a blog post, but I want to seek out some feedback first. I was wondering if anyone wanted to read the first draft and give me any feedback?</p>
<p>In particular, I don't want this to come across as a cheap hit on the team. I would like to be constructive and I'm looking for ways I could contribute to improving things, so if anything in this draft comes across as being too negative, please let me know and I'll try to rewrite it in a more constructive way.</p>
<p>I'm sure I'm far from the first person to wonder about this, but I haven't found much previous work in this area, so if anyone could give me pointers to past discussions or relevant issues I'd be happy to add links to those.</p>
<p>The draft is here: <a href="https://github.com/ericseppanen/crates_io_analyzer/blob/main/README.md">https://github.com/ericseppanen/crates_io_analyzer/blob/main/README.md</a></p>
<p>Feel free to reply in a here or via private message (or send me an email).  Thanks again for the great work!</p>



<a name="255834472"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122651-general/topic/matching%20published%20crate%20to%20upstream%20git%20repo/near/255834472" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Eh2406 <a href="https://zulip-archive.rust-lang.org/stream/122651-general/topic/matching.20published.20crate.20to.20upstream.20git.20repo.html#255834472">(Oct 02 2021 at 02:43)</a>:</h4>
<blockquote>
<p>The crate download doesn't contain a cryptographic signature;</p>
</blockquote>
<p>There is a hash stored in the index <a href="https://github.com/rust-lang/crates.io-index/blob/master/se/mv/semver#L42">https://github.com/rust-lang/crates.io-index/blob/master/se/mv/semver#L42</a>, and Cargo will check it when it is used to download a torball.</p>



<a name="255834632"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122651-general/topic/matching%20published%20crate%20to%20upstream%20git%20repo/near/255834632" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Eh2406 <a href="https://zulip-archive.rust-lang.org/stream/122651-general/topic/matching.20published.20crate.20to.20upstream.20git.20repo.html#255834632">(Oct 02 2021 at 02:45)</a>:</h4>
<blockquote>
<p>What is interesting is that most crates</p>
</blockquote>
<p>This was added to Cargo, so it is all crates published with a at all up to date Cargo.</p>



<a name="255834822"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122651-general/topic/matching%20published%20crate%20to%20upstream%20git%20repo/near/255834822" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Eh2406 <a href="https://zulip-archive.rust-lang.org/stream/122651-general/topic/matching.20published.20crate.20to.20upstream.20git.20repo.html#255834822">(Oct 02 2021 at 02:48)</a>:</h4>
<p>oops you are right, I forget <code>--allow-dirty</code></p>



<a name="255835305"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122651-general/topic/matching%20published%20crate%20to%20upstream%20git%20repo/near/255835305" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Eric Seppanen <a href="https://zulip-archive.rust-lang.org/stream/122651-general/topic/matching.20published.20crate.20to.20upstream.20git.20repo.html#255835305">(Oct 02 2021 at 02:57)</a>:</h4>
<blockquote>
<p>There is a hash stored in the index <a href="https://github.com/rust-lang/crates.io-index/blob/master/se/mv/semver#L42">https://github.com/rust-lang/crates.io-index/blob/master/se/mv/semver#L42</a>, and Cargo will check it when it is used to download a torball.</p>
</blockquote>
<p>I didn't realize that, thanks!</p>



<a name="255835652"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122651-general/topic/matching%20published%20crate%20to%20upstream%20git%20repo/near/255835652" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Eh2406 <a href="https://zulip-archive.rust-lang.org/stream/122651-general/topic/matching.20published.20crate.20to.20upstream.20git.20repo.html#255835652">(Oct 02 2021 at 03:02)</a>:</h4>
<p>You may allso want to read <a href="https://internals.rust-lang.org/t/making-crates-io-verify-code-against-repository/14075">https://internals.rust-lang.org/t/making-crates-io-verify-code-against-repository/14075</a></p>



<a name="255835686"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122651-general/topic/matching%20published%20crate%20to%20upstream%20git%20repo/near/255835686" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Eh2406 <a href="https://zulip-archive.rust-lang.org/stream/122651-general/topic/matching.20published.20crate.20to.20upstream.20git.20repo.html#255835686">(Oct 02 2021 at 03:03)</a>:</h4>
<p>Over all I really like the blog post. Thank you for looking into the topic.</p>



<a name="255835781"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122651-general/topic/matching%20published%20crate%20to%20upstream%20git%20repo/near/255835781" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Eh2406 <a href="https://zulip-archive.rust-lang.org/stream/122651-general/topic/matching.20published.20crate.20to.20upstream.20git.20repo.html#255835781">(Oct 02 2021 at 03:05)</a>:</h4>
<blockquote>
<p>In particular, I don't want this to come across as a cheap hit on the team. </p>
</blockquote>
<p>I am only one person, and on the Cargo team not the <a href="http://Crates.io">Crates.io</a> team, but it did not seam accusatory to me.</p>



<a name="255835837"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122651-general/topic/matching%20published%20crate%20to%20upstream%20git%20repo/near/255835837" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Eric Seppanen <a href="https://zulip-archive.rust-lang.org/stream/122651-general/topic/matching.20published.20crate.20to.20upstream.20git.20repo.html#255835837">(Oct 02 2021 at 03:06)</a>:</h4>
<p>Thanks for the review and all the links, that's really useful information!</p>



<a name="255836184"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122651-general/topic/matching%20published%20crate%20to%20upstream%20git%20repo/near/255836184" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Eric Seppanen <a href="https://zulip-archive.rust-lang.org/stream/122651-general/topic/matching.20published.20crate.20to.20upstream.20git.20repo.html#255836184">(Oct 02 2021 at 03:13)</a>:</h4>
<p><del>What algorithm generated the <code>cksum</code> field in the crate index? After downloading semver-1.0.4.crate, I can't seem to reproduce that checksum?</del><br>
(Never mind, got tripped up by the fact that <code>cargo download semver &gt; semver.crate</code> somehow results in a truncated file. Something like <code>wget &lt;download-url&gt;</code> gives me the right contents.)</p>
<p>Is there an API endpoint to retrieve the hash of a particular crate/version? Is there an authoritative list of what API endpoints exist?</p>



<a name="255836860"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122651-general/topic/matching%20published%20crate%20to%20upstream%20git%20repo/near/255836860" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Eric Seppanen <a href="https://zulip-archive.rust-lang.org/stream/122651-general/topic/matching.20published.20crate.20to.20upstream.20git.20repo.html#255836860">(Oct 02 2021 at 03:26)</a>:</h4>
<p>Also, is there an accepted name for the tarball that <a href="http://crates.io">crates.io</a> delivers? I've been calling it the "code bundle" or "download package", and I should probably use more consistent terminology...</p>



<a name="255878035"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122651-general/topic/matching%20published%20crate%20to%20upstream%20git%20repo/near/255878035" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Eh2406 <a href="https://zulip-archive.rust-lang.org/stream/122651-general/topic/matching.20published.20crate.20to.20upstream.20git.20repo.html#255878035">(Oct 02 2021 at 15:20)</a>:</h4>
<p>Sorry went to bed.</p>
<blockquote>
<p>Is there an API endpoint to retrieve the hash of a particular crate/version?</p>
</blockquote>
<p>At this time, I don't think so. I think the authoritative source is the git index. Like, that is what Cargo uses.</p>
<blockquote>
<p>Is there an authoritative list of what API endpoints exist?</p>
</blockquote>
<p>That is up to the <a href="http://crates.io">crates.io</a> team, I don't off hand know. </p>
<blockquote>
<p>Also, is there an accepted name for the tarball that <a href="http://crates.io">crates.io</a> delivers?</p>
</blockquote>
<p>I thin the Cargo docs call it a "<code>.crate</code> file" <a href="https://doc.rust-lang.org/cargo/commands/cargo-package.html">here</a>, but <span class="user-mention" data-user-id="120518">@Eric Huss</span> would know if we have consistent terminology.</p>



<a name="255879085"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122651-general/topic/matching%20published%20crate%20to%20upstream%20git%20repo/near/255879085" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Eric Huss <a href="https://zulip-archive.rust-lang.org/stream/122651-general/topic/matching.20published.20crate.20to.20upstream.20git.20repo.html#255879085">(Oct 02 2021 at 15:40)</a>:</h4>
<blockquote>
<p>Is there an authoritative list of what API endpoints exist?</p>
</blockquote>
<p><a href="https://doc.rust-lang.org/cargo/reference/registries.html#web-api">https://doc.rust-lang.org/cargo/reference/registries.html#web-api</a> is the only formal documentation for API endpoints. The rest are intentionally not documented, as they don't have a particular commitment to being publicly used.</p>
<blockquote>
<p>is there an accepted name for the tarball that <a href="http://crates.io">crates.io</a> delivers?</p>
</blockquote>
<p>Yea, I just call it a <code>.crate</code> file.</p>



<a name="255879299"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122651-general/topic/matching%20published%20crate%20to%20upstream%20git%20repo/near/255879299" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Eric Huss <a href="https://zulip-archive.rust-lang.org/stream/122651-general/topic/matching.20published.20crate.20to.20upstream.20git.20repo.html#255879299">(Oct 02 2021 at 15:44)</a>:</h4>
<p>One minor issue, it's not super important, but I would consider maybe anonymizing the names of the packages you are highlighting.  People generally don't need to know specifically which packages have certain properties, and it could cause some unwanted headaches for those maintainers. If someone really wants to know, they can re-run your tool to analyze things.</p>



<a name="255977539"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122651-general/topic/matching%20published%20crate%20to%20upstream%20git%20repo/near/255977539" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Eric Seppanen <a href="https://zulip-archive.rust-lang.org/stream/122651-general/topic/matching.20published.20crate.20to.20upstream.20git.20repo.html#255977539">(Oct 03 2021 at 20:29)</a>:</h4>
<p>Article published! Thanks everyone for the feedback!<br>
<a href="https://codeandbitters.com/published-crate-analysis/">https://codeandbitters.com/published-crate-analysis/</a></p>



<hr><p>Last updated: Apr 12 2022 at 20:01 UTC</p>
</html>