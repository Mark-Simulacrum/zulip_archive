<html>
<head><meta charset="utf-8"><title>rustc compile error only when using `cargo doc`? · general · Zulip Chat Archive</title></head>
<h2>Stream: <a href="https://zulip-archive.rust-lang.org/stream/122651-general/index.html">general</a></h2>
<h3>Topic: <a href="https://zulip-archive.rust-lang.org/stream/122651-general/topic/rustc.20compile.20error.20only.20when.20using.20.60cargo.20doc.60.3F.html">rustc compile error only when using `cargo doc`?</a></h3>

<hr>

<base href="https://rust-lang.zulipchat.com">

<head><link href="https://zulip-archive.rust-lang.org/style.css" rel="stylesheet"></head>

<a name="277075105"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122651-general/topic/rustc%20compile%20error%20only%20when%20using%20%60cargo%20doc%60%3F/near/277075105" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Darrow O&#x27;Lykos [Rust Philly] <a href="https://zulip-archive.rust-lang.org/stream/122651-general/topic/rustc.20compile.20error.20only.20when.20using.20.60cargo.20doc.60.3F.html#277075105">(Mar 29 2022 at 22:55)</a>:</h4>
<p>Looking to see if anyone has ran into a similar issue: While my <code>cargo build</code> succeeds, I have a particular <code>cargo doc</code> command, that when I run, it fails to import something that definitely exists with a <code>rustc --explain E0432</code> error. The command I'm running looks like: <code>cargo doc -p rome_formatter --no-deps --open</code></p>
<p>(E0432 is the error people run into when they switch from edition <code>2018</code> back to <code>2015</code> and suddenly need to add <code>extern crate</code> before <code>use</code>. However, in my workspace, my crates's <code>Cargo.toml</code>'s all specify edition <code>2021</code> so I'm not even sure how to go about troubleshooting this.</p>
<p>Note: vscode code navigation works, the imports are there, and <code>cargo build</code> succeeds, and I'm using <code>rustc 1.59.0 (9d1b2106e 2022-02-23)</code></p>
<p>Any thoughts/recs would be greatly appreciated, thank you for your time!</p>
<p>Repo: <a href="https://github.com/RustPhilly/tools/tree/feature/format-jsx-element">https://github.com/RustPhilly/tools/tree/feature/format-jsx-element</a></p>



<a name="277075979"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122651-general/topic/rustc%20compile%20error%20only%20when%20using%20%60cargo%20doc%60%3F/near/277075979" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Nelson <a href="https://zulip-archive.rust-lang.org/stream/122651-general/topic/rustc.20compile.20error.20only.20when.20using.20.60cargo.20doc.60.3F.html#277075979">(Mar 29 2022 at 23:07)</a>:</h4>
<p>what is the error?</p>



<a name="277076038"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122651-general/topic/rustc%20compile%20error%20only%20when%20using%20%60cargo%20doc%60%3F/near/277076038" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Nelson <a href="https://zulip-archive.rust-lang.org/stream/122651-general/topic/rustc.20compile.20error.20only.20when.20using.20.60cargo.20doc.60.3F.html#277076038">(Mar 29 2022 at 23:08)</a>:</h4>
<p>in general the code rustdoc sees is not necessarily the same rustc sees because of <code>cfg(doc)</code></p>



<a name="277079347"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122651-general/topic/rustc%20compile%20error%20only%20when%20using%20%60cargo%20doc%60%3F/near/277079347" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Darrow O&#x27;Lykos [Rust Philly] <a href="https://zulip-archive.rust-lang.org/stream/122651-general/topic/rustc.20compile.20error.20only.20when.20using.20.60cargo.20doc.60.3F.html#277079347">(Mar 29 2022 at 23:56)</a>:</h4>
<p>Hi Josh, this is the error:</p>
<div class="codehilite" data-code-language="Rust"><pre><span></span><code><span class="n">cargo</span><span class="w"> </span><span class="n">doc</span><span class="w"> </span><span class="o">-</span><span class="n">p</span><span class="w"> </span><span class="n">rome_formatter</span><span class="w"> </span><span class="o">--</span><span class="n">no</span><span class="o">-</span><span class="n">deps</span><span class="w"> </span><span class="o">--</span><span class="n">open</span><span class="w"></span>
<span class="w">    </span><span class="n">Checking</span><span class="w"> </span><span class="n">rome_js_syntax</span><span class="w"> </span><span class="n">v0</span><span class="p">.</span><span class="mf">1.4</span><span class="w"> </span><span class="p">(</span><span class="o">/</span><span class="n">Users</span><span class="o">/</span><span class="n">yeeter</span><span class="o">/</span><span class="n">projects</span><span class="o">/</span><span class="n">github</span><span class="p">.</span><span class="n">com</span><span class="o">/</span><span class="n">organizations</span><span class="o">/</span><span class="n">rust</span><span class="o">-</span><span class="n">philly</span><span class="o">/</span><span class="n">tools</span><span class="o">/</span><span class="n">crates</span><span class="o">/</span><span class="n">rome_js_syntax</span><span class="p">)</span><span class="w"></span>
<span class="n">error</span><span class="p">[</span><span class="n">E0432</span><span class="p">]</span>: <span class="nc">unresolved</span><span class="w"> </span><span class="n">import</span><span class="w"> </span><span class="err">`</span><span class="n">rome_rowan</span>::<span class="n">api</span>::<span class="n">TriviaPieceKind</span><span class="err">`</span><span class="w"></span>
<span class="w">  </span><span class="o">-</span>-&gt; <span class="nc">crates</span><span class="o">/</span><span class="n">rome_js_syntax</span><span class="o">/</span><span class="n">src</span><span class="o">/</span><span class="n">lib</span><span class="p">.</span><span class="n">rs</span>:<span class="mi">20</span>:<span class="mi">5</span><span class="w"></span>
<span class="w">   </span><span class="o">|</span><span class="w"></span>
<span class="mi">20</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="k">use</span><span class="w"> </span><span class="n">rome_rowan</span>::<span class="n">api</span>::<span class="n">TriviaPieceKind</span><span class="p">;</span><span class="w"></span>
<span class="w">   </span><span class="o">|</span><span class="w">     </span><span class="o">^^^^^^^^^^^^^^^^^---------------</span><span class="w"></span>
<span class="w">   </span><span class="o">|</span><span class="w">     </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w"></span>
<span class="w">   </span><span class="o">|</span><span class="w">     </span><span class="o">|</span><span class="w">                </span><span class="n">help</span>: <span class="nc">a</span><span class="w"> </span><span class="n">similar</span><span class="w"> </span><span class="n">name</span><span class="w"> </span><span class="n">exists</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">module</span>: <span class="err">`</span><span class="n">TriviaPiece</span><span class="err">`</span><span class="w"></span>
<span class="w">   </span><span class="o">|</span><span class="w">     </span><span class="n">no</span><span class="w"> </span><span class="err">`</span><span class="n">TriviaPieceKind</span><span class="err">`</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="err">`</span><span class="n">api</span><span class="err">`</span><span class="w"></span>

<span class="n">For</span><span class="w"> </span><span class="n">more</span><span class="w"> </span><span class="n">information</span><span class="w"> </span><span class="n">about</span><span class="w"> </span><span class="n">this</span><span class="w"> </span><span class="n">error</span><span class="p">,</span><span class="w"> </span><span class="kr">try</span><span class="w"> </span><span class="err">`</span><span class="n">rustc</span><span class="w"> </span><span class="o">--</span><span class="n">explain</span><span class="w"> </span><span class="n">E0432</span><span class="err">`</span><span class="p">.</span><span class="w"></span>
<span class="n">error</span>: <span class="nc">could</span><span class="w"> </span><span class="n">not</span><span class="w"> </span><span class="n">compile</span><span class="w"> </span><span class="err">`</span><span class="n">rome_js_syntax</span><span class="err">`</span><span class="w"> </span><span class="n">due</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">previous</span><span class="w"> </span><span class="n">error</span><span class="w"></span>
</code></pre></div>
<p>Do you mean that there is a <code>rustdoc</code> error somewhere that is different than this <code>rustc</code> error?, Or did you just want to see the full text of the error I was referencing?</p>
<p>Thank you!</p>



<a name="277079725"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122651-general/topic/rustc%20compile%20error%20only%20when%20using%20%60cargo%20doc%60%3F/near/277079725" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Darrow O&#x27;Lykos [Rust Philly] <a href="https://zulip-archive.rust-lang.org/stream/122651-general/topic/rustc.20compile.20error.20only.20when.20using.20.60cargo.20doc.60.3F.html#277079725">(Mar 30 2022 at 00:01)</a>:</h4>
<p><a href="/user_uploads/4715/6GJFWrCeRa1K0OlrPSPAKrBP/Screen-Shot-2022-03-29-at-7.57.54-PM.png">Screen-Shot-2022-03-29-at-7.57.54-PM.png</a> </p>
<div class="message_inline_image"><a href="/user_uploads/4715/6GJFWrCeRa1K0OlrPSPAKrBP/Screen-Shot-2022-03-29-at-7.57.54-PM.png" title="Screen-Shot-2022-03-29-at-7.57.54-PM.png"><img src="/user_uploads/4715/6GJFWrCeRa1K0OlrPSPAKrBP/Screen-Shot-2022-03-29-at-7.57.54-PM.png"></a></div><ul>
<li>
<p>As seen in this snippet, vscode can find the import OK. <br>
-<code>cargo build</code> has no errors.</p>
</li>
<li>
<p><code>edition="2021"</code> is specified in both <code>Cargo.toml</code>s in <code>rome_js_syntax</code> crate <code>rome_rowan</code>.</p>
</li>
</ul>



<hr><p>Last updated: Apr 12 2022 at 20:01 UTC</p>
</html>