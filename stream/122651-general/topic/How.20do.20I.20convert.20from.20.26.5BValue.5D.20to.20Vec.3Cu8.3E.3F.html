<html>
<head><meta charset="utf-8"><title>How do I convert from &amp;[Value] to Vec&lt;u8&gt;? · general · Zulip Chat Archive</title></head>
<h2>Stream: <a href="https://zulip-archive.rust-lang.org/stream/122651-general/index.html">general</a></h2>
<h3>Topic: <a href="https://zulip-archive.rust-lang.org/stream/122651-general/topic/How.20do.20I.20convert.20from.20.26.5BValue.5D.20to.20Vec.3Cu8.3E.3F.html">How do I convert from &amp;[Value] to Vec&lt;u8&gt;?</a></h3>

<hr>

<base href="https://rust-lang.zulipchat.com">

<head><link href="https://zulip-archive.rust-lang.org/style.css" rel="stylesheet"></head>

<a name="261782243"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122651-general/topic/How%20do%20I%20convert%20from%20%26%5BValue%5D%20to%20Vec%3Cu8%3E%3F/near/261782243" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mark Windrim <a href="https://zulip-archive.rust-lang.org/stream/122651-general/topic/How.20do.20I.20convert.20from.20.26.5BValue.5D.20to.20Vec.3Cu8.3E.3F.html#261782243">(Nov 17 2021 at 13:18)</a>:</h4>
<p>Hi,</p>
<p>I have a rust process on one host that uses Faktory queues (via Faktory-rs).  The data on the Producer has data passed in as Vec&lt;u8&gt;, but when the data is processed through the Consumer, I end up with data as &amp;[Value].    I'm trying to convert back to Vec&lt;u8&gt; but nothing has worked thus far.  I've been trying to use serde_json::from_value by iterating over the data, but that isn't working either.  I suspect there is probably an easier way to do this.  Anyone have any ideas?</p>



<a name="261782465"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122651-general/topic/How%20do%20I%20convert%20from%20%26%5BValue%5D%20to%20Vec%3Cu8%3E%3F/near/261782465" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> The 8472 <a href="https://zulip-archive.rust-lang.org/stream/122651-general/topic/How.20do.20I.20convert.20from.20.26.5BValue.5D.20to.20Vec.3Cu8.3E.3F.html#261782465">(Nov 17 2021 at 13:20)</a>:</h4>
<p>well, what's the binary data supposed to look like? you mention json... but is it a json array or newline separated json objects or ...?</p>



<a name="261783247"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122651-general/topic/How%20do%20I%20convert%20from%20%26%5BValue%5D%20to%20Vec%3Cu8%3E%3F/near/261783247" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mark Windrim <a href="https://zulip-archive.rust-lang.org/stream/122651-general/topic/How.20do.20I.20convert.20from.20.26.5BValue.5D.20to.20Vec.3Cu8.3E.3F.html#261783247">(Nov 17 2021 at 13:27)</a>:</h4>
<p>Example, if I'm trying to send [1,2,3,4], I'll receive [Number(1), Number(2), Number(3), Number(4)].</p>



<a name="261783374"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122651-general/topic/How%20do%20I%20convert%20from%20%26%5BValue%5D%20to%20Vec%3Cu8%3E%3F/near/261783374" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mark Windrim <a href="https://zulip-archive.rust-lang.org/stream/122651-general/topic/How.20do.20I.20convert.20from.20.26.5BValue.5D.20to.20Vec.3Cu8.3E.3F.html#261783374">(Nov 17 2021 at 13:28)</a>:</h4>
<p>If I send ["t"], I'll receive [String("t")]</p>



<a name="261784072"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122651-general/topic/How%20do%20I%20convert%20from%20%26%5BValue%5D%20to%20Vec%3Cu8%3E%3F/near/261784072" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> The 8472 <a href="https://zulip-archive.rust-lang.org/stream/122651-general/topic/How.20do.20I.20convert.20from.20.26.5BValue.5D.20to.20Vec.3Cu8.3E.3F.html#261784072">(Nov 17 2021 at 13:34)</a>:</h4>
<p>tried <code>serde_json::to_vec</code>?</p>



<a name="261787871"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122651-general/topic/How%20do%20I%20convert%20from%20%26%5BValue%5D%20to%20Vec%3Cu8%3E%3F/near/261787871" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mark Windrim <a href="https://zulip-archive.rust-lang.org/stream/122651-general/topic/How.20do.20I.20convert.20from.20.26.5BValue.5D.20to.20Vec.3Cu8.3E.3F.html#261787871">(Nov 17 2021 at 14:05)</a>:</h4>
<p>Yeah, I had tried that.  I  thought it looked like the solution, but it ended up mangling things even worse.  I'll get you the results in a moment.</p>



<a name="261790551"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122651-general/topic/How%20do%20I%20convert%20from%20%26%5BValue%5D%20to%20Vec%3Cu8%3E%3F/near/261790551" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mark Windrim <a href="https://zulip-archive.rust-lang.org/stream/122651-general/topic/How.20do.20I.20convert.20from.20.26.5BValue.5D.20to.20Vec.3Cu8.3E.3F.html#261790551">(Nov 17 2021 at 14:24)</a>:</h4>
<p>I'm submitting vec![1,2,3,4].<br>
I receive [Number(1), Number(2), Number(3), Number(4)]</p>
<p>If I then use serde_json::to_vec, I get:  [91, 49, 44, 50, 44, 51, 44, 52, 93]</p>



<a name="261790923"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122651-general/topic/How%20do%20I%20convert%20from%20%26%5BValue%5D%20to%20Vec%3Cu8%3E%3F/near/261790923" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mark Windrim <a href="https://zulip-archive.rust-lang.org/stream/122651-general/topic/How.20do.20I.20convert.20from.20.26.5BValue.5D.20to.20Vec.3Cu8.3E.3F.html#261790923">(Nov 17 2021 at 14:26)</a>:</h4>
<p>Which appears to be an array of "[ 1 comma 2 comma 3 comma 4 ]"</p>



<a name="261794086"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122651-general/topic/How%20do%20I%20convert%20from%20%26%5BValue%5D%20to%20Vec%3Cu8%3E%3F/near/261794086" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> The 8472 <a href="https://zulip-archive.rust-lang.org/stream/122651-general/topic/How.20do.20I.20convert.20from.20.26.5BValue.5D.20to.20Vec.3Cu8.3E.3F.html#261794086">(Nov 17 2021 at 14:49)</a>:</h4>
<p>You might need <code>to_vec(Value::Array(values))</code> or a custom struct with derived <code>Serialize</code> containing that slice (saves the allocation for converting to vec).</p>



<a name="261843699"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122651-general/topic/How%20do%20I%20convert%20from%20%26%5BValue%5D%20to%20Vec%3Cu8%3E%3F/near/261843699" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mark Windrim <a href="https://zulip-archive.rust-lang.org/stream/122651-general/topic/How.20do.20I.20convert.20from.20.26.5BValue.5D.20to.20Vec.3Cu8.3E.3F.html#261843699">(Nov 17 2021 at 20:26)</a>:</h4>
<p>I did resolve this.  On the producer, I used <code>serde_json::to_value(array).unwrap()</code> and on the consumer <code>serde_json::from_value(job).unwrap()</code></p>



<a name="261843742"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122651-general/topic/How%20do%20I%20convert%20from%20%26%5BValue%5D%20to%20Vec%3Cu8%3E%3F/near/261843742" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mark Windrim <a href="https://zulip-archive.rust-lang.org/stream/122651-general/topic/How.20do.20I.20convert.20from.20.26.5BValue.5D.20to.20Vec.3Cu8.3E.3F.html#261843742">(Nov 17 2021 at 20:26)</a>:</h4>
<p>Thanks for all your help, btw.</p>



<hr><p>Last updated: Apr 12 2022 at 20:01 UTC</p>
</html>