<html>
<head><meta charset="utf-8"><title>Is this function impossible to call? · general · Zulip Chat Archive</title></head>
<h2>Stream: <a href="https://zulip-archive.rust-lang.org/stream/122651-general/index.html">general</a></h2>
<h3>Topic: <a href="https://zulip-archive.rust-lang.org/stream/122651-general/topic/Is.20this.20function.20impossible.20to.20call.3F.html">Is this function impossible to call?</a></h3>

<hr>

<base href="https://rust-lang.zulipchat.com">

<head><link href="https://zulip-archive.rust-lang.org/style.css" rel="stylesheet"></head>

<a name="266293559"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122651-general/topic/Is%20this%20function%20impossible%20to%20call%3F/near/266293559" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Nick12 <a href="https://zulip-archive.rust-lang.org/stream/122651-general/topic/Is.20this.20function.20impossible.20to.20call.3F.html#266293559">(Dec 28 2021 at 21:20)</a>:</h4>
<p>playground link: <a href="https://play.rust-lang.org/?version=stable&amp;mode=debug&amp;edition=2021&amp;gist=04bb104a11cbe012e3a59f9635d37a07">https://play.rust-lang.org/?version=stable&amp;mode=debug&amp;edition=2021&amp;gist=04bb104a11cbe012e3a59f9635d37a07</a></p>
<div class="codehilite" data-code-language="Rust"><pre><span></span><code><span class="k">fn</span> <span class="nf">f</span><span class="o">&lt;</span><span class="k">const</span><span class="w"> </span><span class="n">X</span>: <span class="kt">usize</span><span class="o">&gt;</span><span class="p">(</span><span class="w"></span>
<span class="w">    </span><span class="n">x</span>: <span class="nc">impl</span><span class="w"> </span><span class="nb">Into</span><span class="o">&lt;</span><span class="kt">usize</span><span class="o">&gt;</span><span class="p">,</span><span class="w"></span>
<span class="p">)</span><span class="w"> </span>-&gt; <span class="kt">usize</span> <span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="n">X</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">x</span><span class="p">.</span><span class="n">into</span><span class="p">()</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="k">fn</span> <span class="nf">main</span><span class="p">()</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="c1">// error[E0632]: cannot provide explicit generic arguments when `impl Trait` is used in argument position</span>
<span class="w">    </span><span class="c1">//assert_eq!(3, f::&lt;1&gt;(2));</span>

<span class="w">    </span><span class="c1">// error[E0282]: type annotations needed</span>
<span class="w">    </span><span class="c1">// assert_eq!(3, f(2usize));</span>
<span class="p">}</span><span class="w"></span>
</code></pre></div>
<p>If it is indeed impossible to call, should this be linted by rustc?</p>
<p>I ran into this when trying to add Into&lt;T&gt; to parameters in a function with const generic arguments (Example <a href="https://play.rust-lang.org/?version=stable&amp;mode=debug&amp;edition=2021&amp;gist=e60d14fbe18eea4e02bbe84816a1fec5">https://play.rust-lang.org/?version=stable&amp;mode=debug&amp;edition=2021&amp;gist=e60d14fbe18eea4e02bbe84816a1fec5</a> ). Having to add an underscore for each parameter is a lot of noise so I tried to remove it with impl T</p>



<a name="266298356"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122651-general/topic/Is%20this%20function%20impossible%20to%20call%3F/near/266298356" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jacob Pratt <a href="https://zulip-archive.rust-lang.org/stream/122651-general/topic/Is.20this.20function.20impossible.20to.20call.3F.html#266298356">(Dec 28 2021 at 22:30)</a>:</h4>
<p>I'm on mobile now, but it will be permitted in the future to call with an explicit value provided. Iirc it's implemented and unstable. The latter call I'm not sure is intended to ever succeed.</p>



<a name="266299513"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122651-general/topic/Is%20this%20function%20impossible%20to%20call%3F/near/266299513" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Nick12 <a href="https://zulip-archive.rust-lang.org/stream/122651-general/topic/Is.20this.20function.20impossible.20to.20call.3F.html#266299513">(Dec 28 2021 at 22:52)</a>:</h4>
<p>oh, that makes sense. Thanks!<br>
I just found it a bit odd that I could define an uncallable function</p>



<a name="266307175"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122651-general/topic/Is%20this%20function%20impossible%20to%20call%3F/near/266307175" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Noah Lev <a href="https://zulip-archive.rust-lang.org/stream/122651-general/topic/Is.20this.20function.20impossible.20to.20call.3F.html#266307175">(Dec 29 2021 at 01:25)</a>:</h4>
<p>To be pedantic, there are other ways to define uncallable functions:</p>
<div class="codehilite" data-code-language="Rust"><pre><span></span><code><span class="cp">#![feature(adt_const_params)]</span><span class="w"></span>
<span class="cp">#![feature(never_type)]</span><span class="w"></span>

<span class="k">fn</span> <span class="nf">uncallable</span><span class="o">&lt;</span><span class="k">const</span><span class="w"> </span><span class="n">_X</span>: <span class="o">!&gt;</span><span class="p">()</span><span class="w"> </span><span class="p">{}</span><span class="w"></span>

<span class="k">fn</span> <span class="nf">main</span><span class="p">()</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="n">uncallable</span><span class="p">();</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>
</code></pre></div>
<div class="codehilite"><pre><span></span><code>error[E0282]: type annotations needed
 --&gt; src/main.rs:7:5
  |
7 |     uncallable();
  |     ^^^^^^^^^^ cannot infer the value of const parameter `_X` declared on the function `uncallable`
  |
help: consider specifying the const argument
  |
7 |     uncallable::&lt;_X&gt;();
  |     ~~~~~~~~~~~~~~~~
</code></pre></div>
<p>But I agree that it'd be good for functions like yours to be callable.</p>



<a name="266307399"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122651-general/topic/Is%20this%20function%20impossible%20to%20call%3F/near/266307399" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Patrick Poitras <a href="https://zulip-archive.rust-lang.org/stream/122651-general/topic/Is.20this.20function.20impossible.20to.20call.3F.html#266307399">(Dec 29 2021 at 01:29)</a>:</h4>
<p>Is there a special object of type <code>!</code>, or is this type specifically never creatable even as far as the compiler is involved?</p>



<a name="266307541"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122651-general/topic/Is%20this%20function%20impossible%20to%20call%3F/near/266307541" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Noah Lev <a href="https://zulip-archive.rust-lang.org/stream/122651-general/topic/Is.20this.20function.20impossible.20to.20call.3F.html#266307541">(Dec 29 2021 at 01:31)</a>:</h4>
<p><code>!</code> is the never type, which is supposed to be impossible to construct; in other words, if there were a special value of type <code>!</code>, it would break the language :)</p>



<a name="266307604"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122651-general/topic/Is%20this%20function%20impossible%20to%20call%3F/near/266307604" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Noah Lev <a href="https://zulip-archive.rust-lang.org/stream/122651-general/topic/Is.20this.20function.20impossible.20to.20call.3F.html#266307604">(Dec 29 2021 at 01:32)</a>:</h4>
<p>It is possible to have a function return the <code>!</code> type, which signifies the function will never return. E.g.:</p>
<div class="codehilite" data-code-language="Rust"><pre><span></span><code><span class="k">fn</span> <span class="nf">f</span><span class="p">()</span><span class="w"> </span>-&gt; <span class="o">!</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="fm">panic!</span><span class="p">()</span><span class="w"> </span><span class="p">}</span><span class="w"></span>
</code></pre></div>
<p>or</p>
<div class="codehilite" data-code-language="Rust"><pre><span></span><code><span class="k">fn</span> <span class="nf">g</span><span class="p">()</span><span class="w"> </span>-&gt; <span class="o">!</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="k">loop</span><span class="w"> </span><span class="p">{}</span><span class="w"> </span><span class="p">}</span><span class="w"></span>
</code></pre></div>
<p>are allowed because they never return.</p>



<a name="266307827"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122651-general/topic/Is%20this%20function%20impossible%20to%20call%3F/near/266307827" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Patrick Poitras <a href="https://zulip-archive.rust-lang.org/stream/122651-general/topic/Is.20this.20function.20impossible.20to.20call.3F.html#266307827">(Dec 29 2021 at 01:37)</a>:</h4>
<p>Does the never type provide for a sort of <code>unreachable_unchecked</code>-type culling of code?</p>



<a name="266308207"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122651-general/topic/Is%20this%20function%20impossible%20to%20call%3F/near/266308207" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Michael Goulet <a href="https://zulip-archive.rust-lang.org/stream/122651-general/topic/Is.20this.20function.20impossible.20to.20call.3F.html#266308207">(Dec 29 2021 at 01:44)</a>:</h4>
<p>Indeed it does. Check out the LLVM for <a href="https://play.rust-lang.org/?version=stable&amp;mode=debug&amp;edition=2021&amp;gist=41ef093bdb17b152b317bc2deef5f6f0">https://play.rust-lang.org/?version=stable&amp;mode=debug&amp;edition=2021&amp;gist=41ef093bdb17b152b317bc2deef5f6f0</a></p>



<a name="266308994"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122651-general/topic/Is%20this%20function%20impossible%20to%20call%3F/near/266308994" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Noah Lev <a href="https://zulip-archive.rust-lang.org/stream/122651-general/topic/Is.20this.20function.20impossible.20to.20call.3F.html#266308994">(Dec 29 2021 at 01:56)</a>:</h4>
<p>In fact, you'll find that <code>unreachable_unchecked</code> <a href="https://doc.rust-lang.org/nightly/std/hint/fn.unreachable_unchecked.html">returns</a> the never type ;)</p>



<a name="266309036"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122651-general/topic/Is%20this%20function%20impossible%20to%20call%3F/near/266309036" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Noah Lev <a href="https://zulip-archive.rust-lang.org/stream/122651-general/topic/Is.20this.20function.20impossible.20to.20call.3F.html#266309036">(Dec 29 2021 at 01:57)</a>:</h4>
<p>I believe the never type is actually the <em>source</em> of <code>unreachable_unchecked</code>'s optimizations, though I'm not absolutely certain.</p>



<a name="267633249"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122651-general/topic/Is%20this%20function%20impossible%20to%20call%3F/near/267633249" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> scottmcm <a href="https://zulip-archive.rust-lang.org/stream/122651-general/topic/Is.20this.20function.20impossible.20to.20call.3F.html#267633249">(Jan 11 2022 at 19:33)</a>:</h4>
<p><span class="user-mention silent" data-user-id="307537">Noah Lev</span> <a href="#narrow/stream/122651-general/topic/Is.20this.20function.20impossible.20to.20call.3F/near/266309036">said</a>:</p>
<blockquote>
<p>I believe the never type is actually the <em>source</em> of <code>unreachable_unchecked</code>'s optimizations, though I'm not absolutely certain.</p>
</blockquote>
<p>Well, that also produces &lt;<a href="https://llvm.org/docs/LangRef.html#unreachable-instruction">https://llvm.org/docs/LangRef.html#unreachable-instruction</a>&gt; (perhaps via &lt;<a href="https://doc.rust-lang.org/nightly/nightly-rustc/rustc_middle/mir/terminator/enum.TerminatorKind.html#variant.Unreachable">https://doc.rust-lang.org/nightly/nightly-rustc/rustc_middle/mir/terminator/enum.TerminatorKind.html#variant.Unreachable</a>&gt;?) which makes the optimizations more direct than just being an uninhabited type.</p>



<hr><p>Last updated: Apr 12 2022 at 20:01 UTC</p>
</html>