<html>
<head><meta charset="utf-8"><title>x.py check: each crate shown twice in progress bar · general · Zulip Chat Archive</title></head>
<h2>Stream: <a href="https://zulip-archive.rust-lang.org/stream/122651-general/index.html">general</a></h2>
<h3>Topic: <a href="https://zulip-archive.rust-lang.org/stream/122651-general/topic/x.2Epy.20check.3A.20each.20crate.20shown.20twice.20in.20progress.20bar.html">x.py check: each crate shown twice in progress bar</a></h3>

<hr>

<base href="https://rust-lang.zulipchat.com">

<head><link href="https://zulip-archive.rust-lang.org/style.css" rel="stylesheet"></head>

<a name="252920053"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122651-general/topic/x.py%20check%3A%20each%20crate%20shown%20twice%20in%20progress%20bar/near/252920053" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> RalfJ <a href="https://zulip-archive.rust-lang.org/stream/122651-general/topic/x.2Epy.20check.3A.20each.20crate.20shown.20twice.20in.20progress.20bar.html#252920053">(Sep 11 2021 at 16:27)</a>:</h4>
<p>I havent built rustc in a few weeks, and noticed an odd change in the output today when I did <code>x.py check compiler/rustc</code>:</p>
<div class="codehilite"><pre><span></span><code>Building [=======================&gt; ] 301/307: rustc_interface, rustc_interface
</code></pre></div>
<p>every crate seems to be shown twice like this. any idea what that is happening?</p>



<a name="252922514"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122651-general/topic/x.py%20check%3A%20each%20crate%20shown%20twice%20in%20progress%20bar/near/252922514" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Eric Huss <a href="https://zulip-archive.rust-lang.org/stream/122651-general/topic/x.2Epy.20check.3A.20each.20crate.20shown.20twice.20in.20progress.20bar.html#252922514">(Sep 11 2021 at 17:07)</a>:</h4>
<p><span class="user-mention" data-user-id="120791">@RalfJ</span> It is probably <a href="https://github.com/rust-lang/rust/issues/88011">#88011</a>.  It now uses <code>--all-targets</code> which means it is checking both the normal library, and the library-as-unittests.</p>



<a name="252922561"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122651-general/topic/x.py%20check%3A%20each%20crate%20shown%20twice%20in%20progress%20bar/near/252922561" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Nelson <a href="https://zulip-archive.rust-lang.org/stream/122651-general/topic/x.2Epy.20check.3A.20each.20crate.20shown.20twice.20in.20progress.20bar.html#252922561">(Sep 11 2021 at 17:08)</a>:</h4>
<p><span class="user-mention" data-user-id="120518">@Eric Huss</span> do you think cargo could show <code>rustc_interface (test)</code> for the second case?</p>



<a name="252922570"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122651-general/topic/x.py%20check%3A%20each%20crate%20shown%20twice%20in%20progress%20bar/near/252922570" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Nelson <a href="https://zulip-archive.rust-lang.org/stream/122651-general/topic/x.2Epy.20check.3A.20each.20crate.20shown.20twice.20in.20progress.20bar.html#252922570">(Sep 11 2021 at 17:08)</a>:</h4>
<p>I think it already shows <code>(doc)</code> in some cases</p>



<a name="252922682"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122651-general/topic/x.py%20check%3A%20each%20crate%20shown%20twice%20in%20progress%20bar/near/252922682" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Eric Huss <a href="https://zulip-archive.rust-lang.org/stream/122651-general/topic/x.2Epy.20check.3A.20each.20crate.20shown.20twice.20in.20progress.20bar.html#252922682">(Sep 11 2021 at 17:10)</a>:</h4>
<p>Yea, that sounds reasonable to me.  It can be a little tricky since there is very limited space.  The code is <a href="https://github.com/rust-lang/cargo/blob/2274489833256a979d98bc56633c8011c60df154/src/cargo/core/compiler/job_queue.rs#L999-L1016">here</a> if anyone is interested.</p>



<a name="252922727"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122651-general/topic/x.py%20check%3A%20each%20crate%20shown%20twice%20in%20progress%20bar/near/252922727" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Nelson <a href="https://zulip-archive.rust-lang.org/stream/122651-general/topic/x.2Epy.20check.3A.20each.20crate.20shown.20twice.20in.20progress.20bar.html#252922727">(Sep 11 2021 at 17:11)</a>:</h4>
<p>hmm, I would expect that to already be hit here? is there a special kind of <code>Lib</code> for tests? <a href="https://github.com/rust-lang/cargo/blob/2274489833256a979d98bc56633c8011c60df154/src/cargo/core/compiler/job_queue.rs#L1009">https://github.com/rust-lang/cargo/blob/2274489833256a979d98bc56633c8011c60df154/src/cargo/core/compiler/job_queue.rs#L1009</a></p>



<a name="252922842"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122651-general/topic/x.py%20check%3A%20each%20crate%20shown%20twice%20in%20progress%20bar/near/252922842" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Nelson <a href="https://zulip-archive.rust-lang.org/stream/122651-general/topic/x.2Epy.20check.3A.20each.20crate.20shown.20twice.20in.20progress.20bar.html#252922842">(Sep 11 2021 at 17:13)</a>:</h4>
<p>also, does cargo have its internal docs published somewhere? like what you would get from <code>cargo doc -p cargo --document-private-items</code></p>



<a name="252923966"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122651-general/topic/x.py%20check%3A%20each%20crate%20shown%20twice%20in%20progress%20bar/near/252923966" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Eric Huss <a href="https://zulip-archive.rust-lang.org/stream/122651-general/topic/x.2Epy.20check.3A.20each.20crate.20shown.20twice.20in.20progress.20bar.html#252923966">(Sep 11 2021 at 17:34)</a>:</h4>
<p>Yea, there are two variables here.  The <code>Target</code> is roughly equivalent to the root source file (<code>TargetKind::Test</code> here means an integration test).  The <code>CompileMode</code> is the mode the target is being built in (build, check, test, bench, doc, etc.).</p>



<a name="252923970"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122651-general/topic/x.py%20check%3A%20each%20crate%20shown%20twice%20in%20progress%20bar/near/252923970" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Eric Huss <a href="https://zulip-archive.rust-lang.org/stream/122651-general/topic/x.2Epy.20check.3A.20each.20crate.20shown.20twice.20in.20progress.20bar.html#252923970">(Sep 11 2021 at 17:34)</a>:</h4>
<p>I don't think the private docs are published anywhere.</p>



<a name="252923990"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122651-general/topic/x.py%20check%3A%20each%20crate%20shown%20twice%20in%20progress%20bar/near/252923990" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Nelson <a href="https://zulip-archive.rust-lang.org/stream/122651-general/topic/x.2Epy.20check.3A.20each.20crate.20shown.20twice.20in.20progress.20bar.html#252923990">(Sep 11 2021 at 17:35)</a>:</h4>
<p><span class="user-mention silent" data-user-id="120518">Eric Huss</span> <a href="#narrow/stream/122651-general/topic/x.2Epy.20check.3A.20each.20crate.20shown.20twice.20in.20progress.20bar/near/252923970">said</a>:</p>
<blockquote>
<p>I don't think the private docs are published anywhere.</p>
</blockquote>
<p>would you be ok with me adding them to nightly-rustc?</p>



<a name="252923998"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122651-general/topic/x.py%20check%3A%20each%20crate%20shown%20twice%20in%20progress%20bar/near/252923998" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Nelson <a href="https://zulip-archive.rust-lang.org/stream/122651-general/topic/x.2Epy.20check.3A.20each.20crate.20shown.20twice.20in.20progress.20bar.html#252923998">(Sep 11 2021 at 17:35)</a>:</h4>
<p>rustfmt is already there, I guess we may as well add clippy too while we're at it</p>



<a name="252924060"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122651-general/topic/x.py%20check%3A%20each%20crate%20shown%20twice%20in%20progress%20bar/near/252924060" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Eric Huss <a href="https://zulip-archive.rust-lang.org/stream/122651-general/topic/x.2Epy.20check.3A.20each.20crate.20shown.20twice.20in.20progress.20bar.html#252924060">(Sep 11 2021 at 17:36)</a>:</h4>
<p>If you'd like.  I'm not sure how much that'll pollute the search index, though.  I don't use those docs myself, so I'm probably the wrong person to ask.</p>



<a name="252924109"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122651-general/topic/x.py%20check%3A%20each%20crate%20shown%20twice%20in%20progress%20bar/near/252924109" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Nelson <a href="https://zulip-archive.rust-lang.org/stream/122651-general/topic/x.2Epy.20check.3A.20each.20crate.20shown.20twice.20in.20progress.20bar.html#252924109">(Sep 11 2021 at 17:37)</a>:</h4>
<p>hmm, ok. I wouldn't expect a _ton_ of noise from cargo, most of the functions are probably named differently since it doesn't deal with parsing at all</p>



<a name="252925090"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122651-general/topic/x.py%20check%3A%20each%20crate%20shown%20twice%20in%20progress%20bar/near/252925090" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> simulacrum <a href="https://zulip-archive.rust-lang.org/stream/122651-general/topic/x.2Epy.20check.3A.20each.20crate.20shown.20twice.20in.20progress.20bar.html#252925090">(Sep 11 2021 at 17:55)</a>:</h4>
<p>I don't think we should be adding them to nightly-rustc; that's likely to be confusing. I would not personally object to new /cargo/ with cargo docs, though (technically it need not be nightly-cargo, given that cargo is published to <a href="http://crates.io">crates.io</a>... but that's a separate conversation, in some sense).</p>



<a name="252925427"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122651-general/topic/x.py%20check%3A%20each%20crate%20shown%20twice%20in%20progress%20bar/near/252925427" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Nelson <a href="https://zulip-archive.rust-lang.org/stream/122651-general/topic/x.2Epy.20check.3A.20each.20crate.20shown.20twice.20in.20progress.20bar.html#252925427">(Sep 11 2021 at 18:01)</a>:</h4>
<p>opened <a href="https://github.com/rust-lang/rust/issues/88866">https://github.com/rust-lang/rust/issues/88866</a> (don't have time to work on it right now)</p>



<a name="252925487"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122651-general/topic/x.py%20check%3A%20each%20crate%20shown%20twice%20in%20progress%20bar/near/252925487" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Nelson <a href="https://zulip-archive.rust-lang.org/stream/122651-general/topic/x.2Epy.20check.3A.20each.20crate.20shown.20twice.20in.20progress.20bar.html#252925487">(Sep 11 2021 at 18:02)</a>:</h4>
<p>oh wait, /cargo/ already exists and has the cargo book: <a href="https://doc.rust-lang.org/cargo/">https://doc.rust-lang.org/cargo/</a></p>



<a name="252925493"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122651-general/topic/x.py%20check%3A%20each%20crate%20shown%20twice%20in%20progress%20bar/near/252925493" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Nelson <a href="https://zulip-archive.rust-lang.org/stream/122651-general/topic/x.2Epy.20check.3A.20each.20crate.20shown.20twice.20in.20progress.20bar.html#252925493">(Sep 11 2021 at 18:02)</a>:</h4>
<p>so maybe nightly-cargo is better after all?</p>



<a name="252925500"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122651-general/topic/x.py%20check%3A%20each%20crate%20shown%20twice%20in%20progress%20bar/near/252925500" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Nelson <a href="https://zulip-archive.rust-lang.org/stream/122651-general/topic/x.2Epy.20check.3A.20each.20crate.20shown.20twice.20in.20progress.20bar.html#252925500">(Sep 11 2021 at 18:02)</a>:</h4>
<p>or <code>cargo-internals</code>?</p>



<a name="252925631"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122651-general/topic/x.py%20check%3A%20each%20crate%20shown%20twice%20in%20progress%20bar/near/252925631" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> simulacrum <a href="https://zulip-archive.rust-lang.org/stream/122651-general/topic/x.2Epy.20check.3A.20each.20crate.20shown.20twice.20in.20progress.20bar.html#252925631">(Sep 11 2021 at 18:05)</a>:</h4>
<p>Hm. Well, it may also be worth considering that documenting cargo is pretty fast and not too hard for people to just locally do</p>



<a name="252925657"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122651-general/topic/x.py%20check%3A%20each%20crate%20shown%20twice%20in%20progress%20bar/near/252925657" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> simulacrum <a href="https://zulip-archive.rust-lang.org/stream/122651-general/topic/x.2Epy.20check.3A.20each.20crate.20shown.20twice.20in.20progress.20bar.html#252925657">(Sep 11 2021 at 18:06)</a>:</h4>
<p>Even with all the deps <code>cargo doc -p cargo --document-private-items</code> takes ~25 seconds for me</p>



<a name="252925718"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122651-general/topic/x.py%20check%3A%20each%20crate%20shown%20twice%20in%20progress%20bar/near/252925718" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> simulacrum <a href="https://zulip-archive.rust-lang.org/stream/122651-general/topic/x.2Epy.20check.3A.20each.20crate.20shown.20twice.20in.20progress.20bar.html#252925718">(Sep 11 2021 at 18:06)</a>:</h4>
<p>So it's not clear that we should be publishing them (and in the long run, if we do, we're likely to start considering publishing these docs for all the other crates in rust-lang/rust, which seems a bit much)</p>



<a name="252932939"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122651-general/topic/x.py%20check%3A%20each%20crate%20shown%20twice%20in%20progress%20bar/near/252932939" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> cjgillot <a href="https://zulip-archive.rust-lang.org/stream/122651-general/topic/x.2Epy.20check.3A.20each.20crate.20shown.20twice.20in.20progress.20bar.html#252932939">(Sep 11 2021 at 20:24)</a>:</h4>
<p><span class="user-mention silent" data-user-id="120518">Eric Huss</span> <a href="#narrow/stream/122651-general/topic/x.2Epy.20check.3A.20each.20crate.20shown.20twice.20in.20progress.20bar/near/252922514">said</a>:</p>
<blockquote>
<p><span class="user-mention silent" data-user-id="120791">RalfJ</span> It is probably <a href="https://github.com/rust-lang/rust/issues/88011">#88011</a>.  It now uses <code>--all-targets</code> which means it is checking both the normal library, and the library-as-unittests.</p>
</blockquote>
<p>Is it possible to opt-out? I don't have enough RAM to afford checking rustc_middle twice at a time.</p>



<a name="252933270"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122651-general/topic/x.py%20check%3A%20each%20crate%20shown%20twice%20in%20progress%20bar/near/252933270" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> simulacrum <a href="https://zulip-archive.rust-lang.org/stream/122651-general/topic/x.2Epy.20check.3A.20each.20crate.20shown.20twice.20in.20progress.20bar.html#252933270">(Sep 11 2021 at 20:29)</a>:</h4>
<p>Not currently, I didn't realize that was a strong impediment -- we should add an opt-out then.</p>



<a name="252989815"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122651-general/topic/x.py%20check%3A%20each%20crate%20shown%20twice%20in%20progress%20bar/near/252989815" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> simulacrum <a href="https://zulip-archive.rust-lang.org/stream/122651-general/topic/x.2Epy.20check.3A.20each.20crate.20shown.20twice.20in.20progress.20bar.html#252989815">(Sep 12 2021 at 14:19)</a>:</h4>
<p><span class="user-mention" data-user-id="248906">@cjgillot</span> can you share how much memory you have available? It looks like rustc_middle uses ~900 MB RSS right now for x.py check</p>



<a name="252990300"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122651-general/topic/x.py%20check%3A%20each%20crate%20shown%20twice%20in%20progress%20bar/near/252990300" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> cjgillot <a href="https://zulip-archive.rust-lang.org/stream/122651-general/topic/x.2Epy.20check.3A.20each.20crate.20shown.20twice.20in.20progress.20bar.html#252990300">(Sep 12 2021 at 14:27)</a>:</h4>
<p>I have 3.5 GB installed. I used to be able to run <code>x.py check</code> on two workspaces at a time.</p>



<a name="252990833"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122651-general/topic/x.py%20check%3A%20each%20crate%20shown%20twice%20in%20progress%20bar/near/252990833" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> simulacrum <a href="https://zulip-archive.rust-lang.org/stream/122651-general/topic/x.2Epy.20check.3A.20each.20crate.20shown.20twice.20in.20progress.20bar.html#252990833">(Sep 12 2021 at 14:35)</a>:</h4>
<p>Interesting, well, I do think the opt-out still makes sense</p>



<a name="252990842"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122651-general/topic/x.py%20check%3A%20each%20crate%20shown%20twice%20in%20progress%20bar/near/252990842" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> simulacrum <a href="https://zulip-archive.rust-lang.org/stream/122651-general/topic/x.2Epy.20check.3A.20each.20crate.20shown.20twice.20in.20progress.20bar.html#252990842">(Sep 12 2021 at 14:35)</a>:</h4>
<p>Are you running with incremental enabled by chance?</p>



<a name="252990895"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122651-general/topic/x.py%20check%3A%20each%20crate%20shown%20twice%20in%20progress%20bar/near/252990895" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> cjgillot <a href="https://zulip-archive.rust-lang.org/stream/122651-general/topic/x.2Epy.20check.3A.20each.20crate.20shown.20twice.20in.20progress.20bar.html#252990895">(Sep 12 2021 at 14:36)</a>:</h4>
<p>Yes.</p>



<a name="252991077"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122651-general/topic/x.py%20check%3A%20each%20crate%20shown%20twice%20in%20progress%20bar/near/252991077" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> simulacrum <a href="https://zulip-archive.rust-lang.org/stream/122651-general/topic/x.2Epy.20check.3A.20each.20crate.20shown.20twice.20in.20progress.20bar.html#252991077">(Sep 12 2021 at 14:39)</a>:</h4>
<p>Hm. I'm a little surprised a concurrent x.py check in two workspaces didn't hit the same problem for you, but regardless, we should add an opt-out as I said -- I was expecting much higher memory usage for rustc_middle compilation, tbh</p>



<a name="252991092"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122651-general/topic/x.py%20check%3A%20each%20crate%20shown%20twice%20in%20progress%20bar/near/252991092" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> simulacrum <a href="https://zulip-archive.rust-lang.org/stream/122651-general/topic/x.2Epy.20check.3A.20each.20crate.20shown.20twice.20in.20progress.20bar.html#252991092">(Sep 12 2021 at 14:39)</a>:</h4>
<p>looks like incremental uses ~955 MB, so only a little more.</p>



<a name="252991210"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122651-general/topic/x.py%20check%3A%20each%20crate%20shown%20twice%20in%20progress%20bar/near/252991210" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> cjgillot <a href="https://zulip-archive.rust-lang.org/stream/122651-general/topic/x.2Epy.20check.3A.20each.20crate.20shown.20twice.20in.20progress.20bar.html#252991210">(Sep 12 2021 at 14:41)</a>:</h4>
<p><span class="user-mention silent" data-user-id="116122">simulacrum</span> <a href="#narrow/stream/122651-general/topic/x.2Epy.20check.3A.20each.20crate.20shown.20twice.20in.20progress.20bar/near/252991077">said</a>:</p>
<blockquote>
<p>Hm. I'm a little surprised a concurrent x.py check in two workspaces didn't hit the same problem for you, but regardless, we should add an opt-out as I said -- I was expecting much higher memory usage for rustc_middle compilation, tbh</p>
</blockquote>
<p>I'm going from 2 rustc_middle (1 on each workspace) to 4 rustc_middle (2 on each).</p>



<a name="252991534"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122651-general/topic/x.py%20check%3A%20each%20crate%20shown%20twice%20in%20progress%20bar/near/252991534" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> simulacrum <a href="https://zulip-archive.rust-lang.org/stream/122651-general/topic/x.2Epy.20check.3A.20each.20crate.20shown.20twice.20in.20progress.20bar.html#252991534">(Sep 12 2021 at 14:46)</a>:</h4>
<p>Ah, I see, yeah, ok, that makes sense</p>



<hr><p>Last updated: Apr 12 2022 at 20:01 UTC</p>
</html>