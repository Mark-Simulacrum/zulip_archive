<html>
<head><meta charset="utf-8"><title>lifetime in Cow&lt;T&gt; · general · Zulip Chat Archive</title></head>
<h2>Stream: <a href="https://zulip-archive.rust-lang.org/stream/122651-general/index.html">general</a></h2>
<h3>Topic: <a href="https://zulip-archive.rust-lang.org/stream/122651-general/topic/lifetime.20in.20Cow.3CT.3E.html">lifetime in Cow&lt;T&gt;</a></h3>

<hr>

<base href="https://rust-lang.zulipchat.com">

<head><link href="https://zulip-archive.rust-lang.org/style.css" rel="stylesheet"></head>

<a name="269837078"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122651-general/topic/lifetime%20in%20Cow%3CT%3E/near/269837078" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> yingmanwumen <a href="https://zulip-archive.rust-lang.org/stream/122651-general/topic/lifetime.20in.20Cow.3CT.3E.html#269837078">(Jan 29 2022 at 04:21)</a>:</h4>
<p>The implementation of <code>Cow</code> is </p>
<div class="codehilite" data-code-language="Rust"><pre><span></span><code><span class="k">pub</span><span class="w"> </span><span class="k">enum</span> <span class="nc">Cow</span><span class="o">&lt;'</span><span class="na">a</span><span class="p">,</span><span class="w"> </span><span class="n">B</span><span class="o">&gt;</span><span class="w"></span>
<span class="k">where</span><span class="w"></span>
<span class="w">    </span><span class="n">B</span>: <span class="o">'</span><span class="na">a</span> <span class="o">+</span><span class="w"> </span><span class="nb">ToOwned</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="o">'</span><span class="na">a</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="o">?</span><span class="nb">Sized</span><span class="p">,</span><span class="w"></span>
<span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="n">Borrowed</span><span class="p">(</span><span class="o">&amp;'</span><span class="na">a</span><span class="w"> </span><span class="n">B</span><span class="p">),</span><span class="w">    </span><span class="c1">//用于包裹引用</span>
<span class="w">    </span><span class="n">Owned</span><span class="p">(</span><span class="o">&lt;</span><span class="n">B</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nb">ToOwned</span><span class="o">&gt;</span>::<span class="n">Owned</span><span class="p">),</span><span class="w">   </span><span class="c1">//用于包裹所有者</span>
<span class="p">}</span><span class="w"></span>
</code></pre></div>
<p>And the lifetime tag <code>'a</code> appears twice in the <code>where</code> sentence that confused me a lot.<br>
I just don't understand why there are two <code>'a</code>, <code>B: 'a + ToOwned + 'a + ?Sized</code><br>
<span aria-label="dizzy" class="emoji emoji-1f635" role="img" title="dizzy">:dizzy:</span></p>



<a name="269838749"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122651-general/topic/lifetime%20in%20Cow%3CT%3E/near/269838749" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Ibraheem Ahmed <a href="https://zulip-archive.rust-lang.org/stream/122651-general/topic/lifetime.20in.20Cow.3CT.3E.html#269838749">(Jan 29 2022 at 04:57)</a>:</h4>
<p>Where did you get that definition from?</p>



<a name="269838761"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122651-general/topic/lifetime%20in%20Cow%3CT%3E/near/269838761" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Ibraheem Ahmed <a href="https://zulip-archive.rust-lang.org/stream/122651-general/topic/lifetime.20in.20Cow.3CT.3E.html#269838761">(Jan 29 2022 at 04:57)</a>:</h4>
<p>The definition in <code>alloc</code> is: </p>
<div class="codehilite" data-code-language="Rust"><pre><span></span><code><span class="k">pub</span><span class="w"> </span><span class="k">enum</span> <span class="nc">Cow</span><span class="o">&lt;'</span><span class="na">a</span><span class="p">,</span><span class="w"> </span><span class="n">B</span>: <span class="o">?</span><span class="nb">Sized</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="o">'</span><span class="na">a</span><span class="o">&gt;</span><span class="w"></span>
<span class="k">where</span><span class="w"></span>
<span class="w">    </span><span class="n">B</span>: <span class="nb">ToOwned</span><span class="p">,</span><span class="w"></span>
<span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="sd">/// Borrowed data.</span>
<span class="w">    </span><span class="n">Borrowed</span><span class="p">(</span><span class="o">&amp;'</span><span class="na">a</span><span class="w"> </span><span class="n">B</span><span class="p">),</span><span class="w"></span>
<span class="w">    </span><span class="sd">/// Owned data.</span>
<span class="w">    </span><span class="n">Owned</span><span class="p">(</span><span class="o">&lt;</span><span class="n">B</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nb">ToOwned</span><span class="o">&gt;</span>::<span class="n">Owned</span><span class="p">),</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>
</code></pre></div>



<a name="269842183"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122651-general/topic/lifetime%20in%20Cow%3CT%3E/near/269842183" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lokathor <a href="https://zulip-archive.rust-lang.org/stream/122651-general/topic/lifetime.20in.20Cow.3CT.3E.html#269842183">(Jan 29 2022 at 05:57)</a>:</h4>
<p>Uh, a quick check on the playground seems to indicate that you can put extra <code>+ 'a</code> all you want and the definition will still compile.</p>



<a name="269842192"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122651-general/topic/lifetime%20in%20Cow%3CT%3E/near/269842192" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lokathor <a href="https://zulip-archive.rust-lang.org/stream/122651-general/topic/lifetime.20in.20Cow.3CT.3E.html#269842192">(Jan 29 2022 at 05:57)</a>:</h4>
<p>which i would not have expected to pass without a warning, but it sorta makes sense i guess</p>



<a name="269842524"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122651-general/topic/lifetime%20in%20Cow%3CT%3E/near/269842524" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Frank King <a href="https://zulip-archive.rust-lang.org/stream/122651-general/topic/lifetime.20in.20Cow.3CT.3E.html#269842524">(Jan 29 2022 at 06:03)</a>:</h4>
<p><span class="user-mention" data-user-id="472284">@yingmanwumen</span> I think this material is from some Chinese materials and I cannot find the original version. You may not rely on that, and do double check at <a href="https://doc.rust-lang.org/std/borrow/enum.Cow.html">https://doc.rust-lang.org/std/borrow/enum.Cow.html</a> when you are not sure if what you are reading is right.</p>



<a name="269856352"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122651-general/topic/lifetime%20in%20Cow%3CT%3E/near/269856352" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Daniel Henry-Mantilla <a href="https://zulip-archive.rust-lang.org/stream/122651-general/topic/lifetime.20in.20Cow.3CT.3E.html#269856352">(Jan 29 2022 at 10:57)</a>:</h4>
<p>You can write</p>
<div class="codehilite" data-code-language="Rust"><pre><span></span><code><span class="n">T</span><span class="w"> </span>: <span class="nb">Sized</span> <span class="o">+</span><span class="w"> </span><span class="nb">Clone</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">Did</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">I</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">Say</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nb">Sized</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">And</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">Dont</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">Forget</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">About</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nb">Clone</span><span class="w"></span>
</code></pre></div>
<p>that is, bounds can be redundant, and this includes "usable-within-region <code>'a</code>" bounds such as <code>+ 'a</code>.<br>
As to <em>why</em> would anyone do that, my guess would be typos, such as in that material you had, and macro-generated code</p>



<a name="269857278"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122651-general/topic/lifetime%20in%20Cow%3CT%3E/near/269857278" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> yingmanwumen <a href="https://zulip-archive.rust-lang.org/stream/122651-general/topic/lifetime.20in.20Cow.3CT.3E.html#269857278">(Jan 29 2022 at 11:14)</a>:</h4>
<p>Thanks very much!</p>



<hr><p>Last updated: Apr 12 2022 at 20:01 UTC</p>
</html>