<html>
<head><meta charset="utf-8"><title>Generic Type for numerics · general · Zulip Chat Archive</title></head>
<h2>Stream: <a href="https://zulip-archive.rust-lang.org/stream/122651-general/index.html">general</a></h2>
<h3>Topic: <a href="https://zulip-archive.rust-lang.org/stream/122651-general/topic/Generic.20Type.20for.20numerics.html">Generic Type for numerics</a></h3>

<hr>

<base href="https://rust-lang.zulipchat.com">

<head><link href="https://zulip-archive.rust-lang.org/style.css" rel="stylesheet"></head>

<a name="262003542"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122651-general/topic/Generic%20Type%20for%20numerics/near/262003542" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Israel <a href="https://zulip-archive.rust-lang.org/stream/122651-general/topic/Generic.20Type.20for.20numerics.html#262003542">(Nov 18 2021 at 22:55)</a>:</h4>
<p>Hi, I am trying to use </p>
<div class="codehilite" data-code-language="Rust"><pre><span></span><code><span class="k">impl</span><span class="o">&lt;</span><span class="n">T</span>:<span class="nb">Copy</span>
    <span class="o">+</span><span class="w"> </span><span class="nb">Default</span><span class="w"></span>
<span class="w">    </span><span class="o">+</span><span class="w"> </span><span class="n">Debug</span><span class="w"></span>
<span class="w">    </span><span class="o">+</span><span class="w"> </span><span class="n">AddAssign</span><span class="w"></span>
<span class="w">    </span><span class="o">+</span><span class="w"> </span><span class="n">Add</span><span class="o">&lt;</span><span class="n">Output</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">T</span><span class="o">&gt;</span><span class="w"></span>
<span class="w">    </span><span class="o">+</span><span class="w"> </span><span class="n">Div</span><span class="o">&lt;</span><span class="n">Output</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">T</span><span class="o">&gt;</span><span class="w"></span>
<span class="w">    </span><span class="o">+</span><span class="w"> </span><span class="n">DivAssign</span><span class="w"></span>
<span class="w">    </span><span class="o">+</span><span class="w"> </span><span class="n">Mul</span><span class="o">&lt;</span><span class="n">Output</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">T</span><span class="o">&gt;</span><span class="w"></span>
<span class="w">    </span><span class="o">+</span><span class="w"> </span><span class="n">MulAssign</span><span class="w"></span>
<span class="w">    </span><span class="o">+</span><span class="w"> </span><span class="n">Neg</span><span class="o">&lt;</span><span class="n">Output</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">T</span><span class="o">&gt;</span><span class="w"></span>
<span class="w">    </span><span class="o">+</span><span class="w"> </span><span class="n">Rem</span><span class="o">&lt;</span><span class="n">Output</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">T</span><span class="o">&gt;</span><span class="w"></span>
<span class="w">    </span><span class="o">+</span><span class="w"> </span><span class="n">RemAssign</span><span class="w"></span>
<span class="w">    </span><span class="o">+</span><span class="w"> </span><span class="n">Sub</span><span class="o">&lt;</span><span class="n">Output</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">T</span><span class="o">&gt;</span><span class="w"></span>
<span class="w">    </span><span class="o">+</span><span class="w"> </span><span class="n">SubAssign</span><span class="w"></span>
<span class="w">    </span><span class="o">+</span><span class="w"> </span><span class="nb">Iterator</span><span class="w"></span>
<span class="w">    </span><span class="o">+</span><span class="w"> </span><span class="n">std</span>::<span class="n">cmp</span>::<span class="nb">PartialOrd</span><span class="o">&gt;</span><span class="w">  </span><span class="n">Thing</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">T</span><span class="w"> </span><span class="p">{}</span><span class="w"></span>
</code></pre></div>
<p>(one also without <code>Neg</code> for u* numbers)<br>
as well as: (Vector &lt;T&gt;)</p>
<div class="codehilite" data-code-language="Rust"><pre><span></span><code><span class="k">impl</span><span class="o">&lt;</span><span class="n">T</span>:<span class="nb">Copy</span>
    <span class="o">+</span><span class="w"> </span><span class="nb">Default</span><span class="w"></span>
<span class="w">    </span><span class="o">+</span><span class="w"> </span><span class="n">Debug</span><span class="w"></span>
<span class="w">    </span><span class="o">+</span><span class="w"> </span><span class="n">AddAssign</span><span class="w"></span>
<span class="w">    </span><span class="o">+</span><span class="w"> </span><span class="n">Add</span><span class="o">&lt;</span><span class="n">Output</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">T</span><span class="o">&gt;</span><span class="w"></span>
<span class="w">    </span><span class="o">+</span><span class="w"> </span><span class="n">Div</span><span class="o">&lt;</span><span class="n">Output</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">T</span><span class="o">&gt;</span><span class="w"></span>
<span class="w">    </span><span class="o">+</span><span class="w"> </span><span class="n">DivAssign</span><span class="w"></span>
<span class="w">    </span><span class="o">+</span><span class="w"> </span><span class="n">Mul</span><span class="o">&lt;</span><span class="n">Output</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">T</span><span class="o">&gt;</span><span class="w"></span>
<span class="w">    </span><span class="o">+</span><span class="w"> </span><span class="n">MulAssign</span><span class="w"></span>
<span class="w">    </span><span class="o">+</span><span class="w"> </span><span class="n">Neg</span><span class="o">&lt;</span><span class="n">Output</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">T</span><span class="o">&gt;</span><span class="w"></span>
<span class="w">    </span><span class="o">+</span><span class="w"> </span><span class="n">Rem</span><span class="o">&lt;</span><span class="n">Output</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">T</span><span class="o">&gt;</span><span class="w"></span>
<span class="w">    </span><span class="o">+</span><span class="w"> </span><span class="n">RemAssign</span><span class="w"></span>
<span class="w">    </span><span class="o">+</span><span class="w"> </span><span class="n">Sub</span><span class="o">&lt;</span><span class="n">Output</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">T</span><span class="o">&gt;</span><span class="w"></span>
<span class="w">    </span><span class="o">+</span><span class="w"> </span><span class="n">SubAssign</span><span class="w"></span>
<span class="w">    </span><span class="o">+</span><span class="w"> </span><span class="nb">Iterator</span><span class="w"></span>
<span class="w">    </span><span class="o">+</span><span class="w"> </span><span class="n">std</span>::<span class="n">cmp</span>::<span class="nb">PartialOrd</span><span class="o">&gt;</span><span class="w">  </span><span class="n">Thing</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="nb">Vec</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;</span><span class="w"> </span><span class="p">{}</span><span class="w"></span>
</code></pre></div>
<p>Is this possible?  Is there a numerics trait that ensures it is a number?</p>



<a name="262003666"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122651-general/topic/Generic%20Type%20for%20numerics/near/262003666" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Israel <a href="https://zulip-archive.rust-lang.org/stream/122651-general/topic/Generic.20Type.20for.20numerics.html#262003666">(Nov 18 2021 at 22:56)</a>:</h4>
<p>To be clear the error message from the Vec&lt;T&gt;</p>
<div class="codehilite"><pre><span></span><code>= note: upstream crates may add a new impl of trait `std::ops::$whatever` for type `std::vec::Vec&lt;_&gt;` in future versions
</code></pre></div>



<a name="262003877"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122651-general/topic/Generic%20Type%20for%20numerics/near/262003877" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nagisa <a href="https://zulip-archive.rust-lang.org/stream/122651-general/topic/Generic.20Type.20for.20numerics.html#262003877">(Nov 18 2021 at 22:58)</a>:</h4>
<p>The usual solution is to make your own marker trait and implement it for the types you want to allow.</p>



<a name="262003999"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122651-general/topic/Generic%20Type%20for%20numerics/near/262003999" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Israel <a href="https://zulip-archive.rust-lang.org/stream/122651-general/topic/Generic.20Type.20for.20numerics.html#262003999">(Nov 18 2021 at 22:59)</a>:</h4>
<p><span class="user-mention" data-user-id="123586">@nagisa</span> can you point me to the docs, or give me the <strong>specific</strong> word to search for please!</p>



<a name="262004194"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122651-general/topic/Generic%20Type%20for%20numerics/near/262004194" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nagisa <a href="https://zulip-archive.rust-lang.org/stream/122651-general/topic/Generic.20Type.20for.20numerics.html#262004194">(Nov 18 2021 at 23:00)</a>:</h4>
<p>The reason why this fails is because if all of these traits are implemented for <code>T = Vec&lt;_&gt;</code> then the first implementation would already be triggered, and your crate cannot assert that they won't be implemented in the future. An option is to use <code>specialization</code>, but that isn't a stable feature.</p>



<a name="262004249"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122651-general/topic/Generic%20Type%20for%20numerics/near/262004249" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nagisa <a href="https://zulip-archive.rust-lang.org/stream/122651-general/topic/Generic.20Type.20for.20numerics.html#262004249">(Nov 18 2021 at 23:01)</a>:</h4>
<p><a href="https://stackoverflow.com/questions/50266085/is-there-a-trait-for-only-primitive-types-that-i-can-use-in-a-generic-function">https://stackoverflow.com/questions/50266085/is-there-a-trait-for-only-primitive-types-that-i-can-use-in-a-generic-function</a> is also relevant for you.</p>



<a name="262004544"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122651-general/topic/Generic%20Type%20for%20numerics/near/262004544" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Israel <a href="https://zulip-archive.rust-lang.org/stream/122651-general/topic/Generic.20Type.20for.20numerics.html#262004544">(Nov 18 2021 at 23:03)</a>:</h4>
<p>Thanks for the explanation!  I will try the num crate <code>Num</code> that may be what I am looking for</p>



<a name="262004969"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122651-general/topic/Generic%20Type%20for%20numerics/near/262004969" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Israel <a href="https://zulip-archive.rust-lang.org/stream/122651-general/topic/Generic.20Type.20for.20numerics.html#262004969">(Nov 18 2021 at 23:07)</a>:</h4>
<p>nope... same issue (well &amp;str counts as Num).  This may not be possible.</p>



<a name="262005457"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122651-general/topic/Generic%20Type%20for%20numerics/near/262005457" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> cuviper <a href="https://zulip-archive.rust-lang.org/stream/122651-general/topic/Generic.20Type.20for.20numerics.html#262005457">(Nov 18 2021 at 23:12)</a>:</h4>
<blockquote>
<p>because if all of these traits are implemented for <code>T = Vec&lt;_&gt;</code></p>
</blockquote>
<p>... which will never happen because one of those traits is <code>Copy</code>, but that might need an explicit <code>impl !Copy</code> to be realized, despite the compiler knowing <code>Copy</code> ⊕ <code>Drop</code></p>



<a name="262005690"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122651-general/topic/Generic%20Type%20for%20numerics/near/262005690" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> The 8472 <a href="https://zulip-archive.rust-lang.org/stream/122651-general/topic/Generic.20Type.20for.20numerics.html#262005690">(Nov 18 2021 at 23:14)</a>:</h4>
<p>Or to generalize further just put !Copy on Drop?</p>



<a name="262005712"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122651-general/topic/Generic%20Type%20for%20numerics/near/262005712" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> cuviper <a href="https://zulip-archive.rust-lang.org/stream/122651-general/topic/Generic.20Type.20for.20numerics.html#262005712">(Nov 18 2021 at 23:14)</a>:</h4>
<p>ooh</p>



<a name="262005730"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122651-general/topic/Generic%20Type%20for%20numerics/near/262005730" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> cuviper <a href="https://zulip-archive.rust-lang.org/stream/122651-general/topic/Generic.20Type.20for.20numerics.html#262005730">(Nov 18 2021 at 23:15)</a>:</h4>
<p>like a negative supertrait?</p>



<a name="262005799"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122651-general/topic/Generic%20Type%20for%20numerics/near/262005799" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Israel <a href="https://zulip-archive.rust-lang.org/stream/122651-general/topic/Generic.20Type.20for.20numerics.html#262005799">(Nov 18 2021 at 23:15)</a>:</h4>
<p>So <code>!Copy</code> should work?</p>



<a name="262005900"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122651-general/topic/Generic%20Type%20for%20numerics/near/262005900" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> The 8472 <a href="https://zulip-archive.rust-lang.org/stream/122651-general/topic/Generic.20Type.20for.20numerics.html#262005900">(Nov 18 2021 at 23:16)</a>:</h4>
<p><span class="user-mention" data-user-id="138448">@cuviper</span>  uhh, something. I guess <code>impl !Copy for T where T: Drop</code> wouldn't be legal?</p>
<p><span class="user-mention" data-user-id="458644">@Israel</span> negative trait bounds currently aren't allowed.</p>



<a name="262005964"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122651-general/topic/Generic%20Type%20for%20numerics/near/262005964" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> cuviper <a href="https://zulip-archive.rust-lang.org/stream/122651-general/topic/Generic.20Type.20for.20numerics.html#262005964">(Nov 18 2021 at 23:17)</a>:</h4>
<p><span class="user-mention silent" data-user-id="458644">Israel</span> <a href="#narrow/stream/122651-general/topic/Generic.20Type.20for.20numerics/near/262004969">said</a>:</p>
<blockquote>
<p>nope... same issue (well &amp;str counts as Num).  This may not be possible.</p>
</blockquote>
<p><code>&amp;str</code> doesn't <code>impl Num</code>, but I suppose the coherence error is that it could be added (in theory)</p>



<a name="262006123"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122651-general/topic/Generic%20Type%20for%20numerics/near/262006123" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> cuviper <a href="https://zulip-archive.rust-lang.org/stream/122651-general/topic/Generic.20Type.20for.20numerics.html#262006123">(Nov 18 2021 at 23:19)</a>:</h4>
<p><span class="user-mention" data-user-id="330154">@The 8472</span> then if a type removed <code>Drop</code>, it would be a breaking change<br>
(it's vaguely breaking already, but that's weird)</p>



<a name="262006131"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122651-general/topic/Generic%20Type%20for%20numerics/near/262006131" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Israel <a href="https://zulip-archive.rust-lang.org/stream/122651-general/topic/Generic.20Type.20for.20numerics.html#262006131">(Nov 18 2021 at 23:19)</a>:</h4>
<p>Ahh... the compiler thinks it is.  So no <code>!Copy</code><br>
<span class="user-mention" data-user-id="330154">@The 8472</span> is this something that cannot be done currently?</p>



<a name="262006325"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122651-general/topic/Generic%20Type%20for%20numerics/near/262006325" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Israel <a href="https://zulip-archive.rust-lang.org/stream/122651-general/topic/Generic.20Type.20for.20numerics.html#262006325">(Nov 18 2021 at 23:21)</a>:</h4>
<p>My goal was to use serde + my generics + fltk-form to read in a config file and build a UI.  I guess I will have to manually program more... boo.  Maybe this will work in the future!</p>



<a name="262006338"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122651-general/topic/Generic%20Type%20for%20numerics/near/262006338" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> cuviper <a href="https://zulip-archive.rust-lang.org/stream/122651-general/topic/Generic.20Type.20for.20numerics.html#262006338">(Nov 18 2021 at 23:21)</a>:</h4>
<p>hey, I just noticed <code>Iterator</code> in your trait list too -- what kind of numbers are these?!?</p>



<a name="262006404"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122651-general/topic/Generic%20Type%20for%20numerics/near/262006404" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Israel <a href="https://zulip-archive.rust-lang.org/stream/122651-general/topic/Generic.20Type.20for.20numerics.html#262006404">(Nov 18 2021 at 23:21)</a>:</h4>
<p><span class="user-mention" data-user-id="138448">@cuviper</span> Sorry copy paste error... I was trying to see if I could get a Vec by adding that <span aria-label="smile" class="emoji emoji-1f642" role="img" title="smile">:smile:</span></p>



<a name="262006602"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122651-general/topic/Generic%20Type%20for%20numerics/near/262006602" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Israel <a href="https://zulip-archive.rust-lang.org/stream/122651-general/topic/Generic.20Type.20for.20numerics.html#262006602">(Nov 18 2021 at 23:23)</a>:</h4>
<p>Is there something in std::cmp that only vectors use?<br>
There has to be something that makes Vectors unique</p>



<a name="262006942"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122651-general/topic/Generic%20Type%20for%20numerics/near/262006942" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nagisa <a href="https://zulip-archive.rust-lang.org/stream/122651-general/topic/Generic.20Type.20for.20numerics.html#262006942">(Nov 18 2021 at 23:26)</a>:</h4>
<p>The current implementation of coherence won't allow you to do this no matter what kind of bounds you use, I believe.</p>



<a name="262006978"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122651-general/topic/Generic%20Type%20for%20numerics/near/262006978" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> cuviper <a href="https://zulip-archive.rust-lang.org/stream/122651-general/topic/Generic.20Type.20for.20numerics.html#262006978">(Nov 18 2021 at 23:26)</a>:</h4>
<p>I think you need it the other way, something in your <code>impl&lt;T: ...&gt; Thing for T</code> that doesn't include <code>Vec&lt;_&gt;</code></p>



<a name="262006989"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122651-general/topic/Generic%20Type%20for%20numerics/near/262006989" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> cuviper <a href="https://zulip-archive.rust-lang.org/stream/122651-general/topic/Generic.20Type.20for.20numerics.html#262006989">(Nov 18 2021 at 23:26)</a>:</h4>
<p>maybe a local trait would do?</p>



<a name="262007017"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122651-general/topic/Generic%20Type%20for%20numerics/near/262007017" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> cuviper <a href="https://zulip-archive.rust-lang.org/stream/122651-general/topic/Generic.20Type.20for.20numerics.html#262007017">(Nov 18 2021 at 23:27)</a>:</h4>
<p>but then you might as well just <code>impl Thing for i8</code> etc anyway</p>



<a name="262007127"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122651-general/topic/Generic%20Type%20for%20numerics/near/262007127" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Daniel Henry-Mantilla <a href="https://zulip-archive.rust-lang.org/stream/122651-general/topic/Generic.20Type.20for.20numerics.html#262007127">(Nov 18 2021 at 23:28)</a>:</h4>
<p><span class="user-mention" data-user-id="458644">@Israel</span> FWIW, another approach to handle this "would otherwise need specialization" error is by having an extra parameter on the trait that distinguishes between the two impls. You'd just let it be inferred in practice, and in the impossible case of an overlap, you'd have type inference errors. Otherwise everything just works:</p>
<div class="codehilite" data-code-language="Rust"><pre><span></span><code><span class="k">trait</span><span class="w"> </span><span class="n">Thing</span><span class="o">&lt;</span><span class="k">const</span><span class="w"> </span><span class="n">IS_VEC</span>: <span class="kt">bool</span><span class="o">&gt;</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="o">..</span><span class="p">.</span><span class="w"> </span><span class="p">}</span><span class="w"></span>

<span class="k">impl</span><span class="o">&lt;</span><span class="n">T</span><span class="w"> </span>: <span class="o">..</span><span class="p">.</span><span class="o">&gt;</span><span class="w"> </span><span class="n">Thing</span><span class="o">&lt;</span><span class="kc">false</span><span class="o">&gt;</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">T</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="o">..</span><span class="p">.</span><span class="w"> </span><span class="p">}</span><span class="w"></span>
<span class="k">impl</span><span class="o">&lt;</span><span class="n">T</span><span class="w"> </span>: <span class="o">..</span><span class="p">.</span><span class="o">&gt;</span><span class="w"> </span><span class="n">Thing</span><span class="o">&lt;</span><span class="kc">true</span><span class="o">&gt;</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="nb">Vec</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="o">..</span><span class="p">.</span><span class="w"> </span><span class="p">}</span><span class="w"></span>

<span class="c1">// The extra `IS_VEC` param is the only non-pretty part</span>
<span class="k">fn</span> <span class="nf">foo</span><span class="o">&lt;</span><span class="k">const</span><span class="w"> </span><span class="n">IS_VEC</span>: <span class="kt">bool</span><span class="o">&gt;</span><span class="w"> </span><span class="p">(</span><span class="n">thing</span>: <span class="nc">impl</span><span class="w"> </span><span class="n">Thing</span><span class="o">&lt;</span><span class="n">IS_VEC</span><span class="o">&gt;</span><span class="p">)</span><span class="w"></span>
<span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="o">..</span><span class="p">.</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="n">foo</span><span class="p">(</span><span class="mi">42</span><span class="p">);</span><span class="w"> </span><span class="c1">// OK</span>
<span class="n">foo</span><span class="p">(</span><span class="fm">vec!</span><span class="p">[</span><span class="mi">42</span><span class="p">]);</span><span class="w"> </span><span class="c1">// OK</span>
</code></pre></div>



<a name="262007152"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122651-general/topic/Generic%20Type%20for%20numerics/near/262007152" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Israel <a href="https://zulip-archive.rust-lang.org/stream/122651-general/topic/Generic.20Type.20for.20numerics.html#262007152">(Nov 18 2021 at 23:28)</a>:</h4>
<p><span class="user-mention" data-user-id="123586">@nagisa</span> Good to know!<br>
<span class="user-mention" data-user-id="138448">@cuviper</span> A local trait I make only for numbers?  Just a kind of stub/hacky/workaround?  I am wiling to try it if it will work</p>



<a name="262007222"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122651-general/topic/Generic%20Type%20for%20numerics/near/262007222" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> cuviper <a href="https://zulip-archive.rust-lang.org/stream/122651-general/topic/Generic.20Type.20for.20numerics.html#262007222">(Nov 18 2021 at 23:29)</a>:</h4>
<p>I'm not sure it will work</p>



<a name="262007245"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122651-general/topic/Generic%20Type%20for%20numerics/near/262007245" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nagisa <a href="https://zulip-archive.rust-lang.org/stream/122651-general/topic/Generic.20Type.20for.20numerics.html#262007245">(Nov 18 2021 at 23:29)</a>:</h4>
<p>You can use local traits that way, yes. They are treated specially.</p>



<a name="262007268"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122651-general/topic/Generic%20Type%20for%20numerics/near/262007268" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Israel <a href="https://zulip-archive.rust-lang.org/stream/122651-general/topic/Generic.20Type.20for.20numerics.html#262007268">(Nov 18 2021 at 23:29)</a>:</h4>
<p><span class="user-mention" data-user-id="232018">@Daniel Henry-Mantilla</span> That seems like what <span class="user-mention" data-user-id="138448">@cuviper</span> is getting at<br>
<span class="user-mention" data-user-id="138448">@cuviper</span> what do you suggest?</p>



<a name="262007439"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122651-general/topic/Generic%20Type%20for%20numerics/near/262007439" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> cuviper <a href="https://zulip-archive.rust-lang.org/stream/122651-general/topic/Generic.20Type.20for.20numerics.html#262007439">(Nov 18 2021 at 23:31)</a>:</h4>
<p>well I was saying if you manually <code>impl MyNum for i8</code> etc., and then use that for <code>impl&lt;T: MyNum&gt; Thing for T</code>, why not just do each <code>Thing</code> separately instead</p>



<a name="262007450"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122651-general/topic/Generic%20Type%20for%20numerics/near/262007450" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nagisa <a href="https://zulip-archive.rust-lang.org/stream/122651-general/topic/Generic.20Type.20for.20numerics.html#262007450">(Nov 18 2021 at 23:31)</a>:</h4>
<p>Kinda like this: <a href="https://play.rust-lang.org/?version=stable&amp;mode=debug&amp;edition=2021&amp;gist=6b5f7048aafef551eee1e1d1a9054ebe">https://play.rust-lang.org/?version=stable&amp;mode=debug&amp;edition=2021&amp;gist=6b5f7048aafef551eee1e1d1a9054ebe</a></p>



<a name="262007480"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122651-general/topic/Generic%20Type%20for%20numerics/near/262007480" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nagisa <a href="https://zulip-archive.rust-lang.org/stream/122651-general/topic/Generic.20Type.20for.20numerics.html#262007480">(Nov 18 2021 at 23:31)</a>:</h4>
<p>That's what I was saying in the first response ^^</p>



<a name="262007552"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122651-general/topic/Generic%20Type%20for%20numerics/near/262007552" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Israel <a href="https://zulip-archive.rust-lang.org/stream/122651-general/topic/Generic.20Type.20for.20numerics.html#262007552">(Nov 18 2021 at 23:32)</a>:</h4>
<p><span class="user-mention" data-user-id="123586">@nagisa</span> That actually looks nice!  That seems reasonable.  I will try this</p>



<a name="262008232"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122651-general/topic/Generic%20Type%20for%20numerics/near/262008232" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Israel <a href="https://zulip-archive.rust-lang.org/stream/122651-general/topic/Generic.20Type.20for.20numerics.html#262008232">(Nov 18 2021 at 23:40)</a>:</h4>
<p><span class="user-mention" data-user-id="123586">@nagisa</span> is there a nice way to derive Debug to <code>Primitive</code>,  &lt;T:Primative + std::fmt::Debug&gt; causes the same issue.</p>



<a name="262008756"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122651-general/topic/Generic%20Type%20for%20numerics/near/262008756" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nagisa <a href="https://zulip-archive.rust-lang.org/stream/122651-general/topic/Generic.20Type.20for.20numerics.html#262008756">(Nov 18 2021 at 23:47)</a>:</h4>
<p>Add it as a supertrait of <code>Primitive</code>.</p>



<a name="262008765"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122651-general/topic/Generic%20Type%20for%20numerics/near/262008765" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Israel <a href="https://zulip-archive.rust-lang.org/stream/122651-general/topic/Generic.20Type.20for.20numerics.html#262008765">(Nov 18 2021 at 23:47)</a>:</h4>
<p>Wait a minute!  I think I got it.</p>



<a name="262008772"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122651-general/topic/Generic%20Type%20for%20numerics/near/262008772" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Israel <a href="https://zulip-archive.rust-lang.org/stream/122651-general/topic/Generic.20Type.20for.20numerics.html#262008772">(Nov 18 2021 at 23:47)</a>:</h4>
<p>Thanks <span class="user-mention" data-user-id="123586">@nagisa</span>  <span aria-label="smile" class="emoji emoji-1f642" role="img" title="smile">:smile:</span></p>



<a name="262009745"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122651-general/topic/Generic%20Type%20for%20numerics/near/262009745" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Israel <a href="https://zulip-archive.rust-lang.org/stream/122651-general/topic/Generic.20Type.20for.20numerics.html#262009745">(Nov 18 2021 at 23:59)</a>:</h4>
<p>This mostly works, I will play with it for a while, I might be able to wrangle it to what I want.  I appreciate the time and help</p>



<a name="262011422"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122651-general/topic/Generic%20Type%20for%20numerics/near/262011422" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Israel <a href="https://zulip-archive.rust-lang.org/stream/122651-general/topic/Generic.20Type.20for.20numerics.html#262011422">(Nov 19 2021 at 00:18)</a>:</h4>
<p>Yeah, I think this will do what I need it to.  Thanks again</p>



<a name="262012378"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122651-general/topic/Generic%20Type%20for%20numerics/near/262012378" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Israel <a href="https://zulip-archive.rust-lang.org/stream/122651-general/topic/Generic.20Type.20for.20numerics.html#262012378">(Nov 19 2021 at 00:30)</a>:</h4>
<p>It is still picking up Vectors... <span aria-label="half frown" class="emoji emoji-1f615" role="img" title="half frown">:half_frown:</span></p>



<a name="262012919"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122651-general/topic/Generic%20Type%20for%20numerics/near/262012919" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Israel <a href="https://zulip-archive.rust-lang.org/stream/122651-general/topic/Generic.20Type.20for.20numerics.html#262012919">(Nov 19 2021 at 00:37)</a>:</h4>
<p>I continue to get unsatisfied trait bounds for Vec.  It was worth trying, though...</p>



<hr><p>Last updated: Apr 12 2022 at 20:01 UTC</p>
</html>