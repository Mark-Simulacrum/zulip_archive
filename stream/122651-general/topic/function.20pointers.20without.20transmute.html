<html>
<head><meta charset="utf-8"><title>function pointers without transmute · general · Zulip Chat Archive</title></head>
<h2>Stream: <a href="https://zulip-archive.rust-lang.org/stream/122651-general/index.html">general</a></h2>
<h3>Topic: <a href="https://zulip-archive.rust-lang.org/stream/122651-general/topic/function.20pointers.20without.20transmute.html">function pointers without transmute</a></h3>

<hr>

<base href="https://rust-lang.zulipchat.com">

<head><link href="https://zulip-archive.rust-lang.org/style.css" rel="stylesheet"></head>

<a name="264961676"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122651-general/topic/function%20pointers%20without%20transmute/near/264961676" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Winter <a href="https://zulip-archive.rust-lang.org/stream/122651-general/topic/function.20pointers.20without.20transmute.html#264961676">(Dec 15 2021 at 03:42)</a>:</h4>
<p>I see that libloading’s Symbol&lt;T&gt; (where T can be a function pointer) somehow goes from a raw pointer to a function pointer without using transmute (but is probably equally as unsafe): <a href="https://docs.rs/libloading/0.7.2/src/libloading/os/unix/mod.rs.html#397">https://docs.rs/libloading/0.7.2/src/libloading/os/unix/mod.rs.html#397</a></p>
<p>How exactly does this work? it seems that it’s making a pointer to the pointer<br>
casting that to *const *mut _ (so, a pointer to a pointer of an inferred type), and then casting that back to *mut T?<br>
that extra pointer would still be there, so I’m confused…</p>



<a name="264962338"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122651-general/topic/function%20pointers%20without%20transmute/near/264962338" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Winter <a href="https://zulip-archive.rust-lang.org/stream/122651-general/topic/function.20pointers.20without.20transmute.html#264962338">(Dec 15 2021 at 03:55)</a>:</h4>
<p>(cc <span class="user-mention" data-user-id="123586">@nagisa</span>)</p>



<a name="264962645"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122651-general/topic/function%20pointers%20without%20transmute/near/264962645" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jacob Lifshay <a href="https://zulip-archive.rust-lang.org/stream/122651-general/topic/function.20pointers.20without.20transmute.html#264962645">(Dec 15 2021 at 04:01)</a>:</h4>
<p>there, they're transmuting as if by:</p>
<div class="codehilite" data-code-language="Rust"><pre><span></span><code><span class="kd">let</span><span class="w"> </span><span class="n">a</span>: <span class="nc">P</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="bp">self</span><span class="p">.</span><span class="n">pointer</span><span class="p">;</span><span class="w"></span>
<span class="kd">let</span><span class="w"> </span><span class="n">b</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">unsafe</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="o">*</span><span class="p">(</span><span class="o">&amp;</span><span class="n">a</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="o">*</span><span class="k">const</span><span class="w"> </span><span class="n">P</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="o">*</span><span class="k">const</span><span class="w"> </span><span class="n">T</span><span class="p">)</span><span class="w"> </span><span class="p">};</span><span class="w"></span>
<span class="c1">// same as: let b: T = transmute_copy(&amp;a);</span>
</code></pre></div>



<a name="264962818"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122651-general/topic/function%20pointers%20without%20transmute/near/264962818" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jacob Lifshay <a href="https://zulip-archive.rust-lang.org/stream/122651-general/topic/function.20pointers.20without.20transmute.html#264962818">(Dec 15 2021 at 04:04)</a>:</h4>
<p>except that instead of just reading the dereferenced pointer into <code>b</code>, they convert it to a reference so they can return it.</p>



<a name="264962850"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122651-general/topic/function%20pointers%20without%20transmute/near/264962850" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jacob Lifshay <a href="https://zulip-archive.rust-lang.org/stream/122651-general/topic/function.20pointers.20without.20transmute.html#264962850">(Dec 15 2021 at 04:05)</a>:</h4>
<p>hopefully that explanation makes sense...</p>



<a name="264962923"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122651-general/topic/function%20pointers%20without%20transmute/near/264962923" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Winter <a href="https://zulip-archive.rust-lang.org/stream/122651-general/topic/function.20pointers.20without.20transmute.html#264962923">(Dec 15 2021 at 04:06)</a>:</h4>
<p>hmm<br>
i think i understand…<br>
but why the interim cast to *const P?</p>



<a name="264962931"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122651-general/topic/function%20pointers%20without%20transmute/near/264962931" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Winter <a href="https://zulip-archive.rust-lang.org/stream/122651-general/topic/function.20pointers.20without.20transmute.html#264962931">(Dec 15 2021 at 04:07)</a>:</h4>
<p>oh because the ref needs to be a pointer</p>



<a name="264962937"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122651-general/topic/function%20pointers%20without%20transmute/near/264962937" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Winter <a href="https://zulip-archive.rust-lang.org/stream/122651-general/topic/function.20pointers.20without.20transmute.html#264962937">(Dec 15 2021 at 04:07)</a>:</h4>
<p>of the same type</p>



<a name="264962938"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122651-general/topic/function%20pointers%20without%20transmute/near/264962938" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Winter <a href="https://zulip-archive.rust-lang.org/stream/122651-general/topic/function.20pointers.20without.20transmute.html#264962938">(Dec 15 2021 at 04:07)</a>:</h4>
<p>right, okay</p>



<a name="264963009"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122651-general/topic/function%20pointers%20without%20transmute/near/264963009" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Winter <a href="https://zulip-archive.rust-lang.org/stream/122651-general/topic/function.20pointers.20without.20transmute.html#264963009">(Dec 15 2021 at 04:08)</a>:</h4>
<p>but what I don’t get is that: 1. why is this allowed for function pointers in the generic position but not explicitly? 2. if I’m casting to a *const fn(…), isn’t that a pointer to the function pointer, therefore if <code>pointer</code> is the function pointer itself, it’s invalid?</p>



<a name="264963084"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122651-general/topic/function%20pointers%20without%20transmute/near/264963084" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Winter <a href="https://zulip-archive.rust-lang.org/stream/122651-general/topic/function.20pointers.20without.20transmute.html#264963084">(Dec 15 2021 at 04:10)</a>:</h4>
<p>(as in, if my pointer was 0x1, and I casted to *const fn(…), it would first try to go to 0x1, then whenever 0x1 pointed to, then it would think that was the code)</p>



<a name="264963093"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122651-general/topic/function%20pointers%20without%20transmute/near/264963093" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Winter <a href="https://zulip-archive.rust-lang.org/stream/122651-general/topic/function.20pointers.20without.20transmute.html#264963093">(Dec 15 2021 at 04:10)</a>:</h4>
<p>but that would be invalid if the pointer is the actual function pointer and not a pointer to the function pointer</p>



<a name="264963096"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122651-general/topic/function%20pointers%20without%20transmute/near/264963096" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Winter <a href="https://zulip-archive.rust-lang.org/stream/122651-general/topic/function.20pointers.20without.20transmute.html#264963096">(Dec 15 2021 at 04:10)</a>:</h4>
<p>…if that makes sense at all</p>



<a name="264963444"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122651-general/topic/function%20pointers%20without%20transmute/near/264963444" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jacob Lifshay <a href="https://zulip-archive.rust-lang.org/stream/122651-general/topic/function.20pointers.20without.20transmute.html#264963444">(Dec 15 2021 at 04:17)</a>:</h4>
<p>well, <code>self</code> is a reference to a struct with a field that's a function pointer, <code>&amp;self.pointer</code> is a reference to a function pointer (the reference points into the memory where <code>Self</code> lives), <code>&amp;self.pointer as *const _</code> is a pointer to a function pointer field of <code>Self</code>, <code>&amp;self.pointer as *const _ as *const T</code> is a pointer to that field, but reinterpreted as a field of type <code>T</code> (transmuted), <code>&amp;*(&amp;self.pointer as *const _ as *const T)</code> is a reference to that field, but reinterpreted as a field of type <code>T</code>.</p>



<a name="264963462"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122651-general/topic/function%20pointers%20without%20transmute/near/264963462" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jacob Lifshay <a href="https://zulip-archive.rust-lang.org/stream/122651-general/topic/function.20pointers.20without.20transmute.html#264963462">(Dec 15 2021 at 04:17)</a>:</h4>
<p>...maybe that helps</p>



<a name="264963649"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122651-general/topic/function%20pointers%20without%20transmute/near/264963649" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Winter <a href="https://zulip-archive.rust-lang.org/stream/122651-general/topic/function.20pointers.20without.20transmute.html#264963649">(Dec 15 2021 at 04:20)</a>:</h4>
<p>but if it’s a reference to the pointer reinterpreted like the reference is the function pointer, that would be invalid, no?</p>



<a name="264963659"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122651-general/topic/function%20pointers%20without%20transmute/near/264963659" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jacob Lifshay <a href="https://zulip-archive.rust-lang.org/stream/122651-general/topic/function.20pointers.20without.20transmute.html#264963659">(Dec 15 2021 at 04:20)</a>:</h4>
<blockquote>
<ol>
<li>why is this allowed for function pointers in the generic position but not explicitly?</li>
</ol>
</blockquote>
<p>idk, i'd expect it to be the same as <code>transmute_copy</code> and to work on all types that <code>transmute_copy</code> works on (some transmutes are UB).</p>



<a name="264963672"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122651-general/topic/function%20pointers%20without%20transmute/near/264963672" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Winter <a href="https://zulip-archive.rust-lang.org/stream/122651-general/topic/function.20pointers.20without.20transmute.html#264963672">(Dec 15 2021 at 04:20)</a>:</h4>
<p>since the address of the pointer != the address in the pointer</p>



<a name="264963684"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122651-general/topic/function%20pointers%20without%20transmute/near/264963684" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Winter <a href="https://zulip-archive.rust-lang.org/stream/122651-general/topic/function.20pointers.20without.20transmute.html#264963684">(Dec 15 2021 at 04:21)</a>:</h4>
<p>since the pointer in this case is the location of the code</p>



<a name="264963689"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122651-general/topic/function%20pointers%20without%20transmute/near/264963689" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Winter <a href="https://zulip-archive.rust-lang.org/stream/122651-general/topic/function.20pointers.20without.20transmute.html#264963689">(Dec 15 2021 at 04:21)</a>:</h4>
<p>which would be a valid function pointer</p>



<a name="264963698"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122651-general/topic/function%20pointers%20without%20transmute/near/264963698" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Winter <a href="https://zulip-archive.rust-lang.org/stream/122651-general/topic/function.20pointers.20without.20transmute.html#264963698">(Dec 15 2021 at 04:21)</a>:</h4>
<p>but a pointer to that pointer is not a valid function pointer</p>



<a name="264963712"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122651-general/topic/function%20pointers%20without%20transmute/near/264963712" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Winter <a href="https://zulip-archive.rust-lang.org/stream/122651-general/topic/function.20pointers.20without.20transmute.html#264963712">(Dec 15 2021 at 04:21)</a>:</h4>
<p>therefore calling the transmuted function pointer would be invalid</p>



<a name="264963725"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122651-general/topic/function%20pointers%20without%20transmute/near/264963725" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jacob Lifshay <a href="https://zulip-archive.rust-lang.org/stream/122651-general/topic/function.20pointers.20without.20transmute.html#264963725">(Dec 15 2021 at 04:21)</a>:</h4>
<p>don't forget that deref returns a reference to a function pointer, the deref operator then dereferences that reference leaving just the function pointer</p>



<a name="264963795"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122651-general/topic/function%20pointers%20without%20transmute/near/264963795" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Winter <a href="https://zulip-archive.rust-lang.org/stream/122651-general/topic/function.20pointers.20without.20transmute.html#264963795">(Dec 15 2021 at 04:22)</a>:</h4>
<p>oh</p>



<a name="264963802"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122651-general/topic/function%20pointers%20without%20transmute/near/264963802" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Winter <a href="https://zulip-archive.rust-lang.org/stream/122651-general/topic/function.20pointers.20without.20transmute.html#264963802">(Dec 15 2021 at 04:22)</a>:</h4>
<p>right</p>



<a name="264963816"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122651-general/topic/function%20pointers%20without%20transmute/near/264963816" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Winter <a href="https://zulip-archive.rust-lang.org/stream/122651-general/topic/function.20pointers.20without.20transmute.html#264963816">(Dec 15 2021 at 04:22)</a>:</h4>
<p>but wait</p>



<a name="264963819"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122651-general/topic/function%20pointers%20without%20transmute/near/264963819" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Winter <a href="https://zulip-archive.rust-lang.org/stream/122651-general/topic/function.20pointers.20without.20transmute.html#264963819">(Dec 15 2021 at 04:22)</a>:</h4>
<p>so</p>



<a name="264963861"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122651-general/topic/function%20pointers%20without%20transmute/near/264963861" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Winter <a href="https://zulip-archive.rust-lang.org/stream/122651-general/topic/function.20pointers.20without.20transmute.html#264963861">(Dec 15 2021 at 04:23)</a>:</h4>
<p>so if you drop the final reference from that expression, it’s just of T, and if you drop the final dereference, it’s *T</p>



<a name="264963866"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122651-general/topic/function%20pointers%20without%20transmute/near/264963866" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Winter <a href="https://zulip-archive.rust-lang.org/stream/122651-general/topic/function.20pointers.20without.20transmute.html#264963866">(Dec 15 2021 at 04:24)</a>:</h4>
<p>okay i think I’m understanding this</p>



<a name="264963968"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122651-general/topic/function%20pointers%20without%20transmute/near/264963968" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jacob Lifshay <a href="https://zulip-archive.rust-lang.org/stream/122651-general/topic/function.20pointers.20without.20transmute.html#264963968">(Dec 15 2021 at 04:25)</a>:</h4>
<p>umm, <code>T</code> is some function pointer...</p>



<a name="264963977"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122651-general/topic/function%20pointers%20without%20transmute/near/264963977" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Winter <a href="https://zulip-archive.rust-lang.org/stream/122651-general/topic/function.20pointers.20without.20transmute.html#264963977">(Dec 15 2021 at 04:25)</a>:</h4>
<p>well yes</p>



<a name="264964034"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122651-general/topic/function%20pointers%20without%20transmute/near/264964034" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Winter <a href="https://zulip-archive.rust-lang.org/stream/122651-general/topic/function.20pointers.20without.20transmute.html#264964034">(Dec 15 2021 at 04:26)</a>:</h4>
<p>by “the expression” i meant the deref body</p>



<a name="264964057"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122651-general/topic/function%20pointers%20without%20transmute/near/264964057" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jacob Lifshay <a href="https://zulip-archive.rust-lang.org/stream/122651-general/topic/function.20pointers.20without.20transmute.html#264964057">(Dec 15 2021 at 04:26)</a>:</h4>
<p>so <code>*T</code> isn't ever valid (unless your trying to read the machine code in the function)</p>



<a name="264964101"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122651-general/topic/function%20pointers%20without%20transmute/near/264964101" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Winter <a href="https://zulip-archive.rust-lang.org/stream/122651-general/topic/function.20pointers.20without.20transmute.html#264964101">(Dec 15 2021 at 04:27)</a>:</h4>
<p>oh, my mistake, by *T i meant *const T</p>



<a name="264964105"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122651-general/topic/function%20pointers%20without%20transmute/near/264964105" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Winter <a href="https://zulip-archive.rust-lang.org/stream/122651-general/topic/function.20pointers.20without.20transmute.html#264964105">(Dec 15 2021 at 04:27)</a>:</h4>
<p>i meant a pointer to T</p>



<a name="264964107"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122651-general/topic/function%20pointers%20without%20transmute/near/264964107" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jacob Lifshay <a href="https://zulip-archive.rust-lang.org/stream/122651-general/topic/function.20pointers.20without.20transmute.html#264964107">(Dec 15 2021 at 04:27)</a>:</h4>
<p>oh, yeah</p>



<a name="264964233"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122651-general/topic/function%20pointers%20without%20transmute/near/264964233" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jacob Lifshay <a href="https://zulip-archive.rust-lang.org/stream/122651-general/topic/function.20pointers.20without.20transmute.html#264964233">(Dec 15 2021 at 04:29)</a>:</h4>
<blockquote>
<p>so if you drop the final reference from that expression, it’s just of T, and if you drop the final dereference, it’s *T</p>
</blockquote>
<p>that's correct, since you meant <code>*const T</code> by <code>*T</code></p>



<a name="264964364"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122651-general/topic/function%20pointers%20without%20transmute/near/264964364" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Winter <a href="https://zulip-archive.rust-lang.org/stream/122651-general/topic/function.20pointers.20without.20transmute.html#264964364">(Dec 15 2021 at 04:31)</a>:</h4>
<p>is there any particular reason this manual way is done instead of using transmute_copy?</p>



<a name="264964446"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122651-general/topic/function%20pointers%20without%20transmute/near/264964446" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jacob Lifshay <a href="https://zulip-archive.rust-lang.org/stream/122651-general/topic/function.20pointers.20without.20transmute.html#264964446">(Dec 15 2021 at 04:32)</a>:</h4>
<p>cuz transmute copy would return a function pointer, rather than a reference to a function pointer, as needed by deref's return type</p>



<a name="264964469"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122651-general/topic/function%20pointers%20without%20transmute/near/264964469" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jacob Lifshay <a href="https://zulip-archive.rust-lang.org/stream/122651-general/topic/function.20pointers.20without.20transmute.html#264964469">(Dec 15 2021 at 04:33)</a>:</h4>
<p>or so i'd assume</p>



<a name="264965360"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122651-general/topic/function%20pointers%20without%20transmute/near/264965360" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Winter <a href="https://zulip-archive.rust-lang.org/stream/122651-general/topic/function.20pointers.20without.20transmute.html#264965360">(Dec 15 2021 at 04:48)</a>:</h4>
<p>ah fair</p>



<a name="264965376"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122651-general/topic/function%20pointers%20without%20transmute/near/264965376" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Winter <a href="https://zulip-archive.rust-lang.org/stream/122651-general/topic/function.20pointers.20without.20transmute.html#264965376">(Dec 15 2021 at 04:48)</a>:</h4>
<p>thanks for the help</p>



<hr><p>Last updated: Apr 12 2022 at 20:01 UTC</p>
</html>