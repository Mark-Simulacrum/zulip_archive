<html>
<head><meta charset="utf-8"><title>x.py check default targets · general · Zulip Chat Archive</title></head>
<h2>Stream: <a href="https://zulip-archive.rust-lang.org/stream/122651-general/index.html">general</a></h2>
<h3>Topic: <a href="https://zulip-archive.rust-lang.org/stream/122651-general/topic/x.2Epy.20check.20default.20targets.html">x.py check default targets</a></h3>

<hr>

<base href="https://rust-lang.zulipchat.com">

<head><link href="https://zulip-archive.rust-lang.org/style.css" rel="stylesheet"></head>

<a name="250405056"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122651-general/topic/x.py%20check%20default%20targets/near/250405056" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> matthiaskrgr <a href="https://zulip-archive.rust-lang.org/stream/122651-general/topic/x.2Epy.20check.20default.20targets.html#250405056">(Aug 23 2021 at 20:12)</a>:</h4>
<p>./x.py check recently had a change that would make it check --all-targets by default. Is there a flag to only check the old "default" targets?<br>
I'm asking because ./x.py clippy is also affected and checking the tests and so on can be quite noisy</p>



<a name="250406058"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122651-general/topic/x.py%20check%20default%20targets/near/250406058" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Nelson <a href="https://zulip-archive.rust-lang.org/stream/122651-general/topic/x.2Epy.20check.20default.20targets.html#250406058">(Aug 23 2021 at 20:20)</a>:</h4>
<p>No, but it seems reasonable to add one</p>



<a name="250406064"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122651-general/topic/x.py%20check%20default%20targets/near/250406064" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Nelson <a href="https://zulip-archive.rust-lang.org/stream/122651-general/topic/x.2Epy.20check.20default.20targets.html#250406064">(Aug 23 2021 at 20:20)</a>:</h4>
<p>What do you mean by noisy?</p>



<a name="250406458"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122651-general/topic/x.py%20check%20default%20targets/near/250406458" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> matthiaskrgr <a href="https://zulip-archive.rust-lang.org/stream/122651-general/topic/x.2Epy.20check.20default.20targets.html#250406458">(Aug 23 2021 at 20:24)</a>:</h4>
<p>If you are testing that your <code>.clone()</code>produces correct data for example, you don't want clippy to complain about redundant_clone or something like that :D</p>



<a name="250417403"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122651-general/topic/x.py%20check%20default%20targets/near/250417403" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Nelson <a href="https://zulip-archive.rust-lang.org/stream/122651-general/topic/x.2Epy.20check.20default.20targets.html#250417403">(Aug 23 2021 at 21:56)</a>:</h4>
<p>Oh I see, I thought you meant <code>x.py check src/tools/clippy</code></p>



<a name="250417415"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122651-general/topic/x.py%20check%20default%20targets/near/250417415" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Nelson <a href="https://zulip-archive.rust-lang.org/stream/122651-general/topic/x.2Epy.20check.20default.20targets.html#250417415">(Aug 23 2021 at 21:56)</a>:</h4>
<p>Yes, I agree it should be opt-in for x.py clippy</p>



<a name="250418404"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122651-general/topic/x.py%20check%20default%20targets/near/250418404" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> simulacrum <a href="https://zulip-archive.rust-lang.org/stream/122651-general/topic/x.2Epy.20check.20default.20targets.html#250418404">(Aug 23 2021 at 22:07)</a>:</h4>
<p>Hm, it seems plausible that x.py clippy should have different behavior; to be honest it doesn't really enter my calculus when making decisions for x.py much. I don't use clippy myself so not sure what the strategy should be.</p>



<a name="251299531"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122651-general/topic/x.py%20check%20default%20targets/near/251299531" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> matthiaskrgr <a href="https://zulip-archive.rust-lang.org/stream/122651-general/topic/x.2Epy.20check.20default.20targets.html#251299531">(Aug 30 2021 at 21:41)</a>:</h4>
<p>I opened <a href="https://github.com/rust-lang/rust/pull/88511">https://github.com/rust-lang/rust/pull/88511</a></p>



<a name="251299758"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122651-general/topic/x.py%20check%20default%20targets/near/251299758" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> matthiaskrgr <a href="https://zulip-archive.rust-lang.org/stream/122651-general/topic/x.2Epy.20check.20default.20targets.html#251299758">(Aug 30 2021 at 21:43)</a>:</h4>
<p>not too happy about the solution but something like going into the std::process::Command, inspecting the args list and removing <code>--all-targets</code> from it if <code>builder.kind == Kind::Clippy</code> seemed somewhat difficult <span aria-label="sweat" class="emoji emoji-1f613" role="img" title="sweat">:sweat:</span></p>



<a name="251300163"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122651-general/topic/x.py%20check%20default%20targets/near/251300163" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Nelson <a href="https://zulip-archive.rust-lang.org/stream/122651-general/topic/x.2Epy.20check.20default.20targets.html#251300163">(Aug 30 2021 at 21:47)</a>:</h4>
<p><span class="user-mention silent" data-user-id="217864">matthiaskrgr</span> <a href="#narrow/stream/122651-general/topic/x.2Epy.20check.20default.20targets/near/251299758">said</a>:</p>
<blockquote>
<p>not too happy about the solution but something like going into the std::process::Command, inspecting the args list and removing <code>--all-targets</code> from it if <code>builder.kind == Kind::Clippy</code> seemed somewhat difficult <span aria-label="sweat" class="emoji emoji-1f613" role="img" title="sweat">:sweat:</span></p>
</blockquote>
<p>nah, I think this is a better solution</p>



<a name="251300226"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122651-general/topic/x.py%20check%20default%20targets/near/251300226" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Nelson <a href="https://zulip-archive.rust-lang.org/stream/122651-general/topic/x.2Epy.20check.20default.20targets.html#251300226">(Aug 30 2021 at 21:48)</a>:</h4>
<p>and your other idea would prevent CARGOFLAGS=--all-targets</p>



<a name="251300241"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122651-general/topic/x.py%20check%20default%20targets/near/251300241" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Nelson <a href="https://zulip-archive.rust-lang.org/stream/122651-general/topic/x.2Epy.20check.20default.20targets.html#251300241">(Aug 30 2021 at 21:48)</a>:</h4>
<p>left a review</p>



<hr><p>Last updated: Apr 12 2022 at 20:01 UTC</p>
</html>