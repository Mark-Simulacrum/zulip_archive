<html>
<head><meta charset="utf-8"><title>test profile opt-level · general · Zulip Chat Archive</title></head>
<h2>Stream: <a href="https://zulip-archive.rust-lang.org/stream/122651-general/index.html">general</a></h2>
<h3>Topic: <a href="https://zulip-archive.rust-lang.org/stream/122651-general/topic/test.20profile.20opt-level.html">test profile opt-level</a></h3>

<hr>

<base href="https://rust-lang.zulipchat.com">

<head><link href="https://zulip-archive.rust-lang.org/style.css" rel="stylesheet"></head>

<a name="267814186"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122651-general/topic/test%20profile%20opt-level/near/267814186" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joel Pedraza <a href="https://zulip-archive.rust-lang.org/stream/122651-general/topic/test.20profile.20opt-level.html#267814186">(Jan 13 2022 at 01:57)</a>:</h4>
<p>Soliciting reason(s) not to set [profile.test] opt-level = N &gt; 0?</p>
<p>Cant help but think if this was a universally good idea it would be the default.</p>



<a name="267814451"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122651-general/topic/test%20profile%20opt-level/near/267814451" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Noah Lev <a href="https://zulip-archive.rust-lang.org/stream/122651-general/topic/test.20profile.20opt-level.html#267814451">(Jan 13 2022 at 02:00)</a>:</h4>
<p>It would cause recompiles if the non-test profile were <code>opt-level = 0</code>.</p>



<a name="268059066"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122651-general/topic/test%20profile%20opt-level/near/268059066" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Josh Triplett <a href="https://zulip-archive.rust-lang.org/stream/122651-general/topic/test.20profile.20opt-level.html#268059066">(Jan 14 2022 at 19:15)</a>:</h4>
<p>It builds slower, and when you're testing you often want quicker feedback.</p>



<a name="268059145"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122651-general/topic/test%20profile%20opt-level/near/268059145" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Josh Triplett <a href="https://zulip-archive.rust-lang.org/stream/122651-general/topic/test.20profile.20opt-level.html#268059145">(Jan 14 2022 at 19:16)</a>:</h4>
<p>If your crate benefits strongly from optimization, to the point that your tests will run much slower without optimization, it's worth setting opt-level in your test profile.</p>



<a name="268061071"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122651-general/topic/test%20profile%20opt-level/near/268061071" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Connor Horman <a href="https://zulip-archive.rust-lang.org/stream/122651-general/topic/test.20profile.20opt-level.html#268061071">(Jan 14 2022 at 19:32)</a>:</h4>
<p>I think it can be useful in the general case, though. At some point, even if the crate itself doesn't benefit much in terms of individual tests running slower, if you have a lot of tests, the total time for tests will eventually dominate over the compilation time.</p>



<a name="268066736"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122651-general/topic/test%20profile%20opt-level/near/268066736" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> bjorn3 <a href="https://zulip-archive.rust-lang.org/stream/122651-general/topic/test.20profile.20opt-level.html#268066736">(Jan 14 2022 at 20:18)</a>:</h4>
<p>I believe you can also do <code>cargo test --release</code>. That may disable debug assertions though.</p>



<a name="268068666"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122651-general/topic/test%20profile%20opt-level/near/268068666" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> The 8472 <a href="https://zulip-archive.rust-lang.org/stream/122651-general/topic/test.20profile.20opt-level.html#268068666">(Jan 14 2022 at 20:30)</a>:</h4>
<p><span class="user-mention" data-user-id="257758">@Connor Horman</span> more tests would also mean more compiletime</p>



<a name="268068769"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122651-general/topic/test%20profile%20opt-level/near/268068769" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Connor Horman <a href="https://zulip-archive.rust-lang.org/stream/122651-general/topic/test.20profile.20opt-level.html#268068769">(Jan 14 2022 at 20:31)</a>:</h4>
<p>I doubt it would be significantly more, though. Or rather, I still think that execution time will exceed compile time for some large number of tests or more in general.</p>



<a name="268069345"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122651-general/topic/test%20profile%20opt-level/near/268069345" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Noah Lev <a href="https://zulip-archive.rust-lang.org/stream/122651-general/topic/test.20profile.20opt-level.html#268069345">(Jan 14 2022 at 20:36)</a>:</h4>
<p>But in that case you can just set <code>opt-level = 1</code> yourself</p>



<hr><p>Last updated: Apr 12 2022 at 20:01 UTC</p>
</html>