<html>
<head><meta charset="utf-8"><title>x.py and /usr/bin/env python · general · Zulip Chat Archive</title></head>
<h2>Stream: <a href="https://zulip-archive.rust-lang.org/stream/122651-general/index.html">general</a></h2>
<h3>Topic: <a href="https://zulip-archive.rust-lang.org/stream/122651-general/topic/x.2Epy.20and.20.2Fusr.2Fbin.2Fenv.20python.html">x.py and /usr/bin/env python</a></h3>

<hr>

<base href="https://rust-lang.zulipchat.com">

<head><link href="https://zulip-archive.rust-lang.org/style.css" rel="stylesheet"></head>

<a name="270774496"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122651-general/topic/x.py%20and%20/usr/bin/env%20python/near/270774496" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Alyssa Haroldsen [she] <a href="https://zulip-archive.rust-lang.org/stream/122651-general/topic/x.2Epy.20and.20.2Fusr.2Fbin.2Fenv.20python.html#270774496">(Feb 04 2022 at 21:22)</a>:</h4>
<p>x.py defines <code>#/usr/bin/env python</code> in its first line. Conventionally, <code>python</code> points to Python 2, and some systems define it as pointing to Python 3. However, some systems don't define <code>python</code> at all to opt out of the ambiguity - including my own. Considering Python 2 is 2 years deprecated, is there any reason to not just switch it to saying python3 explicitly?</p>



<a name="270777791"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122651-general/topic/x.py%20and%20/usr/bin/env%20python/near/270777791" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> The 8472 <a href="https://zulip-archive.rust-lang.org/stream/122651-general/topic/x.2Epy.20and.20.2Fusr.2Fbin.2Fenv.20python.html#270777791">(Feb 04 2022 at 21:51)</a>:</h4>
<p>CI runs on some ancient distros to ensure backwards compatibility</p>



<a name="270777817"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122651-general/topic/x.py%20and%20/usr/bin/env%20python/near/270777817" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Pietro Albini <a href="https://zulip-archive.rust-lang.org/stream/122651-general/topic/x.2Epy.20and.20.2Fusr.2Fbin.2Fenv.20python.html#270777817">(Feb 04 2022 at 21:51)</a>:</h4>
<p>I'm pretty sure we're using py3 on those CIs though</p>



<a name="270777891"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122651-general/topic/x.py%20and%20/usr/bin/env%20python/near/270777891" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> The 8472 <a href="https://zulip-archive.rust-lang.org/stream/122651-general/topic/x.2Epy.20and.20.2Fusr.2Fbin.2Fenv.20python.html#270777891">(Feb 04 2022 at 21:52)</a>:</h4>
<p>Hrm, ok</p>



<a name="270777966"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122651-general/topic/x.py%20and%20/usr/bin/env%20python/near/270777966" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> The 8472 <a href="https://zulip-archive.rust-lang.org/stream/122651-general/topic/x.2Epy.20and.20.2Fusr.2Fbin.2Fenv.20python.html#270777966">(Feb 04 2022 at 21:53)</a>:</h4>
<p>At least the llvm 12 builder does</p>
<div class="codehilite"><pre><span></span><code>ENV SCRIPT python2.7 ../x.py --stage 2 test --exclude src/tools/tidy &amp;&amp; \
</code></pre></div>



<a name="270777998"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122651-general/topic/x.py%20and%20/usr/bin/env%20python/near/270777998" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> simulacrum <a href="https://zulip-archive.rust-lang.org/stream/122651-general/topic/x.2Epy.20and.20.2Fusr.2Fbin.2Fenv.20python.html#270777998">(Feb 04 2022 at 21:53)</a>:</h4>
<p>python3 is not available on Windows, IIRC, or vice-versa</p>



<a name="270778100"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122651-general/topic/x.py%20and%20/usr/bin/env%20python/near/270778100" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> simulacrum <a href="https://zulip-archive.rust-lang.org/stream/122651-general/topic/x.2Epy.20and.20.2Fusr.2Fbin.2Fenv.20python.html#270778100">(Feb 04 2022 at 21:54)</a>:</h4>
<p>My recollection is that there is no executable name that is actually available across (macOS, Linux, Windows) even that corresponds to Python 3.x or 2.x</p>



<a name="270778110"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122651-general/topic/x.py%20and%20/usr/bin/env%20python/near/270778110" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> The 8472 <a href="https://zulip-archive.rust-lang.org/stream/122651-general/topic/x.2Epy.20and.20.2Fusr.2Fbin.2Fenv.20python.html#270778110">(Feb 04 2022 at 21:54)</a>:</h4>
<p>If you're on a debian flavor you can install <code>python-is-python3</code></p>



<a name="270778145"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122651-general/topic/x.py%20and%20/usr/bin/env%20python/near/270778145" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> simulacrum <a href="https://zulip-archive.rust-lang.org/stream/122651-general/topic/x.2Epy.20and.20.2Fusr.2Fbin.2Fenv.20python.html#270778145">(Feb 04 2022 at 21:54)</a>:</h4>
<p>If that's changed, then I'd be happy to accept a PR updating the file, but otherwise I'm inclined to leave it as-is and recommend e.g. python-is-python3 as <span class="user-mention" data-user-id="330154">@The 8472</span> mentions.</p>



<a name="270778146"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122651-general/topic/x.py%20and%20/usr/bin/env%20python/near/270778146" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Pietro Albini <a href="https://zulip-archive.rust-lang.org/stream/122651-general/topic/x.2Epy.20and.20.2Fusr.2Fbin.2Fenv.20python.html#270778146">(Feb 04 2022 at 21:54)</a>:</h4>
<p><a href="https://github.com/rust-lang/rust/blob/71226d717a1fb57122e47e63b97295e703319cb0/src/ci/docker/host-x86_64/dist-x86_64-linux/Dockerfile">https://github.com/rust-lang/rust/blob/71226d717a1fb57122e47e63b97295e703319cb0/src/ci/docker/host-x86_64/dist-x86_64-linux/Dockerfile</a></p>



<a name="270779085"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122651-general/topic/x.py%20and%20/usr/bin/env%20python/near/270779085" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Chris Denton <a href="https://zulip-archive.rust-lang.org/stream/122651-general/topic/x.2Epy.20and.20.2Fusr.2Fbin.2Fenv.20python.html#270779085">(Feb 04 2022 at 22:03)</a>:</h4>
<p><span class="user-mention silent" data-user-id="116122">simulacrum</span> <a href="#narrow/stream/122651-general/topic/x.2Epy.20and.20.2Fusr.2Fbin.2Fenv.20python/near/270777998">said</a>:</p>
<blockquote>
<p>python3 is not available on Windows, IIRC, or vice-versa</p>
</blockquote>
<p>It depends how you install Python. The official installer uses a weird "py -3" for running python3 (idk why, legacy maybe). If you install via the Windows store then there is a "python3".</p>



<a name="270779594"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122651-general/topic/x.py%20and%20/usr/bin/env%20python/near/270779594" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> simulacrum <a href="https://zulip-archive.rust-lang.org/stream/122651-general/topic/x.2Epy.20and.20.2Fusr.2Fbin.2Fenv.20python.html#270779594">(Feb 04 2022 at 22:08)</a>:</h4>
<p>Yeah, sure. Basically I think the current situation is bad, and if someone has data (e.g., that across common platforms a majority have a python3) then switching seems OK, I guess. Otherwise it doesn't seem worth it to me.</p>



<a name="270786161"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122651-general/topic/x.py%20and%20/usr/bin/env%20python/near/270786161" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Josh Triplett <a href="https://zulip-archive.rust-lang.org/stream/122651-general/topic/x.2Epy.20and.20.2Fusr.2Fbin.2Fenv.20python.html#270786161">(Feb 04 2022 at 23:18)</a>:</h4>
<p><span class="user-mention silent" data-user-id="330154">The 8472</span> <a href="#narrow/stream/122651-general/topic/x.2Epy.20and.20.2Fusr.2Fbin.2Fenv.20python/near/270778110">said</a>:</p>
<blockquote>
<p>If you're on a debian flavor you can install <code>python-is-python3</code></p>
</blockquote>
<p>I would very much recommend not doing that, though, because <em>many</em> scripts use <code>#!/usr/bin/python</code> or <code>#!/usr/bin/env python</code> and assume Python 2.</p>



<a name="270786186"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122651-general/topic/x.py%20and%20/usr/bin/env%20python/near/270786186" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Josh Triplett <a href="https://zulip-archive.rust-lang.org/stream/122651-general/topic/x.2Epy.20and.20.2Fusr.2Fbin.2Fenv.20python.html#270786186">(Feb 04 2022 at 23:19)</a>:</h4>
<p>Could we make the script use <code>#!/bin/sh</code> and then go find the right version of Python and run ourselves?</p>



<a name="270786209"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122651-general/topic/x.py%20and%20/usr/bin/env%20python/near/270786209" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Josh Triplett <a href="https://zulip-archive.rust-lang.org/stream/122651-general/topic/x.2Epy.20and.20.2Fusr.2Fbin.2Fenv.20python.html#270786209">(Feb 04 2022 at 23:20)</a>:</h4>
<p>I thought I remembered seeing a PR that tried to do that.</p>



<a name="270786383"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122651-general/topic/x.py%20and%20/usr/bin/env%20python/near/270786383" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Josh Triplett <a href="https://zulip-archive.rust-lang.org/stream/122651-general/topic/x.2Epy.20and.20.2Fusr.2Fbin.2Fenv.20python.html#270786383">(Feb 04 2022 at 23:21)</a>:</h4>
<div class="codehilite"><pre><span></span><code><span class="ch">#!/bin/sh</span>
<span class="nv">python_ignores_this</span> <span class="o">=</span> <span class="s2">&quot;&quot;&quot;</span>
<span class="s2"># shell script to find Python 3 and exec that with </span><span class="nv">$0</span><span class="s2"> goes here</span>
<span class="s2">&quot;&quot;&quot;</span>
<span class="c1"># Python script goes here</span>
</code></pre></div>



<a name="270786529"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122651-general/topic/x.py%20and%20/usr/bin/env%20python/near/270786529" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Josh Triplett <a href="https://zulip-archive.rust-lang.org/stream/122651-general/topic/x.2Epy.20and.20.2Fusr.2Fbin.2Fenv.20python.html#270786529">(Feb 04 2022 at 23:23)</a>:</h4>
<p><span class="user-mention" data-user-id="260325">@Chris Denton</span> If we asked the Python installer folks, they might be willing to add a <code>python3</code> for consistency.</p>



<a name="270787935"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122651-general/topic/x.py%20and%20/usr/bin/env%20python/near/270787935" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Alyssa Haroldsen [she] <a href="https://zulip-archive.rust-lang.org/stream/122651-general/topic/x.2Epy.20and.20.2Fusr.2Fbin.2Fenv.20python.html#270787935">(Feb 04 2022 at 23:41)</a>:</h4>
<p><span class="user-mention silent" data-user-id="330154">The 8472</span> <a href="#narrow/stream/122651-general/topic/x.2Epy.20and.20.2Fusr.2Fbin.2Fenv.20python/near/270778110">said</a>:</p>
<blockquote>
<p>If you're on a debian flavor you can install <code>python-is-python3</code></p>
</blockquote>
<p>Ah, thank you! I'm not running any Python 2 code to my knowledge, so this is a good mitigation for my case.</p>



<a name="270789319"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122651-general/topic/x.py%20and%20/usr/bin/env%20python/near/270789319" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> simulacrum <a href="https://zulip-archive.rust-lang.org/stream/122651-general/topic/x.2Epy.20and.20.2Fusr.2Fbin.2Fenv.20python.html#270789319">(Feb 04 2022 at 23:58)</a>:</h4>
<p><span class="user-mention silent" data-user-id="239881">Josh Triplett</span> <a href="#narrow/stream/122651-general/topic/x.2Epy.20and.20.2Fusr.2Fbin.2Fenv.20python/near/270786186">said</a>:</p>
<blockquote>
<p>Could we make the script use <code>#!/bin/sh</code> and then go find the right version of Python and run ourselves?</p>
</blockquote>
<p>IIRC, we didn't do that because on Windows that sort of thing doesn't work? (Maybe /bin/sh is not typically present)?</p>



<a name="270789577"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122651-general/topic/x.py%20and%20/usr/bin/env%20python/near/270789577" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Josh Triplett <a href="https://zulip-archive.rust-lang.org/stream/122651-general/topic/x.2Epy.20and.20.2Fusr.2Fbin.2Fenv.20python.html#270789577">(Feb 05 2022 at 00:00)</a>:</h4>
<p><span class="user-mention" data-user-id="116122">@simulacrum</span> We could add an x.bat for Windows. :)</p>



<a name="270789619"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122651-general/topic/x.py%20and%20/usr/bin/env%20python/near/270789619" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> simulacrum <a href="https://zulip-archive.rust-lang.org/stream/122651-general/topic/x.2Epy.20and.20.2Fusr.2Fbin.2Fenv.20python.html#270789619">(Feb 05 2022 at 00:01)</a>:</h4>
<p>I'm not sure that's worth it. Not sure.</p>



<a name="270789637"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122651-general/topic/x.py%20and%20/usr/bin/env%20python/near/270789637" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> simulacrum <a href="https://zulip-archive.rust-lang.org/stream/122651-general/topic/x.2Epy.20and.20.2Fusr.2Fbin.2Fenv.20python.html#270789637">(Feb 05 2022 at 00:01)</a>:</h4>
<p>Feels annoying, particularly for docs/copy-pasting etc</p>



<a name="270789646"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122651-general/topic/x.py%20and%20/usr/bin/env%20python/near/270789646" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Josh Triplett <a href="https://zulip-archive.rust-lang.org/stream/122651-general/topic/x.2Epy.20and.20.2Fusr.2Fbin.2Fenv.20python.html#270789646">(Feb 05 2022 at 00:01)</a>:</h4>
<p>Not going to argue with that. :)</p>



<a name="270789677"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122651-general/topic/x.py%20and%20/usr/bin/env%20python/near/270789677" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Josh Triplett <a href="https://zulip-archive.rust-lang.org/stream/122651-general/topic/x.2Epy.20and.20.2Fusr.2Fbin.2Fenv.20python.html#270789677">(Feb 05 2022 at 00:01)</a>:</h4>
<p>I'm not sure either. But I'd love to stop running <code>python3 x.py</code>, and have <code>./x.py</code> just work on systems that don't have a <code>/usr/bin/python</code>.</p>



<a name="270789750"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122651-general/topic/x.py%20and%20/usr/bin/env%20python/near/270789750" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Josh Triplett <a href="https://zulip-archive.rust-lang.org/stream/122651-general/topic/x.2Epy.20and.20.2Fusr.2Fbin.2Fenv.20python.html#270789750">(Feb 05 2022 at 00:02)</a>:</h4>
<p>If we got the official Python installer to install a python3 binary, I wonder if that'd tip the balance in favor of being able to use <code>#!/usr/bin/env python3</code>.</p>



<a name="270789751"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122651-general/topic/x.py%20and%20/usr/bin/env%20python/near/270789751" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> simulacrum <a href="https://zulip-archive.rust-lang.org/stream/122651-general/topic/x.2Epy.20and.20.2Fusr.2Fbin.2Fenv.20python.html#270789751">(Feb 05 2022 at 00:02)</a>:</h4>
<p>Well, if we can bug the Python installer on Windows(?) to give us a python3 binary, then we can do that, I think</p>



<a name="270789794"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122651-general/topic/x.py%20and%20/usr/bin/env%20python/near/270789794" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> simulacrum <a href="https://zulip-archive.rust-lang.org/stream/122651-general/topic/x.2Epy.20and.20.2Fusr.2Fbin.2Fenv.20python.html#270789794">(Feb 05 2022 at 00:02)</a>:</h4>
<p>/me is somewhat sad that this isn't already the case, but what can you do.</p>



<a name="270789857"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122651-general/topic/x.py%20and%20/usr/bin/env%20python/near/270789857" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> simulacrum <a href="https://zulip-archive.rust-lang.org/stream/122651-general/topic/x.2Epy.20and.20.2Fusr.2Fbin.2Fenv.20python.html#270789857">(Feb 05 2022 at 00:03)</a>:</h4>
<p>I think both (most) Linux and macOS systems already have python3 (at least relatively recent ones), so there we should be good - it's windows that causes the problem, typically.</p>



<a name="270792447"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122651-general/topic/x.py%20and%20/usr/bin/env%20python/near/270792447" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Josh Triplett <a href="https://zulip-archive.rust-lang.org/stream/122651-general/topic/x.2Epy.20and.20.2Fusr.2Fbin.2Fenv.20python.html#270792447">(Feb 05 2022 at 00:42)</a>:</h4>
<p>I'm looking on the Python issue tracker to see if they have any existing issue about this.</p>



<a name="270792472"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122651-general/topic/x.py%20and%20/usr/bin/env%20python/near/270792472" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Josh Triplett <a href="https://zulip-archive.rust-lang.org/stream/122651-general/topic/x.2Epy.20and.20.2Fusr.2Fbin.2Fenv.20python.html#270792472">(Feb 05 2022 at 00:43)</a>:</h4>
<p>Hmmm. Do you have a Windows system handy?</p>



<a name="270792530"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122651-general/topic/x.py%20and%20/usr/bin/env%20python/near/270792530" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Josh Triplett <a href="https://zulip-archive.rust-lang.org/stream/122651-general/topic/x.2Epy.20and.20.2Fusr.2Fbin.2Fenv.20python.html#270792530">(Feb 05 2022 at 00:44)</a>:</h4>
<p><span class="user-mention" data-user-id="260325">@Chris Denton</span> Do you have a Windows system handy with Python installed via the official Python installer, not the Microsoft store?</p>



<a name="270792687"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122651-general/topic/x.py%20and%20/usr/bin/env%20python/near/270792687" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Chris Denton <a href="https://zulip-archive.rust-lang.org/stream/122651-general/topic/x.2Epy.20and.20.2Fusr.2Fbin.2Fenv.20python.html#270792687">(Feb 05 2022 at 00:46)</a>:</h4>
<p>I can spin up a VM easily enough.</p>



<a name="270792739"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122651-general/topic/x.py%20and%20/usr/bin/env%20python/near/270792739" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Josh Triplett <a href="https://zulip-archive.rust-lang.org/stream/122651-general/topic/x.2Epy.20and.20.2Fusr.2Fbin.2Fenv.20python.html#270792739">(Feb 05 2022 at 00:47)</a>:</h4>
<p><span class="user-mention" data-user-id="116122">@simulacrum</span> It looks like there's at least one person on the Python team who is violently opposed to shipping <code>python3.exe</code>, and it sounds like that'd take some convincing. Still worth trying, though, and in particular, it seems like they don't really care much about compatibility with Linux, and it'd be worth trying to convince them that we have a cross-platform issue here.</p>



<a name="270792751"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122651-general/topic/x.py%20and%20/usr/bin/env%20python/near/270792751" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Josh Triplett <a href="https://zulip-archive.rust-lang.org/stream/122651-general/topic/x.2Epy.20and.20.2Fusr.2Fbin.2Fenv.20python.html#270792751">(Feb 05 2022 at 00:47)</a>:</h4>
<p><span class="user-mention" data-user-id="260325">@Chris Denton</span> Could you confirm that the official Python installer for Windows doesn't install a <code>python3.exe</code> anywhere in the installation?</p>



<a name="270792759"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122651-general/topic/x.py%20and%20/usr/bin/env%20python/near/270792759" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Josh Triplett <a href="https://zulip-archive.rust-lang.org/stream/122651-general/topic/x.2Epy.20and.20.2Fusr.2Fbin.2Fenv.20python.html#270792759">(Feb 05 2022 at 00:47)</a>:</h4>
<p>Only <code>python.exe</code>?</p>



<a name="270792960"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122651-general/topic/x.py%20and%20/usr/bin/env%20python/near/270792960" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Chris Denton <a href="https://zulip-archive.rust-lang.org/stream/122651-general/topic/x.2Epy.20and.20.2Fusr.2Fbin.2Fenv.20python.html#270792960">(Feb 05 2022 at 00:50)</a>:</h4>
<p>Yep. It installs to <code>C:\Users\Me\AppData\Local\Programs\Python\Python310</code>. The only executables are <code>python.exe</code>, <code>pythonw.exe</code>. It also adds <code>C:\Windows\py.exe</code> which can by used to select a version.</p>



<a name="270793316"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122651-general/topic/x.py%20and%20/usr/bin/env%20python/near/270793316" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Josh Triplett <a href="https://zulip-archive.rust-lang.org/stream/122651-general/topic/x.2Epy.20and.20.2Fusr.2Fbin.2Fenv.20python.html#270793316">(Feb 05 2022 at 00:57)</a>:</h4>
<p>Thanks for confirming.</p>



<a name="270793331"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122651-general/topic/x.py%20and%20/usr/bin/env%20python/near/270793331" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Josh Triplett <a href="https://zulip-archive.rust-lang.org/stream/122651-general/topic/x.2Epy.20and.20.2Fusr.2Fbin.2Fenv.20python.html#270793331">(Feb 05 2022 at 00:57)</a>:</h4>
<p><span class="user-mention" data-user-id="116122">@simulacrum</span> Does current macOS ship /usr/bin/python pointing to python3, or does it not ship /usr/bin/python at all?</p>



<a name="270793337"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122651-general/topic/x.py%20and%20/usr/bin/env%20python/near/270793337" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Josh Triplett <a href="https://zulip-archive.rust-lang.org/stream/122651-general/topic/x.2Epy.20and.20.2Fusr.2Fbin.2Fenv.20python.html#270793337">(Feb 05 2022 at 00:57)</a>:</h4>
<p>Er, rephrasing...</p>



<a name="270793352"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122651-general/topic/x.py%20and%20/usr/bin/env%20python/near/270793352" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Josh Triplett <a href="https://zulip-archive.rust-lang.org/stream/122651-general/topic/x.2Epy.20and.20.2Fusr.2Fbin.2Fenv.20python.html#270793352">(Feb 05 2022 at 00:57)</a>:</h4>
<p>How do <code>#!/usr/bin/env python</code> and <code>#!/usr/bin/env python3</code> work on macOS?</p>



<a name="270793447"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122651-general/topic/x.py%20and%20/usr/bin/env%20python/near/270793447" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> simulacrum <a href="https://zulip-archive.rust-lang.org/stream/122651-general/topic/x.2Epy.20and.20.2Fusr.2Fbin.2Fenv.20python.html#270793447">(Feb 05 2022 at 00:58)</a>:</h4>
<p>I'll need to check when I'm back at my desk, but python's docs at least say The Apple-provided build of Python is installed in /System/Library/Frameworks/Python.framework and /usr/bin/python, respectively.</p>



<a name="270793885"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122651-general/topic/x.py%20and%20/usr/bin/env%20python/near/270793885" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> simulacrum <a href="https://zulip-archive.rust-lang.org/stream/122651-general/topic/x.2Epy.20and.20.2Fusr.2Fbin.2Fenv.20python.html#270793885">(Feb 05 2022 at 01:04)</a>:</h4>
<p>And homebrew installs python3 at least - <a href="https://github.com/Homebrew/homebrew-core/blob/HEAD/Formula/python@3.10.rb#L267">https://github.com/Homebrew/homebrew-core/blob/HEAD/Formula/python@3.10.rb#L267</a></p>



<a name="270793898"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122651-general/topic/x.py%20and%20/usr/bin/env%20python/near/270793898" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> simulacrum <a href="https://zulip-archive.rust-lang.org/stream/122651-general/topic/x.2Epy.20and.20.2Fusr.2Fbin.2Fenv.20python.html#270793898">(Feb 05 2022 at 01:05)</a>:</h4>
<p>So I suspect both work out of the box</p>



<a name="270794058"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122651-general/topic/x.py%20and%20/usr/bin/env%20python/near/270794058" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Josh Triplett <a href="https://zulip-archive.rust-lang.org/stream/122651-general/topic/x.2Epy.20and.20.2Fusr.2Fbin.2Fenv.20python.html#270794058">(Feb 05 2022 at 01:07)</a>:</h4>
<p>I was reading <a href="https://macmule.com/2022/01/29/macos-monterey-12-3-will-remove-python-2-7-usr-bin-python/">https://macmule.com/2022/01/29/macos-monterey-12-3-will-remove-python-2-7-usr-bin-python/</a> and wondering how that related.</p>



<a name="270794146"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122651-general/topic/x.py%20and%20/usr/bin/env%20python/near/270794146" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> simulacrum <a href="https://zulip-archive.rust-lang.org/stream/122651-general/topic/x.2Epy.20and.20.2Fusr.2Fbin.2Fenv.20python.html#270794146">(Feb 05 2022 at 01:09)</a>:</h4>
<p>Hm, well, maybe it's a short term happiness :(</p>



<a name="270794335"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122651-general/topic/x.py%20and%20/usr/bin/env%20python/near/270794335" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Eric Huss <a href="https://zulip-archive.rust-lang.org/stream/122651-general/topic/x.2Epy.20and.20.2Fusr.2Fbin.2Fenv.20python.html#270794335">(Feb 05 2022 at 01:12)</a>:</h4>
<p><code>/usr/bin/python</code> is python 2.  There's all sorts of warnings if you try to use it.  I use homebrew and set up my path so that <code>python</code> is python3.  I'm stubborn with my habits.</p>



<a name="270794475"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122651-general/topic/x.py%20and%20/usr/bin/env%20python/near/270794475" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Josh Triplett <a href="https://zulip-archive.rust-lang.org/stream/122651-general/topic/x.2Epy.20and.20.2Fusr.2Fbin.2Fenv.20python.html#270794475">(Feb 05 2022 at 01:14)</a>:</h4>
<p><span class="user-mention" data-user-id="260325">@Chris Denton</span> One other check: if you have a script with <code>#!/usr/bin/env python3</code>, does that work on a Windows system that has installed Python via the Microsoft store, and never used the official Python installer?</p>



<a name="270794823"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122651-general/topic/x.py%20and%20/usr/bin/env%20python/near/270794823" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Chris Denton <a href="https://zulip-archive.rust-lang.org/stream/122651-general/topic/x.2Epy.20and.20.2Fusr.2Fbin.2Fenv.20python.html#270794823">(Feb 05 2022 at 01:19)</a>:</h4>
<p>I think the shebang is entirely ignored. Shells will run it based on the file extension alone.</p>



<a name="270794837"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122651-general/topic/x.py%20and%20/usr/bin/env%20python/near/270794837" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Josh Triplett <a href="https://zulip-archive.rust-lang.org/stream/122651-general/topic/x.2Epy.20and.20.2Fusr.2Fbin.2Fenv.20python.html#270794837">(Feb 05 2022 at 01:19)</a>:</h4>
<p><span class="user-mention" data-user-id="260325">@Chris Denton</span> Right, but the question is what the file association for that extension <em>does</em> with that shebang.</p>



<a name="270794915"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122651-general/topic/x.py%20and%20/usr/bin/env%20python/near/270794915" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Josh Triplett <a href="https://zulip-archive.rust-lang.org/stream/122651-general/topic/x.2Epy.20and.20.2Fusr.2Fbin.2Fenv.20python.html#270794915">(Feb 05 2022 at 01:20)</a>:</h4>
<p>AFAICT, the official Python installer associates <code>.py</code> with a dispatch program that looks at the shebang.</p>



<a name="270794946"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122651-general/topic/x.py%20and%20/usr/bin/env%20python/near/270794946" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Josh Triplett <a href="https://zulip-archive.rust-lang.org/stream/122651-general/topic/x.2Epy.20and.20.2Fusr.2Fbin.2Fenv.20python.html#270794946">(Feb 05 2022 at 01:20)</a>:</h4>
<div class="spoiler-block"><div class="spoiler-header">
<p>Draft message to Python issue tracker</p>
</div><div class="spoiler-content" aria-hidden="true">
<p>I'm writing this issue on behalf of the Rust project.</p>
<p>The build system for the Rust compiler is a Python 3 script <code>x.py</code>, which orchestrates the build process for a user even if they don't already have Rust installed. (For instance, <code>x.py build</code>, <code>x.py test</code>, and various command-line arguments for more complex cases.)</p>
<p>We currently run into various issues making this script easy for people to use on all common platforms people build Rust on: Windows, macOS, and Linux.</p>
<p>If we use a shebang of <code>#!/usr/bin/env python3</code>, then x.py works for macOS and Linux users, and also works on Windows systems that install Python via the Windows store, but fails to run on Windows systems that install via the official Python installer, requiring users to explicitly invoke Python 3 on the script, and adding friction, support issues, and complexity to our documentation to help users debug that situation.</p>
<p>If we use a shebang of <code>#!/usr/bin/env python</code>, then x.py works for Windows users, fails on some modern macOS systems, works on other modern macOS systems (depending on installation method I think, e.g. homebrew vs Apple), fails on some modern Linux systems, and on macOS and Linux systems where it <em>does</em> work, it might be python2 or python3. So in practice, people often have to explicitly run <code>python3 x.py</code>, which again results in friction, support issues, and complexity in our documentation.</p>
<p>We've even considered things like <code>#!/bin/sh</code> and then writing a shell script hidden inside a Python triple-quoted string, but that doesn't work well on Windows where we can't count on the presence of a shell.</p>
<p>We'd love to write a single shebang that works for all of Windows, macOS, and Linux systems, and doesn't resort in recurring friction or support issues for us across the wide range of systems that our users use.</p>
<p>As far as we can tell, <code>#!/usr/bin/env python3</code> would work on all platforms, if the Python installer for Windows shipped a <code>python3.exe</code> and handled that shebang by using <code>python3.exe</code> as the interpreter.</p>
<p>Is that something that the official Python installer could consider adding, to make it easy for us to supply cross-platform Python 3 scripts that work out of the box for all our users?</p>
<p>Thank you,<br>
Josh Triplett, on behalf of many Rust team members</p>
</div></div>
<p>I'd love to get feedback on this before sending it.</p>



<a name="270794989"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122651-general/topic/x.py%20and%20/usr/bin/env%20python/near/270794989" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Josh Triplett <a href="https://zulip-archive.rust-lang.org/stream/122651-general/topic/x.2Epy.20and.20.2Fusr.2Fbin.2Fenv.20python.html#270794989">(Feb 05 2022 at 01:21)</a>:</h4>
<p><span class="user-mention" data-user-id="260325">@Chris Denton</span> I'd like to make sure I'm accurately describing the behavior of Python when installed via the Microsoft store.</p>



<a name="270795093"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122651-general/topic/x.py%20and%20/usr/bin/env%20python/near/270795093" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Chris Denton <a href="https://zulip-archive.rust-lang.org/stream/122651-general/topic/x.2Epy.20and.20.2Fusr.2Fbin.2Fenv.20python.html#270795093">(Feb 05 2022 at 01:22)</a>:</h4>
<p>As far as I can tell, python2 isn't available on the store. The earliest is 3.8. So it should always use python3.</p>



<a name="270795112"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122651-general/topic/x.py%20and%20/usr/bin/env%20python/near/270795112" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Josh Triplett <a href="https://zulip-archive.rust-lang.org/stream/122651-general/topic/x.2Epy.20and.20.2Fusr.2Fbin.2Fenv.20python.html#270795112">(Feb 05 2022 at 01:23)</a>:</h4>
<p><em>nod</em>, but I'd like to make sure that such a script actually does find and use Python.</p>



<a name="270795125"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122651-general/topic/x.py%20and%20/usr/bin/env%20python/near/270795125" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Josh Triplett <a href="https://zulip-archive.rust-lang.org/stream/122651-general/topic/x.2Epy.20and.20.2Fusr.2Fbin.2Fenv.20python.html#270795125">(Feb 05 2022 at 01:23)</a>:</h4>
<p>I don't expect a script with <code>#!/usr/bin/env python3</code> to accidentally run Python 2, I just want to make sure it works rather than failing with some kind of error.</p>



<a name="270796201"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122651-general/topic/x.py%20and%20/usr/bin/env%20python/near/270796201" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Chris Denton <a href="https://zulip-archive.rust-lang.org/stream/122651-general/topic/x.2Epy.20and.20.2Fusr.2Fbin.2Fenv.20python.html#270796201">(Feb 05 2022 at 01:38)</a>:</h4>
<p>Ok, I misunderstood. I tested it with <code>#!/usr/bin/env python3</code>. It works.</p>



<a name="270796239"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122651-general/topic/x.py%20and%20/usr/bin/env%20python/near/270796239" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Chris Denton <a href="https://zulip-archive.rust-lang.org/stream/122651-general/topic/x.2Epy.20and.20.2Fusr.2Fbin.2Fenv.20python.html#270796239">(Feb 05 2022 at 01:39)</a>:</h4>
<p>The only weirdness is that in powershell it will spawn a new command prompt unless <code>;.py</code> is appended to the <code>PATHEXT</code> environment variable.</p>



<a name="270796676"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122651-general/topic/x.py%20and%20/usr/bin/env%20python/near/270796676" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Josh Triplett <a href="https://zulip-archive.rust-lang.org/stream/122651-general/topic/x.2Epy.20and.20.2Fusr.2Fbin.2Fenv.20python.html#270796676">(Feb 05 2022 at 01:46)</a>:</h4>
<p><span class="user-mention silent" data-user-id="260325">Chris Denton</span> <a href="#narrow/stream/122651-general/topic/x.2Epy.20and.20.2Fusr.2Fbin.2Fenv.20python/near/270796201">said</a>:</p>
<blockquote>
<p>Ok, I misunderstood. I tested it with <code>#!/usr/bin/env python3</code>. It works.</p>
</blockquote>
<p>That helps a great deal, thank you!</p>



<a name="270796730"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122651-general/topic/x.py%20and%20/usr/bin/env%20python/near/270796730" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Josh Triplett <a href="https://zulip-archive.rust-lang.org/stream/122651-general/topic/x.2Epy.20and.20.2Fusr.2Fbin.2Fenv.20python.html#270796730">(Feb 05 2022 at 01:47)</a>:</h4>
<p>Any objections to the message I wrote <a href="#narrow/stream/122651-general/topic/x.2Epy.20and.20.2Fusr.2Fbin.2Fenv.20python/near/270794946">above</a>?</p>



<a name="270798003"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122651-general/topic/x.py%20and%20/usr/bin/env%20python/near/270798003" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Chris Denton <a href="https://zulip-archive.rust-lang.org/stream/122651-general/topic/x.2Epy.20and.20.2Fusr.2Fbin.2Fenv.20python.html#270798003">(Feb 05 2022 at 02:09)</a>:</h4>
<p><span class="user-mention" data-user-id="239881">@Josh Triplett</span>  Hm. I've tested with both the Windows store version and the official installer. Both seem fine with the shebang. I'm not actually sure it matters that python3.exe doesn't literally exist, it seems to interpret it fine either way. At least, I can't figure out how to replicate the failures people have mentioned. Maybe something has changed recently.</p>



<a name="270798065"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122651-general/topic/x.py%20and%20/usr/bin/env%20python/near/270798065" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Josh Triplett <a href="https://zulip-archive.rust-lang.org/stream/122651-general/topic/x.2Epy.20and.20.2Fusr.2Fbin.2Fenv.20python.html#270798065">(Feb 05 2022 at 02:10)</a>:</h4>
<p>Huh!</p>



<a name="270798074"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122651-general/topic/x.py%20and%20/usr/bin/env%20python/near/270798074" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Josh Triplett <a href="https://zulip-archive.rust-lang.org/stream/122651-general/topic/x.2Epy.20and.20.2Fusr.2Fbin.2Fenv.20python.html#270798074">(Feb 05 2022 at 02:10)</a>:</h4>
<p>Is that true on a system that has never had the windows store version installed? I want to make sure this isn't an artifact of having used multiple different installers.</p>



<a name="270798094"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122651-general/topic/x.py%20and%20/usr/bin/env%20python/near/270798094" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Chris Denton <a href="https://zulip-archive.rust-lang.org/stream/122651-general/topic/x.2Epy.20and.20.2Fusr.2Fbin.2Fenv.20python.html#270798094">(Feb 05 2022 at 02:11)</a>:</h4>
<p>Yeah, I tested on a fresh VM.</p>



<a name="270798102"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122651-general/topic/x.py%20and%20/usr/bin/env%20python/near/270798102" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Chris Denton <a href="https://zulip-archive.rust-lang.org/stream/122651-general/topic/x.2Epy.20and.20.2Fusr.2Fbin.2Fenv.20python.html#270798102">(Feb 05 2022 at 02:11)</a>:</h4>
<p>There could be some weird interaction with third party shells though.</p>



<a name="270798442"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122651-general/topic/x.py%20and%20/usr/bin/env%20python/near/270798442" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> simulacrum <a href="https://zulip-archive.rust-lang.org/stream/122651-general/topic/x.2Epy.20and.20.2Fusr.2Fbin.2Fenv.20python.html#270798442">(Feb 05 2022 at 02:18)</a>:</h4>
<p><span class="user-mention" data-user-id="239881">@Josh Triplett</span> fwiw, x.py is python 2 and python 3 compatible</p>



<a name="270798524"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122651-general/topic/x.py%20and%20/usr/bin/env%20python/near/270798524" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> simulacrum <a href="https://zulip-archive.rust-lang.org/stream/122651-general/topic/x.2Epy.20and.20.2Fusr.2Fbin.2Fenv.20python.html#270798524">(Feb 05 2022 at 02:20)</a>:</h4>
<p>(in part due to the desire to just work regardless of what python equals)</p>



<a name="270798528"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122651-general/topic/x.py%20and%20/usr/bin/env%20python/near/270798528" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> simulacrum <a href="https://zulip-archive.rust-lang.org/stream/122651-general/topic/x.2Epy.20and.20.2Fusr.2Fbin.2Fenv.20python.html#270798528">(Feb 05 2022 at 02:20)</a>:</h4>
<p>Otherwise the message seems ok to me</p>



<a name="270798883"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122651-general/topic/x.py%20and%20/usr/bin/env%20python/near/270798883" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Chris Denton <a href="https://zulip-archive.rust-lang.org/stream/122651-general/topic/x.2Epy.20and.20.2Fusr.2Fbin.2Fenv.20python.html#270798883">(Feb 05 2022 at 02:28)</a>:</h4>
<p><span class="user-mention" data-user-id="239881">@Josh Triplett</span> Ok, so the problem occurs if using the third party <a href="https://www.msys2.org/">MSYS2 shell</a> (which emulates a *nix environment) and the native python (installed using the official installer) instead of installing the msys2 python.</p>



<a name="270798885"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122651-general/topic/x.py%20and%20/usr/bin/env%20python/near/270798885" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Chris Denton <a href="https://zulip-archive.rust-lang.org/stream/122651-general/topic/x.2Epy.20and.20.2Fusr.2Fbin.2Fenv.20python.html#270798885">(Feb 05 2022 at 02:28)</a>:</h4>
<p>So using MSYS2 with the official Windows installer and using the <code>python3</code> shebang will fail.</p>



<a name="270799834"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122651-general/topic/x.py%20and%20/usr/bin/env%20python/near/270799834" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Josh Triplett <a href="https://zulip-archive.rust-lang.org/stream/122651-general/topic/x.2Epy.20and.20.2Fusr.2Fbin.2Fenv.20python.html#270799834">(Feb 05 2022 at 02:51)</a>:</h4>
<p>Sounds like I need to post a correction to the issue I just filled then.</p>



<a name="270799877"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122651-general/topic/x.py%20and%20/usr/bin/env%20python/near/270799877" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Josh Triplett <a href="https://zulip-archive.rust-lang.org/stream/122651-general/topic/x.2Epy.20and.20.2Fusr.2Fbin.2Fenv.20python.html#270799877">(Feb 05 2022 at 02:52)</a>:</h4>
<p>And, sounds like we might be able to change the shebang.</p>



<a name="270800107"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122651-general/topic/x.py%20and%20/usr/bin/env%20python/near/270800107" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Chris Denton <a href="https://zulip-archive.rust-lang.org/stream/122651-general/topic/x.2Epy.20and.20.2Fusr.2Fbin.2Fenv.20python.html#270800107">(Feb 05 2022 at 02:57)</a>:</h4>
<p>Basically the issue is mostly correct except to add that it only fails when used via MSYS2.</p>



<a name="270800418"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122651-general/topic/x.py%20and%20/usr/bin/env%20python/near/270800418" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Josh Triplett <a href="https://zulip-archive.rust-lang.org/stream/122651-general/topic/x.2Epy.20and.20.2Fusr.2Fbin.2Fenv.20python.html#270800418">(Feb 05 2022 at 03:02)</a>:</h4>
<p><span aria-label="+1" class="emoji emoji-1f44d" role="img" title="+1">:+1:</span></p>



<a name="270800443"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122651-general/topic/x.py%20and%20/usr/bin/env%20python/near/270800443" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Josh Triplett <a href="https://zulip-archive.rust-lang.org/stream/122651-general/topic/x.2Epy.20and.20.2Fusr.2Fbin.2Fenv.20python.html#270800443">(Feb 05 2022 at 03:02)</a>:</h4>
<p>Do you know if this has changed at some point?</p>



<a name="270800528"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122651-general/topic/x.py%20and%20/usr/bin/env%20python/near/270800528" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Chris Denton <a href="https://zulip-archive.rust-lang.org/stream/122651-general/topic/x.2Epy.20and.20.2Fusr.2Fbin.2Fenv.20python.html#270800528">(Feb 05 2022 at 03:04)</a>:</h4>
<p>I don't think it has but I'm not totally sure.</p>



<a name="270800534"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122651-general/topic/x.py%20and%20/usr/bin/env%20python/near/270800534" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Josh Triplett <a href="https://zulip-archive.rust-lang.org/stream/122651-general/topic/x.2Epy.20and.20.2Fusr.2Fbin.2Fenv.20python.html#270800534">(Feb 05 2022 at 03:04)</a>:</h4>
<p><span class="user-mention" data-user-id="260325">@Chris Denton</span> And, <code>#!/usr/bin/env python3</code> works with the official installer from cmd as well? (You mentioned the quirk with PowerShell above, but I'm hoping it worked with cmd.)</p>



<a name="270800549"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122651-general/topic/x.py%20and%20/usr/bin/env%20python/near/270800549" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Chris Denton <a href="https://zulip-archive.rust-lang.org/stream/122651-general/topic/x.2Epy.20and.20.2Fusr.2Fbin.2Fenv.20python.html#270800549">(Feb 05 2022 at 03:05)</a>:</h4>
<p>Yeah that works.</p>



<a name="270800560"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122651-general/topic/x.py%20and%20/usr/bin/env%20python/near/270800560" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Josh Triplett <a href="https://zulip-archive.rust-lang.org/stream/122651-general/topic/x.2Epy.20and.20.2Fusr.2Fbin.2Fenv.20python.html#270800560">(Feb 05 2022 at 03:05)</a>:</h4>
<p>Thank you so much for the testing!</p>



<a name="270800642"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122651-general/topic/x.py%20and%20/usr/bin/env%20python/near/270800642" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Josh Triplett <a href="https://zulip-archive.rust-lang.org/stream/122651-general/topic/x.2Epy.20and.20.2Fusr.2Fbin.2Fenv.20python.html#270800642">(Feb 05 2022 at 03:06)</a>:</h4>
<p>Just posted a correction to <a href="https://bugs.python.org/issue46645">https://bugs.python.org/issue46645</a></p>



<a name="270829165"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122651-general/topic/x.py%20and%20/usr/bin/env%20python/near/270829165" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Chris Denton <a href="https://zulip-archive.rust-lang.org/stream/122651-general/topic/x.2Epy.20and.20.2Fusr.2Fbin.2Fenv.20python.html#270829165">(Feb 05 2022 at 14:14)</a>:</h4>
<p>Earlier discussion in <a href="https://github.com/rust-lang/rust/issues/71841">#71841</a></p>



<a name="270853252"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122651-general/topic/x.py%20and%20/usr/bin/env%20python/near/270853252" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Frank Steffahn <a href="https://zulip-archive.rust-lang.org/stream/122651-general/topic/x.2Epy.20and.20.2Fusr.2Fbin.2Fenv.20python.html#270853252">(Feb 05 2022 at 22:39)</a>:</h4>
<p>If anyone finds that <code>./x.py</code> doesn’t work for them personally because they only have <code>python2</code> and/or <code>python3</code> installed, note that <a href="https://github.com/rust-lang/rust/tree/master/src/tools/x">https://github.com/rust-lang/rust/tree/master/src/tools/x</a> is a thing.</p>



<a name="270858158"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122651-general/topic/x.py%20and%20/usr/bin/env%20python/near/270858158" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> scottmcm <a href="https://zulip-archive.rust-lang.org/stream/122651-general/topic/x.2Epy.20and.20.2Fusr.2Fbin.2Fenv.20python.html#270858158">(Feb 06 2022 at 00:45)</a>:</h4>
<p><del>Hmm, I tried that on windows and it popped the "How do you want to open this file?" dialog.  I guess it's still <code>python x.py</code> for me.</del> My bad!  Apparently windows still hates symlinks.</p>



<a name="270864842"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122651-general/topic/x.py%20and%20/usr/bin/env%20python/near/270864842" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Chris Denton <a href="https://zulip-archive.rust-lang.org/stream/122651-general/topic/x.2Epy.20and.20.2Fusr.2Fbin.2Fenv.20python.html#270864842">(Feb 06 2022 at 03:13)</a>:</h4>
<p>I think currently it'll ask you the firat you run a .py file. But that's a one time thing.</p>



<a name="270866013"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122651-general/topic/x.py%20and%20/usr/bin/env%20python/near/270866013" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> scottmcm <a href="https://zulip-archive.rust-lang.org/stream/122651-general/topic/x.2Epy.20and.20.2Fusr.2Fbin.2Fenv.20python.html#270866013">(Feb 06 2022 at 03:41)</a>:</h4>
<p>I tried to <code>mklink</code> instead of copying the exe, and it didn't use it.  Once it was actually picking up the exe everything was fine.</p>



<a name="271171218"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122651-general/topic/x.py%20and%20/usr/bin/env%20python/near/271171218" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Alyssa Haroldsen [she] <a href="https://zulip-archive.rust-lang.org/stream/122651-general/topic/x.2Epy.20and.20.2Fusr.2Fbin.2Fenv.20python.html#271171218">(Feb 08 2022 at 18:31)</a>:</h4>
<p><span class="user-mention silent" data-user-id="280891">Frank Steffahn</span> <a href="#narrow/stream/122651-general/topic/x.2Epy.20and.20.2Fusr.2Fbin.2Fenv.20python/near/270853252">said</a>:</p>
<blockquote>
<p>If anyone finds that <code>./x.py</code> doesn’t work for them personally because they only have <code>python2</code> and/or <code>python3</code> installed, note that <a href="https://github.com/rust-lang/rust/tree/master/src/tools/x">https://github.com/rust-lang/rust/tree/master/src/tools/x</a> is a thing.</p>
</blockquote>
<p>That doesn't fix things like the default git hooks invoking <code>x.py</code> directly as an executable</p>



<a name="275398811"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122651-general/topic/x.py%20and%20/usr/bin/env%20python/near/275398811" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Walther <a href="https://zulip-archive.rust-lang.org/stream/122651-general/topic/x.2Epy.20and.20.2Fusr.2Fbin.2Fenv.20python.html#275398811">(Mar 15 2022 at 16:35)</a>:</h4>
<p>macOS Monterey 12.3 was released today. It has removed python 2, and does not ship with a <code>python</code> name available in path. I created an issue here <a href="https://github.com/rust-lang/rust/issues/94964">https://github.com/rust-lang/rust/issues/94964</a> that was closed in favor of the other issue from 2020 <a href="https://github.com/rust-lang/rust/issues/71818">https://github.com/rust-lang/rust/issues/71818</a> - <span class="user-mention" data-user-id="116122">@simulacrum</span>  also mentioned this issue upstream in python: <a href="https://bugs.python.org/issue46645">https://bugs.python.org/issue46645</a></p>



<a name="275400937"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122651-general/topic/x.py%20and%20/usr/bin/env%20python/near/275400937" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> simulacrum <a href="https://zulip-archive.rust-lang.org/stream/122651-general/topic/x.2Epy.20and.20.2Fusr.2Fbin.2Fenv.20python.html#275400937">(Mar 15 2022 at 16:48)</a>:</h4>
<p>I think all proposals so far hurt some platform - but as I mentioned, a proper summary across both current fresh installs and (where relevant) things like rhel etc that would be good.</p>



<a name="275503468"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122651-general/topic/x.py%20and%20/usr/bin/env%20python/near/275503468" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Walther <a href="https://zulip-archive.rust-lang.org/stream/122651-general/topic/x.2Epy.20and.20.2Fusr.2Fbin.2Fenv.20python.html#275503468">(Mar 16 2022 at 12:30)</a>:</h4>
<h1>Names of Python</h1>
<p>Problem statement: across different operating system versions and installation methods, which names for Python are available in path?</p>
<h2>Background</h2>
<p>Josh Triplett at Python Issue Tracker <a href="https://bugs.python.org/issue46645">Issue 46645</a>:</p>
<blockquote>
<p>The build system for the Rust compiler is a Python 3 script <code>x.py</code>, which orchestrates the build process for a user even if they don't already have Rust installed. (For instance, <code>x.py build</code>, <code>x.py test</code>, and various command-line arguments for more complex cases.)</p>
<p>We currently run into various issues making this script easy for people to use on all common platforms people build Rust on: Windows, macOS, and Linux.</p>
<p>If we use a shebang of <code>#!/usr/bin/env python3</code>, then x.py works for macOS and Linux users, and also works on Windows systems that install Python via the Windows store, but fails to run on Windows systems that install via the official Python installer, requiring users to explicitly invoke Python 3 on the script, and adding friction, support issues, and complexity to our documentation to help users debug that situation.</p>
<p>If we use a shebang of <code>#!/usr/bin/env python</code>, then x.py works for Windows users, fails on some modern macOS systems, works on other modern macOS systems (depending on installation method I think, e.g. homebrew vs Apple), fails on some modern Linux systems, and on macOS and Linux systems where it <em>does</em> work, it might be python2 or python3. So in practice, people often have to explicitly run <code>python3 x.py</code>, which again results in friction, support issues, and complexity in our documentation.</p>
</blockquote>
<h2>Data collection</h2>
<p>We are going to need several tables for this.</p>
<ul>
<li>Linux, per distribution, per version<ul>
<li>base install, without installing Python manually</li>
<li>installation of Python 3 from the default operating system repositories</li>
<li>other installation methods: what else exists and which are relevant?</li>
</ul>
</li>
<li>Windows, per version<ul>
<li>official Python 3 installer from &lt;<a href="https://www.python.org/downloads/windows/">https://www.python.org/downloads/windows/</a>&gt;</li>
<li>official Python 3 installer from Windows Store as per &lt;<a href="https://docs.microsoft.com/en-us/windows/python/beginners">https://docs.microsoft.com/en-us/windows/python/beginners</a>&gt;</li>
<li>other installation methods: what else exists and which are relevant?</li>
</ul>
</li>
<li>macOS, per version<ul>
<li>base install, without installing Python manually</li>
<li>official Python 3 installer from &lt;<a href="https://www.python.org/downloads/macos/">https://www.python.org/downloads/macos/</a>&gt;</li>
<li>homebrew, as a de facto package manager on macOS</li>
<li>other installation methods: what else exists and which are relevant?</li>
</ul>
</li>
</ul>
<h2>Methodology</h2>
<p>These are the questions we need to ask for each operating system and installation method:</p>
<ol>
<li>Does running <code>python -V</code> work? What does it return? (namely, 2 or 3)</li>
<li>Does running <code>python3 -V</code> work?</li>
<li>What other names for python are added to path, if any? (e.g. <code>py.exe</code>, others?)</li>
</ol>
<p>Note: we should <em>not</em> use helper packages like Ubuntu's <a href="https://packages.ubuntu.com/focal/python-is-python3">python-is-python3</a> unless automatically installed by default on some operating system. We are concerned with the out-of-the-box experience, so we <em>must not</em> use any manual workarounds when collecting the data.</p>
<h2>Open questions</h2>
<ul>
<li>Which linux distributions should we include?<ul>
<li>Is there a popularity table somewhere?</li>
<li>Probably at least Ubuntu, Debian, Arch, some commercial options like RHEL, other?</li>
<li>Which versions should we include - how many years/versions back?</li>
</ul>
</li>
<li>What is the easiest way to collect this data?<ul>
<li>For linux distributions and versions, can we fully automate this?<ul>
<li>e.g. write a script &amp; run on some cloud provider; likely to be quick and cheap</li>
</ul>
</li>
<li>For Windows versions and install methods, can we do any automation?</li>
<li>For macOS versions and install methods, can we do any automation?</li>
</ul>
</li>
</ul>
<h2>Ideal outcome</h2>
<p>Ideally, we would find out a name that works the same way on all platforms. However, according to earlier conversations, this is unlikely.</p>
<p>If not, we could hope to encourage Python developers to standardize and implement a name that is available on all install methods (e.g. <code>python3</code>).</p>



<a name="275505811"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122651-general/topic/x.py%20and%20/usr/bin/env%20python/near/275505811" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> NeoRaider <a href="https://zulip-archive.rust-lang.org/stream/122651-general/topic/x.2Epy.20and.20.2Fusr.2Fbin.2Fenv.20python.html#275505811">(Mar 16 2022 at 12:53)</a>:</h4>
<p>Does Windows even care about the Shebang outside of WSL?</p>



<a name="275507191"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122651-general/topic/x.py%20and%20/usr/bin/env%20python/near/275507191" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Walther <a href="https://zulip-archive.rust-lang.org/stream/122651-general/topic/x.2Epy.20and.20.2Fusr.2Fbin.2Fenv.20python.html#275507191">(Mar 16 2022 at 13:04)</a>:</h4>
<p><span class="user-mention silent" data-user-id="294290">NeoRaider</span> <a href="#narrow/stream/122651-general/topic/x.2Epy.20and.20.2Fusr.2Fbin.2Fenv.20python/near/275505811">said</a>:</p>
<blockquote>
<p>Does Windows even care about the Shebang outside of WSL?</p>
</blockquote>
<p>I would assume so, considering that that has been the main argument of not changing the current shebang to python3 as it "would break windows users"</p>



<a name="275507737"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122651-general/topic/x.py%20and%20/usr/bin/env%20python/near/275507737" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> bjorn3 <a href="https://zulip-archive.rust-lang.org/stream/122651-general/topic/x.2Epy.20and.20.2Fusr.2Fbin.2Fenv.20python.html#275507737">(Mar 16 2022 at 13:09)</a>:</h4>
<p>The kernel does not recognize shebangs in any special way. I believe the issue is that the py executable only accepts <code>#!/usr/bin/env python</code> and not the python3 variant.</p>



<a name="275508211"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122651-general/topic/x.py%20and%20/usr/bin/env%20python/near/275508211" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> The 8472 <a href="https://zulip-archive.rust-lang.org/stream/122651-general/topic/x.2Epy.20and.20.2Fusr.2Fbin.2Fenv.20python.html#275508211">(Mar 16 2022 at 13:13)</a>:</h4>
<p>For linux distros there may not be a single answer since they often have different installation profiles (minimal/server/desktop/...). E.g. the Arch docker image doesn't have python installed while the boot ISO probably does (since archinstall needs it) and idk what the various archinstall profiles do.</p>



<a name="275508852"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122651-general/topic/x.py%20and%20/usr/bin/env%20python/near/275508852" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Walther <a href="https://zulip-archive.rust-lang.org/stream/122651-general/topic/x.2Epy.20and.20.2Fusr.2Fbin.2Fenv.20python.html#275508852">(Mar 16 2022 at 13:19)</a>:</h4>
<p><span class="user-mention silent" data-user-id="330154">The 8472</span> <a href="#narrow/stream/122651-general/topic/x.2Epy.20and.20.2Fusr.2Fbin.2Fenv.20python/near/275508211">said</a>:</p>
<blockquote>
<p>For linux distros there may not be a single answer since they often have different installation profiles (minimal/server/desktop/...). E.g. the Arch docker image doesn't have python installed while the boot ISO probably does (since archinstall needs it) and idk what the various archinstall profiles do.</p>
</blockquote>
<p>I could be wrong, but I would _personally_ be fairly confident in the hypothesis of "on all linux distributions, if you have python 3 installed, you have <code>python3</code> in path"</p>



<a name="275509078"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122651-general/topic/x.py%20and%20/usr/bin/env%20python/near/275509078" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Connor Horman <a href="https://zulip-archive.rust-lang.org/stream/122651-general/topic/x.2Epy.20and.20.2Fusr.2Fbin.2Fenv.20python.html#275509078">(Mar 16 2022 at 13:21)</a>:</h4>
<p>You might not if <code>python</code> is python3.</p>



<a name="275509423"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122651-general/topic/x.py%20and%20/usr/bin/env%20python/near/275509423" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Walther <a href="https://zulip-archive.rust-lang.org/stream/122651-general/topic/x.2Epy.20and.20.2Fusr.2Fbin.2Fenv.20python.html#275509423">(Mar 16 2022 at 13:24)</a>:</h4>
<p><span class="user-mention silent" data-user-id="133247">bjorn3</span> <a href="#narrow/stream/122651-general/topic/x.2Epy.20and.20.2Fusr.2Fbin.2Fenv.20python/near/275507737">said</a>:</p>
<blockquote>
<p>The kernel does not recognize shebangs in any special way. I believe the issue is that the py executable only accepts <code>#!/usr/bin/env python</code> and not the python3 variant.</p>
</blockquote>
<p>Yeah - people should be more exact when talking about "windows" regarding this issue. WSL and WSL2 are closer to VMs than operating "on windows" - they have their own package managers and software installs etc. If you run Python within a WSL(2) shell session, you are running the version installed within that machine - you are not calling into any python installation installed on the Windows side.</p>
<p>The main argument against changing the shebang from <code>python</code> to <code>python3</code> has been that Windows does not support <code>python</code>. I would love to get more specific, <strong>exact statements</strong> on this - with what installation method, in which shell (CMD, Powershell, other native shell) does it not work on Windows and why?</p>
<p>For WSL and WSL2, you will have the path issue of the linux distribution you are running - if you run Ubuntu, you'll have the Ubuntu behavior of <code>python</code> shebang not working, as by default Ubuntu does not ship with an alias of <code>python-is-python3</code></p>



<a name="275509513"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122651-general/topic/x.py%20and%20/usr/bin/env%20python/near/275509513" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Walther <a href="https://zulip-archive.rust-lang.org/stream/122651-general/topic/x.2Epy.20and.20.2Fusr.2Fbin.2Fenv.20python.html#275509513">(Mar 16 2022 at 13:25)</a>:</h4>
<p><span class="user-mention silent" data-user-id="257758">Connor Horman</span> <a href="#narrow/stream/122651-general/topic/x.2Epy.20and.20.2Fusr.2Fbin.2Fenv.20python/near/275509078">said</a>:</p>
<blockquote>
<p>You might not if <code>python</code> is python3.</p>
</blockquote>
<p>Do you know of any examples? I know some systems ship with an alias of <code>python</code> executing <code>python3</code>, but i don't know of any distribution where <code>python3</code> would <em>not</em> exist in path when python 3 is installed</p>



<a name="275509686"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122651-general/topic/x.py%20and%20/usr/bin/env%20python/near/275509686" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Connor Horman <a href="https://zulip-archive.rust-lang.org/stream/122651-general/topic/x.2Epy.20and.20.2Fusr.2Fbin.2Fenv.20python.html#275509686">(Mar 16 2022 at 13:27)</a>:</h4>
<p>Not off the top of my head, but I think BLFS might only install python 3 and only as <code>python</code>.</p>



<a name="275509927"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122651-general/topic/x.py%20and%20/usr/bin/env%20python/near/275509927" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Walther <a href="https://zulip-archive.rust-lang.org/stream/122651-general/topic/x.2Epy.20and.20.2Fusr.2Fbin.2Fenv.20python.html#275509927">(Mar 16 2022 at 13:29)</a>:</h4>
<p>how big of a percentage of users contributing to the rust compiler are doing so on "beyond linux from scratch" vs from Windows, macOS, various other popular linux distributions? do you think BLFS should be a blocker for switching to <code>python3</code> even if the situation is resolved for Windows?</p>



<a name="275511369"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122651-general/topic/x.py%20and%20/usr/bin/env%20python/near/275511369" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Walther <a href="https://zulip-archive.rust-lang.org/stream/122651-general/topic/x.2Epy.20and.20.2Fusr.2Fbin.2Fenv.20python.html#275511369">(Mar 16 2022 at 13:41)</a>:</h4>
<div class="codehilite"><pre><span></span><code>Edition Windows 11 Pro
Version 21H2
Installed on    ‎12/‎12/‎2021
OS build    22000.556
Experience  Windows Feature Experience Pack 1000.22000.556.0
</code></pre></div>
<p>On my Windows 11 machine, if i run <code>python3</code> in either Powershell or CMD, the Windows Store automatically opens to the officiall Python 3.10 software page, published by Python Software Foundation.</p>
<p>After I click the Get button to install it, in both Powershell and CMD, running <code>python3 -V</code> results in <code>Python 3.10.2</code></p>



<a name="275511808"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122651-general/topic/x.py%20and%20/usr/bin/env%20python/near/275511808" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> bjorn3 <a href="https://zulip-archive.rust-lang.org/stream/122651-general/topic/x.2Epy.20and.20.2Fusr.2Fbin.2Fenv.20python.html#275511808">(Mar 16 2022 at 13:44)</a>:</h4>
<p>The windows isssue is the py.exe launcher, not python3.exe.</p>



<a name="275511939"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122651-general/topic/x.py%20and%20/usr/bin/env%20python/near/275511939" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> bjorn3 <a href="https://zulip-archive.rust-lang.org/stream/122651-general/topic/x.2Epy.20and.20.2Fusr.2Fbin.2Fenv.20python.html#275511939">(Mar 16 2022 at 13:45)</a>:</h4>
<blockquote>
<p>To allow shebang lines in Python scripts to be portable between Unix and Windows, this launcher supports a number of ‘virtual’ commands to specify which interpreter to use. The supported virtual commands are:</p>
<ul>
<li>/usr/bin/env python</li>
<li>/usr/bin/python</li>
<li>/usr/local/bin/python</li>
<li>python</li>
</ul>
</blockquote>



<a name="275512013"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122651-general/topic/x.py%20and%20/usr/bin/env%20python/near/275512013" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Walther <a href="https://zulip-archive.rust-lang.org/stream/122651-general/topic/x.2Epy.20and.20.2Fusr.2Fbin.2Fenv.20python.html#275512013">(Mar 16 2022 at 13:46)</a>:</h4>
<p>After the installation, if I write a small file</p>
<div class="codehilite"><pre><span></span><code><span class="ch">#!/usr/bin/env python3</span>
<span class="kn">import</span> <span class="nn">time</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Hello, world&quot;</span><span class="p">)</span>
<span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
</code></pre></div>
<p>and run <code>.\hello.py</code> in Powershell or <code>hello.py</code> in CMD, on first run I get the modal for "what do you want to use to open this file", if i select Python 3.10, it will launch a new window where the output is shown</p>



<a name="275512130"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122651-general/topic/x.py%20and%20/usr/bin/env%20python/near/275512130" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Walther <a href="https://zulip-archive.rust-lang.org/stream/122651-general/topic/x.2Epy.20and.20.2Fusr.2Fbin.2Fenv.20python.html#275512130">(Mar 16 2022 at 13:47)</a>:</h4>
<p>so at least on windows 11 with the python3 installed directly from windows store (as it automatically suggests if you try to run <code>python3</code>) the shebang of <code>#!/usr/bin/env python3</code> seems to work perfectly fine</p>



<a name="275513185"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122651-general/topic/x.py%20and%20/usr/bin/env%20python/near/275513185" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Walther <a href="https://zulip-archive.rust-lang.org/stream/122651-general/topic/x.2Epy.20and.20.2Fusr.2Fbin.2Fenv.20python.html#275513185">(Mar 16 2022 at 13:55)</a>:</h4>
<p>I now uninstalled the version from the Windows Store, and installed the newest installed from <a href="https://www.python.org/downloads/release/python-3102/">https://www.python.org/downloads/release/python-3102/</a> . I installed with the default options, _without_ selecting the "add python 3.10 to PATH" option as it was unselected by default.</p>
<p>Even with this installation, running the abovementioned <code>.\hello.py</code> works in powershell and <code>hello.py</code> in cmd, with the shebang set to refer to <code>python3</code>. Conversely, if I set the shebang to <code>python</code>, <strong>then</strong> it actually fails with an error of <code>Python was not found</code></p>



<a name="275513298"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122651-general/topic/x.py%20and%20/usr/bin/env%20python/near/275513298" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Walther <a href="https://zulip-archive.rust-lang.org/stream/122651-general/topic/x.2Epy.20and.20.2Fusr.2Fbin.2Fenv.20python.html#275513298">(Mar 16 2022 at 13:56)</a>:</h4>
<p>based on this, it looks to me like the shebang of <code>#!/usr/bin/env python3</code> should work even on Windows, both when installed via Windows Store as well as when installed via the official Python installer?</p>



<a name="275513422"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122651-general/topic/x.py%20and%20/usr/bin/env%20python/near/275513422" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Walther <a href="https://zulip-archive.rust-lang.org/stream/122651-general/topic/x.2Epy.20and.20.2Fusr.2Fbin.2Fenv.20python.html#275513422">(Mar 16 2022 at 13:57)</a>:</h4>
<p>and i get the same behavior with using the <code>py</code> wrapper you mentioned: <code>py hello.py</code> in both Powershell and CMD. shebang of <code>python3</code> works, <code>python</code> doesn't</p>



<a name="275513608"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122651-general/topic/x.py%20and%20/usr/bin/env%20python/near/275513608" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Walther <a href="https://zulip-archive.rust-lang.org/stream/122651-general/topic/x.2Epy.20and.20.2Fusr.2Fbin.2Fenv.20python.html#275513608">(Mar 16 2022 at 13:58)</a>:</h4>
<div class="codehilite"><pre><span></span><code>py --help
Python Launcher for Windows Version 3.10.2150.1013

usage:
py [launcher-args] [python-args] [script [script-args]]

Launcher arguments:

-2     : Launch the latest Python 2.x version
-3     : Launch the latest Python 3.x version
-X.Y   : Launch the specified Python version
     The above all default to 64 bit if a matching 64 bit python is present.
-X.Y-32: Launch the specified 32bit Python version
-X-32  : Launch the latest 32bit Python X version
-X.Y-64: Launch the specified 64bit Python version
-X-64  : Launch the latest 64bit Python X version
-0  --list       : List the available pythons
-0p --list-paths : List with paths

 If no script is specified the specified interpreter is opened.
If an exact version is not given, using the latest version can be overridden by
any of the following, (in priority order):
 An active virtual environment
 A shebang line in the script (if present)
 With -2 or -3 flag a matching PY_PYTHON2 or PY_PYTHON3 Environment variable
 A PY_PYTHON Environment variable
 From [defaults] in py.ini in your %LOCALAPPDATA%\py.ini
 From [defaults] in py.ini beside py.exe (use `where py` to locate)
</code></pre></div>



<a name="275513709"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122651-general/topic/x.py%20and%20/usr/bin/env%20python/near/275513709" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Walther <a href="https://zulip-archive.rust-lang.org/stream/122651-general/topic/x.2Epy.20and.20.2Fusr.2Fbin.2Fenv.20python.html#275513709">(Mar 16 2022 at 13:59)</a>:</h4>
<p>to me it looks like even <code>py.exe</code> happily supports the <code>#!/usr/bin/env python3</code> shebang</p>



<a name="275514348"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122651-general/topic/x.py%20and%20/usr/bin/env%20python/near/275514348" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Walther <a href="https://zulip-archive.rust-lang.org/stream/122651-general/topic/x.2Epy.20and.20.2Fusr.2Fbin.2Fenv.20python.html#275514348">(Mar 16 2022 at 14:03)</a>:</h4>
<p><span class="user-mention silent" data-user-id="133247">bjorn3</span> <a href="#narrow/stream/122651-general/topic/x.2Epy.20and.20.2Fusr.2Fbin.2Fenv.20python/near/275511939">said</a>:</p>
<blockquote>
<blockquote>
<p>To allow shebang lines in Python scripts to be portable between Unix and Windows, this launcher supports a number of ‘virtual’ commands to specify which interpreter to use. The supported virtual commands are:</p>
<ul>
<li>/usr/bin/env python</li>
<li>/usr/bin/python</li>
<li>/usr/local/bin/python</li>
<li>python</li>
</ul>
</blockquote>
</blockquote>
<p>The documentation you are quoting <a href="https://docs.python.org/3/using/windows.html#shebang-lines">https://docs.python.org/3/using/windows.html#shebang-lines</a> continues with the following snippet:</p>
<blockquote>
<p>Any of the above virtual commands can be suffixed with an explicit version (either just the major version, or the major and minor version).</p>
</blockquote>
<p>To me this sounds like there should be no reason why the shebang could not be updated to <code>#!/usr/bin/env python3</code></p>



<a name="275540862"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122651-general/topic/x.py%20and%20/usr/bin/env%20python/near/275540862" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Walther <a href="https://zulip-archive.rust-lang.org/stream/122651-general/topic/x.2Epy.20and.20.2Fusr.2Fbin.2Fenv.20python.html#275540862">(Mar 16 2022 at 16:44)</a>:</h4>
<p>Of course if anyone has actual reproduction steps for <code>#!/usr/bin/env python3</code> shebang not working on Windows, please do share <span aria-label="bow" class="emoji emoji-1f647" role="img" title="bow">:bow:</span> Haven't been able to reproduce that, and that anecdote has been held as the main blocker for this change</p>



<a name="275550612"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122651-general/topic/x.py%20and%20/usr/bin/env%20python/near/275550612" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Eric Huss <a href="https://zulip-archive.rust-lang.org/stream/122651-general/topic/x.2Epy.20and.20.2Fusr.2Fbin.2Fenv.20python.html#275550612">(Mar 16 2022 at 17:43)</a>:</h4>
<p>In git bash I get <code>/c/Users/eric/AppData/Local/Microsoft/WindowsApps/python3: Permission denied</code> when running <code>python3</code>. That is with or without the store version installed.</p>



<a name="275551141"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122651-general/topic/x.py%20and%20/usr/bin/env%20python/near/275551141" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Eric Huss <a href="https://zulip-archive.rust-lang.org/stream/122651-general/topic/x.2Epy.20and.20.2Fusr.2Fbin.2Fenv.20python.html#275551141">(Mar 16 2022 at 17:47)</a>:</h4>
<p><a href="https://stackoverflow.com/questions/56974927/permission-denied-trying-to-run-python-on-windows-10">https://stackoverflow.com/questions/56974927/permission-denied-trying-to-run-python-on-windows-10</a></p>
<p>What a mess. <span aria-label="frown" class="emoji emoji-1f641" role="img" title="frown">:frown:</span></p>



<a name="275553677"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122651-general/topic/x.py%20and%20/usr/bin/env%20python/near/275553677" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Walther <a href="https://zulip-archive.rust-lang.org/stream/122651-general/topic/x.2Epy.20and.20.2Fusr.2Fbin.2Fenv.20python.html#275553677">(Mar 16 2022 at 18:02)</a>:</h4>
<p><span class="user-mention silent" data-user-id="120518">Eric Huss</span> <a href="#narrow/stream/122651-general/topic/x.2Epy.20and.20.2Fusr.2Fbin.2Fenv.20python/near/275550612">said</a>:</p>
<blockquote>
<p>In git bash I get <code>/c/Users/eric/AppData/Local/Microsoft/WindowsApps/python3: Permission denied</code> when running <code>python3</code>. That is with or without the store version installed.</p>
</blockquote>
<p>Is this a python issue or (more likely i think?) a git bash issue? considering it should work in CMD or Powershell (does it, on your machine?)</p>
<p>Also: do you get that error when trying to run <code>python3</code> directly from the gitbash command line, or when running a file with the <code>#!/usr/bin/env python3</code> shebang? Is there a difference between running directly with <code>./hello.py</code> or with the py.exe helper <code>py hello.py</code> ?</p>



<a name="275557405"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122651-general/topic/x.py%20and%20/usr/bin/env%20python/near/275557405" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Eric Huss <a href="https://zulip-archive.rust-lang.org/stream/122651-general/topic/x.2Epy.20and.20.2Fusr.2Fbin.2Fenv.20python.html#275557405">(Mar 16 2022 at 18:28)</a>:</h4>
<p><span class="user-mention silent" data-user-id="201711">Walther</span> <a href="#narrow/stream/122651-general/topic/x.2Epy.20and.20.2Fusr.2Fbin.2Fenv.20python/near/275553677">said</a>:</p>
<blockquote>
<p>Is this a python issue or (more likely i think?) a git bash issue? considering it should work in CMD or Powershell (does it, on your machine?)</p>
</blockquote>
<p>Per the analysis in the stackoverflow above, the answer is "it's complicated".  I think the essence is the weird way microsoft created the 0-byte stubs that launch the store page.  It works in cmd/powershell.</p>
<blockquote>
<p>Also: do you get that error when trying to run <code>python3</code> directly from the gitbash command line, or when running a file with the <code>#!/usr/bin/env python3</code> shebang? Either directly with <code>./hello.py</code> or with the py.exe helper <code>py hello.py</code> ?</p>
</blockquote>
<p>All of those fail exept <code>py hello.py</code>.  </p>
<p>I don't think this is something that should block progress.  I'm just pointing out that it will be a regression for some.  There are workarounds.  Preferably they could be documented somehow.</p>



<a name="275557595"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122651-general/topic/x.py%20and%20/usr/bin/env%20python/near/275557595" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Walther <a href="https://zulip-archive.rust-lang.org/stream/122651-general/topic/x.2Epy.20and.20.2Fusr.2Fbin.2Fenv.20python.html#275557595">(Mar 16 2022 at 18:30)</a>:</h4>
<p>okay i tried it on my machine as well.</p>
<ul>
<li>with python installed from the <a href="http://python.org">python.org</a> installer, with default options, and then running gitbash,<ul>
<li><code>./hello.py</code> does <strong>not</strong> work with _either_ shebang</li>
<li><code>py hello.py</code> <strong>works</strong> with the python3 shebang but <strong>not</strong> with the python shebang</li>
</ul>
</li>
<li>with python installed from the windows store, and then running githbash,<ul>
<li><code>./hello.py</code> <strong>works</strong> with _either_ shebang</li>
<li><code>py hello.py</code> does <strong>not</strong> work with either, as <code>py</code> or <code>py.exe</code> does not appear in gitbash path</li>
</ul>
</li>
</ul>
<p>so to me, it sounds like changing the shebang should not make things worse in any case, and should make many cases better?</p>



<a name="275557965"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122651-general/topic/x.py%20and%20/usr/bin/env%20python/near/275557965" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Eric Huss <a href="https://zulip-archive.rust-lang.org/stream/122651-general/topic/x.2Epy.20and.20.2Fusr.2Fbin.2Fenv.20python.html#275557965">(Mar 16 2022 at 18:33)</a>:</h4>
<p>Perhaps things changed in Windows 11 or your system is configured differently?  At least for me, it would be worse. But I can work around it.</p>



<a name="275558493"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122651-general/topic/x.py%20and%20/usr/bin/env%20python/near/275558493" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Walther <a href="https://zulip-archive.rust-lang.org/stream/122651-general/topic/x.2Epy.20and.20.2Fusr.2Fbin.2Fenv.20python.html#275558493">(Mar 16 2022 at 18:36)</a>:</h4>
<blockquote>
<p>All of those fail exept py hello.py</p>
</blockquote>
<p>Just to double check: do any of the other running methods work in your gitbash if you switch the shebang back to <code>#!/usr/bin/env python</code>? As in, is there an actual specific difference between the <code>#!/usr/bin/env python</code> and <code>#!/usr/bin/env python3</code> that would regress?</p>



<a name="275561240"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122651-general/topic/x.py%20and%20/usr/bin/env%20python/near/275561240" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Eric Huss <a href="https://zulip-archive.rust-lang.org/stream/122651-general/topic/x.2Epy.20and.20.2Fusr.2Fbin.2Fenv.20python.html#275561240">(Mar 16 2022 at 18:53)</a>:</h4>
<p>Yea, <code>#!/usr/bin/env python</code> works. That launches the python installed from <a href="http://python.org">python.org</a></p>



<a name="275561985"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122651-general/topic/x.py%20and%20/usr/bin/env%20python/near/275561985" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Walther <a href="https://zulip-archive.rust-lang.org/stream/122651-general/topic/x.2Epy.20and.20.2Fusr.2Fbin.2Fenv.20python.html#275561985">(Mar 16 2022 at 18:59)</a>:</h4>
<p>interesting! which python version, which git bash version, and do you happen to remember if you checked the "add python to PATH" in the installer or not? wondering if this can be reproduced / if we could figure out what the subset of users would be where this would regress. currently it looks like many cases should improve and some stay equally-supported</p>



<a name="276190235"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122651-general/topic/x.py%20and%20/usr/bin/env%20python/near/276190235" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Walther <a href="https://zulip-archive.rust-lang.org/stream/122651-general/topic/x.2Epy.20and.20.2Fusr.2Fbin.2Fenv.20python.html#276190235">(Mar 22 2022 at 13:44)</a>:</h4>
<p>sorry, i think i owe you all an apology - i've been way too insistent and pushy on this issue. the topic is close to my heart, as i've been very frustrated by x.py not working out of the box on pretty much any of my machines, but i should not take it out on the community that is actively trying to help fix things <span aria-label="bow" class="emoji emoji-1f647" role="img" title="bow">:bow:</span></p>



<hr><p>Last updated: Apr 12 2022 at 20:01 UTC</p>
</html>