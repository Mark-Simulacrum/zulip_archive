<html>
<head><meta charset="utf-8"><title>int_roundings (div_ceil, div_floor, next_multiple_of) · t-libs · Zulip Chat Archive</title></head>
<h2>Stream: <a href="https://zulip-archive.rust-lang.org/stream/219381-t-libs/index.html">t-libs</a></h2>
<h3>Topic: <a href="https://zulip-archive.rust-lang.org/stream/219381-t-libs/topic/int_roundings.20(div_ceil.2C.20div_floor.2C.20next_multiple_of).html">int_roundings (div_ceil, div_floor, next_multiple_of)</a></h3>

<hr>

<base href="https://rust-lang.zulipchat.com">

<head><link href="https://zulip-archive.rust-lang.org/style.css" rel="stylesheet"></head>

<a name="273280156"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/219381-t-libs/topic/int_roundings%20%28div_ceil%2C%20div_floor%2C%20next_multiple_of%29/near/273280156" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Josh Triplett <a href="https://zulip-archive.rust-lang.org/stream/219381-t-libs/topic/int_roundings.20(div_ceil.2C.20div_floor.2C.20next_multiple_of).html#273280156">(Feb 25 2022 at 20:24)</a>:</h4>
<p>A while back, we added <code>div_floor</code>, <code>div_ceil</code>, <code>next_multiple_of</code>, etc, under the <code>int_roundings</code> feature. We then ended up renaming them temporarily to add an <code>unstable_</code> prefix, due to a conflict with methods of the same name in <code>num_integer</code> causing widespread breakage.</p>



<a name="273280182"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/219381-t-libs/topic/int_roundings%20%28div_ceil%2C%20div_floor%2C%20next_multiple_of%29/near/273280182" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Josh Triplett <a href="https://zulip-archive.rust-lang.org/stream/219381-t-libs/topic/int_roundings.20(div_ceil.2C.20div_floor.2C.20next_multiple_of).html#273280182">(Feb 25 2022 at 20:24)</a>:</h4>
<p>We now have a stable release (1.59) where we have a future compatibility warning about using those methods.</p>



<a name="273280201"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/219381-t-libs/topic/int_roundings%20%28div_ceil%2C%20div_floor%2C%20next_multiple_of%29/near/273280201" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Josh Triplett <a href="https://zulip-archive.rust-lang.org/stream/219381-t-libs/topic/int_roundings.20(div_ceil.2C.20div_floor.2C.20next_multiple_of).html#273280201">(Feb 25 2022 at 20:25)</a>:</h4>
<p>Given that, could we rename the methods back and aim to stabilize them in 1.61?</p>



<a name="273280213"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/219381-t-libs/topic/int_roundings%20%28div_ceil%2C%20div_floor%2C%20next_multiple_of%29/near/273280213" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Josh Triplett <a href="https://zulip-archive.rust-lang.org/stream/219381-t-libs/topic/int_roundings.20(div_ceil.2C.20div_floor.2C.20next_multiple_of).html#273280213">(Feb 25 2022 at 20:25)</a>:</h4>
<p>Is there any other blocker to stabilization?</p>



<a name="273280335"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/219381-t-libs/topic/int_roundings%20%28div_ceil%2C%20div_floor%2C%20next_multiple_of%29/near/273280335" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> cuviper <a href="https://zulip-archive.rust-lang.org/stream/219381-t-libs/topic/int_roundings.20(div_ceil.2C.20div_floor.2C.20next_multiple_of).html#273280335">(Feb 25 2022 at 20:26)</a>:</h4>
<p>does that warning give any estimate of a timeline?</p>



<a name="273280457"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/219381-t-libs/topic/int_roundings%20%28div_ceil%2C%20div_floor%2C%20next_multiple_of%29/near/273280457" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> cuviper <a href="https://zulip-archive.rust-lang.org/stream/219381-t-libs/topic/int_roundings.20(div_ceil.2C.20div_floor.2C.20next_multiple_of).html#273280457">(Feb 25 2022 at 20:27)</a>:</h4>
<p>(distro hat on) RHEL is updating Rust every 6 months, which is ~4-5 rust releases. So a RHEL customer would never even see a future warning that only spanned 2 releases, unless we got lucky on that alignment</p>



<a name="273280744"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/219381-t-libs/topic/int_roundings%20%28div_ceil%2C%20div_floor%2C%20next_multiple_of%29/near/273280744" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> cuviper <a href="https://zulip-archive.rust-lang.org/stream/219381-t-libs/topic/int_roundings.20(div_ceil.2C.20div_floor.2C.20next_multiple_of).html#273280744">(Feb 25 2022 at 20:30)</a>:</h4>
<p>(in this instance, we'd be unlucky, as we're shipping 1.58 in RHEL 8.6 and 9.0, so 8.7/9.1 will probably get 1.62 or 1.63)</p>



<a name="273281302"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/219381-t-libs/topic/int_roundings%20%28div_ceil%2C%20div_floor%2C%20next_multiple_of%29/near/273281302" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Josh Triplett <a href="https://zulip-archive.rust-lang.org/stream/219381-t-libs/topic/int_roundings.20(div_ceil.2C.20div_floor.2C.20next_multiple_of).html#273281302">(Feb 25 2022 at 20:34)</a>:</h4>
<p>I would also expect most crates to get updated by then, so that RHEL customer would miss both the warning and the breakage the warning seeks to prevent.</p>



<a name="273281420"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/219381-t-libs/topic/int_roundings%20%28div_ceil%2C%20div_floor%2C%20next_multiple_of%29/near/273281420" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> cuviper <a href="https://zulip-archive.rust-lang.org/stream/219381-t-libs/topic/int_roundings.20(div_ceil.2C.20div_floor.2C.20next_multiple_of).html#273281420">(Feb 25 2022 at 20:35)</a>:</h4>
<p>hopefully. I don't have good data on that...</p>



<a name="273281570"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/219381-t-libs/topic/int_roundings%20%28div_ceil%2C%20div_floor%2C%20next_multiple_of%29/near/273281570" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Josh Triplett <a href="https://zulip-archive.rust-lang.org/stream/219381-t-libs/topic/int_roundings.20(div_ceil.2C.20div_floor.2C.20next_multiple_of).html#273281570">(Feb 25 2022 at 20:37)</a>:</h4>
<p>The largest sources of breakage are already fixed.</p>



<a name="273281582"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/219381-t-libs/topic/int_roundings%20%28div_ceil%2C%20div_floor%2C%20next_multiple_of%29/near/273281582" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Josh Triplett <a href="https://zulip-archive.rust-lang.org/stream/219381-t-libs/topic/int_roundings.20(div_ceil.2C.20div_floor.2C.20next_multiple_of).html#273281582">(Feb 25 2022 at 20:37)</a>:</h4>
<p>num-bigint in particular.</p>



<a name="273281940"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/219381-t-libs/topic/int_roundings%20%28div_ceil%2C%20div_floor%2C%20next_multiple_of%29/near/273281940" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Josh Triplett <a href="https://zulip-archive.rust-lang.org/stream/219381-t-libs/topic/int_roundings.20(div_ceil.2C.20div_floor.2C.20next_multiple_of).html#273281940">(Feb 25 2022 at 20:38)</a>:</h4>
<p>Also, the breakage was exacerbated by having an unstable function that conflicted with the stable function, so people encountering the conflict couldn't just switch to the standard library function. If we rename and stabilize the functions, people encountering the conflict can switch to the standard library function.</p>



<a name="273281968"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/219381-t-libs/topic/int_roundings%20%28div_ceil%2C%20div_floor%2C%20next_multiple_of%29/near/273281968" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> simulacrum <a href="https://zulip-archive.rust-lang.org/stream/219381-t-libs/topic/int_roundings.20(div_ceil.2C.20div_floor.2C.20next_multiple_of).html#273281968">(Feb 25 2022 at 20:38)</a>:</h4>
<p>If we rename back, it seems like we would want to immediately stabilize alongside that, right? Otherwise you (still) can't migrate and the breakage hasn't actually gone away?</p>
<p>Or did num-integer get fixed somehow?</p>



<a name="273282025"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/219381-t-libs/topic/int_roundings%20%28div_ceil%2C%20div_floor%2C%20next_multiple_of%29/near/273282025" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> simulacrum <a href="https://zulip-archive.rust-lang.org/stream/219381-t-libs/topic/int_roundings.20(div_ceil.2C.20div_floor.2C.20next_multiple_of).html#273282025">(Feb 25 2022 at 20:38)</a>:</h4>
<p>Oh, heh, you just said that.</p>



<a name="273283006"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/219381-t-libs/topic/int_roundings%20%28div_ceil%2C%20div_floor%2C%20next_multiple_of%29/near/273283006" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Josh Triplett <a href="https://zulip-archive.rust-lang.org/stream/219381-t-libs/topic/int_roundings.20(div_ceil.2C.20div_floor.2C.20next_multiple_of).html#273283006">(Feb 25 2022 at 20:46)</a>:</h4>
<p>Yeah, that's what I'm proposing to do. I'd be happy to send the PR doing exactly that.</p>



<a name="273305760"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/219381-t-libs/topic/int_roundings%20%28div_ceil%2C%20div_floor%2C%20next_multiple_of%29/near/273305760" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Josh Triplett <a href="https://zulip-archive.rust-lang.org/stream/219381-t-libs/topic/int_roundings.20(div_ceil.2C.20div_floor.2C.20next_multiple_of).html#273305760">(Feb 26 2022 at 00:59)</a>:</h4>
<p>I just realized that we <em>did</em> rename back, some time ago: <a href="https://github.com/rust-lang/rust/commit/41f70f3491f02533819ab6584328ffd266ce02f2">41f70f3491f02533819ab6584328ffd266ce02f2</a></p>



<a name="273306119"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/219381-t-libs/topic/int_roundings%20%28div_ceil%2C%20div_floor%2C%20next_multiple_of%29/near/273306119" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> cuviper <a href="https://zulip-archive.rust-lang.org/stream/219381-t-libs/topic/int_roundings.20(div_ceil.2C.20div_floor.2C.20next_multiple_of).html#273306119">(Feb 26 2022 at 01:02)</a>:</h4>
<p>ah, thanks to <a href="https://github.com/rust-lang/rust/issues/90329">#90329</a></p>



<hr><p>Last updated: Apr 12 2022 at 20:01 UTC</p>
</html>