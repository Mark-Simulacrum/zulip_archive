<html>
<head><meta charset="utf-8"><title>Path of macro · t-libs · Zulip Chat Archive</title></head>
<h2>Stream: <a href="https://zulip-archive.rust-lang.org/stream/219381-t-libs/index.html">t-libs</a></h2>
<h3>Topic: <a href="https://zulip-archive.rust-lang.org/stream/219381-t-libs/topic/Path.20of.20macro.html">Path of macro</a></h3>

<hr>

<base href="https://rust-lang.zulipchat.com">

<head><link href="https://zulip-archive.rust-lang.org/style.css" rel="stylesheet"></head>

<a name="269620689"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/219381-t-libs/topic/Path%20of%20macro/near/269620689" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> CraftSpider <a href="https://zulip-archive.rust-lang.org/stream/219381-t-libs/topic/Path.20of.20macro.html#269620689">(Jan 27 2022 at 18:58)</a>:</h4>
<p>The discussion of macros for function names reminds me of a macro I wish existed: <code>path_of!($path)</code>, which would take some in-scope path, and give me an absolute path to that location. EG <code>path_of!(Debug) -&gt; ::core::fmt::Debug</code> or <code>path_of!(imported_fn) -&gt; ::crate_name::module::imported_fn</code>. I can see some issues around, say, pub-in-priv or such, but it would be really nice to be able to generate some arbitrary 'side' data in a macro, then access it later.<br>
A current workaround is to generate an item in a different namespace alongside, so an import of the item can use that macro. However, this is brittle as there's no single namespace for all cases, and also is fragile to the user wanting to do the same thing. So only one 'alongside' item can generally exist.</p>



<a name="269621310"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/219381-t-libs/topic/Path%20of%20macro/near/269621310" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> CraftSpider <a href="https://zulip-archive.rust-lang.org/stream/219381-t-libs/topic/Path.20of.20macro.html#269621310">(Jan 27 2022 at 19:02)</a>:</h4>
<p>The other issue is that this would have to take place at a 'weird' level, as it would need to know enough to resolve but not yet have fully expanded all macros. I'm not sure if the existing module_path macro architecture works for this or not, as I'm not super deep into the compiler's internal magic</p>



<a name="269621450"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/219381-t-libs/topic/Path%20of%20macro/near/269621450" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> CraftSpider <a href="https://zulip-archive.rust-lang.org/stream/219381-t-libs/topic/Path.20of.20macro.html#269621450">(Jan 27 2022 at 19:03)</a>:</h4>
<p>But this could be useful for things 'alongside' at module level, but also enum variants (if only some are in scope), and I fell would make a lot of macro-based interpretation of items less brittle</p>



<a name="269621825"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/219381-t-libs/topic/Path%20of%20macro/near/269621825" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> bstrie <a href="https://zulip-archive.rust-lang.org/stream/219381-t-libs/topic/Path.20of.20macro.html#269621825">(Jan 27 2022 at 19:06)</a>:</h4>
<blockquote>
<p>can see some issues around, say, pub-in-priv or such</p>
</blockquote>



<a name="269621843"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/219381-t-libs/topic/Path%20of%20macro/near/269621843" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> bstrie <a href="https://zulip-archive.rust-lang.org/stream/219381-t-libs/topic/Path.20of.20macro.html#269621843">(Jan 27 2022 at 19:06)</a>:</h4>
<p>I don't think item privacy actually tries to hide items, it just prevents you from using them</p>



<a name="269621878"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/219381-t-libs/topic/Path%20of%20macro/near/269621878" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> bstrie <a href="https://zulip-archive.rust-lang.org/stream/219381-t-libs/topic/Path.20of.20macro.html#269621878">(Jan 27 2022 at 19:07)</a>:</h4>
<p>unless I'm misunderstanding the problem?</p>



<a name="269622151"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/219381-t-libs/topic/Path%20of%20macro/near/269622151" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> CraftSpider <a href="https://zulip-archive.rust-lang.org/stream/219381-t-libs/topic/Path.20of.20macro.html#269622151">(Jan 27 2022 at 19:09)</a>:</h4>
<p>Actually you're right, I don't think this would allow anything previously disallowed. I think previously to avoid the question around where in item resolution this falls, I instead considered whether something like a magic <code>Self</code> path qualifier could exist, which would possibly allow naming previously unnameable types, but this sidesteps that issue if it just gets you the path.</p>



<hr><p>Last updated: Apr 12 2022 at 20:01 UTC</p>
</html>