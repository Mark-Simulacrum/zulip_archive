<html>
<head><meta charset="utf-8"><title>Const std::ops traits PR · t-libs · Zulip Chat Archive</title></head>
<h2>Stream: <a href="https://zulip-archive.rust-lang.org/stream/219381-t-libs/index.html">t-libs</a></h2>
<h3>Topic: <a href="https://zulip-archive.rust-lang.org/stream/219381-t-libs/topic/Const.20std.3A.3Aops.20traits.20PR.html">Const std::ops traits PR</a></h3>

<hr>

<base href="https://rust-lang.zulipchat.com">

<head><link href="https://zulip-archive.rust-lang.org/style.css" rel="stylesheet"></head>

<a name="257462957"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/219381-t-libs/topic/Const%20std%3A%3Aops%20traits%20PR/near/257462957" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> AlexApps99 <a href="https://zulip-archive.rust-lang.org/stream/219381-t-libs/topic/Const.20std.3A.3Aops.20traits.20PR.html#257462957">(Oct 14 2021 at 01:01)</a>:</h4>
<p>Hello, writing my first PR, and the goal is to make std::ops traits (<code>Add</code>, <code>Sub</code>, so on) const for primitives and <code>NonZero</code>s.<br>
I am doing this with <a href="https://github.com/rust-lang/rust/issues/67792"><code>const_trait_impl</code></a>, similar to what <a href="https://github.com/rust-lang/rust/issues/87852"><code>const_num_from_num</code></a> does.<br>
Is something like this wanted, even if it uses an unstable feature?</p>
<p>I have also made a patch to make the default functions of PartialEq, Eq, and PartialOrd const, so it's much easier to create const implementations of this, but it's much harder to merge with temporary syntax so I won't humor that just yet.</p>
<p>Have a look at <a href="https://github.com/AlexApps99/rust/tree/const_ops">https://github.com/AlexApps99/rust/tree/const_ops</a> if you want, though it's not a particularly complex set of changes.</p>



<a name="257495067"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/219381-t-libs/topic/Const%20std%3A%3Aops%20traits%20PR/near/257495067" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> oli <a href="https://zulip-archive.rust-lang.org/stream/219381-t-libs/topic/Const.20std.3A.3Aops.20traits.20PR.html#257495067">(Oct 14 2021 at 08:02)</a>:</h4>
<p>yea, we should wait until the next bootstrap bump before doing anything here</p>



<a name="257495773"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/219381-t-libs/topic/Const%20std%3A%3Aops%20traits%20PR/near/257495773" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> oli <a href="https://zulip-archive.rust-lang.org/stream/219381-t-libs/topic/Const.20std.3A.3Aops.20traits.20PR.html#257495773">(Oct 14 2021 at 08:08)</a>:</h4>
<p>also, as mentioned in <a href="#narrow/stream/146212-t-compiler.2Fconst-eval/topic/first.20pr/near/257494822">https://rust-lang.zulipchat.com/#narrow/stream/146212-t-compiler.2Fconst-eval/topic/first.20pr/near/257494822</a>, I just remembered that wg-const-eval can make functions unstably const fn without pinging T-libs, but we never talked about the even-more-unstable const trait bounds, and I just went ahead and merged things without thinking about that.</p>



<a name="257496318"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/219381-t-libs/topic/Const%20std%3A%3Aops%20traits%20PR/near/257496318" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> AlexApps99 <a href="https://zulip-archive.rust-lang.org/stream/219381-t-libs/topic/Const.20std.3A.3Aops.20traits.20PR.html#257496318">(Oct 14 2021 at 08:12)</a>:</h4>
<blockquote>
<p>we should wait until the next bootstrap bump</p>
</blockquote>
<p>When is that? Asking so I know if I should shelve it for now or keep working on it</p>



<a name="257496402"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/219381-t-libs/topic/Const%20std%3A%3Aops%20traits%20PR/near/257496402" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> oli <a href="https://zulip-archive.rust-lang.org/stream/219381-t-libs/topic/Const.20std.3A.3Aops.20traits.20PR.html#257496402">(Oct 14 2021 at 08:13)</a>:</h4>
<p><a href="https://forge.rust-lang.org/">https://forge.rust-lang.org/</a> says october 19th</p>



<a name="257496588"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/219381-t-libs/topic/Const%20std%3A%3Aops%20traits%20PR/near/257496588" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> oli <a href="https://zulip-archive.rust-lang.org/stream/219381-t-libs/topic/Const.20std.3A.3Aops.20traits.20PR.html#257496588">(Oct 14 2021 at 08:15)</a>:</h4>
<p><span class="user-mention silent" data-user-id="124288">oli</span> <a href="#narrow/stream/219381-t-libs/topic/Const.20std.3A.3Aops.20traits.20PR/near/257495067">said</a>:</p>
<blockquote>
<p>yea, we should wait until the next bootstrap bump before doing anything here</p>
</blockquote>
<p>actually, your changes don't use <code>~const</code>, so we're good on that end, no need to wait</p>



<a name="257500050"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/219381-t-libs/topic/Const%20std%3A%3Aops%20traits%20PR/near/257500050" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> AlexApps99 <a href="https://zulip-archive.rust-lang.org/stream/219381-t-libs/topic/Const.20std.3A.3Aops.20traits.20PR.html#257500050">(Oct 14 2021 at 08:42)</a>:</h4>
<p>I put it up as a draft PR here:<br>
<a href="https://github.com/rust-lang/rust/pull/89876">https://github.com/rust-lang/rust/pull/89876</a><br>
It's my first, so I'd be keen for feedback wherever needed.</p>



<a name="257698103"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/219381-t-libs/topic/Const%20std%3A%3Aops%20traits%20PR/near/257698103" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> fee1-dead <a href="https://zulip-archive.rust-lang.org/stream/219381-t-libs/topic/Const.20std.3A.3Aops.20traits.20PR.html#257698103">(Oct 15 2021 at 13:35)</a>:</h4>
<p><span class="user-mention silent" data-user-id="124288">oli</span> <a href="#narrow/stream/219381-t-libs/topic/Const.20std.3A.3Aops.20traits.20PR/near/257496588">said</a>:</p>
<blockquote>
<p><span class="user-mention silent" data-user-id="124288">oli</span> <a href="#narrow/stream/219381-t-libs/topic/Const.20std.3A.3Aops.20traits.20PR/near/257495067">said</a>:</p>
<blockquote>
<p>yea, we should wait until the next bootstrap bump before doing anything here</p>
</blockquote>
<p>actually, your changes don't use <code>~const</code>, so we're good on that end, no need to wait</p>
</blockquote>
<p>Let me be clear about what "constifications" need the next bootstrap bump: inherent associated functions that use <code>~const</code> bounds, and anything that has <code>~const Drop</code> bounds. These are the only things that have not yet entered the beta release IIRC.</p>



<a name="257818559"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/219381-t-libs/topic/Const%20std%3A%3Aops%20traits%20PR/near/257818559" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Josh Triplett <a href="https://zulip-archive.rust-lang.org/stream/219381-t-libs/topic/Const.20std.3A.3Aops.20traits.20PR.html#257818559">(Oct 16 2021 at 09:47)</a>:</h4>
<p>Where is the tracking issue for <code>~const</code>?</p>



<a name="257818831"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/219381-t-libs/topic/Const%20std%3A%3Aops%20traits%20PR/near/257818831" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Josh Triplett <a href="https://zulip-archive.rust-lang.org/stream/219381-t-libs/topic/Const.20std.3A.3Aops.20traits.20PR.html#257818831">(Oct 16 2021 at 09:52)</a>:</h4>
<p>Oh, found it: <a href="https://github.com/rust-lang/rust/issues/67792">https://github.com/rust-lang/rust/issues/67792</a></p>



<a name="258304154"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/219381-t-libs/topic/Const%20std%3A%3Aops%20traits%20PR/near/258304154" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> AlexApps99 <a href="https://zulip-archive.rust-lang.org/stream/219381-t-libs/topic/Const.20std.3A.3Aops.20traits.20PR.html#258304154">(Oct 20 2021 at 02:43)</a>:</h4>
<p>Rebased because a newer PR had overlapping functionality, and took the opportunity to create a tracking issue:<br>
<a href="https://github.com/rust-lang/rust/issues/90080">https://github.com/rust-lang/rust/issues/90080</a></p>



<a name="258327010"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/219381-t-libs/topic/Const%20std%3A%3Aops%20traits%20PR/near/258327010" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> oli <a href="https://zulip-archive.rust-lang.org/stream/219381-t-libs/topic/Const.20std.3A.3Aops.20traits.20PR.html#258327010">(Oct 20 2021 at 07:57)</a>:</h4>
<p>Uh... I didn't see that PR...</p>



<a name="258327248"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/219381-t-libs/topic/Const%20std%3A%3Aops%20traits%20PR/near/258327248" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> oli <a href="https://zulip-archive.rust-lang.org/stream/219381-t-libs/topic/Const.20std.3A.3Aops.20traits.20PR.html#258327248">(Oct 20 2021 at 07:59)</a>:</h4>
<p><span class="user-mention" data-user-id="119235">@David Tolnay</span> we're putting a hold on adding more unstable const impls until a T-libs sign-off on that. I messed up and merged a few PRs already, but we should talk about the ramnifications first</p>



<hr><p>Last updated: Apr 12 2022 at 20:01 UTC</p>
</html>