<html>
<head><meta charset="utf-8"><title>slice::contains key type · t-libs · Zulip Chat Archive</title></head>
<h2>Stream: <a href="https://zulip-archive.rust-lang.org/stream/219381-t-libs/index.html">t-libs</a></h2>
<h3>Topic: <a href="https://zulip-archive.rust-lang.org/stream/219381-t-libs/topic/slice.3A.3Acontains.20key.20type.html">slice::contains key type</a></h3>

<hr>

<base href="https://rust-lang.zulipchat.com">

<head><link href="https://zulip-archive.rust-lang.org/style.css" rel="stylesheet"></head>

<a name="251681704"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/219381-t-libs/topic/slice%3A%3Acontains%20key%20type/near/251681704" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Dirkjan Ochtman <a href="https://zulip-archive.rust-lang.org/stream/219381-t-libs/topic/slice.3A.3Acontains.20key.20type.html#251681704">(Sep 02 2021 at 08:26)</a>:</h4>
<p>I noticed that <code>slice::contains</code> has this example: "If you do not have a <code>&amp;T</code>, but some other value that you can compare with one (for example, <code>String</code> implements <code>PartialEq&lt;str&gt;</code>), you can use <code>iter().any</code>:". I'm wondering, is there a reason not to make this work more along the lines of <code>HashMap::get()</code>, with the parameter getting a different type argument <code>Q</code> and the constraint that <code>Q: PartialEq&lt;T&gt;</code> (or the other way around)?</p>



<a name="251681730"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/219381-t-libs/topic/slice%3A%3Acontains%20key%20type/near/251681730" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Dirkjan Ochtman <a href="https://zulip-archive.rust-lang.org/stream/219381-t-libs/topic/slice.3A.3Acontains.20key.20type.html#251681730">(Sep 02 2021 at 08:26)</a>:</h4>
<p>I suppose the same thing would be true for other slice methods with <code>PartialEq</code> constraints</p>



<a name="251685022"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/219381-t-libs/topic/slice%3A%3Acontains%20key%20type/near/251685022" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mara <a href="https://zulip-archive.rust-lang.org/stream/219381-t-libs/topic/slice.3A.3Acontains.20key.20type.html#251685022">(Sep 02 2021 at 08:55)</a>:</h4>
<p>the signature of <code>slice.contains</code> can't be changed like that without breaking code</p>



<a name="251685452"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/219381-t-libs/topic/slice%3A%3Acontains%20key%20type/near/251685452" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mara <a href="https://zulip-archive.rust-lang.org/stream/219381-t-libs/topic/slice.3A.3Acontains.20key.20type.html#251685452">(Sep 02 2021 at 08:59)</a>:</h4>
<p><a href="https://play.rust-lang.org/?version=stable&amp;mode=debug&amp;edition=2018&amp;gist=0a2cd3b8f43d239452dfd5b34b115d46">https://play.rust-lang.org/?version=stable&amp;mode=debug&amp;edition=2018&amp;gist=0a2cd3b8f43d239452dfd5b34b115d46</a></p>



<a name="251695070"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/219381-t-libs/topic/slice%3A%3Acontains%20key%20type/near/251695070" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Dirkjan Ochtman <a href="https://zulip-archive.rust-lang.org/stream/219381-t-libs/topic/slice.3A.3Acontains.20key.20type.html#251695070">(Sep 02 2021 at 10:34)</a>:</h4>
<p>hmm, thanks, so the issue here is just that it cannot be inferred, and that's part of the compatibility guarantee?</p>



<a name="251695408"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/219381-t-libs/topic/slice%3A%3Acontains%20key%20type/near/251695408" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> The 8472 <a href="https://zulip-archive.rust-lang.org/stream/219381-t-libs/topic/slice.3A.3Acontains.20key.20type.html#251695408">(Sep 02 2021 at 10:38)</a>:</h4>
<p>afaik inference breakage is allowed in principle, but it depends on impact. For contains that might be pretty big</p>



<a name="251695476"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/219381-t-libs/topic/slice%3A%3Acontains%20key%20type/near/251695476" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mara <a href="https://zulip-archive.rust-lang.org/stream/219381-t-libs/topic/slice.3A.3Acontains.20key.20type.html#251695476">(Sep 02 2021 at 10:39)</a>:</h4>
<p>rustc itself doesn't even compile if you make that change to <code>slice.contains</code></p>



<a name="251738804"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/219381-t-libs/topic/slice%3A%3Acontains%20key%20type/near/251738804" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Gus Wynn <a href="https://zulip-archive.rust-lang.org/stream/219381-t-libs/topic/slice.3A.3Acontains.20key.20type.html#251738804">(Sep 02 2021 at 15:59)</a>:</h4>
<p>This issue: <a href="https://github.com/rust-lang/rust/issues/42671">https://github.com/rust-lang/rust/issues/42671</a> (2017, wowee) suggested adding a <code>contains_ref</code></p>



<a name="251962695"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/219381-t-libs/topic/slice%3A%3Acontains%20key%20type/near/251962695" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Thom Chiovoloni <a href="https://zulip-archive.rust-lang.org/stream/219381-t-libs/topic/slice.3A.3Acontains.20key.20type.html#251962695">(Sep 04 2021 at 01:37)</a>:</h4>
<p>I think this was covered by the (now withdrawan) needle api in the past. There are a few things like this; I had wanted position/rposition too (see <a href="https://github.com/rust-lang/rust/pull/84058">https://github.com/rust-lang/rust/pull/84058</a>).</p>
<p>I think the fact that that needle and such is now not going to happen (which is probably the right call), there's a number of slice methods that were tied up in it which we should consider stabilizing somehow</p>



<hr><p>Last updated: Apr 12 2022 at 20:01 UTC</p>
</html>