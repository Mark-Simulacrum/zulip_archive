<html>
<head><meta charset="utf-8"><title>future deprecation of `env::set_var` · t-libs · Zulip Chat Archive</title></head>
<h2>Stream: <a href="https://zulip-archive.rust-lang.org/stream/219381-t-libs/index.html">t-libs</a></h2>
<h3>Topic: <a href="https://zulip-archive.rust-lang.org/stream/219381-t-libs/topic/future.20deprecation.20of.20.60env.3A.3Aset_var.60.html">future deprecation of `env::set_var`</a></h3>

<hr>

<base href="https://rust-lang.zulipchat.com">

<head><link href="https://zulip-archive.rust-lang.org/style.css" rel="stylesheet"></head>

<a name="266444883"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/219381-t-libs/topic/future%20deprecation%20of%20%60env%3A%3Aset_var%60/near/266444883" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jacob Pratt <a href="https://zulip-archive.rust-lang.org/stream/219381-t-libs/topic/future.20deprecation.20of.20.60env.3A.3Aset_var.60.html#266444883">(Dec 30 2021 at 17:44)</a>:</h4>
<p><span class="user-group-mention" data-user-group-id="2645">@T-libs-api</span> feelings towards marking <code>std::env::set_var</code> and <code>std::env::remove_var</code> as deprecated in the future? As in right now, before an <code>unsafe</code> replacement is present in <code>std</code>. There seems to be some disagreement over whether we should do this (<a href="https://github.com/rust-lang/rust/issues/92365">#92365</a>), so I figure I may as well ping the relevant team to gauge feelings.</p>



<a name="266446020"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/219381-t-libs/topic/future%20deprecation%20of%20%60env%3A%3Aset_var%60/near/266446020" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Josh Triplett <a href="https://zulip-archive.rust-lang.org/stream/219381-t-libs/topic/future.20deprecation.20of.20.60env.3A.3Aset_var.60.html#266446020">(Dec 30 2021 at 18:00)</a>:</h4>
<p>I would be in favor of a future deprecation, just not a present one.</p>



<a name="266446062"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/219381-t-libs/topic/future%20deprecation%20of%20%60env%3A%3Aset_var%60/near/266446062" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jacob Pratt <a href="https://zulip-archive.rust-lang.org/stream/219381-t-libs/topic/future.20deprecation.20of.20.60env.3A.3Aset_var.60.html#266446062">(Dec 30 2021 at 18:01)</a>:</h4>
<p>Yeah, for clarity I mean <code>#[rustc_deprecated(since = "TBD")]</code></p>



<a name="266446409"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/219381-t-libs/topic/future%20deprecation%20of%20%60env%3A%3Aset_var%60/near/266446409" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> simulacrum <a href="https://zulip-archive.rust-lang.org/stream/219381-t-libs/topic/future.20deprecation.20of.20.60env.3A.3Aset_var.60.html#266446409">(Dec 30 2021 at 18:05)</a>:</h4>
<p>That still causes the same warnings for all current users, though, right? It's not really all that different IMO from a user's perspective compared to just deprecating, IIUC what the effect is.</p>
<p>I think we shouldn't do it until we have a plan or set of replacements in place, for the same reasons deprecating the current functions isn't yet a good idea.</p>



<a name="266446429"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/219381-t-libs/topic/future%20deprecation%20of%20%60env%3A%3Aset_var%60/near/266446429" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jacob Pratt <a href="https://zulip-archive.rust-lang.org/stream/219381-t-libs/topic/future.20deprecation.20of.20.60env.3A.3Aset_var.60.html#266446429">(Dec 30 2021 at 18:05)</a>:</h4>
<p>It would cause a warning if <code>#![warn(future_deprecated)]</code> is enabled (which I do not believe is default).</p>



<a name="266446481"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/219381-t-libs/topic/future%20deprecation%20of%20%60env%3A%3Aset_var%60/near/266446481" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jacob Pratt <a href="https://zulip-archive.rust-lang.org/stream/219381-t-libs/topic/future.20deprecation.20of.20.60env.3A.3Aset_var.60.html#266446481">(Dec 30 2021 at 18:06)</a>:</h4>
<p>It doesn't trigger <code>#![warn(deprecated)]</code></p>



<a name="266446482"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/219381-t-libs/topic/future%20deprecation%20of%20%60env%3A%3Aset_var%60/near/266446482" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> simulacrum <a href="https://zulip-archive.rust-lang.org/stream/219381-t-libs/topic/future.20deprecation.20of.20.60env.3A.3Aset_var.60.html#266446482">(Dec 30 2021 at 18:06)</a>:</h4>
<p>Hm, ok</p>



<a name="266446523"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/219381-t-libs/topic/future%20deprecation%20of%20%60env%3A%3Aset_var%60/near/266446523" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> simulacrum <a href="https://zulip-archive.rust-lang.org/stream/219381-t-libs/topic/future.20deprecation.20of.20.60env.3A.3Aset_var.60.html#266446523">(Dec 30 2021 at 18:07)</a>:</h4>
<p>yeah, sounds like that's the case. I'm not sure we'll actually end up deprecating the current functions, and the effect of adding such a label on them seems pretty minimal, but it seems oK then</p>



<a name="266446626"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/219381-t-libs/topic/future%20deprecation%20of%20%60env%3A%3Aset_var%60/near/266446626" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> simulacrum <a href="https://zulip-archive.rust-lang.org/stream/219381-t-libs/topic/future.20deprecation.20of.20.60env.3A.3Aset_var.60.html#266446626">(Dec 30 2021 at 18:08)</a>:</h4>
<p>That particular PR looks more minimal than what I'd expect though -- and maybe regardless of the actual deprecated attribute, adding a paragraph to the docs about the soundness / problems with these functions as they're implemented today seems like a good start to me</p>



<a name="266449127"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/219381-t-libs/topic/future%20deprecation%20of%20%60env%3A%3Aset_var%60/near/266449127" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Josh Triplett <a href="https://zulip-archive.rust-lang.org/stream/219381-t-libs/topic/future.20deprecation.20of.20.60env.3A.3Aset_var.60.html#266449127">(Dec 30 2021 at 18:45)</a>:</h4>
<p><span class="user-mention silent" data-user-id="116122">simulacrum</span> <a href="#narrow/stream/219381-t-libs/topic/future.20deprecation.20of.20.60env.3A.3Aset_var.60/near/266446626">said</a>:</p>
<blockquote>
<p>adding a paragraph to the docs about the soundness / problems with these functions as they're implemented today seems like a good start to me</p>
</blockquote>
<p>There appears to be at least some such documentation already.</p>



<hr><p>Last updated: Apr 12 2022 at 20:01 UTC</p>
</html>