<html>
<head><meta charset="utf-8"><title>Moving socket2 crate to Tokio&#x27;s organisation · t-libs · Zulip Chat Archive</title></head>
<h2>Stream: <a href="https://zulip-archive.rust-lang.org/stream/219381-t-libs/index.html">t-libs</a></h2>
<h3>Topic: <a href="https://zulip-archive.rust-lang.org/stream/219381-t-libs/topic/Moving.20socket2.20crate.20to.20Tokio&#x27;s.20organisation.html">Moving socket2 crate to Tokio&#x27;s organisation</a></h3>

<hr>

<base href="https://rust-lang.zulipchat.com">

<head><link href="https://zulip-archive.rust-lang.org/style.css" rel="stylesheet"></head>

<a name="258818794"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/219381-t-libs/topic/Moving%20socket2%20crate%20to%20Tokio%27s%20organisation/near/258818794" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Thomas de Zeeuw <a href="https://zulip-archive.rust-lang.org/stream/219381-t-libs/topic/Moving.20socket2.20crate.20to.20Tokio&#x27;s.20organisation.html#258818794">(Oct 23 2021 at 11:37)</a>:</h4>
<p>Currently the maintenance for various crates in the rust-lang organisation is somewhat lacking. To be clear I'm not trying to point fingers here, but I think it's clear that we just need more people. I became the maintainer of socket2 after the original creators moved on. I was happy to do maintain socket2 (still am), but I'm the only one doing it. I'm fine with that, but if I get hit by a bus... then who's stepping up? </p>
<p>The Tokio organisation has offered to maintain the repo. I'm already maintaining Mio in the Tokio org so personally I'm ok either way. I've created an issue in the socket2 repo (<a href="https://github.com/rust-lang/socket2/issues/269">https://github.com/rust-lang/socket2/issues/269</a>), but got no response.</p>
<p>Since the libs team still owns the crate (I think, I'm not sure), I wanted to check here before moving the repo (since I've see no objections so far).</p>



<a name="258819654"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/219381-t-libs/topic/Moving%20socket2%20crate%20to%20Tokio%27s%20organisation/near/258819654" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Josh Triplett <a href="https://zulip-archive.rust-lang.org/stream/219381-t-libs/topic/Moving.20socket2.20crate.20to.20Tokio&#x27;s.20organisation.html#258819654">(Oct 23 2021 at 12:01)</a>:</h4>
<p><span class="user-mention" data-user-id="358138">@Thomas de Zeeuw</span> I remember some time ago there was some discussion about trying to merge some of the functionality of socket2 into the standard library. Is there still an interest in doing so? I personally would be thrilled to merge support for additional options on sockets, including target-specific options.</p>



<a name="258819667"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/219381-t-libs/topic/Moving%20socket2%20crate%20to%20Tokio%27s%20organisation/near/258819667" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Josh Triplett <a href="https://zulip-archive.rust-lang.org/stream/219381-t-libs/topic/Moving.20socket2.20crate.20to.20Tokio&#x27;s.20organisation.html#258819667">(Oct 23 2021 at 12:01)</a>:</h4>
<p>(That's not directly addressing your question, but it seems related.)</p>



<a name="258819723"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/219381-t-libs/topic/Moving%20socket2%20crate%20to%20Tokio%27s%20organisation/near/258819723" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Thomas de Zeeuw <a href="https://zulip-archive.rust-lang.org/stream/219381-t-libs/topic/Moving.20socket2.20crate.20to.20Tokio&#x27;s.20organisation.html#258819723">(Oct 23 2021 at 12:02)</a>:</h4>
<p><span class="user-mention silent" data-user-id="239881">Josh Triplett</span> <a href="#narrow/stream/219381-t-libs/topic/Moving.20socket2.20crate.20to.20Tokio's.20organisation/near/258819654">said</a>:</p>
<blockquote>
<p><span class="user-mention silent" data-user-id="358138">Thomas de Zeeuw</span> I remember some time ago there was some discussion about trying to merge some of the functionality of socket2 into the standard library. Is there still an interest in doing so? I personally would be thrilled to merge support for additional options on sockets, including target-specific options.</p>
</blockquote>
<p>This was indeed my intention, but more as a std-lib depending on socket2 (similar to what the HashMap type does with the hashbrown crate). I think this can still continue, but I personally don't have the time for it anymore</p>



<a name="258819724"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/219381-t-libs/topic/Moving%20socket2%20crate%20to%20Tokio%27s%20organisation/near/258819724" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Josh Triplett <a href="https://zulip-archive.rust-lang.org/stream/219381-t-libs/topic/Moving.20socket2.20crate.20to.20Tokio&#x27;s.20organisation.html#258819724">(Oct 23 2021 at 12:02)</a>:</h4>
<p>In general, I'd love to see a semi-unsafe <code>setsockopt</code> (handling buffer size but not knowing the type of the option you're passing) and a safe wrapper around it for any useful option, as one example.</p>



<a name="258819737"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/219381-t-libs/topic/Moving%20socket2%20crate%20to%20Tokio%27s%20organisation/near/258819737" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Josh Triplett <a href="https://zulip-archive.rust-lang.org/stream/219381-t-libs/topic/Moving.20socket2.20crate.20to.20Tokio&#x27;s.20organisation.html#258819737">(Oct 23 2021 at 12:03)</a>:</h4>
<p><span class="user-mention silent" data-user-id="358138">Thomas de Zeeuw</span> <a href="#narrow/stream/219381-t-libs/topic/Moving.20socket2.20crate.20to.20Tokio's.20organisation/near/258819723">said</a>:</p>
<blockquote>
<p><span class="user-mention silent" data-user-id="239881">Josh Triplett</span> <a href="#narrow/stream/219381-t-libs/topic/Moving.20socket2.20crate.20to.20Tokio's.20organisation/near/258819654">said</a>:</p>
<blockquote>
<p><span class="user-mention silent" data-user-id="358138">Thomas de Zeeuw</span> I remember some time ago there was some discussion about trying to merge some of the functionality of socket2 into the standard library. Is there still an interest in doing so? I personally would be thrilled to merge support for additional options on sockets, including target-specific options.</p>
</blockquote>
<p>This was indeed my intention, but more as a std-lib depending on socket2 (similar to what the HashMap type does with the hashbrown crate). I think this can still continue, but I personally don't have the time for it anymore</p>
</blockquote>
<p>Would you be open to the idea of just directly adding the functionality to the standard library socket types?</p>



<a name="258820025"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/219381-t-libs/topic/Moving%20socket2%20crate%20to%20Tokio%27s%20organisation/near/258820025" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Thomas de Zeeuw <a href="https://zulip-archive.rust-lang.org/stream/219381-t-libs/topic/Moving.20socket2.20crate.20to.20Tokio&#x27;s.20organisation.html#258820025">(Oct 23 2021 at 12:10)</a>:</h4>
<p>Yes and no. Yes because I also like to see std lib socket's get some more options. However I still need the socket2 library in my own crates (Mio, Heph and possibly Tokio in the future), which don't/can't depend on std lib's socket types. So that would mean we still have two implementation of the same thing, which I think is a mistake.</p>



<a name="258821358"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/219381-t-libs/topic/Moving%20socket2%20crate%20to%20Tokio%27s%20organisation/near/258821358" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> The 8472 <a href="https://zulip-archive.rust-lang.org/stream/219381-t-libs/topic/Moving.20socket2.20crate.20to.20Tokio&#x27;s.20organisation.html#258821358">(Oct 23 2021 at 12:44)</a>:</h4>
<blockquote>
<p>which don't/can't depend on std lib's socket types.</p>
</blockquote>
<p>Tangentially, we have IO-safety now with BorrowedFd (unix) and BorrowedSocket (windows). Maybe a cross-platform abstraction BorrowedSocketIsh would help these kinds of libraries to make conversion easier without needing platform-specific <code>cfg</code> stuff.</p>



<a name="258829482"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/219381-t-libs/topic/Moving%20socket2%20crate%20to%20Tokio%27s%20organisation/near/258829482" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Thomas de Zeeuw <a href="https://zulip-archive.rust-lang.org/stream/219381-t-libs/topic/Moving.20socket2.20crate.20to.20Tokio&#x27;s.20organisation.html#258829482">(Oct 23 2021 at 15:41)</a>:</h4>
<p><span class="user-mention silent" data-user-id="330154">The 8472</span> <a href="#narrow/stream/219381-t-libs/topic/Moving.20socket2.20crate.20to.20Tokio's.20organisation/near/258821358">said</a>:</p>
<blockquote>
<blockquote>
<p>which don't/can't depend on std lib's socket types.</p>
</blockquote>
<p>Tangentially, we have IO-safety now with BorrowedFd (unix) and BorrowedSocket (windows). Maybe a cross-platform abstraction BorrowedSocketIsh would help these kinds of libraries to make conversion easier without needing platform-specific <code>cfg</code> stuff.</p>
</blockquote>
<p>You mean <a href="https://docs.rs/socket2/0.4.2/socket2/struct.SockRef.html">https://docs.rs/socket2/0.4.2/socket2/struct.SockRef.html</a>?</p>



<a name="258830534"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/219381-t-libs/topic/Moving%20socket2%20crate%20to%20Tokio%27s%20organisation/near/258830534" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> The 8472 <a href="https://zulip-archive.rust-lang.org/stream/219381-t-libs/topic/Moving.20socket2.20crate.20to.20Tokio&#x27;s.20organisation.html#258830534">(Oct 23 2021 at 16:06)</a>:</h4>
<p>Oh, yeah, that works. Didn't see that <code>From</code> impl.</p>



<a name="258842587"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/219381-t-libs/topic/Moving%20socket2%20crate%20to%20Tokio%27s%20organisation/near/258842587" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Kestrer <a href="https://zulip-archive.rust-lang.org/stream/219381-t-libs/topic/Moving.20socket2.20crate.20to.20Tokio&#x27;s.20organisation.html#258842587">(Oct 23 2021 at 21:03)</a>:</h4>
<blockquote>
<p>which don't/can't depend on std lib's socket types</p>
</blockquote>
<p>Wait, why not? Neither crates are <code>#![no_std]</code>.</p>
<blockquote>
<p>Maybe a cross-platform abstraction BorrowedSocketIsh would help</p>
</blockquote>
<p>The Socketlike family of types exists in the io-lifetimes crate (<a href="https://docs.rs/io-lifetimes">https://docs.rs/io-lifetimes</a>) for this purpose. I think this was removed from the RFC though.</p>



<a name="259054902"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/219381-t-libs/topic/Moving%20socket2%20crate%20to%20Tokio%27s%20organisation/near/259054902" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Alice Ryhl <a href="https://zulip-archive.rust-lang.org/stream/219381-t-libs/topic/Moving.20socket2.20crate.20to.20Tokio&#x27;s.20organisation.html#259054902">(Oct 26 2021 at 05:57)</a>:</h4>
<p>What is the realistic timeline if we want to get socket2 to become part of std in a hashbrown-like solution?</p>



<a name="259070346"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/219381-t-libs/topic/Moving%20socket2%20crate%20to%20Tokio%27s%20organisation/near/259070346" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Josh Triplett <a href="https://zulip-archive.rust-lang.org/stream/219381-t-libs/topic/Moving.20socket2.20crate.20to.20Tokio&#x27;s.20organisation.html#259070346">(Oct 26 2021 at 09:17)</a>:</h4>
<p>Does socket2 support no_std?</p>



<a name="259133994"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/219381-t-libs/topic/Moving%20socket2%20crate%20to%20Tokio%27s%20organisation/near/259133994" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Alice Ryhl <a href="https://zulip-archive.rust-lang.org/stream/219381-t-libs/topic/Moving.20socket2.20crate.20to.20Tokio&#x27;s.20organisation.html#259133994">(Oct 26 2021 at 17:42)</a>:</h4>
<p>No I don't think so.</p>



<a name="259137743"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/219381-t-libs/topic/Moving%20socket2%20crate%20to%20Tokio%27s%20organisation/near/259137743" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Josh Triplett <a href="https://zulip-archive.rust-lang.org/stream/219381-t-libs/topic/Moving.20socket2.20crate.20to.20Tokio&#x27;s.20organisation.html#259137743">(Oct 26 2021 at 18:09)</a>:</h4>
<p><span class="user-mention" data-user-id="218683">@Alice Ryhl</span> One issue we've run into is that if a crate wants to be a dependency of std, it needs to not, itself, depend on std.</p>



<a name="259137923"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/219381-t-libs/topic/Moving%20socket2%20crate%20to%20Tokio%27s%20organisation/near/259137923" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Josh Triplett <a href="https://zulip-archive.rust-lang.org/stream/219381-t-libs/topic/Moving.20socket2.20crate.20to.20Tokio&#x27;s.20organisation.html#259137923">(Oct 26 2021 at 18:10)</a>:</h4>
<p>I'm also wondering what about the implementation would make such a dependency sufficient to save substantial implementation burden, compared to (for instance) flipping it around and having socket2 use (and extend) std sockets.</p>



<a name="259137946"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/219381-t-libs/topic/Moving%20socket2%20crate%20to%20Tokio%27s%20organisation/near/259137946" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Josh Triplett <a href="https://zulip-archive.rust-lang.org/stream/219381-t-libs/topic/Moving.20socket2.20crate.20to.20Tokio&#x27;s.20organisation.html#259137946">(Oct 26 2021 at 18:10)</a>:</h4>
<p>Especially if we expose more functionality in std sockets.</p>



<a name="260832531"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/219381-t-libs/topic/Moving%20socket2%20crate%20to%20Tokio%27s%20organisation/near/260832531" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Thomas de Zeeuw <a href="https://zulip-archive.rust-lang.org/stream/219381-t-libs/topic/Moving.20socket2.20crate.20to.20Tokio&#x27;s.20organisation.html#260832531">(Nov 09 2021 at 17:43)</a>:</h4>
<p>I noticed that I can't ping the lib team on issues. Could lib team ping and/or take a look at <a href="https://github.com/rust-lang/socket2/issues/269">https://github.com/rust-lang/socket2/issues/269</a>?</p>



<a name="265163143"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/219381-t-libs/topic/Moving%20socket2%20crate%20to%20Tokio%27s%20organisation/near/265163143" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mara <a href="https://zulip-archive.rust-lang.org/stream/219381-t-libs/topic/Moving.20socket2.20crate.20to.20Tokio&#x27;s.20organisation.html#265163143">(Dec 16 2021 at 14:27)</a>:</h4>
<p><span class="user-mention" data-user-id="358138">@Thomas de Zeeuw</span> sorry for the very late reply here. the best way to get our attention and input on sometihng is to open an issue on the libs-team or rust repository and label it as I-libs-nominated. then it appears on our agenda for the next meeting. or just leave a message in the <a class="stream" data-stream-id="259402" href="/#narrow/stream/259402-t-libs.2Fmeetings">#t-libs/meetings</a> channel. the <a class="stream" data-stream-id="219381" href="/#narrow/stream/219381-t-libs">#t-libs</a> channel itself is very active with a lot of things that don't need team decisions, so things that need to be discussed in a meeting easily get lost when posted here.</p>



<a name="265281975"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/219381-t-libs/topic/Moving%20socket2%20crate%20to%20Tokio%27s%20organisation/near/265281975" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Thomas de Zeeuw <a href="https://zulip-archive.rust-lang.org/stream/219381-t-libs/topic/Moving.20socket2.20crate.20to.20Tokio&#x27;s.20organisation.html#265281975">(Dec 17 2021 at 11:04)</a>:</h4>
<p><span class="user-mention" data-user-id="310399">@Mara</span> Thanks for the tip, didn't know that. I tried pinging @rust-lang/libs on GitHub in <a href="https://github.com/rust-lang/socket2/issues/269#issuecomment-962607039">https://github.com/rust-lang/socket2/issues/269#issuecomment-962607039</a>, but that didn't work.</p>



<a name="265369165"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/219381-t-libs/topic/Moving%20socket2%20crate%20to%20Tokio%27s%20organisation/near/265369165" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Waffle Lapkin <a href="https://zulip-archive.rust-lang.org/stream/219381-t-libs/topic/Moving.20socket2.20crate.20to.20Tokio&#x27;s.20organisation.html#265369165">(Dec 17 2021 at 22:24)</a>:</h4>
<p>Pinging teams on GitHub only works for members of the organization afaik (i.e. you need to be a member in order to ping teams)</p>



<hr><p>Last updated: Apr 12 2022 at 20:01 UTC</p>
</html>