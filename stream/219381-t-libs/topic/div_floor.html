<html>
<head><meta charset="utf-8"><title>div_floor · t-libs · Zulip Chat Archive</title></head>
<h2>Stream: <a href="https://zulip-archive.rust-lang.org/stream/219381-t-libs/index.html">t-libs</a></h2>
<h3>Topic: <a href="https://zulip-archive.rust-lang.org/stream/219381-t-libs/topic/div_floor.html">div_floor</a></h3>

<hr>

<base href="https://rust-lang.zulipchat.com">

<head><link href="https://zulip-archive.rust-lang.org/style.css" rel="stylesheet"></head>

<a name="251099939"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/219381-t-libs/topic/div_floor/near/251099939" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jacob Pratt <a href="https://zulip-archive.rust-lang.org/stream/219381-t-libs/topic/div_floor.html#251099939">(Aug 29 2021 at 02:53)</a>:</h4>
<p>Would a PR that adds a <code>div_floor</code> method to signed integer types be accepted? It would have the signature <code>const fn div_floor(self, rhs: Self) -&gt; Self</code>. I have found a method like this to be quite useful for implementing certain algorithms.</p>



<a name="251099997"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/219381-t-libs/topic/div_floor/near/251099997" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jacob Pratt <a href="https://zulip-archive.rust-lang.org/stream/219381-t-libs/topic/div_floor.html#251099997">(Aug 29 2021 at 02:54)</a>:</h4>
<p>In that regard, would a method like this need to be unstable to start? I've seen some methods be insta-stable that are trivial, but I've no idea what the criteria are for that, if any even exist.</p>



<a name="251100085"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/219381-t-libs/topic/div_floor/near/251100085" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Josh Triplett <a href="https://zulip-archive.rust-lang.org/stream/219381-t-libs/topic/div_floor.html#251100085">(Aug 29 2021 at 02:56)</a>:</h4>
<p><span class="user-mention" data-user-id="245610">@Jacob Pratt</span> floor, or round-towards-zero?</p>



<a name="251100092"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/219381-t-libs/topic/div_floor/near/251100092" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jacob Pratt <a href="https://zulip-archive.rust-lang.org/stream/219381-t-libs/topic/div_floor.html#251100092">(Aug 29 2021 at 02:56)</a>:</h4>
<p>Floor. Round towards negative infinity.</p>



<a name="251100098"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/219381-t-libs/topic/div_floor/near/251100098" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Josh Triplett <a href="https://zulip-archive.rust-lang.org/stream/219381-t-libs/topic/div_floor.html#251100098">(Aug 29 2021 at 02:56)</a>:</h4>
<p>Huh. What algorithms does that function particularly help with?</p>



<a name="251100105"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/219381-t-libs/topic/div_floor/near/251100105" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jacob Pratt <a href="https://zulip-archive.rust-lang.org/stream/219381-t-libs/topic/div_floor.html#251100105">(Aug 29 2021 at 02:57)</a>:</h4>
<p>There are some with datetime arithmetic. Give me a minute and I can pull up a concrete example.</p>



<a name="251100135"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/219381-t-libs/topic/div_floor/near/251100135" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Josh Triplett <a href="https://zulip-archive.rust-lang.org/stream/219381-t-libs/topic/div_floor.html#251100135">(Aug 29 2021 at 02:57)</a>:</h4>
<p>(Not doubting it, just looking to learn.)</p>



<a name="251100204"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/219381-t-libs/topic/div_floor/near/251100204" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Josh Triplett <a href="https://zulip-archive.rust-lang.org/stream/219381-t-libs/topic/div_floor.html#251100204">(Aug 29 2021 at 02:58)</a>:</h4>
<p>I'd be happy to see <code>div_floor</code>; I'd also really like <code>div_round_up</code>.</p>



<a name="251100221"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/219381-t-libs/topic/div_floor/near/251100221" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jacob Pratt <a href="https://zulip-archive.rust-lang.org/stream/219381-t-libs/topic/div_floor.html#251100221">(Aug 29 2021 at 02:59)</a>:</h4>
<p>Oh, for sure. First one that pops up from a quick <code>rg</code> is calculating the day of the year (like 1-365) from a week number and weekday: <a href="https://github.com/time-rs/time/blob/ffb028e4d653899ecdff748c0198f2300f566ef3/src/date.rs#L146-L147">https://github.com/time-rs/time/blob/ffb028e4d653899ecdff748c0198f2300f566ef3/src/date.rs#L146-L147</a></p>



<a name="251100227"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/219381-t-libs/topic/div_floor/near/251100227" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jacob Pratt <a href="https://zulip-archive.rust-lang.org/stream/219381-t-libs/topic/div_floor.html#251100227">(Aug 29 2021 at 02:59)</a>:</h4>
<p><code>div_ceil</code> would go alongside it, sure.</p>



<a name="251100237"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/219381-t-libs/topic/div_floor/near/251100237" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jacob Pratt <a href="https://zulip-archive.rust-lang.org/stream/219381-t-libs/topic/div_floor.html#251100237">(Aug 29 2021 at 02:59)</a>:</h4>
<p>Personally I'd like to see a fair amount of <code>num</code> uplifted into <code>core</code>, but that's my preference.</p>



<a name="251100361"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/219381-t-libs/topic/div_floor/near/251100361" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Josh Triplett <a href="https://zulip-archive.rust-lang.org/stream/219381-t-libs/topic/div_floor.html#251100361">(Aug 29 2021 at 03:01)</a>:</h4>
<p>I would as well.</p>



<a name="251100365"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/219381-t-libs/topic/div_floor/near/251100365" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Josh Triplett <a href="https://zulip-archive.rust-lang.org/stream/219381-t-libs/topic/div_floor.html#251100365">(Aug 29 2021 at 03:01)</a>:</h4>
<p>I would personally r+ a patch adding both div_floor and div_ceil.</p>



<a name="251100375"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/219381-t-libs/topic/div_floor/near/251100375" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Josh Triplett <a href="https://zulip-archive.rust-lang.org/stream/219381-t-libs/topic/div_floor.html#251100375">(Aug 29 2021 at 03:01)</a>:</h4>
<p>(along with tests and docs)</p>



<a name="251100436"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/219381-t-libs/topic/div_floor/near/251100436" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Josh Triplett <a href="https://zulip-archive.rust-lang.org/stream/219381-t-libs/topic/div_floor.html#251100436">(Aug 29 2021 at 03:02)</a>:</h4>
<p>I'd also really love to have <code>round_up_to_multiple</code>.</p>



<a name="251100440"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/219381-t-libs/topic/div_floor/near/251100440" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jacob Pratt <a href="https://zulip-archive.rust-lang.org/stream/219381-t-libs/topic/div_floor.html#251100440">(Aug 29 2021 at 03:02)</a>:</h4>
<p>Unstable I presume?</p>



<a name="251100449"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/219381-t-libs/topic/div_floor/near/251100449" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jacob Pratt <a href="https://zulip-archive.rust-lang.org/stream/219381-t-libs/topic/div_floor.html#251100449">(Aug 29 2021 at 03:02)</a>:</h4>
<p>Like <code>3.round_up_to_multiple(5) == 5</code>?</p>



<a name="251100454"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/219381-t-libs/topic/div_floor/near/251100454" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jacob Pratt <a href="https://zulip-archive.rust-lang.org/stream/219381-t-libs/topic/div_floor.html#251100454">(Aug 29 2021 at 03:03)</a>:</h4>
<p>(naming aside)</p>



<a name="251100458"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/219381-t-libs/topic/div_floor/near/251100458" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Josh Triplett <a href="https://zulip-archive.rust-lang.org/stream/219381-t-libs/topic/div_floor.html#251100458">(Aug 29 2021 at 03:03)</a>:</h4>
<p>Right. Unstable methods (with feature gate) just need an r+, but stabilization needs an FCP.</p>



<a name="251100460"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/219381-t-libs/topic/div_floor/near/251100460" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Josh Triplett <a href="https://zulip-archive.rust-lang.org/stream/219381-t-libs/topic/div_floor.html#251100460">(Aug 29 2021 at 03:03)</a>:</h4>
<p><span class="user-mention silent" data-user-id="245610">Jacob Pratt</span> <a href="#narrow/stream/219381-t-libs/topic/div_floor/near/251100449">said</a>:</p>
<blockquote>
<p>Like <code>3.round_up_to_multiple(5) == 5</code>?</p>
</blockquote>
<p>Yes.</p>



<a name="251100473"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/219381-t-libs/topic/div_floor/near/251100473" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Josh Triplett <a href="https://zulip-archive.rust-lang.org/stream/219381-t-libs/topic/div_floor.html#251100473">(Aug 29 2021 at 03:03)</a>:</h4>
<p>Semantically, <code>x.round_up_to_multiple(y) == x.div_ceil(y) * y</code>.</p>



<a name="251100528"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/219381-t-libs/topic/div_floor/near/251100528" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Josh Triplett <a href="https://zulip-archive.rust-lang.org/stream/219381-t-libs/topic/div_floor.html#251100528">(Aug 29 2021 at 03:04)</a>:</h4>
<p>Tests need to cover corner cases like <code>0</code>, <code>-1</code>, <code>-T::min</code>, <code>T::max</code>, and <code>y</code>.</p>



<a name="251100570"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/219381-t-libs/topic/div_floor/near/251100570" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jacob Pratt <a href="https://zulip-archive.rust-lang.org/stream/219381-t-libs/topic/div_floor.html#251100570">(Aug 29 2021 at 03:05)</a>:</h4>
<p>Should a <code>checked_</code> alternative be provided as well?</p>



<a name="251100580"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/219381-t-libs/topic/div_floor/near/251100580" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jacob Pratt <a href="https://zulip-archive.rust-lang.org/stream/219381-t-libs/topic/div_floor.html#251100580">(Aug 29 2021 at 03:05)</a>:</h4>
<p>What's the use case for rounding to a multiple, anyways?</p>



<a name="251100631"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/219381-t-libs/topic/div_floor/near/251100631" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Josh Triplett <a href="https://zulip-archive.rust-lang.org/stream/219381-t-libs/topic/div_floor.html#251100631">(Aug 29 2021 at 03:06)</a>:</h4>
<p><span class="user-mention" data-user-id="245610">@Jacob Pratt</span> "How many blocks of size N do I need to hold the number of items I have?"</p>



<a name="251100639"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/219381-t-libs/topic/div_floor/near/251100639" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Josh Triplett <a href="https://zulip-archive.rust-lang.org/stream/219381-t-libs/topic/div_floor.html#251100639">(Aug 29 2021 at 03:06)</a>:</h4>
<p>For instance, "how many 4k blocks does this file take up, given the number of bytes in it?".</p>



<a name="251100660"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/219381-t-libs/topic/div_floor/near/251100660" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jacob Pratt <a href="https://zulip-archive.rust-lang.org/stream/219381-t-libs/topic/div_floor.html#251100660">(Aug 29 2021 at 03:07)</a>:</h4>
<p><span aria-label="+1" class="emoji emoji-1f44d" role="img" title="+1">:+1:</span></p>



<a name="251100664"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/219381-t-libs/topic/div_floor/near/251100664" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Josh Triplett <a href="https://zulip-archive.rust-lang.org/stream/219381-t-libs/topic/div_floor.html#251100664">(Aug 29 2021 at 03:07)</a>:</h4>
<p><span class="user-mention silent" data-user-id="245610">Jacob Pratt</span> <a href="#narrow/stream/219381-t-libs/topic/div_floor/near/251100570">said</a>:</p>
<blockquote>
<p>Should a <code>checked_</code> alternative be provided as well?</p>
</blockquote>
<p>round_up_to_multiple (or whatever it gets called) absolutely needs a checked version.</p>



<a name="251100671"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/219381-t-libs/topic/div_floor/near/251100671" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Josh Triplett <a href="https://zulip-archive.rust-lang.org/stream/219381-t-libs/topic/div_floor.html#251100671">(Aug 29 2021 at 03:07)</a>:</h4>
<p>(and not a wrapping version)</p>



<a name="251100763"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/219381-t-libs/topic/div_floor/near/251100763" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Josh Triplett <a href="https://zulip-archive.rust-lang.org/stream/219381-t-libs/topic/div_floor.html#251100763">(Aug 29 2021 at 03:09)</a>:</h4>
<p>I <em>think</em> the only way div_ceil can fail is if you give it 0, or if you do <code>(T::MIN).div_ceil(-1)</code>.</p>



<a name="251100830"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/219381-t-libs/topic/div_floor/near/251100830" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Josh Triplett <a href="https://zulip-archive.rust-lang.org/stream/219381-t-libs/topic/div_floor.html#251100830">(Aug 29 2021 at 03:10)</a>:</h4>
<p>For my part, I primarily need both of these for unsigned types.</p>



<a name="251100842"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/219381-t-libs/topic/div_floor/near/251100842" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Josh Triplett <a href="https://zulip-archive.rust-lang.org/stream/219381-t-libs/topic/div_floor.html#251100842">(Aug 29 2021 at 03:10)</a>:</h4>
<p>In which case I think <code>div_ceil</code> can only fail if given 0, and I think it'd be fine if that's just a panic rather than making a checked version.</p>



<a name="251100927"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/219381-t-libs/topic/div_floor/near/251100927" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jacob Pratt <a href="https://zulip-archive.rust-lang.org/stream/219381-t-libs/topic/div_floor.html#251100927">(Aug 29 2021 at 03:12)</a>:</h4>
<p>so let's add:</p>
<ul>
<li><code>fn div_floor(self, rhs: Self) -&gt; Self</code></li>
<li><code>fn div_ceil(self, rhs: Self) -&gt; Self</code></li>
<li><code>fn round_up_to_multiple(self, rhs: Self) -&gt; Self</code></li>
<li><code>fn checked_div_floor(self, rhs: Self) -&gt; Option&lt;Self&gt;</code></li>
<li><code>fn checked_div_ceil(self, rhs: Self) -&gt; Option&lt;Self&gt;</code></li>
<li><code>fn checked_round_up_to_multiple(self, rhs: Self) -&gt; Option&lt;Self&gt;</code></li>
</ul>
<p>? I don't personally need the checked versions, but they have a plausible use case I think. I <em>would</em> like them to be <code>const fn</code>, but this isn't possible (stably) for an explicit <code>panic!</code>.</p>



<a name="251100964"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/219381-t-libs/topic/div_floor/near/251100964" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Josh Triplett <a href="https://zulip-archive.rust-lang.org/stream/219381-t-libs/topic/div_floor.html#251100964">(Aug 29 2021 at 03:13)</a>:</h4>
<p>Question for you: does the signed case actually need to divide <em>by</em> a signed number, or the corresponding unsigned type?</p>



<a name="251100968"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/219381-t-libs/topic/div_floor/near/251100968" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Josh Triplett <a href="https://zulip-archive.rust-lang.org/stream/219381-t-libs/topic/div_floor.html#251100968">(Aug 29 2021 at 03:13)</a>:</h4>
<p>Does the denominator need to be negative?</p>



<a name="251100974"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/219381-t-libs/topic/div_floor/near/251100974" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jacob Pratt <a href="https://zulip-archive.rust-lang.org/stream/219381-t-libs/topic/div_floor.html#251100974">(Aug 29 2021 at 03:13)</a>:</h4>
<p>My personal use case only ever has a positive denominator, though the macro I'm using as a shim would handle it.</p>



<a name="251101017"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/219381-t-libs/topic/div_floor/near/251101017" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Josh Triplett <a href="https://zulip-archive.rust-lang.org/stream/219381-t-libs/topic/div_floor.html#251101017">(Aug 29 2021 at 03:14)</a>:</h4>
<p>(I don't have a use case for the signed operation, which is why I'm asking; happy to defer to you for the semantics of the signed operation.)</p>



<a name="251101036"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/219381-t-libs/topic/div_floor/near/251101036" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Josh Triplett <a href="https://zulip-archive.rust-lang.org/stream/219381-t-libs/topic/div_floor.html#251101036">(Aug 29 2021 at 03:14)</a>:</h4>
<p><span aria-label="+1" class="emoji emoji-1f44d" role="img" title="+1">:+1:</span> for adding all six, if you think None-on-0 is useful. I'd also be happy to <em>not</em> add the checked version of div_ceil or div_floor until someone actually needs it.</p>



<a name="251101054"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/219381-t-libs/topic/div_floor/near/251101054" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Josh Triplett <a href="https://zulip-archive.rust-lang.org/stream/219381-t-libs/topic/div_floor.html#251101054">(Aug 29 2021 at 03:15)</a>:</h4>
<p>Also, I'm wondering if there's a better name for <code>round_up_to_multiple</code>.</p>



<a name="251101058"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/219381-t-libs/topic/div_floor/near/251101058" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jacob Pratt <a href="https://zulip-archive.rust-lang.org/stream/219381-t-libs/topic/div_floor.html#251101058">(Aug 29 2021 at 03:15)</a>:</h4>
<p>Let's defer until someone asks for it, then</p>



<a name="251101066"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/219381-t-libs/topic/div_floor/near/251101066" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jacob Pratt <a href="https://zulip-archive.rust-lang.org/stream/219381-t-libs/topic/div_floor.html#251101066">(Aug 29 2021 at 03:15)</a>:</h4>
<p>And there <em>definitely</em> is, just not sure what</p>



<a name="251101073"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/219381-t-libs/topic/div_floor/near/251101073" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jacob Pratt <a href="https://zulip-archive.rust-lang.org/stream/219381-t-libs/topic/div_floor.html#251101073">(Aug 29 2021 at 03:15)</a>:</h4>
<p>Maybe <code>.next_multiple_of</code>?</p>



<a name="251101077"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/219381-t-libs/topic/div_floor/near/251101077" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Josh Triplett <a href="https://zulip-archive.rust-lang.org/stream/219381-t-libs/topic/div_floor.html#251101077">(Aug 29 2021 at 03:15)</a>:</h4>
<p>The Linux kernel calls these operations <code>div_round_up</code> and <code>round_up</code>, but the latter isn't actually self-explanatory except in the context of the former.</p>



<a name="251101081"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/219381-t-libs/topic/div_floor/near/251101081" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Josh Triplett <a href="https://zulip-archive.rust-lang.org/stream/219381-t-libs/topic/div_floor.html#251101081">(Aug 29 2021 at 03:15)</a>:</h4>
<p><span class="user-mention silent" data-user-id="245610">Jacob Pratt</span> <a href="#narrow/stream/219381-t-libs/topic/div_floor/near/251101073">said</a>:</p>
<blockquote>
<p>Maybe <code>.next_multiple_of</code>?</p>
</blockquote>
<p>Yes!</p>



<a name="251101084"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/219381-t-libs/topic/div_floor/near/251101084" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Josh Triplett <a href="https://zulip-archive.rust-lang.org/stream/219381-t-libs/topic/div_floor.html#251101084">(Aug 29 2021 at 03:15)</a>:</h4>
<p>That's perfect.</p>



<a name="251101101"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/219381-t-libs/topic/div_floor/near/251101101" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Josh Triplett <a href="https://zulip-archive.rust-lang.org/stream/219381-t-libs/topic/div_floor.html#251101101">(Aug 29 2021 at 03:16)</a>:</h4>
<p>Wait, wait, no.</p>



<a name="251101134"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/219381-t-libs/topic/div_floor/near/251101134" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Josh Triplett <a href="https://zulip-archive.rust-lang.org/stream/219381-t-libs/topic/div_floor.html#251101134">(Aug 29 2021 at 03:16)</a>:</h4>
<p><code>4096.next_multiple_of(4096)</code> sounds like it should be 8192, not 4096.</p>



<a name="251101138"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/219381-t-libs/topic/div_floor/near/251101138" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jacob Pratt <a href="https://zulip-archive.rust-lang.org/stream/219381-t-libs/topic/div_floor.html#251101138">(Aug 29 2021 at 03:16)</a>:</h4>
<p>hmmm</p>



<a name="251101148"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/219381-t-libs/topic/div_floor/near/251101148" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jacob Pratt <a href="https://zulip-archive.rust-lang.org/stream/219381-t-libs/topic/div_floor.html#251101148">(Aug 29 2021 at 03:16)</a>:</h4>
<p>which all but rules out anything with "next" in it</p>



<a name="251101157"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/219381-t-libs/topic/div_floor/near/251101157" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Josh Triplett <a href="https://zulip-archive.rust-lang.org/stream/219381-t-libs/topic/div_floor.html#251101157">(Aug 29 2021 at 03:17)</a>:</h4>
<p>Yeah, other than really verbose things like <code>round_to_next_multiple_of</code>.</p>



<a name="251101167"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/219381-t-libs/topic/div_floor/near/251101167" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Josh Triplett <a href="https://zulip-archive.rust-lang.org/stream/219381-t-libs/topic/div_floor.html#251101167">(Aug 29 2021 at 03:17)</a>:</h4>
<p>(which still seems less clear than <code>round_up_...</code> names.)</p>



<a name="251101204"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/219381-t-libs/topic/div_floor/near/251101204" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Josh Triplett <a href="https://zulip-archive.rust-lang.org/stream/219381-t-libs/topic/div_floor.html#251101204">(Aug 29 2021 at 03:18)</a>:</h4>
<p>I think <code>div_ceil</code> is definitely the right name for that operation, with precedent from num-integer.</p>



<a name="251101245"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/219381-t-libs/topic/div_floor/near/251101245" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jacob Pratt <a href="https://zulip-archive.rust-lang.org/stream/219381-t-libs/topic/div_floor.html#251101245">(Aug 29 2021 at 03:18)</a>:</h4>
<p>I think <code>next_multiple_of</code> is actually fine. Precedent being <code>next_power_of_two</code>, which explicitly says greater than or equal in docs.</p>



<a name="251101255"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/219381-t-libs/topic/div_floor/near/251101255" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Josh Triplett <a href="https://zulip-archive.rust-lang.org/stream/219381-t-libs/topic/div_floor.html#251101255">(Aug 29 2021 at 03:19)</a>:</h4>
<p>num-integer <em>does</em> actually call it <code>num_multiple_of</code>.</p>



<a name="251101264"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/219381-t-libs/topic/div_floor/near/251101264" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Josh Triplett <a href="https://zulip-archive.rust-lang.org/stream/219381-t-libs/topic/div_floor.html#251101264">(Aug 29 2021 at 03:19)</a>:</h4>
<p>Which is further precedent.</p>



<a name="251101276"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/219381-t-libs/topic/div_floor/near/251101276" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Josh Triplett <a href="https://zulip-archive.rust-lang.org/stream/219381-t-libs/topic/div_floor.html#251101276">(Aug 29 2021 at 03:19)</a>:</h4>
<p><span aria-label="+1" class="emoji emoji-1f44d" role="img" title="+1">:+1:</span> for just copying num-integer here.</p>



<a name="251101328"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/219381-t-libs/topic/div_floor/near/251101328" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jacob Pratt <a href="https://zulip-archive.rust-lang.org/stream/219381-t-libs/topic/div_floor.html#251101328">(Aug 29 2021 at 03:20)</a>:</h4>
<p>Alright. I'll write that up. May or may not be tonight.</p>



<a name="251101330"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/219381-t-libs/topic/div_floor/near/251101330" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Josh Triplett <a href="https://zulip-archive.rust-lang.org/stream/219381-t-libs/topic/div_floor.html#251101330">(Aug 29 2021 at 03:20)</a>:</h4>
<p>No rush.</p>



<a name="251101334"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/219381-t-libs/topic/div_floor/near/251101334" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Josh Triplett <a href="https://zulip-archive.rust-lang.org/stream/219381-t-libs/topic/div_floor.html#251101334">(Aug 29 2021 at 03:20)</a>:</h4>
<p>But feel free to CC me when it's ready.</p>



<a name="251101338"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/219381-t-libs/topic/div_floor/near/251101338" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jacob Pratt <a href="https://zulip-archive.rust-lang.org/stream/219381-t-libs/topic/div_floor.html#251101338">(Aug 29 2021 at 03:20)</a>:</h4>
<p>Sounds good. Thanks for your input!</p>



<a name="251101348"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/219381-t-libs/topic/div_floor/near/251101348" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Josh Triplett <a href="https://zulip-archive.rust-lang.org/stream/219381-t-libs/topic/div_floor.html#251101348">(Aug 29 2021 at 03:20)</a>:</h4>
<p>num-integer is <code>MIT OR Apache-2.0</code> just like core, so feel free to just copy its docs unless there's something to improve.</p>



<a name="251101369"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/219381-t-libs/topic/div_floor/near/251101369" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mario Carneiro <a href="https://zulip-archive.rust-lang.org/stream/219381-t-libs/topic/div_floor.html#251101369">(Aug 29 2021 at 03:21)</a>:</h4>
<p>FWIW, my two cents is that integer division should always round to negative infinity by default. That has the nicest mathematical properties, and also happens to be what most processors implement</p>



<a name="251101414"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/219381-t-libs/topic/div_floor/near/251101414" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jacob Pratt <a href="https://zulip-archive.rust-lang.org/stream/219381-t-libs/topic/div_floor.html#251101414">(Aug 29 2021 at 03:22)</a>:</h4>
<p>That would be a breaking change to say the least</p>



<a name="251101429"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/219381-t-libs/topic/div_floor/near/251101429" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mario Carneiro <a href="https://zulip-archive.rust-lang.org/stream/219381-t-libs/topic/div_floor.html#251101429">(Aug 29 2021 at 03:22)</a>:</h4>
<p>I'm not sure who came up with round-to-zero integer division (C?) but it has unfortunately spread into most programming languages from there</p>



<a name="251101452"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/219381-t-libs/topic/div_floor/near/251101452" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Josh Triplett <a href="https://zulip-archive.rust-lang.org/stream/219381-t-libs/topic/div_floor.html#251101452">(Aug 29 2021 at 03:23)</a>:</h4>
<p>I think C did, and I think it's the less confusing of the two options.</p>



<a name="251101460"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/219381-t-libs/topic/div_floor/near/251101460" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Josh Triplett <a href="https://zulip-archive.rust-lang.org/stream/219381-t-libs/topic/div_floor.html#251101460">(Aug 29 2021 at 03:23)</a>:</h4>
<p>Both options are really confusing when it comes to negative numbers.</p>



<a name="251101464"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/219381-t-libs/topic/div_floor/near/251101464" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mario Carneiro <a href="https://zulip-archive.rust-lang.org/stream/219381-t-libs/topic/div_floor.html#251101464">(Aug 29 2021 at 03:23)</a>:</h4>
<p>it makes some sense around displaying integers, but it's about as acceptable as 1-based indexing to me</p>



<a name="251101469"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/219381-t-libs/topic/div_floor/near/251101469" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Josh Triplett <a href="https://zulip-archive.rust-lang.org/stream/219381-t-libs/topic/div_floor.html#251101469">(Aug 29 2021 at 03:23)</a>:</h4>
<p>They're <em>especially</em> confusing when it comes to dividing by negative numbers.</p>



<a name="251101535"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/219381-t-libs/topic/div_floor/near/251101535" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mario Carneiro <a href="https://zulip-archive.rust-lang.org/stream/219381-t-libs/topic/div_floor.html#251101535">(Aug 29 2021 at 03:24)</a>:</h4>
<p>for negative divisors, there isn't much standardization. There is a post I read a while ago about three different conventions and the relative advantages between them</p>



<a name="251101637"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/219381-t-libs/topic/div_floor/near/251101637" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Josh Triplett <a href="https://zulip-archive.rust-lang.org/stream/219381-t-libs/topic/div_floor.html#251101637">(Aug 29 2021 at 03:27)</a>:</h4>
<p>I find C's approach clear from a just-truncate perspective, but there's also another reason...</p>



<a name="251101718"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/219381-t-libs/topic/div_floor/near/251101718" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Josh Triplett <a href="https://zulip-archive.rust-lang.org/stream/219381-t-libs/topic/div_floor.html#251101718">(Aug 29 2021 at 03:28)</a>:</h4>
<p>One key reason, I think, is that your choice of behavior for / has to be consistent with your choice of behavior for %.</p>



<a name="251101722"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/219381-t-libs/topic/div_floor/near/251101722" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mario Carneiro <a href="https://zulip-archive.rust-lang.org/stream/219381-t-libs/topic/div_floor.html#251101722">(Aug 29 2021 at 03:28)</a>:</h4>
<p>well that's just restating the problem; truncation is just rounding (but with what rounding mode?)</p>



<a name="251101725"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/219381-t-libs/topic/div_floor/near/251101725" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Josh Triplett <a href="https://zulip-archive.rust-lang.org/stream/219381-t-libs/topic/div_floor.html#251101725">(Aug 29 2021 at 03:28)</a>:</h4>
<div class="codehilite"><pre><span></span><code>x = 10, y = 3, x/y = 3, x%y = 1, (x/y)*y = 9, (x/y)*y + x%y = 10
x = -10, y = 3, x/y = -3, x%y = -1, (x/y)*y = -9, (x/y)*y + x%y = -10
x = 10, y = -3, x/y = -3, x%y = 1, (x/y)*y = 9, (x/y)*y + x%y = 10
x = -10, y = -3, x/y = 3, x%y = -1, (x/y)*y = -9, (x/y)*y + x%y = -10
</code></pre></div>



<a name="251101741"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/219381-t-libs/topic/div_floor/near/251101741" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Josh Triplett <a href="https://zulip-archive.rust-lang.org/stream/219381-t-libs/topic/div_floor.html#251101741">(Aug 29 2021 at 03:29)</a>:</h4>
<p><span class="user-mention silent" data-user-id="271719">Mario Carneiro</span> <a href="#narrow/stream/219381-t-libs/topic/div_floor/near/251101722">said</a>:</p>
<blockquote>
<p>well that's just restating the problem; truncation is just rounding (but with what rounding mode?)</p>
</blockquote>
<p>"truncate" meaning "drop the fractional part". If you drop the fractional part of -9.5 you get -9.</p>



<a name="251101822"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/219381-t-libs/topic/div_floor/near/251101822" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mario Carneiro <a href="https://zulip-archive.rust-lang.org/stream/219381-t-libs/topic/div_floor.html#251101822">(Aug 29 2021 at 03:30)</a>:</h4>
<p>I contest that this is a weird operation unless you use sign-magnitude representation of a number (and english decimal integers happens to use such a representation)</p>



<a name="251101839"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/219381-t-libs/topic/div_floor/near/251101839" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Josh Triplett <a href="https://zulip-archive.rust-lang.org/stream/219381-t-libs/topic/div_floor.html#251101839">(Aug 29 2021 at 03:30)</a>:</h4>
<p>I will not dispute that all of these operations are weird on signed numbers in general.</p>



<a name="251101865"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/219381-t-libs/topic/div_floor/near/251101865" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Josh Triplett <a href="https://zulip-archive.rust-lang.org/stream/219381-t-libs/topic/div_floor.html#251101865">(Aug 29 2021 at 03:31)</a>:</h4>
<p>I think it's fair to say "what's least confusing" and "what's most useful", and weigh both of those in defining the semantics.</p>



<a name="251101867"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/219381-t-libs/topic/div_floor/near/251101867" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mario Carneiro <a href="https://zulip-archive.rust-lang.org/stream/219381-t-libs/topic/div_floor.html#251101867">(Aug 29 2021 at 03:31)</a>:</h4>
<p>the natural algorithm for integer division yields round-to-negative-infinity which is why most processors implement it</p>



<a name="251101915"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/219381-t-libs/topic/div_floor/near/251101915" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mario Carneiro <a href="https://zulip-archive.rust-lang.org/stream/219381-t-libs/topic/div_floor.html#251101915">(Aug 29 2021 at 03:32)</a>:</h4>
<p>it is also generally more useful unless you are manipulating sign-magnitude numbers and/or preparing numbers for display</p>



<a name="251101926"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/219381-t-libs/topic/div_floor/near/251101926" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mario Carneiro <a href="https://zulip-archive.rust-lang.org/stream/219381-t-libs/topic/div_floor.html#251101926">(Aug 29 2021 at 03:32)</a>:</h4>
<p>for example stuff like calculating offsets generally doesn't treat 0 specially</p>



<a name="251102007"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/219381-t-libs/topic/div_floor/near/251102007" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Josh Triplett <a href="https://zulip-archive.rust-lang.org/stream/219381-t-libs/topic/div_floor.html#251102007">(Aug 29 2021 at 03:34)</a>:</h4>
<p>So, while I think it's reasonable to debate what makes the most sense, I think it's clear that 1) Rust chose to be C-compatible here, 2) that would break too many things to change, and thus 3) <code>div_floor</code> is not a redundant operation with <code>/</code>.</p>



<a name="251102620"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/219381-t-libs/topic/div_floor/near/251102620" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Josh Triplett <a href="https://zulip-archive.rust-lang.org/stream/219381-t-libs/topic/div_floor.html#251102620">(Aug 29 2021 at 03:47)</a>:</h4>
<p>(I split the conversations about div/mod semantics and about ! semantics into separate threads.)</p>



<a name="251102705"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/219381-t-libs/topic/div_floor/near/251102705" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mario Carneiro <a href="https://zulip-archive.rust-lang.org/stream/219381-t-libs/topic/div_floor.html#251102705">(Aug 29 2021 at 03:49)</a>:</h4>
<p>I haven't found the original post I was looking for, but I do have a documentation of the three integer division conventions in <a href="https://github.com/leanprover-community/lean/commit/e705d8949002481a118003ea5bee2098226dbd22#diff-28df10e2dbc2fa18af1293c5145788c9983f7e892038b18717a1a80862e976b9R201-R248">this commit here</a> for when I implemented integer division in lean</p>



<a name="251102775"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/219381-t-libs/topic/div_floor/near/251102775" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mario Carneiro <a href="https://zulip-archive.rust-lang.org/stream/219381-t-libs/topic/div_floor.html#251102775">(Aug 29 2021 at 03:50)</a>:</h4>
<p>The one called "T-rounding" is the division you know from C, and "E-rounding" is round to negative infinity</p>



<a name="251102795"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/219381-t-libs/topic/div_floor/near/251102795" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Josh Triplett <a href="https://zulip-archive.rust-lang.org/stream/219381-t-libs/topic/div_floor.html#251102795">(Aug 29 2021 at 03:50)</a>:</h4>
<p>Wait, E-rounding is round-to-negative-infinity, or F-rounding is?</p>



<a name="251102817"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/219381-t-libs/topic/div_floor/near/251102817" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mario Carneiro <a href="https://zulip-archive.rust-lang.org/stream/219381-t-libs/topic/div_floor.html#251102817">(Aug 29 2021 at 03:51)</a>:</h4>
<p>E rounding and F rounding both round to negative infinity, but they differ for when the second number is negative</p>



<a name="251102881"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/219381-t-libs/topic/div_floor/near/251102881" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mario Carneiro <a href="https://zulip-archive.rust-lang.org/stream/219381-t-libs/topic/div_floor.html#251102881">(Aug 29 2021 at 03:52)</a>:</h4>
<p>I'll make up a comparison chart</p>



<a name="251102992"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/219381-t-libs/topic/div_floor/near/251102992" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Josh Triplett <a href="https://zulip-archive.rust-lang.org/stream/219381-t-libs/topic/div_floor.html#251102992">(Aug 29 2021 at 03:54)</a>:</h4>
<p>Ah, makes sense.</p>



<a name="251103138"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/219381-t-libs/topic/div_floor/near/251103138" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mario Carneiro <a href="https://zulip-archive.rust-lang.org/stream/219381-t-libs/topic/div_floor.html#251103138">(Aug 29 2021 at 03:57)</a>:</h4>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="k">#eval</span> <span class="o">(</span><span class="n">int.div</span> <span class="mi">10</span> <span class="mi">3</span><span class="o">,</span> <span class="n">int.mod</span> <span class="mi">10</span> <span class="mi">3</span><span class="o">)</span> <span class="c1">-- (3, 1)</span>
<span class="k">#eval</span> <span class="o">(</span><span class="n">int.fdiv</span> <span class="mi">10</span> <span class="mi">3</span><span class="o">,</span> <span class="n">int.fmod</span> <span class="mi">10</span> <span class="mi">3</span><span class="o">)</span> <span class="c1">-- (3, 1)</span>
<span class="k">#eval</span> <span class="o">(</span><span class="n">int.quot</span> <span class="mi">10</span> <span class="mi">3</span><span class="o">,</span> <span class="n">int.rem</span> <span class="mi">10</span> <span class="mi">3</span><span class="o">)</span> <span class="c1">-- (3, 1)</span>

<span class="k">#eval</span> <span class="o">(</span><span class="n">int.div</span> <span class="o">(</span><span class="bp">-</span><span class="mi">10</span><span class="o">)</span> <span class="mi">3</span><span class="o">,</span> <span class="n">int.mod</span> <span class="o">(</span><span class="bp">-</span><span class="mi">10</span><span class="o">)</span> <span class="mi">3</span><span class="o">)</span> <span class="c1">-- (-4, 2)</span>
<span class="k">#eval</span> <span class="o">(</span><span class="n">int.fdiv</span> <span class="o">(</span><span class="bp">-</span><span class="mi">10</span><span class="o">)</span> <span class="mi">3</span><span class="o">,</span> <span class="n">int.fmod</span> <span class="o">(</span><span class="bp">-</span><span class="mi">10</span><span class="o">)</span> <span class="mi">3</span><span class="o">)</span> <span class="c1">-- (-4, 2)</span>
<span class="k">#eval</span> <span class="o">(</span><span class="n">int.quot</span> <span class="o">(</span><span class="bp">-</span><span class="mi">10</span><span class="o">)</span> <span class="mi">3</span><span class="o">,</span> <span class="n">int.rem</span> <span class="o">(</span><span class="bp">-</span><span class="mi">10</span><span class="o">)</span> <span class="mi">3</span><span class="o">)</span> <span class="c1">-- (-3, 1)</span>

<span class="k">#eval</span> <span class="o">(</span><span class="n">int.div</span> <span class="mi">10</span> <span class="o">(</span><span class="bp">-</span><span class="mi">3</span><span class="o">),</span> <span class="n">int.mod</span> <span class="mi">10</span> <span class="o">(</span><span class="bp">-</span><span class="mi">3</span><span class="o">))</span> <span class="c1">-- (-3, 1)</span>
<span class="k">#eval</span> <span class="o">(</span><span class="n">int.fdiv</span> <span class="mi">10</span> <span class="o">(</span><span class="bp">-</span><span class="mi">3</span><span class="o">),</span> <span class="n">int.fmod</span> <span class="mi">10</span> <span class="o">(</span><span class="bp">-</span><span class="mi">3</span><span class="o">))</span> <span class="c1">-- (-4, -2)</span>
<span class="k">#eval</span> <span class="o">(</span><span class="n">int.quot</span> <span class="mi">10</span> <span class="o">(</span><span class="bp">-</span><span class="mi">3</span><span class="o">),</span> <span class="n">int.rem</span> <span class="mi">10</span> <span class="o">(</span><span class="bp">-</span><span class="mi">3</span><span class="o">))</span> <span class="c1">-- (-3, 1)</span>

<span class="k">#eval</span> <span class="o">(</span><span class="n">int.div</span> <span class="o">(</span><span class="bp">-</span><span class="mi">10</span><span class="o">)</span> <span class="o">(</span><span class="bp">-</span><span class="mi">3</span><span class="o">),</span> <span class="n">int.mod</span> <span class="o">(</span><span class="bp">-</span><span class="mi">10</span><span class="o">)</span> <span class="o">(</span><span class="bp">-</span><span class="mi">3</span><span class="o">))</span> <span class="c1">-- (4, 2)</span>
<span class="k">#eval</span> <span class="o">(</span><span class="n">int.fdiv</span> <span class="o">(</span><span class="bp">-</span><span class="mi">10</span><span class="o">)</span> <span class="o">(</span><span class="bp">-</span><span class="mi">3</span><span class="o">),</span> <span class="n">int.fmod</span> <span class="o">(</span><span class="bp">-</span><span class="mi">10</span><span class="o">)</span> <span class="o">(</span><span class="bp">-</span><span class="mi">3</span><span class="o">))</span> <span class="c1">-- (3, -1)</span>
<span class="k">#eval</span> <span class="o">(</span><span class="n">int.quot</span> <span class="o">(</span><span class="bp">-</span><span class="mi">10</span><span class="o">)</span> <span class="o">(</span><span class="bp">-</span><span class="mi">3</span><span class="o">),</span> <span class="n">int.rem</span> <span class="o">(</span><span class="bp">-</span><span class="mi">10</span><span class="o">)</span> <span class="o">(</span><span class="bp">-</span><span class="mi">3</span><span class="o">))</span> <span class="c1">-- (3, -1)</span>
</code></pre></div>



<a name="251103216"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/219381-t-libs/topic/div_floor/near/251103216" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mario Carneiro <a href="https://zulip-archive.rust-lang.org/stream/219381-t-libs/topic/div_floor.html#251103216">(Aug 29 2021 at 03:58)</a>:</h4>
<p>In the first one, the mod is always nonnegative, in the second one we always round the div down, and in the third we always round the div to 0</p>



<a name="251103236"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/219381-t-libs/topic/div_floor/near/251103236" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mario Carneiro <a href="https://zulip-archive.rust-lang.org/stream/219381-t-libs/topic/div_floor.html#251103236">(Aug 29 2021 at 03:59)</a>:</h4>
<p>and in all cases the <code>x % y + (x / y) * y = x</code> identity holds unconditionally (which either determines the div from the mod or vice versa)</p>



<a name="251103401"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/219381-t-libs/topic/div_floor/near/251103401" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Josh Triplett <a href="https://zulip-archive.rust-lang.org/stream/219381-t-libs/topic/div_floor.html#251103401">(Aug 29 2021 at 04:01)</a>:</h4>
<p><span class="user-mention" data-user-id="245610">@Jacob Pratt</span> I really appreciate you being willing to add all these operations (<code>div_ceil</code>, <code>div_floor</code>, and <code>next_multiple_of</code>), not just the specific one you needed. I think it makes sense to add these as a family.</p>



<a name="251103437"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/219381-t-libs/topic/div_floor/near/251103437" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mario Carneiro <a href="https://zulip-archive.rust-lang.org/stream/219381-t-libs/topic/div_floor.html#251103437">(Aug 29 2021 at 04:02)</a>:</h4>
<p>as you can see, in lean, without a decisive reason to pick one over the other, they are just all provided as functions. In practice no one cares and just uses the one that happens to be registered as <code>/</code></p>



<a name="251103457"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/219381-t-libs/topic/div_floor/near/251103457" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jacob Pratt <a href="https://zulip-archive.rust-lang.org/stream/219381-t-libs/topic/div_floor.html#251103457">(Aug 29 2021 at 04:02)</a>:</h4>
<p>It's not like they're terrible difficult to implement :) may as well help others if I can</p>



<a name="251107478"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/219381-t-libs/topic/div_floor/near/251107478" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Simon Sapin <a href="https://zulip-archive.rust-lang.org/stream/219381-t-libs/topic/div_floor.html#251107478">(Aug 29 2021 at 05:27)</a>:</h4>
<p><span class="user-mention silent" data-user-id="239881">Josh Triplett</span> <a href="#narrow/stream/219381-t-libs/topic/div_floor/near/251101134">said</a>:</p>
<blockquote>
<p><code>4096.next_multiple_of(4096)</code> sounds like it should be 8192, not 4096.</p>
</blockquote>
<p>That’s similar to the stable <a href="https://doc.rust-lang.org/std/primitive.u32.html#method.next_power_of_two"><code>next_power_of_two</code></a> which “Returns the smallest power of two greater than <strong>or equal</strong> to <code>self</code>.”</p>



<a name="251107691"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/219381-t-libs/topic/div_floor/near/251107691" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jacob Pratt <a href="https://zulip-archive.rust-lang.org/stream/219381-t-libs/topic/div_floor.html#251107691">(Aug 29 2021 at 05:31)</a>:</h4>
<p>already mentioned above :)</p>



<a name="251107741"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/219381-t-libs/topic/div_floor/near/251107741" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jacob Pratt <a href="https://zulip-archive.rust-lang.org/stream/219381-t-libs/topic/div_floor.html#251107741">(Aug 29 2021 at 05:32)</a>:</h4>
<p>Side note, but feature name? I was thinking <code>div_floor_ceil</code> and something separate for <code>next_multiple_of</code></p>



<a name="251145686"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/219381-t-libs/topic/div_floor/near/251145686" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> scottmcm <a href="https://zulip-archive.rust-lang.org/stream/219381-t-libs/topic/div_floor.html#251145686">(Aug 29 2021 at 17:21)</a>:</h4>
<p><span class="user-mention silent" data-user-id="245610">Jacob Pratt</span> <a href="#narrow/stream/219381-t-libs/topic/div_floor/near/251100221">said</a>:</p>
<blockquote>
<p>Oh, for sure. First one that pops up from a quick <code>rg</code> is calculating the day of the year (like 1-365) from a week number and weekday: <a href="https://github.com/time-rs/time/blob/ffb028e4d653899ecdff748c0198f2300f566ef3/src/date.rs#L146-L147">https://github.com/time-rs/time/blob/ffb028e4d653899ecdff748c0198f2300f566ef3/src/date.rs#L146-L147</a></p>
</blockquote>
<p>Silly question: would <code>div_euclid</code> not work for it?</p>



<a name="251145750"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/219381-t-libs/topic/div_floor/near/251145750" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Josh Triplett <a href="https://zulip-archive.rust-lang.org/stream/219381-t-libs/topic/div_floor.html#251145750">(Aug 29 2021 at 17:22)</a>:</h4>
<p><span class="user-mention" data-user-id="245610">@Jacob Pratt</span> I think you can use the same feature name for all three; we can always split them if we want a partial stabilization.</p>



<a name="251145767"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/219381-t-libs/topic/div_floor/near/251145767" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Josh Triplett <a href="https://zulip-archive.rust-lang.org/stream/219381-t-libs/topic/div_floor.html#251145767">(Aug 29 2021 at 17:23)</a>:</h4>
<p>more_div_methods or similar?</p>



<a name="251145893"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/219381-t-libs/topic/div_floor/near/251145893" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> scottmcm <a href="https://zulip-archive.rust-lang.org/stream/219381-t-libs/topic/div_floor.html#251145893">(Aug 29 2021 at 17:25)</a>:</h4>
<p><span class="user-mention silent" data-user-id="245610">Jacob Pratt</span> <a href="#narrow/stream/219381-t-libs/topic/div_floor/near/251100927">said</a>:</p>
<blockquote>
<p>? I don't personally need the checked versions, but they have a plausible use case I think. I <em>would</em> like them to be <code>const fn</code>, but this isn't possible (stably) for an explicit <code>panic!</code>.</p>
</blockquote>
<p>I would generally say that either it should just offer <code>foo</code>, or it should have the full slate of <code>wrapping_foo</code>, <code>checked_foo</code>, and <code>saturating_foo</code> too.</p>



<a name="251167400"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/219381-t-libs/topic/div_floor/near/251167400" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mario Carneiro <a href="https://zulip-archive.rust-lang.org/stream/219381-t-libs/topic/div_floor.html#251167400">(Aug 29 2021 at 23:51)</a>:</h4>
<p>Ah right, the E in E-rounding is named for euclid, I forgot</p>



<a name="251167468"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/219381-t-libs/topic/div_floor/near/251167468" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mario Carneiro <a href="https://zulip-archive.rust-lang.org/stream/219381-t-libs/topic/div_floor.html#251167468">(Aug 29 2021 at 23:52)</a>:</h4>
<p>and I guess the others are "floor" and "truncate"</p>



<a name="251174219"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/219381-t-libs/topic/div_floor/near/251174219" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jacob Pratt <a href="https://zulip-archive.rust-lang.org/stream/219381-t-libs/topic/div_floor.html#251174219">(Aug 30 2021 at 01:55)</a>:</h4>
<p><code>div_euclid</code> actually would work. Guess I never looked at the euclidean methods other than <code>rem_euclid</code>.</p>
<p><span class="user-mention" data-user-id="239881">@Josh Triplett</span> I was hoping for a <em>slightly</em> more descriptive feature name, hence my question.</p>



<a name="251174235"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/219381-t-libs/topic/div_floor/near/251174235" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jacob Pratt <a href="https://zulip-archive.rust-lang.org/stream/219381-t-libs/topic/div_floor.html#251174235">(Aug 30 2021 at 01:56)</a>:</h4>
<p>I can still submit the PR if it's desired, though.</p>



<a name="251175387"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/219381-t-libs/topic/div_floor/near/251175387" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lokathor <a href="https://zulip-archive.rust-lang.org/stream/219381-t-libs/topic/div_floor.html#251175387">(Aug 30 2021 at 02:15)</a>:</h4>
<p>nobody needs the feature name after stabilization, so they're mostly just temporary oddities in the long term of it.</p>



<a name="251175727"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/219381-t-libs/topic/div_floor/near/251175727" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jacob Pratt <a href="https://zulip-archive.rust-lang.org/stream/219381-t-libs/topic/div_floor.html#251175727">(Aug 30 2021 at 02:21)</a>:</h4>
<p>Oh I know. But it's still nice to have in the meantime <span aria-label="stuck out tongue" class="emoji emoji-1f61b" role="img" title="stuck out tongue">:stuck_out_tongue:</span></p>



<a name="251177599"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/219381-t-libs/topic/div_floor/near/251177599" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Josh Triplett <a href="https://zulip-archive.rust-lang.org/stream/219381-t-libs/topic/div_floor.html#251177599">(Aug 30 2021 at 02:58)</a>:</h4>
<p><span class="user-mention" data-user-id="245610">@Jacob Pratt</span> How about <code>div_roundings</code>?</p>



<a name="251177611"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/219381-t-libs/topic/div_floor/near/251177611" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jacob Pratt <a href="https://zulip-archive.rust-lang.org/stream/219381-t-libs/topic/div_floor.html#251177611">(Aug 30 2021 at 02:58)</a>:</h4>
<p>Works for me. Better than just "more methods" haha</p>



<a name="251177870"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/219381-t-libs/topic/div_floor/near/251177870" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Josh Triplett <a href="https://zulip-archive.rust-lang.org/stream/219381-t-libs/topic/div_floor.html#251177870">(Aug 30 2021 at 03:04)</a>:</h4>
<p>:)</p>



<a name="251177875"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/219381-t-libs/topic/div_floor/near/251177875" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Josh Triplett <a href="https://zulip-archive.rust-lang.org/stream/219381-t-libs/topic/div_floor.html#251177875">(Aug 30 2021 at 03:04)</a>:</h4>
<p>Or <code>int_roundings</code>.</p>



<a name="251177884"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/219381-t-libs/topic/div_floor/near/251177884" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Josh Triplett <a href="https://zulip-archive.rust-lang.org/stream/219381-t-libs/topic/div_floor.html#251177884">(Aug 30 2021 at 03:05)</a>:</h4>
<p>(Since one of them isn't div.)</p>



<a name="251263995"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/219381-t-libs/topic/div_floor/near/251263995" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> cuviper <a href="https://zulip-archive.rust-lang.org/stream/219381-t-libs/topic/div_floor.html#251263995">(Aug 30 2021 at 17:29)</a>:</h4>
<p><span class="user-mention silent" data-user-id="239881">Josh Triplett</span> <a href="#narrow/stream/219381-t-libs/topic/div_floor/near/251101348">said</a>:</p>
<blockquote>
<p>num-integer is <code>MIT OR Apache-2.0</code> just like core, so feel free to just copy its docs unless there's something to improve.</p>
</blockquote>
<p>I'll take those improvements back too, if they still apply...</p>



<a name="251302482"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/219381-t-libs/topic/div_floor/near/251302482" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Josh Triplett <a href="https://zulip-archive.rust-lang.org/stream/219381-t-libs/topic/div_floor.html#251302482">(Aug 30 2021 at 22:08)</a>:</h4>
<p><span class="user-mention" data-user-id="138448">@cuviper</span> Sure. Though, long-term, if those functions get added to core then num-integer can just depend on them.</p>



<a name="251302617"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/219381-t-libs/topic/div_floor/near/251302617" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> cuviper <a href="https://zulip-archive.rust-lang.org/stream/219381-t-libs/topic/div_floor.html#251302617">(Aug 30 2021 at 22:09)</a>:</h4>
<p>in implementation, yes, but I can't re-export the docs</p>



<a name="251511060"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/219381-t-libs/topic/div_floor/near/251511060" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jacob Pratt <a href="https://zulip-archive.rust-lang.org/stream/219381-t-libs/topic/div_floor.html#251511060">(Sep 01 2021 at 06:49)</a>:</h4>
<p><span class="user-mention" data-user-id="138448">@cuviper</span> Are you aware that the stated invariant for <code>next_multiple_of</code> is not always true? Calling <code>iX::MIN.next_multiple_of(&amp;-1)</code> will panic when it should return <code>iX::MIN</code>. This <em>is not</em> the case with <code>iX::MIN.prev_multiple_of(&amp;1)</code>. From quick testing this is the only edge case.</p>



<a name="251511096"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/219381-t-libs/topic/div_floor/near/251511096" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jacob Pratt <a href="https://zulip-archive.rust-lang.org/stream/219381-t-libs/topic/div_floor.html#251511096">(Sep 01 2021 at 06:49)</a>:</h4>
<p>Only noticing this because my (not yet pushed) implementation returns <code>None</code> in that case when it reasonably should not.</p>



<a name="251511373"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/219381-t-libs/topic/div_floor/near/251511373" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jacob Pratt <a href="https://zulip-archive.rust-lang.org/stream/219381-t-libs/topic/div_floor.html#251511373">(Sep 01 2021 at 06:52)</a>:</h4>
<p>I haven't run a benchmark, but adding <code>if other == -1 { return Some(self); }</code> at the top of the method (ignoring the <code>Some</code> for your crate) actually generates less assembly.</p>



<a name="251609570"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/219381-t-libs/topic/div_floor/near/251609570" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> cuviper <a href="https://zulip-archive.rust-lang.org/stream/219381-t-libs/topic/div_floor.html#251609570">(Sep 01 2021 at 18:47)</a>:</h4>
<p><span class="user-mention" data-user-id="245610">@Jacob Pratt</span> I'd call that a bug -- care to file an issue and/or pull request?</p>



<a name="251650010"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/219381-t-libs/topic/div_floor/near/251650010" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jacob Pratt <a href="https://zulip-archive.rust-lang.org/stream/219381-t-libs/topic/div_floor.html#251650010">(Sep 02 2021 at 00:38)</a>:</h4>
<p>Will do. Just finishing up the PR for rust-lang/rust. Took me longer than I'd like to admit to realize that I used the wrong variable in one place <span aria-label="laughing" class="emoji emoji-1f606" role="img" title="laughing">:laughing:</span></p>



<a name="251668061"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/219381-t-libs/topic/div_floor/near/251668061" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jacob Pratt <a href="https://zulip-archive.rust-lang.org/stream/219381-t-libs/topic/div_floor.html#251668061">(Sep 02 2021 at 05:30)</a>:</h4>
<p><span class="user-mention" data-user-id="239881">@Josh Triplett</span> PR created: <a href="https://github.com/rust-lang/rust/issues/88582">#88582</a></p>



<a name="251668306"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/219381-t-libs/topic/div_floor/near/251668306" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Josh Triplett <a href="https://zulip-archive.rust-lang.org/stream/219381-t-libs/topic/div_floor.html#251668306">(Sep 02 2021 at 05:35)</a>:</h4>
<p><span class="user-mention" data-user-id="245610">@Jacob Pratt</span> Looking good. Is there a reason div_floor and div_ceil aren't present on unsigned integers?</p>



<a name="251668354"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/219381-t-libs/topic/div_floor/near/251668354" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Josh Triplett <a href="https://zulip-archive.rust-lang.org/stream/219381-t-libs/topic/div_floor.html#251668354">(Sep 02 2021 at 05:36)</a>:</h4>
<p>(I specifically would like to use div_ceil on unsigned integers.)</p>



<a name="251668393"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/219381-t-libs/topic/div_floor/near/251668393" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jacob Pratt <a href="https://zulip-archive.rust-lang.org/stream/219381-t-libs/topic/div_floor.html#251668393">(Sep 02 2021 at 05:37)</a>:</h4>
<p>Whoops. Was more focused on <code>div_floor</code>, which is the same as regular division on unsigned ints. Didn't even consider <code>div_ceil</code> which of course is not. I can add it.</p>



<a name="251668412"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/219381-t-libs/topic/div_floor/near/251668412" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jacob Pratt <a href="https://zulip-archive.rust-lang.org/stream/219381-t-libs/topic/div_floor.html#251668412">(Sep 02 2021 at 05:37)</a>:</h4>
<p>I can add <code>div_floor</code> if desired, but it seems a bit superfluous</p>



<a name="251668576"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/219381-t-libs/topic/div_floor/near/251668576" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jacob Pratt <a href="https://zulip-archive.rust-lang.org/stream/219381-t-libs/topic/div_floor.html#251668576">(Sep 02 2021 at 05:40)</a>:</h4>
<p>Eh, just looking and things like <code>div_euclid</code> exist despite being identical, so precedence I guess</p>



<a name="251669427"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/219381-t-libs/topic/div_floor/near/251669427" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jacob Pratt <a href="https://zulip-archive.rust-lang.org/stream/219381-t-libs/topic/div_floor.html#251669427">(Sep 02 2021 at 05:54)</a>:</h4>
<p><span class="user-mention" data-user-id="239881">@Josh Triplett</span> Updated with the added impls.</p>



<a name="251675617"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/219381-t-libs/topic/div_floor/near/251675617" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Josh Triplett <a href="https://zulip-archive.rust-lang.org/stream/219381-t-libs/topic/div_floor.html#251675617">(Sep 02 2021 at 07:22)</a>:</h4>
<p><span class="user-mention" data-user-id="245610">@Jacob Pratt</span> Looking now.</p>



<a name="251742054"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/219381-t-libs/topic/div_floor/near/251742054" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lokathor <a href="https://zulip-archive.rust-lang.org/stream/219381-t-libs/topic/div_floor.html#251742054">(Sep 02 2021 at 16:18)</a>:</h4>
<p>Yeah, existing for consistency is good.</p>



<a name="251784351"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/219381-t-libs/topic/div_floor/near/251784351" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jacob Pratt <a href="https://zulip-archive.rust-lang.org/stream/219381-t-libs/topic/div_floor.html#251784351">(Sep 02 2021 at 20:51)</a>:</h4>
<p>I included it right after I noticed that similar methods existed even when identical. PR is just waiting on bors now, then we're set for nightly.</p>



<a name="251820822"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/219381-t-libs/topic/div_floor/near/251820822" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Josh Triplett <a href="https://zulip-archive.rust-lang.org/stream/219381-t-libs/topic/div_floor.html#251820822">(Sep 03 2021 at 04:21)</a>:</h4>
<p>Thanks again!</p>



<a name="251821068"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/219381-t-libs/topic/div_floor/near/251821068" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jacob Pratt <a href="https://zulip-archive.rust-lang.org/stream/219381-t-libs/topic/div_floor.html#251821068">(Sep 03 2021 at 04:25)</a>:</h4>
<p>Not an issue! It's (partially) something I want so I may as well make it happen.</p>



<a name="251904569"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/219381-t-libs/topic/div_floor/near/251904569" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Elichai Turkel <a href="https://zulip-archive.rust-lang.org/stream/219381-t-libs/topic/div_floor.html#251904569">(Sep 03 2021 at 16:09)</a>:</h4>
<p>This actually broke <code>num-bigint</code> <a href="https://github.com/rust-lang/rust/pull/88582#issuecomment-912650095">https://github.com/rust-lang/rust/pull/88582#issuecomment-912650095</a></p>



<a name="251906739"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/219381-t-libs/topic/div_floor/near/251906739" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> cuviper <a href="https://zulip-archive.rust-lang.org/stream/219381-t-libs/topic/div_floor.html#251906739">(Sep 03 2021 at 16:24)</a>:</h4>
<p>yeah, <a href="https://github.com/rust-num/num-bigint/issues/218">https://github.com/rust-num/num-bigint/issues/218</a></p>



<a name="251906746"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/219381-t-libs/topic/div_floor/near/251906746" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> cuviper <a href="https://zulip-archive.rust-lang.org/stream/219381-t-libs/topic/div_floor.html#251906746">(Sep 03 2021 at 16:24)</a>:</h4>
<p>but I'll fix it</p>



<a name="251907420"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/219381-t-libs/topic/div_floor/near/251907420" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> cuviper <a href="https://zulip-archive.rust-lang.org/stream/219381-t-libs/topic/div_floor.html#251907420">(Sep 03 2021 at 16:29)</a>:</h4>
<p>wasn't there something in the compiler to avoid unstable items?</p>



<a name="251907511"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/219381-t-libs/topic/div_floor/near/251907511" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> cuviper <a href="https://zulip-archive.rust-lang.org/stream/219381-t-libs/topic/div_floor.html#251907511">(Sep 03 2021 at 16:30)</a>:</h4>
<p>but still, eventually it would stabilize and the arguments don't match, so it has to be fixed regardless</p>



<a name="251909890"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/219381-t-libs/topic/div_floor/near/251909890" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Josh Triplett <a href="https://zulip-archive.rust-lang.org/stream/219381-t-libs/topic/div_floor.html#251909890">(Sep 03 2021 at 16:48)</a>:</h4>
<p><span class="user-mention silent" data-user-id="138448">cuviper</span> <a href="#narrow/stream/219381-t-libs/topic/div_floor/near/251907420">said</a>:</p>
<blockquote>
<p>wasn't there something in the compiler to avoid unstable items?</p>
</blockquote>
<p>I thought there was supposed to be, yes.</p>



<a name="251910907"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/219381-t-libs/topic/div_floor/near/251910907" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> cuviper <a href="https://zulip-archive.rust-lang.org/stream/219381-t-libs/topic/div_floor.html#251910907">(Sep 03 2021 at 16:56)</a>:</h4>
<p>maybe that was only with trait methods, like unstable <code>Iterator</code> vs <code>Itertools</code></p>



<a name="251911882"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/219381-t-libs/topic/div_floor/near/251911882" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Gary Guo <a href="https://zulip-archive.rust-lang.org/stream/219381-t-libs/topic/div_floor.html#251911882">(Sep 03 2021 at 17:02)</a>:</h4>
<p>There is a check in rustc_typeck/src/check/method/probe.rs</p>



<a name="251912452"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/219381-t-libs/topic/div_floor/near/251912452" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> cuviper <a href="https://zulip-archive.rust-lang.org/stream/219381-t-libs/topic/div_floor.html#251912452">(Sep 03 2021 at 17:06)</a>:</h4>
<p>it might also be that the inherent method is on <code>self</code>, while <code>Integer</code>'s method is on <code>&amp;self</code></p>



<a name="251953056"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/219381-t-libs/topic/div_floor/near/251953056" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jacob Pratt <a href="https://zulip-archive.rust-lang.org/stream/219381-t-libs/topic/div_floor.html#251953056">(Sep 03 2021 at 23:06)</a>:</h4>
<p>Obviously I understand that it's "acceptable breakage" and have stated as such in issues, but might this be worth reverting before it hits the stable release? That way checks like those mentioned could be implemented. A test could be added for that situation.</p>



<a name="251953099"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/219381-t-libs/topic/div_floor/near/251953099" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jacob Pratt <a href="https://zulip-archive.rust-lang.org/stream/219381-t-libs/topic/div_floor.html#251953099">(Sep 03 2021 at 23:06)</a>:</h4>
<p>Of course <code>num-bigint</code> should make the changes, but that's a separate issue.</p>



<a name="251954511"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/219381-t-libs/topic/div_floor/near/251954511" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> cuviper <a href="https://zulip-archive.rust-lang.org/stream/219381-t-libs/topic/div_floor.html#251954511">(Sep 03 2021 at 23:25)</a>:</h4>
<p>I've already published <code>num-bigint</code> 0.4.2 and 0.3.3</p>



<a name="251954586"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/219381-t-libs/topic/div_floor/near/251954586" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> cuviper <a href="https://zulip-archive.rust-lang.org/stream/219381-t-libs/topic/div_floor.html#251954586">(Sep 03 2021 at 23:26)</a>:</h4>
<p>but of course, similar breakage could exist elsewhere</p>



<a name="251954594"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/219381-t-libs/topic/div_floor/near/251954594" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jacob Pratt <a href="https://zulip-archive.rust-lang.org/stream/219381-t-libs/topic/div_floor.html#251954594">(Sep 03 2021 at 23:26)</a>:</h4>
<p>Ah, perfect. Was just about to say that ^^</p>



<a name="262375216"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/219381-t-libs/topic/div_floor/near/262375216" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jacob Pratt <a href="https://zulip-archive.rust-lang.org/stream/219381-t-libs/topic/div_floor.html#262375216">(Nov 22 2021 at 20:45)</a>:</h4>
<p><span class="user-mention" data-user-id="239881">@Josh Triplett</span> Now that <a href="https://github.com/rust-lang/rust/issues/90329">#90329</a> has been merged, <a href="https://github.com/rust-lang/rust/issues/88971">#88971</a> can be reverted, correct?</p>



<a name="262375264"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/219381-t-libs/topic/div_floor/near/262375264" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Josh Triplett <a href="https://zulip-archive.rust-lang.org/stream/219381-t-libs/topic/div_floor.html#262375264">(Nov 22 2021 at 20:45)</a>:</h4>
<p>I <em>believe</em> so, yes.</p>



<a name="262375317"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/219381-t-libs/topic/div_floor/near/262375317" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Josh Triplett <a href="https://zulip-archive.rust-lang.org/stream/219381-t-libs/topic/div_floor.html#262375317">(Nov 22 2021 at 20:46)</a>:</h4>
<p>Probably worth a crater run on the revert PR, though.</p>



<a name="262375333"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/219381-t-libs/topic/div_floor/near/262375333" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jacob Pratt <a href="https://zulip-archive.rust-lang.org/stream/219381-t-libs/topic/div_floor.html#262375333">(Nov 22 2021 at 20:46)</a>:</h4>
<p>I'll prepare a PR to revert in that case.</p>



<a name="262375338"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/219381-t-libs/topic/div_floor/near/262375338" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Josh Triplett <a href="https://zulip-archive.rust-lang.org/stream/219381-t-libs/topic/div_floor.html#262375338">(Nov 22 2021 at 20:46)</a>:</h4>
<p>Let's make sure that <a href="https://github.com/rust-lang/rust/issues/90329">#90329</a> does what we expect it to in this context.</p>



<a name="262375809"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/219381-t-libs/topic/div_floor/near/262375809" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jacob Pratt <a href="https://zulip-archive.rust-lang.org/stream/219381-t-libs/topic/div_floor.html#262375809">(Nov 22 2021 at 20:50)</a>:</h4>
<p>Just did <code>git revert 3ece63b64e192146fcdd1724e25856a93d7626aa</code> without conflicts. It's PR <a href="https://github.com/rust-lang/rust/issues/91141">#91141</a>.</p>



<a name="262376019"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/219381-t-libs/topic/div_floor/near/262376019" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> The 8472 <a href="https://zulip-archive.rust-lang.org/stream/219381-t-libs/topic/div_floor.html#262376019">(Nov 22 2021 at 20:52)</a>:</h4>
<p>Won't that just delay the breakage until those methods get stabilized?</p>



<a name="262376171"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/219381-t-libs/topic/div_floor/near/262376171" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jacob Pratt <a href="https://zulip-archive.rust-lang.org/stream/219381-t-libs/topic/div_floor.html#262376171">(Nov 22 2021 at 20:53)</a>:</h4>
<p>Yes? But we may as well have them under the appropriate name while unstable.</p>



<a name="262376246"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/219381-t-libs/topic/div_floor/near/262376246" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jacob Pratt <a href="https://zulip-archive.rust-lang.org/stream/219381-t-libs/topic/div_floor.html#262376246">(Nov 22 2021 at 20:54)</a>:</h4>
<p>The breakage has already been fixed in multiple places; it's just a matter of time for people to upgrade their deps now.</p>



<a name="262376738"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/219381-t-libs/topic/div_floor/near/262376738" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> The 8472 <a href="https://zulip-archive.rust-lang.org/stream/219381-t-libs/topic/div_floor.html#262376738">(Nov 22 2021 at 20:58)</a>:</h4>
<blockquote>
<div class="codehilite"><pre><span></span><code>        // Emit a lint if there are unstable candidates alongside the stable ones.
       //
</code></pre></div>

</blockquote>
<p>Ah, this should cover it.</p>



<a name="262398879"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/219381-t-libs/topic/div_floor/near/262398879" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Gary Guo <a href="https://zulip-archive.rust-lang.org/stream/219381-t-libs/topic/div_floor.html#262398879">(Nov 23 2021 at 00:49)</a>:</h4>
<p><span class="user-mention silent" data-user-id="239881">Josh Triplett</span> <a href="#narrow/stream/219381-t-libs/topic/div_floor/near/262375338">said</a>:</p>
<blockquote>
<p>Let's make sure that <a href="https://github.com/rust-lang/rust/issues/90329">#90329</a> does what we expect it to in this context.</p>
</blockquote>
<p>I hope it does :)</p>



<a name="262399835"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/219381-t-libs/topic/div_floor/near/262399835" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jacob Pratt <a href="https://zulip-archive.rust-lang.org/stream/219381-t-libs/topic/div_floor.html#262399835">(Nov 23 2021 at 00:59)</a>:</h4>
<p>We'll find out once a crater run is queued. I'm sure your work is quality, though!</p>



<hr><p>Last updated: Apr 12 2022 at 20:01 UTC</p>
</html>