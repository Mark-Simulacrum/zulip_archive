<html>
<head><meta charset="utf-8"><title>std and core hardcoding paths to backtrace and core_arch? · t-libs · Zulip Chat Archive</title></head>
<h2>Stream: <a href="https://zulip-archive.rust-lang.org/stream/219381-t-libs/index.html">t-libs</a></h2>
<h3>Topic: <a href="https://zulip-archive.rust-lang.org/stream/219381-t-libs/topic/std.20and.20core.20hardcoding.20paths.20to.20backtrace.20and.20core_arch.3F.html">std and core hardcoding paths to backtrace and core_arch?</a></h3>

<hr>

<base href="https://rust-lang.zulipchat.com">

<head><link href="https://zulip-archive.rust-lang.org/style.css" rel="stylesheet"></head>

<a name="261541496"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/219381-t-libs/topic/std%20and%20core%20hardcoding%20paths%20to%20backtrace%20and%20core_arch%3F/near/261541496" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Matt H <a href="https://zulip-archive.rust-lang.org/stream/219381-t-libs/topic/std.20and.20core.20hardcoding.20paths.20to.20backtrace.20and.20core_arch.3F.html#261541496">(Nov 15 2021 at 18:48)</a>:</h4>
<p>std: <a href="https://github.com/rust-lang/rust/blob/master/library/std/src/lib.rs#L552-L554">https://github.com/rust-lang/rust/blob/master/library/std/src/lib.rs#L552-L554</a><br>
core: <a href="https://github.com/rust-lang/rust/blob/master/library/core/src/lib.rs#L347-L362">https://github.com/rust-lang/rust/blob/master/library/core/src/lib.rs#L347-L362</a></p>
<p>is it written up somewhere why these relationships aren't expressed as normal dependencies in cargo? not exactly sure how to search for it in the stream history</p>



<a name="261541662"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/219381-t-libs/topic/std%20and%20core%20hardcoding%20paths%20to%20backtrace%20and%20core_arch%3F/near/261541662" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> The 8472 <a href="https://zulip-archive.rust-lang.org/stream/219381-t-libs/topic/std.20and.20core.20hardcoding.20paths.20to.20backtrace.20and.20core_arch.3F.html#261541662">(Nov 15 2021 at 18:49)</a>:</h4>
<p>git blame -&gt; look at the commit -&gt; github shows PR numbers where it was merged</p>



<a name="261564565"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/219381-t-libs/topic/std%20and%20core%20hardcoding%20paths%20to%20backtrace%20and%20core_arch%3F/near/261564565" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> bjorn3 <a href="https://zulip-archive.rust-lang.org/stream/219381-t-libs/topic/std.20and.20core.20hardcoding.20paths.20to.20backtrace.20and.20core_arch.3F.html#261564565">(Nov 15 2021 at 21:50)</a>:</h4>
<p>In both cases these libraries depend on the library they are included themself. Every crate needs to depend on libcore as it defines a whole lot of essential lang items (without which even something as simple as taking a function argument fails), thus corearch needs to be compiled as part of libcore to be able to export it from libcore. It can't be a regular dependency. Libbacktrace needs libstd for reading files containing the debuginfo, but libstd uses libbacktrace itself, so both need to be compiled together.</p>



<a name="261564592"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/219381-t-libs/topic/std%20and%20core%20hardcoding%20paths%20to%20backtrace%20and%20core_arch%3F/near/261564592" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> bjorn3 <a href="https://zulip-archive.rust-lang.org/stream/219381-t-libs/topic/std.20and.20core.20hardcoding.20paths.20to.20backtrace.20and.20core_arch.3F.html#261564592">(Nov 15 2021 at 21:51)</a>:</h4>
<p><span class="user-mention" data-user-id="456484">@Matt H</span> ^</p>



<a name="261577142"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/219381-t-libs/topic/std%20and%20core%20hardcoding%20paths%20to%20backtrace%20and%20core_arch%3F/near/261577142" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Matt H <a href="https://zulip-archive.rust-lang.org/stream/219381-t-libs/topic/std.20and.20core.20hardcoding.20paths.20to.20backtrace.20and.20core_arch.3F.html#261577142">(Nov 15 2021 at 23:40)</a>:</h4>
<p>i see. i was thinking the <code>rustc-dep-of-std</code> switcheroo might work here, but that only enables std to depend on crates that depend on core (which are all presumably <code>#![no_std]</code>), not crates that depend on std. thank you for holding my hand through that haha</p>



<hr><p>Last updated: Apr 12 2022 at 20:01 UTC</p>
</html>