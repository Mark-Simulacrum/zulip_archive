<html>
<head><meta charset="utf-8"><title>We can&#x27;t `u128: From&lt;usize&gt;`, can we? · t-libs · Zulip Chat Archive</title></head>
<h2>Stream: <a href="https://zulip-archive.rust-lang.org/stream/219381-t-libs/index.html">t-libs</a></h2>
<h3>Topic: <a href="https://zulip-archive.rust-lang.org/stream/219381-t-libs/topic/We.20can&#x27;t.20.60u128.3A.20From.3Cusize.3E.60.2C.20can.20we.3F.html">We can&#x27;t `u128: From&lt;usize&gt;`, can we?</a></h3>

<hr>

<base href="https://rust-lang.zulipchat.com">

<head><link href="https://zulip-archive.rust-lang.org/style.css" rel="stylesheet"></head>

<a name="264242400"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/219381-t-libs/topic/We%20can%27t%20%60u128%3A%20From%3Cusize%3E%60%2C%20can%20we%3F/near/264242400" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> scottmcm <a href="https://zulip-archive.rust-lang.org/stream/219381-t-libs/topic/We.20can&#x27;t.20.60u128.3A.20From.3Cusize.3E.60.2C.20can.20we.3F.html#264242400">(Dec 09 2021 at 00:42)</a>:</h4>
<p>I was going to propose that we make <code>u128: From&lt;usize&gt;</code> infallible, since it is and always will be.  (Even just 2⁹⁶ silicon atoms is 3695 kilograms, and that's without addressing circuitry or wires.)</p>
<p>But I guess we can't, can we, since we have <code>&lt;u128 as TryFrom&lt;usize&gt;&gt;::Error</code> as something other than <code>Infallible</code>?</p>



<a name="264250894"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/219381-t-libs/topic/We%20can%27t%20%60u128%3A%20From%3Cusize%3E%60%2C%20can%20we%3F/near/264250894" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Josh Triplett <a href="https://zulip-archive.rust-lang.org/stream/219381-t-libs/topic/We.20can&#x27;t.20.60u128.3A.20From.3Cusize.3E.60.2C.20can.20we.3F.html#264250894">(Dec 09 2021 at 03:01)</a>:</h4>
<p>I don't think it'd be a breaking change.</p>



<a name="264250896"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/219381-t-libs/topic/We%20can%27t%20%60u128%3A%20From%3Cusize%3E%60%2C%20can%20we%3F/near/264250896" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Josh Triplett <a href="https://zulip-archive.rust-lang.org/stream/219381-t-libs/topic/We.20can&#x27;t.20.60u128.3A.20From.3Cusize.3E.60.2C.20can.20we.3F.html#264250896">(Dec 09 2021 at 03:01)</a>:</h4>
<p>In practice.</p>



<a name="264250912"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/219381-t-libs/topic/We%20can%27t%20%60u128%3A%20From%3Cusize%3E%60%2C%20can%20we%3F/near/264250912" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Josh Triplett <a href="https://zulip-archive.rust-lang.org/stream/219381-t-libs/topic/We.20can&#x27;t.20.60u128.3A.20From.3Cusize.3E.60.2C.20can.20we.3F.html#264250912">(Dec 09 2021 at 03:01)</a>:</h4>
<p>But also, I genuinely think it's <em>possible</em> that people could have a system where <code>usize</code> is more than 128 bits.</p>



<a name="264250929"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/219381-t-libs/topic/We%20can%27t%20%60u128%3A%20From%3Cusize%3E%60%2C%20can%20we%3F/near/264250929" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Josh Triplett <a href="https://zulip-archive.rust-lang.org/stream/219381-t-libs/topic/We.20can&#x27;t.20.60u128.3A.20From.3Cusize.3E.60.2C.20can.20we.3F.html#264250929">(Dec 09 2021 at 03:01)</a>:</h4>
<p>Not because people would actually use 2**256 bytes <em>simultaneously</em>.</p>



<a name="264250991"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/219381-t-libs/topic/We%20can%27t%20%60u128%3A%20From%3Cusize%3E%60%2C%20can%20we%3F/near/264250991" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Josh Triplett <a href="https://zulip-archive.rust-lang.org/stream/219381-t-libs/topic/We.20can&#x27;t.20.60u128.3A.20From.3Cusize.3E.60.2C.20can.20we.3F.html#264250991">(Dec 09 2021 at 03:02)</a>:</h4>
<p>But for the same reason that IPv6 is 128 bits rather than 64: it's convenient for partitioning at several levels.</p>



<a name="264251093"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/219381-t-libs/topic/We%20can%27t%20%60u128%3A%20From%3Cusize%3E%60%2C%20can%20we%3F/near/264251093" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Josh Triplett <a href="https://zulip-archive.rust-lang.org/stream/219381-t-libs/topic/We.20can&#x27;t.20.60u128.3A.20From.3Cusize.3E.60.2C.20can.20we.3F.html#264251093">(Dec 09 2021 at 03:04)</a>:</h4>
<p>Suppose, hypothetically, you have a data-center-wide computer with a shared address space, such that there's a unique virtual address for every byte of virtual address in any process's address space. And for partitioning reasons, it might make sense to partition addresses such that there are N bits to identify a system, N bits to identify a CPU within the system, and also N bits to identify processes, in addition to each process having a 64-bit address space.</p>



<a name="264251098"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/219381-t-libs/topic/We%20can%27t%20%60u128%3A%20From%3Cusize%3E%60%2C%20can%20we%3F/near/264251098" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Josh Triplett <a href="https://zulip-archive.rust-lang.org/stream/219381-t-libs/topic/We.20can&#x27;t.20.60u128.3A.20From.3Cusize.3E.60.2C.20can.20we.3F.html#264251098">(Dec 09 2021 at 03:04)</a>:</h4>
<p>(leaving aside things like pointer tagging)</p>



<a name="264269516"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/219381-t-libs/topic/We%20can%27t%20%60u128%3A%20From%3Cusize%3E%60%2C%20can%20we%3F/near/264269516" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> scottmcm <a href="https://zulip-archive.rust-lang.org/stream/219381-t-libs/topic/We.20can&#x27;t.20.60u128.3A.20From.3Cusize.3E.60.2C.20can.20we.3F.html#264269516">(Dec 09 2021 at 08:32)</a>:</h4>
<p>I understand that more bits than you can address is reasonable -- that's why I only used 96 bits in my example.  But exponentials are just so powerful.  It's like why 128-bit security is more than fine, even though 80 bits isn't.</p>



<a name="264269583"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/219381-t-libs/topic/We%20can%27t%20%60u128%3A%20From%3Cusize%3E%60%2C%20can%20we%3F/near/264269583" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> scottmcm <a href="https://zulip-archive.rust-lang.org/stream/219381-t-libs/topic/We.20can&#x27;t.20.60u128.3A.20From.3Cusize.3E.60.2C.20can.20we.3F.html#264269583">(Dec 09 2021 at 08:33)</a>:</h4>
<p>Do supercomputers still use shared memory models, BTW?  I thought they'd moved to MPI-like approaches instead.</p>



<a name="264270285"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/219381-t-libs/topic/We%20can%27t%20%60u128%3A%20From%3Cusize%3E%60%2C%20can%20we%3F/near/264270285" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Josh Triplett <a href="https://zulip-archive.rust-lang.org/stream/219381-t-libs/topic/We.20can&#x27;t.20.60u128.3A.20From.3Cusize.3E.60.2C.20can.20we.3F.html#264270285">(Dec 09 2021 at 08:41)</a>:</h4>
<p>Supercomputers generally don't, but there are other technologies that do, and things are tried from time to time.</p>



<a name="264270397"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/219381-t-libs/topic/We%20can%27t%20%60u128%3A%20From%3Cusize%3E%60%2C%20can%20we%3F/near/264270397" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Josh Triplett <a href="https://zulip-archive.rust-lang.org/stream/219381-t-libs/topic/We.20can&#x27;t.20.60u128.3A.20From.3Cusize.3E.60.2C.20can.20we.3F.html#264270397">(Dec 09 2021 at 08:42)</a>:</h4>
<p>HP tried to do interesting things with The Machine.</p>



<a name="264270487"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/219381-t-libs/topic/We%20can%27t%20%60u128%3A%20From%3Cusize%3E%60%2C%20can%20we%3F/near/264270487" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Josh Triplett <a href="https://zulip-archive.rust-lang.org/stream/219381-t-libs/topic/We.20can&#x27;t.20.60u128.3A.20From.3Cusize.3E.60.2C.20can.20we.3F.html#264270487">(Dec 09 2021 at 08:43)</a>:</h4>
<p>I don't feel comfortable predicting that we will not need more than 128-bit addressing in the future.</p>



<a name="264270584"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/219381-t-libs/topic/We%20can%27t%20%60u128%3A%20From%3Cusize%3E%60%2C%20can%20we%3F/near/264270584" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Josh Triplett <a href="https://zulip-archive.rust-lang.org/stream/219381-t-libs/topic/We.20can&#x27;t.20.60u128.3A.20From.3Cusize.3E.60.2C.20can.20we.3F.html#264270584">(Dec 09 2021 at 08:44)</a>:</h4>
<p>I <em>do</em> think we need the portability lint and defaults that let you infallibly get a u64 from a usize if you don't opt into handling more.</p>



<a name="264280065"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/219381-t-libs/topic/We%20can%27t%20%60u128%3A%20From%3Cusize%3E%60%2C%20can%20we%3F/near/264280065" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> The 8472 <a href="https://zulip-archive.rust-lang.org/stream/219381-t-libs/topic/We.20can&#x27;t.20.60u128.3A.20From.3Cusize.3E.60.2C.20can.20we.3F.html#264280065">(Dec 09 2021 at 10:15)</a>:</h4>
<p>For collision resistance (classical) you'd need double the size. E.g. if your memory system wanted to hand out virtual addresses at random without having to check that they're already in use.</p>



<a name="264283278"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/219381-t-libs/topic/We%20can%27t%20%60u128%3A%20From%3Cusize%3E%60%2C%20can%20we%3F/near/264283278" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Vadim Petrochenkov <a href="https://zulip-archive.rust-lang.org/stream/219381-t-libs/topic/We.20can&#x27;t.20.60u128.3A.20From.3Cusize.3E.60.2C.20can.20we.3F.html#264283278">(Dec 09 2021 at 10:48)</a>:</h4>
<p>This is an old story, I still think that we need to have <code>X: From&lt;usize&gt;</code> and <code>usize: From&lt;X&gt;</code> for all integer types that support the lossless conversion on the current target, together with a lint that warns on "widely unportable" conversions like <code>usize</code> -&gt; <code>u32</code> on 32-bit systems and <code>u64</code> -&gt; <code>usize</code> ion 64-bit systems.</p>



<a name="264283325"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/219381-t-libs/topic/We%20can%27t%20%60u128%3A%20From%3Cusize%3E%60%2C%20can%20we%3F/near/264283325" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Vadim Petrochenkov <a href="https://zulip-archive.rust-lang.org/stream/219381-t-libs/topic/We.20can&#x27;t.20.60u128.3A.20From.3Cusize.3E.60.2C.20can.20we.3F.html#264283325">(Dec 09 2021 at 10:48)</a>:</h4>
<p>I believe there was even a relative recent (last year?) PR that started this work but was closed due to inactivity.</p>



<a name="264305999"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/219381-t-libs/topic/We%20can%27t%20%60u128%3A%20From%3Cusize%3E%60%2C%20can%20we%3F/near/264305999" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Vadim Petrochenkov <a href="https://zulip-archive.rust-lang.org/stream/219381-t-libs/topic/We.20can&#x27;t.20.60u128.3A.20From.3Cusize.3E.60.2C.20can.20we.3F.html#264305999">(Dec 09 2021 at 14:08)</a>:</h4>
<p>(It was <a href="https://github.com/rust-lang/rust/pull/71360">https://github.com/rust-lang/rust/pull/71360</a>)</p>



<a name="264352225"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/219381-t-libs/topic/We%20can%27t%20%60u128%3A%20From%3Cusize%3E%60%2C%20can%20we%3F/near/264352225" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> scottmcm <a href="https://zulip-archive.rust-lang.org/stream/219381-t-libs/topic/We.20can&#x27;t.20.60u128.3A.20From.3Cusize.3E.60.2C.20can.20we.3F.html#264352225">(Dec 09 2021 at 19:16)</a>:</h4>
<p><span class="user-mention silent" data-user-id="239881">Josh Triplett</span> <a href="#narrow/stream/219381-t-libs/topic/We.20can't.20.60u128.3A.20From.3Cusize.3E.60.2C.20can.20we.3F/near/264270487">said</a>:</p>
<blockquote>
<p>I don't feel comfortable predicting that we will not need more than 128-bit addressing in the future.</p>
</blockquote>
<p>This is where I like to pull out <a href="https://arxiv.org/abs/quant-ph/9908043">Lloyd 1999</a>.  It discusses an "ultimate laptop":</p>
<blockquote>
<p>The amount of information that can be stored by the 1 kilogram computer in the black-hole limit is 3.827 × 10¹⁶ bits. A computer compressed to the size of a black hole can perform 5.4258 × 10⁵⁰ operations per second.</p>
</blockquote>
<p>That's 1.062 × 2⁵⁵ bits of information; call it 2⁵² bytes.  That leaves <em>plenty</em> of room for addressing across multiple such machines or whatever in a 128-bit <code>usize</code>.</p>
<p>Come to think of it, this is potentially also interesting for the <code>size_t</code> vs <code>ptrdiff_t</code> conversation.  Arguably <code>size_t</code> is likely to be fine as 64-bit forever, even if <code>ptrdiff_t</code> may need to be larger.  (Like how an individual file in ZFS can only be 2⁶⁴ bytes even though the pool as a whole can store 2¹²⁸ bytes.)</p>



<a name="264353207"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/219381-t-libs/topic/We%20can%27t%20%60u128%3A%20From%3Cusize%3E%60%2C%20can%20we%3F/near/264353207" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> The 8472 <a href="https://zulip-archive.rust-lang.org/stream/219381-t-libs/topic/We.20can&#x27;t.20.60u128.3A.20From.3Cusize.3E.60.2C.20can.20we.3F.html#264353207">(Dec 09 2021 at 19:23)</a>:</h4>
<p>By the time you're using a black hole on your lap for compute we might have a rust 2.0</p>



<a name="264354092"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/219381-t-libs/topic/We%20can%27t%20%60u128%3A%20From%3Cusize%3E%60%2C%20can%20we%3F/near/264354092" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jake <a href="https://zulip-archive.rust-lang.org/stream/219381-t-libs/topic/We.20can&#x27;t.20.60u128.3A.20From.3Cusize.3E.60.2C.20can.20we.3F.html#264354092">(Dec 09 2021 at 19:31)</a>:</h4>
<p><span class="user-mention silent" data-user-id="330154">The 8472</span> <a href="#narrow/stream/219381-t-libs/topic/We.20can't.20.60u128.3A.20From.3Cusize.3E.60.2C.20can.20we.3F/near/264353207">said</a>:</p>
<blockquote>
<p>By the time you're using a black hole on your lap for compute we might have a rust 2.0</p>
</blockquote>
<p>Wow so this whole thing about Rust's stability guarantees is just a joke? Who would've thought</p>



<a name="264354360"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/219381-t-libs/topic/We%20can%27t%20%60u128%3A%20From%3Cusize%3E%60%2C%20can%20we%3F/near/264354360" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> The 8472 <a href="https://zulip-archive.rust-lang.org/stream/219381-t-libs/topic/We.20can&#x27;t.20.60u128.3A.20From.3Cusize.3E.60.2C.20can.20we.3F.html#264354360">(Dec 09 2021 at 19:33)</a>:</h4>
<p>Feature accretion disk.</p>



<a name="264363748"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/219381-t-libs/topic/We%20can%27t%20%60u128%3A%20From%3Cusize%3E%60%2C%20can%20we%3F/near/264363748" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Daniel Henry-Mantilla <a href="https://zulip-archive.rust-lang.org/stream/219381-t-libs/topic/We.20can&#x27;t.20.60u128.3A.20From.3Cusize.3E.60.2C.20can.20we.3F.html#264363748">(Dec 09 2021 at 20:46)</a>:</h4>
<p>Stability is not absolute, but relative to the observer</p>



<a name="264372395"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/219381-t-libs/topic/We%20can%27t%20%60u128%3A%20From%3Cusize%3E%60%2C%20can%20we%3F/near/264372395" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mario Carneiro <a href="https://zulip-archive.rust-lang.org/stream/219381-t-libs/topic/We.20can&#x27;t.20.60u128.3A.20From.3Cusize.3E.60.2C.20can.20we.3F.html#264372395">(Dec 09 2021 at 21:54)</a>:</h4>
<p>Isn't this kind of argument assuming that those 128 bits are actually all being used densely? It seems much more likely to me that a future pointer format is invented that needs more bits than that because of overly generous reservations at multiple levels. For example architectures currently reserve all 64 bytes of the pointer (except possibly the low few bits assuming known alignment, although even then it's not necessarily the case, e.g. ARM thumb pointers) even though most can't even use more than 48 bits due to the hardware design, which means pointer tagging systems like CHERI have to go to 128 bits even though there is certainly a lot less entropy than that</p>



<a name="264372913"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/219381-t-libs/topic/We%20can%27t%20%60u128%3A%20From%3Cusize%3E%60%2C%20can%20we%3F/near/264372913" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Josh Triplett <a href="https://zulip-archive.rust-lang.org/stream/219381-t-libs/topic/We.20can&#x27;t.20.60u128.3A.20From.3Cusize.3E.60.2C.20can.20we.3F.html#264372913">(Dec 09 2021 at 21:59)</a>:</h4>
<p>Exactly. I don't expect that anyone needs more than <code>2**128</code> bytes of actual RAM, but when you assign portions of virtual address space for things like tags, networks, systems, CPUs, processes, etc, then you consume bits <em>linearly</em>.</p>



<a name="264373020"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/219381-t-libs/topic/We%20can%27t%20%60u128%3A%20From%3Cusize%3E%60%2C%20can%20we%3F/near/264373020" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Josh Triplett <a href="https://zulip-archive.rust-lang.org/stream/219381-t-libs/topic/We.20can&#x27;t.20.60u128.3A.20From.3Cusize.3E.60.2C.20can.20we.3F.html#264373020">(Dec 09 2021 at 22:00)</a>:</h4>
<p>For instance, combine CHERI pointer tagging with "I want to uniquely address every virtual address on every system on the network" and you already need more than 128 bits.</p>



<a name="264373196"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/219381-t-libs/topic/We%20can%27t%20%60u128%3A%20From%3Cusize%3E%60%2C%20can%20we%3F/near/264373196" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Josh Triplett <a href="https://zulip-archive.rust-lang.org/stream/219381-t-libs/topic/We.20can&#x27;t.20.60u128.3A.20From.3Cusize.3E.60.2C.20can.20we.3F.html#264373196">(Dec 09 2021 at 22:01)</a>:</h4>
<p>Or, suppose you chose a virtual address scheme involving a system's unique IPv6 address (to give a ridiculous but not <em>too</em> ridiculous possibility).</p>



<a name="264373879"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/219381-t-libs/topic/We%20can%27t%20%60u128%3A%20From%3Cusize%3E%60%2C%20can%20we%3F/near/264373879" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Connor Horman <a href="https://zulip-archive.rust-lang.org/stream/219381-t-libs/topic/We.20can&#x27;t.20.60u128.3A.20From.3Cusize.3E.60.2C.20can.20we.3F.html#264373879">(Dec 09 2021 at 22:04)</a>:</h4>
<p>Or you take ASLR to the <em>next</em> level.</p>



<a name="264378108"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/219381-t-libs/topic/We%20can%27t%20%60u128%3A%20From%3Cusize%3E%60%2C%20can%20we%3F/near/264378108" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Josh Triplett <a href="https://zulip-archive.rust-lang.org/stream/219381-t-libs/topic/We.20can&#x27;t.20.60u128.3A.20From.3Cusize.3E.60.2C.20can.20we.3F.html#264378108">(Dec 09 2021 at 22:41)</a>:</h4>
<p>Heh. "You can't even guess a thing that's a valid address, and distant segfaults (rather than 'local' segfaults) are SIGKILL so you can't walk your shots".</p>



<a name="264378143"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/219381-t-libs/topic/We%20can%27t%20%60u128%3A%20From%3Cusize%3E%60%2C%20can%20we%3F/near/264378143" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Josh Triplett <a href="https://zulip-archive.rust-lang.org/stream/219381-t-libs/topic/We.20can&#x27;t.20.60u128.3A.20From.3Cusize.3E.60.2C.20can.20we.3F.html#264378143">(Dec 09 2021 at 22:41)</a>:</h4>
<p>I think that's kinda what CHERI is trying to do.</p>



<a name="264378243"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/219381-t-libs/topic/We%20can%27t%20%60u128%3A%20From%3Cusize%3E%60%2C%20can%20we%3F/near/264378243" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Josh Triplett <a href="https://zulip-archive.rust-lang.org/stream/219381-t-libs/topic/We.20can&#x27;t.20.60u128.3A.20From.3Cusize.3E.60.2C.20can.20we.3F.html#264378243">(Dec 09 2021 at 22:42)</a>:</h4>
<p>Insofar as CHERI makes it possible to distinguish between "just off the end of a valid address" and "could not have been derived from a valid address".</p>



<a name="264380090"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/219381-t-libs/topic/We%20can%27t%20%60u128%3A%20From%3Cusize%3E%60%2C%20can%20we%3F/near/264380090" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Connor Horman <a href="https://zulip-archive.rust-lang.org/stream/219381-t-libs/topic/We.20can&#x27;t.20.60u128.3A.20From.3Cusize.3E.60.2C.20can.20we.3F.html#264380090">(Dec 09 2021 at 23:00)</a>:</h4>
<p>Don't even need SIGKILL. You've got a <em>few</em> years (584) if you guess one address every nanosecond.</p>



<a name="264386626"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/219381-t-libs/topic/We%20can%27t%20%60u128%3A%20From%3Cusize%3E%60%2C%20can%20we%3F/near/264386626" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Josh Triplett <a href="https://zulip-archive.rust-lang.org/stream/219381-t-libs/topic/We.20can&#x27;t.20.60u128.3A.20From.3Cusize.3E.60.2C.20can.20we.3F.html#264386626">(Dec 10 2021 at 00:16)</a>:</h4>
<p><span class="user-mention" data-user-id="257758">@Connor Horman</span> Fair enough, though there's still value in catching attempts.</p>



<a name="264406346"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/219381-t-libs/topic/We%20can%27t%20%60u128%3A%20From%3Cusize%3E%60%2C%20can%20we%3F/near/264406346" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jubilee <a href="https://zulip-archive.rust-lang.org/stream/219381-t-libs/topic/We.20can&#x27;t.20.60u128.3A.20From.3Cusize.3E.60.2C.20can.20we.3F.html#264406346">(Dec 10 2021 at 05:57)</a>:</h4>
<p>imagining an arch which uses sha-256 pointers, just to getcha</p>



<a name="264409066"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/219381-t-libs/topic/We%20can%27t%20%60u128%3A%20From%3Cusize%3E%60%2C%20can%20we%3F/near/264409066" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Josh Triplett <a href="https://zulip-archive.rust-lang.org/stream/219381-t-libs/topic/We.20can&#x27;t.20.60u128.3A.20From.3Cusize.3E.60.2C.20can.20we.3F.html#264409066">(Dec 10 2021 at 06:53)</a>:</h4>
<p>Oooh, that's fun. Or pointers public-key encrypted to a private key in the processor.</p>



<a name="264410597"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/219381-t-libs/topic/We%20can%27t%20%60u128%3A%20From%3Cusize%3E%60%2C%20can%20we%3F/near/264410597" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> fee1-dead <a href="https://zulip-archive.rust-lang.org/stream/219381-t-libs/topic/We.20can&#x27;t.20.60u128.3A.20From.3Cusize.3E.60.2C.20can.20we.3F.html#264410597">(Dec 10 2021 at 07:23)</a>:</h4>
<p>Ethereum Virtual Machine uses 256bit addressing because keccak256 has 256bit output.</p>



<a name="264699971"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/219381-t-libs/topic/We%20can%27t%20%60u128%3A%20From%3Cusize%3E%60%2C%20can%20we%3F/near/264699971" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Simon Sapin <a href="https://zulip-archive.rust-lang.org/stream/219381-t-libs/topic/We.20can&#x27;t.20.60u128.3A.20From.3Cusize.3E.60.2C.20can.20we.3F.html#264699971">(Dec 13 2021 at 12:41)</a>:</h4>
<p>See <a href="https://github.com/rust-lang/rust/pull/49305’s">https://github.com/rust-lang/rust/pull/49305’s</a> PR description:</p>
<blockquote>
<p>[…] the C99 standard which (indirectly) requires pointers to be at least 16 bits […]</p>
<p>Note: if we make similar assumptions about the _maximum_ bit size of pointers (for all targets Rust will ever run on in the future), we could have similar <code>From</code> impls converting pointer-sized integers to large fixed-size integers. RISC-V considers the possibility of a 128-bit address space (RV128), which would leave only <code>impl From&lt;usize&gt; for u128</code> and <code>impl From&lt;isize&gt; for u128</code>. I <a href="https://www.cl.cam.ac.uk/research/security/ctsrd/pdfs/20171017a-cheri-poster.pdf">found</a> some <a href="http://www.csl.sri.com/users/neumann/2012resolve-cheri.pdf">things</a> about 256-bit “capabilities”, but I don’t know how relevant that would be to Rust’s <code>usize</code> and <code>isize</code> types.</p>
<p>I chose conservatively to make no assumption about the future there. Users <del>making</del> can make their own portability decisions and <del>using</del> use something like <code>.try_into().unwrap()</code>.</p>
</blockquote>



<a name="264700066"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/219381-t-libs/topic/We%20can%27t%20%60u128%3A%20From%3Cusize%3E%60%2C%20can%20we%3F/near/264700066" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Simon Sapin <a href="https://zulip-archive.rust-lang.org/stream/219381-t-libs/topic/We.20can&#x27;t.20.60u128.3A.20From.3Cusize.3E.60.2C.20can.20we.3F.html#264700066">(Dec 13 2021 at 12:42)</a>:</h4>
<p>ah I see CHERI was already mentioned here</p>



<a name="264723431"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/219381-t-libs/topic/We%20can%27t%20%60u128%3A%20From%3Cusize%3E%60%2C%20can%20we%3F/near/264723431" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Connor Horman <a href="https://zulip-archive.rust-lang.org/stream/219381-t-libs/topic/We.20can&#x27;t.20.60u128.3A.20From.3Cusize.3E.60.2C.20can.20we.3F.html#264723431">(Dec 13 2021 at 15:35)</a>:</h4>
<p>256-bit capabilities would apply to rust if usize=<code>uintptr_t</code>.</p>



<a name="264927417"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/219381-t-libs/topic/We%20can%27t%20%60u128%3A%20From%3Cusize%3E%60%2C%20can%20we%3F/near/264927417" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jubilee <a href="https://zulip-archive.rust-lang.org/stream/219381-t-libs/topic/We.20can&#x27;t.20.60u128.3A.20From.3Cusize.3E.60.2C.20can.20we.3F.html#264927417">(Dec 14 2021 at 21:23)</a>:</h4>
<p>I was reading this insanely cursed paper on how some people used a custom memory controller, plus some "creative" ideas of how to flip bits in RAM, to do computation "directly on RAM", and it turned out that 256 bits was about the right working unit. So it created a word (256-bits)-addressed SIMD machine.</p>
<p>I claim no relationship with the rest of this conversation I just think it's funny.</p>



<a name="264929296"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/219381-t-libs/topic/We%20can%27t%20%60u128%3A%20From%3Cusize%3E%60%2C%20can%20we%3F/near/264929296" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Josh Triplett <a href="https://zulip-archive.rust-lang.org/stream/219381-t-libs/topic/We.20can&#x27;t.20.60u128.3A.20From.3Cusize.3E.60.2C.20can.20we.3F.html#264929296">(Dec 14 2021 at 21:38)</a>:</h4>
<p>That sounds similar to the zero-instruction computer built out of the x86 page fault handler.</p>



<a name="264930738"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/219381-t-libs/topic/We%20can%27t%20%60u128%3A%20From%3Cusize%3E%60%2C%20can%20we%3F/near/264930738" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jubilee <a href="https://zulip-archive.rust-lang.org/stream/219381-t-libs/topic/We.20can&#x27;t.20.60u128.3A.20From.3Cusize.3E.60.2C.20can.20we.3F.html#264930738">(Dec 14 2021 at 21:46)</a>:</h4>
<p>They synthesized most higher-level instructions out of MAJ and NOT, as opposed to the classic AND, OR, and NOT building blocks.<br>
<a href="https://people.inf.ethz.ch/omutlu/pub/SIMDRAM_asplos21.pdf">https://people.inf.ethz.ch/omutlu/pub/SIMDRAM_asplos21.pdf</a></p>



<hr><p>Last updated: Apr 12 2022 at 20:01 UTC</p>
</html>