<html>
<head><meta charset="utf-8"><title>possible getrandom interface · t-libs · Zulip Chat Archive</title></head>
<h2>Stream: <a href="https://zulip-archive.rust-lang.org/stream/219381-t-libs/index.html">t-libs</a></h2>
<h3>Topic: <a href="https://zulip-archive.rust-lang.org/stream/219381-t-libs/topic/possible.20getrandom.20interface.html">possible getrandom interface</a></h3>

<hr>

<base href="https://rust-lang.zulipchat.com">

<head><link href="https://zulip-archive.rust-lang.org/style.css" rel="stylesheet"></head>

<a name="272440256"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/219381-t-libs/topic/possible%20getrandom%20interface/near/272440256" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jubilee <a href="https://zulip-archive.rust-lang.org/stream/219381-t-libs/topic/possible.20getrandom.20interface.html#272440256">(Feb 18 2022 at 18:39)</a>:</h4>
<p>Brought up in the 2022 roadmap as likely to be a smaller addition.<br>
I think it would be beneficial to prefer the non-blocking form for this?<br>
Is a non-blocking getrandom-like function valid on the Big Three?</p>



<a name="272441215"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/219381-t-libs/topic/possible%20getrandom%20interface/near/272441215" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Thom Chiovoloni <a href="https://zulip-archive.rust-lang.org/stream/219381-t-libs/topic/possible.20getrandom.20interface.html#272441215">(Feb 18 2022 at 18:46)</a>:</h4>
<p>Non-blocking as in asynchronous? Or as in, "doesn't do blocking I/O"</p>



<a name="272441312"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/219381-t-libs/topic/possible%20getrandom%20interface/near/272441312" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Thom Chiovoloni <a href="https://zulip-archive.rust-lang.org/stream/219381-t-libs/topic/possible.20getrandom.20interface.html#272441312">(Feb 18 2022 at 18:47)</a>:</h4>
<p>I think the stdlib having <code>async fn get_random</code> would be pretty annoying in practice. A very large portion of the time I need entropy I'm not already in an async function.</p>



<a name="272441417"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/219381-t-libs/topic/possible%20getrandom%20interface/near/272441417" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jubilee <a href="https://zulip-archive.rust-lang.org/stream/219381-t-libs/topic/possible.20getrandom.20interface.html#272441417">(Feb 18 2022 at 18:48)</a>:</h4>
<p><span class="user-mention silent" data-user-id="209168">Thom Chiovoloni</span> <a href="#narrow/stream/219381-t-libs/topic/possible.20getrandom.20interface/near/272441215">said</a>:</p>
<blockquote>
<p>Non-blocking as in asynchronous? Or as in, "doesn't do blocking I/O"</p>
</blockquote>
<p>Not async. The Linux-y version which I think is also POSIX-y? allows you to use a flag when invoking it and then if there's not enough entropy in the system to service the request it fails fast instead of blocking.</p>



<a name="272441794"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/219381-t-libs/topic/possible%20getrandom%20interface/near/272441794" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jubilee <a href="https://zulip-archive.rust-lang.org/stream/219381-t-libs/topic/possible.20getrandom.20interface.html#272441794">(Feb 18 2022 at 18:52)</a>:</h4>
<p>In practical cases, from the <strong>user</strong> perspective, it should have effectively 0 difference since the function should return a Result anyways (probably because it implements Read?) and they should be handling the cases where it doesn't return the value they want. Even if it's just "okay I'll busy-wait until there is."</p>



<a name="272442031"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/219381-t-libs/topic/possible%20getrandom%20interface/near/272442031" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> bjorn3 <a href="https://zulip-archive.rust-lang.org/stream/219381-t-libs/topic/possible.20getrandom.20interface.html#272442031">(Feb 18 2022 at 18:54)</a>:</h4>
<p>I believe it is the other way around. The default blocks if there is not enough entropy and there is a flag to return immediately if there is not enough entropy.</p>



<a name="272442115"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/219381-t-libs/topic/possible%20getrandom%20interface/near/272442115" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jubilee <a href="https://zulip-archive.rust-lang.org/stream/219381-t-libs/topic/possible.20getrandom.20interface.html#272442115">(Feb 18 2022 at 18:55)</a>:</h4>
<p>yeah, I think that's the case. I just suspect that our default should be to use the flag.<br>
The interface is still "sync" in both cases.</p>



<a name="272442270"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/219381-t-libs/topic/possible%20getrandom%20interface/near/272442270" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> bjorn3 <a href="https://zulip-archive.rust-lang.org/stream/219381-t-libs/topic/possible.20getrandom.20interface.html#272442270">(Feb 18 2022 at 18:57)</a>:</h4>
<p>I don't think so. People likely are going to handle the not enough entropy case incorrectly. For this reason for example fuchsia never returns an error from the random number syscall. It always blocks or I think crashes the target process.</p>



<a name="272442333"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/219381-t-libs/topic/possible%20getrandom%20interface/near/272442333" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jubilee <a href="https://zulip-archive.rust-lang.org/stream/219381-t-libs/topic/possible.20getrandom.20interface.html#272442333">(Feb 18 2022 at 18:57)</a>:</h4>
<p>kaboom.</p>



<a name="272442843"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/219381-t-libs/topic/possible%20getrandom%20interface/near/272442843" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> bjorn3 <a href="https://zulip-archive.rust-lang.org/stream/219381-t-libs/topic/possible.20getrandom.20interface.html#272442843">(Feb 18 2022 at 19:00)</a>:</h4>
<p><a href="https://fuchsia.dev/fuchsia-src/reference/syscalls/cprng_draw">https://fuchsia.dev/fuchsia-src/reference/syscalls/cprng_draw</a>: It terminates the process if the provided buffer pointer is not valid. It doesn't return an error in any other case. According to <a href="https://fuchsia.dev/fuchsia-src/concepts/kernel/cprng">https://fuchsia.dev/fuchsia-src/concepts/kernel/cprng</a> it may block during initial seeding but doesn't block afterwards.</p>



<a name="272442910"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/219381-t-libs/topic/possible%20getrandom%20interface/near/272442910" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> bjorn3 <a href="https://zulip-archive.rust-lang.org/stream/219381-t-libs/topic/possible.20getrandom.20interface.html#272442910">(Feb 18 2022 at 19:01)</a>:</h4>
<p>Blocking during initial seeding and never afterwards is what linux is moving to (or has already moved to) I believe.</p>



<a name="272443694"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/219381-t-libs/topic/possible%20getrandom%20interface/near/272443694" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Hans Kratz <a href="https://zulip-archive.rust-lang.org/stream/219381-t-libs/topic/possible.20getrandom.20interface.html#272443694">(Feb 18 2022 at 19:07)</a>:</h4>
<p>Has moved to in 5.6.</p>



<a name="272443857"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/219381-t-libs/topic/possible%20getrandom%20interface/near/272443857" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jubilee <a href="https://zulip-archive.rust-lang.org/stream/219381-t-libs/topic/possible.20getrandom.20interface.html#272443857">(Feb 18 2022 at 19:09)</a>:</h4>
<p>Hm, if we expose it through a Read implementation then that would raise the question of whether Read is being handled correctly at all.<br>
Though read_exact could attempt to block.</p>



<a name="272446380"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/219381-t-libs/topic/possible%20getrandom%20interface/near/272446380" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> The 8472 <a href="https://zulip-archive.rust-lang.org/stream/219381-t-libs/topic/possible.20getrandom.20interface.html#272446380">(Feb 18 2022 at 19:30)</a>:</h4>
<p>That caused a problem in early-boot though. systemd then had to switch to a non-blocking, best-effort call that was needed to generate UUIDs where low-quality randomness is acceptable</p>



<a name="272446674"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/219381-t-libs/topic/possible%20getrandom%20interface/near/272446674" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> lyinch <a href="https://zulip-archive.rust-lang.org/stream/219381-t-libs/topic/possible.20getrandom.20interface.html#272446674">(Feb 18 2022 at 19:33)</a>:</h4>
<p>In linux &gt;=4.8 , if <code>/dev/random</code> blocks, then it generally hasn't been seeded and the user may wish to wait. After initial seeding <code>/dev/urandom</code> can be used which never blocks. <a href="https://www.2uo.de/myths-about-urandom/#whats-wrong-with-blocking">https://www.2uo.de/myths-about-urandom/#whats-wrong-with-blocking</a>  <br>
The <code>getrandom</code> crate chooses to always blocks</p>



<a name="272446789"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/219381-t-libs/topic/possible%20getrandom%20interface/near/272446789" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> The 8472 <a href="https://zulip-archive.rust-lang.org/stream/219381-t-libs/topic/possible.20getrandom.20interface.html#272446789">(Feb 18 2022 at 19:34)</a>:</h4>
<p>I think we're talking about the getrandom syscall since that doesn't assume acccess to the filesystem, not the /dev devices</p>



<a name="272446851"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/219381-t-libs/topic/possible%20getrandom%20interface/near/272446851" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> The 8472 <a href="https://zulip-archive.rust-lang.org/stream/219381-t-libs/topic/possible.20getrandom.20interface.html#272446851">(Feb 18 2022 at 19:34)</a>:</h4>
<p><a href="https://man7.org/linux/man-pages/man2/getrandom.2.html">https://man7.org/linux/man-pages/man2/getrandom.2.html</a></p>



<a name="272447410"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/219381-t-libs/topic/possible%20getrandom%20interface/near/272447410" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jubilee <a href="https://zulip-archive.rust-lang.org/stream/219381-t-libs/topic/possible.20getrandom.20interface.html#272447410">(Feb 18 2022 at 19:40)</a>:</h4>
<p>Yeah.</p>



<a name="272447551"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/219381-t-libs/topic/possible%20getrandom%20interface/near/272447551" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Chris Denton <a href="https://zulip-archive.rust-lang.org/stream/219381-t-libs/topic/possible.20getrandom.20interface.html#272447551">(Feb 18 2022 at 19:41)</a>:</h4>
<p>Possibly relevant, (esp. for background): <a href="https://lwn.net/SubscriberLink/884875/58f88e6eb7913686/">Uniting the Linux random-number devices</a></p>



<a name="272447639"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/219381-t-libs/topic/possible%20getrandom%20interface/near/272447639" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jubilee <a href="https://zulip-archive.rust-lang.org/stream/219381-t-libs/topic/possible.20getrandom.20interface.html#272447639">(Feb 18 2022 at 19:42)</a>:</h4>
<p>Thinking about it, "don't wait" vs. "wait" actually mirrors the semantics of <code>read</code> vs <code>read_exact</code>.</p>



<a name="272447703"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/219381-t-libs/topic/possible%20getrandom%20interface/near/272447703" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lokathor <a href="https://zulip-archive.rust-lang.org/stream/219381-t-libs/topic/possible.20getrandom.20interface.html#272447703">(Feb 18 2022 at 19:42)</a>:</h4>
<p>The idea that we can't have an error case at all because users might write bad error handling code is probably not a good one to lean on too much. We have a Result type for a reason, and if you can't trust the user to interact with that then <em>most of the standard library</em> goes up in smoke.</p>



<a name="272447890"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/219381-t-libs/topic/possible%20getrandom%20interface/near/272447890" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jubilee <a href="https://zulip-archive.rust-lang.org/stream/219381-t-libs/topic/possible.20getrandom.20interface.html#272447890">(Feb 18 2022 at 19:44)</a>:</h4>
<p>Also C code doesn't ever <strong>have</strong> to interact with a Result type, Rust code is more obnoxious to avoid that case in.</p>



<a name="272448081"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/219381-t-libs/topic/possible%20getrandom%20interface/near/272448081" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lokathor <a href="https://zulip-archive.rust-lang.org/stream/219381-t-libs/topic/possible.20getrandom.20interface.html#272448081">(Feb 18 2022 at 19:46)</a>:</h4>
<p>We could provide a function <code>f() -&gt; Result&lt;[u8; N], RandSourceError&gt;</code> and then be confident that the user would be absolutely have to handle the error somehow.</p>



<a name="272448155"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/219381-t-libs/topic/possible%20getrandom%20interface/near/272448155" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jubilee <a href="https://zulip-archive.rust-lang.org/stream/219381-t-libs/topic/possible.20getrandom.20interface.html#272448155">(Feb 18 2022 at 19:47)</a>:</h4>
<p>Also true.</p>



<a name="272448428"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/219381-t-libs/topic/possible%20getrandom%20interface/near/272448428" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> The 8472 <a href="https://zulip-archive.rust-lang.org/stream/219381-t-libs/topic/possible.20getrandom.20interface.html#272448428">(Feb 18 2022 at 19:49)</a>:</h4>
<p>If you don't handle short reads on <code>Read</code> then all kinds of things will go wrong, not just your crypto.</p>



<a name="272448458"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/219381-t-libs/topic/possible%20getrandom%20interface/near/272448458" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> lyinch <a href="https://zulip-archive.rust-lang.org/stream/219381-t-libs/topic/possible.20getrandom.20interface.html#272448458">(Feb 18 2022 at 19:50)</a>:</h4>
<p>should the <code>GRND_NONBLOCK</code> flag be allowed to control the blocking behaviour?</p>



<a name="272448649"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/219381-t-libs/topic/possible%20getrandom%20interface/near/272448649" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> The 8472 <a href="https://zulip-archive.rust-lang.org/stream/219381-t-libs/topic/possible.20getrandom.20interface.html#272448649">(Feb 18 2022 at 19:51)</a>:</h4>
<p>aiui <span class="user-mention" data-user-id="281757">@Jubilee</span> suggested to make that flag implicit in the read vs. read_exact distinction</p>



<a name="272448702"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/219381-t-libs/topic/possible%20getrandom%20interface/near/272448702" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> The 8472 <a href="https://zulip-archive.rust-lang.org/stream/219381-t-libs/topic/possible.20getrandom.20interface.html#272448702">(Feb 18 2022 at 19:52)</a>:</h4>
<p>I.e. have <code>impl Read for Random</code> implement both methods.</p>



<a name="272448819"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/219381-t-libs/topic/possible%20getrandom%20interface/near/272448819" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jubilee <a href="https://zulip-archive.rust-lang.org/stream/219381-t-libs/topic/possible.20getrandom.20interface.html#272448819">(Feb 18 2022 at 19:53)</a>:</h4>
<p>Yes.<br>
It at the very least feels obvious to me that we want to make something equivalent to nonblocking randomness <strong>accessible</strong> for the very likely case that someone is writing a filesystem or init daemon or even, yes, a kernel, or just honestly doesn't care much, and then probably make another for the "block until entropy available" approach.</p>



<a name="272448993"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/219381-t-libs/topic/possible%20getrandom%20interface/near/272448993" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Thom Chiovoloni <a href="https://zulip-archive.rust-lang.org/stream/219381-t-libs/topic/possible.20getrandom.20interface.html#272448993">(Feb 18 2022 at 19:54)</a>:</h4>
<blockquote>
<p>If you don't handle short reads on <code>Read</code> then all kinds of things will go wrong, not just your crypto.</p>
</blockquote>
<p>Yes, but in practice theres a lot of code in the wild that doesn't handle short reads on <code>Read</code> correctly, and just relies on things happening to work out most of the time. A function returning a <code>Result&lt;[u8; N], Error&gt;</code> would avoid this though, at the cost of some copying.</p>



<a name="272449007"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/219381-t-libs/topic/possible%20getrandom%20interface/near/272449007" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jubilee <a href="https://zulip-archive.rust-lang.org/stream/219381-t-libs/topic/possible.20getrandom.20interface.html#272449007">(Feb 18 2022 at 19:54)</a>:</h4>
<p>it usually will fully fill the buffer if they ask for a reasonable-sized buffer but also someone out there will be like eh, "16 bytes is good enough, I'm just seeding my game state, not writing crypto, here."</p>



<a name="272449017"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/219381-t-libs/topic/possible%20getrandom%20interface/near/272449017" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Thom Chiovoloni <a href="https://zulip-archive.rust-lang.org/stream/219381-t-libs/topic/possible.20getrandom.20interface.html#272449017">(Feb 18 2022 at 19:54)</a>:</h4>
<p>Perhaps an unreasonable amount of copying</p>



<a name="272449059"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/219381-t-libs/topic/possible%20getrandom%20interface/near/272449059" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Thom Chiovoloni <a href="https://zulip-archive.rust-lang.org/stream/219381-t-libs/topic/possible.20getrandom.20interface.html#272449059">(Feb 18 2022 at 19:55)</a>:</h4>
<p>and it would be annoying to use to populate a vec with a dynamic amount of entropy</p>



<a name="272449123"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/219381-t-libs/topic/possible%20getrandom%20interface/near/272449123" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Thom Chiovoloni <a href="https://zulip-archive.rust-lang.org/stream/219381-t-libs/topic/possible.20getrandom.20interface.html#272449123">(Feb 18 2022 at 19:55)</a>:</h4>
<p>(so to be clear, i'm not sure i'm in favor of it)</p>



<a name="272449246"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/219381-t-libs/topic/possible%20getrandom%20interface/near/272449246" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lokathor <a href="https://zulip-archive.rust-lang.org/stream/219381-t-libs/topic/possible.20getrandom.20interface.html#272449246">(Feb 18 2022 at 19:56)</a>:</h4>
<p>If it's like a video game or something I'd <em>like</em> good randomness, but I can also get bad randomness a number of ways if I have to. So not blocking and just letting me have an error and then i can go to a backup is fine.</p>



<a name="272449247"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/219381-t-libs/topic/possible%20getrandom%20interface/near/272449247" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> The 8472 <a href="https://zulip-archive.rust-lang.org/stream/219381-t-libs/topic/possible.20getrandom.20interface.html#272449247">(Feb 18 2022 at 19:56)</a>:</h4>
<p><span class="user-mention silent" data-user-id="209168">Thom Chiovoloni</span> <a href="#narrow/stream/219381-t-libs/topic/possible.20getrandom.20interface/near/272448993">said</a>:</p>
<blockquote>
<p>Yes, but in practice theres a lot of code in the wild that doesn't handle short reads on <code>Read</code> correctly, and just relies on things happening to work out most of the time.</p>
</blockquote>
<p><span aria-label="scream" class="emoji emoji-1f631" role="img" title="scream">:scream:</span></p>



<a name="272449410"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/219381-t-libs/topic/possible%20getrandom%20interface/near/272449410" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jubilee <a href="https://zulip-archive.rust-lang.org/stream/219381-t-libs/topic/possible.20getrandom.20interface.html#272449410">(Feb 18 2022 at 19:57)</a>:</h4>
<p>tbh I have written code like that but only for the impl of Read on an existing <code>[u8]</code>.<br>
like<br>
many things fall apart if I can't rely on LOAD and STORE working, my fellow crab.</p>



<a name="272449723"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/219381-t-libs/topic/possible%20getrandom%20interface/near/272449723" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> The 8472 <a href="https://zulip-archive.rust-lang.org/stream/219381-t-libs/topic/possible.20getrandom.20interface.html#272449723">(Feb 18 2022 at 19:58)</a>:</h4>
<p>Yeah ok, but that's not a generic read. You have knowledge that this read impl cannot fail.</p>



<a name="272449889"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/219381-t-libs/topic/possible%20getrandom%20interface/near/272449889" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jubilee <a href="https://zulip-archive.rust-lang.org/stream/219381-t-libs/topic/possible.20getrandom.20interface.html#272449889">(Feb 18 2022 at 19:58)</a>:</h4>
<p>yes.</p>



<a name="272449997"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/219381-t-libs/topic/possible%20getrandom%20interface/near/272449997" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> The 8472 <a href="https://zulip-archive.rust-lang.org/stream/219381-t-libs/topic/possible.20getrandom.20interface.html#272449997">(Feb 18 2022 at 19:59)</a>:</h4>
<p><span class="user-mention" data-user-id="224471">@Lokathor</span>  you probably wouldn't want to do that in a video game anyway since it'd involve a syscall. Userspace PRNG would be preferable for a game.</p>



<a name="272450037"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/219381-t-libs/topic/possible%20getrandom%20interface/near/272450037" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jubilee <a href="https://zulip-archive.rust-lang.org/stream/219381-t-libs/topic/possible.20getrandom.20interface.html#272450037">(Feb 18 2022 at 19:59)</a>:</h4>
<p>You'd like to seed the PRNG with some higher-quality randomness tho'.</p>



<a name="272450107"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/219381-t-libs/topic/possible%20getrandom%20interface/near/272450107" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> The 8472 <a href="https://zulip-archive.rust-lang.org/stream/219381-t-libs/topic/possible.20getrandom.20interface.html#272450107">(Feb 18 2022 at 20:00)</a>:</h4>
<p>Yeah, but that's done once at startup</p>



<a name="272450318"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/219381-t-libs/topic/possible%20getrandom%20interface/near/272450318" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lokathor <a href="https://zulip-archive.rust-lang.org/stream/219381-t-libs/topic/possible.20getrandom.20interface.html#272450318">(Feb 18 2022 at 20:00)</a>:</h4>
<p>Yeah but that doesn't change my request at all</p>



<a name="272450391"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/219381-t-libs/topic/possible%20getrandom%20interface/near/272450391" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lokathor <a href="https://zulip-archive.rust-lang.org/stream/219381-t-libs/topic/possible.20getrandom.20interface.html#272450391">(Feb 18 2022 at 20:01)</a>:</h4>
<p>I still want "just error right now and I'll handle it", not blocking, and certainly not process death.</p>



<a name="272450491"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/219381-t-libs/topic/possible%20getrandom%20interface/near/272450491" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Thom Chiovoloni <a href="https://zulip-archive.rust-lang.org/stream/219381-t-libs/topic/possible.20getrandom.20interface.html#272450491">(Feb 18 2022 at 20:02)</a>:</h4>
<p>process death in fuschia is when you pass an invalid pointer</p>



<a name="272450545"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/219381-t-libs/topic/possible%20getrandom%20interface/near/272450545" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Thom Chiovoloni <a href="https://zulip-archive.rust-lang.org/stream/219381-t-libs/topic/possible.20getrandom.20interface.html#272450545">(Feb 18 2022 at 20:02)</a>:</h4>
<p>not insufficient entropy</p>



<a name="272450728"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/219381-t-libs/topic/possible%20getrandom%20interface/near/272450728" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jubilee <a href="https://zulip-archive.rust-lang.org/stream/219381-t-libs/topic/possible.20getrandom.20interface.html#272450728">(Feb 18 2022 at 20:04)</a>:</h4>
<p>I mentioned a Read impl mostly because <span class="user-mention" data-user-id="256342">@bstrie</span> requested it, but I am beginning to wonder if allowing the use of <code>read_to_end</code> on the entropy source is too mischievous. :^)</p>



<a name="272450804"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/219381-t-libs/topic/possible%20getrandom%20interface/near/272450804" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> The 8472 <a href="https://zulip-archive.rust-lang.org/stream/219381-t-libs/topic/possible.20getrandom.20interface.html#272450804">(Feb 18 2022 at 20:05)</a>:</h4>
<p>assuming it's urandom it would still be fairly fast, no worse than filling something from /dev/urandom</p>



<a name="272450893"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/219381-t-libs/topic/possible%20getrandom%20interface/near/272450893" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> The 8472 <a href="https://zulip-archive.rust-lang.org/stream/219381-t-libs/topic/possible.20getrandom.20interface.html#272450893">(Feb 18 2022 at 20:05)</a>:</h4>
<p>it's essentially a CSPRNG in the kernel that gets reseeded whenever additionally entrop is available.</p>



<a name="272450974"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/219381-t-libs/topic/possible%20getrandom%20interface/near/272450974" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jubilee <a href="https://zulip-archive.rust-lang.org/stream/219381-t-libs/topic/possible.20getrandom.20interface.html#272450974">(Feb 18 2022 at 20:06)</a>:</h4>
<p>I mean, true, but draining <strong>all</strong> the entropy in urandom?</p>



<a name="272451022"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/219381-t-libs/topic/possible%20getrandom%20interface/near/272451022" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> The 8472 <a href="https://zulip-archive.rust-lang.org/stream/219381-t-libs/topic/possible.20getrandom.20interface.html#272451022">(Feb 18 2022 at 20:06)</a>:</h4>
<p>urandom doesn't do that</p>



<a name="272451039"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/219381-t-libs/topic/possible%20getrandom%20interface/near/272451039" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> The 8472 <a href="https://zulip-archive.rust-lang.org/stream/219381-t-libs/topic/possible.20getrandom.20interface.html#272451039">(Feb 18 2022 at 20:06)</a>:</h4>
<p>random does (did?)</p>



<a name="272451040"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/219381-t-libs/topic/possible%20getrandom%20interface/near/272451040" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jubilee <a href="https://zulip-archive.rust-lang.org/stream/219381-t-libs/topic/possible.20getrandom.20interface.html#272451040">(Feb 18 2022 at 20:06)</a>:</h4>
<p>hmm.</p>



<a name="272451118"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/219381-t-libs/topic/possible%20getrandom%20interface/near/272451118" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jubilee <a href="https://zulip-archive.rust-lang.org/stream/219381-t-libs/topic/possible.20getrandom.20interface.html#272451118">(Feb 18 2022 at 20:07)</a>:</h4>
<p>Oh, I don't mean about performance, I mean that it would be uh "unfriendly" to other guests in the system.</p>



<a name="272451220"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/219381-t-libs/topic/possible%20getrandom%20interface/near/272451220" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> The 8472 <a href="https://zulip-archive.rust-lang.org/stream/219381-t-libs/topic/possible.20getrandom.20interface.html#272451220">(Feb 18 2022 at 20:08)</a>:</h4>
<p>AIUI urandom effectively doesn't do entropy accounting once it's seeded.</p>



<a name="272451251"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/219381-t-libs/topic/possible%20getrandom%20interface/near/272451251" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jubilee <a href="https://zulip-archive.rust-lang.org/stream/219381-t-libs/topic/possible.20getrandom.20interface.html#272451251">(Feb 18 2022 at 20:08)</a>:</h4>
<p>Ahh.</p>



<a name="272451400"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/219381-t-libs/topic/possible%20getrandom%20interface/near/272451400" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> The 8472 <a href="https://zulip-archive.rust-lang.org/stream/219381-t-libs/topic/possible.20getrandom.20interface.html#272451400">(Feb 18 2022 at 20:10)</a>:</h4>
<p>well...</p>
<div class="codehilite"><pre><span></span><code>$ dd if=/dev/random bs=1M count=1000 of=/dev/null
1000+0 records in
1000+0 records out
1048576000 bytes (1.0 GB, 1000 MiB) copied, 19.7782 s, 53.0 MB/s
$ dd if=/dev/urandom bs=1M count=1000 of=/dev/null
1000+0 records in
1000+0 records out
1048576000 bytes (1.0 GB, 1000 MiB) copied, 20.3227 s, 51.6 MB/s
</code></pre></div>



<a name="272451485"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/219381-t-libs/topic/possible%20getrandom%20interface/near/272451485" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jubilee <a href="https://zulip-archive.rust-lang.org/stream/219381-t-libs/topic/possible.20getrandom.20interface.html#272451485">(Feb 18 2022 at 20:11)</a>:</h4>
<p>welp.</p>



<a name="272451520"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/219381-t-libs/topic/possible%20getrandom%20interface/near/272451520" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jubilee <a href="https://zulip-archive.rust-lang.org/stream/219381-t-libs/topic/possible.20getrandom.20interface.html#272451520">(Feb 18 2022 at 20:11)</a>:</h4>
<p>What're the Mac and WIndows CPRNG interfaces like?</p>



<a name="272451629"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/219381-t-libs/topic/possible%20getrandom%20interface/near/272451629" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> lyinch <a href="https://zulip-archive.rust-lang.org/stream/219381-t-libs/topic/possible.20getrandom.20interface.html#272451629">(Feb 18 2022 at 20:12)</a>:</h4>
<p>on windows I found this: <a href="https://docs.microsoft.com/en-us/windows/win32/seccng/cng-portal">https://docs.microsoft.com/en-us/windows/win32/seccng/cng-portal</a></p>



<a name="272451657"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/219381-t-libs/topic/possible%20getrandom%20interface/near/272451657" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> scottmcm <a href="https://zulip-archive.rust-lang.org/stream/219381-t-libs/topic/possible.20getrandom.20interface.html#272451657">(Feb 18 2022 at 20:13)</a>:</h4>
<p>The usual windows one is this, IIRC: <a href="https://docs.microsoft.com/en-us/windows/win32/api/wincrypt/nf-wincrypt-cryptgenrandom">https://docs.microsoft.com/en-us/windows/win32/api/wincrypt/nf-wincrypt-cryptgenrandom</a></p>



<a name="272451758"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/219381-t-libs/topic/possible%20getrandom%20interface/near/272451758" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Chris Denton <a href="https://zulip-archive.rust-lang.org/stream/219381-t-libs/topic/possible.20getrandom.20interface.html#272451758">(Feb 18 2022 at 20:14)</a>:</h4>
<p>We use <a href="https://docs.microsoft.com/en-us/windows/win32/api/bcrypt/nf-bcrypt-bcryptgenrandom"><code>BCryptGenRandom</code></a></p>



<a name="272451764"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/219381-t-libs/topic/possible%20getrandom%20interface/near/272451764" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> scottmcm <a href="https://zulip-archive.rust-lang.org/stream/219381-t-libs/topic/possible.20getrandom.20interface.html#272451764">(Feb 18 2022 at 20:14)</a>:</h4>
<p>With a good reseedable XOF there's really no need to worry about output length.  Like it can be a sponge where you add new entropy when available for extra safety.</p>



<a name="272451928"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/219381-t-libs/topic/possible%20getrandom%20interface/near/272451928" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> lyinch <a href="https://zulip-archive.rust-lang.org/stream/219381-t-libs/topic/possible.20getrandom.20interface.html#272451928">(Feb 18 2022 at 20:16)</a>:</h4>
<p>on osx there's <code>getentropy</code></p>



<a name="272451972"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/219381-t-libs/topic/possible%20getrandom%20interface/near/272451972" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jubilee <a href="https://zulip-archive.rust-lang.org/stream/219381-t-libs/topic/possible.20getrandom.20interface.html#272451972">(Feb 18 2022 at 20:16)</a>:</h4>
<p>Ahhh, that one only allows 256 bytes at a time.</p>



<a name="272451976"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/219381-t-libs/topic/possible%20getrandom%20interface/near/272451976" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> lyinch <a href="https://zulip-archive.rust-lang.org/stream/219381-t-libs/topic/possible.20getrandom.20interface.html#272451976">(Feb 18 2022 at 20:16)</a>:</h4>
<p>interestingly, the man page says </p>
<blockquote>
<p>The maximum buffer size permitted is 256 bytes</p>
</blockquote>



<a name="272452125"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/219381-t-libs/topic/possible%20getrandom%20interface/near/272452125" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jubilee <a href="https://zulip-archive.rust-lang.org/stream/219381-t-libs/topic/possible.20getrandom.20interface.html#272452125">(Feb 18 2022 at 20:18)</a>:</h4>
<p><a href="https://man7.org/linux/man-pages/man3/getentropy.3.html">https://man7.org/linux/man-pages/man3/getentropy.3.html</a></p>
<blockquote>
<p>The maximum permitted value for the length argument is 256.</p>
</blockquote>



<a name="272452145"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/219381-t-libs/topic/possible%20getrandom%20interface/near/272452145" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> lyinch <a href="https://zulip-archive.rust-lang.org/stream/219381-t-libs/topic/possible.20getrandom.20interface.html#272452145">(Feb 18 2022 at 20:18)</a>:</h4>
<p>there seems to be a bit more to it, they also have alternatives</p>
<blockquote>
<p>However, it should be noted that getentropy() is primarily intended for use in the construction and seeding of userspace PRNGs like arc4random(3) or CC_crypto(3).  Clients who simply require random data should use arc4random(3), CCRandomGenerateBytes() from CC_crypto(3), or SecRandomCopyBytes() from the Security framework instead of getentropy() or random(4)</p>
</blockquote>



<a name="272452216"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/219381-t-libs/topic/possible%20getrandom%20interface/near/272452216" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> lyinch <a href="https://zulip-archive.rust-lang.org/stream/219381-t-libs/topic/possible.20getrandom.20interface.html#272452216">(Feb 18 2022 at 20:19)</a>:</h4>
<p>I'm copying from <code>man getentropy</code> on osx 12.1</p>



<a name="272452228"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/219381-t-libs/topic/possible%20getrandom%20interface/near/272452228" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jubilee <a href="https://zulip-archive.rust-lang.org/stream/219381-t-libs/topic/possible.20getrandom.20interface.html#272452228">(Feb 18 2022 at 20:19)</a>:</h4>
<p>Ohh.</p>



<a name="272452350"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/219381-t-libs/topic/possible%20getrandom%20interface/near/272452350" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jubilee <a href="https://zulip-archive.rust-lang.org/stream/219381-t-libs/topic/possible.20getrandom.20interface.html#272452350">(Feb 18 2022 at 20:20)</a>:</h4>
<p>I would hope they don't actually somehow check to see if the buffer is in fact 257 bytes long and just mean they look at the length arg. <span aria-label="sweat smile" class="emoji emoji-1f605" role="img" title="sweat smile">:sweat_smile:</span></p>



<a name="272452478"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/219381-t-libs/topic/possible%20getrandom%20interface/near/272452478" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> The 8472 <a href="https://zulip-archive.rust-lang.org/stream/219381-t-libs/topic/possible.20getrandom.20interface.html#272452478">(Feb 18 2022 at 20:21)</a>:</h4>
<p>We could of course wrap a userspace CPRNG around the kernel source. Although that'd mean pulling some crypto lib into std.</p>



<a name="272452603"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/219381-t-libs/topic/possible%20getrandom%20interface/near/272452603" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Thom Chiovoloni <a href="https://zulip-archive.rust-lang.org/stream/219381-t-libs/topic/possible.20getrandom.20interface.html#272452603">(Feb 18 2022 at 20:22)</a>:</h4>
<p><span class="user-mention silent" data-user-id="260325">Chris Denton</span> <a href="#narrow/stream/219381-t-libs/topic/possible.20getrandom.20interface/near/272451758">said</a>:</p>
<blockquote>
<p>We use <a href="https://docs.microsoft.com/en-us/windows/win32/api/bcrypt/nf-bcrypt-bcryptgenrandom"><code>BCryptGenRandom</code></a></p>
</blockquote>
<p>Which perhaps causes problems too... <a href="https://github.com/rust-lang/rust/issues/94098">https://github.com/rust-lang/rust/issues/94098</a></p>



<a name="272452700"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/219381-t-libs/topic/possible%20getrandom%20interface/near/272452700" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> The 8472 <a href="https://zulip-archive.rust-lang.org/stream/219381-t-libs/topic/possible.20getrandom.20interface.html#272452700">(Feb 18 2022 at 20:23)</a>:</h4>
<p>Sounds like it's limited to some broken systems and could be worked around. That wouldn't be a blocker to providing a std API</p>



<a name="272452723"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/219381-t-libs/topic/possible%20getrandom%20interface/near/272452723" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Thom Chiovoloni <a href="https://zulip-archive.rust-lang.org/stream/219381-t-libs/topic/possible.20getrandom.20interface.html#272452723">(Feb 18 2022 at 20:23)</a>:</h4>
<p>i agree</p>



<a name="272452929"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/219381-t-libs/topic/possible%20getrandom%20interface/near/272452929" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jubilee <a href="https://zulip-archive.rust-lang.org/stream/219381-t-libs/topic/possible.20getrandom.20interface.html#272452929">(Feb 18 2022 at 20:25)</a>:</h4>
<p><span class="user-mention silent" data-user-id="479478">lyinch</span> <a href="#narrow/stream/219381-t-libs/topic/possible.20getrandom.20interface/near/272452145">said</a>:</p>
<blockquote>
<p>there seems to be a bit more to it, they also have alternatives</p>
<blockquote>
<p>However, it should be noted that getentropy() is primarily intended for use in the construction and seeding of userspace PRNGs like arc4random(3) or CC_crypto(3).  Clients who simply require random data should use arc4random(3), CCRandomGenerateBytes() from CC_crypto(3), or SecRandomCopyBytes() from the Security framework instead of getentropy() or random(4)</p>
</blockquote>
</blockquote>
<p>Thank you, this is good to know.</p>



<a name="272452937"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/219381-t-libs/topic/possible%20getrandom%20interface/near/272452937" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> lyinch <a href="https://zulip-archive.rust-lang.org/stream/219381-t-libs/topic/possible.20getrandom.20interface.html#272452937">(Feb 18 2022 at 20:25)</a>:</h4>
<p>as for the choice on osx, the <code>getentropy</code> syscall also claims to be a bit more secure and _always_ available</p>
<blockquote>
<p>Unlike the random(4) pseudo-devices, it is not vulnerable to file descriptor exhaustion attacks and is available when sandboxed or in a chroot, making it more reliable for security-critical applications.</p>
</blockquote>



<a name="272452963"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/219381-t-libs/topic/possible%20getrandom%20interface/near/272452963" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jubilee <a href="https://zulip-archive.rust-lang.org/stream/219381-t-libs/topic/possible.20getrandom.20interface.html#272452963">(Feb 18 2022 at 20:25)</a>:</h4>
<p>Interesting.</p>



<a name="272452985"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/219381-t-libs/topic/possible%20getrandom%20interface/near/272452985" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> scottmcm <a href="https://zulip-archive.rust-lang.org/stream/219381-t-libs/topic/possible.20getrandom.20interface.html#272452985">(Feb 18 2022 at 20:25)</a>:</h4>
<p><span class="user-mention silent" data-user-id="330154">The 8472</span> <a href="#narrow/stream/219381-t-libs/topic/possible.20getrandom.20interface/near/272452478">said</a>:</p>
<blockquote>
<p>We could of course wrap a userspace CPRNG around the kernel source.</p>
</blockquote>
<p>I think we should just use the OS facility here, and provide access to whatever crypto-XOF the OS does.</p>
<p>Anyone needing <em>specifically</em> entropy or whatever is doing something specific enough that I think it might even be good for them to use the OS things directly, since the implications on the system of consuming entropy can be bad.</p>



<a name="272453166"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/219381-t-libs/topic/possible%20getrandom%20interface/near/272453166" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> The 8472 <a href="https://zulip-archive.rust-lang.org/stream/219381-t-libs/topic/possible.20getrandom.20interface.html#272453166">(Feb 18 2022 at 20:27)</a>:</h4>
<p>Ok, then we should document it potentially being terribly slow. Perhaps <code>Read</code> isn't necessary then and <code>Result&lt;[u8; N], Error&gt;</code> is fine.</p>



<a name="272453298"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/219381-t-libs/topic/possible%20getrandom%20interface/near/272453298" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jubilee <a href="https://zulip-archive.rust-lang.org/stream/219381-t-libs/topic/possible.20getrandom.20interface.html#272453298">(Feb 18 2022 at 20:28)</a>:</h4>
<p>Yeah, I think we should avoid introducing our own CPRNG here if the OS offers one, and basically say that it's probably for seeding your own higher-quality randomness function.</p>



<a name="272453388"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/219381-t-libs/topic/possible%20getrandom%20interface/near/272453388" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> bstrie <a href="https://zulip-archive.rust-lang.org/stream/219381-t-libs/topic/possible.20getrandom.20interface.html#272453388">(Feb 18 2022 at 20:29)</a>:</h4>
<p><code>std::io::Entropy</code>?</p>



<a name="272453708"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/219381-t-libs/topic/possible%20getrandom%20interface/near/272453708" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jubilee <a href="https://zulip-archive.rust-lang.org/stream/219381-t-libs/topic/possible.20getrandom.20interface.html#272453708">(Feb 18 2022 at 20:31)</a>:</h4>
<p>And since this would ostensibly be for making <code>rand</code>-like crates easier to write, we should probably ask the rand maintainer(s) what they'd find useful.</p>



<a name="272453787"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/219381-t-libs/topic/possible%20getrandom%20interface/near/272453787" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> lyinch <a href="https://zulip-archive.rust-lang.org/stream/219381-t-libs/topic/possible.20getrandom.20interface.html#272453787">(Feb 18 2022 at 20:32)</a>:</h4>
<p>they already offer this in their own <a href="https://docs.rs/getrandom/latest/getrandom/">https://docs.rs/getrandom/latest/getrandom/</a> crate</p>



<a name="272453864"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/219381-t-libs/topic/possible%20getrandom%20interface/near/272453864" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jubilee <a href="https://zulip-archive.rust-lang.org/stream/219381-t-libs/topic/possible.20getrandom.20interface.html#272453864">(Feb 18 2022 at 20:33)</a>:</h4>
<p><del>or what they think were mistakes in their getrandom crate's API</del></p>



<a name="272453889"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/219381-t-libs/topic/possible%20getrandom%20interface/near/272453889" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Thom Chiovoloni <a href="https://zulip-archive.rust-lang.org/stream/219381-t-libs/topic/possible.20getrandom.20interface.html#272453889">(Feb 18 2022 at 20:33)</a>:</h4>
<p><code>fn std::rand::seed&lt;const N: usize&gt;() -&gt; Result&lt;[u8; N], Error&gt;</code> might be a way to paint the bikeshed that makes it clear its just for seeding other rngs, and may be very slow</p>



<a name="272454065"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/219381-t-libs/topic/possible%20getrandom%20interface/near/272454065" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jubilee <a href="https://zulip-archive.rust-lang.org/stream/219381-t-libs/topic/possible.20getrandom.20interface.html#272454065">(Feb 18 2022 at 20:35)</a>:</h4>
<p>Yeah, I was thinking we should say <code>seed</code> somewhere, so that sounds good to me.</p>



<a name="272454177"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/219381-t-libs/topic/possible%20getrandom%20interface/near/272454177" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jubilee <a href="https://zulip-archive.rust-lang.org/stream/219381-t-libs/topic/possible.20getrandom.20interface.html#272454177">(Feb 18 2022 at 20:36)</a>:</h4>
<blockquote>
<p>There is no blanket implementation on unix targets that reads from /dev/urandom. This ensures all supported targets are using the recommended interface and respect maximum buffer sizes.</p>
</blockquote>



<a name="272454180"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/219381-t-libs/topic/possible%20getrandom%20interface/near/272454180" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> lyinch <a href="https://zulip-archive.rust-lang.org/stream/219381-t-libs/topic/possible.20getrandom.20interface.html#272454180">(Feb 18 2022 at 20:36)</a>:</h4>
<p>there's also a draft rfc from many years ago: <a href="https://github.com/dhardy/rfcs/blob/system-random/text/0000-system-random.md">https://github.com/dhardy/rfcs/blob/system-random/text/0000-system-random.md</a>  . There might be a bunch of issues with discussions which are worth at digging out</p>



<a name="272454463"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/219381-t-libs/topic/possible%20getrandom%20interface/near/272454463" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> bstrie <a href="https://zulip-archive.rust-lang.org/stream/219381-t-libs/topic/possible.20getrandom.20interface.html#272454463">(Feb 18 2022 at 20:39)</a>:</h4>
<p>signalling that "this is potentially slow and not a general-purpose RNG API" is the reason that I proposed putting this in std::io :P</p>



<a name="272454561"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/219381-t-libs/topic/possible%20getrandom%20interface/near/272454561" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Thom Chiovoloni <a href="https://zulip-archive.rust-lang.org/stream/219381-t-libs/topic/possible.20getrandom.20interface.html#272454561">(Feb 18 2022 at 20:40)</a>:</h4>
<p>std::io to me implies that its implemented in terms of doing IO, tbh</p>



<a name="272454617"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/219381-t-libs/topic/possible%20getrandom%20interface/near/272454617" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> bstrie <a href="https://zulip-archive.rust-lang.org/stream/219381-t-libs/topic/possible.20getrandom.20interface.html#272454617">(Feb 18 2022 at 20:40)</a>:</h4>
<p>well it involves a syscall, it's not a userspace PRNG</p>



<a name="272454622"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/219381-t-libs/topic/possible%20getrandom%20interface/near/272454622" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Thom Chiovoloni <a href="https://zulip-archive.rust-lang.org/stream/219381-t-libs/topic/possible.20getrandom.20interface.html#272454622">(Feb 18 2022 at 20:40)</a>:</h4>
<p>given that that's a reasonable way of implementing it but probably not the way we're doing it, i'm not sure</p>



<a name="272454632"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/219381-t-libs/topic/possible%20getrandom%20interface/near/272454632" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> lyinch <a href="https://zulip-archive.rust-lang.org/stream/219381-t-libs/topic/possible.20getrandom.20interface.html#272454632">(Feb 18 2022 at 20:41)</a>:</h4>
<p>(in linux, everything is a file, so this is correct)</p>



<a name="272454702"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/219381-t-libs/topic/possible%20getrandom%20interface/near/272454702" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Thom Chiovoloni <a href="https://zulip-archive.rust-lang.org/stream/219381-t-libs/topic/possible.20getrandom.20interface.html#272454702">(Feb 18 2022 at 20:41)</a>:</h4>
<p>also <code>std::io::Entropy</code> doesn't really indicate that it's non-general purpose to me. I also would expect it to implement std::io::Read, which i think is kind of a footgun</p>



<a name="272454708"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/219381-t-libs/topic/possible%20getrandom%20interface/near/272454708" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Thom Chiovoloni <a href="https://zulip-archive.rust-lang.org/stream/219381-t-libs/topic/possible.20getrandom.20interface.html#272454708">(Feb 18 2022 at 20:41)</a>:</h4>
<p>for this case</p>



<a name="272455052"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/219381-t-libs/topic/possible%20getrandom%20interface/near/272455052" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jubilee <a href="https://zulip-archive.rust-lang.org/stream/219381-t-libs/topic/possible.20getrandom.20interface.html#272455052">(Feb 18 2022 at 20:45)</a>:</h4>
<p>Yeah, I think that given that some OS will give you basically-whatever amounts of entropy but others will glare at you for asking for more than 256 bytes, we should be hesitant to implement a general-purpose Read interface.</p>



<a name="272455373"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/219381-t-libs/topic/possible%20getrandom%20interface/near/272455373" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> bstrie <a href="https://zulip-archive.rust-lang.org/stream/219381-t-libs/topic/possible.20getrandom.20interface.html#272455373">(Feb 18 2022 at 20:48)</a>:</h4>
<p>my suggestion to use Read was more-or-less just exuberance, I don't care how this gets added to std, I just want it :P</p>



<a name="272455667"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/219381-t-libs/topic/possible%20getrandom%20interface/near/272455667" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Josh Triplett <a href="https://zulip-archive.rust-lang.org/stream/219381-t-libs/topic/possible.20getrandom.20interface.html#272455667">(Feb 18 2022 at 20:51)</a>:</h4>
<p><span class="user-mention silent" data-user-id="330154">The 8472</span> <a href="#narrow/stream/219381-t-libs/topic/possible.20getrandom.20interface/near/272449723">said</a>:</p>
<blockquote>
<p>Yeah ok, but that's not a generic read. You have knowledge that this read impl cannot fail.</p>
</blockquote>
<p>In particular, I wish I had some way of using a read interface on a slice or similar infallible thing where the type checker could <em>see</em> that it can' fail.</p>



<a name="272455671"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/219381-t-libs/topic/possible%20getrandom%20interface/near/272455671" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> bstrie <a href="https://zulip-archive.rust-lang.org/stream/219381-t-libs/topic/possible.20getrandom.20interface.html#272455671">(Feb 18 2022 at 20:51)</a>:</h4>
<p>at the same time, I don't think an interface that lets the user ask for an arbitrary number of bytes is infeasible. we can batch multiple calls under the hood if we need to. and even for Read::read, we're allowed to read less than the user asked for: "It is not an error if the returned value n is smaller than the buffer size, even when the reader is not at the end of the stream yet. This may happen for example because fewer bytes are actually available right now (e. g. being close to end-of-file) or because read() was interrupted by a signal."</p>



<a name="272455750"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/219381-t-libs/topic/possible%20getrandom%20interface/near/272455750" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Josh Triplett <a href="https://zulip-archive.rust-lang.org/stream/219381-t-libs/topic/possible.20getrandom.20interface.html#272455750">(Feb 18 2022 at 20:52)</a>:</h4>
<p><span class="user-mention silent" data-user-id="330154">The 8472</span> <a href="#narrow/stream/219381-t-libs/topic/possible.20getrandom.20interface/near/272451220">said</a>:</p>
<blockquote>
<p>AIUI urandom effectively doesn't do entropy accounting once it's seeded.</p>
</blockquote>
<p>Per the LWN article linked above: random doesn't either, anymore.</p>



<a name="272455827"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/219381-t-libs/topic/possible%20getrandom%20interface/near/272455827" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> scottmcm <a href="https://zulip-archive.rust-lang.org/stream/219381-t-libs/topic/possible.20getrandom.20interface.html#272455827">(Feb 18 2022 at 20:53)</a>:</h4>
<p><span class="user-mention silent" data-user-id="330154">The 8472</span> <a href="#narrow/stream/219381-t-libs/topic/possible.20getrandom.20interface/near/272453166">said</a>:</p>
<blockquote>
<p>Ok, then we should document it potentially being terribly slow.</p>
</blockquote>
<p>I mean, if we say that it's from the OS, then it's up to the OS.</p>
<p>Are there any tier 1 OSs that don't expose a reasonable-speed CS-XOF to contexts that would be using <code>std</code>?</p>
<p>It being secure and slower, so you use it to seed a user-space RNG if you care about fast instead, seems very in line with what I'd expect a default in <code>std</code> to do.</p>



<a name="272455835"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/219381-t-libs/topic/possible%20getrandom%20interface/near/272455835" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jubilee <a href="https://zulip-archive.rust-lang.org/stream/219381-t-libs/topic/possible.20getrandom.20interface.html#272455835">(Feb 18 2022 at 20:53)</a>:</h4>
<p>We're allowed, but the argument above is that short reads are handled poorly "in the wild".</p>



<a name="272455846"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/219381-t-libs/topic/possible%20getrandom%20interface/near/272455846" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Josh Triplett <a href="https://zulip-archive.rust-lang.org/stream/219381-t-libs/topic/possible.20getrandom.20interface.html#272455846">(Feb 18 2022 at 20:53)</a>:</h4>
<p><span class="user-mention silent" data-user-id="330154">The 8472</span> <a href="#narrow/stream/219381-t-libs/topic/possible.20getrandom.20interface/near/272452478">said</a>:</p>
<blockquote>
<p>We could of course wrap a userspace CPRNG around the kernel source. Although that'd mean pulling some crypto lib into std.</p>
</blockquote>
<p>I would love to have a seedable CSPRNG in core, and a get-random-bytes mechanism in std that could be used to seed it.</p>



<a name="272455949"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/219381-t-libs/topic/possible%20getrandom%20interface/near/272455949" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jubilee <a href="https://zulip-archive.rust-lang.org/stream/219381-t-libs/topic/possible.20getrandom.20interface.html#272455949">(Feb 18 2022 at 20:54)</a>:</h4>
<p>I am not <em>against</em> exposing a Rust CSPRNG in <code>std</code>, but atm we're discussing the second part, not the first. ^_^</p>



<a name="272455960"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/219381-t-libs/topic/possible%20getrandom%20interface/near/272455960" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Josh Triplett <a href="https://zulip-archive.rust-lang.org/stream/219381-t-libs/topic/possible.20getrandom.20interface.html#272455960">(Feb 18 2022 at 20:54)</a>:</h4>
<p><span aria-label="+1" class="emoji emoji-1f44d" role="img" title="+1">:+1:</span>, and I'm happy with having those separated.</p>



<a name="272455968"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/219381-t-libs/topic/possible%20getrandom%20interface/near/272455968" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> bstrie <a href="https://zulip-archive.rust-lang.org/stream/219381-t-libs/topic/possible.20getrandom.20interface.html#272455968">(Feb 18 2022 at 20:54)</a>:</h4>
<p>I'd also love to have an actual PRNG in std "someday", but for now I'd just like people to be able to seed their own RNGs without having to resort to tokio's awful HashMap hack</p>



<a name="272455983"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/219381-t-libs/topic/possible%20getrandom%20interface/near/272455983" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Josh Triplett <a href="https://zulip-archive.rust-lang.org/stream/219381-t-libs/topic/possible.20getrandom.20interface.html#272455983">(Feb 18 2022 at 20:54)</a>:</h4>
<p>Not least of which because I don't think there's much value in having the CSPRNG in core <em>until</em> we have a sensible mechanism for seeding it.</p>



<a name="272456227"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/219381-t-libs/topic/possible%20getrandom%20interface/near/272456227" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> bstrie <a href="https://zulip-archive.rust-lang.org/stream/219381-t-libs/topic/possible.20getrandom.20interface.html#272456227">(Feb 18 2022 at 20:57)</a>:</h4>
<p>I would actually expect that a CSPRNG would <em>not</em> be seedable via any stdlib API</p>



<a name="272456253"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/219381-t-libs/topic/possible%20getrandom%20interface/near/272456253" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> The 8472 <a href="https://zulip-archive.rust-lang.org/stream/219381-t-libs/topic/possible.20getrandom.20interface.html#272456253">(Feb 18 2022 at 20:57)</a>:</h4>
<p>?</p>



<a name="272456265"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/219381-t-libs/topic/possible%20getrandom%20interface/near/272456265" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> scottmcm <a href="https://zulip-archive.rust-lang.org/stream/219381-t-libs/topic/possible.20getrandom.20interface.html#272456265">(Feb 18 2022 at 20:57)</a>:</h4>
<p>I worry that anything that really <em>needs</em> a CSPRNG would have compliance restrictions that would keep them from being able to use anything we implement in <code>std</code> anyway.  I'd much rather people fix a specific audited version of rustsec, for example, than the version of their rust toolchain.</p>



<a name="272456274"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/219381-t-libs/topic/possible%20getrandom%20interface/near/272456274" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> bstrie <a href="https://zulip-archive.rust-lang.org/stream/219381-t-libs/topic/possible.20getrandom.20interface.html#272456274">(Feb 18 2022 at 20:57)</a>:</h4>
<p>CSPRNGs should have a disjoint interface from PRNGs used for simulation</p>



<a name="272456363"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/219381-t-libs/topic/possible%20getrandom%20interface/near/272456363" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> The 8472 <a href="https://zulip-archive.rust-lang.org/stream/219381-t-libs/topic/possible.20getrandom.20interface.html#272456363">(Feb 18 2022 at 20:58)</a>:</h4>
<p>Oh, sure. I don't think josh was proposing an integrated API. Just two building blocks that can be joined manually</p>



<a name="272456364"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/219381-t-libs/topic/possible%20getrandom%20interface/near/272456364" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> bstrie <a href="https://zulip-archive.rust-lang.org/stream/219381-t-libs/topic/possible.20getrandom.20interface.html#272456364">(Feb 18 2022 at 20:58)</a>:</h4>
<p>one needs to be misuse-resistant and not seedable, and the other needs to be seedable and deterministic</p>



<a name="272456411"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/219381-t-libs/topic/possible%20getrandom%20interface/near/272456411" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Josh Triplett <a href="https://zulip-archive.rust-lang.org/stream/219381-t-libs/topic/possible.20getrandom.20interface.html#272456411">(Feb 18 2022 at 20:58)</a>:</h4>
<p><span class="user-mention silent" data-user-id="256342">bstrie</span> <a href="#narrow/stream/219381-t-libs/topic/possible.20getrandom.20interface/near/272456364">said</a>:</p>
<blockquote>
<p>one needs to be misuse-resistant and not seedable, and the other needs to be seedable and deterministic</p>
</blockquote>
<p>I don't think there's any use case for a seedable PRNG that isn't satisfied by a seedable CSPRNG.</p>



<a name="272456428"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/219381-t-libs/topic/possible%20getrandom%20interface/near/272456428" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Josh Triplett <a href="https://zulip-archive.rust-lang.org/stream/219381-t-libs/topic/possible.20getrandom.20interface.html#272456428">(Feb 18 2022 at 20:59)</a>:</h4>
<p>I think in both cases we want "misuse-resistant".</p>



<a name="272456492"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/219381-t-libs/topic/possible%20getrandom%20interface/near/272456492" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> bstrie <a href="https://zulip-archive.rust-lang.org/stream/219381-t-libs/topic/possible.20getrandom.20interface.html#272456492">(Feb 18 2022 at 20:59)</a>:</h4>
<p><span class="user-mention" data-user-id="125270">@scottmcm</span> the problem that we ran into at Rust 1.0 is that if we <em>do</em> ship a non-cryptographically-secure RNG but <em>don't</em> ship a cryptographically-secure RNG, then we know that people will reach for the former when they should be using the latter</p>



<a name="272456505"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/219381-t-libs/topic/possible%20getrandom%20interface/near/272456505" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Josh Triplett <a href="https://zulip-archive.rust-lang.org/stream/219381-t-libs/topic/possible.20getrandom.20interface.html#272456505">(Feb 18 2022 at 20:59)</a>:</h4>
<p>I'd ideally want 1) an underlying CSPRNG that takes a seed and gives you random numbers, and 2) a default binding of that together with a secure seeding mechanism from the OS, that we encourage people to use by default for any purpose that <em>doesn't</em> want replayability.</p>



<a name="272456519"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/219381-t-libs/topic/possible%20getrandom%20interface/near/272456519" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Thom Chiovoloni <a href="https://zulip-archive.rust-lang.org/stream/219381-t-libs/topic/possible.20getrandom.20interface.html#272456519">(Feb 18 2022 at 20:59)</a>:</h4>
<blockquote>
<p>I worry that anything that really needs a CSPRNG would have compliance restrictions that would keep them from being able to use anything we implement in std anyway. I'd much rather people fix a specific audited version of rustsec, for example, than the version of their rust toolchain.</p>
</blockquote>
<p>I know I used the same rand hashing hack tokio uses explicitly because using the hashmap api for this was okay but pulling in a 3rd party rng wasnt (this was in earlier times of rust in firefox, when security crates needed a separate audit).</p>



<a name="272456763"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/219381-t-libs/topic/possible%20getrandom%20interface/near/272456763" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> lyinch <a href="https://zulip-archive.rust-lang.org/stream/219381-t-libs/topic/possible.20getrandom.20interface.html#272456763">(Feb 18 2022 at 21:00)</a>:</h4>
<p>for macos, what do you think about allowing &gt;256 bytes by just calling <code>getentropy()</code> repeatedly? I don't think people who do cross-platform development care or even know about this limit</p>



<a name="272456941"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/219381-t-libs/topic/possible%20getrandom%20interface/near/272456941" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jubilee <a href="https://zulip-archive.rust-lang.org/stream/219381-t-libs/topic/possible.20getrandom.20interface.html#272456941">(Feb 18 2022 at 21:01)</a>:</h4>
<p><span class="user-mention silent" data-user-id="125270">scottmcm</span> <a href="#narrow/stream/219381-t-libs/topic/possible.20getrandom.20interface/near/272456265">said</a>:</p>
<blockquote>
<p>I worry that anything that really <em>needs</em> a CSPRNG would have compliance restrictions that would keep them from being able to use anything we implement in <code>std</code> anyway.  I'd much rather people fix a specific audited version of rustsec, for example, than the version of their rust toolchain.</p>
</blockquote>
<p>No, I don't think this is how compliance auditing works.</p>



<a name="272457019"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/219381-t-libs/topic/possible%20getrandom%20interface/near/272457019" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> scottmcm <a href="https://zulip-archive.rust-lang.org/stream/219381-t-libs/topic/possible.20getrandom.20interface.html#272457019">(Feb 18 2022 at 21:02)</a>:</h4>
<p><span class="user-mention silent" data-user-id="256342">bstrie</span> <a href="#narrow/stream/219381-t-libs/topic/possible.20getrandom.20interface/near/272456492">said</a>:</p>
<blockquote>
<p><span class="user-mention silent" data-user-id="125270">scottmcm</span> the problem that we ran into at Rust 1.0 is that if we <em>do</em> ship a non-cryptographically-secure RNG but <em>don't</em> ship a cryptographically-secure RNG, then we know that people will reach for the former when they should be using the latter</p>
</blockquote>
<p>Totally agreed, but I think what I'm proposing here is <em>just</em> having the OS's CS-XOF exposed in <code>std</code> and leaving everything else to elsewhere.  Since those other things can seed from the non-seedable OS XOF we expose, if they want.</p>



<a name="272457064"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/219381-t-libs/topic/possible%20getrandom%20interface/near/272457064" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> The 8472 <a href="https://zulip-archive.rust-lang.org/stream/219381-t-libs/topic/possible.20getrandom.20interface.html#272457064">(Feb 18 2022 at 21:02)</a>:</h4>
<p>That's 256 <em>bytes</em>. To resist quantum attacks you might need <em>maybe</em> 512<em>bits</em>. So the limit should be enough for seeding about anything.</p>



<a name="272457107"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/219381-t-libs/topic/possible%20getrandom%20interface/near/272457107" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jubilee <a href="https://zulip-archive.rust-lang.org/stream/219381-t-libs/topic/possible.20getrandom.20interface.html#272457107">(Feb 18 2022 at 21:03)</a>:</h4>
<p>At least, not for a <strong>lot</strong> of users.<br>
For a lot of people, the way auditing is going to work will actually be oriented around verifying the Rust toolchain first.</p>



<a name="272457203"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/219381-t-libs/topic/possible%20getrandom%20interface/near/272457203" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Josh Triplett <a href="https://zulip-archive.rust-lang.org/stream/219381-t-libs/topic/possible.20getrandom.20interface.html#272457203">(Feb 18 2022 at 21:04)</a>:</h4>
<p><span class="user-mention silent" data-user-id="125270">scottmcm</span> <a href="#narrow/stream/219381-t-libs/topic/possible.20getrandom.20interface/near/272456265">said</a>:</p>
<blockquote>
<p>I worry that anything that really <em>needs</em> a CSPRNG would have compliance restrictions that would keep them from being able to use anything we implement in <code>std</code> anyway.  I'd much rather people fix a specific audited version of rustsec, for example, than the version of their rust toolchain.</p>
</blockquote>
<p>So, I don't think we should give <em>any</em> thought to things like FIPS. Those should remain the domain of specialized crates.</p>



<a name="272457234"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/219381-t-libs/topic/possible%20getrandom%20interface/near/272457234" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brendan Hickey <a href="https://zulip-archive.rust-lang.org/stream/219381-t-libs/topic/possible.20getrandom.20interface.html#272457234">(Feb 18 2022 at 21:04)</a>:</h4>
<p>When we built the abseil RNG library we decided to make it difficult to seed. What we had found was that people misused RNGs in tests and blessed the results. This made it impossible to execute large scale changes. Very few people are dealing with multi-million package repos, so this concern might not generalize.</p>



<a name="272457305"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/219381-t-libs/topic/possible%20getrandom%20interface/near/272457305" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Josh Triplett <a href="https://zulip-archive.rust-lang.org/stream/219381-t-libs/topic/possible.20getrandom.20interface.html#272457305">(Feb 18 2022 at 21:05)</a>:</h4>
<p>The case of "I need something actually secure" should be covered by a CSPRNG. The case of "I need something on some particular approved/vetted list" is entirely different.</p>



<a name="272457435"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/219381-t-libs/topic/possible%20getrandom%20interface/near/272457435" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jubilee <a href="https://zulip-archive.rust-lang.org/stream/219381-t-libs/topic/possible.20getrandom.20interface.html#272457435">(Feb 18 2022 at 21:06)</a>:</h4>
<p><span class="user-mention silent" data-user-id="239881">Josh Triplett</span> <a href="#narrow/stream/219381-t-libs/topic/possible.20getrandom.20interface/near/272457305">said</a>:</p>
<blockquote>
<p>The case of "I need something actually secure" should be covered by a CSPRNG. The case of "I need something on some particular approved/vetted list" is entirely different.</p>
</blockquote>
<p>This is true, I just wanted to note that saying that it shouldn't be in std for compliance concerns is getting it the wrong way around.</p>



<a name="272458109"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/219381-t-libs/topic/possible%20getrandom%20interface/near/272458109" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jubilee <a href="https://zulip-archive.rust-lang.org/stream/219381-t-libs/topic/possible.20getrandom.20interface.html#272458109">(Feb 18 2022 at 21:12)</a>:</h4>
<p>Okay done futzing I think that groups everything appropriately. &lt;_&lt;</p>



<a name="272458372"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/219381-t-libs/topic/possible%20getrandom%20interface/near/272458372" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Josh Triplett <a href="https://zulip-archive.rust-lang.org/stream/219381-t-libs/topic/possible.20getrandom.20interface.html#272458372">(Feb 18 2022 at 21:14)</a>:</h4>
<p><span class="user-mention" data-user-id="281757">@Jubilee</span> So, not especially urgent, but I feel like the whole line of discussion between scottmcm and myself about seedable RNGs potentially locking down the algorithm doesn't actually belong in the "RNGs in tests" topic, it's part of the more general topic.</p>



<a name="272458424"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/219381-t-libs/topic/possible%20getrandom%20interface/near/272458424" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jubilee <a href="https://zulip-archive.rust-lang.org/stream/219381-t-libs/topic/possible.20getrandom.20interface.html#272458424">(Feb 18 2022 at 21:15)</a>:</h4>
<p>well~</p>



<a name="272458607"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/219381-t-libs/topic/possible%20getrandom%20interface/near/272458607" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jubilee <a href="https://zulip-archive.rust-lang.org/stream/219381-t-libs/topic/possible.20getrandom.20interface.html#272458607">(Feb 18 2022 at 21:17)</a>:</h4>
<p><span class="user-mention silent" data-user-id="239881">Josh Triplett</span> <a href="#narrow/stream/219381-t-libs/topic/possible.20getrandom.20interface/near/272458372">said</a>:</p>
<blockquote>
<p><span class="user-mention silent" data-user-id="281757">Jubilee</span> So, not especially urgent, but I feel like the whole line of discussion between scottmcm and myself about seedable RNGs potentially locking down the algorithm doesn't actually belong in the "RNGs in tests" topic, it's part of the more general topic.</p>
</blockquote>
<p>kinda but also this is mostly about the interface one might use to seed things with as opposed to whether another interface is seedable! also afaik I have no special powers, if everyone disagrees you are all free to move your messages back into this topic, I think.</p>



<a name="272458941"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/219381-t-libs/topic/possible%20getrandom%20interface/near/272458941" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> lyinch <a href="https://zulip-archive.rust-lang.org/stream/219381-t-libs/topic/possible.20getrandom.20interface.html#272458941">(Feb 18 2022 at 21:20)</a>:</h4>
<p>what do you think about the <code>no_std</code> idea from here: <a href="https://github.com/dhardy/rfcs/blob/system-random/text/0000-system-random.md#no_std-support">https://github.com/dhardy/rfcs/blob/system-random/text/0000-system-random.md#no_std-support</a>  ? Add an implementation to <code>libcore</code> which always fails and which <code>no_std</code> users have to implement themselves. The actual implementation will be in<code>libstd</code>.</p>



<a name="272460298"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/219381-t-libs/topic/possible%20getrandom%20interface/near/272460298" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jubilee <a href="https://zulip-archive.rust-lang.org/stream/219381-t-libs/topic/possible.20getrandom.20interface.html#272460298">(Feb 18 2022 at 21:32)</a>:</h4>
<p><span class="user-mention silent" data-user-id="479478">lyinch</span> <a href="#narrow/stream/219381-t-libs/topic/possible.20getrandom.20interface/near/272458941">said</a>:</p>
<blockquote>
<p>what do you think about the <code>no_std</code> idea from here: <a href="https://github.com/dhardy/rfcs/blob/system-random/text/0000-system-random.md#no_std-support">https://github.com/dhardy/rfcs/blob/system-random/text/0000-system-random.md#no_std-support</a>  ? Add an implementation to <code>libcore</code> which always fails and which <code>no_std</code> users have to implement themselves. The actual implementation will be in<code>libstd</code>.</p>
</blockquote>
<p>So the first thing hinges on whether <code>io::Error</code> can be used. I think our E for this Result should be designed for the particularities of the use case, rather than using <code>io::Error</code>. I think because this domain is so exceptionally security-sensitive, we don't want to couple it to anything else.</p>
<p>But I also doubt we should provide an implementation for <code>core</code>, unless we can do so by simply directly issuing the relevant hardware instructions across most architectures.</p>



<a name="272463580"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/219381-t-libs/topic/possible%20getrandom%20interface/near/272463580" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> lyinch <a href="https://zulip-archive.rust-lang.org/stream/219381-t-libs/topic/possible.20getrandom.20interface.html#272463580">(Feb 18 2022 at 22:00)</a>:</h4>
<p>for AMD and Intel x86-64 there is <code>RDRAND</code> and <code>RDSEED</code> and for ARM V8 there seems to be support for <code>RNDR</code></p>



<a name="272463759"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/219381-t-libs/topic/possible%20getrandom%20interface/near/272463759" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> The 8472 <a href="https://zulip-archive.rust-lang.org/stream/219381-t-libs/topic/possible.20getrandom.20interface.html#272463759">(Feb 18 2022 at 22:01)</a>:</h4>
<p>See the other thread, those are being discussed there too :D</p>



<a name="272464165"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/219381-t-libs/topic/possible%20getrandom%20interface/near/272464165" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jubilee <a href="https://zulip-archive.rust-lang.org/stream/219381-t-libs/topic/possible.20getrandom.20interface.html#272464165">(Feb 18 2022 at 22:05)</a>:</h4>
<p>I think, based on the fact that it seems the security community lacks consensus for whether it is acceptable to do that, and it would still break on some <code>#!{no_std]</code> targets assuredly, and a lot else requires the machine to be configured properly by the bare-metal user, and by then they have much better access to sources of randomness than we can generically implement, it existing in libcore should simply be eschewed. GIve people a compiler error, not a runtime error.</p>



<a name="272466318"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/219381-t-libs/topic/possible%20getrandom%20interface/near/272466318" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> bjorn3 <a href="https://zulip-archive.rust-lang.org/stream/219381-t-libs/topic/possible.20getrandom.20interface.html#272466318">(Feb 18 2022 at 22:23)</a>:</h4>
<p>Rdrand also breaks rr due to being non-deterministic in a way that rr can't capture and replay.</p>



<a name="272466980"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/219381-t-libs/topic/possible%20getrandom%20interface/near/272466980" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> lyinch <a href="https://zulip-archive.rust-lang.org/stream/219381-t-libs/topic/possible.20getrandom.20interface.html#272466980">(Feb 18 2022 at 22:29)</a>:</h4>
<p><span class="user-mention silent" data-user-id="133247">bjorn3</span> <a href="#narrow/stream/219381-t-libs/topic/possible.20getrandom.20interface/near/272466318">said</a>:</p>
<blockquote>
<p>Rdrand also breaks rr due to being non-deterministic in a way that rr can't capture and replay.</p>
</blockquote>
<p><a href="https://github.com/systemd/systemd/pull/17115">https://github.com/systemd/systemd/pull/17115</a> can be disabled with systemd</p>



<a name="272468011"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/219381-t-libs/topic/possible%20getrandom%20interface/near/272468011" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> bjorn3 <a href="https://zulip-archive.rust-lang.org/stream/219381-t-libs/topic/possible.20getrandom.20interface.html#272468011">(Feb 18 2022 at 22:39)</a>:</h4>
<p>That disables it specifically for systemd's <code>/sbin/init</code> and not for arbitrary user programs, right?</p>



<a name="272707076"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/219381-t-libs/topic/possible%20getrandom%20interface/near/272707076" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> lyinch <a href="https://zulip-archive.rust-lang.org/stream/219381-t-libs/topic/possible.20getrandom.20interface.html#272707076">(Feb 21 2022 at 16:05)</a>:</h4>
<p>how will this continue? I guess this addition requires an RFC</p>



<a name="272717268"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/219381-t-libs/topic/possible%20getrandom%20interface/near/272717268" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> bstrie <a href="https://zulip-archive.rust-lang.org/stream/219381-t-libs/topic/possible.20getrandom.20interface.html#272717268">(Feb 21 2022 at 17:36)</a>:</h4>
<p>yes, I would expect something of this magnitude to have an RFC. and correct me if I'm wrong, but I don't think this is a case of needing to add a new external dependency to std; std should <em>already</em> have all the code necessary for this, in order to support HashMaps, it just needs an interface. In fact I think the getrandom crate might have just been copied out of std directly.</p>



<a name="272721624"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/219381-t-libs/topic/possible%20getrandom%20interface/near/272721624" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> lyinch <a href="https://zulip-archive.rust-lang.org/stream/219381-t-libs/topic/possible.20getrandom.20interface.html#272721624">(Feb 21 2022 at 18:26)</a>:</h4>
<p>indeed, I was not aware that so much is already implemented in <a href="https://github.com/rust-lang/rust/blob/master/library/std/src/sys/unix/rand.rs">https://github.com/rust-lang/rust/blob/master/library/std/src/sys/unix/rand.rs</a></p>



<a name="272732069"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/219381-t-libs/topic/possible%20getrandom%20interface/near/272732069" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jubilee <a href="https://zulip-archive.rust-lang.org/stream/219381-t-libs/topic/possible.20getrandom.20interface.html#272732069">(Feb 21 2022 at 20:26)</a>:</h4>
<p>Technically this is only a single function, so, following the libs policy, we could just add it... :^)<br>
But I think the <strong>import</strong> of it is, in fact, yes<br>
high-magnitude, and will certainly require RFC-like levels of talking to people,<br>
whether or not it goes through the RFC process.</p>



<a name="272732133"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/219381-t-libs/topic/possible%20getrandom%20interface/near/272732133" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Josh Triplett <a href="https://zulip-archive.rust-lang.org/stream/219381-t-libs/topic/possible.20getrandom.20interface.html#272732133">(Feb 21 2022 at 20:27)</a>:</h4>
<p>Yeah, I think in particular exposing a function to provide secure randomness has lots of implications about target support.</p>



<a name="272732251"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/219381-t-libs/topic/possible%20getrandom%20interface/near/272732251" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jubilee <a href="https://zulip-archive.rust-lang.org/stream/219381-t-libs/topic/possible.20getrandom.20interface.html#272732251">(Feb 21 2022 at 20:29)</a>:</h4>
<p>Like, "does this require an RFC?" idk, procedurally no, but morally yes, it requires running down every person who has a thought on this matter and broadcasting they can get their remarks in.</p>



<a name="272732383"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/219381-t-libs/topic/possible%20getrandom%20interface/near/272732383" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> scottmcm <a href="https://zulip-archive.rust-lang.org/stream/219381-t-libs/topic/possible.20getrandom.20interface.html#272732383">(Feb 21 2022 at 20:30)</a>:</h4>
<p>Given that <a href="https://doc.rust-lang.org/nightly/rustc/platform-support.html">https://doc.rust-lang.org/nightly/rustc/platform-support.html</a> already says "the full standard library is available" for <code>wasm32-unknown-unknown</code>, I'm not sure that it really says all that much about target support, since this could just be another thing that's stubbed out.</p>



<a name="272732536"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/219381-t-libs/topic/possible%20getrandom%20interface/near/272732536" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Josh Triplett <a href="https://zulip-archive.rust-lang.org/stream/219381-t-libs/topic/possible.20getrandom.20interface.html#272732536">(Feb 21 2022 at 20:32)</a>:</h4>
<p>Sure, but there are other platforms where randomness may not be available either. Embedded for instance.</p>



<a name="272732613"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/219381-t-libs/topic/possible%20getrandom%20interface/near/272732613" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Connor Horman <a href="https://zulip-archive.rust-lang.org/stream/219381-t-libs/topic/possible.20getrandom.20interface.html#272732613">(Feb 21 2022 at 20:33)</a>:</h4>
<p>Well, needs to be in std for !embedded.</p>



<a name="272732721"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/219381-t-libs/topic/possible%20getrandom%20interface/near/272732721" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Connor Horman <a href="https://zulip-archive.rust-lang.org/stream/219381-t-libs/topic/possible.20getrandom.20interface.html#272732721">(Feb 21 2022 at 20:35)</a>:</h4>
<p>Might be a good idea to allow it to be implemented via a userspace CSPRNG, though, as a fallback.</p>



<a name="272732768"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/219381-t-libs/topic/possible%20getrandom%20interface/near/272732768" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Josh Triplett <a href="https://zulip-archive.rust-lang.org/stream/219381-t-libs/topic/possible.20getrandom.20interface.html#272732768">(Feb 21 2022 at 20:36)</a>:</h4>
<p>That much seems fine, but you still have to seed it.</p>



<a name="272732836"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/219381-t-libs/topic/possible%20getrandom%20interface/near/272732836" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Josh Triplett <a href="https://zulip-archive.rust-lang.org/stream/219381-t-libs/topic/possible.20getrandom.20interface.html#272732836">(Feb 21 2022 at 20:36)</a>:</h4>
<p>If you have a piece of hardware with <em>no</em> source of randomness, you can't really produce randomness ex nihilo.</p>



<a name="272732998"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/219381-t-libs/topic/possible%20getrandom%20interface/near/272732998" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> scottmcm <a href="https://zulip-archive.rust-lang.org/stream/219381-t-libs/topic/possible.20getrandom.20interface.html#272732998">(Feb 21 2022 at 20:38)</a>:</h4>
<p><span class="user-mention silent" data-user-id="239881">Josh Triplett</span> <a href="#narrow/stream/219381-t-libs/topic/possible.20getrandom.20interface/near/272732536">said</a>:</p>
<blockquote>
<p>Sure, but there are other platforms where randomness may not be available either. Embedded for instance.</p>
</blockquote>
<p>I just mean that we have precedent for "it just panics" counting as enough support to be Tier2.</p>



<a name="272733013"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/219381-t-libs/topic/possible%20getrandom%20interface/near/272733013" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Connor Horman <a href="https://zulip-archive.rust-lang.org/stream/219381-t-libs/topic/possible.20getrandom.20interface.html#272733013">(Feb 21 2022 at 20:39)</a>:</h4>
<p><span class="user-mention silent" data-user-id="239881">Josh Triplett</span> <a href="#narrow/stream/219381-t-libs/topic/possible.20getrandom.20interface/near/272732768">said</a>:</p>
<blockquote>
<p>That much seems fine, but you still have to seed it.</p>
</blockquote>
<p>Yeah. Ultimately, the answer could be is it's allowed to be seeded the same way every execution. I would expect this solution to be "few and far between" though.</p>



<a name="272733124"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/219381-t-libs/topic/possible%20getrandom%20interface/near/272733124" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> scottmcm <a href="https://zulip-archive.rust-lang.org/stream/219381-t-libs/topic/possible.20getrandom.20interface.html#272733124">(Feb 21 2022 at 20:40)</a>:</h4>
<p><span class="user-mention silent" data-user-id="257758">Connor Horman</span> <a href="#narrow/stream/219381-t-libs/topic/possible.20getrandom.20interface/near/272733013">said</a>:</p>
<blockquote>
<p>the answer could be is it's allowed to be seeded the same way every execution</p>
</blockquote>
<p>I'd email <a href="mailto:security@rust-lang.org">security@rust-lang.org</a> if I found any platforms doing that in the official bits, personally.</p>



<a name="272733197"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/219381-t-libs/topic/possible%20getrandom%20interface/near/272733197" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Josh Triplett <a href="https://zulip-archive.rust-lang.org/stream/219381-t-libs/topic/possible.20getrandom.20interface.html#272733197">(Feb 21 2022 at 20:41)</a>:</h4>
<p>Yeah. I'd rather have a target panic than do that.</p>



<a name="272733252"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/219381-t-libs/topic/possible%20getrandom%20interface/near/272733252" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Josh Triplett <a href="https://zulip-archive.rust-lang.org/stream/219381-t-libs/topic/possible.20getrandom.20interface.html#272733252">(Feb 21 2022 at 20:42)</a>:</h4>
<p>If someone wants the same randomness every time, they can run the seedable RNG with a fixed seed.</p>



<a name="272733260"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/219381-t-libs/topic/possible%20getrandom%20interface/near/272733260" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Connor Horman <a href="https://zulip-archive.rust-lang.org/stream/219381-t-libs/topic/possible.20getrandom.20interface.html#272733260">(Feb 21 2022 at 20:42)</a>:</h4>
<p>Maybe. I know old Mingw did that for <code>std::random_device</code></p>



<a name="272733427"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/219381-t-libs/topic/possible%20getrandom%20interface/near/272733427" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> lyinch <a href="https://zulip-archive.rust-lang.org/stream/219381-t-libs/topic/possible.20getrandom.20interface.html#272733427">(Feb 21 2022 at 20:44)</a>:</h4>
<p>I think that was a bug</p>
<blockquote>
<p>A notable implementation where std::random_device is deterministic is old versions of MinGW (bug 338, fixed since GCC 9.2). <br>
<a href="https://en.cppreference.com/w/cpp/numeric/random/random_device">https://en.cppreference.com/w/cpp/numeric/random/random_device</a></p>
</blockquote>



<a name="272736205"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/219381-t-libs/topic/possible%20getrandom%20interface/near/272736205" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jubilee <a href="https://zulip-archive.rust-lang.org/stream/219381-t-libs/topic/possible.20getrandom.20interface.html#272736205">(Feb 21 2022 at 21:21)</a>:</h4>
<p>Honestly, I don't think the <code>wasm*-?-?</code> target bears much consideration. It essentially is a shim for a real <code>wasm*-wasi</code> target, or <code>wasm*-browser</code></p>



<a name="272736494"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/219381-t-libs/topic/possible%20getrandom%20interface/near/272736494" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jubilee <a href="https://zulip-archive.rust-lang.org/stream/219381-t-libs/topic/possible.20getrandom.20interface.html#272736494">(Feb 21 2022 at 21:25)</a>:</h4>
<p>Not saying this to bag on anyone who uses it or contributed to it, it's just that it's more valuable than it is coherent, and trying to bend everything around rationalizing-as-coherent what is essentially a point of explicit decoherence strikes me as an unwise approach.</p>



<a name="272736614"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/219381-t-libs/topic/possible%20getrandom%20interface/near/272736614" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Josh Triplett <a href="https://zulip-archive.rust-lang.org/stream/219381-t-libs/topic/possible.20getrandom.20interface.html#272736614">(Feb 21 2022 at 21:26)</a>:</h4>
<p>In general, it feels like those targets want some kind of capability mechanism for "what your particular target has". Some embedded targets want that too.</p>



<a name="272744834"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/219381-t-libs/topic/possible%20getrandom%20interface/near/272744834" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> The 8472 <a href="https://zulip-archive.rust-lang.org/stream/219381-t-libs/topic/possible.20getrandom.20interface.html#272744834">(Feb 21 2022 at 23:31)</a>:</h4>
<p>Isn't that just the slicing-std-into-features thing again?</p>



<a name="272795261"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/219381-t-libs/topic/possible%20getrandom%20interface/near/272795261" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> bstrie <a href="https://zulip-archive.rust-lang.org/stream/219381-t-libs/topic/possible.20getrandom.20interface.html#272795261">(Feb 22 2022 at 12:25)</a>:</h4>
<p><span class="user-mention silent" data-user-id="239881">Josh Triplett</span> <a href="#narrow/stream/219381-t-libs/topic/possible.20getrandom.20interface/near/272732536">said</a>:</p>
<blockquote>
<p>Sure, but there are other platforms where randomness may not be available either. Embedded for instance.</p>
</blockquote>
<p>I don't envision this random interface being in libcore, only in libstd. no_std things will be on their own.</p>



<a name="272795417"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/219381-t-libs/topic/possible%20getrandom%20interface/near/272795417" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> bstrie <a href="https://zulip-archive.rust-lang.org/stream/219381-t-libs/topic/possible.20getrandom.20interface.html#272795417">(Feb 22 2022 at 12:27)</a>:</h4>
<p>for the same reason that HashMap is defined in libstd, whereas all the other std::collections are defined in liballoc</p>



<a name="273013161"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/219381-t-libs/topic/possible%20getrandom%20interface/near/273013161" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> lyinch <a href="https://zulip-archive.rust-lang.org/stream/219381-t-libs/topic/possible.20getrandom.20interface.html#273013161">(Feb 23 2022 at 21:23)</a>:</h4>
<p>does anyone know if <code>/dev/urandom</code> possibly block on macos &lt; 10.12 like on linux? Or does it return lower-entropy values like on some BSD distros? </p>
<blockquote>
<p>When  read,  /dev/urandom  device  will return as many bytes as are re quested.  As a result, if there is not sufficient entropy  in  the  entropy pool, the returned values are theoretically vulnerable to a cryptographic attack on the algorithms used by the  driver.<br>
<a href="https://www.freebsd.org/cgi/man.cgi?query=urandom&amp;apropos=0&amp;sektion=0&amp;manpath=Red+Hat+9&amp;arch=default&amp;format=html">https://www.freebsd.org/cgi/man.cgi?query=urandom&amp;apropos=0&amp;sektion=0&amp;manpath=Red+Hat+9&amp;arch=default&amp;format=html</a></p>
</blockquote>
<p>I don't know where I can find man pages of different macos versions online</p>



<a name="273013893"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/219381-t-libs/topic/possible%20getrandom%20interface/near/273013893" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> cuviper <a href="https://zulip-archive.rust-lang.org/stream/219381-t-libs/topic/possible.20getrandom.20interface.html#273013893">(Feb 23 2022 at 21:29)</a>:</h4>
<p>Is that really a freebsd manpage? Or as the url implies Red Hat 9 which would be ancient...</p>



<a name="273014882"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/219381-t-libs/topic/possible%20getrandom%20interface/near/273014882" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> lyinch <a href="https://zulip-archive.rust-lang.org/stream/219381-t-libs/topic/possible.20getrandom.20interface.html#273014882">(Feb 23 2022 at 21:38)</a>:</h4>
<p>yes, you're right... This should be the corresponding freedsb 14 page: <a href="https://www.freebsd.org/cgi/man.cgi?query=random&amp;sektion=4&amp;apropos=0&amp;manpath=FreeBSD+14.0-current">https://www.freebsd.org/cgi/man.cgi?query=random&amp;sektion=4&amp;apropos=0&amp;manpath=FreeBSD+14.0-current</a>  which says that it's blocking:</p>
<blockquote>
<p>The generator will start in an unseeded state, and will block reads until it is seeded for the first time.</p>
</blockquote>



<hr><p>Last updated: Apr 12 2022 at 20:01 UTC</p>
</html>