<html>
<head><meta charset="utf-8"><title>✔ &quot;async for _ in Stream&quot;? · wg-async-foundations · Zulip Chat Archive</title></head>
<h2>Stream: <a href="https://rust-lang.github.io/zulip_archive/stream/187312-wg-async-foundations/index.html">wg-async-foundations</a></h2>
<h3>Topic: <a href="https://rust-lang.github.io/zulip_archive/stream/187312-wg-async-foundations/topic/.E2.9C.94.20.22async.20for.20_.20in.20Stream.22.3F.html">✔ &quot;async for _ in Stream&quot;?</a></h3>

<hr>

<base href="https://rust-lang.zulipchat.com">

<head><link href="https://rust-lang.github.io/zulip_archive/style.css" rel="stylesheet"></head>

<a name="246015593"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/187312-wg-async-foundations/topic/%E2%9C%94%20%22async%20for%20_%20in%20Stream%22%3F/near/246015593" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jonathan de Jong <a href="https://rust-lang.github.io/zulip_archive/stream/187312-wg-async-foundations/topic/.E2.9C.94.20.22async.20for.20_.20in.20Stream.22.3F.html#246015593">(Jul 14 2021 at 20:28)</a>:</h4>
<p>Has someone yet proposed or gotten the idea to sugar the syntax of;</p>
<div class="codehilite" data-code-language="Rust"><pre><span></span><code><span class="k">while</span><span class="w"> </span><span class="kd">let</span><span class="w"> </span><span class="nb">Some</span><span class="p">(</span><span class="n">item</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">stream</span><span class="p">.</span><span class="n">next</span><span class="p">().</span><span class="k">await</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">  </span><span class="c1">// do something with item</span>
<span class="p">}</span><span class="w"></span>
</code></pre></div>
<p>to</p>
<div class="codehilite" data-code-language="Rust"><pre><span></span><code><span class="k">async</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">item</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="n">stream</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">  </span><span class="c1">// do something with item</span>
<span class="p">}</span><span class="w"></span>
</code></pre></div>
<p>or the likes?</p>
<p>I'm taking inspiration <a href="https://www.python.org/dev/peps/pep-0525/#id12">from python</a>, which uses these semantics;</p>
<div class="codehilite" data-code-language="Python"><pre><span></span><code><span class="k">async</span> <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">async_generator</span><span class="p">():</span>
    <span class="k">pass</span> <span class="c1"># do something with item</span>
</code></pre></div>



<a name="246016096"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/187312-wg-async-foundations/topic/%E2%9C%94%20%22async%20for%20_%20in%20Stream%22%3F/near/246016096" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jonathan de Jong <a href="https://rust-lang.github.io/zulip_archive/stream/187312-wg-async-foundations/topic/.E2.9C.94.20.22async.20for.20_.20in.20Stream.22.3F.html#246016096">(Jul 14 2021 at 20:32)</a>:</h4>
<p>Oh nevermind, i just saw <a href="https://rust-lang.github.io/rfcs/2394-async_await.html#generators-and-streams">this rfc</a></p>



<a name="246016102"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/187312-wg-async-foundations/topic/%E2%9C%94%20%22async%20for%20_%20in%20Stream%22%3F/near/246016102" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Notification Bot <a href="https://rust-lang.github.io/zulip_archive/stream/187312-wg-async-foundations/topic/.E2.9C.94.20.22async.20for.20_.20in.20Stream.22.3F.html#246016102">(Jul 14 2021 at 20:32)</a>:</h4>
<p><span class="user-mention silent" data-user-id="300259">Jonathan de Jong</span> has marked this topic as resolved.</p>



<a name="246247942"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/187312-wg-async-foundations/topic/%E2%9C%94%20%22async%20for%20_%20in%20Stream%22%3F/near/246247942" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://rust-lang.github.io/zulip_archive/stream/187312-wg-async-foundations/topic/.E2.9C.94.20.22async.20for.20_.20in.20Stream.22.3F.html#246247942">(Jul 16 2021 at 16:42)</a>:</h4>
<p>Woah, I didn't know "resolved" topics were a thing</p>



<a name="246259208"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/187312-wg-async-foundations/topic/%E2%9C%94%20%22async%20for%20_%20in%20Stream%22%3F/near/246259208" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Ibraheem Ahmed <a href="https://rust-lang.github.io/zulip_archive/stream/187312-wg-async-foundations/topic/.E2.9C.94.20.22async.20for.20_.20in.20Stream.22.3F.html#246259208">(Jul 16 2021 at 18:08)</a>:</h4>
<p><span class="user-mention silent" data-user-id="300259">Jonathan de Jong</span> <a href="#narrow/stream/187312-wg-async-foundations/topic/.E2.9C.94.20.22async.20for.20_.20in.20Stream.22.3F/near/246016096">said</a>:</p>
<blockquote>
<p>Oh nevermind, i just saw <a href="https://rust-lang.github.io/rfcs/2394-async_await.html#generators-and-streams">this rfc</a></p>
</blockquote>
<p>That section was referring to generators, something a bit different.</p>



<a name="246259216"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/187312-wg-async-foundations/topic/%E2%9C%94%20%22async%20for%20_%20in%20Stream%22%3F/near/246259216" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Ibraheem Ahmed <a href="https://rust-lang.github.io/zulip_archive/stream/187312-wg-async-foundations/topic/.E2.9C.94.20.22async.20for.20_.20in.20Stream.22.3F.html#246259216">(Jul 16 2021 at 18:09)</a>:</h4>
<div class="codehilite" data-code-language="Rust"><pre><span></span><code><span class="k">async</span><span class="w"> </span><span class="k">fn</span> <span class="nf">foo</span><span class="p">(</span><span class="n">io</span>: <span class="kp">&amp;</span><span class="nc">AsyncRead</span><span class="p">)</span><span class="w"> </span><span class="kr">yield</span><span class="w"> </span><span class="kt">i32</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="k">async</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">line</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="n">io</span><span class="p">.</span><span class="n">lines</span><span class="p">()</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">        </span><span class="kr">yield</span><span class="w"> </span><span class="n">line</span><span class="p">.</span><span class="n">unwrap</span><span class="p">().</span><span class="n">parse</span><span class="p">().</span><span class="n">unwrap</span><span class="p">();</span><span class="w"></span>
<span class="w">    </span><span class="p">}</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>
</code></pre></div>



<a name="246259255"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/187312-wg-async-foundations/topic/%E2%9C%94%20%22async%20for%20_%20in%20Stream%22%3F/near/246259255" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Ibraheem Ahmed <a href="https://rust-lang.github.io/zulip_archive/stream/187312-wg-async-foundations/topic/.E2.9C.94.20.22async.20for.20_.20in.20Stream.22.3F.html#246259255">(Jul 16 2021 at 18:09)</a>:</h4>
<p>I think the syntax you want is mentioned in <a href="https://rust-lang.github.io/rfcs/2394-async_await.html#for-await-and-processing-streams">the section above</a></p>



<a name="246259285"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/187312-wg-async-foundations/topic/%E2%9C%94%20%22async%20for%20_%20in%20Stream%22%3F/near/246259285" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Ibraheem Ahmed <a href="https://rust-lang.github.io/zulip_archive/stream/187312-wg-async-foundations/topic/.E2.9C.94.20.22async.20for.20_.20in.20Stream.22.3F.html#246259285">(Jul 16 2021 at 18:09)</a>:</h4>
<div class="codehilite" data-code-language="Rust"><pre><span></span><code><span class="k">for</span><span class="w"> </span><span class="k">await</span><span class="w"> </span><span class="n">item</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="n">stream</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">  </span><span class="c1">// do something with item</span>
<span class="p">}</span><span class="w"></span>
</code></pre></div>



<a name="246259438"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/187312-wg-async-foundations/topic/%E2%9C%94%20%22async%20for%20_%20in%20Stream%22%3F/near/246259438" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Ibraheem Ahmed <a href="https://rust-lang.github.io/zulip_archive/stream/187312-wg-async-foundations/topic/.E2.9C.94.20.22async.20for.20_.20in.20Stream.22.3F.html#246259438">(Jul 16 2021 at 18:11)</a>:</h4>
<p>(Also, it's not an rfc itself, it's an unresolved question from the async/await rfc)</p>



<a name="246259467"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/187312-wg-async-foundations/topic/%E2%9C%94%20%22async%20for%20_%20in%20Stream%22%3F/near/246259467" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Ibraheem Ahmed <a href="https://rust-lang.github.io/zulip_archive/stream/187312-wg-async-foundations/topic/.E2.9C.94.20.22async.20for.20_.20in.20Stream.22.3F.html#246259467">(Jul 16 2021 at 18:11)</a>:</h4>
<p>Now that the stream rfc has been merged, I think this is actionable?</p>



<hr><p>Last updated: Aug 07 2021 at 22:04 UTC</p>
</html>