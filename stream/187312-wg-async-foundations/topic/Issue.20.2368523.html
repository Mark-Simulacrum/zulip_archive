<html>
<head><meta charset="utf-8"><title>Issue #68523 · wg-async-foundations · Zulip Chat Archive</title></head>
<h2>Stream: <a href="https://rust-lang.github.io/zulip_archive/stream/187312-wg-async-foundations/index.html">wg-async-foundations</a></h2>
<h3>Topic: <a href="https://rust-lang.github.io/zulip_archive/stream/187312-wg-async-foundations/topic/Issue.20.2368523.html">Issue #68523</a></h3>

<hr>

<base href="https://rust-lang.zulipchat.com">

<head><link href="https://rust-lang.github.io/zulip_archive/style.css" rel="stylesheet"></head>

<a name="193459190"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/187312-wg-async-foundations/topic/Issue%20%2368523/near/193459190" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sebastian Malton <a href="https://rust-lang.github.io/zulip_archive/stream/187312-wg-async-foundations/topic/Issue.20.2368523.html#193459190">(Apr 09 2020 at 14:40)</a>:</h4>
<p>Hello, I have been trying to make the changes to <code>hir::IsAsync</code> but I get a test failure for the "rustdoc/inline_cross/impl_trait.rs" test.</p>
<p>I have made the type be:</p>
<div class="codehilite"><pre><span></span><span class="k">struct</span> <span class="nc">IsAsync</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="n">Yes</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="n">span</span>: <span class="nc">Span</span><span class="w"> </span><span class="p">},</span><span class="w"></span>
<span class="w">    </span><span class="n">No</span><span class="p">,</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>
</pre></div>


<p>and the output from the test is as follows:</p>
<div class="codehilite"><pre><span></span>---- [rustdoc] rustdoc/inline_cross/impl_trait.rs stdout ----

error: rustdoc failed!
status: exit code: 1
command: &quot;/Users/sebastianmalton/repos/rust/build/x86_64-apple-darwin/stage2/bin/rustdoc&quot; &quot;-L&quot; &quot;/Users/sebastianmalton/repos/rust/build/x86_64-apple-darwin/stage2/lib/rustlib/x86_64-apple-darwin/lib&quot; &quot;-L&quot; &quot;/Users/sebastianmalton/repos/rust/build/x86_64-apple-darwin/test/rustdoc/inline_cross/impl_trait/auxiliary&quot; &quot;-o&quot; &quot;/Users/sebastianmalton/repos/rust/build/x86_64-apple-darwin/test/rustdoc/inline_cross/impl_trait&quot; &quot;/Users/sebastianmalton/repos/rust/src/test/rustdoc/inline_cross/impl_trait.rs&quot; &quot;--edition=2018&quot;
stdout:
------------------------------------------

------------------------------------------
stderr:
------------------------------------------
error: internal compiler error: src/librustc_metadata/rmeta/decoder.rs:398: Cannot decode Span without Session.

thread &#39;rustc&#39; panicked at &#39;Box&lt;Any&gt;&#39;, src/librustc_errors/lib.rs:880:9
note: run with `RUST_BACKTRACE=1` environment variable to display a backtrace
error: aborting due to previous error


------------------------------------------
</pre></div>



<a name="193459450"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/187312-wg-async-foundations/topic/Issue%20%2368523/near/193459450" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> centril <a href="https://rust-lang.github.io/zulip_archive/stream/187312-wg-async-foundations/topic/Issue.20.2368523.html#193459450">(Apr 09 2020 at 14:42)</a>:</h4>
<p><span class="user-mention" data-user-id="247082">@Sebastian Malton</span>  might help you perhaps: <a href="https://github.com/rust-lang/rust/pull/66364#discussion_r345741153" title="https://github.com/rust-lang/rust/pull/66364#discussion_r345741153">https://github.com/rust-lang/rust/pull/66364#discussion_r345741153</a></p>



<a name="193460016"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/187312-wg-async-foundations/topic/Issue%20%2368523/near/193460016" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sebastian Malton <a href="https://rust-lang.github.io/zulip_archive/stream/187312-wg-async-foundations/topic/Issue.20.2368523.html#193460016">(Apr 09 2020 at 14:46)</a>:</h4>
<p>Thanks I'll look into that</p>



<a name="193510430"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/187312-wg-async-foundations/topic/Issue%20%2368523/near/193510430" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sebastian Malton <a href="https://rust-lang.github.io/zulip_archive/stream/187312-wg-async-foundations/topic/Issue.20.2368523.html#193510430">(Apr 09 2020 at 21:17)</a>:</h4>
<p>I have what was mentioned in that comment but to no avail. My code is here: <a href="https://github.com/Nokel81/rust/tree/fix-async-main-error" title="https://github.com/Nokel81/rust/tree/fix-async-main-error">https://github.com/Nokel81/rust/tree/fix-async-main-error</a> if you have time to help, it would be greatly appreciated. I don't understand how adding the span to <code>hir::IsAsync</code> would cause the <code>Session</code> to be needed in some other place besides when decoding async.</p>



<a name="193928165"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/187312-wg-async-foundations/topic/Issue%20%2368523/near/193928165" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://rust-lang.github.io/zulip_archive/stream/187312-wg-async-foundations/topic/Issue.20.2368523.html#193928165">(Apr 14 2020 at 17:07)</a>:</h4>
<p><span class="user-mention" data-user-id="247082">@Sebastian Malton</span> hmm I can try to clone your branch locally</p>



<a name="193929635"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/187312-wg-async-foundations/topic/Issue%20%2368523/near/193929635" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sebastian Malton <a href="https://rust-lang.github.io/zulip_archive/stream/187312-wg-async-foundations/topic/Issue.20.2368523.html#193929635">(Apr 14 2020 at 17:18)</a>:</h4>
<p><span class="user-mention silent" data-user-id="116009">nikomatsakis</span> <a href="#narrow/stream/187312-wg-async-foundations/topic/Issue.20.2368523/near/193928165" title="#narrow/stream/187312-wg-async-foundations/topic/Issue.20.2368523/near/193928165">said</a>:</p>
<blockquote>
<p><span class="user-mention silent" data-user-id="247082">Sebastian Malton</span> hmm I can try to clone your branch locally</p>
</blockquote>
<p>Thank you very much. I really don't know enough about the compiler to progress by myself.</p>



<a name="193932767"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/187312-wg-async-foundations/topic/Issue%20%2368523/near/193932767" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://rust-lang.github.io/zulip_archive/stream/187312-wg-async-foundations/topic/Issue.20.2368523.html#193932767">(Apr 14 2020 at 17:42)</a>:</h4>
<p><span class="user-mention" data-user-id="247082">@Sebastian Malton</span> when did you get that error?</p>



<a name="193932803"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/187312-wg-async-foundations/topic/Issue%20%2368523/near/193932803" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://rust-lang.github.io/zulip_archive/stream/187312-wg-async-foundations/topic/Issue.20.2368523.html#193932803">(Apr 14 2020 at 17:42)</a>:</h4>
<p>was it bootstrapping, or running tests?</p>



<a name="193932840"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/187312-wg-async-foundations/topic/Issue%20%2368523/near/193932840" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://rust-lang.github.io/zulip_archive/stream/187312-wg-async-foundations/topic/Issue.20.2368523.html#193932840">(Apr 14 2020 at 17:43)</a>:</h4>
<p>I didn't get it bootstrapping, at least</p>



<a name="193934946"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/187312-wg-async-foundations/topic/Issue%20%2368523/near/193934946" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://rust-lang.github.io/zulip_archive/stream/187312-wg-async-foundations/topic/Issue.20.2368523.html#193934946">(Apr 14 2020 at 17:59)</a>:</h4>
<p>ok, I'm seeing it when running some tests</p>



<a name="193936135"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/187312-wg-async-foundations/topic/Issue%20%2368523/near/193936135" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://rust-lang.github.io/zulip_archive/stream/187312-wg-async-foundations/topic/Issue.20.2368523.html#193936135">(Apr 14 2020 at 18:08)</a>:</h4>
<p><span class="user-mention" data-user-id="119009">@eddyb</span> since apparently you helped <span class="user-mention silent" data-user-id="126931">centril</span> earlier, do you have some suggestions regarding the problem that <span class="user-mention" data-user-id="247082">@Sebastian Malton</span> is seeing... they added some <code>Span</code> info into a HIR data structure that gets serialized, but we're getting panics in metadata deserialization.</p>



<a name="193936144"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/187312-wg-async-foundations/topic/Issue%20%2368523/near/193936144" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://rust-lang.github.io/zulip_archive/stream/187312-wg-async-foundations/topic/Issue.20.2368523.html#193936144">(Apr 14 2020 at 18:08)</a>:</h4>
<p>I figure I should ping you before I dig too much more deeply to understand the problem</p>



<a name="193936192"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/187312-wg-async-foundations/topic/Issue%20%2368523/near/193936192" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> eddyb <a href="https://rust-lang.github.io/zulip_archive/stream/187312-wg-async-foundations/topic/Issue.20.2368523.html#193936192">(Apr 14 2020 at 18:09)</a>:</h4>
<p>what do you mean, HIR is never serialized</p>



<a name="193936195"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/187312-wg-async-foundations/topic/Issue%20%2368523/near/193936195" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://rust-lang.github.io/zulip_archive/stream/187312-wg-async-foundations/topic/Issue.20.2368523.html#193936195">(Apr 14 2020 at 18:09)</a>:</h4>
<p>they tried <a href="https://github.com/Nokel81/rust/commit/56f51e622d864fe078cfec4514cea6624cbd00cd" title="https://github.com/Nokel81/rust/commit/56f51e622d864fe078cfec4514cea6624cbd00cd">this code here</a>, that creates a tuple with session</p>



<a name="193936206"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/187312-wg-async-foundations/topic/Issue%20%2368523/near/193936206" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://rust-lang.github.io/zulip_archive/stream/187312-wg-async-foundations/topic/Issue.20.2368523.html#193936206">(Apr 14 2020 at 18:09)</a>:</h4>
<p>well, it's the <code>hir::IsAsync</code> enum</p>



<a name="193936234"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/187312-wg-async-foundations/topic/Issue%20%2368523/near/193936234" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> eddyb <a href="https://rust-lang.github.io/zulip_archive/stream/187312-wg-async-foundations/topic/Issue.20.2368523.html#193936234">(Apr 14 2020 at 18:09)</a>:</h4>
<p>ah we tend to avoid stuff like that</p>



<a name="193936251"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/187312-wg-async-foundations/topic/Issue%20%2368523/near/193936251" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> eddyb <a href="https://rust-lang.github.io/zulip_archive/stream/187312-wg-async-foundations/topic/Issue.20.2368523.html#193936251">(Apr 14 2020 at 18:09)</a>:</h4>
<p>but it shouldn't be a problem anyway</p>



<a name="193936340"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/187312-wg-async-foundations/topic/Issue%20%2368523/near/193936340" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://rust-lang.github.io/zulip_archive/stream/187312-wg-async-foundations/topic/Issue.20.2368523.html#193936340">(Apr 14 2020 at 18:10)</a>:</h4>
<p>pre-existing, I suppose</p>



<a name="193936343"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/187312-wg-async-foundations/topic/Issue%20%2368523/near/193936343" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://rust-lang.github.io/zulip_archive/stream/187312-wg-async-foundations/topic/Issue.20.2368523.html#193936343">(Apr 14 2020 at 18:10)</a>:</h4>
<p>you have stuff like</p>



<a name="193936351"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/187312-wg-async-foundations/topic/Issue%20%2368523/near/193936351" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> eddyb <a href="https://rust-lang.github.io/zulip_archive/stream/187312-wg-async-foundations/topic/Issue.20.2368523.html#193936351">(Apr 14 2020 at 18:10)</a>:</h4>
<p>hmm why are there reformat changes in that file, wrong <code>rustfmt</code> version?</p>



<a name="193936354"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/187312-wg-async-foundations/topic/Issue%20%2368523/near/193936354" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://rust-lang.github.io/zulip_archive/stream/187312-wg-async-foundations/topic/Issue.20.2368523.html#193936354">(Apr 14 2020 at 18:10)</a>:</h4>
<div class="codehilite"><pre><span></span><span class="cp">#[derive(RustcEncodable, RustcDecodable)]</span><span class="w"></span>
<span class="k">struct</span> <span class="nc">FnData</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="n">asyncness</span>: <span class="nc">hir</span>::<span class="n">IsAsync</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">constness</span>: <span class="nc">hir</span>::<span class="n">Constness</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">param_names</span>: <span class="nc">Lazy</span><span class="o">&lt;</span><span class="p">[</span><span class="n">ast</span>::<span class="n">Name</span><span class="p">]</span><span class="o">&gt;</span><span class="p">,</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>
</pre></div>



<a name="193936359"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/187312-wg-async-foundations/topic/Issue%20%2368523/near/193936359" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://rust-lang.github.io/zulip_archive/stream/187312-wg-async-foundations/topic/Issue.20.2368523.html#193936359">(Apr 14 2020 at 18:10)</a>:</h4>
<p><span class="user-mention silent" data-user-id="119009">eddyb</span> <a href="#narrow/stream/187312-wg-async-foundations/topic/Issue.20.2368523/near/193936351" title="#narrow/stream/187312-wg-async-foundations/topic/Issue.20.2368523/near/193936351">said</a>:</p>
<blockquote>
<p>hmm why are there reformat changes in that file, wrong <code>rustfmt</code> version?</p>
</blockquote>
<p>yes</p>



<a name="193936363"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/187312-wg-async-foundations/topic/Issue%20%2368523/near/193936363" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> eddyb <a href="https://rust-lang.github.io/zulip_archive/stream/187312-wg-async-foundations/topic/Issue.20.2368523.html#193936363">(Apr 14 2020 at 18:10)</a>:</h4>
<p>(sorry, they're distracting)</p>



<a name="193936364"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/187312-wg-async-foundations/topic/Issue%20%2368523/near/193936364" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://rust-lang.github.io/zulip_archive/stream/187312-wg-async-foundations/topic/Issue.20.2368523.html#193936364">(Apr 14 2020 at 18:10)</a>:</h4>
<p>you can ignore those</p>



<a name="193936368"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/187312-wg-async-foundations/topic/Issue%20%2368523/near/193936368" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://rust-lang.github.io/zulip_archive/stream/187312-wg-async-foundations/topic/Issue.20.2368523.html#193936368">(Apr 14 2020 at 18:10)</a>:</h4>
<p>yeah,I know</p>



<a name="193936378"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/187312-wg-async-foundations/topic/Issue%20%2368523/near/193936378" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://rust-lang.github.io/zulip_archive/stream/187312-wg-async-foundations/topic/Issue.20.2368523.html#193936378">(Apr 14 2020 at 18:10)</a>:</h4>
<p>I have that problem sometimes too</p>



<a name="193936404"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/187312-wg-async-foundations/topic/Issue%20%2368523/near/193936404" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> eddyb <a href="https://rust-lang.github.io/zulip_archive/stream/187312-wg-async-foundations/topic/Issue.20.2368523.html#193936404">(Apr 14 2020 at 18:11)</a>:</h4>
<p>is there anything <em>other</em> than a <code>Span</code> in <code>hir::IsAsync</code>?</p>



<a name="193936412"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/187312-wg-async-foundations/topic/Issue%20%2368523/near/193936412" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://rust-lang.github.io/zulip_archive/stream/187312-wg-async-foundations/topic/Issue.20.2368523.html#193936412">(Apr 14 2020 at 18:11)</a>:</h4>
<p>I didn't quite figure out how this <code>(self, sess)</code> thing works</p>



<a name="193936434"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/187312-wg-async-foundations/topic/Issue%20%2368523/near/193936434" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> eddyb <a href="https://rust-lang.github.io/zulip_archive/stream/187312-wg-async-foundations/topic/Issue.20.2368523.html#193936434">(Apr 14 2020 at 18:11)</a>:</h4>
<p>it implements a trait at the top of the file</p>



<a name="193936443"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/187312-wg-async-foundations/topic/Issue%20%2368523/near/193936443" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://rust-lang.github.io/zulip_archive/stream/187312-wg-async-foundations/topic/Issue.20.2368523.html#193936443">(Apr 14 2020 at 18:11)</a>:</h4>
<div class="codehilite"><pre><span></span><span class="k">pub</span><span class="w"> </span><span class="k">enum</span> <span class="nc">IsAsync</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="n">Async</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="n">span</span>: <span class="nc">Span</span><span class="w"> </span><span class="p">},</span><span class="w"></span>
<span class="w">    </span><span class="n">NotAsync</span><span class="p">,</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>
</pre></div>



<a name="193936453"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/187312-wg-async-foundations/topic/Issue%20%2368523/near/193936453" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> eddyb <a href="https://rust-lang.github.io/zulip_archive/stream/187312-wg-async-foundations/topic/Issue.20.2368523.html#193936453">(Apr 14 2020 at 18:11)</a>:</h4>
<p>that should work</p>



<a name="193936454"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/187312-wg-async-foundations/topic/Issue%20%2368523/near/193936454" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://rust-lang.github.io/zulip_archive/stream/187312-wg-async-foundations/topic/Issue.20.2368523.html#193936454">(Apr 14 2020 at 18:11)</a>:</h4>
<p>the tuple does?</p>



<a name="193936462"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/187312-wg-async-foundations/topic/Issue%20%2368523/near/193936462" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> eddyb <a href="https://rust-lang.github.io/zulip_archive/stream/187312-wg-async-foundations/topic/Issue.20.2368523.html#193936462">(Apr 14 2020 at 18:11)</a>:</h4>
<p>yes</p>



<a name="193936465"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/187312-wg-async-foundations/topic/Issue%20%2368523/near/193936465" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://rust-lang.github.io/zulip_archive/stream/187312-wg-async-foundations/topic/Issue.20.2368523.html#193936465">(Apr 14 2020 at 18:11)</a>:</h4>
<p>I figured it must be <em>somewhere</em></p>



<a name="193936474"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/187312-wg-async-foundations/topic/Issue%20%2368523/near/193936474" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> eddyb <a href="https://rust-lang.github.io/zulip_archive/stream/187312-wg-async-foundations/topic/Issue.20.2368523.html#193936474">(Apr 14 2020 at 18:11)</a>:</h4>
<p>it's all self-contained in that file</p>



<a name="193936486"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/187312-wg-async-foundations/topic/Issue%20%2368523/near/193936486" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://rust-lang.github.io/zulip_archive/stream/187312-wg-async-foundations/topic/Issue.20.2368523.html#193936486">(Apr 14 2020 at 18:12)</a>:</h4>
<p>ok, I see it now</p>



<a name="193936487"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/187312-wg-async-foundations/topic/Issue%20%2368523/near/193936487" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> eddyb <a href="https://rust-lang.github.io/zulip_archive/stream/187312-wg-async-foundations/topic/Issue.20.2368523.html#193936487">(Apr 14 2020 at 18:12)</a>:</h4>
<p>same for the encoding side</p>



<a name="193936541"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/187312-wg-async-foundations/topic/Issue%20%2368523/near/193936541" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> eddyb <a href="https://rust-lang.github.io/zulip_archive/stream/187312-wg-async-foundations/topic/Issue.20.2368523.html#193936541">(Apr 14 2020 at 18:12)</a>:</h4>
<p>oh I know</p>



<a name="193936555"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/187312-wg-async-foundations/topic/Issue%20%2368523/near/193936555" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://rust-lang.github.io/zulip_archive/stream/187312-wg-async-foundations/topic/Issue.20.2368523.html#193936555">(Apr 14 2020 at 18:12)</a>:</h4>
<p>yes, I'm starting to see how it's put together now</p>



<a name="193936558"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/187312-wg-async-foundations/topic/Issue%20%2368523/near/193936558" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://rust-lang.github.io/zulip_archive/stream/187312-wg-async-foundations/topic/Issue.20.2368523.html#193936558">(Apr 14 2020 at 18:12)</a>:</h4>
<p>ok</p>



<a name="193936562"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/187312-wg-async-foundations/topic/Issue%20%2368523/near/193936562" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> eddyb <a href="https://rust-lang.github.io/zulip_archive/stream/187312-wg-async-foundations/topic/Issue.20.2368523.html#193936562">(Apr 14 2020 at 18:12)</a>:</h4>
<p>it's not panicking in <code>asyncness</code></p>



<a name="193936577"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/187312-wg-async-foundations/topic/Issue%20%2368523/near/193936577" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> eddyb <a href="https://rust-lang.github.io/zulip_archive/stream/187312-wg-async-foundations/topic/Issue.20.2368523.html#193936577">(Apr 14 2020 at 18:12)</a>:</h4>
<p>or at least, this is the simplest explanation</p>



<a name="193936598"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/187312-wg-async-foundations/topic/Issue%20%2368523/near/193936598" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://rust-lang.github.io/zulip_archive/stream/187312-wg-async-foundations/topic/Issue.20.2368523.html#193936598">(Apr 14 2020 at 18:12)</a>:</h4>
<p>seems plausible</p>



<a name="193936606"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/187312-wg-async-foundations/topic/Issue%20%2368523/near/193936606" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://rust-lang.github.io/zulip_archive/stream/187312-wg-async-foundations/topic/Issue.20.2368523.html#193936606">(Apr 14 2020 at 18:12)</a>:</h4>
<p>I'll dig a bit deeper</p>



<a name="193936608"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/187312-wg-async-foundations/topic/Issue%20%2368523/near/193936608" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> eddyb <a href="https://rust-lang.github.io/zulip_archive/stream/187312-wg-async-foundations/topic/Issue.20.2368523.html#193936608">(Apr 14 2020 at 18:12)</a>:</h4>
<p>there are probably a dozen places where <code>FnData</code> is decoded</p>



<a name="193936613"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/187312-wg-async-foundations/topic/Issue%20%2368523/near/193936613" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://rust-lang.github.io/zulip_archive/stream/187312-wg-async-foundations/topic/Issue.20.2368523.html#193936613">(Apr 14 2020 at 18:12)</a>:</h4>
<p>ah ok ok</p>



<a name="193936618"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/187312-wg-async-foundations/topic/Issue%20%2368523/near/193936618" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> eddyb <a href="https://rust-lang.github.io/zulip_archive/stream/187312-wg-async-foundations/topic/Issue.20.2368523.html#193936618">(Apr 14 2020 at 18:12)</a>:</h4>
<p><em>all</em> of them need the session now</p>



<a name="193936634"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/187312-wg-async-foundations/topic/Issue%20%2368523/near/193936634" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://rust-lang.github.io/zulip_archive/stream/187312-wg-async-foundations/topic/Issue.20.2368523.html#193936634">(Apr 14 2020 at 18:13)</a>:</h4>
<p>yes, duh, that makes sense</p>



<a name="193936638"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/187312-wg-async-foundations/topic/Issue%20%2368523/near/193936638" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> eddyb <a href="https://rust-lang.github.io/zulip_archive/stream/187312-wg-async-foundations/topic/Issue.20.2368523.html#193936638">(Apr 14 2020 at 18:13)</a>:</h4>
<p>unless you wrap <code>IsAsync</code> in <code>Lazy</code> :P</p>



<a name="193936691"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/187312-wg-async-foundations/topic/Issue%20%2368523/near/193936691" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://rust-lang.github.io/zulip_archive/stream/187312-wg-async-foundations/topic/Issue.20.2368523.html#193936691">(Apr 14 2020 at 18:13)</a>:</h4>
<p>I guess had I even bothered to run with <code>RUST_BACKTRACE=1</code> I'd have seen that :)</p>



<a name="193936694"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/187312-wg-async-foundations/topic/Issue%20%2368523/near/193936694" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://rust-lang.github.io/zulip_archive/stream/187312-wg-async-foundations/topic/Issue.20.2368523.html#193936694">(Apr 14 2020 at 18:13)</a>:</h4>
<p>/me truly lazy</p>



<a name="193936735"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/187312-wg-async-foundations/topic/Issue%20%2368523/near/193936735" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://rust-lang.github.io/zulip_archive/stream/187312-wg-async-foundations/topic/Issue.20.2368523.html#193936735">(Apr 14 2020 at 18:14)</a>:</h4>
<p>but yeah indeed</p>
<div class="codehilite"><pre><span></span>  16: &lt;rustc_metadata::rmeta::FnData as serialize::serialize::Decodable&gt;::decode
  17: rustc_metadata::rmeta::decoder::&lt;impl rustc_metadata::creader::CrateMetadataRef&gt;::is_const_fn_raw
  18: rustc_metadata::rmeta::decoder::cstore_impl::provide_extern::is_const_fn_raw
</pre></div>



<a name="193936844"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/187312-wg-async-foundations/topic/Issue%20%2368523/near/193936844" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://rust-lang.github.io/zulip_archive/stream/187312-wg-async-foundations/topic/Issue.20.2368523.html#193936844">(Apr 14 2020 at 18:14)</a>:</h4>
<p>So, <span class="user-mention" data-user-id="247082">@Sebastian Malton</span>, did you follow that? You need to add <code>(self, span)</code> to the various places that <code>FnData</code> is decoded</p>



<a name="193936875"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/187312-wg-async-foundations/topic/Issue%20%2368523/near/193936875" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> eddyb <a href="https://rust-lang.github.io/zulip_archive/stream/187312-wg-async-foundations/topic/Issue.20.2368523.html#193936875">(Apr 14 2020 at 18:14)</a>:</h4>
<p><code>(self, sess)</code> :P</p>



<a name="193936896"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/187312-wg-async-foundations/topic/Issue%20%2368523/near/193936896" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://rust-lang.github.io/zulip_archive/stream/187312-wg-async-foundations/topic/Issue.20.2368523.html#193936896">(Apr 14 2020 at 18:15)</a>:</h4>
<p>er right</p>



<a name="193936912"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/187312-wg-async-foundations/topic/Issue%20%2368523/near/193936912" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> eddyb <a href="https://rust-lang.github.io/zulip_archive/stream/187312-wg-async-foundations/topic/Issue.20.2368523.html#193936912">(Apr 14 2020 at 18:15)</a>:</h4>
<p>or we can use this moment to start doing the right thing</p>



<a name="193936926"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/187312-wg-async-foundations/topic/Issue%20%2368523/near/193936926" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> eddyb <a href="https://rust-lang.github.io/zulip_archive/stream/187312-wg-async-foundations/topic/Issue.20.2368523.html#193936926">(Apr 14 2020 at 18:15)</a>:</h4>
<p>which is to add another table instead of changing <code>FnData</code> :P</p>



<a name="193936945"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/187312-wg-async-foundations/topic/Issue%20%2368523/near/193936945" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> eddyb <a href="https://rust-lang.github.io/zulip_archive/stream/187312-wg-async-foundations/topic/Issue.20.2368523.html#193936945">(Apr 14 2020 at 18:15)</a>:</h4>
<p>but it might be expensive, size-wise</p>



<a name="193936976"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/187312-wg-async-foundations/topic/Issue%20%2368523/near/193936976" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://rust-lang.github.io/zulip_archive/stream/187312-wg-async-foundations/topic/Issue.20.2368523.html#193936976">(Apr 14 2020 at 18:15)</a>:</h4>
<p>add another table?</p>



<a name="193936980"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/187312-wg-async-foundations/topic/Issue%20%2368523/near/193936980" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> eddyb <a href="https://rust-lang.github.io/zulip_archive/stream/187312-wg-async-foundations/topic/Issue.20.2368523.html#193936980">(Apr 14 2020 at 18:15)</a>:</h4>
<p>since we don't have a sparse format yet (mw had some ideas)</p>



<a name="193936983"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/187312-wg-async-foundations/topic/Issue%20%2368523/near/193936983" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://rust-lang.github.io/zulip_archive/stream/187312-wg-async-foundations/topic/Issue.20.2368523.html#193936983">(Apr 14 2020 at 18:16)</a>:</h4>
<p>into the metadata, you mean?</p>



<a name="193937031"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/187312-wg-async-foundations/topic/Issue%20%2368523/near/193937031" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://rust-lang.github.io/zulip_archive/stream/187312-wg-async-foundations/topic/Issue.20.2368523.html#193937031">(Apr 14 2020 at 18:16)</a>:</h4>
<p>/me a bit confused</p>



<a name="193937034"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/187312-wg-async-foundations/topic/Issue%20%2368523/near/193937034" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> eddyb <a href="https://rust-lang.github.io/zulip_archive/stream/187312-wg-async-foundations/topic/Issue.20.2368523.html#193937034">(Apr 14 2020 at 18:16)</a>:</h4>
<p>this <code>FnData</code> is in one of the tables</p>



<a name="193937051"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/187312-wg-async-foundations/topic/Issue%20%2368523/near/193937051" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> eddyb <a href="https://rust-lang.github.io/zulip_archive/stream/187312-wg-async-foundations/topic/Issue.20.2368523.html#193937051">(Apr 14 2020 at 18:16)</a>:</h4>
<p>'sec, grabbing the source</p>



<a name="193937104"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/187312-wg-async-foundations/topic/Issue%20%2368523/near/193937104" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> eddyb <a href="https://rust-lang.github.io/zulip_archive/stream/187312-wg-async-foundations/topic/Issue.20.2368523.html#193937104">(Apr 14 2020 at 18:16)</a>:</h4>
<p><span class="user-mention" data-user-id="116009">@nikomatsakis</span> <a href="https://github.com/rust-lang/rust/blob/master/src/librustc_metadata/rmeta/mod.rs#L254-L280" title="https://github.com/rust-lang/rust/blob/master/src/librustc_metadata/rmeta/mod.rs#L254-L280">https://github.com/rust-lang/rust/blob/master/src/librustc_metadata/rmeta/mod.rs#L254-L280</a></p>



<a name="193937138"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/187312-wg-async-foundations/topic/Issue%20%2368523/near/193937138" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> eddyb <a href="https://rust-lang.github.io/zulip_archive/stream/187312-wg-async-foundations/topic/Issue.20.2368523.html#193937138">(Apr 14 2020 at 18:17)</a>:</h4>
<p><code>FnData</code> is nested in variants of <code>EntryKind</code>, in the first table</p>



<a name="193937376"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/187312-wg-async-foundations/topic/Issue%20%2368523/near/193937376" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> eddyb <a href="https://rust-lang.github.io/zulip_archive/stream/187312-wg-async-foundations/topic/Issue.20.2368523.html#193937376">(Apr 14 2020 at 18:19)</a>:</h4>
<p>it's easy to add another table, just throw it in there. it's free if no defs in the crate insert in it, but it might be extra space wasting for some crates, idk</p>



<a name="193937407"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/187312-wg-async-foundations/topic/Issue%20%2368523/near/193937407" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> eddyb <a href="https://rust-lang.github.io/zulip_archive/stream/187312-wg-async-foundations/topic/Issue.20.2368523.html#193937407">(Apr 14 2020 at 18:19)</a>:</h4>
<p>anyway if you just want to land something, throwing it into <code>FnData</code> is alright</p>



<a name="193941224"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/187312-wg-async-foundations/topic/Issue%20%2368523/near/193941224" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sebastian Malton <a href="https://rust-lang.github.io/zulip_archive/stream/187312-wg-async-foundations/topic/Issue.20.2368523.html#193941224">(Apr 14 2020 at 18:50)</a>:</h4>
<p>Yes I follow, thank you for all the help. Both of you</p>



<a name="194052007"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/187312-wg-async-foundations/topic/Issue%20%2368523/near/194052007" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sebastian Malton <a href="https://rust-lang.github.io/zulip_archive/stream/187312-wg-async-foundations/topic/Issue.20.2368523.html#194052007">(Apr 15 2020 at 15:53)</a>:</h4>
<p><span class="user-mention" data-user-id="119009">@eddyb</span> Would I be able to get a couple of file paths for where I should start looking for the type checking of <code>fn main</code>?</p>



<a name="194056672"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/187312-wg-async-foundations/topic/Issue%20%2368523/near/194056672" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> eddyb <a href="https://rust-lang.github.io/zulip_archive/stream/187312-wg-async-foundations/topic/Issue.20.2368523.html#194056672">(Apr 15 2020 at 16:27)</a>:</h4>
<p><span class="user-mention" data-user-id="247082">@Sebastian Malton</span> presumably somewhere near the top of <code>rustc_typeck</code></p>



<a name="194056700"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/187312-wg-async-foundations/topic/Issue%20%2368523/near/194056700" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> eddyb <a href="https://rust-lang.github.io/zulip_archive/stream/187312-wg-async-foundations/topic/Issue.20.2368523.html#194056700">(Apr 15 2020 at 16:27)</a>:</h4>
<p>assuming you mean how it allows <code>-&gt; SomeTypeThatImplementsATrait</code></p>



<a name="194056819"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/187312-wg-async-foundations/topic/Issue%20%2368523/near/194056819" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> eddyb <a href="https://rust-lang.github.io/zulip_archive/stream/187312-wg-async-foundations/topic/Issue.20.2368523.html#194056819">(Apr 15 2020 at 16:28)</a>:</h4>
<p><span class="user-mention" data-user-id="247082">@Sebastian Malton</span> <a href="https://github.com/rust-lang/rust/blob/master/src/librustc_typeck/lib.rs#L155" title="https://github.com/rust-lang/rust/blob/master/src/librustc_typeck/lib.rs#L155">https://github.com/rust-lang/rust/blob/master/src/librustc_typeck/lib.rs#L155</a></p>



<a name="194056853"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/187312-wg-async-foundations/topic/Issue%20%2368523/near/194056853" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sebastian Malton <a href="https://rust-lang.github.io/zulip_archive/stream/187312-wg-async-foundations/topic/Issue.20.2368523.html#194056853">(Apr 15 2020 at 16:28)</a>:</h4>
<p>Okay thanks, I'll start there. Yeah, I have found the definition of <code>Termination</code> but I was having trouble finding where the code that checked that the return type of main implemented <code>Termination</code></p>



<a name="194060980"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/187312-wg-async-foundations/topic/Issue%20%2368523/near/194060980" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sebastian Malton <a href="https://rust-lang.github.io/zulip_archive/stream/187312-wg-async-foundations/topic/Issue.20.2368523.html#194060980">(Apr 15 2020 at 16:59)</a>:</h4>
<p>I guess a simple question. Should we suppress the error would not implementing <code>Termination</code> as well as adding an error about not allowing to be <code>async</code> or just have both?</p>



<a name="194062184"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/187312-wg-async-foundations/topic/Issue%20%2368523/near/194062184" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sebastian Malton <a href="https://rust-lang.github.io/zulip_archive/stream/187312-wg-async-foundations/topic/Issue.20.2368523.html#194062184">(Apr 15 2020 at 17:09)</a>:</h4>
<p>Also, should the error also be emitted for <code>Start</code> functions, and not just for main?</p>



<a name="194205686"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/187312-wg-async-foundations/topic/Issue%20%2368523/near/194205686" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sebastian Malton <a href="https://rust-lang.github.io/zulip_archive/stream/187312-wg-async-foundations/topic/Issue.20.2368523.html#194205686">(Apr 15 2020 at 18:11)</a>:</h4>
<p>I have put up a PR <a href="https://github.com/rust-lang/rust/pull/71174" title="https://github.com/rust-lang/rust/pull/71174">https://github.com/rust-lang/rust/pull/71174</a></p>



<hr><p>Last updated: Aug 07 2021 at 22:04 UTC</p>
</html>