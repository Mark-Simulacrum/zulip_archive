<html>
<head><meta charset="utf-8"><title>perf down · t-compiler/performance · Zulip Chat Archive</title></head>
<h2>Stream: <a href="https://zulip-archive.rust-lang.org/stream/247081-t-compiler/performance/index.html">t-compiler/performance</a></h2>
<h3>Topic: <a href="https://zulip-archive.rust-lang.org/stream/247081-t-compiler/performance/topic/perf.20down.html">perf down</a></h3>

<hr>

<base href="https://rust-lang.zulipchat.com">

<head><link href="https://zulip-archive.rust-lang.org/style.css" rel="stylesheet"></head>

<a name="249095443"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/247081-t-compiler/performance/topic/perf%20down/near/249095443" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> rylev <a href="https://zulip-archive.rust-lang.org/stream/247081-t-compiler/performance/topic/perf.20down.html#249095443">(Aug 11 2021 at 11:40)</a>:</h4>
<p><span class="user-mention" data-user-id="116122">@simulacrum</span> perf seems to be down. I imagine it's due to the change I just merged (<a href="https://github.com/rust-lang/rustc-perf/pull/957">https://github.com/rust-lang/rustc-perf/pull/957</a>). Is there some way to see logs? I can revert the PR, and see if it fixes the issue.</p>



<a name="249095474"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/247081-t-compiler/performance/topic/perf%20down/near/249095474" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> simulacrum <a href="https://zulip-archive.rust-lang.org/stream/247081-t-compiler/performance/topic/perf.20down.html#249095474">(Aug 11 2021 at 11:41)</a>:</h4>
<p>Logs are not currently easy to share access to others (I can look personally but not right this minute)</p>



<a name="249095487"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/247081-t-compiler/performance/topic/perf%20down/near/249095487" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> rylev <a href="https://zulip-archive.rust-lang.org/stream/247081-t-compiler/performance/topic/perf.20down.html#249095487">(Aug 11 2021 at 11:41)</a>:</h4>
<p>Ok I'll revert</p>



<a name="249095636"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/247081-t-compiler/performance/topic/perf%20down/near/249095636" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> simulacrum <a href="https://zulip-archive.rust-lang.org/stream/247081-t-compiler/performance/topic/perf.20down.html#249095636">(Aug 11 2021 at 11:43)</a>:</h4>
<p>I'll take a look later and see if there's something helpful I can post on the PR with or so</p>



<a name="249095861"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/247081-t-compiler/performance/topic/perf%20down/near/249095861" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> rylev <a href="https://zulip-archive.rust-lang.org/stream/247081-t-compiler/performance/topic/perf.20down.html#249095861">(Aug 11 2021 at 11:46)</a>:</h4>
<p>I wonder if it's the postgres prepared statement. I need to set up postgres on my machine to allow testing of that locally.</p>



<a name="249096301"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/247081-t-compiler/performance/topic/perf%20down/near/249096301" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> simulacrum <a href="https://zulip-archive.rust-lang.org/stream/247081-t-compiler/performance/topic/perf.20down.html#249096301">(Aug 11 2021 at 11:52)</a>:</h4>
<p>We should get a dummy database or something for CI, probably, both postgres and SQLite</p>



<a name="249096322"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/247081-t-compiler/performance/topic/perf%20down/near/249096322" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> simulacrum <a href="https://zulip-archive.rust-lang.org/stream/247081-t-compiler/performance/topic/perf.20down.html#249096322">(Aug 11 2021 at 11:52)</a>:</h4>
<p>(even entirely empty would already check a lot)</p>



<a name="249096369"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/247081-t-compiler/performance/topic/perf%20down/near/249096369" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> rylev <a href="https://zulip-archive.rust-lang.org/stream/247081-t-compiler/performance/topic/perf.20down.html#249096369">(Aug 11 2021 at 11:53)</a>:</h4>
<p>It also would be good to know when the site has been re-deployed. I'm now wondering if the revert has been deployed and it didn't fix anything or if I just need to be patient.</p>



<a name="249096447"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/247081-t-compiler/performance/topic/perf%20down/near/249096447" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> simulacrum <a href="https://zulip-archive.rust-lang.org/stream/247081-t-compiler/performance/topic/perf.20down.html#249096447">(Aug 11 2021 at 11:54)</a>:</h4>
<p>Hm CI needs to run and then it should automatically do so in roughly 60 seconds in my experience</p>



<a name="249096630"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/247081-t-compiler/performance/topic/perf%20down/near/249096630" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> rylev <a href="https://zulip-archive.rust-lang.org/stream/247081-t-compiler/performance/topic/perf.20down.html#249096630">(Aug 11 2021 at 11:56)</a>:</h4>
<p>Ok it's back up</p>



<a name="249096658"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/247081-t-compiler/performance/topic/perf%20down/near/249096658" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> simulacrum <a href="https://zulip-archive.rust-lang.org/stream/247081-t-compiler/performance/topic/perf.20down.html#249096658">(Aug 11 2021 at 11:57)</a>:</h4>
<p>looking at logs</p>



<a name="249096754"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/247081-t-compiler/performance/topic/perf%20down/near/249096754" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> simulacrum <a href="https://zulip-archive.rust-lang.org/stream/247081-t-compiler/performance/topic/perf.20down.html#249096754">(Aug 11 2021 at 11:58)</a>:</h4>
<div class="codehilite"><pre><span></span><code>thread &#39;tokio-runtime-worker&#39; panicked at &#39;called `Result::unwrap()` on an `Err` value: Error { kind: Db, cause: Some(DbError { severity: &quot;ERROR&quot;, parsed_severity: Some(Error), code: SqlState(E42601), message: &quot;subquery in FROM must have an alias&quot;, detail: None, hint: Some(&quot;For example, FROM (SELECT ...) [AS] foo.&quot;), position: Some(Original(78)), where_: None, schema: None, table: None, column: None, datatype: None, constraint: None, file: Some(&quot;gram.y&quot;), line: Some(11895), routine: Some(&quot;base_yyparse&quot;) }) }&#39;, database/src/pool/postgres.rs:368:30
</code></pre></div>



<a name="249096779"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/247081-t-compiler/performance/topic/perf%20down/near/249096779" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> simulacrum <a href="https://zulip-archive.rust-lang.org/stream/247081-t-compiler/performance/topic/perf.20down.html#249096779">(Aug 11 2021 at 11:58)</a>:</h4>
<p>yeah looks like a simple problem with postgres</p>



<a name="249119132"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/247081-t-compiler/performance/topic/perf%20down/near/249119132" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pnkfelix <a href="https://zulip-archive.rust-lang.org/stream/247081-t-compiler/performance/topic/perf.20down.html#249119132">(Aug 11 2021 at 14:53)</a>:</h4>
<p>hey <span class="user-mention" data-user-id="116122">@simulacrum</span> and <span class="user-mention" data-user-id="224872">@rylev</span> ,  I’m getting a 504 Gateway timeout when trying to use <code>curl</code> on the API endpoint. Is that potentially related to the outage you noted here?</p>



<a name="249119215"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/247081-t-compiler/performance/topic/perf%20down/near/249119215" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> simulacrum <a href="https://zulip-archive.rust-lang.org/stream/247081-t-compiler/performance/topic/perf.20down.html#249119215">(Aug 11 2021 at 14:54)</a>:</h4>
<p>hm</p>



<a name="249119225"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/247081-t-compiler/performance/topic/perf%20down/near/249119225" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pnkfelix <a href="https://zulip-archive.rust-lang.org/stream/247081-t-compiler/performance/topic/perf.20down.html#249119225">(Aug 11 2021 at 14:54)</a>:</h4>
<p>oh wait, hold end, user error</p>



<a name="249119295"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/247081-t-compiler/performance/topic/perf%20down/near/249119295" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pnkfelix <a href="https://zulip-archive.rust-lang.org/stream/247081-t-compiler/performance/topic/perf.20down.html#249119295">(Aug 11 2021 at 14:54)</a>:</h4>
<p><em>one day</em> I will get shell variable syntax correct on the first try</p>



<a name="249119320"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/247081-t-compiler/performance/topic/perf%20down/near/249119320" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pnkfelix <a href="https://zulip-archive.rust-lang.org/stream/247081-t-compiler/performance/topic/perf.20down.html#249119320">(Aug 11 2021 at 14:54)</a>:</h4>
<p>yeah never mind, its working fine</p>



<a name="249119347"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/247081-t-compiler/performance/topic/perf%20down/near/249119347" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> simulacrum <a href="https://zulip-archive.rust-lang.org/stream/247081-t-compiler/performance/topic/perf.20down.html#249119347">(Aug 11 2021 at 14:55)</a>:</h4>
<p>ok, sounds good :)</p>



<a name="249119409"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/247081-t-compiler/performance/topic/perf%20down/near/249119409" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pnkfelix <a href="https://zulip-archive.rust-lang.org/stream/247081-t-compiler/performance/topic/perf.20down.html#249119409">(Aug 11 2021 at 14:55)</a>:</h4>
<p>though to be fair, this is the command that it responded to with a 504: <code>curl https://perf.rust-lang.org/perf/triage -d {"start": “"}</code></p>



<a name="249119459"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/247081-t-compiler/performance/topic/perf%20down/near/249119459" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pnkfelix <a href="https://zulip-archive.rust-lang.org/stream/247081-t-compiler/performance/topic/perf.20down.html#249119459">(Aug 11 2021 at 14:56)</a>:</h4>
<p>maybe the server should produce a better response for ill-formed input?</p>



<a name="249119510"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/247081-t-compiler/performance/topic/perf%20down/near/249119510" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pnkfelix <a href="https://zulip-archive.rust-lang.org/stream/247081-t-compiler/performance/topic/perf.20down.html#249119510">(Aug 11 2021 at 14:56)</a>:</h4>
<p>I’ll file an issue</p>



<a name="249119538"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/247081-t-compiler/performance/topic/perf%20down/near/249119538" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> simulacrum <a href="https://zulip-archive.rust-lang.org/stream/247081-t-compiler/performance/topic/perf.20down.html#249119538">(Aug 11 2021 at 14:56)</a>:</h4>
<p>Not sure it was ill formed</p>



<a name="249119563"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/247081-t-compiler/performance/topic/perf%20down/near/249119563" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> simulacrum <a href="https://zulip-archive.rust-lang.org/stream/247081-t-compiler/performance/topic/perf.20down.html#249119563">(Aug 11 2021 at 14:56)</a>:</h4>
<p>it's probably a genuine timeout, for trying to gather a triage report for last 30 days</p>



<a name="249120283"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/247081-t-compiler/performance/topic/perf%20down/near/249120283" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pnkfelix <a href="https://zulip-archive.rust-lang.org/stream/247081-t-compiler/performance/topic/perf.20down.html#249120283">(Aug 11 2021 at 15:01)</a>:</h4>
<p>hmm.</p>



<a name="249120330"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/247081-t-compiler/performance/topic/perf%20down/near/249120330" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pnkfelix <a href="https://zulip-archive.rust-lang.org/stream/247081-t-compiler/performance/topic/perf.20down.html#249120330">(Aug 11 2021 at 15:02)</a>:</h4>
<p>filed <a href="https://github.com/rust-lang/rustc-perf/issues/962">rustc-perf#962</a> , maybe I’ll revise title to avoid saying “ill-formed"</p>



<a name="249120442"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/247081-t-compiler/performance/topic/perf%20down/near/249120442" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pnkfelix <a href="https://zulip-archive.rust-lang.org/stream/247081-t-compiler/performance/topic/perf.20down.html#249120442">(Aug 11 2021 at 15:02)</a>:</h4>
<p><span class="user-mention silent" data-user-id="116122">simulacrum</span> <a href="#narrow/stream/247081-t-compiler.2Fperformance/topic/perf.20down/near/249119563">said</a>:</p>
<blockquote>
<p>it's probably a genuine timeout, for trying to gather a triage report for last 30 days</p>
</blockquote>
<p>a 30 day report overloads the service?</p>



<a name="249121468"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/247081-t-compiler/performance/topic/perf%20down/near/249121468" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> rylev <a href="https://zulip-archive.rust-lang.org/stream/247081-t-compiler/performance/topic/perf.20down.html#249121468">(Aug 11 2021 at 15:09)</a>:</h4>
<p>I wouldn't see why it would. I wonder how many comparisons that is.</p>



<a name="249122764"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/247081-t-compiler/performance/topic/perf%20down/near/249122764" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> rylev <a href="https://zulip-archive.rust-lang.org/stream/247081-t-compiler/performance/topic/perf.20down.html#249122764">(Aug 11 2021 at 15:18)</a>:</h4>
<p>Ah indeed, one month of changes is enough to cause a 504</p>



<a name="249574215"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/247081-t-compiler/performance/topic/perf%20down/near/249574215" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> rylev <a href="https://zulip-archive.rust-lang.org/stream/247081-t-compiler/performance/topic/perf.20down.html#249574215">(Aug 16 2021 at 11:01)</a>:</h4>
<p><span class="user-mention" data-user-id="116122">@simulacrum</span> the triage endpoint is returning a 502. Could you look in the logs to see if you see anything?</p>



<a name="249574289"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/247081-t-compiler/performance/topic/perf%20down/near/249574289" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> rylev <a href="https://zulip-archive.rust-lang.org/stream/247081-t-compiler/performance/topic/perf.20down.html#249574289">(Aug 16 2021 at 11:02)</a>:</h4>
<p>Looks like the response is coming from elb though...</p>



<a name="249589708"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/247081-t-compiler/performance/topic/perf%20down/near/249589708" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> simulacrum <a href="https://zulip-archive.rust-lang.org/stream/247081-t-compiler/performance/topic/perf.20down.html#249589708">(Aug 16 2021 at 13:41)</a>:</h4>
<p>Investigating</p>



<a name="249590194"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/247081-t-compiler/performance/topic/perf%20down/near/249590194" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> simulacrum <a href="https://zulip-archive.rust-lang.org/stream/247081-t-compiler/performance/topic/perf.20down.html#249590194">(Aug 16 2021 at 13:45)</a>:</h4>
<p><span class="user-mention" data-user-id="224872">@rylev</span> can you say specifically what commit you were querying for?</p>



<a name="249590578"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/247081-t-compiler/performance/topic/perf%20down/near/249590578" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> simulacrum <a href="https://zulip-archive.rust-lang.org/stream/247081-t-compiler/performance/topic/perf.20down.html#249590578">(Aug 16 2021 at 13:48)</a>:</h4>
<p>seems to be working right now, I think, not completely sure</p>



<a name="249592241"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/247081-t-compiler/performance/topic/perf%20down/near/249592241" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> rylev <a href="https://zulip-archive.rust-lang.org/stream/247081-t-compiler/performance/topic/perf.20down.html#249592241">(Aug 16 2021 at 14:01)</a>:</h4>
<p>curl <a href="https://perf.rust-lang.org/perf/triage">https://perf.rust-lang.org/perf/triage</a> -d '{"start":"<a href="https://github.com/rust-lang/rust/commit/6b20506d17f4e5e5bf5bcad7e94add4d754b0ae3">6b20506d17f4e5e5bf5bcad7e94add4d754b0ae3</a>"}'</p>



<a name="249592293"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/247081-t-compiler/performance/topic/perf%20down/near/249592293" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> rylev <a href="https://zulip-archive.rust-lang.org/stream/247081-t-compiler/performance/topic/perf.20down.html#249592293">(Aug 16 2021 at 14:01)</a>:</h4>
<p>Still seeing a 502 with this query</p>



<a name="249592519"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/247081-t-compiler/performance/topic/perf%20down/near/249592519" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> simulacrum <a href="https://zulip-archive.rust-lang.org/stream/247081-t-compiler/performance/topic/perf.20down.html#249592519">(Aug 16 2021 at 14:03)</a>:</h4>
<p>aha</p>



<a name="249592522"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/247081-t-compiler/performance/topic/perf%20down/near/249592522" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> simulacrum <a href="https://zulip-archive.rust-lang.org/stream/247081-t-compiler/performance/topic/perf.20down.html#249592522">(Aug 16 2021 at 14:03)</a>:</h4>
<p>thread 'tokio-runtime-worker' panicked at 'called <code>Option::unwrap()</code> on a <code>None</code> value', /site/src/comparison.rs:35:10</p>



<a name="249592821"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/247081-t-compiler/performance/topic/perf%20down/near/249592821" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> simulacrum <a href="https://zulip-archive.rust-lang.org/stream/247081-t-compiler/performance/topic/perf.20down.html#249592821">(Aug 16 2021 at 14:05)</a>:</h4>
<p><span class="user-mention" data-user-id="224872">@rylev</span> which seems to jog my memory, so I think this is pre-existing?</p>



<a name="249592830"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/247081-t-compiler/performance/topic/perf%20down/near/249592830" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> simulacrum <a href="https://zulip-archive.rust-lang.org/stream/247081-t-compiler/performance/topic/perf.20down.html#249592830">(Aug 16 2021 at 14:05)</a>:</h4>
<p>(i.e., not recently introduced)</p>



<a name="249593151"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/247081-t-compiler/performance/topic/perf%20down/near/249593151" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> rylev <a href="https://zulip-archive.rust-lang.org/stream/247081-t-compiler/performance/topic/perf.20down.html#249593151">(Aug 16 2021 at 14:08)</a>:</h4>
<p>Ah interesting. That gets triggered where this is no next commit after the "start" commit</p>



<a name="249593208"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/247081-t-compiler/performance/topic/perf%20down/near/249593208" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> rylev <a href="https://zulip-archive.rust-lang.org/stream/247081-t-compiler/performance/topic/perf.20down.html#249593208">(Aug 16 2021 at 14:08)</a>:</h4>
<p>There obviously should be a next commit though...</p>



<a name="249593273"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/247081-t-compiler/performance/topic/perf%20down/near/249593273" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> simulacrum <a href="https://zulip-archive.rust-lang.org/stream/247081-t-compiler/performance/topic/perf.20down.html#249593273">(Aug 16 2021 at 14:09)</a>:</h4>
<p>hm</p>



<a name="249593566"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/247081-t-compiler/performance/topic/perf%20down/near/249593566" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> simulacrum <a href="https://zulip-archive.rust-lang.org/stream/247081-t-compiler/performance/topic/perf.20down.html#249593566">(Aug 16 2021 at 14:11)</a>:</h4>
<p>looks like triagebot may have no record of  <a href="https://github.com/rust-lang/rust/commit/508b328c398b84126011f6fe74d018fe855bc242">508b328c398b84126011f6fe74d018fe855bc242</a>, investigating</p>



<a name="249593672"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/247081-t-compiler/performance/topic/perf%20down/near/249593672" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> simulacrum <a href="https://zulip-archive.rust-lang.org/stream/247081-t-compiler/performance/topic/perf.20down.html#249593672">(Aug 16 2021 at 14:12)</a>:</h4>
<p>my guess is this is due to the github flakiness</p>



<a name="249593722"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/247081-t-compiler/performance/topic/perf%20down/near/249593722" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> simulacrum <a href="https://zulip-archive.rust-lang.org/stream/247081-t-compiler/performance/topic/perf.20down.html#249593722">(Aug 16 2021 at 14:12)</a>:</h4>
<p>manually added <a href="https://github.com/rust-lang/rust/commit/508b328c398b84126011f6fe74d018fe855bc242">https://github.com/rust-lang/rust/commit/508b328c398b84126011f6fe74d018fe855bc242</a> to triagebot's db, checking the next few commits as well</p>



<a name="249593837"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/247081-t-compiler/performance/topic/perf%20down/near/249593837" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> rylev <a href="https://zulip-archive.rust-lang.org/stream/247081-t-compiler/performance/topic/perf.20down.html#249593837">(Aug 16 2021 at 14:13)</a>:</h4>
<p>triage report works now, but it looks indeed like the next commit after 508b is not there</p>



<a name="249593903"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/247081-t-compiler/performance/topic/perf%20down/near/249593903" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> simulacrum <a href="https://zulip-archive.rust-lang.org/stream/247081-t-compiler/performance/topic/perf.20down.html#249593903">(Aug 16 2021 at 14:14)</a>:</h4>
<p>it's benchmarking now - <a href="https://perf.rust-lang.org/status.html">https://perf.rust-lang.org/status.html</a></p>



<a name="249594016"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/247081-t-compiler/performance/topic/perf%20down/near/249594016" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> simulacrum <a href="https://zulip-archive.rust-lang.org/stream/247081-t-compiler/performance/topic/perf.20down.html#249594016">(Aug 16 2021 at 14:15)</a>:</h4>
<p>spot checking more commits since then seems like they're all present</p>



<a name="249594032"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/247081-t-compiler/performance/topic/perf%20down/near/249594032" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> simulacrum <a href="https://zulip-archive.rust-lang.org/stream/247081-t-compiler/performance/topic/perf.20down.html#249594032">(Aug 16 2021 at 14:15)</a>:</h4>
<p>so not sure what happened, but ultimately going to be impractical to find out</p>



<a name="249594173"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/247081-t-compiler/performance/topic/perf%20down/near/249594173" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> rylev <a href="https://zulip-archive.rust-lang.org/stream/247081-t-compiler/performance/topic/perf.20down.html#249594173">(Aug 16 2021 at 14:16)</a>:</h4>
<p>Would it make sense for us to turn panics into 500s with the body the panic message?</p>



<a name="249594188"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/247081-t-compiler/performance/topic/perf%20down/near/249594188" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> rylev <a href="https://zulip-archive.rust-lang.org/stream/247081-t-compiler/performance/topic/perf.20down.html#249594188">(Aug 16 2021 at 14:16)</a>:</h4>
<p>That would at least mean you wouldn't have to look at the logs to figure out what was wrong</p>



<a name="249594288"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/247081-t-compiler/performance/topic/perf%20down/near/249594288" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> simulacrum <a href="https://zulip-archive.rust-lang.org/stream/247081-t-compiler/performance/topic/perf.20down.html#249594288">(Aug 16 2021 at 14:17)</a>:</h4>
<p>generally seems like a good idea</p>



<a name="249594309"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/247081-t-compiler/performance/topic/perf%20down/near/249594309" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> simulacrum <a href="https://zulip-archive.rust-lang.org/stream/247081-t-compiler/performance/topic/perf.20down.html#249594309">(Aug 16 2021 at 14:17)</a>:</h4>
<p>not sure if we can accidentally leak tokens or something somewhere</p>



<a name="249594336"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/247081-t-compiler/performance/topic/perf%20down/near/249594336" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> simulacrum <a href="https://zulip-archive.rust-lang.org/stream/247081-t-compiler/performance/topic/perf.20down.html#249594336">(Aug 16 2021 at 14:17)</a>:</h4>
<p>but seems pretty unlikely</p>



<a name="249594434"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/247081-t-compiler/performance/topic/perf%20down/near/249594434" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> rylev <a href="https://zulip-archive.rust-lang.org/stream/247081-t-compiler/performance/topic/perf.20down.html#249594434">(Aug 16 2021 at 14:18)</a>:</h4>
<p>Yea that's a good point. I guess we could at least figure out the line numbers and return those</p>



<a name="249594798"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/247081-t-compiler/performance/topic/perf%20down/near/249594798" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> simulacrum <a href="https://zulip-archive.rust-lang.org/stream/247081-t-compiler/performance/topic/perf.20down.html#249594798">(Aug 16 2021 at 14:21)</a>:</h4>
<p>yes, that definitely seems good</p>



<a name="249674729"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/247081-t-compiler/performance/topic/perf%20down/near/249674729" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pnkfelix <a href="https://zulip-archive.rust-lang.org/stream/247081-t-compiler/performance/topic/perf.20down.html#249674729">(Aug 17 2021 at 03:18)</a>:</h4>
<p><span class="user-mention silent" data-user-id="116122">simulacrum</span> <a href="#narrow/stream/247081-t-compiler.2Fperformance/topic/perf.20down/near/249594309">said</a>:</p>
<blockquote>
<p>not sure if we can accidentally leak tokens or something somewhere</p>
</blockquote>
<p>Hmm. Maybe we could capture the panic output server-side, scrub it for things that look like tokens (i.e. strings of text with no whitespace) and replace them with <code>&lt;scrubscrubscrubscr…&gt;</code> ?</p>



<a name="251355356"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/247081-t-compiler/performance/topic/perf%20down/near/251355356" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Vadim Petrochenkov <a href="https://zulip-archive.rust-lang.org/stream/247081-t-compiler/performance/topic/perf.20down.html#251355356">(Aug 31 2021 at 09:23)</a>:</h4>
<hr>
<p>New perf-rlo issue: any comparison page fails with "error decoding response body: expected value at line 1 column 1" now.</p>



<a name="251373622"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/247081-t-compiler/performance/topic/perf%20down/near/251373622" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> rylev <a href="https://zulip-archive.rust-lang.org/stream/247081-t-compiler/performance/topic/perf.20down.html#251373622">(Aug 31 2021 at 12:07)</a>:</h4>
<p>I'll take a look at this in a minute</p>



<a name="251384759"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/247081-t-compiler/performance/topic/perf%20down/near/251384759" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> rylev <a href="https://zulip-archive.rust-lang.org/stream/247081-t-compiler/performance/topic/perf.20down.html#251384759">(Aug 31 2021 at 13:31)</a>:</h4>
<p>Looks like getting the list of commits is from bors is not working:<br>
<a href="https://triage.rust-lang.org/bors-commit-list">https://triage.rust-lang.org/bors-commit-list</a><br>
Getting commit data</p>
<p>Caused by:<br>
    connection closed</p>



<a name="251384855"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/247081-t-compiler/performance/topic/perf%20down/near/251384855" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> rylev <a href="https://zulip-archive.rust-lang.org/stream/247081-t-compiler/performance/topic/perf.20down.html#251384855">(Aug 31 2021 at 13:32)</a>:</h4>
<p><span class="user-mention" data-user-id="116122">@simulacrum</span> Do you know why the call to <a href="https://triage.rust-lang.org/bors-commit-list">https://triage.rust-lang.org/bors-commit-list</a> might be failing?</p>



<a name="251385435"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/247081-t-compiler/performance/topic/perf%20down/near/251385435" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> rylev <a href="https://zulip-archive.rust-lang.org/stream/247081-t-compiler/performance/topic/perf.20down.html#251385435">(Aug 31 2021 at 13:35)</a>:</h4>
<p>Here's the function in triage api handler that seems to be failing</p>



<a name="251385443"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/247081-t-compiler/performance/topic/perf%20down/near/251385443" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> rylev <a href="https://zulip-archive.rust-lang.org/stream/247081-t-compiler/performance/topic/perf.20down.html#251385443">(Aug 31 2021 at 13:35)</a>:</h4>
<p><a href="https://github.com/rust-lang/triagebot/blob/606bffb4bbe5e3c5f2e1623d79fdb5ba895debbf/src/db/rustc_commits.rs#L25">https://github.com/rust-lang/triagebot/blob/606bffb4bbe5e3c5f2e1623d79fdb5ba895debbf/src/db/rustc_commits.rs#L25</a></p>



<a name="251385546"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/247081-t-compiler/performance/topic/perf%20down/near/251385546" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> rylev <a href="https://zulip-archive.rust-lang.org/stream/247081-t-compiler/performance/topic/perf.20down.html#251385546">(Aug 31 2021 at 13:35)</a>:</h4>
<p>The error looks like the DB connection is closed for some reason</p>



<a name="251385572"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/247081-t-compiler/performance/topic/perf%20down/near/251385572" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> rylev <a href="https://zulip-archive.rust-lang.org/stream/247081-t-compiler/performance/topic/perf.20down.html#251385572">(Aug 31 2021 at 13:35)</a>:</h4>
<p>Does the connection need to be restarted?</p>



<a name="251386094"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/247081-t-compiler/performance/topic/perf%20down/near/251386094" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> simulacrum <a href="https://zulip-archive.rust-lang.org/stream/247081-t-compiler/performance/topic/perf.20down.html#251386094">(Aug 31 2021 at 13:38)</a>:</h4>
<p>I'll take a look</p>



<a name="251386135"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/247081-t-compiler/performance/topic/perf%20down/near/251386135" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> simulacrum <a href="https://zulip-archive.rust-lang.org/stream/247081-t-compiler/performance/topic/perf.20down.html#251386135">(Aug 31 2021 at 13:38)</a>:</h4>
<p>we should in theory be auto-reconnecting, but triagebot doesn't do that for some reason</p>



<a name="251386158"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/247081-t-compiler/performance/topic/perf%20down/near/251386158" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> simulacrum <a href="https://zulip-archive.rust-lang.org/stream/247081-t-compiler/performance/topic/perf.20down.html#251386158">(Aug 31 2021 at 13:38)</a>:</h4>
<p>I've historically just restarted triagebot</p>



<a name="251387036"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/247081-t-compiler/performance/topic/perf%20down/near/251387036" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> simulacrum <a href="https://zulip-archive.rust-lang.org/stream/247081-t-compiler/performance/topic/perf.20down.html#251387036">(Aug 31 2021 at 13:45)</a>:</h4>
<p>ok, restarted, seems fixed</p>



<a name="251387230"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/247081-t-compiler/performance/topic/perf%20down/near/251387230" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> rylev <a href="https://zulip-archive.rust-lang.org/stream/247081-t-compiler/performance/topic/perf.20down.html#251387230">(Aug 31 2021 at 13:46)</a>:</h4>
<p>Thanks <span class="user-mention" data-user-id="116122">@simulacrum</span> !</p>



<a name="251387369"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/247081-t-compiler/performance/topic/perf%20down/near/251387369" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> rylev <a href="https://zulip-archive.rust-lang.org/stream/247081-t-compiler/performance/topic/perf.20down.html#251387369">(Aug 31 2021 at 13:47)</a>:</h4>
<p>Another example of where we could be better with our error messages. It wasn't too hard to debug, but it would have been nice to know that it was the triage bot API that was failing from the start</p>



<a name="251387617"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/247081-t-compiler/performance/topic/perf%20down/near/251387617" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> simulacrum <a href="https://zulip-archive.rust-lang.org/stream/247081-t-compiler/performance/topic/perf.20down.html#251387617">(Aug 31 2021 at 13:48)</a>:</h4>
<p>Yeah, for sure.</p>



<a name="251392789"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/247081-t-compiler/performance/topic/perf%20down/near/251392789" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> simulacrum <a href="https://zulip-archive.rust-lang.org/stream/247081-t-compiler/performance/topic/perf.20down.html#251392789">(Aug 31 2021 at 14:19)</a>:</h4>
<p><a href="https://github.com/rust-lang/triagebot/pull/1481">https://github.com/rust-lang/triagebot/pull/1481</a> should fix this error for triagebot</p>



<a name="251984365"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/247081-t-compiler/performance/topic/perf%20down/near/251984365" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Vadim Petrochenkov <a href="https://zulip-archive.rust-lang.org/stream/247081-t-compiler/performance/topic/perf.20down.html#251984365">(Sep 04 2021 at 08:32)</a>:</h4>
<hr>
<p>New perf-rlo issue: "Summary: ERROR categorizing benchmark run!", and "could not find start commit for bound" when opening the comparison link.<br>
Examples: <a href="https://github.com/rust-lang/rust/pull/88626">https://github.com/rust-lang/rust/pull/88626</a>, <a href="https://github.com/rust-lang/rust/pull/88627">https://github.com/rust-lang/rust/pull/88627</a></p>



<a name="251997646"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/247081-t-compiler/performance/topic/perf%20down/near/251997646" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> simulacrum <a href="https://zulip-archive.rust-lang.org/stream/247081-t-compiler/performance/topic/perf.20down.html#251997646">(Sep 04 2021 at 12:35)</a>:</h4>
<p>yeah this is <a href="https://github.com/rust-lang/triagebot/issues/1483">https://github.com/rust-lang/triagebot/issues/1483</a>, queued a few commits manually -- <a href="https://perf.rust-lang.org/status.html">https://perf.rust-lang.org/status.html</a></p>



<hr><p>Last updated: Apr 12 2022 at 20:01 UTC</p>
</html>