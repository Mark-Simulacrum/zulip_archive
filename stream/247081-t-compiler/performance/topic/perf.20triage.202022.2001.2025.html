<html>
<head><meta charset="utf-8"><title>perf triage 2022 01 25 · t-compiler/performance · Zulip Chat Archive</title></head>
<h2>Stream: <a href="https://zulip-archive.rust-lang.org/stream/247081-t-compiler/performance/index.html">t-compiler/performance</a></h2>
<h3>Topic: <a href="https://zulip-archive.rust-lang.org/stream/247081-t-compiler/performance/topic/perf.20triage.202022.2001.2025.html">perf triage 2022 01 25</a></h3>

<hr>

<base href="https://rust-lang.zulipchat.com">

<head><link href="https://zulip-archive.rust-lang.org/style.css" rel="stylesheet"></head>

<a name="269349077"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/247081-t-compiler/performance/topic/perf%20triage%202022%2001%2025/near/269349077" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pnkfelix <a href="https://zulip-archive.rust-lang.org/stream/247081-t-compiler/performance/topic/perf.20triage.202022.2001.2025.html#269349077">(Jan 26 2022 at 00:59)</a>:</h4>
<p>late start on this week’s triage. lets see how this goes.</p>



<a name="269362543"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/247081-t-compiler/performance/topic/perf%20triage%202022%2001%2025/near/269362543" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pnkfelix <a href="https://zulip-archive.rust-lang.org/stream/247081-t-compiler/performance/topic/perf.20triage.202022.2001.2025.html#269362543">(Jan 26 2022 at 04:34)</a>:</h4>
<p>So, lets see. I failed to take notes here as I was working</p>



<a name="269362577"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/247081-t-compiler/performance/topic/perf%20triage%202022%2001%2025/near/269362577" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pnkfelix <a href="https://zulip-archive.rust-lang.org/stream/247081-t-compiler/performance/topic/perf.20triage.202022.2001.2025.html#269362577">(Jan 26 2022 at 04:35)</a>:</h4>
<p>For PR <a href="https://github.com/rust-lang/rust/issues/92896">#92896</a>: <span class="user-mention" data-user-id="116113">@lqd</span> wrote guess that regression cause could be noise injected via one of the dependency updates, specifically hashbrown 0.11.0 to 0.11.2.</p>
<ul>
<li>Left it untriaged for now (I would like to circle back and check whether there's any way to check that hypothesis; but if it goes untouched for a week, then we might just rubber-stamp it as triaged).</li>
</ul>



<a name="269362636"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/247081-t-compiler/performance/topic/perf%20triage%202022%2001%2025/near/269362636" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pnkfelix <a href="https://zulip-archive.rust-lang.org/stream/247081-t-compiler/performance/topic/perf.20triage.202022.2001.2025.html#269362636">(Jan 26 2022 at 04:36)</a>:</h4>
<p>PR <a href="https://github.com/rust-lang/rust/issues/93165">#93165</a> (and PR <a href="https://github.com/rust-lang/rust/issues/93138">#93138</a> / PR <a href="https://github.com/rust-lang/rust/issues/91032">#91032</a>) were already discussed in <a class="stream-topic" data-stream-id="247081" href="/#narrow/stream/247081-t-compiler.2Fperformance/topic/next.20perf.20triage">#t-compiler/performance &gt; next perf triage</a> . I did my best to summarize in the report.</p>



<a name="269362644"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/247081-t-compiler/performance/topic/perf%20triage%202022%2001%2025/near/269362644" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pnkfelix <a href="https://zulip-archive.rust-lang.org/stream/247081-t-compiler/performance/topic/perf.20triage.202022.2001.2025.html#269362644">(Jan 26 2022 at 04:37)</a>:</h4>
<p>PR <a href="https://github.com/rust-lang/rust/issues/93014">#93014</a> and PR <a href="https://github.com/rust-lang/rust/issues/93095">#93095</a> were already triaged, which was great.</p>



<a name="269362651"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/247081-t-compiler/performance/topic/perf%20triage%202022%2001%2025/near/269362651" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pnkfelix <a href="https://zulip-archive.rust-lang.org/stream/247081-t-compiler/performance/topic/perf.20triage.202022.2001.2025.html#269362651">(Jan 26 2022 at 04:37)</a>:</h4>
<p>those were the regressions</p>



<a name="269362655"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/247081-t-compiler/performance/topic/perf%20triage%202022%2001%2025/near/269362655" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pnkfelix <a href="https://zulip-archive.rust-lang.org/stream/247081-t-compiler/performance/topic/perf.20triage.202022.2001.2025.html#269362655">(Jan 26 2022 at 04:37)</a>:</h4>
<p>for Improvements</p>



<a name="269362661"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/247081-t-compiler/performance/topic/perf%20triage%202022%2001%2025/near/269362661" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pnkfelix <a href="https://zulip-archive.rust-lang.org/stream/247081-t-compiler/performance/topic/perf.20triage.202022.2001.2025.html#269362661">(Jan 26 2022 at 04:37)</a>:</h4>
<p>PR <a href="https://github.com/rust-lang/rust/issues/92138">#92138</a> hopefully closes the loop on an nearly four-year old hypothesized performance fix, issue <a href="https://github.com/rust-lang/rust/issues/48994">#48994</a>.</p>



<a name="269362715"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/247081-t-compiler/performance/topic/perf%20triage%202022%2001%2025/near/269362715" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pnkfelix <a href="https://zulip-archive.rust-lang.org/stream/247081-t-compiler/performance/topic/perf.20triage.202022.2001.2025.html#269362715">(Jan 26 2022 at 04:38)</a>:</h4>
<p>PR <a href="https://github.com/rust-lang/rust/issues/93066">#93066</a> is simply awesome. Thanks <span class="user-mention" data-user-id="120989">@nnethercote</span>; specifically:</p>
<ul>
<li>Wow. This <a href="https://perf.rust-lang.org/compare.html?start=1e4067957bd5d0e12c1657e720903209ecc291dc&amp;end=84322efad553c7a79c80189f2d1b9197c1aa005f">compare page</a> has an impressive amount of green.</li>
<li>Perhaps even more notably, the bootstrap time had 8 seconds (-1.141%) shaved off via this PR, and from the <a href="https://perf.rust-lang.org/bootstrap.html">bootstrap graph</a>, the bulk of that improvement has stuck.</li>
</ul>



<a name="269362731"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/247081-t-compiler/performance/topic/perf%20triage%202022%2001%2025/near/269362731" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pnkfelix <a href="https://zulip-archive.rust-lang.org/stream/247081-t-compiler/performance/topic/perf.20triage.202022.2001.2025.html#269362731">(Jan 26 2022 at 04:39)</a>:</h4>
<p>PR <a href="https://github.com/rust-lang/rust/issues/90842">#90842</a> was a happy accident, AFAICT</p>



<a name="269362749"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/247081-t-compiler/performance/topic/perf%20triage%202022%2001%2025/near/269362749" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pnkfelix <a href="https://zulip-archive.rust-lang.org/stream/247081-t-compiler/performance/topic/perf.20triage.202022.2001.2025.html#269362749">(Jan 26 2022 at 04:39)</a>:</h4>
<p>Next, for Mixed</p>



<a name="269362762"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/247081-t-compiler/performance/topic/perf%20triage%202022%2001%2025/near/269362762" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pnkfelix <a href="https://zulip-archive.rust-lang.org/stream/247081-t-compiler/performance/topic/perf.20triage.202022.2001.2025.html#269362762">(Jan 26 2022 at 04:39)</a>:</h4>
<p>Already talked about PR <a href="https://github.com/rust-lang/rust/issues/93138">#93138</a></p>



<a name="269362827"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/247081-t-compiler/performance/topic/perf%20triage%202022%2001%2025/near/269362827" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pnkfelix <a href="https://zulip-archive.rust-lang.org/stream/247081-t-compiler/performance/topic/perf.20triage.202022.2001.2025.html#269362827">(Jan 26 2022 at 04:40)</a>:</h4>
<p>For PR <a href="https://github.com/rust-lang/rust/issues/91359">#91359</a>, <span class="user-mention" data-user-id="116122">@simulacrum</span> posted a <a href="https://github.com/rust-lang/rust/pull/91359#issuecomment-1013525074">nice analysis</a> explaining the probable root cause.</p>



<a name="269362836"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/247081-t-compiler/performance/topic/perf%20triage%202022%2001%2025/near/269362836" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pnkfelix <a href="https://zulip-archive.rust-lang.org/stream/247081-t-compiler/performance/topic/perf.20triage.202022.2001.2025.html#269362836">(Jan 26 2022 at 04:40)</a>:</h4>
<ul>
<li>Notably, "with <code>-Csymbol-mangling-version=v0</code> the hashes (changes to which cause LLVM's workload to change) go away; [...] this patch is pretty much an improvement in terms of emitted IR (as roughly expected).”</li>
</ul>



<a name="269362869"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/247081-t-compiler/performance/topic/perf%20triage%202022%2001%2025/near/269362869" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pnkfelix <a href="https://zulip-archive.rust-lang.org/stream/247081-t-compiler/performance/topic/perf.20triage.202022.2001.2025.html#269362869">(Jan 26 2022 at 04:41)</a>:</h4>
<p>For PR <a href="https://github.com/rust-lang/rust/issues/92998">#92998</a>, <span class="user-mention" data-user-id="143274">@Amanieu</span> wrote a plausible explanation: "an overall win but with a bit of noise since this code is extremely sensitive to inlining.” <span class="user-mention" data-user-id="116122">@simulacrum</span> agreed so I’m going with it without looking too deeply. :)</p>



<a name="269362882"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/247081-t-compiler/performance/topic/perf%20triage%202022%2001%2025/near/269362882" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pnkfelix <a href="https://zulip-archive.rust-lang.org/stream/247081-t-compiler/performance/topic/perf.20triage.202022.2001.2025.html#269362882">(Jan 26 2022 at 04:41)</a>:</h4>
<p>and so we get to the last mixed PR, rollup PR <a href="https://github.com/rust-lang/rust/issues/93288">#93288</a></p>



<a name="269362939"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/247081-t-compiler/performance/topic/perf%20triage%202022%2001%2025/near/269362939" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pnkfelix <a href="https://zulip-archive.rust-lang.org/stream/247081-t-compiler/performance/topic/perf.20triage.202022.2001.2025.html#269362939">(Jan 26 2022 at 04:42)</a>:</h4>
<p>Rollup of 8 pull requests <a href="https://github.com/rust-lang/rust/issues/93288">#93288</a></p>
<ul>
<li>Average relevant regression: 1.5%</li>
<li>Average relevant improvement: -0.7%</li>
<li>Largest improvement in <a href="https://perf.rust-lang.org/compare.html?start=e7825f2b690c9a0d21b6f6d84c404bb53b151b38&amp;end=df368ae457c54fb95d3e64f9986a5f171a6370f0&amp;stat=instructions:u">instruction counts</a>: -0.8% on <code>incr-full</code> builds of <code>keccak check</code></li>
<li>Largest regression in <a href="https://perf.rust-lang.org/compare.html?start=e7825f2b690c9a0d21b6f6d84c404bb53b151b38&amp;end=df368ae457c54fb95d3e64f9986a5f171a6370f0&amp;stat=instructions:u">instruction counts</a>: 2.0% on <code>incr-full</code> builds of <code>stm32f4 check</code></li>
</ul>



<a name="269362941"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/247081-t-compiler/performance/topic/perf%20triage%202022%2001%2025/near/269362941" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pnkfelix <a href="https://zulip-archive.rust-lang.org/stream/247081-t-compiler/performance/topic/perf.20triage.202022.2001.2025.html#269362941">(Jan 26 2022 at 04:42)</a>:</h4>
<ul>
<li>It is not obvious what caused the changes here in this rollup.</li>
</ul>



<a name="269362948"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/247081-t-compiler/performance/topic/perf%20triage%202022%2001%2025/near/269362948" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pnkfelix <a href="https://zulip-archive.rust-lang.org/stream/247081-t-compiler/performance/topic/perf.20triage.202022.2001.2025.html#269362948">(Jan 26 2022 at 04:42)</a>:</h4>
<ul>
<li>PR <a href="https://github.com/rust-lang/rust/issues/88794">#88794</a> - std library addition. Its possible this can cause problems. Not sure if we request perf runs here.<br>
  PR <a href="https://github.com/rust-lang/rust/issues/93064">#93064</a> - "Properly track DepNodes in trait evaluation provisional cache" Left Q if it needed perf run.<br>
  PR <a href="https://github.com/rust-lang/rust/issues/93118">#93118</a> - revision of error emission code so that we get more output. Unlikely to be cause.<br>
  PR <a href="https://github.com/rust-lang/rust/issues/93144">#93144</a> - code coverage data change. Unlikely to be cause.<br>
  PR <a href="https://github.com/rust-lang/rust/issues/93169">#93169</a> - rustdoc implementation change. Unlikely to be cause.<br>
  PR <a href="https://github.com/rust-lang/rust/issues/93175">#93175</a> - "Implement stable overlap check considering negative traits"; maybe expected no-op for feature-free code? Left Q asking if it needed perf run.<br>
  PR <a href="https://github.com/rust-lang/rust/issues/93251">#93251</a> - rustdoc theme change. Unlikely to be cause.<br>
  PR <a href="https://github.com/rust-lang/rust/issues/93269">#93269</a> - LLVM backend change to cope with some C/Rust LTO version mismatch issues. Seems innocuous here.</li>
</ul>



<a name="269362972"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/247081-t-compiler/performance/topic/perf%20triage%202022%2001%2025/near/269362972" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pnkfelix <a href="https://zulip-archive.rust-lang.org/stream/247081-t-compiler/performance/topic/perf.20triage.202022.2001.2025.html#269362972">(Jan 26 2022 at 04:43)</a>:</h4>
<p>So I’m debating about what to do about PR <a href="https://github.com/rust-lang/rust/issues/93288">#93288</a>, in terms of the report.</p>



<a name="269363041"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/247081-t-compiler/performance/topic/perf%20triage%202022%2001%2025/near/269363041" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pnkfelix <a href="https://zulip-archive.rust-lang.org/stream/247081-t-compiler/performance/topic/perf.20triage.202022.2001.2025.html#269363041">(Jan 26 2022 at 04:44)</a>:</h4>
<p>I guess I’ll just summarize what I said above: that it is likely narrowed down to one of PR <a href="https://github.com/rust-lang/rust/issues/93064">#93064</a> or PR <a href="https://github.com/rust-lang/rust/issues/93175">#93175</a> (though std library changes do make me nervous in terms of potential for introducing noise).</p>



<a name="269363358"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/247081-t-compiler/performance/topic/perf%20triage%202022%2001%2025/near/269363358" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pnkfelix <a href="https://zulip-archive.rust-lang.org/stream/247081-t-compiler/performance/topic/perf.20triage.202022.2001.2025.html#269363358">(Jan 26 2022 at 04:50)</a>:</h4>
<p>stm32f4 was added in part to bench compiler trait machinery</p>



<a name="269363378"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/247081-t-compiler/performance/topic/perf%20triage%202022%2001%2025/near/269363378" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pnkfelix <a href="https://zulip-archive.rust-lang.org/stream/247081-t-compiler/performance/topic/perf.20triage.202022.2001.2025.html#269363378">(Jan 26 2022 at 04:51)</a>:</h4>
<p>so the regression being there might be support for hypothesis that this is PR <a href="https://github.com/rust-lang/rust/issues/93064">#93064</a> or <a href="https://github.com/rust-lang/rust/issues/93175">#93175</a>. Probably former.</p>



<a name="269364316"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/247081-t-compiler/performance/topic/perf%20triage%202022%2001%2025/near/269364316" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pnkfelix <a href="https://zulip-archive.rust-lang.org/stream/247081-t-compiler/performance/topic/perf.20triage.202022.2001.2025.html#269364316">(Jan 26 2022 at 05:05)</a>:</h4>
<p>posted PR: <a href="https://github.com/rust-lang/rustc-perf/pull/1158">https://github.com/rust-lang/rustc-perf/pull/1158</a></p>



<a name="269382048"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/247081-t-compiler/performance/topic/perf%20triage%202022%2001%2025/near/269382048" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> lqd <a href="https://zulip-archive.rust-lang.org/stream/247081-t-compiler/performance/topic/perf.20triage.202022.2001.2025.html#269382048">(Jan 26 2022 at 09:25)</a>:</h4>
<p>do you think it'd be worthwhile to try and make the bot's <code>make-pr-for</code> feature work, to track the source of the changes in rollup <a href="https://github.com/rust-lang/rust/issues/93288">#93288</a> ? it seems likely that we'll be having more rollups like these needing to be investigated, and these perf runs reverting parts of a rollup should help narrow things down.</p>



<a name="269388252"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/247081-t-compiler/performance/topic/perf%20triage%202022%2001%2025/near/269388252" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> tm <a href="https://zulip-archive.rust-lang.org/stream/247081-t-compiler/performance/topic/perf.20triage.202022.2001.2025.html#269388252">(Jan 26 2022 at 10:24)</a>:</h4>
<p>For <a href="https://github.com/rust-lang/rust/issues/93288">#93288</a> and benchmark stm32f4 check cachegrind diff is:</p>
<div class="codehilite"><pre><span></span><code>--------------------------------------------------------------------------------
Ir
--------------------------------------------------------------------------------
688,903,346  PROGRAM TOTALS

--------------------------------------------------------------------------------
Ir           file:function
--------------------------------------------------------------------------------
545,836,918  ???:&lt;rustc_middle::ty::context::TyCtxt&gt;::has_attr
 98,006,468  ???:&lt;rustc_session::session::Session&gt;::contains_name
 45,007,143  ???:rustc_trait_selection::traits::coherence::overlap_within_probe
 ...
</code></pre></div>
<p>Which points at <a href="https://github.com/rust-lang/rust/issues/93175">#93175</a> (<code>overlap_mode</code> could easily avoid at least two <code>has_attr</code> calls).</p>
<p>cc <span class="user-mention" data-user-id="116266">@Santiago Pastorino</span></p>



<a name="269406394"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/247081-t-compiler/performance/topic/perf%20triage%202022%2001%2025/near/269406394" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pnkfelix <a href="https://zulip-archive.rust-lang.org/stream/247081-t-compiler/performance/topic/perf.20triage.202022.2001.2025.html#269406394">(Jan 26 2022 at 13:02)</a>:</h4>
<p>oh, good point <span class="user-mention" data-user-id="352985">@tm</span> !</p>



<a name="269407482"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/247081-t-compiler/performance/topic/perf%20triage%202022%2001%2025/near/269407482" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Santiago Pastorino <a href="https://zulip-archive.rust-lang.org/stream/247081-t-compiler/performance/topic/perf.20triage.202022.2001.2025.html#269407482">(Jan 26 2022 at 13:10)</a>:</h4>
<p><span class="user-mention silent" data-user-id="352985">tm</span> <a href="#narrow/stream/247081-t-compiler.2Fperformance/topic/perf.20triage.202022.2001.2025/near/269388252">said</a>:</p>
<blockquote>
<p>For <a href="https://github.com/rust-lang/rust/issues/93288">#93288</a> and benchmark stm32f4 check cachegrind diff is:</p>
<div class="codehilite"><pre><span></span><code>--------------------------------------------------------------------------------
Ir
--------------------------------------------------------------------------------
688,903,346  PROGRAM TOTALS

--------------------------------------------------------------------------------
Ir           file:function
--------------------------------------------------------------------------------
545,836,918  ???:&lt;rustc_middle::ty::context::TyCtxt&gt;::has_attr
 98,006,468  ???:&lt;rustc_session::session::Session&gt;::contains_name
 45,007,143  ???:rustc_trait_selection::traits::coherence::overlap_within_probe
 ...
</code></pre></div>
<p>Which points at <a href="https://github.com/rust-lang/rust/issues/93175">#93175</a> (<code>overlap_mode</code> could easily avoid at least two <code>has_attr</code> calls).</p>
<p>cc <span class="user-mention silent" data-user-id="116266">Santiago Pastorino</span></p>
</blockquote>
<p><span class="user-mention" data-user-id="352985">@tm</span> <span class="user-mention" data-user-id="116083">@pnkfelix</span> gonna check this out, thanks for sharing</p>



<a name="269407650"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/247081-t-compiler/performance/topic/perf%20triage%202022%2001%2025/near/269407650" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> tm <a href="https://zulip-archive.rust-lang.org/stream/247081-t-compiler/performance/topic/perf.20triage.202022.2001.2025.html#269407650">(Jan 26 2022 at 13:11)</a>:</h4>
<p><span class="user-mention" data-user-id="116266">@Santiago Pastorino</span> I implemented the idea in <a href="https://github.com/rust-lang/rust/issues/93324">#93324</a>.</p>



<a name="269412720"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/247081-t-compiler/performance/topic/perf%20triage%202022%2001%2025/near/269412720" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Santiago Pastorino <a href="https://zulip-archive.rust-lang.org/stream/247081-t-compiler/performance/topic/perf.20triage.202022.2001.2025.html#269412720">(Jan 26 2022 at 13:47)</a>:</h4>
<p><span class="user-mention silent" data-user-id="352985">tm</span> <a href="#narrow/stream/247081-t-compiler.2Fperformance/topic/perf.20triage.202022.2001.2025/near/269407650">said</a>:</p>
<blockquote>
<p><span class="user-mention silent" data-user-id="116266">Santiago Pastorino</span> I implemented the idea in <a href="https://github.com/rust-lang/rust/issues/93324">#93324</a>.</p>
</blockquote>
<p><span aria-label="+1" class="emoji emoji-1f44d" role="img" title="+1">:+1:</span>, approving it, should we rollup this one or disallow to see the perf impact?</p>



<a name="269412827"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/247081-t-compiler/performance/topic/perf%20triage%202022%2001%2025/near/269412827" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> simulacrum <a href="https://zulip-archive.rust-lang.org/stream/247081-t-compiler/performance/topic/perf.20triage.202022.2001.2025.html#269412827">(Jan 26 2022 at 13:47)</a>:</h4>
<p>Let's see what perf says before approving it, I think.</p>



<a name="269412910"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/247081-t-compiler/performance/topic/perf%20triage%202022%2001%2025/near/269412910" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> lqd <a href="https://zulip-archive.rust-lang.org/stream/247081-t-compiler/performance/topic/perf.20triage.202022.2001.2025.html#269412910">(Jan 26 2022 at 13:48)</a>:</h4>
<p>this PR can still be slightly improved</p>



<a name="269413581"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/247081-t-compiler/performance/topic/perf%20triage%202022%2001%2025/near/269413581" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Santiago Pastorino <a href="https://zulip-archive.rust-lang.org/stream/247081-t-compiler/performance/topic/perf.20triage.202022.2001.2025.html#269413581">(Jan 26 2022 at 13:52)</a>:</h4>
<p>ohh sorry Mark, didn't see that you fired a perf test and fired a new one</p>



<a name="269418545"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/247081-t-compiler/performance/topic/perf%20triage%202022%2001%2025/near/269418545" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Santiago Pastorino <a href="https://zulip-archive.rust-lang.org/stream/247081-t-compiler/performance/topic/perf.20triage.202022.2001.2025.html#269418545">(Jan 26 2022 at 14:21)</a>:</h4>
<p>opened a different PR <a href="https://github.com/rust-lang/rust/issues/93328">#93328</a></p>



<a name="269422177"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/247081-t-compiler/performance/topic/perf%20triage%202022%2001%2025/near/269422177" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Santiago Pastorino <a href="https://zulip-archive.rust-lang.org/stream/247081-t-compiler/performance/topic/perf.20triage.202022.2001.2025.html#269422177">(Jan 26 2022 at 14:45)</a>:</h4>
<p>just in case, my PR is a bit different and probably won't have a perf difference, but the idea is to use with negative and in particular with negative may land on stdlib so the code would do less checks in cases that are more likely to happen</p>



<a name="269422202"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/247081-t-compiler/performance/topic/perf%20triage%202022%2001%2025/near/269422202" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Santiago Pastorino <a href="https://zulip-archive.rust-lang.org/stream/247081-t-compiler/performance/topic/perf.20triage.202022.2001.2025.html#269422202">(Jan 26 2022 at 14:45)</a>:</h4>
<p>but performance of both PRs should be similar right now</p>



<a name="269422237"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/247081-t-compiler/performance/topic/perf%20triage%202022%2001%2025/near/269422237" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Santiago Pastorino <a href="https://zulip-archive.rust-lang.org/stream/247081-t-compiler/performance/topic/perf.20triage.202022.2001.2025.html#269422237">(Jan 26 2022 at 14:45)</a>:</h4>
<p>anyway, I'd be more inclined to merge mine because of these reasons</p>



<a name="269425012"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/247081-t-compiler/performance/topic/perf%20triage%202022%2001%2025/near/269425012" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> tm <a href="https://zulip-archive.rust-lang.org/stream/247081-t-compiler/performance/topic/perf.20triage.202022.2001.2025.html#269425012">(Jan 26 2022 at 15:02)</a>:</h4>
<p>Feel free to close <a href="https://github.com/rust-lang/rust/issues/93324">#93324</a>, unless you are interested in perf comparison.</p>



<a name="269436900"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/247081-t-compiler/performance/topic/perf%20triage%202022%2001%2025/near/269436900" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Santiago Pastorino <a href="https://zulip-archive.rust-lang.org/stream/247081-t-compiler/performance/topic/perf.20triage.202022.2001.2025.html#269436900">(Jan 26 2022 at 16:11)</a>:</h4>
<p><span class="user-mention" data-user-id="352985">@tm</span> <span aria-label="+1" class="emoji emoji-1f44d" role="img" title="+1">:+1:</span>, given that is already up, let's see what perf says</p>



<a name="269464452"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/247081-t-compiler/performance/topic/perf%20triage%202022%2001%2025/near/269464452" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Santiago Pastorino <a href="https://zulip-archive.rust-lang.org/stream/247081-t-compiler/performance/topic/perf.20triage.202022.2001.2025.html#269464452">(Jan 26 2022 at 19:06)</a>:</h4>
<p>as I was already expecting after seeing <a href="https://github.com/rust-lang/rust/issues/93324">#93324</a>, <a href="https://github.com/rust-lang/rust/issues/93328">#93328</a> doesn't either bring better results</p>



<a name="269464483"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/247081-t-compiler/performance/topic/perf%20triage%202022%2001%2025/near/269464483" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Santiago Pastorino <a href="https://zulip-archive.rust-lang.org/stream/247081-t-compiler/performance/topic/perf.20triage.202022.2001.2025.html#269464483">(Jan 26 2022 at 19:06)</a>:</h4>
<p><span class="user-mention" data-user-id="352985">@tm</span> <span class="user-mention" data-user-id="116122">@simulacrum</span> how bad the thing were?</p>



<a name="269464512"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/247081-t-compiler/performance/topic/perf%20triage%202022%2001%2025/near/269464512" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Santiago Pastorino <a href="https://zulip-archive.rust-lang.org/stream/247081-t-compiler/performance/topic/perf.20triage.202022.2001.2025.html#269464512">(Jan 26 2022 at 19:06)</a>:</h4>
<p>I was talking to Niko that maybe is better if we switch that and use a crate level attribute</p>



<a name="269464523"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/247081-t-compiler/performance/topic/perf%20triage%202022%2001%2025/near/269464523" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Santiago Pastorino <a href="https://zulip-archive.rust-lang.org/stream/247081-t-compiler/performance/topic/perf.20triage.202022.2001.2025.html#269464523">(Jan 26 2022 at 19:06)</a>:</h4>
<p>well actually 2</p>



<a name="269464575"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/247081-t-compiler/performance/topic/perf%20triage%202022%2001%2025/near/269464575" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Santiago Pastorino <a href="https://zulip-archive.rust-lang.org/stream/247081-t-compiler/performance/topic/perf.20triage.202022.2001.2025.html#269464575">(Jan 26 2022 at 19:07)</a>:</h4>
<p>or I guess I could condense this into just one attribute</p>



<a name="269465092"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/247081-t-compiler/performance/topic/perf%20triage%202022%2001%2025/near/269465092" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Santiago Pastorino <a href="https://zulip-archive.rust-lang.org/stream/247081-t-compiler/performance/topic/perf.20triage.202022.2001.2025.html#269465092">(Jan 26 2022 at 19:10)</a>:</h4>
<p>although I wonder ... I understand that this may be affecting instruction counts but does it affect wall time at all? I guess it shouldn't?</p>



<a name="269466147"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/247081-t-compiler/performance/topic/perf%20triage%202022%2001%2025/near/269466147" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> The 8472 <a href="https://zulip-archive.rust-lang.org/stream/247081-t-compiler/performance/topic/perf.20triage.202022.2001.2025.html#269466147">(Jan 26 2022 at 19:17)</a>:</h4>
<p>Is there any reason to assume that in this case instruction count changes wouldn't affect wall time?</p>



<a name="269466504"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/247081-t-compiler/performance/topic/perf%20triage%202022%2001%2025/near/269466504" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> simulacrum <a href="https://zulip-archive.rust-lang.org/stream/247081-t-compiler/performance/topic/perf.20triage.202022.2001.2025.html#269466504">(Jan 26 2022 at 19:19)</a>:</h4>
<p>The instruction count regressions are fairly small in absolute magnitude, so it might not be something we can standalone measure as impacting wall time (too small effect size), but I wouldn't expect no effect</p>



<a name="269467230"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/247081-t-compiler/performance/topic/perf%20triage%202022%2001%2025/near/269467230" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> tm <a href="https://zulip-archive.rust-lang.org/stream/247081-t-compiler/performance/topic/perf.20triage.202022.2001.2025.html#269467230">(Jan 26 2022 at 19:24)</a>:</h4>
<p>Cachegrind diff for <a href="https://github.com/rust-lang/rust/issues/93324">#93324</a> and stm32f4 check:</p>
<div class="codehilite"><pre><span></span><code>--------------------------------------------------------------------------------
Ir
--------------------------------------------------------------------------------
 -222,084,494  PROGRAM TOTALS

--------------------------------------------------------------------------------
Ir             file:function
--------------------------------------------------------------------------------
 -181,938,360  ???:&lt;rustc_middle::ty::context::TyCtxt&gt;::has_attr
  -33,048,596  ???:&lt;rustc_session::session::Session&gt;::contains_name
  -12,024,623  ???:&lt;rustc_data_structures::stable_hasher::StableHasher&gt;::finish::&lt;u128&gt;
   11,945,001  ???:&lt;core::iter::adapters::map::Map&lt;std::collections::hash::map::Iter&lt;ru
...
</code></pre></div>
<p>Cachegrind diff for <a href="https://github.com/rust-lang/rust/issues/93343">#93343</a> and stm32f4 check:</p>
<div class="codehilite"><pre><span></span><code>--------------------------------------------------------------------------------
Ir
--------------------------------------------------------------------------------
 -467,843,688  PROGRAM TOTALS

--------------------------------------------------------------------------------
Ir             file:function
--------------------------------------------------------------------------------
 -545,836,932  ???:&lt;rustc_middle::ty::context::TyCtxt&gt;::has_attr
  169,593,607  ???:&lt;rustc_middle::ty::context::TyCtxt&gt;::get_attrs
  -98,006,468  ???:&lt;rustc_session::session::Session&gt;::contains_name
   11,126,628  ???:&lt;rustc_ast::ast::Attribute&gt;::name_or_empty
...
</code></pre></div>



<a name="269467774"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/247081-t-compiler/performance/topic/perf%20triage%202022%2001%2025/near/269467774" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Santiago Pastorino <a href="https://zulip-archive.rust-lang.org/stream/247081-t-compiler/performance/topic/perf.20triage.202022.2001.2025.html#269467774">(Jan 26 2022 at 19:28)</a>:</h4>
<p>I was actually trying something similar to what <span class="user-mention" data-user-id="116113">@lqd</span> was doing</p>



<a name="269467855"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/247081-t-compiler/performance/topic/perf%20triage%202022%2001%2025/near/269467855" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Santiago Pastorino <a href="https://zulip-archive.rust-lang.org/stream/247081-t-compiler/performance/topic/perf.20triage.202022.2001.2025.html#269467855">(Jan 26 2022 at 19:28)</a>:</h4>
<p><span class="user-mention" data-user-id="352985">@tm</span> can you run it on <a href="https://github.com/rust-lang/rust/issues/93328">#93328</a> ?</p>



<a name="269467884"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/247081-t-compiler/performance/topic/perf%20triage%202022%2001%2025/near/269467884" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Santiago Pastorino <a href="https://zulip-archive.rust-lang.org/stream/247081-t-compiler/performance/topic/perf.20triage.202022.2001.2025.html#269467884">(Jan 26 2022 at 19:28)</a>:</h4>
<p>I'd expect it to be similar to your PR</p>



<a name="269469664"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/247081-t-compiler/performance/topic/perf%20triage%202022%2001%2025/near/269469664" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Santiago Pastorino <a href="https://zulip-archive.rust-lang.org/stream/247081-t-compiler/performance/topic/perf.20triage.202022.2001.2025.html#269469664">(Jan 26 2022 at 19:40)</a>:</h4>
<p>ok, I'm going to move this into a crate level attribute and this problem will be fixed</p>



<a name="269469772"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/247081-t-compiler/performance/topic/perf%20triage%202022%2001%2025/near/269469772" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> tm <a href="https://zulip-archive.rust-lang.org/stream/247081-t-compiler/performance/topic/perf.20triage.202022.2001.2025.html#269469772">(Jan 26 2022 at 19:41)</a>:</h4>
<p>Cachegrind diff for <a href="https://github.com/rust-lang/rust/issues/93328">#93328</a> and stm32f4 check:</p>
<div class="codehilite"><pre><span></span><code>--------------------------------------------------------------------------------
Ir
--------------------------------------------------------------------------------
 -211,707,257  PROGRAM TOTALS

--------------------------------------------------------------------------------
Ir             file:function
--------------------------------------------------------------------------------
 -181,938,360  ???:&lt;rustc_middle::ty::context::TyCtxt&gt;::has_attr
  -33,048,596  ???:&lt;rustc_session::session::Session&gt;::contains_name
  -12,024,623  ???:&lt;rustc_data_structures::stable_hasher::StableHasher&gt;::finish::&lt;u128&gt;
   11,945,001  ???:&lt;core::iter::adapters::map::Map&lt;std::collections::hash::map::Iter&lt;ru
</code></pre></div>



<a name="269470059"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/247081-t-compiler/performance/topic/perf%20triage%202022%2001%2025/near/269470059" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> tm <a href="https://zulip-archive.rust-lang.org/stream/247081-t-compiler/performance/topic/perf.20triage.202022.2001.2025.html#269470059">(Jan 26 2022 at 19:43)</a>:</h4>
<p>I think the difference is small, so we might have already spent more time on it than it was worth, it just looked like there was an easy opportunity to recover most of the regression.</p>



<a name="269472569"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/247081-t-compiler/performance/topic/perf%20triage%202022%2001%2025/near/269472569" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Santiago Pastorino <a href="https://zulip-archive.rust-lang.org/stream/247081-t-compiler/performance/topic/perf.20triage.202022.2001.2025.html#269472569">(Jan 26 2022 at 20:00)</a>:</h4>
<p><span class="user-mention silent" data-user-id="352985">tm</span> <a href="#narrow/stream/247081-t-compiler.2Fperformance/topic/perf.20triage.202022.2001.2025/near/269470059">said</a>:</p>
<blockquote>
<p>I think the difference is small, so we might have already spent more time on it than it was worth, it just looked like there was an easy opportunity to recover most of the regression.</p>
</blockquote>
<p>well, the difference is small between which things?</p>



<a name="269472631"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/247081-t-compiler/performance/topic/perf%20triage%202022%2001%2025/near/269472631" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Santiago Pastorino <a href="https://zulip-archive.rust-lang.org/stream/247081-t-compiler/performance/topic/perf.20triage.202022.2001.2025.html#269472631">(Jan 26 2022 at 20:00)</a>:</h4>
<p>I thought it wasn't if you were comparing my PR and how the perf was before ?</p>



<a name="269472689"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/247081-t-compiler/performance/topic/perf%20triage%202022%2001%2025/near/269472689" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Santiago Pastorino <a href="https://zulip-archive.rust-lang.org/stream/247081-t-compiler/performance/topic/perf.20triage.202022.2001.2025.html#269472689">(Jan 26 2022 at 20:01)</a>:</h4>
<p>or are you comparing the 3 PRs all of us cooked?</p>



<a name="269472727"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/247081-t-compiler/performance/topic/perf%20triage%202022%2001%2025/near/269472727" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Santiago Pastorino <a href="https://zulip-archive.rust-lang.org/stream/247081-t-compiler/performance/topic/perf.20triage.202022.2001.2025.html#269472727">(Jan 26 2022 at 20:01)</a>:</h4>
<p>in any case, the best thing to do is to move the attribute to the crate level and all this work would be avoided</p>



<a name="269472795"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/247081-t-compiler/performance/topic/perf%20triage%202022%2001%2025/near/269472795" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pnkfelix <a href="https://zulip-archive.rust-lang.org/stream/247081-t-compiler/performance/topic/perf.20triage.202022.2001.2025.html#269472795">(Jan 26 2022 at 20:01)</a>:</h4>
<p><span class="user-mention silent" data-user-id="116113">lqd</span> <a href="#narrow/stream/247081-t-compiler.2Fperformance/topic/perf.20triage.202022.2001.2025/near/269382048">said</a>:</p>
<blockquote>
<p>do you think it'd be worthwhile to try and make the bot's <code>make-pr-for</code> feature work, to track the source of the changes in rollup <a href="https://github.com/rust-lang/rust/issues/93288">#93288</a> ? it seems likely that we'll be having more rollups like these needing to be investigated, and these perf runs reverting parts of a rollup should help narrow things down.</p>
</blockquote>
<p>(what is the <code>make-pr-for</code> feature?)</p>



<a name="269473066"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/247081-t-compiler/performance/topic/perf%20triage%202022%2001%2025/near/269473066" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> simulacrum <a href="https://zulip-archive.rust-lang.org/stream/247081-t-compiler/performance/topic/perf.20triage.202022.2001.2025.html#269473066">(Jan 26 2022 at 20:04)</a>:</h4>
<p>make-pr-for is intended to automate in-rollup PR triage, but it's typically not worth it</p>



<a name="269473108"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/247081-t-compiler/performance/topic/perf%20triage%202022%2001%2025/near/269473108" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> simulacrum <a href="https://zulip-archive.rust-lang.org/stream/247081-t-compiler/performance/topic/perf.20triage.202022.2001.2025.html#269473108">(Jan 26 2022 at 20:04)</a>:</h4>
<p>it's semi-broken right now</p>



<a name="269473122"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/247081-t-compiler/performance/topic/perf%20triage%202022%2001%2025/near/269473122" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> lqd <a href="https://zulip-archive.rust-lang.org/stream/247081-t-compiler/performance/topic/perf.20triage.202022.2001.2025.html#269473122">(Jan 26 2022 at 20:04)</a>:</h4>
<p>mark and ryan can explain more, but I remember it as "let's ask the bot to make a PR that reverts a PR that was in a rollup and we'd like to see the impact on perf"</p>



<a name="269473271"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/247081-t-compiler/performance/topic/perf%20triage%202022%2001%2025/near/269473271" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pnkfelix <a href="https://zulip-archive.rust-lang.org/stream/247081-t-compiler/performance/topic/perf.20triage.202022.2001.2025.html#269473271">(Jan 26 2022 at 20:05)</a>:</h4>
<p>oh interesting</p>



<a name="269474055"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/247081-t-compiler/performance/topic/perf%20triage%202022%2001%2025/near/269474055" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pnkfelix <a href="https://zulip-archive.rust-lang.org/stream/247081-t-compiler/performance/topic/perf.20triage.202022.2001.2025.html#269474055">(Jan 26 2022 at 20:11)</a>:</h4>
<p>btw, twir PR for this week’s triage. <span aria-label="smile" class="emoji emoji-1f642" role="img" title="smile">:smile:</span> : <a href="https://github.com/rust-lang/this-week-in-rust/pull/2854">https://github.com/rust-lang/this-week-in-rust/pull/2854</a></p>



<a name="269488115"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/247081-t-compiler/performance/topic/perf%20triage%202022%2001%2025/near/269488115" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Santiago Pastorino <a href="https://zulip-archive.rust-lang.org/stream/247081-t-compiler/performance/topic/perf.20triage.202022.2001.2025.html#269488115">(Jan 26 2022 at 21:53)</a>:</h4>
<p>opened <a href="https://github.com/rust-lang/rust/issues/93348">#93348</a></p>



<hr><p>Last updated: Apr 12 2022 at 20:01 UTC</p>
</html>