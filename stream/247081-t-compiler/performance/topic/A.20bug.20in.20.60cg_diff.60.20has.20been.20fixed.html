<html>
<head><meta charset="utf-8"><title>A bug in `cg_diff` has been fixed · t-compiler/performance · Zulip Chat Archive</title></head>
<h2>Stream: <a href="https://zulip-archive.rust-lang.org/stream/247081-t-compiler/performance/index.html">t-compiler/performance</a></h2>
<h3>Topic: <a href="https://zulip-archive.rust-lang.org/stream/247081-t-compiler/performance/topic/A.20bug.20in.20.60cg_diff.60.20has.20been.20fixed.html">A bug in `cg_diff` has been fixed</a></h3>

<hr>

<base href="https://rust-lang.zulipchat.com">

<head><link href="https://zulip-archive.rust-lang.org/style.css" rel="stylesheet"></head>

<a name="263098259"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/247081-t-compiler/performance/topic/A%20bug%20in%20%60cg_diff%60%20has%20been%20fixed/near/263098259" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nnethercote <a href="https://zulip-archive.rust-lang.org/stream/247081-t-compiler/performance/topic/A.20bug.20in.20.60cg_diff.60.20has.20been.20fixed.html#263098259">(Nov 30 2021 at 03:32)</a>:</h4>
<p>I discovered that <code>cg_diff</code> (Cachegrind's diff tool) was misbehaving when rust symbols included a <code>#</code> character, which happens with closures.</p>
<p>I fixed it here: <a href="http://sourceware.org/git/?p=valgrind.git;a=commit;h=1cf2cf91e77db18f8d95767f73af3b3068d1a3ab">http://sourceware.org/git/?p=valgrind.git;a=commit;h=1cf2cf91e77db18f8d95767f73af3b3068d1a3ab</a></p>
<p>If you ever use <code>cg_diff</code> you should clone and build the Valgrind repository (<a href="https://valgrind.org/downloads/repository.html">https://valgrind.org/downloads/repository.html</a>) and use the recent version. (You'll get various other symbol demangling fixes that way, too.)</p>



<a name="263818969"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/247081-t-compiler/performance/topic/A%20bug%20in%20%60cg_diff%60%20has%20been%20fixed/near/263818969" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nnethercote <a href="https://zulip-archive.rust-lang.org/stream/247081-t-compiler/performance/topic/A.20bug.20in.20.60cg_diff.60.20has.20been.20fixed.html#263818969">(Dec 06 2021 at 08:16)</a>:</h4>
<p>I also fixed another small bug that caused warnings about uninitialized values to be printed by <code>cg_annotate</code> when viewing profiles created with <code>cg_diff</code>.</p>



<a name="263818975"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/247081-t-compiler/performance/topic/A%20bug%20in%20%60cg_diff%60%20has%20been%20fixed/near/263818975" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nnethercote <a href="https://zulip-archive.rust-lang.org/stream/247081-t-compiler/performance/topic/A.20bug.20in.20.60cg_diff.60.20has.20been.20fixed.html#263818975">(Dec 06 2021 at 08:16)</a>:</h4>
<p>Turns out they were disconcerting but harmless.</p>



<hr><p>Last updated: Apr 12 2022 at 20:01 UTC</p>
</html>