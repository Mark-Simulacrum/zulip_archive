<html>
<head><meta charset="utf-8"><title>triage 2021 14 09 · t-compiler/performance · Zulip Chat Archive</title></head>
<h2>Stream: <a href="https://zulip-archive.rust-lang.org/stream/247081-t-compiler/performance/index.html">t-compiler/performance</a></h2>
<h3>Topic: <a href="https://zulip-archive.rust-lang.org/stream/247081-t-compiler/performance/topic/triage.202021.2014.2009.html">triage 2021 14 09</a></h3>

<hr>

<base href="https://rust-lang.zulipchat.com">

<head><link href="https://zulip-archive.rust-lang.org/style.css" rel="stylesheet"></head>

<a name="253245530"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/247081-t-compiler/performance/topic/triage%202021%2014%2009/near/253245530" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> rylev <a href="https://zulip-archive.rust-lang.org/stream/247081-t-compiler/performance/topic/triage.202021.2014.2009.html#253245530">(Sep 14 2021 at 12:59)</a>:</h4>
<p>FYI: <span class="user-mention" data-user-id="116122">@simulacrum</span> has already done the triage. I'm going to land <a href="https://github.com/rust-lang/rustc-perf/pull/1001">https://github.com/rust-lang/rustc-perf/pull/1001</a> which changes the IQR multipler from 1.5 to 3.0 which we use in the new significance test (not on by default) and then I'm going to rerun the triage to see what the diff is.</p>



<a name="253245667"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/247081-t-compiler/performance/topic/triage%202021%2014%2009/near/253245667" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> simulacrum <a href="https://zulip-archive.rust-lang.org/stream/247081-t-compiler/performance/topic/triage.202021.2014.2009.html#253245667">(Sep 14 2021 at 13:00)</a>:</h4>
<p>Yeah - I plan to take another look this morning regardless, just wanted to get the bulk out of the way last night (and merge in case I didn't have a bit of time this morning)</p>



<a name="253245761"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/247081-t-compiler/performance/topic/triage%202021%2014%2009/near/253245761" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> rylev <a href="https://zulip-archive.rust-lang.org/stream/247081-t-compiler/performance/topic/triage.202021.2014.2009.html#253245761">(Sep 14 2021 at 13:00)</a>:</h4>
<p>(there's absolutely no issue with doing the triage on Monday nights <span aria-label="blush" class="emoji emoji-1f60a" role="img" title="blush">:blush:</span>)</p>



<a name="253245812"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/247081-t-compiler/performance/topic/triage%202021%2014%2009/near/253245812" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> simulacrum <a href="https://zulip-archive.rust-lang.org/stream/247081-t-compiler/performance/topic/triage.202021.2014.2009.html#253245812">(Sep 14 2021 at 13:01)</a>:</h4>
<p>I didn't triage the 'maybe interesting' section anyway, was leaving that for today :)</p>



<a name="253245960"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/247081-t-compiler/performance/topic/triage%202021%2014%2009/near/253245960" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> rylev <a href="https://zulip-archive.rust-lang.org/stream/247081-t-compiler/performance/topic/triage.202021.2014.2009.html#253245960">(Sep 14 2021 at 13:02)</a>:</h4>
<p>We can do that with the new significance threshold calculation as well.</p>



<a name="253246066"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/247081-t-compiler/performance/topic/triage%202021%2014%2009/near/253246066" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> simulacrum <a href="https://zulip-archive.rust-lang.org/stream/247081-t-compiler/performance/topic/triage.202021.2014.2009.html#253246066">(Sep 14 2021 at 13:02)</a>:</h4>
<p>We should switch to calcNewSig probably, right? Otherwise the IQR adjustment doesn't mean too much.</p>



<a name="253246761"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/247081-t-compiler/performance/topic/triage%202021%2014%2009/near/253246761" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> rylev <a href="https://zulip-archive.rust-lang.org/stream/247081-t-compiler/performance/topic/triage.202021.2014.2009.html#253246761">(Sep 14 2021 at 13:07)</a>:</h4>
<p>The thought was that since calcNewSig can be passed as a query param we can test it while other users of the perf service remain unaffected until we think things are good enough to switch over the default</p>



<a name="253247196"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/247081-t-compiler/performance/topic/triage%202021%2014%2009/near/253247196" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> simulacrum <a href="https://zulip-archive.rust-lang.org/stream/247081-t-compiler/performance/topic/triage.202021.2014.2009.html#253247196">(Sep 14 2021 at 13:11)</a>:</h4>
<p>Hm. Yeah, I guess that makes sense-- it's a bit annoying to edit the URLs in the triage report to use it (and generally deal with that).</p>
<p>Maybe we should surface it in the UI as a toggle (requiring a new page load)... but that also seems a little hard.</p>



<a name="253247223"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/247081-t-compiler/performance/topic/triage%202021%2014%2009/near/253247223" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> simulacrum <a href="https://zulip-archive.rust-lang.org/stream/247081-t-compiler/performance/topic/triage.202021.2014.2009.html#253247223">(Sep 14 2021 at 13:11)</a>:</h4>
<p>It does feel like the right direction to move in, though, so maybe we should just go for it.</p>



<a name="253248750"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/247081-t-compiler/performance/topic/triage%202021%2014%2009/near/253248750" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> rylev <a href="https://zulip-archive.rust-lang.org/stream/247081-t-compiler/performance/topic/triage.202021.2014.2009.html#253248750">(Sep 14 2021 at 13:20)</a>:</h4>
<p><span class="user-mention silent" data-user-id="116122">simulacrum</span> <a href="#narrow/stream/247081-t-compiler.2Fperformance/topic/triage.202021.2014.2009/near/253247223">said</a>:</p>
<blockquote>
<p>It does feel like the right direction to move in, though, so maybe we should just go for it.</p>
</blockquote>
<p>I'm convinced it's the right direction, and it's merely about gaining confidence that we've tweaked the knobs in the right way to get the results we're looking for.</p>



<a name="253248841"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/247081-t-compiler/performance/topic/triage%202021%2014%2009/near/253248841" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> rylev <a href="https://zulip-archive.rust-lang.org/stream/247081-t-compiler/performance/topic/triage.202021.2014.2009.html#253248841">(Sep 14 2021 at 13:21)</a>:</h4>
<p>We could spend cycles making it easier to toggle between the old and new significance scheme, but I think it's not worth it.</p>



<a name="253248858"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/247081-t-compiler/performance/topic/triage%202021%2014%2009/near/253248858" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> rylev <a href="https://zulip-archive.rust-lang.org/stream/247081-t-compiler/performance/topic/triage.202021.2014.2009.html#253248858">(Sep 14 2021 at 13:21)</a>:</h4>
<p>I think we're nearly at the point of turning it on by default</p>



<a name="253248871"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/247081-t-compiler/performance/topic/triage%202021%2014%2009/near/253248871" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> simulacrum <a href="https://zulip-archive.rust-lang.org/stream/247081-t-compiler/performance/topic/triage.202021.2014.2009.html#253248871">(Sep 14 2021 at 13:21)</a>:</h4>
<p>Yeah.</p>
<p>By the way, I enabled some of the CI things as "required" last night so that we can use the github auto merge feature (I think it's a requirement)</p>



<a name="253248942"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/247081-t-compiler/performance/topic/triage%202021%2014%2009/near/253248942" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> simulacrum <a href="https://zulip-archive.rust-lang.org/stream/247081-t-compiler/performance/topic/triage.202021.2014.2009.html#253248942">(Sep 14 2021 at 13:21)</a>:</h4>
<p>Obviously can iterate on which ones to enable but that felt like a good first step</p>



<a name="253249175"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/247081-t-compiler/performance/topic/triage%202021%2014%2009/near/253249175" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> rylev <a href="https://zulip-archive.rust-lang.org/stream/247081-t-compiler/performance/topic/triage.202021.2014.2009.html#253249175">(Sep 14 2021 at 13:23)</a>:</h4>
<p>That's great. We might want to discuss this in another topic, but I also want to see if we can turn off benchmark CI and only run it when someone changes a benchmark, on master, or for the cron job run.</p>



<a name="253441543"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/247081-t-compiler/performance/topic/triage%202021%2014%2009/near/253441543" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> rylev <a href="https://zulip-archive.rust-lang.org/stream/247081-t-compiler/performance/topic/triage.202021.2014.2009.html#253441543">(Sep 15 2021 at 16:14)</a>:</h4>
<p><span class="user-mention" data-user-id="116122">@simulacrum</span> noticing you've been making progress on doing perf investigation and adding <code>perf-regression-triaged</code>. That's great! Would you be able to write any docs (just bullet points for now) on what you're doing for investigating. I assume it's a lot of cache-grind</p>



<a name="253442113"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/247081-t-compiler/performance/topic/triage%202021%2014%2009/near/253442113" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> simulacrum <a href="https://zulip-archive.rust-lang.org/stream/247081-t-compiler/performance/topic/triage.202021.2014.2009.html#253442113">(Sep 15 2021 at 16:16)</a>:</h4>
<p>I've been trying to leave fairly detailed comments in terms of outputs, but you're right that adding what commands are run would be good too</p>



<a name="253442127"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/247081-t-compiler/performance/topic/triage%202021%2014%2009/near/253442127" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> simulacrum <a href="https://zulip-archive.rust-lang.org/stream/247081-t-compiler/performance/topic/triage.202021.2014.2009.html#253442127">(Sep 15 2021 at 16:16)</a>:</h4>
<p>I might just leave those in the comments for now?</p>



<a name="253442504"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/247081-t-compiler/performance/topic/triage%202021%2014%2009/near/253442504" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> The 8472 <a href="https://zulip-archive.rust-lang.org/stream/247081-t-compiler/performance/topic/triage.202021.2014.2009.html#253442504">(Sep 15 2021 at 16:18)</a>:</h4>
<p>I would be interested to learn about how you use cachegrind too. Haven't used that before and sometimes <code>perf</code> doesn't cut it.</p>



<hr><p>Last updated: Apr 12 2022 at 20:01 UTC</p>
</html>