<html>
<head><meta charset="utf-8"><title>erroneously marked as perf-regression · t-compiler/performance · Zulip Chat Archive</title></head>
<h2>Stream: <a href="https://zulip-archive.rust-lang.org/stream/247081-t-compiler/performance/index.html">t-compiler/performance</a></h2>
<h3>Topic: <a href="https://zulip-archive.rust-lang.org/stream/247081-t-compiler/performance/topic/erroneously.20marked.20as.20perf-regression.html">erroneously marked as perf-regression</a></h3>

<hr>

<base href="https://rust-lang.zulipchat.com">

<head><link href="https://zulip-archive.rust-lang.org/style.css" rel="stylesheet"></head>

<a name="251788087"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/247081-t-compiler/performance/topic/erroneously%20marked%20as%20perf-regression/near/251788087" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Noah Lev <a href="https://zulip-archive.rust-lang.org/stream/247081-t-compiler/performance/topic/erroneously.20marked.20as.20perf-regression.html#251788087">(Sep 02 2021 at 21:19)</a>:</h4>
<p>Hi all, my PR (<a href="https://github.com/rust-lang/rust/issues/88574">#88574</a>) was marked as a <code>perf-regression</code>, but I think the reported regressions are spurious because they are in rustc benchmarks while this is a rustdoc-only change. Also, the reported perf changes were for <code>deep-vector</code>, which IIRC often shows spurious perf changes. Should I remove the <code>perf-regression</code> label? I wanted to check to make sure I follow the right protocol for this :)</p>



<a name="251834646"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/247081-t-compiler/performance/topic/erroneously%20marked%20as%20perf-regression/near/251834646" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> rylev <a href="https://zulip-archive.rust-lang.org/stream/247081-t-compiler/performance/topic/erroneously.20marked.20as.20perf-regression.html#251834646">(Sep 03 2021 at 07:37)</a>:</h4>
<p>Yes, it's a fine to remove the label (since it's not actually a regression at all so justifying it doesn't really make any sense). Please leave a comment saying that the perf results are noise.</p>



<a name="251834832"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/247081-t-compiler/performance/topic/erroneously%20marked%20as%20perf-regression/near/251834832" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> rylev <a href="https://zulip-archive.rust-lang.org/stream/247081-t-compiler/performance/topic/erroneously.20marked.20as.20perf-regression.html#251834832">(Sep 03 2021 at 07:39)</a>:</h4>
<p>It is concerning to see a result as large as -0.56% in effectively a noop run, since 0.2% is our cut off for whether to consider changes real or not. But I think this is the price we pay for not running many iterations.</p>



<a name="251932817"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/247081-t-compiler/performance/topic/erroneously%20marked%20as%20perf-regression/near/251932817" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Noah Lev <a href="https://zulip-archive.rust-lang.org/stream/247081-t-compiler/performance/topic/erroneously.20marked.20as.20perf-regression.html#251932817">(Sep 03 2021 at 19:46)</a>:</h4>
<p>Ok, thanks! I've removed the label.</p>



<a name="251932878"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/247081-t-compiler/performance/topic/erroneously%20marked%20as%20perf-regression/near/251932878" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Noah Lev <a href="https://zulip-archive.rust-lang.org/stream/247081-t-compiler/performance/topic/erroneously.20marked.20as.20perf-regression.html#251932878">(Sep 03 2021 at 19:47)</a>:</h4>
<p><span class="user-mention silent" data-user-id="116122">simulacrum</span> also did a second perf run, and <a href="https://github.com/rust-lang/rust/pull/88574#issuecomment-912771379">it showed the exact opposite results</a> of the first run, so that confirms the spuriousness.</p>



<a name="252351122"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/247081-t-compiler/performance/topic/erroneously%20marked%20as%20perf-regression/near/252351122" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pnkfelix <a href="https://zulip-archive.rust-lang.org/stream/247081-t-compiler/performance/topic/erroneously.20marked.20as.20perf-regression.html#252351122">(Sep 07 2021 at 18:35)</a>:</h4>
<p>that’s an interesting idea: would it make any sense for us to automatically do a second run if we see only small (but supposedly real) deltas in the first run? (This reminds me again of the <a href="https://dl.acm.org/doi/pdf/10.1145/2555670.2464160">Rigorous Benchmarking in Reasonable Time</a> paper)</p>



<a name="252501686"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/247081-t-compiler/performance/topic/erroneously%20marked%20as%20perf-regression/near/252501686" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Noah Lev <a href="https://zulip-archive.rust-lang.org/stream/247081-t-compiler/performance/topic/erroneously.20marked.20as.20perf-regression.html#252501686">(Sep 08 2021 at 17:36)</a>:</h4>
<p>That could be interesting, although it'd have to be carefully designed so it didn't keep running perf over and over in an infinite loop ;)</p>



<a name="252501788"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/247081-t-compiler/performance/topic/erroneously%20marked%20as%20perf-regression/near/252501788" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Noah Lev <a href="https://zulip-archive.rust-lang.org/stream/247081-t-compiler/performance/topic/erroneously.20marked.20as.20perf-regression.html#252501788">(Sep 08 2021 at 17:37)</a>:</h4>
<p>Also, it might make sense to only do it if the deltas are mixed, because I'd assume lots of PRs have small but supposedly real deltas, but they might all be slightly positive or slightly negative, and the case where they are mixed is more likely to be spurious.</p>



<a name="252502128"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/247081-t-compiler/performance/topic/erroneously%20marked%20as%20perf-regression/near/252502128" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> The 8472 <a href="https://zulip-archive.rust-lang.org/stream/247081-t-compiler/performance/topic/erroneously.20marked.20as.20perf-regression.html#252502128">(Sep 08 2021 at 17:39)</a>:</h4>
<p>AIUI most benchmarks already are executed multiple times, so we're already throwing away data by showing only a single sample instead of multiple</p>



<hr><p>Last updated: Apr 12 2022 at 20:01 UTC</p>
</html>