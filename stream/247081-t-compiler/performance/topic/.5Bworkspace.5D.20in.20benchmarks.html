<html>
<head><meta charset="utf-8"><title>[workspace] in benchmarks · t-compiler/performance · Zulip Chat Archive</title></head>
<h2>Stream: <a href="https://zulip-archive.rust-lang.org/stream/247081-t-compiler/performance/index.html">t-compiler/performance</a></h2>
<h3>Topic: <a href="https://zulip-archive.rust-lang.org/stream/247081-t-compiler/performance/topic/.5Bworkspace.5D.20in.20benchmarks.html">[workspace] in benchmarks</a></h3>

<hr>

<base href="https://rust-lang.zulipchat.com">

<head><link href="https://zulip-archive.rust-lang.org/style.css" rel="stylesheet"></head>

<a name="275721104"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/247081-t-compiler/performance/topic/%5Bworkspace%5D%20in%20benchmarks/near/275721104" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nnethercote <a href="https://zulip-archive.rust-lang.org/stream/247081-t-compiler/performance/topic/.5Bworkspace.5D.20in.20benchmarks.html#275721104">(Mar 17 2022 at 20:28)</a>:</h4>
<p>Should I be adding an empty <code>[workspace]</code> to <code>Cargo.toml</code> of new benchmarks? I didn't do that with <code>cargo-0.60.0</code>, but I can add it now and put it on my checklist for future ones.</p>



<a name="275721218"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/247081-t-compiler/performance/topic/%5Bworkspace%5D%20in%20benchmarks/near/275721218" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> simulacrum <a href="https://zulip-archive.rust-lang.org/stream/247081-t-compiler/performance/topic/.5Bworkspace.5D.20in.20benchmarks.html#275721218">(Mar 17 2022 at 20:28)</a>:</h4>
<p>Hm</p>



<a name="275721232"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/247081-t-compiler/performance/topic/%5Bworkspace%5D%20in%20benchmarks/near/275721232" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> simulacrum <a href="https://zulip-archive.rust-lang.org/stream/247081-t-compiler/performance/topic/.5Bworkspace.5D.20in.20benchmarks.html#275721232">(Mar 17 2022 at 20:28)</a>:</h4>
<p>I think it's necessary if you want to directly cd &amp;&amp; cargo ...</p>



<a name="275721261"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/247081-t-compiler/performance/topic/%5Bworkspace%5D%20in%20benchmarks/near/275721261" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> simulacrum <a href="https://zulip-archive.rust-lang.org/stream/247081-t-compiler/performance/topic/.5Bworkspace.5D.20in.20benchmarks.html#275721261">(Mar 17 2022 at 20:29)</a>:</h4>
<p>seems like a good standard practice, we should get the download script to insert it</p>



<a name="275721623"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/247081-t-compiler/performance/topic/%5Bworkspace%5D%20in%20benchmarks/near/275721623" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nnethercote <a href="https://zulip-archive.rust-lang.org/stream/247081-t-compiler/performance/topic/.5Bworkspace.5D.20in.20benchmarks.html#275721623">(Mar 17 2022 at 20:31)</a>:</h4>
<p>It would need to handle if there is already a <code>[workspace]</code>, e.g. <code>diesel</code></p>



<a name="275721716"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/247081-t-compiler/performance/topic/%5Bworkspace%5D%20in%20benchmarks/near/275721716" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nnethercote <a href="https://zulip-archive.rust-lang.org/stream/247081-t-compiler/performance/topic/.5Bworkspace.5D.20in.20benchmarks.html#275721716">(Mar 17 2022 at 20:32)</a>:</h4>
<p>Maybe just grep for workspace in the <code>Cargo.toml</code>, and if it's already present, don't do anything but print a message saying "I didn't add workspace"</p>



<a name="275722019"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/247081-t-compiler/performance/topic/%5Bworkspace%5D%20in%20benchmarks/near/275722019" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nnethercote <a href="https://zulip-archive.rust-lang.org/stream/247081-t-compiler/performance/topic/.5Bworkspace.5D.20in.20benchmarks.html#275722019">(Mar 17 2022 at 20:34)</a>:</h4>
<p><code>ripgrep</code> and <code>serde</code> are other examples that already have workspaces</p>



<a name="275722077"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/247081-t-compiler/performance/topic/%5Bworkspace%5D%20in%20benchmarks/near/275722077" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> lqd <a href="https://zulip-archive.rust-lang.org/stream/247081-t-compiler/performance/topic/.5Bworkspace.5D.20in.20benchmarks.html#275722077">(Mar 17 2022 at 20:34)</a>:</h4>
<p>is the perf-config.json file now also mandatory for benchmark categorization ?</p>



<a name="275722985"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/247081-t-compiler/performance/topic/%5Bworkspace%5D%20in%20benchmarks/near/275722985" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> simulacrum <a href="https://zulip-archive.rust-lang.org/stream/247081-t-compiler/performance/topic/.5Bworkspace.5D.20in.20benchmarks.html#275722985">(Mar 17 2022 at 20:40)</a>:</h4>
<p>Yeah, if it's already there it should be fine out of the box I suspect</p>



<a name="275724008"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/247081-t-compiler/performance/topic/%5Bworkspace%5D%20in%20benchmarks/near/275724008" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nnethercote <a href="https://zulip-archive.rust-lang.org/stream/247081-t-compiler/performance/topic/.5Bworkspace.5D.20in.20benchmarks.html#275724008">(Mar 17 2022 at 20:46)</a>:</h4>
<p>@lqd: yes, perf-config.json is mandatory, and the <code>download</code> command adds one</p>



<a name="275724237"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/247081-t-compiler/performance/topic/%5Bworkspace%5D%20in%20benchmarks/near/275724237" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nnethercote <a href="https://zulip-archive.rust-lang.org/stream/247081-t-compiler/performance/topic/.5Bworkspace.5D.20in.20benchmarks.html#275724237">(Mar 17 2022 at 20:48)</a>:</h4>
<p>Interesting that <a href="https://perf.rust-lang.org/status.html">https://perf.rust-lang.org/status.html</a> lists every benchmarks that's ever been in the suite, even long-gone ones like <code>hyper</code></p>



<a name="275725657"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/247081-t-compiler/performance/topic/%5Bworkspace%5D%20in%20benchmarks/near/275725657" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> simulacrum <a href="https://zulip-archive.rust-lang.org/stream/247081-t-compiler/performance/topic/.5Bworkspace.5D.20in.20benchmarks.html#275725657">(Mar 17 2022 at 20:58)</a>:</h4>
<p>It's for the same reason we have graphs for them, I think.</p>



<a name="275790721"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/247081-t-compiler/performance/topic/%5Bworkspace%5D%20in%20benchmarks/near/275790721" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jakub Beránek <a href="https://zulip-archive.rust-lang.org/stream/247081-t-compiler/performance/topic/.5Bworkspace.5D.20in.20benchmarks.html#275790721">(Mar 18 2022 at 11:39)</a>:</h4>
<p><a href="https://github.com/rust-lang/rustc-perf/pull/1183#pullrequestreview-893497484">https://github.com/rust-lang/rustc-perf/pull/1183#pullrequestreview-893497484</a> I did that originally, but then we kind of decided against it?</p>



<a name="275948681"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/247081-t-compiler/performance/topic/%5Bworkspace%5D%20in%20benchmarks/near/275948681" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nnethercote <a href="https://zulip-archive.rust-lang.org/stream/247081-t-compiler/performance/topic/.5Bworkspace.5D.20in.20benchmarks.html#275948681">(Mar 20 2022 at 05:14)</a>:</h4>
<p><span class="user-mention" data-user-id="266526">@Jakub Beránek</span> is adding the <code>[workspace]</code> after doing the lockfile generation ok?</p>



<a name="275951127"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/247081-t-compiler/performance/topic/%5Bworkspace%5D%20in%20benchmarks/near/275951127" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jakub Beránek <a href="https://zulip-archive.rust-lang.org/stream/247081-t-compiler/performance/topic/.5Bworkspace.5D.20in.20benchmarks.html#275951127">(Mar 20 2022 at 06:26)</a>:</h4>
<p>I think that it should be fine (if the Cargo.toml doesn't already contain a workspace attribute, of course).</p>



<hr><p>Last updated: Apr 12 2022 at 20:01 UTC</p>
</html>