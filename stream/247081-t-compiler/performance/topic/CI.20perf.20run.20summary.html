<html>
<head><meta charset="utf-8"><title>CI perf run summary · t-compiler/performance · Zulip Chat Archive</title></head>
<h2>Stream: <a href="https://zulip-archive.rust-lang.org/stream/247081-t-compiler/performance/index.html">t-compiler/performance</a></h2>
<h3>Topic: <a href="https://zulip-archive.rust-lang.org/stream/247081-t-compiler/performance/topic/CI.20perf.20run.20summary.html">CI perf run summary</a></h3>

<hr>

<base href="https://rust-lang.zulipchat.com">

<head><link href="https://zulip-archive.rust-lang.org/style.css" rel="stylesheet"></head>

<a name="273425445"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/247081-t-compiler/performance/topic/CI%20perf%20run%20summary/near/273425445" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nnethercote <a href="https://zulip-archive.rust-lang.org/stream/247081-t-compiler/performance/topic/CI.20perf.20run.20summary.html#273425445">(Feb 27 2022 at 21:12)</a>:</h4>
<p><a href="https://github.com/rust-lang/rust/pull/94084#issuecomment-1053631207">https://github.com/rust-lang/rust/pull/94084#issuecomment-1053631207</a> mentions the number of improvements, but not the number of regressions. Which then makes the "Arithmetic mean of relevant regressions: 1.1%" line surprising</p>



<a name="273425453"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/247081-t-compiler/performance/topic/CI%20perf%20run%20summary/near/273425453" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nnethercote <a href="https://zulip-archive.rust-lang.org/stream/247081-t-compiler/performance/topic/CI.20perf.20run.20summary.html#273425453">(Feb 27 2022 at 21:13)</a>:</h4>
<p><span class="user-mention" data-user-id="266526">@Jakub Beránek</span> Any idea why it does this?</p>



<a name="273425707"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/247081-t-compiler/performance/topic/CI%20perf%20run%20summary/near/273425707" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> simulacrum <a href="https://zulip-archive.rust-lang.org/stream/247081-t-compiler/performance/topic/CI.20perf.20run.20summary.html#273425707">(Feb 27 2022 at 21:19)</a>:</h4>
<p><a href="https://github.com/rust-lang/rustc-perf/blob/master/site/src/github.rs#L712">https://github.com/rust-lang/rustc-perf/blob/master/site/src/github.rs#L712</a> only lists regressions if direction is mixed -- which requires <a href="https://github.com/rust-lang/rustc-perf/blob/master/site/src/comparison.rs#L240">https://github.com/rust-lang/rustc-perf/blob/master/site/src/comparison.rs#L240</a></p>



<a name="273426593"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/247081-t-compiler/performance/topic/CI%20perf%20run%20summary/near/273426593" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> lqd <a href="https://zulip-archive.rust-lang.org/stream/247081-t-compiler/performance/topic/CI.20perf.20run.20summary.html#273426593">(Feb 27 2022 at 21:37)</a>:</h4>
<p>does this mean that PRs with a small number of small regressions will not be considered as regressions anymore ?</p>



<a name="273426992"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/247081-t-compiler/performance/topic/CI%20perf%20run%20summary/near/273426992" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> simulacrum <a href="https://zulip-archive.rust-lang.org/stream/247081-t-compiler/performance/topic/CI.20perf.20run.20summary.html#273426992">(Feb 27 2022 at 21:47)</a>:</h4>
<p>I don't think this is <em>new</em> behavior</p>



<a name="273427236"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/247081-t-compiler/performance/topic/CI%20perf%20run%20summary/near/273427236" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> lqd <a href="https://zulip-archive.rust-lang.org/stream/247081-t-compiler/performance/topic/CI.20perf.20run.20summary.html#273427236">(Feb 27 2022 at 21:53)</a>:</h4>
<p>oh ok, I see. thanks</p>



<a name="273427240"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/247081-t-compiler/performance/topic/CI%20perf%20run%20summary/near/273427240" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> simulacrum <a href="https://zulip-archive.rust-lang.org/stream/247081-t-compiler/performance/topic/CI.20perf.20run.20summary.html#273427240">(Feb 27 2022 at 21:53)</a>:</h4>
<p>we're still iterating on the right way to display results so that they're meaningful and not noisy</p>



<a name="273427244"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/247081-t-compiler/performance/topic/CI%20perf%20run%20summary/near/273427244" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> simulacrum <a href="https://zulip-archive.rust-lang.org/stream/247081-t-compiler/performance/topic/CI.20perf.20run.20summary.html#273427244">(Feb 27 2022 at 21:53)</a>:</h4>
<p>I think this case in particular is one we probably are getting it wrong, though it's unclear</p>



<a name="273427299"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/247081-t-compiler/performance/topic/CI%20perf%20run%20summary/near/273427299" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> simulacrum <a href="https://zulip-archive.rust-lang.org/stream/247081-t-compiler/performance/topic/CI.20perf.20run.20summary.html#273427299">(Feb 27 2022 at 21:54)</a>:</h4>
<p>In particular, I think we sometimes are <em>too</em> eager to categorize things as regressions/mixed, but it's hard to make that evaluation automatically.</p>



<a name="273428558"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/247081-t-compiler/performance/topic/CI%20perf%20run%20summary/near/273428558" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nnethercote <a href="https://zulip-archive.rust-lang.org/stream/247081-t-compiler/performance/topic/CI.20perf.20run.20summary.html#273428558">(Feb 27 2022 at 22:23)</a>:</h4>
<p>I see. I think it would be good to always show all the top line numbers (number of improvements and regressions, plus the arithmetic means) and then categorize that as improvement/mixed/regression in a way that makes is clear it's an automated/heuristic classification.</p>



<a name="273428633"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/247081-t-compiler/performance/topic/CI%20perf%20run%20summary/near/273428633" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nnethercote <a href="https://zulip-archive.rust-lang.org/stream/247081-t-compiler/performance/topic/CI.20perf.20run.20summary.html#273428633">(Feb 27 2022 at 22:25)</a>:</h4>
<p>Actually, this makes clear why I've always found this sentence strange: "If you disagree with this performance assessment, please file an issue in rust-lang/rustc-perf."  Because the text above that sentence is mostly measurements, combined with an automated classification. I see now the sentence is actually referring to the classification... it's hard to disagree with the measurements <span aria-label="smile" class="emoji emoji-1f642" role="img" title="smile">:smile:</span></p>



<a name="273428954"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/247081-t-compiler/performance/topic/CI%20perf%20run%20summary/near/273428954" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nnethercote <a href="https://zulip-archive.rust-lang.org/stream/247081-t-compiler/performance/topic/CI.20perf.20run.20summary.html#273428954">(Feb 27 2022 at 22:31)</a>:</h4>
<p>So it would be clearer if it was something like:</p>
<div class="codehilite"><pre><span></span><code>This benchmark run shows 55 relevant improvements and 9 relevant regressions to instruction counts.
- Arithmetic mean of relevant regressions: 1.1%
- Arithmetic mean of relevant improvements: -0.8%
- Arithmetic mean of all relevant changes: -0.6%
- Largest improvement in instruction counts: -2.3% on full builds of keccak check

Based on these measurements, we have automatically assessed this result as an *improvement*.

If you disagree with this performance assessment, please file an issue in rust-lang/rustc-perf.
</code></pre></div>



<a name="273428961"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/247081-t-compiler/performance/topic/CI%20perf%20run%20summary/near/273428961" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nnethercote <a href="https://zulip-archive.rust-lang.org/stream/247081-t-compiler/performance/topic/CI.20perf.20run.20summary.html#273428961">(Feb 27 2022 at 22:31)</a>:</h4>
<p>I.e. facts first, automated assessment second</p>



<a name="273429005"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/247081-t-compiler/performance/topic/CI%20perf%20run%20summary/near/273429005" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> simulacrum <a href="https://zulip-archive.rust-lang.org/stream/247081-t-compiler/performance/topic/CI.20perf.20run.20summary.html#273429005">(Feb 27 2022 at 22:32)</a>:</h4>
<p>Yeah, that seems ok to me</p>



<hr><p>Last updated: Apr 12 2022 at 20:01 UTC</p>
</html>