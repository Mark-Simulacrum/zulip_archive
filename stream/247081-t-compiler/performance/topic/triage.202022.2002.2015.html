<html>
<head><meta charset="utf-8"><title>triage 2022 02 15 · t-compiler/performance · Zulip Chat Archive</title></head>
<h2>Stream: <a href="https://zulip-archive.rust-lang.org/stream/247081-t-compiler/performance/index.html">t-compiler/performance</a></h2>
<h3>Topic: <a href="https://zulip-archive.rust-lang.org/stream/247081-t-compiler/performance/topic/triage.202022.2002.2015.html">triage 2022 02 15</a></h3>

<hr>

<base href="https://rust-lang.zulipchat.com">

<head><link href="https://zulip-archive.rust-lang.org/style.css" rel="stylesheet"></head>

<a name="272071047"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/247081-t-compiler/performance/topic/triage%202022%2002%2015/near/272071047" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pnkfelix <a href="https://zulip-archive.rust-lang.org/stream/247081-t-compiler/performance/topic/triage.202022.2002.2015.html#272071047">(Feb 16 2022 at 03:59)</a>:</h4>
<p>Hey y'all. I forgot to start triage today; I'll be taking care of it tomorrow.</p>



<a name="272135370"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/247081-t-compiler/performance/topic/triage%202022%2002%2015/near/272135370" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pnkfelix <a href="https://zulip-archive.rust-lang.org/stream/247081-t-compiler/performance/topic/triage.202022.2002.2015.html#272135370">(Feb 16 2022 at 16:00)</a>:</h4>
<p>okay starting triage now</p>



<a name="272181357"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/247081-t-compiler/performance/topic/triage%202022%2002%2015/near/272181357" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pnkfelix <a href="https://zulip-archive.rust-lang.org/stream/247081-t-compiler/performance/topic/triage.202022.2002.2015.html#272181357">(Feb 16 2022 at 21:26)</a>:</h4>
<p>Dumb question: Why isn't PR <a href="https://github.com/rust-lang/rust/issues/94021">#94021</a> "Inline a few trivial conversion functions" classified as an improvement?  The summary says "103 results were found to be statistically significant but too small to be relevant.", but several of the results are -0.75% or better, all the way up to -1.06%. Is -1% too small to note?</p>



<a name="272181886"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/247081-t-compiler/performance/topic/triage%202022%2002%2015/near/272181886" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> simulacrum <a href="https://zulip-archive.rust-lang.org/stream/247081-t-compiler/performance/topic/triage.202022.2002.2015.html#272181886">(Feb 16 2022 at 21:31)</a>:</h4>
<p>We need it to be definitely relevant for master commits (try builds only require at least probably relevance). Definitely relevant currently requires a 'medium' change -- which I believe means it's over the significance threshold by more than 3x</p>



<a name="272181916"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/247081-t-compiler/performance/topic/triage%202022%2002%2015/near/272181916" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pnkfelix <a href="https://zulip-archive.rust-lang.org/stream/247081-t-compiler/performance/topic/triage.202022.2002.2015.html#272181916">(Feb 16 2022 at 21:31)</a>:</h4>
<p>triage PR: <a href="https://github.com/rust-lang/rustc-perf/pull/1173">https://github.com/rust-lang/rustc-perf/pull/1173</a></p>



<a name="272181933"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/247081-t-compiler/performance/topic/triage%202022%2002%2015/near/272181933" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pnkfelix <a href="https://zulip-archive.rust-lang.org/stream/247081-t-compiler/performance/topic/triage.202022.2002.2015.html#272181933">(Feb 16 2022 at 21:31)</a>:</h4>
<p>TWIR PR: <a href="https://github.com/rust-lang/this-week-in-rust/pull/2950">https://github.com/rust-lang/this-week-in-rust/pull/2950</a></p>



<a name="272181934"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/247081-t-compiler/performance/topic/triage%202022%2002%2015/near/272181934" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> simulacrum <a href="https://zulip-archive.rust-lang.org/stream/247081-t-compiler/performance/topic/triage.202022.2002.2015.html#272181934">(Feb 16 2022 at 21:31)</a>:</h4>
<p>though I do see a couple that are over there, at least at first glance - e.g., 3.35x</p>



<a name="272181966"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/247081-t-compiler/performance/topic/triage%202022%2002%2015/near/272181966" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pnkfelix <a href="https://zulip-archive.rust-lang.org/stream/247081-t-compiler/performance/topic/triage.202022.2002.2015.html#272181966">(Feb 16 2022 at 21:31)</a>:</h4>
<p><span class="user-mention silent" data-user-id="116122">simulacrum</span> <a href="#narrow/stream/247081-t-compiler.2Fperformance/topic/triage.202022.2002.2015/near/272181886">said</a>:</p>
<blockquote>
<p>We need it to be definitely relevant for master commits (try builds only require at least probably relevance). Definitely relevant currently requires a 'medium' change -- which I believe means it's over the significance threshold by more than 3x</p>
</blockquote>
<p>okay. I manually reclassified it as "improvement" in this weeks report</p>



<a name="272181972"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/247081-t-compiler/performance/topic/triage%202022%2002%2015/near/272181972" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pnkfelix <a href="https://zulip-archive.rust-lang.org/stream/247081-t-compiler/performance/topic/triage.202022.2002.2015.html#272181972">(Feb 16 2022 at 21:32)</a>:</h4>
<p>and I'll go back over the data later</p>



<a name="272181973"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/247081-t-compiler/performance/topic/triage%202022%2002%2015/near/272181973" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> simulacrum <a href="https://zulip-archive.rust-lang.org/stream/247081-t-compiler/performance/topic/triage.202022.2002.2015.html#272181973">(Feb 16 2022 at 21:32)</a>:</h4>
<p>seems good</p>



<a name="272182046"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/247081-t-compiler/performance/topic/triage%202022%2002%2015/near/272182046" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> simulacrum <a href="https://zulip-archive.rust-lang.org/stream/247081-t-compiler/performance/topic/triage.202022.2002.2015.html#272182046">(Feb 16 2022 at 21:32)</a>:</h4>
<p>actually, I think I'm misreading code -- let me actually rip out the calc_new_sig threading, it seems pretty clear we're going with it</p>



<a name="272182111"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/247081-t-compiler/performance/topic/triage%202022%2002%2015/near/272182111" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> simulacrum <a href="https://zulip-archive.rust-lang.org/stream/247081-t-compiler/performance/topic/triage.202022.2002.2015.html#272182111">(Feb 16 2022 at 21:33)</a>:</h4>
<p>oh, we're more fancy than just 3x</p>



<a name="272182276"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/247081-t-compiler/performance/topic/triage%202022%2002%2015/near/272182276" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> simulacrum <a href="https://zulip-archive.rust-lang.org/stream/247081-t-compiler/performance/topic/triage.202022.2002.2015.html#272182276">(Feb 16 2022 at 21:34)</a>:</h4>
<p>The current logic is that we need to be &gt;3x significance threshold <em>and</em> avg(significance magnitude, change magnitude)  is at least medium</p>



<a name="272182297"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/247081-t-compiler/performance/topic/triage%202022%2002%2015/near/272182297" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> simulacrum <a href="https://zulip-archive.rust-lang.org/stream/247081-t-compiler/performance/topic/triage.202022.2002.2015.html#272182297">(Feb 16 2022 at 21:34)</a>:</h4>
<p>er, no</p>



<a name="272182303"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/247081-t-compiler/performance/topic/triage%202022%2002%2015/near/272182303" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> simulacrum <a href="https://zulip-archive.rust-lang.org/stream/247081-t-compiler/performance/topic/triage.202022.2002.2015.html#272182303">(Feb 16 2022 at 21:34)</a>:</h4>
<p>just that the average is at least medium</p>



<a name="272182370"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/247081-t-compiler/performance/topic/triage%202022%2002%2015/near/272182370" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> simulacrum <a href="https://zulip-archive.rust-lang.org/stream/247081-t-compiler/performance/topic/triage.202022.2002.2015.html#272182370">(Feb 16 2022 at 21:35)</a>:</h4>
<p>which basically means that &gt;3x and change &gt; 1% I think?</p>



<a name="272182380"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/247081-t-compiler/performance/topic/triage%202022%2002%2015/near/272182380" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> simulacrum <a href="https://zulip-archive.rust-lang.org/stream/247081-t-compiler/performance/topic/triage.202022.2002.2015.html#272182380">(Feb 16 2022 at 21:35)</a>:</h4>
<p>(or one of those is significantly higher, of course)</p>



<a name="272186870"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/247081-t-compiler/performance/topic/triage%202022%2002%2015/near/272186870" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pnkfelix <a href="https://zulip-archive.rust-lang.org/stream/247081-t-compiler/performance/topic/triage.202022.2002.2015.html#272186870">(Feb 16 2022 at 22:14)</a>:</h4>
<p>hmm, I see. in this case the ones that were &gt;=3x significance were below 1% change (just barely), and the one that was above 1% change was below 3x significance (just barely in one case)</p>



<a name="272187065"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/247081-t-compiler/performance/topic/triage%202022%2002%2015/near/272187065" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pnkfelix <a href="https://zulip-archive.rust-lang.org/stream/247081-t-compiler/performance/topic/triage.202022.2002.2015.html#272187065">(Feb 16 2022 at 22:15)</a>:</h4>
<p>So, probably still worth calling out as an actual improvement, given how borderline it was, but it wouldnt have been a disaster to classify it as non-change...</p>



<a name="272196002"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/247081-t-compiler/performance/topic/triage%202022%2002%2015/near/272196002" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pnkfelix <a href="https://zulip-archive.rust-lang.org/stream/247081-t-compiler/performance/topic/triage.202022.2002.2015.html#272196002">(Feb 16 2022 at 23:50)</a>:</h4>
<p>Thanks for the fix <span class="user-mention" data-user-id="116122">@simulacrum</span> ! I caught it on TWIR but forgot to back port my fix <span aria-label="joy" class="emoji emoji-1f602" role="img" title="joy">:joy:</span></p>



<a name="272230786"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/247081-t-compiler/performance/topic/triage%202022%2002%2015/near/272230786" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> rylev <a href="https://zulip-archive.rust-lang.org/stream/247081-t-compiler/performance/topic/triage.202022.2002.2015.html#272230786">(Feb 17 2022 at 09:02)</a>:</h4>
<p>I spent a bit of time bashing my head over how to classify relevance. It's fairly easy to make a definition of "significance" that's based (at least loosely) in statistical significance, but relevance is often much more subjective. Ideally you want the change to be sufficiently large <em>and</em> the magnitude of the change to be sufficiently large. This avoids classifying changes from 0.01% to 0.2% (a 20x change!) as relevant since the actual change is still small.</p>



<a name="272230882"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/247081-t-compiler/performance/topic/triage%202022%2002%2015/near/272230882" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> rylev <a href="https://zulip-archive.rust-lang.org/stream/247081-t-compiler/performance/topic/triage.202022.2002.2015.html#272230882">(Feb 17 2022 at 09:03)</a>:</h4>
<p>An additional challenge with this is that some test cases are more variable than others. Ideally, we would be able to account for this variance and report relevance when we're sure that the change we're seeing is real and not just noise (or primarily contributed to by noise)</p>



<a name="272251592"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/247081-t-compiler/performance/topic/triage%202022%2002%2015/near/272251592" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> The 8472 <a href="https://zulip-archive.rust-lang.org/stream/247081-t-compiler/performance/topic/triage.202022.2002.2015.html#272251592">(Feb 17 2022 at 12:27)</a>:</h4>
<p>maybe subtract <del>variance</del> deviation from the magnitude?</p>



<hr><p>Last updated: Apr 12 2022 at 20:01 UTC</p>
</html>