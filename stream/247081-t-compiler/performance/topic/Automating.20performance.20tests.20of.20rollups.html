<html>
<head><meta charset="utf-8"><title>Automating performance tests of rollups · t-compiler/performance · Zulip Chat Archive</title></head>
<h2>Stream: <a href="https://zulip-archive.rust-lang.org/stream/247081-t-compiler/performance/index.html">t-compiler/performance</a></h2>
<h3>Topic: <a href="https://zulip-archive.rust-lang.org/stream/247081-t-compiler/performance/topic/Automating.20performance.20tests.20of.20rollups.html">Automating performance tests of rollups</a></h3>

<hr>

<base href="https://rust-lang.zulipchat.com">

<head><link href="https://zulip-archive.rust-lang.org/style.css" rel="stylesheet"></head>

<a name="276442128"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/247081-t-compiler/performance/topic/Automating%20performance%20tests%20of%20rollups/near/276442128" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jakub Beránek <a href="https://zulip-archive.rust-lang.org/stream/247081-t-compiler/performance/topic/Automating.20performance.20tests.20of.20rollups.html#276442128">(Mar 24 2022 at 08:06)</a>:</h4>
<p>It seems to me that it's not uncommon that there are some performance regressions (or improvements) in rollups that were not expected. It's quite difficult to find what PR caused the regression in that case and currently it is done manually, which is quite cumbersome.</p>
<p>What about creating some automation for this? Some script could go through a rollup, try each PR in isolation (or maybe better yet try to revert just that PR if it helps), perf. test it and let the user know what could be the culprit. It could be a local script that would execute on one's computer, but then the environment would not be the same as on CI. Ideally it could actually spawn the perf. tests on CI, benchmark all (or selected) rollup PRs and then create some summary that would quickly show what could be the culprit. Even more ideally, it could do this without creating N useless PRs.</p>



<a name="276457969"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/247081-t-compiler/performance/topic/Automating%20performance%20tests%20of%20rollups/near/276457969" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> bjorn3 <a href="https://zulip-archive.rust-lang.org/stream/247081-t-compiler/performance/topic/Automating.20performance.20tests.20of.20rollups.html#276457969">(Mar 24 2022 at 10:50)</a>:</h4>
<p>We already have <code>@rust-timer make-pr-for</code>. Seems to have a bug around rollups though: <a href="https://github.com/rust-lang/rustc-perf/issues/832">https://github.com/rust-lang/rustc-perf/issues/832</a></p>



<a name="276459800"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/247081-t-compiler/performance/topic/Automating%20performance%20tests%20of%20rollups/near/276459800" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jakub Beránek <a href="https://zulip-archive.rust-lang.org/stream/247081-t-compiler/performance/topic/Automating.20performance.20tests.20of.20rollups.html#276459800">(Mar 24 2022 at 11:08)</a>:</h4>
<p>And what does <code>make-pr-for</code> do? (where can I find the code for the timer bot btw?)</p>



<a name="276461036"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/247081-t-compiler/performance/topic/Automating%20performance%20tests%20of%20rollups/near/276461036" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> lqd <a href="https://zulip-archive.rust-lang.org/stream/247081-t-compiler/performance/topic/Automating.20performance.20tests.20of.20rollups.html#276461036">(Mar 24 2022 at 11:20)</a>:</h4>
<p><a href="https://github.com/rust-lang/rustc-perf/blob/master/site/src/request_handlers/github.rs">https://github.com/rust-lang/rustc-perf/blob/master/site/src/request_handlers/github.rs</a> IIRC</p>



<a name="276463117"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/247081-t-compiler/performance/topic/Automating%20performance%20tests%20of%20rollups/near/276463117" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jakub Beránek <a href="https://zulip-archive.rust-lang.org/stream/247081-t-compiler/performance/topic/Automating.20performance.20tests.20of.20rollups.html#276463117">(Mar 24 2022 at 11:43)</a>:</h4>
<p>Ooh, I see, thanks, so it already is partly automated.</p>



<a name="276486219"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/247081-t-compiler/performance/topic/Automating%20performance%20tests%20of%20rollups/near/276486219" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> simulacrum <a href="https://zulip-archive.rust-lang.org/stream/247081-t-compiler/performance/topic/Automating.20performance.20tests.20of.20rollups.html#276486219">(Mar 24 2022 at 14:48)</a>:</h4>
<p>Yeah, fixing it would be great</p>



<a name="276486271"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/247081-t-compiler/performance/topic/Automating%20performance%20tests%20of%20rollups/near/276486271" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> simulacrum <a href="https://zulip-archive.rust-lang.org/stream/247081-t-compiler/performance/topic/Automating.20performance.20tests.20of.20rollups.html#276486271">(Mar 24 2022 at 14:48)</a>:</h4>
<p>I think I at one point diagnosed it and left a comment somewhere</p>



<hr><p>Last updated: Apr 12 2022 at 20:01 UTC</p>
</html>