<html>
<head><meta charset="utf-8"><title>native-tls-0.1.5 · t-compiler/performance · Zulip Chat Archive</title></head>
<h2>Stream: <a href="https://zulip-archive.rust-lang.org/stream/247081-t-compiler/performance/index.html">t-compiler/performance</a></h2>
<h3>Topic: <a href="https://zulip-archive.rust-lang.org/stream/247081-t-compiler/performance/topic/native-tls-0.2E1.2E5.html">native-tls-0.1.5</a></h3>

<hr>

<base href="https://rust-lang.zulipchat.com">

<head><link href="https://zulip-archive.rust-lang.org/style.css" rel="stylesheet"></head>

<a name="274060754"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/247081-t-compiler/performance/topic/native-tls-0.1.5/near/274060754" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nnethercote <a href="https://zulip-archive.rust-lang.org/stream/247081-t-compiler/performance/topic/native-tls-0.2E1.2E5.html#274060754">(Mar 04 2022 at 00:17)</a>:</h4>
<p><span class="user-mention" data-user-id="116122">@simulacrum</span> I'd like to move <code>native-tls-0.1.5</code> and <code>rust-mozjs</code> out of <code>collector/benchmarks/</code>, because they can cause confusion there -- they look like actual benchmarks.</p>



<a name="274060860"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/247081-t-compiler/performance/topic/native-tls-0.1.5/near/274060860" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nnethercote <a href="https://zulip-archive.rust-lang.org/stream/247081-t-compiler/performance/topic/native-tls-0.2E1.2E5.html#274060860">(Mar 04 2022 at 00:18)</a>:</h4>
<p>I'm looking at <code>native-tls-0.1.5</code> first. <code>tokio-webpush-simple/</code> has a symlink to the actual <code>native-tls-0.1.5</code> one directory down. Do you know why this is a symlink? Any reason why <code>native-tls-0.1.5</code> couldn't just be within <code>tokio-webpush-simple/</code>?</p>



<a name="274061429"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/247081-t-compiler/performance/topic/native-tls-0.1.5/near/274061429" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> simulacrum <a href="https://zulip-archive.rust-lang.org/stream/247081-t-compiler/performance/topic/native-tls-0.2E1.2E5.html#274061429">(Mar 04 2022 at 00:25)</a>:</h4>
<p>My rough recollection is that I thought it would be used by more benchmarks</p>



<a name="274061443"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/247081-t-compiler/performance/topic/native-tls-0.1.5/near/274061443" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> simulacrum <a href="https://zulip-archive.rust-lang.org/stream/247081-t-compiler/performance/topic/native-tls-0.2E1.2E5.html#274061443">(Mar 04 2022 at 00:25)</a>:</h4>
<p>But seems fine to move or duplicate</p>



<a name="274061449"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/247081-t-compiler/performance/topic/native-tls-0.1.5/near/274061449" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nnethercote <a href="https://zulip-archive.rust-lang.org/stream/247081-t-compiler/performance/topic/native-tls-0.2E1.2E5.html#274061449">(Mar 04 2022 at 00:25)</a>:</h4>
<p>I just tried removing the symlink and putting <code>native-tls-0.1.5</code> within <code>tokio-webpush-simple</code>, it seems to work</p>



<a name="274061469"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/247081-t-compiler/performance/topic/native-tls-0.1.5/near/274061469" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nnethercote <a href="https://zulip-archive.rust-lang.org/stream/247081-t-compiler/performance/topic/native-tls-0.2E1.2E5.html#274061469">(Mar 04 2022 at 00:25)</a>:</h4>
<p>Why does this crate need special handling?</p>



<a name="274061529"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/247081-t-compiler/performance/topic/native-tls-0.1.5/near/274061529" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> simulacrum <a href="https://zulip-archive.rust-lang.org/stream/247081-t-compiler/performance/topic/native-tls-0.2E1.2E5.html#274061529">(Mar 04 2022 at 00:26)</a>:</h4>
<p>It's the openssl issue, IIRC, where stubbing it out helps</p>



<a name="274061571"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/247081-t-compiler/performance/topic/native-tls-0.1.5/near/274061571" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> simulacrum <a href="https://zulip-archive.rust-lang.org/stream/247081-t-compiler/performance/topic/native-tls-0.2E1.2E5.html#274061571">(Mar 04 2022 at 00:26)</a>:</h4>
<p>I believe that native tls in tree is cut down from the normal version upstream</p>



<a name="274061631"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/247081-t-compiler/performance/topic/native-tls-0.1.5/near/274061631" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nnethercote <a href="https://zulip-archive.rust-lang.org/stream/247081-t-compiler/performance/topic/native-tls-0.2E1.2E5.html#274061631">(Mar 04 2022 at 00:27)</a>:</h4>
<p>Sorry, what is the OpenSSL issue?</p>



<a name="274061869"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/247081-t-compiler/performance/topic/native-tls-0.1.5/near/274061869" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> simulacrum <a href="https://zulip-archive.rust-lang.org/stream/247081-t-compiler/performance/topic/native-tls-0.2E1.2E5.html#274061869">(Mar 04 2022 at 00:30)</a>:</h4>
<p>I'm not sure if you remember but there was a period of time where if you had the wrong openssl headers or something we failed to run because openssl (the rust crate) required a particular version</p>



<a name="274062046"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/247081-t-compiler/performance/topic/native-tls-0.1.5/near/274062046" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> simulacrum <a href="https://zulip-archive.rust-lang.org/stream/247081-t-compiler/performance/topic/native-tls-0.2E1.2E5.html#274062046">(Mar 04 2022 at 00:30)</a>:</h4>
<p>I think this native-tls patch was aimed at fixing that</p>



<a name="274062145"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/247081-t-compiler/performance/topic/native-tls-0.1.5/near/274062145" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nnethercote <a href="https://zulip-archive.rust-lang.org/stream/247081-t-compiler/performance/topic/native-tls-0.2E1.2E5.html#274062145">(Mar 04 2022 at 00:31)</a>:</h4>
<p>ok, thanks</p>



<a name="274062477"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/247081-t-compiler/performance/topic/native-tls-0.1.5/near/274062477" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nnethercote <a href="https://zulip-archive.rust-lang.org/stream/247081-t-compiler/performance/topic/native-tls-0.2E1.2E5.html#274062477">(Mar 04 2022 at 00:36)</a>:</h4>
<p>As for <code>rust-mozjs</code>... I don't think it's used. I just tried renaming it <code>rust-mozjs-2</code> and style-servo compiled fine; it's the only benchmark that uses it.</p>



<a name="274062510"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/247081-t-compiler/performance/topic/native-tls-0.1.5/near/274062510" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nnethercote <a href="https://zulip-archive.rust-lang.org/stream/247081-t-compiler/performance/topic/native-tls-0.2E1.2E5.html#274062510">(Mar 04 2022 at 00:37)</a>:</h4>
<p>But <code>style-servo/components/script/Cargo.toml</code> has <code>js = {git = "https://github.com/servo/rust-mozjs", features = ["promises"]}</code></p>



<a name="274062912"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/247081-t-compiler/performance/topic/native-tls-0.1.5/near/274062912" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nnethercote <a href="https://zulip-archive.rust-lang.org/stream/247081-t-compiler/performance/topic/native-tls-0.2E1.2E5.html#274062912">(Mar 04 2022 at 00:42)</a>:</h4>
<p>/me deletes it</p>



<a name="274063413"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/247081-t-compiler/performance/topic/native-tls-0.1.5/near/274063413" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> simulacrum <a href="https://zulip-archive.rust-lang.org/stream/247081-t-compiler/performance/topic/native-tls-0.2E1.2E5.html#274063413">(Mar 04 2022 at 00:48)</a>:</h4>
<p>CI should confirm, but seems good</p>



<a name="274063467"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/247081-t-compiler/performance/topic/native-tls-0.1.5/near/274063467" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nnethercote <a href="https://zulip-archive.rust-lang.org/stream/247081-t-compiler/performance/topic/native-tls-0.2E1.2E5.html#274063467">(Mar 04 2022 at 00:49)</a>:</h4>
<p>Getting a CI failure twice in a row, on this:</p>
<div class="codehilite"><pre><span></span><code>E: Failed to fetch http://azure.archive.ubuntu.com/ubuntu/pool/main/g/glibc/libc6-dbg_2.31-0ubuntu9.2_amd64.deb  404  Not Found [IP: 40.81.13.82 80]
</code></pre></div>



<a name="274063476"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/247081-t-compiler/performance/topic/native-tls-0.1.5/near/274063476" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nnethercote <a href="https://zulip-archive.rust-lang.org/stream/247081-t-compiler/performance/topic/native-tls-0.2E1.2E5.html#274063476">(Mar 04 2022 at 00:49)</a>:</h4>
<p>Doesn't sound like my fault</p>



<a name="274063999"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/247081-t-compiler/performance/topic/native-tls-0.1.5/near/274063999" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> simulacrum <a href="https://zulip-archive.rust-lang.org/stream/247081-t-compiler/performance/topic/native-tls-0.2E1.2E5.html#274063999">(Mar 04 2022 at 00:56)</a>:</h4>
<p>Yes, I think it's in master. Needs some investigation and a fix</p>



<a name="274065149"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/247081-t-compiler/performance/topic/native-tls-0.1.5/near/274065149" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nnethercote <a href="https://zulip-archive.rust-lang.org/stream/247081-t-compiler/performance/topic/native-tls-0.2E1.2E5.html#274065149">(Mar 04 2022 at 01:10)</a>:</h4>
<p>It's failing when running <code>sudo apt install -y valgrind</code>, weird</p>



<a name="274091473"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/247081-t-compiler/performance/topic/native-tls-0.1.5/near/274091473" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> bjorn3 <a href="https://zulip-archive.rust-lang.org/stream/247081-t-compiler/performance/topic/native-tls-0.2E1.2E5.html#274091473">(Mar 04 2022 at 07:42)</a>:</h4>
<p>Try sudo apt update first. There may be a new version of glibc and the mirror having deleted the old one.</p>



<a name="274103969"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/247081-t-compiler/performance/topic/native-tls-0.1.5/near/274103969" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jakub Beránek <a href="https://zulip-archive.rust-lang.org/stream/247081-t-compiler/performance/topic/native-tls-0.2E1.2E5.html#274103969">(Mar 04 2022 at 09:43)</a>:</h4>
<p><a href="https://github.com/rust-lang/rustc-perf/pull/1190">https://github.com/rust-lang/rustc-perf/pull/1190</a> this should fix it, it worked for <a href="https://github.com/rust-lang/rustc-perf/runs/5420212641?check_suite_focus=true">https://github.com/rust-lang/rustc-perf/runs/5420212641?check_suite_focus=true</a>.</p>



<hr><p>Last updated: Apr 12 2022 at 20:01 UTC</p>
</html>