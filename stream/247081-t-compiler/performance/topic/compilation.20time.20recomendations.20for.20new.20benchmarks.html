<html>
<head><meta charset="utf-8"><title>compilation time recomendations for new benchmarks · t-compiler/performance · Zulip Chat Archive</title></head>
<h2>Stream: <a href="https://zulip-archive.rust-lang.org/stream/247081-t-compiler/performance/index.html">t-compiler/performance</a></h2>
<h3>Topic: <a href="https://zulip-archive.rust-lang.org/stream/247081-t-compiler/performance/topic/compilation.20time.20recomendations.20for.20new.20benchmarks.html">compilation time recomendations for new benchmarks</a></h3>

<hr>

<base href="https://rust-lang.zulipchat.com">

<head><link href="https://zulip-archive.rust-lang.org/style.css" rel="stylesheet"></head>

<a name="268439160"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/247081-t-compiler/performance/topic/compilation%20time%20recomendations%20for%20new%20benchmarks/near/268439160" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wesley Wiser <a href="https://zulip-archive.rust-lang.org/stream/247081-t-compiler/performance/topic/compilation.20time.20recomendations.20for.20new.20benchmarks.html#268439160">(Jan 18 2022 at 18:58)</a>:</h4>
<p>I'm looking at adding a benchmark for the projection caching issue (<a href="https://github.com/rust-lang/rustc-perf/issues/1124">https://github.com/rust-lang/rustc-perf/issues/1124</a>) based on a reproducer that uses the <code>futures</code> crate. On my machine, it takes about 10 seconds to compile <code>future</code> and other dependencies but the crate itself compiles in &lt; 1 second after projection caching was re-added (and longer than 30 minutes prior to the caching). </p>
<p>My understanding is that for benchmarking, we compile the dependencies once and then repeatedly clean and build just the final crate being benchmarked. Are these build times reasonable for a new benchmark?</p>



<a name="268439763"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/247081-t-compiler/performance/topic/compilation%20time%20recomendations%20for%20new%20benchmarks/near/268439763" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> The 8472 <a href="https://zulip-archive.rust-lang.org/stream/247081-t-compiler/performance/topic/compilation.20time.20recomendations.20for.20new.20benchmarks.html#268439763">(Jan 18 2022 at 19:02)</a>:</h4>
<p>from a previous thread:</p>
<blockquote>
<p>(it should also note that 1 second can exclude deps, in case that's relevant)</p>
</blockquote>



<a name="268439881"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/247081-t-compiler/performance/topic/compilation%20time%20recomendations%20for%20new%20benchmarks/near/268439881" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> simulacrum <a href="https://zulip-archive.rust-lang.org/stream/247081-t-compiler/performance/topic/compilation.20time.20recomendations.20for.20new.20benchmarks.html#268439881">(Jan 18 2022 at 19:03)</a>:</h4>
<p>Yes, that should be reasonable to add</p>



<a name="268439920"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/247081-t-compiler/performance/topic/compilation%20time%20recomendations%20for%20new%20benchmarks/near/268439920" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> simulacrum <a href="https://zulip-archive.rust-lang.org/stream/247081-t-compiler/performance/topic/compilation.20time.20recomendations.20for.20new.20benchmarks.html#268439920">(Jan 18 2022 at 19:03)</a>:</h4>
<p>and your understanding is correct</p>



<a name="268443671"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/247081-t-compiler/performance/topic/compilation%20time%20recomendations%20for%20new%20benchmarks/near/268443671" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jack Huey <a href="https://zulip-archive.rust-lang.org/stream/247081-t-compiler/performance/topic/compilation.20time.20recomendations.20for.20new.20benchmarks.html#268443671">(Jan 18 2022 at 19:31)</a>:</h4>
<p>agh I never made a PR for the README</p>



<a name="268470820"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/247081-t-compiler/performance/topic/compilation%20time%20recomendations%20for%20new%20benchmarks/near/268470820" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wesley Wiser <a href="https://zulip-archive.rust-lang.org/stream/247081-t-compiler/performance/topic/compilation.20time.20recomendations.20for.20new.20benchmarks.html#268470820">(Jan 18 2022 at 23:21)</a>:</h4>
<p>Thanks all! <a href="https://github.com/rust-lang/rustc-perf/pull/1153">https://github.com/rust-lang/rustc-perf/pull/1153</a></p>



<hr><p>Last updated: Apr 12 2022 at 20:01 UTC</p>
</html>