<html>
<head><meta charset="utf-8"><title>Clean-up of the `collector` subcommands · t-compiler/performance · Zulip Chat Archive</title></head>
<h2>Stream: <a href="https://zulip-archive.rust-lang.org/stream/247081-t-compiler/performance/index.html">t-compiler/performance</a></h2>
<h3>Topic: <a href="https://zulip-archive.rust-lang.org/stream/247081-t-compiler/performance/topic/Clean-up.20of.20the.20.60collector.60.20subcommands.html">Clean-up of the `collector` subcommands</a></h3>

<hr>

<base href="https://rust-lang.zulipchat.com">

<head><link href="https://zulip-archive.rust-lang.org/style.css" rel="stylesheet"></head>

<a name="204010132"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/247081-t-compiler/performance/topic/Clean-up%20of%20the%20%60collector%60%20subcommands/near/204010132" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> njn <a href="https://zulip-archive.rust-lang.org/stream/247081-t-compiler/performance/topic/Clean-up.20of.20the.20.60collector.60.20subcommands.html#204010132">(Jul 15 2020 at 20:41)</a>:</h4>
<p>I'm working on <a href="https://github.com/rust-lang/rustc-perf/issues/683">https://github.com/rust-lang/rustc-perf/issues/683</a>, and there are some choices required. Specifically, how many things must the user specify, vs. how many of them can we provide reasonable defaults?</p>



<a name="204010159"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/247081-t-compiler/performance/topic/Clean-up%20of%20the%20%60collector%60%20subcommands/near/204010159" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> njn <a href="https://zulip-archive.rust-lang.org/stream/247081-t-compiler/performance/topic/Clean-up.20of.20the.20.60collector.60.20subcommands.html#204010159">(Jul 15 2020 at 20:41)</a>:</h4>
<p>For example, here's one possible formulation for <code>bench_local</code>:</p>



<a name="204010192"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/247081-t-compiler/performance/topic/Clean-up%20of%20the%20%60collector%60%20subcommands/near/204010192" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> njn <a href="https://zulip-archive.rust-lang.org/stream/247081-t-compiler/performance/topic/Clean-up.20of.20the.20.60collector.60.20subcommands.html#204010192">(Jul 15 2020 at 20:41)</a>:</h4>
<div class="codehilite"><pre><span></span><code>collector bench_local $DB $RUSTC $CARGO $ID \
  --filter $FILTER --exclude $EXCLUDE --self-profile --builds $BUILDS --runs $RUNS
</code></pre></div>



<a name="204010284"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/247081-t-compiler/performance/topic/Clean-up%20of%20the%20%60collector%60%20subcommands/near/204010284" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> njn <a href="https://zulip-archive.rust-lang.org/stream/247081-t-compiler/performance/topic/Clean-up.20of.20the.20.60collector.60.20subcommands.html#204010284">(Jul 15 2020 at 20:42)</a>:</h4>
<p>In this formulation, you must provide the database name, rustc executable location, cargo executable location, and ID for the results within the database.</p>



<a name="204010299"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/247081-t-compiler/performance/topic/Clean-up%20of%20the%20%60collector%60%20subcommands/near/204010299" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> njn <a href="https://zulip-archive.rust-lang.org/stream/247081-t-compiler/performance/topic/Clean-up.20of.20the.20.60collector.60.20subcommands.html#204010299">(Jul 15 2020 at 20:42)</a>:</h4>
<p>But we could provide defaults for some/all of these.</p>



<a name="204010321"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/247081-t-compiler/performance/topic/Clean-up%20of%20the%20%60collector%60%20subcommands/near/204010321" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> njn <a href="https://zulip-archive.rust-lang.org/stream/247081-t-compiler/performance/topic/Clean-up.20of.20the.20.60collector.60.20subcommands.html#204010321">(Jul 15 2020 at 20:43)</a>:</h4>
<ul>
<li>Default to a name like <code>results.db</code> for the database.</li>
</ul>



<a name="204010335"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/247081-t-compiler/performance/topic/Clean-up%20of%20the%20%60collector%60%20subcommands/near/204010335" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Nelson <a href="https://zulip-archive.rust-lang.org/stream/247081-t-compiler/performance/topic/Clean-up.20of.20the.20.60collector.60.20subcommands.html#204010335">(Jul 15 2020 at 20:43)</a>:</h4>
<p>The ID to me seems like the only thing that will be different each time you call it</p>



<a name="204010341"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/247081-t-compiler/performance/topic/Clean-up%20of%20the%20%60collector%60%20subcommands/near/204010341" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> njn <a href="https://zulip-archive.rust-lang.org/stream/247081-t-compiler/performance/topic/Clean-up.20of.20the.20.60collector.60.20subcommands.html#204010341">(Jul 15 2020 at 20:43)</a>:</h4>
<ul>
<li>Default to 'rustc in your path'</li>
</ul>



<a name="204010350"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/247081-t-compiler/performance/topic/Clean-up%20of%20the%20%60collector%60%20subcommands/near/204010350" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Nelson <a href="https://zulip-archive.rust-lang.org/stream/247081-t-compiler/performance/topic/Clean-up.20of.20the.20.60collector.60.20subcommands.html#204010350">(Jul 15 2020 at 20:43)</a>:</h4>
<p>maybe we could set up a <code>collector.toml</code> config file or something?</p>



<a name="204010355"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/247081-t-compiler/performance/topic/Clean-up%20of%20the%20%60collector%60%20subcommands/near/204010355" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> njn <a href="https://zulip-archive.rust-lang.org/stream/247081-t-compiler/performance/topic/Clean-up.20of.20the.20.60collector.60.20subcommands.html#204010355">(Jul 15 2020 at 20:43)</a>:</h4>
<ul>
<li>Default to 'cargo in your path'</li>
</ul>



<a name="204010374"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/247081-t-compiler/performance/topic/Clean-up%20of%20the%20%60collector%60%20subcommands/near/204010374" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> njn <a href="https://zulip-archive.rust-lang.org/stream/247081-t-compiler/performance/topic/Clean-up.20of.20the.20.60collector.60.20subcommands.html#204010374">(Jul 15 2020 at 20:43)</a>:</h4>
<ul>
<li>Default to "Original" or something for the ID</li>
</ul>



<a name="204010404"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/247081-t-compiler/performance/topic/Clean-up%20of%20the%20%60collector%60%20subcommands/near/204010404" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> njn <a href="https://zulip-archive.rust-lang.org/stream/247081-t-compiler/performance/topic/Clean-up.20of.20the.20.60collector.60.20subcommands.html#204010404">(Jul 15 2020 at 20:43)</a>:</h4>
<p>And I've omitted <code>rustdoc</code>, too</p>



<a name="204010459"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/247081-t-compiler/performance/topic/Clean-up%20of%20the%20%60collector%60%20subcommands/near/204010459" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> njn <a href="https://zulip-archive.rust-lang.org/stream/247081-t-compiler/performance/topic/Clean-up.20of.20the.20.60collector.60.20subcommands.html#204010459">(Jul 15 2020 at 20:44)</a>:</h4>
<p><span class="user-mention" data-user-id="232545">@Joshua Nelson</span> The good news is that I have a lot of experience running these commands :)</p>



<a name="204010506"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/247081-t-compiler/performance/topic/Clean-up%20of%20the%20%60collector%60%20subcommands/near/204010506" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> njn <a href="https://zulip-archive.rust-lang.org/stream/247081-t-compiler/performance/topic/Clean-up.20of.20the.20.60collector.60.20subcommands.html#204010506">(Jul 15 2020 at 20:44)</a>:</h4>
<p>For me, <code>$CARGO</code> is 99.99% of the time just <code>which cargo</code>. That's the easiest one.</p>



<a name="204010546"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/247081-t-compiler/performance/topic/Clean-up%20of%20the%20%60collector%60%20subcommands/near/204010546" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> njn <a href="https://zulip-archive.rust-lang.org/stream/247081-t-compiler/performance/topic/Clean-up.20of.20the.20.60collector.60.20subcommands.html#204010546">(Jul 15 2020 at 20:45)</a>:</h4>
<p><code>$RUSTC</code> changes frequently. I very often run an unmodified local build vs a modified local build</p>



<a name="204010699"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/247081-t-compiler/performance/topic/Clean-up%20of%20the%20%60collector%60%20subcommands/near/204010699" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> njn <a href="https://zulip-archive.rust-lang.org/stream/247081-t-compiler/performance/topic/Clean-up.20of.20the.20.60collector.60.20subcommands.html#204010699">(Jul 15 2020 at 20:46)</a>:</h4>
<p><code>$DB</code> also changes frequently. I often use a date-based naming system, e.g. <code>jul16.db</code>. For <code>collector profile</code>, instead of a database filename we have an output dir, and I use <code>jul16/</code> for that. I often end up with dozens of different output files in a day's directory, often for multiple profilers.</p>



<a name="204010836"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/247081-t-compiler/performance/topic/Clean-up%20of%20the%20%60collector%60%20subcommands/near/204010836" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> njn <a href="https://zulip-archive.rust-lang.org/stream/247081-t-compiler/performance/topic/Clean-up.20of.20the.20.60collector.60.20subcommands.html#204010836">(Jul 15 2020 at 20:47)</a>:</h4>
<p>I have a bash function that I use, it's usage is like this: <code>rustc-bench &lt;rustc&gt; &lt;db&gt; &lt;id&gt; &lt;builds&gt; &lt;runs&gt; [&lt;filter&gt;]</code></p>



<a name="204010937"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/247081-t-compiler/performance/topic/Clean-up%20of%20the%20%60collector%60%20subcommands/near/204010937" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> njn <a href="https://zulip-archive.rust-lang.org/stream/247081-t-compiler/performance/topic/Clean-up.20of.20the.20.60collector.60.20subcommands.html#204010937">(Jul 15 2020 at 20:48)</a>:</h4>
<p>for that, the builds and runs are mandatory, because I mostly use non-default values</p>



<a name="204010971"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/247081-t-compiler/performance/topic/Clean-up%20of%20the%20%60collector%60%20subcommands/near/204010971" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> njn <a href="https://zulip-archive.rust-lang.org/stream/247081-t-compiler/performance/topic/Clean-up.20of.20the.20.60collector.60.20subcommands.html#204010971">(Jul 15 2020 at 20:48)</a>:</h4>
<p>(I'm mostly just thinking aloud here)</p>



<a name="204011028"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/247081-t-compiler/performance/topic/Clean-up%20of%20the%20%60collector%60%20subcommands/near/204011028" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> njn <a href="https://zulip-archive.rust-lang.org/stream/247081-t-compiler/performance/topic/Clean-up.20of.20the.20.60collector.60.20subcommands.html#204011028">(Jul 15 2020 at 20:49)</a>:</h4>
<p>"Cargo in your path" with a <code>--cargo</code> option definitely seems wise, that covers the very common default nicely while allowing flexibility for the rare cases where it's needed</p>



<a name="204011086"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/247081-t-compiler/performance/topic/Clean-up%20of%20the%20%60collector%60%20subcommands/near/204011086" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> njn <a href="https://zulip-archive.rust-lang.org/stream/247081-t-compiler/performance/topic/Clean-up.20of.20the.20.60collector.60.20subcommands.html#204011086">(Jul 15 2020 at 20:49)</a>:</h4>
<p>For <code>rustdoc</code>, I'm inclined to look for it next to <code>rustc</code> by default, and maybe have a <code>--rustdoc</code> option as well.</p>



<a name="204011392"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/247081-t-compiler/performance/topic/Clean-up%20of%20the%20%60collector%60%20subcommands/near/204011392" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> njn <a href="https://zulip-archive.rust-lang.org/stream/247081-t-compiler/performance/topic/Clean-up.20of.20the.20.60collector.60.20subcommands.html#204011392">(Jul 15 2020 at 20:52)</a>:</h4>
<p>For <code>rustc</code>, I think specifying it is common enough that maybe it should just be mandatory?</p>



<a name="204011436"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/247081-t-compiler/performance/topic/Clean-up%20of%20the%20%60collector%60%20subcommands/near/204011436" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Nelson <a href="https://zulip-archive.rust-lang.org/stream/247081-t-compiler/performance/topic/Clean-up.20of.20the.20.60collector.60.20subcommands.html#204011436">(Jul 15 2020 at 20:52)</a>:</h4>
<p>and a positional argument I think too</p>



<a name="204011450"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/247081-t-compiler/performance/topic/Clean-up%20of%20the%20%60collector%60%20subcommands/near/204011450" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Nelson <a href="https://zulip-archive.rust-lang.org/stream/247081-t-compiler/performance/topic/Clean-up.20of.20the.20.60collector.60.20subcommands.html#204011450">(Jul 15 2020 at 20:52)</a>:</h4>
<p>having mandatory 'options' is confusing</p>



<a name="204011462"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/247081-t-compiler/performance/topic/Clean-up%20of%20the%20%60collector%60%20subcommands/near/204011462" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> njn <a href="https://zulip-archive.rust-lang.org/stream/247081-t-compiler/performance/topic/Clean-up.20of.20the.20.60collector.60.20subcommands.html#204011462">(Jul 15 2020 at 20:53)</a>:</h4>
<p>Yeah, the mandatory ones will all be positional</p>



<a name="204011528"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/247081-t-compiler/performance/topic/Clean-up%20of%20the%20%60collector%60%20subcommands/near/204011528" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> njn <a href="https://zulip-archive.rust-lang.org/stream/247081-t-compiler/performance/topic/Clean-up.20of.20the.20.60collector.60.20subcommands.html#204011528">(Jul 15 2020 at 20:53)</a>:</h4>
<p><code>$DB</code>, hmm. A default might be reasonable there. I'm probably unusual in having lots of different databases/directories when I do this stuff.</p>



<a name="204011675"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/247081-t-compiler/performance/topic/Clean-up%20of%20the%20%60collector%60%20subcommands/near/204011675" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> njn <a href="https://zulip-archive.rust-lang.org/stream/247081-t-compiler/performance/topic/Clean-up.20of.20the.20.60collector.60.20subcommands.html#204011675">(Jul 15 2020 at 20:54)</a>:</h4>
<p><span class="user-mention" data-user-id="116122">@simulacrum</span>  <a href="https://github.com/rust-lang/rustc-perf/issues/683#issuecomment-658520272">https://github.com/rust-lang/rustc-perf/issues/683#issuecomment-658520272</a> would be helpful for this. Even if you don't add the code, if you could just show me the invocations that would be very helpful</p>



<a name="204011713"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/247081-t-compiler/performance/topic/Clean-up%20of%20the%20%60collector%60%20subcommands/near/204011713" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> simulacrum <a href="https://zulip-archive.rust-lang.org/stream/247081-t-compiler/performance/topic/Clean-up.20of.20the.20.60collector.60.20subcommands.html#204011713">(Jul 15 2020 at 20:55)</a>:</h4>
<p>oh yeah I meant to do that this morning but completely forgot</p>



<a name="204011718"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/247081-t-compiler/performance/topic/Clean-up%20of%20the%20%60collector%60%20subcommands/near/204011718" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> simulacrum <a href="https://zulip-archive.rust-lang.org/stream/247081-t-compiler/performance/topic/Clean-up.20of.20the.20.60collector.60.20subcommands.html#204011718">(Jul 15 2020 at 20:55)</a>:</h4>
<p>let me go push that up</p>



<a name="204011805"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/247081-t-compiler/performance/topic/Clean-up%20of%20the%20%60collector%60%20subcommands/near/204011805" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> njn <a href="https://zulip-archive.rust-lang.org/stream/247081-t-compiler/performance/topic/Clean-up.20of.20the.20.60collector.60.20subcommands.html#204011805">(Jul 15 2020 at 20:56)</a>:</h4>
<p>thanks!</p>



<a name="204011822"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/247081-t-compiler/performance/topic/Clean-up%20of%20the%20%60collector%60%20subcommands/near/204011822" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> njn <a href="https://zulip-archive.rust-lang.org/stream/247081-t-compiler/performance/topic/Clean-up.20of.20the.20.60collector.60.20subcommands.html#204011822">(Jul 15 2020 at 20:56)</a>:</h4>
<p>So, we're circling in on this:</p>
<div class="codehilite"><pre><span></span><code>collector bench_local $RUSTC $ID \
  --rustdoc $RUSTDOC --cargo $CARGO \
  --filter $FILTER --exclude $EXCLUDE \
  --self-profile --builds $BUILDS --runs $RUNS
  --db $DB
</code></pre></div>



<a name="204011840"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/247081-t-compiler/performance/topic/Clean-up%20of%20the%20%60collector%60%20subcommands/near/204011840" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> simulacrum <a href="https://zulip-archive.rust-lang.org/stream/247081-t-compiler/performance/topic/Clean-up.20of.20the.20.60collector.60.20subcommands.html#204011840">(Jul 15 2020 at 20:56)</a>:</h4>
<p><a href="https://gist.github.com/Mark-Simulacrum/a0850ed4e7085a0656cb53c2762c0979">https://gist.github.com/Mark-Simulacrum/a0850ed4e7085a0656cb53c2762c0979</a></p>



<a name="204011870"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/247081-t-compiler/performance/topic/Clean-up%20of%20the%20%60collector%60%20subcommands/near/204011870" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> simulacrum <a href="https://zulip-archive.rust-lang.org/stream/247081-t-compiler/performance/topic/Clean-up.20of.20the.20.60collector.60.20subcommands.html#204011870">(Jul 15 2020 at 20:56)</a>:</h4>
<p>I'll need to pick out the secret variables into .env or something later and actually put it in the repo, but that should do it for now</p>



<a name="204011903"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/247081-t-compiler/performance/topic/Clean-up%20of%20the%20%60collector%60%20subcommands/near/204011903" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> simulacrum <a href="https://zulip-archive.rust-lang.org/stream/247081-t-compiler/performance/topic/Clean-up.20of.20the.20.60collector.60.20subcommands.html#204011903">(Jul 15 2020 at 20:57)</a>:</h4>
<p>I am pretty much <span aria-label="thumbs up" class="emoji emoji-1f44d" role="img" title="thumbs up">:thumbs_up:</span> on whatever for this</p>



<a name="204012362"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/247081-t-compiler/performance/topic/Clean-up%20of%20the%20%60collector%60%20subcommands/near/204012362" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> njn <a href="https://zulip-archive.rust-lang.org/stream/247081-t-compiler/performance/topic/Clean-up.20of.20the.20.60collector.60.20subcommands.html#204012362">(Jul 15 2020 at 21:01)</a>:</h4>
<p><span class="user-mention" data-user-id="116122">@simulacrum</span>  Is <code>bench_published</code> for <a href="https://perf.rust-lang.org/dashboard.html">https://perf.rust-lang.org/dashboard.html</a>, while <code>process</code> is for the per-merge results?</p>



<a name="204012377"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/247081-t-compiler/performance/topic/Clean-up%20of%20the%20%60collector%60%20subcommands/near/204012377" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> simulacrum <a href="https://zulip-archive.rust-lang.org/stream/247081-t-compiler/performance/topic/Clean-up.20of.20the.20.60collector.60.20subcommands.html#204012377">(Jul 15 2020 at 21:01)</a>:</h4>
<p>correct, yes</p>



<a name="204012388"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/247081-t-compiler/performance/topic/Clean-up%20of%20the%20%60collector%60%20subcommands/near/204012388" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> njn <a href="https://zulip-archive.rust-lang.org/stream/247081-t-compiler/performance/topic/Clean-up.20of.20the.20.60collector.60.20subcommands.html#204012388">(Jul 15 2020 at 21:01)</a>:</h4>
<p>Ok, cool</p>



<a name="204012394"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/247081-t-compiler/performance/topic/Clean-up%20of%20the%20%60collector%60%20subcommands/near/204012394" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> simulacrum <a href="https://zulip-archive.rust-lang.org/stream/247081-t-compiler/performance/topic/Clean-up.20of.20the.20.60collector.60.20subcommands.html#204012394">(Jul 15 2020 at 21:01)</a>:</h4>
<p>I'd be totally on board with merging those just haven't gotten around to it, too, btw</p>



<a name="204012415"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/247081-t-compiler/performance/topic/Clean-up%20of%20the%20%60collector%60%20subcommands/near/204012415" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> simulacrum <a href="https://zulip-archive.rust-lang.org/stream/247081-t-compiler/performance/topic/Clean-up.20of.20the.20.60collector.60.20subcommands.html#204012415">(Jul 15 2020 at 21:01)</a>:</h4>
<p>(e.g., with a <code>--only-stable</code> arg or something)</p>



<a name="204012485"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/247081-t-compiler/performance/topic/Clean-up%20of%20the%20%60collector%60%20subcommands/near/204012485" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> njn <a href="https://zulip-archive.rust-lang.org/stream/247081-t-compiler/performance/topic/Clean-up.20of.20the.20.60collector.60.20subcommands.html#204012485">(Jul 15 2020 at 21:02)</a>:</h4>
<p>sorry, merging what?</p>



<a name="204012506"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/247081-t-compiler/performance/topic/Clean-up%20of%20the%20%60collector%60%20subcommands/near/204012506" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> njn <a href="https://zulip-archive.rust-lang.org/stream/247081-t-compiler/performance/topic/Clean-up.20of.20the.20.60collector.60.20subcommands.html#204012506">(Jul 15 2020 at 21:02)</a>:</h4>
<p>oh, combining commands?</p>



<a name="204012935"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/247081-t-compiler/performance/topic/Clean-up%20of%20the%20%60collector%60%20subcommands/near/204012935" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> simulacrum <a href="https://zulip-archive.rust-lang.org/stream/247081-t-compiler/performance/topic/Clean-up.20of.20the.20.60collector.60.20subcommands.html#204012935">(Jul 15 2020 at 21:06)</a>:</h4>
<p>yeah</p>



<a name="204012959"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/247081-t-compiler/performance/topic/Clean-up%20of%20the%20%60collector%60%20subcommands/near/204012959" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> njn <a href="https://zulip-archive.rust-lang.org/stream/247081-t-compiler/performance/topic/Clean-up.20of.20the.20.60collector.60.20subcommands.html#204012959">(Jul 15 2020 at 21:06)</a>:</h4>
<p><span class="user-mention" data-user-id="116122">@simulacrum</span> which ones?</p>



<a name="204012971"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/247081-t-compiler/performance/topic/Clean-up%20of%20the%20%60collector%60%20subcommands/near/204012971" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> simulacrum <a href="https://zulip-archive.rust-lang.org/stream/247081-t-compiler/performance/topic/Clean-up.20of.20the.20.60collector.60.20subcommands.html#204012971">(Jul 15 2020 at 21:06)</a>:</h4>
<p>bench_published and process</p>



<a name="204013015"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/247081-t-compiler/performance/topic/Clean-up%20of%20the%20%60collector%60%20subcommands/near/204013015" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> simulacrum <a href="https://zulip-archive.rust-lang.org/stream/247081-t-compiler/performance/topic/Clean-up.20of.20the.20.60collector.60.20subcommands.html#204013015">(Jul 15 2020 at 21:07)</a>:</h4>
<p>and/or making bench_published and bench_local the same command, though we'd want a "--only-stable" filter</p>



<a name="204013034"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/247081-t-compiler/performance/topic/Clean-up%20of%20the%20%60collector%60%20subcommands/near/204013034" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> simulacrum <a href="https://zulip-archive.rust-lang.org/stream/247081-t-compiler/performance/topic/Clean-up.20of.20the.20.60collector.60.20subcommands.html#204013034">(Jul 15 2020 at 21:07)</a>:</h4>
<p>the latter probably makes more sense</p>



<a name="204013245"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/247081-t-compiler/performance/topic/Clean-up%20of%20the%20%60collector%60%20subcommands/near/204013245" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> njn <a href="https://zulip-archive.rust-lang.org/stream/247081-t-compiler/performance/topic/Clean-up.20of.20the.20.60collector.60.20subcommands.html#204013245">(Jul 15 2020 at 21:09)</a>:</h4>
<p>hmm, bench_published seems quite different to bench_local: in the way it gets the toolchain, and because it runs 3 times instead of 1</p>



<a name="204013254"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/247081-t-compiler/performance/topic/Clean-up%20of%20the%20%60collector%60%20subcommands/near/204013254" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> njn <a href="https://zulip-archive.rust-lang.org/stream/247081-t-compiler/performance/topic/Clean-up.20of.20the.20.60collector.60.20subcommands.html#204013254">(Jul 15 2020 at 21:09)</a>:</h4>
<p>I'm happy for it to be separate for now</p>



<a name="204013284"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/247081-t-compiler/performance/topic/Clean-up%20of%20the%20%60collector%60%20subcommands/near/204013284" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> njn <a href="https://zulip-archive.rust-lang.org/stream/247081-t-compiler/performance/topic/Clean-up.20of.20the.20.60collector.60.20subcommands.html#204013284">(Jul 15 2020 at 21:09)</a>:</h4>
<p><span class="user-mention" data-user-id="116122">@simulacrum</span> Any preferences for a default database name? <code>results.db</code>?</p>



<a name="204013309"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/247081-t-compiler/performance/topic/Clean-up%20of%20the%20%60collector%60%20subcommands/near/204013309" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> simulacrum <a href="https://zulip-archive.rust-lang.org/stream/247081-t-compiler/performance/topic/Clean-up.20of.20the.20.60collector.60.20subcommands.html#204013309">(Jul 15 2020 at 21:09)</a>:</h4>
<p>seems fine</p>



<a name="204013406"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/247081-t-compiler/performance/topic/Clean-up%20of%20the%20%60collector%60%20subcommands/near/204013406" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Nelson <a href="https://zulip-archive.rust-lang.org/stream/247081-t-compiler/performance/topic/Clean-up.20of.20the.20.60collector.60.20subcommands.html#204013406">(Jul 15 2020 at 21:10)</a>:</h4>
<p>personally I'd like it to have some connection to perf, so you know where it came from</p>



<a name="204013413"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/247081-t-compiler/performance/topic/Clean-up%20of%20the%20%60collector%60%20subcommands/near/204013413" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Nelson <a href="https://zulip-archive.rust-lang.org/stream/247081-t-compiler/performance/topic/Clean-up.20of.20the.20.60collector.60.20subcommands.html#204013413">(Jul 15 2020 at 21:10)</a>:</h4>
<p>so <code>perf.db</code> or <code>collector.db</code></p>



<a name="204013465"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/247081-t-compiler/performance/topic/Clean-up%20of%20the%20%60collector%60%20subcommands/near/204013465" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> njn <a href="https://zulip-archive.rust-lang.org/stream/247081-t-compiler/performance/topic/Clean-up.20of.20the.20.60collector.60.20subcommands.html#204013465">(Jul 15 2020 at 21:10)</a>:</h4>
<p><code>perf.db</code> is easily confused with linux <code>perf</code>, but I like <code>collector.db</code></p>



<a name="204013514"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/247081-t-compiler/performance/topic/Clean-up%20of%20the%20%60collector%60%20subcommands/near/204013514" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> simulacrum <a href="https://zulip-archive.rust-lang.org/stream/247081-t-compiler/performance/topic/Clean-up.20of.20the.20.60collector.60.20subcommands.html#204013514">(Jul 15 2020 at 21:11)</a>:</h4>
<p>yeah perf.db falls into the <code>perf.data</code> namespace from linux perf too closely I think</p>



<a name="204013545"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/247081-t-compiler/performance/topic/Clean-up%20of%20the%20%60collector%60%20subcommands/near/204013545" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> njn <a href="https://zulip-archive.rust-lang.org/stream/247081-t-compiler/performance/topic/Clean-up.20of.20the.20.60collector.60.20subcommands.html#204013545">(Jul 15 2020 at 21:11)</a>:</h4>
<p><span class="user-mention" data-user-id="232545">@Joshua Nelson</span> any reason you put <code>Doc</code> between <code>Debug</code> and <code>Opt</code>? It feels wrong to me there :)</p>



<a name="204013570"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/247081-t-compiler/performance/topic/Clean-up%20of%20the%20%60collector%60%20subcommands/near/204013570" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Nelson <a href="https://zulip-archive.rust-lang.org/stream/247081-t-compiler/performance/topic/Clean-up.20of.20the.20.60collector.60.20subcommands.html#204013570">(Jul 15 2020 at 21:11)</a>:</h4>
<p>oh I just made it alphabetical lol</p>



<a name="204013575"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/247081-t-compiler/performance/topic/Clean-up%20of%20the%20%60collector%60%20subcommands/near/204013575" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> njn <a href="https://zulip-archive.rust-lang.org/stream/247081-t-compiler/performance/topic/Clean-up.20of.20the.20.60collector.60.20subcommands.html#204013575">(Jul 15 2020 at 21:11)</a>:</h4>
<p>ha</p>



<a name="204013579"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/247081-t-compiler/performance/topic/Clean-up%20of%20the%20%60collector%60%20subcommands/near/204013579" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Nelson <a href="https://zulip-archive.rust-lang.org/stream/247081-t-compiler/performance/topic/Clean-up.20of.20the.20.60collector.60.20subcommands.html#204013579">(Jul 15 2020 at 21:11)</a>:</h4>
<p>if you want it to be by frequency of use that's probably better</p>



<a name="204013632"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/247081-t-compiler/performance/topic/Clean-up%20of%20the%20%60collector%60%20subcommands/near/204013632" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> njn <a href="https://zulip-archive.rust-lang.org/stream/247081-t-compiler/performance/topic/Clean-up.20of.20the.20.60collector.60.20subcommands.html#204013632">(Jul 15 2020 at 21:12)</a>:</h4>
<p>ok, I might change that later</p>



<a name="204014345"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/247081-t-compiler/performance/topic/Clean-up%20of%20the%20%60collector%60%20subcommands/near/204014345" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> njn <a href="https://zulip-archive.rust-lang.org/stream/247081-t-compiler/performance/topic/Clean-up.20of.20the.20.60collector.60.20subcommands.html#204014345">(Jul 15 2020 at 21:17)</a>:</h4>
<p>And for <code>profile</code> I will default to <code>collector/</code> as the output dir</p>



<a name="204014447"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/247081-t-compiler/performance/topic/Clean-up%20of%20the%20%60collector%60%20subcommands/near/204014447" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> njn <a href="https://zulip-archive.rust-lang.org/stream/247081-t-compiler/performance/topic/Clean-up.20of.20the.20.60collector.60.20subcommands.html#204014447">(Jul 15 2020 at 21:18)</a>:</h4>
<p>I wonder if I should rename it <code>profile_local</code> to match <code>bench_local</code></p>



<a name="204014468"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/247081-t-compiler/performance/topic/Clean-up%20of%20the%20%60collector%60%20subcommands/near/204014468" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> simulacrum <a href="https://zulip-archive.rust-lang.org/stream/247081-t-compiler/performance/topic/Clean-up.20of.20the.20.60collector.60.20subcommands.html#204014468">(Jul 15 2020 at 21:18)</a>:</h4>
<p><span aria-label="thumbs up" class="emoji emoji-1f44d" role="img" title="thumbs up">:thumbs_up:</span> on that</p>



<a name="204015493"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/247081-t-compiler/performance/topic/Clean-up%20of%20the%20%60collector%60%20subcommands/near/204015493" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> njn <a href="https://zulip-archive.rust-lang.org/stream/247081-t-compiler/performance/topic/Clean-up.20of.20the.20.60collector.60.20subcommands.html#204015493">(Jul 15 2020 at 21:27)</a>:</h4>
<p>Ok, here's my design: <a href="https://paste.mozilla.org/mi6bKPe2/raw">https://paste.mozilla.org/mi6bKPe2/raw</a></p>



<a name="204015627"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/247081-t-compiler/performance/topic/Clean-up%20of%20the%20%60collector%60%20subcommands/near/204015627" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> simulacrum <a href="https://zulip-archive.rust-lang.org/stream/247081-t-compiler/performance/topic/Clean-up.20of.20the.20.60collector.60.20subcommands.html#204015627">(Jul 15 2020 at 21:28)</a>:</h4>
<p>I think cargo should default to $CARGO first, and then rustup which cargo --toolchain nightly, and then cargo in path</p>



<a name="204015784"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/247081-t-compiler/performance/topic/Clean-up%20of%20the%20%60collector%60%20subcommands/near/204015784" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> simulacrum <a href="https://zulip-archive.rust-lang.org/stream/247081-t-compiler/performance/topic/Clean-up.20of.20the.20.60collector.60.20subcommands.html#204015784">(Jul 15 2020 at 21:30)</a>:</h4>
<p><span class="user-mention" data-user-id="120989">@njn</span> looks great!</p>



<a name="204015800"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/247081-t-compiler/performance/topic/Clean-up%20of%20the%20%60collector%60%20subcommands/near/204015800" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> simulacrum <a href="https://zulip-archive.rust-lang.org/stream/247081-t-compiler/performance/topic/Clean-up.20of.20the.20.60collector.60.20subcommands.html#204015800">(Jul 15 2020 at 21:30)</a>:</h4>
<p>and process indeed only collects at most one commit</p>



<a name="204015819"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/247081-t-compiler/performance/topic/Clean-up%20of%20the%20%60collector%60%20subcommands/near/204015819" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> njn <a href="https://zulip-archive.rust-lang.org/stream/247081-t-compiler/performance/topic/Clean-up.20of.20the.20.60collector.60.20subcommands.html#204015819">(Jul 15 2020 at 21:30)</a>:</h4>
<p>is it the most recent revision?</p>



<a name="204015834"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/247081-t-compiler/performance/topic/Clean-up%20of%20the%20%60collector%60%20subcommands/near/204015834" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> njn <a href="https://zulip-archive.rust-lang.org/stream/247081-t-compiler/performance/topic/Clean-up.20of.20the.20.60collector.60.20subcommands.html#204015834">(Jul 15 2020 at 21:30)</a>:</h4>
<p>or the earliest not-yet-measured one?</p>



<a name="204015854"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/247081-t-compiler/performance/topic/Clean-up%20of%20the%20%60collector%60%20subcommands/near/204015854" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> simulacrum <a href="https://zulip-archive.rust-lang.org/stream/247081-t-compiler/performance/topic/Clean-up.20of.20the.20.60collector.60.20subcommands.html#204015854">(Jul 15 2020 at 21:31)</a>:</h4>
<p>the one the server specified gives it</p>



<a name="204015869"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/247081-t-compiler/performance/topic/Clean-up%20of%20the%20%60collector%60%20subcommands/near/204015869" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> simulacrum <a href="https://zulip-archive.rust-lang.org/stream/247081-t-compiler/performance/topic/Clean-up.20of.20the.20.60collector.60.20subcommands.html#204015869">(Jul 15 2020 at 21:31)</a>:</h4>
<p>it hits /perf/next_commit on it or so</p>



<a name="204015957"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/247081-t-compiler/performance/topic/Clean-up%20of%20the%20%60collector%60%20subcommands/near/204015957" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> simulacrum <a href="https://zulip-archive.rust-lang.org/stream/247081-t-compiler/performance/topic/Clean-up.20of.20the.20.60collector.60.20subcommands.html#204015957">(Jul 15 2020 at 21:32)</a>:</h4>
<p>server is specified via environment var SITE_URL (e.g., "<a href="https://perf.rust-lang.org">https://perf.rust-lang.org</a>") today</p>



<a name="204016013"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/247081-t-compiler/performance/topic/Clean-up%20of%20the%20%60collector%60%20subcommands/near/204016013" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> simulacrum <a href="https://zulip-archive.rust-lang.org/stream/247081-t-compiler/performance/topic/Clean-up.20of.20the.20.60collector.60.20subcommands.html#204016013">(Jul 15 2020 at 21:32)</a>:</h4>
<p>mostly because I'm lazy and env variables are easier to add than cli args</p>



<a name="204016074"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/247081-t-compiler/performance/topic/Clean-up%20of%20the%20%60collector%60%20subcommands/near/204016074" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> njn <a href="https://zulip-archive.rust-lang.org/stream/247081-t-compiler/performance/topic/Clean-up.20of.20the.20.60collector.60.20subcommands.html#204016074">(Jul 15 2020 at 21:33)</a>:</h4>
<p>SITE_URL is really just a local variable in <code>run.sh</code>?</p>



<a name="204016088"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/247081-t-compiler/performance/topic/Clean-up%20of%20the%20%60collector%60%20subcommands/near/204016088" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> simulacrum <a href="https://zulip-archive.rust-lang.org/stream/247081-t-compiler/performance/topic/Clean-up.20of.20the.20.60collector.60.20subcommands.html#204016088">(Jul 15 2020 at 21:33)</a>:</h4>
<p>yes</p>



<a name="204016095"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/247081-t-compiler/performance/topic/Clean-up%20of%20the%20%60collector%60%20subcommands/near/204016095" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> njn <a href="https://zulip-archive.rust-lang.org/stream/247081-t-compiler/performance/topic/Clean-up.20of.20the.20.60collector.60.20subcommands.html#204016095">(Jul 15 2020 at 21:33)</a>:</h4>
<p>oh, but <code>collector</code> looks at it</p>



<a name="204016154"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/247081-t-compiler/performance/topic/Clean-up%20of%20the%20%60collector%60%20subcommands/near/204016154" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> simulacrum <a href="https://zulip-archive.rust-lang.org/stream/247081-t-compiler/performance/topic/Clean-up.20of.20the.20.60collector.60.20subcommands.html#204016154">(Jul 15 2020 at 21:34)</a>:</h4>
<p>yeah there's a bunch of env::var("SITE_URL")</p>



<a name="204016165"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/247081-t-compiler/performance/topic/Clean-up%20of%20the%20%60collector%60%20subcommands/near/204016165" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> njn <a href="https://zulip-archive.rust-lang.org/stream/247081-t-compiler/performance/topic/Clean-up.20of.20the.20.60collector.60.20subcommands.html#204016165">(Jul 15 2020 at 21:34)</a>:</h4>
<p>hmm, maybe I should make that an option instead, for consistency</p>



<a name="204016181"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/247081-t-compiler/performance/topic/Clean-up%20of%20the%20%60collector%60%20subcommands/near/204016181" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> njn <a href="https://zulip-archive.rust-lang.org/stream/247081-t-compiler/performance/topic/Clean-up.20of.20the.20.60collector.60.20subcommands.html#204016181">(Jul 15 2020 at 21:34)</a>:</h4>
<p>and maybe <code>process</code> should be <code>bench_next</code></p>



<a name="204016182"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/247081-t-compiler/performance/topic/Clean-up%20of%20the%20%60collector%60%20subcommands/near/204016182" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> simulacrum <a href="https://zulip-archive.rust-lang.org/stream/247081-t-compiler/performance/topic/Clean-up.20of.20the.20.60collector.60.20subcommands.html#204016182">(Jul 15 2020 at 21:34)</a>:</h4>
<p>I'm not opposed but you'll have to thread it through</p>



<a name="204016202"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/247081-t-compiler/performance/topic/Clean-up%20of%20the%20%60collector%60%20subcommands/near/204016202" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> njn <a href="https://zulip-archive.rust-lang.org/stream/247081-t-compiler/performance/topic/Clean-up.20of.20the.20.60collector.60.20subcommands.html#204016202">(Jul 15 2020 at 21:35)</a>:</h4>
<p>that's fine</p>



<a name="204016213"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/247081-t-compiler/performance/topic/Clean-up%20of%20the%20%60collector%60%20subcommands/near/204016213" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> njn <a href="https://zulip-archive.rust-lang.org/stream/247081-t-compiler/performance/topic/Clean-up.20of.20the.20.60collector.60.20subcommands.html#204016213">(Jul 15 2020 at 21:35)</a>:</h4>
<p>I'm in a "get rid of all the hacks and mess" mode, might as well do it properly :)</p>



<a name="204016237"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/247081-t-compiler/performance/topic/Clean-up%20of%20the%20%60collector%60%20subcommands/near/204016237" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> njn <a href="https://zulip-archive.rust-lang.org/stream/247081-t-compiler/performance/topic/Clean-up.20of.20the.20.60collector.60.20subcommands.html#204016237">(Jul 15 2020 at 21:35)</a>:</h4>
<p>For similar reasons, I'm not sold on using $CARGO</p>



<a name="204016254"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/247081-t-compiler/performance/topic/Clean-up%20of%20the%20%60collector%60%20subcommands/near/204016254" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> njn <a href="https://zulip-archive.rust-lang.org/stream/247081-t-compiler/performance/topic/Clean-up.20of.20the.20.60collector.60.20subcommands.html#204016254">(Jul 15 2020 at 21:35)</a>:</h4>
<p>if we allow that, there's little point in also having <code>--cargo</code></p>



<a name="204016304"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/247081-t-compiler/performance/topic/Clean-up%20of%20the%20%60collector%60%20subcommands/near/204016304" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> njn <a href="https://zulip-archive.rust-lang.org/stream/247081-t-compiler/performance/topic/Clean-up.20of.20the.20.60collector.60.20subcommands.html#204016304">(Jul 15 2020 at 21:36)</a>:</h4>
<p>the <code>rustup</code> thing is neat, though</p>



<a name="204021807"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/247081-t-compiler/performance/topic/Clean-up%20of%20the%20%60collector%60%20subcommands/near/204021807" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> njn <a href="https://zulip-archive.rust-lang.org/stream/247081-t-compiler/performance/topic/Clean-up.20of.20the.20.60collector.60.20subcommands.html#204021807">(Jul 15 2020 at 22:39)</a>:</h4>
<p><span class="user-mention" data-user-id="116122">@simulacrum</span> if you commit the <a href="http://run.sh">run.sh</a> script I can modify it as part of these changes</p>



<a name="204021875"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/247081-t-compiler/performance/topic/Clean-up%20of%20the%20%60collector%60%20subcommands/near/204021875" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> njn <a href="https://zulip-archive.rust-lang.org/stream/247081-t-compiler/performance/topic/Clean-up.20of.20the.20.60collector.60.20subcommands.html#204021875">(Jul 15 2020 at 22:40)</a>:</h4>
<p>/me also wonders about using dashes instead of underscores in subcommand names, e.g.<code>collector bench-local</code></p>



<a name="204022692"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/247081-t-compiler/performance/topic/Clean-up%20of%20the%20%60collector%60%20subcommands/near/204022692" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> simulacrum <a href="https://zulip-archive.rust-lang.org/stream/247081-t-compiler/performance/topic/Clean-up.20of.20the.20.60collector.60.20subcommands.html#204022692">(Jul 15 2020 at 22:50)</a>:</h4>
<p><span class="user-mention" data-user-id="120989">@njn</span> don't worry about <a href="http://run.sh">run.sh</a> I think</p>



<a name="204022697"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/247081-t-compiler/performance/topic/Clean-up%20of%20the%20%60collector%60%20subcommands/near/204022697" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> simulacrum <a href="https://zulip-archive.rust-lang.org/stream/247081-t-compiler/performance/topic/Clean-up.20of.20the.20.60collector.60.20subcommands.html#204022697">(Jul 15 2020 at 22:50)</a>:</h4>
<p>it's a trivial script</p>



<a name="204022720"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/247081-t-compiler/performance/topic/Clean-up%20of%20the%20%60collector%60%20subcommands/near/204022720" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> simulacrum <a href="https://zulip-archive.rust-lang.org/stream/247081-t-compiler/performance/topic/Clean-up.20of.20the.20.60collector.60.20subcommands.html#204022720">(Jul 15 2020 at 22:50)</a>:</h4>
<p>(and translating it will be a good "gut check" I think)</p>



<a name="204022727"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/247081-t-compiler/performance/topic/Clean-up%20of%20the%20%60collector%60%20subcommands/near/204022727" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> njn <a href="https://zulip-archive.rust-lang.org/stream/247081-t-compiler/performance/topic/Clean-up.20of.20the.20.60collector.60.20subcommands.html#204022727">(Jul 15 2020 at 22:50)</a>:</h4>
<p>ok</p>



<a name="204029979"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/247081-t-compiler/performance/topic/Clean-up%20of%20the%20%60collector%60%20subcommands/near/204029979" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> njn <a href="https://zulip-archive.rust-lang.org/stream/247081-t-compiler/performance/topic/Clean-up.20of.20the.20.60collector.60.20subcommands.html#204029979">(Jul 16 2020 at 00:17)</a>:</h4>
<p>Hmm, <code>clap_app!</code> doesn't support hyphens in subcommand names, oh well</p>



<a name="204034585"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/247081-t-compiler/performance/topic/Clean-up%20of%20the%20%60collector%60%20subcommands/near/204034585" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> njn <a href="https://zulip-archive.rust-lang.org/stream/247081-t-compiler/performance/topic/Clean-up.20of.20the.20.60collector.60.20subcommands.html#204034585">(Jul 16 2020 at 01:28)</a>:</h4>
<p>Hmm, using <code>collector/</code> as the default output-dir for <code>profile_local</code> is a problem, because that's already a directory in the repo...</p>



<a name="204034634"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/247081-t-compiler/performance/topic/Clean-up%20of%20the%20%60collector%60%20subcommands/near/204034634" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Nelson <a href="https://zulip-archive.rust-lang.org/stream/247081-t-compiler/performance/topic/Clean-up.20of.20the.20.60collector.60.20subcommands.html#204034634">(Jul 16 2020 at 01:29)</a>:</h4>
<p><code>perf_collector</code>?</p>



<a name="204034657"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/247081-t-compiler/performance/topic/Clean-up%20of%20the%20%60collector%60%20subcommands/near/204034657" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Nelson <a href="https://zulip-archive.rust-lang.org/stream/247081-t-compiler/performance/topic/Clean-up.20of.20the.20.60collector.60.20subcommands.html#204034657">(Jul 16 2020 at 01:29)</a>:</h4>
<p>or summon nasal demons and use <code>target/collector</code> <span aria-label="upside down" class="emoji emoji-1f643" role="img" title="upside down">:upside_down:</span></p>



<a name="204038608"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/247081-t-compiler/performance/topic/Clean-up%20of%20the%20%60collector%60%20subcommands/near/204038608" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> eddyb <a href="https://zulip-archive.rust-lang.org/stream/247081-t-compiler/performance/topic/Clean-up.20of.20the.20.60collector.60.20subcommands.html#204038608">(Jul 16 2020 at 02:38)</a>:</h4>
<p>has someone filed an issue yet to move to <code>structopt</code>?</p>



<a name="204038620"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/247081-t-compiler/performance/topic/Clean-up%20of%20the%20%60collector%60%20subcommands/near/204038620" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Nelson <a href="https://zulip-archive.rust-lang.org/stream/247081-t-compiler/performance/topic/Clean-up.20of.20the.20.60collector.60.20subcommands.html#204038620">(Jul 16 2020 at 02:39)</a>:</h4>
<p>ehh, I don't think structopt is a giant improvement over the clap macros</p>



<a name="204038626"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/247081-t-compiler/performance/topic/Clean-up%20of%20the%20%60collector%60%20subcommands/near/204038626" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> eddyb <a href="https://zulip-archive.rust-lang.org/stream/247081-t-compiler/performance/topic/Clean-up.20of.20the.20.60collector.60.20subcommands.html#204038626">(Jul 16 2020 at 02:39)</a>:</h4>
<p><em>shrug</em> it feels cleaner and I think you can do some options reuse with it</p>



<a name="204038644"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/247081-t-compiler/performance/topic/Clean-up%20of%20the%20%60collector%60%20subcommands/near/204038644" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> eddyb <a href="https://zulip-archive.rust-lang.org/stream/247081-t-compiler/performance/topic/Clean-up.20of.20the.20.60collector.60.20subcommands.html#204038644">(Jul 16 2020 at 02:40)</a>:</h4>
<p><span class="user-mention" data-user-id="120989">@njn</span> I'd expect something with "results" in its name, for the output</p>



<a name="204040725"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/247081-t-compiler/performance/topic/Clean-up%20of%20the%20%60collector%60%20subcommands/near/204040725" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> simulacrum <a href="https://zulip-archive.rust-lang.org/stream/247081-t-compiler/performance/topic/Clean-up.20of.20the.20.60collector.60.20subcommands.html#204040725">(Jul 16 2020 at 03:22)</a>:</h4>
<p>structopt gives you more flexibility and is what the ecosystem uses, and personally I find it a ton more readable than the macros</p>



<a name="204040730"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/247081-t-compiler/performance/topic/Clean-up%20of%20the%20%60collector%60%20subcommands/near/204040730" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> simulacrum <a href="https://zulip-archive.rust-lang.org/stream/247081-t-compiler/performance/topic/Clean-up.20of.20the.20.60collector.60.20subcommands.html#204040730">(Jul 16 2020 at 03:23)</a>:</h4>
<p>(I guess you pay some compile time but with our 350 deps already it won't matter that much)</p>



<a name="204052474"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/247081-t-compiler/performance/topic/Clean-up%20of%20the%20%60collector%60%20subcommands/near/204052474" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pachi <a href="https://zulip-archive.rust-lang.org/stream/247081-t-compiler/performance/topic/Clean-up.20of.20the.20.60collector.60.20subcommands.html#204052474">(Jul 16 2020 at 07:15)</a>:</h4>
<p>Clap 3 will integrate strctopt, but it's in a long cooking. <a class="stream" data-stream-id="220302" href="/#narrow/stream/220302-wg-cli">#wg-cli</a> knows more</p>



<a name="204052649"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/247081-t-compiler/performance/topic/Clean-up%20of%20the%20%60collector%60%20subcommands/near/204052649" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> eddyb <a href="https://zulip-archive.rust-lang.org/stream/247081-t-compiler/performance/topic/Clean-up.20of.20the.20.60collector.60.20subcommands.html#204052649">(Jul 16 2020 at 07:18)</a>:</h4>
<p>presumably clap -&gt; structopt will be where you need to change the code, and structopt -&gt; clap3 is mostly a surface thing</p>



<a name="204148563"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/247081-t-compiler/performance/topic/Clean-up%20of%20the%20%60collector%60%20subcommands/near/204148563" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> njn <a href="https://zulip-archive.rust-lang.org/stream/247081-t-compiler/performance/topic/Clean-up.20of.20the.20.60collector.60.20subcommands.html#204148563">(Jul 16 2020 at 21:56)</a>:</h4>
<p><span class="user-mention" data-user-id="116122">@simulacrum</span> is the <code>script-servo</code> comment in <a href="https://github.com/rust-lang/rustc-perf/blob/master/collector/benchmarks/README.md">https://github.com/rust-lang/rustc-perf/blob/master/collector/benchmarks/README.md</a> out of date?</p>



<a name="204148595"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/247081-t-compiler/performance/topic/Clean-up%20of%20the%20%60collector%60%20subcommands/near/204148595" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> simulacrum <a href="https://zulip-archive.rust-lang.org/stream/247081-t-compiler/performance/topic/Clean-up.20of.20the.20.60collector.60.20subcommands.html#204148595">(Jul 16 2020 at 21:56)</a>:</h4>
<p>Hm you mean which commit we pulled in?</p>



<a name="204148605"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/247081-t-compiler/performance/topic/Clean-up%20of%20the%20%60collector%60%20subcommands/near/204148605" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> simulacrum <a href="https://zulip-archive.rust-lang.org/stream/247081-t-compiler/performance/topic/Clean-up.20of.20the.20.60collector.60.20subcommands.html#204148605">(Jul 16 2020 at 21:57)</a>:</h4>
<p>I think it should be correct</p>



<a name="204148637"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/247081-t-compiler/performance/topic/Clean-up%20of%20the%20%60collector%60%20subcommands/near/204148637" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> simulacrum <a href="https://zulip-archive.rust-lang.org/stream/247081-t-compiler/performance/topic/Clean-up.20of.20the.20.60collector.60.20subcommands.html#204148637">(Jul 16 2020 at 21:57)</a>:</h4>
<p>Maybe I managed to mess up somehow though</p>



<a name="204149438"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/247081-t-compiler/performance/topic/Clean-up%20of%20the%20%60collector%60%20subcommands/near/204149438" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> njn <a href="https://zulip-archive.rust-lang.org/stream/247081-t-compiler/performance/topic/Clean-up.20of.20the.20.60collector.60.20subcommands.html#204149438">(Jul 16 2020 at 22:06)</a>:</h4>
<p>Ok, but the name is missing the <code>-2</code> suffix</p>



<a name="204149511"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/247081-t-compiler/performance/topic/Clean-up%20of%20the%20%60collector%60%20subcommands/near/204149511" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> njn <a href="https://zulip-archive.rust-lang.org/stream/247081-t-compiler/performance/topic/Clean-up.20of.20the.20.60collector.60.20subcommands.html#204149511">(Jul 16 2020 at 22:07)</a>:</h4>
<p>I checked blame, you updated the description, but missed the -2 suffix</p>



<a name="204149513"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/247081-t-compiler/performance/topic/Clean-up%20of%20the%20%60collector%60%20subcommands/near/204149513" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> njn <a href="https://zulip-archive.rust-lang.org/stream/247081-t-compiler/performance/topic/Clean-up.20of.20the.20.60collector.60.20subcommands.html#204149513">(Jul 16 2020 at 22:07)</a>:</h4>
<p>I will fix that</p>



<a name="204150139"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/247081-t-compiler/performance/topic/Clean-up%20of%20the%20%60collector%60%20subcommands/near/204150139" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> njn <a href="https://zulip-archive.rust-lang.org/stream/247081-t-compiler/performance/topic/Clean-up.20of.20the.20.60collector.60.20subcommands.html#204150139">(Jul 16 2020 at 22:14)</a>:</h4>
<p><span class="user-mention" data-user-id="116122">@simulacrum</span> I have addressed your review comments for the big overhaul, thank you. Is it ok for me to merge this now? It's 8.15am here so I will be around all day to help fix any problems</p>



<a name="204150422"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/247081-t-compiler/performance/topic/Clean-up%20of%20the%20%60collector%60%20subcommands/near/204150422" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> njn <a href="https://zulip-archive.rust-lang.org/stream/247081-t-compiler/performance/topic/Clean-up.20of.20the.20.60collector.60.20subcommands.html#204150422">(Jul 16 2020 at 22:17)</a>:</h4>
<p>Oh conflicts. Oh dear, I hope they aren't bad...</p>



<a name="204150719"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/247081-t-compiler/performance/topic/Clean-up%20of%20the%20%60collector%60%20subcommands/near/204150719" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> njn <a href="https://zulip-archive.rust-lang.org/stream/247081-t-compiler/performance/topic/Clean-up.20of.20the.20.60collector.60.20subcommands.html#204150719">(Jul 16 2020 at 22:20)</a>:</h4>
<p>Ok, easy</p>



<a name="204150857"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/247081-t-compiler/performance/topic/Clean-up%20of%20the%20%60collector%60%20subcommands/near/204150857" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> njn <a href="https://zulip-archive.rust-lang.org/stream/247081-t-compiler/performance/topic/Clean-up.20of.20the.20.60collector.60.20subcommands.html#204150857">(Jul 16 2020 at 22:22)</a>:</h4>
<p>I guess you'll have to deploy for the changes to reach production</p>



<a name="204151030"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/247081-t-compiler/performance/topic/Clean-up%20of%20the%20%60collector%60%20subcommands/near/204151030" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> njn <a href="https://zulip-archive.rust-lang.org/stream/247081-t-compiler/performance/topic/Clean-up.20of.20the.20.60collector.60.20subcommands.html#204151030">(Jul 16 2020 at 22:24)</a>:</h4>
<p>And I should at least wait for CI tests to pass</p>



<a name="204155306"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/247081-t-compiler/performance/topic/Clean-up%20of%20the%20%60collector%60%20subcommands/near/204155306" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> simulacrum <a href="https://zulip-archive.rust-lang.org/stream/247081-t-compiler/performance/topic/Clean-up.20of.20the.20.60collector.60.20subcommands.html#204155306">(Jul 16 2020 at 23:24)</a>:</h4>
<p><span class="user-mention" data-user-id="120989">@njn</span> yeah feel free to merge in the future</p>



<a name="204155351"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/247081-t-compiler/performance/topic/Clean-up%20of%20the%20%60collector%60%20subcommands/near/204155351" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> simulacrum <a href="https://zulip-archive.rust-lang.org/stream/247081-t-compiler/performance/topic/Clean-up.20of.20the.20.60collector.60.20subcommands.html#204155351">(Jul 16 2020 at 23:25)</a>:</h4>
<p>I deploy whenever I get a chance -- we currently don't cache in-progress builds so most of the time I try to wait till we're in between (or right at the start) to avoid losing a lot of work</p>



<a name="204155773"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/247081-t-compiler/performance/topic/Clean-up%20of%20the%20%60collector%60%20subcommands/near/204155773" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> njn <a href="https://zulip-archive.rust-lang.org/stream/247081-t-compiler/performance/topic/Clean-up.20of.20the.20.60collector.60.20subcommands.html#204155773">(Jul 16 2020 at 23:31)</a>:</h4>
<p>Thanks for merging.</p>



<a name="204155800"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/247081-t-compiler/performance/topic/Clean-up%20of%20the%20%60collector%60%20subcommands/near/204155800" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> njn <a href="https://zulip-archive.rust-lang.org/stream/247081-t-compiler/performance/topic/Clean-up.20of.20the.20.60collector.60.20subcommands.html#204155800">(Jul 16 2020 at 23:31)</a>:</h4>
<p><span class="user-mention" data-user-id="211727">@Jonas Schievink</span> I just landed a big overhaul to the command-line interface of rustc-perf. It's a lot easier to get started now!</p>



<a name="204155817"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/247081-t-compiler/performance/topic/Clean-up%20of%20the%20%60collector%60%20subcommands/near/204155817" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> njn <a href="https://zulip-archive.rust-lang.org/stream/247081-t-compiler/performance/topic/Clean-up.20of.20the.20.60collector.60.20subcommands.html#204155817">(Jul 16 2020 at 23:31)</a>:</h4>
<p><a href="https://github.com/rust-lang/rustc-perf/blob/master/collector/README.md">https://github.com/rust-lang/rustc-perf/blob/master/collector/README.md</a></p>



<a name="204155903"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/247081-t-compiler/performance/topic/Clean-up%20of%20the%20%60collector%60%20subcommands/near/204155903" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jonas Schievink  [he/him] <a href="https://zulip-archive.rust-lang.org/stream/247081-t-compiler/performance/topic/Clean-up.20of.20the.20.60collector.60.20subcommands.html#204155903">(Jul 16 2020 at 23:32)</a>:</h4>
<p><span class="user-mention" data-user-id="120989">@njn</span> wow, thanks so much, that looks very good!</p>



<a name="204155962"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/247081-t-compiler/performance/topic/Clean-up%20of%20the%20%60collector%60%20subcommands/near/204155962" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> njn <a href="https://zulip-archive.rust-lang.org/stream/247081-t-compiler/performance/topic/Clean-up.20of.20the.20.60collector.60.20subcommands.html#204155962">(Jul 16 2020 at 23:33)</a>:</h4>
<p>We definitely want people to be running the benchmarks locally, so when you tried and failed, for me it was like a red rag to a bull</p>



<a name="204156192"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/247081-t-compiler/performance/topic/Clean-up%20of%20the%20%60collector%60%20subcommands/near/204156192" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> simulacrum <a href="https://zulip-archive.rust-lang.org/stream/247081-t-compiler/performance/topic/Clean-up.20of.20the.20.60collector.60.20subcommands.html#204156192">(Jul 16 2020 at 23:35)</a>:</h4>
<p>I'll probably deploy the changes later tonight or tomorrow, we're 5 benchmarks away from completing the current run</p>



<a name="204158066"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/247081-t-compiler/performance/topic/Clean-up%20of%20the%20%60collector%60%20subcommands/near/204158066" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> simulacrum <a href="https://zulip-archive.rust-lang.org/stream/247081-t-compiler/performance/topic/Clean-up.20of.20the.20.60collector.60.20subcommands.html#204158066">(Jul 17 2020 at 00:01)</a>:</h4>
<p>okay changes are deployed</p>



<a name="204158078"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/247081-t-compiler/performance/topic/Clean-up%20of%20the%20%60collector%60%20subcommands/near/204158078" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> simulacrum <a href="https://zulip-archive.rust-lang.org/stream/247081-t-compiler/performance/topic/Clean-up.20of.20the.20.60collector.60.20subcommands.html#204158078">(Jul 17 2020 at 00:01)</a>:</h4>
<p>seems to be working...</p>



<hr><p>Last updated: Apr 12 2022 at 20:01 UTC</p>
</html>