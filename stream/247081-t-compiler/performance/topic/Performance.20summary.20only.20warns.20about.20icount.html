<html>
<head><meta charset="utf-8"><title>Performance summary only warns about icount · t-compiler/performance · Zulip Chat Archive</title></head>
<h2>Stream: <a href="https://zulip-archive.rust-lang.org/stream/247081-t-compiler/performance/index.html">t-compiler/performance</a></h2>
<h3>Topic: <a href="https://zulip-archive.rust-lang.org/stream/247081-t-compiler/performance/topic/Performance.20summary.20only.20warns.20about.20icount.html">Performance summary only warns about icount</a></h3>

<hr>

<base href="https://rust-lang.zulipchat.com">

<head><link href="https://zulip-archive.rust-lang.org/style.css" rel="stylesheet"></head>

<a name="276474286"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/247081-t-compiler/performance/topic/Performance%20summary%20only%20warns%20about%20icount/near/276474286" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jakub Beránek <a href="https://zulip-archive.rust-lang.org/stream/247081-t-compiler/performance/topic/Performance.20summary.20only.20warns.20about.20icount.html#276474286">(Mar 24 2022 at 13:21)</a>:</h4>
<p>The PR comment that is posted by <code>rust-timer</code> after a perf. run only contains information about instruction counts. While other data (RSS, cycles, walltime) can be notoriously unstable, I still think that it could be useful to at least provide some warning in the comment if they change (with some quite large thresholds to filter out noise).</p>
<p>Sometimes these values can change even though icount stays largely the same, which can be problematic if no one takes the time to look at them. For example, <a href="https://github.com/rust-lang/rust/pull/95171#issuecomment-1077613520">here</a> icounts are basically the same, but RSS has improved significantly (and, seemingly, consistently).</p>
<p>What about including some text to the comment if a large change is detected, at least for RSS? Let's say that if RSS detects a lot of significant changes (or if the changes are almost exclusively to one side) or if the arithmetic mean is larger than a few percent, we could include some text like "It looks like RSS has changed significantly. While it may be noise, you can check the results <a href="http://link">here</a>.".</p>



<a name="276475949"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/247081-t-compiler/performance/topic/Performance%20summary%20only%20warns%20about%20icount/near/276475949" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> rylev <a href="https://zulip-archive.rust-lang.org/stream/247081-t-compiler/performance/topic/Performance.20summary.20only.20warns.20about.20icount.html#276475949">(Mar 24 2022 at 13:35)</a>:</h4>
<p>I'd be in favor of including more. We just don't have a good grip on what the threshold between noise and truly relevant changes to RSS actually is. Once we come to an agreement on that, I think we should try including something.</p>



<a name="276476022"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/247081-t-compiler/performance/topic/Performance%20summary%20only%20warns%20about%20icount/near/276476022" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> rylev <a href="https://zulip-archive.rust-lang.org/stream/247081-t-compiler/performance/topic/Performance.20summary.20only.20warns.20about.20icount.html#276476022">(Mar 24 2022 at 13:36)</a>:</h4>
<p>As an FYI: there's an issue open right now examining ways to improve the messaging posted after perf runs: <a href="https://github.com/rust-lang/rustc-perf/issues/1214">https://github.com/rust-lang/rustc-perf/issues/1214</a></p>



<a name="276478751"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/247081-t-compiler/performance/topic/Performance%20summary%20only%20warns%20about%20icount/near/276478751" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jakub Beránek <a href="https://zulip-archive.rust-lang.org/stream/247081-t-compiler/performance/topic/Performance.20summary.20only.20warns.20about.20icount.html#276478751">(Mar 24 2022 at 13:57)</a>:</h4>
<p>I saw that and I like the table very much! After you reach a consensus I can implement it.</p>



<a name="276479933"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/247081-t-compiler/performance/topic/Performance%20summary%20only%20warns%20about%20icount/near/276479933" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> bjorn3 <a href="https://zulip-archive.rust-lang.org/stream/247081-t-compiler/performance/topic/Performance.20summary.20only.20warns.20about.20icount.html#276479933">(Mar 24 2022 at 14:06)</a>:</h4>
<p>I think we should take the change across all benchmarks into account to reduce noise.</p>



<a name="276550310"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/247081-t-compiler/performance/topic/Performance%20summary%20only%20warns%20about%20icount/near/276550310" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nnethercote <a href="https://zulip-archive.rust-lang.org/stream/247081-t-compiler/performance/topic/Performance.20summary.20only.20warns.20about.20icount.html#276550310">(Mar 24 2022 at 23:00)</a>:</h4>
<p>The basic idea here is great, the challenge is implementing it in an effective manner <span aria-label="smile" class="emoji emoji-1f642" role="img" title="smile">:smile:</span></p>



<a name="276584212"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/247081-t-compiler/performance/topic/Performance%20summary%20only%20warns%20about%20icount/near/276584212" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jakub Beránek <a href="https://zulip-archive.rust-lang.org/stream/247081-t-compiler/performance/topic/Performance.20summary.20only.20warns.20about.20icount.html#276584212">(Mar 25 2022 at 07:33)</a>:</h4>
<p>It would be quite useful to have the ability to download historical data from RLO to experiment with this analysis of e.g. RSS.</p>



<hr><p>Last updated: Apr 12 2022 at 20:01 UTC</p>
</html>