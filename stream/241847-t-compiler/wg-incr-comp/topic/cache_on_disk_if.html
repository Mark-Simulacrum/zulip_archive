<html>
<head><meta charset="utf-8"><title>cache_on_disk_if · t-compiler/wg-incr-comp · Zulip Chat Archive</title></head>
<h2>Stream: <a href="https://zulip-archive.rust-lang.org/stream/241847-t-compiler/wg-incr-comp/index.html">t-compiler/wg-incr-comp</a></h2>
<h3>Topic: <a href="https://zulip-archive.rust-lang.org/stream/241847-t-compiler/wg-incr-comp/topic/cache_on_disk_if.html">cache_on_disk_if</a></h3>

<hr>

<base href="https://rust-lang.zulipchat.com">

<head><link href="https://zulip-archive.rust-lang.org/style.css" rel="stylesheet"></head>

<a name="258100318"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/241847-t-compiler/wg-incr-comp/topic/cache_on_disk_if/near/258100318" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> lcnr <a href="https://zulip-archive.rust-lang.org/stream/241847-t-compiler/wg-incr-comp/topic/cache_on_disk_if.html#258100318">(Oct 18 2021 at 21:06)</a>:</h4>
<p>cache_on_disk_if is sometimes called with <code>None</code>.When should I return <code>true</code> if that happens?</p>



<a name="258106176"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/241847-t-compiler/wg-incr-comp/topic/cache_on_disk_if/near/258106176" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> cjgillot <a href="https://zulip-archive.rust-lang.org/stream/241847-t-compiler/wg-incr-comp/topic/cache_on_disk_if.html#258106176">(Oct 18 2021 at 21:49)</a>:</h4>
<p>cache_on_disk_if will be passed Some when trying to know whether to save a value, and it will be passed None when trying to know whether to load it. I think the two cases should be identical, otherwise we will attempt to save values that will never be read.</p>



<a name="258106289"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/241847-t-compiler/wg-incr-comp/topic/cache_on_disk_if/near/258106289" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> cjgillot <a href="https://zulip-archive.rust-lang.org/stream/241847-t-compiler/wg-incr-comp/topic/cache_on_disk_if.html#258106289">(Oct 18 2021 at 21:50)</a>:</h4>
<p>I am planning to remove the possibility to pass the query result to <code>cache_on_disk_if</code> for this reason. Do you have a use case in mind?</p>



<a name="258107018"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/241847-t-compiler/wg-incr-comp/topic/cache_on_disk_if/near/258107018" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> lcnr <a href="https://zulip-archive.rust-lang.org/stream/241847-t-compiler/wg-incr-comp/topic/cache_on_disk_if.html#258107018">(Oct 18 2021 at 21:56)</a>:</h4>
<p>i want to change <code>specialization_graph_of</code> to return a <code>Result</code> and don't want to cache it when returing <code>Err</code> (which should only happen when failing compilation)</p>



<a name="258107050"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/241847-t-compiler/wg-incr-comp/topic/cache_on_disk_if/near/258107050" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> lcnr <a href="https://zulip-archive.rust-lang.org/stream/241847-t-compiler/wg-incr-comp/topic/cache_on_disk_if.html#258107050">(Oct 18 2021 at 21:56)</a>:</h4>
<p>though we probably don't cache stuff anyways in that case?</p>



<a name="258109401"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/241847-t-compiler/wg-incr-comp/topic/cache_on_disk_if/near/258109401" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> cjgillot <a href="https://zulip-archive.rust-lang.org/stream/241847-t-compiler/wg-incr-comp/topic/cache_on_disk_if.html#258109401">(Oct 18 2021 at 22:16)</a>:</h4>
<p>Normally, the dep-graph and the on-disk query cache are discarded if errors have been emitted.</p>



<a name="258109497"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/241847-t-compiler/wg-incr-comp/topic/cache_on_disk_if/near/258109497" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> cjgillot <a href="https://zulip-archive.rust-lang.org/stream/241847-t-compiler/wg-incr-comp/topic/cache_on_disk_if.html#258109497">(Oct 18 2021 at 22:17)</a>:</h4>
<p>I mean, the old caches are left on the disk and are not overwritten by the session which produced errors.</p>



<a name="258110827"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/241847-t-compiler/wg-incr-comp/topic/cache_on_disk_if/near/258110827" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> lcnr <a href="https://zulip-archive.rust-lang.org/stream/241847-t-compiler/wg-incr-comp/topic/cache_on_disk_if.html#258110827">(Oct 18 2021 at 22:29)</a>:</h4>
<p>thanks &lt;3</p>



<hr><p>Last updated: Apr 12 2022 at 20:01 UTC</p>
</html>