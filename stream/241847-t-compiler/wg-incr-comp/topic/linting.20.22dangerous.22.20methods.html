<html>
<head><meta charset="utf-8"><title>linting &quot;dangerous&quot; methods · t-compiler/wg-incr-comp · Zulip Chat Archive</title></head>
<h2>Stream: <a href="https://zulip-archive.rust-lang.org/stream/241847-t-compiler/wg-incr-comp/index.html">t-compiler/wg-incr-comp</a></h2>
<h3>Topic: <a href="https://zulip-archive.rust-lang.org/stream/241847-t-compiler/wg-incr-comp/topic/linting.20.22dangerous.22.20methods.html">linting &quot;dangerous&quot; methods</a></h3>

<hr>

<base href="https://rust-lang.zulipchat.com">

<head><link href="https://zulip-archive.rust-lang.org/style.css" rel="stylesheet"></head>

<a name="256255511"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/241847-t-compiler/wg-incr-comp/topic/linting%20%22dangerous%22%20methods/near/256255511" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> lcnr <a href="https://zulip-archive.rust-lang.org/stream/241847-t-compiler/wg-incr-comp/topic/linting.20.22dangerous.22.20methods.html#256255511">(Oct 05 2021 at 14:30)</a>:</h4>
<p>After <a href="https://github.com/rust-lang/rust/issues/89016">#89016</a> and a afaik some other incr comp bugs due to iterating over hashmaps, i wrote i lint warning when using these methods: <a href="https://github.com/rust-lang/rust/issues/89016">#89016</a></p>



<a name="256255905"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/241847-t-compiler/wg-incr-comp/topic/linting%20%22dangerous%22%20methods/near/256255905" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> lcnr <a href="https://zulip-archive.rust-lang.org/stream/241847-t-compiler/wg-incr-comp/topic/linting.20.22dangerous.22.20methods.html#256255905">(Oct 05 2021 at 14:33)</a>:</h4>
<p>this PR adds an attribute <code>#[rustc_lint_query_stability]</code> to  these methods and leads to the following amount of warnings</p>
<div class="codehilite"><pre><span></span><code>warning: `rustc_lint` (lib) generated 6 warnings
warning: `rustc_privacy` (lib) generated 2 warnings
warning: `rustc_middle` (lib) generated 8 warnings
warning: `rustc_mir_build` (lib) generated 1 warning
warning: `rustc_const_eval` (lib) generated 2 warnings
warning: `rustc_codegen_llvm` (lib) generated 7 warnings
warning: `rustc_trait_selection` (lib) generated 12 warnings
warning: `rustc_mir_transform` (lib) generated 3 warnings
warning: `rustc_interface` (lib) generated 4 warnings
warning: `rustc_borrowck` (lib) generated 12 warnings
warning: `rustc_typeck` (lib) generated 31 warnings
warning: `rustc_query_impl` (lib) generated 1 warning
</code></pre></div>



<a name="256256067"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/241847-t-compiler/wg-incr-comp/topic/linting%20%22dangerous%22%20methods/near/256256067" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> lcnr <a href="https://zulip-archive.rust-lang.org/stream/241847-t-compiler/wg-incr-comp/topic/linting.20.22dangerous.22.20methods.html#256256067">(Oct 05 2021 at 14:34)</a>:</h4>
<p>there are a bunch of warnings which are obviously unnecessary, e.g. <code>map.retain</code> with a pure predicate</p>



<a name="256256130"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/241847-t-compiler/wg-incr-comp/topic/linting%20%22dangerous%22%20methods/near/256256130" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> lcnr <a href="https://zulip-archive.rust-lang.org/stream/241847-t-compiler/wg-incr-comp/topic/linting.20.22dangerous.22.20methods.html#256256130">(Oct 05 2021 at 14:34)</a>:</h4>
<p>but also areas which are far from trivially correct or even buggy</p>



<a name="256256978"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/241847-t-compiler/wg-incr-comp/topic/linting%20%22dangerous%22%20methods/near/256256978" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> lcnr <a href="https://zulip-archive.rust-lang.org/stream/241847-t-compiler/wg-incr-comp/topic/linting.20.22dangerous.22.20methods.html#256256978">(Oct 05 2021 at 14:38)</a>:</h4>
<p>won't look into all of the warnings today, so in case one of <span class="user-group-mention" data-user-group-id="3282">@wg-incr-comp</span> in interested in where we (incorrectly) use hashmaps feel free to take a peek. Will probably try and fix these warnings next week unless someone else already did by then</p>



<a name="256257009"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/241847-t-compiler/wg-incr-comp/topic/linting%20%22dangerous%22%20methods/near/256257009" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> lcnr <a href="https://zulip-archive.rust-lang.org/stream/241847-t-compiler/wg-incr-comp/topic/linting.20.22dangerous.22.20methods.html#256257009">(Oct 05 2021 at 14:38)</a>:</h4>
<p>(also going to open an mcp rn <span aria-label="sweat smile" class="emoji emoji-1f605" role="img" title="sweat smile">:sweat_smile:</span> )</p>



<hr><p>Last updated: Apr 12 2022 at 20:01 UTC</p>
</html>