<html>
<head><meta charset="utf-8"><title>more test coverage · rustdoc · Zulip Chat Archive</title></head>
<h2>Stream: <a href="https://zulip-archive.rust-lang.org/stream/266220-rustdoc/index.html">rustdoc</a></h2>
<h3>Topic: <a href="https://zulip-archive.rust-lang.org/stream/266220-rustdoc/topic/more.20test.20coverage.html">more test coverage</a></h3>

<hr>

<base href="https://rust-lang.zulipchat.com">

<head><link href="https://zulip-archive.rust-lang.org/style.css" rel="stylesheet"></head>

<a name="262189671"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/266220-rustdoc/topic/more%20test%20coverage/near/262189671" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Noah Lev <a href="https://zulip-archive.rust-lang.org/stream/266220-rustdoc/topic/more.20test.20coverage.html#262189671">(Nov 20 2021 at 15:44)</a>:</h4>
<p>Currently, rustdoc doesn't have a lot of test coverage, but it does have a lot of edge cases. It'd be good to have more test coverage so we can improve the code with less fear of introducing bugs.</p>
<p>What do you think about creating <code>E-easy</code> + <code>E-mentor</code> issues focused on writing more tests? We'd need to give instructions on what kinds of tests to write (e.g., testing doc-comment indentation, or re-exports), and then ask people to come up with wonky code that exercises rustdoc's edge cases.</p>



<a name="262189736"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/266220-rustdoc/topic/more%20test%20coverage/near/262189736" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Nelson <a href="https://zulip-archive.rust-lang.org/stream/266220-rustdoc/topic/more.20test.20coverage.html#262189736">(Nov 20 2021 at 15:45)</a>:</h4>
<p>It would be nice to test exactly how inlining works too</p>



<a name="262189930"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/266220-rustdoc/topic/more%20test%20coverage/near/262189930" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Noah Lev <a href="https://zulip-archive.rust-lang.org/stream/266220-rustdoc/topic/more.20test.20coverage.html#262189930">(Nov 20 2021 at 15:50)</a>:</h4>
<p><span class="user-mention silent" data-user-id="232545">Joshua Nelson</span> <a href="#narrow/stream/266220-rustdoc/topic/more.20test.20coverage/near/262189736">said</a>:</p>
<blockquote>
<p>It would be nice to test exactly how inlining works too</p>
</blockquote>
<p>Yep, I agree; that's what I was referring to when I said re-exports.</p>



<a name="262196771"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/266220-rustdoc/topic/more%20test%20coverage/near/262196771" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> jsha <a href="https://zulip-archive.rust-lang.org/stream/266220-rustdoc/topic/more.20test.20coverage.html#262196771">(Nov 20 2021 at 18:13)</a>:</h4>
<p>It's definitely a good idea to write down in detail what tests need to get written, ideally in enough detail that it could be considered easy. I think writing tests is often not a good beginner task though, since so much of the process is asking oneself "is this broken, or do I just misunderstand the code?"</p>
<p>Also writing tests and having a good experience requires having a tight loop- like knowing how to run just one test, and not rebuild the compiler all the time, and so on. Before we invite beginners to write tests, we should make sure our first-time setup documentation lays out the tight loop for our tests.</p>



<a name="262198233"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/266220-rustdoc/topic/more%20test%20coverage/near/262198233" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Noah Lev <a href="https://zulip-archive.rust-lang.org/stream/266220-rustdoc/topic/more.20test.20coverage.html#262198233">(Nov 20 2021 at 18:42)</a>:</h4>
<p>We could add specialized docs to the issue to help with the "tight loop" part. That way, people don't have to try to apply general docs to the specific scenario.</p>



<a name="262198257"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/266220-rustdoc/topic/more%20test%20coverage/near/262198257" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Noah Lev <a href="https://zulip-archive.rust-lang.org/stream/266220-rustdoc/topic/more.20test.20coverage.html#262198257">(Nov 20 2021 at 18:43)</a>:</h4>
<blockquote>
<p>I think writing tests is often not a good beginner task though, since so much of the process is asking oneself "is this broken, or do I just misunderstand the code?"</p>
</blockquote>
<p>I do think that writing tests can be hard for beginners, but we can say that you don't need to make sure the behavior is correct. During review we can check if the behavior makes sense. The hard part is coming up with test cases, so I'm happy to check the behavior myself.</p>



<a name="262201951"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/266220-rustdoc/topic/more%20test%20coverage/near/262201951" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> GuillaumeGomez <a href="https://zulip-archive.rust-lang.org/stream/266220-rustdoc/topic/more.20test.20coverage.html#262201951">(Nov 20 2021 at 20:07)</a>:</h4>
<p>Totally agree. Since a year or so, we have been adding/updating tests for new features and bug fixes. Adding even more tests will only improve it overall.</p>



<a name="262257342"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/266220-rustdoc/topic/more%20test%20coverage/near/262257342" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Noah Lev <a href="https://zulip-archive.rust-lang.org/stream/266220-rustdoc/topic/more.20test.20coverage.html#262257342">(Nov 21 2021 at 19:55)</a>:</h4>
<p>Great, I opened an <code>E-easy</code> + <code>E-mentor</code> issue! <a href="https://github.com/rust-lang/rust/issues/91113">#91113</a></p>



<a name="262257357"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/266220-rustdoc/topic/more%20test%20coverage/near/262257357" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Noah Lev <a href="https://zulip-archive.rust-lang.org/stream/266220-rustdoc/topic/more.20test.20coverage.html#262257357">(Nov 21 2021 at 19:55)</a>:</h4>
<p>Please add to the "What to test" list if you have ideas :)</p>



<a name="262303311"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/266220-rustdoc/topic/more%20test%20coverage/near/262303311" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Cameron M <a href="https://zulip-archive.rust-lang.org/stream/266220-rustdoc/topic/more.20test.20coverage.html#262303311">(Nov 22 2021 at 10:46)</a>:</h4>
<p>Hi, I just claimed that issue (although just noticed it's a tracking issue, not sure if it makes sense to claim it). I'm very new to rustdoc but looking to get more involved. Not sure if I'm missing something obvious, but I've tried garbling some <code>@has</code> comments, and running <code>./x.py test src/test/rustdoc</code>, and the tests are still passing (it's also only running 4 tests, ignoring 480). Any idea what I'm doing wrong?</p>



<a name="262303748"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/266220-rustdoc/topic/more%20test%20coverage/near/262303748" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Nelson <a href="https://zulip-archive.rust-lang.org/stream/266220-rustdoc/topic/more.20test.20coverage.html#262303748">(Nov 22 2021 at 10:51)</a>:</h4>
<p><span class="user-mention" data-user-id="450601">@Cameron M</span> it's probably rerunning only the tests you've changed.</p>
<p>As for why they aren't failing, that probably just means the test never worked in the first place <span aria-label="sweat smile" class="emoji emoji-1f605" role="img" title="sweat smile">:sweat_smile:</span> unless this is a <code>@!has</code> directive in which case it doesn't make sense to modify it randomly</p>



<a name="262303915"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/266220-rustdoc/topic/more%20test%20coverage/near/262303915" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Nelson <a href="https://zulip-archive.rust-lang.org/stream/266220-rustdoc/topic/more.20test.20coverage.html#262303915">(Nov 22 2021 at 10:53)</a>:</h4>
<p>Unassigned you on the issue with an explanation why</p>



<a name="262306028"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/266220-rustdoc/topic/more%20test%20coverage/near/262306028" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Cameron M <a href="https://zulip-archive.rust-lang.org/stream/266220-rustdoc/topic/more.20test.20coverage.html#262306028">(Nov 22 2021 at 11:17)</a>:</h4>
<p>Ah, the test I was modifying was in <code>src/test/rustdoc-json</code> <span aria-label="face palm" class="emoji emoji-1f926" role="img" title="face palm">:face_palm:</span> . Just checking I've got the right idea with this issue, we're just trying to increase test coverage to pin down the current behaaviour, rather than writing tests to match a spec/RFC?</p>



<a name="262307047"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/266220-rustdoc/topic/more%20test%20coverage/near/262307047" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Nelson <a href="https://zulip-archive.rust-lang.org/stream/266220-rustdoc/topic/more.20test.20coverage.html#262307047">(Nov 22 2021 at 11:29)</a>:</h4>
<p>Correct, in a lot of cases we're not even sure what rustdoc does <em>currently</em> and knowing that is a prerequisite to changing it</p>



<a name="262307146"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/266220-rustdoc/topic/more%20test%20coverage/near/262307146" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Nelson <a href="https://zulip-archive.rust-lang.org/stream/266220-rustdoc/topic/more.20test.20coverage.html#262307146">(Nov 22 2021 at 11:30)</a>:</h4>
<p>And I'd suggest not worrying about the JSON output too much for now, it's both unstable and known to be buggy</p>



<a name="262307176"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/266220-rustdoc/topic/more%20test%20coverage/near/262307176" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Nelson <a href="https://zulip-archive.rust-lang.org/stream/266220-rustdoc/topic/more.20test.20coverage.html#262307176">(Nov 22 2021 at 11:31)</a>:</h4>
<p>src/test/rustdoc is a good place to play around with :)</p>



<a name="262316004"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/266220-rustdoc/topic/more%20test%20coverage/near/262316004" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> GuillaumeGomez <a href="https://zulip-archive.rust-lang.org/stream/266220-rustdoc/topic/more.20test.20coverage.html#262316004">(Nov 22 2021 at 13:08)</a>:</h4>
<p><span class="user-mention silent" data-user-id="232545">Joshua Nelson</span> <a href="#narrow/stream/266220-rustdoc/topic/more.20test.20coverage/near/262307146">said</a>:</p>
<blockquote>
<p>And I'd suggest not worrying about the JSON output too much for now, it's both unstable and known to be buggy</p>
</blockquote>
<p>We're back to a few years ago haha</p>



<a name="262639032"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/266220-rustdoc/topic/more%20test%20coverage/near/262639032" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Noah Lev <a href="https://zulip-archive.rust-lang.org/stream/266220-rustdoc/topic/more.20test.20coverage.html#262639032">(Nov 24 2021 at 20:52)</a>:</h4>
<p>We could also consider posting about this in This Week in Rust to get more volunteers? Though that might overwhelm our review capacity...</p>



<a name="262639049"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/266220-rustdoc/topic/more%20test%20coverage/near/262639049" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Noah Lev <a href="https://zulip-archive.rust-lang.org/stream/266220-rustdoc/topic/more.20test.20coverage.html#262639049">(Nov 24 2021 at 20:52)</a>:</h4>
<p>Perhaps it's best to start small</p>



<a name="262643148"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/266220-rustdoc/topic/more%20test%20coverage/near/262643148" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> GuillaumeGomez <a href="https://zulip-archive.rust-lang.org/stream/266220-rustdoc/topic/more.20test.20coverage.html#262643148">(Nov 24 2021 at 21:38)</a>:</h4>
<p>Maybe even open a tracking issue where we could list areas needing tests and explaining how to add them.</p>



<a name="262643318"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/266220-rustdoc/topic/more%20test%20coverage/near/262643318" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Nelson <a href="https://zulip-archive.rust-lang.org/stream/266220-rustdoc/topic/more.20test.20coverage.html#262643318">(Nov 24 2021 at 21:40)</a>:</h4>
<p>we already have a tracking issue</p>



<a name="262643336"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/266220-rustdoc/topic/more%20test%20coverage/near/262643336" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Nelson <a href="https://zulip-archive.rust-lang.org/stream/266220-rustdoc/topic/more.20test.20coverage.html#262643336">(Nov 24 2021 at 21:40)</a>:</h4>
<p>we need to fill it out with the places with tests</p>



<a name="262643509"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/266220-rustdoc/topic/more%20test%20coverage/near/262643509" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Noah Lev <a href="https://zulip-archive.rust-lang.org/stream/266220-rustdoc/topic/more.20test.20coverage.html#262643509">(Nov 24 2021 at 21:42)</a>:</h4>
<p><span class="user-mention silent" data-user-id="210316">GuillaumeGomez</span> <a href="#narrow/stream/266220-rustdoc/topic/more.20test.20coverage/near/262643148">said</a>:</p>
<blockquote>
<p>Maybe even open a tracking issue where we could list areas needing tests and explaining how to add them.</p>
</blockquote>
<p>It's this one: <a href="https://github.com/rust-lang/rust/issues/91113">#91113</a></p>



<a name="262643947"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/266220-rustdoc/topic/more%20test%20coverage/near/262643947" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> GuillaumeGomez <a href="https://zulip-archive.rust-lang.org/stream/266220-rustdoc/topic/more.20test.20coverage.html#262643947">(Nov 24 2021 at 21:47)</a>:</h4>
<p>And now that I see it I remember it. Grandpa Guillaume will go to bed very soon I guess...</p>



<hr><p>Last updated: Apr 12 2022 at 20:01 UTC</p>
</html>