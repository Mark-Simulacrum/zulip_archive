<html>
<head><meta charset="utf-8"><title>target_feature and doctests · rustdoc · Zulip Chat Archive</title></head>
<h2>Stream: <a href="https://zulip-archive.rust-lang.org/stream/266220-rustdoc/index.html">rustdoc</a></h2>
<h3>Topic: <a href="https://zulip-archive.rust-lang.org/stream/266220-rustdoc/topic/target_feature.20and.20doctests.html">target_feature and doctests</a></h3>

<hr>

<base href="https://rust-lang.zulipchat.com">

<head><link href="https://zulip-archive.rust-lang.org/style.css" rel="stylesheet"></head>

<a name="262960264"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/266220-rustdoc/topic/target_feature%20and%20doctests/near/262960264" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Eric Huss <a href="https://zulip-archive.rust-lang.org/stream/266220-rustdoc/topic/target_feature.20and.20doctests.html#262960264">(Nov 29 2021 at 01:58)</a>:</h4>
<p>Does anyone have any insight why a function marked with <code>#[target_feature(...)]</code> would prevent doctests from running for that function?</p>



<a name="262960769"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/266220-rustdoc/topic/target_feature%20and%20doctests/near/262960769" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Nelson <a href="https://zulip-archive.rust-lang.org/stream/266220-rustdoc/topic/target_feature.20and.20doctests.html#262960769">(Nov 29 2021 at 02:09)</a>:</h4>
<p>I have no idea, sorry. Doctests are very hacky in general.</p>



<a name="262960840"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/266220-rustdoc/topic/target_feature%20and%20doctests/near/262960840" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Eric Huss <a href="https://zulip-archive.rust-lang.org/stream/266220-rustdoc/topic/target_feature.20and.20doctests.html#262960840">(Nov 29 2021 at 02:11)</a>:</h4>
<p>Oh, I see, <code>#[target_feature]</code> is treated as <code>#[doc(cfg(target_feature="..."))]</code></p>



<a name="262960892"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/266220-rustdoc/topic/target_feature%20and%20doctests/near/262960892" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Eric Huss <a href="https://zulip-archive.rust-lang.org/stream/266220-rustdoc/topic/target_feature.20and.20doctests.html#262960892">(Nov 29 2021 at 02:12)</a>:</h4>
<p>That should probably be documented somewhere.</p>



<a name="262960954"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/266220-rustdoc/topic/target_feature%20and%20doctests/near/262960954" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Nelson <a href="https://zulip-archive.rust-lang.org/stream/266220-rustdoc/topic/target_feature.20and.20doctests.html#262960954">(Nov 29 2021 at 02:14)</a>:</h4>
<p>... I was not aware that was the case <span aria-label="sweat smile" class="emoji emoji-1f605" role="img" title="sweat smile">:sweat_smile:</span></p>



<a name="262960960"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/266220-rustdoc/topic/target_feature%20and%20doctests/near/262960960" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Nelson <a href="https://zulip-archive.rust-lang.org/stream/266220-rustdoc/topic/target_feature.20and.20doctests.html#262960960">(Nov 29 2021 at 02:15)</a>:</h4>
<p>And I wouldn't expect it to impact doctests? Doc(cfg) should only affect the html rendering</p>



<a name="262963244"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/266220-rustdoc/topic/target_feature%20and%20doctests/near/262963244" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Eric Huss <a href="https://zulip-archive.rust-lang.org/stream/266220-rustdoc/topic/target_feature.20and.20doctests.html#262963244">(Nov 29 2021 at 03:16)</a>:</h4>
<p>My impression from <a href="https://github.com/rust-lang/rust/issues/43348">#43348</a> is that doc(cfg) affecting doctests was intentional.  </p>
<p>And I think it sorta makes sense.  You don't want to run tests for functions that don't work on the current architecture.  It would be nice if there was some indication it was skipped, but the test harness doesn't really support that. (They could maybe be "ignored", but people have different opinions about what <code>ignore</code> should be used for.)</p>



<hr><p>Last updated: Apr 12 2022 at 20:01 UTC</p>
</html>