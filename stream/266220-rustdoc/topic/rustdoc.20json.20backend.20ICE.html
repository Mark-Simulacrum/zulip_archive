<html>
<head><meta charset="utf-8"><title>rustdoc json backend ICE · rustdoc · Zulip Chat Archive</title></head>
<h2>Stream: <a href="https://zulip-archive.rust-lang.org/stream/266220-rustdoc/index.html">rustdoc</a></h2>
<h3>Topic: <a href="https://zulip-archive.rust-lang.org/stream/266220-rustdoc/topic/rustdoc.20json.20backend.20ICE.html">rustdoc json backend ICE</a></h3>

<hr>

<base href="https://rust-lang.zulipchat.com">

<head><link href="https://zulip-archive.rust-lang.org/style.css" rel="stylesheet"></head>

<a name="257179626"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/266220-rustdoc/topic/rustdoc%20json%20backend%20ICE/near/257179626" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> weiznich <a href="https://zulip-archive.rust-lang.org/stream/266220-rustdoc/topic/rustdoc.20json.20backend.20ICE.html#257179626">(Oct 12 2021 at 10:18)</a>:</h4>
<p><span aria-label="wave" class="emoji emoji-1f44b" role="img" title="wave">:wave:</span> I recently tried to get the "new" rustdoc json backend working to maybe build a tool on top of this that shows which API's have changed between two crate versions. While running <code>cargo doc</code> with the following <code>RUSTDOCFLAGS='-Z unstable-options --output-format=json' </code> set on diesel I encounter the following ICE:</p>
<div class="codehilite"><pre><span></span><code>thread &#39;rustc&#39; panicked at &#39;assertion failed: `(left == right)`
  left: `Item { id: Id(&quot;0:1675&quot;), crate_id: 0, name: Some(&quot;Expression&quot;), span: Some(Span { filename: &quot;diesel/src/expression/mod.rs&quot;, begin: (221, 4), end: (221, 27) }), visibility: Public, docs: None, links: {}, attrs: [], deprecation: None, inner: Typedef(Typedef { type_: Generic(&quot;T&quot;), generics: Generics { params: [], where_predicates: [] } }) }`,
 right: `Item { id: Id(&quot;0:1675&quot;), crate_id: 0, name: Some(&quot;Expression&quot;), span: Some(Span { filename: &quot;diesel/src/expression/mod.rs&quot;, begin: (221, 4), end: (221, 27) }), visibility: Default, docs: None, links: {}, attrs: [], deprecation: None, inner: Typedef(Typedef { type_: Generic(&quot;Self&quot;), generics: Generics { params: [], where_predicates: [] } }) }`&#39;, src/librustdoc/json/mod.rs:195:17
note: run with `RUST_BACKTRACE=1` environment variable to display a backtrace

error: internal compiler error: unexpected panic

error: Unrecognized option: &#39;output-format&#39;

error: could not document `diesel`
</code></pre></div>
<p>This happens for the current nightly (rustdoc 1.57.0-nightly (5b210643e 2021-10-11)).<br>
I've reported this issue <a href="https://github.com/rust-lang/rust/issues/89097">here</a>, but wanted to ask if there is an easy workaround available.</p>



<a name="257180487"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/266220-rustdoc/topic/rustdoc%20json%20backend%20ICE/near/257180487" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Urgau <a href="https://zulip-archive.rust-lang.org/stream/266220-rustdoc/topic/rustdoc.20json.20backend.20ICE.html#257180487">(Oct 12 2021 at 10:26)</a>:</h4>
<p>I would like so much, this ICE is very common but there is no workaround to my knowledge. The problem seems to be the difference between the actual data and the one coming from the "metadata".</p>



<hr><p>Last updated: Apr 12 2022 at 20:01 UTC</p>
</html>