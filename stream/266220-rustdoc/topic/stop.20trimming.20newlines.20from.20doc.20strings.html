<html>
<head><meta charset="utf-8"><title>stop trimming newlines from doc strings · rustdoc · Zulip Chat Archive</title></head>
<h2>Stream: <a href="https://zulip-archive.rust-lang.org/stream/266220-rustdoc/index.html">rustdoc</a></h2>
<h3>Topic: <a href="https://zulip-archive.rust-lang.org/stream/266220-rustdoc/topic/stop.20trimming.20newlines.20from.20doc.20strings.html">stop trimming newlines from doc strings</a></h3>

<hr>

<base href="https://rust-lang.zulipchat.com">

<head><link href="https://zulip-archive.rust-lang.org/style.css" rel="stylesheet"></head>

<a name="266290666"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/266220-rustdoc/topic/stop%20trimming%20newlines%20from%20doc%20strings/near/266290666" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Noah Lev <a href="https://zulip-archive.rust-lang.org/stream/266220-rustdoc/topic/stop.20trimming.20newlines.20from.20doc.20strings.html#266290666">(Dec 28 2021 at 20:41)</a>:</h4>
<p>Newlines are currently trimmed, surprisingly, from <code>doc</code> attributes (<a href="https://github.com/rust-lang/rust/issues/91201">#91201</a>). PR <a href="https://github.com/rust-lang/rust/issues/92357">#92357</a> fixes this, but I realize it's potentially a breaking change. What should we do?</p>



<a name="266290670"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/266220-rustdoc/topic/stop%20trimming%20newlines%20from%20doc%20strings/near/266290670" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Noah Lev <a href="https://zulip-archive.rust-lang.org/stream/266220-rustdoc/topic/stop.20trimming.20newlines.20from.20doc.20strings.html#266290670">(Dec 28 2021 at 20:42)</a>:</h4>
<p>cc <span class="user-mention" data-user-id="210316">@GuillaumeGomez</span></p>



<a name="266290848"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/266220-rustdoc/topic/stop%20trimming%20newlines%20from%20doc%20strings/near/266290848" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> GuillaumeGomez <a href="https://zulip-archive.rust-lang.org/stream/266220-rustdoc/topic/stop.20trimming.20newlines.20from.20doc.20strings.html#266290848">(Dec 28 2021 at 20:44)</a>:</h4>
<p>To be more precise, it is a breaking change for mixed doc comments because each different doc comment is trimmed, which isn't the case anymore. However, the start and end of the merged doc comments are trimmed by <code>pulldown-cmark</code>.</p>



<a name="266290860"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/266220-rustdoc/topic/stop%20trimming%20newlines%20from%20doc%20strings/near/266290860" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> GuillaumeGomez <a href="https://zulip-archive.rust-lang.org/stream/266220-rustdoc/topic/stop.20trimming.20newlines.20from.20doc.20strings.html#266290860">(Dec 28 2021 at 20:44)</a>:</h4>
<p>So, just a fix, not sure if breaking change applies here.</p>



<a name="266290956"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/266220-rustdoc/topic/stop%20trimming%20newlines%20from%20doc%20strings/near/266290956" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Noah Lev <a href="https://zulip-archive.rust-lang.org/stream/266220-rustdoc/topic/stop.20trimming.20newlines.20from.20doc.20strings.html#266290956">(Dec 28 2021 at 20:45)</a>:</h4>
<p>I meant "breaking" in the sense that it'll change rustdoc's output; limited breaking changes are usually ok if they fix bugs. I still want to get some feedback from other people before approving it though :)</p>



<a name="266291056"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/266220-rustdoc/topic/stop%20trimming%20newlines%20from%20doc%20strings/near/266291056" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> GuillaumeGomez <a href="https://zulip-archive.rust-lang.org/stream/266220-rustdoc/topic/stop.20trimming.20newlines.20from.20doc.20strings.html#266291056">(Dec 28 2021 at 20:47)</a>:</h4>
<p>I see. Well, let's see if everyone is fine with it then.</p>



<a name="266360973"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/266220-rustdoc/topic/stop%20trimming%20newlines%20from%20doc%20strings/near/266360973" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> jsha <a href="https://zulip-archive.rust-lang.org/stream/266220-rustdoc/topic/stop.20trimming.20newlines.20from.20doc.20strings.html#266360973">(Dec 29 2021 at 16:58)</a>:</h4>
<p>I'm fine with <a href="https://github.com/rust-lang/rust/issues/92357">#92357</a></p>



<a name="266418385"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/266220-rustdoc/topic/stop%20trimming%20newlines%20from%20doc%20strings/near/266418385" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> apiraino <a href="https://zulip-archive.rust-lang.org/stream/266220-rustdoc/topic/stop.20trimming.20newlines.20from.20doc.20strings.html#266418385">(Dec 30 2021 at 10:28)</a>:</h4>
<p>Does T-compiler need to chime in for <a href="https://github.com/rust-lang/rust/issues/92357">#92357</a> or can I remove the <code>T-compiler</code> label?</p>



<a name="266422085"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/266220-rustdoc/topic/stop%20trimming%20newlines%20from%20doc%20strings/near/266422085" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> GuillaumeGomez <a href="https://zulip-archive.rust-lang.org/stream/266220-rustdoc/topic/stop.20trimming.20newlines.20from.20doc.20strings.html#266422085">(Dec 30 2021 at 11:34)</a>:</h4>
<p>I think it's fine to remove the label but I'm not 100% sure if we should. We're changing compiler source code after all.</p>



<a name="266424647"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/266220-rustdoc/topic/stop%20trimming%20newlines%20from%20doc%20strings/near/266424647" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> apiraino <a href="https://zulip-archive.rust-lang.org/stream/266220-rustdoc/topic/stop.20trimming.20newlines.20from.20doc.20strings.html#266424647">(Dec 30 2021 at 12:22)</a>:</h4>
<p>ok. Since it's labeled <code>s-waiting-on-team</code> &amp;&amp; <code>T-compiler</code> it will end on their table today, so just wanted to be sure to provide some context for them</p>



<a name="266466007"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/266220-rustdoc/topic/stop%20trimming%20newlines%20from%20doc%20strings/near/266466007" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Noah Lev <a href="https://zulip-archive.rust-lang.org/stream/266220-rustdoc/topic/stop.20trimming.20newlines.20from.20doc.20strings.html#266466007">(Dec 30 2021 at 23:14)</a>:</h4>
<p>I wonder if we should move that code to rustdoc ... does it need to be in the compiler?</p>



<a name="266511341"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/266220-rustdoc/topic/stop%20trimming%20newlines%20from%20doc%20strings/near/266511341" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> GuillaumeGomez <a href="https://zulip-archive.rust-lang.org/stream/266220-rustdoc/topic/stop.20trimming.20newlines.20from.20doc.20strings.html#266511341">(Dec 31 2021 at 16:08)</a>:</h4>
<p>It's used by other external tools (I think clippy) iirc</p>



<a name="266636811"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/266220-rustdoc/topic/stop%20trimming%20newlines%20from%20doc%20strings/near/266636811" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Nelson <a href="https://zulip-archive.rust-lang.org/stream/266220-rustdoc/topic/stop.20trimming.20newlines.20from.20doc.20strings.html#266636811">(Jan 02 2022 at 22:43)</a>:</h4>
<p>not clippy, but RLS:</p>
<div class="codehilite"><pre><span></span><code>/home/jnelson/rust-lang/rust/compiler/rustc_save_analysis/src/lib.rs
13:use rustc_ast::util::comments::beautify_doc_string;
828:                result.push_str(beautify_doc_string(val).as_str());
</code></pre></div>



<hr><p>Last updated: Apr 12 2022 at 20:01 UTC</p>
</html>