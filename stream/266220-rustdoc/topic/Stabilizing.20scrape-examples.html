<html>
<head><meta charset="utf-8"><title>Stabilizing scrape-examples · rustdoc · Zulip Chat Archive</title></head>
<h2>Stream: <a href="https://zulip-archive.rust-lang.org/stream/266220-rustdoc/index.html">rustdoc</a></h2>
<h3>Topic: <a href="https://zulip-archive.rust-lang.org/stream/266220-rustdoc/topic/Stabilizing.20scrape-examples.html">Stabilizing scrape-examples</a></h3>

<hr>

<base href="https://rust-lang.zulipchat.com">

<head><link href="https://zulip-archive.rust-lang.org/style.css" rel="stylesheet"></head>

<a name="277757477"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/266220-rustdoc/topic/Stabilizing%20scrape-examples/near/277757477" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Will Crichton <a href="https://zulip-archive.rust-lang.org/stream/266220-rustdoc/topic/Stabilizing.20scrape-examples.html#277757477">(Apr 04 2022 at 16:28)</a>:</h4>
<p>Hi Rustdoc team, I would like to push the scrape-examples feature for stabilization soon. It's a big enough feature that it's easy to languish for months without progress. But I think it is <strong>so close</strong> to being done. Specifically, with the merging of:</p>
<ul>
<li><a href="https://github.com/rust-lang/rust/pull/93217">rust-lang/rust#93217</a></li>
<li><a href="https://github.com/rust-lang/cargo/pull/10343">rust-lang/cargo#10343</a></li>
</ul>
<p>Then I think scrape-examples is ready for prime-time. Right now, <a href="https://github.com/rust-lang/rust/issues/93217">#93217</a> is waiting for confirmation from reviewers (<span class="user-mention" data-user-id="315412">@jsha</span> <span class="user-mention" data-user-id="210316">@GuillaumeGomez</span> <span class="user-mention" data-user-id="307537">@Noah Lev</span>). And <a href="https://github.com/rust-lang/rust/issues/10343">#10343</a> is blocked on <a href="https://github.com/rust-lang/rust/issues/93217">#93217</a> being merged.</p>
<p>Please let me know if y'all have any remaining high-level issues or objections to the current design of the extension, especially those two PRs. If not, let me know if there's anything else I can do to help simplify the review process.</p>



<a name="277757686"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/266220-rustdoc/topic/Stabilizing%20scrape-examples/near/277757686" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> GuillaumeGomez <a href="https://zulip-archive.rust-lang.org/stream/266220-rustdoc/topic/Stabilizing.20scrape-examples.html#277757686">(Apr 04 2022 at 16:30)</a>:</h4>
<p>It's still in my review list, I'll try to get back to it this week.</p>



<a name="277757770"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/266220-rustdoc/topic/Stabilizing%20scrape-examples/near/277757770" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> GuillaumeGomez <a href="https://zulip-archive.rust-lang.org/stream/266220-rustdoc/topic/Stabilizing.20scrape-examples.html#277757770">(Apr 04 2022 at 16:30)</a>:</h4>
<p>As for the cargo PR, it's not up to the rustdoc team I think.</p>



<a name="277800776"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/266220-rustdoc/topic/Stabilizing%20scrape-examples/near/277800776" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Noah Lev <a href="https://zulip-archive.rust-lang.org/stream/266220-rustdoc/topic/Stabilizing.20scrape-examples.html#277800776">(Apr 04 2022 at 22:10)</a>:</h4>
<p>I didn't realize that PR was waiting on review. Please use <code>@rustbot ready</code> in the future so it shows up as ready for review for me.</p>



<a name="277800913"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/266220-rustdoc/topic/Stabilizing%20scrape-examples/near/277800913" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Noah Lev <a href="https://zulip-archive.rust-lang.org/stream/266220-rustdoc/topic/Stabilizing.20scrape-examples.html#277800913">(Apr 04 2022 at 22:11)</a>:</h4>
<p>My only concerns really are</p>
<ol>
<li>the cargo API (e.g., <a href="https://github.com/rust-lang/cargo/issues/10343">cargo#10343</a>) and making sure it's consistent</li>
<li>ensuring the API between rustdoc and cargo is unstable so we could improve it later</li>
</ol>



<a name="277801182"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/266220-rustdoc/topic/Stabilizing%20scrape-examples/near/277801182" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Nelson <a href="https://zulip-archive.rust-lang.org/stream/266220-rustdoc/topic/Stabilizing.20scrape-examples.html#277801182">(Apr 04 2022 at 22:14)</a>:</h4>
<ol start="2">
<li>is not possible. There's no way to stabilize an API only for cargo, it has to be stable for everyone or not at all.</li>
</ol>



<a name="277801251"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/266220-rustdoc/topic/Stabilizing%20scrape-examples/near/277801251" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Nelson <a href="https://zulip-archive.rust-lang.org/stream/266220-rustdoc/topic/Stabilizing.20scrape-examples.html#277801251">(Apr 04 2022 at 22:15)</a>:</h4>
<p>(theoretically cargo could set RUSTC_BOOTSTRAP but that sets a bad precedent IMO)</p>



<a name="277801280"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/266220-rustdoc/topic/Stabilizing%20scrape-examples/near/277801280" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Noah Lev <a href="https://zulip-archive.rust-lang.org/stream/266220-rustdoc/topic/Stabilizing.20scrape-examples.html#277801280">(Apr 04 2022 at 22:15)</a>:</h4>
<p>Hmm... I thought that <em>was</em> possible</p>



<a name="277801345"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/266220-rustdoc/topic/Stabilizing%20scrape-examples/near/277801345" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Noah Lev <a href="https://zulip-archive.rust-lang.org/stream/266220-rustdoc/topic/Stabilizing.20scrape-examples.html#277801345">(Apr 04 2022 at 22:16)</a>:</h4>
<p>I guess we do want non-cargo users to theoretically be able to use this feature as well</p>



<a name="277801366"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/266220-rustdoc/topic/Stabilizing%20scrape-examples/near/277801366" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Noah Lev <a href="https://zulip-archive.rust-lang.org/stream/266220-rustdoc/topic/Stabilizing.20scrape-examples.html#277801366">(Apr 04 2022 at 22:16)</a>:</h4>
<p>The interface is just quite complicated, at least the version I knew of last, with multiple invocations and depositing JSON files in the target folder</p>



<a name="277803295"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/266220-rustdoc/topic/Stabilizing%20scrape-examples/near/277803295" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Nelson <a href="https://zulip-archive.rust-lang.org/stream/266220-rustdoc/topic/Stabilizing.20scrape-examples.html#277803295">(Apr 04 2022 at 22:37)</a>:</h4>
<p>FWIW, if we somehow manage to do this in 1 pass in the future, it seems reasonable to deprecate the old flags, the way <code>--passes</code> is now deprecated and does nothing. They only need to be stable in the sense that rustdoc doesn't give a hard error when it seems them.</p>



<a name="277819872"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/266220-rustdoc/topic/Stabilizing%20scrape-examples/near/277819872" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Will Crichton <a href="https://zulip-archive.rust-lang.org/stream/266220-rustdoc/topic/Stabilizing.20scrape-examples.html#277819872">(Apr 05 2022 at 02:20)</a>:</h4>
<blockquote>
<p>It's still in my review list, I'll try to get back to it this week.</p>
</blockquote>
<p>Fabulous thank you!</p>
<blockquote>
<p>I didn't realize that PR was waiting on review. Please use <code>@rustbot ready</code> in the future so it shows up as ready for review for me.</p>
</blockquote>
<p>Ah did not know I could do this, will do so in the future.</p>
<blockquote>
<p>The interface is just quite complicated, at least the version I knew of last, with multiple invocations and depositing JSON files in the target folder</p>
</blockquote>
<p>Yes that is still the case. Essentially the new Cargo-level concept is a <code>CompileMode::Docscrape</code> unit whose output is serialized metadata about call locations in a crate, which later gets read in by <code>Doc</code> units.</p>



<hr><p>Last updated: Apr 12 2022 at 20:01 UTC</p>
</html>