<html>
<head><meta charset="utf-8"><title>moving pass docs · rustdoc · Zulip Chat Archive</title></head>
<h2>Stream: <a href="https://zulip-archive.rust-lang.org/stream/266220-rustdoc/index.html">rustdoc</a></h2>
<h3>Topic: <a href="https://zulip-archive.rust-lang.org/stream/266220-rustdoc/topic/moving.20pass.20docs.html">moving pass docs</a></h3>

<hr>

<base href="https://rust-lang.zulipchat.com">

<head><link href="https://zulip-archive.rust-lang.org/style.css" rel="stylesheet"></head>

<a name="265058351"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/266220-rustdoc/topic/moving%20pass%20docs/near/265058351" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Noah Lev <a href="https://zulip-archive.rust-lang.org/stream/266220-rustdoc/topic/moving.20pass.20docs.html#265058351">(Dec 15 2021 at 19:01)</a>:</h4>
<p>Currently, rustdoc's passes are <a href="https://rustc-dev-guide.rust-lang.org/rustdoc-internals.html#hot-potato">documented in the rustc-dev-guide</a>. This has two main downsides:</p>
<ul>
<li>When passes are added, removed, or modified, people often forget (or don't know) to update the docs. With the guide's date-check tool, the docs do end up getting updated, but it's more work than if they were updated as they were changed.</li>
<li>Readers can't look at the docs alongside the code.</li>
</ul>
<p>What do you think about moving the pass docs to the pass modules themselves, as doc comments?</p>



<a name="265062545"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/266220-rustdoc/topic/moving%20pass%20docs/near/265062545" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> jsha <a href="https://zulip-archive.rust-lang.org/stream/266220-rustdoc/topic/moving.20pass.20docs.html#265062545">(Dec 15 2021 at 19:32)</a>:</h4>
<p>Do the rustdoc docs get generated to <a href="http://doc.rust-lang.org">doc.rust-lang.org</a> somewhere?</p>



<a name="265062634"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/266220-rustdoc/topic/moving%20pass%20docs/near/265062634" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> jsha <a href="https://zulip-archive.rust-lang.org/stream/266220-rustdoc/topic/moving.20pass.20docs.html#265062634">(Dec 15 2021 at 19:33)</a>:</h4>
<p>ah here we go: <a href="https://doc.rust-lang.org/nightly/nightly-rustc/rustdoc/">https://doc.rust-lang.org/nightly/nightly-rustc/rustdoc/</a>. We should probably bump that link to the top of the rustdoc internals page (currently it's at the bottom)</p>



<a name="265062806"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/266220-rustdoc/topic/moving%20pass%20docs/near/265062806" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> jsha <a href="https://zulip-archive.rust-lang.org/stream/266220-rustdoc/topic/moving.20pass.20docs.html#265062806">(Dec 15 2021 at 19:34)</a>:</h4>
<p>and passes are here: <a href="https://doc.rust-lang.org/nightly/nightly-rustc/rustdoc/passes/index.html">https://doc.rust-lang.org/nightly/nightly-rustc/rustdoc/passes/index.html</a></p>



<a name="265062835"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/266220-rustdoc/topic/moving%20pass%20docs/near/265062835" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Noah Lev <a href="https://zulip-archive.rust-lang.org/stream/266220-rustdoc/topic/moving.20pass.20docs.html#265062835">(Dec 15 2021 at 19:34)</a>:</h4>
<p>Ah, have you never seen the rustdoc API docs before? <span aria-label="cry" class="emoji emoji-1f622" role="img" title="cry">:cry:</span></p>



<a name="265062842"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/266220-rustdoc/topic/moving%20pass%20docs/near/265062842" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Noah Lev <a href="https://zulip-archive.rust-lang.org/stream/266220-rustdoc/topic/moving.20pass.20docs.html#265062842">(Dec 15 2021 at 19:34)</a>:</h4>
<p>They're very useful</p>



<a name="265062915"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/266220-rustdoc/topic/moving%20pass%20docs/near/265062915" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> jsha <a href="https://zulip-archive.rust-lang.org/stream/266220-rustdoc/topic/moving.20pass.20docs.html#265062915">(Dec 15 2021 at 19:35)</a>:</h4>
<p>nope! I didn't notice there was a link to them in the internals guide; I ignored the "see also" docs at the bottom.</p>



<a name="265063049"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/266220-rustdoc/topic/moving%20pass%20docs/near/265063049" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Noah Lev <a href="https://zulip-archive.rust-lang.org/stream/266220-rustdoc/topic/moving.20pass.20docs.html#265063049">(Dec 15 2021 at 19:36)</a>:</h4>
<p>That's not how I found out about them, but I don't remember where I did learn about them <span aria-label="sweat smile" class="emoji emoji-1f605" role="img" title="sweat smile">:sweat_smile:</span></p>



<a name="265063071"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/266220-rustdoc/topic/moving%20pass%20docs/near/265063071" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Noah Lev <a href="https://zulip-archive.rust-lang.org/stream/266220-rustdoc/topic/moving.20pass.20docs.html#265063071">(Dec 15 2021 at 19:36)</a>:</h4>
<p>Do you want to move the link to the top?</p>



<a name="265063083"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/266220-rustdoc/topic/moving%20pass%20docs/near/265063083" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Noah Lev <a href="https://zulip-archive.rust-lang.org/stream/266220-rustdoc/topic/moving.20pass.20docs.html#265063083">(Dec 15 2021 at 19:36)</a>:</h4>
<p>I'm happy to approve a PR for that</p>



<a name="265064195"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/266220-rustdoc/topic/moving%20pass%20docs/near/265064195" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> jsha <a href="https://zulip-archive.rust-lang.org/stream/266220-rustdoc/topic/moving.20pass.20docs.html#265064195">(Dec 15 2021 at 19:43)</a>:</h4>
<p>yeah I'll do that</p>



<a name="265064323"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/266220-rustdoc/topic/moving%20pass%20docs/near/265064323" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> jsha <a href="https://zulip-archive.rust-lang.org/stream/266220-rustdoc/topic/moving.20pass.20docs.html#265064323">(Dec 15 2021 at 19:44)</a>:</h4>
<p>also we should fill out those docs so there's a crate-level introduction, and a summary for each of the modules.</p>



<a name="265064966"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/266220-rustdoc/topic/moving%20pass%20docs/near/265064966" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Noah Lev <a href="https://zulip-archive.rust-lang.org/stream/266220-rustdoc/topic/moving.20pass.20docs.html#265064966">(Dec 15 2021 at 19:48)</a>:</h4>
<p>Happy to review those as well :)</p>



<a name="265066623"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/266220-rustdoc/topic/moving%20pass%20docs/near/265066623" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> jsha <a href="https://zulip-archive.rust-lang.org/stream/266220-rustdoc/topic/moving.20pass.20docs.html#265066623">(Dec 15 2021 at 19:59)</a>:</h4>
<p>One of the pieces of info I'd really like is a definition of "clean" - <a href="https://doc.rust-lang.org/nightly/nightly-rustc/rustdoc/clean/index.html">https://doc.rust-lang.org/nightly/nightly-rustc/rustdoc/clean/index.html</a>. What are the properties we are trying to achieve in the various clean functions?</p>



<a name="265067217"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/266220-rustdoc/topic/moving%20pass%20docs/near/265067217" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Noah Lev <a href="https://zulip-archive.rust-lang.org/stream/266220-rustdoc/topic/moving.20pass.20docs.html#265067217">(Dec 15 2021 at 20:02)</a>:</h4>
<p>Clean is rustdoc's pseudo-AST that is more suited for rustdoc's use case. (Although I still think it should eventually be removed.)</p>



<a name="265067351"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/266220-rustdoc/topic/moving%20pass%20docs/near/265067351" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Noah Lev <a href="https://zulip-archive.rust-lang.org/stream/266220-rustdoc/topic/moving.20pass.20docs.html#265067351">(Dec 15 2021 at 20:03)</a>:</h4>
<p>We can't use HIR because it's only available for the local crate and is missing semantic info, and we can't yet use metadata because e.g. type aliases are gone in <code>ty::Ty</code>.</p>



<a name="265067532"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/266220-rustdoc/topic/moving%20pass%20docs/near/265067532" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Noah Lev <a href="https://zulip-archive.rust-lang.org/stream/266220-rustdoc/topic/moving.20pass.20docs.html#265067532">(Dec 15 2021 at 20:04)</a>:</h4>
<p>See <a href="#narrow/stream/266220-rustdoc/topic/reducing.20duplication">https://rust-lang.zulipchat.com/#narrow/stream/266220-rustdoc/topic/reducing.20duplication</a>.</p>



<a name="265069310"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/266220-rustdoc/topic/moving%20pass%20docs/near/265069310" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Nelson <a href="https://zulip-archive.rust-lang.org/stream/266220-rustdoc/topic/moving.20pass.20docs.html#265069310">(Dec 15 2021 at 20:16)</a>:</h4>
<blockquote>
<p>What are the properties we are trying to achieve in the various clean functions?</p>
</blockquote>
<p>no idea, the original author of rustdoc has long left the project</p>



<a name="265069352"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/266220-rustdoc/topic/moving%20pass%20docs/near/265069352" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Nelson <a href="https://zulip-archive.rust-lang.org/stream/266220-rustdoc/topic/moving.20pass.20docs.html#265069352">(Dec 15 2021 at 20:16)</a>:</h4>
<p><a href="https://github.com/rust-lang/rust/issues/76382">https://github.com/rust-lang/rust/issues/76382</a></p>



<a name="265069431"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/266220-rustdoc/topic/moving%20pass%20docs/near/265069431" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Nelson <a href="https://zulip-archive.rust-lang.org/stream/266220-rustdoc/topic/moving.20pass.20docs.html#265069431">(Dec 15 2021 at 20:17)</a>:</h4>
<p>there's a bunch of stuff that depends on clean behaving exactly as it does now, but there's no rhyme or reason to the changes, people just play around with things until the tests pass</p>



<a name="265069814"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/266220-rustdoc/topic/moving%20pass%20docs/near/265069814" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Nelson <a href="https://zulip-archive.rust-lang.org/stream/266220-rustdoc/topic/moving.20pass.20docs.html#265069814">(Dec 15 2021 at 20:20)</a>:</h4>
<p>see also our <em>second</em> psuedo ast: <a href="https://doc.rust-lang.org/nightly/nightly-rustc/rustdoc/visit_ast/struct.Module.html">https://doc.rust-lang.org/nightly/nightly-rustc/rustdoc/visit_ast/struct.Module.html</a></p>



<a name="265070089"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/266220-rustdoc/topic/moving%20pass%20docs/near/265070089" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Noah Lev <a href="https://zulip-archive.rust-lang.org/stream/266220-rustdoc/topic/moving.20pass.20docs.html#265070089">(Dec 15 2021 at 20:22)</a>:</h4>
<p><span class="user-mention silent" data-user-id="232545">Joshua Nelson</span> <a href="#narrow/stream/266220-rustdoc/topic/moving.20pass.20docs/near/265069431">said</a>:</p>
<blockquote>
<p>there's a bunch of stuff that depends on clean behaving exactly as it does now, but there's no rhyme or reason to the changes, people just play around with things until the tests pass</p>
</blockquote>
<p>Yeah, my workflow and goal is to fiddle around with stuff and then delete it <span aria-label="laughing" class="emoji emoji-1f606" role="img" title="laughing">:laughing:</span></p>



<a name="265076626"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/266220-rustdoc/topic/moving%20pass%20docs/near/265076626" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> GuillaumeGomez <a href="https://zulip-archive.rust-lang.org/stream/266220-rustdoc/topic/moving.20pass.20docs.html#265076626">(Dec 15 2021 at 21:21)</a>:</h4>
<p>The original idea behind clean was to stop having rustdoc breaking change daily :)</p>



<a name="265076699"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/266220-rustdoc/topic/moving%20pass%20docs/near/265076699" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> GuillaumeGomez <a href="https://zulip-archive.rust-lang.org/stream/266220-rustdoc/topic/moving.20pass.20docs.html#265076699">(Dec 15 2021 at 21:22)</a>:</h4>
<p>By putting the conversion in one place, when something changed in the compiler API, it was just one place to update so the compiler dev did</p>



<a name="265076796"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/266220-rustdoc/topic/moving%20pass%20docs/near/265076796" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> GuillaumeGomez <a href="https://zulip-archive.rust-lang.org/stream/266220-rustdoc/topic/moving.20pass.20docs.html#265076796">(Dec 15 2021 at 21:22)</a>:</h4>
<p>since then, things got settled so we can use tyctxt and other compiler types directly</p>



<a name="265366793"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/266220-rustdoc/topic/moving%20pass%20docs/near/265366793" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Noah Lev <a href="https://zulip-archive.rust-lang.org/stream/266220-rustdoc/topic/moving.20pass.20docs.html#265366793">(Dec 17 2021 at 22:04)</a>:</h4>
<p>Anyway, so are we agreed that it's a good idea to move the pass docs?</p>



<hr><p>Last updated: Apr 12 2022 at 20:01 UTC</p>
</html>