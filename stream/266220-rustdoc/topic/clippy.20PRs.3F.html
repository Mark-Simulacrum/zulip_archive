<html>
<head><meta charset="utf-8"><title>clippy PRs? · rustdoc · Zulip Chat Archive</title></head>
<h2>Stream: <a href="https://zulip-archive.rust-lang.org/stream/266220-rustdoc/index.html">rustdoc</a></h2>
<h3>Topic: <a href="https://zulip-archive.rust-lang.org/stream/266220-rustdoc/topic/clippy.20PRs.3F.html">clippy PRs?</a></h3>

<hr>

<base href="https://rust-lang.zulipchat.com">

<head><link href="https://zulip-archive.rust-lang.org/style.css" rel="stylesheet"></head>

<a name="267934178"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/266220-rustdoc/topic/clippy%20PRs%3F/near/267934178" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pierwill <a href="https://zulip-archive.rust-lang.org/stream/266220-rustdoc/topic/clippy.20PRs.3F.html#267934178">(Jan 13 2022 at 21:35)</a>:</h4>
<p>Would it be considered helpful to submit a PR addressing some clippy lints in librustdoc?</p>



<a name="267934410"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/266220-rustdoc/topic/clippy%20PRs%3F/near/267934410" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pierwill <a href="https://zulip-archive.rust-lang.org/stream/266220-rustdoc/topic/clippy.20PRs.3F.html#267934410">(Jan 13 2022 at 21:37)</a>:</h4>
<p>Lots of "this <code>else { if .. }</code> block can be collapsed". Isn't there also a way to disable that clippy lint if we want?</p>



<a name="267934744"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/266220-rustdoc/topic/clippy%20PRs%3F/near/267934744" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> GuillaumeGomez <a href="https://zulip-archive.rust-lang.org/stream/266220-rustdoc/topic/clippy.20PRs.3F.html#267934744">(Jan 13 2022 at 21:40)</a>:</h4>
<p>There is, something like <code>#[allow(clippy:lint)]</code></p>



<a name="267934850"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/266220-rustdoc/topic/clippy%20PRs%3F/near/267934850" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pierwill <a href="https://zulip-archive.rust-lang.org/stream/266220-rustdoc/topic/clippy.20PRs.3F.html#267934850">(Jan 13 2022 at 21:41)</a>:</h4>
<p>Would we prefer that over the fixes? Some of these do make the code a little nicer :)</p>



<a name="267935118"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/266220-rustdoc/topic/clippy%20PRs%3F/near/267935118" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pierwill <a href="https://zulip-archive.rust-lang.org/stream/266220-rustdoc/topic/clippy.20PRs.3F.html#267935118">(Jan 13 2022 at 21:44)</a>:</h4>
<p>Well I'll submit a PR and y'all can close if it's not even worth reviewing lol</p>



<a name="267935530"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/266220-rustdoc/topic/clippy%20PRs%3F/near/267935530" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pierwill <a href="https://zulip-archive.rust-lang.org/stream/266220-rustdoc/topic/clippy.20PRs.3F.html#267935530">(Jan 13 2022 at 21:48)</a>:</h4>
<p>fwiw <a href="https://github.com/rust-lang/rust/pull/92868">https://github.com/rust-lang/rust/pull/92868</a></p>



<a name="267935532"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/266220-rustdoc/topic/clippy%20PRs%3F/near/267935532" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> GuillaumeGomez <a href="https://zulip-archive.rust-lang.org/stream/266220-rustdoc/topic/clippy.20PRs.3F.html#267935532">(Jan 13 2022 at 21:48)</a>:</h4>
<p>I did that some time ago. We had a looooot of false positives or things that were making the code more complicated to read. So please be careful ;)</p>



<a name="267935570"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/266220-rustdoc/topic/clippy%20PRs%3F/near/267935570" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pierwill <a href="https://zulip-archive.rust-lang.org/stream/266220-rustdoc/topic/clippy.20PRs.3F.html#267935570">(Jan 13 2022 at 21:48)</a>:</h4>
<p>lol yeah i know</p>



<a name="267935606"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/266220-rustdoc/topic/clippy%20PRs%3F/near/267935606" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pierwill <a href="https://zulip-archive.rust-lang.org/stream/266220-rustdoc/topic/clippy.20PRs.3F.html#267935606">(Jan 13 2022 at 21:49)</a>:</h4>
<p>i tried to only accept the ones that looked nice and didn't produce awful diffs</p>



<a name="267935635"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/266220-rustdoc/topic/clippy%20PRs%3F/near/267935635" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> GuillaumeGomez <a href="https://zulip-archive.rust-lang.org/stream/266220-rustdoc/topic/clippy.20PRs.3F.html#267935635">(Jan 13 2022 at 21:49)</a>:</h4>
<p>Then all good! Can't wait to see the improvements :)</p>



<a name="267935640"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/266220-rustdoc/topic/clippy%20PRs%3F/near/267935640" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> scottmcm <a href="https://zulip-archive.rust-lang.org/stream/266220-rustdoc/topic/clippy.20PRs.3F.html#267935640">(Jan 13 2022 at 21:49)</a>:</h4>
<p><span class="user-mention silent" data-user-id="316352">pierwill</span> <a href="#narrow/stream/266220-rustdoc/topic/clippy.20PRs.3F/near/267934178">said</a>:</p>
<blockquote>
<p>Would it be considered helpful to submit a PR addressing some clippy lints in librustdoc?</p>
</blockquote>
<p>I'm not a rustdoc team member, so take this with appropriate salt, but I often find clippy too picky in many cases.  <code>else { if</code> can definitely be one of those cases, if it was written that way to help emphasize symmetry.</p>
<p>If you look at things and go "yes, that's obviously better", then go for it.  </p>
<p>(But don't put too much in one PR -- make sure it's easy to review.)</p>



<a name="267935793"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/266220-rustdoc/topic/clippy%20PRs%3F/near/267935793" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pierwill <a href="https://zulip-archive.rust-lang.org/stream/266220-rustdoc/topic/clippy.20PRs.3F.html#267935793">(Jan 13 2022 at 21:50)</a>:</h4>
<p>thanks <span class="user-mention" data-user-id="125270">@scottmcm</span> :)</p>



<a name="267937216"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/266220-rustdoc/topic/clippy%20PRs%3F/near/267937216" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Noah Lev <a href="https://zulip-archive.rust-lang.org/stream/266220-rustdoc/topic/clippy.20PRs.3F.html#267937216">(Jan 13 2022 at 22:02)</a>:</h4>
<p>Yeah, that <code>else { if</code> lint is one of the only Clippy lints that I'm really against in most cases ;)</p>



<a name="267938022"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/266220-rustdoc/topic/clippy%20PRs%3F/near/267938022" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> jsha <a href="https://zulip-archive.rust-lang.org/stream/266220-rustdoc/topic/clippy.20PRs.3F.html#267938022">(Jan 13 2022 at 22:10)</a>:</h4>
<p>huh, looking at the PR I really like it? I find deeply nested if blocks really hard to read, and hoisting the lower <code>if</code> really makes clear that each of those blocks is mutually exclusive. Also, when a whole cluster ends with <code>else</code> it makes clear that exactly one of the provided blocks will execute.</p>



<a name="267938459"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/266220-rustdoc/topic/clippy%20PRs%3F/near/267938459" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Noah Lev <a href="https://zulip-archive.rust-lang.org/stream/266220-rustdoc/topic/clippy.20PRs.3F.html#267938459">(Jan 13 2022 at 22:13)</a>:</h4>
<p>I like having the nested <code>if</code> blocks because it acts like a tree of what's being handled:</p>
<ul>
<li><code>macro_rules!</code><ul>
<li>code</li>
</ul>
</li>
<li><code>macro</code><ul>
<li><code>&lt;= 1</code> matchers</li>
<li>otherwise</li>
</ul>
</li>
</ul>
<p>With the <code>if</code> blocks collapsed, it reads like this:</p>
<ul>
<li><code>macro_rules!</code><ul>
<li>code</li>
</ul>
</li>
<li><code>&lt;= 1</code> matchers</li>
<li>otherwise</li>
</ul>
<p>which I find confusing.</p>



<a name="267938559"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/266220-rustdoc/topic/clippy%20PRs%3F/near/267938559" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Noah Lev <a href="https://zulip-archive.rust-lang.org/stream/266220-rustdoc/topic/clippy.20PRs.3F.html#267938559">(Jan 13 2022 at 22:13)</a>:</h4>
<p>Also, the changes will add noise to Git blame, which doesn't feel worth it to me</p>



<a name="267940774"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/266220-rustdoc/topic/clippy%20PRs%3F/near/267940774" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pierwill <a href="https://zulip-archive.rust-lang.org/stream/266220-rustdoc/topic/clippy.20PRs.3F.html#267940774">(Jan 13 2022 at 22:31)</a>:</h4>
<p>thanks for reviewing and sorry for the churn. just trying to help improve things where i can! I cleaned the changes up a lot <span class="user-mention" data-user-id="307537">@Noah Lev</span></p>



<a name="267940791"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/266220-rustdoc/topic/clippy%20PRs%3F/near/267940791" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pierwill <a href="https://zulip-archive.rust-lang.org/stream/266220-rustdoc/topic/clippy.20PRs.3F.html#267940791">(Jan 13 2022 at 22:31)</a>:</h4>
<p><a href="https://github.com/rust-lang/rust/pull/92868/files">https://github.com/rust-lang/rust/pull/92868/files</a></p>



<a name="267955416"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/266220-rustdoc/topic/clippy%20PRs%3F/near/267955416" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Noah Lev <a href="https://zulip-archive.rust-lang.org/stream/266220-rustdoc/topic/clippy.20PRs.3F.html#267955416">(Jan 14 2022 at 01:11)</a>:</h4>
<p>Thanks! Sorry I was a bit curt :)</p>



<a name="268066802"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/266220-rustdoc/topic/clippy%20PRs%3F/near/268066802" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Noah Lev <a href="https://zulip-archive.rust-lang.org/stream/266220-rustdoc/topic/clippy.20PRs.3F.html#268066802">(Jan 14 2022 at 20:19)</a>:</h4>
<p>FYI: the PR also <code>allow</code>s the collapsible lints</p>



<hr><p>Last updated: Apr 12 2022 at 20:01 UTC</p>
</html>