<html>
<head><meta charset="utf-8"><title>doc format for JS · rustdoc · Zulip Chat Archive</title></head>
<h2>Stream: <a href="https://zulip-archive.rust-lang.org/stream/266220-rustdoc/index.html">rustdoc</a></h2>
<h3>Topic: <a href="https://zulip-archive.rust-lang.org/stream/266220-rustdoc/topic/doc.20format.20for.20JS.html">doc format for JS</a></h3>

<hr>

<base href="https://rust-lang.zulipchat.com">

<head><link href="https://zulip-archive.rust-lang.org/style.css" rel="stylesheet"></head>

<a name="265209466"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/266220-rustdoc/topic/doc%20format%20for%20JS/near/265209466" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> jsha <a href="https://zulip-archive.rust-lang.org/stream/266220-rustdoc/topic/doc.20format.20for.20JS.html#265209466">(Dec 16 2021 at 19:45)</a>:</h4>
<p>Right now, some function comments in search.js that use an approximation of JSDoc style. Others use no formal doccomment style.</p>
<p><span class="user-mention" data-user-id="210316">@GuillaumeGomez</span> and I have been discussing a bit on <a href="https://github.com/rust-lang/rust/pull/91977#discussion_r770857193">https://github.com/rust-lang/rust/pull/91977#discussion_r770857193</a>.</p>
<p>There are two directions we can take:</p>
<ul>
<li>fully embrace JSDoc and update our existing comments to follow it</li>
<li>abandon JSDoc and use free-form function comments</li>
</ul>
<p>Some info about JSDoc here: <a href="https://jsdoc.app/about-getting-started.html">https://jsdoc.app/about-getting-started.html</a>. An example JSDoc comment:</p>
<div class="codehilite"><pre><span></span><code>/**
 * Represents a book.
 * @constructor
 * @param {string} title - The title of the book.
 * @param {string} author - The author of the book.
 */
function Book(title, author) {
}
</code></pre></div>
<p>I think we should fully embrace JSDoc comments, even though we probably won't actually generate documentation from them. This will make our comments more consistent and encourage us to annotate type information for parameters and return types. Also, more importantly, we can use tooling to enforce some of the properties documented. At a minimum we can keep the parameter names in sync, and I have a vague recollection that we can do a small amount of static enforcement of types.</p>



<a name="265209874"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/266220-rustdoc/topic/doc%20format%20for%20JS/near/265209874" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> jsha <a href="https://zulip-archive.rust-lang.org/stream/266220-rustdoc/topic/doc.20format.20for.20JS.html#265209874">(Dec 16 2021 at 19:49)</a>:</h4>
<p>Some more details on checking types from JSDoc:</p>
<p>I have successfully in the past used the Closure Compiler to check types, even when I don't actually use the output of the compiler: <a href="https://github.com/google/closure-compiler/wiki/Annotating-JavaScript-for-the-Closure-Compiler">https://github.com/google/closure-compiler/wiki/Annotating-JavaScript-for-the-Closure-Compiler</a></p>
<p>Also this post talks a little about type checking with JSDoc: <a href="https://www.xiaoru.li/post/light-type-checking-with-jsdoc/">https://www.xiaoru.li/post/light-type-checking-with-jsdoc/</a></p>



<a name="265210035"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/266220-rustdoc/topic/doc%20format%20for%20JS/near/265210035" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> GuillaumeGomez <a href="https://zulip-archive.rust-lang.org/stream/266220-rustdoc/topic/doc.20format.20for.20JS.html#265210035">(Dec 16 2021 at 19:50)</a>:</h4>
<p>I don't know how much the infra people will like the idea to add even more JS tools haha</p>



<a name="265210124"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/266220-rustdoc/topic/doc%20format%20for%20JS/near/265210124" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> jsha <a href="https://zulip-archive.rust-lang.org/stream/266220-rustdoc/topic/doc.20format.20for.20JS.html#265210124">(Dec 16 2021 at 19:51)</a>:</h4>
<p>Yeah, it may be a problem adding more tools to CI - but I think it's better to have something at least tool-friendly, even if we can't run the tool in CI.</p>



<a name="265210673"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/266220-rustdoc/topic/doc%20format%20for%20JS/near/265210673" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> GuillaumeGomez <a href="https://zulip-archive.rust-lang.org/stream/266220-rustdoc/topic/doc.20format.20for.20JS.html#265210673">(Dec 16 2021 at 19:55)</a>:</h4>
<p>I find the doc comments hard to read but I'm not the target here so I'll let others decide.</p>



<a name="265211438"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/266220-rustdoc/topic/doc%20format%20for%20JS/near/265211438" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Nelson <a href="https://zulip-archive.rust-lang.org/stream/266220-rustdoc/topic/doc.20format.20for.20JS.html#265211438">(Dec 16 2021 at 20:00)</a>:</h4>
<p>making it consistent seems nice, yeah</p>



<a name="265211475"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/266220-rustdoc/topic/doc%20format%20for%20JS/near/265211475" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Nelson <a href="https://zulip-archive.rust-lang.org/stream/266220-rustdoc/topic/doc.20format.20for.20JS.html#265211475">(Dec 16 2021 at 20:01)</a>:</h4>
<p>I <em>really</em> like the idea of making it machine checkable :)</p>



<a name="265211925"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/266220-rustdoc/topic/doc%20format%20for%20JS/near/265211925" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> jsha <a href="https://zulip-archive.rust-lang.org/stream/266220-rustdoc/topic/doc.20format.20for.20JS.html#265211925">(Dec 16 2021 at 20:04)</a>:</h4>
<p>This is an interesting comment from <a href="https://github.com/google/closure-compiler/wiki/Annotating-JavaScript-for-the-Closure-Compiler#param-type-varname-description">closure compiler docs</a>:</p>
<blockquote>
<p>The Closure Compiler's type language derives from the annotations used by the JSDoc document-generation tool, although over the years it has diverged. This document describes the set of annotations and type expressions that the Closure Compiler understands.</p>
</blockquote>
<p>It's been years but I remember the Closure Compiler being surprisingly good at statically checking these things. So given the choice we should target the Closure Compiler dialect rather than the pure JSDoc dialect. Though I suspect they strongly overlap for the things we care about (mostly @params and @returns).</p>



<a name="265212041"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/266220-rustdoc/topic/doc%20format%20for%20JS/near/265212041" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Nelson <a href="https://zulip-archive.rust-lang.org/stream/266220-rustdoc/topic/doc.20format.20for.20JS.html#265212041">(Dec 16 2021 at 20:05)</a>:</h4>
<p>yeah I think we should stick with the subset they both support if at all possible</p>



<a name="265212060"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/266220-rustdoc/topic/doc%20format%20for%20JS/near/265212060" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Nelson <a href="https://zulip-archive.rust-lang.org/stream/266220-rustdoc/topic/doc.20format.20for.20JS.html#265212060">(Dec 16 2021 at 20:05)</a>:</h4>
<p>(I don't think we have anything complicated enough for it to be a problem)</p>



<a name="265215246"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/266220-rustdoc/topic/doc%20format%20for%20JS/near/265215246" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> jsha <a href="https://zulip-archive.rust-lang.org/stream/266220-rustdoc/topic/doc.20format.20for.20JS.html#265215246">(Dec 16 2021 at 20:31)</a>:</h4>
<p>I'm playing around with this a little locally and one nice thing is it's telling me to annotate which parameters to a function are optional. I'm often confused about which parameters in JS are optional, so that's helpful.</p>



<a name="265215357"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/266220-rustdoc/topic/doc%20format%20for%20JS/near/265215357" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Nelson <a href="https://zulip-archive.rust-lang.org/stream/266220-rustdoc/topic/doc.20format.20for.20JS.html#265215357">(Dec 16 2021 at 20:32)</a>:</h4>
<p>this sounds <em>amazing</em> tbh</p>



<a name="265215369"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/266220-rustdoc/topic/doc%20format%20for%20JS/near/265215369" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Nelson <a href="https://zulip-archive.rust-lang.org/stream/266220-rustdoc/topic/doc.20format.20for.20JS.html#265215369">(Dec 16 2021 at 20:32)</a>:</h4>
<p>like typescript but without the build system haha</p>



<a name="265215564"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/266220-rustdoc/topic/doc%20format%20for%20JS/near/265215564" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> jsha <a href="https://zulip-archive.rust-lang.org/stream/266220-rustdoc/topic/doc.20format.20for.20JS.html#265215564">(Dec 16 2021 at 20:34)</a>:</h4>
<p>I mean basically it is a build system but we would just be throwing away the built results :D</p>



<a name="265258439"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/266220-rustdoc/topic/doc%20format%20for%20JS/near/265258439" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> jsha <a href="https://zulip-archive.rust-lang.org/stream/266220-rustdoc/topic/doc.20format.20for.20JS.html#265258439">(Dec 17 2021 at 06:24)</a>:</h4>
<p>Sent a PR: <a href="https://github.com/rust-lang/rust/pull/92026">https://github.com/rust-lang/rust/pull/92026</a></p>



<hr><p>Last updated: Apr 12 2022 at 20:01 UTC</p>
</html>