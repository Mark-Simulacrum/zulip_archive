<html>
<head><meta charset="utf-8"><title>`HashMap` performance · t-compiler/help · Zulip Chat Archive</title></head>
<h2>Stream: <a href="https://zulip-archive.rust-lang.org/stream/182449-t-compiler/help/index.html">t-compiler/help</a></h2>
<h3>Topic: <a href="https://zulip-archive.rust-lang.org/stream/182449-t-compiler/help/topic/.60HashMap.60.20performance.html">`HashMap` performance</a></h3>

<hr>

<base href="https://rust-lang.zulipchat.com">

<head><link href="https://zulip-archive.rust-lang.org/style.css" rel="stylesheet"></head>

<a name="261203994"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/182449-t-compiler/help/topic/%60HashMap%60%20performance/near/261203994" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> inquisitivecrystal <a href="https://zulip-archive.rust-lang.org/stream/182449-t-compiler/help/topic/.60HashMap.60.20performance.html#261203994">(Nov 12 2021 at 01:52)</a>:</h4>
<p>What performance differences would there be between <code>HashMap&lt;String, HashMap&lt;String, Vec&lt;String&gt;&gt;&gt;</code> and <code>HashMap&lt;(String, Sting), Vec&lt;String&gt;&gt;</code>?</p>



<a name="261204173"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/182449-t-compiler/help/topic/%60HashMap%60%20performance/near/261204173" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> inquisitivecrystal <a href="https://zulip-archive.rust-lang.org/stream/182449-t-compiler/help/topic/.60HashMap.60.20performance.html#261204173">(Nov 12 2021 at 01:56)</a>:</h4>
<p>I'm guessing the later would be better in most cases, because it seems like there has to be a cost to each HashMap creation and lookup.</p>



<a name="261204180"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/182449-t-compiler/help/topic/%60HashMap%60%20performance/near/261204180" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> inquisitivecrystal <a href="https://zulip-archive.rust-lang.org/stream/182449-t-compiler/help/topic/.60HashMap.60.20performance.html#261204180">(Nov 12 2021 at 01:56)</a>:</h4>
<p>The size of each HashMap would be fairly small.</p>



<a name="261205089"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/182449-t-compiler/help/topic/%60HashMap%60%20performance/near/261205089" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Nelson <a href="https://zulip-archive.rust-lang.org/stream/182449-t-compiler/help/topic/.60HashMap.60.20performance.html#261205089">(Nov 12 2021 at 02:12)</a>:</h4>
<p>Yeah, the latter is better - if you use a whole HashMap as a key, you have to hash each and every element in it every time you look up a value</p>



<a name="261205100"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/182449-t-compiler/help/topic/%60HashMap%60%20performance/near/261205100" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Nelson <a href="https://zulip-archive.rust-lang.org/stream/182449-t-compiler/help/topic/.60HashMap.60.20performance.html#261205100">(Nov 12 2021 at 02:12)</a>:</h4>
<p>(does HashMap even implement Hash?)</p>



<a name="261205302"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/182449-t-compiler/help/topic/%60HashMap%60%20performance/near/261205302" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nnethercote <a href="https://zulip-archive.rust-lang.org/stream/182449-t-compiler/help/topic/.60HashMap.60.20performance.html#261205302">(Nov 12 2021 at 02:16)</a>:</h4>
<p>There's no use of a hashmap as a key here, just nested hashmaps. But I agree that the latter is better. Nesting hashmaps is likely to be slower, and probably use more memory too</p>



<a name="261223717"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/182449-t-compiler/help/topic/%60HashMap%60%20performance/near/261223717" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> cuviper <a href="https://zulip-archive.rust-lang.org/stream/182449-t-compiler/help/topic/.60HashMap.60.20performance.html#261223717">(Nov 12 2021 at 08:35)</a>:</h4>
<p>One counterpoint is if you want to iterate a sub-map, the nested version would probably be better than iterating and filtering the flattened map.</p>



<a name="261223860"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/182449-t-compiler/help/topic/%60HashMap%60%20performance/near/261223860" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> cuviper <a href="https://zulip-archive.rust-lang.org/stream/182449-t-compiler/help/topic/.60HashMap.60.20performance.html#261223860">(Nov 12 2021 at 08:37)</a>:</h4>
<p>And no, <code>HashMap</code> doesn't implement <code>Hash</code> -- this was debated, but it's difficult to make that consistent with <code>Eq</code>, independent of order.</p>



<hr><p>Last updated: Apr 12 2022 at 20:01 UTC</p>
</html>