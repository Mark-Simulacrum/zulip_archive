<html>
<head><meta charset="utf-8"><title>Tests only fail during rollup · t-compiler/help · Zulip Chat Archive</title></head>
<h2>Stream: <a href="https://zulip-archive.rust-lang.org/stream/182449-t-compiler/help/index.html">t-compiler/help</a></h2>
<h3>Topic: <a href="https://zulip-archive.rust-lang.org/stream/182449-t-compiler/help/topic/Tests.20only.20fail.20during.20rollup.html">Tests only fail during rollup</a></h3>

<hr>

<base href="https://rust-lang.zulipchat.com">

<head><link href="https://zulip-archive.rust-lang.org/style.css" rel="stylesheet"></head>

<a name="259983107"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/182449-t-compiler/help/topic/Tests%20only%20fail%20during%20rollup/near/259983107" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nilstrieb <a href="https://zulip-archive.rust-lang.org/stream/182449-t-compiler/help/topic/Tests.20only.20fail.20during.20rollup.html#259983107">(Nov 02 2021 at 11:37)</a>:</h4>
<p>This PR has been stuck because the tests only fail during rollup but run fine during PR CI and on my machine: <a href="https://github.com/rust-lang/rust/pull/90179">https://github.com/rust-lang/rust/pull/90179</a> <br>
Does anyone know what the problem could be and how to solve it?</p>



<a name="259984592"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/182449-t-compiler/help/topic/Tests%20only%20fail%20during%20rollup/near/259984592" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Nelson <a href="https://zulip-archive.rust-lang.org/stream/182449-t-compiler/help/topic/Tests.20only.20fail.20during.20rollup.html#259984592">(Nov 02 2021 at 11:52)</a>:</h4>
<p>I don't know what the problem is, but bors runs more tests on merge than it does for PRs. I don't know a good way to reproduce the tests locally :(</p>



<a name="259987738"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/182449-t-compiler/help/topic/Tests%20only%20fail%20during%20rollup/near/259987738" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> The 8472 <a href="https://zulip-archive.rust-lang.org/stream/182449-t-compiler/help/topic/Tests.20only.20fail.20during.20rollup.html#259987738">(Nov 02 2021 at 12:23)</a>:</h4>
<p>since it's failing in <code>x86_64-gnu-nopt</code> you can run that via <code>./src/ci/docker/run.sh x86_64-gnu-nopt</code></p>



<a name="259987870"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/182449-t-compiler/help/topic/Tests%20only%20fail%20during%20rollup/near/259987870" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> The 8472 <a href="https://zulip-archive.rust-lang.org/stream/182449-t-compiler/help/topic/Tests.20only.20fail.20during.20rollup.html#259987870">(Nov 02 2021 at 12:24)</a>:</h4>
<p>that takes a long time though, adjusting the command executed in the <code>Dockerfile</code> can speed things up</p>



<a name="259988056"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/182449-t-compiler/help/topic/Tests%20only%20fail%20during%20rollup/near/259988056" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Nelson <a href="https://zulip-archive.rust-lang.org/stream/182449-t-compiler/help/topic/Tests.20only.20fail.20during.20rollup.html#259988056">(Nov 02 2021 at 12:26)</a>:</h4>
<p><span class="user-mention" data-user-id="330154">@The 8472</span> is there a way to do that for windows test failures?</p>



<a name="259991592"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/182449-t-compiler/help/topic/Tests%20only%20fail%20during%20rollup/near/259991592" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> lqd <a href="https://zulip-archive.rust-lang.org/stream/182449-t-compiler/help/topic/Tests.20only.20fail.20during.20rollup.html#259991592">(Nov 02 2021 at 13:01)</a>:</h4>
<p>as you've noticed in the PR comments, the NLL tests are failing. </p>
<p>if they are working locally and not on CI, it looks likely that you have the <code>.nll.stderr</code> files on your machine and that they're not committed or pushed to the PR: it has no blessed NLL test expectations.</p>



<a name="259994496"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/182449-t-compiler/help/topic/Tests%20only%20fail%20during%20rollup/near/259994496" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> The 8472 <a href="https://zulip-archive.rust-lang.org/stream/182449-t-compiler/help/topic/Tests.20only.20fail.20during.20rollup.html#259994496">(Nov 02 2021 at 13:26)</a>:</h4>
<p><span class="user-mention" data-user-id="232545">@Joshua Nelson</span> on a non-windows machine? no, I don't think so. I saw a gist somewhere to build msvc rust under wine, but I haven't tried that myself.</p>



<a name="260052697"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/182449-t-compiler/help/topic/Tests%20only%20fail%20during%20rollup/near/260052697" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nilstrieb <a href="https://zulip-archive.rust-lang.org/stream/182449-t-compiler/help/topic/Tests.20only.20fail.20during.20rollup.html#260052697">(Nov 02 2021 at 20:22)</a>:</h4>
<p>Oh I think I just found the issue. Two tests have always been failing (ui/linkage-attr/issue-10755.rs and ui/process/process-spawn-nonexistent.rs) (I should probably open an issue) so I've just been ignoring that fact. I just added the ignore-test attribute to them and turns out, there is some more stuff that is ran after they fail, for example thje NLL tests. I've now got the .nll.stderr and I hope this will fix everything! Oh man this is so dumb, but I'm glad that I finally fixed it, thank you for your help!</p>



<hr><p>Last updated: Apr 12 2022 at 20:01 UTC</p>
</html>