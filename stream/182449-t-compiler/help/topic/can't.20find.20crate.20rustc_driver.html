<html>
<head><meta charset="utf-8"><title>can&#x27;t find crate rustc_driver · t-compiler/help · Zulip Chat Archive</title></head>
<h2>Stream: <a href="https://zulip-archive.rust-lang.org/stream/182449-t-compiler/help/index.html">t-compiler/help</a></h2>
<h3>Topic: <a href="https://zulip-archive.rust-lang.org/stream/182449-t-compiler/help/topic/can&#x27;t.20find.20crate.20rustc_driver.html">can&#x27;t find crate rustc_driver</a></h3>

<hr>

<base href="https://rust-lang.zulipchat.com">

<head><link href="https://zulip-archive.rust-lang.org/style.css" rel="stylesheet"></head>

<a name="250211479"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/182449-t-compiler/help/topic/can%27t%20find%20crate%20rustc_driver/near/250211479" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> hannahE2 <a href="https://zulip-archive.rust-lang.org/stream/182449-t-compiler/help/topic/can&#x27;t.20find.20crate.20rustc_driver.html#250211479">(Aug 21 2021 at 11:00)</a>:</h4>
<div class="codehilite"><pre><span></span><code>./x.py build --stage 1
Updating only changed submodules
Submodules updated in 0.03 seconds
    Finished dev [unoptimized + debuginfo] target(s) in 1.34s
Building stage0 std artifacts (x86_64-unknown-linux-gnu -&gt; x86_64-unknown-linux-gnu)
    Finished release [optimized + debuginfo] target(s) in 0.95s
Copying stage0 std from stage0 (x86_64-unknown-linux-gnu -&gt; x86_64-unknown-linux-gnu / x86_64-unknown-linux-gnu)
Building stage0 compiler artifacts (x86_64-unknown-linux-gnu -&gt; x86_64-unknown-linux-gnu)
    Finished release [optimized + debuginfo] target(s) in 2.39s
Copying stage0 rustc from stage0 (x86_64-unknown-linux-gnu -&gt; x86_64-unknown-linux-gnu / x86_64-unknown-linux-gnu)
Assembling stage1 compiler (x86_64-unknown-linux-gnu)
Building stage1 std artifacts (x86_64-unknown-linux-gnu -&gt; x86_64-unknown-linux-gnu)
    Finished release [optimized + debuginfo] target(s) in 0.72s
Copying stage1 std from stage1 (x86_64-unknown-linux-gnu -&gt; x86_64-unknown-linux-gnu / x86_64-unknown-linux-gnu)
Building rustdoc for stage1 (x86_64-unknown-linux-gnu)
   Compiling rustdoc
error[E0463]: can&#39;t find crate for `rustc_llvm` which `rustc_driver` depends on
  --&gt; src/librustdoc/lib.rs:36:1
   |
36 | extern crate rustc_driver;
   | ^^^^^^^^^^^^^^^^^^^^^^^^^^ can&#39;t find crate
</code></pre></div>



<a name="250211536"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/182449-t-compiler/help/topic/can%27t%20find%20crate%20rustc_driver/near/250211536" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> hannahE2 <a href="https://zulip-archive.rust-lang.org/stream/182449-t-compiler/help/topic/can&#x27;t.20find.20crate.20rustc_driver.html#250211536">(Aug 21 2021 at 11:01)</a>:</h4>
<p>any ideas what causes this? I've rebased a fork on top of master, cleaned up everything, and I get this after a fresh build</p>



<a name="250214666"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/182449-t-compiler/help/topic/can%27t%20find%20crate%20rustc_driver/near/250214666" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Nelson <a href="https://zulip-archive.rust-lang.org/stream/182449-t-compiler/help/topic/can&#x27;t.20find.20crate.20rustc_driver.html#250214666">(Aug 21 2021 at 12:20)</a>:</h4>
<p>Hmm, do you have download-ci-llvm or download-rustc set? (If you're not sure, what <code>profile</code> is at the top of config.toml?)</p>



<a name="250214677"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/182449-t-compiler/help/topic/can%27t%20find%20crate%20rustc_driver/near/250214677" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Nelson <a href="https://zulip-archive.rust-lang.org/stream/182449-t-compiler/help/topic/can&#x27;t.20find.20crate.20rustc_driver.html#250214677">(Aug 21 2021 at 12:20)</a>:</h4>
<p>You could try <code>touch compiler/rustc_driver/src/lib.rs</code> and see if that helps</p>



<a name="250235174"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/182449-t-compiler/help/topic/can%27t%20find%20crate%20rustc_driver/near/250235174" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> hannahE2 <a href="https://zulip-archive.rust-lang.org/stream/182449-t-compiler/help/topic/can&#x27;t.20find.20crate.20rustc_driver.html#250235174">(Aug 21 2021 at 20:18)</a>:</h4>
<p><code>profile = "codegen"</code></p>



<a name="250235185"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/182449-t-compiler/help/topic/can%27t%20find%20crate%20rustc_driver/near/250235185" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Nelson <a href="https://zulip-archive.rust-lang.org/stream/182449-t-compiler/help/topic/can&#x27;t.20find.20crate.20rustc_driver.html#250235185">(Aug 21 2021 at 20:19)</a>:</h4>
<p>ok, just download-ci-llvm should be set then</p>



<a name="250235188"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/182449-t-compiler/help/topic/can%27t%20find%20crate%20rustc_driver/near/250235188" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Nelson <a href="https://zulip-archive.rust-lang.org/stream/182449-t-compiler/help/topic/can&#x27;t.20find.20crate.20rustc_driver.html#250235188">(Aug 21 2021 at 20:19)</a>:</h4>
<p>did you try <code>touch</code>, did it help?</p>



<a name="250235256"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/182449-t-compiler/help/topic/can%27t%20find%20crate%20rustc_driver/near/250235256" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> hannahE2 <a href="https://zulip-archive.rust-lang.org/stream/182449-t-compiler/help/topic/can&#x27;t.20find.20crate.20rustc_driver.html#250235256">(Aug 21 2021 at 20:21)</a>:</h4>
<p>i can try setting it<br>
i have modified the backends list from llvm, enabled assertions, etc. (i want to build it as part of the build)</p>



<a name="250235271"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/182449-t-compiler/help/topic/can%27t%20find%20crate%20rustc_driver/near/250235271" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> hannahE2 <a href="https://zulip-archive.rust-lang.org/stream/182449-t-compiler/help/topic/can&#x27;t.20find.20crate.20rustc_driver.html#250235271">(Aug 21 2021 at 20:21)</a>:</h4>
<p>so <code>download-ci-llvm</code> was <code>false</code></p>



<a name="250235313"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/182449-t-compiler/help/topic/can%27t%20find%20crate%20rustc_driver/near/250235313" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Nelson <a href="https://zulip-archive.rust-lang.org/stream/182449-t-compiler/help/topic/can&#x27;t.20find.20crate.20rustc_driver.html#250235313">(Aug 21 2021 at 20:22)</a>:</h4>
<p>if llvm is being built from source I'm not sure what could be going wrong</p>



<a name="250235317"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/182449-t-compiler/help/topic/can%27t%20find%20crate%20rustc_driver/near/250235317" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> hannahE2 <a href="https://zulip-archive.rust-lang.org/stream/182449-t-compiler/help/topic/can&#x27;t.20find.20crate.20rustc_driver.html#250235317">(Aug 21 2021 at 20:22)</a>:</h4>
<p>setting it to true errors with:</p>
<div class="codehilite"><pre><span></span><code>thread &#39;main&#39; panicked at &#39;setting llvm.release_debuginfo is incompatible with download-ci-llvm.&#39;, src/bootstrap/config.rs:791:17
</code></pre></div>



<a name="250235322"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/182449-t-compiler/help/topic/can%27t%20find%20crate%20rustc_driver/near/250235322" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Nelson <a href="https://zulip-archive.rust-lang.org/stream/182449-t-compiler/help/topic/can&#x27;t.20find.20crate.20rustc_driver.html#250235322">(Aug 21 2021 at 20:22)</a>:</h4>
<p>yup that's what I'd expect</p>



<a name="250235440"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/182449-t-compiler/help/topic/can%27t%20find%20crate%20rustc_driver/near/250235440" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> hannahE2 <a href="https://zulip-archive.rust-lang.org/stream/182449-t-compiler/help/topic/can&#x27;t.20find.20crate.20rustc_driver.html#250235440">(Aug 21 2021 at 20:25)</a>:</h4>
<div class="codehilite"><pre><span></span><code>changelog-seen = 2
profile = &quot;codegen&quot;
[llvm]
release-debuginfo = true
assertions = true
ninja = false
targets = &quot;X86&quot;
[build]
[install]
[rust]
debug = true
[target.x86_64-unknown-linux-gnu]
[dist]
</code></pre></div>



<a name="250235490"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/182449-t-compiler/help/topic/can%27t%20find%20crate%20rustc_driver/near/250235490" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Nelson <a href="https://zulip-archive.rust-lang.org/stream/182449-t-compiler/help/topic/can&#x27;t.20find.20crate.20rustc_driver.html#250235490">(Aug 21 2021 at 20:26)</a>:</h4>
<p>hmm, are you sure <code>X86</code> include 64-bit platforms?</p>



<a name="250235497"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/182449-t-compiler/help/topic/can%27t%20find%20crate%20rustc_driver/near/250235497" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Nelson <a href="https://zulip-archive.rust-lang.org/stream/182449-t-compiler/help/topic/can&#x27;t.20find.20crate.20rustc_driver.html#250235497">(Aug 21 2021 at 20:27)</a>:</h4>
<p>I wouldn't be surprised if x.py is assuming you only compile rustdoc for the host somewhere</p>



<a name="250235621"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/182449-t-compiler/help/topic/can%27t%20find%20crate%20rustc_driver/near/250235621" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> hannahE2 <a href="https://zulip-archive.rust-lang.org/stream/182449-t-compiler/help/topic/can&#x27;t.20find.20crate.20rustc_driver.html#250235621">(Aug 21 2021 at 20:30)</a>:</h4>
<p>the default only says X86</p>



<a name="250235625"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/182449-t-compiler/help/topic/can%27t%20find%20crate%20rustc_driver/near/250235625" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Nelson <a href="https://zulip-archive.rust-lang.org/stream/182449-t-compiler/help/topic/can&#x27;t.20find.20crate.20rustc_driver.html#250235625">(Aug 21 2021 at 20:30)</a>:</h4>
<p>maybe remove <code>targets</code> then if you don't intend it to be different?</p>



<a name="250235626"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/182449-t-compiler/help/topic/can%27t%20find%20crate%20rustc_driver/near/250235626" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> hannahE2 <a href="https://zulip-archive.rust-lang.org/stream/182449-t-compiler/help/topic/can&#x27;t.20find.20crate.20rustc_driver.html#250235626">(Aug 21 2021 at 20:30)</a>:</h4>
<p>in config.toml.example</p>



<a name="250235631"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/182449-t-compiler/help/topic/can%27t%20find%20crate%20rustc_driver/near/250235631" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> hannahE2 <a href="https://zulip-archive.rust-lang.org/stream/182449-t-compiler/help/topic/can&#x27;t.20find.20crate.20rustc_driver.html#250235631">(Aug 21 2021 at 20:30)</a>:</h4>
<p>there are more targets compiled by default<br>
i just need the x86_64 one</p>



<a name="250235636"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/182449-t-compiler/help/topic/can%27t%20find%20crate%20rustc_driver/near/250235636" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> hannahE2 <a href="https://zulip-archive.rust-lang.org/stream/182449-t-compiler/help/topic/can&#x27;t.20find.20crate.20rustc_driver.html#250235636">(Aug 21 2021 at 20:31)</a>:</h4>
<p>otherwise building llvm takes too long</p>



<a name="250235650"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/182449-t-compiler/help/topic/can%27t%20find%20crate%20rustc_driver/near/250235650" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Nelson <a href="https://zulip-archive.rust-lang.org/stream/182449-t-compiler/help/topic/can&#x27;t.20find.20crate.20rustc_driver.html#250235650">(Aug 21 2021 at 20:31)</a>:</h4>
<p>oh I see what you mean, ok</p>



<a name="250235658"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/182449-t-compiler/help/topic/can%27t%20find%20crate%20rustc_driver/near/250235658" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Nelson <a href="https://zulip-archive.rust-lang.org/stream/182449-t-compiler/help/topic/can&#x27;t.20find.20crate.20rustc_driver.html#250235658">(Aug 21 2021 at 20:31)</a>:</h4>
<p>yeah, I'm not sure what's going wrong</p>



<a name="250235696"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/182449-t-compiler/help/topic/can%27t%20find%20crate%20rustc_driver/near/250235696" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Nelson <a href="https://zulip-archive.rust-lang.org/stream/182449-t-compiler/help/topic/can&#x27;t.20find.20crate.20rustc_driver.html#250235696">(Aug 21 2021 at 20:32)</a>:</h4>
<p>you could try wiping the build cache maybe :/</p>



<a name="250235698"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/182449-t-compiler/help/topic/can%27t%20find%20crate%20rustc_driver/near/250235698" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Nelson <a href="https://zulip-archive.rust-lang.org/stream/182449-t-compiler/help/topic/can&#x27;t.20find.20crate.20rustc_driver.html#250235698">(Aug 21 2021 at 20:32)</a>:</h4>
<p><span class="user-mention silent" data-user-id="232545">Joshua Nelson</span> <a href="#narrow/stream/182449-t-compiler.2Fhelp/topic/can't.20find.20crate.20rustc_driver/near/250235188">said</a>:</p>
<blockquote>
<p>did you try <code>touch</code>, did it help?</p>
</blockquote>
<p>^ did you ever try this?</p>



<a name="250235702"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/182449-t-compiler/help/topic/can%27t%20find%20crate%20rustc_driver/near/250235702" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> hannahE2 <a href="https://zulip-archive.rust-lang.org/stream/182449-t-compiler/help/topic/can&#x27;t.20find.20crate.20rustc_driver.html#250235702">(Aug 21 2021 at 20:32)</a>:</h4>
<p>i reproduced with a clean from master</p>



<a name="250235703"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/182449-t-compiler/help/topic/can%27t%20find%20crate%20rustc_driver/near/250235703" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> hannahE2 <a href="https://zulip-archive.rust-lang.org/stream/182449-t-compiler/help/topic/can&#x27;t.20find.20crate.20rustc_driver.html#250235703">(Aug 21 2021 at 20:32)</a>:</h4>
<p>let me try that</p>



<a name="250235708"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/182449-t-compiler/help/topic/can%27t%20find%20crate%20rustc_driver/near/250235708" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Nelson <a href="https://zulip-archive.rust-lang.org/stream/182449-t-compiler/help/topic/can&#x27;t.20find.20crate.20rustc_driver.html#250235708">(Aug 21 2021 at 20:32)</a>:</h4>
<p><span class="user-mention silent" data-user-id="409057">hannahE2</span> <a href="#narrow/stream/182449-t-compiler.2Fhelp/topic/can't.20find.20crate.20rustc_driver/near/250235702">said</a>:</p>
<blockquote>
<p>i reproduced with a clean from master</p>
</blockquote>
<p>ah ok, then I'm not sure</p>



<a name="250235734"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/182449-t-compiler/help/topic/can%27t%20find%20crate%20rustc_driver/near/250235734" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> hannahE2 <a href="https://zulip-archive.rust-lang.org/stream/182449-t-compiler/help/topic/can&#x27;t.20find.20crate.20rustc_driver.html#250235734">(Aug 21 2021 at 20:33)</a>:</h4>
<p>doing the <code>touch</code> re-compiles <code>rustc_driver</code>, so it is at least compiled</p>



<a name="250236099"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/182449-t-compiler/help/topic/can%27t%20find%20crate%20rustc_driver/near/250236099" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> hannahE2 <a href="https://zulip-archive.rust-lang.org/stream/182449-t-compiler/help/topic/can&#x27;t.20find.20crate.20rustc_driver.html#250236099">(Aug 21 2021 at 20:43)</a>:</h4>
<div class="codehilite"><pre><span></span><code>rust/build/x86_64-unknown-linux-gnu/stage0/bin/cargo&quot; &quot;build&quot; &quot;--target&quot; &quot;x86_64-unknown-linux-gnu&quot; &quot;-Zbinary-dep-depinfo&quot; &quot;-j&quot; &quot;256&quot; &quot;--release&quot; &quot;--manifest-path&quot; &quot;rust/src/tools/rustdoc/Cargo.toml&quot;
</code></pre></div>
<p>is the command that fails</p>



<hr><p>Last updated: Apr 12 2022 at 20:01 UTC</p>
</html>