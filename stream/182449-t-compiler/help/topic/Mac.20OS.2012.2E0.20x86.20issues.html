<html>
<head><meta charset="utf-8"><title>Mac OS 12.0 x86 issues · t-compiler/help · Zulip Chat Archive</title></head>
<h2>Stream: <a href="https://zulip-archive.rust-lang.org/stream/182449-t-compiler/help/index.html">t-compiler/help</a></h2>
<h3>Topic: <a href="https://zulip-archive.rust-lang.org/stream/182449-t-compiler/help/topic/Mac.20OS.2012.2E0.20x86.20issues.html">Mac OS 12.0 x86 issues</a></h3>

<hr>

<base href="https://rust-lang.zulipchat.com">

<head><link href="https://zulip-archive.rust-lang.org/style.css" rel="stylesheet"></head>

<a name="277779659"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/182449-t-compiler/help/topic/Mac%20OS%2012.0%20x86%20issues/near/277779659" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Michael Mileusnich <a href="https://zulip-archive.rust-lang.org/stream/182449-t-compiler/help/topic/Mac.20OS.2012.2E0.20x86.20issues.html#277779659">(Apr 04 2022 at 19:08)</a>:</h4>
<p>There seems to be serious memory allocation issues with all rust tools on mac os 12.0 per <a href="https://github.com/rust-lang/rust/issues/92173">https://github.com/rust-lang/rust/issues/92173</a>.</p>



<a name="277901470"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/182449-t-compiler/help/topic/Mac%20OS%2012.0%20x86%20issues/near/277901470" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Michael Mileusnich <a href="https://zulip-archive.rust-lang.org/stream/182449-t-compiler/help/topic/Mac.20OS.2012.2E0.20x86.20issues.html#277901470">(Apr 05 2022 at 15:58)</a>:</h4>
<p>bump?</p>



<a name="277904620"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/182449-t-compiler/help/topic/Mac%20OS%2012.0%20x86%20issues/near/277904620" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Nelson <a href="https://zulip-archive.rust-lang.org/stream/182449-t-compiler/help/topic/Mac.20OS.2012.2E0.20x86.20issues.html#277904620">(Apr 05 2022 at 16:18)</a>:</h4>
<p>what are you asking? the problem is already tracked in the issue you linked.</p>



<a name="277907037"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/182449-t-compiler/help/topic/Mac%20OS%2012.0%20x86%20issues/near/277907037" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Michael Mileusnich <a href="https://zulip-archive.rust-lang.org/stream/182449-t-compiler/help/topic/Mac.20OS.2012.2E0.20x86.20issues.html#277907037">(Apr 05 2022 at 16:34)</a>:</h4>
<p>Apologies for not being clear, just wondering it the team is looking at it or if I can assist.  There just needs to be a rebuild of the darwin binaries on x86-64 I believe.  But the tools are really broken currently and it is very painful to use on Mac.</p>



<a name="277908032"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/182449-t-compiler/help/topic/Mac%20OS%2012.0%20x86%20issues/near/277908032" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Nelson <a href="https://zulip-archive.rust-lang.org/stream/182449-t-compiler/help/topic/Mac.20OS.2012.2E0.20x86.20issues.html#277908032">(Apr 05 2022 at 16:41)</a>:</h4>
<p>Don't know why a rebuild would help. But I think someone mentioned it's fixed on beta, so it will hopefully work after the 1.60 release that's happening Thursday</p>



<a name="277908238"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/182449-t-compiler/help/topic/Mac%20OS%2012.0%20x86%20issues/near/277908238" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Michael Mileusnich <a href="https://zulip-archive.rust-lang.org/stream/182449-t-compiler/help/topic/Mac.20OS.2012.2E0.20x86.20issues.html#277908238">(Apr 05 2022 at 16:42)</a>:</h4>
<p>oh sound good!  I didn't know there was any code fix?  All I did was updated xcode and rebuilt all rust tools locally.</p>



<a name="277908357"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/182449-t-compiler/help/topic/Mac%20OS%2012.0%20x86%20issues/near/277908357" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Nelson <a href="https://zulip-archive.rust-lang.org/stream/182449-t-compiler/help/topic/Mac.20OS.2012.2E0.20x86.20issues.html#277908357">(Apr 05 2022 at 16:43)</a>:</h4>
<p>Yeah I think it's unclear to everyone why it's broken</p>



<a name="277908813"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/182449-t-compiler/help/topic/Mac%20OS%2012.0%20x86%20issues/near/277908813" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Michael Mileusnich <a href="https://zulip-archive.rust-lang.org/stream/182449-t-compiler/help/topic/Mac.20OS.2012.2E0.20x86.20issues.html#277908813">(Apr 05 2022 at 16:46)</a>:</h4>
<p>thanks for the response have a good day</p>



<a name="277922258"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/182449-t-compiler/help/topic/Mac%20OS%2012.0%20x86%20issues/near/277922258" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Eric Huss <a href="https://zulip-archive.rust-lang.org/stream/182449-t-compiler/help/topic/Mac.20OS.2012.2E0.20x86.20issues.html#277922258">(Apr 05 2022 at 18:21)</a>:</h4>
<p><span class="user-mention" data-user-id="232545">@Joshua Nelson</span> Why do you say it is fixed in beta?  I'm not aware of any fixes implemented.</p>
<p>A possible fix is for the tools to use jemalloc.  It would be a bit messy, as it requires copying/pasting a bunch of code.  Perhaps that can be shared somehow, but it's not particularly trivial.</p>
<p>It sounds like someone had success using XCode 13.3.  Unfortunately that doesn't appear to be available on CI, yet.  That also might not be a "full" fix, since we don't have any information on the underlying error.  The error seems to be very sensitive to the code layout, so it could just be that the newer xcode causes things to shift around a little.</p>



<a name="277923248"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/182449-t-compiler/help/topic/Mac%20OS%2012.0%20x86%20issues/near/277923248" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Nelson <a href="https://zulip-archive.rust-lang.org/stream/182449-t-compiler/help/topic/Mac.20OS.2012.2E0.20x86.20issues.html#277923248">(Apr 05 2022 at 18:27)</a>:</h4>
<p>someone mentioned it was fixed on nightly: <a href="https://github.com/rust-lang/rust-clippy/issues/8470#issuecomment-1050341164">https://github.com/rust-lang/rust-clippy/issues/8470#issuecomment-1050341164</a><br>
not sure whether anyone tested on beta</p>



<a name="277928040"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/182449-t-compiler/help/topic/Mac%20OS%2012.0%20x86%20issues/near/277928040" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Eric Huss <a href="https://zulip-archive.rust-lang.org/stream/182449-t-compiler/help/topic/Mac.20OS.2012.2E0.20x86.20issues.html#277928040">(Apr 05 2022 at 18:58)</a>:</h4>
<p>Ah, good to see it seems to be resolved on newer versions.  It's hard to say if it is definitively fixed if we don't know what is causing it.  In my experiments, slight adjustments of unrelated code would make it go away which indicates it is susceptible to small changes in code layout.</p>



<hr><p>Last updated: Apr 12 2022 at 20:01 UTC</p>
</html>