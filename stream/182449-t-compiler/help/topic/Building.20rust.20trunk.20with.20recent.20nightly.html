<html>
<head><meta charset="utf-8"><title>Building rust trunk with recent nightly · t-compiler/help · Zulip Chat Archive</title></head>
<h2>Stream: <a href="https://zulip-archive.rust-lang.org/stream/182449-t-compiler/help/index.html">t-compiler/help</a></h2>
<h3>Topic: <a href="https://zulip-archive.rust-lang.org/stream/182449-t-compiler/help/topic/Building.20rust.20trunk.20with.20recent.20nightly.html">Building rust trunk with recent nightly</a></h3>

<hr>

<base href="https://rust-lang.zulipchat.com">

<head><link href="https://zulip-archive.rust-lang.org/style.css" rel="stylesheet"></head>

<a name="271494584"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/182449-t-compiler/help/topic/Building%20rust%20trunk%20with%20recent%20nightly/near/271494584" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Collin Baker <a href="https://zulip-archive.rust-lang.org/stream/182449-t-compiler/help/topic/Building.20rust.20trunk.20with.20recent.20nightly.html#271494584">(Feb 10 2022 at 21:08)</a>:</h4>
<p>I know Rust's bootstrap system uses the latest beta as stage 0. is building the current trunk with a recent but slightly older trunk toolchain supported?</p>



<a name="271494694"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/182449-t-compiler/help/topic/Building%20rust%20trunk%20with%20recent%20nightly/near/271494694" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Collin Baker <a href="https://zulip-archive.rust-lang.org/stream/182449-t-compiler/help/topic/Building.20rust.20trunk.20with.20recent.20nightly.html#271494694">(Feb 10 2022 at 21:09)</a>:</h4>
<p>obviously any particular revision of rust can build itself, but I'm not sure if that means yesterday's nightly can build today's nightly</p>



<a name="271494899"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/182449-t-compiler/help/topic/Building%20rust%20trunk%20with%20recent%20nightly/near/271494899" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Collin Baker <a href="https://zulip-archive.rust-lang.org/stream/182449-t-compiler/help/topic/Building.20rust.20trunk.20with.20recent.20nightly.html#271494899">(Feb 10 2022 at 21:11)</a>:</h4>
<p>even if this should work in principle, would it be expected to work in practice?</p>



<a name="271494902"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/182449-t-compiler/help/topic/Building%20rust%20trunk%20with%20recent%20nightly/near/271494902" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Collin Baker <a href="https://zulip-archive.rust-lang.org/stream/182449-t-compiler/help/topic/Building.20rust.20trunk.20with.20recent.20nightly.html#271494902">(Feb 10 2022 at 21:11)</a>:</h4>
<p><a href="https://rustc-dev-guide.rust-lang.org/building/bootstrapping.html#complications-of-bootstrapping">https://rustc-dev-guide.rust-lang.org/building/bootstrapping.html#complications-of-bootstrapping</a></p>



<a name="271495112"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/182449-t-compiler/help/topic/Building%20rust%20trunk%20with%20recent%20nightly/near/271495112" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Collin Baker <a href="https://zulip-archive.rust-lang.org/stream/182449-t-compiler/help/topic/Building.20rust.20trunk.20with.20recent.20nightly.html#271495112">(Feb 10 2022 at 21:13)</a>:</h4>
<p>the situation I'm worried about is this: the trunk code conditionally uses an unstable feature for stage1+. a later revision changes the way the feature works, and test coverage ensures rustc can still compile itself. but the way the feature worked in the previous revision is now incompatible with the latest revision</p>



<a name="271496123"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/182449-t-compiler/help/topic/Building%20rust%20trunk%20with%20recent%20nightly/near/271496123" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> simulacrum <a href="https://zulip-archive.rust-lang.org/stream/182449-t-compiler/help/topic/Building.20rust.20trunk.20with.20recent.20nightly.html#271496123">(Feb 10 2022 at 21:20)</a>:</h4>
<p>We verify builds with a particular beta (pinned in src/stage0.json, alongside checksums), though in principle any beta should work.</p>
<p>A slightly older trunk is significantly less likely to work; in general a reasonable rule of thumb is likely that any patch which changes/adds cfg(bootstrap) code anywhere is a 'breaking point'.</p>



<a name="271496187"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/182449-t-compiler/help/topic/Building%20rust%20trunk%20with%20recent%20nightly/near/271496187" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> simulacrum <a href="https://zulip-archive.rust-lang.org/stream/182449-t-compiler/help/topic/Building.20rust.20trunk.20with.20recent.20nightly.html#271496187">(Feb 10 2022 at 21:21)</a>:</h4>
<p>But yes, even changes that just change features can also in theory cause trouble, though typically that is rare if they're not updating code covered by cfg(bootstrap) at the same time.</p>



<hr><p>Last updated: Apr 12 2022 at 20:01 UTC</p>
</html>