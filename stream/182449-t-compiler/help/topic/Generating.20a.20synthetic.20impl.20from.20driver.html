<html>
<head><meta charset="utf-8"><title>Generating a synthetic impl from driver · t-compiler/help · Zulip Chat Archive</title></head>
<h2>Stream: <a href="https://zulip-archive.rust-lang.org/stream/182449-t-compiler/help/index.html">t-compiler/help</a></h2>
<h3>Topic: <a href="https://zulip-archive.rust-lang.org/stream/182449-t-compiler/help/topic/Generating.20a.20synthetic.20impl.20from.20driver.html">Generating a synthetic impl from driver</a></h3>

<hr>

<base href="https://rust-lang.zulipchat.com">

<head><link href="https://zulip-archive.rust-lang.org/style.css" rel="stylesheet"></head>

<a name="270178397"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/182449-t-compiler/help/topic/Generating%20a%20synthetic%20impl%20from%20driver/near/270178397" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Xavier Denis <a href="https://zulip-archive.rust-lang.org/stream/182449-t-compiler/help/topic/Generating.20a.20synthetic.20impl.20from.20driver.html#270178397">(Feb 01 2022 at 09:47)</a>:</h4>
<p>Hi!</p>
<p>Is there anyway for a rustc driver to generate a synthetic implementation (like <code>Fn</code>/<code>FnMut</code>/<code>FnOnce</code>) during compilation?</p>



<a name="270178426"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/182449-t-compiler/help/topic/Generating%20a%20synthetic%20impl%20from%20driver/near/270178426" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Xavier Denis <a href="https://zulip-archive.rust-lang.org/stream/182449-t-compiler/help/topic/Generating.20a.20synthetic.20impl.20from.20driver.html#270178426">(Feb 01 2022 at 09:47)</a>:</h4>
<p>In my case I have a parallel <code>Fn</code> hierarchy and want to generate a trait impl for closures automatically</p>



<a name="270178742"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/182449-t-compiler/help/topic/Generating%20a%20synthetic%20impl%20from%20driver/near/270178742" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Xavier Denis <a href="https://zulip-archive.rust-lang.org/stream/182449-t-compiler/help/topic/Generating.20a.20synthetic.20impl.20from.20driver.html#270178742">(Feb 01 2022 at 09:50)</a>:</h4>
<p>I know that the <code>fn</code> traits are handled specially in the compiler ( :( ) but I can't figure out how I could create and inject a "normal" instance to trait resolution</p>



<a name="270178798"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/182449-t-compiler/help/topic/Generating%20a%20synthetic%20impl%20from%20driver/near/270178798" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Xavier Denis <a href="https://zulip-archive.rust-lang.org/stream/182449-t-compiler/help/topic/Generating.20a.20synthetic.20impl.20from.20driver.html#270178798">(Feb 01 2022 at 09:50)</a>:</h4>
<p>Is there a query I can override?</p>



<a name="270179526"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/182449-t-compiler/help/topic/Generating%20a%20synthetic%20impl%20from%20driver/near/270179526" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Xavier Denis <a href="https://zulip-archive.rust-lang.org/stream/182449-t-compiler/help/topic/Generating.20a.20synthetic.20impl.20from.20driver.html#270179526">(Feb 01 2022 at 09:55)</a>:</h4>
<p>hmm perhaps <code>trait_impls_of</code> ?</p>



<a name="270180010"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/182449-t-compiler/help/topic/Generating%20a%20synthetic%20impl%20from%20driver/near/270180010" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Xavier Denis <a href="https://zulip-archive.rust-lang.org/stream/182449-t-compiler/help/topic/Generating.20a.20synthetic.20impl.20from.20driver.html#270180010">(Feb 01 2022 at 09:58)</a>:</h4>
<p>still requires me to be able to generate <code>DefId</code>s at the very minimum :/</p>



<a name="270203903"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/182449-t-compiler/help/topic/Generating%20a%20synthetic%20impl%20from%20driver/near/270203903" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Xavier Denis <a href="https://zulip-archive.rust-lang.org/stream/182449-t-compiler/help/topic/Generating.20a.20synthetic.20impl.20from.20driver.html#270203903">(Feb 01 2022 at 12:55)</a>:</h4>
<p>Hmm, because the traits <code>fn / fnmut / fnonce</code> are treated specially for closures, the instances don't show up as part of <code>trait_impls_of</code></p>



<hr><p>Last updated: Apr 12 2022 at 20:01 UTC</p>
</html>