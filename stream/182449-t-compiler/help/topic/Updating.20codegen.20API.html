<html>
<head><meta charset="utf-8"><title>Updating codegen API · t-compiler/help · Zulip Chat Archive</title></head>
<h2>Stream: <a href="https://zulip-archive.rust-lang.org/stream/182449-t-compiler/help/index.html">t-compiler/help</a></h2>
<h3>Topic: <a href="https://zulip-archive.rust-lang.org/stream/182449-t-compiler/help/topic/Updating.20codegen.20API.html">Updating codegen API</a></h3>

<hr>

<base href="https://rust-lang.zulipchat.com">

<head><link href="https://zulip-archive.rust-lang.org/style.css" rel="stylesheet"></head>

<a name="251432984"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/182449-t-compiler/help/topic/Updating%20codegen%20API/near/251432984" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Riccardo D&#x27;Ambrosio <a href="https://zulip-archive.rust-lang.org/stream/182449-t-compiler/help/topic/Updating.20codegen.20API.html#251432984">(Aug 31 2021 at 18:28)</a>:</h4>
<p>If i am writing a custom backend for rustc, what toolchain should i keep up to date with? It seems the codegen backend api breaks a lot so i am not quite sure if i should be following nightly and fixing it when nightly updates or what?</p>



<a name="251441112"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/182449-t-compiler/help/topic/Updating%20codegen%20API/near/251441112" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Nelson <a href="https://zulip-archive.rust-lang.org/stream/182449-t-compiler/help/topic/Updating.20codegen.20API.html#251441112">(Aug 31 2021 at 19:14)</a>:</h4>
<p>yeah, rustc_cg_clif regularly updates the toolchain</p>



<a name="251441179"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/182449-t-compiler/help/topic/Updating%20codegen%20API/near/251441179" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Nelson <a href="https://zulip-archive.rust-lang.org/stream/182449-t-compiler/help/topic/Updating.20codegen.20API.html#251441179">(Aug 31 2021 at 19:15)</a>:</h4>
<p>you can choose what toolchains you want to support though, you aren't forced to use the latest nightly as long as you use rust-toolchain</p>



<a name="251442535"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/182449-t-compiler/help/topic/Updating%20codegen%20API/near/251442535" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Riccardo D&#x27;Ambrosio <a href="https://zulip-archive.rust-lang.org/stream/182449-t-compiler/help/topic/Updating.20codegen.20API.html#251442535">(Aug 31 2021 at 19:23)</a>:</h4>
<p><span class="user-mention" data-user-id="232545">@Joshua Nelson</span> arent i forced to use nightly because of rustc_private?</p>



<a name="251443495"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/182449-t-compiler/help/topic/Updating%20codegen%20API/near/251443495" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Riccardo D&#x27;Ambrosio <a href="https://zulip-archive.rust-lang.org/stream/182449-t-compiler/help/topic/Updating.20codegen.20API.html#251443495">(Aug 31 2021 at 19:28)</a>:</h4>
<p>I have a bit of a confusing setup, my codegen needs llvm 7, but i cant really build llvm 7 every time someone wants to use the backend. So i was thinking i can set up github CI to build shared libs of it which i can then download automatically. But then id have to build new libs on every nightly release, which sounds problematic</p>



<a name="251443718"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/182449-t-compiler/help/topic/Updating%20codegen%20API/near/251443718" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Riccardo D&#x27;Ambrosio <a href="https://zulip-archive.rust-lang.org/stream/182449-t-compiler/help/topic/Updating.20codegen.20API.html#251443718">(Aug 31 2021 at 19:29)</a>:</h4>
<p>maybe i can set up a way to download prebuilt llvm like rustc can do. But that also gets confusing...</p>



<a name="251444013"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/182449-t-compiler/help/topic/Updating%20codegen%20API/near/251444013" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Riccardo D&#x27;Ambrosio <a href="https://zulip-archive.rust-lang.org/stream/182449-t-compiler/help/topic/Updating.20codegen.20API.html#251444013">(Aug 31 2021 at 19:31)</a>:</h4>
<p>because to build the codegen you need to also have rustc-dev installed and it just... its a mess</p>



<a name="251450212"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/182449-t-compiler/help/topic/Updating%20codegen%20API/near/251450212" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Eric Huss <a href="https://zulip-archive.rust-lang.org/stream/182449-t-compiler/help/topic/Updating.20codegen.20API.html#251450212">(Aug 31 2021 at 20:06)</a>:</h4>
<p>I think what Joshua is referring to is that you can pin to a specific nightly, and then just update periodically when you have time.  For example: <a href="https://github.com/bjorn3/rustc_codegen_cranelift/blob/master/rust-toolchain"><code>rust-toolchain</code></a> in cranelift.  There are more docs about pinning <a href="https://rust-lang.github.io/rustup/overrides.html#the-toolchain-file">here</a>.</p>



<a name="251450278"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/182449-t-compiler/help/topic/Updating%20codegen%20API/near/251450278" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Riccardo D&#x27;Ambrosio <a href="https://zulip-archive.rust-lang.org/stream/182449-t-compiler/help/topic/Updating.20codegen.20API.html#251450278">(Aug 31 2021 at 20:06)</a>:</h4>
<p>I see</p>



<a name="251453634"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/182449-t-compiler/help/topic/Updating%20codegen%20API/near/251453634" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Nelson <a href="https://zulip-archive.rust-lang.org/stream/182449-t-compiler/help/topic/Updating.20codegen.20API.html#251453634">(Aug 31 2021 at 20:27)</a>:</h4>
<p>Yeah, you need a nightly <em>channel</em>, but you can pick any specific nightly <em>toolchain</em></p>



<hr><p>Last updated: Apr 12 2022 at 20:01 UTC</p>
</html>