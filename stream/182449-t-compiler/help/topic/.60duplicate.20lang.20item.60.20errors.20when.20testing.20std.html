<html>
<head><meta charset="utf-8"><title>`duplicate lang item` errors when testing std · t-compiler/help · Zulip Chat Archive</title></head>
<h2>Stream: <a href="https://zulip-archive.rust-lang.org/stream/182449-t-compiler/help/index.html">t-compiler/help</a></h2>
<h3>Topic: <a href="https://zulip-archive.rust-lang.org/stream/182449-t-compiler/help/topic/.60duplicate.20lang.20item.60.20errors.20when.20testing.20std.html">`duplicate lang item` errors when testing std</a></h3>

<hr>

<base href="https://rust-lang.zulipchat.com">

<head><link href="https://zulip-archive.rust-lang.org/style.css" rel="stylesheet"></head>

<a name="273697428"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/182449-t-compiler/help/topic/%60duplicate%20lang%20item%60%20errors%20when%20testing%20std/near/273697428" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Collin Baker <a href="https://zulip-archive.rust-lang.org/stream/182449-t-compiler/help/topic/.60duplicate.20lang.20item.60.20errors.20when.20testing.20std.html#273697428">(Mar 01 2022 at 19:31)</a>:</h4>
<p>I'm seeing errors like this:</p>
<div class="codehilite"><pre><span></span><code>Testing std stage1 (x86_64-unknown-linux-gnu -&gt; x86_64-unknown-linux-gnu)
...

error: duplicate lang item in crate `alloc` (which `std` depends on): `str_alloc`.
  |
  = note: the lang item is first defined in crate `alloc` (which `std` depends on)
  = note: first definition in `alloc` loaded from /b/s/w/ir/cache/builder/src/third_party/rust-src/build/x86_64-unknown-linux-gnu/stage1/lib/rustlib/x86_64-unknown-linux-gnu/lib/liballoc-c082dfd94cd81117.rlib, /b/s/w/ir/cache/builder/src/third_party/rust-src/build/x86_64-unknown-linux-gnu/stage1-std/x86_64-unknown-linux-gnu/release/deps/liballoc-c082dfd94cd81117.rmeta
  = note: second definition in `alloc` loaded from /b/s/w/ir/cache/builder/src/third_party/rust-src/build/x86_64-unknown-linux-gnu/stage1-std/x86_64-unknown-linux-gnu/release/deps/liballoc-d8a36d94a6b2b299.rlib
</code></pre></div>



<a name="273697627"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/182449-t-compiler/help/topic/%60duplicate%20lang%20item%60%20errors%20when%20testing%20std/near/273697627" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Collin Baker <a href="https://zulip-archive.rust-lang.org/stream/182449-t-compiler/help/topic/.60duplicate.20lang.20item.60.20errors.20when.20testing.20std.html#273697627">(Mar 01 2022 at 19:32)</a>:</h4>
<p>from running <code>x.py test --stage 1 --keep-stage 1 library/std src/test/codegen src/test/ui</code></p>



<a name="273697789"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/182449-t-compiler/help/topic/%60duplicate%20lang%20item%60%20errors%20when%20testing%20std/near/273697789" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Collin Baker <a href="https://zulip-archive.rust-lang.org/stream/182449-t-compiler/help/topic/.60duplicate.20lang.20item.60.20errors.20when.20testing.20std.html#273697789">(Mar 01 2022 at 19:33)</a>:</h4>
<p>if it makes a difference, I previously ran <code>x.py build --stage 1 library/proc_macro library/std src/tools/cargo src/tools/clippy src/tools/rustfmt</code></p>



<a name="273697893"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/182449-t-compiler/help/topic/%60duplicate%20lang%20item%60%20errors%20when%20testing%20std/near/273697893" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Collin Baker <a href="https://zulip-archive.rust-lang.org/stream/182449-t-compiler/help/topic/.60duplicate.20lang.20item.60.20errors.20when.20testing.20std.html#273697893">(Mar 01 2022 at 19:34)</a>:</h4>
<p>what's going on here? why are there two different <code>liballoc</code>s in stage 1?</p>



<a name="273697923"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/182449-t-compiler/help/topic/%60duplicate%20lang%20item%60%20errors%20when%20testing%20std/near/273697923" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Collin Baker <a href="https://zulip-archive.rust-lang.org/stream/182449-t-compiler/help/topic/.60duplicate.20lang.20item.60.20errors.20when.20testing.20std.html#273697923">(Mar 01 2022 at 19:34)</a>:</h4>
<p>I'm seeing this error inconsistently.</p>



<hr><p>Last updated: Apr 12 2022 at 20:01 UTC</p>
</html>