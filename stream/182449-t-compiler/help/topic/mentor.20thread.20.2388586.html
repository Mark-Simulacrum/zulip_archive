<html>
<head><meta charset="utf-8"><title>mentor thread #88586 · t-compiler/help · Zulip Chat Archive</title></head>
<h2>Stream: <a href="https://zulip-archive.rust-lang.org/stream/182449-t-compiler/help/index.html">t-compiler/help</a></h2>
<h3>Topic: <a href="https://zulip-archive.rust-lang.org/stream/182449-t-compiler/help/topic/mentor.20thread.20.2388586.html">mentor thread #88586</a></h3>

<hr>

<base href="https://rust-lang.zulipchat.com">

<head><link href="https://zulip-archive.rust-lang.org/style.css" rel="stylesheet"></head>

<a name="262858748"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/182449-t-compiler/help/topic/mentor%20thread%20%2388586/near/262858748" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Ben Reeves <a href="https://zulip-archive.rust-lang.org/stream/182449-t-compiler/help/topic/mentor.20thread.20.2388586.html#262858748">(Nov 27 2021 at 07:03)</a>:</h4>
<p>For <a href="https://github.com/rust-lang/rust/issues/88586">https://github.com/rust-lang/rust/issues/88586</a></p>
<p>I'm gonna spend some time in the code to get my bearings. </p>
<p>For the record, this will be my first substantive contribution to rustc. I have spent a little bit of time in some of the MIR parts of the compiler like trait_selection and infer, but the AST and HIR stuff is all new to me still.</p>



<a name="262862699"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/182449-t-compiler/help/topic/mentor%20thread%20%2388586/near/262862699" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Ben Reeves <a href="https://zulip-archive.rust-lang.org/stream/182449-t-compiler/help/topic/mentor.20thread.20.2388586.html#262862699">(Nov 27 2021 at 08:54)</a>:</h4>
<p>Ok, some random questions/thoughts before I go to bed:</p>
<p>1) Conceptually, what does the "poly" mean in PolyTraitRef?</p>
<p>2) The following example does <em>not</em> ICE with debug_assertions:</p>
<div class="codehilite" data-code-language="Rust"><pre><span></span><code><span class="k">fn</span> <span class="nf">foo</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;</span><span class="p">(</span><span class="n">t</span>: <span class="nc">T</span><span class="p">)</span><span class="w"></span>
<span class="k">where</span><span class="w"></span>
<span class="w">    </span><span class="k">for</span><span class="o">&lt;'</span><span class="na">b</span><span class="o">&gt;</span><span class="w"> </span><span class="n">T</span>: <span class="o">'</span><span class="na">b</span><span class="p">,</span><span class="w"></span>
<span class="p">{</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>
</code></pre></div>
<p>What makes this example different from the one that does ICE? I tried doing some debug logging, and it seems that the difference lies somewhere above <code>AstConv::add_bounds</code>:</p>
<p>ICE example (empty <code>bound_vars</code>):</p>
<div class="codehilite"><pre><span></span><code>┐rustc_typeck::astconv::add_bounds param_ty=Self, bound_vars=[]
┘
┐rustc_typeck::astconv::add_bounds param_ty=Self, bound_vars=[]
├─┐rustc_typeck::astconv::ast_region_to_region lifetime=lifetime(HirId { owner: DefId(0:9 ~ issue_88586[e2ea]::A), local_id: 4 }: &#39;a), def=None
...
├─┐rustc_middle::ty::sty::bind_with_vars value=ReLateBound(DebruijnIndex(0), BoundRegion { var: 0, kind: BrNamed(DefId(0:10 ~ issue_88586[e2ea]::A::&#39;a), &#39;a) }), vars=[]
</code></pre></div>
<p>No-ICE example (non-empty <code>bound_vars</code>):</p>
<div class="codehilite"><pre><span></span><code>┐rustc_typeck::astconv::add_bounds param_ty=T, bound_vars=[]
┘
┐rustc_typeck::astconv::add_bounds param_ty=T, bound_vars=[Region(BrNamed(DefId(0:12 ~ issue_88586[e2ea]::foo::&#39;b), &#39;b))]
├─┐rustc_typeck::astconv::ast_region_to_region lifetime=lifetime(HirId { owner: DefId(0:10 ~ issue_88586[e2ea]::foo), local_id: 9 }: &#39;b), def=None
...
├─┐rustc_middle::ty::sty::bind_with_vars value=ReLateBound(DebruijnIndex(0), BoundRegion { var: 0, kind: BrNamed(DefId(0:12 ~ issue_88586[e2ea]::foo::&#39;b), &#39;b) }), vars=[Region(BrNamed(DefId(0:12 ~ issue_88586[e2ea]::foo::&#39;b), &#39;b))]
</code></pre></div>



<a name="262882486"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/182449-t-compiler/help/topic/mentor%20thread%20%2388586/near/262882486" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jack Huey <a href="https://zulip-archive.rust-lang.org/stream/182449-t-compiler/help/topic/mentor.20thread.20.2388586.html#262882486">(Nov 27 2021 at 16:53)</a>:</h4>
<p>1) <code>Poly*</code> generally means it's a type alias for <code>Binder&lt;'tcx, *&gt;</code></p>



<a name="262882587"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/182449-t-compiler/help/topic/mentor%20thread%20%2388586/near/262882587" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jack Huey <a href="https://zulip-archive.rust-lang.org/stream/182449-t-compiler/help/topic/mentor.20thread.20.2388586.html#262882587">(Nov 27 2021 at 16:55)</a>:</h4>
<p>2) The difference here really does lie with the bound vars that get passed to <code>add_bounds</code></p>



<a name="262888223"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/182449-t-compiler/help/topic/mentor%20thread%20%2388586/near/262888223" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Ben Reeves <a href="https://zulip-archive.rust-lang.org/stream/182449-t-compiler/help/topic/mentor.20thread.20.2388586.html#262888223">(Nov 27 2021 at 19:10)</a>:</h4>
<p>1) sure, I get that, but I'm having a hard time understanding how "poly" and "binder" are related conceptually.</p>
<p>2) ok, so is that relevant to this issue do you think? Or a red herring?</p>



<a name="262910457"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/182449-t-compiler/help/topic/mentor%20thread%20%2388586/near/262910457" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Ben Reeves <a href="https://zulip-archive.rust-lang.org/stream/182449-t-compiler/help/topic/mentor.20thread.20.2388586.html#262910457">(Nov 28 2021 at 05:14)</a>:</h4>
<p>I think I got it</p>



<hr><p>Last updated: Apr 12 2022 at 20:01 UTC</p>
</html>