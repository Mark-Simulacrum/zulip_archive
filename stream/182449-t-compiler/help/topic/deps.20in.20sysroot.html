<html>
<head><meta charset="utf-8"><title>deps in sysroot · t-compiler/help · Zulip Chat Archive</title></head>
<h2>Stream: <a href="https://rust-lang.github.io/zulip_archive/stream/182449-t-compiler/help/index.html">t-compiler/help</a></h2>
<h3>Topic: <a href="https://rust-lang.github.io/zulip_archive/stream/182449-t-compiler/help/topic/deps.20in.20sysroot.html">deps in sysroot</a></h3>

<hr>

<base href="https://rust-lang.zulipchat.com">

<head><link href="https://rust-lang.github.io/zulip_archive/style.css" rel="stylesheet"></head>

<a name="216298694"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/182449-t-compiler/help/topic/deps%20in%20sysroot/near/216298694" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Nelson <a href="https://rust-lang.github.io/zulip_archive/stream/182449-t-compiler/help/topic/deps.20in.20sysroot.html#216298694">(Nov 11 2020 at 01:43)</a>:</h4>
<p>wait, why is rustc_mir different from rustdoc?</p>



<a name="216298698"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/182449-t-compiler/help/topic/deps%20in%20sysroot/near/216298698" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Nelson <a href="https://rust-lang.github.io/zulip_archive/stream/182449-t-compiler/help/topic/deps.20in.20sysroot.html#216298698">(Nov 11 2020 at 01:43)</a>:</h4>
<p>rustdoc loads it from sysroot iirc</p>



<a name="216298707"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/182449-t-compiler/help/topic/deps%20in%20sysroot/near/216298707" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> simulacrum <a href="https://rust-lang.github.io/zulip_archive/stream/182449-t-compiler/help/topic/deps.20in.20sysroot.html#216298707">(Nov 11 2020 at 01:43)</a>:</h4>
<p>because rustdoc is built in a different target directory (with other tools)</p>



<a name="216298720"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/182449-t-compiler/help/topic/deps%20in%20sysroot/near/216298720" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Nelson <a href="https://rust-lang.github.io/zulip_archive/stream/182449-t-compiler/help/topic/deps.20in.20sysroot.html#216298720">(Nov 11 2020 at 01:43)</a>:</h4>
<p>oh I see</p>



<a name="216298723"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/182449-t-compiler/help/topic/deps%20in%20sysroot/near/216298723" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Nelson <a href="https://rust-lang.github.io/zulip_archive/stream/182449-t-compiler/help/topic/deps.20in.20sysroot.html#216298723">(Nov 11 2020 at 01:43)</a>:</h4>
<p>are the directories documented somewhere?</p>



<a name="216298732"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/182449-t-compiler/help/topic/deps%20in%20sysroot/near/216298732" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> simulacrum <a href="https://rust-lang.github.io/zulip_archive/stream/182449-t-compiler/help/topic/deps.20in.20sysroot.html#216298732">(Nov 11 2020 at 01:43)</a>:</h4>
<p>uh, I mean, they're pretty directly mapped</p>



<a name="216298733"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/182449-t-compiler/help/topic/deps%20in%20sysroot/near/216298733" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> simulacrum <a href="https://rust-lang.github.io/zulip_archive/stream/182449-t-compiler/help/topic/deps.20in.20sysroot.html#216298733">(Nov 11 2020 at 01:43)</a>:</h4>
<p>but no</p>



<a name="216298779"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/182449-t-compiler/help/topic/deps%20in%20sysroot/near/216298779" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> simulacrum <a href="https://rust-lang.github.io/zulip_archive/stream/182449-t-compiler/help/topic/deps.20in.20sysroot.html#216298779">(Nov 11 2020 at 01:44)</a>:</h4>
<p>I also don't really want to document stuff inside build/</p>



<a name="216298783"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/182449-t-compiler/help/topic/deps%20in%20sysroot/near/216298783" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> simulacrum <a href="https://rust-lang.github.io/zulip_archive/stream/182449-t-compiler/help/topic/deps.20in.20sysroot.html#216298783">(Nov 11 2020 at 01:44)</a>:</h4>
<p>I guess as internal docs maybe</p>



<a name="216298793"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/182449-t-compiler/help/topic/deps%20in%20sysroot/near/216298793" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Nelson <a href="https://rust-lang.github.io/zulip_archive/stream/182449-t-compiler/help/topic/deps.20in.20sysroot.html#216298793">(Nov 11 2020 at 01:44)</a>:</h4>
<p>right, as reference in the dev guide maybe, or instructions for adding dependencies</p>



<a name="216298803"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/182449-t-compiler/help/topic/deps%20in%20sysroot/near/216298803" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> simulacrum <a href="https://rust-lang.github.io/zulip_archive/stream/182449-t-compiler/help/topic/deps.20in.20sysroot.html#216298803">(Nov 11 2020 at 01:44)</a>:</h4>
<p><a href="https://github.com/Mark-Simulacrum/rust/blob/72f27be42acfa212fc2828dba5b8bed8693cc7f4/src/bootstrap/lib.rs#L602-L611">https://github.com/Mark-Simulacrum/rust/blob/72f27be42acfa212fc2828dba5b8bed8693cc7f4/src/bootstrap/lib.rs#L602-L611</a></p>



<a name="216298807"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/182449-t-compiler/help/topic/deps%20in%20sysroot/near/216298807" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Nelson <a href="https://rust-lang.github.io/zulip_archive/stream/182449-t-compiler/help/topic/deps.20in.20sysroot.html#216298807">(Nov 11 2020 at 01:44)</a>:</h4>
<p>right now 'should dependencies be loaded from sysroot' is not a question I know how to answer without your input</p>



<a name="216298841"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/182449-t-compiler/help/topic/deps%20in%20sysroot/near/216298841" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> simulacrum <a href="https://rust-lang.github.io/zulip_archive/stream/182449-t-compiler/help/topic/deps.20in.20sysroot.html#216298841">(Nov 11 2020 at 01:45)</a>:</h4>
<p>I answer it with "does x.py check work" basically</p>



<a name="216298857"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/182449-t-compiler/help/topic/deps%20in%20sysroot/near/216298857" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Nelson <a href="https://rust-lang.github.io/zulip_archive/stream/182449-t-compiler/help/topic/deps.20in.20sysroot.html#216298857">(Nov 11 2020 at 01:45)</a>:</h4>
<p>well, it did just now for rustc_mir, didn't it?</p>



<a name="216298861"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/182449-t-compiler/help/topic/deps%20in%20sysroot/near/216298861" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Nelson <a href="https://rust-lang.github.io/zulip_archive/stream/182449-t-compiler/help/topic/deps.20in.20sysroot.html#216298861">(Nov 11 2020 at 01:45)</a>:</h4>
<p>when loading from sysroot</p>



<a name="216299095"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/182449-t-compiler/help/topic/deps%20in%20sysroot/near/216299095" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> simulacrum <a href="https://rust-lang.github.io/zulip_archive/stream/182449-t-compiler/help/topic/deps.20in.20sysroot.html#216299095">(Nov 11 2020 at 01:49)</a>:</h4>
<p>er, rustc_mir doesn't load tracing from sysroot ... ever</p>



<a name="216299152"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/182449-t-compiler/help/topic/deps%20in%20sysroot/near/216299152" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> simulacrum <a href="https://rust-lang.github.io/zulip_archive/stream/182449-t-compiler/help/topic/deps.20in.20sysroot.html#216299152">(Nov 11 2020 at 01:50)</a>:</h4>
<p>the steps are:</p>
<ul>
<li>try to use it</li>
<li>fails to work, add to Cargo.toml</li>
<li>it should work now</li>
</ul>



<a name="216299188"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/182449-t-compiler/help/topic/deps%20in%20sysroot/near/216299188" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Nelson <a href="https://rust-lang.github.io/zulip_archive/stream/182449-t-compiler/help/topic/deps.20in.20sysroot.html#216299188">(Nov 11 2020 at 01:51)</a>:</h4>
<p>I think I'm confused what 'sysroot' means then - I thought it was all the build artifacts for one stage of the rust compiler?</p>



<a name="216299189"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/182449-t-compiler/help/topic/deps%20in%20sysroot/near/216299189" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> simulacrum <a href="https://rust-lang.github.io/zulip_archive/stream/182449-t-compiler/help/topic/deps.20in.20sysroot.html#216299189">(Nov 11 2020 at 01:51)</a>:</h4>
<p>there's edge cases I think around conflicts for some crates where you need to make sure it gets into the sysroot (e.g., via the fake deps thing) but that's super rare to run into</p>



<a name="216299268"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/182449-t-compiler/help/topic/deps%20in%20sysroot/near/216299268" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> simulacrum <a href="https://rust-lang.github.io/zulip_archive/stream/182449-t-compiler/help/topic/deps.20in.20sysroot.html#216299268">(Nov 11 2020 at 01:52)</a>:</h4>
<p>loading from the sysroot means "--extern foo=/path/to/foo" is not passed, basically, and the compiler looks in <code>$(rustc --print sysroot)/lib/rustlib/$target/lib/foo.rlib</code> or something like that to find the foo crate</p>



<a name="216299280"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/182449-t-compiler/help/topic/deps%20in%20sysroot/near/216299280" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> simulacrum <a href="https://rust-lang.github.io/zulip_archive/stream/182449-t-compiler/help/topic/deps.20in.20sysroot.html#216299280">(Nov 11 2020 at 01:52)</a>:</h4>
<p>the target/deps directory is not the sysroot</p>



<a name="216299289"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/182449-t-compiler/help/topic/deps%20in%20sysroot/near/216299289" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> simulacrum <a href="https://rust-lang.github.io/zulip_archive/stream/182449-t-compiler/help/topic/deps.20in.20sysroot.html#216299289">(Nov 11 2020 at 01:52)</a>:</h4>
<p>same way that e.g. rustc_driver does not load rustc_mir from the sysroot, ever</p>



<a name="216299304"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/182449-t-compiler/help/topic/deps%20in%20sysroot/near/216299304" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> simulacrum <a href="https://rust-lang.github.io/zulip_archive/stream/182449-t-compiler/help/topic/deps.20in.20sysroot.html#216299304">(Nov 11 2020 at 01:53)</a>:</h4>
<p>that is, compilation of rustc_driver does not load rustc_mir</p>



<a name="216299320"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/182449-t-compiler/help/topic/deps%20in%20sysroot/near/216299320" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Nelson <a href="https://rust-lang.github.io/zulip_archive/stream/182449-t-compiler/help/topic/deps.20in.20sysroot.html#216299320">(Nov 11 2020 at 01:53)</a>:</h4>
<p><span class="user-mention silent" data-user-id="116122">simulacrum</span> <a href="#narrow/stream/182449-t-compiler.2Fhelp/topic/enabling.20debug.20logging.20for.20rustc.20in-tree.20tests/near/216299304">said</a>:</p>
<blockquote>
<p>that is, compilation of rustc_driver does not load rustc_mir</p>
</blockquote>
<p>wait I was with you until then - doesn't it need to load rustc_mir from target/deps?</p>



<a name="216299376"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/182449-t-compiler/help/topic/deps%20in%20sysroot/near/216299376" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Nelson <a href="https://rust-lang.github.io/zulip_archive/stream/182449-t-compiler/help/topic/deps.20in.20sysroot.html#216299376">(Nov 11 2020 at 01:54)</a>:</h4>
<p>and I'm slightly confused - sysroot is 'dependencies rustc knows about' and target/deps is 'dependencies cargo knows about'?</p>



<a name="216299383"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/182449-t-compiler/help/topic/deps%20in%20sysroot/near/216299383" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Nelson <a href="https://rust-lang.github.io/zulip_archive/stream/182449-t-compiler/help/topic/deps.20in.20sysroot.html#216299383">(Nov 11 2020 at 01:54)</a>:</h4>
<p>are they both rlibs?</p>



<a name="216299389"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/182449-t-compiler/help/topic/deps%20in%20sysroot/near/216299389" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Nelson <a href="https://rust-lang.github.io/zulip_archive/stream/182449-t-compiler/help/topic/deps.20in.20sysroot.html#216299389">(Nov 11 2020 at 01:54)</a>:</h4>
<p>(planning to write all this up in the dev-guide at some point)</p>



<a name="216299393"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/182449-t-compiler/help/topic/deps%20in%20sysroot/near/216299393" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> simulacrum <a href="https://rust-lang.github.io/zulip_archive/stream/182449-t-compiler/help/topic/deps.20in.20sysroot.html#216299393">(Nov 11 2020 at 01:55)</a>:</h4>
<p>let me fork this</p>



<a name="216299512"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/182449-t-compiler/help/topic/deps%20in%20sysroot/near/216299512" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> simulacrum <a href="https://rust-lang.github.io/zulip_archive/stream/182449-t-compiler/help/topic/deps.20in.20sysroot.html#216299512">(Nov 11 2020 at 01:56)</a>:</h4>
<p>target/deps is not the sysroot</p>



<a name="216299517"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/182449-t-compiler/help/topic/deps%20in%20sysroot/near/216299517" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Nelson <a href="https://rust-lang.github.io/zulip_archive/stream/182449-t-compiler/help/topic/deps.20in.20sysroot.html#216299517">(Nov 11 2020 at 01:57)</a>:</h4>
<p>right, I got that</p>



<a name="216299524"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/182449-t-compiler/help/topic/deps%20in%20sysroot/near/216299524" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> simulacrum <a href="https://rust-lang.github.io/zulip_archive/stream/182449-t-compiler/help/topic/deps.20in.20sysroot.html#216299524">(Nov 11 2020 at 01:57)</a>:</h4>
<p>oh, I meant "does not load rustc_mir from the sysroot"</p>



<a name="216299568"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/182449-t-compiler/help/topic/deps%20in%20sysroot/near/216299568" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> simulacrum <a href="https://rust-lang.github.io/zulip_archive/stream/182449-t-compiler/help/topic/deps.20in.20sysroot.html#216299568">(Nov 11 2020 at 01:57)</a>:</h4>
<p>I was trying to clarify that at runtime it could load it from the sysroot if rustc_mir was a dylib (like it was at some point, these days it's statically linked into rustc_driver)</p>



<a name="216299689"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/182449-t-compiler/help/topic/deps%20in%20sysroot/near/216299689" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Nelson <a href="https://rust-lang.github.io/zulip_archive/stream/182449-t-compiler/help/topic/deps.20in.20sysroot.html#216299689">(Nov 11 2020 at 01:58)</a>:</h4>
<p>ohhhh I see, the sysroot <em>also</em> has shared objects</p>



<a name="216299696"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/182449-t-compiler/help/topic/deps%20in%20sysroot/near/216299696" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Nelson <a href="https://rust-lang.github.io/zulip_archive/stream/182449-t-compiler/help/topic/deps.20in.20sysroot.html#216299696">(Nov 11 2020 at 01:58)</a>:</h4>
<p>ok that makes sense, the way llvm is a shared object</p>



<a name="216299741"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/182449-t-compiler/help/topic/deps%20in%20sysroot/near/216299741" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Nelson <a href="https://rust-lang.github.io/zulip_archive/stream/182449-t-compiler/help/topic/deps.20in.20sysroot.html#216299741">(Nov 11 2020 at 01:59)</a>:</h4>
<p>and libstd too, look at that</p>
<div class="codehilite"><pre><span></span><code>$ ls $(rustc --print sysroot)/lib
libchalk_derive-46a5a352f0138c2f.so  libstd-7edd956e9d8d05ea.so
libLLVM-11-rust-1.49.0-nightly.so    libtest-5016d499037f0dbe.so
librustc_driver-a574036e5082812b.so  libtracing_attributes-f365db74608592aa.so
librustc_macros-526b2b3435deae8e.so  rustlib
</code></pre></div>



<a name="216299746"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/182449-t-compiler/help/topic/deps%20in%20sysroot/near/216299746" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> simulacrum <a href="https://rust-lang.github.io/zulip_archive/stream/182449-t-compiler/help/topic/deps.20in.20sysroot.html#216299746">(Nov 11 2020 at 01:59)</a>:</h4>
<p>that is not the sysroot</p>



<a name="216299750"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/182449-t-compiler/help/topic/deps%20in%20sysroot/near/216299750" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> simulacrum <a href="https://rust-lang.github.io/zulip_archive/stream/182449-t-compiler/help/topic/deps.20in.20sysroot.html#216299750">(Nov 11 2020 at 01:59)</a>:</h4>
<p>or, rather, not the one rustc loads from</p>



<a name="216299756"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/182449-t-compiler/help/topic/deps%20in%20sysroot/near/216299756" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> simulacrum <a href="https://rust-lang.github.io/zulip_archive/stream/182449-t-compiler/help/topic/deps.20in.20sysroot.html#216299756">(Nov 11 2020 at 01:59)</a>:</h4>
<p>you want lib/rustlib/$target/lib</p>



<a name="216299822"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/182449-t-compiler/help/topic/deps%20in%20sysroot/near/216299822" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> simulacrum <a href="https://rust-lang.github.io/zulip_archive/stream/182449-t-compiler/help/topic/deps.20in.20sysroot.html#216299822">(Nov 11 2020 at 02:00)</a>:</h4>
<p>(which you can remember by thinking "I want to cross-compile, so we need a target arch in the path somewhere")</p>



<a name="216299845"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/182449-t-compiler/help/topic/deps%20in%20sysroot/near/216299845" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Nelson <a href="https://rust-lang.github.io/zulip_archive/stream/182449-t-compiler/help/topic/deps.20in.20sysroot.html#216299845">(Nov 11 2020 at 02:00)</a>:</h4>
<p>hmm, what's the difference? I see rustlib/ has proc_macro and libunwind and a bunch of other things</p>



<a name="216299851"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/182449-t-compiler/help/topic/deps%20in%20sysroot/near/216299851" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Nelson <a href="https://rust-lang.github.io/zulip_archive/stream/182449-t-compiler/help/topic/deps.20in.20sysroot.html#216299851">(Nov 11 2020 at 02:00)</a>:</h4>
<p>what is lib/ alone used for?</p>



<a name="216299868"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/182449-t-compiler/help/topic/deps%20in%20sysroot/near/216299868" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> simulacrum <a href="https://rust-lang.github.io/zulip_archive/stream/182449-t-compiler/help/topic/deps.20in.20sysroot.html#216299868">(Nov 11 2020 at 02:01)</a>:</h4>
<p>that's like the compiler itself</p>



<a name="216299877"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/182449-t-compiler/help/topic/deps%20in%20sysroot/near/216299877" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> simulacrum <a href="https://rust-lang.github.io/zulip_archive/stream/182449-t-compiler/help/topic/deps.20in.20sysroot.html#216299877">(Nov 11 2020 at 02:01)</a>:</h4>
<p>basically we want to share the compiler code between clippy / rustc/ rustdoc</p>



<a name="216299882"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/182449-t-compiler/help/topic/deps%20in%20sysroot/near/216299882" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> simulacrum <a href="https://rust-lang.github.io/zulip_archive/stream/182449-t-compiler/help/topic/deps.20in.20sysroot.html#216299882">(Nov 11 2020 at 02:01)</a>:</h4>
<p>chalk_derive and rustc_macros are just "bugs" in rustbuild, they don't actually need to be there</p>



<a name="216299930"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/182449-t-compiler/help/topic/deps%20in%20sysroot/near/216299930" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> simulacrum <a href="https://rust-lang.github.io/zulip_archive/stream/182449-t-compiler/help/topic/deps.20in.20sysroot.html#216299930">(Nov 11 2020 at 02:02)</a>:</h4>
<p>everything else I would expect to be a shared library dep of rustc</p>



<a name="216299937"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/182449-t-compiler/help/topic/deps%20in%20sysroot/near/216299937" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Nelson <a href="https://rust-lang.github.io/zulip_archive/stream/182449-t-compiler/help/topic/deps.20in.20sysroot.html#216299937">(Nov 11 2020 at 02:02)</a>:</h4>
<p>lib/ is built by stage 1 and rustlib/ is built by stage 2? or vice versa?</p>



<a name="216299955"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/182449-t-compiler/help/topic/deps%20in%20sysroot/near/216299955" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> simulacrum <a href="https://rust-lang.github.io/zulip_archive/stream/182449-t-compiler/help/topic/deps.20in.20sysroot.html#216299955">(Nov 11 2020 at 02:02)</a>:</h4>
<p>in published artifacts they're duplicates of each other (literally copied)</p>



<a name="216299970"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/182449-t-compiler/help/topic/deps%20in%20sysroot/near/216299970" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Nelson <a href="https://rust-lang.github.io/zulip_archive/stream/182449-t-compiler/help/topic/deps.20in.20sysroot.html#216299970">(Nov 11 2020 at 02:03)</a>:</h4>
<p>right, yeah, maybe 'built by' is not the best terminology - I think 'linked to' is better</p>



<a name="216299981"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/182449-t-compiler/help/topic/deps%20in%20sysroot/near/216299981" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Nelson <a href="https://rust-lang.github.io/zulip_archive/stream/182449-t-compiler/help/topic/deps.20in.20sysroot.html#216299981">(Nov 11 2020 at 02:03)</a>:</h4>
<p>is rustlib linked to <code>rustc</code> or to programs built by rustc?</p>



<a name="216299984"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/182449-t-compiler/help/topic/deps%20in%20sysroot/near/216299984" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> simulacrum <a href="https://rust-lang.github.io/zulip_archive/stream/182449-t-compiler/help/topic/deps.20in.20sysroot.html#216299984">(Nov 11 2020 at 02:03)</a>:</h4>
<p>built by</p>



<a name="216299995"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/182449-t-compiler/help/topic/deps%20in%20sysroot/near/216299995" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> simulacrum <a href="https://rust-lang.github.io/zulip_archive/stream/182449-t-compiler/help/topic/deps.20in.20sysroot.html#216299995">(Nov 11 2020 at 02:04)</a>:</h4>
<p>for build/stageN, lib/ is stageN-1 artifacts, rustlib/.../lib is stageN artifacts</p>



<a name="216300034"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/182449-t-compiler/help/topic/deps%20in%20sysroot/near/216300034" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Nelson <a href="https://rust-lang.github.io/zulip_archive/stream/182449-t-compiler/help/topic/deps.20in.20sysroot.html#216300034">(Nov 11 2020 at 02:04)</a>:</h4>
<p>this is super helpful :D thank you!</p>



<a name="216300043"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/182449-t-compiler/help/topic/deps%20in%20sysroot/near/216300043" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Charles Ellis O&#x27;Riley Jr. <a href="https://rust-lang.github.io/zulip_archive/stream/182449-t-compiler/help/topic/deps.20in.20sysroot.html#216300043">(Nov 11 2020 at 02:04)</a>:</h4>
<p>What do you mean by published artifact?</p>



<a name="216300049"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/182449-t-compiler/help/topic/deps%20in%20sysroot/near/216300049" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Nelson <a href="https://rust-lang.github.io/zulip_archive/stream/182449-t-compiler/help/topic/deps.20in.20sysroot.html#216300049">(Nov 11 2020 at 02:04)</a>:</h4>
<p><span class="user-mention" data-user-id="344328">@Charles Ellis O'Riley Jr.</span> like packaged with rustup</p>



<a name="216300059"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/182449-t-compiler/help/topic/deps%20in%20sysroot/near/216300059" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Charles Ellis O&#x27;Riley Jr. <a href="https://rust-lang.github.io/zulip_archive/stream/182449-t-compiler/help/topic/deps.20in.20sysroot.html#216300059">(Nov 11 2020 at 02:04)</a>:</h4>
<p><span aria-label="call me" class="emoji emoji-1f919" role="img" title="call me">:call_me:</span></p>



<a name="216300254"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/182449-t-compiler/help/topic/deps%20in%20sysroot/near/216300254" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Nelson <a href="https://rust-lang.github.io/zulip_archive/stream/182449-t-compiler/help/topic/deps.20in.20sysroot.html#216300254">(Nov 11 2020 at 02:08)</a>:</h4>
<p>opened <a href="https://github.com/rust-lang/rustc-dev-guide/issues/953">https://github.com/rust-lang/rustc-dev-guide/issues/953</a> so I don't forget to write this up :) thanks again!</p>



<hr><p>Last updated: Aug 07 2021 at 22:04 UTC</p>
</html>