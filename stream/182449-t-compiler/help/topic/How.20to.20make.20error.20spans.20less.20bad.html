<html>
<head><meta charset="utf-8"><title>How to make error spans less bad · t-compiler/help · Zulip Chat Archive</title></head>
<h2>Stream: <a href="https://zulip-archive.rust-lang.org/stream/182449-t-compiler/help/index.html">t-compiler/help</a></h2>
<h3>Topic: <a href="https://zulip-archive.rust-lang.org/stream/182449-t-compiler/help/topic/How.20to.20make.20error.20spans.20less.20bad.html">How to make error spans less bad</a></h3>

<hr>

<base href="https://rust-lang.zulipchat.com">

<head><link href="https://zulip-archive.rust-lang.org/style.css" rel="stylesheet"></head>

<a name="268113508"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/182449-t-compiler/help/topic/How%20to%20make%20error%20spans%20less%20bad/near/268113508" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> asquared31415 <a href="https://zulip-archive.rust-lang.org/stream/182449-t-compiler/help/topic/How.20to.20make.20error.20spans.20less.20bad.html#268113508">(Jan 15 2022 at 08:13)</a>:</h4>
<p>I have some error code that is producing the following output</p>
<div class="codehilite"><pre><span></span><code>error: the #[test] attribute may only be used on a non-associated function
  --&gt; PATH/test-on-not-fn.rs:3:1
   |
LL | / #[test]
LL | | mod test {}
   | |_----------^
   |   |
   |   expected a non-associated function, found a module
   |
   = note: the `#[test]` macro causes a a function to be run on a test and has no effect on non-functions
help: replace with conditional compilation to make the item only exist when tests are being run
   |
LL | #[cfg(test)]
   |
</code></pre></div>
<p>the "main" error span is the whole span including the attribute and the module, the <code>expected a non-associated function</code> span note is on just the item, and the <code>help</code> span is on just the attribute span.  However this formatting is awful and extremely hard to read.  How can I make the spans more obvious and use less overlapping lines?</p>



<a name="268114147"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/182449-t-compiler/help/topic/How%20to%20make%20error%20spans%20less%20bad/near/268114147" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> asquared31415 <a href="https://zulip-archive.rust-lang.org/stream/182449-t-compiler/help/topic/How.20to.20make.20error.20spans.20less.20bad.html#268114147">(Jan 15 2022 at 08:30)</a>:</h4>
<p>I made it somewhat better by making the error span just on the attribute and span_label on the item span so they don't overlap</p>
<div class="codehilite"><pre><span></span><code>error: the #[test] attribute may only be used on a non-associated function
  --&gt; PATH/test-on-not-fn.rs:3:1
   |
LL | #[test]
   | ^^^^^^^
LL | mod test {}
   | ----------- expected a non-associated function, found a module
   |
   = note: the `#[test]` macro causes a a function to be run on a test and has no effect on non-functions
help: replace with conditional compilation to make the item only exist when tests are being run
   |
LL | #[cfg(test)]
   |
</code></pre></div>



<a name="268140277"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/182449-t-compiler/help/topic/How%20to%20make%20error%20spans%20less%20bad/near/268140277" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Noah Lev <a href="https://zulip-archive.rust-lang.org/stream/182449-t-compiler/help/topic/How.20to.20make.20error.20spans.20less.20bad.html#268140277">(Jan 15 2022 at 18:44)</a>:</h4>
<p>What is the code that generates the <code>help</code> suggestion?</p>



<hr><p>Last updated: Apr 12 2022 at 20:01 UTC</p>
</html>