<html>
<head><meta charset="utf-8"><title>✔ compiler ICE adding a new target · t-compiler/help · Zulip Chat Archive</title></head>
<h2>Stream: <a href="https://zulip-archive.rust-lang.org/stream/182449-t-compiler/help/index.html">t-compiler/help</a></h2>
<h3>Topic: <a href="https://zulip-archive.rust-lang.org/stream/182449-t-compiler/help/topic/.E2.9C.94.20compiler.20ICE.20adding.20a.20new.20target.html">✔ compiler ICE adding a new target</a></h3>

<hr>

<base href="https://rust-lang.zulipchat.com">

<head><link href="https://zulip-archive.rust-lang.org/style.css" rel="stylesheet"></head>

<a name="245910391"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/182449-t-compiler/help/topic/%E2%9C%94%20compiler%20ICE%20adding%20a%20new%20target/near/245910391" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> orvi <a href="https://zulip-archive.rust-lang.org/stream/182449-t-compiler/help/topic/.E2.9C.94.20compiler.20ICE.20adding.20a.20new.20target.html#245910391">(Jul 14 2021 at 01:42)</a>:</h4>
<p>Hi, I'm new to hacking on rustc, and ran into a problem adding a new target (<code>riscv-unknown-uefi</code>). I went through the rustc-dev-guide docs on adding a new target, and got an ICE during compilation.</p>
<p>I opened an issue <a href="https://github.com/rust-lang/rust/issues/86829">https://github.com/rust-lang/rust/issues/86829</a>, am I doing something obviously wrong, or is this a legitimate bug in rustc? I'll keep debugging if I'm doing something wrong.</p>
<p>Thanks in advance for any help</p>



<a name="245910483"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/182449-t-compiler/help/topic/%E2%9C%94%20compiler%20ICE%20adding%20a%20new%20target/near/245910483" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Nelson <a href="https://zulip-archive.rust-lang.org/stream/182449-t-compiler/help/topic/.E2.9C.94.20compiler.20ICE.20adding.20a.20new.20target.html#245910483">(Jul 14 2021 at 01:44)</a>:</h4>
<p><span class="user-mention" data-user-id="426841">@orvi</span> do you get the same error without your change?</p>



<a name="245910513"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/182449-t-compiler/help/topic/%E2%9C%94%20compiler%20ICE%20adding%20a%20new%20target/near/245910513" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Nelson <a href="https://zulip-archive.rust-lang.org/stream/182449-t-compiler/help/topic/.E2.9C.94.20compiler.20ICE.20adding.20a.20new.20target.html#245910513">(Jul 14 2021 at 01:45)</a>:</h4>
<p>hmm, that happens in stage0-rustc, so it's not <a href="https://github.com/rust-lang/rust/issues/76720">https://github.com/rust-lang/rust/issues/76720</a></p>



<a name="245910611"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/182449-t-compiler/help/topic/%E2%9C%94%20compiler%20ICE%20adding%20a%20new%20target/near/245910611" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> orvi <a href="https://zulip-archive.rust-lang.org/stream/182449-t-compiler/help/topic/.E2.9C.94.20compiler.20ICE.20adding.20a.20new.20target.html#245910611">(Jul 14 2021 at 01:47)</a>:</h4>
<p>I don't think I tried without the changes, can check now</p>



<a name="245913834"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/182449-t-compiler/help/topic/%E2%9C%94%20compiler%20ICE%20adding%20a%20new%20target/near/245913834" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> orvi <a href="https://zulip-archive.rust-lang.org/stream/182449-t-compiler/help/topic/.E2.9C.94.20compiler.20ICE.20adding.20a.20new.20target.html#245913834">(Jul 14 2021 at 02:53)</a>:</h4>
<p><span class="user-mention" data-user-id="232545">@Joshua Nelson</span> think it may have been the nightly/beta compiler when I built the code. Tried building without my changes, same error. Updated to latest master, rebuilt, seems to be working now. I'll try rebasing my changes on latest master, see if that works</p>



<a name="245913883"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/182449-t-compiler/help/topic/%E2%9C%94%20compiler%20ICE%20adding%20a%20new%20target/near/245913883" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> orvi <a href="https://zulip-archive.rust-lang.org/stream/182449-t-compiler/help/topic/.E2.9C.94.20compiler.20ICE.20adding.20a.20new.20target.html#245913883">(Jul 14 2021 at 02:54)</a>:</h4>
<p>thanks for your feedback</p>



<a name="246031522"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/182449-t-compiler/help/topic/%E2%9C%94%20compiler%20ICE%20adding%20a%20new%20target/near/246031522" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Notification Bot <a href="https://zulip-archive.rust-lang.org/stream/182449-t-compiler/help/topic/.E2.9C.94.20compiler.20ICE.20adding.20a.20new.20target.html#246031522">(Jul 14 2021 at 22:44)</a>:</h4>
<p><span class="user-mention silent" data-user-id="426841">orvi</span> has marked this topic as resolved.</p>



<hr><p>Last updated: Apr 12 2022 at 20:01 UTC</p>
</html>