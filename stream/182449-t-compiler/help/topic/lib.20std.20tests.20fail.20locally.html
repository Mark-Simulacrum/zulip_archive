<html>
<head><meta charset="utf-8"><title>lib std tests fail locally · t-compiler/help · Zulip Chat Archive</title></head>
<h2>Stream: <a href="https://zulip-archive.rust-lang.org/stream/182449-t-compiler/help/index.html">t-compiler/help</a></h2>
<h3>Topic: <a href="https://zulip-archive.rust-lang.org/stream/182449-t-compiler/help/topic/lib.20std.20tests.20fail.20locally.html">lib std tests fail locally</a></h3>

<hr>

<base href="https://rust-lang.zulipchat.com">

<head><link href="https://zulip-archive.rust-lang.org/style.css" rel="stylesheet"></head>

<a name="272245158"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/182449-t-compiler/help/topic/lib%20std%20tests%20fail%20locally/near/272245158" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> lyinch <a href="https://zulip-archive.rust-lang.org/stream/182449-t-compiler/help/topic/lib.20std.20tests.20fail.20locally.html#272245158">(Feb 17 2022 at 11:21)</a>:</h4>
<p>Hello, I wanted to work on an open issue in lib/std but the tests are failing on my machine (macos M1 12.1) . I'm not sure what I did wrong, this is my first time working on internals</p>
<div class="codehilite"><pre><span></span><code>./x.py test library/std
Updating only changed submodules
  Submodules updated in 0.03 seconds
Building rustbuild
    Finished dev [unoptimized] target(s) in 0.07s
Building stage0 std artifacts (aarch64-apple-darwin -&gt; aarch64-apple-darwin)
    Finished release [optimized] target(s) in 0.07s
Copying stage0 std from stage0 (aarch64-apple-darwin -&gt; aarch64-apple-darwin / aarch64-apple-darwin)
Testing std stage0 (aarch64-apple-darwin -&gt; aarch64-apple-darwin)
    Finished release [optimized] target(s) in 0.07s
     Running unittests (build/aarch64-apple-darwin/stage0-std/aarch64-apple-darwin/release/deps/std-1620871dcb41dc2f)

running 920 tests
.................................................................................................... 100/920
.................................................................................................... 200/920
..................................................................i...........................thread &#39;&lt;unnamed&gt;&#39; panicked at &#39;explicit panic&#39;, library/std/src/io/buffered/tests.rs:495:13
...... 300/920
.....................................................................thread &#39;&lt;unnamed&gt;&#39; panicked at &#39;explicit panic&#39;, library/std/src/io/stdio/tests.rs.:37:9
.............................. 400/920
.................................................................................................... 500/920
.................................................................................................... 600/920
.............................................................thread &#39;&lt;unnamed&gt;&#39; panicked at &#39;called `Result::unwrap()` on an `Err` value: RecvError&#39;, library/std/src/sync/mpsc/sync_tests.rs:346:28
....thread &#39;&lt;unnamed&gt;&#39; panicked at &#39;called `Result::unwrap()` on an `Err` value: RecvError&#39;, library/std/src/sync/mpsc/sync_tests.rs:383:27
thread &#39;&lt;unnamed&gt;&#39; panicked at &#39;called `Result::unwrap()` on an `Err` value: SendError { .. }&#39;, library/std/src/sync/mpsc/sync_tests.rs:371:24
.......thread &#39;&lt;unnamed&gt;&#39; panicked at &#39;called `Result::unwrap()` on an `Err` value: RecvError&#39;, library/std/src/sync/mpsc/sync_tests.rs:250:19
............................ 700/920
..............thread &#39;&lt;unnamed&gt;&#39; panicked at &#39;called `Result::unwrap()` on an `Err` value: RecvError&#39;, library/std/src/sync/mpsc/tests.rs:322:28
....thread &#39;&lt;unnamed&gt;&#39; panicked at &#39;called `Result::unwrap()` on an `Err` value: SendError { .. }&#39;, library/std/src/sync/mpsc/tests.rs:347:24
thread &#39;&lt;unnamed&gt;&#39; panicked at &#39;called `Result::unwrap()` on an `Err` value: RecvError&#39;, library/std/src/sync/mpsc/tests.rs:359:27
.......thread &#39;&lt;unnamed&gt;&#39; panicked at &#39;called `Result::unwrap()` on an `Err` value: RecvError&#39;, library/std/src/sync/mpsc/tests.rs:241:19
...................................^C
Build completed unsuccessfully in 0:00:02
</code></pre></div>
<div class="codehilite"><pre><span></span><code>git status
On branch master
Your branch is up to date with &#39;origin/master&#39;.

nothing to commit, working tree clean
</code></pre></div>
<div class="codehilite"><pre><span></span><code>./x.py check
Updating only changed submodules
  Submodules updated in 0.03 seconds
Building rustbuild
    Finished dev [unoptimized] target(s) in 0.07s
Checking stage0 std artifacts (aarch64-apple-darwin -&gt; aarch64-apple-darwin)
    Finished release [optimized] target(s) in 0.08s
Checking stage0 std test/bench/example targets (aarch64-apple-darwin -&gt; aarch64-apple-darwin)
    Finished release [optimized] target(s) in 0.07s
Checking stage0 compiler artifacts (aarch64-apple-darwin -&gt; aarch64-apple-darwin)
    Finished release [optimized] target(s) in 0.13s
Checking stage0 rustdoc artifacts (aarch64-apple-darwin -&gt; aarch64-apple-darwin)
    Finished release [optimized] target(s) in 0.08s
Checking stage0 cranelift artifacts (aarch64-apple-darwin -&gt; aarch64-apple-darwin)
    Finished release [optimized] target(s) in 0.01s
Checking stage0 gcc artifacts (aarch64-apple-darwin -&gt; aarch64-apple-darwin)
    Finished release [optimized] target(s) in 0.00s
Checking stage0 clippy artifacts (aarch64-apple-darwin -&gt; aarch64-apple-darwin)
    Finished release [optimized] target(s) in 0.10s
Checking stage0 rustfmt artifacts (aarch64-apple-darwin -&gt; aarch64-apple-darwin)
    Finished release [optimized] target(s) in 0.09s
Build completed successfully in 0:00:01
</code></pre></div>



<a name="272245697"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/182449-t-compiler/help/topic/lib%20std%20tests%20fail%20locally/near/272245697" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> bjorn3 <a href="https://zulip-archive.rust-lang.org/stream/182449-t-compiler/help/topic/lib.20std.20tests.20fail.20locally.html#272245697">(Feb 17 2022 at 11:26)</a>:</h4>
<p>Those panics are expected. The tests check that various things still work correctly in the presence of panics. <a href="https://github.com/rust-lang/rust/blob/930fc4f59ddeb9f26d554a2c75c5355989189540/library/std/src/io/buffered/tests.rs#L508">https://github.com/rust-lang/rust/blob/930fc4f59ddeb9f26d554a2c75c5355989189540/library/std/src/io/buffered/tests.rs#L508</a> If you let the test process finish, it should say that all tests passed.</p>



<hr><p>Last updated: Apr 12 2022 at 20:01 UTC</p>
</html>