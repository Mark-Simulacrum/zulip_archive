<html>
<head><meta charset="utf-8"><title>Why are my native rustlibs missing for a cross-compile? · t-compiler/help · Zulip Chat Archive</title></head>
<h2>Stream: <a href="https://rust-lang.github.io/zulip_archive/stream/182449-t-compiler/help/index.html">t-compiler/help</a></h2>
<h3>Topic: <a href="https://rust-lang.github.io/zulip_archive/stream/182449-t-compiler/help/topic/Why.20are.20my.20native.20rustlibs.20missing.20for.20a.20cross-compile.3F.html">Why are my native rustlibs missing for a cross-compile?</a></h3>

<hr>

<base href="https://rust-lang.zulipchat.com">

<head><link href="https://rust-lang.github.io/zulip_archive/style.css" rel="stylesheet"></head>

<a name="202896868"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/182449-t-compiler/help/topic/Why%20are%20my%20native%20rustlibs%20missing%20for%20a%20cross-compile%3F/near/202896868" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jake Goulding <a href="https://rust-lang.github.io/zulip_archive/stream/182449-t-compiler/help/topic/Why.20are.20my.20native.20rustlibs.20missing.20for.20a.20cross-compile.3F.html#202896868">(Jul 05 2020 at 00:03)</a>:</h4>
<p>When cross-compiling from x86_64 to aarch64, the native <code>rustlib</code> directory is empty in the target compiler. However, my x86_64 compiler has the rustlibs for the _target_:</p>
<div class="codehilite"><pre><span></span><code>% ls build/aarch64-apple-darwin/stage1/lib/rustlib/aarch64-apple-darwin/lib | cat
libLLVM.dylib

% ls build/x86_64-apple-darwin/stage1/lib/rustlib/aarch64-apple-darwin/lib | cat
liballoc-bc1bed71af59030d.rlib
libbacktrace-908ce5b600cbb5e4.rlib
libbacktrace_sys-73640f972bd0168e.rlib
libcfg_if-ed32d5eef52668e4.rlib
libcompiler_builtins-48b6ebeb945f7f23.rlib
libcore-eae2616245cf1435.rlib
libgetopts-4868046cc68f6a07.rlib
libhashbrown-4019ac1df1726b61.rlib
liblibc-147e2bbc2c8920b5.rlib
libpanic_abort-2d6d15cfb868ff37.rlib
libpanic_unwind-5fba9238dd90a238.rlib
libproc_macro-7b75bc3478afb07d.rlib
librustc_demangle-022c7d6aca3d2ccc.rlib
librustc_std_workspace_alloc-322b374d69dcba49.rlib
librustc_std_workspace_core-3322a8e8a27ca844.rlib
librustc_std_workspace_std-12218c207bcf61af.rlib
libstd-6247a4aa0eaf3fee.dylib
libstd-6247a4aa0eaf3fee.rlib
libterm-fe16d30007d35333.rlib
libtest-23728a41e0e6f04a.dylib
libtest-23728a41e0e6f04a.rlib
libunicode_width-e2337f69b5becf1b.rlib
libunwind-65eb1f72892d4a26.rlib
self-contained
</code></pre></div>



<a name="202896910"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/182449-t-compiler/help/topic/Why%20are%20my%20native%20rustlibs%20missing%20for%20a%20cross-compile%3F/near/202896910" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jake Goulding <a href="https://rust-lang.github.io/zulip_archive/stream/182449-t-compiler/help/topic/Why.20are.20my.20native.20rustlibs.20missing.20for.20a.20cross-compile.3F.html#202896910">(Jul 05 2020 at 00:04)</a>:</h4>
<p>Is this "normal" for a cross-compile? Did I do something wrong?</p>



<a name="202904924"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/182449-t-compiler/help/topic/Why%20are%20my%20native%20rustlibs%20missing%20for%20a%20cross-compile%3F/near/202904924" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> eddyb <a href="https://rust-lang.github.io/zulip_archive/stream/182449-t-compiler/help/topic/Why.20are.20my.20native.20rustlibs.20missing.20for.20a.20cross-compile.3F.html#202904924">(Jul 05 2020 at 04:37)</a>:</h4>
<p>probably. there are 3 triples: "target", "host" and "build"</p>



<a name="202904925"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/182449-t-compiler/help/topic/Why%20are%20my%20native%20rustlibs%20missing%20for%20a%20cross-compile%3F/near/202904925" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> eddyb <a href="https://rust-lang.github.io/zulip_archive/stream/182449-t-compiler/help/topic/Why.20are.20my.20native.20rustlibs.20missing.20for.20a.20cross-compile.3F.html#202904925">(Jul 05 2020 at 04:37)</a>:</h4>
<p>I can never remember what the "host" vs "build" distinction is</p>



<a name="202904966"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/182449-t-compiler/help/topic/Why%20are%20my%20native%20rustlibs%20missing%20for%20a%20cross-compile%3F/near/202904966" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> eddyb <a href="https://rust-lang.github.io/zulip_archive/stream/182449-t-compiler/help/topic/Why.20are.20my.20native.20rustlibs.20missing.20for.20a.20cross-compile.3F.html#202904966">(Jul 05 2020 at 04:38)</a>:</h4>
<p>but AFAIK you use <code>--target</code> to get cross-compilation stdlib</p>



<a name="202904973"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/182449-t-compiler/help/topic/Why%20are%20my%20native%20rustlibs%20missing%20for%20a%20cross-compile%3F/near/202904973" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> eddyb <a href="https://rust-lang.github.io/zulip_archive/stream/182449-t-compiler/help/topic/Why.20are.20my.20native.20rustlibs.20missing.20for.20a.20cross-compile.3F.html#202904973">(Jul 05 2020 at 04:39)</a>:</h4>
<p><span class="user-mention" data-user-id="116155">@Jake Goulding</span> actually, wait, I misread, why would <code>build/aarch64-apple-darwin</code> exist/work?</p>



<a name="202904976"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/182449-t-compiler/help/topic/Why%20are%20my%20native%20rustlibs%20missing%20for%20a%20cross-compile%3F/near/202904976" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> André Arko <a href="https://rust-lang.github.io/zulip_archive/stream/182449-t-compiler/help/topic/Why.20are.20my.20native.20rustlibs.20missing.20for.20a.20cross-compile.3F.html#202904976">(Jul 05 2020 at 04:39)</a>:</h4>
<p>it was in the host array, I think</p>



<a name="202904978"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/182449-t-compiler/help/topic/Why%20are%20my%20native%20rustlibs%20missing%20for%20a%20cross-compile%3F/near/202904978" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> eddyb <a href="https://rust-lang.github.io/zulip_archive/stream/182449-t-compiler/help/topic/Why.20are.20my.20native.20rustlibs.20missing.20for.20a.20cross-compile.3F.html#202904978">(Jul 05 2020 at 04:39)</a>:</h4>
<p>unless you can execute <code>aarch64-apple-darwin</code> binaries, that directory shouldn't make sense I don't think?</p>



<a name="202904979"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/182449-t-compiler/help/topic/Why%20are%20my%20native%20rustlibs%20missing%20for%20a%20cross-compile%3F/near/202904979" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> André Arko <a href="https://rust-lang.github.io/zulip_archive/stream/182449-t-compiler/help/topic/Why.20are.20my.20native.20rustlibs.20missing.20for.20a.20cross-compile.3F.html#202904979">(Jul 05 2020 at 04:39)</a>:</h4>
<p>we can</p>



<a name="202905026"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/182449-t-compiler/help/topic/Why%20are%20my%20native%20rustlibs%20missing%20for%20a%20cross-compile%3F/near/202905026" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> eddyb <a href="https://rust-lang.github.io/zulip_archive/stream/182449-t-compiler/help/topic/Why.20are.20my.20native.20rustlibs.20missing.20for.20a.20cross-compile.3F.html#202905026">(Jul 05 2020 at 04:40)</a>:</h4>
<p>is this using the OS-level emulation layer thing?</p>



<a name="202905033"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/182449-t-compiler/help/topic/Why%20are%20my%20native%20rustlibs%20missing%20for%20a%20cross-compile%3F/near/202905033" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> André Arko <a href="https://rust-lang.github.io/zulip_archive/stream/182449-t-compiler/help/topic/Why.20are.20my.20native.20rustlibs.20missing.20for.20a.20cross-compile.3F.html#202905033">(Jul 05 2020 at 04:40)</a>:</h4>
<p>no, I have physical arm64 macOS hardware</p>



<a name="202905035"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/182449-t-compiler/help/topic/Why%20are%20my%20native%20rustlibs%20missing%20for%20a%20cross-compile%3F/near/202905035" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> André Arko <a href="https://rust-lang.github.io/zulip_archive/stream/182449-t-compiler/help/topic/Why.20are.20my.20native.20rustlibs.20missing.20for.20a.20cross-compile.3F.html#202905035">(Jul 05 2020 at 04:40)</a>:</h4>
<p>and that build above produces a <code>rustc</code> that works, but complains about a missing libstd</p>



<a name="202905037"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/182449-t-compiler/help/topic/Why%20are%20my%20native%20rustlibs%20missing%20for%20a%20cross-compile%3F/near/202905037" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> eddyb <a href="https://rust-lang.github.io/zulip_archive/stream/182449-t-compiler/help/topic/Why.20are.20my.20native.20rustlibs.20missing.20for.20a.20cross-compile.3F.html#202905037">(Jul 05 2020 at 04:41)</a>:</h4>
<p>I am talking about a system that can execute both <code>aarch64-apple-darwin</code> and <code>x86_64-apple-darwin</code></p>



<a name="202905041"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/182449-t-compiler/help/topic/Why%20are%20my%20native%20rustlibs%20missing%20for%20a%20cross-compile%3F/near/202905041" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> André Arko <a href="https://rust-lang.github.io/zulip_archive/stream/182449-t-compiler/help/topic/Why.20are.20my.20native.20rustlibs.20missing.20for.20a.20cross-compile.3F.html#202905041">(Jul 05 2020 at 04:41)</a>:</h4>
<p>oh I see, yes, the physical hardware can execute both</p>



<a name="202905043"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/182449-t-compiler/help/topic/Why%20are%20my%20native%20rustlibs%20missing%20for%20a%20cross-compile%3F/near/202905043" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> eddyb <a href="https://rust-lang.github.io/zulip_archive/stream/182449-t-compiler/help/topic/Why.20are.20my.20native.20rustlibs.20missing.20for.20a.20cross-compile.3F.html#202905043">(Jul 05 2020 at 04:41)</a>:</h4>
<p>AFAIK that's the only reason to have both under <code>./build/</code></p>



<a name="202905050"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/182449-t-compiler/help/topic/Why%20are%20my%20native%20rustlibs%20missing%20for%20a%20cross-compile%3F/near/202905050" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> André Arko <a href="https://rust-lang.github.io/zulip_archive/stream/182449-t-compiler/help/topic/Why.20are.20my.20native.20rustlibs.20missing.20for.20a.20cross-compile.3F.html#202905050">(Jul 05 2020 at 04:41)</a>:</h4>
<p>so what's the right way to cross-compile from x86_64 to aarch64 then?</p>



<a name="202905051"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/182449-t-compiler/help/topic/Why%20are%20my%20native%20rustlibs%20missing%20for%20a%20cross-compile%3F/near/202905051" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> eddyb <a href="https://rust-lang.github.io/zulip_archive/stream/182449-t-compiler/help/topic/Why.20are.20my.20native.20rustlibs.20missing.20for.20a.20cross-compile.3F.html#202905051">(Jul 05 2020 at 04:41)</a>:</h4>
<p><span class="user-mention" data-user-id="317220">@André Arko</span> the hardware you're building Rust on?</p>



<a name="202905094"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/182449-t-compiler/help/topic/Why%20are%20my%20native%20rustlibs%20missing%20for%20a%20cross-compile%3F/near/202905094" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> eddyb <a href="https://rust-lang.github.io/zulip_archive/stream/182449-t-compiler/help/topic/Why.20are.20my.20native.20rustlibs.20missing.20for.20a.20cross-compile.3F.html#202905094">(Jul 05 2020 at 04:42)</a>:</h4>
<p>which one is the native and which one is it emulating?</p>



<a name="202905097"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/182449-t-compiler/help/topic/Why%20are%20my%20native%20rustlibs%20missing%20for%20a%20cross-compile%3F/near/202905097" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> André Arko <a href="https://rust-lang.github.io/zulip_archive/stream/182449-t-compiler/help/topic/Why.20are.20my.20native.20rustlibs.20missing.20for.20a.20cross-compile.3F.html#202905097">(Jul 05 2020 at 04:42)</a>:</h4>
<p>okay let me back up :)</p>



<a name="202905099"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/182449-t-compiler/help/topic/Why%20are%20my%20native%20rustlibs%20missing%20for%20a%20cross-compile%3F/near/202905099" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> André Arko <a href="https://rust-lang.github.io/zulip_archive/stream/182449-t-compiler/help/topic/Why.20are.20my.20native.20rustlibs.20missing.20for.20a.20cross-compile.3F.html#202905099">(Jul 05 2020 at 04:42)</a>:</h4>
<p>I have 1 intel x86_64 macOS machine, and 1 apple arm64 macOS machine</p>



<a name="202905102"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/182449-t-compiler/help/topic/Why%20are%20my%20native%20rustlibs%20missing%20for%20a%20cross-compile%3F/near/202905102" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> eddyb <a href="https://rust-lang.github.io/zulip_archive/stream/182449-t-compiler/help/topic/Why.20are.20my.20native.20rustlibs.20missing.20for.20a.20cross-compile.3F.html#202905102">(Jul 05 2020 at 04:43)</a>:</h4>
<p>to be clear: I'm asking about the machine that has both directories under <code>./build/</code></p>



<a name="202905104"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/182449-t-compiler/help/topic/Why%20are%20my%20native%20rustlibs%20missing%20for%20a%20cross-compile%3F/near/202905104" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> eddyb <a href="https://rust-lang.github.io/zulip_archive/stream/182449-t-compiler/help/topic/Why.20are.20my.20native.20rustlibs.20missing.20for.20a.20cross-compile.3F.html#202905104">(Jul 05 2020 at 04:43)</a>:</h4>
<p>no other machine</p>



<a name="202905110"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/182449-t-compiler/help/topic/Why%20are%20my%20native%20rustlibs%20missing%20for%20a%20cross-compile%3F/near/202905110" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> André Arko <a href="https://rust-lang.github.io/zulip_archive/stream/182449-t-compiler/help/topic/Why.20are.20my.20native.20rustlibs.20missing.20for.20a.20cross-compile.3F.html#202905110">(Jul 05 2020 at 04:43)</a>:</h4>
<p>that directory was produced by <span class="user-mention" data-user-id="116155">@Jake Goulding</span>'s x86_64 machine, where he was trying to cross-compile a rustc that would work an arm64</p>



<a name="202905112"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/182449-t-compiler/help/topic/Why%20are%20my%20native%20rustlibs%20missing%20for%20a%20cross-compile%3F/near/202905112" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> André Arko <a href="https://rust-lang.github.io/zulip_archive/stream/182449-t-compiler/help/topic/Why.20are.20my.20native.20rustlibs.20missing.20for.20a.20cross-compile.3F.html#202905112">(Jul 05 2020 at 04:43)</a>:</h4>
<p>he succeeded, the output rustc works when copied to the arm64 hardware</p>



<a name="202905113"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/182449-t-compiler/help/topic/Why%20are%20my%20native%20rustlibs%20missing%20for%20a%20cross-compile%3F/near/202905113" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> eddyb <a href="https://rust-lang.github.io/zulip_archive/stream/182449-t-compiler/help/topic/Why.20are.20my.20native.20rustlibs.20missing.20for.20a.20cross-compile.3F.html#202905113">(Jul 05 2020 at 04:43)</a>:</h4>
<p>can the x86_64 machine <em>run</em> aarch64 executables?</p>



<a name="202905115"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/182449-t-compiler/help/topic/Why%20are%20my%20native%20rustlibs%20missing%20for%20a%20cross-compile%3F/near/202905115" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> André Arko <a href="https://rust-lang.github.io/zulip_archive/stream/182449-t-compiler/help/topic/Why.20are.20my.20native.20rustlibs.20missing.20for.20a.20cross-compile.3F.html#202905115">(Jul 05 2020 at 04:43)</a>:</h4>
<p>no</p>



<a name="202905159"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/182449-t-compiler/help/topic/Why%20are%20my%20native%20rustlibs%20missing%20for%20a%20cross-compile%3F/near/202905159" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> eddyb <a href="https://rust-lang.github.io/zulip_archive/stream/182449-t-compiler/help/topic/Why.20are.20my.20native.20rustlibs.20missing.20for.20a.20cross-compile.3F.html#202905159">(Jul 05 2020 at 04:44)</a>:</h4>
<p>okay then AFAIK <code>build/aarch64-apple-darwin</code> shouldn't exist on that machine</p>



<a name="202905163"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/182449-t-compiler/help/topic/Why%20are%20my%20native%20rustlibs%20missing%20for%20a%20cross-compile%3F/near/202905163" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> André Arko <a href="https://rust-lang.github.io/zulip_archive/stream/182449-t-compiler/help/topic/Why.20are.20my.20native.20rustlibs.20missing.20for.20a.20cross-compile.3F.html#202905163">(Jul 05 2020 at 04:44)</a>:</h4>
<p>the one inside stage1, or the one containing stage1?</p>



<a name="202905166"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/182449-t-compiler/help/topic/Why%20are%20my%20native%20rustlibs%20missing%20for%20a%20cross-compile%3F/near/202905166" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> André Arko <a href="https://rust-lang.github.io/zulip_archive/stream/182449-t-compiler/help/topic/Why.20are.20my.20native.20rustlibs.20missing.20for.20a.20cross-compile.3F.html#202905166">(Jul 05 2020 at 04:44)</a>:</h4>
<p>oh you mean the top level one?</p>



<a name="202905169"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/182449-t-compiler/help/topic/Why%20are%20my%20native%20rustlibs%20missing%20for%20a%20cross-compile%3F/near/202905169" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> eddyb <a href="https://rust-lang.github.io/zulip_archive/stream/182449-t-compiler/help/topic/Why.20are.20my.20native.20rustlibs.20missing.20for.20a.20cross-compile.3F.html#202905169">(Jul 05 2020 at 04:45)</a>:</h4>
<p>yes, that's the one that depends on the hardware you're running on. or at least I haven't seen it any other way</p>



<a name="202905172"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/182449-t-compiler/help/topic/Why%20are%20my%20native%20rustlibs%20missing%20for%20a%20cross-compile%3F/near/202905172" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> André Arko <a href="https://rust-lang.github.io/zulip_archive/stream/182449-t-compiler/help/topic/Why.20are.20my.20native.20rustlibs.20missing.20for.20a.20cross-compile.3F.html#202905172">(Jul 05 2020 at 04:45)</a>:</h4>
<p>...your message is very confusing because the entire point of running the build was to create that directory</p>



<a name="202905177"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/182449-t-compiler/help/topic/Why%20are%20my%20native%20rustlibs%20missing%20for%20a%20cross-compile%3F/near/202905177" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> André Arko <a href="https://rust-lang.github.io/zulip_archive/stream/182449-t-compiler/help/topic/Why.20are.20my.20native.20rustlibs.20missing.20for.20a.20cross-compile.3F.html#202905177">(Jul 05 2020 at 04:45)</a>:</h4>
<p>like, cross compiling an arm64 rustc from x86_64</p>



<a name="202905178"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/182449-t-compiler/help/topic/Why%20are%20my%20native%20rustlibs%20missing%20for%20a%20cross-compile%3F/near/202905178" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> eddyb <a href="https://rust-lang.github.io/zulip_archive/stream/182449-t-compiler/help/topic/Why.20are.20my.20native.20rustlibs.20missing.20for.20a.20cross-compile.3F.html#202905178">(Jul 05 2020 at 04:45)</a>:</h4>
<p>hmmmmmm</p>



<a name="202905179"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/182449-t-compiler/help/topic/Why%20are%20my%20native%20rustlibs%20missing%20for%20a%20cross-compile%3F/near/202905179" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> André Arko <a href="https://rust-lang.github.io/zulip_archive/stream/182449-t-compiler/help/topic/Why.20are.20my.20native.20rustlibs.20missing.20for.20a.20cross-compile.3F.html#202905179">(Jul 05 2020 at 04:45)</a>:</h4>
<p>and it worked, <code>build/aarch64-apple-darwin</code> contained a working rustc at the end</p>



<a name="202905182"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/182449-t-compiler/help/topic/Why%20are%20my%20native%20rustlibs%20missing%20for%20a%20cross-compile%3F/near/202905182" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> eddyb <a href="https://rust-lang.github.io/zulip_archive/stream/182449-t-compiler/help/topic/Why.20are.20my.20native.20rustlibs.20missing.20for.20a.20cross-compile.3F.html#202905182">(Jul 05 2020 at 04:45)</a>:</h4>
<p>oh I see, our buildsystem is even more confusing than I expected</p>



<a name="202905183"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/182449-t-compiler/help/topic/Why%20are%20my%20native%20rustlibs%20missing%20for%20a%20cross-compile%3F/near/202905183" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> André Arko <a href="https://rust-lang.github.io/zulip_archive/stream/182449-t-compiler/help/topic/Why.20are.20my.20native.20rustlibs.20missing.20for.20a.20cross-compile.3F.html#202905183">(Jul 05 2020 at 04:46)</a>:</h4>
<p>but, confusingly, it was missing libstd</p>



<a name="202905225"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/182449-t-compiler/help/topic/Why%20are%20my%20native%20rustlibs%20missing%20for%20a%20cross-compile%3F/near/202905225" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> André Arko <a href="https://rust-lang.github.io/zulip_archive/stream/182449-t-compiler/help/topic/Why.20are.20my.20native.20rustlibs.20missing.20for.20a.20cross-compile.3F.html#202905225">(Jul 05 2020 at 04:46)</a>:</h4>
<p>unlike the x86_64 directory, which was not missing libstd</p>



<a name="202905233"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/182449-t-compiler/help/topic/Why%20are%20my%20native%20rustlibs%20missing%20for%20a%20cross-compile%3F/near/202905233" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> eddyb <a href="https://rust-lang.github.io/zulip_archive/stream/182449-t-compiler/help/topic/Why.20are.20my.20native.20rustlibs.20missing.20for.20a.20cross-compile.3F.html#202905233">(Jul 05 2020 at 04:46)</a>:</h4>
<p>(it can build anything cross-compiled into <code>build/x86_64-apple-darwin</code>, it's just the sysroot that wouldn't make sense)</p>



<a name="202905236"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/182449-t-compiler/help/topic/Why%20are%20my%20native%20rustlibs%20missing%20for%20a%20cross-compile%3F/near/202905236" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> André Arko <a href="https://rust-lang.github.io/zulip_archive/stream/182449-t-compiler/help/topic/Why.20are.20my.20native.20rustlibs.20missing.20for.20a.20cross-compile.3F.html#202905236">(Jul 05 2020 at 04:46)</a>:</h4>
<p>(literally copying the libs from x86_64 to aarch64 made it a full, working rustc, which I have then used to cargo install ripgrep and some other things successfully)</p>



<a name="202905237"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/182449-t-compiler/help/topic/Why%20are%20my%20native%20rustlibs%20missing%20for%20a%20cross-compile%3F/near/202905237" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> André Arko <a href="https://rust-lang.github.io/zulip_archive/stream/182449-t-compiler/help/topic/Why.20are.20my.20native.20rustlibs.20missing.20for.20a.20cross-compile.3F.html#202905237">(Jul 05 2020 at 04:47)</a>:</h4>
<p>huh okay</p>



<a name="202905247"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/182449-t-compiler/help/topic/Why%20are%20my%20native%20rustlibs%20missing%20for%20a%20cross-compile%3F/near/202905247" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> André Arko <a href="https://rust-lang.github.io/zulip_archive/stream/182449-t-compiler/help/topic/Why.20are.20my.20native.20rustlibs.20missing.20for.20a.20cross-compile.3F.html#202905247">(Jul 05 2020 at 04:47)</a>:</h4>
<p>in that case, what would be the "right" way to do that?</p>



<a name="202905297"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/182449-t-compiler/help/topic/Why%20are%20my%20native%20rustlibs%20missing%20for%20a%20cross-compile%3F/near/202905297" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> eddyb <a href="https://rust-lang.github.io/zulip_archive/stream/182449-t-compiler/help/topic/Why.20are.20my.20native.20rustlibs.20missing.20for.20a.20cross-compile.3F.html#202905297">(Jul 05 2020 at 04:48)</a>:</h4>
<p>not sure. to expand a bit, we have <code>build/$tripleX/stage0-rustc/release/</code> and <code>build/$tripleX/stage0-rustc/$tripleY/release/</code></p>



<a name="202905301"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/182449-t-compiler/help/topic/Why%20are%20my%20native%20rustlibs%20missing%20for%20a%20cross-compile%3F/near/202905301" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> eddyb <a href="https://rust-lang.github.io/zulip_archive/stream/182449-t-compiler/help/topic/Why.20are.20my.20native.20rustlibs.20missing.20for.20a.20cross-compile.3F.html#202905301">(Jul 05 2020 at 04:48)</a>:</h4>
<p>the former will contain things like build scripts and proc macros, that have to <em>run</em> on the same hardware that's doing the build</p>



<a name="202905304"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/182449-t-compiler/help/topic/Why%20are%20my%20native%20rustlibs%20missing%20for%20a%20cross-compile%3F/near/202905304" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> eddyb <a href="https://rust-lang.github.io/zulip_archive/stream/182449-t-compiler/help/topic/Why.20are.20my.20native.20rustlibs.20missing.20for.20a.20cross-compile.3F.html#202905304">(Jul 05 2020 at 04:49)</a>:</h4>
<p>while the latter will contain cross-compilation artifacts</p>



<a name="202905308"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/182449-t-compiler/help/topic/Why%20are%20my%20native%20rustlibs%20missing%20for%20a%20cross-compile%3F/near/202905308" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> eddyb <a href="https://rust-lang.github.io/zulip_archive/stream/182449-t-compiler/help/topic/Why.20are.20my.20native.20rustlibs.20missing.20for.20a.20cross-compile.3F.html#202905308">(Jul 05 2020 at 04:49)</a>:</h4>
<p>and I'm not even sure <code>$tripleX</code> <em>matters</em> for those</p>



<a name="202905310"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/182449-t-compiler/help/topic/Why%20are%20my%20native%20rustlibs%20missing%20for%20a%20cross-compile%3F/near/202905310" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> André Arko <a href="https://rust-lang.github.io/zulip_archive/stream/182449-t-compiler/help/topic/Why.20are.20my.20native.20rustlibs.20missing.20for.20a.20cross-compile.3F.html#202905310">(Jul 05 2020 at 04:49)</a>:</h4>
<p>ah ok, interesting</p>



<a name="202905312"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/182449-t-compiler/help/topic/Why%20are%20my%20native%20rustlibs%20missing%20for%20a%20cross-compile%3F/near/202905312" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> eddyb <a href="https://rust-lang.github.io/zulip_archive/stream/182449-t-compiler/help/topic/Why.20are.20my.20native.20rustlibs.20missing.20for.20a.20cross-compile.3F.html#202905312">(Jul 05 2020 at 04:49)</a>:</h4>
<p>(meaning we might be able to simplify our directory structure. not sure though)</p>



<a name="202905316"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/182449-t-compiler/help/topic/Why%20are%20my%20native%20rustlibs%20missing%20for%20a%20cross-compile%3F/near/202905316" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> André Arko <a href="https://rust-lang.github.io/zulip_archive/stream/182449-t-compiler/help/topic/Why.20are.20my.20native.20rustlibs.20missing.20for.20a.20cross-compile.3F.html#202905316">(Jul 05 2020 at 04:49)</a>:</h4>
<p>so (iirc) the configuration was <code>build="x86_64-apple-darwin"</code> and <code>host=["aarch64-apple-darwin"]</code></p>



<a name="202905359"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/182449-t-compiler/help/topic/Why%20are%20my%20native%20rustlibs%20missing%20for%20a%20cross-compile%3F/near/202905359" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> eddyb <a href="https://rust-lang.github.io/zulip_archive/stream/182449-t-compiler/help/topic/Why.20are.20my.20native.20rustlibs.20missing.20for.20a.20cross-compile.3F.html#202905359">(Jul 05 2020 at 04:50)</a>:</h4>
<p><em>however</em>, what you are talking about is the sysroots, e.g. <code>build/$tripleX/stage1</code> (which has <code>bin/rustc</code> and <code>lib/rustlib/$tripleZ</code> etc.)</p>



<a name="202905368"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/182449-t-compiler/help/topic/Why%20are%20my%20native%20rustlibs%20missing%20for%20a%20cross-compile%3F/near/202905368" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> eddyb <a href="https://rust-lang.github.io/zulip_archive/stream/182449-t-compiler/help/topic/Why.20are.20my.20native.20rustlibs.20missing.20for.20a.20cross-compile.3F.html#202905368">(Jul 05 2020 at 04:50)</a>:</h4>
<p>that's what I was missing at first, those don't have more than <code>$tripleX</code> for the binaries</p>



<a name="202905374"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/182449-t-compiler/help/topic/Why%20are%20my%20native%20rustlibs%20missing%20for%20a%20cross-compile%3F/near/202905374" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> André Arko <a href="https://rust-lang.github.io/zulip_archive/stream/182449-t-compiler/help/topic/Why.20are.20my.20native.20rustlibs.20missing.20for.20a.20cross-compile.3F.html#202905374">(Jul 05 2020 at 04:51)</a>:</h4>
<p>ahh, yes that seems right</p>



<a name="202905380"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/182449-t-compiler/help/topic/Why%20are%20my%20native%20rustlibs%20missing%20for%20a%20cross-compile%3F/near/202905380" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> eddyb <a href="https://rust-lang.github.io/zulip_archive/stream/182449-t-compiler/help/topic/Why.20are.20my.20native.20rustlibs.20missing.20for.20a.20cross-compile.3F.html#202905380">(Jul 05 2020 at 04:51)</a>:</h4>
<p><span class="user-mention" data-user-id="317220">@André Arko</span> <span class="user-mention" data-user-id="116155">@Jake Goulding</span> okay now that I'm not (as) confused... did you copy directories from <code>build/</code> or try to use installing into a temporary directory?</p>



<a name="202905424"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/182449-t-compiler/help/topic/Why%20are%20my%20native%20rustlibs%20missing%20for%20a%20cross-compile%3F/near/202905424" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> eddyb <a href="https://rust-lang.github.io/zulip_archive/stream/182449-t-compiler/help/topic/Why.20are.20my.20native.20rustlibs.20missing.20for.20a.20cross-compile.3F.html#202905424">(Jul 05 2020 at 04:52)</a>:</h4>
<p>the former is not really supported</p>



<a name="202905432"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/182449-t-compiler/help/topic/Why%20are%20my%20native%20rustlibs%20missing%20for%20a%20cross-compile%3F/near/202905432" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> eddyb <a href="https://rust-lang.github.io/zulip_archive/stream/182449-t-compiler/help/topic/Why.20are.20my.20native.20rustlibs.20missing.20for.20a.20cross-compile.3F.html#202905432">(Jul 05 2020 at 04:52)</a>:</h4>
<p>except for <code>rustup toolchain link</code> and that's for non-cross-compiled <code>rustc</code> anyway</p>



<a name="202905444"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/182449-t-compiler/help/topic/Why%20are%20my%20native%20rustlibs%20missing%20for%20a%20cross-compile%3F/near/202905444" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> eddyb <a href="https://rust-lang.github.io/zulip_archive/stream/182449-t-compiler/help/topic/Why.20are.20my.20native.20rustlibs.20missing.20for.20a.20cross-compile.3F.html#202905444">(Jul 05 2020 at 04:53)</a>:</h4>
<p>I think you need something like <code>DESTDIR=some/empty/dir ./x.py install</code></p>



<a name="202905452"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/182449-t-compiler/help/topic/Why%20are%20my%20native%20rustlibs%20missing%20for%20a%20cross-compile%3F/near/202905452" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> eddyb <a href="https://rust-lang.github.io/zulip_archive/stream/182449-t-compiler/help/topic/Why.20are.20my.20native.20rustlibs.20missing.20for.20a.20cross-compile.3F.html#202905452">(Jul 05 2020 at 04:53)</a>:</h4>
<p>and then <em>that</em> directory should contain <code>bin</code>, <code>lib</code>, <code>etc</code>, etc.</p>



<a name="202905458"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/182449-t-compiler/help/topic/Why%20are%20my%20native%20rustlibs%20missing%20for%20a%20cross-compile%3F/near/202905458" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> André Arko <a href="https://rust-lang.github.io/zulip_archive/stream/182449-t-compiler/help/topic/Why.20are.20my.20native.20rustlibs.20missing.20for.20a.20cross-compile.3F.html#202905458">(Jul 05 2020 at 04:53)</a>:</h4>
<p>ahh, okay. I didn't see anything in the rustc book that explained that, but maybe I missed it</p>



<a name="202905459"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/182449-t-compiler/help/topic/Why%20are%20my%20native%20rustlibs%20missing%20for%20a%20cross-compile%3F/near/202905459" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> André Arko <a href="https://rust-lang.github.io/zulip_archive/stream/182449-t-compiler/help/topic/Why.20are.20my.20native.20rustlibs.20missing.20for.20a.20cross-compile.3F.html#202905459">(Jul 05 2020 at 04:53)</a>:</h4>
<p>I was confused about why everything seemed so scattered in <code>build/</code> :)</p>



<a name="202905462"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/182449-t-compiler/help/topic/Why%20are%20my%20native%20rustlibs%20missing%20for%20a%20cross-compile%3F/near/202905462" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> eddyb <a href="https://rust-lang.github.io/zulip_archive/stream/182449-t-compiler/help/topic/Why.20are.20my.20native.20rustlibs.20missing.20for.20a.20cross-compile.3F.html#202905462">(Jul 05 2020 at 04:54)</a>:</h4>
<p>yeah you're not supposed to poke around in there</p>



<a name="202905501"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/182449-t-compiler/help/topic/Why%20are%20my%20native%20rustlibs%20missing%20for%20a%20cross-compile%3F/near/202905501" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> eddyb <a href="https://rust-lang.github.io/zulip_archive/stream/182449-t-compiler/help/topic/Why.20are.20my.20native.20rustlibs.20missing.20for.20a.20cross-compile.3F.html#202905501">(Jul 05 2020 at 04:54)</a>:</h4>
<p>I guess this is just <code>./configure &amp;&amp; make install</code> tbh</p>



<a name="202905508"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/182449-t-compiler/help/topic/Why%20are%20my%20native%20rustlibs%20missing%20for%20a%20cross-compile%3F/near/202905508" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> eddyb <a href="https://rust-lang.github.io/zulip_archive/stream/182449-t-compiler/help/topic/Why.20are.20my.20native.20rustlibs.20missing.20for.20a.20cross-compile.3F.html#202905508">(Jul 05 2020 at 04:54)</a>:</h4>
<p>that's where the <code>DESTDIR</code> env var convention comes from</p>



<a name="202905511"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/182449-t-compiler/help/topic/Why%20are%20my%20native%20rustlibs%20missing%20for%20a%20cross-compile%3F/near/202905511" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> eddyb <a href="https://rust-lang.github.io/zulip_archive/stream/182449-t-compiler/help/topic/Why.20are.20my.20native.20rustlibs.20missing.20for.20a.20cross-compile.3F.html#202905511">(Jul 05 2020 at 04:54)</a>:</h4>
<p>this is how distros (are supposed to) build rustc</p>



<a name="202905524"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/182449-t-compiler/help/topic/Why%20are%20my%20native%20rustlibs%20missing%20for%20a%20cross-compile%3F/near/202905524" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> André Arko <a href="https://rust-lang.github.io/zulip_archive/stream/182449-t-compiler/help/topic/Why.20are.20my.20native.20rustlibs.20missing.20for.20a.20cross-compile.3F.html#202905524">(Jul 05 2020 at 04:55)</a>:</h4>
<p>got it, I'm not familiar with DESTDIR (only ./configure --prefix) so that didn't occur to me</p>



<a name="202905530"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/182449-t-compiler/help/topic/Why%20are%20my%20native%20rustlibs%20missing%20for%20a%20cross-compile%3F/near/202905530" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> André Arko <a href="https://rust-lang.github.io/zulip_archive/stream/182449-t-compiler/help/topic/Why.20are.20my.20native.20rustlibs.20missing.20for.20a.20cross-compile.3F.html#202905530">(Jul 05 2020 at 04:55)</a>:</h4>
<p>we also had the small intermediate problem of needing to edit rustc, build a new one, and use that one to run the cross-compile build</p>



<a name="202905534"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/182449-t-compiler/help/topic/Why%20are%20my%20native%20rustlibs%20missing%20for%20a%20cross-compile%3F/near/202905534" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> eddyb <a href="https://rust-lang.github.io/zulip_archive/stream/182449-t-compiler/help/topic/Why.20are.20my.20native.20rustlibs.20missing.20for.20a.20cross-compile.3F.html#202905534">(Jul 05 2020 at 04:56)</a>:</h4>
<p><code>--prefix</code> is where you'll install stuff (so <code>/usr</code> typically), <code>DESTDIR</code> is whatever dir to dump the actual files in</p>



<a name="202905573"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/182449-t-compiler/help/topic/Why%20are%20my%20native%20rustlibs%20missing%20for%20a%20cross-compile%3F/near/202905573" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> eddyb <a href="https://rust-lang.github.io/zulip_archive/stream/182449-t-compiler/help/topic/Why.20are.20my.20native.20rustlibs.20missing.20for.20a.20cross-compile.3F.html#202905573">(Jul 05 2020 at 04:56)</a>:</h4>
<p>that the packager will put into a <code>rpm</code>, <code>deb</code>, etc.</p>



<a name="202905576"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/182449-t-compiler/help/topic/Why%20are%20my%20native%20rustlibs%20missing%20for%20a%20cross-compile%3F/near/202905576" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> André Arko <a href="https://rust-lang.github.io/zulip_archive/stream/182449-t-compiler/help/topic/Why.20are.20my.20native.20rustlibs.20missing.20for.20a.20cross-compile.3F.html#202905576">(Jul 05 2020 at 04:56)</a>:</h4>
<p>got it</p>



<a name="202905578"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/182449-t-compiler/help/topic/Why%20are%20my%20native%20rustlibs%20missing%20for%20a%20cross-compile%3F/near/202905578" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> André Arko <a href="https://rust-lang.github.io/zulip_archive/stream/182449-t-compiler/help/topic/Why.20are.20my.20native.20rustlibs.20missing.20for.20a.20cross-compile.3F.html#202905578">(Jul 05 2020 at 04:56)</a>:</h4>
<p>thanks, this is helpful</p>



<a name="202905580"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/182449-t-compiler/help/topic/Why%20are%20my%20native%20rustlibs%20missing%20for%20a%20cross-compile%3F/near/202905580" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> eddyb <a href="https://rust-lang.github.io/zulip_archive/stream/182449-t-compiler/help/topic/Why.20are.20my.20native.20rustlibs.20missing.20for.20a.20cross-compile.3F.html#202905580">(Jul 05 2020 at 04:56)</a>:</h4>
<p>I only learned about it a few months ago, from someone trying to package Rust without using Python (that was... a lot of fun :P)</p>



<a name="202905595"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/182449-t-compiler/help/topic/Why%20are%20my%20native%20rustlibs%20missing%20for%20a%20cross-compile%3F/near/202905595" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> eddyb <a href="https://rust-lang.github.io/zulip_archive/stream/182449-t-compiler/help/topic/Why.20are.20my.20native.20rustlibs.20missing.20for.20a.20cross-compile.3F.html#202905595">(Jul 05 2020 at 04:57)</a>:</h4>
<p>you should also be able to create whatever <code>rustup</code> downloads and install, using... <code>./x.py dist</code> I think?, but presumably that's harder to use than installing into a directory that you then copy over</p>



<a name="202905634"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/182449-t-compiler/help/topic/Why%20are%20my%20native%20rustlibs%20missing%20for%20a%20cross-compile%3F/near/202905634" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> eddyb <a href="https://rust-lang.github.io/zulip_archive/stream/182449-t-compiler/help/topic/Why.20are.20my.20native.20rustlibs.20missing.20for.20a.20cross-compile.3F.html#202905634">(Jul 05 2020 at 04:58)</a>:</h4>
<p><span class="user-mention" data-user-id="317220">@André Arko</span> this seems useful <a href="https://www.gnu.org/prep/standards/html_node/DESTDIR.html">https://www.gnu.org/prep/standards/html_node/DESTDIR.html</a></p>



<a name="202905652"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/182449-t-compiler/help/topic/Why%20are%20my%20native%20rustlibs%20missing%20for%20a%20cross-compile%3F/near/202905652" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> eddyb <a href="https://rust-lang.github.io/zulip_archive/stream/182449-t-compiler/help/topic/Why.20are.20my.20native.20rustlibs.20missing.20for.20a.20cross-compile.3F.html#202905652">(Jul 05 2020 at 04:59)</a>:</h4>
<p>this also mentions <code>DESTDIR</code> <a href="https://www.debian.org/doc/manuals/maint-guide/modify.en.html#destdir">https://www.debian.org/doc/manuals/maint-guide/modify.en.html#destdir</a></p>



<a name="202905653"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/182449-t-compiler/help/topic/Why%20are%20my%20native%20rustlibs%20missing%20for%20a%20cross-compile%3F/near/202905653" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> eddyb <a href="https://rust-lang.github.io/zulip_archive/stream/182449-t-compiler/help/topic/Why.20are.20my.20native.20rustlibs.20missing.20for.20a.20cross-compile.3F.html#202905653">(Jul 05 2020 at 04:59)</a>:</h4>
<p>so yeah it's a common convention</p>



<a name="202905660"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/182449-t-compiler/help/topic/Why%20are%20my%20native%20rustlibs%20missing%20for%20a%20cross-compile%3F/near/202905660" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> André Arko <a href="https://rust-lang.github.io/zulip_archive/stream/182449-t-compiler/help/topic/Why.20are.20my.20native.20rustlibs.20missing.20for.20a.20cross-compile.3F.html#202905660">(Jul 05 2020 at 04:59)</a>:</h4>
<p>yeah, makes sense! I clearly have never built linux distro packages before :)</p>



<a name="202905762"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/182449-t-compiler/help/topic/Why%20are%20my%20native%20rustlibs%20missing%20for%20a%20cross-compile%3F/near/202905762" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> eddyb <a href="https://rust-lang.github.io/zulip_archive/stream/182449-t-compiler/help/topic/Why.20are.20my.20native.20rustlibs.20missing.20for.20a.20cross-compile.3F.html#202905762">(Jul 05 2020 at 05:02)</a>:</h4>
<p><span class="user-mention" data-user-id="116122">@simulacrum</span> what do you think about replacing <code>build/$triple/stage$n-$foo</code> with just <code>build/stage$n-$foo</code>? given that inside each of those, there's <code>$triple/release</code> already for the target, as per Cargo. although maybe this is a half-baked idea</p>



<a name="202905775"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/182449-t-compiler/help/topic/Why%20are%20my%20native%20rustlibs%20missing%20for%20a%20cross-compile%3F/near/202905775" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> eddyb <a href="https://rust-lang.github.io/zulip_archive/stream/182449-t-compiler/help/topic/Why.20are.20my.20native.20rustlibs.20missing.20for.20a.20cross-compile.3F.html#202905775">(Jul 05 2020 at 05:03)</a>:</h4>
<p>maybe <code>build/$triple</code> is for the "build" triple which if you changed, a different beta would be downloaded, right? so it'd make sense to keep the current stratification</p>



<a name="202905819"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/182449-t-compiler/help/topic/Why%20are%20my%20native%20rustlibs%20missing%20for%20a%20cross-compile%3F/near/202905819" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> eddyb <a href="https://rust-lang.github.io/zulip_archive/stream/182449-t-compiler/help/topic/Why.20are.20my.20native.20rustlibs.20missing.20for.20a.20cross-compile.3F.html#202905819">(Jul 05 2020 at 05:04)</a>:</h4>
<p>but then why would this:</p>
<blockquote>
<p>so (iirc) the configuration was <code>build="x86_64-apple-darwin"</code> and <code>host=["aarch64-apple-darwin"]</code></p>
</blockquote>
<p>result in <code>build/aarch64-apple-darwin</code> existing?</p>



<a name="202918102"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/182449-t-compiler/help/topic/Why%20are%20my%20native%20rustlibs%20missing%20for%20a%20cross-compile%3F/near/202918102" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> simulacrum <a href="https://rust-lang.github.io/zulip_archive/stream/182449-t-compiler/help/topic/Why.20are.20my.20native.20rustlibs.20missing.20for.20a.20cross-compile.3F.html#202918102">(Jul 05 2020 at 11:37)</a>:</h4>
<p>Otherwise you'd clobber the stage2/bin/rustc (and everything else in there)</p>



<a name="202919967"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/182449-t-compiler/help/topic/Why%20are%20my%20native%20rustlibs%20missing%20for%20a%20cross-compile%3F/near/202919967" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jake Goulding <a href="https://rust-lang.github.io/zulip_archive/stream/182449-t-compiler/help/topic/Why.20are.20my.20native.20rustlibs.20missing.20for.20a.20cross-compile.3F.html#202919967">(Jul 05 2020 at 12:34)</a>:</h4>
<p><span class="user-mention" data-user-id="116122">@simulacrum</span> maybe the question i should be asking is "what is the right invocation of <code>x.py</code>?"</p>



<a name="202919979"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/182449-t-compiler/help/topic/Why%20are%20my%20native%20rustlibs%20missing%20for%20a%20cross-compile%3F/near/202919979" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> simulacrum <a href="https://rust-lang.github.io/zulip_archive/stream/182449-t-compiler/help/topic/Why.20are.20my.20native.20rustlibs.20missing.20for.20a.20cross-compile.3F.html#202919979">(Jul 05 2020 at 12:34)</a>:</h4>
<p>You're trying to produce a full toolchain, cross-compiling?</p>



<a name="202919990"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/182449-t-compiler/help/topic/Why%20are%20my%20native%20rustlibs%20missing%20for%20a%20cross-compile%3F/near/202919990" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jake Goulding <a href="https://rust-lang.github.io/zulip_archive/stream/182449-t-compiler/help/topic/Why.20are.20my.20native.20rustlibs.20missing.20for.20a.20cross-compile.3F.html#202919990">(Jul 05 2020 at 12:35)</a>:</h4>
<p>Yeah. I have one, but I'm doing copy-pasting of files myself.</p>



<a name="202920041"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/182449-t-compiler/help/topic/Why%20are%20my%20native%20rustlibs%20missing%20for%20a%20cross-compile%3F/near/202920041" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jake Goulding <a href="https://rust-lang.github.io/zulip_archive/stream/182449-t-compiler/help/topic/Why.20are.20my.20native.20rustlibs.20missing.20for.20a.20cross-compile.3F.html#202920041">(Jul 05 2020 at 12:36)</a>:</h4>
<p><a href="https://github.com/shepmaster/rust/blob/silicon-bootstrap/silicon/README.md#copy-the-cross-compiler-to-the-dtk">https://github.com/shepmaster/rust/blob/silicon-bootstrap/silicon/README.md#copy-the-cross-compiler-to-the-dtk</a></p>



<a name="202920050"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/182449-t-compiler/help/topic/Why%20are%20my%20native%20rustlibs%20missing%20for%20a%20cross-compile%3F/near/202920050" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> simulacrum <a href="https://rust-lang.github.io/zulip_archive/stream/182449-t-compiler/help/topic/Why.20are.20my.20native.20rustlibs.20missing.20for.20a.20cross-compile.3F.html#202920050">(Jul 05 2020 at 12:36)</a>:</h4>
<p>I would look at one of the dist builders, say for ppc - IIRC, those cross compile currently so you can likely make use of the same invocation</p>



<a name="202920060"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/182449-t-compiler/help/topic/Why%20are%20my%20native%20rustlibs%20missing%20for%20a%20cross-compile%3F/near/202920060" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> simulacrum <a href="https://rust-lang.github.io/zulip_archive/stream/182449-t-compiler/help/topic/Why.20are.20my.20native.20rustlibs.20missing.20for.20a.20cross-compile.3F.html#202920060">(Jul 05 2020 at 12:37)</a>:</h4>
<p>(swapping dist for build perhaps)</p>



<a name="202920132"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/182449-t-compiler/help/topic/Why%20are%20my%20native%20rustlibs%20missing%20for%20a%20cross-compile%3F/near/202920132" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jake Goulding <a href="https://rust-lang.github.io/zulip_archive/stream/182449-t-compiler/help/topic/Why.20are.20my.20native.20rustlibs.20missing.20for.20a.20cross-compile.3F.html#202920132">(Jul 05 2020 at 12:39)</a>:</h4>
<div class="codehilite"><pre><span></span><code>HOSTS=powerpc-unknown-linux-gnu
python3 ../x.py dist --host $HOSTS --target $HOSTS
</code></pre></div>



<a name="202920196"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/182449-t-compiler/help/topic/Why%20are%20my%20native%20rustlibs%20missing%20for%20a%20cross-compile%3F/near/202920196" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jake Goulding <a href="https://rust-lang.github.io/zulip_archive/stream/182449-t-compiler/help/topic/Why.20are.20my.20native.20rustlibs.20missing.20for.20a.20cross-compile.3F.html#202920196">(Jul 05 2020 at 12:41)</a>:</h4>
<p>That seems overly simple</p>



<a name="202920243"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/182449-t-compiler/help/topic/Why%20are%20my%20native%20rustlibs%20missing%20for%20a%20cross-compile%3F/near/202920243" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> simulacrum <a href="https://rust-lang.github.io/zulip_archive/stream/182449-t-compiler/help/topic/Why.20are.20my.20native.20rustlibs.20missing.20for.20a.20cross-compile.3F.html#202920243">(Jul 05 2020 at 12:42)</a>:</h4>
<p>Hm that looks about right. I'd try it</p>



<a name="202920248"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/182449-t-compiler/help/topic/Why%20are%20my%20native%20rustlibs%20missing%20for%20a%20cross-compile%3F/near/202920248" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> simulacrum <a href="https://rust-lang.github.io/zulip_archive/stream/182449-t-compiler/help/topic/Why.20are.20my.20native.20rustlibs.20missing.20for.20a.20cross-compile.3F.html#202920248">(Jul 05 2020 at 12:42)</a>:</h4>
<p>Target for std, host for rustc</p>



<a name="202920256"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/182449-t-compiler/help/topic/Why%20are%20my%20native%20rustlibs%20missing%20for%20a%20cross-compile%3F/near/202920256" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jake Goulding <a href="https://rust-lang.github.io/zulip_archive/stream/182449-t-compiler/help/topic/Why.20are.20my.20native.20rustlibs.20missing.20for.20a.20cross-compile.3F.html#202920256">(Jul 05 2020 at 12:43)</a>:</h4>
<p>So <code>x.py dist --host aarch64-apple-darwin --target aarch64-apple-darwin</code> and that will produce a single directory I could copy around?</p>



<a name="202920258"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/182449-t-compiler/help/topic/Why%20are%20my%20native%20rustlibs%20missing%20for%20a%20cross-compile%3F/near/202920258" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jake Goulding <a href="https://rust-lang.github.io/zulip_archive/stream/182449-t-compiler/help/topic/Why.20are.20my.20native.20rustlibs.20missing.20for.20a.20cross-compile.3F.html#202920258">(Jul 05 2020 at 12:43)</a>:</h4>
<p>Can I mix in a <code>stage 1</code> in there too?</p>



<a name="202920259"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/182449-t-compiler/help/topic/Why%20are%20my%20native%20rustlibs%20missing%20for%20a%20cross-compile%3F/near/202920259" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> simulacrum <a href="https://rust-lang.github.io/zulip_archive/stream/182449-t-compiler/help/topic/Why.20are.20my.20native.20rustlibs.20missing.20for.20a.20cross-compile.3F.html#202920259">(Jul 05 2020 at 12:43)</a>:</h4>
<p>Should, I think, yeah</p>



<a name="202920263"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/182449-t-compiler/help/topic/Why%20are%20my%20native%20rustlibs%20missing%20for%20a%20cross-compile%3F/near/202920263" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> simulacrum <a href="https://rust-lang.github.io/zulip_archive/stream/182449-t-compiler/help/topic/Why.20are.20my.20native.20rustlibs.20missing.20for.20a.20cross-compile.3F.html#202920263">(Jul 05 2020 at 12:43)</a>:</h4>
<p>I think so</p>



<a name="202920297"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/182449-t-compiler/help/topic/Why%20are%20my%20native%20rustlibs%20missing%20for%20a%20cross-compile%3F/near/202920297" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jake Goulding <a href="https://rust-lang.github.io/zulip_archive/stream/182449-t-compiler/help/topic/Why.20are.20my.20native.20rustlibs.20missing.20for.20a.20cross-compile.3F.html#202920297">(Jul 05 2020 at 12:44)</a>:</h4>
<p><code>s/dist/build/</code></p>



<a name="202920301"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/182449-t-compiler/help/topic/Why%20are%20my%20native%20rustlibs%20missing%20for%20a%20cross-compile%3F/near/202920301" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> simulacrum <a href="https://rust-lang.github.io/zulip_archive/stream/182449-t-compiler/help/topic/Why.20are.20my.20native.20rustlibs.20missing.20for.20a.20cross-compile.3F.html#202920301">(Jul 05 2020 at 12:44)</a>:</h4>
<p>Though it won't speed things up I imagine</p>



<a name="202920306"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/182449-t-compiler/help/topic/Why%20are%20my%20native%20rustlibs%20missing%20for%20a%20cross-compile%3F/near/202920306" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> simulacrum <a href="https://rust-lang.github.io/zulip_archive/stream/182449-t-compiler/help/topic/Why.20are.20my.20native.20rustlibs.20missing.20for.20a.20cross-compile.3F.html#202920306">(Jul 05 2020 at 12:44)</a>:</h4>
<p>Since you're building the compiler again anyway</p>



<a name="202920308"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/182449-t-compiler/help/topic/Why%20are%20my%20native%20rustlibs%20missing%20for%20a%20cross-compile%3F/near/202920308" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> simulacrum <a href="https://rust-lang.github.io/zulip_archive/stream/182449-t-compiler/help/topic/Why.20are.20my.20native.20rustlibs.20missing.20for.20a.20cross-compile.3F.html#202920308">(Jul 05 2020 at 12:44)</a>:</h4>
<p>I could be wrong though</p>



<a name="202920376"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/182449-t-compiler/help/topic/Why%20are%20my%20native%20rustlibs%20missing%20for%20a%20cross-compile%3F/near/202920376" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jake Goulding <a href="https://rust-lang.github.io/zulip_archive/stream/182449-t-compiler/help/topic/Why.20are.20my.20native.20rustlibs.20missing.20for.20a.20cross-compile.3F.html#202920376">(Jul 05 2020 at 12:46)</a>:</h4>
<p>It is the nature of the beast</p>



<a name="202923239"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/182449-t-compiler/help/topic/Why%20are%20my%20native%20rustlibs%20missing%20for%20a%20cross-compile%3F/near/202923239" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> eddyb <a href="https://rust-lang.github.io/zulip_archive/stream/182449-t-compiler/help/topic/Why.20are.20my.20native.20rustlibs.20missing.20for.20a.20cross-compile.3F.html#202923239">(Jul 05 2020 at 14:10)</a>:</h4>
<p><span class="user-mention" data-user-id="116155">@Jake Goulding</span> in case you didn't see it,  I suggested using <code>DESTDIR=some/empty/dir x.py install</code> instead of copying things from the <code>build</code> directory</p>



<a name="202923242"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/182449-t-compiler/help/topic/Why%20are%20my%20native%20rustlibs%20missing%20for%20a%20cross-compile%3F/near/202923242" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> eddyb <a href="https://rust-lang.github.io/zulip_archive/stream/182449-t-compiler/help/topic/Why.20are.20my.20native.20rustlibs.20missing.20for.20a.20cross-compile.3F.html#202923242">(Jul 05 2020 at 14:10)</a>:</h4>
<p>wasn't sure what <code>dist</code> does but it sounds similar</p>



<a name="202923308"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/182449-t-compiler/help/topic/Why%20are%20my%20native%20rustlibs%20missing%20for%20a%20cross-compile%3F/near/202923308" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jake Goulding <a href="https://rust-lang.github.io/zulip_archive/stream/182449-t-compiler/help/topic/Why.20are.20my.20native.20rustlibs.20missing.20for.20a.20cross-compile.3F.html#202923308">(Jul 05 2020 at 14:12)</a>:</h4>
<p>Dist produces the .gz and .xz files. Install is probably more want I want for “copy things around”</p>



<a name="202923312"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/182449-t-compiler/help/topic/Why%20are%20my%20native%20rustlibs%20missing%20for%20a%20cross-compile%3F/near/202923312" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> eddyb <a href="https://rust-lang.github.io/zulip_archive/stream/182449-t-compiler/help/topic/Why.20are.20my.20native.20rustlibs.20missing.20for.20a.20cross-compile.3F.html#202923312">(Jul 05 2020 at 14:12)</a>:</h4>
<p><span class="user-mention silent" data-user-id="116122">simulacrum</span> <a href="#narrow/stream/182449-t-compiler.2Fhelp/topic/Why.20are.20my.20native.20rustlibs.20missing.20for.20a.20cross-compile.3F/near/202918102">said</a>:</p>
<blockquote>
<p>Otherwise you'd clobber the stage2/bin/rustc (and everything else in there)</p>
</blockquote>
<p>if you're not going to <em>execute</em> it, why should it be in <code>stageN/bin/rustc</code>?</p>



<a name="202923319"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/182449-t-compiler/help/topic/Why%20are%20my%20native%20rustlibs%20missing%20for%20a%20cross-compile%3F/near/202923319" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> eddyb <a href="https://rust-lang.github.io/zulip_archive/stream/182449-t-compiler/help/topic/Why.20are.20my.20native.20rustlibs.20missing.20for.20a.20cross-compile.3F.html#202923319">(Jul 05 2020 at 14:13)</a>:</h4>
<p><span class="user-mention" data-user-id="116155">@Jake Goulding</span> note that the intended "automated distro build" workflow is <code>./configure ... &amp;&amp; make &amp;&amp; make DESTDIR=... install</code></p>



<a name="202923325"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/182449-t-compiler/help/topic/Why%20are%20my%20native%20rustlibs%20missing%20for%20a%20cross-compile%3F/near/202923325" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> eddyb <a href="https://rust-lang.github.io/zulip_archive/stream/182449-t-compiler/help/topic/Why.20are.20my.20native.20rustlibs.20missing.20for.20a.20cross-compile.3F.html#202923325">(Jul 05 2020 at 14:13)</a>:</h4>
<p>so you don't even need to touch <code>x.py</code> or <code>config.toml</code> if you want to automate this</p>



<a name="202923384"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/182449-t-compiler/help/topic/Why%20are%20my%20native%20rustlibs%20missing%20for%20a%20cross-compile%3F/near/202923384" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jake Goulding <a href="https://rust-lang.github.io/zulip_archive/stream/182449-t-compiler/help/topic/Why.20are.20my.20native.20rustlibs.20missing.20for.20a.20cross-compile.3F.html#202923384">(Jul 05 2020 at 14:15)</a>:</h4>
<p>"automate" is not <em>quite</em> a goal, beyond allowing <code>rustup install</code>. Mostly just documenting what we need to do as we get to there.</p>



<a name="202923451"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/182449-t-compiler/help/topic/Why%20are%20my%20native%20rustlibs%20missing%20for%20a%20cross-compile%3F/near/202923451" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> eddyb <a href="https://rust-lang.github.io/zulip_archive/stream/182449-t-compiler/help/topic/Why.20are.20my.20native.20rustlibs.20missing.20for.20a.20cross-compile.3F.html#202923451">(Jul 05 2020 at 14:16)</a>:</h4>
<p>fair enough. I wonder if you can make <code>x.py dist</code> work with <code>rustup install</code> without having the components published on the official server, I sadly doubt it because I've seen a separate tool being needed even just to install PR artifacts (which are similar to nightlies but on a different S3 bucket or something)</p>



<a name="202923460"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/182449-t-compiler/help/topic/Why%20are%20my%20native%20rustlibs%20missing%20for%20a%20cross-compile%3F/near/202923460" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jake Goulding <a href="https://rust-lang.github.io/zulip_archive/stream/182449-t-compiler/help/topic/Why.20are.20my.20native.20rustlibs.20missing.20for.20a.20cross-compile.3F.html#202923460">(Jul 05 2020 at 14:17)</a>:</h4>
<p>Yeah. I think I asked about something similar before — would have loved to publish AVR-enabled <code>rustc</code> builds that were usable by rustup somehow.</p>



<a name="202923463"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/182449-t-compiler/help/topic/Why%20are%20my%20native%20rustlibs%20missing%20for%20a%20cross-compile%3F/near/202923463" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> eddyb <a href="https://rust-lang.github.io/zulip_archive/stream/182449-t-compiler/help/topic/Why.20are.20my.20native.20rustlibs.20missing.20for.20a.20cross-compile.3F.html#202923463">(Jul 05 2020 at 14:17)</a>:</h4>
<p><span class="user-mention" data-user-id="116122">@simulacrum</span> basically I'm suggesting that the triple in <code>build/$triple</code> always be the <em>build</em> triple (and all of the sysroots would be of that triple), and <em>host</em> triples would only exist under e.g. <code>stageN-rustc/$triple/release</code></p>



<a name="202923507"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/182449-t-compiler/help/topic/Why%20are%20my%20native%20rustlibs%20missing%20for%20a%20cross-compile%3F/near/202923507" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> eddyb <a href="https://rust-lang.github.io/zulip_archive/stream/182449-t-compiler/help/topic/Why.20are.20my.20native.20rustlibs.20missing.20for.20a.20cross-compile.3F.html#202923507">(Jul 05 2020 at 14:18)</a>:</h4>
<p><span class="user-mention" data-user-id="116122">@simulacrum</span> and only <code>x.py install</code> / <code>x.py dist</code> would know how to create a sysroot for a <em>host</em> triple different than the <em>build</em> triple</p>



<a name="202923511"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/182449-t-compiler/help/topic/Why%20are%20my%20native%20rustlibs%20missing%20for%20a%20cross-compile%3F/near/202923511" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> eddyb <a href="https://rust-lang.github.io/zulip_archive/stream/182449-t-compiler/help/topic/Why.20are.20my.20native.20rustlibs.20missing.20for.20a.20cross-compile.3F.html#202923511">(Jul 05 2020 at 14:18)</a>:</h4>
<p>is that too convoluted? idk</p>



<a name="202923512"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/182449-t-compiler/help/topic/Why%20are%20my%20native%20rustlibs%20missing%20for%20a%20cross-compile%3F/near/202923512" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> simulacrum <a href="https://rust-lang.github.io/zulip_archive/stream/182449-t-compiler/help/topic/Why.20are.20my.20native.20rustlibs.20missing.20for.20a.20cross-compile.3F.html#202923512">(Jul 05 2020 at 14:18)</a>:</h4>
<p>oh it's probably possible, just not what we do today and may break some expectations</p>



<a name="202923515"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/182449-t-compiler/help/topic/Why%20are%20my%20native%20rustlibs%20missing%20for%20a%20cross-compile%3F/near/202923515" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> simulacrum <a href="https://rust-lang.github.io/zulip_archive/stream/182449-t-compiler/help/topic/Why.20are.20my.20native.20rustlibs.20missing.20for.20a.20cross-compile.3F.html#202923515">(Jul 05 2020 at 14:18)</a>:</h4>
<p>seems like a "good" change though generally speaking</p>



<a name="202923517"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/182449-t-compiler/help/topic/Why%20are%20my%20native%20rustlibs%20missing%20for%20a%20cross-compile%3F/near/202923517" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> eddyb <a href="https://rust-lang.github.io/zulip_archive/stream/182449-t-compiler/help/topic/Why.20are.20my.20native.20rustlibs.20missing.20for.20a.20cross-compile.3F.html#202923517">(Jul 05 2020 at 14:19)</a>:</h4>
<p>also if this works the next question is  "do we need the stratification of <code>build/$triple</code> or can we just expect the build triple to just never change on a given system"</p>



<a name="202923530"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/182449-t-compiler/help/topic/Why%20are%20my%20native%20rustlibs%20missing%20for%20a%20cross-compile%3F/near/202923530" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> simulacrum <a href="https://rust-lang.github.io/zulip_archive/stream/182449-t-compiler/help/topic/Why.20are.20my.20native.20rustlibs.20missing.20for.20a.20cross-compile.3F.html#202923530">(Jul 05 2020 at 14:19)</a>:</h4>
<p>IIRC someone complained when I said it probably never changes, iirc talking about running i686 and x86_64 compilers on the same platform or something</p>



<a name="202923533"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/182449-t-compiler/help/topic/Why%20are%20my%20native%20rustlibs%20missing%20for%20a%20cross-compile%3F/near/202923533" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> simulacrum <a href="https://rust-lang.github.io/zulip_archive/stream/182449-t-compiler/help/topic/Why.20are.20my.20native.20rustlibs.20missing.20for.20a.20cross-compile.3F.html#202923533">(Jul 05 2020 at 14:19)</a>:</h4>
<p>(i.e., build compilers)</p>



<a name="202923537"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/182449-t-compiler/help/topic/Why%20are%20my%20native%20rustlibs%20missing%20for%20a%20cross-compile%3F/near/202923537" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jake Goulding <a href="https://rust-lang.github.io/zulip_archive/stream/182449-t-compiler/help/topic/Why.20are.20my.20native.20rustlibs.20missing.20for.20a.20cross-compile.3F.html#202923537">(Jul 05 2020 at 14:19)</a>:</h4>
<p>Ditto x86_64 and aarch64 in my case :-)</p>



<a name="202923578"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/182449-t-compiler/help/topic/Why%20are%20my%20native%20rustlibs%20missing%20for%20a%20cross-compile%3F/near/202923578" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> eddyb <a href="https://rust-lang.github.io/zulip_archive/stream/182449-t-compiler/help/topic/Why.20are.20my.20native.20rustlibs.20missing.20for.20a.20cross-compile.3F.html#202923578">(Jul 05 2020 at 14:20)</a>:</h4>
<p>no, <em>build</em> triples you have to be able to run on the machine you're building on</p>



<a name="202923584"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/182449-t-compiler/help/topic/Why%20are%20my%20native%20rustlibs%20missing%20for%20a%20cross-compile%3F/near/202923584" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jake Goulding <a href="https://rust-lang.github.io/zulip_archive/stream/182449-t-compiler/help/topic/Why.20are.20my.20native.20rustlibs.20missing.20for.20a.20cross-compile.3F.html#202923584">(Jul 05 2020 at 14:20)</a>:</h4>
<p>Yes, and the new apple machines can run both :-)</p>



<a name="202923585"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/182449-t-compiler/help/topic/Why%20are%20my%20native%20rustlibs%20missing%20for%20a%20cross-compile%3F/near/202923585" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> eddyb <a href="https://rust-lang.github.io/zulip_archive/stream/182449-t-compiler/help/topic/Why.20are.20my.20native.20rustlibs.20missing.20for.20a.20cross-compile.3F.html#202923585">(Jul 05 2020 at 14:20)</a>:</h4>
<p>you have a <code>x86_64</code> <em>build</em> triple and a <code>aarch64</code> <em>host</em> triple</p>



<a name="202923586"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/182449-t-compiler/help/topic/Why%20are%20my%20native%20rustlibs%20missing%20for%20a%20cross-compile%3F/near/202923586" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> simulacrum <a href="https://rust-lang.github.io/zulip_archive/stream/182449-t-compiler/help/topic/Why.20are.20my.20native.20rustlibs.20missing.20for.20a.20cross-compile.3F.html#202923586">(Jul 05 2020 at 14:20)</a>:</h4>
<p>wrt to making rustup work, you can do it if you don't mind being "nightly" or "beta" or "stable"</p>



<a name="202923590"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/182449-t-compiler/help/topic/Why%20are%20my%20native%20rustlibs%20missing%20for%20a%20cross-compile%3F/near/202923590" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> eddyb <a href="https://rust-lang.github.io/zulip_archive/stream/182449-t-compiler/help/topic/Why.20are.20my.20native.20rustlibs.20missing.20for.20a.20cross-compile.3F.html#202923590">(Jul 05 2020 at 14:20)</a>:</h4>
<p><span class="user-mention" data-user-id="116155">@Jake Goulding</span> sure, that's why I kept asking confusing questions last night :P</p>



<a name="202923592"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/182449-t-compiler/help/topic/Why%20are%20my%20native%20rustlibs%20missing%20for%20a%20cross-compile%3F/near/202923592" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> simulacrum <a href="https://rust-lang.github.io/zulip_archive/stream/182449-t-compiler/help/topic/Why.20are.20my.20native.20rustlibs.20missing.20for.20a.20cross-compile.3F.html#202923592">(Jul 05 2020 at 14:20)</a>:</h4>
<p>(we do so for say dev-static)</p>



<a name="202923602"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/182449-t-compiler/help/topic/Why%20are%20my%20native%20rustlibs%20missing%20for%20a%20cross-compile%3F/near/202923602" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> simulacrum <a href="https://rust-lang.github.io/zulip_archive/stream/182449-t-compiler/help/topic/Why.20are.20my.20native.20rustlibs.20missing.20for.20a.20cross-compile.3F.html#202923602">(Jul 05 2020 at 14:21)</a>:</h4>
<p><code>RUSTUP_DIST_SERVER=https://dev-static.rust-lang.org rustup -v update stable</code> with a URL that's to, say, <a href="http://jakes-apple-builds.com">jakes-apple-builds.com</a> would in theory work, you'd just need the same directory structure and manifests</p>



<a name="202923603"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/182449-t-compiler/help/topic/Why%20are%20my%20native%20rustlibs%20missing%20for%20a%20cross-compile%3F/near/202923603" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> eddyb <a href="https://rust-lang.github.io/zulip_archive/stream/182449-t-compiler/help/topic/Why.20are.20my.20native.20rustlibs.20missing.20for.20a.20cross-compile.3F.html#202923603">(Jul 05 2020 at 14:21)</a>:</h4>
<p>(because it wasn't clear what machine these dirs were on. IMO the only reasons to have more than one dir under <code>build/</code> is 32-bit vs 64-bit or musl vs glibc, that sort of t hing)</p>



<a name="202923649"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/182449-t-compiler/help/topic/Why%20are%20my%20native%20rustlibs%20missing%20for%20a%20cross-compile%3F/near/202923649" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> simulacrum <a href="https://rust-lang.github.io/zulip_archive/stream/182449-t-compiler/help/topic/Why.20are.20my.20native.20rustlibs.20missing.20for.20a.20cross-compile.3F.html#202923649">(Jul 05 2020 at 14:22)</a>:</h4>
<p>even then we can probably say "edge case" and tell people to use different build/ directories</p>



<a name="202923652"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/182449-t-compiler/help/topic/Why%20are%20my%20native%20rustlibs%20missing%20for%20a%20cross-compile%3F/near/202923652" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> eddyb <a href="https://rust-lang.github.io/zulip_archive/stream/182449-t-compiler/help/topic/Why.20are.20my.20native.20rustlibs.20missing.20for.20a.20cross-compile.3F.html#202923652">(Jul 05 2020 at 14:22)</a>:</h4>
<p><span class="user-mention" data-user-id="116122">@simulacrum</span> huuuuh do PR builds not work like that because <code>rustup</code> doesn't understand their versioning?</p>



<a name="202923655"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/182449-t-compiler/help/topic/Why%20are%20my%20native%20rustlibs%20missing%20for%20a%20cross-compile%3F/near/202923655" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> simulacrum <a href="https://rust-lang.github.io/zulip_archive/stream/182449-t-compiler/help/topic/Why.20are.20my.20native.20rustlibs.20missing.20for.20a.20cross-compile.3F.html#202923655">(Jul 05 2020 at 14:22)</a>:</h4>
<p>well rustup has 3 channels</p>



<a name="202923658"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/182449-t-compiler/help/topic/Why%20are%20my%20native%20rustlibs%20missing%20for%20a%20cross-compile%3F/near/202923658" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jake Goulding <a href="https://rust-lang.github.io/zulip_archive/stream/182449-t-compiler/help/topic/Why.20are.20my.20native.20rustlibs.20missing.20for.20a.20cross-compile.3F.html#202923658">(Jul 05 2020 at 14:23)</a>:</h4>
<blockquote>
<p>it wasn't clear what machine these dirs were on</p>
</blockquote>
<p>Yep, we've been bouncing around a bit — as you do when getting a new platform going :-)</p>



<a name="202923661"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/182449-t-compiler/help/topic/Why%20are%20my%20native%20rustlibs%20missing%20for%20a%20cross-compile%3F/near/202923661" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> simulacrum <a href="https://rust-lang.github.io/zulip_archive/stream/182449-t-compiler/help/topic/Why.20are.20my.20native.20rustlibs.20missing.20for.20a.20cross-compile.3F.html#202923661">(Jul 05 2020 at 14:23)</a>:</h4>
<p>maybe you could finagle the PR builds as "future nightlies" but there's not really support in rustup for hashes I think</p>



<a name="202923663"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/182449-t-compiler/help/topic/Why%20are%20my%20native%20rustlibs%20missing%20for%20a%20cross-compile%3F/near/202923663" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> simulacrum <a href="https://rust-lang.github.io/zulip_archive/stream/182449-t-compiler/help/topic/Why.20are.20my.20native.20rustlibs.20missing.20for.20a.20cross-compile.3F.html#202923663">(Jul 05 2020 at 14:23)</a>:</h4>
<p>it's long been on my todo list to try and get that support integrated</p>



<a name="202923666"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/182449-t-compiler/help/topic/Why%20are%20my%20native%20rustlibs%20missing%20for%20a%20cross-compile%3F/near/202923666" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> eddyb <a href="https://rust-lang.github.io/zulip_archive/stream/182449-t-compiler/help/topic/Why.20are.20my.20native.20rustlibs.20missing.20for.20a.20cross-compile.3F.html#202923666">(Jul 05 2020 at 14:23)</a>:</h4>
<p>NixOS patches <code>rustup</code> to auto-patch toolchains to work directly, so anything that uses <code>rustup</code> as a dependency, as opposed to executing the one on the system, will be missing the requisite <code>patchelf</code> invocations :(</p>



<a name="202923677"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/182449-t-compiler/help/topic/Why%20are%20my%20native%20rustlibs%20missing%20for%20a%20cross-compile%3F/near/202923677" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> eddyb <a href="https://rust-lang.github.io/zulip_archive/stream/182449-t-compiler/help/topic/Why.20are.20my.20native.20rustlibs.20missing.20for.20a.20cross-compile.3F.html#202923677">(Jul 05 2020 at 14:23)</a>:</h4>
<p>I have a bunch of <code>patchelf</code> commands in my <code>fish</code> history so this isn't too bad but I don't like it very much</p>



<a name="202923717"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/182449-t-compiler/help/topic/Why%20are%20my%20native%20rustlibs%20missing%20for%20a%20cross-compile%3F/near/202923717" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> eddyb <a href="https://rust-lang.github.io/zulip_archive/stream/182449-t-compiler/help/topic/Why.20are.20my.20native.20rustlibs.20missing.20for.20a.20cross-compile.3F.html#202923717">(Jul 05 2020 at 14:24)</a>:</h4>
<p><span class="user-mention" data-user-id="116122">@simulacrum</span> anyway, thanks for the explanation! I was mostly trying to clean up my own understanding. and hoping we can make this less confusing in the future</p>



<a name="202923731"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/182449-t-compiler/help/topic/Why%20are%20my%20native%20rustlibs%20missing%20for%20a%20cross-compile%3F/near/202923731" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> eddyb <a href="https://rust-lang.github.io/zulip_archive/stream/182449-t-compiler/help/topic/Why.20are.20my.20native.20rustlibs.20missing.20for.20a.20cross-compile.3F.html#202923731">(Jul 05 2020 at 14:25)</a>:</h4>
<p><span class="user-mention" data-user-id="116155">@Jake Goulding</span> sure, but based on having both dirs under <code>build/</code> I thought this was a machine that could run <em>both</em>, but <em>that was wrong</em> (as made clear by <span class="user-mention" data-user-id="317220">@André Arko</span>)</p>



<a name="202923785"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/182449-t-compiler/help/topic/Why%20are%20my%20native%20rustlibs%20missing%20for%20a%20cross-compile%3F/near/202923785" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jake Goulding <a href="https://rust-lang.github.io/zulip_archive/stream/182449-t-compiler/help/topic/Why.20are.20my.20native.20rustlibs.20missing.20for.20a.20cross-compile.3F.html#202923785">(Jul 05 2020 at 14:26)</a>:</h4>
<p>Well, it depends who and when you ask <span aria-label="wink" class="emoji emoji-1f609" role="img" title="wink">:wink:</span>. I currently am building the rustc compiler on the aarch64 machine. that machine can run <strong>both</strong> aarch64 and x86-64 binaries natively.</p>



<a name="202923792"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/182449-t-compiler/help/topic/Why%20are%20my%20native%20rustlibs%20missing%20for%20a%20cross-compile%3F/near/202923792" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> eddyb <a href="https://rust-lang.github.io/zulip_archive/stream/182449-t-compiler/help/topic/Why.20are.20my.20native.20rustlibs.20missing.20for.20a.20cross-compile.3F.html#202923792">(Jul 05 2020 at 14:26)</a>:</h4>
<p>uhhhhhhh <span class="user-mention" data-user-id="317220">@André Arko</span> claimed the situation you were in was on a x64 machine</p>



<a name="202923799"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/182449-t-compiler/help/topic/Why%20are%20my%20native%20rustlibs%20missing%20for%20a%20cross-compile%3F/near/202923799" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jake Goulding <a href="https://rust-lang.github.io/zulip_archive/stream/182449-t-compiler/help/topic/Why.20are.20my.20native.20rustlibs.20missing.20for.20a.20cross-compile.3F.html#202923799">(Jul 05 2020 at 14:27)</a>:</h4>
<p>"natively" as in  <code>./some-x86-binary</code> and <code>./some-aarch64-binary</code>; there's still some emulation happening somewhere</p>



<a name="202923810"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/182449-t-compiler/help/topic/Why%20are%20my%20native%20rustlibs%20missing%20for%20a%20cross-compile%3F/near/202923810" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jake Goulding <a href="https://rust-lang.github.io/zulip_archive/stream/182449-t-compiler/help/topic/Why.20are.20my.20native.20rustlibs.20missing.20for.20a.20cross-compile.3F.html#202923810">(Jul 05 2020 at 14:27)</a>:</h4>
<p>That's what I mean by "when". At one point we only were able to cross-compile. Now we are able to natively compile.</p>



<a name="202923853"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/182449-t-compiler/help/topic/Why%20are%20my%20native%20rustlibs%20missing%20for%20a%20cross-compile%3F/near/202923853" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jake Goulding <a href="https://rust-lang.github.io/zulip_archive/stream/182449-t-compiler/help/topic/Why.20are.20my.20native.20rustlibs.20missing.20for.20a.20cross-compile.3F.html#202923853">(Jul 05 2020 at 14:28)</a>:</h4>
<p>But I'm still doing steps on both machines, in order to be able to reproduce this elsewhere.</p>



<a name="202923857"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/182449-t-compiler/help/topic/Why%20are%20my%20native%20rustlibs%20missing%20for%20a%20cross-compile%3F/near/202923857" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> eddyb <a href="https://rust-lang.github.io/zulip_archive/stream/182449-t-compiler/help/topic/Why.20are.20my.20native.20rustlibs.20missing.20for.20a.20cross-compile.3F.html#202923857">(Jul 05 2020 at 14:28)</a>:</h4>
<p><span class="user-mention" data-user-id="116122">@simulacrum</span> the thing that is fascinating to me and which wasn't really there ages ago in this form, is the existence of <code>stageN-X/$triple/release</code>, which comes from how Cargo target dir works I guess, and which can service both <em>host</em> and <em>target</em> triples equally, leaving <code>stageN-X/release</code> to be the <em>build</em> triple, implicitly</p>



<a name="202923862"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/182449-t-compiler/help/topic/Why%20are%20my%20native%20rustlibs%20missing%20for%20a%20cross-compile%3F/near/202923862" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> simulacrum <a href="https://rust-lang.github.io/zulip_archive/stream/182449-t-compiler/help/topic/Why.20are.20my.20native.20rustlibs.20missing.20for.20a.20cross-compile.3F.html#202923862">(Jul 05 2020 at 14:29)</a>:</h4>
<p>hm yeah that's been a thing in cargo for as long as I remember but maybe we weren't always passing --target to cargo? not sure</p>



<a name="202923867"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/182449-t-compiler/help/topic/Why%20are%20my%20native%20rustlibs%20missing%20for%20a%20cross-compile%3F/near/202923867" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> eddyb <a href="https://rust-lang.github.io/zulip_archive/stream/182449-t-compiler/help/topic/Why.20are.20my.20native.20rustlibs.20missing.20for.20a.20cross-compile.3F.html#202923867">(Jul 05 2020 at 14:29)</a>:</h4>
<p>we weren't using Cargo pre-"rustbuild" :P</p>



<a name="202923911"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/182449-t-compiler/help/topic/Why%20are%20my%20native%20rustlibs%20missing%20for%20a%20cross-compile%3F/near/202923911" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> simulacrum <a href="https://rust-lang.github.io/zulip_archive/stream/182449-t-compiler/help/topic/Why.20are.20my.20native.20rustlibs.20missing.20for.20a.20cross-compile.3F.html#202923911">(Jul 05 2020 at 14:30)</a>:</h4>
<p>oh right</p>



<a name="202923915"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/182449-t-compiler/help/topic/Why%20are%20my%20native%20rustlibs%20missing%20for%20a%20cross-compile%3F/near/202923915" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> eddyb <a href="https://rust-lang.github.io/zulip_archive/stream/182449-t-compiler/help/topic/Why.20are.20my.20native.20rustlibs.20missing.20for.20a.20cross-compile.3F.html#202923915">(Jul 05 2020 at 14:30)</a>:</h4>
<p>and I'm not sure we've fully looked into the consequences of that - another example is the effort being put into making "rustbuild" less necessary for doing builds, and relying on Cargo more</p>



<a name="202923918"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/182449-t-compiler/help/topic/Why%20are%20my%20native%20rustlibs%20missing%20for%20a%20cross-compile%3F/near/202923918" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> eddyb <a href="https://rust-lang.github.io/zulip_archive/stream/182449-t-compiler/help/topic/Why.20are.20my.20native.20rustlibs.20missing.20for.20a.20cross-compile.3F.html#202923918">(Jul 05 2020 at 14:30)</a>:</h4>
<p><span class="user-mention" data-user-id="116155">@Jake Goulding</span> oh btw, speaking of this whole thing, are you aware of the person trying to get aarch64 builds going, on Discord?</p>



<a name="202923924"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/182449-t-compiler/help/topic/Why%20are%20my%20native%20rustlibs%20missing%20for%20a%20cross-compile%3F/near/202923924" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> eddyb <a href="https://rust-lang.github.io/zulip_archive/stream/182449-t-compiler/help/topic/Why.20are.20my.20native.20rustlibs.20missing.20for.20a.20cross-compile.3F.html#202923924">(Jul 05 2020 at 14:30)</a>:</h4>
<p>they had a lot of trouble and I wasn't sure who to point them to</p>



<a name="202923929"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/182449-t-compiler/help/topic/Why%20are%20my%20native%20rustlibs%20missing%20for%20a%20cross-compile%3F/near/202923929" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jake Goulding <a href="https://rust-lang.github.io/zulip_archive/stream/182449-t-compiler/help/topic/Why.20are.20my.20native.20rustlibs.20missing.20for.20a.20cross-compile.3F.html#202923929">(Jul 05 2020 at 14:31)</a>:</h4>
<p>which channel?</p>



<a name="202923932"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/182449-t-compiler/help/topic/Why%20are%20my%20native%20rustlibs%20missing%20for%20a%20cross-compile%3F/near/202923932" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> eddyb <a href="https://rust-lang.github.io/zulip_archive/stream/182449-t-compiler/help/topic/Why.20are.20my.20native.20rustlibs.20missing.20for.20a.20cross-compile.3F.html#202923932">(Jul 05 2020 at 14:31)</a>:</h4>
<p>#compiler, scroll up and you'll find a bunch of stuff</p>



<a name="202923938"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/182449-t-compiler/help/topic/Why%20are%20my%20native%20rustlibs%20missing%20for%20a%20cross-compile%3F/near/202923938" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> eddyb <a href="https://rust-lang.github.io/zulip_archive/stream/182449-t-compiler/help/topic/Why.20are.20my.20native.20rustlibs.20missing.20for.20a.20cross-compile.3F.html#202923938">(Jul 05 2020 at 14:31)</a>:</h4>
<p>I expected other people would also try to do this sort of thing, and that <em>someone</em> would know more about LLVM and buildsystems, enough to deal with everything quicker, I just didn't know who to point them to</p>



<a name="202923977"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/182449-t-compiler/help/topic/Why%20are%20my%20native%20rustlibs%20missing%20for%20a%20cross-compile%3F/near/202923977" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> eddyb <a href="https://rust-lang.github.io/zulip_archive/stream/182449-t-compiler/help/topic/Why.20are.20my.20native.20rustlibs.20missing.20for.20a.20cross-compile.3F.html#202923977">(Jul 05 2020 at 14:32)</a>:</h4>
<p>they eventually got rustc running on iOS</p>



<a name="202923979"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/182449-t-compiler/help/topic/Why%20are%20my%20native%20rustlibs%20missing%20for%20a%20cross-compile%3F/near/202923979" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jake Goulding <a href="https://rust-lang.github.io/zulip_archive/stream/182449-t-compiler/help/topic/Why.20are.20my.20native.20rustlibs.20missing.20for.20a.20cross-compile.3F.html#202923979">(Jul 05 2020 at 14:32)</a>:</h4>
<p>yeah, the ios person</p>



<a name="202923984"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/182449-t-compiler/help/topic/Why%20are%20my%20native%20rustlibs%20missing%20for%20a%20cross-compile%3F/near/202923984" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jake Goulding <a href="https://rust-lang.github.io/zulip_archive/stream/182449-t-compiler/help/topic/Why.20are.20my.20native.20rustlibs.20missing.20for.20a.20cross-compile.3F.html#202923984">(Jul 05 2020 at 14:33)</a>:</h4>
<p>I think this is them <a href="https://github.com/rust-lang/rust/issues/73628">https://github.com/rust-lang/rust/issues/73628</a></p>



<a name="202923985"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/182449-t-compiler/help/topic/Why%20are%20my%20native%20rustlibs%20missing%20for%20a%20cross-compile%3F/near/202923985" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> eddyb <a href="https://rust-lang.github.io/zulip_archive/stream/182449-t-compiler/help/topic/Why.20are.20my.20native.20rustlibs.20missing.20for.20a.20cross-compile.3F.html#202923985">(Jul 05 2020 at 14:33)</a>:</h4>
<p>I just feel bad if they wasted their time</p>



<a name="202923986"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/182449-t-compiler/help/topic/Why%20are%20my%20native%20rustlibs%20missing%20for%20a%20cross-compile%3F/near/202923986" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> eddyb <a href="https://rust-lang.github.io/zulip_archive/stream/182449-t-compiler/help/topic/Why.20are.20my.20native.20rustlibs.20missing.20for.20a.20cross-compile.3F.html#202923986">(Jul 05 2020 at 14:33)</a>:</h4>
<p>due to lack of coordination</p>



<a name="202923990"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/182449-t-compiler/help/topic/Why%20are%20my%20native%20rustlibs%20missing%20for%20a%20cross-compile%3F/near/202923990" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jake Goulding <a href="https://rust-lang.github.io/zulip_archive/stream/182449-t-compiler/help/topic/Why.20are.20my.20native.20rustlibs.20missing.20for.20a.20cross-compile.3F.html#202923990">(Jul 05 2020 at 14:33)</a>:</h4>
<p>jokes on you, I know nothing, other than to ask smarter people <span aria-label="wink" class="emoji emoji-1f609" role="img" title="wink">:wink:</span></p>



<a name="202923993"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/182449-t-compiler/help/topic/Why%20are%20my%20native%20rustlibs%20missing%20for%20a%20cross-compile%3F/near/202923993" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> eddyb <a href="https://rust-lang.github.io/zulip_archive/stream/182449-t-compiler/help/topic/Why.20are.20my.20native.20rustlibs.20missing.20for.20a.20cross-compile.3F.html#202923993">(Jul 05 2020 at 14:33)</a>:</h4>
<p>I mean idk who the macOS ppl are</p>



<a name="202924034"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/182449-t-compiler/help/topic/Why%20are%20my%20native%20rustlibs%20missing%20for%20a%20cross-compile%3F/near/202924034" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> eddyb <a href="https://rust-lang.github.io/zulip_archive/stream/182449-t-compiler/help/topic/Why.20are.20my.20native.20rustlibs.20missing.20for.20a.20cross-compile.3F.html#202924034">(Jul 05 2020 at 14:34)</a>:</h4>
<p>other than acrichto who is probably too busy</p>



<a name="202924036"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/182449-t-compiler/help/topic/Why%20are%20my%20native%20rustlibs%20missing%20for%20a%20cross-compile%3F/near/202924036" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> eddyb <a href="https://rust-lang.github.io/zulip_archive/stream/182449-t-compiler/help/topic/Why.20are.20my.20native.20rustlibs.20missing.20for.20a.20cross-compile.3F.html#202924036">(Jul 05 2020 at 14:34)</a>:</h4>
<p>that issue sounds relevant but I wonder if there's two people</p>



<a name="202924097"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/182449-t-compiler/help/topic/Why%20are%20my%20native%20rustlibs%20missing%20for%20a%20cross-compile%3F/near/202924097" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> eddyb <a href="https://rust-lang.github.io/zulip_archive/stream/182449-t-compiler/help/topic/Why.20are.20my.20native.20rustlibs.20missing.20for.20a.20cross-compile.3F.html#202924097">(Jul 05 2020 at 14:36)</a>:</h4>
<p>oh, <span class="user-mention" data-user-id="312033">@aspen</span>, they're on here as well</p>



<a name="202924168"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/182449-t-compiler/help/topic/Why%20are%20my%20native%20rustlibs%20missing%20for%20a%20cross-compile%3F/near/202924168" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jake Goulding <a href="https://rust-lang.github.io/zulip_archive/stream/182449-t-compiler/help/topic/Why.20are.20my.20native.20rustlibs.20missing.20for.20a.20cross-compile.3F.html#202924168">(Jul 05 2020 at 14:39)</a>:</h4>
<p>The main place for ARM stuff is <a class="stream" data-stream-id="242906" href="/#narrow/stream/242906-t-compiler.2Farm">#t-compiler/arm</a>. I've just been popping out into other streams for help from a broader perspective</p>



<a name="202924193"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/182449-t-compiler/help/topic/Why%20are%20my%20native%20rustlibs%20missing%20for%20a%20cross-compile%3F/near/202924193" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jake Goulding <a href="https://rust-lang.github.io/zulip_archive/stream/182449-t-compiler/help/topic/Why.20are.20my.20native.20rustlibs.20missing.20for.20a.20cross-compile.3F.html#202924193">(Jul 05 2020 at 14:39)</a>:</h4>
<div class="codehilite"><pre><span></span><code>  DESTDIR=/tmp/crossed \
  ../../x.py install --stage 1 --host aarch64-apple-darwin --target aarch64-apple-darwin,x86_64-apple-darwin --warnings warn
</code></pre></div>


<p>Does seem to do what I'd want though!</p>



<a name="202924245"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/182449-t-compiler/help/topic/Why%20are%20my%20native%20rustlibs%20missing%20for%20a%20cross-compile%3F/near/202924245" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> eddyb <a href="https://rust-lang.github.io/zulip_archive/stream/182449-t-compiler/help/topic/Why.20are.20my.20native.20rustlibs.20missing.20for.20a.20cross-compile.3F.html#202924245">(Jul 05 2020 at 14:40)</a>:</h4>
<p>nice :D</p>



<a name="202924273"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/182449-t-compiler/help/topic/Why%20are%20my%20native%20rustlibs%20missing%20for%20a%20cross-compile%3F/near/202924273" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jake Goulding <a href="https://rust-lang.github.io/zulip_archive/stream/182449-t-compiler/help/topic/Why.20are.20my.20native.20rustlibs.20missing.20for.20a.20cross-compile.3F.html#202924273">(Jul 05 2020 at 14:41)</a>:</h4>
<div class="codehilite"><pre><span></span><code>% cargo new hello-world
% cd hello-world

% cargo +installed-cross run
Hello, world!

% file target/debug/hello-world
target/debug/hello-world: Mach-O 64-bit executable arm64

% cargo +installed-cross run --target=x86_64-apple-darwin
Hello, world!

% file target/x86_64-apple-darwin/debug/hello-world
target/x86_64-apple-darwin/debug/hello-world: Mach-O 64-bit executable x86_64
</code></pre></div>



<a name="202924347"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/182449-t-compiler/help/topic/Why%20are%20my%20native%20rustlibs%20missing%20for%20a%20cross-compile%3F/near/202924347" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jake Goulding <a href="https://rust-lang.github.io/zulip_archive/stream/182449-t-compiler/help/topic/Why.20are.20my.20native.20rustlibs.20missing.20for.20a.20cross-compile.3F.html#202924347">(Jul 05 2020 at 14:43)</a>:</h4>
<div class="codehilite"><pre><span></span><code>% lipo -output hello-world -create target/{,x86_64-apple-darwin}/debug/hello-world
% file hello-world
hello-world: Mach-O universal binary with 2 architectures: [x86_64:Mach-O 64-bit executable x86_64] [arm64:Mach-O 64-bit executable arm64]
hello-world (for architecture x86_64):  Mach-O 64-bit executable x86_64
hello-world (for architecture arm64):   Mach-O 64-bit executable arm64
</code></pre></div>



<a name="202924615"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/182449-t-compiler/help/topic/Why%20are%20my%20native%20rustlibs%20missing%20for%20a%20cross-compile%3F/near/202924615" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> eddyb <a href="https://rust-lang.github.io/zulip_archive/stream/182449-t-compiler/help/topic/Why.20are.20my.20native.20rustlibs.20missing.20for.20a.20cross-compile.3F.html#202924615">(Jul 05 2020 at 14:50)</a>:</h4>
<p>isn't there a <code>cargo-lipo</code> as well :P?</p>



<a name="202924768"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/182449-t-compiler/help/topic/Why%20are%20my%20native%20rustlibs%20missing%20for%20a%20cross-compile%3F/near/202924768" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jake Goulding <a href="https://rust-lang.github.io/zulip_archive/stream/182449-t-compiler/help/topic/Why.20are.20my.20native.20rustlibs.20missing.20for.20a.20cross-compile.3F.html#202924768">(Jul 05 2020 at 14:54)</a>:</h4>
<p>I know of it, but I've never used it. Figured I'd do the simpler thing for now. I'm sure that project will be picking up steam soon.</p>



<hr><p>Last updated: Aug 07 2021 at 22:04 UTC</p>
</html>