<html>
<head><meta charset="utf-8"><title>Tidy not building with `./x.py check` · t-compiler/help · Zulip Chat Archive</title></head>
<h2>Stream: <a href="https://zulip-archive.rust-lang.org/stream/182449-t-compiler/help/index.html">t-compiler/help</a></h2>
<h3>Topic: <a href="https://zulip-archive.rust-lang.org/stream/182449-t-compiler/help/topic/Tidy.20not.20building.20with.20.60.2E.2Fx.2Epy.20check.60.html">Tidy not building with `./x.py check`</a></h3>

<hr>

<base href="https://rust-lang.zulipchat.com">

<head><link href="https://zulip-archive.rust-lang.org/style.css" rel="stylesheet"></head>

<a name="219114633"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/182449-t-compiler/help/topic/Tidy%20not%20building%20with%20%60./x.py%20check%60/near/219114633" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Eric Arellano <a href="https://zulip-archive.rust-lang.org/stream/182449-t-compiler/help/topic/Tidy.20not.20building.20with.20.60.2E.2Fx.2Epy.20check.60.html#219114633">(Dec 07 2020 at 18:00)</a>:</h4>
<p>Hey folks, <code>./x.py check</code> isn't building Tidy. I added <code>let x: u64 = false;</code> to debug, but it doesn't error as <code>tools/tidy</code> doesn't compile. I had run <code>./x.py setup</code> and chosen <code>compiler</code>, with no manual modifications made. Any ideas?</p>
<p>(This is for <a href="https://github.com/rust-lang/rust/issues/74773">https://github.com/rust-lang/rust/issues/74773</a>)</p>



<a name="219114656"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/182449-t-compiler/help/topic/Tidy%20not%20building%20with%20%60./x.py%20check%60/near/219114656" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Nelson <a href="https://zulip-archive.rust-lang.org/stream/182449-t-compiler/help/topic/Tidy.20not.20building.20with.20.60.2E.2Fx.2Epy.20check.60.html#219114656">(Dec 07 2020 at 18:00)</a>:</h4>
<p><span class="user-mention" data-user-id="370151">@Eric Arellano</span> <code>x.py test tidy</code></p>



<a name="219114798"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/182449-t-compiler/help/topic/Tidy%20not%20building%20with%20%60./x.py%20check%60/near/219114798" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Eric Arellano <a href="https://zulip-archive.rust-lang.org/stream/182449-t-compiler/help/topic/Tidy.20not.20building.20with.20.60.2E.2Fx.2Epy.20check.60.html#219114798">(Dec 07 2020 at 18:01)</a>:</h4>
<p>Ah, thank you Joshua! And thanks for the excellent Rustc Dev Guide book.</p>



<a name="219114817"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/182449-t-compiler/help/topic/Tidy%20not%20building%20with%20%60./x.py%20check%60/near/219114817" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Nelson <a href="https://zulip-archive.rust-lang.org/stream/182449-t-compiler/help/topic/Tidy.20not.20building.20with.20.60.2E.2Fx.2Epy.20check.60.html#219114817">(Dec 07 2020 at 18:01)</a>:</h4>
<p>you're very welcome! thanks for contributing :)</p>



<a name="219125670"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/182449-t-compiler/help/topic/Tidy%20not%20building%20with%20%60./x.py%20check%60/near/219125670" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Eric Arellano <a href="https://zulip-archive.rust-lang.org/stream/182449-t-compiler/help/topic/Tidy.20not.20building.20with.20.60.2E.2Fx.2Epy.20check.60.html#219125670">(Dec 07 2020 at 19:22)</a>:</h4>
<p>I'm also touching other tools like cargo and rustfmt. Should I be running <code>./x.py test rustfmt</code>? That's building more than I expected.</p>



<a name="219131333"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/182449-t-compiler/help/topic/Tidy%20not%20building%20with%20%60./x.py%20check%60/near/219131333" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Eric Arellano <a href="https://zulip-archive.rust-lang.org/stream/182449-t-compiler/help/topic/Tidy.20not.20building.20with.20.60.2E.2Fx.2Epy.20check.60.html#219131333">(Dec 07 2020 at 20:06)</a>:</h4>
<p>Nvm, I see now. Those are maintained in separate Git repos and only loaded via submodules. I shouldn't be touching the code in Cargo, rustfmt, and clippy. TIL :)</p>



<a name="219132829"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/182449-t-compiler/help/topic/Tidy%20not%20building%20with%20%60./x.py%20check%60/near/219132829" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> bjorn3 <a href="https://zulip-archive.rust-lang.org/stream/182449-t-compiler/help/topic/Tidy.20not.20building.20with.20.60.2E.2Fx.2Epy.20check.60.html#219132829">(Dec 07 2020 at 20:19)</a>:</h4>
<p>Clippy is no longer a submodule. It now uses <code>git subtree</code> to sync the <code>src/tools/clippy</code> dir with the rust-lang/rust-clippy repo. If your change breaks clippy, you will need to fix it in <code>src/tools/clippy</code>.</p>



<a name="219228203"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/182449-t-compiler/help/topic/Tidy%20not%20building%20with%20%60./x.py%20check%60/near/219228203" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Eric Arellano <a href="https://zulip-archive.rust-lang.org/stream/182449-t-compiler/help/topic/Tidy.20not.20building.20with.20.60.2E.2Fx.2Epy.20check.60.html#219228203">(Dec 08 2020 at 16:28)</a>:</h4>
<p>Related: <code>./x.py fmt</code> and <code>./x.py fmt tidy</code> don't seem to touch Tidy. Do you know if there's a command I can use?</p>



<a name="219252961"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/182449-t-compiler/help/topic/Tidy%20not%20building%20with%20%60./x.py%20check%60/near/219252961" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Eric Arellano <a href="https://zulip-archive.rust-lang.org/stream/182449-t-compiler/help/topic/Tidy.20not.20building.20with.20.60.2E.2Fx.2Epy.20check.60.html#219252961">(Dec 08 2020 at 19:47)</a>:</h4>
<p>Ahh. <code>./x.py fmt</code> does touch Tidy. Rustfmt doesn't know how to format the line in general. </p>
<div class="codehilite"><pre><span></span><code>s.split_once(&#39;:&#39;).expect(format!(&quot;Expected a line with the format `E0xxx: include_str!(\&quot;..\&quot;)`, but got {} without a `:` delimiter&quot;, s).as_str()).0.to_owned();
</code></pre></div>



<hr><p>Last updated: Apr 12 2022 at 20:01 UTC</p>
</html>