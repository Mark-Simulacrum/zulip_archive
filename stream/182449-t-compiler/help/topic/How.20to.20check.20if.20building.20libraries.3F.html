<html>
<head><meta charset="utf-8"><title>How to check if building libraries? · t-compiler/help · Zulip Chat Archive</title></head>
<h2>Stream: <a href="https://zulip-archive.rust-lang.org/stream/182449-t-compiler/help/index.html">t-compiler/help</a></h2>
<h3>Topic: <a href="https://zulip-archive.rust-lang.org/stream/182449-t-compiler/help/topic/How.20to.20check.20if.20building.20libraries.3F.html">How to check if building libraries?</a></h3>

<hr>

<base href="https://rust-lang.zulipchat.com">

<head><link href="https://zulip-archive.rust-lang.org/style.css" rel="stylesheet"></head>

<a name="252748519"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/182449-t-compiler/help/topic/How%20to%20check%20if%20building%20libraries%3F/near/252748519" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> osa1 <a href="https://zulip-archive.rust-lang.org/stream/182449-t-compiler/help/topic/How.20to.20check.20if.20building.20libraries.3F.html#252748519">(Sep 10 2021 at 08:09)</a>:</h4>
<p>In the compiler code is there a way to check if I'm currently compiling libraries for stage1 build (maybe an env variable set by the build system)? It's fine if it's hacky, this is for debugging.</p>
<p>I'm making a change in compilation (method probing) and it causes failures when compiling libraries. If I could compile libraries as before and have a working compiler it would make debugging much easier as I could try my changes on tiny programs instead of complicated std modules.</p>



<a name="252749962"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/182449-t-compiler/help/topic/How%20to%20check%20if%20building%20libraries%3F/near/252749962" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> The 8472 <a href="https://zulip-archive.rust-lang.org/stream/182449-t-compiler/help/topic/How.20to.20check.20if.20building.20libraries.3F.html#252749962">(Sep 10 2021 at 08:22)</a>:</h4>
<p>you could keep stage 0 std</p>



<a name="252751720"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/182449-t-compiler/help/topic/How%20to%20check%20if%20building%20libraries%3F/near/252751720" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> osa1 <a href="https://zulip-archive.rust-lang.org/stream/182449-t-compiler/help/topic/How.20to.20check.20if.20building.20libraries.3F.html#252751720">(Sep 10 2021 at 08:37)</a>:</h4>
<p>Could you explain please? No idea what you mean by "keep" or how to compile programs with stage 0 std</p>



<a name="252753116"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/182449-t-compiler/help/topic/How%20to%20check%20if%20building%20libraries%3F/near/252753116" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> The 8472 <a href="https://zulip-archive.rust-lang.org/stream/182449-t-compiler/help/topic/How.20to.20check.20if.20building.20libraries.3F.html#252753116">(Sep 10 2021 at 08:49)</a>:</h4>
<p>it's a bootstrap option. <code>./x.py build &lt;foo&gt; --keep-stage-std 0</code></p>



<a name="252761229"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/182449-t-compiler/help/topic/How%20to%20check%20if%20building%20libraries%3F/near/252761229" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Nelson <a href="https://zulip-archive.rust-lang.org/stream/182449-t-compiler/help/topic/How.20to.20check.20if.20building.20libraries.3F.html#252761229">(Sep 10 2021 at 10:01)</a>:</h4>
<p>In answer to your direct question: when bootstrapping, RUSTC_STAGE is set: <a href="https://github.com/rust-lang/rust/blob/497ee321af3b8496eaccd7af7b437f18bab81abf/src/bootstrap/bin/rustc.rs#L47">https://github.com/rust-lang/rust/blob/497ee321af3b8496eaccd7af7b437f18bab81abf/src/bootstrap/bin/rustc.rs#L47</a><br>
But you won't have it available unless you're building rustc or libstd itself.</p>



<a name="253531773"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/182449-t-compiler/help/topic/How%20to%20check%20if%20building%20libraries%3F/near/253531773" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> osa1 <a href="https://zulip-archive.rust-lang.org/stream/182449-t-compiler/help/topic/How.20to.20check.20if.20building.20libraries.3F.html#253531773">(Sep 16 2021 at 05:38)</a>:</h4>
<p>That worked, thanks!</p>



<hr><p>Last updated: Apr 12 2022 at 20:01 UTC</p>
</html>