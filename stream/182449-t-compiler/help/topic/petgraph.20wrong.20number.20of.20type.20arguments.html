<html>
<head><meta charset="utf-8"><title>petgraph wrong number of type arguments · t-compiler/help · Zulip Chat Archive</title></head>
<h2>Stream: <a href="https://rust-lang.github.io/zulip_archive/stream/182449-t-compiler/help/index.html">t-compiler/help</a></h2>
<h3>Topic: <a href="https://rust-lang.github.io/zulip_archive/stream/182449-t-compiler/help/topic/petgraph.20wrong.20number.20of.20type.20arguments.html">petgraph wrong number of type arguments</a></h3>

<hr>

<base href="https://rust-lang.zulipchat.com">

<head><link href="https://rust-lang.github.io/zulip_archive/style.css" rel="stylesheet"></head>

<a name="206582547"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/182449-t-compiler/help/topic/petgraph%20wrong%20number%20of%20type%20arguments/near/206582547" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jake Goulding <a href="https://rust-lang.github.io/zulip_archive/stream/182449-t-compiler/help/topic/petgraph.20wrong.20number.20of.20type.20arguments.html#206582547">(Aug 11 2020 at 14:34)</a>:</h4>
<p>I updated to <a href="https://github.com/rust-lang/rust/commit/441fd2255763c2aeea616aeac61b2c795a4c5330">441fd2255763c2aeea616aeac61b2c795a4c5330</a> in my aarch64-darwin fork, and now I'm getting:</p>
<div class="codehilite"><pre><span></span><code>error[E0107]: wrong number of type arguments: expected 3, found 2
   --&gt; /Users/shepmaster/.cargo/registry/src/github.com-1ecc6299db9ec823/petgraph-0.5.1/src/graphmap.rs:580:16
    |
580 |     edges: &amp;&#39;a IndexMap&lt;(N, N), E&gt;,
    |                ^^^^^^^^^^^^^^^^^^^ expected 3 type arguments

error[E0107]: wrong number of type arguments: expected 2, found 1
   --&gt; /Users/shepmaster/.cargo/registry/src/github.com-1ecc6299db9ec823/petgraph-0.5.1/src/matrix_graph.rs:925:22
    |
925 |     removed_ids: &amp;&#39;a IndexSet&lt;usize&gt;,
    |                      ^^^^^^^^^^^^^^^ expected 2 type arguments

error[E0107]: wrong number of type arguments: expected 3, found 2
  --&gt; /Users/shepmaster/.cargo/registry/src/github.com-1ecc6299db9ec823/petgraph-0.5.1/src/graphmap.rs:61:12
   |
61 |     nodes: IndexMap&lt;N, Vec&lt;(N, CompactDirection)&gt;&gt;,
   |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ expected 3 type arguments

error[E0107]: wrong number of type arguments: expected 3, found 2
  --&gt; /Users/shepmaster/.cargo/registry/src/github.com-1ecc6299db9ec823/petgraph-0.5.1/src/graphmap.rs:62:12
   |
62 |     edges: IndexMap&lt;(N, N), E&gt;,
   |            ^^^^^^^^^^^^^^^^^^^ expected 3 type arguments

error[E0107]: wrong number of type arguments: expected 2, found 1
   --&gt; /Users/shepmaster/.cargo/registry/src/github.com-1ecc6299db9ec823/petgraph-0.5.1/src/matrix_graph.rs:851:18
    |
851 |     removed_ids: IndexSet&lt;usize&gt;,
    |                  ^^^^^^^^^^^^^^^ expected 2 type arguments
</code></pre></div>


<p>Ring a bell for anyone?</p>



<a name="206598672"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/182449-t-compiler/help/topic/petgraph%20wrong%20number%20of%20type%20arguments/near/206598672" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jake Goulding <a href="https://rust-lang.github.io/zulip_archive/stream/182449-t-compiler/help/topic/petgraph.20wrong.20number.20of.20type.20arguments.html#206598672">(Aug 11 2020 at 16:44)</a>:</h4>
<p>I wasn't super clear, but this is while compiling rustc:</p>
<div class="codehilite"><pre><span></span><code>    SDKROOT=$(xcrun -sdk macosx11.0 --show-sdk-path) \
    MACOSX_DEPLOYMENT_TARGET=$(xcrun -sdk macosx11.0 --show-sdk-platform-version) \
    DESTDIR=~/crossed \
    ../../x.py install -i --stage 1 --host ../aarch64-apple-darwin.json --target aarch64-apple-darwin,x86_64-apple-darwin \
    src/librustc library/std
</code></pre></div>



<a name="206627185"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/182449-t-compiler/help/topic/petgraph%20wrong%20number%20of%20type%20arguments/near/206627185" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> simulacrum <a href="https://rust-lang.github.io/zulip_archive/stream/182449-t-compiler/help/topic/petgraph.20wrong.20number.20of.20type.20arguments.html#206627185">(Aug 11 2020 at 20:31)</a>:</h4>
<p><a href="https://github.com/rust-lang/rust/pull/75309#issuecomment-672261875">https://github.com/rust-lang/rust/pull/75309#issuecomment-672261875</a> seems similar</p>



<a name="207842892"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/182449-t-compiler/help/topic/petgraph%20wrong%20number%20of%20type%20arguments/near/207842892" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jake Goulding <a href="https://rust-lang.github.io/zulip_archive/stream/182449-t-compiler/help/topic/petgraph.20wrong.20number.20of.20type.20arguments.html#207842892">(Aug 24 2020 at 13:31)</a>:</h4>
<p>This is still happening :-(</p>



<a name="207843438"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/182449-t-compiler/help/topic/petgraph%20wrong%20number%20of%20type%20arguments/near/207843438" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jake Goulding <a href="https://rust-lang.github.io/zulip_archive/stream/182449-t-compiler/help/topic/petgraph.20wrong.20number.20of.20type.20arguments.html#207843438">(Aug 24 2020 at 13:36)</a>:</h4>
<blockquote>
<p>Hm so indexmap is using autocfg to probe for std's presence, I think via this <a href="https://docs.rs/autocfg/1.0.0/src/autocfg/lib.rs.html#268-271">bit of code</a>. My guess is that's not using the right rustc or not passing it the right parameters, but I'm not sure without seeing the actual build log from autocfg we'd be able to say much.</p>
</blockquote>
<p><span class="user-mention" data-user-id="116122">@simulacrum</span> so if I could get that, maybe we could get unstuck?</p>



<a name="207843682"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/182449-t-compiler/help/topic/petgraph%20wrong%20number%20of%20type%20arguments/near/207843682" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jake Goulding <a href="https://rust-lang.github.io/zulip_archive/stream/182449-t-compiler/help/topic/petgraph.20wrong.20number.20of.20type.20arguments.html#207843682">(Aug 24 2020 at 13:38)</a>:</h4>
<p><span class="user-mention" data-user-id="138448">@cuviper</span> How may I get debugging output from autocfg?</p>



<a name="207844023"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/182449-t-compiler/help/topic/petgraph%20wrong%20number%20of%20type%20arguments/near/207844023" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> simulacrum <a href="https://rust-lang.github.io/zulip_archive/stream/182449-t-compiler/help/topic/petgraph.20wrong.20number.20of.20type.20arguments.html#207844023">(Aug 24 2020 at 13:41)</a>:</h4>
<p>Realistically I'm pretty unhappy about crates doing this in the first place, seems a bit hacky. I guess there's not too many better solutions...</p>



<a name="207844044"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/182449-t-compiler/help/topic/petgraph%20wrong%20number%20of%20type%20arguments/near/207844044" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> simulacrum <a href="https://rust-lang.github.io/zulip_archive/stream/182449-t-compiler/help/topic/petgraph.20wrong.20number.20of.20type.20arguments.html#207844044">(Aug 24 2020 at 13:41)</a>:</h4>
<p>(well, cargo features are the norm, and something I'd prefer)</p>



<a name="207844621"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/182449-t-compiler/help/topic/petgraph%20wrong%20number%20of%20type%20arguments/near/207844621" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jake Goulding <a href="https://rust-lang.github.io/zulip_archive/stream/182449-t-compiler/help/topic/petgraph.20wrong.20number.20of.20type.20arguments.html#207844621">(Aug 24 2020 at 13:47)</a>:</h4>
<p>Heh, it's something I have a light fight with for SNAFU as well. Having the "auto" is really nice, _but_. My soft plan there is to keep having <code>v1_30</code> flags and a <code>auto_detect</code> flag, both of which are off-by-default.</p>



<a name="207845527"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/182449-t-compiler/help/topic/petgraph%20wrong%20number%20of%20type%20arguments/near/207845527" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jake Goulding <a href="https://rust-lang.github.io/zulip_archive/stream/182449-t-compiler/help/topic/petgraph.20wrong.20number.20of.20type.20arguments.html#207845527">(Aug 24 2020 at 13:54)</a>:</h4>
<p>Ah, here we go...</p>
<div class="codehilite"><pre><span></span><code>rustc command: &quot;DYLD_LIBRARY_PATH&quot;=&quot;/Users/shepmaster/Projects/rust/silicon/cross/build/x86_64-apple-darwin/stage0/lib&quot; &quot;/Users/shepmaster/Projects/rust/silicon/cross/build/x86_64-apple-darwin/stage0/bin/rustc&quot; &quot;--crate-name&quot; &quot;probe0&quot; &quot;--crate-type=lib&quot; &quot;--out-dir&quot; &quot;/Users/shepmaster/Projects/rust/silicon/cross/build/x86_64-apple-darwin/stage0-rustc/aarch64-apple-darwin/release/build/indexmap-2845cc4b8ddf50e9/out&quot; &quot;--emit=llvm-ir&quot; &quot;--cfg=bootstrap&quot; &quot;-Zdual-proc-macros&quot; &quot;-Zmacro-backtrace&quot; &quot;-Zosx-rpath-install-name&quot; &quot;-Clink-args=-Wl,-rpath,@loader_path/../lib&quot; &quot;-Zunstable-options&quot; &quot;-Wrustc::internal&quot; &quot;-Cprefer-dynamic&quot; &quot;-Cllvm-args=-import-instr-limit=10&quot; &quot;--target&quot; &quot;aarch64-apple-darwin&quot; &quot;-&quot; &quot;-Wrust_2018_idioms&quot; &quot;-Wunused_lifetimes&quot; &quot;-Dwarnings&quot; &quot;--sysroot&quot; &quot;/Users/shepmaster/Projects/rust/silicon/cross/build/x86_64-apple-darwin/stage0-sysroot&quot; &quot;-Z&quot; &quot;force-unstable-if-unmarked&quot;
sysroot: &quot;/Users/shepmaster/Projects/rust/silicon/cross/build/x86_64-apple-darwin/stage0-sysroot&quot;
libdir: &quot;/Users/shepmaster/Projects/rust/silicon/cross/build/x86_64-apple-darwin/stage0/lib&quot;
&lt;jemalloc&gt;: Unsupported system page size
error: Error loading target specification: Could not find specification for target &quot;aarch64-apple-darwin&quot;. Use `--print target-list` for a list of built-in targets
``
</code></pre></div>



<a name="207845815"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/182449-t-compiler/help/topic/petgraph%20wrong%20number%20of%20type%20arguments/near/207845815" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jake Goulding <a href="https://rust-lang.github.io/zulip_archive/stream/182449-t-compiler/help/topic/petgraph.20wrong.20number.20of.20type.20arguments.html#207845815">(Aug 24 2020 at 13:56)</a>:</h4>
<p>So it looks like there's a mismatch between which rustc is being used and the target</p>



<a name="207845900"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/182449-t-compiler/help/topic/petgraph%20wrong%20number%20of%20type%20arguments/near/207845900" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jake Goulding <a href="https://rust-lang.github.io/zulip_archive/stream/182449-t-compiler/help/topic/petgraph.20wrong.20number.20of.20type.20arguments.html#207845900">(Aug 24 2020 at 13:57)</a>:</h4>
<p>Because the bootstrap compiler doesn't know about aarch64-macos yet</p>



<a name="207846188"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/182449-t-compiler/help/topic/petgraph%20wrong%20number%20of%20type%20arguments/near/207846188" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Nelson <a href="https://rust-lang.github.io/zulip_archive/stream/182449-t-compiler/help/topic/petgraph.20wrong.20number.20of.20type.20arguments.html#207846188">(Aug 24 2020 at 13:59)</a>:</h4>
<p>you could try <code>RUSTFLAGS_NOT_BOOTSTRAP</code> maybe?</p>



<a name="207846541"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/182449-t-compiler/help/topic/petgraph%20wrong%20number%20of%20type%20arguments/near/207846541" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jake Goulding <a href="https://rust-lang.github.io/zulip_archive/stream/182449-t-compiler/help/topic/petgraph.20wrong.20number.20of.20type.20arguments.html#207846541">(Aug 24 2020 at 14:02)</a>:</h4>
<p>Perhaps! But I can't reason through if this <strong>is</strong> bootstrap or not</p>



<a name="207846545"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/182449-t-compiler/help/topic/petgraph%20wrong%20number%20of%20type%20arguments/near/207846545" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> simulacrum <a href="https://rust-lang.github.io/zulip_archive/stream/182449-t-compiler/help/topic/petgraph.20wrong.20number.20of.20type.20arguments.html#207846545">(Aug 24 2020 at 14:02)</a>:</h4>
<p>yeah, build compiler for build scripts is always(?) set to the bootstrap compiler</p>



<a name="207846574"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/182449-t-compiler/help/topic/petgraph%20wrong%20number%20of%20type%20arguments/near/207846574" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> simulacrum <a href="https://rust-lang.github.io/zulip_archive/stream/182449-t-compiler/help/topic/petgraph.20wrong.20number.20of.20type.20arguments.html#207846574">(Aug 24 2020 at 14:02)</a>:</h4>
<p>well, I mean, it has to be in this case, you don't have another compiler</p>



<a name="207846615"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/182449-t-compiler/help/topic/petgraph%20wrong%20number%20of%20type%20arguments/near/207846615" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> simulacrum <a href="https://rust-lang.github.io/zulip_archive/stream/182449-t-compiler/help/topic/petgraph.20wrong.20number.20of.20type.20arguments.html#207846615">(Aug 24 2020 at 14:03)</a>:</h4>
<p>looking at that command it looks like it's failing in stage0 compiler artifacts compilation</p>



<a name="207846620"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/182449-t-compiler/help/topic/petgraph%20wrong%20number%20of%20type%20arguments/near/207846620" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jake Goulding <a href="https://rust-lang.github.io/zulip_archive/stream/182449-t-compiler/help/topic/petgraph.20wrong.20number.20of.20type.20arguments.html#207846620">(Aug 24 2020 at 14:03)</a>:</h4>
<p>One thing I don't understand is why this previously worked and recently changed.</p>



<a name="207846638"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/182449-t-compiler/help/topic/petgraph%20wrong%20number%20of%20type%20arguments/near/207846638" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> simulacrum <a href="https://rust-lang.github.io/zulip_archive/stream/182449-t-compiler/help/topic/petgraph.20wrong.20number.20of.20type.20arguments.html#207846638">(Aug 24 2020 at 14:03)</a>:</h4>
<p>indexmap I think only recently started doing this perhaps?</p>



<a name="207846686"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/182449-t-compiler/help/topic/petgraph%20wrong%20number%20of%20type%20arguments/near/207846686" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> simulacrum <a href="https://rust-lang.github.io/zulip_archive/stream/182449-t-compiler/help/topic/petgraph.20wrong.20number.20of.20type.20arguments.html#207846686">(Aug 24 2020 at 14:03)</a>:</h4>
<p>maybe not, not sure :)</p>



<a name="207846759"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/182449-t-compiler/help/topic/petgraph%20wrong%20number%20of%20type%20arguments/near/207846759" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jake Goulding <a href="https://rust-lang.github.io/zulip_archive/stream/182449-t-compiler/help/topic/petgraph.20wrong.20number.20of.20type.20arguments.html#207846759">(Aug 24 2020 at 14:04)</a>:</h4>
<p>It'd be fine to use the bootstrap compiler, so long as the <code>--target</code> path was passed</p>



<a name="207846786"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/182449-t-compiler/help/topic/petgraph%20wrong%20number%20of%20type%20arguments/near/207846786" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> simulacrum <a href="https://rust-lang.github.io/zulip_archive/stream/182449-t-compiler/help/topic/petgraph.20wrong.20number.20of.20type.20arguments.html#207846786">(Aug 24 2020 at 14:04)</a>:</h4>
<p>right, I guess someone is synthesizing a wrong rustc invocation, probably autocfg</p>



<a name="207846814"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/182449-t-compiler/help/topic/petgraph%20wrong%20number%20of%20type%20arguments/near/207846814" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jake Goulding <a href="https://rust-lang.github.io/zulip_archive/stream/182449-t-compiler/help/topic/petgraph.20wrong.20number.20of.20type.20arguments.html#207846814">(Aug 24 2020 at 14:04)</a>:</h4>
<p>Relevant part of my command line:</p>
<div class="codehilite"><pre><span></span><code>../../x.py install -i --stage 1 --host ../aarch64-apple-darwin.json --target aarch64-apple-darwin,x86_64-apple-darwin
</code></pre></div>



<a name="207846858"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/182449-t-compiler/help/topic/petgraph%20wrong%20number%20of%20type%20arguments/near/207846858" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> simulacrum <a href="https://rust-lang.github.io/zulip_archive/stream/182449-t-compiler/help/topic/petgraph.20wrong.20number.20of.20type.20arguments.html#207846858">(Aug 24 2020 at 14:05)</a>:</h4>
<p>oh</p>



<a name="207846890"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/182449-t-compiler/help/topic/petgraph%20wrong%20number%20of%20type%20arguments/near/207846890" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> simulacrum <a href="https://rust-lang.github.io/zulip_archive/stream/182449-t-compiler/help/topic/petgraph.20wrong.20number.20of.20type.20arguments.html#207846890">(Aug 24 2020 at 14:05)</a>:</h4>
<p>wait, that seems weird, why do you have .json for host but not target?</p>



<a name="207846946"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/182449-t-compiler/help/topic/petgraph%20wrong%20number%20of%20type%20arguments/near/207846946" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> simulacrum <a href="https://rust-lang.github.io/zulip_archive/stream/182449-t-compiler/help/topic/petgraph.20wrong.20number.20of.20type.20arguments.html#207846946">(Aug 24 2020 at 14:05)</a>:</h4>
<p>you can see that the bootstrap compiler is being run with "--target" "aarch64-apple-darwin"</p>



<a name="207846997"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/182449-t-compiler/help/topic/petgraph%20wrong%20number%20of%20type%20arguments/near/207846997" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jake Goulding <a href="https://rust-lang.github.io/zulip_archive/stream/182449-t-compiler/help/topic/petgraph.20wrong.20number.20of.20type.20arguments.html#207846997">(Aug 24 2020 at 14:06)</a>:</h4>
<p>I agree it's weird, but I'll fall back on the old chestnuts of "this used to work" and "I don't fully understand the build process"</p>



<a name="207847119"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/182449-t-compiler/help/topic/petgraph%20wrong%20number%20of%20type%20arguments/near/207847119" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jake Goulding <a href="https://rust-lang.github.io/zulip_archive/stream/182449-t-compiler/help/topic/petgraph.20wrong.20number.20of.20type.20arguments.html#207847119">(Aug 24 2020 at 14:07)</a>:</h4>
<p>I'm guessing that the most expedient fix would be for me to bump the bootstrap compiler so that I can abandon the json file</p>



<a name="207847163"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/182449-t-compiler/help/topic/petgraph%20wrong%20number%20of%20type%20arguments/near/207847163" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jake Goulding <a href="https://rust-lang.github.io/zulip_archive/stream/182449-t-compiler/help/topic/petgraph.20wrong.20number.20of.20type.20arguments.html#207847163">(Aug 24 2020 at 14:07)</a>:</h4>
<p>But I was thinking I might as well try to fix weird thing while I'm here, if it seems useful</p>



<a name="207847169"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/182449-t-compiler/help/topic/petgraph%20wrong%20number%20of%20type%20arguments/near/207847169" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> bjorn3 <a href="https://rust-lang.github.io/zulip_archive/stream/182449-t-compiler/help/topic/petgraph.20wrong.20number.20of.20type.20arguments.html#207847169">(Aug 24 2020 at 14:07)</a>:</h4>
<p><code>--host</code> is what you build a compiler for. <code>--target</code> is what you build libstd for.</p>



<a name="207847487"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/182449-t-compiler/help/topic/petgraph%20wrong%20number%20of%20type%20arguments/near/207847487" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jake Goulding <a href="https://rust-lang.github.io/zulip_archive/stream/182449-t-compiler/help/topic/petgraph.20wrong.20number.20of.20type.20arguments.html#207847487">(Aug 24 2020 at 14:11)</a>:</h4>
<p>Sure. And the libstd is seemingly built with the compiler built from <code>--host</code>, which is why I could get away with using the built-in target then.</p>



<a name="207847862"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/182449-t-compiler/help/topic/petgraph%20wrong%20number%20of%20type%20arguments/near/207847862" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> simulacrum <a href="https://rust-lang.github.io/zulip_archive/stream/182449-t-compiler/help/topic/petgraph.20wrong.20number.20of.20type.20arguments.html#207847862">(Aug 24 2020 at 14:14)</a>:</h4>
<p>I <em>think</em> the problem is that cargo sets $TARGET for build scripts to the json-less path</p>



<a name="207847905"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/182449-t-compiler/help/topic/petgraph%20wrong%20number%20of%20type%20arguments/near/207847905" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> simulacrum <a href="https://rust-lang.github.io/zulip_archive/stream/182449-t-compiler/help/topic/petgraph.20wrong.20number.20of.20type.20arguments.html#207847905">(Aug 24 2020 at 14:14)</a>:</h4>
<p>but without knowing whether cargo is passed the json-less path, I'm not sure if that's cargo's fault or not</p>



<a name="207847939"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/182449-t-compiler/help/topic/petgraph%20wrong%20number%20of%20type%20arguments/near/207847939" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> simulacrum <a href="https://rust-lang.github.io/zulip_archive/stream/182449-t-compiler/help/topic/petgraph.20wrong.20number.20of.20type.20arguments.html#207847939">(Aug 24 2020 at 14:14)</a>:</h4>
<p>(json-less path =&gt; not a path at all)</p>



<a name="207848986"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/182449-t-compiler/help/topic/petgraph%20wrong%20number%20of%20type%20arguments/near/207848986" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> simulacrum <a href="https://rust-lang.github.io/zulip_archive/stream/182449-t-compiler/help/topic/petgraph.20wrong.20number.20of.20type.20arguments.html#207848986">(Aug 24 2020 at 14:23)</a>:</h4>
<p><span class="user-mention" data-user-id="116155">@Jake Goulding</span> do you have the cargo invocation?</p>



<a name="207849400"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/182449-t-compiler/help/topic/petgraph%20wrong%20number%20of%20type%20arguments/near/207849400" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jake Goulding <a href="https://rust-lang.github.io/zulip_archive/stream/182449-t-compiler/help/topic/petgraph.20wrong.20number.20of.20type.20arguments.html#207849400">(Aug 24 2020 at 14:26)</a>:</h4>
<p>I do not right now, but after this test with upgrading bootstrap I can get it again.</p>



<a name="207849547"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/182449-t-compiler/help/topic/petgraph%20wrong%20number%20of%20type%20arguments/near/207849547" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jake Goulding <a href="https://rust-lang.github.io/zulip_archive/stream/182449-t-compiler/help/topic/petgraph.20wrong.20number.20of.20type.20arguments.html#207849547">(Aug 24 2020 at 14:27)</a>:</h4>
<p><span class="user-mention" data-user-id="116122">@simulacrum</span> If I rebased with your PR for 1.46, would I also get a bootstrap bump?</p>



<a name="207849575"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/182449-t-compiler/help/topic/petgraph%20wrong%20number%20of%20type%20arguments/near/207849575" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> simulacrum <a href="https://rust-lang.github.io/zulip_archive/stream/182449-t-compiler/help/topic/petgraph.20wrong.20number.20of.20type.20arguments.html#207849575">(Aug 24 2020 at 14:27)</a>:</h4>
<p>hm which PR?</p>



<a name="207849661"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/182449-t-compiler/help/topic/petgraph%20wrong%20number%20of%20type%20arguments/near/207849661" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jake Goulding <a href="https://rust-lang.github.io/zulip_archive/stream/182449-t-compiler/help/topic/petgraph.20wrong.20number.20of.20type.20arguments.html#207849661">(Aug 24 2020 at 14:28)</a>:</h4>
<p>Oh, I guess you just reviewed it, not authored it (<a href="https://github.com/rust-lang/rust/pull/75878">https://github.com/rust-lang/rust/pull/75878</a>)</p>



<a name="207849711"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/182449-t-compiler/help/topic/petgraph%20wrong%20number%20of%20type%20arguments/near/207849711" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> simulacrum <a href="https://rust-lang.github.io/zulip_archive/stream/182449-t-compiler/help/topic/petgraph.20wrong.20number.20of.20type.20arguments.html#207849711">(Aug 24 2020 at 14:28)</a>:</h4>
<p>oh no you shouldn't rebase with that PR as your tip</p>



<a name="207849721"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/182449-t-compiler/help/topic/petgraph%20wrong%20number%20of%20type%20arguments/near/207849721" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jake Goulding <a href="https://rust-lang.github.io/zulip_archive/stream/182449-t-compiler/help/topic/petgraph.20wrong.20number.20of.20type.20arguments.html#207849721">(Aug 24 2020 at 14:28)</a>:</h4>
<p>Ok, good.</p>



<a name="207849766"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/182449-t-compiler/help/topic/petgraph%20wrong%20number%20of%20type%20arguments/near/207849766" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jake Goulding <a href="https://rust-lang.github.io/zulip_archive/stream/182449-t-compiler/help/topic/petgraph.20wrong.20number.20of.20type.20arguments.html#207849766">(Aug 24 2020 at 14:29)</a>:</h4>
<p>Oh, it's even going to the stable branch. yes.</p>



<a name="207849774"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/182449-t-compiler/help/topic/petgraph%20wrong%20number%20of%20type%20arguments/near/207849774" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> simulacrum <a href="https://rust-lang.github.io/zulip_archive/stream/182449-t-compiler/help/topic/petgraph.20wrong.20number.20of.20type.20arguments.html#207849774">(Aug 24 2020 at 14:29)</a>:</h4>
<p>if you want to bump bootstrap, edit src/stage0.txt to set date: to 2020-08-22</p>



<a name="207849788"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/182449-t-compiler/help/topic/petgraph%20wrong%20number%20of%20type%20arguments/near/207849788" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> simulacrum <a href="https://rust-lang.github.io/zulip_archive/stream/182449-t-compiler/help/topic/petgraph.20wrong.20number.20of.20type.20arguments.html#207849788">(Aug 24 2020 at 14:29)</a>:</h4>
<p>(or maybe 21, not sure)</p>



<a name="207849814"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/182449-t-compiler/help/topic/petgraph%20wrong%20number%20of%20type%20arguments/near/207849814" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jake Goulding <a href="https://rust-lang.github.io/zulip_archive/stream/182449-t-compiler/help/topic/petgraph.20wrong.20number.20of.20type.20arguments.html#207849814">(Aug 24 2020 at 14:29)</a>:</h4>
<p>Yeah, that's what I did, but then was looking for any other PRs that might have been updating it.</p>



<a name="207849842"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/182449-t-compiler/help/topic/petgraph%20wrong%20number%20of%20type%20arguments/near/207849842" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> simulacrum <a href="https://rust-lang.github.io/zulip_archive/stream/182449-t-compiler/help/topic/petgraph.20wrong.20number.20of.20type.20arguments.html#207849842">(Aug 24 2020 at 14:29)</a>:</h4>
<p>I think we talked about bumping but never actually did. We rarely do.</p>



<a name="207849894"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/182449-t-compiler/help/topic/petgraph%20wrong%20number%20of%20type%20arguments/near/207849894" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jake Goulding <a href="https://rust-lang.github.io/zulip_archive/stream/182449-t-compiler/help/topic/petgraph.20wrong.20number.20of.20type.20arguments.html#207849894">(Aug 24 2020 at 14:30)</a>:</h4>
<p>I suppose there will be a normal bump in the next week or so to get the next <code>beta.0</code>?</p>



<a name="207849913"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/182449-t-compiler/help/topic/petgraph%20wrong%20number%20of%20type%20arguments/near/207849913" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> simulacrum <a href="https://rust-lang.github.io/zulip_archive/stream/182449-t-compiler/help/topic/petgraph.20wrong.20number.20of.20type.20arguments.html#207849913">(Aug 24 2020 at 14:30)</a>:</h4>
<p>yeah, to 1.47-beta</p>



<a name="207850256"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/182449-t-compiler/help/topic/petgraph%20wrong%20number%20of%20type%20arguments/near/207850256" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> simulacrum <a href="https://rust-lang.github.io/zulip_archive/stream/182449-t-compiler/help/topic/petgraph.20wrong.20number.20of.20type.20arguments.html#207850256">(Aug 24 2020 at 14:33)</a>:</h4>
<p><span class="user-mention" data-user-id="116155">@Jake Goulding</span> to be clear, I suspect that there's either a cargo or bootstrap bug (though maybe hard to fix) wrt to treatment of $TARGET when <code>--target</code> is a file path, not a compiler-known triple</p>



<a name="207850276"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/182449-t-compiler/help/topic/petgraph%20wrong%20number%20of%20type%20arguments/near/207850276" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> simulacrum <a href="https://rust-lang.github.io/zulip_archive/stream/182449-t-compiler/help/topic/petgraph.20wrong.20number.20of.20type.20arguments.html#207850276">(Aug 24 2020 at 14:33)</a>:</h4>
<p>I suspect a cargo bug</p>



<a name="207850642"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/182449-t-compiler/help/topic/petgraph%20wrong%20number%20of%20type%20arguments/near/207850642" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jake Goulding <a href="https://rust-lang.github.io/zulip_archive/stream/182449-t-compiler/help/topic/petgraph.20wrong.20number.20of.20type.20arguments.html#207850642">(Aug 24 2020 at 14:36)</a>:</h4>
<p>sure. I certainly changed a lot of places in bootstrap to try and pass the file around, so I'd lean towards believing there's something I missed, TBH.</p>



<a name="207851018"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/182449-t-compiler/help/topic/petgraph%20wrong%20number%20of%20type%20arguments/near/207851018" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> simulacrum <a href="https://rust-lang.github.io/zulip_archive/stream/182449-t-compiler/help/topic/petgraph.20wrong.20number.20of.20type.20arguments.html#207851018">(Aug 24 2020 at 14:39)</a>:</h4>
<p>well I'd expect things to fail much earlier if we're not passing it to cargo correctly</p>



<a name="207851031"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/182449-t-compiler/help/topic/petgraph%20wrong%20number%20of%20type%20arguments/near/207851031" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> simulacrum <a href="https://rust-lang.github.io/zulip_archive/stream/182449-t-compiler/help/topic/petgraph.20wrong.20number.20of.20type.20arguments.html#207851031">(Aug 24 2020 at 14:39)</a>:</h4>
<p>and cargo is in charge of $TARGET</p>



<a name="207852881"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/182449-t-compiler/help/topic/petgraph%20wrong%20number%20of%20type%20arguments/near/207852881" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jake Goulding <a href="https://rust-lang.github.io/zulip_archive/stream/182449-t-compiler/help/topic/petgraph.20wrong.20number.20of.20type.20arguments.html#207852881">(Aug 24 2020 at 14:53)</a>:</h4>
<p>Just doing the bootstrap bump was sufficient, so that's good.</p>



<a name="207852947"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/182449-t-compiler/help/topic/petgraph%20wrong%20number%20of%20type%20arguments/near/207852947" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jake Goulding <a href="https://rust-lang.github.io/zulip_archive/stream/182449-t-compiler/help/topic/petgraph.20wrong.20number.20of.20type.20arguments.html#207852947">(Aug 24 2020 at 14:53)</a>:</h4>
<p>Now to restart and get that cargo error.</p>



<a name="207856081"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/182449-t-compiler/help/topic/petgraph%20wrong%20number%20of%20type%20arguments/near/207856081" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jake Goulding <a href="https://rust-lang.github.io/zulip_archive/stream/182449-t-compiler/help/topic/petgraph.20wrong.20number.20of.20type.20arguments.html#207856081">(Aug 24 2020 at 15:17)</a>:</h4>
<p>It's almost like it <em>doesn't</em> run Cargo again, which is nonsensical</p>



<a name="207856296"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/182449-t-compiler/help/topic/petgraph%20wrong%20number%20of%20type%20arguments/near/207856296" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jake Goulding <a href="https://rust-lang.github.io/zulip_archive/stream/182449-t-compiler/help/topic/petgraph.20wrong.20number.20of.20type.20arguments.html#207856296">(Aug 24 2020 at 15:19)</a>:</h4>
<p>Starting at the end of the log, I search backward for <code>indexmap-1.5.1/build.rs</code>:</p>
<div class="codehilite"><pre><span></span><code>rustc command: &quot;DYLD_LIBRARY_PATH&quot;=&quot;/Users/shepmaster/Projects/rust/silicon/cross/build/x86_64-apple-darwin/stage0/lib&quot; &quot;/Users/shepmaster/Projects/rust/silicon/cross/build/x86_64-apple-darwin/stage0/bin/rustc&quot; &quot;--crate-name&quot; &quot;build_script_build&quot; &quot;--edition=2018&quot; &quot;/Use
rs/shepmaster/.cargo/registry/src/github.com-1ecc6299db9ec823/indexmap-1.5.1/build.rs&quot; &quot;--error-format=json&quot; &quot;--json=diagnostic-rendered-ansi&quot; &quot;--crate-type&quot; &quot;bin&quot; &quot;--emit=dep-info,link&quot; &quot;-C&quot; &quot;opt-level=3&quot; &quot;-Cembed-bitcode=no&quot; &quot;-C&quot; &quot;debuginfo=0&quot; &quot;-C&quot; &quot;metadata=8c660252
da0efa04&quot; &quot;-C&quot; &quot;extra-filename=-8c660252da0efa04&quot; &quot;--out-dir&quot; &quot;/Users/shepmaster/Projects/rust/silicon/cross/build/x86_64-apple-darwin/stage0-rustc/release/build/indexmap-8c660252da0efa04&quot; &quot;-L&quot; &quot;dependency=/Users/shepmaster/Projects/rust/silicon/cross/build/x86_64-appl
e-darwin/stage0-rustc/release/deps&quot; &quot;--extern&quot; &quot;autocfg=/Users/shepmaster/Projects/rust/silicon/cross/build/x86_64-apple-darwin/stage0-rustc/release/deps/libautocfg-29bfb26e4fe2686c.rlib&quot; &quot;--cap-lints&quot; &quot;warn&quot; &quot;-Zbinary-dep-depinfo&quot; &quot;-Wrust_2018_idioms&quot; &quot;-Wunused_lifeti
mes&quot; &quot;-Dwarnings&quot;
</code></pre></div>


<p>Then, the next preceding line that mentions indexmap is</p>
<div class="codehilite"><pre><span></span><code>Copy &quot;/Users/shepmaster/Projects/rust/silicon/cross/build/x86_64-apple-darwin/stage0-rustc/x86_64-apple-darwin/release/deps/libindexmap-6714a9f0e483ccbd.rlib&quot; to &quot;/Users/shepmaster/Projects/rust/silicon/cross/build/x86_64-apple-darwin/stage0-sysroot/lib/rustlib/x86_64-
apple-darwin/lib/libindexmap-6714a9f0e483ccbd.rlib&quot;
</code></pre></div>



<a name="207857362"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/182449-t-compiler/help/topic/petgraph%20wrong%20number%20of%20type%20arguments/near/207857362" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> simulacrum <a href="https://rust-lang.github.io/zulip_archive/stream/182449-t-compiler/help/topic/petgraph.20wrong.20number.20of.20type.20arguments.html#207857362">(Aug 24 2020 at 15:27)</a>:</h4>
<p>can you paste the full log? Cargo won't be run to build just indexmap</p>



<a name="207857458"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/182449-t-compiler/help/topic/petgraph%20wrong%20number%20of%20type%20arguments/near/207857458" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jake Goulding <a href="https://rust-lang.github.io/zulip_archive/stream/182449-t-compiler/help/topic/petgraph.20wrong.20number.20of.20type.20arguments.html#207857458">(Aug 24 2020 at 15:27)</a>:</h4>
<p>sure — you have a suggested location for ~4MB of text?</p>



<a name="207857540"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/182449-t-compiler/help/topic/petgraph%20wrong%20number%20of%20type%20arguments/near/207857540" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> simulacrum <a href="https://rust-lang.github.io/zulip_archive/stream/182449-t-compiler/help/topic/petgraph.20wrong.20number.20of.20type.20arguments.html#207857540">(Aug 24 2020 at 15:28)</a>:</h4>
<p>I'm only interested in running: "/home/mark/Build/rust/build/x86_64-unknown-linux-gnu/stage0/bin/cargo" "build" "--target" "x86_64-unknown-linux-gnu" "-Zbinary-dep-depinfo" "-j" "32" "-v" "--release" "--manifest-path" "/home/mark/Build/rust/src/tools/rustdoc/Cargo.toml"<br>
and similar</p>



<a name="207857627"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/182449-t-compiler/help/topic/petgraph%20wrong%20number%20of%20type%20arguments/near/207857627" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jake Goulding <a href="https://rust-lang.github.io/zulip_archive/stream/182449-t-compiler/help/topic/petgraph.20wrong.20number.20of.20type.20arguments.html#207857627">(Aug 24 2020 at 15:28)</a>:</h4>
<p>Well that will never work... <span aria-label="cry" class="emoji emoji-1f622" role="img" title="cry">:cry:</span> My name's not <code>mark</code> <span aria-label="wink" class="emoji emoji-1f609" role="img" title="wink">:wink:</span></p>



<a name="207857886"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/182449-t-compiler/help/topic/petgraph%20wrong%20number%20of%20type%20arguments/near/207857886" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jake Goulding <a href="https://rust-lang.github.io/zulip_archive/stream/182449-t-compiler/help/topic/petgraph.20wrong.20number.20of.20type.20arguments.html#207857886">(Aug 24 2020 at 15:30)</a>:</h4>
<p><code>./build/x86_64-apple-darwin/stage0/bin/cargo "build" "--target" "x86_64-apple-darwin" "-Zbinary-dep-depinfo" "-j" "32" "-v" "--release" "--manifest-path" "../../src/tools/rustdoc/Cargo.toml"</code> — what's the magic "let me use <code>-Z</code> on beta env var?</p>



<a name="207858099"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/182449-t-compiler/help/topic/petgraph%20wrong%20number%20of%20type%20arguments/near/207858099" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> simulacrum <a href="https://rust-lang.github.io/zulip_archive/stream/182449-t-compiler/help/topic/petgraph.20wrong.20number.20of.20type.20arguments.html#207858099">(Aug 24 2020 at 15:32)</a>:</h4>
<p><span class="user-mention" data-user-id="116155">@Jake Goulding</span> no, I mean that running is part of the 4MB log hopefully</p>



<a name="207858136"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/182449-t-compiler/help/topic/petgraph%20wrong%20number%20of%20type%20arguments/near/207858136" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> simulacrum <a href="https://rust-lang.github.io/zulip_archive/stream/182449-t-compiler/help/topic/petgraph.20wrong.20number.20of.20type.20arguments.html#207858136">(Aug 24 2020 at 15:32)</a>:</h4>
<p>and the other running cargo lines</p>



<a name="207858269"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/182449-t-compiler/help/topic/petgraph%20wrong%20number%20of%20type%20arguments/near/207858269" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jake Goulding <a href="https://rust-lang.github.io/zulip_archive/stream/182449-t-compiler/help/topic/petgraph.20wrong.20number.20of.20type.20arguments.html#207858269">(Aug 24 2020 at 15:33)</a>:</h4>
<p>ah.</p>
<div class="codehilite"><pre><span></span><code>% grep -F &#39;&quot;build&quot;&#39; /tmp/build.log
running: &quot;/Users/shepmaster/Projects/rust/silicon/cross/build/x86_64-apple-darwin/stage0/bin/cargo&quot; &quot;build&quot; &quot;--target&quot; &quot;x86_64-apple-darwin&quot; &quot;-Zbinary-dep-depinfo&quot; &quot;-j&quot; &quot;4&quot; &quot;-v&quot; &quot;-v&quot; &quot;-v&quot; &quot;-v&quot; &quot;-v&quot; &quot;--release&quot; &quot;--features&quot; &quot;panic-unwind backtrace compiler-builtins-c&quot; &quot;--manifest-path&quot; &quot;/Users/shepmaster/Projects/rust/library/test/Cargo.toml&quot; &quot;--message-format&quot; &quot;json-render-diagnostics&quot;
running: &quot;/Users/shepmaster/Projects/rust/silicon/cross/build/x86_64-apple-darwin/stage0/bin/cargo&quot; &quot;build&quot; &quot;--target&quot; &quot;x86_64-apple-darwin&quot; &quot;-Zbinary-dep-depinfo&quot; &quot;-j&quot; &quot;4&quot; &quot;-v&quot; &quot;-v&quot; &quot;-v&quot; &quot;-v&quot; &quot;-v&quot; &quot;--release&quot; &quot;--features&quot; &quot; llvm&quot; &quot;--manifest-path&quot; &quot;/Users/shepmaster/Projects/rust/src/rustc/Cargo.toml&quot; &quot;--message-format&quot; &quot;json-render-diagnostics&quot;
running: &quot;/Users/shepmaster/Projects/rust/silicon/cross/build/x86_64-apple-darwin/stage0/bin/cargo&quot; &quot;build&quot; &quot;--target&quot; &quot;../aarch64-apple-darwin.json&quot; &quot;-Zbinary-dep-depinfo&quot; &quot;-j&quot; &quot;4&quot; &quot;-v&quot; &quot;-v&quot; &quot;-v&quot; &quot;-v&quot; &quot;-v&quot; &quot;--release&quot; &quot;--features&quot; &quot;panic-unwind backtrace compiler-builtins-c&quot; &quot;--manifest-path&quot; &quot;/Users/shepmaster/Projects/rust/library/test/Cargo.toml&quot; &quot;--message-format&quot; &quot;json-render-diagnostics&quot;
running: &quot;/Users/shepmaster/Projects/rust/silicon/cross/build/x86_64-apple-darwin/stage0/bin/cargo&quot; &quot;build&quot; &quot;--target&quot; &quot;../aarch64-apple-darwin.json&quot; &quot;-Zdual-proc-macros&quot; &quot;-Zbinary-dep-depinfo&quot; &quot;-j&quot; &quot;4&quot; &quot;-v&quot; &quot;-v&quot; &quot;-v&quot; &quot;-v&quot; &quot;-v&quot; &quot;--release&quot; &quot;--features&quot; &quot; llvm&quot; &quot;--manifest-path&quot; &quot;/Users/shepmaster/Projects/rust/src/rustc/Cargo.toml&quot; &quot;--message-format&quot; &quot;json-render-diagnostics&quot;
command did not execute successfully: &quot;/Users/shepmaster/Projects/rust/silicon/cross/build/x86_64-apple-darwin/stage0/bin/cargo&quot; &quot;build&quot; &quot;--target&quot; &quot;../aarch64-apple-darwin.json&quot; &quot;-Zdual-proc-macros&quot; &quot;-Zbinary-dep-depinfo&quot; &quot;-j&quot; &quot;4&quot; &quot;-v&quot; &quot;-v&quot; &quot;-v&quot; &quot;-v&quot; &quot;-v&quot; &quot;--release&quot; &quot;--features&quot; &quot; llvm&quot; &quot;--manifest-path&quot; &quot;/Users/shepmaster/Projects/rust/src/rustc/Cargo.toml&quot; &quot;--message-format&quot; &quot;json-render-diagnostics&quot;
</code></pre></div>



<a name="207858270"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/182449-t-compiler/help/topic/petgraph%20wrong%20number%20of%20type%20arguments/near/207858270" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> simulacrum <a href="https://rust-lang.github.io/zulip_archive/stream/182449-t-compiler/help/topic/petgraph.20wrong.20number.20of.20type.20arguments.html#207858270">(Aug 24 2020 at 15:33)</a>:</h4>
<p>My guess is that we'll see --target aarch64....json  being passe to Cargo, but cargo is passing it without .json to build scripts in $TARGET, which means autocfg will not (in general) work</p>



<a name="207858297"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/182449-t-compiler/help/topic/petgraph%20wrong%20number%20of%20type%20arguments/near/207858297" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> simulacrum <a href="https://rust-lang.github.io/zulip_archive/stream/182449-t-compiler/help/topic/petgraph.20wrong.20number.20of.20type.20arguments.html#207858297">(Aug 24 2020 at 15:33)</a>:</h4>
<p>yeah that seems to be the case</p>



<a name="207858339"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/182449-t-compiler/help/topic/petgraph%20wrong%20number%20of%20type%20arguments/near/207858339" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> simulacrum <a href="https://rust-lang.github.io/zulip_archive/stream/182449-t-compiler/help/topic/petgraph.20wrong.20number.20of.20type.20arguments.html#207858339">(Aug 24 2020 at 15:33)</a>:</h4>
<p>so, in general, this is a cargo "bug" or autocfg is buggy, depending on how you think about what $TARGET means</p>



<a name="207858371"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/182449-t-compiler/help/topic/petgraph%20wrong%20number%20of%20type%20arguments/near/207858371" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jake Goulding <a href="https://rust-lang.github.io/zulip_archive/stream/182449-t-compiler/help/topic/petgraph.20wrong.20number.20of.20type.20arguments.html#207858371">(Aug 24 2020 at 15:34)</a>:</h4>
<p>Very strange, as doing this kind of thing is super common for embedded</p>



<a name="207858515"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/182449-t-compiler/help/topic/petgraph%20wrong%20number%20of%20type%20arguments/near/207858515" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> simulacrum <a href="https://rust-lang.github.io/zulip_archive/stream/182449-t-compiler/help/topic/petgraph.20wrong.20number.20of.20type.20arguments.html#207858515">(Aug 24 2020 at 15:35)</a>:</h4>
<p>well, I imagine that it's relatively rare for build scripts to do this</p>



<a name="207858553"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/182449-t-compiler/help/topic/petgraph%20wrong%20number%20of%20type%20arguments/near/207858553" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> simulacrum <a href="https://rust-lang.github.io/zulip_archive/stream/182449-t-compiler/help/topic/petgraph.20wrong.20number.20of.20type.20arguments.html#207858553">(Aug 24 2020 at 15:35)</a>:</h4>
<p>afaik most build scripts don't invoke rustc, or if they do, they don't invoke it in a target-specific setting</p>



<a name="207859296"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/182449-t-compiler/help/topic/petgraph%20wrong%20number%20of%20type%20arguments/near/207859296" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> simulacrum <a href="https://rust-lang.github.io/zulip_archive/stream/182449-t-compiler/help/topic/petgraph.20wrong.20number.20of.20type.20arguments.html#207859296">(Aug 24 2020 at 15:41)</a>:</h4>
<p>If you could file a cargo issue and cc me on it that'd be great</p>



<a name="207860389"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/182449-t-compiler/help/topic/petgraph%20wrong%20number%20of%20type%20arguments/near/207860389" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jake Goulding <a href="https://rust-lang.github.io/zulip_archive/stream/182449-t-compiler/help/topic/petgraph.20wrong.20number.20of.20type.20arguments.html#207860389">(Aug 24 2020 at 15:52)</a>:</h4>
<p>Sure. Any thoughts on how to make a repro? I was thinking something like</p>
<div class="codehilite"><pre><span></span><code># Same target as default, but in a file
rustc +nightly -Z unstable-options --print target-spec-json &gt; my-target.json
# Try to use it
cargo +nightly build --target $PWD/my-target.json -Z build-std
</code></pre></div>


<p>but that seems to have issues compiling std.</p>



<a name="207861273"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/182449-t-compiler/help/topic/petgraph%20wrong%20number%20of%20type%20arguments/near/207861273" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jake Goulding <a href="https://rust-lang.github.io/zulip_archive/stream/182449-t-compiler/help/topic/petgraph.20wrong.20number.20of.20type.20arguments.html#207861273">(Aug 24 2020 at 15:59)</a>:</h4>
<p><span class="user-mention" data-user-id="120518">@Eric Huss</span>  does this ring any bells?</p>
<div class="codehilite"><pre><span></span><code>% cargo +nightly build --target $PWD/my-target.json -Z build-std --verbose

...

error[E0432]: unresolved imports `crate::sys_common::net::getsockopt`, `crate::sys_common::net::setsockopt`, `crate::sys_common::net::sockaddr_to_addr`
 --&gt; /Users/shep/.rustup/toolchains/nightly-x86_64-apple-darwin/lib/rustlib/src/rust/library/std/src/sys/unix/net.rs:8:30
  |
8 | use crate::sys_common::net::{getsockopt, setsockopt, sockaddr_to_addr};
  |                              ^^^^^^^^^^  ^^^^^^^^^^  ^^^^^^^^^^^^^^^^ no `sockaddr_to_addr` in `sys::unix::net`
  |                              |           |
  |                              |           no `setsockopt` in `sys::unix::net`
  |                              no `getsockopt` in `sys::unix::net`

error[E0432]: unresolved import `crate::sys_common::net::LookupHost`
  --&gt; /Users/shep/.rustup/toolchains/nightly-x86_64-apple-darwin/lib/rustlib/src/rust/library/std/src/net/addr.rs:12:5
   |
12 | use crate::sys_common::net::LookupHost;
   |     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ no `LookupHost` in `sys::unix::net`

error[E0433]: failed to resolve: could not find `TcpStream` in `net_imp`
</code></pre></div>



<a name="207862237"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/182449-t-compiler/help/topic/petgraph%20wrong%20number%20of%20type%20arguments/near/207862237" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> bjorn3 <a href="https://rust-lang.github.io/zulip_archive/stream/182449-t-compiler/help/topic/petgraph.20wrong.20number.20of.20type.20arguments.html#207862237">(Aug 24 2020 at 16:09)</a>:</h4>
<p>Does <a href="https://github.com/rust-lang/rust/blob/80fb3f3139c7dee7f211964c6a0b3ccb04b83d5e/library/std/build.rs#L41">https://github.com/rust-lang/rust/blob/80fb3f3139c7dee7f211964c6a0b3ccb04b83d5e/library/std/build.rs#L41</a> get run or the fallback <a href="https://github.com/rust-lang/rust/blob/80fb3f3139c7dee7f211964c6a0b3ccb04b83d5e/library/std/build.rs#L91">https://github.com/rust-lang/rust/blob/80fb3f3139c7dee7f211964c6a0b3ccb04b83d5e/library/std/build.rs#L91</a>? What is the name of the target spec json file?</p>



<a name="207862377"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/182449-t-compiler/help/topic/petgraph%20wrong%20number%20of%20type%20arguments/near/207862377" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jake Goulding <a href="https://rust-lang.github.io/zulip_archive/stream/182449-t-compiler/help/topic/petgraph.20wrong.20number.20of.20type.20arguments.html#207862377">(Aug 24 2020 at 16:10)</a>:</h4>
<p>You mean in the (attempted) repro? <code>--target $PWD/my-target.json</code></p>



<a name="207862470"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/182449-t-compiler/help/topic/petgraph%20wrong%20number%20of%20type%20arguments/near/207862470" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> bjorn3 <a href="https://rust-lang.github.io/zulip_archive/stream/182449-t-compiler/help/topic/petgraph.20wrong.20number.20of.20type.20arguments.html#207862470">(Aug 24 2020 at 16:11)</a>:</h4>
<p>Yes. Does it work if you name the file <code>$PWD/aarch64-apple-darwin.json</code> or something like that with the substring <code>apple-darwin</code>?</p>



<a name="207862505"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/182449-t-compiler/help/topic/petgraph%20wrong%20number%20of%20type%20arguments/near/207862505" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jake Goulding <a href="https://rust-lang.github.io/zulip_archive/stream/182449-t-compiler/help/topic/petgraph.20wrong.20number.20of.20type.20arguments.html#207862505">(Aug 24 2020 at 16:11)</a>:</h4>
<p>yeah, renaming it now. I guess I got stupidly lucky with respect to that when I started this whole thing</p>



<a name="207862822"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/182449-t-compiler/help/topic/petgraph%20wrong%20number%20of%20type%20arguments/near/207862822" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> cuviper <a href="https://rust-lang.github.io/zulip_archive/stream/182449-t-compiler/help/topic/petgraph.20wrong.20number.20of.20type.20arguments.html#207862822">(Aug 24 2020 at 16:14)</a>:</h4>
<p><span class="user-mention silent" data-user-id="116155">Jake Goulding</span> <a href="#narrow/stream/182449-t-compiler.2Fhelp/topic/petgraph.20wrong.20number.20of.20type.20arguments/near/207843682">said</a>:</p>
<blockquote>
<p><span class="user-mention silent" data-user-id="138448">cuviper</span> How may I get debugging output from autocfg?</p>
</blockquote>
<p>The only real option at the moment is to find the <code>stderr</code> file that cargo captures from the build script, but that will only have error output from its compiler invocations. It would probably be a good idea to add an environment <code>DEBUG_AUTOCFG</code> that dumps more from <code>autocfg</code> itself...</p>



<a name="207862823"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/182449-t-compiler/help/topic/petgraph%20wrong%20number%20of%20type%20arguments/near/207862823" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Eric Huss <a href="https://rust-lang.github.io/zulip_archive/stream/182449-t-compiler/help/topic/petgraph.20wrong.20number.20of.20type.20arguments.html#207862823">(Aug 24 2020 at 16:14)</a>:</h4>
<p><span class="user-mention" data-user-id="116155">@Jake Goulding</span> Yea, there are a bunch of places that look at the target name (that shouldn't).  I think in this case the JSON filename needs a substring like "apple-darwin" in it.</p>



<a name="207862927"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/182449-t-compiler/help/topic/petgraph%20wrong%20number%20of%20type%20arguments/near/207862927" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> cuviper <a href="https://rust-lang.github.io/zulip_archive/stream/182449-t-compiler/help/topic/petgraph.20wrong.20number.20of.20type.20arguments.html#207862927">(Aug 24 2020 at 16:15)</a>:</h4>
<p>target-json issues are new to me, but there are similar issues with <code>RUSTFLAGS</code>: <a href="https://github.com/cuviper/autocfg/issues/15">https://github.com/cuviper/autocfg/issues/15</a></p>



<a name="207863031"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/182449-t-compiler/help/topic/petgraph%20wrong%20number%20of%20type%20arguments/near/207863031" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jake Goulding <a href="https://rust-lang.github.io/zulip_archive/stream/182449-t-compiler/help/topic/petgraph.20wrong.20number.20of.20type.20arguments.html#207863031">(Aug 24 2020 at 16:16)</a>:</h4>
<p>Yeah, I'm seeing something like this now in my smaller repro:</p>
<div class="codehilite"><pre><span></span><code>[repro 0.1.0] error[E0463]: can&#39;t find crate for `std`
[repro 0.1.0]   |
[repro 0.1.0]   = note: the `apple-darwin-x86_64-fork` target may not be installed
[repro 0.1.0]
[repro 0.1.0] error: aborting due to previous error
</code></pre></div>


<p>Trying to see if it's a Cargo or autocfg issue before I file something</p>



<a name="207863048"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/182449-t-compiler/help/topic/petgraph%20wrong%20number%20of%20type%20arguments/near/207863048" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Eric Huss <a href="https://rust-lang.github.io/zulip_archive/stream/182449-t-compiler/help/topic/petgraph.20wrong.20number.20of.20type.20arguments.html#207863048">(Aug 24 2020 at 16:17)</a>:</h4>
<p>If you want to make progress on fixing things, one place to start is <a href="https://github.com/rust-lang/rust/blob/master/library/std/build.rs">https://github.com/rust-lang/rust/blob/master/library/std/build.rs</a>, where it should be looking at CARGO_CFG_TARGET_* values instead of <code>TARGET</code>.</p>



<a name="207865543"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/182449-t-compiler/help/topic/petgraph%20wrong%20number%20of%20type%20arguments/near/207865543" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Eric Huss <a href="https://rust-lang.github.io/zulip_archive/stream/182449-t-compiler/help/topic/petgraph.20wrong.20number.20of.20type.20arguments.html#207865543">(Aug 24 2020 at 16:38)</a>:</h4>
<p>I posted <a href="https://github.com/rust-lang/wg-cargo-std-aware/issues/6#issuecomment-679237914">https://github.com/rust-lang/wg-cargo-std-aware/issues/6#issuecomment-679237914</a> with a list of other places that are sensitive to the JSON filename.</p>



<a name="207877443"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/182449-t-compiler/help/topic/petgraph%20wrong%20number%20of%20type%20arguments/near/207877443" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jake Goulding <a href="https://rust-lang.github.io/zulip_archive/stream/182449-t-compiler/help/topic/petgraph.20wrong.20number.20of.20type.20arguments.html#207877443">(Aug 24 2020 at 18:18)</a>:</h4>
<p><span class="user-mention" data-user-id="116122">@simulacrum</span> <a href="https://github.com/rust-lang/cargo/issues/8646">https://github.com/rust-lang/cargo/issues/8646</a></p>



<a name="207881619"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/182449-t-compiler/help/topic/petgraph%20wrong%20number%20of%20type%20arguments/near/207881619" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> simulacrum <a href="https://rust-lang.github.io/zulip_archive/stream/182449-t-compiler/help/topic/petgraph.20wrong.20number.20of.20type.20arguments.html#207881619">(Aug 24 2020 at 18:51)</a>:</h4>
<p>Thanks!</p>



<hr><p>Last updated: Aug 07 2021 at 22:04 UTC</p>
</html>