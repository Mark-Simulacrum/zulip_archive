<html>
<head><meta charset="utf-8"><title>Confusion on building stage0 compiler with no core · t-compiler/help · Zulip Chat Archive</title></head>
<h2>Stream: <a href="https://zulip-archive.rust-lang.org/stream/182449-t-compiler/help/index.html">t-compiler/help</a></h2>
<h3>Topic: <a href="https://zulip-archive.rust-lang.org/stream/182449-t-compiler/help/topic/Confusion.20on.20building.20stage0.20compiler.20with.20no.20core.html">Confusion on building stage0 compiler with no core</a></h3>

<hr>

<base href="https://rust-lang.zulipchat.com">

<head><link href="https://zulip-archive.rust-lang.org/style.css" rel="stylesheet"></head>

<a name="258495718"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/182449-t-compiler/help/topic/Confusion%20on%20building%20stage0%20compiler%20with%20no%20core/near/258495718" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> moxian <a href="https://zulip-archive.rust-lang.org/stream/182449-t-compiler/help/topic/Confusion.20on.20building.20stage0.20compiler.20with.20no.20core.html#258495718">(Oct 21 2021 at 06:48)</a>:</h4>
<p>Hello. I'm either confused on what is stage0, or how to skip building core.</p>
<p>The behaviours i observe:<br>
<code>python x.py build --stage 0</code> finishes very fast, but doesn't contain the compiler changes that i've made to the source<br>
<code>python x.py build --stage 1</code>does contain the changes, but needs to spend time building <code>core</code></p>
<p>I want some middle ground between the two (i.e. have the changes i made to, say, <code>rustc_middle</code> in the resulting binary, but /not/ build libcore)<br>
I've read the basics of &lt;<a href="https://rustc-dev-guide.rust-lang.org/building/how-to-build-and-run.html">https://rustc-dev-guide.rust-lang.org/building/how-to-build-and-run.html</a>&gt; but that doesn't seem to solve my issue.</p>
<p>Any advice would be appreciated.</p>



<a name="258506778"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/182449-t-compiler/help/topic/Confusion%20on%20building%20stage0%20compiler%20with%20no%20core/near/258506778" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> The 8472 <a href="https://zulip-archive.rust-lang.org/stream/182449-t-compiler/help/topic/Confusion.20on.20building.20stage0.20compiler.20with.20no.20core.html#258506778">(Oct 21 2021 at 08:30)</a>:</h4>
<p>there's the keep-std flag for that, that said... building core is quite fast compared to building the compiler itself.</p>



<a name="258507416"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/182449-t-compiler/help/topic/Confusion%20on%20building%20stage0%20compiler%20with%20no%20core/near/258507416" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> moxian <a href="https://zulip-archive.rust-lang.org/stream/182449-t-compiler/help/topic/Confusion.20on.20building.20stage0.20compiler.20with.20no.20core.html#258507416">(Oct 21 2021 at 08:34)</a>:</h4>
<p><code>--keep-stage-std</code> works, thank you!</p>



<a name="258541290"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/182449-t-compiler/help/topic/Confusion%20on%20building%20stage0%20compiler%20with%20no%20core/near/258541290" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Nelson <a href="https://zulip-archive.rust-lang.org/stream/182449-t-compiler/help/topic/Confusion.20on.20building.20stage0.20compiler.20with.20no.20core.html#258541290">(Oct 21 2021 at 13:04)</a>:</h4>
<p><span class="user-mention" data-user-id="120828">@moxian</span> <a href="https://rustc-dev-guide.rust-lang.org/building/bootstrapping.html#stages-and-std">https://rustc-dev-guide.rust-lang.org/building/bootstrapping.html#stages-and-std</a></p>



<a name="258541361"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/182449-t-compiler/help/topic/Confusion%20on%20building%20stage0%20compiler%20with%20no%20core/near/258541361" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Nelson <a href="https://zulip-archive.rust-lang.org/stream/182449-t-compiler/help/topic/Confusion.20on.20building.20stage0.20compiler.20with.20no.20core.html#258541361">(Oct 21 2021 at 13:04)</a>:</h4>
<p>In particular, --keep-stage-std is unsound, and could break if you change the metadata in some subtle way</p>



<a name="258541438"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/182449-t-compiler/help/topic/Confusion%20on%20building%20stage0%20compiler%20with%20no%20core/near/258541438" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Nelson <a href="https://zulip-archive.rust-lang.org/stream/182449-t-compiler/help/topic/Confusion.20on.20building.20stage0.20compiler.20with.20no.20core.html#258541438">(Oct 21 2021 at 13:05)</a>:</h4>
<p>(but usually it breaks noisily, not silently)</p>



<hr><p>Last updated: Apr 12 2022 at 20:01 UTC</p>
</html>