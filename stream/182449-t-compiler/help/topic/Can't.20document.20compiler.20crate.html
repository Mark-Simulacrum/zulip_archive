<html>
<head><meta charset="utf-8"><title>Can&#x27;t document compiler crate · t-compiler/help · Zulip Chat Archive</title></head>
<h2>Stream: <a href="https://rust-lang.github.io/zulip_archive/stream/182449-t-compiler/help/index.html">t-compiler/help</a></h2>
<h3>Topic: <a href="https://rust-lang.github.io/zulip_archive/stream/182449-t-compiler/help/topic/Can&#x27;t.20document.20compiler.20crate.html">Can&#x27;t document compiler crate</a></h3>

<hr>

<base href="https://rust-lang.zulipchat.com">

<head><link href="https://rust-lang.github.io/zulip_archive/style.css" rel="stylesheet"></head>

<a name="219677965"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/182449-t-compiler/help/topic/Can%27t%20document%20compiler%20crate/near/219677965" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Nadrieril <a href="https://rust-lang.github.io/zulip_archive/stream/182449-t-compiler/help/topic/Can&#x27;t.20document.20compiler.20crate.html#219677965">(Dec 12 2020 at 00:18)</a>:</h4>
<p><code>x.py doc -h -v</code> claims that I should be able to call <code>./x.py doc compiler/rustc_mir_build</code> to document only that crate. If I try that, I get instead "error: unknown debugging option: <code>normalize-docs</code>" "error: could not document <code>rustc_error_codes</code>"</p>



<a name="219677993"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/182449-t-compiler/help/topic/Can%27t%20document%20compiler%20crate/near/219677993" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Nadrieril <a href="https://rust-lang.github.io/zulip_archive/stream/182449-t-compiler/help/topic/Can&#x27;t.20document.20compiler.20crate.html#219677993">(Dec 12 2020 at 00:18)</a>:</h4>
<p>I tried this on latest master after <code>rm -rf build</code>. Also <code>./x.py doc</code> works fine</p>



<a name="219677997"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/182449-t-compiler/help/topic/Can%27t%20document%20compiler%20crate/near/219677997" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Nadrieril <a href="https://rust-lang.github.io/zulip_archive/stream/182449-t-compiler/help/topic/Can&#x27;t.20document.20compiler.20crate.html#219677997">(Dec 12 2020 at 00:19)</a>:</h4>
<p>Anyone know what could be happening?</p>



<a name="219681458"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/182449-t-compiler/help/topic/Can%27t%20document%20compiler%20crate/near/219681458" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Nelson <a href="https://rust-lang.github.io/zulip_archive/stream/182449-t-compiler/help/topic/Can&#x27;t.20document.20compiler.20crate.html#219681458">(Dec 12 2020 at 01:22)</a>:</h4>
<p><span class="user-mention" data-user-id="245339">@Nadrieril</span> I broke this in <a href="https://github.com/rust-lang/rust/pull/79525">https://github.com/rust-lang/rust/pull/79525</a></p>



<a name="219681467"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/182449-t-compiler/help/topic/Can%27t%20document%20compiler%20crate/near/219681467" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Nelson <a href="https://rust-lang.github.io/zulip_archive/stream/182449-t-compiler/help/topic/Can&#x27;t.20document.20compiler.20crate.html#219681467">(Dec 12 2020 at 01:22)</a>:</h4>
<p>someone (you or me) needs to add <code>if stage != 0</code> to that bit</p>



<a name="219681484"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/182449-t-compiler/help/topic/Can%27t%20document%20compiler%20crate/near/219681484" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Nelson <a href="https://rust-lang.github.io/zulip_archive/stream/182449-t-compiler/help/topic/Can&#x27;t.20document.20compiler.20crate.html#219681484">(Dec 12 2020 at 01:23)</a>:</h4>
<p>weird that <code>doc</code> on its own works though, maybe it's cached?</p>



<a name="219681497"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/182449-t-compiler/help/topic/Can%27t%20document%20compiler%20crate/near/219681497" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Nelson <a href="https://rust-lang.github.io/zulip_archive/stream/182449-t-compiler/help/topic/Can&#x27;t.20document.20compiler.20crate.html#219681497">(Dec 12 2020 at 01:23)</a>:</h4>
<p><span class="user-mention silent" data-user-id="232545">Joshua Nelson</span> <a href="#narrow/stream/182449-t-compiler.2Fhelp/topic/Can't.20document.20single.20crate/near/219681467">said</a>:</p>
<blockquote>
<p>someone (you or me) needs to add <code>if stage != 0</code> to that bit</p>
</blockquote>
<p>let me just do this now</p>



<a name="219681663"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/182449-t-compiler/help/topic/Can%27t%20document%20compiler%20crate/near/219681663" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Nelson <a href="https://rust-lang.github.io/zulip_archive/stream/182449-t-compiler/help/topic/Can&#x27;t.20document.20compiler.20crate.html#219681663">(Dec 12 2020 at 01:27)</a>:</h4>
<p><span class="user-mention" data-user-id="116122">@simulacrum</span> if I leave a <code>// cfg(not(bootstrap))</code> comment, will that be enough for you to find it on the next beta bump?</p>



<a name="219681684"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/182449-t-compiler/help/topic/Can%27t%20document%20compiler%20crate/near/219681684" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> simulacrum <a href="https://rust-lang.github.io/zulip_archive/stream/182449-t-compiler/help/topic/Can&#x27;t.20document.20compiler.20crate.html#219681684">(Dec 12 2020 at 01:28)</a>:</h4>
<p>Yeah should be I expect</p>



<a name="219681739"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/182449-t-compiler/help/topic/Can%27t%20document%20compiler%20crate/near/219681739" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Nelson <a href="https://rust-lang.github.io/zulip_archive/stream/182449-t-compiler/help/topic/Can&#x27;t.20document.20compiler.20crate.html#219681739">(Dec 12 2020 at 01:29)</a>:</h4>
<p><span class="user-mention silent" data-user-id="232545">Joshua Nelson</span> <a href="#narrow/stream/182449-t-compiler.2Fhelp/topic/Can't.20document.20single.20crate/near/219681467">said</a>:</p>
<blockquote>
<p>someone (you or me) needs to add <code>if stage != 0</code> to that bit</p>
</blockquote>
<p>wow, that really was it <a href="https://github.com/rust-lang/rust/pull/79954">https://github.com/rust-lang/rust/pull/79954</a></p>



<a name="219685233"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/182449-t-compiler/help/topic/Can%27t%20document%20compiler%20crate/near/219685233" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Nadrieril <a href="https://rust-lang.github.io/zulip_archive/stream/182449-t-compiler/help/topic/Can&#x27;t.20document.20compiler.20crate.html#219685233">(Dec 12 2020 at 02:54)</a>:</h4>
<p>Neat, thanks!</p>



<a name="219692797"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/182449-t-compiler/help/topic/Can%27t%20document%20compiler%20crate/near/219692797" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Nadrieril <a href="https://rust-lang.github.io/zulip_archive/stream/182449-t-compiler/help/topic/Can&#x27;t.20document.20compiler.20crate.html#219692797">(Dec 12 2020 at 06:08)</a>:</h4>
<p><span class="user-mention" data-user-id="232545">@Joshua Nelson</span> I applied the change from <a href="https://github.com/rust-lang/rust/pull/79954">https://github.com/rust-lang/rust/pull/79954</a>, and I get a different error now, when running <code>./x.py doc compiler/rustc_mir_build</code>:</p>
<div class="codehilite"><pre><span></span><code>thread &#39;rustc&#39; panicked at &#39;Unable to resolve external crate proc_macro2&#39;, src/librustdoc/core.rs:457:37
note: run with `RUST_BACKTRACE=1` environment variable to display a backtrace
error: internal compiler error: unexpected panic
error: Unrecognized option: &#39;crate-version&#39;
error: could not document `coverage_test_macros`
</code></pre></div>



<a name="219708115"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/182449-t-compiler/help/topic/Can%27t%20document%20compiler%20crate/near/219708115" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Nelson <a href="https://rust-lang.github.io/zulip_archive/stream/182449-t-compiler/help/topic/Can&#x27;t.20document.20compiler.20crate.html#219708115">(Dec 12 2020 at 13:06)</a>:</h4>
<p>That looks like a bug in rustdoc :/ I'm not sure without digging into it</p>



<a name="219709841"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/182449-t-compiler/help/topic/Can%27t%20document%20compiler%20crate/near/219709841" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Nelson <a href="https://rust-lang.github.io/zulip_archive/stream/182449-t-compiler/help/topic/Can&#x27;t.20document.20compiler.20crate.html#219709841">(Dec 12 2020 at 13:50)</a>:</h4>
<p>this is from <a href="https://github.com/rust-lang/rust/blob/c3ed6681ff8d446e68ce272be4bf66f4145f6e29/src/librustdoc/core.rs#L448">https://github.com/rust-lang/rust/blob/c3ed6681ff8d446e68ce272be4bf66f4145f6e29/src/librustdoc/core.rs#L448</a></p>



<a name="219709853"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/182449-t-compiler/help/topic/Can%27t%20document%20compiler%20crate/near/219709853" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Nelson <a href="https://rust-lang.github.io/zulip_archive/stream/182449-t-compiler/help/topic/Can&#x27;t.20document.20compiler.20crate.html#219709853">(Dec 12 2020 at 13:51)</a>:</h4>
<p>since this is in beta I'm not sure it's worth fixing - <span class="user-mention" data-user-id="245339">@Nadrieril</span> does it work with<code>doc --stage 1</code>?</p>



<a name="219709919"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/182449-t-compiler/help/topic/Can%27t%20document%20compiler%20crate/near/219709919" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Nelson <a href="https://rust-lang.github.io/zulip_archive/stream/182449-t-compiler/help/topic/Can&#x27;t.20document.20compiler.20crate.html#219709919">(Dec 12 2020 at 13:53)</a>:</h4>
<p>I guess the real question is whether this is a rustdoc bug or a bootstrap bug</p>



<a name="219709922"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/182449-t-compiler/help/topic/Can%27t%20document%20compiler%20crate/near/219709922" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Nelson <a href="https://rust-lang.github.io/zulip_archive/stream/182449-t-compiler/help/topic/Can&#x27;t.20document.20compiler.20crate.html#219709922">(Dec 12 2020 at 13:53)</a>:</h4>
<p>in the second case it won't be fixed by promoting nightly to beta</p>



<a name="219718770"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/182449-t-compiler/help/topic/Can%27t%20document%20compiler%20crate/near/219718770" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Nadrieril <a href="https://rust-lang.github.io/zulip_archive/stream/182449-t-compiler/help/topic/Can&#x27;t.20document.20compiler.20crate.html#219718770">(Dec 12 2020 at 17:40)</a>:</h4>
<p><span class="user-mention silent" data-user-id="232545">Joshua Nelson</span> <a href="#narrow/stream/182449-t-compiler.2Fhelp/topic/Can't.20document.20single.20crate/near/219709853">said</a>:</p>
<blockquote>
<p>since this is in beta I'm not sure it's worth fixing - <span class="user-mention silent" data-user-id="245339">Nadrieril</span> does it work with<code>doc --stage 1</code>?</p>
</blockquote>
<p>Yes!</p>



<a name="219718866"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/182449-t-compiler/help/topic/Can%27t%20document%20compiler%20crate/near/219718866" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Nadrieril <a href="https://rust-lang.github.io/zulip_archive/stream/182449-t-compiler/help/topic/Can&#x27;t.20document.20compiler.20crate.html#219718866">(Dec 12 2020 at 17:43)</a>:</h4>
<p>It compiles everything when I change just docs though, that's painful. I expected <code>--stage 0</code> would avoid that, but that gives me the same <code>Unable to resolve external crate</code> panic as above</p>



<a name="219719458"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/182449-t-compiler/help/topic/Can%27t%20document%20compiler%20crate/near/219719458" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Nelson <a href="https://rust-lang.github.io/zulip_archive/stream/182449-t-compiler/help/topic/Can&#x27;t.20document.20compiler.20crate.html#219719458">(Dec 12 2020 at 17:58)</a>:</h4>
<p>yeah, this is why stage 0 is the default, building rustc twice is painful</p>



<a name="219719469"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/182449-t-compiler/help/topic/Can%27t%20document%20compiler%20crate/near/219719469" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Nelson <a href="https://rust-lang.github.io/zulip_archive/stream/182449-t-compiler/help/topic/Can&#x27;t.20document.20compiler.20crate.html#219719469">(Dec 12 2020 at 17:58)</a>:</h4>
<p>not sure why it's not working :/ the fact that proc macro specifically is breaking makes me think something to do with bootstrap</p>



<a name="219719986"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/182449-t-compiler/help/topic/Can%27t%20document%20compiler%20crate/near/219719986" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Nadrieril <a href="https://rust-lang.github.io/zulip_archive/stream/182449-t-compiler/help/topic/Can&#x27;t.20document.20compiler.20crate.html#219719986">(Dec 12 2020 at 18:11)</a>:</h4>
<p>It's <code>proc_macro2</code> though, which is a normal crate right? If anything I'd expect <code>proc_macro</code> to have some bootstrap magic, but not <code>proc_macro2</code></p>



<a name="219721547"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/182449-t-compiler/help/topic/Can%27t%20document%20compiler%20crate/near/219721547" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Nelson <a href="https://rust-lang.github.io/zulip_archive/stream/182449-t-compiler/help/topic/Can&#x27;t.20document.20compiler.20crate.html#219721547">(Dec 12 2020 at 18:45)</a>:</h4>
<p>hmm good point</p>



<a name="219725284"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/182449-t-compiler/help/topic/Can%27t%20document%20compiler%20crate/near/219725284" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Nadrieril <a href="https://rust-lang.github.io/zulip_archive/stream/182449-t-compiler/help/topic/Can&#x27;t.20document.20compiler.20crate.html#219725284">(Dec 12 2020 at 20:02)</a>:</h4>
<p>I tried documenting a bunch of different compiler crates and it always panics when documenting <code>coverage_test_macros</code>. That's a subcrate of <code>rustc_mir</code> though, so I am surprised it causes errors when trying to document say <code>rustc_ast</code> which can't depend on it</p>



<a name="219725303"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/182449-t-compiler/help/topic/Can%27t%20document%20compiler%20crate/near/219725303" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Nelson <a href="https://rust-lang.github.io/zulip_archive/stream/182449-t-compiler/help/topic/Can&#x27;t.20document.20compiler.20crate.html#219725303">(Dec 12 2020 at 20:02)</a>:</h4>
<p>I'm not sure <code>doc compiler/x</code> actually does anything different from <code>doc compiler/rustc</code> <span aria-label="sweat smile" class="emoji emoji-1f605" role="img" title="sweat smile">:sweat_smile:</span></p>



<a name="219725305"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/182449-t-compiler/help/topic/Can%27t%20document%20compiler%20crate/near/219725305" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Nelson <a href="https://rust-lang.github.io/zulip_archive/stream/182449-t-compiler/help/topic/Can&#x27;t.20document.20compiler.20crate.html#219725305">(Dec 12 2020 at 20:02)</a>:</h4>
<p>they might all be aliases for documenting the whole compiler</p>



<a name="219725326"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/182449-t-compiler/help/topic/Can%27t%20document%20compiler%20crate/near/219725326" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Nadrieril <a href="https://rust-lang.github.io/zulip_archive/stream/182449-t-compiler/help/topic/Can&#x27;t.20document.20compiler.20crate.html#219725326">(Dec 12 2020 at 20:03)</a>:</h4>
<p>Oh x) But <code>x.py -h -v</code> lists all those paths as possible options</p>



<a name="219725327"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/182449-t-compiler/help/topic/Can%27t%20document%20compiler%20crate/near/219725327" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Nelson <a href="https://rust-lang.github.io/zulip_archive/stream/182449-t-compiler/help/topic/Can&#x27;t.20document.20compiler.20crate.html#219725327">(Dec 12 2020 at 20:03)</a>:</h4>
<p><span class="user-mention silent" data-user-id="245339">Nadrieril</span> <a href="#narrow/stream/182449-t-compiler.2Fhelp/topic/Can't.20document.20single.20crate/near/219725284">said</a>:</p>
<blockquote>
<p>I tried documenting a bunch of different compiler crates and it always panics when documenting <code>coverage_test_macros</code>. That's a subcrate of <code>rustc_mir</code> though, so I am surprised it causes errors when trying to document say <code>rustc_ast</code> which can't depend on it</p>
</blockquote>
<p>if you want to look into this, it would be helpful to know if <code>doc --stage 1</code> loads proc_macro2 from the sysroot or from target/deps</p>



<a name="219725335"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/182449-t-compiler/help/topic/Can%27t%20document%20compiler%20crate/near/219725335" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Nadrieril <a href="https://rust-lang.github.io/zulip_archive/stream/182449-t-compiler/help/topic/Can&#x27;t.20document.20compiler.20crate.html#219725335">(Dec 12 2020 at 20:03)</a>:</h4>
<p><span class="user-mention silent" data-user-id="245339">Nadrieril</span> <a href="#narrow/stream/182449-t-compiler.2Fhelp/topic/Can't.20document.20single.20crate/near/219725326">said</a>:</p>
<blockquote>
<p>Oh x) But <code>x.py -h -v</code> lists all those paths as possible options</p>
</blockquote>
<p>So someone somewhere believed that those paths behaved differently</p>



<a name="219725573"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/182449-t-compiler/help/topic/Can%27t%20document%20compiler%20crate/near/219725573" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Nadrieril <a href="https://rust-lang.github.io/zulip_archive/stream/182449-t-compiler/help/topic/Can&#x27;t.20document.20compiler.20crate.html#219725573">(Dec 12 2020 at 20:08)</a>:</h4>
<p><span class="user-mention silent" data-user-id="232545">Joshua Nelson</span> <a href="#narrow/stream/182449-t-compiler.2Fhelp/topic/Can't.20document.20single.20crate/near/219725327">said</a>:</p>
<blockquote>
<p>if you want to look into this, it would be helpful to know if <code>doc --stage 1</code> loads proc_macro2 from the sysroot or from target/deps</p>
</blockquote>
<p>What does this mean? How can I tell the difference?</p>



<a name="219725648"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/182449-t-compiler/help/topic/Can%27t%20document%20compiler%20crate/near/219725648" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Nelson <a href="https://rust-lang.github.io/zulip_archive/stream/182449-t-compiler/help/topic/Can&#x27;t.20document.20compiler.20crate.html#219725648">(Dec 12 2020 at 20:10)</a>:</h4>
<p>I am not sure. You could look in <code>$(rustc --print sysroot)/lib</code> to see if it has <code>libproc_macro2.rlib</code> or something like that</p>



<a name="219725654"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/182449-t-compiler/help/topic/Can%27t%20document%20compiler%20crate/near/219725654" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Nelson <a href="https://rust-lang.github.io/zulip_archive/stream/182449-t-compiler/help/topic/Can&#x27;t.20document.20compiler.20crate.html#219725654">(Dec 12 2020 at 20:10)</a>:</h4>
<p>'sysroot' is explained here: <a href="https://rustc-dev-guide.rust-lang.org/building/bootstrapping.html?highlight=sysroot#what-is-a-sysroot">https://rustc-dev-guide.rust-lang.org/building/bootstrapping.html?highlight=sysroot#what-is-a-sysroot</a></p>



<a name="219725971"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/182449-t-compiler/help/topic/Can%27t%20document%20compiler%20crate/near/219725971" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Nelson <a href="https://rust-lang.github.io/zulip_archive/stream/182449-t-compiler/help/topic/Can&#x27;t.20document.20compiler.20crate.html#219725971">(Dec 12 2020 at 20:19)</a>:</h4>
<p>for context, the thing that's going wrong is <a href="https://github.com/rust-lang/rust/issues/68427#issuecomment-578113028">https://github.com/rust-lang/rust/issues/68427#issuecomment-578113028</a></p>



<a name="219725974"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/182449-t-compiler/help/topic/Can%27t%20document%20compiler%20crate/near/219725974" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Nelson <a href="https://rust-lang.github.io/zulip_archive/stream/182449-t-compiler/help/topic/Can&#x27;t.20document.20compiler.20crate.html#219725974">(Dec 12 2020 at 20:19)</a>:</h4>
<p>rustdoc is trying to load a crate eagerly and the crate isn't there</p>



<a name="219728197"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/182449-t-compiler/help/topic/Can%27t%20document%20compiler%20crate/near/219728197" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Nadrieril <a href="https://rust-lang.github.io/zulip_archive/stream/182449-t-compiler/help/topic/Can&#x27;t.20document.20compiler.20crate.html#219728197">(Dec 12 2020 at 21:10)</a>:</h4>
<p>Thanks for the links! Made me think of another solution: turns out coverage_test_macros doesn't use its <code>proc_macro2</code> dependency! That solves this problem, but there's another one now &gt;&lt;</p>



<a name="219728233"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/182449-t-compiler/help/topic/Can%27t%20document%20compiler%20crate/near/219728233" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Nadrieril <a href="https://rust-lang.github.io/zulip_archive/stream/182449-t-compiler/help/topic/Can&#x27;t.20document.20compiler.20crate.html#219728233">(Dec 12 2020 at 21:11)</a>:</h4>
<p>I'll open an issue</p>



<a name="219728819"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/182449-t-compiler/help/topic/Can%27t%20document%20compiler%20crate/near/219728819" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Nelson <a href="https://rust-lang.github.io/zulip_archive/stream/182449-t-compiler/help/topic/Can&#x27;t.20document.20compiler.20crate.html#219728819">(Dec 12 2020 at 21:24)</a>:</h4>
<blockquote>
<p>doesn't use its dependency</p>
</blockquote>
<p>In all seriousness this is probably what caused the bug lol</p>



<a name="219728898"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/182449-t-compiler/help/topic/Can%27t%20document%20compiler%20crate/near/219728898" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Nadrieril <a href="https://rust-lang.github.io/zulip_archive/stream/182449-t-compiler/help/topic/Can&#x27;t.20document.20compiler.20crate.html#219728898">(Dec 12 2020 at 21:26)</a>:</h4>
<p><span class="user-mention silent" data-user-id="232545">Joshua Nelson</span> <a href="#narrow/stream/182449-t-compiler.2Fhelp/topic/Can't.20document.20compiler.20crate/near/219725971">said</a>:</p>
<blockquote>
<p>for context, the thing that's going wrong is <a href="https://github.com/rust-lang/rust/issues/68427#issuecomment-578113028">https://github.com/rust-lang/rust/issues/68427#issuecomment-578113028</a></p>
</blockquote>
<p>It seems so yeah, because that comment you linked reported the same kind of thing happening on an unused dependency</p>



<a name="219729001"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/182449-t-compiler/help/topic/Can%27t%20document%20compiler%20crate/near/219729001" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Nadrieril <a href="https://rust-lang.github.io/zulip_archive/stream/182449-t-compiler/help/topic/Can&#x27;t.20document.20compiler.20crate.html#219729001">(Dec 12 2020 at 21:28)</a>:</h4>
<p>From that comment I would guess rustc ignores it because it's unused, so it's not made available to rustdoc who then tries to load it and crashes.</p>



<a name="219729112"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/182449-t-compiler/help/topic/Can%27t%20document%20compiler%20crate/near/219729112" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Nelson <a href="https://rust-lang.github.io/zulip_archive/stream/182449-t-compiler/help/topic/Can&#x27;t.20document.20compiler.20crate.html#219729112">(Dec 12 2020 at 21:30)</a>:</h4>
<p>hmm, I wonder if I should change that panic into a no-op</p>



<a name="219729127"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/182449-t-compiler/help/topic/Can%27t%20document%20compiler%20crate/near/219729127" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Nelson <a href="https://rust-lang.github.io/zulip_archive/stream/182449-t-compiler/help/topic/Can&#x27;t.20document.20compiler.20crate.html#219729127">(Dec 12 2020 at 21:30)</a>:</h4>
<p>then we'd get people confused that they can't use <code>proc_macro2</code> in intra-doc links, but that seems strictly better than an ICE</p>



<a name="219729984"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/182449-t-compiler/help/topic/Can%27t%20document%20compiler%20crate/near/219729984" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Nadrieril <a href="https://rust-lang.github.io/zulip_archive/stream/182449-t-compiler/help/topic/Can&#x27;t.20document.20compiler.20crate.html#219729984">(Dec 12 2020 at 21:48)</a>:</h4>
<p>I opened an issue that details what I did and the last error I'm now stuck on: <a href="https://github.com/rust-lang/rust/issues/79980">https://github.com/rust-lang/rust/issues/79980</a></p>



<a name="219730014"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/182449-t-compiler/help/topic/Can%27t%20document%20compiler%20crate/near/219730014" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Nelson <a href="https://rust-lang.github.io/zulip_archive/stream/182449-t-compiler/help/topic/Can&#x27;t.20document.20compiler.20crate.html#219730014">(Dec 12 2020 at 21:49)</a>:</h4>
<p><span class="user-mention" data-user-id="245339">@Nadrieril</span> your first and second error message are the same, is that intentional?</p>



<a name="219730065"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/182449-t-compiler/help/topic/Can%27t%20document%20compiler%20crate/near/219730065" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Nelson <a href="https://rust-lang.github.io/zulip_archive/stream/182449-t-compiler/help/topic/Can&#x27;t.20document.20compiler.20crate.html#219730065">(Dec 12 2020 at 21:50)</a>:</h4>
<p>... those first and second <code>libstd</code> files are the same <span aria-label="eyes" class="emoji emoji-1f440" role="img" title="eyes">:eyes:</span></p>



<a name="219730070"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/182449-t-compiler/help/topic/Can%27t%20document%20compiler%20crate/near/219730070" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Nelson <a href="https://rust-lang.github.io/zulip_archive/stream/182449-t-compiler/help/topic/Can&#x27;t.20document.20compiler.20crate.html#219730070">(Dec 12 2020 at 21:50)</a>:</h4>
<p>why are they both in stage0-sysroot?</p>



<a name="219730078"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/182449-t-compiler/help/topic/Can%27t%20document%20compiler%20crate/near/219730078" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Nelson <a href="https://rust-lang.github.io/zulip_archive/stream/182449-t-compiler/help/topic/Can&#x27;t.20document.20compiler.20crate.html#219730078">(Dec 12 2020 at 21:50)</a>:</h4>
<p><span class="user-mention silent" data-user-id="232545">Joshua Nelson</span> <a href="#narrow/stream/182449-t-compiler.2Fhelp/topic/Can't.20document.20compiler.20crate/near/219730065">said</a>:</p>
<blockquote>
<p>... those first and second <code>libstd</code> files are the same <span aria-label="eyes" class="emoji emoji-1f440" role="img" title="eyes">:eyes:</span></p>
</blockquote>
<p>oh except one is an rlib and one is an .so</p>



<a name="219730084"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/182449-t-compiler/help/topic/Can%27t%20document%20compiler%20crate/near/219730084" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Nadrieril <a href="https://rust-lang.github.io/zulip_archive/stream/182449-t-compiler/help/topic/Can&#x27;t.20document.20compiler.20crate.html#219730084">(Dec 12 2020 at 21:50)</a>:</h4>
<p><span class="user-mention silent" data-user-id="232545">Joshua Nelson</span> <a href="#narrow/stream/182449-t-compiler.2Fhelp/topic/Can't.20document.20compiler.20crate/near/219730014">said</a>:</p>
<blockquote>
<p><span class="user-mention silent" data-user-id="245339">Nadrieril</span> your first and second error message are the same, is that intentional?</p>
</blockquote>
<p>no, one is <code>_</code> the other is <code>-</code></p>



<a name="219730096"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/182449-t-compiler/help/topic/Can%27t%20document%20compiler%20crate/near/219730096" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Nelson <a href="https://rust-lang.github.io/zulip_archive/stream/182449-t-compiler/help/topic/Can&#x27;t.20document.20compiler.20crate.html#219730096">(Dec 12 2020 at 21:51)</a>:</h4>
<p>oh I think that's a typo on my part when I added the option lol</p>



<a name="219730099"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/182449-t-compiler/help/topic/Can%27t%20document%20compiler%20crate/near/219730099" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Nelson <a href="https://rust-lang.github.io/zulip_archive/stream/182449-t-compiler/help/topic/Can&#x27;t.20document.20compiler.20crate.html#219730099">(Dec 12 2020 at 21:51)</a>:</h4>
<p>oops</p>



<a name="219730108"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/182449-t-compiler/help/topic/Can%27t%20document%20compiler%20crate/near/219730108" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Nelson <a href="https://rust-lang.github.io/zulip_archive/stream/182449-t-compiler/help/topic/Can&#x27;t.20document.20compiler.20crate.html#219730108">(Dec 12 2020 at 21:51)</a>:</h4>
<p>does rustc normalize that during parsing or something?</p>



<a name="219730156"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/182449-t-compiler/help/topic/Can%27t%20document%20compiler%20crate/near/219730156" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Nelson <a href="https://rust-lang.github.io/zulip_archive/stream/182449-t-compiler/help/topic/Can&#x27;t.20document.20compiler.20crate.html#219730156">(Dec 12 2020 at 21:52)</a>:</h4>
<p>and second question - is this fixed by <code>incremental = false</code>?</p>



<a name="219730191"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/182449-t-compiler/help/topic/Can%27t%20document%20compiler%20crate/near/219730191" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Nadrieril <a href="https://rust-lang.github.io/zulip_archive/stream/182449-t-compiler/help/topic/Can&#x27;t.20document.20compiler.20crate.html#219730191">(Dec 12 2020 at 21:53)</a>:</h4>
<p><span class="user-mention silent" data-user-id="232545">Joshua Nelson</span> <a href="#narrow/stream/182449-t-compiler.2Fhelp/topic/Can't.20document.20compiler.20crate/near/219730156">said</a>:</p>
<blockquote>
<p>and second question - is this fixed by <code>incremental = false</code>?</p>
</blockquote>
<p>Trying that</p>



<a name="219730198"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/182449-t-compiler/help/topic/Can%27t%20document%20compiler%20crate/near/219730198" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Nelson <a href="https://rust-lang.github.io/zulip_archive/stream/182449-t-compiler/help/topic/Can&#x27;t.20document.20compiler.20crate.html#219730198">(Dec 12 2020 at 21:53)</a>:</h4>
<p>hmm this looks like <a href="https://github.com/rust-lang/rust/issues/74976">https://github.com/rust-lang/rust/issues/74976</a> actually</p>



<a name="219730695"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/182449-t-compiler/help/topic/Can%27t%20document%20compiler%20crate/near/219730695" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Nadrieril <a href="https://rust-lang.github.io/zulip_archive/stream/182449-t-compiler/help/topic/Can&#x27;t.20document.20compiler.20crate.html#219730695">(Dec 12 2020 at 22:05)</a>:</h4>
<p>huh indeed, and that wasn't fixed</p>



<a name="219730835"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/182449-t-compiler/help/topic/Can%27t%20document%20compiler%20crate/near/219730835" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Nadrieril <a href="https://rust-lang.github.io/zulip_archive/stream/182449-t-compiler/help/topic/Can&#x27;t.20document.20compiler.20crate.html#219730835">(Dec 12 2020 at 22:09)</a>:</h4>
<p><span class="user-mention silent" data-user-id="232545">Joshua Nelson</span> <a href="#narrow/stream/182449-t-compiler.2Fhelp/topic/Can't.20document.20compiler.20crate/near/219730156">said</a>:</p>
<blockquote>
<p>and second question - is this fixed by <code>incremental = false</code>?</p>
</blockquote>
<p>Nope, same error</p>



<a name="219730920"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/182449-t-compiler/help/topic/Can%27t%20document%20compiler%20crate/near/219730920" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Nelson <a href="https://rust-lang.github.io/zulip_archive/stream/182449-t-compiler/help/topic/Can&#x27;t.20document.20compiler.20crate.html#219730920">(Dec 12 2020 at 22:11)</a>:</h4>
<blockquote>
<p>@jyn514 pointed me to this comment, which led me to notice that coverage_test_macros doesn't use its proc_macro2 dependency. So I removed it.</p>
</blockquote>
<p><span class="user-mention" data-user-id="245339">@Nadrieril</span> can you make a PR with this? even if it doesn't fix the issue it's a nice cleanup</p>



<a name="219730976"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/182449-t-compiler/help/topic/Can%27t%20document%20compiler%20crate/near/219730976" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Nadrieril <a href="https://rust-lang.github.io/zulip_archive/stream/182449-t-compiler/help/topic/Can&#x27;t.20document.20compiler.20crate.html#219730976">(Dec 12 2020 at 22:13)</a>:</h4>
<p>sure</p>



<a name="219731130"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/182449-t-compiler/help/topic/Can%27t%20document%20compiler%20crate/near/219731130" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Nelson <a href="https://rust-lang.github.io/zulip_archive/stream/182449-t-compiler/help/topic/Can&#x27;t.20document.20compiler.20crate.html#219731130">(Dec 12 2020 at 22:17)</a>:</h4>
<p>oh! I might know what's going wrong: there are two standard libraries, one is master libstd (<code>library/</code>) and one is beta libstd (<code>rust-std</code>, from CI artifacts)</p>



<a name="219731134"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/182449-t-compiler/help/topic/Can%27t%20document%20compiler%20crate/near/219731134" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Nelson <a href="https://rust-lang.github.io/zulip_archive/stream/182449-t-compiler/help/topic/Can&#x27;t.20document.20compiler.20crate.html#219731134">(Dec 12 2020 at 22:17)</a>:</h4>
<p>not sure why they'd both be in stage0-sysroot though</p>



<a name="219731135"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/182449-t-compiler/help/topic/Can%27t%20document%20compiler%20crate/near/219731135" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Nelson <a href="https://rust-lang.github.io/zulip_archive/stream/182449-t-compiler/help/topic/Can&#x27;t.20document.20compiler.20crate.html#219731135">(Dec 12 2020 at 22:17)</a>:</h4>
<p>or only show up when documenting :/</p>



<a name="219731871"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/182449-t-compiler/help/topic/Can%27t%20document%20compiler%20crate/near/219731871" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Nadrieril <a href="https://rust-lang.github.io/zulip_archive/stream/182449-t-compiler/help/topic/Can&#x27;t.20document.20compiler.20crate.html#219731871">(Dec 12 2020 at 22:37)</a>:</h4>
<p>I'm surprised that the .rlib and the .so end up in the same directory</p>



<a name="219731879"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/182449-t-compiler/help/topic/Can%27t%20document%20compiler%20crate/near/219731879" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Nelson <a href="https://rust-lang.github.io/zulip_archive/stream/182449-t-compiler/help/topic/Can&#x27;t.20document.20compiler.20crate.html#219731879">(Dec 12 2020 at 22:37)</a>:</h4>
<p>yeah that seems odd</p>



<a name="219731949"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/182449-t-compiler/help/topic/Can%27t%20document%20compiler%20crate/near/219731949" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Nadrieril <a href="https://rust-lang.github.io/zulip_archive/stream/182449-t-compiler/help/topic/Can&#x27;t.20document.20compiler.20crate.html#219731949">(Dec 12 2020 at 22:38)</a>:</h4>
<p>I'll try to see if one of the two doesn't appear if I build instead of doc. Maybe doc is building some things wrong</p>



<a name="219731971"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/182449-t-compiler/help/topic/Can%27t%20document%20compiler%20crate/near/219731971" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Nelson <a href="https://rust-lang.github.io/zulip_archive/stream/182449-t-compiler/help/topic/Can&#x27;t.20document.20compiler.20crate.html#219731971">(Dec 12 2020 at 22:39)</a>:</h4>
<p>well they're both present on nightly even, so I doubt it's the issue</p>
<div class="codehilite"><pre><span></span><code>/home/joshua/.local/lib/rustup/toolchains/nightly-x86_64-unknown-linux-gnu/lib/rustlib/x86_64-unknown-linux-gnu/lib/libstd-25c6acf8063a3802.rlib
/home/joshua/.local/lib/rustup/toolchains/nightly-x86_64-unknown-linux-gnu/lib/rustlib/x86_64-unknown-linux-gnu/lib/libstd-25c6acf8063a3802.so
</code></pre></div>



<a name="219732102"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/182449-t-compiler/help/topic/Can%27t%20document%20compiler%20crate/near/219732102" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Nadrieril <a href="https://rust-lang.github.io/zulip_archive/stream/182449-t-compiler/help/topic/Can&#x27;t.20document.20compiler.20crate.html#219732102">(Dec 12 2020 at 22:43)</a>:</h4>
<p>oh</p>



<a name="219732241"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/182449-t-compiler/help/topic/Can%27t%20document%20compiler%20crate/near/219732241" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Nadrieril <a href="https://rust-lang.github.io/zulip_archive/stream/182449-t-compiler/help/topic/Can&#x27;t.20document.20compiler.20crate.html#219732241">(Dec 12 2020 at 22:46)</a>:</h4>
<p>I wanted to diff those files with the ones from nightly or beta, but I can't find some with the same hash</p>



<a name="219732252"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/182449-t-compiler/help/topic/Can%27t%20document%20compiler%20crate/near/219732252" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Nelson <a href="https://rust-lang.github.io/zulip_archive/stream/182449-t-compiler/help/topic/Can&#x27;t.20document.20compiler.20crate.html#219732252">(Dec 12 2020 at 22:47)</a>:</h4>
<p>I would not expect to get useful results from diffing binary files <span aria-label="sweat smile" class="emoji emoji-1f605" role="img" title="sweat smile">:sweat_smile:</span></p>



<a name="219732254"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/182449-t-compiler/help/topic/Can%27t%20document%20compiler%20crate/near/219732254" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Nelson <a href="https://rust-lang.github.io/zulip_archive/stream/182449-t-compiler/help/topic/Can&#x27;t.20document.20compiler.20crate.html#219732254">(Dec 12 2020 at 22:47)</a>:</h4>
<p>instead maybe you could see if <code>doc --stage 1</code> has the same files generated?</p>



<a name="219732297"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/182449-t-compiler/help/topic/Can%27t%20document%20compiler%20crate/near/219732297" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Nadrieril <a href="https://rust-lang.github.io/zulip_archive/stream/182449-t-compiler/help/topic/Can&#x27;t.20document.20compiler.20crate.html#219732297">(Dec 12 2020 at 22:48)</a>:</h4>
<p>I would have expected that one of them was the same and the other different or sth</p>



<a name="219732299"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/182449-t-compiler/help/topic/Can%27t%20document%20compiler%20crate/near/219732299" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Nadrieril <a href="https://rust-lang.github.io/zulip_archive/stream/182449-t-compiler/help/topic/Can&#x27;t.20document.20compiler.20crate.html#219732299">(Dec 12 2020 at 22:48)</a>:</h4>
<p>oh good idea</p>



<a name="219732378"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/182449-t-compiler/help/topic/Can%27t%20document%20compiler%20crate/near/219732378" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Nadrieril <a href="https://rust-lang.github.io/zulip_archive/stream/182449-t-compiler/help/topic/Can&#x27;t.20document.20compiler.20crate.html#219732378">(Dec 12 2020 at 22:50)</a>:</h4>
<p><span class="user-mention silent" data-user-id="245339">Nadrieril</span> <a href="#narrow/stream/182449-t-compiler.2Fhelp/topic/Can't.20document.20compiler.20crate/near/219732297">said</a>:</p>
<blockquote>
<p>I would have expected that one of them was the same and the other different or sth</p>
</blockquote>
<p>As in, if bootstrap is mixing between beta and master libstd, maybe one of those files is copied from beta and not the other</p>



<a name="219732383"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/182449-t-compiler/help/topic/Can%27t%20document%20compiler%20crate/near/219732383" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Nadrieril <a href="https://rust-lang.github.io/zulip_archive/stream/182449-t-compiler/help/topic/Can&#x27;t.20document.20compiler.20crate.html#219732383">(Dec 12 2020 at 22:51)</a>:</h4>
<p>you may notice I'm out of my depth ^^</p>



<a name="219732388"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/182449-t-compiler/help/topic/Can%27t%20document%20compiler%20crate/near/219732388" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Nelson <a href="https://rust-lang.github.io/zulip_archive/stream/182449-t-compiler/help/topic/Can&#x27;t.20document.20compiler.20crate.html#219732388">(Dec 12 2020 at 22:51)</a>:</h4>
<p><span class="user-mention silent" data-user-id="245339">Nadrieril</span> <a href="#narrow/stream/182449-t-compiler.2Fhelp/topic/Can't.20document.20compiler.20crate/near/219732378">said</a>:</p>
<blockquote>
<p><span class="user-mention silent" data-user-id="245339">Nadrieril</span> <a href="#narrow/stream/182449-t-compiler.2Fhelp/topic/Can't.20document.20compiler.20crate/near/219732297">said</a>:</p>
<blockquote>
<p>I would have expected that one of them was the same and the other different or sth</p>
</blockquote>
<p>As in, if bootstrap is mixing between beta and master libstd, maybe one of those files is copied from beta and not the other</p>
</blockquote>
<p>well, that might have been a red herring on my part haha</p>



<a name="219732391"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/182449-t-compiler/help/topic/Can%27t%20document%20compiler%20crate/near/219732391" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Nelson <a href="https://rust-lang.github.io/zulip_archive/stream/182449-t-compiler/help/topic/Can&#x27;t.20document.20compiler.20crate.html#219732391">(Dec 12 2020 at 22:51)</a>:</h4>
<p><span class="user-mention silent" data-user-id="245339">Nadrieril</span> <a href="#narrow/stream/182449-t-compiler.2Fhelp/topic/Can't.20document.20compiler.20crate/near/219732383">said</a>:</p>
<blockquote>
<p>you may notice I'm out of my depth ^^</p>
</blockquote>
<p>oh me too don't worry <span aria-label="laughing" class="emoji emoji-1f606" role="img" title="laughing">:laughing:</span></p>



<a name="219732436"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/182449-t-compiler/help/topic/Can%27t%20document%20compiler%20crate/near/219732436" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Nadrieril <a href="https://rust-lang.github.io/zulip_archive/stream/182449-t-compiler/help/topic/Can&#x27;t.20document.20compiler.20crate.html#219732436">(Dec 12 2020 at 22:52)</a>:</h4>
<p>well, <code>--stage 1</code> builds different files</p>



<a name="219732449"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/182449-t-compiler/help/topic/Can%27t%20document%20compiler%20crate/near/219732449" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Nelson <a href="https://rust-lang.github.io/zulip_archive/stream/182449-t-compiler/help/topic/Can&#x27;t.20document.20compiler.20crate.html#219732449">(Dec 12 2020 at 22:53)</a>:</h4>
<p>like a different hash, right?</p>



<a name="219732451"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/182449-t-compiler/help/topic/Can%27t%20document%20compiler%20crate/near/219732451" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Nelson <a href="https://rust-lang.github.io/zulip_archive/stream/182449-t-compiler/help/topic/Can&#x27;t.20document.20compiler.20crate.html#219732451">(Dec 12 2020 at 22:53)</a>:</h4>
<p>but does it still build a .rlib and a .so?</p>



<a name="219732453"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/182449-t-compiler/help/topic/Can%27t%20document%20compiler%20crate/near/219732453" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Nadrieril <a href="https://rust-lang.github.io/zulip_archive/stream/182449-t-compiler/help/topic/Can&#x27;t.20document.20compiler.20crate.html#219732453">(Dec 12 2020 at 22:53)</a>:</h4>
<p>different hash in the filename, different sizes</p>



<a name="219732454"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/182449-t-compiler/help/topic/Can%27t%20document%20compiler%20crate/near/219732454" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Nadrieril <a href="https://rust-lang.github.io/zulip_archive/stream/182449-t-compiler/help/topic/Can&#x27;t.20document.20compiler.20crate.html#219732454">(Dec 12 2020 at 22:53)</a>:</h4>
<p>yes</p>



<a name="219732456"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/182449-t-compiler/help/topic/Can%27t%20document%20compiler%20crate/near/219732456" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Nelson <a href="https://rust-lang.github.io/zulip_archive/stream/182449-t-compiler/help/topic/Can&#x27;t.20document.20compiler.20crate.html#219732456">(Dec 12 2020 at 22:53)</a>:</h4>
<p>also we should get <span class="user-mention" data-user-id="116122">@simulacrum</span> on this, he might actually know what's going on lol</p>



<a name="219732460"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/182449-t-compiler/help/topic/Can%27t%20document%20compiler%20crate/near/219732460" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Nelson <a href="https://rust-lang.github.io/zulip_archive/stream/182449-t-compiler/help/topic/Can&#x27;t.20document.20compiler.20crate.html#219732460">(Dec 12 2020 at 22:54)</a>:</h4>
<p>context: rustdoc crashes documenting with --stage 0: <a href="https://github.com/rust-lang/rust/issues/79980">https://github.com/rust-lang/rust/issues/79980</a></p>



<a name="219732461"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/182449-t-compiler/help/topic/Can%27t%20document%20compiler%20crate/near/219732461" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> simulacrum <a href="https://rust-lang.github.io/zulip_archive/stream/182449-t-compiler/help/topic/Can&#x27;t.20document.20compiler.20crate.html#219732461">(Dec 12 2020 at 22:54)</a>:</h4>
<p>ah</p>



<a name="219732516"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/182449-t-compiler/help/topic/Can%27t%20document%20compiler%20crate/near/219732516" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> simulacrum <a href="https://rust-lang.github.io/zulip_archive/stream/182449-t-compiler/help/topic/Can&#x27;t.20document.20compiler.20crate.html#219732516">(Dec 12 2020 at 22:55)</a>:</h4>
<p>interesting</p>



<a name="219732518"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/182449-t-compiler/help/topic/Can%27t%20document%20compiler%20crate/near/219732518" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> simulacrum <a href="https://rust-lang.github.io/zulip_archive/stream/182449-t-compiler/help/topic/Can&#x27;t.20document.20compiler.20crate.html#219732518">(Dec 12 2020 at 22:55)</a>:</h4>
<p>I'm pretty sure we're building compiler-docs in CI</p>



<a name="219732524"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/182449-t-compiler/help/topic/Can%27t%20document%20compiler%20crate/near/219732524" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Nelson <a href="https://rust-lang.github.io/zulip_archive/stream/182449-t-compiler/help/topic/Can&#x27;t.20document.20compiler.20crate.html#219732524">(Dec 12 2020 at 22:55)</a>:</h4>
<p>with --stage 1 or --stage 2 I would expect</p>



<a name="219732561"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/182449-t-compiler/help/topic/Can%27t%20document%20compiler%20crate/near/219732561" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Nelson <a href="https://rust-lang.github.io/zulip_archive/stream/182449-t-compiler/help/topic/Can&#x27;t.20document.20compiler.20crate.html#219732561">(Dec 12 2020 at 22:56)</a>:</h4>
<p>I'm not sure what's different with --stage 0 :(</p>



<a name="219732568"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/182449-t-compiler/help/topic/Can%27t%20document%20compiler%20crate/near/219732568" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> simulacrum <a href="https://rust-lang.github.io/zulip_archive/stream/182449-t-compiler/help/topic/Can&#x27;t.20document.20compiler.20crate.html#219732568">(Dec 12 2020 at 22:56)</a>:</h4>
<p>oh is this specifically with stage 0?</p>



<a name="219732570"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/182449-t-compiler/help/topic/Can%27t%20document%20compiler%20crate/near/219732570" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Nelson <a href="https://rust-lang.github.io/zulip_archive/stream/182449-t-compiler/help/topic/Can&#x27;t.20document.20compiler.20crate.html#219732570">(Dec 12 2020 at 22:56)</a>:</h4>
<p>yes</p>



<a name="219732648"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/182449-t-compiler/help/topic/Can%27t%20document%20compiler%20crate/near/219732648" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Nelson <a href="https://rust-lang.github.io/zulip_archive/stream/182449-t-compiler/help/topic/Can&#x27;t.20document.20compiler.20crate.html#219732648">(Dec 12 2020 at 22:59)</a>:</h4>
<p>this is the error:</p>
<div class="codehilite"><pre><span></span><code>  Documenting rustc_macros v0.1.0 (/home/joshua/rustc3/compiler/rustc_macros)
error[E0460]: found possibly newer version of crate `std` which `synstructure` depends on
 --&gt; compiler/rustc_macros/src/lib.rs:5:5
  |
5 | use synstructure::decl_derive;
  |     ^^^^^^^^^^^^
  |
  = note: perhaps that crate needs to be recompiled?
  = note: the following crate versions were found:
          crate `std`: /home/joshua/rustc3/build/x86_64-unknown-linux-gnu/stage0-sysroot/lib/rustlib/x86_64-unknown-linux-gnu/lib/libstd-8049277477c5d6df.rlib
          crate `std`: /home/joshua/rustc3/build/x86_64-unknown-linux-gnu/stage0-sysroot/lib/rustlib/x86_64-unknown-linux-gnu/lib/libstd-8049277477c5d6df.so
          crate `synstructure`: /home/joshua/rustc3/build/x86_64-unknown-linux-gnu/stage0-rustc/release/deps/libsynstructure-af825c806db8e20d.rmeta
</code></pre></div>



<a name="219732649"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/182449-t-compiler/help/topic/Can%27t%20document%20compiler%20crate/near/219732649" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> simulacrum <a href="https://rust-lang.github.io/zulip_archive/stream/182449-t-compiler/help/topic/Can&#x27;t.20document.20compiler.20crate.html#219732649">(Dec 12 2020 at 22:59)</a>:</h4>
<p>I guess I haven't looked at that PR? I assume it's assigned to me</p>



<a name="219732693"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/182449-t-compiler/help/topic/Can%27t%20document%20compiler%20crate/near/219732693" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Nelson <a href="https://rust-lang.github.io/zulip_archive/stream/182449-t-compiler/help/topic/Can&#x27;t.20document.20compiler.20crate.html#219732693">(Dec 12 2020 at 23:00)</a>:</h4>
<p>there are a couple related PRs (<a href="https://github.com/rust-lang/rust/pull/79954">https://github.com/rust-lang/rust/pull/79954</a>, <a href="https://github.com/rust-lang/rust/pull/79984">https://github.com/rust-lang/rust/pull/79984</a>, both from today) but neither fix the latest error</p>



<a name="219732695"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/182449-t-compiler/help/topic/Can%27t%20document%20compiler%20crate/near/219732695" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Nelson <a href="https://rust-lang.github.io/zulip_archive/stream/182449-t-compiler/help/topic/Can&#x27;t.20document.20compiler.20crate.html#219732695">(Dec 12 2020 at 23:00)</a>:</h4>
<p>they'll just be necessary once this error is fixed</p>



<a name="219732719"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/182449-t-compiler/help/topic/Can%27t%20document%20compiler%20crate/near/219732719" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> simulacrum <a href="https://rust-lang.github.io/zulip_archive/stream/182449-t-compiler/help/topic/Can&#x27;t.20document.20compiler.20crate.html#219732719">(Dec 12 2020 at 23:01)</a>:</h4>
<p>I'll try to take a look I guess, want to finish my PR review backlog first</p>



<a name="219732772"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/182449-t-compiler/help/topic/Can%27t%20document%20compiler%20crate/near/219732772" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Nelson <a href="https://rust-lang.github.io/zulip_archive/stream/182449-t-compiler/help/topic/Can&#x27;t.20document.20compiler.20crate.html#219732772">(Dec 12 2020 at 23:02)</a>:</h4>
<p>no problem, this isn't urgent</p>



<a name="219732774"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/182449-t-compiler/help/topic/Can%27t%20document%20compiler%20crate/near/219732774" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Nelson <a href="https://rust-lang.github.io/zulip_archive/stream/182449-t-compiler/help/topic/Can&#x27;t.20document.20compiler.20crate.html#219732774">(Dec 12 2020 at 23:02)</a>:</h4>
<p>pretty sure it's been broken for a while</p>



<a name="219732787"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/182449-t-compiler/help/topic/Can%27t%20document%20compiler%20crate/near/219732787" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Nelson <a href="https://rust-lang.github.io/zulip_archive/stream/182449-t-compiler/help/topic/Can&#x27;t.20document.20compiler.20crate.html#219732787">(Dec 12 2020 at 23:02)</a>:</h4>
<p>I have to go for dinner but I expect <span class="user-mention" data-user-id="245339">@Nadrieril</span> and I might keep stumbling around blindly for a bit after <span aria-label="laughing" class="emoji emoji-1f606" role="img" title="laughing">:laughing:</span></p>



<a name="219733424"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/182449-t-compiler/help/topic/Can%27t%20document%20compiler%20crate/near/219733424" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Nadrieril <a href="https://rust-lang.github.io/zulip_archive/stream/182449-t-compiler/help/topic/Can&#x27;t.20document.20compiler.20crate.html#219733424">(Dec 12 2020 at 23:21)</a>:</h4>
<p>can confirm that <code>--stage 1</code> works for me</p>



<a name="219733425"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/182449-t-compiler/help/topic/Can%27t%20document%20compiler%20crate/near/219733425" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Nadrieril <a href="https://rust-lang.github.io/zulip_archive/stream/182449-t-compiler/help/topic/Can&#x27;t.20document.20compiler.20crate.html#219733425">(Dec 12 2020 at 23:21)</a>:</h4>
<p>I'll have to go to sleep at some point too ^^</p>



<a name="219734443"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/182449-t-compiler/help/topic/Can%27t%20document%20compiler%20crate/near/219734443" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> simulacrum <a href="https://rust-lang.github.io/zulip_archive/stream/182449-t-compiler/help/topic/Can&#x27;t.20document.20compiler.20crate.html#219734443">(Dec 12 2020 at 23:53)</a>:</h4>
<p>I think <a href="https://github.com/rust-lang/rust/issues/74976#issuecomment-667265945">https://github.com/rust-lang/rust/issues/74976#issuecomment-667265945</a> is still accurate</p>



<a name="219734445"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/182449-t-compiler/help/topic/Can%27t%20document%20compiler%20crate/near/219734445" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> simulacrum <a href="https://rust-lang.github.io/zulip_archive/stream/182449-t-compiler/help/topic/Can&#x27;t.20document.20compiler.20crate.html#219734445">(Dec 12 2020 at 23:53)</a>:</h4>
<p>and so fixing this is indeed hard</p>



<a name="219734505"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/182449-t-compiler/help/topic/Can%27t%20document%20compiler%20crate/near/219734505" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Nelson <a href="https://rust-lang.github.io/zulip_archive/stream/182449-t-compiler/help/topic/Can&#x27;t.20document.20compiler.20crate.html#219734505">(Dec 12 2020 at 23:55)</a>:</h4>
<blockquote>
<p>I suspect that rustdoc always setting the sysroot might in fact be a bug, or at least unintentional - it seems like the two should be the same probably?</p>
</blockquote>
<p>would it be enough to only set sysroot if <code>--sysroot</code> isn't passed?</p>



<a name="219734508"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/182449-t-compiler/help/topic/Can%27t%20document%20compiler%20crate/near/219734508" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Nelson <a href="https://rust-lang.github.io/zulip_archive/stream/182449-t-compiler/help/topic/Can&#x27;t.20document.20compiler.20crate.html#219734508">(Dec 12 2020 at 23:55)</a>:</h4>
<p>(is this a 'try it and see' question?)</p>



<a name="219734511"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/182449-t-compiler/help/topic/Can%27t%20document%20compiler%20crate/near/219734511" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> simulacrum <a href="https://rust-lang.github.io/zulip_archive/stream/182449-t-compiler/help/topic/Can&#x27;t.20document.20compiler.20crate.html#219734511">(Dec 12 2020 at 23:55)</a>:</h4>
<p>No, that doesn't seem correct</p>



<a name="219734513"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/182449-t-compiler/help/topic/Can%27t%20document%20compiler%20crate/near/219734513" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> simulacrum <a href="https://rust-lang.github.io/zulip_archive/stream/182449-t-compiler/help/topic/Can&#x27;t.20document.20compiler.20crate.html#219734513">(Dec 12 2020 at 23:55)</a>:</h4>
<p>I don't know why we're doing that with rustc</p>



<a name="219734550"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/182449-t-compiler/help/topic/Can%27t%20document%20compiler%20crate/near/219734550" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> simulacrum <a href="https://rust-lang.github.io/zulip_archive/stream/182449-t-compiler/help/topic/Can&#x27;t.20document.20compiler.20crate.html#219734550">(Dec 12 2020 at 23:56)</a>:</h4>
<p>Ah, cargo miri test</p>



<a name="219734552"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/182449-t-compiler/help/topic/Can%27t%20document%20compiler%20crate/near/219734552" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> simulacrum <a href="https://rust-lang.github.io/zulip_archive/stream/182449-t-compiler/help/topic/Can&#x27;t.20document.20compiler.20crate.html#219734552">(Dec 12 2020 at 23:56)</a>:</h4>
<p>ok, so just piling hacks then :)</p>



<a name="219734557"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/182449-t-compiler/help/topic/Can%27t%20document%20compiler%20crate/near/219734557" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> simulacrum <a href="https://rust-lang.github.io/zulip_archive/stream/182449-t-compiler/help/topic/Can&#x27;t.20document.20compiler.20crate.html#219734557">(Dec 12 2020 at 23:56)</a>:</h4>
<p>Yeah, I don't think that will be the right fix</p>



<a name="219734567"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/182449-t-compiler/help/topic/Can%27t%20document%20compiler%20crate/near/219734567" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> simulacrum <a href="https://rust-lang.github.io/zulip_archive/stream/182449-t-compiler/help/topic/Can&#x27;t.20document.20compiler.20crate.html#219734567">(Dec 12 2020 at 23:57)</a>:</h4>
<p>You need the sysroots in sync during a build, otherwise you get bugs like these, but because Cargo is passing --target to rustdoc but not to rustc, that's not happening</p>



<a name="219734569"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/182449-t-compiler/help/topic/Can%27t%20document%20compiler%20crate/near/219734569" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> simulacrum <a href="https://rust-lang.github.io/zulip_archive/stream/182449-t-compiler/help/topic/Can&#x27;t.20document.20compiler.20crate.html#219734569">(Dec 12 2020 at 23:57)</a>:</h4>
<p>I don't really understand why rustc doesn't get --target passed, though.</p>



<a name="219734571"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/182449-t-compiler/help/topic/Can%27t%20document%20compiler%20crate/near/219734571" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> simulacrum <a href="https://rust-lang.github.io/zulip_archive/stream/182449-t-compiler/help/topic/Can&#x27;t.20document.20compiler.20crate.html#219734571">(Dec 12 2020 at 23:57)</a>:</h4>
<p>(Seems odd).</p>



<a name="219734614"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/182449-t-compiler/help/topic/Can%27t%20document%20compiler%20crate/near/219734614" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Nelson <a href="https://rust-lang.github.io/zulip_archive/stream/182449-t-compiler/help/topic/Can&#x27;t.20document.20compiler.20crate.html#219734614">(Dec 12 2020 at 23:58)</a>:</h4>
<p><span class="user-mention silent" data-user-id="116122">simulacrum</span> <a href="#narrow/stream/182449-t-compiler.2Fhelp/topic/Can't.20document.20compiler.20crate/near/219734569">said</a>:</p>
<blockquote>
<p>I don't really understand why rustc doesn't get --target passed, though.</p>
</blockquote>
<p>this might be because it's a proc-macro</p>



<a name="219734620"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/182449-t-compiler/help/topic/Can%27t%20document%20compiler%20crate/near/219734620" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Nelson <a href="https://rust-lang.github.io/zulip_archive/stream/182449-t-compiler/help/topic/Can&#x27;t.20document.20compiler.20crate.html#219734620">(Dec 12 2020 at 23:58)</a>:</h4>
<p>I remember cargo has a <em>lot</em> of weirdness around proc-macros</p>



<a name="219734624"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/182449-t-compiler/help/topic/Can%27t%20document%20compiler%20crate/near/219734624" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Nelson <a href="https://rust-lang.github.io/zulip_archive/stream/182449-t-compiler/help/topic/Can&#x27;t.20document.20compiler.20crate.html#219734624">(Dec 12 2020 at 23:58)</a>:</h4>
<p><a href="https://github.com/rust-lang/cargo/issues/7677">https://github.com/rust-lang/cargo/issues/7677</a></p>



<a name="219734625"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/182449-t-compiler/help/topic/Can%27t%20document%20compiler%20crate/near/219734625" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Nelson <a href="https://rust-lang.github.io/zulip_archive/stream/182449-t-compiler/help/topic/Can&#x27;t.20document.20compiler.20crate.html#219734625">(Dec 12 2020 at 23:58)</a>:</h4>
<p>ugh</p>



<a name="219734634"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/182449-t-compiler/help/topic/Can%27t%20document%20compiler%20crate/near/219734634" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Nelson <a href="https://rust-lang.github.io/zulip_archive/stream/182449-t-compiler/help/topic/Can&#x27;t.20document.20compiler.20crate.html#219734634">(Dec 12 2020 at 23:59)</a>:</h4>
<p>could we pass <code>--target host</code> if --target isn't set, maybe?</p>



<a name="219734637"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/182449-t-compiler/help/topic/Can%27t%20document%20compiler%20crate/near/219734637" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Nelson <a href="https://rust-lang.github.io/zulip_archive/stream/182449-t-compiler/help/topic/Can&#x27;t.20document.20compiler.20crate.html#219734637">(Dec 12 2020 at 23:59)</a>:</h4>
<p>(whatever the host happens to be)</p>



<a name="219734645"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/182449-t-compiler/help/topic/Can%27t%20document%20compiler%20crate/near/219734645" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Nelson <a href="https://rust-lang.github.io/zulip_archive/stream/182449-t-compiler/help/topic/Can&#x27;t.20document.20compiler.20crate.html#219734645">(Dec 12 2020 at 23:59)</a>:</h4>
<p><span class="user-mention silent" data-user-id="116122">simulacrum</span> <a href="#narrow/stream/182449-t-compiler.2Fhelp/topic/Can't.20document.20compiler.20crate/near/219734557">said</a>:</p>
<blockquote>
<p>Yeah, I don't think that will be the right fix</p>
</blockquote>
<p>you are correct, it did not work <span aria-label="laughing" class="emoji emoji-1f606" role="img" title="laughing">:laughing:</span></p>



<a name="219734709"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/182449-t-compiler/help/topic/Can%27t%20document%20compiler%20crate/near/219734709" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> simulacrum <a href="https://rust-lang.github.io/zulip_archive/stream/182449-t-compiler/help/topic/Can&#x27;t.20document.20compiler.20crate.html#219734709">(Dec 13 2020 at 00:00)</a>:</h4>
<p>I doubt that there will be a clear path towards fixing this. Generally speaking, passing --target host is likely to break other things; it's not a clear path forward.</p>



<a name="219734740"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/182449-t-compiler/help/topic/Can%27t%20document%20compiler%20crate/near/219734740" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> simulacrum <a href="https://rust-lang.github.io/zulip_archive/stream/182449-t-compiler/help/topic/Can&#x27;t.20document.20compiler.20crate.html#219734740">(Dec 13 2020 at 00:01)</a>:</h4>
<p>(For example, the reason we don't always want to pass --target is that currently that is used to detect proc macros and build scripts during the std build and use the beta sysroot to build them. The normal sysroot is not yet populated with std, so we cannot do otherwise).</p>



<a name="219734741"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/182449-t-compiler/help/topic/Can%27t%20document%20compiler%20crate/near/219734741" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Nelson <a href="https://rust-lang.github.io/zulip_archive/stream/182449-t-compiler/help/topic/Can&#x27;t.20document.20compiler.20crate.html#219734741">(Dec 13 2020 at 00:01)</a>:</h4>
<p>for rustdoc specifically the only thing that should change is the output directory</p>



<a name="219734748"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/182449-t-compiler/help/topic/Can%27t%20document%20compiler%20crate/near/219734748" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> simulacrum <a href="https://rust-lang.github.io/zulip_archive/stream/182449-t-compiler/help/topic/Can&#x27;t.20document.20compiler.20crate.html#219734748">(Dec 13 2020 at 00:01)</a>:</h4>
<p>I do not think that is true.</p>



<a name="219734788"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/182449-t-compiler/help/topic/Can%27t%20document%20compiler%20crate/near/219734788" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Nelson <a href="https://rust-lang.github.io/zulip_archive/stream/182449-t-compiler/help/topic/Can&#x27;t.20document.20compiler.20crate.html#219734788">(Dec 13 2020 at 00:02)</a>:</h4>
<p>I missed your previous comment, sorry - let me read that</p>



<a name="219734792"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/182449-t-compiler/help/topic/Can%27t%20document%20compiler%20crate/near/219734792" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Nelson <a href="https://rust-lang.github.io/zulip_archive/stream/182449-t-compiler/help/topic/Can&#x27;t.20document.20compiler.20crate.html#219734792">(Dec 13 2020 at 00:02)</a>:</h4>
<p>(chat platforms should really reconfirm if you want to send if someone else sent at the same time)</p>



<a name="219734823"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/182449-t-compiler/help/topic/Can%27t%20document%20compiler%20crate/near/219734823" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Nelson <a href="https://rust-lang.github.io/zulip_archive/stream/182449-t-compiler/help/topic/Can&#x27;t.20document.20compiler.20crate.html#219734823">(Dec 13 2020 at 00:03)</a>:</h4>
<p><span class="user-mention silent" data-user-id="116122">simulacrum</span> <a href="#narrow/stream/182449-t-compiler.2Fhelp/topic/Can't.20document.20compiler.20crate/near/219734740">said</a>:</p>
<blockquote>
<p>(For example, the reason we don't always want to pass --target is that currently that is used to detect proc macros and build scripts during the std build and use the beta sysroot to build them. The normal sysroot is not yet populated with std, so we cannot do otherwise).</p>
</blockquote>
<p>hmm, I guess rustdoc can certainly be called on proc-macros, in which case we need to use beta libstd, yeah</p>



<a name="219735099"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/182449-t-compiler/help/topic/Can%27t%20document%20compiler%20crate/near/219735099" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Nelson <a href="https://rust-lang.github.io/zulip_archive/stream/182449-t-compiler/help/topic/Can&#x27;t.20document.20compiler.20crate.html#219735099">(Dec 13 2020 at 00:11)</a>:</h4>
<p>that said, this does work:</p>
<div class="codehilite"><pre><span></span><code>RUSTDOCFLAGS=&quot;--sysroot=$(rustc --print sysroot)&quot; x.py doc --stage 0 compiler/rustc
</code></pre></div>



<a name="219735102"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/182449-t-compiler/help/topic/Can%27t%20document%20compiler%20crate/near/219735102" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Nelson <a href="https://rust-lang.github.io/zulip_archive/stream/182449-t-compiler/help/topic/Can&#x27;t.20document.20compiler.20crate.html#219735102">(Dec 13 2020 at 00:11)</a>:</h4>
<p><span class="user-mention" data-user-id="245339">@Nadrieril</span> can you try that command? ^</p>



<a name="219735147"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/182449-t-compiler/help/topic/Can%27t%20document%20compiler%20crate/near/219735147" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Nelson <a href="https://rust-lang.github.io/zulip_archive/stream/182449-t-compiler/help/topic/Can&#x27;t.20document.20compiler.20crate.html#219735147">(Dec 13 2020 at 00:12)</a>:</h4>
<p>oh wait it's still recompiling, not documenting yet :( never mind, waiting for that to run</p>



<a name="219735158"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/182449-t-compiler/help/topic/Can%27t%20document%20compiler%20crate/near/219735158" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> simulacrum <a href="https://rust-lang.github.io/zulip_archive/stream/182449-t-compiler/help/topic/Can&#x27;t.20document.20compiler.20crate.html#219735158">(Dec 13 2020 at 00:12)</a>:</h4>
<p>I have no idea what sysroot that is using</p>



<a name="219735161"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/182449-t-compiler/help/topic/Can%27t%20document%20compiler%20crate/near/219735161" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> simulacrum <a href="https://rust-lang.github.io/zulip_archive/stream/182449-t-compiler/help/topic/Can&#x27;t.20document.20compiler.20crate.html#219735161">(Dec 13 2020 at 00:12)</a>:</h4>
<p>nightly I guess?</p>



<a name="219735162"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/182449-t-compiler/help/topic/Can%27t%20document%20compiler%20crate/near/219735162" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Nadrieril <a href="https://rust-lang.github.io/zulip_archive/stream/182449-t-compiler/help/topic/Can&#x27;t.20document.20compiler.20crate.html#219735162">(Dec 13 2020 at 00:12)</a>:</h4>
<p><span class="user-mention silent" data-user-id="232545">Joshua Nelson</span> <a href="#narrow/stream/182449-t-compiler.2Fhelp/topic/Can't.20document.20compiler.20crate/near/219735102">said</a>:</p>
<blockquote>
<p><span class="user-mention silent" data-user-id="245339">Nadrieril</span> can you try that command? ^</p>
</blockquote>
<p>same error</p>



<a name="219735171"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/182449-t-compiler/help/topic/Can%27t%20document%20compiler%20crate/near/219735171" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Nelson <a href="https://rust-lang.github.io/zulip_archive/stream/182449-t-compiler/help/topic/Can&#x27;t.20document.20compiler.20crate.html#219735171">(Dec 13 2020 at 00:13)</a>:</h4>
<p><span class="user-mention silent" data-user-id="116122">simulacrum</span> <a href="#narrow/stream/182449-t-compiler.2Fhelp/topic/Can't.20document.20compiler.20crate/near/219735158">said</a>:</p>
<blockquote>
<p>I have no idea what sysroot that is using</p>
</blockquote>
<p>yes, sorry, that's nightly</p>



<a name="219735174"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/182449-t-compiler/help/topic/Can%27t%20document%20compiler%20crate/near/219735174" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Nadrieril <a href="https://rust-lang.github.io/zulip_archive/stream/182449-t-compiler/help/topic/Can&#x27;t.20document.20compiler.20crate.html#219735174">(Dec 13 2020 at 00:13)</a>:</h4>
<p>oh yeah, that's using sysroot from stable for me</p>



<a name="219735178"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/182449-t-compiler/help/topic/Can%27t%20document%20compiler%20crate/near/219735178" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> simulacrum <a href="https://rust-lang.github.io/zulip_archive/stream/182449-t-compiler/help/topic/Can&#x27;t.20document.20compiler.20crate.html#219735178">(Dec 13 2020 at 00:13)</a>:</h4>
<p>that's (as we have discussed many times before :) is not guaranteed to work, because std in-tree and in nightly (or whatever sysroot you're getting) could be different</p>



<a name="219735220"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/182449-t-compiler/help/topic/Can%27t%20document%20compiler%20crate/near/219735220" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> simulacrum <a href="https://rust-lang.github.io/zulip_archive/stream/182449-t-compiler/help/topic/Can&#x27;t.20document.20compiler.20crate.html#219735220">(Dec 13 2020 at 00:14)</a>:</h4>
<p>and the other part of it is that RUSTDOCFLAGS and RUSTFLAGS presumably both have same behavior and don't apply to build scripts / proc macros when --target is passed.</p>



<a name="219735222"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/182449-t-compiler/help/topic/Can%27t%20document%20compiler%20crate/near/219735222" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Nelson <a href="https://rust-lang.github.io/zulip_archive/stream/182449-t-compiler/help/topic/Can&#x27;t.20document.20compiler.20crate.html#219735222">(Dec 13 2020 at 00:14)</a>:</h4>
<p>ugh yeah you're right</p>



<a name="219735231"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/182449-t-compiler/help/topic/Can%27t%20document%20compiler%20crate/near/219735231" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Nelson <a href="https://rust-lang.github.io/zulip_archive/stream/182449-t-compiler/help/topic/Can&#x27;t.20document.20compiler.20crate.html#219735231">(Dec 13 2020 at 00:14)</a>:</h4>
<p>I don't know why cargo does that :(</p>



<a name="219735252"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/182449-t-compiler/help/topic/Can%27t%20document%20compiler%20crate/near/219735252" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> simulacrum <a href="https://rust-lang.github.io/zulip_archive/stream/182449-t-compiler/help/topic/Can&#x27;t.20document.20compiler.20crate.html#219735252">(Dec 13 2020 at 00:15)</a>:</h4>
<p>One thing that <em>would</em> be interesting to explore is why non-zero stages work</p>



<a name="219735270"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/182449-t-compiler/help/topic/Can%27t%20document%20compiler%20crate/near/219735270" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> simulacrum <a href="https://rust-lang.github.io/zulip_archive/stream/182449-t-compiler/help/topic/Can&#x27;t.20document.20compiler.20crate.html#219735270">(Dec 13 2020 at 00:15)</a>:</h4>
<p>Because I would have expected a similar bug there. It's possible though that we just don't detect it with ignore-git=true? I don't know.</p>



<a name="219735313"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/182449-t-compiler/help/topic/Can%27t%20document%20compiler%20crate/near/219735313" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Nelson <a href="https://rust-lang.github.io/zulip_archive/stream/182449-t-compiler/help/topic/Can&#x27;t.20document.20compiler.20crate.html#219735313">(Dec 13 2020 at 00:16)</a>:</h4>
<blockquote>
<p>It's possible though that we just don't detect it with ignore-git=true? I don't know.</p>
</blockquote>
<p>oh that's frightening <span aria-label="sweat smile" class="emoji emoji-1f605" role="img" title="sweat smile">:sweat_smile:</span></p>



<a name="219735319"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/182449-t-compiler/help/topic/Can%27t%20document%20compiler%20crate/near/219735319" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Nelson <a href="https://rust-lang.github.io/zulip_archive/stream/182449-t-compiler/help/topic/Can&#x27;t.20document.20compiler.20crate.html#219735319">(Dec 13 2020 at 00:16)</a>:</h4>
<p>I guess I can recompile everything and see?</p>



<a name="219735324"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/182449-t-compiler/help/topic/Can%27t%20document%20compiler%20crate/near/219735324" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> simulacrum <a href="https://rust-lang.github.io/zulip_archive/stream/182449-t-compiler/help/topic/Can&#x27;t.20document.20compiler.20crate.html#219735324">(Dec 13 2020 at 00:16)</a>:</h4>
<p>I don't think you can</p>



<a name="219735326"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/182449-t-compiler/help/topic/Can%27t%20document%20compiler%20crate/near/219735326" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> simulacrum <a href="https://rust-lang.github.io/zulip_archive/stream/182449-t-compiler/help/topic/Can&#x27;t.20document.20compiler.20crate.html#219735326">(Dec 13 2020 at 00:16)</a>:</h4>
<p>ignore-git isn't really the thing there</p>



<a name="219735343"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/182449-t-compiler/help/topic/Can%27t%20document%20compiler%20crate/near/219735343" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Nadrieril <a href="https://rust-lang.github.io/zulip_archive/stream/182449-t-compiler/help/topic/Can&#x27;t.20document.20compiler.20crate.html#219735343">(Dec 13 2020 at 00:17)</a>:</h4>
<p>I'm surprised why this wasn't found before. Does no one ever run <code>x.py doc</code>?</p>



<a name="219735350"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/182449-t-compiler/help/topic/Can%27t%20document%20compiler%20crate/near/219735350" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> simulacrum <a href="https://rust-lang.github.io/zulip_archive/stream/182449-t-compiler/help/topic/Can&#x27;t.20document.20compiler.20crate.html#219735350">(Dec 13 2020 at 00:17)</a>:</h4>
<p>Oh, I think I know why this isn't causing problems in non-zero stages: the sysroot there is just right by default</p>



<a name="219735355"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/182449-t-compiler/help/topic/Can%27t%20document%20compiler%20crate/near/219735355" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Nelson <a href="https://rust-lang.github.io/zulip_archive/stream/182449-t-compiler/help/topic/Can&#x27;t.20document.20compiler.20crate.html#219735355">(Dec 13 2020 at 00:17)</a>:</h4>
<p><span class="user-mention" data-user-id="245339">@Nadrieril</span> I have it set to <code>doc-stage = 1</code> and I think others have compiler-docs turned off</p>



<a name="219735402"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/182449-t-compiler/help/topic/Can%27t%20document%20compiler%20crate/near/219735402" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Nelson <a href="https://rust-lang.github.io/zulip_archive/stream/182449-t-compiler/help/topic/Can&#x27;t.20document.20compiler.20crate.html#219735402">(Dec 13 2020 at 00:18)</a>:</h4>
<p><span class="user-mention silent" data-user-id="116122">simulacrum</span> <a href="#narrow/stream/182449-t-compiler.2Fhelp/topic/Can't.20document.20compiler.20crate/near/219735350">said</a>:</p>
<blockquote>
<p>Oh, I think I know why this isn't causing problems in non-zero stages: the sysroot there is just right by default</p>
</blockquote>
<p>that sounds right - there's no beta libstd to confuse it with</p>



<a name="219735408"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/182449-t-compiler/help/topic/Can%27t%20document%20compiler%20crate/near/219735408" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> simulacrum <a href="https://rust-lang.github.io/zulip_archive/stream/182449-t-compiler/help/topic/Can&#x27;t.20document.20compiler.20crate.html#219735408">(Dec 13 2020 at 00:18)</a>:</h4>
<p>kind of.</p>



<a name="219735421"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/182449-t-compiler/help/topic/Can%27t%20document%20compiler%20crate/near/219735421" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> simulacrum <a href="https://rust-lang.github.io/zulip_archive/stream/182449-t-compiler/help/topic/Can&#x27;t.20document.20compiler.20crate.html#219735421">(Dec 13 2020 at 00:19)</a>:</h4>
<p>stage0-sysroot and stage0 are both sysroots in stage 0, but in higher stages there's just the one sysroot, so we don't see this bug (sort of by accident, really)</p>



<a name="219735485"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/182449-t-compiler/help/topic/Can%27t%20document%20compiler%20crate/near/219735485" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Nelson <a href="https://rust-lang.github.io/zulip_archive/stream/182449-t-compiler/help/topic/Can&#x27;t.20document.20compiler.20crate.html#219735485">(Dec 13 2020 at 00:20)</a>:</h4>
<p><span class="user-mention silent" data-user-id="116122">simulacrum</span> <a href="#narrow/stream/182449-t-compiler.2Fhelp/topic/Can't.20document.20compiler.20crate/near/219735421">said</a>:</p>
<blockquote>
<p>stage0-sysroot and stage0 are both sysroots in stage 0, but in higher stages there's just the one sysroot, so we don't see this bug (sort of by accident, really)</p>
</blockquote>
<p>right - stage0/ is the beta sysroot and stage0-sysroot/ is master libstd</p>



<a name="219735488"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/182449-t-compiler/help/topic/Can%27t%20document%20compiler%20crate/near/219735488" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Nadrieril <a href="https://rust-lang.github.io/zulip_archive/stream/182449-t-compiler/help/topic/Can&#x27;t.20document.20compiler.20crate.html#219735488">(Dec 13 2020 at 00:20)</a>:</h4>
<p>Just to check: is the problem that rustdoc somehow mixes libstd from stage0-sysroot and stage0?</p>



<a name="219735490"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/182449-t-compiler/help/topic/Can%27t%20document%20compiler%20crate/near/219735490" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Nelson <a href="https://rust-lang.github.io/zulip_archive/stream/182449-t-compiler/help/topic/Can&#x27;t.20document.20compiler.20crate.html#219735490">(Dec 13 2020 at 00:20)</a>:</h4>
<p>yes</p>



<a name="219735492"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/182449-t-compiler/help/topic/Can%27t%20document%20compiler%20crate/near/219735492" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Nelson <a href="https://rust-lang.github.io/zulip_archive/stream/182449-t-compiler/help/topic/Can&#x27;t.20document.20compiler.20crate.html#219735492">(Dec 13 2020 at 00:21)</a>:</h4>
<p>or rather, rustc uses stage0/ and rustdoc uses stage0-sysroot/</p>



<a name="219735495"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/182449-t-compiler/help/topic/Can%27t%20document%20compiler%20crate/near/219735495" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Nadrieril <a href="https://rust-lang.github.io/zulip_archive/stream/182449-t-compiler/help/topic/Can&#x27;t.20document.20compiler.20crate.html#219735495">(Dec 13 2020 at 00:21)</a>:</h4>
<p>oh ok makes more sense</p>



<a name="219735602"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/182449-t-compiler/help/topic/Can%27t%20document%20compiler%20crate/near/219735602" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Nadrieril <a href="https://rust-lang.github.io/zulip_archive/stream/182449-t-compiler/help/topic/Can&#x27;t.20document.20compiler.20crate.html#219735602">(Dec 13 2020 at 00:24)</a>:</h4>
<p>by "uses a libstd", do you mean "is a binary compiled with that libstd" or "links that libstd into what it compiles/documents"?</p>



<a name="219735608"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/182449-t-compiler/help/topic/Can%27t%20document%20compiler%20crate/near/219735608" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Nelson <a href="https://rust-lang.github.io/zulip_archive/stream/182449-t-compiler/help/topic/Can&#x27;t.20document.20compiler.20crate.html#219735608">(Dec 13 2020 at 00:24)</a>:</h4>
<p>"links that libstd", stage 0 rustdoc is already built ;)</p>



<a name="219735612"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/182449-t-compiler/help/topic/Can%27t%20document%20compiler%20crate/near/219735612" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Nadrieril <a href="https://rust-lang.github.io/zulip_archive/stream/182449-t-compiler/help/topic/Can&#x27;t.20document.20compiler.20crate.html#219735612">(Dec 13 2020 at 00:25)</a>:</h4>
<p>oh right, we're running stuff from beta</p>



<a name="219735965"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/182449-t-compiler/help/topic/Can%27t%20document%20compiler%20crate/near/219735965" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Nadrieril <a href="https://rust-lang.github.io/zulip_archive/stream/182449-t-compiler/help/topic/Can&#x27;t.20document.20compiler.20crate.html#219735965">(Dec 13 2020 at 00:35)</a>:</h4>
<p>still trying to understand: why does rustdoc use stage0-sysroot? if rustc can compile stuff with the stage0 sysroot, surely rustdoc should be able to use the same?</p>



<a name="219736014"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/182449-t-compiler/help/topic/Can%27t%20document%20compiler%20crate/near/219736014" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Nelson <a href="https://rust-lang.github.io/zulip_archive/stream/182449-t-compiler/help/topic/Can&#x27;t.20document.20compiler.20crate.html#219736014">(Dec 13 2020 at 00:36)</a>:</h4>
<p>As I understand it, the issue is knowing <em>when</em> to set the sysroot</p>



<a name="219736015"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/182449-t-compiler/help/topic/Can%27t%20document%20compiler%20crate/near/219736015" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Nelson <a href="https://rust-lang.github.io/zulip_archive/stream/182449-t-compiler/help/topic/Can&#x27;t.20document.20compiler.20crate.html#219736015">(Dec 13 2020 at 00:36)</a>:</h4>
<p>right now rustdoc unconditionally sets it to stage0-sysroot</p>



<a name="219736018"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/182449-t-compiler/help/topic/Can%27t%20document%20compiler%20crate/near/219736018" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Nelson <a href="https://rust-lang.github.io/zulip_archive/stream/182449-t-compiler/help/topic/Can&#x27;t.20document.20compiler.20crate.html#219736018">(Dec 13 2020 at 00:37)</a>:</h4>
<p>but it's not clear in what circumstances it should use stage0 instead</p>



<a name="219736088"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/182449-t-compiler/help/topic/Can%27t%20document%20compiler%20crate/near/219736088" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Nelson <a href="https://rust-lang.github.io/zulip_archive/stream/182449-t-compiler/help/topic/Can&#x27;t.20document.20compiler.20crate.html#219736088">(Dec 13 2020 at 00:38)</a>:</h4>
<p>this causes <em>all</em> targets to give the error, not just proc-macros (or maybe everything but proc-macros?):</p>
<div class="codehilite" data-code-language="Diff"><pre><span></span><code><span class="gh">diff --git a/src/bootstrap/bin/rustdoc.rs b/src/bootstrap/bin/rustdoc.rs</span>
<span class="gh">index cba17c8e608..f1921067872 100644</span>
<span class="gd">--- a/src/bootstrap/bin/rustdoc.rs</span>
<span class="gi">+++ b/src/bootstrap/bin/rustdoc.rs</span>
<span class="gu">@@ -25,8 +25,8 @@ fn main() {</span>

     let mut cmd = Command::new(rustdoc);
     cmd.args(&amp;args)
<span class="gd">-        .arg("--sysroot")</span>
<span class="gd">-        .arg(&amp;sysroot)</span>
<span class="gi">+        //.arg("--sysroot")</span>
<span class="gi">+        //.arg(&amp;sysroot)</span>
         .env(bootstrap::util::dylib_path_var(), env::join_paths(&amp;dylib_path).unwrap());

     // Force all crates compiled by this compiler to (a) be unstable and (b)
</code></pre></div>



<a name="219736103"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/182449-t-compiler/help/topic/Can%27t%20document%20compiler%20crate/near/219736103" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Nadrieril <a href="https://rust-lang.github.io/zulip_archive/stream/182449-t-compiler/help/topic/Can&#x27;t.20document.20compiler.20crate.html#219736103">(Dec 13 2020 at 00:39)</a>:</h4>
<p>ah, and that's where the --target business comes into play</p>



<a name="219736111"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/182449-t-compiler/help/topic/Can%27t%20document%20compiler%20crate/near/219736111" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Nelson <a href="https://rust-lang.github.io/zulip_archive/stream/182449-t-compiler/help/topic/Can&#x27;t.20document.20compiler.20crate.html#219736111">(Dec 13 2020 at 00:40)</a>:</h4>
<p>sorry, I overloaded 'target' there</p>



<a name="219736150"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/182449-t-compiler/help/topic/Can%27t%20document%20compiler%20crate/near/219736150" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Nelson <a href="https://rust-lang.github.io/zulip_archive/stream/182449-t-compiler/help/topic/Can&#x27;t.20document.20compiler.20crate.html#219736150">(Dec 13 2020 at 00:40)</a>:</h4>
<p>pretend I said 'crate' instead</p>



<a name="219736153"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/182449-t-compiler/help/topic/Can%27t%20document%20compiler%20crate/near/219736153" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Nadrieril <a href="https://rust-lang.github.io/zulip_archive/stream/182449-t-compiler/help/topic/Can&#x27;t.20document.20compiler.20crate.html#219736153">(Dec 13 2020 at 00:40)</a>:</h4>
<p>yeah I followed that</p>



<a name="219736162"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/182449-t-compiler/help/topic/Can%27t%20document%20compiler%20crate/near/219736162" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Nadrieril <a href="https://rust-lang.github.io/zulip_archive/stream/182449-t-compiler/help/topic/Can&#x27;t.20document.20compiler.20crate.html#219736162">(Dec 13 2020 at 00:41)</a>:</h4>
<p>I meant that --target is what allows rustc to choose which sysroot to use, right? But rustdoc doesn't get passed the same --target for some reason?</p>



<a name="219736177"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/182449-t-compiler/help/topic/Can%27t%20document%20compiler%20crate/near/219736177" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Nelson <a href="https://rust-lang.github.io/zulip_archive/stream/182449-t-compiler/help/topic/Can&#x27;t.20document.20compiler.20crate.html#219736177">(Dec 13 2020 at 00:41)</a>:</h4>
<p>correct</p>



<a name="219736181"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/182449-t-compiler/help/topic/Can%27t%20document%20compiler%20crate/near/219736181" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Nelson <a href="https://rust-lang.github.io/zulip_archive/stream/182449-t-compiler/help/topic/Can&#x27;t.20document.20compiler.20crate.html#219736181">(Dec 13 2020 at 00:41)</a>:</h4>
<p>which I think is <a href="https://github.com/rust-lang/cargo/issues/7677">https://github.com/rust-lang/cargo/issues/7677</a></p>



<a name="219736305"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/182449-t-compiler/help/topic/Can%27t%20document%20compiler%20crate/near/219736305" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Nadrieril <a href="https://rust-lang.github.io/zulip_archive/stream/182449-t-compiler/help/topic/Can&#x27;t.20document.20compiler.20crate.html#219736305">(Dec 13 2020 at 00:45)</a>:</h4>
<p>and naively passing the same --target flags to rustdoc as the ones we pass to rustc would break things I suppose</p>



<a name="219736310"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/182449-t-compiler/help/topic/Can%27t%20document%20compiler%20crate/near/219736310" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Nelson <a href="https://rust-lang.github.io/zulip_archive/stream/182449-t-compiler/help/topic/Can&#x27;t.20document.20compiler.20crate.html#219736310">(Dec 13 2020 at 00:45)</a>:</h4>
<p>well <em>we</em> aren't passing any target flags at all</p>



<a name="219736311"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/182449-t-compiler/help/topic/Can%27t%20document%20compiler%20crate/near/219736311" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Nelson <a href="https://rust-lang.github.io/zulip_archive/stream/182449-t-compiler/help/topic/Can&#x27;t.20document.20compiler.20crate.html#219736311">(Dec 13 2020 at 00:45)</a>:</h4>
<p>cargo is the one passing them</p>



<a name="219736312"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/182449-t-compiler/help/topic/Can%27t%20document%20compiler%20crate/near/219736312" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Nelson <a href="https://rust-lang.github.io/zulip_archive/stream/182449-t-compiler/help/topic/Can&#x27;t.20document.20compiler.20crate.html#219736312">(Dec 13 2020 at 00:46)</a>:</h4>
<p>inconsistently</p>



<a name="219736358"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/182449-t-compiler/help/topic/Can%27t%20document%20compiler%20crate/near/219736358" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Nelson <a href="https://rust-lang.github.io/zulip_archive/stream/182449-t-compiler/help/topic/Can&#x27;t.20document.20compiler.20crate.html#219736358">(Dec 13 2020 at 00:46)</a>:</h4>
<p><span class="user-mention silent" data-user-id="232545">Joshua Nelson</span> <a href="#narrow/stream/182449-t-compiler.2Fhelp/topic/Can't.20document.20compiler.20crate/near/219736310">said</a>:</p>
<blockquote>
<p>well <em>we</em> aren't passing any target flags at all</p>
</blockquote>
<p>or rather, x.py calls <code>cargo build --target</code> unconditionally I think</p>



<a name="219736368"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/182449-t-compiler/help/topic/Can%27t%20document%20compiler%20crate/near/219736368" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Nelson <a href="https://rust-lang.github.io/zulip_archive/stream/182449-t-compiler/help/topic/Can&#x27;t.20document.20compiler.20crate.html#219736368">(Dec 13 2020 at 00:47)</a>:</h4>
<p>oh!! <span class="user-mention" data-user-id="116122">@simulacrum</span> this worked:</p>
<div class="codehilite" data-code-language="Diff"><pre><span></span><code><span class="gh">diff --git a/src/bootstrap/bin/rustdoc.rs b/src/bootstrap/bin/rustdoc.rs</span>
<span class="gh">index cba17c8e608..5b9ad864b5f 100644</span>
<span class="gd">--- a/src/bootstrap/bin/rustdoc.rs</span>
<span class="gi">+++ b/src/bootstrap/bin/rustdoc.rs</span>
<span class="gu">@@ -25,10 +25,12 @@ fn main() {</span>

     let mut cmd = Command::new(rustdoc);
     cmd.args(&amp;args)
<span class="gd">-        .arg("--sysroot")</span>
<span class="gd">-        .arg(&amp;sysroot)</span>
         .env(bootstrap::util::dylib_path_var(), env::join_paths(&amp;dylib_path).unwrap());

<span class="gi">+    // Don't set the sysroot for proc-macros or build scripts.</span>
<span class="gi">+    if std::env::var("TARGET").is_err() {</span>
<span class="gi">+        cmd.arg("--sysroot").arg(&amp;sysroot);</span>
<span class="gi">+    }</span>
     // Force all crates compiled by this compiler to (a) be unstable and (b)
     // allow the `rustc_private` feature to link to other unstable crates
     // also in the sysroot.
</code></pre></div>



<a name="219736371"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/182449-t-compiler/help/topic/Can%27t%20document%20compiler%20crate/near/219736371" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Nadrieril <a href="https://rust-lang.github.io/zulip_archive/stream/182449-t-compiler/help/topic/Can&#x27;t.20document.20compiler.20crate.html#219736371">(Dec 13 2020 at 00:47)</a>:</h4>
<p>is there a good reason for this inconsistency, or is it a historical accident that is now relied on?</p>



<a name="219736373"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/182449-t-compiler/help/topic/Can%27t%20document%20compiler%20crate/near/219736373" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Nelson <a href="https://rust-lang.github.io/zulip_archive/stream/182449-t-compiler/help/topic/Can&#x27;t.20document.20compiler.20crate.html#219736373">(Dec 13 2020 at 00:47)</a>:</h4>
<p><span class="user-mention silent" data-user-id="245339">Nadrieril</span> <a href="#narrow/stream/182449-t-compiler.2Fhelp/topic/Can't.20document.20compiler.20crate/near/219736371">said</a>:</p>
<blockquote>
<p>is there a good reason for this inconsistency, or is it a historical accident that is now relied on?</p>
</blockquote>
<p>I disagree with the cargo team on this, read the issue if you want to know more</p>



<a name="219736381"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/182449-t-compiler/help/topic/Can%27t%20document%20compiler%20crate/near/219736381" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Nadrieril <a href="https://rust-lang.github.io/zulip_archive/stream/182449-t-compiler/help/topic/Can&#x27;t.20document.20compiler.20crate.html#219736381">(Dec 13 2020 at 00:47)</a>:</h4>
<p>yeah I read it but could quite figure out the reasoning</p>



<a name="219736382"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/182449-t-compiler/help/topic/Can%27t%20document%20compiler%20crate/near/219736382" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Nelson <a href="https://rust-lang.github.io/zulip_archive/stream/182449-t-compiler/help/topic/Can&#x27;t.20document.20compiler.20crate.html#219736382">(Dec 13 2020 at 00:47)</a>:</h4>
<p><span class="user-mention" data-user-id="245339">@Nadrieril</span> can you try that diff with <code>--stage 0</code>?</p>



<a name="219736446"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/182449-t-compiler/help/topic/Can%27t%20document%20compiler%20crate/near/219736446" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Nadrieril <a href="https://rust-lang.github.io/zulip_archive/stream/182449-t-compiler/help/topic/Can&#x27;t.20document.20compiler.20crate.html#219736446">(Dec 13 2020 at 00:49)</a>:</h4>
<p>I get the exact same error</p>



<a name="219736449"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/182449-t-compiler/help/topic/Can%27t%20document%20compiler%20crate/near/219736449" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Nadrieril <a href="https://rust-lang.github.io/zulip_archive/stream/182449-t-compiler/help/topic/Can&#x27;t.20document.20compiler.20crate.html#219736449">(Dec 13 2020 at 00:49)</a>:</h4>
<p>still pointing to build/.../stage0-sysroot/.../libstd</p>



<a name="219736494"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/182449-t-compiler/help/topic/Can%27t%20document%20compiler%20crate/near/219736494" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Nelson <a href="https://rust-lang.github.io/zulip_archive/stream/182449-t-compiler/help/topic/Can&#x27;t.20document.20compiler.20crate.html#219736494">(Dec 13 2020 at 00:50)</a>:</h4>
<p>that's so weird, it works for me</p>



<a name="219736502"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/182449-t-compiler/help/topic/Can%27t%20document%20compiler%20crate/near/219736502" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Nadrieril <a href="https://rust-lang.github.io/zulip_archive/stream/182449-t-compiler/help/topic/Can&#x27;t.20document.20compiler.20crate.html#219736502">(Dec 13 2020 at 00:50)</a>:</h4>
<p>I might need to clear <code>build</code></p>



<a name="219736526"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/182449-t-compiler/help/topic/Can%27t%20document%20compiler%20crate/near/219736526" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Nelson <a href="https://rust-lang.github.io/zulip_archive/stream/182449-t-compiler/help/topic/Can&#x27;t.20document.20compiler.20crate.html#219736526">(Dec 13 2020 at 00:51)</a>:</h4>
<p>yeah, I will too</p>



<a name="219736692"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/182449-t-compiler/help/topic/Can%27t%20document%20compiler%20crate/near/219736692" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Nadrieril <a href="https://rust-lang.github.io/zulip_archive/stream/182449-t-compiler/help/topic/Can&#x27;t.20document.20compiler.20crate.html#219736692">(Dec 13 2020 at 00:55)</a>:</h4>
<p>now we wait ^^</p>



<a name="219736842"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/182449-t-compiler/help/topic/Can%27t%20document%20compiler%20crate/near/219736842" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Nadrieril <a href="https://rust-lang.github.io/zulip_archive/stream/182449-t-compiler/help/topic/Can&#x27;t.20document.20compiler.20crate.html#219736842">(Dec 13 2020 at 00:58)</a>:</h4>
<p><span class="user-mention silent" data-user-id="232545">Joshua Nelson</span> <a href="#narrow/stream/182449-t-compiler.2Fhelp/topic/Can't.20document.20compiler.20crate/near/219736373">said</a>:</p>
<blockquote>
<p><span class="user-mention silent" data-user-id="245339">Nadrieril</span> <a href="#narrow/stream/182449-t-compiler.2Fhelp/topic/Can't.20document.20compiler.20crate/near/219736371">said</a>:</p>
<blockquote>
<p>is there a good reason for this inconsistency, or is it a historical accident that is now relied on?</p>
</blockquote>
<p>I disagree with the cargo team on this, read the issue if you want to know more</p>
</blockquote>
<p>The issue explains why we don't want to always pass <code>--target</code> because of no_std, and that makes sense. I imagine that in the no_std+proc_macro case, rustc doesn't get passed --target either?</p>



<a name="219736872"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/182449-t-compiler/help/topic/Can%27t%20document%20compiler%20crate/near/219736872" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Nelson <a href="https://rust-lang.github.io/zulip_archive/stream/182449-t-compiler/help/topic/Can&#x27;t.20document.20compiler.20crate.html#219736872">(Dec 13 2020 at 00:59)</a>:</h4>
<p>the issue is talking about when no_std is the <em>host</em> toolchain</p>



<a name="219736874"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/182449-t-compiler/help/topic/Can%27t%20document%20compiler%20crate/near/219736874" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Nadrieril <a href="https://rust-lang.github.io/zulip_archive/stream/182449-t-compiler/help/topic/Can&#x27;t.20document.20compiler.20crate.html#219736874">(Dec 13 2020 at 00:59)</a>:</h4>
<p>I dunno, I'm missing too many parts to understand I guess</p>



<a name="219736875"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/182449-t-compiler/help/topic/Can%27t%20document%20compiler%20crate/near/219736875" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Nelson <a href="https://rust-lang.github.io/zulip_archive/stream/182449-t-compiler/help/topic/Can&#x27;t.20document.20compiler.20crate.html#219736875">(Dec 13 2020 at 00:59)</a>:</h4>
<p>which is never the case for rustc</p>



<a name="219736920"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/182449-t-compiler/help/topic/Can%27t%20document%20compiler%20crate/near/219736920" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Nadrieril <a href="https://rust-lang.github.io/zulip_archive/stream/182449-t-compiler/help/topic/Can&#x27;t.20document.20compiler.20crate.html#219736920">(Dec 13 2020 at 01:00)</a>:</h4>
<p>oh, but could be the case for rustdoc?</p>



<a name="219736929"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/182449-t-compiler/help/topic/Can%27t%20document%20compiler%20crate/near/219736929" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Nelson <a href="https://rust-lang.github.io/zulip_archive/stream/182449-t-compiler/help/topic/Can&#x27;t.20document.20compiler.20crate.html#219736929">(Dec 13 2020 at 01:00)</a>:</h4>
<p><span aria-label="shrug" class="emoji emoji-1f937" role="img" title="shrug">:shrug:</span></p>



<a name="219736950"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/182449-t-compiler/help/topic/Can%27t%20document%20compiler%20crate/near/219736950" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Nelson <a href="https://rust-lang.github.io/zulip_archive/stream/182449-t-compiler/help/topic/Can&#x27;t.20document.20compiler.20crate.html#219736950">(Dec 13 2020 at 01:01)</a>:</h4>
<p><span class="user-mention silent" data-user-id="245339">Nadrieril</span> <a href="#narrow/stream/182449-t-compiler.2Fhelp/topic/Can't.20document.20compiler.20crate/near/219736446">said</a>:</p>
<blockquote>
<p>I get the exact same error</p>
</blockquote>
<p>ok yeah this broke for me after a rebuild</p>



<a name="219736954"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/182449-t-compiler/help/topic/Can%27t%20document%20compiler%20crate/near/219736954" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Nadrieril <a href="https://rust-lang.github.io/zulip_archive/stream/182449-t-compiler/help/topic/Can&#x27;t.20document.20compiler.20crate.html#219736954">(Dec 13 2020 at 01:01)</a>:</h4>
<p>:(</p>



<a name="219736956"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/182449-t-compiler/help/topic/Can%27t%20document%20compiler%20crate/near/219736956" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Nelson <a href="https://rust-lang.github.io/zulip_archive/stream/182449-t-compiler/help/topic/Can&#x27;t.20document.20compiler.20crate.html#219736956">(Dec 13 2020 at 01:01)</a>:</h4>
<p>not sure what happened before, maybe it was cached or something</p>



<a name="219737005"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/182449-t-compiler/help/topic/Can%27t%20document%20compiler%20crate/near/219737005" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Nadrieril <a href="https://rust-lang.github.io/zulip_archive/stream/182449-t-compiler/help/topic/Can&#x27;t.20document.20compiler.20crate.html#219737005">(Dec 13 2020 at 01:02)</a>:</h4>
<p>well, sounds like unless someone sits down and makes this mess consistent there's not much we can do</p>



<a name="219737011"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/182449-t-compiler/help/topic/Can%27t%20document%20compiler%20crate/near/219737011" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Nelson <a href="https://rust-lang.github.io/zulip_archive/stream/182449-t-compiler/help/topic/Can&#x27;t.20document.20compiler.20crate.html#219737011">(Dec 13 2020 at 01:02)</a>:</h4>
<p>yeah :(</p>



<a name="219737261"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/182449-t-compiler/help/topic/Can%27t%20document%20compiler%20crate/near/219737261" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Nadrieril <a href="https://rust-lang.github.io/zulip_archive/stream/182449-t-compiler/help/topic/Can&#x27;t.20document.20compiler.20crate.html#219737261">(Dec 13 2020 at 01:09)</a>:</h4>
<p>well, time for bed. I'll be having recursive dreams of bootstrapping messes</p>



<hr><p>Last updated: Aug 07 2021 at 22:04 UTC</p>
</html>