<html>
<head><meta charset="utf-8"><title>Replacing stdlib for a builtin triple with a custom spec · t-compiler/help · Zulip Chat Archive</title></head>
<h2>Stream: <a href="https://zulip-archive.rust-lang.org/stream/182449-t-compiler/help/index.html">t-compiler/help</a></h2>
<h3>Topic: <a href="https://zulip-archive.rust-lang.org/stream/182449-t-compiler/help/topic/Replacing.20stdlib.20for.20a.20builtin.20triple.20with.20a.20custom.20spec.html">Replacing stdlib for a builtin triple with a custom spec</a></h3>

<hr>

<base href="https://rust-lang.zulipchat.com">

<head><link href="https://zulip-archive.rust-lang.org/style.css" rel="stylesheet"></head>

<a name="204323251"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/182449-t-compiler/help/topic/Replacing%20stdlib%20for%20a%20builtin%20triple%20with%20a%20custom%20spec/near/204323251" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jake Goulding <a href="https://zulip-archive.rust-lang.org/stream/182449-t-compiler/help/topic/Replacing.20stdlib.20for.20a.20builtin.20triple.20with.20a.20custom.20spec.html#204323251">(Jul 18 2020 at 23:55)</a>:</h4>
<p>I'm trying to cross-compile to aarch64-apple-darwin in one step (instead of my <a href="https://github.com/shepmaster/rust/blob/silicon/silicon/README.md">current two-step process</a>). I've taught bootstrap how to better handle target JSON files, and the cross-compiled <code>rustc</code> runs on the target. However, when I try to compile with it, I get mismatched crate versions:</p>
<div class="codehilite"><pre><span></span><code>error[E0461]: couldn&#39;t find crate `std` with expected target triple aarch64-apple-darwin
  |
  = note: the following crate versions were found:
          crate `std`, target triple aarch64-apple-darwin-1752181066458373883: /Users/shep/crossed-one/usr/local/lib/rustlib/aarch64-apple-darwin/lib/libstd-11e5fe59d2e3c43b.rlib
          crate `std`, target triple aarch64-apple-darwin-1752181066458373883: /Users/shep/crossed-one/usr/local/lib/rustlib/aarch64-apple-darwin/lib/libstd-11e5fe59d2e3c43b.dylib
</code></pre></div>


<p>I (loosely) know that JSON targets have a hash appended to them to <em>cause</em> this specific failure, as you usually don't want them to overlap. Is there a way I can make them overlap?</p>



<a name="204381505"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/182449-t-compiler/help/topic/Replacing%20stdlib%20for%20a%20builtin%20triple%20with%20a%20custom%20spec/near/204381505" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> eddyb <a href="https://zulip-archive.rust-lang.org/stream/182449-t-compiler/help/topic/Replacing.20stdlib.20for.20a.20builtin.20triple.20with.20a.20custom.20spec.html#204381505">(Jul 20 2020 at 02:33)</a>:</h4>
<p>oh that's funny, I didn't even notice the hashes the first time</p>



<a name="204381548"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/182449-t-compiler/help/topic/Replacing%20stdlib%20for%20a%20builtin%20triple%20with%20a%20custom%20spec/near/204381548" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> eddyb <a href="https://zulip-archive.rust-lang.org/stream/182449-t-compiler/help/topic/Replacing.20stdlib.20for.20a.20builtin.20triple.20with.20a.20custom.20spec.html#204381548">(Jul 20 2020 at 02:34)</a>:</h4>
<p>presumably this is the thing we resolved elsewhere</p>



<hr><p>Last updated: Apr 12 2022 at 20:01 UTC</p>
</html>