<html>
<head><meta charset="utf-8"><title>rustc compilation failures · t-compiler/help · Zulip Chat Archive</title></head>
<h2>Stream: <a href="https://zulip-archive.rust-lang.org/stream/182449-t-compiler/help/index.html">t-compiler/help</a></h2>
<h3>Topic: <a href="https://zulip-archive.rust-lang.org/stream/182449-t-compiler/help/topic/rustc.20compilation.20failures.html">rustc compilation failures</a></h3>

<hr>

<base href="https://rust-lang.zulipchat.com">

<head><link href="https://zulip-archive.rust-lang.org/style.css" rel="stylesheet"></head>

<a name="169107947"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/182449-t-compiler/help/topic/rustc%20compilation%20failures/near/169107947" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> davidtwco <a href="https://zulip-archive.rust-lang.org/stream/182449-t-compiler/help/topic/rustc.20compilation.20failures.html#169107947">(Jun 27 2019 at 06:38)</a>:</h4>
<p>For the past few days, I've been unable to compile rustc on my machine, I'm not sure what's changed, I've tried nuking the <code>build</code> directory:</p>
<div class="codehilite"><pre><span></span>Building stage1 compiler artifacts (x86_64-unknown-linux-gnu -&gt; x86_64-unknown-linux-gnu)
   Compiling rustc-main v0.0.0 (/home/david/projects/rust/rust1/src/rustc)
error: linking with `cc` failed: exit code: 1
  |
  = note: &quot;cc&quot; &quot;-Wl,--as-needed&quot; &quot;-Wl,-z,noexecstack&quot; &quot;-m64&quot; &quot;-L&quot; &quot;/home/david/projects/rust/rust1/build/x86_64-unknown-linux-gnu/stage1/lib/rustlib/x86_64-unknown-linux-gnu/lib&quot; &quot;/home/david/projects/rust/rust1/build/x86_64-unknown-linux-gnu/stage1-rustc/x86_64-unknown-linux-gnu/debug/deps/rustc_binary-deb9300b83568394.1263nq3e2ud1o1r4.rcgu.o&quot; &quot;/home/david/projects/rust/rust1/build/x86_64-unknown-linux-gnu/stage1-rustc/x86_64-unknown-linux-gnu/debug/deps/rustc_binary-deb9300b83568394.19epgmon2rkq5dqz.rcgu.o&quot; &quot;/home/david/projects/rust/rust1/build/x86_64-unknown-linux-gnu/stage1-rustc/x86_64-unknown-linux-gnu/debug/deps/rustc_binary-deb9300b83568394.2ndja17l3eh4xefg.rcgu.o&quot; &quot;/home/david/projects/rust/rust1/build/x86_64-unknown-linux-gnu/stage1-rustc/x86_64-unknown-linux-gnu/debug/deps/rustc_binary-deb9300b83568394.3mhtk9zwdn16kyhb.rcgu.o&quot; &quot;/home/david/projects/rust/rust1/build/x86_64-unknown-linux-gnu/stage1-rustc/x86_64-unknown-linux-gnu/debug/deps/rustc_binary-deb9300b83568394.maphhcx0e6y3w5p.rcgu.o&quot; &quot;-o&quot; &quot;/home/david/projects/rust/rust1/build/x86_64-unknown-linux-gnu/stage1-rustc/x86_64-unknown-linux-gnu/debug/deps/rustc_binary-deb9300b83568394&quot; &quot;-Wl,--gc-sections&quot; &quot;-pie&quot; &quot;-Wl,-zrelro&quot; &quot;-Wl,-znow&quot; &quot;-nodefaultlibs&quot; &quot;-L&quot; &quot;/home/david/projects/rust/rust1/build/x86_64-unknown-linux-gnu/stage1-rustc/x86_64-unknown-linux-gnu/debug/deps&quot; &quot;-L&quot; &quot;/home/david/projects/rust/rust1/build/x86_64-unknown-linux-gnu/stage1-rustc/debug/deps&quot; &quot;-L&quot; &quot;/home/david/projects/rust/rust1/build/x86_64-unknown-linux-gnu/stage1-rustc/x86_64-unknown-linux-gnu/debug/build/backtrace-sys-46f80450446ade43/out&quot; &quot;-L&quot; &quot;/home/david/projects/rust/rust1/build/x86_64-unknown-linux-gnu/stage1-rustc/x86_64-unknown-linux-gnu/debug/build/miniz-sys-fc84a27db85004a9/out&quot; &quot;-L&quot; &quot;/home/david/projects/rust/rust1/build/x86_64-unknown-linux-gnu/stage1/lib/rustlib/x86_64-unknown-linux-gnu/lib&quot; &quot;-L&quot; &quot;/home/david/projects/rust/rust1/build/x86_64-unknown-linux-gnu/stage1-rustc/x86_64-unknown-linux-gnu/debug/deps&quot; &quot;-lrustc_driver-92cabad887175fbd&quot; &quot;-L&quot; &quot;/home/david/projects/rust/rust1/build/x86_64-unknown-linux-gnu/stage1-rustc/x86_64-unknown-linux-gnu/debug/deps&quot; &quot;-lrustc_interface-3c9591280d71773e&quot; &quot;-L&quot; &quot;/home/david/projects/rust/rust1/build/x86_64-unknown-linux-gnu/stage1-rustc/x86_64-unknown-linux-gnu/debug/deps&quot; &quot;-lrustc_lint-d1cbfcd28f4f6c9d&quot; &quot;-L&quot; &quot;/home/david/projects/rust/rust1/build/x86_64-unknown-linux-gnu/stage1-rustc/x86_64-unknown-linux-gnu/debug/deps&quot; &quot;-lrustc_traits-a9264844143f03bd&quot; &quot;-L&quot; &quot;/home/david/projects/rust/rust1/build/x86_64-unknown-linux-gnu/stage1-rustc/x86_64-unknown-linux-gnu/debug/deps&quot; &quot;-lrustc_resolve-ee4dad60d33d7e77&quot; &quot;-L&quot; &quot;/home/david/projects/rust/rust1/build/x86_64-unknown-linux-gnu/stage1-rustc/x86_64-unknown-linux-gnu/debug/deps&quot; &quot;-lrustc_privacy-7a9a512f6d9e17e0&quot; &quot;-L&quot; &quot;/home/david/projects/rust/rust1/build/x86_64-unknown-linux-gnu/stage1-rustc/x86_64-unknown-linux-gnu/debug/deps&quot; &quot;-lrustc_typeck-4ae08802f739b808&quot; &quot;-L&quot; &quot;/home/david/projects/rust/rust1/build/x86_64-unknown-linux-gnu/stage1-rustc/x86_64-unknown-linux-gnu/debug/deps&quot; &quot;-lrustc_plugin-b664993e67340a59&quot; &quot;-L&quot; &quot;/home/david/projects/rust/rust1/build/x86_64-unknown-linux-gnu/stage1-rustc/x86_64-unknown-linux-gnu/debug/deps&quot; &quot;-lrustc_passes-d140753043f9a139&quot; &quot;-L&quot; &quot;/home/david/projects/rust/rust1/build/x86_64-unknown-linux-gnu/stage1-rustc/x86_64-unknown-linux-gnu/debug/deps&quot; &quot;-lrustc_codegen_ssa-2cb9746fb91012d9&quot; &quot;-L&quot; &quot;/home/david/projects/rust/rust1/build/x86_64-unknown-linux-gnu/stage1-rustc/x86_64-unknown-linux-gnu/debug/deps&quot; &quot;-lrustc_incremental-0bd0ecbb930f21a4&quot; &quot;-L&quot; &quot;/home/david/projects/rust/rust1/build/x86_64-unknown-linux-gnu/stage1-rustc/x86_64-unknown-linux-gnu/debug/deps&quot; &quot;-lrustc_borrowck-37a983988ab4e91d&quot; &quot;-L&quot; &quot;/home/david/projects/rust/rust1/build/x86_64-unknown-linux-gnu/stage1-rustc/x86_64-unknown-linux-gnu/debug/deps&quot; &quot;-lrustc_mir-c1cb373a64019785&quot; &quot;-L&quot; &quot;/home/david/projects/rust/rust1/build/x86_64-unknown-linux-gnu/stage1-rustc/x86_64-unknown-linux-gnu/debug/deps&quot; &quot;-lrustc_allocator-4a61643d292e53f0&quot; &quot;-L&quot; &quot;/home/david/projects/rust/rust1/build/x86_64-unknown-linux-gnu/stage1-rustc/x86_64-unknown-linux-gnu/debug/deps&quot; &quot;-lrustc_save_analysis-c57ab05bfa68ef11&quot; &quot;-L&quot; &quot;/home/david/projects/rust/rust1/build/x86_64-unknown-linux-gnu/stage1-rustc/x86_64-unknown-linux-gnu/debug/deps&quot; &quot;-lrustc_codegen_utils-9eccc25163658977&quot; &quot;-L&quot; &quot;/home/david/projects/rust/rust1/build/x86_64-unknown-linux-gnu/stage1-rustc/x86_64-unknown-linux-gnu/debug/deps&quot; &quot;-lrustc_metadata-61e29cfa6d6b2c9f&quot; &quot;-L&quot; &quot;/home/david/projects/rust/rust1/build/x86_64-unknown-linux-gnu/stage1-rustc/x86_64-unknown-linux-gnu/debug/deps&quot; &quot;-lsyntax_ext-5d0b711f7456c69a&quot; &quot;-L&quot; &quot;/home/david/projects/rust/rust1/build/x86_64-unknown-linux-gnu/stage1-rustc/x86_64-unknown-linux-gnu/debug/deps&quot; &quot;-lrustc-5b6ecf8f92ed30b8&quot; &quot;-L&quot; &quot;/home/david/projects/rust/rust1/build/x86_64-unknown-linux-gnu/stage1-rustc/x86_64-unknown-linux-gnu/debug/deps&quot; &quot;-lfmt_macros-26c8e1b9ecf78390&quot; &quot;-L&quot; &quot;/home/david/projects/rust/rust1/build/x86_64-unknown-linux-gnu/stage1-rustc/x86_64-unknown-linux-gnu/debug/deps&quot; &quot;-lrustc_fs_util-611bea1453abbdd9&quot; &quot;-L&quot; &quot;/home/david/projects/rust/rust1/build/x86_64-unknown-linux-gnu/stage1/lib/rustlib/x86_64-unknown-linux-gnu/lib&quot; &quot;-ltest-8a6e21431435ffde&quot; &quot;-L&quot; &quot;/home/david/projects/rust/rust1/build/x86_64-unknown-linux-gnu/stage1/lib/rustlib/x86_64-unknown-linux-gnu/lib&quot; &quot;-lterm-ff0b7549deba8821&quot; &quot;-L&quot; &quot;/home/david/projects/rust/rust1/build/x86_64-unknown-linux-gnu/stage1-rustc/x86_64-unknown-linux-gnu/debug/deps&quot; &quot;-lsyntax-34892d50bc6c0e8d&quot; &quot;-L&quot; &quot;/home/david/projects/rust/rust1/build/x86_64-unknown-linux-gnu/stage1-rustc/x86_64-unknown-linux-gnu/debug/deps&quot; &quot;-lrustc_target-ce4c6a8ab44f6289&quot; &quot;-L&quot; &quot;/home/david/projects/rust/rust1/build/x86_64-unknown-linux-gnu/stage1-rustc/x86_64-unknown-linux-gnu/debug/deps&quot; &quot;-lrustc_errors-662d68a5c84e576b&quot; &quot;-L&quot; &quot;/home/david/projects/rust/rust1/build/x86_64-unknown-linux-gnu/stage1-rustc/x86_64-unknown-linux-gnu/debug/deps&quot; &quot;-lsyntax_pos-146b76a9e314a43a&quot; &quot;-L&quot; &quot;/home/david/projects/rust/rust1/build/x86_64-unknown-linux-gnu/stage1-rustc/x86_64-unknown-linux-gnu/debug/deps&quot; &quot;-larena-c73c72e167db49ac&quot; &quot;-L&quot; &quot;/home/david/projects/rust/rust1/build/x86_64-unknown-linux-gnu/stage1-rustc/x86_64-unknown-linux-gnu/debug/deps&quot; &quot;-lrustc_data_structures-0b793d5bdefb4eea&quot; &quot;-L&quot; &quot;/home/david/projects/rust/rust1/build/x86_64-unknown-linux-gnu/stage1-rustc/x86_64-unknown-linux-gnu/debug/deps&quot; &quot;-lgraphviz-267b75f50964da8e&quot; &quot;-L&quot; &quot;/home/david/projects/rust/rust1/build/x86_64-unknown-linux-gnu/stage1-rustc/x86_64-unknown-linux-gnu/debug/deps&quot; &quot;-lrustc_cratesio_shim-cc7572e7a76e61f0&quot; &quot;-L&quot; &quot;/home/david/projects/rust/rust1/build/x86_64-unknown-linux-gnu/stage1-rustc/x86_64-unknown-linux-gnu/debug/deps&quot; &quot;-lserialize-905317db2d4405be&quot; &quot;-Wl,--start-group&quot; &quot;-L&quot; &quot;/home/david/projects/rust/rust1/build/x86_64-unknown-linux-gnu/stage1/lib/rustlib/x86_64-unknown-linux-gnu/lib&quot; &quot;-lstd-a52529454bb7e403&quot; &quot;-Wl,--end-group&quot; &quot;-Wl,-Bstatic&quot; &quot;/home/david/projects/rust/rust1/build/x86_64-unknown-linux-gnu/stage1/lib/rustlib/x86_64-unknown-linux-gnu/lib/libcompiler_builtins-866ebf4f9ba01b1e.rlib&quot; &quot;-Wl,-Bdynamic&quot; &quot;-lutil&quot; &quot;-lutil&quot; &quot;-ldl&quot; &quot;-lrt&quot; &quot;-lpthread&quot; &quot;-lgcc_s&quot; &quot;-lc&quot; &quot;-lm&quot; &quot;-lrt&quot; &quot;-lpthread&quot; &quot;-lutil&quot; &quot;-lutil&quot; &quot;-Wl,-rpath,$ORIGIN/../lib&quot;
  = note: /nix/store/0y7jmqnj48ikjh37n3dl9kqw9hnn68nq-binutils-2.31.1/bin/ld: /home/david/projects/rust/rust1/build/x86_64-unknown-linux-gnu/stage1-rustc/x86_64-unknown-linux-gnu/debug/deps/librustc_codegen_ssa-2cb9746fb91012d9.so: undefined reference to `&lt;I as core::iter::traits::collect::IntoIterator&gt;::into_iter&#39;
          /nix/store/0y7jmqnj48ikjh37n3dl9kqw9hnn68nq-binutils-2.31.1/bin/ld: /home/david/projects/rust/rust1/build/x86_64-unknown-linux-gnu/stage1-rustc/x86_64-unknown-linux-gnu/debug/deps/librustc_codegen_ssa-2cb9746fb91012d9.so: undefined reference to `std::error::Error::type_id&#39;
          /nix/store/0y7jmqnj48ikjh37n3dl9kqw9hnn68nq-binutils-2.31.1/bin/ld: /home/david/projects/rust/rust1/build/x86_64-unknown-linux-gnu/stage1-rustc/x86_64-unknown-linux-gnu/debug/deps/librustc_codegen_ssa-2cb9746fb91012d9.so: undefined reference to `core::iter::range::&lt;impl core::iter::traits::iterator::Iterator for core::ops::range::Range&lt;A&gt;&gt;::next&#39;
collect2: error: ld returned 1 exit status
</pre></div>



<a name="169107962"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/182449-t-compiler/help/topic/rustc%20compilation%20failures/near/169107962" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> davidtwco <a href="https://zulip-archive.rust-lang.org/stream/182449-t-compiler/help/topic/rustc.20compilation.20failures.html#169107962">(Jun 27 2019 at 06:39)</a>:</h4>
<p>Anyone ran into this or know how to get around it?</p>



<a name="169108062"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/182449-t-compiler/help/topic/rustc%20compilation%20failures/near/169108062" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> davidtwco <a href="https://zulip-archive.rust-lang.org/stream/182449-t-compiler/help/topic/rustc.20compilation.20failures.html#169108062">(Jun 27 2019 at 06:41)</a>:</h4>
<p>In fact, this is on my unoptimized directory, so I suspect it's something to do with that.</p>



<a name="169109232"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/182449-t-compiler/help/topic/rustc%20compilation%20failures/near/169109232" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> davidtwco <a href="https://zulip-archive.rust-lang.org/stream/182449-t-compiler/help/topic/rustc.20compilation.20failures.html#169109232">(Jun 27 2019 at 07:06)</a>:</h4>
<p>Can confirm that it was that, switching to my regular <code>config.toml</code> fixed the issue.</p>



<a name="169124658"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/182449-t-compiler/help/topic/rustc%20compilation%20failures/near/169124658" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> simulacrum <a href="https://zulip-archive.rust-lang.org/stream/182449-t-compiler/help/topic/rustc.20compilation.20failures.html#169124658">(Jun 27 2019 at 11:12)</a>:</h4>
<p>Possibly errors in how we handle symbols or something? <span class="user-mention" data-user-id="119009">@eddyb</span> is the most familiar with that code I believe</p>



<a name="169129254"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/182449-t-compiler/help/topic/rustc%20compilation%20failures/near/169129254" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> eddyb <a href="https://zulip-archive.rust-lang.org/stream/182449-t-compiler/help/topic/rustc.20compilation.20failures.html#169129254">(Jun 27 2019 at 12:25)</a>:</h4>
<p>I have no idea, there shouldn't be any change to that, but building unoptimized rustc is generally discouraged just because of how uselessly slow the resulting compiler is :P</p>



<a name="169129310"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/182449-t-compiler/help/topic/rustc%20compilation%20failures/near/169129310" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> eddyb <a href="https://zulip-archive.rust-lang.org/stream/182449-t-compiler/help/topic/rustc.20compilation.20failures.html#169129310">(Jun 27 2019 at 12:26)</a>:</h4>
<p>if it's a dylib-related issue maybe <span class="user-mention" data-user-id="116466">@Zoxc</span> knows</p>



<a name="169131863"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/182449-t-compiler/help/topic/rustc%20compilation%20failures/near/169131863" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> davidtwco <a href="https://zulip-archive.rust-lang.org/stream/182449-t-compiler/help/topic/rustc.20compilation.20failures.html#169131863">(Jun 27 2019 at 12:58)</a>:</h4>
<blockquote>
<p>I have no idea, there shouldn't be any change to that, but building unoptimized rustc is generally discouraged just because of how uselessly slow the resulting compiler is :P</p>
</blockquote>
<p>I build it overnight because I sometimes I find it useful to be able to step through what's happening on master with a debugger.</p>



<a name="169132187"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/182449-t-compiler/help/topic/rustc%20compilation%20failures/near/169132187" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Zoxc <a href="https://zulip-archive.rust-lang.org/stream/182449-t-compiler/help/topic/rustc.20compilation.20failures.html#169132187">(Jun 27 2019 at 13:01)</a>:</h4>
<p>Was it a clean build?</p>



<a name="169133687"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/182449-t-compiler/help/topic/rustc%20compilation%20failures/near/169133687" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> davidtwco <a href="https://zulip-archive.rust-lang.org/stream/182449-t-compiler/help/topic/rustc.20compilation.20failures.html#169133687">(Jun 27 2019 at 13:19)</a>:</h4>
<p>Yeah, I ran clean before it, and tried deleting <code>build</code>.</p>



<a name="169135283"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/182449-t-compiler/help/topic/rustc%20compilation%20failures/near/169135283" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Zoxc <a href="https://zulip-archive.rust-lang.org/stream/182449-t-compiler/help/topic/rustc.20compilation.20failures.html#169135283">(Jun 27 2019 at 13:39)</a>:</h4>
<p>I'm going to try a clean debug build =P</p>



<a name="169135714"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/182449-t-compiler/help/topic/rustc%20compilation%20failures/near/169135714" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> davidtwco <a href="https://zulip-archive.rust-lang.org/stream/182449-t-compiler/help/topic/rustc.20compilation.20failures.html#169135714">(Jun 27 2019 at 13:43)</a>:</h4>
<p>I should have backed up the <code>config.toml</code> it was using.</p>



<a name="169214861"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/182449-t-compiler/help/topic/rustc%20compilation%20failures/near/169214861" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Zoxc <a href="https://zulip-archive.rust-lang.org/stream/182449-t-compiler/help/topic/rustc.20compilation.20failures.html#169214861">(Jun 28 2019 at 10:54)</a>:</h4>
<p>I didn't have any problems building a debug build. (I had parallel-compiler enabled, so it would complete in an hour though)</p>



<hr><p>Last updated: Apr 12 2022 at 20:01 UTC</p>
</html>