<html>
<head><meta charset="utf-8"><title>get `HirId` for `hir::Fn`&#x27;s parameters · t-compiler/help · Zulip Chat Archive</title></head>
<h2>Stream: <a href="https://zulip-archive.rust-lang.org/stream/182449-t-compiler/help/index.html">t-compiler/help</a></h2>
<h3>Topic: <a href="https://zulip-archive.rust-lang.org/stream/182449-t-compiler/help/topic/get.20.60HirId.60.20for.20.60hir.3A.3AFn.60&#x27;s.20parameters.html">get `HirId` for `hir::Fn`&#x27;s parameters</a></h3>

<hr>

<base href="https://rust-lang.zulipchat.com">

<head><link href="https://zulip-archive.rust-lang.org/style.css" rel="stylesheet"></head>

<a name="278098554"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/182449-t-compiler/help/topic/get%20%60HirId%60%20for%20%60hir%3A%3AFn%60%27s%20parameters/near/278098554" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> csicar <a href="https://zulip-archive.rust-lang.org/stream/182449-t-compiler/help/topic/get.20.60HirId.60.20for.20.60hir.3A.3AFn.60&#x27;s.20parameters.html#278098554">(Apr 06 2022 at 23:11)</a>:</h4>
<p>Hi, <br>
so I'm trying to create an supplemental type system for rust, which requires creating a type context. Part of type checking a function requires filling the type context with the function's parameters. When a <code>Path</code> needs to be typed, I could then find the corresponding entry in the type context by the referenced <code>HirId</code>.<br>
Unfortunately, I have not found a way to access the definition sites of a functions parameters from its hir item, which makes it hard to fill the type context. </p>
<p>Tl;dr: <em>Is there a way to get the parameter definition<code>HirId</code>s from an <code>hir::Fn</code> Item?</em></p>



<a name="278099175"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/182449-t-compiler/help/topic/get%20%60HirId%60%20for%20%60hir%3A%3AFn%60%27s%20parameters/near/278099175" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Michael Goulet (compiler-errors) <a href="https://zulip-archive.rust-lang.org/stream/182449-t-compiler/help/topic/get.20.60HirId.60.20for.20.60hir.3A.3AFn.60&#x27;s.20parameters.html#278099175">(Apr 06 2022 at 23:18)</a>:</h4>
<p>So what specifically do you want from the parameter?</p>



<a name="278099196"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/182449-t-compiler/help/topic/get%20%60HirId%60%20for%20%60hir%3A%3AFn%60%27s%20parameters/near/278099196" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Michael Goulet (compiler-errors) <a href="https://zulip-archive.rust-lang.org/stream/182449-t-compiler/help/topic/get.20.60HirId.60.20for.20.60hir.3A.3AFn.60&#x27;s.20parameters.html#278099196">(Apr 06 2022 at 23:18)</a>:</h4>
<p>From a Fn item in hir, you can get the hir::Ty of each of the fn's inputs, which has a HIR id</p>



<a name="278099201"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/182449-t-compiler/help/topic/get%20%60HirId%60%20for%20%60hir%3A%3AFn%60%27s%20parameters/near/278099201" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Michael Goulet (compiler-errors) <a href="https://zulip-archive.rust-lang.org/stream/182449-t-compiler/help/topic/get.20.60HirId.60.20for.20.60hir.3A.3AFn.60&#x27;s.20parameters.html#278099201">(Apr 06 2022 at 23:18)</a>:</h4>
<p>but do you need more information than that?</p>



<a name="278099659"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/182449-t-compiler/help/topic/get%20%60HirId%60%20for%20%60hir%3A%3AFn%60%27s%20parameters/near/278099659" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> csicar <a href="https://zulip-archive.rust-lang.org/stream/182449-t-compiler/help/topic/get.20.60HirId.60.20for.20.60hir.3A.3AFn.60&#x27;s.20parameters.html#278099659">(Apr 06 2022 at 23:24)</a>:</h4>
<p>Thank you for the quick response!  The difference is, that I'm not looking for the type (<code>i32</code>), but rather the parameter variable definition (<code>a</code>)</p>
<p>Here's a short example (reading the comments only makes sense when reading from last to first)</p>
<div class="codehilite" data-code-language="Rust"><pre><span></span><code><span class="w">     </span><span class="c1">//|- ------ how do I get the HirId of `a`?</span>
<span class="k">fn</span> <span class="nf">foo</span><span class="p">(</span><span class="n">a</span>: <span class="kt">i32</span><span class="p">)</span><span class="w"> </span>-&gt; <span class="kt">i32</span> <span class="p">{</span><span class="w"></span>
<span class="w"> </span><span class="c1">//       ^^ but the hir::ty `i32` has a different hir_id (e.g. `HirId { owner: DefId(0:7 ~ rust_out[9149]::foo), local_id: 7 `)</span>
<span class="w">      </span><span class="n">a</span><span class="w"></span>
<span class="w"> </span><span class="c1">//   ^ once `a` is Resolved, its Res will refer to some hir_id (e.g. `HirId { owner: DefId(0:7 ~ rust_out[9149]::foo), local_id: 2 }`)</span>
<span class="p">}</span><span class="w"></span>
</code></pre></div>



<a name="278101861"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/182449-t-compiler/help/topic/get%20%60HirId%60%20for%20%60hir%3A%3AFn%60%27s%20parameters/near/278101861" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Michael Goulet (compiler-errors) <a href="https://zulip-archive.rust-lang.org/stream/182449-t-compiler/help/topic/get.20.60HirId.60.20for.20.60hir.3A.3AFn.60&#x27;s.20parameters.html#278101861">(Apr 06 2022 at 23:53)</a>:</h4>
<p>Ah, you can get the parameter from the body of the fn: <a href="https://doc.rust-lang.org/stable/nightly-rustc/rustc_middle/hir/map/struct.Map.html#method.body">https://doc.rust-lang.org/stable/nightly-rustc/rustc_middle/hir/map/struct.Map.html#method.body</a></p>



<a name="278101928"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/182449-t-compiler/help/topic/get%20%60HirId%60%20for%20%60hir%3A%3AFn%60%27s%20parameters/near/278101928" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Michael Goulet (compiler-errors) <a href="https://zulip-archive.rust-lang.org/stream/182449-t-compiler/help/topic/get.20.60HirId.60.20for.20.60hir.3A.3AFn.60&#x27;s.20parameters.html#278101928">(Apr 06 2022 at 23:54)</a>:</h4>
<p>You can get the BodyId from the hir::itemKind::Fn</p>



<a name="278102456"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/182449-t-compiler/help/topic/get%20%60HirId%60%20for%20%60hir%3A%3AFn%60%27s%20parameters/near/278102456" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> csicar <a href="https://zulip-archive.rust-lang.org/stream/182449-t-compiler/help/topic/get.20.60HirId.60.20for.20.60hir.3A.3AFn.60&#x27;s.20parameters.html#278102456">(Apr 07 2022 at 00:00)</a>:</h4>
<p>ooooh, well that makes sense. Thank you so much!</p>



<a name="278103320"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/182449-t-compiler/help/topic/get%20%60HirId%60%20for%20%60hir%3A%3AFn%60%27s%20parameters/near/278103320" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> csicar <a href="https://zulip-archive.rust-lang.org/stream/182449-t-compiler/help/topic/get.20.60HirId.60.20for.20.60hir.3A.3AFn.60&#x27;s.20parameters.html#278103320">(Apr 07 2022 at 00:13)</a>:</h4>
<p>In case somebody else will need this: To get the <code>a</code> in the example above do this:</p>
<div class="codehilite" data-code-language="Rust"><pre><span></span><code><span class="k">match</span><span class="w"> </span><span class="n">hir_item</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">        </span><span class="n">hir</span>::<span class="n">Item</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">            </span><span class="n">kind</span>: <span class="nc">hir</span>::<span class="n">ItemKind</span>::<span class="nb">Fn</span><span class="p">(</span><span class="w"> </span><span class="n">hir</span>::<span class="n">FnSig</span><span class="w"> </span><span class="p">{</span><span class="w">   </span><span class="o">..</span><span class="w">   </span><span class="p">},</span><span class="w">    </span><span class="n">_</span><span class="p">,</span><span class="w">   </span><span class="n">body_id</span><span class="w"> </span><span class="p">),</span><span class="w"></span>
<span class="w">            </span><span class="o">..</span><span class="w"></span>
<span class="w">        </span><span class="p">}</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">             </span><span class="kd">let</span><span class="w"> </span><span class="n">body</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">tcx</span><span class="p">.</span><span class="n">hir</span><span class="p">().</span><span class="n">body</span><span class="p">(</span><span class="n">body_id</span><span class="p">.</span><span class="n">clone</span><span class="p">());</span><span class="w"></span>
<span class="w">             </span><span class="n">body</span><span class="p">.</span><span class="n">params</span><span class="p">[</span><span class="mi">0</span><span class="p">].</span><span class="n">hir_id</span><span class="w"> </span><span class="c1">// == HirId { owner: DefId(0:7 ~ rust_out[9149]::foo), local_id: 1 }</span>
<span class="w">            </span><span class="n">body</span><span class="p">.</span><span class="n">params</span><span class="p">[</span><span class="mi">0</span><span class="p">].</span><span class="n">pat</span><span class="p">.</span><span class="n">hir_id</span><span class="w"> </span><span class="c1">// == HirId { owner: DefId(0:7 ~ rust_out[9149]::foo), local_id: 2 }</span>
<span class="w">       </span><span class="p">}</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>
</code></pre></div>



<hr><p>Last updated: Apr 12 2022 at 20:01 UTC</p>
</html>