<html>
<head><meta charset="utf-8"><title>Getting the Span of a function&#x27;s args · t-compiler/help · Zulip Chat Archive</title></head>
<h2>Stream: <a href="https://zulip-archive.rust-lang.org/stream/182449-t-compiler/help/index.html">t-compiler/help</a></h2>
<h3>Topic: <a href="https://zulip-archive.rust-lang.org/stream/182449-t-compiler/help/topic/Getting.20the.20Span.20of.20a.20function&#x27;s.20args.html">Getting the Span of a function&#x27;s args</a></h3>

<hr>

<base href="https://rust-lang.zulipchat.com">

<head><link href="https://zulip-archive.rust-lang.org/style.css" rel="stylesheet"></head>

<a name="269185638"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/182449-t-compiler/help/topic/Getting%20the%20Span%20of%20a%20function%27s%20args/near/269185638" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jack Huey <a href="https://zulip-archive.rust-lang.org/stream/182449-t-compiler/help/topic/Getting.20the.20Span.20of.20a.20function&#x27;s.20args.html#269185638">(Jan 24 2022 at 23:05)</a>:</h4>
<p>Okay, so if I have a Span of <code>foo(bar)</code>, what's the best way to get the Span <code>bar</code>? Or, if it's <code>foo()</code>, to get the empty span within the function call</p>



<a name="269185981"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/182449-t-compiler/help/topic/Getting%20the%20Span%20of%20a%20function%27s%20args/near/269185981" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> bjorn3 <a href="https://zulip-archive.rust-lang.org/stream/182449-t-compiler/help/topic/Getting.20the.20Span.20of.20a.20function&#x27;s.20args.html#269185981">(Jan 24 2022 at 23:09)</a>:</h4>
<p>Is this at AST, HIR or MIR level?</p>



<a name="269186530"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/182449-t-compiler/help/topic/Getting%20the%20Span%20of%20a%20function%27s%20args/near/269186530" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jack Huey <a href="https://zulip-archive.rust-lang.org/stream/182449-t-compiler/help/topic/Getting.20the.20Span.20of.20a.20function&#x27;s.20args.html#269186530">(Jan 24 2022 at 23:15)</a>:</h4>
<p>uh, during typechecking</p>



<a name="269192776"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/182449-t-compiler/help/topic/Getting%20the%20Span%20of%20a%20function%27s%20args/near/269192776" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Aaron Hill <a href="https://zulip-archive.rust-lang.org/stream/182449-t-compiler/help/topic/Getting.20the.20Span.20of.20a.20function&#x27;s.20args.html#269192776">(Jan 25 2022 at 00:33)</a>:</h4>
<p>In general, you should avoid manipulating a Span in-place, except in diagnostic code</p>



<a name="269192891"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/182449-t-compiler/help/topic/Getting%20the%20Span%20of%20a%20function%27s%20args/near/269192891" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Aaron Hill <a href="https://zulip-archive.rust-lang.org/stream/182449-t-compiler/help/topic/Getting.20the.20Span.20of.20a.20function&#x27;s.20args.html#269192891">(Jan 25 2022 at 00:34)</a>:</h4>
<p>When we glue together multiple spans (e.g. the span of <code>foo</code> and the span of <code>(bar)</code>), we may frequently lose information, since different parts may come from different files from different macro expansions</p>



<a name="269192901"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/182449-t-compiler/help/topic/Getting%20the%20Span%20of%20a%20function%27s%20args/near/269192901" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Aaron Hill <a href="https://zulip-archive.rust-lang.org/stream/182449-t-compiler/help/topic/Getting.20the.20Span.20of.20a.20function&#x27;s.20args.html#269192901">(Jan 25 2022 at 00:34)</a>:</h4>
<p>The best way to get that span would be to go through the HIR</p>



<a name="269193057"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/182449-t-compiler/help/topic/Getting%20the%20Span%20of%20a%20function%27s%20args/near/269193057" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Aaron Hill <a href="https://zulip-archive.rust-lang.org/stream/182449-t-compiler/help/topic/Getting.20the.20Span.20of.20a.20function&#x27;s.20args.html#269193057">(Jan 25 2022 at 00:36)</a>:</h4>
<p>You could get the spans of the <code>Expr</code> arguments in <code>hir::ExprKind::MethodCall</code>: <a href="https://doc.rust-lang.org/nightly/nightly-rustc/rustc_hir/hir/enum.ExprKind.html#variant.MethodCall">https://doc.rust-lang.org/nightly/nightly-rustc/rustc_hir/hir/enum.ExprKind.html#variant.MethodCall</a></p>



<a name="269193063"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/182449-t-compiler/help/topic/Getting%20the%20Span%20of%20a%20function%27s%20args/near/269193063" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Aaron Hill <a href="https://zulip-archive.rust-lang.org/stream/182449-t-compiler/help/topic/Getting.20the.20Span.20of.20a.20function&#x27;s.20args.html#269193063">(Jan 25 2022 at 00:36)</a>:</h4>
<p>and join them together</p>



<a name="269193707"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/182449-t-compiler/help/topic/Getting%20the%20Span%20of%20a%20function%27s%20args/near/269193707" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jack Huey <a href="https://zulip-archive.rust-lang.org/stream/182449-t-compiler/help/topic/Getting.20the.20Span.20of.20a.20function&#x27;s.20args.html#269193707">(Jan 25 2022 at 00:46)</a>:</h4>
<p>So, I most specifically want the Span of the <em>start</em> of the function arguments. So I have a place to suggest for missing arguments.</p>



<a name="269193814"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/182449-t-compiler/help/topic/Getting%20the%20Span%20of%20a%20function%27s%20args/near/269193814" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jack Huey <a href="https://zulip-archive.rust-lang.org/stream/182449-t-compiler/help/topic/Getting.20the.20Span.20of.20a.20function&#x27;s.20args.html#269193814">(Jan 25 2022 at 00:48)</a>:</h4>
<p>(This is diagnostic code)</p>



<a name="269202255"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/182449-t-compiler/help/topic/Getting%20the%20Span%20of%20a%20function%27s%20args/near/269202255" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Aaron Hill <a href="https://zulip-archive.rust-lang.org/stream/182449-t-compiler/help/topic/Getting.20the.20Span.20of.20a.20function&#x27;s.20args.html#269202255">(Jan 25 2022 at 02:45)</a>:</h4>
<p>Do you the method name, or just the opening paren?</p>



<a name="269205201"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/182449-t-compiler/help/topic/Getting%20the%20Span%20of%20a%20function%27s%20args/near/269205201" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jack Huey <a href="https://zulip-archive.rust-lang.org/stream/182449-t-compiler/help/topic/Getting.20the.20Span.20of.20a.20function&#x27;s.20args.html#269205201">(Jan 25 2022 at 03:29)</a>:</h4>
<p>Well, I <em>wanted</em> the opening paren</p>



<a name="269205241"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/182449-t-compiler/help/topic/Getting%20the%20Span%20of%20a%20function%27s%20args/near/269205241" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jack Huey <a href="https://zulip-archive.rust-lang.org/stream/182449-t-compiler/help/topic/Getting.20the.20Span.20of.20a.20function&#x27;s.20args.html#269205241">(Jan 25 2022 at 03:29)</a>:</h4>
<p>But I guess <span class="user-mention" data-user-id="119031">@Esteban Küber</span> pointed out that we can't point at the space between an empty method call, instead it would point to the second paren, which isn't great</p>



<a name="269328420"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/182449-t-compiler/help/topic/Getting%20the%20Span%20of%20a%20function%27s%20args/near/269328420" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Esteban Küber <a href="https://zulip-archive.rust-lang.org/stream/182449-t-compiler/help/topic/Getting.20the.20Span.20of.20a.20function&#x27;s.20args.html#269328420">(Jan 25 2022 at 21:36)</a>:</h4>
<p>We can still add a span pointing at it, it will just increase the ast size in mem</p>



<a name="269328445"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/182449-t-compiler/help/topic/Getting%20the%20Span%20of%20a%20function%27s%20args/near/269328445" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Esteban Küber <a href="https://zulip-archive.rust-lang.org/stream/182449-t-compiler/help/topic/Getting.20the.20Span.20of.20a.20function&#x27;s.20args.html#269328445">(Jan 25 2022 at 21:36)</a>:</h4>
<p>But there's précédent for diagnostic only spans</p>



<hr><p>Last updated: Apr 12 2022 at 20:01 UTC</p>
</html>