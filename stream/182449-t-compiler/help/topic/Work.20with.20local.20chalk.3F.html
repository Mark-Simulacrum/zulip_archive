<html>
<head><meta charset="utf-8"><title>Work with local chalk? · t-compiler/help · Zulip Chat Archive</title></head>
<h2>Stream: <a href="https://zulip-archive.rust-lang.org/stream/182449-t-compiler/help/index.html">t-compiler/help</a></h2>
<h3>Topic: <a href="https://zulip-archive.rust-lang.org/stream/182449-t-compiler/help/topic/Work.20with.20local.20chalk.3F.html">Work with local chalk?</a></h3>

<hr>

<base href="https://rust-lang.zulipchat.com">

<head><link href="https://zulip-archive.rust-lang.org/style.css" rel="stylesheet"></head>

<a name="261042224"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/182449-t-compiler/help/topic/Work%20with%20local%20chalk%3F/near/261042224" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pierwill <a href="https://zulip-archive.rust-lang.org/stream/182449-t-compiler/help/topic/Work.20with.20local.20chalk.3F.html#261042224">(Nov 10 2021 at 19:31)</a>:</h4>
<p>I'm working on a large change to rustc. It's affecting chalk now. Is there a way I can hook up a local copy with my edits of chalk to my rust build? I tried using a local path in  specific crates' Config.toml, but that wasn't enough to get things work IIRC..</p>



<a name="261043507"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/182449-t-compiler/help/topic/Work%20with%20local%20chalk%3F/near/261043507" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> bjorn3 <a href="https://zulip-archive.rust-lang.org/stream/182449-t-compiler/help/topic/Work.20with.20local.20chalk.3F.html#261043507">(Nov 10 2021 at 19:41)</a>:</h4>
<p>You can use the <code>[patch.crates-io]</code> section in the root <code>Cargo.toml</code>.</p>



<a name="261043549"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/182449-t-compiler/help/topic/Work%20with%20local%20chalk%3F/near/261043549" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pierwill <a href="https://zulip-archive.rust-lang.org/stream/182449-t-compiler/help/topic/Work.20with.20local.20chalk.3F.html#261043549">(Nov 10 2021 at 19:42)</a>:</h4>
<p>Ah great! Will try that</p>



<a name="261043603"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/182449-t-compiler/help/topic/Work%20with%20local%20chalk%3F/near/261043603" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> bjorn3 <a href="https://zulip-archive.rust-lang.org/stream/182449-t-compiler/help/topic/Work.20with.20local.20chalk.3F.html#261043603">(Nov 10 2021 at 19:42)</a>:</h4>
<p>See <a href="https://doc.rust-lang.org/cargo/reference/overriding-dependencies.html#the-patch-section">https://doc.rust-lang.org/cargo/reference/overriding-dependencies.html#the-patch-section</a> for the docs if you need it.</p>



<a name="261044663"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/182449-t-compiler/help/topic/Work%20with%20local%20chalk%3F/near/261044663" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pierwill <a href="https://zulip-archive.rust-lang.org/stream/182449-t-compiler/help/topic/Work.20with.20local.20chalk.3F.html#261044663">(Nov 10 2021 at 19:50)</a>:</h4>
<p>Related: why does rustc use such an old version of chalk?</p>



<a name="261044709"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/182449-t-compiler/help/topic/Work%20with%20local%20chalk%3F/near/261044709" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pierwill <a href="https://zulip-archive.rust-lang.org/stream/182449-t-compiler/help/topic/Work.20with.20local.20chalk.3F.html#261044709">(Nov 10 2021 at 19:50)</a>:</h4>
<p>Would changes to chalk even take affect before an upgrade?</p>



<a name="261045850"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/182449-t-compiler/help/topic/Work%20with%20local%20chalk%3F/near/261045850" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pierwill <a href="https://zulip-archive.rust-lang.org/stream/182449-t-compiler/help/topic/Work.20with.20local.20chalk.3F.html#261045850">(Nov 10 2021 at 19:58)</a>:</h4>
<p>I'm getting </p>
<div class="codehilite"><pre><span></span><code>warning: Patch `chalk-ir v0.74.0-dev.0 (/Users/user/repos/chalk/chalk-ir)` was not used in the crate graph.
Check that the patched package version and available features are compatible
with the dependency requirements. If the patch has a different version from
what is locked in the Cargo.lock file, run `cargo update` to use the new
version. This may also occur with an optional dependency that is not enabled.
</code></pre></div>
<p><code>cargo update</code> gives the same error. Should I have version 0.55.0 checkout out, then add my patch to that? <span aria-label="thinking" class="emoji emoji-1f914" role="img" title="thinking">:thinking:</span></p>



<a name="261045974"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/182449-t-compiler/help/topic/Work%20with%20local%20chalk%3F/near/261045974" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> lqd <a href="https://zulip-archive.rust-lang.org/stream/182449-t-compiler/help/topic/Work.20with.20local.20chalk.3F.html#261045974">(Nov 10 2021 at 19:59)</a>:</h4>
<p>I think so</p>



<a name="261046009"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/182449-t-compiler/help/topic/Work%20with%20local%20chalk%3F/near/261046009" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> lqd <a href="https://zulip-archive.rust-lang.org/stream/182449-t-compiler/help/topic/Work.20with.20local.20chalk.3F.html#261046009">(Nov 10 2021 at 19:59)</a>:</h4>
<p>IIRC patching it this way requires that your local checkout has the same version</p>



<a name="261046022"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/182449-t-compiler/help/topic/Work%20with%20local%20chalk%3F/near/261046022" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> lqd <a href="https://zulip-archive.rust-lang.org/stream/182449-t-compiler/help/topic/Work.20with.20local.20chalk.3F.html#261046022">(Nov 10 2021 at 19:59)</a>:</h4>
<p>(or a somewhat compatible one, say)</p>



<a name="261046238"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/182449-t-compiler/help/topic/Work%20with%20local%20chalk%3F/near/261046238" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> The 8472 <a href="https://zulip-archive.rust-lang.org/stream/182449-t-compiler/help/topic/Work.20with.20local.20chalk.3F.html#261046238">(Nov 10 2021 at 20:00)</a>:</h4>
<p>those warnings are normal when doing x.py because it builds some components which don't have chalk in their dependency graph.</p>



<a name="261047913"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/182449-t-compiler/help/topic/Work%20with%20local%20chalk%3F/near/261047913" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pierwill <a href="https://zulip-archive.rust-lang.org/stream/182449-t-compiler/help/topic/Work.20with.20local.20chalk.3F.html#261047913">(Nov 10 2021 at 20:12)</a>:</h4>
<p>Checked out v0.55.0 locally, now I'm getting deprecation warnings <span aria-label="laughter tears" class="emoji emoji-1f602" role="img" title="laughter tears">:laughter_tears:</span></p>



<a name="261049612"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/182449-t-compiler/help/topic/Work%20with%20local%20chalk%3F/near/261049612" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pierwill <a href="https://zulip-archive.rust-lang.org/stream/182449-t-compiler/help/topic/Work.20with.20local.20chalk.3F.html#261049612">(Nov 10 2021 at 20:24)</a>:</h4>
<p>Ah. <code>#![allow(warnings)]</code> fixed that.</p>



<a name="261050353"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/182449-t-compiler/help/topic/Work%20with%20local%20chalk%3F/near/261050353" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jack Huey <a href="https://zulip-archive.rust-lang.org/stream/182449-t-compiler/help/topic/Work.20with.20local.20chalk.3F.html#261050353">(Nov 10 2021 at 20:30)</a>:</h4>
<p>When I'm testing a Chalk change, I'll generally just push to a branch and then switch the dependencies to git</p>



<a name="261050400"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/182449-t-compiler/help/topic/Work%20with%20local%20chalk%3F/near/261050400" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jack Huey <a href="https://zulip-archive.rust-lang.org/stream/182449-t-compiler/help/topic/Work.20with.20local.20chalk.3F.html#261050400">(Nov 10 2021 at 20:30)</a>:</h4>
<p>I don't think rustc uses <em>that old</em> of a Chalk version</p>



<a name="261050428"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/182449-t-compiler/help/topic/Work%20with%20local%20chalk%3F/near/261050428" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jack Huey <a href="https://zulip-archive.rust-lang.org/stream/182449-t-compiler/help/topic/Work.20with.20local.20chalk.3F.html#261050428">(Nov 10 2021 at 20:30)</a>:</h4>
<p>but PRs to update are welcome</p>



<a name="261050440"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/182449-t-compiler/help/topic/Work%20with%20local%20chalk%3F/near/261050440" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jack Huey <a href="https://zulip-archive.rust-lang.org/stream/182449-t-compiler/help/topic/Work.20with.20local.20chalk.3F.html#261050440">(Nov 10 2021 at 20:30)</a>:</h4>
<p>just r? me</p>



<a name="261050563"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/182449-t-compiler/help/topic/Work%20with%20local%20chalk%3F/near/261050563" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pierwill <a href="https://zulip-archive.rust-lang.org/stream/182449-t-compiler/help/topic/Work.20with.20local.20chalk.3F.html#261050563">(Nov 10 2021 at 20:31)</a>:</h4>
<p><span class="user-mention silent" data-user-id="232957">Jack Huey</span> <a href="#narrow/stream/182449-t-compiler.2Fhelp/topic/Work.20with.20local.20chalk.3F/near/261050353">said</a>:</p>
<blockquote>
<p>When I'm testing a Chalk change, I'll generally just push to a branch and then switch the dependencies to git</p>
</blockquote>
<p>Are you able to use the current master of chalk with rustc builds?</p>



<a name="261050637"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/182449-t-compiler/help/topic/Work%20with%20local%20chalk%3F/near/261050637" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jack Huey <a href="https://zulip-archive.rust-lang.org/stream/182449-t-compiler/help/topic/Work.20with.20local.20chalk.3F.html#261050637">(Nov 10 2021 at 20:32)</a>:</h4>
<p>I haven't checked anytime recently</p>



<a name="261050700"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/182449-t-compiler/help/topic/Work%20with%20local%20chalk%3F/near/261050700" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jack Huey <a href="https://zulip-archive.rust-lang.org/stream/182449-t-compiler/help/topic/Work.20with.20local.20chalk.3F.html#261050700">(Nov 10 2021 at 20:33)</a>:</h4>
<p>I guess it's 55 vs 74</p>



<a name="261050758"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/182449-t-compiler/help/topic/Work%20with%20local%20chalk%3F/near/261050758" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jack Huey <a href="https://zulip-archive.rust-lang.org/stream/182449-t-compiler/help/topic/Work.20with.20local.20chalk.3F.html#261050758">(Nov 10 2021 at 20:33)</a>:</h4>
<p>Last update was Februrary: <a href="https://github.com/rust-lang/rust/issues/80593">#80593</a></p>



<a name="261051171"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/182449-t-compiler/help/topic/Work%20with%20local%20chalk%3F/near/261051171" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jack Huey <a href="https://zulip-archive.rust-lang.org/stream/182449-t-compiler/help/topic/Work.20with.20local.20chalk.3F.html#261051171">(Nov 10 2021 at 20:37)</a>:</h4>
<p>Looks like the only real changes since then are related to generators</p>



<hr><p>Last updated: Apr 12 2022 at 20:01 UTC</p>
</html>