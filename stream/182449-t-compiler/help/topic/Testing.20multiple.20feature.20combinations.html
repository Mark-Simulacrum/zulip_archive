<html>
<head><meta charset="utf-8"><title>Testing multiple feature combinations · t-compiler/help · Zulip Chat Archive</title></head>
<h2>Stream: <a href="https://zulip-archive.rust-lang.org/stream/182449-t-compiler/help/index.html">t-compiler/help</a></h2>
<h3>Topic: <a href="https://zulip-archive.rust-lang.org/stream/182449-t-compiler/help/topic/Testing.20multiple.20feature.20combinations.html">Testing multiple feature combinations</a></h3>

<hr>

<base href="https://rust-lang.zulipchat.com">

<head><link href="https://zulip-archive.rust-lang.org/style.css" rel="stylesheet"></head>

<a name="253652633"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/182449-t-compiler/help/topic/Testing%20multiple%20feature%20combinations/near/253652633" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> eholk <a href="https://zulip-archive.rust-lang.org/stream/182449-t-compiler/help/topic/Testing.20multiple.20feature.20combinations.html#253652633">(Sep 16 2021 at 21:17)</a>:</h4>
<p>Is it possible to write a single test that runs in both the default configuration and with a certain feature enabled?</p>



<a name="253652778"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/182449-t-compiler/help/topic/Testing%20multiple%20feature%20combinations/near/253652778" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> eholk <a href="https://zulip-archive.rust-lang.org/stream/182449-t-compiler/help/topic/Testing.20multiple.20feature.20combinations.html#253652778">(Sep 16 2021 at 21:18)</a>:</h4>
<p>I'm working on a change where I want to make sure that enabling the new feature keeps the same behavior on the existing tests, and then add tests that cover the new desired behavior as well</p>



<a name="253652827"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/182449-t-compiler/help/topic/Testing%20multiple%20feature%20combinations/near/253652827" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> eholk <a href="https://zulip-archive.rust-lang.org/stream/182449-t-compiler/help/topic/Testing.20multiple.20feature.20combinations.html#253652827">(Sep 16 2021 at 21:18)</a>:</h4>
<p>The obvious option is to duplicated all the tests and add <code>#![feature(my_feature)]</code> to the top, but it'd be nice not to have to do this.</p>



<a name="253652940"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/182449-t-compiler/help/topic/Testing%20multiple%20feature%20combinations/near/253652940" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> simulacrum <a href="https://zulip-archive.rust-lang.org/stream/182449-t-compiler/help/topic/Testing.20multiple.20feature.20combinations.html#253652940">(Sep 16 2021 at 21:19)</a>:</h4>
<p>Revisions should do this, I think</p>



<a name="253653014"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/182449-t-compiler/help/topic/Testing%20multiple%20feature%20combinations/near/253653014" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> eholk <a href="https://zulip-archive.rust-lang.org/stream/182449-t-compiler/help/topic/Testing.20multiple.20feature.20combinations.html#253653014">(Sep 16 2021 at 21:20)</a>:</h4>
<p>Ah, cool. Where can I find out more about that?</p>



<a name="253653024"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/182449-t-compiler/help/topic/Testing%20multiple%20feature%20combinations/near/253653024" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> simulacrum <a href="https://zulip-archive.rust-lang.org/stream/182449-t-compiler/help/topic/Testing.20multiple.20feature.20combinations.html#253653024">(Sep 16 2021 at 21:20)</a>:</h4>
<p><a href="https://github.com/rust-lang/rust/blob/master/src/test/ui/meta/revision-ok.rs">https://github.com/rust-lang/rust/blob/master/src/test/ui/meta/revision-ok.rs</a> is an example</p>



<a name="253653036"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/182449-t-compiler/help/topic/Testing%20multiple%20feature%20combinations/near/253653036" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> simulacrum <a href="https://zulip-archive.rust-lang.org/stream/182449-t-compiler/help/topic/Testing.20multiple.20feature.20combinations.html#253653036">(Sep 16 2021 at 21:20)</a>:</h4>
<p>but it's pretty simple</p>



<a name="253653085"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/182449-t-compiler/help/topic/Testing%20multiple%20feature%20combinations/near/253653085" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> The 8472 <a href="https://zulip-archive.rust-lang.org/stream/182449-t-compiler/help/topic/Testing.20multiple.20feature.20combinations.html#253653085">(Sep 16 2021 at 21:20)</a>:</h4>
<p>revision -&gt; pass compile flags -&gt; add <code>--cfg</code></p>



<a name="253653090"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/182449-t-compiler/help/topic/Testing%20multiple%20feature%20combinations/near/253653090" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> simulacrum <a href="https://zulip-archive.rust-lang.org/stream/182449-t-compiler/help/topic/Testing.20multiple.20feature.20combinations.html#253653090">(Sep 16 2021 at 21:20)</a>:</h4>
<p>there's even docs (!) <a href="https://rustc-dev-guide.rust-lang.org/tests/adding.html#revisions">https://rustc-dev-guide.rust-lang.org/tests/adding.html#revisions</a></p>



<a name="253653111"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/182449-t-compiler/help/topic/Testing%20multiple%20feature%20combinations/near/253653111" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> eholk <a href="https://zulip-archive.rust-lang.org/stream/182449-t-compiler/help/topic/Testing.20multiple.20feature.20combinations.html#253653111">(Sep 16 2021 at 21:21)</a>:</h4>
<p>Awesome!</p>



<a name="253653147"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/182449-t-compiler/help/topic/Testing%20multiple%20feature%20combinations/near/253653147" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> eholk <a href="https://zulip-archive.rust-lang.org/stream/182449-t-compiler/help/topic/Testing.20multiple.20feature.20combinations.html#253653147">(Sep 16 2021 at 21:21)</a>:</h4>
<p>So it looks like I can add a <code>cfg_attr</code> or whatever it is to enable the feature for certain revisions. That should work</p>



<a name="253653269"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/182449-t-compiler/help/topic/Testing%20multiple%20feature%20combinations/near/253653269" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> eholk <a href="https://zulip-archive.rust-lang.org/stream/182449-t-compiler/help/topic/Testing.20multiple.20feature.20combinations.html#253653269">(Sep 16 2021 at 21:22)</a>:</h4>
<p>Oh, interesting, the docs say that compile-pass tests aren't supported yet</p>



<a name="253653318"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/182449-t-compiler/help/topic/Testing%20multiple%20feature%20combinations/near/253653318" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> simulacrum <a href="https://zulip-archive.rust-lang.org/stream/182449-t-compiler/help/topic/Testing.20multiple.20feature.20combinations.html#253653318">(Sep 16 2021 at 21:22)</a>:</h4>
<p>I'd... be a little surprised if they aren't</p>



<a name="253653322"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/182449-t-compiler/help/topic/Testing%20multiple%20feature%20combinations/near/253653322" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> simulacrum <a href="https://zulip-archive.rust-lang.org/stream/182449-t-compiler/help/topic/Testing.20multiple.20feature.20combinations.html#253653322">(Sep 16 2021 at 21:22)</a>:</h4>
<p>I'd check</p>



<a name="253653381"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/182449-t-compiler/help/topic/Testing%20multiple%20feature%20combinations/near/253653381" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> eholk <a href="https://zulip-archive.rust-lang.org/stream/182449-t-compiler/help/topic/Testing.20multiple.20feature.20combinations.html#253653381">(Sep 16 2021 at 21:23)</a>:</h4>
<p>I'll try it out. Good chance the docs are just out of date or imprecise</p>



<a name="253653417"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/182449-t-compiler/help/topic/Testing%20multiple%20feature%20combinations/near/253653417" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> simulacrum <a href="https://zulip-archive.rust-lang.org/stream/182449-t-compiler/help/topic/Testing.20multiple.20feature.20combinations.html#253653417">(Sep 16 2021 at 21:23)</a>:</h4>
<p>It's probably not too hard to add if needed anyway :)</p>



<a name="253653520"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/182449-t-compiler/help/topic/Testing%20multiple%20feature%20combinations/near/253653520" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> The 8472 <a href="https://zulip-archive.rust-lang.org/stream/182449-t-compiler/help/topic/Testing.20multiple.20feature.20combinations.html#253653520">(Sep 16 2021 at 21:24)</a>:</h4>
<p>there are run-pass tests with revisions, so it would be odd if compile-pass doesn't work</p>



<a name="253653882"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/182449-t-compiler/help/topic/Testing%20multiple%20feature%20combinations/near/253653882" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> eholk <a href="https://zulip-archive.rust-lang.org/stream/182449-t-compiler/help/topic/Testing.20multiple.20feature.20combinations.html#253653882">(Sep 16 2021 at 21:27)</a>:</h4>
<p>Actually, I guess the wording is actually meant to be non-exhaustive. Oh well, I'll try it out and know for sure.</p>



<a name="253654394"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/182449-t-compiler/help/topic/Testing%20multiple%20feature%20combinations/near/253654394" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> eholk <a href="https://zulip-archive.rust-lang.org/stream/182449-t-compiler/help/topic/Testing.20multiple.20feature.20combinations.html#253654394">(Sep 16 2021 at 21:31)</a>:</h4>
<p>Okay, I did a quick check and revisions seem to work for run-pass at least</p>



<hr><p>Last updated: Apr 12 2022 at 20:01 UTC</p>
</html>