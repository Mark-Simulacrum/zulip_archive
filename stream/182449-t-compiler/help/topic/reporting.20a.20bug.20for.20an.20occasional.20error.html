<html>
<head><meta charset="utf-8"><title>reporting a bug for an occasional error · t-compiler/help · Zulip Chat Archive</title></head>
<h2>Stream: <a href="https://zulip-archive.rust-lang.org/stream/182449-t-compiler/help/index.html">t-compiler/help</a></h2>
<h3>Topic: <a href="https://zulip-archive.rust-lang.org/stream/182449-t-compiler/help/topic/reporting.20a.20bug.20for.20an.20occasional.20error.html">reporting a bug for an occasional error</a></h3>

<hr>

<base href="https://rust-lang.zulipchat.com">

<head><link href="https://zulip-archive.rust-lang.org/style.css" rel="stylesheet"></head>

<a name="268145306"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/182449-t-compiler/help/topic/reporting%20a%20bug%20for%20an%20occasional%20error/near/268145306" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Matthew Graham <a href="https://zulip-archive.rust-lang.org/stream/182449-t-compiler/help/topic/reporting.20a.20bug.20for.20an.20occasional.20error.html#268145306">(Jan 15 2022 at 20:24)</a>:</h4>
<p>Hi, I've started getting occasional rust compiler and linker errors while doing development on this project <a href="https://github.com/mdg/leema">https://github.com/mdg/leema</a><br>
It's happening pretty regularly but I can't find good ways to reproduce beyond make some small change and rerun tests.<br>
Sometimes just rerunning the compiler fixes it on the first or second retry. Usually cargo clean and rebuild fixes so I'm pretty sure that a regular bug report would just get "cannot reproduce".<br>
Is there a good way to report a bug like this or any tips for what to look for in the huge streams of output to maybe point to how to reproduce? Thanks!</p>



<a name="268146496"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/182449-t-compiler/help/topic/reporting%20a%20bug%20for%20an%20occasional%20error/near/268146496" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Matthew Graham <a href="https://zulip-archive.rust-lang.org/stream/182449-t-compiler/help/topic/reporting.20a.20bug.20for.20an.20occasional.20error.html#268146496">(Jan 15 2022 at 20:50)</a>:</h4>
<p>hmm... actually this program has been around for a while. could be that I have some really old libraries that need to be upgraded. I'll try that first.</p>



<a name="268146636"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/182449-t-compiler/help/topic/reporting%20a%20bug%20for%20an%20occasional%20error/near/268146636" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Aaron Hill <a href="https://zulip-archive.rust-lang.org/stream/182449-t-compiler/help/topic/reporting.20a.20bug.20for.20an.20occasional.20error.html#268146636">(Jan 15 2022 at 20:54)</a>:</h4>
<p>Can you post the error message you're getting?</p>



<a name="268633000"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/182449-t-compiler/help/topic/reporting%20a%20bug%20for%20an%20occasional%20error/near/268633000" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Matthew Graham <a href="https://zulip-archive.rust-lang.org/stream/182449-t-compiler/help/topic/reporting.20a.20bug.20for.20an.20occasional.20error.html#268633000">(Jan 20 2022 at 02:34)</a>:</h4>
<p>So of course it didn't happen for a long time. Here's what I just got. Ran the same command a second time and it worked.</p>
<div class="codehilite"><pre><span></span><code>cargo build --bin leema
warning: unused manifest key: package.rustc-link-lib
warning: unused manifest key: package.rustc-link-search
   Compiling leema v0.0.2 (/home/mdg/src/leema)
/home/mdg/.rustup/toolchains/stable-x86_64-unknown-linux-gnu/bin/../lib/librustc_driver-31f8e42342ce4267.so(+0x4dd503)[0x7fabe8b91503]
/lib64/libpthread.so.0(+0x13a20)[0x7fabe831ca20]
/home/mdg/.rustup/toolchains/stable-x86_64-unknown-linux-gnu/bin/../lib/../lib/libLLVM-13-rust-1.58.0-stable.so(_ZNK4llvm3DIE10getUnitDieEv+0x2)[0x7fabe697cc52]
/home/mdg/.rustup/toolchains/stable-x86_64-unknown-linux-gnu/bin/../lib/../lib/libLLVM-13-rust-1.58.0-stable.so(_ZN4llvm10DwarfDebug23finishEntityDefinitionsEv+0x57)[0x7fabe6420157]
/home/mdg/.rustup/toolchains/stable-x86_64-unknown-linux-gnu/bin/../lib/../lib/libLLVM-13-rust-1.58.0-stable.so(_ZN4llvm10DwarfDebug18finalizeModuleInfoEv+0x32)[0x7fabe641fa62]
/home/mdg/.rustup/toolchains/stable-x86_64-unknown-linux-gnu/bin/../lib/../lib/libLLVM-13-rust-1.58.0-stable.so(_ZN4llvm10DwarfDebug9endModuleEv+0x49)[0x7fabe641c289]
/home/mdg/.rustup/toolchains/stable-x86_64-unknown-linux-gnu/bin/../lib/../lib/libLLVM-13-rust-1.58.0-stable.so(_ZN4llvm10AsmPrinter14doFinalizationERNS_6ModuleE+0x358)[0x7fabe63832d8]
/home/mdg/.rustup/toolchains/stable-x86_64-unknown-linux-gnu/bin/../lib/../lib/libLLVM-13-rust-1.58.0-stable.so(_ZN4llvm13FPPassManager14doFinalizationERNS_6ModuleE+0x2d)[0x7fabe61ce42d]
/home/mdg/.rustup/toolchains/stable-x86_64-unknown-linux-gnu/bin/../lib/../lib/libLLVM-13-rust-1.58.0-stable.so(_ZN4llvm6legacy15PassManagerImpl3runERNS_6ModuleE+0x33c)[0x7fabe61cc83c]
/home/mdg/.rustup/toolchains/stable-x86_64-unknown-linux-gnu/bin/../lib/librustc_driver-31f8e42342ce4267.so(+0x216f9d4)[0x7fabea8239d4]
/home/mdg/.rustup/toolchains/stable-x86_64-unknown-linux-gnu/bin/../lib/librustc_driver-31f8e42342ce4267.so(+0x2157987)[0x7fabea80b987]
/home/mdg/.rustup/toolchains/stable-x86_64-unknown-linux-gnu/bin/../lib/librustc_driver-31f8e42342ce4267.so(+0x215ac69)[0x7fabea80ec69]
/home/mdg/.rustup/toolchains/stable-x86_64-unknown-linux-gnu/bin/../lib/librustc_driver-31f8e42342ce4267.so(+0x2164a3b)[0x7fabea818a3b]
/home/mdg/.rustup/toolchains/stable-x86_64-unknown-linux-gnu/bin/../lib/librustc_driver-31f8e42342ce4267.so(+0x215e983)[0x7fabea812983]
/home/mdg/.rustup/toolchains/stable-x86_64-unknown-linux-gnu/bin/../lib/librustc_driver-31f8e42342ce4267.so(+0x210e8e3)[0x7fabea7c28e3]
/home/mdg/.rustup/toolchains/stable-x86_64-unknown-linux-gnu/bin/../lib/librustc_driver-31f8e42342ce4267.so(+0x2143983)[0x7fabea7f7983]
/home/mdg/.rustup/toolchains/stable-x86_64-unknown-linux-gnu/bin/../lib/libstd-1e1088264352fcd6.so(rust_metadata_std_40fd643a72e9c5b+0xaabf3)[0x7fabe83eebf3]
/lib64/libpthread.so.0(+0x9299)[0x7fabe8312299]
/lib64/libc.so.6(clone+0x43)[0x7fabe8226353]
error: could not compile `leema`

Caused by:
  process didn&#39;t exit successfully: `rustc --crate-name leema --edition=2018 src/main.rs --error-format=json --json=diagnostic-rendered-ansi --crate-type bin --emit=dep-info,link -C embed-bitcode=no -C debuginfo=2 -C metadata=80fa0185e82f2ff4 -C extra-filename=-80fa0185e82f2ff4 --out-dir /home/mdg/src/leema/target/debug/deps -C incremental=/home/mdg/src/leema/target/debug/incremental -L dependency=/home/mdg/src/leema/target/debug/deps --extern bytes=/home/mdg/src/leema/target/debug/deps/libbytes-d49d51d0e6ea3068.rlib --extern docopt=/home/mdg/src/leema/target/debug/deps/libdocopt-42d4f044413ae3de.rlib --extern futures=/home/mdg/src/leema/target/debug/deps/libfutures-2024e13b805cc037.rlib --extern hyper=/home/mdg/src/leema/target/debug/deps/libhyper-0cc940ec0675996c.rlib --extern hyper_rustls=/home/mdg/src/leema/target/debug/deps/libhyper_rustls-09d96add5d3658be.rlib --extern lazy_static=/home/mdg/src/leema/target/debug/deps/liblazy_static-58877db5eb397361.rlib --extern libc=/home/mdg/src/leema/target/debug/deps/liblibc-65acde2ecb00c58b.rlib --extern log=/home/mdg/src/leema/target/debug/deps/liblog-9b0541ac9bb25277.rlib --extern matches=/home/mdg/src/leema/target/debug/deps/libmatches-cda0b22a4c4e99be.rlib --extern mopa=/home/mdg/src/leema/target/debug/deps/libmopa-88c005617989bf5f.rlib --extern pest=/home/mdg/src/leema/target/debug/deps/libpest-325e2a04ed36f89d.rlib --extern pest_derive=/home/mdg/src/leema/target/debug/deps/libpest_derive-913958e699728ff4.so --extern rand=/home/mdg/src/leema/target/debug/deps/librand-0f8cec4d9c32e082.rlib --extern rustc_serialize=/home/mdg/src/leema/target/debug/deps/librustc_serialize-efdd5dd05296eae6.rlib --extern serde=/home/mdg/src/leema/target/debug/deps/libserde-7d24222d2ea880ca.rlib --extern serde_derive=/home/mdg/src/leema/target/debug/deps/libserde_derive-6599a3d7926d4a3d.so --extern serde_json=/home/mdg/src/leema/target/debug/deps/libserde_json-637c9c935720cf06.rlib --extern tokio=/home/mdg/src/leema/target/debug/deps/libtokio-04ed1a6d90360c56.rlib --extern tokio_current_thread=/home/mdg/src/leema/target/debug/deps/libtokio_current_thread-62cdc7608002d41f.rlib -L native=/home/mdg/src/leema/target/debug/build/ring-c333fd75e9e4c3f2/out` (signal: 11, SIGSEGV: invalid memory reference)
make: *** [Makefile:10: build] Error 101
</code></pre></div>



<a name="268974824"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/182449-t-compiler/help/topic/reporting%20a%20bug%20for%20an%20occasional%20error/near/268974824" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Matthew Graham <a href="https://zulip-archive.rust-lang.org/stream/182449-t-compiler/help/topic/reporting.20a.20bug.20for.20an.20occasional.20error.html#268974824">(Jan 22 2022 at 19:59)</a>:</h4>
<p>Here's a different output:</p>
<div class="codehilite"><pre><span></span><code>$ cargo t test_main_func_fin
warning: unused manifest key: package.rustc-link-lib
warning: unused manifest key: package.rustc-link-search
   Compiling leema v0.0.2 (/home/mdg/src/leema)
/home/mdg/.rustup/toolchains/stable-x86_64-unknown-linux-gnu/bin/../lib/librustc_driver-31f8e42342ce4267.so(+0x4dd503)[0x7f0ed3ef2503]
/lib64/libpthread.so.0(+0x13a20)[0x7f0ed367da20]
/home/mdg/.rustup/toolchains/stable-x86_64-unknown-linux-gnu/bin/../lib/../lib/libLLVM-13-rust-1.58.0-stable.so(+0x9eeb8f)[0x7f0ecf1c9b8f]
error: could not compile `leema`

Caused by:
  process didn&#39;t exit successfully: `rustc --crate-name leema --edition=2018 src/main.rs --error-format=json --json=diagnostic-rendered-ansi --emit=dep-info,link -C embed-bitcode=no -C debuginfo=2 --test -C metadata=1c7eb2ce0a19cc92 -C extra-filename=-1c7eb2ce0a19cc92 --out-dir /home/mdg/src/leema/target/debug/deps -C incremental=/home/mdg/src/leema/target/debug/incremental -L dependency=/home/mdg/src/leema/target/debug/deps --extern docopt=/home/mdg/src/leema/target/debug/deps/libdocopt-0c271ed22b4cdd82.rlib --extern futures=/home/mdg/src/leema/target/debug/deps/libfutures-a0f161d37df48764.rlib --extern hyper=/home/mdg/src/leema/target/debug/deps/libhyper-748b549218e5c714.rlib --extern hyper_rustls=/home/mdg/src/leema/target/debug/deps/libhyper_rustls-61956ce1ae9d9759.rlib --extern lazy_static=/home/mdg/src/leema/target/debug/deps/liblazy_static-58877db5eb397361.rlib --extern libc=/home/mdg/src/leema/target/debug/deps/liblibc-09b6b1c93dff15ac.rlib --extern log=/home/mdg/src/leema/target/debug/deps/liblog-9b0541ac9bb25277.rlib --extern matches=/home/mdg/src/leema/target/debug/deps/libmatches-cda0b22a4c4e99be.rlib --extern mopa=/home/mdg/src/leema/target/debug/deps/libmopa-88c005617989bf5f.rlib --extern pest=/home/mdg/src/leema/target/debug/deps/libpest-325e2a04ed36f89d.rlib --extern pest_derive=/home/mdg/src/leema/target/debug/deps/libpest_derive-6d9f5e15f9159f46.so --extern rand=/home/mdg/src/leema/target/debug/deps/librand-b1074fa68e192935.rlib --extern rustc_serialize=/home/mdg/src/leema/target/debug/deps/librustc_serialize-efdd5dd05296eae6.rlib --extern serde=/home/mdg/src/leema/target/debug/deps/libserde-937e2b3d8c08b3cf.rlib --extern serde_derive=/home/mdg/src/leema/target/debug/deps/libserde_derive-f094798d0c1e55ca.so --extern serde_json=/home/mdg/src/leema/target/debug/deps/libserde_json-c75941884262ab86.rlib --extern tokio=/home/mdg/src/leema/target/debug/deps/libtokio-32698ff7fc109560.rlib --extern tokio_current_thread=/home/mdg/src/leema/target/debug/deps/libtokio_current_thread-62cdc7608002d41f.rlib -L native=/home/mdg/src/leema/target/debug/build/ring-1c488c27cd74934f/out` (signal: 11, SIGSEGV: invalid memory reference)
</code></pre></div>



<a name="268975035"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/182449-t-compiler/help/topic/reporting%20a%20bug%20for%20an%20occasional%20error/near/268975035" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Matthew Graham <a href="https://zulip-archive.rust-lang.org/stream/182449-t-compiler/help/topic/reporting.20a.20bug.20for.20an.20occasional.20error.html#268975035">(Jan 22 2022 at 20:03)</a>:</h4>
<p>This last case was persistent until I did <code>cargo clean</code> and rebuilt.</p>



<a name="268975058"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/182449-t-compiler/help/topic/reporting%20a%20bug%20for%20an%20occasional%20error/near/268975058" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Matthew Graham <a href="https://zulip-archive.rust-lang.org/stream/182449-t-compiler/help/topic/reporting.20a.20bug.20for.20an.20occasional.20error.html#268975058">(Jan 22 2022 at 20:03)</a>:</h4>
<p>which gets me back to my question, what's the good way to report something like this that will not show up for someone building clean?</p>



<hr><p>Last updated: Apr 12 2022 at 20:01 UTC</p>
</html>