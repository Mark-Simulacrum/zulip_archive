<html>
<head><meta charset="utf-8"><title>Segfault in #93387 · t-compiler/help · Zulip Chat Archive</title></head>
<h2>Stream: <a href="https://zulip-archive.rust-lang.org/stream/182449-t-compiler/help/index.html">t-compiler/help</a></h2>
<h3>Topic: <a href="https://zulip-archive.rust-lang.org/stream/182449-t-compiler/help/topic/Segfault.20in.20.2393387.html">Segfault in #93387</a></h3>

<hr>

<base href="https://rust-lang.zulipchat.com">

<head><link href="https://zulip-archive.rust-lang.org/style.css" rel="stylesheet"></head>

<a name="269628810"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/182449-t-compiler/help/topic/Segfault%20in%20%2393387/near/269628810" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jake <a href="https://zulip-archive.rust-lang.org/stream/182449-t-compiler/help/topic/Segfault.20in.20.2393387.html#269628810">(Jan 27 2022 at 19:56)</a>:</h4>
<p>Can anyone give any insight as to how I should approach the CI failure in <a href="https://github.com/rust-lang/rust/issues/93387">#93387</a>? I can't reproduce it locally, even on a clean build. Is the</p>
<div class="codehilite"><pre><span></span><code>Warning: Skipping &quot;src/test/mir-opt&quot;: not a regular file or directory
</code></pre></div>
<p>related?</p>



<a name="269633001"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/182449-t-compiler/help/topic/Segfault%20in%20%2393387/near/269633001" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Waffle Lapkin <a href="https://zulip-archive.rust-lang.org/stream/182449-t-compiler/help/topic/Segfault.20in.20.2393387.html#269633001">(Jan 27 2022 at 20:28)</a>:</h4>
<p>Every PR currently fails with the same "expected success, got: signal: 11 (core dumped)"</p>
<p>See <a href="https://github.com/rust-lang/rust/issues/93384">https://github.com/rust-lang/rust/issues/93384</a></p>



<a name="269875487"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/182449-t-compiler/help/topic/Segfault%20in%20%2393387/near/269875487" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tavian Barnes <a href="https://zulip-archive.rust-lang.org/stream/182449-t-compiler/help/topic/Segfault.20in.20.2393387.html#269875487">(Jan 29 2022 at 16:59)</a>:</h4>
<p>I think that's my fault.  Hopefully <a href="https://github.com/rust-lang/rust/pull/93459">https://github.com/rust-lang/rust/pull/93459</a> fixes it</p>



<a name="269876954"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/182449-t-compiler/help/topic/Segfault%20in%20%2393387/near/269876954" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> cuviper <a href="https://zulip-archive.rust-lang.org/stream/182449-t-compiler/help/topic/Segfault.20in.20.2393387.html#269876954">(Jan 29 2022 at 17:25)</a>:</h4>
<p>wow, so that dirent copy has been wrong for a long time, just not used on linux until your recent pr?</p>



<a name="269881622"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/182449-t-compiler/help/topic/Segfault%20in%20%2393387/near/269881622" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Josh Triplett <a href="https://zulip-archive.rust-lang.org/stream/182449-t-compiler/help/topic/Segfault.20in.20.2393387.html#269881622">(Jan 29 2022 at 18:54)</a>:</h4>
<p>Good argument for having fewer code paths.</p>



<a name="269909602"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/182449-t-compiler/help/topic/Segfault%20in%20%2393387/near/269909602" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tavian Barnes <a href="https://zulip-archive.rust-lang.org/stream/182449-t-compiler/help/topic/Segfault.20in.20.2393387.html#269909602">(Jan 30 2022 at 04:33)</a>:</h4>
<p>Yep :/</p>



<a name="269909661"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/182449-t-compiler/help/topic/Segfault%20in%20%2393387/near/269909661" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tavian Barnes <a href="https://zulip-archive.rust-lang.org/stream/182449-t-compiler/help/topic/Segfault.20in.20.2393387.html#269909661">(Jan 30 2022 at 04:34)</a>:</h4>
<p>Any idea why bors seemed to fail immediately on that PR?  I don't see logs anywhere</p>



<a name="269910624"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/182449-t-compiler/help/topic/Segfault%20in%20%2393387/near/269910624" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Ben Kimock (Saethlin) <a href="https://zulip-archive.rust-lang.org/stream/182449-t-compiler/help/topic/Segfault.20in.20.2393387.html#269910624">(Jan 30 2022 at 04:59)</a>:</h4>
<p>I think there are logs here? <a href="https://github.com/rust-lang/rust/pull/93387#issuecomment-1024812371">https://github.com/rust-lang/rust/pull/93387#issuecomment-1024812371</a> Not that I can find anything useful in them. I suspect this PR just got lucky/unlucky. I'm no expert on the POSIX fs stuff, but it looks like to trip this you need to get lucky/unlucky with the number of things in a directory _and_ the particular order that they appear in.</p>



<a name="269931615"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/182449-t-compiler/help/topic/Segfault%20in%20%2393387/near/269931615" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tavian Barnes <a href="https://zulip-archive.rust-lang.org/stream/182449-t-compiler/help/topic/Segfault.20in.20.2393387.html#269931615">(Jan 30 2022 at 12:57)</a>:</h4>
<p>I mean <a href="https://github.com/rust-lang/rust/issues/93459">#93459</a>, which is supposed to fix that</p>



<a name="269948254"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/182449-t-compiler/help/topic/Segfault%20in%20%2393387/near/269948254" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Josh Triplett <a href="https://zulip-archive.rust-lang.org/stream/182449-t-compiler/help/topic/Segfault.20in.20.2393387.html#269948254">(Jan 30 2022 at 18:35)</a>:</h4>
<p><span class="user-mention" data-user-id="306504">@Tavian Barnes</span> Thank you for scrambling to get this fixed and unblock people.</p>



<a name="269949052"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/182449-t-compiler/help/topic/Segfault%20in%20%2393387/near/269949052" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tavian Barnes <a href="https://zulip-archive.rust-lang.org/stream/182449-t-compiler/help/topic/Segfault.20in.20.2393387.html#269949052">(Jan 30 2022 at 18:51)</a>:</h4>
<p>No problem!</p>



<hr><p>Last updated: Apr 12 2022 at 20:01 UTC</p>
</html>