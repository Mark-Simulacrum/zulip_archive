<html>
<head><meta charset="utf-8"><title>How to restrict an attr to some specific item kind? · t-compiler/help · Zulip Chat Archive</title></head>
<h2>Stream: <a href="https://zulip-archive.rust-lang.org/stream/182449-t-compiler/help/index.html">t-compiler/help</a></h2>
<h3>Topic: <a href="https://zulip-archive.rust-lang.org/stream/182449-t-compiler/help/topic/How.20to.20restrict.20an.20attr.20to.20some.20specific.20item.20kind.3F.html">How to restrict an attr to some specific item kind?</a></h3>

<hr>

<base href="https://rust-lang.zulipchat.com">

<head><link href="https://zulip-archive.rust-lang.org/style.css" rel="stylesheet"></head>

<a name="269608451"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/182449-t-compiler/help/topic/How%20to%20restrict%20an%20attr%20to%20some%20specific%20item%20kind%3F/near/269608451" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Waffle Lapkin <a href="https://zulip-archive.rust-lang.org/stream/182449-t-compiler/help/topic/How.20to.20restrict.20an.20attr.20to.20some.20specific.20item.20kind.3F.html#269608451">(Jan 27 2022 at 17:36)</a>:</h4>
<p>There is a <code>rustc_attr!()</code>-defined attribute that only makes sense to be applied to traits (<code>#[rustc_must_implement_one_of]</code>). How to check, that it's only applied to traits and emit error otherwise?</p>



<a name="269608936"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/182449-t-compiler/help/topic/How%20to%20restrict%20an%20attr%20to%20some%20specific%20item%20kind%3F/near/269608936" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Waffle Lapkin <a href="https://zulip-archive.rust-lang.org/stream/182449-t-compiler/help/topic/How.20to.20restrict.20an.20attr.20to.20some.20specific.20item.20kind.3F.html#269608936">(Jan 27 2022 at 17:39)</a>:</h4>
<p>Hm, I'm now noticing that some other <code>rustc_*</code> attributes don't check whatever they are applied to a right kind of item <span aria-label="thinking" class="emoji emoji-1f914" role="img" title="thinking">:thinking:</span> </p>
<p><a href="https://play.rust-lang.org/?version=nightly&amp;mode=debug&amp;edition=2021&amp;gist=4b2034c1524b431a2c5366b4fa3accc3">https://play.rust-lang.org/?version=nightly&amp;mode=debug&amp;edition=2021&amp;gist=4b2034c1524b431a2c5366b4fa3accc3</a></p>



<a name="269609368"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/182449-t-compiler/help/topic/How%20to%20restrict%20an%20attr%20to%20some%20specific%20item%20kind%3F/near/269609368" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Waffle Lapkin <a href="https://zulip-archive.rust-lang.org/stream/182449-t-compiler/help/topic/How.20to.20restrict.20an.20attr.20to.20some.20specific.20item.20kind.3F.html#269609368">(Jan 27 2022 at 17:42)</a>:</h4>
<p>Ah, I think I've found the place to add the check: <a href="https://github.com/rust-lang/rust/blob/21b4a9cfdcbb1e76f4b36b5c3cfd64d627285093/compiler/rustc_passes/src/check_attr.rs">https://github.com/rust-lang/rust/blob/21b4a9cfdcbb1e76f4b36b5c3cfd64d627285093/compiler/rustc_passes/src/check_attr.rs</a></p>



<hr><p>Last updated: Apr 12 2022 at 20:01 UTC</p>
</html>