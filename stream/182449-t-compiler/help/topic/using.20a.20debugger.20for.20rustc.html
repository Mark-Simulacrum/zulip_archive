<html>
<head><meta charset="utf-8"><title>using a debugger for rustc · t-compiler/help · Zulip Chat Archive</title></head>
<h2>Stream: <a href="https://zulip-archive.rust-lang.org/stream/182449-t-compiler/help/index.html">t-compiler/help</a></h2>
<h3>Topic: <a href="https://zulip-archive.rust-lang.org/stream/182449-t-compiler/help/topic/using.20a.20debugger.20for.20rustc.html">using a debugger for rustc</a></h3>

<hr>

<base href="https://rust-lang.zulipchat.com">

<head><link href="https://zulip-archive.rust-lang.org/style.css" rel="stylesheet"></head>

<a name="273304664"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/182449-t-compiler/help/topic/using%20a%20debugger%20for%20rustc/near/273304664" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> enterprisey <a href="https://zulip-archive.rust-lang.org/stream/182449-t-compiler/help/topic/using.20a.20debugger.20for.20rustc.html#273304664">(Feb 26 2022 at 00:40)</a>:</h4>
<p>Is there anything out there about using gdb or another debugger on rustc? It's a tough topic to search for.</p>



<a name="273305412"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/182449-t-compiler/help/topic/using%20a%20debugger%20for%20rustc/near/273305412" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Eric Huss <a href="https://zulip-archive.rust-lang.org/stream/182449-t-compiler/help/topic/using.20a.20debugger.20for.20rustc.html#273305412">(Feb 26 2022 at 00:53)</a>:</h4>
<p><span class="user-mention" data-user-id="362597">@enterprisey</span> I can't think of any docs offhand.  Can you say what kind of trouble you're running into?  You should be able to just build with debugging and use gdb like you normally would.  rustc can't practically be built without optimizations, so it may be difficult to follow as lots of things will get optimized away, but otherwise it should be usable.</p>



<a name="273326418"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/182449-t-compiler/help/topic/using%20a%20debugger%20for%20rustc/near/273326418" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jakub Beránek <a href="https://zulip-archive.rust-lang.org/stream/182449-t-compiler/help/topic/using.20a.20debugger.20for.20rustc.html#273326418">(Feb 26 2022 at 08:09)</a>:</h4>
<p>I was able to debug rustc using the IntelliJ Rust plugin. It's a bit problematic since the compiler is optimized, but it did work.</p>



<a name="273327802"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/182449-t-compiler/help/topic/using%20a%20debugger%20for%20rustc/near/273327802" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> enterprisey <a href="https://zulip-archive.rust-lang.org/stream/182449-t-compiler/help/topic/using.20a.20debugger.20for.20rustc.html#273327802">(Feb 26 2022 at 08:41)</a>:</h4>
<p>Thanks Eric. I got gdb to work, but I can't view any locals (<code>info locals</code> prints "No locals".). Any ideas?</p>



<a name="273328036"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/182449-t-compiler/help/topic/using%20a%20debugger%20for%20rustc/near/273328036" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> bjorn3 <a href="https://zulip-archive.rust-lang.org/stream/182449-t-compiler/help/topic/using.20a.20debugger.20for.20rustc.html#273328036">(Feb 26 2022 at 08:46)</a>:</h4>
<p>Did you set debuginfo-level to 2? If not debuginfo for locals is not generated. Only debuginfo for source views.</p>



<a name="273328104"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/182449-t-compiler/help/topic/using%20a%20debugger%20for%20rustc/near/273328104" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> enterprisey <a href="https://zulip-archive.rust-lang.org/stream/182449-t-compiler/help/topic/using.20a.20debugger.20for.20rustc.html#273328104">(Feb 26 2022 at 08:48)</a>:</h4>
<p>You said that just as I reached that option while reading config.toml.example. My bad :)</p>



<a name="273388344"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/182449-t-compiler/help/topic/using%20a%20debugger%20for%20rustc/near/273388344" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> enterprisey <a href="https://zulip-archive.rust-lang.org/stream/182449-t-compiler/help/topic/using.20a.20debugger.20for.20rustc.html#273388344">(Feb 27 2022 at 07:28)</a>:</h4>
<p>it did indeed use a lot of ram while linking (I was down to 0.8% of my ram available), but the real problem is now that gdb (rust-gdb) aborts when I try to print certain locals</p>



<a name="273388346"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/182449-t-compiler/help/topic/using%20a%20debugger%20for%20rustc/near/273388346" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> enterprisey <a href="https://zulip-archive.rust-lang.org/stream/182449-t-compiler/help/topic/using.20a.20debugger.20for.20rustc.html#273388346">(Feb 27 2022 at 07:28)</a>:</h4>
<p>(other locals, it works fine)</p>



<a name="273388348"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/182449-t-compiler/help/topic/using%20a%20debugger%20for%20rustc/near/273388348" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> enterprisey <a href="https://zulip-archive.rust-lang.org/stream/182449-t-compiler/help/topic/using.20a.20debugger.20for.20rustc.html#273388348">(Feb 27 2022 at 07:28)</a>:</h4>
<p>...is the recommended workflow just to <code>trace!</code> a lot and not use a debugger, or am I missing something</p>



<a name="273389094"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/182449-t-compiler/help/topic/using%20a%20debugger%20for%20rustc/near/273389094" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> enterprisey <a href="https://zulip-archive.rust-lang.org/stream/182449-t-compiler/help/topic/using.20a.20debugger.20for.20rustc.html#273389094">(Feb 27 2022 at 07:48)</a>:</h4>
<p>(if anyone else wanted to give it a shot, the crashing command was <code>print id</code> at the top of the for loop in <code>resolve_path_with_ribs</code> in <code>rustc_resolve</code>)</p>



<a name="273389440"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/182449-t-compiler/help/topic/using%20a%20debugger%20for%20rustc/near/273389440" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> oli <a href="https://zulip-archive.rust-lang.org/stream/182449-t-compiler/help/topic/using.20a.20debugger.20for.20rustc.html#273389440">(Feb 27 2022 at 07:59)</a>:</h4>
<p>I've used gdb frequently on rustc without any crashes. I turned on debug mode for rustc in config.toml (but still kept optimizations on). Not just debuginfo, but <code>debug = true</code>. Maybe there is some additional info that is missing otherwise?</p>
<p>Either way, I can strongly recommend using <code>rr</code> when you debug rustc, as it allows you to step backwards.</p>
<p>That said, I mostly use tracing for debugging things, as I get a larger picture from that and can grep around.</p>



<hr><p>Last updated: Apr 12 2022 at 20:01 UTC</p>
</html>