<html>
<head><meta charset="utf-8"><title>`Span::join` in the compiler · t-compiler/help · Zulip Chat Archive</title></head>
<h2>Stream: <a href="https://rust-lang.github.io/zulip_archive/stream/182449-t-compiler/help/index.html">t-compiler/help</a></h2>
<h3>Topic: <a href="https://rust-lang.github.io/zulip_archive/stream/182449-t-compiler/help/topic/.60Span.3A.3Ajoin.60.20in.20the.20compiler.html">`Span::join` in the compiler</a></h3>

<hr>

<base href="https://rust-lang.zulipchat.com">

<head><link href="https://rust-lang.github.io/zulip_archive/style.css" rel="stylesheet"></head>

<a name="244109067"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/182449-t-compiler/help/topic/%60Span%3A%3Ajoin%60%20in%20the%20compiler/near/244109067" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jacob Pratt <a href="https://rust-lang.github.io/zulip_archive/stream/182449-t-compiler/help/topic/.60Span.3A.3Ajoin.60.20in.20the.20compiler.html#244109067">(Jun 28 2021 at 07:17)</a>:</h4>
<p>How can I perform an operation similar to <code>Span::join</code> in the compiler?</p>



<a name="244109159"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/182449-t-compiler/help/topic/%60Span%3A%3Ajoin%60%20in%20the%20compiler/near/244109159" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> inquisitivecrystal <a href="https://rust-lang.github.io/zulip_archive/stream/182449-t-compiler/help/topic/.60Span.3A.3Ajoin.60.20in.20the.20compiler.html#244109159">(Jun 28 2021 at 07:18)</a>:</h4>
<p>Is <code>Span::to</code> what you're looking for?</p>



<a name="244109223"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/182449-t-compiler/help/topic/%60Span%3A%3Ajoin%60%20in%20the%20compiler/near/244109223" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> inquisitivecrystal <a href="https://rust-lang.github.io/zulip_archive/stream/182449-t-compiler/help/topic/.60Span.3A.3Ajoin.60.20in.20the.20compiler.html#244109223">(Jun 28 2021 at 07:19)</a>:</h4>
<p><a href="https://doc.rust-lang.org/stable/nightly-rustc/rustc_span/struct.Span.html#method.to">https://doc.rust-lang.org/stable/nightly-rustc/rustc_span/struct.Span.html#method.to</a></p>



<a name="244109377"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/182449-t-compiler/help/topic/%60Span%3A%3Ajoin%60%20in%20the%20compiler/near/244109377" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jacob Pratt <a href="https://rust-lang.github.io/zulip_archive/stream/182449-t-compiler/help/topic/.60Span.3A.3Ajoin.60.20in.20the.20compiler.html#244109377">(Jun 28 2021 at 07:21)</a>:</h4>
<p>Not quite. I'd like to avoid everything in between, which is what <code>Span::join</code> does afaik</p>



<a name="244109685"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/182449-t-compiler/help/topic/%60Span%3A%3Ajoin%60%20in%20the%20compiler/near/244109685" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> inquisitivecrystal <a href="https://rust-lang.github.io/zulip_archive/stream/182449-t-compiler/help/topic/.60Span.3A.3Ajoin.60.20in.20the.20compiler.html#244109685">(Jun 28 2021 at 07:24)</a>:</h4>
<p>I don't <em>think</em> that's possible  given the way that Span is implemented. It seems to consist of just a start, a length, and a syntax context.</p>



<a name="244109711"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/182449-t-compiler/help/topic/%60Span%3A%3Ajoin%60%20in%20the%20compiler/near/244109711" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jacob Pratt <a href="https://rust-lang.github.io/zulip_archive/stream/182449-t-compiler/help/topic/.60Span.3A.3Ajoin.60.20in.20the.20compiler.html#244109711">(Jun 28 2021 at 07:25)</a>:</h4>
<p>How does <code>Span::join</code> work then? <span aria-label="thinking" class="emoji emoji-1f914" role="img" title="thinking">:thinking:</span></p>



<a name="244109726"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/182449-t-compiler/help/topic/%60Span%3A%3Ajoin%60%20in%20the%20compiler/near/244109726" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jacob Pratt <a href="https://rust-lang.github.io/zulip_archive/stream/182449-t-compiler/help/topic/.60Span.3A.3Ajoin.60.20in.20the.20compiler.html#244109726">(Jun 28 2021 at 07:25)</a>:</h4>
<p>Ideally the API I'm trying to use would take a <code>MultiSpan</code>, but it doesn't.</p>



<a name="244109882"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/182449-t-compiler/help/topic/%60Span%3A%3Ajoin%60%20in%20the%20compiler/near/244109882" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> inquisitivecrystal <a href="https://rust-lang.github.io/zulip_archive/stream/182449-t-compiler/help/topic/.60Span.3A.3Ajoin.60.20in.20the.20compiler.html#244109882">(Jun 28 2021 at 07:27)</a>:</h4>
<p>Because <code>proc_macro::Span</code> is implemented differently from <code>rustc_span::Span</code>? There's also a pretty fair chance I'm just wrong. I'm not a super expirienced contributor.</p>



<a name="244109916"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/182449-t-compiler/help/topic/%60Span%3A%3Ajoin%60%20in%20the%20compiler/near/244109916" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jacob Pratt <a href="https://rust-lang.github.io/zulip_archive/stream/182449-t-compiler/help/topic/.60Span.3A.3Ajoin.60.20in.20the.20compiler.html#244109916">(Jun 28 2021 at 07:27)</a>:</h4>
<p>Just seems odd that a library can do something the compiler can't. Got me.</p>



<a name="244110196"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/182449-t-compiler/help/topic/%60Span%3A%3Ajoin%60%20in%20the%20compiler/near/244110196" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> inquisitivecrystal <a href="https://rust-lang.github.io/zulip_archive/stream/182449-t-compiler/help/topic/.60Span.3A.3Ajoin.60.20in.20the.20compiler.html#244110196">(Jun 28 2021 at 07:31)</a>:</h4>
<p>Yeah, if it does work how I think it does, it's super weird.</p>



<a name="244113489"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/182449-t-compiler/help/topic/%60Span%3A%3Ajoin%60%20in%20the%20compiler/near/244113489" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jacob Pratt <a href="https://rust-lang.github.io/zulip_archive/stream/182449-t-compiler/help/topic/.60Span.3A.3Ajoin.60.20in.20the.20compiler.html#244113489">(Jun 28 2021 at 08:10)</a>:</h4>
<p>I will note that I initially thought of using <code>Diagnostic</code> directly, since that <em>does</em> accept a <code>MultiSpan</code>, but that seems a bit hacky.<br>
For reference I'm trying to emit a diagnostic that has a single label for some number of (potentially nonconsecutive) spans. I could do this via <code>.span_labels</code>, but that emits the label for each span, which isn't what I want.</p>



<a name="244113709"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/182449-t-compiler/help/topic/%60Span%3A%3Ajoin%60%20in%20the%20compiler/near/244113709" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> inquisitivecrystal <a href="https://rust-lang.github.io/zulip_archive/stream/182449-t-compiler/help/topic/.60Span.3A.3Ajoin.60.20in.20the.20compiler.html#244113709">(Jun 28 2021 at 08:12)</a>:</h4>
<p>Could you add an API that takes a <code>MultiSpan</code> where you think there should be one? I always tend to add internal methods when I need them, but I may be too willing to do that.</p>



<a name="244113800"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/182449-t-compiler/help/topic/%60Span%3A%3Ajoin%60%20in%20the%20compiler/near/244113800" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jacob Pratt <a href="https://rust-lang.github.io/zulip_archive/stream/182449-t-compiler/help/topic/.60Span.3A.3Ajoin.60.20in.20the.20compiler.html#244113800">(Jun 28 2021 at 08:14)</a>:</h4>
<p>I certainly could. I'm digging through API docs and I <em>think</em> <code>.multipart_suggestion</code> is similar to what I'm looking for. The actual error message doesn't particularly need to point to every instance of the error, since it's super obvious from the message.</p>



<a name="244115819"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/182449-t-compiler/help/topic/%60Span%3A%3Ajoin%60%20in%20the%20compiler/near/244115819" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jacob Pratt <a href="https://rust-lang.github.io/zulip_archive/stream/182449-t-compiler/help/topic/.60Span.3A.3Ajoin.60.20in.20the.20compiler.html#244115819">(Jun 28 2021 at 08:36)</a>:</h4>
<p>Haven't figured out how to test the suggestions but I'm pretty sure it's correct. Would still be nice to actually point to multiple attributes to indicate mass-removal, though.</p>



<hr><p>Last updated: Aug 07 2021 at 22:04 UTC</p>
</html>