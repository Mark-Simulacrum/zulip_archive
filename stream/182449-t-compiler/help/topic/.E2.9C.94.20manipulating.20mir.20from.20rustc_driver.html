<html>
<head><meta charset="utf-8"><title>✔ manipulating mir from rustc_driver · t-compiler/help · Zulip Chat Archive</title></head>
<h2>Stream: <a href="https://zulip-archive.rust-lang.org/stream/182449-t-compiler/help/index.html">t-compiler/help</a></h2>
<h3>Topic: <a href="https://zulip-archive.rust-lang.org/stream/182449-t-compiler/help/topic/.E2.9C.94.20manipulating.20mir.20from.20rustc_driver.html">✔ manipulating mir from rustc_driver</a></h3>

<hr>

<base href="https://rust-lang.zulipchat.com">

<head><link href="https://zulip-archive.rust-lang.org/style.css" rel="stylesheet"></head>

<a name="258749369"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/182449-t-compiler/help/topic/%E2%9C%94%20manipulating%20mir%20from%20rustc_driver/near/258749369" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Pietro Albini <a href="https://zulip-archive.rust-lang.org/stream/182449-t-compiler/help/topic/.E2.9C.94.20manipulating.20mir.20from.20rustc_driver.html#258749369">(Oct 22 2021 at 18:01)</a>:</h4>
<p>oh! didn't think of that, thanks <span aria-label="heart" class="emoji emoji-2764" role="img" title="heart">:heart:</span></p>



<a name="258749378"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/182449-t-compiler/help/topic/%E2%9C%94%20manipulating%20mir%20from%20rustc_driver/near/258749378" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Notification Bot <a href="https://zulip-archive.rust-lang.org/stream/182449-t-compiler/help/topic/.E2.9C.94.20manipulating.20mir.20from.20rustc_driver.html#258749378">(Oct 22 2021 at 18:01)</a>:</h4>
<p><span class="user-mention silent" data-user-id="121055">Pietro Albini</span> has marked this topic as resolved.</p>



<a name="258776672"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/182449-t-compiler/help/topic/%E2%9C%94%20manipulating%20mir%20from%20rustc_driver/near/258776672" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Celina V. <a href="https://zulip-archive.rust-lang.org/stream/182449-t-compiler/help/topic/.E2.9C.94.20manipulating.20mir.20from.20rustc_driver.html#258776672">(Oct 22 2021 at 21:22)</a>:</h4>
<p>Sorry to reopen this thread. I am really interested in doing the same as <span class="user-mention" data-user-id="121055">@Pietro Albini</span> .</p>
<p>I think I'm missing something here. Is there a clean way to override a provider and use a reference to the old provider?</p>
<p>The optimized_mir is a private method, so I cannot call it directly from my new provider. I can't pass the old provider method to the definition of my new provider because providers are meant to be functions. The only way I can think of is by using a mutable global variable. Is that correct?</p>



<a name="258802529"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/182449-t-compiler/help/topic/%E2%9C%94%20manipulating%20mir%20from%20rustc_driver/near/258802529" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> bjorn3 <a href="https://zulip-archive.rust-lang.org/stream/182449-t-compiler/help/topic/.E2.9C.94.20manipulating.20mir.20from.20rustc_driver.html#258802529">(Oct 23 2021 at 04:24)</a>:</h4>
<p><code>rustc_interface::DEFAULT_QUERY_PROVIDERS</code> has an <code>optimized_mir</code> field you can call.</p>



<a name="258990143"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/182449-t-compiler/help/topic/%E2%9C%94%20manipulating%20mir%20from%20rustc_driver/near/258990143" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Celina V. <a href="https://zulip-archive.rust-lang.org/stream/182449-t-compiler/help/topic/.E2.9C.94.20manipulating.20mir.20from.20rustc_driver.html#258990143">(Oct 25 2021 at 17:09)</a>:</h4>
<p>Perfect! Thank you.</p>



<hr><p>Last updated: Apr 12 2022 at 20:01 UTC</p>
</html>