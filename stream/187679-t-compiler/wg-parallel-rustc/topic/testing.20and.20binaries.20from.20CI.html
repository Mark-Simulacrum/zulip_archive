<html>
<head><meta charset="utf-8"><title>testing and binaries from CI · t-compiler/wg-parallel-rustc · Zulip Chat Archive</title></head>
<h2>Stream: <a href="https://zulip-archive.rust-lang.org/stream/187679-t-compiler/wg-parallel-rustc/index.html">t-compiler/wg-parallel-rustc</a></h2>
<h3>Topic: <a href="https://zulip-archive.rust-lang.org/stream/187679-t-compiler/wg-parallel-rustc/topic/testing.20and.20binaries.20from.20CI.html">testing and binaries from CI</a></h3>

<hr>

<base href="https://rust-lang.zulipchat.com">

<head><link href="https://zulip-archive.rust-lang.org/style.css" rel="stylesheet"></head>

<a name="161653190"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/187679-t-compiler/wg-parallel-rustc/topic/testing%20and%20binaries%20from%20CI/near/161653190" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> mw <a href="https://zulip-archive.rust-lang.org/stream/187679-t-compiler/wg-parallel-rustc/topic/testing.20and.20binaries.20from.20CI.html#161653190">(Mar 25 2019 at 15:13)</a>:</h4>
<p><span class="user-mention" data-user-id="116015">@Alex Crichton</span> has kindly offered to look into providing CI-generated parallel rustc binaries.</p>



<a name="161653232"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/187679-t-compiler/wg-parallel-rustc/topic/testing%20and%20binaries%20from%20CI/near/161653232" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> mw <a href="https://zulip-archive.rust-lang.org/stream/187679-t-compiler/wg-parallel-rustc/topic/testing.20and.20binaries.20from.20CI.html#161653232">(Mar 25 2019 at 15:13)</a>:</h4>
<p>the plan is to make CI build binaries for Linux, macOs, and Windows and have instructions for downloading them in a convenient way</p>



<a name="161653407"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/187679-t-compiler/wg-parallel-rustc/topic/testing%20and%20binaries%20from%20CI/near/161653407" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> mw <a href="https://zulip-archive.rust-lang.org/stream/187679-t-compiler/wg-parallel-rustc/topic/testing.20and.20binaries.20from.20CI.html#161653407">(Mar 25 2019 at 15:15)</a>:</h4>
<p>as a follow up step, it would be great if we could use those binaries for setting up some external regression testing that compiles a number of projects and checks if the output is the same as the one from the non-parallel compiler.</p>



<a name="161653489"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/187679-t-compiler/wg-parallel-rustc/topic/testing%20and%20binaries%20from%20CI/near/161653489" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> mw <a href="https://zulip-archive.rust-lang.org/stream/187679-t-compiler/wg-parallel-rustc/topic/testing.20and.20binaries.20from.20CI.html#161653489">(Mar 25 2019 at 15:16)</a>:</h4>
<p>(doing this as part of regular CI does not seem to be feasible at the moment)</p>



<a name="161653520"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/187679-t-compiler/wg-parallel-rustc/topic/testing%20and%20binaries%20from%20CI/near/161653520" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> mw <a href="https://zulip-archive.rust-lang.org/stream/187679-t-compiler/wg-parallel-rustc/topic/testing.20and.20binaries.20from.20CI.html#161653520">(Mar 25 2019 at 15:16)</a>:</h4>
<p>cc <span class="user-mention" data-user-id="116466">@Zoxc</span> <span class="user-mention" data-user-id="116009">@nikomatsakis</span></p>



<a name="161656722"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/187679-t-compiler/wg-parallel-rustc/topic/testing%20and%20binaries%20from%20CI/near/161656722" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Alex Crichton <a href="https://zulip-archive.rust-lang.org/stream/187679-t-compiler/wg-parallel-rustc/topic/testing.20and.20binaries.20from.20CI.html#161656722">(Mar 25 2019 at 15:50)</a>:</h4>
<p><span class="user-mention" data-user-id="124287">@mw</span> is there a general tracking issue for parallel queries?</p>



<a name="161656733"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/187679-t-compiler/wg-parallel-rustc/topic/testing%20and%20binaries%20from%20CI/near/161656733" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Alex Crichton <a href="https://zulip-archive.rust-lang.org/stream/187679-t-compiler/wg-parallel-rustc/topic/testing.20and.20binaries.20from.20CI.html#161656733">(Mar 25 2019 at 15:50)</a>:</h4>
<p>I'm gonna open a tracking issue on rust-lang/rust for this</p>



<a name="161659110"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/187679-t-compiler/wg-parallel-rustc/topic/testing%20and%20binaries%20from%20CI/near/161659110" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wesley Wiser <a href="https://zulip-archive.rust-lang.org/stream/187679-t-compiler/wg-parallel-rustc/topic/testing.20and.20binaries.20from.20CI.html#161659110">(Mar 25 2019 at 16:13)</a>:</h4>
<p><span class="user-mention" data-user-id="116015">@Alex Crichton</span> There's a tacking issue for parallel queries in <a href="https://github.com/rust-lang/rust/issues/48685" target="_blank" title="https://github.com/rust-lang/rust/issues/48685">#48685</a></p>



<a name="161686401"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/187679-t-compiler/wg-parallel-rustc/topic/testing%20and%20binaries%20from%20CI/near/161686401" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Alex Crichton <a href="https://zulip-archive.rust-lang.org/stream/187679-t-compiler/wg-parallel-rustc/topic/testing.20and.20binaries.20from.20CI.html#161686401">(Mar 25 2019 at 20:53)</a>:</h4>
<p>Thanks! I've posted a first pass at <a href="https://github.com/rust-lang/rust/pull/59417" target="_blank" title="https://github.com/rust-lang/rust/pull/59417">https://github.com/rust-lang/rust/pull/59417</a>, and we'll see what comes out of that to keep testing</p>



<a name="162337495"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/187679-t-compiler/wg-parallel-rustc/topic/testing%20and%20binaries%20from%20CI/near/162337495" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Alex Crichton <a href="https://zulip-archive.rust-lang.org/stream/187679-t-compiler/wg-parallel-rustc/topic/testing.20and.20binaries.20from.20CI.html#162337495">(Apr 02 2019 at 14:11)</a>:</h4>
<p>Ok so I had an idea with <span class="user-mention" data-user-id="116009">@nikomatsakis</span> at Rust LATAM which was "what if we just enabled parallel on by default right now?". I was thinking we might not necessarily turn on the actual multithreaded part, but what if we started shipping parallel-capable compilers right now but continued to default the number of threads to 1 while we're working out all the bugs?</p>



<a name="162337516"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/187679-t-compiler/wg-parallel-rustc/topic/testing%20and%20binaries%20from%20CI/near/162337516" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Alex Crichton <a href="https://zulip-archive.rust-lang.org/stream/187679-t-compiler/wg-parallel-rustc/topic/testing.20and.20binaries.20from.20CI.html#162337516">(Apr 02 2019 at 14:11)</a>:</h4>
<p>I ran a <code>@bors: try</code> build on <a href="https://github.com/rust-lang/rust/pull/59417#issuecomment-479013998" target="_blank" title="https://github.com/rust-lang/rust/pull/59417#issuecomment-479013998">https://github.com/rust-lang/rust/pull/59417#issuecomment-479013998</a> and it turns out the slowdown, while there, is quite small at 2-3% across the board.</p>



<a name="162337588"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/187679-t-compiler/wg-parallel-rustc/topic/testing%20and%20binaries%20from%20CI/near/162337588" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Alex Crichton <a href="https://zulip-archive.rust-lang.org/stream/187679-t-compiler/wg-parallel-rustc/topic/testing.20and.20binaries.20from.20CI.html#162337588">(Apr 02 2019 at 14:12)</a>:</h4>
<p>That seems quite impressive in terms of slowdown, and makes me think that we'd be perfectly suited to enable parallel compilation <em>right now</em> (ok, maybe after the next release on April 11) for testing</p>



<a name="162337606"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/187679-t-compiler/wg-parallel-rustc/topic/testing%20and%20binaries%20from%20CI/near/162337606" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Alex Crichton <a href="https://zulip-archive.rust-lang.org/stream/187679-t-compiler/wg-parallel-rustc/topic/testing.20and.20binaries.20from.20CI.html#162337606">(Apr 02 2019 at 14:12)</a>:</h4>
<p>that way we won't need any crazy support with try or not, and we can just have normal nightly testing like we have for everything else</p>



<a name="162337615"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/187679-t-compiler/wg-parallel-rustc/topic/testing%20and%20binaries%20from%20CI/near/162337615" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Alex Crichton <a href="https://zulip-archive.rust-lang.org/stream/187679-t-compiler/wg-parallel-rustc/topic/testing.20and.20binaries.20from.20CI.html#162337615">(Apr 02 2019 at 14:12)</a>:</h4>
<p><span class="user-mention" data-user-id="116466">@Zoxc</span> and <span class="user-mention" data-user-id="124287">@mw</span>, thoughts?</p>



<a name="162337687"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/187679-t-compiler/wg-parallel-rustc/topic/testing%20and%20binaries%20from%20CI/near/162337687" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Cem Karan <a href="https://zulip-archive.rust-lang.org/stream/187679-t-compiler/wg-parallel-rustc/topic/testing.20and.20binaries.20from.20CI.html#162337687">(Apr 02 2019 at 14:13)</a>:</h4>
<p>Works for me; it means an extra sip of coffee while the compiler is running. <span aria-label="wink" class="emoji emoji-1f609" role="img" title="wink">:wink:</span></p>



<a name="162339069"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/187679-t-compiler/wg-parallel-rustc/topic/testing%20and%20binaries%20from%20CI/near/162339069" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Alex Crichton <a href="https://zulip-archive.rust-lang.org/stream/187679-t-compiler/wg-parallel-rustc/topic/testing.20and.20binaries.20from.20CI.html#162339069">(Apr 02 2019 at 14:25)</a>:</h4>
<p>Ah this was brought up in the PR but the 2-3% number is actually incorrect, that's number of instructions where the more interesting metric for htis PR is wall time, and wall time regresses by 10% mostly which I think is probably too bad to land in rustc nightly right now</p>



<a name="162339077"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/187679-t-compiler/wg-parallel-rustc/topic/testing%20and%20binaries%20from%20CI/near/162339077" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Alex Crichton <a href="https://zulip-archive.rust-lang.org/stream/187679-t-compiler/wg-parallel-rustc/topic/testing.20and.20binaries.20from.20CI.html#162339077">(Apr 02 2019 at 14:25)</a>:</h4>
<p>so less actionable than I thought :(</p>



<a name="162339177"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/187679-t-compiler/wg-parallel-rustc/topic/testing%20and%20binaries%20from%20CI/near/162339177" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Alex Crichton <a href="https://zulip-archive.rust-lang.org/stream/187679-t-compiler/wg-parallel-rustc/topic/testing.20and.20binaries.20from.20CI.html#162339177">(Apr 02 2019 at 14:26)</a>:</h4>
<p>Although honestly the major regressions are all in tiny crates that take 1s extra to compile it looks like</p>



<a name="162339193"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/187679-t-compiler/wg-parallel-rustc/topic/testing%20and%20binaries%20from%20CI/near/162339193" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Alex Crichton <a href="https://zulip-archive.rust-lang.org/stream/187679-t-compiler/wg-parallel-rustc/topic/testing.20and.20binaries.20from.20CI.html#162339193">(Apr 02 2019 at 14:26)</a>:</h4>
<p>as opposed to larger crates also only regressing by a few seconds, showing up as a large-ish percentage</p>



<a name="162339210"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/187679-t-compiler/wg-parallel-rustc/topic/testing%20and%20binaries%20from%20CI/near/162339210" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Alex Crichton <a href="https://zulip-archive.rust-lang.org/stream/187679-t-compiler/wg-parallel-rustc/topic/testing.20and.20binaries.20from.20CI.html#162339210">(Apr 02 2019 at 14:26)</a>:</h4>
<p>so perhaps not that bad after all...</p>



<a name="162341802"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/187679-t-compiler/wg-parallel-rustc/topic/testing%20and%20binaries%20from%20CI/near/162341802" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Cem Karan <a href="https://zulip-archive.rust-lang.org/stream/187679-t-compiler/wg-parallel-rustc/topic/testing.20and.20binaries.20from.20CI.html#162341802">(Apr 02 2019 at 14:49)</a>:</h4>
<p>Do you know what is major cause of the 10% regression?  I mean, is it drive access, too much swapping, etc.?  If there was an extra flag in rustc/cargo to enable self-profiling and shipping the profiling data back to a central location for further analysis, that could be useful (Apple did something like this when they were switching from the old OS 9/Carbon APIs to the OS X APIs; in their case they were just getting information about the APIs being used by developers, but I can see having a simple way of shipping the profiling data back for analysis being useful here to see what areas need to be concentrated on 'in the wild').</p>



<a name="162341881"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/187679-t-compiler/wg-parallel-rustc/topic/testing%20and%20binaries%20from%20CI/near/162341881" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> mw <a href="https://zulip-archive.rust-lang.org/stream/187679-t-compiler/wg-parallel-rustc/topic/testing.20and.20binaries.20from.20CI.html#162341881">(Apr 02 2019 at 14:49)</a>:</h4>
<p>are there wins too?</p>



<a name="162343407"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/187679-t-compiler/wg-parallel-rustc/topic/testing%20and%20binaries%20from%20CI/near/162343407" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Alex Crichton <a href="https://zulip-archive.rust-lang.org/stream/187679-t-compiler/wg-parallel-rustc/topic/testing.20and.20binaries.20from.20CI.html#162343407">(Apr 02 2019 at 15:03)</a>:</h4>
<p><span class="user-mention" data-user-id="202560">@Cem Karan</span> I'm not sure, but I've pigned <span class="user-mention" data-user-id="116466">@Zoxc</span> who may know more</p>



<a name="162343437"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/187679-t-compiler/wg-parallel-rustc/topic/testing%20and%20binaries%20from%20CI/near/162343437" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Alex Crichton <a href="https://zulip-archive.rust-lang.org/stream/187679-t-compiler/wg-parallel-rustc/topic/testing.20and.20binaries.20from.20CI.html#162343437">(Apr 02 2019 at 15:03)</a>:</h4>
<p><span class="user-mention" data-user-id="124287">@mw</span> I pinned the number of threads to 1 because it sounds like we're not ready for true parallelism yet</p>



<a name="162343452"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/187679-t-compiler/wg-parallel-rustc/topic/testing%20and%20binaries%20from%20CI/near/162343452" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Alex Crichton <a href="https://zulip-archive.rust-lang.org/stream/187679-t-compiler/wg-parallel-rustc/topic/testing.20and.20binaries.20from.20CI.html#162343452">(Apr 02 2019 at 15:03)</a>:</h4>
<p>so this was a test of "can we take a small hit to build in parallel mode always and just not use it"</p>



<a name="162343462"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/187679-t-compiler/wg-parallel-rustc/topic/testing%20and%20binaries%20from%20CI/near/162343462" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Alex Crichton <a href="https://zulip-archive.rust-lang.org/stream/187679-t-compiler/wg-parallel-rustc/topic/testing.20and.20binaries.20from.20CI.html#162343462">(Apr 02 2019 at 15:03)</a>:</h4>
<p>so there were no improvements, only regressions</p>



<a name="162343466"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/187679-t-compiler/wg-parallel-rustc/topic/testing%20and%20binaries%20from%20CI/near/162343466" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Alex Crichton <a href="https://zulip-archive.rust-lang.org/stream/187679-t-compiler/wg-parallel-rustc/topic/testing.20and.20binaries.20from.20CI.html#162343466">(Apr 02 2019 at 15:03)</a>:</h4>
<p>(as expected though)</p>



<a name="162343676"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/187679-t-compiler/wg-parallel-rustc/topic/testing%20and%20binaries%20from%20CI/near/162343676" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> mw <a href="https://zulip-archive.rust-lang.org/stream/187679-t-compiler/wg-parallel-rustc/topic/testing.20and.20binaries.20from.20CI.html#162343676">(Apr 02 2019 at 15:05)</a>:</h4>
<p>hm, results from here seem to be mixed: <a href="https://github.com/rust-lang/rust/pull/59530" target="_blank" title="https://github.com/rust-lang/rust/pull/59530">https://github.com/rust-lang/rust/pull/59530</a></p>



<a name="162347034"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/187679-t-compiler/wg-parallel-rustc/topic/testing%20and%20binaries%20from%20CI/near/162347034" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Alex Crichton <a href="https://zulip-archive.rust-lang.org/stream/187679-t-compiler/wg-parallel-rustc/topic/testing.20and.20binaries.20from.20CI.html#162347034">(Apr 02 2019 at 15:43)</a>:</h4>
<p><span class="user-mention" data-user-id="124287">@mw</span> oh that's a separate PR with a different strategy (turning on parallel rustc <em>and</em> defaulting threads to num_cpus)</p>



<a name="162347040"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/187679-t-compiler/wg-parallel-rustc/topic/testing%20and%20binaries%20from%20CI/near/162347040" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Alex Crichton <a href="https://zulip-archive.rust-lang.org/stream/187679-t-compiler/wg-parallel-rustc/topic/testing.20and.20binaries.20from.20CI.html#162347040">(Apr 02 2019 at 15:43)</a>:</h4>
<p>you're looking at wall time as well, right?</p>



<a name="162347052"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/187679-t-compiler/wg-parallel-rustc/topic/testing%20and%20binaries%20from%20CI/near/162347052" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Alex Crichton <a href="https://zulip-archive.rust-lang.org/stream/187679-t-compiler/wg-parallel-rustc/topic/testing.20and.20binaries.20from.20CI.html#162347052">(Apr 02 2019 at 15:43)</a>:</h4>
<p>it's <a href="https://perf.rust-lang.org/compare.html?start=2002b4b39a16760f37107cf02d7a91ff316d3073&amp;end=e1f9d0488d052f77315c033b3b8bf47a4d8fdb11&amp;stat=wall-time" target="_blank" title="https://perf.rust-lang.org/compare.html?start=2002b4b39a16760f37107cf02d7a91ff316d3073&amp;end=e1f9d0488d052f77315c033b3b8bf47a4d8fdb11&amp;stat=wall-time">still got some regressions</a> but overall looks quite good</p>



<a name="162409134"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/187679-t-compiler/wg-parallel-rustc/topic/testing%20and%20binaries%20from%20CI/near/162409134" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> mw <a href="https://zulip-archive.rust-lang.org/stream/187679-t-compiler/wg-parallel-rustc/topic/testing.20and.20binaries.20from.20CI.html#162409134">(Apr 03 2019 at 08:28)</a>:</h4>
<p>Yeah, I was wondering if that was an option: make parallel the default and also letting it take advantage of the parallelism.</p>



<a name="162409187"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/187679-t-compiler/wg-parallel-rustc/topic/testing%20and%20binaries%20from%20CI/near/162409187" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> mw <a href="https://zulip-archive.rust-lang.org/stream/187679-t-compiler/wg-parallel-rustc/topic/testing.20and.20binaries.20from.20CI.html#162409187">(Apr 03 2019 at 08:29)</a>:</h4>
<p>but some of the regressions look quite severe. might be a bad interaction with the jobserver?</p>



<a name="162824597"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/187679-t-compiler/wg-parallel-rustc/topic/testing%20and%20binaries%20from%20CI/near/162824597" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Cem Karan <a href="https://zulip-archive.rust-lang.org/stream/187679-t-compiler/wg-parallel-rustc/topic/testing.20and.20binaries.20from.20CI.html#162824597">(Apr 08 2019 at 15:00)</a>:</h4>
<blockquote>
<p><span class="user-mention silent" data-user-id="202560">Cem Karan</span> I'm not sure, but I've pigned <span class="user-mention silent" data-user-id="116466">Zoxc</span> who may know more</p>
</blockquote>
<p><span class="user-mention" data-user-id="116466">@Zoxc</span> Do you know any more about these regressions?  Just curious as to what the cause is...</p>



<a name="162824802"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/187679-t-compiler/wg-parallel-rustc/topic/testing%20and%20binaries%20from%20CI/near/162824802" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Zoxc <a href="https://zulip-archive.rust-lang.org/stream/187679-t-compiler/wg-parallel-rustc/topic/testing.20and.20binaries.20from.20CI.html#162824802">(Apr 08 2019 at 15:03)</a>:</h4>
<p>Swapping <code>RefCell</code> for <code>parking_lot::Mutex</code> is the main cause. Atomic ops are slower</p>



<a name="162829310"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/187679-t-compiler/wg-parallel-rustc/topic/testing%20and%20binaries%20from%20CI/near/162829310" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Cem Karan <a href="https://zulip-archive.rust-lang.org/stream/187679-t-compiler/wg-parallel-rustc/topic/testing.20and.20binaries.20from.20CI.html#162829310">(Apr 08 2019 at 15:53)</a>:</h4>
<p>Got it, thanks.</p>



<a name="162946837"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/187679-t-compiler/wg-parallel-rustc/topic/testing%20and%20binaries%20from%20CI/near/162946837" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/187679-t-compiler/wg-parallel-rustc/topic/testing.20and.20binaries.20from.20CI.html#162946837">(Apr 09 2019 at 20:27)</a>:</h4>
<p>I feel like those percentages... hmm. They are borderline. It may be worth it. It probably depends a bit on how far off we think the actual parallel execution is.</p>



<hr><p>Last updated: Apr 12 2022 at 20:01 UTC</p>
</html>