<html>
<head><meta charset="utf-8"><title>named function types · t-lang · Zulip Chat Archive</title></head>
<h2>Stream: <a href="https://zulip-archive.rust-lang.org/stream/213817-t-lang/index.html">t-lang</a></h2>
<h3>Topic: <a href="https://zulip-archive.rust-lang.org/stream/213817-t-lang/topic/named.20function.20types.html">named function types</a></h3>

<hr>

<base href="https://rust-lang.zulipchat.com">

<head><link href="https://zulip-archive.rust-lang.org/style.css" rel="stylesheet"></head>

<a name="258605023"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/213817-t-lang/topic/named%20function%20types/near/258605023" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/213817-t-lang/topic/named.20function.20types.html#258605023">(Oct 21 2021 at 19:40)</a>:</h4>
<p><span class="user-mention" data-user-id="116883">@tmandry</span> I have a "mostly done" first draft of the named function type RFC:</p>
<p><a href="https://rust-lang.github.io/impl-trait-initiative/RFCs/named-function-types.html">https://rust-lang.github.io/impl-trait-initiative/RFCs/named-function-types.html</a></p>
<p>I am somewhat pleased with this explanation of <a href="https://rust-lang.github.io/impl-trait-initiative/RFCs/named-function-types.html#early-vs-late-binding">early vs late binding</a>.</p>



<a name="258605034"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/213817-t-lang/topic/named%20function%20types/near/258605034" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/213817-t-lang/topic/named.20function.20types.html#258605034">(Oct 21 2021 at 19:40)</a>:</h4>
<p>cc <span class="user-mention" data-user-id="124288">@oli</span>, relevant to impl trait</p>



<a name="258605107"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/213817-t-lang/topic/named%20function%20types/near/258605107" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/213817-t-lang/topic/named.20function.20types.html#258605107">(Oct 21 2021 at 19:41)</a>:</h4>
<p>also cc <span class="user-mention" data-user-id="123856">@Vadim Petrochenkov</span> for feedback on <a href="https://rust-lang.github.io/impl-trait-initiative/RFCs/named-function-types.html#top-level-functions">this section of the shadowing discussion</a></p>



<a name="258606058"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/213817-t-lang/topic/named%20function%20types/near/258606058" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jack Huey <a href="https://zulip-archive.rust-lang.org/stream/213817-t-lang/topic/named.20function.20types.html#258606058">(Oct 21 2021 at 19:48)</a>:</h4>
<blockquote>
<p>Change impl Trait in argument position so that it desugars to "late-bound types"</p>
</blockquote>
<p>Well, that's surprising. I'm imagining some <code>for&lt;T&gt; fn(T)</code>as an example where <code>T</code> would be "late-bound" (though, I'm not sure what this would mean semantically)</p>



<a name="258606178"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/213817-t-lang/topic/named%20function%20types/near/258606178" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/213817-t-lang/topic/named.20function.20types.html#258606178">(Oct 21 2021 at 19:49)</a>:</h4>
<p>I should add some text about this</p>



<a name="258606186"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/213817-t-lang/topic/named%20function%20types/near/258606186" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/213817-t-lang/topic/named.20function.20types.html#258606186">(Oct 21 2021 at 19:49)</a>:</h4>
<p>Note that I didn't change the definition of function <em>pointers</em></p>



<a name="258606225"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/213817-t-lang/topic/named%20function%20types/near/258606225" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/213817-t-lang/topic/named.20function.20types.html#258606225">(Oct 21 2021 at 19:49)</a>:</h4>
<p>I actually think there may be a nice fix for <a href="https://github.com/rust-lang/rust/issues/25680">#25680</a> here</p>



<a name="258606285"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/213817-t-lang/topic/named%20function%20types/near/258606285" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jack Huey <a href="https://zulip-archive.rust-lang.org/stream/213817-t-lang/topic/named.20function.20types.html#258606285">(Oct 21 2021 at 19:50)</a>:</h4>
<blockquote>
<p>For every function my_function, define both a value and a type, except when there is already a type with that name.<br>
As a disambiguator, also export a type fn#my_function that can be used to unambiguously name the fndef type.</p>
</blockquote>
<p>Tbh I think just having fn#my_function would be better and less confusing</p>



<a name="258606301"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/213817-t-lang/topic/named%20function%20types/near/258606301" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/213817-t-lang/topic/named.20function.20types.html#258606301">(Oct 21 2021 at 19:50)</a>:</h4>
<p>Oh, I forgot to remove that</p>



<a name="258606323"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/213817-t-lang/topic/named%20function%20types/near/258606323" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/213817-t-lang/topic/named.20function.20types.html#258606323">(Oct 21 2021 at 19:50)</a>:</h4>
<p>I was planning on just moving towards making shadowing an error in Rust 2024</p>



<a name="258606354"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/213817-t-lang/topic/named%20function%20types/near/258606354" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/213817-t-lang/topic/named.20function.20types.html#258606354">(Oct 21 2021 at 19:50)</a>:</h4>
<p>I don't hate <code>fn#foo</code></p>



<a name="258606367"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/213817-t-lang/topic/named%20function%20types/near/258606367" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/213817-t-lang/topic/named.20function.20types.html#258606367">(Oct 21 2021 at 19:50)</a>:</h4>
<p>I don't love <code>SomeTrait::fn#foo</code></p>



<a name="258606388"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/213817-t-lang/topic/named%20function%20types/near/258606388" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jack Huey <a href="https://zulip-archive.rust-lang.org/stream/213817-t-lang/topic/named.20function.20types.html#258606388">(Oct 21 2021 at 19:50)</a>:</h4>
<p>ew yeah</p>



<a name="258606464"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/213817-t-lang/topic/named%20function%20types/near/258606464" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/213817-t-lang/topic/named.20function.20types.html#258606464">(Oct 21 2021 at 19:51)</a>:</h4>
<p>we could be inconsistent I suppose</p>



<a name="258606634"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/213817-t-lang/topic/named%20function%20types/near/258606634" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jack Huey <a href="https://zulip-archive.rust-lang.org/stream/213817-t-lang/topic/named.20function.20types.html#258606634">(Oct 21 2021 at 19:52)</a>:</h4>
<p>Yeah, I mean, <code>SomeTrait::foo</code> is pretty clear what's going on; <code>foo</code> less so</p>



<a name="258606726"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/213817-t-lang/topic/named%20function%20types/near/258606726" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jack Huey <a href="https://zulip-archive.rust-lang.org/stream/213817-t-lang/topic/named.20function.20types.html#258606726">(Oct 21 2021 at 19:53)</a>:</h4>
<p>I guess, just <code>foo</code> isn't that weird</p>



<a name="258608100"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/213817-t-lang/topic/named%20function%20types/near/258608100" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/213817-t-lang/topic/named.20function.20types.html#258608100">(Oct 21 2021 at 20:02)</a>:</h4>
<p>it's worth noting that top-level fn items are the tricky ones w/r/t backwards compat</p>



<a name="258608123"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/213817-t-lang/topic/named%20function%20types/near/258608123" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/213817-t-lang/topic/named.20function.20types.html#258608123">(Oct 21 2021 at 20:02)</a>:</h4>
<p>so we could just do <code>fn#foo</code> there to make our lives easier and decide in Rust 2024 if we care :)</p>



<a name="258609771"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/213817-t-lang/topic/named%20function%20types/near/258609771" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> scottmcm <a href="https://zulip-archive.rust-lang.org/stream/213817-t-lang/topic/named.20function.20types.html#258609771">(Oct 21 2021 at 20:13)</a>:</h4>
<p>The "unless another type with tha tname already exists" definitely sounded scary to me when I read it.</p>
<p>This sounds like a great place to start with <code>fn#foo</code> and add sugar later.  (Rust 2024 just always having it make a type and an error to conflict sounds interesting, though would be hard to migrate.)</p>



<a name="258611328"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/213817-t-lang/topic/named%20function%20types/near/258611328" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/213817-t-lang/topic/named.20function.20types.html#258611328">(Oct 21 2021 at 20:23)</a>:</h4>
<p><span class="user-mention silent" data-user-id="116009">nikomatsakis</span> <a href="#narrow/stream/213817-t-lang/topic/named.20function.20types/near/258606225">said</a>:</p>
<blockquote>
<p>I actually think there may be a nice fix for <a href="https://github.com/rust-lang/rust/issues/25680">#25680</a> here</p>
</blockquote>
<p>no, I'm wrong (<a href="https://hackmd.io/I7RzhvQMTGKu_DM9yjxj0Q">writeup</a>)</p>



<a name="258612320"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/213817-t-lang/topic/named%20function%20types/near/258612320" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> lqd <a href="https://zulip-archive.rust-lang.org/stream/213817-t-lang/topic/named.20function.20types.html#258612320">(Oct 21 2021 at 20:30)</a>:</h4>
<p>guessing you meant the infamous <a href="https://github.com/rust-lang/rust/issues/25860">#25860</a></p>



<a name="258744556"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/213817-t-lang/topic/named%20function%20types/near/258744556" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> tmandry <a href="https://zulip-archive.rust-lang.org/stream/213817-t-lang/topic/named.20function.20types.html#258744556">(Oct 22 2021 at 17:26)</a>:</h4>
<p>I'm excited about this direction :)</p>



<a name="258744892"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/213817-t-lang/topic/named%20function%20types/near/258744892" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> tmandry <a href="https://zulip-archive.rust-lang.org/stream/213817-t-lang/topic/named.20function.20types.html#258744892">(Oct 22 2021 at 17:28)</a>:</h4>
<p><span class="user-mention silent" data-user-id="125270">scottmcm</span> <a href="#narrow/stream/213817-t-lang/topic/named.20function.20types/near/258609771">said</a>:</p>
<blockquote>
<p>The "unless another type with tha tname already exists" definitely sounded scary to me when I read it.</p>
<p>This sounds like a great place to start with <code>fn#foo</code> and add sugar later.  (Rust 2024 just always having it make a type and an error to conflict sounds interesting, though would be hard to migrate.)</p>
</blockquote>
<p>I would be fine with this for top-level functions, it seems clearer, but I agree with the above sentiments; for traits I really want to avoid having to type <code>SomeTrait::fn#foo</code></p>



<a name="258749051"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/213817-t-lang/topic/named%20function%20types/near/258749051" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> scottmcm <a href="https://zulip-archive.rust-lang.org/stream/213817-t-lang/topic/named.20function.20types.html#258749051">(Oct 22 2021 at 17:59)</a>:</h4>
<p>I guess "unless it already exists" isn't as bad as my first thought.  Because we have the full set of items defined, so it's not some multi-stage process that can be informed by a bunch of things.</p>



<a name="258769058"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/213817-t-lang/topic/named%20function%20types/near/258769058" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Gary Guo <a href="https://zulip-archive.rust-lang.org/stream/213817-t-lang/topic/named.20function.20types.html#258769058">(Oct 22 2021 at 20:22)</a>:</h4>
<p>Why is <code>#</code> needed?</p>



<a name="258769084"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/213817-t-lang/topic/named%20function%20types/near/258769084" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Gary Guo <a href="https://zulip-archive.rust-lang.org/stream/213817-t-lang/topic/named.20function.20types.html#258769084">(Oct 22 2021 at 20:22)</a>:</h4>
<p>Can't use just write <code>fn foo</code>, <code>fn SomeTrait::foo</code>?</p>



<a name="258769135"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/213817-t-lang/topic/named%20function%20types/near/258769135" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Gary Guo <a href="https://zulip-archive.rust-lang.org/stream/213817-t-lang/topic/named.20function.20types.html#258769135">(Oct 22 2021 at 20:23)</a>:</h4>
<p>I think currently the syntax rule expects a <code>(</code> after <code>fn</code>, so this addition should be okay.</p>



<a name="258778909"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/213817-t-lang/topic/named%20function%20types/near/258778909" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> cuviper <a href="https://zulip-archive.rust-lang.org/stream/213817-t-lang/topic/named.20function.20types.html#258778909">(Oct 22 2021 at 21:43)</a>:</h4>
<p>You could have a macro that expects whatever it wants after <code>fn</code>, but <code>fn#foo</code> is reserved in that regard.</p>



<a name="258779442"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/213817-t-lang/topic/named%20function%20types/near/258779442" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> cuviper <a href="https://zulip-archive.rust-lang.org/stream/213817-t-lang/topic/named.20function.20types.html#258779442">(Oct 22 2021 at 21:49)</a>:</h4>
<p>Is the identifier always raw here? e.g. if I have a <code>fn r#fn(...)</code>, would the named type be <code>fn#fn</code>?</p>



<a name="258802148"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/213817-t-lang/topic/named%20function%20types/near/258802148" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Charles Lew <a href="https://zulip-archive.rust-lang.org/stream/213817-t-lang/topic/named.20function.20types.html#258802148">(Oct 23 2021 at 04:13)</a>:</h4>
<p>I like this approach in general, but there's a small thing though:  <code>dyn Trait</code> types currently must get all associated types specified, if associated functions have their types as associated types, this rule needs to be tweaked a little, i think. This will also affect the dyn safety checking.</p>



<a name="258823075"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/213817-t-lang/topic/named%20function%20types/near/258823075" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Vadim Petrochenkov <a href="https://zulip-archive.rust-lang.org/stream/213817-t-lang/topic/named.20function.20types.html#258823075">(Oct 23 2021 at 13:23)</a>:</h4>
<p>Sorry, can't check the proposal right now, but I'll certainly do it some time during the upcoming week.<br>
The summary looks like something from the "over my dead body" category.</p>



<a name="258835777"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/213817-t-lang/topic/named%20function%20types/near/258835777" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Daniel Henry-Mantilla <a href="https://zulip-archive.rust-lang.org/stream/213817-t-lang/topic/named.20function.20types.html#258835777">(Oct 23 2021 at 18:08)</a>:</h4>
<p><span class="user-mention silent" data-user-id="138448">cuviper</span> <a href="#narrow/stream/213817-t-lang/topic/named.20function.20types/near/258778909">said</a>:</p>
<blockquote>
<p>You could have a macro that expects whatever it wants after <code>fn</code>, but <code>fn#foo</code> is reserved in that regard.</p>
</blockquote>
<p>I don't see how that is a problem? <code>fn</code>, here, could be perceived as some kind of scope-reduced <code>typeof</code>, whereby fetching the type of a given function "item" (even if just implemented as a namespace disambiguator)</p>
<hr>
<p>The proposal looks quite nice; I'm just a bit worried by the "having an actual equally named type to be hard error" to be an <em>extremely</em> harsh policy, even for a new edition. We'd have to see how it happens in practice, but I'd expect to be using <code>edition_2021! { … }</code> or something similar to sometimes opt out of that restriction, since I vaguely recall having needed to define functions with eponymous types</p>



<a name="258958232"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/213817-t-lang/topic/named%20function%20types/near/258958232" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Waffle Lapkin <a href="https://zulip-archive.rust-lang.org/stream/213817-t-lang/topic/named.20function.20types.html#258958232">(Oct 25 2021 at 13:25)</a>:</h4>
<p><a href="/user_uploads/4715/qV7g2C5B-qxYNedRnTipepn-/image.png">image.png</a> </p>
<div class="message_inline_image"><a href="/user_uploads/4715/qV7g2C5B-qxYNedRnTipepn-/image.png" title="image.png"><img src="/user_uploads/4715/qV7g2C5B-qxYNedRnTipepn-/image.png"></a></div><p>Does this mean that <code>fn#Foo</code> also won't work? If so, then why? And if no, I think the wording can be improved...</p>



<a name="258959241"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/213817-t-lang/topic/named%20function%20types/near/258959241" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Waffle Lapkin <a href="https://zulip-archive.rust-lang.org/stream/213817-t-lang/topic/named.20function.20types.html#258959241">(Oct 25 2021 at 13:33)</a>:</h4>
<p><a href="https://rust-lang.github.io/impl-trait-initiative/RFCs/named-function-types.html#traits-and-trait-impls">Traits and trait impls</a> is a little confusing. Especially the <code>baz</code> part -- it's easy to mix up it with <code>bar</code> and it seems like there is a typo in the comment:</p>
<blockquote>
<p><div class="codehilite" data-code-language="Rust"><pre><span></span><code><span class="w">    </span><span class="c1">// The `Bar` supertrait defines an associated type `baz`, but implicitly:</span>
<span class="w">    </span><span class="c1">//</span>
<span class="w">    </span><span class="c1">// generate an associated type `baz.`</span>
<span class="w">    </span><span class="k">fn</span> <span class="nf">baz</span><span class="p">(</span><span class="o">&amp;</span><span class="bp">self</span><span class="p">);</span><span class="w"></span>
</code></pre></div><br>
</p>
</blockquote>
<p><code>Bar</code> supertrait doesn't explicitly define <code>baz</code> type, so maybe it should be something like </p>
<blockquote>
<p>The <code>Bar</code> supertrait defines an associated <strong>fn</strong> <code>baz</code> <strong>and</strong> implicitly generate<strong>s</strong> an associated type <code>baz.</code></p>
<p>nothing is generated for the <code>fn bar</code> here.</p>
</blockquote>
<p>?</p>



<a name="258965837"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/213817-t-lang/topic/named%20function%20types/near/258965837" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> cuviper <a href="https://zulip-archive.rust-lang.org/stream/213817-t-lang/topic/named.20function.20types.html#258965837">(Oct 25 2021 at 14:22)</a>:</h4>
<p><span class="user-mention" data-user-id="232018">@Daniel Henry-Mantilla</span>, the macro issue is that someone could have two patterns, first for <code>$foo:ty</code> and second for <code>fn $foo:ident</code>. If we give new meaning to <code>fn foo</code> as a type, then we won't get to the second pattern anymore.</p>



<a name="258965893"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/213817-t-lang/topic/named%20function%20types/near/258965893" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> cuviper <a href="https://zulip-archive.rust-lang.org/stream/213817-t-lang/topic/named.20function.20types.html#258965893">(Oct 25 2021 at 14:22)</a>:</h4>
<p>We can try to rule that out with crater, but it's a risk.</p>



<a name="258968925"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/213817-t-lang/topic/named%20function%20types/near/258968925" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Gary Guo <a href="https://zulip-archive.rust-lang.org/stream/213817-t-lang/topic/named.20function.20types.html#258968925">(Oct 25 2021 at 14:44)</a>:</h4>
<p>Wouldn't it be the same situation for any syntax addition?</p>



<a name="258973030"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/213817-t-lang/topic/named%20function%20types/near/258973030" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> cuviper <a href="https://zulip-archive.rust-lang.org/stream/213817-t-lang/topic/named.20function.20types.html#258973030">(Oct 25 2021 at 15:09)</a>:</h4>
<p>2021 has reserved syntax, refusing to tokenize <code>any_ident#</code> at all, exactly so we can add things like this. If you want to use <code>fn#</code> in a macro now, you have to add whitespace.</p>



<a name="258973316"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/213817-t-lang/topic/named%20function%20types/near/258973316" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> cuviper <a href="https://zulip-archive.rust-lang.org/stream/213817-t-lang/topic/named.20function.20types.html#258973316">(Oct 25 2021 at 15:11)</a>:</h4>
<p>Raw identifiers lucked into a similar situation, because <code>r#</code> was previously only allowed to tokenize as the start of a raw string.</p>



<a name="258977280"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/213817-t-lang/topic/named%20function%20types/near/258977280" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Daniel Henry-Mantilla <a href="https://zulip-archive.rust-lang.org/stream/213817-t-lang/topic/named.20function.20types.html#258977280">(Oct 25 2021 at 15:36)</a>:</h4>
<p>I'm pretty sure that since <code>fn</code> is already a valid prefix of a type (<em>e.g.</em>, with <code>fn()</code>), this cannot happen with <code>$:ty</code> (<a href="https://play.rust-lang.org/?version=stable&amp;mode=debug&amp;edition=2021&amp;gist=84b4918649fe5ead098ec06f5ff48543">Demo</a>). And perhaps even more surprisingly, the problem doesn't occur with <code>$:path</code> either (which would have been one to look for)</p>



<a name="258981723"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/213817-t-lang/topic/named%20function%20types/near/258981723" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> simulacrum <a href="https://zulip-archive.rust-lang.org/stream/213817-t-lang/topic/named.20function.20types.html#258981723">(Oct 25 2021 at 16:07)</a>:</h4>
<p>One thought I just had about this proposal: it seems worth considering whether it would need trickery for any future extensions to the trait system which permit overlapping trait impls or similar for traits with all methods that are uncallable (e.g., ones that can never be called due to taking <code>&amp;self</code> where Self is <code>!</code>).</p>
<p>At a naive glance such an extension would mean that there's two separate source code definitions for what has to under the hood be the same type. I think today we don't run into trouble due to #[marker] traits needing to be literally empty, but we may not want that to hold eventually.</p>



<a name="258984127"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/213817-t-lang/topic/named%20function%20types/near/258984127" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> cuviper <a href="https://zulip-archive.rust-lang.org/stream/213817-t-lang/topic/named.20function.20types.html#258984127">(Oct 25 2021 at 16:24)</a>:</h4>
<p>Oh interesting, I didn't realize that little bit of function pointer syntax would force it to match <code>:ty</code> only.</p>



<a name="259020305"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/213817-t-lang/topic/named%20function%20types/near/259020305" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> tmandry <a href="https://zulip-archive.rust-lang.org/stream/213817-t-lang/topic/named.20function.20types.html#259020305">(Oct 25 2021 at 21:03)</a>:</h4>
<p>One of the use cases of this proposal is making it possible to bound output lifetimes. While <code>fn</code> might work by itself, I think it looks extremely confusing to have a space in the middle of a path:</p>
<div class="codehilite" data-code-language="Rust"><pre><span></span><code><span class="k">where</span><span class="w"> </span><span class="o">&lt;</span><span class="n">T</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">SomeTrait</span><span class="o">&gt;</span>::<span class="k">fn</span> <span class="nf">foo</span>::<span class="n">Output</span>: <span class="nb">Send</span>
</code></pre></div>



<a name="259020535"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/213817-t-lang/topic/named%20function%20types/near/259020535" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> tmandry <a href="https://zulip-archive.rust-lang.org/stream/213817-t-lang/topic/named.20function.20types.html#259020535">(Oct 25 2021 at 21:05)</a>:</h4>
<p>Of course the goal is to not have to write this <code>fn</code> or <code>fn#</code> in normal code, hence creating an associated type of the same name as the function when we can.</p>



<a name="259020714"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/213817-t-lang/topic/named%20function%20types/near/259020714" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> tmandry <a href="https://zulip-archive.rust-lang.org/stream/213817-t-lang/topic/named.20function.20types.html#259020714">(Oct 25 2021 at 21:07)</a>:</h4>
<p>Another thing we can potentially use this for: bounding functions by <code>const</code></p>



<a name="259020968"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/213817-t-lang/topic/named%20function%20types/near/259020968" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> tmandry <a href="https://zulip-archive.rust-lang.org/stream/213817-t-lang/topic/named.20function.20types.html#259020968">(Oct 25 2021 at 21:08)</a>:</h4>
<div class="codehilite" data-code-language="Rust"><pre><span></span><code><span class="k">const</span><span class="w"> </span><span class="k">fn</span> <span class="nf">takes_foo</span><span class="o">&lt;</span><span class="n">T</span>: <span class="nc">Foo</span><span class="o">&gt;</span><span class="p">(</span><span class="n">x</span>: <span class="nc">T</span><span class="p">)</span><span class="w"> </span><span class="k">where</span><span class="w"> </span><span class="n">T</span>::<span class="n">foo</span>: <span class="nc">const</span><span class="w"> </span><span class="p">{}</span><span class="w"></span>
</code></pre></div>



<a name="259021159"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/213817-t-lang/topic/named%20function%20types/near/259021159" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> tmandry <a href="https://zulip-archive.rust-lang.org/stream/213817-t-lang/topic/named.20function.20types.html#259021159">(Oct 25 2021 at 21:10)</a>:</h4>
<p>We'd still want some way of stating implications (this function is const if another function is const), but this is one of the pieces of the puzzle, I think</p>



<a name="259021950"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/213817-t-lang/topic/named%20function%20types/near/259021950" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Gary Guo <a href="https://zulip-archive.rust-lang.org/stream/213817-t-lang/topic/named.20function.20types.html#259021950">(Oct 25 2021 at 21:17)</a>:</h4>
<p><span class="user-mention silent" data-user-id="116883">tmandry</span> <a href="#narrow/stream/213817-t-lang/topic/named.20function.20types/near/259020305">said</a>:</p>
<blockquote>
<p>One of the use cases of this proposal is making it possible to bound output lifetimes. While <code>fn</code> might work by itself, I think it looks extremely confusing to have a space in the middle of a path:</p>
<p><div class="codehilite" data-code-language="Rust"><pre><span></span><code><span class="k">where</span><span class="w"> </span><span class="o">&lt;</span><span class="n">T</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">SomeTrait</span><span class="o">&gt;</span>::<span class="k">fn</span> <span class="nf">foo</span>::<span class="n">Output</span>: <span class="nb">Send</span>
</code></pre></div><br>
</p>
</blockquote>
<p>Could be <code>where (fn &lt;T as SomeTrait&gt;::foo)::Output: Send</code></p>



<a name="259081252"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/213817-t-lang/topic/named%20function%20types/near/259081252" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Daniel Henry-Mantilla <a href="https://zulip-archive.rust-lang.org/stream/213817-t-lang/topic/named.20function.20types.html#259081252">(Oct 26 2021 at 11:12)</a>:</h4>
<p>Exactly! (but for using angle brackets to get <code>Output</code>)</p>
<div class="codehilite" data-code-language="Rust"><pre><span></span><code><span class="k">where</span><span class="w"></span>
<span class="w">    </span><span class="o">&lt;</span><span class="k">fn</span> <span class="o">&lt;</span><span class="n">T</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">SomeTrait</span><span class="o">&gt;</span>::<span class="n">foo</span><span class="o">&gt;</span>::<span class="n">Output</span><span class="w"> </span>: <span class="nb">Send</span><span class="p">,</span><span class="w"></span>
<span class="c1">// or.</span>
<span class="w">    </span><span class="o">&lt;</span><span class="n">T</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">SomeTrait</span><span class="o">&gt;</span>::<span class="k">fn</span>#<span class="n">foo</span>::<span class="n">Output</span><span class="w"> </span>: <span class="nb">Send</span><span class="p">,</span><span class="w"></span>
</code></pre></div>
<p>As I mentioned, the "leading <code>fn </code> syntax" would just be featuring the same syntax as that of <code>typeof</code>, but for the restricted targets, and being implemented as a namespace shenanigan.</p>
<p>Incidentally, I'd love to see <code>fn() { foo }</code> in diagnostics become <code>fn foo</code>, with the latter being actual Rust <span aria-label="smile" class="emoji emoji-1f642" role="img" title="smile">:smile:</span> </p>
<p><span class="user-mention silent" data-user-id="116883">tmandry</span> <a href="#narrow/stream/213817-t-lang/topic/named.20function.20types/near/259021159">said</a>:</p>
<blockquote>
<p>We'd still want some way of stating implications (this function is const if another function is const), but this is one of the pieces of the puzzle, I think</p>
</blockquote>
<div class="codehilite" data-code-language="Rust"><pre><span></span><code><span class="k">where</span><span class="w"></span>
<span class="w">    </span><span class="k">fn</span> <span class="nf">T</span>::<span class="n">foo</span>: <span class="o">~</span><span class="k">const</span><span class="p">,</span><span class="w"></span>
<span class="c1">// or</span>
<span class="w">    </span><span class="n">T</span>::<span class="k">fn</span>#<span class="n">foo</span>: <span class="o">~</span><span class="k">const</span><span class="p">,</span><span class="w"></span>
</code></pre></div>
<p>?</p>



<a name="259085092"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/213817-t-lang/topic/named%20function%20types/near/259085092" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mario Carneiro <a href="https://zulip-archive.rust-lang.org/stream/213817-t-lang/topic/named.20function.20types.html#259085092">(Oct 26 2021 at 11:56)</a>:</h4>
<p><span class="user-mention silent" data-user-id="232018">Daniel Henry-Mantilla</span> <a href="#narrow/stream/213817-t-lang/topic/named.20function.20types/near/259081252">said</a>:</p>
<blockquote>
<p>Incidentally, I'd love to see <code>fn() { foo }</code> in diagnostics become <code>fn foo</code>, with the latter being actual Rust <span aria-label="smile" class="emoji emoji-1f642" role="img" title="smile">:smile:</span> </p>
</blockquote>
<p>One downside of this is that you will lose the type of the function in the printout. Although I have seen folks getting confused by type errors like <code>expected type "fn(int) -&gt; int", got type "fn(int) -&gt; int {foo}"</code> (where they miss or are confused by the <code>{foo}</code> and think that it should not be a type error), and <code>expected type "fn(int) -&gt; int", got type "fn foo"</code> will probably be confusing in a different way</p>



<a name="259107941"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/213817-t-lang/topic/named%20function%20types/near/259107941" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/213817-t-lang/topic/named.20function.20types.html#259107941">(Oct 26 2021 at 14:49)</a>:</h4>
<p>The <code>fn foo</code> syntax is interesting. I feel like the <code>fn</code> keyword might help people to learn what is going on.</p>



<a name="259107966"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/213817-t-lang/topic/named%20function%20types/near/259107966" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/213817-t-lang/topic/named.20function.20types.html#259107966">(Oct 26 2021 at 14:49)</a>:</h4>
<p>I'm not sure about <code>&lt;fn T::foo&gt;::Output</code></p>



<a name="259108070"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/213817-t-lang/topic/named%20function%20types/near/259108070" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/213817-t-lang/topic/named.20function.20types.html#259108070">(Oct 26 2021 at 14:50)</a>:</h4>
<p>I definitely think having a syntax we can print in errors is a big plus from this proposal.</p>



<a name="259108155"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/213817-t-lang/topic/named%20function%20types/near/259108155" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/213817-t-lang/topic/named.20function.20types.html#259108155">(Oct 26 2021 at 14:51)</a>:</h4>
<p>I was not happy about the name resolution implications of the current proposal, so I see <code>fn &lt;path&gt;</code> as having an advantage there</p>



<a name="259108182"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/213817-t-lang/topic/named%20function%20types/near/259108182" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/213817-t-lang/topic/named.20function.20types.html#259108182">(Oct 26 2021 at 14:51)</a>:</h4>
<p>I feel like a postfix syntax would be better :) but ...</p>



<a name="259108192"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/213817-t-lang/topic/named%20function%20types/near/259108192" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/213817-t-lang/topic/named.20function.20types.html#259108192">(Oct 26 2021 at 14:51)</a>:</h4>
<p><code>foo::fn</code>... not so sure about <em>that</em></p>



<a name="259225810"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/213817-t-lang/topic/named%20function%20types/near/259225810" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> kennytm <a href="https://zulip-archive.rust-lang.org/stream/213817-t-lang/topic/named.20function.20types.html#259225810">(Oct 27 2021 at 11:41)</a>:</h4>
<p>oh by "postfix" i thought you meant <code>foo#fn</code></p>



<a name="259232031"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/213817-t-lang/topic/named%20function%20types/near/259232031" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Connor Horman <a href="https://zulip-archive.rust-lang.org/stream/213817-t-lang/topic/named.20function.20types.html#259232031">(Oct 27 2021 at 12:41)</a>:</h4>
<p>postfix <code>#fn</code> wouldn't work - it would conflict with raw identifiers and reserved keywords for functions named <code>r</code> and <code>k</code> respectively.</p>



<a name="259238500"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/213817-t-lang/topic/named%20function%20types/near/259238500" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> oli <a href="https://zulip-archive.rust-lang.org/stream/213817-t-lang/topic/named.20function.20types.html#259238500">(Oct 27 2021 at 13:31)</a>:</h4>
<p>one alternative I haven't seen yet is to use <code>T::foo::fn</code>, <code>&lt;T as Trait&gt;::method::fn</code> and <code>bar::fn</code> as the path to the function type</p>



<a name="259240342"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/213817-t-lang/topic/named%20function%20types/near/259240342" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Josh Triplett <a href="https://zulip-archive.rust-lang.org/stream/213817-t-lang/topic/named.20function.20types.html#259240342">(Oct 27 2021 at 13:43)</a>:</h4>
<p>I like that idea, especially if you can get to the arguments and return type that way.</p>



<a name="259253632"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/213817-t-lang/topic/named%20function%20types/near/259253632" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/213817-t-lang/topic/named.20function.20types.html#259253632">(Oct 27 2021 at 15:05)</a>:</h4>
<p>yeah, postfix <code>fn</code> is interesting</p>



<a name="259253657"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/213817-t-lang/topic/named%20function%20types/near/259253657" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/213817-t-lang/topic/named.20function.20types.html#259253657">(Oct 27 2021 at 15:05)</a>:</h4>
<p><code>foo::fn::Output</code></p>



<a name="259253681"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/213817-t-lang/topic/named%20function%20types/near/259253681" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/213817-t-lang/topic/named.20function.20types.html#259253681">(Oct 27 2021 at 15:05)</a>:</h4>
<p>we could even make <code>foo::return</code> as a "shorthand sugar" for that, I suppose</p>



<a name="259253694"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/213817-t-lang/topic/named%20function%20types/near/259253694" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/213817-t-lang/topic/named.20function.20types.html#259253694">(Oct 27 2021 at 15:05)</a>:</h4>
<p>one other thing....</p>



<a name="259253865"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/213817-t-lang/topic/named%20function%20types/near/259253865" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/213817-t-lang/topic/named.20function.20types.html#259253865">(Oct 27 2021 at 15:06)</a>:</h4>
<p>I didn't extend the RFC to talk about it yet, but I think that we will sometimes wind up with wanting to writing something like <code>&lt;foo::fn as FnOnce(T1, T2)&gt;::Output</code> -- i.e., specify types of the arguments <code>T1</code> and <code>T2</code></p>



<a name="259253917"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/213817-t-lang/topic/named%20function%20types/near/259253917" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/213817-t-lang/topic/named.20function.20types.html#259253917">(Oct 27 2021 at 15:06)</a>:</h4>
<p>given <code>fn</code>, we could have a sugar for that, e.g. <code>foo::fn(T1, T2)</code></p>



<a name="259253957"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/213817-t-lang/topic/named%20function%20types/near/259253957" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/213817-t-lang/topic/named.20function.20types.html#259253957">(Oct 27 2021 at 15:07)</a>:</h4>
<p>this is useful if there are late-bound types</p>



<a name="259254029"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/213817-t-lang/topic/named%20function%20types/near/259254029" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/213817-t-lang/topic/named.20function.20types.html#259254029">(Oct 27 2021 at 15:07)</a>:</h4>
<p>probably need to make a little hackmd with all the syntaxes</p>



<a name="259254183"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/213817-t-lang/topic/named%20function%20types/near/259254183" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mario Carneiro <a href="https://zulip-archive.rust-lang.org/stream/213817-t-lang/topic/named.20function.20types.html#259254183">(Oct 27 2021 at 15:08)</a>:</h4>
<p>This is only useful for "late bound types", right? Since early bound types will be earlier in the path</p>



<a name="259254226"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/213817-t-lang/topic/named%20function%20types/near/259254226" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/213817-t-lang/topic/named.20function.20types.html#259254226">(Oct 27 2021 at 15:08)</a>:</h4>
<p>it is only needed for late-bound types, at least</p>



<a name="259254238"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/213817-t-lang/topic/named%20function%20types/near/259254238" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/213817-t-lang/topic/named.20function.20types.html#259254238">(Oct 27 2021 at 15:08)</a>:</h4>
<p>it may be useful elsewhere</p>



<a name="259254286"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/213817-t-lang/topic/named%20function%20types/near/259254286" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/213817-t-lang/topic/named.20function.20types.html#259254286">(Oct 27 2021 at 15:09)</a>:</h4>
<p>depending how generous we want to get with inference, I guess</p>



<a name="259254317"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/213817-t-lang/topic/named%20function%20types/near/259254317" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/213817-t-lang/topic/named.20function.20types.html#259254317">(Oct 27 2021 at 15:09)</a>:</h4>
<p><a href="https://hackmd.io/WQUfas2jSiaeIv6EBPgtew">named function type alternatives</a></p>



<a name="259258187"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/213817-t-lang/topic/named%20function%20types/near/259258187" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/213817-t-lang/topic/named.20function.20types.html#259258187">(Oct 27 2021 at 15:33)</a>:</h4>
<p>anybody see anything missing from the above chart? <span aria-label="point up" class="emoji emoji-1f446" role="img" title="point up">:point_up:</span></p>



<a name="259259530"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/213817-t-lang/topic/named%20function%20types/near/259259530" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> The 8472 <a href="https://zulip-archive.rust-lang.org/stream/213817-t-lang/topic/named.20function.20types.html#259259530">(Oct 27 2021 at 15:42)</a>:</h4>
<p><code>Trait::fn::foo</code> to access the fn namespace.</p>



<a name="259259983"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/213817-t-lang/topic/named%20function%20types/near/259259983" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> The 8472 <a href="https://zulip-archive.rust-lang.org/stream/213817-t-lang/topic/named.20function.20types.html#259259983">(Oct 27 2021 at 15:45)</a>:</h4>
<p>It's the same as the hash prefix one except that using # instead of :: doesn't seem necessary because fn already is a keyword and can't be used for path components.</p>



<a name="259260486"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/213817-t-lang/topic/named%20function%20types/near/259260486" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/213817-t-lang/topic/named.20function.20types.html#259260486">(Oct 27 2021 at 15:49)</a>:</h4>
<p>added it</p>



<a name="259272184"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/213817-t-lang/topic/named%20function%20types/near/259272184" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Gary Guo <a href="https://zulip-archive.rust-lang.org/stream/213817-t-lang/topic/named.20function.20types.html#259272184">(Oct 27 2021 at 17:05)</a>:</h4>
<p><code>typeof foo</code> could use turbofish to specify args, right? <code>(typeof foo::&lt;T&gt;)::Output</code></p>



<a name="259272311"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/213817-t-lang/topic/named%20function%20types/near/259272311" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Gary Guo <a href="https://zulip-archive.rust-lang.org/stream/213817-t-lang/topic/named.20function.20types.html#259272311">(Oct 27 2021 at 17:06)</a>:</h4>
<p>Or maybe <code>&lt;(typeof foo) as FnOnce(T1, T2)&gt;::Output</code></p>



<a name="259275223"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/213817-t-lang/topic/named%20function%20types/near/259275223" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> kennytm <a href="https://zulip-archive.rust-lang.org/stream/213817-t-lang/topic/named.20function.20types.html#259275223">(Oct 27 2021 at 17:25)</a>:</h4>
<p>i think you'll write <code>&lt;typeof foo&gt;::Output</code> in the same way you'll need <code>&lt;(u8,)&gt;::stuff</code></p>
<p>or maybe <code>typeof&lt;{foo}&gt;::Output</code></p>



<a name="259279983"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/213817-t-lang/topic/named%20function%20types/near/259279983" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jack Wrenn <a href="https://zulip-archive.rust-lang.org/stream/213817-t-lang/topic/named.20function.20types.html#259279983">(Oct 27 2021 at 17:58)</a>:</h4>
<p>does <code>typeof</code> address the ambiguity issue? e.g., what's the type of <code>Bar</code>:</p>
<div class="codehilite" data-code-language="Rust"><pre><span></span><code><span class="k">pub</span><span class="w"> </span><span class="k">struct</span> <span class="nc">foo</span><span class="p">{}</span><span class="w"></span>
<span class="k">pub</span><span class="w"> </span><span class="k">fn</span> <span class="nf">foo</span><span class="p">()</span><span class="w"> </span><span class="p">{}</span><span class="w"></span>

<span class="k">type</span> <span class="nc">Bar</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kr">typeof</span><span class="w"> </span><span class="n">foo</span><span class="p">;</span><span class="w"></span>
</code></pre></div>



<a name="259282490"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/213817-t-lang/topic/named%20function%20types/near/259282490" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> kennytm <a href="https://zulip-archive.rust-lang.org/stream/213817-t-lang/topic/named.20function.20types.html#259282490">(Oct 27 2021 at 18:14)</a>:</h4>
<p>the input to <code>typeof</code> is an expression, it is definitely referring to the function.</p>



<a name="259430730"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/213817-t-lang/topic/named%20function%20types/near/259430730" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Daniel Henry-Mantilla <a href="https://zulip-archive.rust-lang.org/stream/213817-t-lang/topic/named.20function.20types.html#259430730">(Oct 28 2021 at 18:19)</a>:</h4>
<p><span class="user-mention silent" data-user-id="330154">The 8472</span> <a href="#narrow/stream/213817-t-lang/topic/named.20function.20types/near/259259983">said</a>:</p>
<blockquote>
<p>It's the same as the hash prefix one except that using # instead of :: doesn't seem necessary because fn already is a keyword and can't be used for path components.</p>
</blockquote>
<p>Nice find! This is actually my favorite proposal</p>



<a name="259871564"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/213817-t-lang/topic/named%20function%20types/near/259871564" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/213817-t-lang/topic/named.20function.20types.html#259871564">(Nov 01 2021 at 14:38)</a>:</h4>
<p>Having given this some thought, I think I've come to prefer "fn path prefix" (e.g., <code>fn::foo</code>)</p>



<a name="259871598"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/213817-t-lang/topic/named%20function%20types/near/259871598" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/213817-t-lang/topic/named.20function.20types.html#259871598">(Nov 01 2021 at 14:39)</a>:</h4>
<p>I like that it is syntactically distinct, which I think will help people to understand what this is</p>



<a name="259871605"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/213817-t-lang/topic/named%20function%20types/near/259871605" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/213817-t-lang/topic/named.20function.20types.html#259871605">(Nov 01 2021 at 14:39)</a>:</h4>
<p>("what is a <code>fn::X</code> type?")</p>



<a name="259871636"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/213817-t-lang/topic/named%20function%20types/near/259871636" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Josh Triplett <a href="https://zulip-archive.rust-lang.org/stream/213817-t-lang/topic/named.20function.20types.html#259871636">(Nov 01 2021 at 14:39)</a>:</h4>
<p><span class="user-mention" data-user-id="116009">@nikomatsakis</span> I'm a little concerned that that could mean something else: the function-level scope, which we might potentially provide access to.</p>



<a name="259871639"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/213817-t-lang/topic/named%20function%20types/near/259871639" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/213817-t-lang/topic/named.20function.20types.html#259871639">(Nov 01 2021 at 14:39)</a>:</h4>
<p>I also like that it has a kind of "intuitive" feeling like <code>Trait::fn</code> is kind of a "view" on <code>Trait</code> that contains "the fns in the trait"</p>



<a name="259871677"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/213817-t-lang/topic/named%20function%20types/near/259871677" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Josh Triplett <a href="https://zulip-archive.rust-lang.org/stream/213817-t-lang/topic/named.20function.20types.html#259871677">(Nov 01 2021 at 14:39)</a>:</h4>
<p>Consider the possibility of disambiguating scopes when you declare a function within a function.</p>



<a name="259871692"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/213817-t-lang/topic/named%20function%20types/near/259871692" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/213817-t-lang/topic/named.20function.20types.html#259871692">(Nov 01 2021 at 14:40)</a>:</h4>
<p>This could be useful for other things we've thought about, such as being able to <code>where </code>&lt;T as Trait&gt;::fn::*::Output: Send`</p>



<a name="259871732"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/213817-t-lang/topic/named%20function%20types/near/259871732" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Josh Triplett <a href="https://zulip-archive.rust-lang.org/stream/213817-t-lang/topic/named.20function.20types.html#259871732">(Nov 01 2021 at 14:40)</a>:</h4>
<p>It <em>feels</em> like a parallel to <code>crate::</code> and <code>self::</code> and <code>super::</code>.</p>



<a name="259871738"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/213817-t-lang/topic/named%20function%20types/near/259871738" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/213817-t-lang/topic/named.20function.20types.html#259871738">(Nov 01 2021 at 14:40)</a>:</h4>
<p>That's true</p>



<a name="259871746"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/213817-t-lang/topic/named%20function%20types/near/259871746" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/213817-t-lang/topic/named.20function.20types.html#259871746">(Nov 01 2021 at 14:40)</a>:</h4>
<p>That's a downside :)</p>



<a name="259871773"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/213817-t-lang/topic/named%20function%20types/near/259871773" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Josh Triplett <a href="https://zulip-archive.rust-lang.org/stream/213817-t-lang/topic/named.20function.20types.html#259871773">(Nov 01 2021 at 14:40)</a>:</h4>
<p>I'm not saying we <em>shouldn't</em> use it for this, but we should consider if we never want a scope named <code>fn</code>.</p>



<a name="259871817"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/213817-t-lang/topic/named%20function%20types/near/259871817" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Josh Triplett <a href="https://zulip-archive.rust-lang.org/stream/213817-t-lang/topic/named.20function.20types.html#259871817">(Nov 01 2021 at 14:40)</a>:</h4>
<p>That's not a problem for something like <code>Trait::fn::...</code></p>



<a name="259871829"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/213817-t-lang/topic/named%20function%20types/near/259871829" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Josh Triplett <a href="https://zulip-archive.rust-lang.org/stream/213817-t-lang/topic/named.20function.20types.html#259871829">(Nov 01 2021 at 14:40)</a>:</h4>
<p>Just for a <code>fn::</code> that starts a path.</p>



<a name="259871837"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/213817-t-lang/topic/named%20function%20types/near/259871837" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/213817-t-lang/topic/named.20function.20types.html#259871837">(Nov 01 2021 at 14:41)</a>:</h4>
<p>I guess that <code>fn#</code> could be used in the same way</p>



<a name="259871840"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/213817-t-lang/topic/named%20function%20types/near/259871840" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/213817-t-lang/topic/named.20function.20types.html#259871840">(Nov 01 2021 at 14:41)</a>:</h4>
<p><code>Trait::fn#*::Output</code></p>



<a name="259871848"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/213817-t-lang/topic/named%20function%20types/near/259871848" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/213817-t-lang/topic/named.20function.20types.html#259871848">(Nov 01 2021 at 14:41)</a>:</h4>
<p>it's just "line-noisy"</p>



<a name="259871877"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/213817-t-lang/topic/named%20function%20types/near/259871877" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Josh Triplett <a href="https://zulip-archive.rust-lang.org/stream/213817-t-lang/topic/named.20function.20types.html#259871877">(Nov 01 2021 at 14:41)</a>:</h4>
<p>I don't think that's necessary. <code>Trait::fn::...::Output</code> is unambiguous.</p>



<a name="259871880"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/213817-t-lang/topic/named%20function%20types/near/259871880" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/213817-t-lang/topic/named.20function.20types.html#259871880">(Nov 01 2021 at 14:41)</a>:</h4>
<p>but in a way it "groups" better</p>



<a name="259871892"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/213817-t-lang/topic/named%20function%20types/near/259871892" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/213817-t-lang/topic/named.20function.20types.html#259871892">(Nov 01 2021 at 14:41)</a>:</h4>
<p><span class="user-mention" data-user-id="239881">@Josh Triplett</span> sure, but I'd like to have uniformity</p>



<a name="259871932"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/213817-t-lang/topic/named%20function%20types/near/259871932" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/213817-t-lang/topic/named.20function.20types.html#259871932">(Nov 01 2021 at 14:42)</a>:</h4>
<p>I don't think that using <code>Trait::fn::foo</code> for methods of a trait but something else for the types of free functions makes sense</p>



<a name="259871997"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/213817-t-lang/topic/named%20function%20types/near/259871997" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/213817-t-lang/topic/named.20function.20types.html#259871997">(Nov 01 2021 at 14:42)</a>:</h4>
<p>or, if we were going to do that, I'd probably make traits use <em>no</em> prefix</p>



<a name="259872006"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/213817-t-lang/topic/named%20function%20types/near/259872006" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/213817-t-lang/topic/named.20function.20types.html#259872006">(Nov 01 2021 at 14:42)</a>:</h4>
<p><del>e.g., <code>Trait::fn</code></del></p>
<p>e.g., <code>Trait::some_fn</code></p>



<a name="259872032"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/213817-t-lang/topic/named%20function%20types/near/259872032" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Josh Triplett <a href="https://zulip-archive.rust-lang.org/stream/213817-t-lang/topic/named.20function.20types.html#259872032">(Nov 01 2021 at 14:42)</a>:</h4>
<p>Do you mean <code>Trait::foo</code>?</p>



<a name="259872054"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/213817-t-lang/topic/named%20function%20types/near/259872054" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/213817-t-lang/topic/named.20function.20types.html#259872054">(Nov 01 2021 at 14:42)</a>:</h4>
<p>yes, sorry</p>



<a name="259872080"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/213817-t-lang/topic/named%20function%20types/near/259872080" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Josh Triplett <a href="https://zulip-archive.rust-lang.org/stream/213817-t-lang/topic/named.20function.20types.html#259872080">(Nov 01 2021 at 14:43)</a>:</h4>
<p>For uniformity, I kinda like <code>Trait::foo::fn</code> and <code>foo::fn</code>.</p>



<a name="259872122"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/213817-t-lang/topic/named%20function%20types/near/259872122" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/213817-t-lang/topic/named.20function.20types.html#259872122">(Nov 01 2021 at 14:43)</a>:</h4>
<p>that feels strange to me, because <code>x::y</code> usually means that "y is based on x"</p>



<a name="259872170"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/213817-t-lang/topic/named%20function%20types/near/259872170" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Josh Triplett <a href="https://zulip-archive.rust-lang.org/stream/213817-t-lang/topic/named.20function.20types.html#259872170">(Nov 01 2021 at 14:43)</a>:</h4>
<p>"Look at Trait, look at the foo function of Trait, look at the function type of foo".</p>



<a name="259872246"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/213817-t-lang/topic/named%20function%20types/near/259872246" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/213817-t-lang/topic/named.20function.20types.html#259872246">(Nov 01 2021 at 14:44)</a>:</h4>
<p>Yeah but if there is an associated type named <code>foo</code>...</p>



<a name="259872275"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/213817-t-lang/topic/named%20function%20types/near/259872275" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/213817-t-lang/topic/named.20function.20types.html#259872275">(Nov 01 2021 at 14:44)</a>:</h4>
<p>I guess you can think of it like a group of two things that gets "narrowed down" by the <code>fn</code></p>



<a name="259872313"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/213817-t-lang/topic/named%20function%20types/near/259872313" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Josh Triplett <a href="https://zulip-archive.rust-lang.org/stream/213817-t-lang/topic/named.20function.20types.html#259872313">(Nov 01 2021 at 14:44)</a>:</h4>
<p>Also, in theory, that syntax would naturally extend into something like <code>Trait::foo::fn(Arg1, Arg2)</code>.</p>



<a name="259872357"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/213817-t-lang/topic/named%20function%20types/near/259872357" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Josh Triplett <a href="https://zulip-archive.rust-lang.org/stream/213817-t-lang/topic/named.20function.20types.html#259872357">(Nov 01 2021 at 14:45)</a>:</h4>
<p>(rather than <code>Trait::foo::fn as FnOnce(Arg1, Arg2) ...</code>)</p>



<a name="259872403"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/213817-t-lang/topic/named%20function%20types/near/259872403" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/213817-t-lang/topic/named.20function.20types.html#259872403">(Nov 01 2021 at 14:45)</a>:</h4>
<p>Side note: I am always wondering what <a href="https://www.thefeedbackloop.xyz/stroustrups-rule-and-layering-over-time/">Stroustroup's rule</a> implies. I definitely see it at work here, although I think that talking about the types of functions will (hopefully!) always be somewhat niche.</p>



<a name="259872441"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/213817-t-lang/topic/named%20function%20types/near/259872441" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/213817-t-lang/topic/named.20function.20types.html#259872441">(Nov 01 2021 at 14:45)</a>:</h4>
<p><span class="user-mention silent" data-user-id="239881">Josh Triplett</span> <a href="#narrow/stream/213817-t-lang/topic/named.20function.20types/near/259872313">said</a>:</p>
<blockquote>
<p>Also, in theory, that syntax would naturally extend into something like <code>Trait::foo::fn(Arg1, Arg2)</code>.</p>
</blockquote>
<p>yes, that is a plus.</p>



<a name="259872550"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/213817-t-lang/topic/named%20function%20types/near/259872550" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Josh Triplett <a href="https://zulip-archive.rust-lang.org/stream/213817-t-lang/topic/named.20function.20types.html#259872550">(Nov 01 2021 at 14:46)</a>:</h4>
<p>If we just use <code>Trait::foo</code> and can do so unambiguously, we could do <code>Trait::foo: FnOnce(...)</code>. But it doesn't seem clear if we can do that unambiguously.</p>



<a name="259872596"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/213817-t-lang/topic/named%20function%20types/near/259872596" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/213817-t-lang/topic/named.20function.20types.html#259872596">(Nov 01 2021 at 14:46)</a>:</h4>
<p>(In particular, I'm not sure whether Stroustroup's Rule suggests one should just "give in" and go for the loud syntax initially, or whether it means that the prudent designer should hold out for terse notation. My guess is that it's a mix: for things that are expected to be the "new normal", go for terse notation, even if it is scary. For things that will remain unusual, explicit syntax is ok.)</p>



<a name="259872632"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/213817-t-lang/topic/named%20function%20types/near/259872632" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/213817-t-lang/topic/named.20function.20types.html#259872632">(Nov 01 2021 at 14:46)</a>:</h4>
<p><span class="user-mention silent" data-user-id="239881">Josh Triplett</span> <a href="#narrow/stream/213817-t-lang/topic/named.20function.20types/near/259872550">said</a>:</p>
<blockquote>
<p>If we just use <code>Trait::foo</code> and can do so unambiguously, we could do <code>Trait::foo: FnOnce(...)</code>. But it doesn't seem clear if we can do that unambiguously.</p>
</blockquote>
<p>That is clear</p>



<a name="259872649"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/213817-t-lang/topic/named%20function%20types/near/259872649" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Josh Triplett <a href="https://zulip-archive.rust-lang.org/stream/213817-t-lang/topic/named.20function.20types.html#259872649">(Nov 01 2021 at 14:47)</a>:</h4>
<p>Oh?</p>



<a name="259872655"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/213817-t-lang/topic/named%20function%20types/near/259872655" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/213817-t-lang/topic/named.20function.20types.html#259872655">(Nov 01 2021 at 14:47)</a>:</h4>
<p>However, we can't do it if there is an associated type that shadows it</p>



<a name="259872661"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/213817-t-lang/topic/named%20function%20types/near/259872661" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/213817-t-lang/topic/named.20function.20types.html#259872661">(Nov 01 2021 at 14:47)</a>:</h4>
<p>What is unclear is whether we could do it for free functions</p>



<a name="259872668"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/213817-t-lang/topic/named%20function%20types/near/259872668" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Josh Triplett <a href="https://zulip-archive.rust-lang.org/stream/213817-t-lang/topic/named.20function.20types.html#259872668">(Nov 01 2021 at 14:47)</a>:</h4>
<p>Ah, got it.</p>



<a name="259872682"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/213817-t-lang/topic/named%20function%20types/near/259872682" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Josh Triplett <a href="https://zulip-archive.rust-lang.org/stream/213817-t-lang/topic/named.20function.20types.html#259872682">(Nov 01 2021 at 14:47)</a>:</h4>
<p>Regarding <code>fn::</code>, another possible use of it as a prefix: <code>|| { fn::return return_value_from_containing_function; }</code>.</p>



<a name="259872796"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/213817-t-lang/topic/named%20function%20types/near/259872796" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/213817-t-lang/topic/named.20function.20types.html#259872796">(Nov 01 2021 at 14:48)</a>:</h4>
<p>If we did use it for a prefix, it seems perhaps suboptimal for it to have both a prefix and a suffix use?</p>



<a name="259872828"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/213817-t-lang/topic/named%20function%20types/near/259872828" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/213817-t-lang/topic/named.20function.20types.html#259872828">(Nov 01 2021 at 14:48)</a>:</h4>
<p>Not sure, but I could see people being confused, since the two uses have nothing in common.</p>



<a name="259873160"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/213817-t-lang/topic/named%20function%20types/near/259873160" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Josh Triplett <a href="https://zulip-archive.rust-lang.org/stream/213817-t-lang/topic/named.20function.20types.html#259873160">(Nov 01 2021 at 14:51)</a>:</h4>
<p>Fair.</p>



<a name="259873211"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/213817-t-lang/topic/named%20function%20types/near/259873211" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/213817-t-lang/topic/named.20function.20types.html#259873211">(Nov 01 2021 at 14:51)</a>:</h4>
<p>Sigh!</p>



<a name="259892046"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/213817-t-lang/topic/named%20function%20types/near/259892046" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> kennytm <a href="https://zulip-archive.rust-lang.org/stream/213817-t-lang/topic/named.20function.20types.html#259892046">(Nov 01 2021 at 17:12)</a>:</h4>
<p>if you want to refer to the type of a function in another module using prefix <code>fn</code> do you wear it like <code>module::fn::function</code> or <code>fn::module::function</code></p>



<a name="259908931"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/213817-t-lang/topic/named%20function%20types/near/259908931" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Connor Horman <a href="https://zulip-archive.rust-lang.org/stream/213817-t-lang/topic/named.20function.20types.html#259908931">(Nov 01 2021 at 19:28)</a>:</h4>
<p>Would have to be the former, as you could have multiple fn types within a hierarchy.</p>



<a name="259966228"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/213817-t-lang/topic/named%20function%20types/near/259966228" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Nick Cameron <a href="https://zulip-archive.rust-lang.org/stream/213817-t-lang/topic/named.20function.20types.html#259966228">(Nov 02 2021 at 08:42)</a>:</h4>
<p>I would be wary about overloading path syntax in this way - turbofish and similar constructs seem to be very confusing for users, and this would add more potential confusion. I would rather use some other syntax for combining fn with a name.</p>



<a name="259966303"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/213817-t-lang/topic/named%20function%20types/near/259966303" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Nick Cameron <a href="https://zulip-archive.rust-lang.org/stream/213817-t-lang/topic/named.20function.20types.html#259966303">(Nov 02 2021 at 08:43)</a>:</h4>
<p>E.g., (and a total strawman, really just pulling a sigil out of the air): fn#foo and Trait::fn#foo</p>



<a name="259987027"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/213817-t-lang/topic/named%20function%20types/near/259987027" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Daniel Henry-Mantilla <a href="https://zulip-archive.rust-lang.org/stream/213817-t-lang/topic/named.20function.20types.html#259987027">(Nov 02 2021 at 12:17)</a>:</h4>
<p><span class="user-mention silent" data-user-id="239881">Josh Triplett</span> <a href="#narrow/stream/213817-t-lang/topic/named.20function.20types/near/259871636">said</a>:</p>
<blockquote>
<p><span class="user-mention silent" data-user-id="116009">nikomatsakis</span> I'm a little concerned that that could mean something else: the function-level scope, which we might potentially provide access to.</p>
</blockquote>
<p>Those could also operate off variants of <code>fn</code>: I'd imagine using <code>self::fn::*</code> (or <code>fn::self::*</code>?) for those:</p>
<div class="codehilite" data-code-language="Rust"><pre><span></span><code><span class="k">fn</span> <span class="nf">foo</span><span class="p">()</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="k">const</span><span class="w"> </span><span class="n">FOO</span>: <span class="kt">u8</span> <span class="o">=</span><span class="w"> </span><span class="mi">42</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="k">match</span><span class="w"> </span><span class="nb">Some</span><span class="p">(</span><span class="mi">42</span><span class="p">)</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">        </span><span class="nb">Some</span><span class="p">(</span><span class="bp">self</span>::<span class="k">fn</span>::<span class="n">OOF</span><span class="p">)</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="p">{},</span><span class="w"> </span><span class="c1">// fails to compile! 👌</span>
<span class="w">        </span><span class="n">_</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="fm">unreachable!</span><span class="p">(),</span><span class="w"></span>
<span class="w">    </span><span class="p">}</span><span class="w"></span>
<span class="w">    </span><span class="c1">// as well as:</span>
<span class="w">    </span><span class="k">mod</span> <span class="nn">macro_helper_module</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">        </span><span class="k">use</span><span class="w"> </span><span class="k">super</span>::<span class="p">{</span><span class="o">*</span><span class="p">,</span><span class="w"> </span><span class="k">fn</span>::<span class="o">*</span><span class="p">};</span><span class="w"> </span><span class="c1">// maybe?</span>

<span class="w">        </span><span class="c1">// …</span>
<span class="w">    </span><span class="p">}</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>
</code></pre></div>
<p>Granted, that would <em>overload</em> <code>fn</code> since context would be enough to disambiguate, much like we overload <code>self</code>, when we come to think about it.</p>



<a name="260014000"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/213817-t-lang/topic/named%20function%20types/near/260014000" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/213817-t-lang/topic/named.20function.20types.html#260014000">(Nov 02 2021 at 15:42)</a>:</h4>
<p><span class="user-mention silent" data-user-id="256841">Nick Cameron</span> <a href="#narrow/stream/213817-t-lang/topic/named.20function.20types/near/259966303">said</a>:</p>
<blockquote>
<p>E.g., (and a total strawman, really just pulling a sigil out of the air): fn#foo and Trait::fn#foo</p>
</blockquote>
<p>(fwiw, these are listed as variants in the doc)</p>



<a name="260027673"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/213817-t-lang/topic/named%20function%20types/near/260027673" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> scottmcm <a href="https://zulip-archive.rust-lang.org/stream/213817-t-lang/topic/named.20function.20types.html#260027673">(Nov 02 2021 at 17:13)</a>:</h4>
<p><span class="user-mention silent" data-user-id="256841">Nick Cameron</span> <a href="#narrow/stream/213817-t-lang/topic/named.20function.20types/near/259966228">said</a>:</p>
<blockquote>
<p>I would rather use some other syntax for combining fn with a name.</p>
</blockquote>
<p>Hmm, this is making me think of <code>r#union</code> and <code>k#yeet</code> and such.</p>
<p>I wonder if people would want <code>use fn#foo;</code> to pull in just the <code>fn</code> vs <code>use type#foo;</code> or something.</p>



<a name="260028163"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/213817-t-lang/topic/named%20function%20types/near/260028163" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Connor Horman <a href="https://zulip-archive.rust-lang.org/stream/213817-t-lang/topic/named.20function.20types.html#260028163">(Nov 02 2021 at 17:17)</a>:</h4>
<p>Isn't one of the issues that you can already have functions with the same name as associate (or free) types?</p>



<a name="260028709"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/213817-t-lang/topic/named%20function%20types/near/260028709" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> scottmcm <a href="https://zulip-archive.rust-lang.org/stream/213817-t-lang/topic/named.20function.20types.html#260028709">(Nov 02 2021 at 17:21)</a>:</h4>
<p>yup, that's why <code>use foo::bar;</code> and <code>type bar = foo::bar;</code> do different things.</p>



<a name="260029091"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/213817-t-lang/topic/named%20function%20types/near/260029091" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> cuviper <a href="https://zulip-archive.rust-lang.org/stream/213817-t-lang/topic/named.20function.20types.html#260029091">(Nov 02 2021 at 17:23)</a>:</h4>
<p>most commonly seen with the tuple-struct constructor</p>



<a name="260029495"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/213817-t-lang/topic/named%20function%20types/near/260029495" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> The 8472 <a href="https://zulip-archive.rust-lang.org/stream/213817-t-lang/topic/named.20function.20types.html#260029495">(Nov 02 2021 at 17:25)</a>:</h4>
<p>The tables for each variant could use examples for chaining, i.e. foo::Output::bar::Output where foo and bar are both functions.<br>
This could reveal clunkiness of some variants.</p>



<a name="260034935"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/213817-t-lang/topic/named%20function%20types/near/260034935" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> kennytm <a href="https://zulip-archive.rust-lang.org/stream/213817-t-lang/topic/named.20function.20types.html#260034935">(Nov 02 2021 at 18:03)</a>:</h4>
<p><span class="user-mention silent" data-user-id="330154">The 8472</span> <a href="#narrow/stream/213817-t-lang/topic/named.20function.20types/near/260029495">said</a>:</p>
<blockquote>
<p>The tables for each variant could use examples for chaining, i.e. foo::Output::bar::Output where foo and bar are both functions.</p>
</blockquote>
<p>i bet this will hit <a href="https://github.com/rust-lang/rust/issues/38078">#38078</a> (ambiguous associated type).</p>



<a name="260153737"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/213817-t-lang/topic/named%20function%20types/near/260153737" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/213817-t-lang/topic/named.20function.20types.html#260153737">(Nov 03 2021 at 15:47)</a>:</h4>
<p>So, I had an epiphany when working with <span class="user-mention" data-user-id="119031">@Esteban Küber</span> yesterday</p>



<a name="260153754"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/213817-t-lang/topic/named%20function%20types/near/260153754" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/213817-t-lang/topic/named.20function.20types.html#260153754">(Nov 03 2021 at 15:47)</a>:</h4>
<p>which is that <code>fn</code> is highlighted as a keyword in hackmd presently</p>



<a name="260153781"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/213817-t-lang/topic/named%20function%20types/near/260153781" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/213817-t-lang/topic/named.20function.20types.html#260153781">(Nov 03 2021 at 15:47)</a>:</h4>
<p>and if you read </p>
<div class="codehilite" data-code-language="Rust"><pre><span></span><code><span class="k">fn</span>#<span class="n">foo</span><span class="w"></span>
</code></pre></div>



<a name="260153788"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/213817-t-lang/topic/named%20function%20types/near/260153788" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/213817-t-lang/topic/named.20function.20types.html#260153788">(Nov 03 2021 at 15:47)</a>:</h4>
<p>(also highlighted here!)</p>



<a name="260153791"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/213817-t-lang/topic/named%20function%20types/near/260153791" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/213817-t-lang/topic/named.20function.20types.html#260153791">(Nov 03 2021 at 15:47)</a>:</h4>
<p>it looks very good!</p>



<a name="260153854"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/213817-t-lang/topic/named%20function%20types/near/260153854" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/213817-t-lang/topic/named.20function.20types.html#260153854">(Nov 03 2021 at 15:48)</a>:</h4>
<p>I think I've decided I just like <code>fn#foo</code>, it solves all the problems</p>



<a name="260153880"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/213817-t-lang/topic/named%20function%20types/near/260153880" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/213817-t-lang/topic/named.20function.20types.html#260153880">(Nov 03 2021 at 15:48)</a>:</h4>
<p>It seems also ok to me to do <code>Trait::fn#foo</code></p>



<a name="260153889"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/213817-t-lang/topic/named%20function%20types/near/260153889" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/213817-t-lang/topic/named.20function.20types.html#260153889">(Nov 03 2021 at 15:48)</a>:</h4>
<p>and we can extend to <code>fn#*</code> in the future</p>



<a name="260155013"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/213817-t-lang/topic/named%20function%20types/near/260155013" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> The 8472 <a href="https://zulip-archive.rust-lang.org/stream/213817-t-lang/topic/named.20function.20types.html#260155013">(Nov 03 2021 at 15:55)</a>:</h4>
<div class="codehilite" data-code-language="Rust"><pre><span></span><code><span class="k">fn</span>::<span class="n">foo</span><span class="w"></span>
</code></pre></div>



<a name="260170802"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/213817-t-lang/topic/named%20function%20types/near/260170802" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Vadim Petrochenkov <a href="https://zulip-archive.rust-lang.org/stream/213817-t-lang/topic/named.20function.20types.html#260170802">(Nov 03 2021 at 17:45)</a>:</h4>
<p>I've read the draft (and the zulip discussion) and I disagree with all components of the proposal basically, they all are either functionally harmful, or don't fit into the existing language, or are short sighted, or go against precedents from other languages.</p>



<a name="260171049"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/213817-t-lang/topic/named%20function%20types/near/260171049" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Vadim Petrochenkov <a href="https://zulip-archive.rust-lang.org/stream/213817-t-lang/topic/named.20function.20types.html#260171049">(Nov 03 2021 at 17:47)</a>:</h4>
<p>I can elaborate, but I need to calm down first.<br>
TLDR: C++ does everything right - <code>decltype</code> (<code>typeof</code>) for naming unnamed types + early bound parameters for argument-position <code>impl Trait</code>.</p>



<a name="260173777"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/213817-t-lang/topic/named%20function%20types/near/260173777" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/213817-t-lang/topic/named.20function.20types.html#260173777">(Nov 03 2021 at 18:06)</a>:</h4>
<p>Heh, tell us what you really think :)</p>



<a name="260173798"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/213817-t-lang/topic/named%20function%20types/near/260173798" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/213817-t-lang/topic/named.20function.20types.html#260173798">(Nov 03 2021 at 18:06)</a>:</h4>
<p>I'd love to hear your case though!</p>



<a name="261721545"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/213817-t-lang/topic/named%20function%20types/near/261721545" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/213817-t-lang/topic/named.20function.20types.html#261721545">(Nov 16 2021 at 23:13)</a>:</h4>
<p>Hey <span class="user-mention" data-user-id="123856">@Vadim Petrochenkov</span> or others who are fans of typeof--</p>
<p>I'd appreciate it if you would take a look at <a href="https://hackmd.io/@nikomatsakis/Hk0EwI-OF">this document</a> and especially <a href="https://hackmd.io/@nikomatsakis/Hk0EwI-OF#Approach-2-typeof">the discussion of typeof here</a>. I tried to do a thorough evaluation but I realize that perhaps people have had clever ideas for how to resolve some of the ergonomic pitfalls that I see. I'd appreciate any pointers or tips!</p>



<a name="261734086"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/213817-t-lang/topic/named%20function%20types/near/261734086" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Gary Guo <a href="https://zulip-archive.rust-lang.org/stream/213817-t-lang/topic/named.20function.20types.html#261734086">(Nov 17 2021 at 01:44)</a>:</h4>
<blockquote>
<p>Why not offer any shorthands for the typeof syntax?</p>
<p>For example, we might permit typeof(Widget::frob(_ as &amp;'a Widget)) or typeof(L::Log(_, _)): Send. But we weren’t sure what syntax to use, and there is the challenge is that these shorthands become part of the grammar for expressions</p>
</blockquote>
<p>Those are already part of expression grammar given destructuring assignment.</p>



<a name="261734283"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/213817-t-lang/topic/named%20function%20types/near/261734283" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Gary Guo <a href="https://zulip-archive.rust-lang.org/stream/213817-t-lang/topic/named.20function.20types.html#261734283">(Nov 17 2021 at 01:47)</a>:</h4>
<p>I personally don't like the idea of using <code>fn_name(arg_type)</code> to name the output type in alt 1, it'll make it hard to tell if something is a type or a const. The elision of <code>fn#</code> in where clause rule also feels ad hoc and inconsistent.</p>



<a name="261734469"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/213817-t-lang/topic/named%20function%20types/near/261734469" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Vadim Petrochenkov <a href="https://zulip-archive.rust-lang.org/stream/213817-t-lang/topic/named.20function.20types.html#261734469">(Nov 17 2021 at 01:51)</a>:</h4>
<p><span class="user-mention" data-user-id="116009">@nikomatsakis</span> <br>
I'll get to this thread again next week, most likely, it's in my todo list.</p>



<a name="261736038"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/213817-t-lang/topic/named%20function%20types/near/261736038" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mario Carneiro <a href="https://zulip-archive.rust-lang.org/stream/213817-t-lang/topic/named.20function.20types.html#261736038">(Nov 17 2021 at 02:16)</a>:</h4>
<p><span class="user-mention silent" data-user-id="303710">Gary Guo</span> <a href="#narrow/stream/213817-t-lang/topic/named.20function.20types/near/261734283">said</a>:</p>
<blockquote>
<p>I personally don't like the idea of using <code>fn_name(arg_type)</code> to name the output type in alt 1, it'll make it hard to tell if something is a type or a const.</p>
</blockquote>
<p>To be fair, the types appearing in <code>fn(A, B)</code> and <code>impl Fn(A, B)</code> are also types surrounded by parens, so this is not without precedent.</p>



<a name="261739415"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/213817-t-lang/topic/named%20function%20types/near/261739415" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Gary Guo <a href="https://zulip-archive.rust-lang.org/stream/213817-t-lang/topic/named.20function.20types.html#261739415">(Nov 17 2021 at 03:27)</a>:</h4>
<p>It's next to fn though, not a name of function.</p>



<a name="261745899"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/213817-t-lang/topic/named%20function%20types/near/261745899" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Josh Triplett <a href="https://zulip-archive.rust-lang.org/stream/213817-t-lang/topic/named.20function.20types.html#261745899">(Nov 17 2021 at 05:41)</a>:</h4>
<p><span class="user-mention" data-user-id="116009">@nikomatsakis</span> My only concern with typeof is if we want to have unnamed types that intentionally cannot be named.</p>



<a name="261746039"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/213817-t-lang/topic/named%20function%20types/near/261746039" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Josh Triplett <a href="https://zulip-archive.rust-lang.org/stream/213817-t-lang/topic/named.20function.20types.html#261746039">(Nov 17 2021 at 05:44)</a>:</h4>
<p>For instance, if we have unnamed fields of structs/unions, without typeof those types can never appear anywhere else.</p>



<a name="261746238"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/213817-t-lang/topic/named%20function%20types/near/261746238" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Josh Triplett <a href="https://zulip-archive.rust-lang.org/stream/213817-t-lang/topic/named.20function.20types.html#261746238">(Nov 17 2021 at 05:50)</a>:</h4>
<p>If we make an intentional decision that we don't want to have <em>unnameable</em> types, then typeof seems <em>great</em>.</p>



<a name="261812604"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/213817-t-lang/topic/named%20function%20types/near/261812604" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Connor Horman <a href="https://zulip-archive.rust-lang.org/stream/213817-t-lang/topic/named.20function.20types.html#261812604">(Nov 17 2021 at 16:49)</a>:</h4>
<p>You can name those types, though, in a constrained way using type_alias_impl_trait.</p>



<a name="261822416"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/213817-t-lang/topic/named%20function%20types/near/261822416" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> rpjohnst <a href="https://zulip-archive.rust-lang.org/stream/213817-t-lang/topic/named.20function.20types.html#261822416">(Nov 17 2021 at 17:57)</a>:</h4>
<p>I'd like to offer some reasons I really dislike typeof:</p>
<ul>
<li>As mentioned in the hackmd, it sometimes requires materializing values, which tends to lead to something like C++'s declval (called value in the hackmd)- a weird "function" only usable in non-evaluated contexts. Related to this, it also tends to introduce a lot of duplication- copying expressions into this non-evaluated context and sometimes replacing bits of them with declval.<ul>
<li>C++20 even adds new syntax to make the value materialization less weird (but not the duplication)- <code>requires</code> exprs can declare arbitrary "parameters" to materialize these values instead of using declval.</li>
</ul>
</li>
<li>A major reason for this "duplication into an unevaluted context" is to extract intermediate/unnamed results from metaprogramming-style stuff built from overload resolution + template argument deduction/SFINAE + template/constexpr evaluation. This does not feel like it fits well with Rust's approach which gives more things concrete signatures and names using traits- IMO leveraging the existing Fn::Output or similar is more in line with existing idioms.</li>
<li>In C++, decltype fits into the very linear/down-the-page flow of type information. In Rust, type information flows in more general graph shapes, such that <code>type T = impl Trait</code> fits the (or at least my) mental model much better- it binds a type variable which is "elsewhere" constrained in various ways by <em>actual</em> usage, rather than directly+immediately executing the compiler's metaprogramming machinery on an <em>unevaluated</em> (and thus often artificially invented) expression.</li>
</ul>



<a name="262847431"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/213817-t-lang/topic/named%20function%20types/near/262847431" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> scottmcm <a href="https://zulip-archive.rust-lang.org/stream/213817-t-lang/topic/named.20function.20types.html#262847431">(Nov 27 2021 at 01:45)</a>:</h4>
<p><span class="user-mention silent" data-user-id="116009">nikomatsakis</span> <a href="#narrow/stream/213817-t-lang/topic/named.20function.20types/near/260153889">said</a>:</p>
<blockquote>
<p>and we can extend to <code>fn#*</code> in the future</p>
</blockquote>
<p>I was flipping through the rfcs repo and saw <a href="https://github.com/rust-lang/rfcs/issues/3175">https://github.com/rust-lang/rfcs/issues/3175</a>, which made me think of this thread.</p>
<p><code>fn#</code> seems fine for functions, but I was wondering about other things -- what if this syntax were allowed for writing the names of other things too?  Like <code>Trait::fn#ASSOCIATED_CONST</code> or (if we ever get these) <code>Trait::fn#field_name</code>.  Or even without traits, it might be handy to be able to emit <code>&lt;$some_type&gt;::fn#bar</code> in a place that needs the type of the <code>bar</code> field on that type but where the macro doesn't actually have the type definition available.</p>
<p>Which makes me wonder about instead perhaps picking something like</p>
<div class="codehilite" data-code-language="Rust"><pre><span></span><code><span class="n">Trait</span>::<span class="k">type</span>#<span class="n">foo</span><span class="w"></span>
</code></pre></div>



<a name="263815782"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/213817-t-lang/topic/named%20function%20types/near/263815782" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Vadim Petrochenkov <a href="https://zulip-archive.rust-lang.org/stream/213817-t-lang/topic/named.20function.20types.html#263815782">(Dec 06 2021 at 07:29)</a>:</h4>
<p>Regarding argument-position <code>impl Trait</code> (APIT) and late-bound generic parameters.<br>
(Feel free to move to a separate thread since the APIT change was removed from the draft.)</p>
<p>In rustc there are 522 result for the search <code>: impl \w+</code>, from which <em>at least</em> 180 are used in public functions (34%).<br>
This goes against recommendation of not using APIT in public interfaces, because the users may need to pass the generic arguments explicitly.<br>
This is ok in rustc, because it's a controlled codebase and all crates can be changed together if necessary, but that's not my point.</p>
<p>My point is that APIT is casually used as a simple sugar for single-use generic parameters, without any further thought.<br>
I suggest the reality match these expectations and to not add any subtleties and surprises to this scheme.<br>
This approach is currently implemented and feature gated, the tracking issue is <a href="https://github.com/rust-lang/rust/issues/83701">https://github.com/rust-lang/rust/issues/83701</a>, the implementation fit very naturally into the existing compiler.</p>
<p>C++ used this generic parameter sugar approach for concepts in function parameter types (an APIT analogue) from the start, and I haven't seen any concerns or complaints about it.</p>



<a name="263815792"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/213817-t-lang/topic/named%20function%20types/near/263815792" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Vadim Petrochenkov <a href="https://zulip-archive.rust-lang.org/stream/213817-t-lang/topic/named.20function.20types.html#263815792">(Dec 06 2021 at 07:29)</a>:</h4>
<p>I don't have anything agains experimenting with late-bound type parameters as a separate feature.<br>
We already have a surface syntax for them in function types <code>for&lt;'param&gt; fn(arg: &amp;'param u8)</code> and I can't see any reasons why it could not be extended to function items - <code>for&lt;'param&gt; fn(arg: &amp;'param u8) { ... }</code>, I already suggested this in <a href="https://github.com/rust-lang/rust/issues/42868#issuecomment-330602249">https://github.com/rust-lang/rust/issues/42868#issuecomment-330602249</a>.</p>
<p>Shifting the parameters from the type to the impl is an interesting idea.<br>
C++ does a similar thing with "generic closures" (which would be nice to eventually have in Rust as well), except it shifts the generic even further on the <code>operator()</code> itself (aka <code>fn call(_mut,_once)</code> in Rust), because templates are checked lately there and <code>operator()</code> can have an arbitrary, possible generic, signature not dictated in advance by a trait.<br>
That's basically the same thing as the example in [link]:</p>
<div class="codehilite" data-code-language="Rust"><pre><span></span><code><span class="k">fn</span> <span class="nf">main</span><span class="p">()</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="kd">let</span><span class="w"> </span><span class="n">f</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">impl</span><span class="o">&lt;</span><span class="n">T</span>: <span class="nc">Debug</span><span class="o">&gt;</span><span class="w"> </span><span class="o">|</span><span class="n">arg</span>: <span class="nc">T</span><span class="o">|</span><span class="w"> </span><span class="p">{};</span><span class="w"> </span><span class="c1">// Somehow</span>
<span class="w">    </span><span class="n">f</span><span class="p">(</span><span class="mi">22_</span><span class="k">u32</span><span class="p">);</span><span class="w"> </span><span class="c1">// call once with `u32`</span>
<span class="w">    </span><span class="n">f</span><span class="p">(</span><span class="mi">22_</span><span class="k">i32</span><span class="p">);</span><span class="w"> </span><span class="c1">// call again with `i32`</span>
<span class="p">}</span><span class="w"></span>
</code></pre></div>
<p>What is worrying, however, is that parameters shifted to the <code>impl</code> are not the same thing as late bound lifetime parameters as they exist in the language now.<br>
They are still "concrete" early-bound parameters, just from a different item.<br>
So things like this won't work.</p>
<div class="codehilite" data-code-language="Rust"><pre><span></span><code><span class="k">struct</span> <span class="nc">S</span><span class="p">;</span><span class="w"></span>
<span class="k">trait</span><span class="w"> </span><span class="n">Tr</span><span class="o">&lt;</span><span class="n">Arg</span><span class="o">&gt;</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="k">fn</span> <span class="nf">method</span><span class="p">(</span><span class="n">_arg</span>: <span class="nc">Arg</span><span class="p">)</span><span class="w"> </span><span class="p">{}</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="k">impl</span><span class="o">&lt;'</span><span class="na">a</span><span class="o">&gt;</span><span class="w"> </span><span class="n">Tr</span><span class="o">&lt;&amp;'</span><span class="na">a</span><span class="w"> </span><span class="kt">u8</span><span class="o">&gt;</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">S</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="k">fn</span> <span class="nf">method</span><span class="p">(</span><span class="n">_arg</span>: <span class="kp">&amp;</span><span class="o">'</span><span class="na">a</span> <span class="kt">u8</span><span class="p">)</span><span class="w"> </span><span class="p">{}</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="k">fn</span> <span class="nf">main</span><span class="p">()</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="kd">let</span><span class="w"> </span><span class="n">fnptr</span>: <span class="nc">fn</span><span class="p">(</span><span class="o">&amp;</span><span class="kt">u8</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">S</span>::<span class="n">method</span><span class="p">;</span><span class="w"> </span><span class="c1">// Nope</span>
<span class="w">                                    </span><span class="c1">// expected fn pointer `for&lt;'r&gt; fn(&amp;'r u8)`</span>
<span class="w">                                    </span><span class="c1">//    found fn pointer `fn(&amp;u8)`</span>
<span class="w">    </span><span class="kd">let</span><span class="w"> </span><span class="n">fnptr</span>: <span class="nc">fn</span><span class="p">(</span><span class="o">&amp;'</span><span class="nb">static</span><span class="w"> </span><span class="kt">u8</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">S</span>::<span class="n">method</span><span class="p">;</span><span class="w"> </span><span class="c1">// But this is OK</span>
<span class="p">}</span><span class="w"></span>
</code></pre></div>
<p>So maybe some different terminology should be used if we introduce some sugar for shifting generit parameters to impls, and maybe that sugar shouldn't use <code>for&lt;PARAMS&gt;</code> then.</p>



<a name="263816366"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/213817-t-lang/topic/named%20function%20types/near/263816366" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Vadim Petrochenkov <a href="https://zulip-archive.rust-lang.org/stream/213817-t-lang/topic/named.20function.20types.html#263816366">(Dec 06 2021 at 07:39)</a>:</h4>
<hr>
<p>Regarding path-like syntaxes for function types (<code>fn::something</code>).</p>
<p>I think it's a pretty fundamental property of paths that if <code>path_prefix::segment</code> is a path, then the <code>path_prefix</code> is a path too, that means it goes through name resolution and points to some module.<br>
It's true for non-keyword path prefixes, and it's true for <code>crate::segment</code>, <code>self::segment</code>, etc too - single <code>crate</code> is a path pointing to the crate root module, single <code>self</code> is a path pointing to the current normal module (in type namespace).</p>
<p>Is single <code>fn</code> a path pointing to some module in (the older versions) of this proposal? No.<br>
I think that means it shouldn't use the path syntax either.<br>
(This applies to other proposal suggesting paths as a syntax for other unrelated sugars.)</p>



<a name="263816947"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/213817-t-lang/topic/named%20function%20types/near/263816947" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Vadim Petrochenkov <a href="https://zulip-archive.rust-lang.org/stream/213817-t-lang/topic/named.20function.20types.html#263816947">(Dec 06 2021 at 07:49)</a>:</h4>
<hr>
<p>Oh, and anyone suggesting using <code>#</code> for any syntax not related to ~preprocessor has zero sense of style. <span aria-label="smile" class="emoji emoji-1f642" role="img" title="smile">:smile:</span></p>



<a name="263817518"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/213817-t-lang/topic/named%20function%20types/near/263817518" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Vadim Petrochenkov <a href="https://zulip-archive.rust-lang.org/stream/213817-t-lang/topic/named.20function.20types.html#263817518">(Dec 06 2021 at 07:58)</a>:</h4>
<hr>
<p>(I still have some comments to write about <code>typeof</code>, maybe later this week.)</p>



<a name="263839961"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/213817-t-lang/topic/named%20function%20types/near/263839961" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Vadim Petrochenkov <a href="https://zulip-archive.rust-lang.org/stream/213817-t-lang/topic/named.20function.20types.html#263839961">(Dec 06 2021 at 12:01)</a>:</h4>
<p><span class="user-mention silent" data-user-id="117495">rpjohnst</span> <a href="#narrow/stream/213817-t-lang/topic/named.20function.20types/near/261822416">said</a>:</p>
<blockquote>
<p>I'd like to offer some reasons I really dislike typeof:</p>
<ul>
<li>As mentioned in the hackmd, it sometimes requires materializing values, which tends to lead to something like C++'s declval (called value in the hackmd)- a weird "function" only usable in non-evaluated contexts. Related to this, it also tends to introduce a lot of duplication- copying expressions into this non-evaluated context and sometimes replacing bits of them with declval.<ul>
<li>C++20 even adds new syntax to make the value materialization less weird (but not the duplication)- <code>requires</code> exprs can declare arbitrary "parameters" to materialize these values instead of using declval.</li>
</ul>
</li>
<li>A major reason for this "duplication into an unevaluted context" is to extract intermediate/unnamed results from metaprogramming-style stuff built from overload resolution + template argument deduction/SFINAE + template/constexpr evaluation. This does not feel like it fits well with Rust's approach which gives more things concrete signatures and names using traits- IMO leveraging the existing Fn::Output or similar is more in line with existing idioms.</li>
<li>In C++, decltype fits into the very linear/down-the-page flow of type information. In Rust, type information flows in more general graph shapes, such that <code>type T = impl Trait</code> fits the (or at least my) mental model much better- it binds a type variable which is "elsewhere" constrained in various ways by <em>actual</em> usage, rather than directly+immediately executing the compiler's metaprogramming machinery on an <em>unevaluated</em> (and thus often artificially invented) expression.</li>
</ul>
</blockquote>
<blockquote>
<p>As mentioned in the hackmd, it sometimes requires materializing values...</p>
</blockquote>
<p>This is true, but we can easily limit expressions inside <code>typeof</code> to paths resolving to functions for a start, then there will be not many values to materialize.<br>
Extending the supported set of expressions inside of <code>typeof</code> (and giving more potential for value materialization tricks) is our choice, not necessity.</p>
<blockquote>
<p>A major reason for this "duplication into an unevaluted context" is to extract intermediate/unnamed results from metaprogramming-style stuff built from overload resolution + template argument deduction/SFINAE + template/constexpr evaluation. This does not feel like it fits well with Rust's approach which gives more things concrete signatures and names using traits- IMO leveraging the existing Fn::Output or similar is more in line with existing idioms.</p>
</blockquote>
<p>I don't think there's a conflict between these two approaches?<br>
<code>Output</code> can be taken from a result of <code>typeof</code> as well.</p>
<blockquote>
<p>In C++, decltype fits into the very linear/down-the-page flow of type information. In Rust, type information flows in more general graph shapes, such that <code>type T = impl Trait</code> fits the (or at least my) mental model much better- it binds a type variable which is "elsewhere" constrained in various ways by <em>actual</em> usage, rather than directly+immediately executing the compiler's metaprogramming machinery on an <em>unevaluated</em> (and thus often artificially invented) expression.</p>
</blockquote>
<p>I don't see why there's a conflict with Rust type inference, and why <code>typeof</code> necessarily needs a unidirectional type inference, the body of <code>typeof</code> can be type-checked as a part of the larger context, like bodies of closures and <code>const { ... }</code> blocks.</p>



<a name="263840315"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/213817-t-lang/topic/named%20function%20types/near/263840315" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Vadim Petrochenkov <a href="https://zulip-archive.rust-lang.org/stream/213817-t-lang/topic/named.20function.20types.html#263840315">(Dec 06 2021 at 12:05)</a>:</h4>
<p><span class="user-mention silent" data-user-id="116009">nikomatsakis</span> <a href="#narrow/stream/213817-t-lang/topic/named.20function.20types/near/261721545">said</a>:</p>
<blockquote>
<p>Hey <span class="user-mention silent" data-user-id="123856">Vadim Petrochenkov</span> or others who are fans of typeof--</p>
<p>I'd appreciate it if you would take a look at <a href="https://hackmd.io/@nikomatsakis/Hk0EwI-OF">this document</a> and especially <a href="https://hackmd.io/@nikomatsakis/Hk0EwI-OF#Approach-2-typeof">the discussion of typeof here</a>. I tried to do a thorough evaluation but I realize that perhaps people have had clever ideas for how to resolve some of the ergonomic pitfalls that I see. I'd appreciate any pointers or tips!</p>
</blockquote>
<p>Maybe it's not a very clever idea, but is prettifying the use of <code>typeof</code> or analogues even necessary?  This is certainly not an operation for everyday use.<br>
I wouldn't personally think about any sugar for it until the base feature is implemented and used for some months.</p>



<a name="264042820"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/213817-t-lang/topic/named%20function%20types/near/264042820" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/213817-t-lang/topic/named.20function.20types.html#264042820">(Dec 07 2021 at 17:53)</a>:</h4>
<p>Thanks for that write-up, <span class="user-mention" data-user-id="123856">@Vadim Petrochenkov</span>, I'll take a look in detail later -- that said, I've personally "moved on" to preferring a different point in the design space (<a href="https://rust-lang.github.io/async-fundamentals-initiative/explainer/phase_1.html#naming-the-future-that-is-returned">described here</a>).  I've been meaning to try and do some kind of update blog post to talk about the hows/whys (tl;dr -- the "name the fn type" is too hard to explain and cumbersome, this version seems simpler).</p>



<a name="264083388"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/213817-t-lang/topic/named%20function%20types/near/264083388" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Daniel Henry-Mantilla <a href="https://zulip-archive.rust-lang.org/stream/213817-t-lang/topic/named.20function.20types.html#264083388">(Dec 07 2021 at 22:32)</a>:</h4>
<p>In that regard, I still lean towards the shorthand form using <code>&lt;'_, '_, ...&gt;</code> to make it explicit there is a higher-order thing going on. With a hypothetical <code>'..</code> "variadic ellipsis", it would even allow something almost as concise as the suggested sugar: <code>P::request&lt;'..&gt; : Send</code></p>



<a name="264108489"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/213817-t-lang/topic/named%20function%20types/near/264108489" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Vadim Petrochenkov <a href="https://zulip-archive.rust-lang.org/stream/213817-t-lang/topic/named.20function.20types.html#264108489">(Dec 08 2021 at 03:47)</a>:</h4>
<p><span class="user-mention silent" data-user-id="116009">nikomatsakis</span> <a href="#narrow/stream/213817-t-lang/topic/named.20function.20types/near/264042820">said</a>:</p>
<blockquote>
<p>a different point in the design space (<a href="https://rust-lang.github.io/async-fundamentals-initiative/explainer/phase_1.html#naming-the-future-that-is-returned">described here</a>)</p>
</blockquote>
<p>Ah, so you are planning to make the associated type synthesized for "RPIT in traits" named after all.<br>
Shouldn't this affect <a href="https://github.com/rust-lang/rfcs/pull/3193">https://github.com/rust-lang/rfcs/pull/3193</a> as well in that case?</p>



<a name="264617815"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/213817-t-lang/topic/named%20function%20types/near/264617815" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> cjgillot <a href="https://zulip-archive.rust-lang.org/stream/213817-t-lang/topic/named.20function.20types.html#264617815">(Dec 12 2021 at 11:22)</a>:</h4>
<blockquote>
<hr>
<p>Regarding path-like syntaxes for function types (<code>fn::something</code>).</p>
<p>I think it's a pretty fundamental property of paths that if <code>path_prefix::segment</code> is a path, then the <code>path_prefix</code> is a path too, that means it goes through name resolution and points to some module.<br>
It's true for non-keyword path prefixes, and it's true for <code>crate::segment</code>, <code>self::segment</code>, etc too - single <code>crate</code> is a path pointing to the crate root module, single <code>self</code> is a path pointing to the current normal module (in type namespace).</p>
<p>Is single <code>fn</code> a path pointing to some module in (the older versions) of this proposal? No.<br>
I think that means it shouldn't use the path syntax either.<br>
(This applies to other proposal suggesting paths as a syntax for other unrelated sugars.)</p>
</blockquote>
<p>Could we do the converse: call the function type <code>function::fn</code>? This would nest a type inside a value, I don't know is the resolver allows for such a thing. Similarly, we could name the function's output type <code>function::Output</code>, either as a binding inside <code>function</code> or as sugar for <code>&lt;function as Fn&lt;_&gt;&gt;::Output</code>.</p>



<hr><p>Last updated: Apr 12 2022 at 20:01 UTC</p>
</html>