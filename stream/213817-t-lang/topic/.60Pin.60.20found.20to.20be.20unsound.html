<html>
<head><meta charset="utf-8"><title>`Pin` found to be unsound · t-lang · Zulip Chat Archive</title></head>
<h2>Stream: <a href="https://rust-lang.github.io/zulip_archive/stream/213817-t-lang/index.html">t-lang</a></h2>
<h3>Topic: <a href="https://rust-lang.github.io/zulip_archive/stream/213817-t-lang/topic/.60Pin.60.20found.20to.20be.20unsound.html">`Pin` found to be unsound</a></h3>

<hr>

<base href="https://rust-lang.zulipchat.com">

<head><link href="https://rust-lang.github.io/zulip_archive/style.css" rel="stylesheet"></head>

<a name="181049302"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/213817-t-lang/topic/%60Pin%60%20found%20to%20be%20unsound/near/181049302" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> RalfJ <a href="https://rust-lang.github.io/zulip_archive/stream/213817-t-lang/topic/.60Pin.60.20found.20to.20be.20unsound.html#181049302">(Nov 18 2019 at 19:48)</a>:</h4>
<p>Uh-oh: <a href="https://internals.rust-lang.org/t/unsoundness-in-pin/11311" target="_blank" title="https://internals.rust-lang.org/t/unsoundness-in-pin/11311">https://internals.rust-lang.org/t/unsoundness-in-pin/11311</a><br>
Cc <span class="user-mention" data-user-id="203289">@boats</span> <span class="user-mention" data-user-id="127859">@Taylor Cramer</span> <span class="user-mention" data-user-id="126931">@centril</span></p>



<a name="181090141"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/213817-t-lang/topic/%60Pin%60%20found%20to%20be%20unsound/near/181090141" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> centril <a href="https://rust-lang.github.io/zulip_archive/stream/213817-t-lang/topic/.60Pin.60.20found.20to.20be.20unsound.html#181090141">(Nov 19 2019 at 08:10)</a>:</h4>
<p>I saw; haven't processed yet</p>



<a name="181090160"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/213817-t-lang/topic/%60Pin%60%20found%20to%20be%20unsound/near/181090160" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> centril <a href="https://rust-lang.github.io/zulip_archive/stream/213817-t-lang/topic/.60Pin.60.20found.20to.20be.20unsound.html#181090160">(Nov 19 2019 at 08:11)</a>:</h4>
<p>Should also be filed as an issue on rust-lang/rust and labeled with I-unsound so that we can have the more-official discussion there</p>



<a name="181097884"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/213817-t-lang/topic/%60Pin%60%20found%20to%20be%20unsound/near/181097884" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> RalfJ <a href="https://rust-lang.github.io/zulip_archive/stream/213817-t-lang/topic/.60Pin.60.20found.20to.20be.20unsound.html#181097884">(Nov 19 2019 at 10:20)</a>:</h4>
<p>IRLO is official though?</p>



<a name="181097899"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/213817-t-lang/topic/%60Pin%60%20found%20to%20be%20unsound/near/181097899" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> RalfJ <a href="https://rust-lang.github.io/zulip_archive/stream/213817-t-lang/topic/.60Pin.60.20found.20to.20be.20unsound.html#181097899">(Nov 19 2019 at 10:20)</a>:</h4>
<p>I agree about having an issue for tracking, but discourse is just the better medium for discussion that GH^^</p>



<a name="181098057"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/213817-t-lang/topic/%60Pin%60%20found%20to%20be%20unsound/near/181098057" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> RalfJ <a href="https://rust-lang.github.io/zulip_archive/stream/213817-t-lang/topic/.60Pin.60.20found.20to.20be.20unsound.html#181098057">(Nov 19 2019 at 10:22)</a>:</h4>
<p>issue filed: <a href="https://github.com/rust-lang/rust/issues/66544" target="_blank" title="https://github.com/rust-lang/rust/issues/66544">https://github.com/rust-lang/rust/issues/66544</a></p>



<a name="181098113"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/213817-t-lang/topic/%60Pin%60%20found%20to%20be%20unsound/near/181098113" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> RalfJ <a href="https://rust-lang.github.io/zulip_archive/stream/213817-t-lang/topic/.60Pin.60.20found.20to.20be.20unsound.html#181098113">(Nov 19 2019 at 10:23)</a>:</h4>
<p>Feel free to add more labels to that issue, I am not sure what makes sense. P-high? I-nominate?</p>



<a name="181102987"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/213817-t-lang/topic/%60Pin%60%20found%20to%20be%20unsound/near/181102987" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> centril <a href="https://rust-lang.github.io/zulip_archive/stream/213817-t-lang/topic/.60Pin.60.20found.20to.20be.20unsound.html#181102987">(Nov 19 2019 at 11:33)</a>:</h4>
<p>ok this is good for now; added some labels</p>



<a name="181605065"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/213817-t-lang/topic/%60Pin%60%20found%20to%20be%20unsound/near/181605065" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> simulacrum <a href="https://rust-lang.github.io/zulip_archive/stream/213817-t-lang/topic/.60Pin.60.20found.20to.20be.20unsound.html#181605065">(Nov 22 2019 at 02:24)</a>:</h4>
<p>One thing that I thought might be worth mentioning around the discussion for blanket forbidding e.g. DerefMut on <code>&amp;T</code> is a recent Embedded <a href="https://github.com/rust-embedded/wg/blob/master/rfcs/0377-mutex-trait.md#the-rust-standard-library-mutex-uses-self-for-the-lock-method-why-choose-mut-self" target="_blank" title="https://github.com/rust-embedded/wg/blob/master/rfcs/0377-mutex-trait.md#the-rust-standard-library-mutex-uses-self-for-the-lock-method-why-choose-mut-self">RFC</a> which suggests a trait and a typical impl for <code>&amp;T</code> while the traits signature takes <code>&amp;mut self</code> -- I don't think this is really a problem in this case, but thought I'd mention it at least</p>



<a name="181605083"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/213817-t-lang/topic/%60Pin%60%20found%20to%20be%20unsound/near/181605083" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> simulacrum <a href="https://rust-lang.github.io/zulip_archive/stream/213817-t-lang/topic/.60Pin.60.20found.20to.20be.20unsound.html#181605083">(Nov 22 2019 at 02:25)</a>:</h4>
<p>In particular I haven't put in too much thought but I could imagine a design that made DerefMut for &amp;Mutex reasonable in some sense (not sure how you'd synthesize the mutable reference, but I think you <em>could</em> with the right effort</p>



<a name="182762997"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/213817-t-lang/topic/%60Pin%60%20found%20to%20be%20unsound/near/182762997" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> boats <a href="https://rust-lang.github.io/zulip_archive/stream/213817-t-lang/topic/.60Pin.60.20found.20to.20be.20unsound.html#182762997">(Dec 06 2019 at 14:05)</a>:</h4>
<p>@simulacrum implementing DerefMut for &amp;Mutex doesn't work, because it needs to drop the lock in its destructor. Implementing an &amp;mut method for an &amp;T type presents no problems for pin and is quite different - it means exclusive access to that shared reference.</p>



<a name="182766051"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/213817-t-lang/topic/%60Pin%60%20found%20to%20be%20unsound/near/182766051" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> simulacrum <a href="https://rust-lang.github.io/zulip_archive/stream/213817-t-lang/topic/.60Pin.60.20found.20to.20be.20unsound.html#182766051">(Dec 06 2019 at 14:38)</a>:</h4>
<p>(I thought so, but wanted to point it out in case it was relevant. Thanks for taking a look!)</p>



<hr><p>Last updated: Aug 07 2021 at 22:04 UTC</p>
</html>