<html>
<head><meta charset="utf-8"><title>`forbid(unsafe_code)` and macros · t-lang · Zulip Chat Archive</title></head>
<h2>Stream: <a href="https://zulip-archive.rust-lang.org/stream/213817-t-lang/index.html">t-lang</a></h2>
<h3>Topic: <a href="https://zulip-archive.rust-lang.org/stream/213817-t-lang/topic/.60forbid(unsafe_code).60.20and.20macros.html">`forbid(unsafe_code)` and macros</a></h3>

<hr>

<base href="https://rust-lang.zulipchat.com">

<head><link href="https://zulip-archive.rust-lang.org/style.css" rel="stylesheet"></head>

<a name="227492397"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/213817-t-lang/topic/%60forbid%28unsafe_code%29%60%20and%20macros/near/227492397" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> scottmcm <a href="https://zulip-archive.rust-lang.org/stream/213817-t-lang/topic/.60forbid(unsafe_code).60.20and.20macros.html#227492397">(Feb 23 2021 at 19:50)</a>:</h4>
<p>This IRLO thread has an interesting point for our conversation about lint hygiene: <a href="https://internals.rust-lang.org/t/hidden-unsafe-due-to-unintentionally-abusable-macros-and-include/14107?u=scottmcm">https://internals.rust-lang.org/t/hidden-unsafe-due-to-unintentionally-abusable-macros-and-include/14107?u=scottmcm</a></p>
<p>My rough summary is that it's different from the other crate using <code>unsafe</code>, because it can apply the <code>unsafe</code> to the expression you passed to the macro, which is different from the unsafe applying to its own code.</p>
<p>Now, maybe the answer there is that <code>forbid(unsafe_code)</code> is foundationally different from other lints, so should be a different mechanism, but I think it's a good thing to raise as a place where "hygienic lint levels" wouldn't necessary do what's wanted.</p>



<a name="227492730"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/213817-t-lang/topic/%60forbid%28unsafe_code%29%60%20and%20macros/near/227492730" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> scottmcm <a href="https://zulip-archive.rust-lang.org/stream/213817-t-lang/topic/.60forbid(unsafe_code).60.20and.20macros.html#227492730">(Feb 23 2021 at 19:52)</a>:</h4>
<p>...and I just noticed that someone started a <a class="stream" data-stream-id="136281" href="/#narrow/stream/136281-t-lang.2Fwg-unsafe-code-guidelines">#t-lang/wg-unsafe-code-guidelines</a> topic about that thread in <a href="#narrow/stream/146229-wg-secure-code/topic/Hidden.20unsafe.20due.20to.20unintentionally.20abusable.20macros/near/227491663">https://rust-lang.zulipchat.com/#narrow/stream/146229-wg-secure-code/topic/Hidden.20unsafe.20due.20to.20unintentionally.20abusable.20macros/near/227491663</a></p>



<a name="227494422"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/213817-t-lang/topic/%60forbid%28unsafe_code%29%60%20and%20macros/near/227494422" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/213817-t-lang/topic/.60forbid(unsafe_code).60.20and.20macros.html#227494422">(Feb 23 2021 at 20:03)</a>:</h4>
<p>I think it'd be great for us to be leveraging the design notes for this sort of thing</p>



<a name="227494437"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/213817-t-lang/topic/%60forbid%28unsafe_code%29%60%20and%20macros/near/227494437" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/213817-t-lang/topic/.60forbid(unsafe_code).60.20and.20macros.html#227494437">(Feb 23 2021 at 20:03)</a>:</h4>
<p>maybe we should start a hygiene.md in there?</p>



<a name="227494440"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/213817-t-lang/topic/%60forbid%28unsafe_code%29%60%20and%20macros/near/227494440" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/213817-t-lang/topic/.60forbid(unsafe_code).60.20and.20macros.html#227494440">(Feb 23 2021 at 20:03)</a>:</h4>
<p>and collect these points?</p>



<a name="227494448"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/213817-t-lang/topic/%60forbid%28unsafe_code%29%60%20and%20macros/near/227494448" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/213817-t-lang/topic/.60forbid(unsafe_code).60.20and.20macros.html#227494448">(Feb 23 2021 at 20:03)</a>:</h4>
<p>they seem quite easy to forget</p>



<hr><p>Last updated: Apr 12 2022 at 20:01 UTC</p>
</html>