<html>
<head><meta charset="utf-8"><title>`paste!` incorporation for ident concatination · t-lang · Zulip Chat Archive</title></head>
<h2>Stream: <a href="https://zulip-archive.rust-lang.org/stream/213817-t-lang/index.html">t-lang</a></h2>
<h3>Topic: <a href="https://zulip-archive.rust-lang.org/stream/213817-t-lang/topic/.60paste!.60.20incorporation.20for.20ident.20concatination.html">`paste!` incorporation for ident concatination</a></h3>

<hr>

<base href="https://rust-lang.zulipchat.com">

<head><link href="https://zulip-archive.rust-lang.org/style.css" rel="stylesheet"></head>

<a name="278384816"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/213817-t-lang/topic/%60paste%21%60%20incorporation%20for%20ident%20concatination/near/278384816" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> inquisitivecrystal <a href="https://zulip-archive.rust-lang.org/stream/213817-t-lang/topic/.60paste!.60.20incorporation.20for.20ident.20concatination.html#278384816">(Apr 09 2022 at 03:25)</a>:</h4>
<p>Random thought: I think the syntax from the <a href="https://github.com/dtolnay/paste"><code>paste</code> crate</a> could just be a general part of rust's features (at least inside macros). Paste lets you do things like <code>[&lt;Q R S T&gt;]</code> to concatenate idents together. Which would be boring, except it also works with metavariables. Plus, you can modify the case or camel/snake-casedness, like this: <code>[&lt;ld_ $reg:lower _expr&gt;]</code>. That makes <code>$reg</code> lowercase. </p>
<p>In other words, it's like <code>concat_idents!</code>, except it's more powerful and seems to avoid the ambiguity problems that <code>concat_idents!</code> has, allowing this syntax to be used in ident position. I realize that full support for macros in ident position would be better, but given how long <a href="https://github.com/rust-lang/rust/issues/29599">#29599</a> has been open, I'm not getting the feeling that's ever going to happen.</p>



<a name="278384897"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/213817-t-lang/topic/%60paste%21%60%20incorporation%20for%20ident%20concatination/near/278384897" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> inquisitivecrystal <a href="https://zulip-archive.rust-lang.org/stream/213817-t-lang/topic/.60paste!.60.20incorporation.20for.20ident.20concatination.html#278384897">(Apr 09 2022 at 03:27)</a>:</h4>
<p>Examples are stolen from the paste README.</p>



<a name="278386542"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/213817-t-lang/topic/%60paste%21%60%20incorporation%20for%20ident%20concatination/near/278386542" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> matt1992 <a href="https://zulip-archive.rust-lang.org/stream/213817-t-lang/topic/.60paste!.60.20incorporation.20for.20ident.20concatination.html#278386542">(Apr 09 2022 at 04:09)</a>:</h4>
<p>Maybe the metavariable expression syntax could be leveraged to do this?<br>
To support <code>${concat_ident(ld_ $reg _expr)}</code>, at least.<br>
<a href="https://github.com/rust-lang/rfcs/blob/master/text/3086-macro-metavar-expr.md">https://github.com/rust-lang/rfcs/blob/master/text/3086-macro-metavar-expr.md</a></p>



<a name="278440061"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/213817-t-lang/topic/%60paste%21%60%20incorporation%20for%20ident%20concatination/near/278440061" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Daniel Henry-Mantilla <a href="https://zulip-archive.rust-lang.org/stream/213817-t-lang/topic/.60paste!.60.20incorporation.20for.20ident.20concatination.html#278440061">(Apr 10 2022 at 00:56)</a>:</h4>
<p>Or the eager-expansion pattern:</p>
<div class="codehilite" data-code-language="Rust"><pre><span></span><code><span class="k">match</span><span class="o">!</span><span class="w"> </span><span class="fm">concat_idents!</span><span class="p">(</span><span class="n">ld_</span><span class="w"> </span><span class="cp">$ref</span><span class="w"> </span><span class="n">_expr</span><span class="p">)</span><span class="w"> </span><span class="p">{(</span><span class="w"> </span><span class="cp">$fname</span>:<span class="nc">ident</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="p">(</span><span class="w"></span>
<span class="w">    </span><span class="k">fn</span> <span class="cp">$fname</span><span class="w"> </span><span class="o">..</span><span class="p">.</span><span class="w"></span>
<span class="p">)}</span><span class="w"></span>
</code></pre></div>
<ul>
<li>prototyped <a href="https://docs.rs/with_builtin_macros/0.0.3/with_builtin_macros/builtin_macros/concat_idents/index.html">over here</a></li>
</ul>



<a name="278452059"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/213817-t-lang/topic/%60paste%21%60%20incorporation%20for%20ident%20concatination/near/278452059" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> inquisitivecrystal <a href="https://zulip-archive.rust-lang.org/stream/213817-t-lang/topic/.60paste!.60.20incorporation.20for.20ident.20concatination.html#278452059">(Apr 10 2022 at 06:45)</a>:</h4>
<p>Interesting!</p>



<a name="278452064"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/213817-t-lang/topic/%60paste%21%60%20incorporation%20for%20ident%20concatination/near/278452064" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> inquisitivecrystal <a href="https://zulip-archive.rust-lang.org/stream/213817-t-lang/topic/.60paste!.60.20incorporation.20for.20ident.20concatination.html#278452064">(Apr 10 2022 at 06:45)</a>:</h4>
<p>I'm not picky about how it gets done, although I do think that strong support for case conversions is vital.</p>



<a name="278459671"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/213817-t-lang/topic/%60paste%21%60%20incorporation%20for%20ident%20concatination/near/278459671" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mario Carneiro <a href="https://zulip-archive.rust-lang.org/stream/213817-t-lang/topic/.60paste!.60.20incorporation.20for.20ident.20concatination.html#278459671">(Apr 10 2022 at 10:05)</a>:</h4>
<p>are case conventions currently a part of the language? AFAIK they are limited to lints and warnings only</p>



<a name="278460235"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/213817-t-lang/topic/%60paste%21%60%20incorporation%20for%20ident%20concatination/near/278460235" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Chayim Refael Friedman <a href="https://zulip-archive.rust-lang.org/stream/213817-t-lang/topic/.60paste!.60.20incorporation.20for.20ident.20concatination.html#278460235">(Apr 10 2022 at 10:21)</a>:</h4>
<p>What do you define as "part of the language"? They're <a href="https://rust-lang.github.io/api-guidelines/naming.html">officially recommended</a> and have lints.</p>



<a name="278460250"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/213817-t-lang/topic/%60paste%21%60%20incorporation%20for%20ident%20concatination/near/278460250" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mario Carneiro <a href="https://zulip-archive.rust-lang.org/stream/213817-t-lang/topic/.60paste!.60.20incorporation.20for.20ident.20concatination.html#278460250">(Apr 10 2022 at 10:21)</a>:</h4>
<p>do they form part of the definition of what a valid rust program is</p>



<a name="278460302"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/213817-t-lang/topic/%60paste%21%60%20incorporation%20for%20ident%20concatination/near/278460302" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Chayim Refael Friedman <a href="https://zulip-archive.rust-lang.org/stream/213817-t-lang/topic/.60paste!.60.20incorporation.20for.20ident.20concatination.html#278460302">(Apr 10 2022 at 10:22)</a>:</h4>
<p>No, and they shouldn't (unless you <code>#[deny(...)]</code> the lints).</p>



<a name="278460318"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/213817-t-lang/topic/%60paste%21%60%20incorporation%20for%20ident%20concatination/near/278460318" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mario Carneiro <a href="https://zulip-archive.rust-lang.org/stream/213817-t-lang/topic/.60paste!.60.20incorporation.20for.20ident.20concatination.html#278460318">(Apr 10 2022 at 10:23)</a>:</h4>
<p>making them part of macro matchers would change that</p>



<a name="278460396"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/213817-t-lang/topic/%60paste%21%60%20incorporation%20for%20ident%20concatination/near/278460396" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Chayim Refael Friedman <a href="https://zulip-archive.rust-lang.org/stream/213817-t-lang/topic/.60paste!.60.20incorporation.20for.20ident.20concatination.html#278460396">(Apr 10 2022 at 10:25)</a>:</h4>
<p>We can just let the user choose the casing, like the <code>paste</code> crate does.</p>



<a name="278461162"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/213817-t-lang/topic/%60paste%21%60%20incorporation%20for%20ident%20concatination/near/278461162" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mario Carneiro <a href="https://zulip-archive.rust-lang.org/stream/213817-t-lang/topic/.60paste!.60.20incorporation.20for.20ident.20concatination.html#278461162">(Apr 10 2022 at 10:45)</a>:</h4>
<p>that still makes case conversion a part of the standard though</p>



<a name="278461237"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/213817-t-lang/topic/%60paste%21%60%20incorporation%20for%20ident%20concatination/near/278461237" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Chayim Refael Friedman <a href="https://zulip-archive.rust-lang.org/stream/213817-t-lang/topic/.60paste!.60.20incorporation.20for.20ident.20concatination.html#278461237">(Apr 10 2022 at 10:47)</a>:</h4>
<p><strong>conversions</strong>, but not <strong>conventions</strong>. That's whole lot different. Casing is a concept that exists, and nobody can deny that; handling it in identifiers, in some sense, is like providing string manipulation functions to handle it. But forcing people to use specific naming conventions is something entirely different.</p>



<a name="278519837"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/213817-t-lang/topic/%60paste%21%60%20incorporation%20for%20ident%20concatination/near/278519837" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> inquisitivecrystal <a href="https://zulip-archive.rust-lang.org/stream/213817-t-lang/topic/.60paste!.60.20incorporation.20for.20ident.20concatination.html#278519837">(Apr 11 2022 at 08:07)</a>:</h4>
<p>Yeah.</p>



<a name="278519900"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/213817-t-lang/topic/%60paste%21%60%20incorporation%20for%20ident%20concatination/near/278519900" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> inquisitivecrystal <a href="https://zulip-archive.rust-lang.org/stream/213817-t-lang/topic/.60paste!.60.20incorporation.20for.20ident.20concatination.html#278519900">(Apr 11 2022 at 08:08)</a>:</h4>
<p>I agree with Chayim.</p>



<a name="278519964"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/213817-t-lang/topic/%60paste%21%60%20incorporation%20for%20ident%20concatination/near/278519964" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> inquisitivecrystal <a href="https://zulip-archive.rust-lang.org/stream/213817-t-lang/topic/.60paste!.60.20incorporation.20for.20ident.20concatination.html#278519964">(Apr 11 2022 at 08:08)</a>:</h4>
<p>They already have lints. These are rustc lints too.s rustc will warn you that you're doing something wrong if you don't follow the convention.</p>



<a name="278520173"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/213817-t-lang/topic/%60paste%21%60%20incorporation%20for%20ident%20concatination/near/278520173" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> inquisitivecrystal <a href="https://zulip-archive.rust-lang.org/stream/213817-t-lang/topic/.60paste!.60.20incorporation.20for.20ident.20concatination.html#278520173">(Apr 11 2022 at 08:11)</a>:</h4>
<p>I wasn't proposing to make them any more required than they are now, just to allow the user to specify the casing. The alternative is to make everyone who wants to use <code>concat_idents!</code> ignore the lints (which we could do by default, but still). And if they did so they'd still have confusing expanded code.</p>



<a name="278520219"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/213817-t-lang/topic/%60paste%21%60%20incorporation%20for%20ident%20concatination/near/278520219" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> inquisitivecrystal <a href="https://zulip-archive.rust-lang.org/stream/213817-t-lang/topic/.60paste!.60.20incorporation.20for.20ident.20concatination.html#278520219">(Apr 11 2022 at 08:11)</a>:</h4>
<p>Here, we're providing people the option to follow case conventions in there macros.</p>



<a name="278520316"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/213817-t-lang/topic/%60paste%21%60%20incorporation%20for%20ident%20concatination/near/278520316" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> inquisitivecrystal <a href="https://zulip-archive.rust-lang.org/stream/213817-t-lang/topic/.60paste!.60.20incorporation.20for.20ident.20concatination.html#278520316">(Apr 11 2022 at 08:12)</a>:</h4>
<p>And yeah, that means officially defining camel case and snake space as part of the language spec. But lints are already almost part of the language spec themselves, so it's not a big change.</p>



<hr><p>Last updated: Apr 12 2022 at 20:01 UTC</p>
</html>