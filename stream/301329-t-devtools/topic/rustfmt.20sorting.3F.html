<html>
<head><meta charset="utf-8"><title>rustfmt sorting? · t-devtools · Zulip Chat Archive</title></head>
<h2>Stream: <a href="https://zulip-archive.rust-lang.org/stream/301329-t-devtools/index.html">t-devtools</a></h2>
<h3>Topic: <a href="https://zulip-archive.rust-lang.org/stream/301329-t-devtools/topic/rustfmt.20sorting.3F.html">rustfmt sorting?</a></h3>

<hr>

<base href="https://rust-lang.zulipchat.com">

<head><link href="https://zulip-archive.rust-lang.org/style.css" rel="stylesheet"></head>

<a name="275721314"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/301329-t-devtools/topic/rustfmt%20sorting%3F/near/275721314" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Josh Triplett <a href="https://zulip-archive.rust-lang.org/stream/301329-t-devtools/topic/rustfmt.20sorting.3F.html#275721314">(Mar 17 2022 at 20:29)</a>:</h4>
<p>What is rustfmt's sort order for imports? rustfmt just produced this diff:</p>
<div class="codehilite" data-code-language="Diff"><pre><span></span><code><span class="gd">-use smol::Async;</span><span class="w"></span>
<span class="w"> </span>use smol::io::{AsyncReadExt, AsyncWriteExt};<span class="w"></span>
<span class="gi">+use smol::Async;</span><span class="w"></span>
</code></pre></div>
<p>I can't reconcile that diff with any plausible sort order. It can't be alphabetical since <code>A</code> comes before <code>i</code>, and it can't be ASCIIbetical because even then <code>A</code> comes before <code>i</code>.</p>



<a name="275722029"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/301329-t-devtools/topic/rustfmt%20sorting%3F/near/275722029" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> simulacrum <a href="https://zulip-archive.rust-lang.org/stream/301329-t-devtools/topic/rustfmt.20sorting.3F.html#275722029">(Mar 17 2022 at 20:34)</a>:</h4>
<p>Alphabetical, lowercase &lt; uppercase?</p>



<a name="275722163"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/301329-t-devtools/topic/rustfmt%20sorting%3F/near/275722163" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> simulacrum <a href="https://zulip-archive.rust-lang.org/stream/301329-t-devtools/topic/rustfmt.20sorting.3F.html#275722163">(Mar 17 2022 at 20:35)</a>:</h4>
<p><a href="https://github.com/rust-lang/rustfmt/blob/b4de150dbc65a6bb95c86517430726c55251d0b0/src/imports.rs#L761">https://github.com/rust-lang/rustfmt/blob/b4de150dbc65a6bb95c86517430726c55251d0b0/src/imports.rs#L761</a></p>



<a name="275722432"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/301329-t-devtools/topic/rustfmt%20sorting%3F/near/275722432" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Josh Triplett <a href="https://zulip-archive.rust-lang.org/stream/301329-t-devtools/topic/rustfmt.20sorting.3F.html#275722432">(Mar 17 2022 at 20:37)</a>:</h4>
<p>/me stares.</p>



<a name="275722438"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/301329-t-devtools/topic/rustfmt%20sorting%3F/near/275722438" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Josh Triplett <a href="https://zulip-archive.rust-lang.org/stream/301329-t-devtools/topic/rustfmt.20sorting.3F.html#275722438">(Mar 17 2022 at 20:37)</a>:</h4>
<p>Well, that certainly is an ordering.</p>



<a name="275722535"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/301329-t-devtools/topic/rustfmt%20sorting%3F/near/275722535" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Josh Triplett <a href="https://zulip-archive.rust-lang.org/stream/301329-t-devtools/topic/rustfmt.20sorting.3F.html#275722535">(Mar 17 2022 at 20:38)</a>:</h4>
<p>Is there any documented rationale for that somewhere? Because that's roughly never what my fingers are going to emit automatically, unlike most of the rest of rustfmt's formatting.</p>



<a name="275722682"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/301329-t-devtools/topic/rustfmt%20sorting%3F/near/275722682" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Josh Triplett <a href="https://zulip-archive.rust-lang.org/stream/301329-t-devtools/topic/rustfmt.20sorting.3F.html#275722682">(Mar 17 2022 at 20:39)</a>:</h4>
<p>(I'm asking in part because as one of the members of the style team I'm wondering if I managed to do this to myself. ;) )</p>



<a name="275727786"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/301329-t-devtools/topic/rustfmt%20sorting%3F/near/275727786" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Josh Triplett <a href="https://zulip-archive.rust-lang.org/stream/301329-t-devtools/topic/rustfmt.20sorting.3F.html#275727786">(Mar 17 2022 at 21:12)</a>:</h4>
<p>AFAICT the style guide just says "ordered alphabetically".</p>



<a name="275728916"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/301329-t-devtools/topic/rustfmt%20sorting%3F/near/275728916" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Josh Triplett <a href="https://zulip-archive.rust-lang.org/stream/301329-t-devtools/topic/rustfmt.20sorting.3F.html#275728916">(Mar 17 2022 at 21:19)</a>:</h4>
<p>More unusual ordering:</p>
<div class="codehilite" data-code-language="Rust"><pre><span></span><code><span class="k">use</span><span class="w"> </span><span class="n">zsort_test</span>::<span class="p">{</span><span class="n">a</span><span class="p">,</span><span class="w"> </span><span class="n">Aa</span><span class="p">,</span><span class="w"> </span><span class="n">WoRD</span><span class="p">,</span><span class="w"> </span><span class="n">Word</span><span class="p">,</span><span class="w"> </span><span class="n">A</span><span class="p">,</span><span class="w"> </span><span class="n">AA</span><span class="p">,</span><span class="w"> </span><span class="n">WORD</span><span class="p">};</span><span class="w"></span>
</code></pre></div>



<a name="275729203"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/301329-t-devtools/topic/rustfmt%20sorting%3F/near/275729203" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Josh Triplett <a href="https://zulip-archive.rust-lang.org/stream/301329-t-devtools/topic/rustfmt.20sorting.3F.html#275729203">(Mar 17 2022 at 21:21)</a>:</h4>
<p>That seems inconsistent with <a href="https://github.com/rust-dev-tools/fmt-rfcs/blob/master/guide/items.md#ordering-list-import">https://github.com/rust-dev-tools/fmt-rfcs/blob/master/guide/items.md#ordering-list-import</a> which says "ascii-betically".</p>



<a name="275729479"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/301329-t-devtools/topic/rustfmt%20sorting%3F/near/275729479" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Josh Triplett <a href="https://zulip-archive.rust-lang.org/stream/301329-t-devtools/topic/rustfmt.20sorting.3F.html#275729479">(Mar 17 2022 at 21:23)</a>:</h4>
<p>Looks like this may have been reported as <a href="https://github.com/rust-lang/rustfmt/issues/4648">https://github.com/rust-lang/rustfmt/issues/4648</a> .</p>



<a name="275730631"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/301329-t-devtools/topic/rustfmt%20sorting%3F/near/275730631" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Josh Triplett <a href="https://zulip-archive.rust-lang.org/stream/301329-t-devtools/topic/rustfmt.20sorting.3F.html#275730631">(Mar 17 2022 at 21:33)</a>:</h4>
<p><code>use brace_group_sort_test::{a, aA, aa, Aa, WoRD, Word, A, AA, WORD};</code></p>



<a name="275730770"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/301329-t-devtools/topic/rustfmt%20sorting%3F/near/275730770" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Josh Triplett <a href="https://zulip-archive.rust-lang.org/stream/301329-t-devtools/topic/rustfmt.20sorting.3F.html#275730770">(Mar 17 2022 at 21:34)</a>:</h4>
<p>I can't think of <em>any</em> sort order that matches these properties. At first I thought it <em>might</em> be "first letter lowercase-first, subsequent letters uppercase-first", but that doesn't explain <code>Aa &lt; WoRD &lt; Word &lt; A &lt; AA &lt; WORD</code></p>



<a name="275730914"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/301329-t-devtools/topic/rustfmt%20sorting%3F/near/275730914" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Josh Triplett <a href="https://zulip-archive.rust-lang.org/stream/301329-t-devtools/topic/rustfmt.20sorting.3F.html#275730914">(Mar 17 2022 at 21:35)</a>:</h4>
<p>Reported as <a href="https://github.com/rust-lang/rustfmt/issues/5269">https://github.com/rust-lang/rustfmt/issues/5269</a> .</p>



<hr><p>Last updated: Apr 12 2022 at 20:01 UTC</p>
</html>