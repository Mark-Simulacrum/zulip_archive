<html>
<head><meta charset="utf-8"><title>Stop caching non-JSON rustc error messages · t-cargo · Zulip Chat Archive</title></head>
<h2>Stream: <a href="https://zulip-archive.rust-lang.org/stream/246057-t-cargo/index.html">t-cargo</a></h2>
<h3>Topic: <a href="https://zulip-archive.rust-lang.org/stream/246057-t-cargo/topic/Stop.20caching.20non-JSON.20rustc.20error.20messages.html">Stop caching non-JSON rustc error messages</a></h3>

<hr>

<base href="https://rust-lang.zulipchat.com">

<head><link href="https://zulip-archive.rust-lang.org/style.css" rel="stylesheet"></head>

<a name="262588808"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/246057-t-cargo/topic/Stop%20caching%20non-JSON%20rustc%20error%20messages/near/262588808" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Weihang Lo <a href="https://zulip-archive.rust-lang.org/stream/246057-t-cargo/topic/Stop.20caching.20non-JSON.20rustc.20error.20messages.html#262588808">(Nov 24 2021 at 13:36)</a>:</h4>
<p>Tools like cargo-bloat leverge <code>RUSTC_WRAPPER</code> and may write to stderr, and then cargo caches their output. However, when switching to other tools or executing <code>cargo build</code>, cached output from those tools is still shown. That is bad since we are not using those tools to build.</p>
<p>I don't think cargo should add wrapper into fingerprint and invalidate when switching. My proposal is not to cache any non-JSON error messages from rustc or wrapper. But I am afraid there are tools depending on this implicit behavior and get broken.</p>
<p>Original issue here: <a href="https://github.com/rust-lang/cargo/issues/9553">https://github.com/rust-lang/cargo/issues/9553</a></p>



<hr><p>Last updated: Apr 12 2022 at 20:01 UTC</p>
</html>