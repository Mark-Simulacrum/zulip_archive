<html>
<head><meta charset="utf-8"><title>Stance on cargo&#x27;s API · t-cargo · Zulip Chat Archive</title></head>
<h2>Stream: <a href="https://zulip-archive.rust-lang.org/stream/246057-t-cargo/index.html">t-cargo</a></h2>
<h3>Topic: <a href="https://zulip-archive.rust-lang.org/stream/246057-t-cargo/topic/Stance.20on.20cargo&#x27;s.20API.html">Stance on cargo&#x27;s API</a></h3>

<hr>

<base href="https://rust-lang.zulipchat.com">

<head><link href="https://zulip-archive.rust-lang.org/style.css" rel="stylesheet"></head>

<a name="277172456"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/246057-t-cargo/topic/Stance%20on%20cargo%27s%20API/near/277172456" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Ed Page <a href="https://zulip-archive.rust-lang.org/stream/246057-t-cargo/topic/Stance.20on.20cargo&#x27;s.20API.html#277172456">(Mar 30 2022 at 16:40)</a>:</h4>
<p>Should we reject most <a href="https://github.com/rust-lang/cargo/issues?q=is%3Aissue+is%3Aopen+api+label%3AA-cargo-api">cargo-api issues</a></p>
<p>We've talked before about how the intended API is the cargo command, rather than the crate.  I can see keeping some issues open around splitting out crates (blocked on nested workspaces) since there are some gray areas but I feel like we could just reject issues around exposing functionality and the ease of use.</p>



<a name="277174925"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/246057-t-cargo/topic/Stance%20on%20cargo%27s%20API/near/277174925" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jon Gjengset <a href="https://zulip-archive.rust-lang.org/stream/246057-t-cargo/topic/Stance.20on.20cargo&#x27;s.20API.html#277174925">(Mar 30 2022 at 16:56)</a>:</h4>
<p>I do kind of worry about the whole "the command is the API" stance, since having to shell out left right and center can get pretty expensive, especially on platforms where exec'ing is costly. And even when it isn't, all those extra re-parses of Rustup and Cargo configuration do add up. Not that I have a better suggestion, just wanted to register the concern.</p>



<a name="277183641"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/246057-t-cargo/topic/Stance%20on%20cargo%27s%20API/near/277183641" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Josh Triplett <a href="https://zulip-archive.rust-lang.org/stream/246057-t-cargo/topic/Stance.20on.20cargo&#x27;s.20API.html#277183641">(Mar 30 2022 at 18:00)</a>:</h4>
<p><span class="user-mention" data-user-id="120054">@Jon Gjengset</span> That's valid, and I don't think anyone is saying we don't <em>want</em> an API, just that we don't have time to maintain one.</p>



<a name="277183737"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/246057-t-cargo/topic/Stance%20on%20cargo%27s%20API/near/277183737" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Josh Triplett <a href="https://zulip-archive.rust-lang.org/stream/246057-t-cargo/topic/Stance.20on.20cargo&#x27;s.20API.html#277183737">(Mar 30 2022 at 18:00)</a>:</h4>
<p>I think it'd be appropriate to make sure they're labeled appropriately (so that they can get reconsidered later) and close them.</p>



<a name="277202441"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/246057-t-cargo/topic/Stance%20on%20cargo%27s%20API/near/277202441" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Eric Huss <a href="https://zulip-archive.rust-lang.org/stream/246057-t-cargo/topic/Stance.20on.20cargo&#x27;s.20API.html#277202441">(Mar 30 2022 at 20:51)</a>:</h4>
<p>Yea, I agree with Josh here.  In many cases, a user's experience will be much better if tools use the CLI. It handles rustup, avoids build issues, avoids the treadmill of updates, etc.  But that doesn't mean we will <em>prevent</em> people from using the library. It will continue to be published for the foreseeable future.</p>
<p>As for the specific issues that are currently tagged, most of them seem worthy to keep open.  I'd maybe close a few of them, though.</p>



<a name="277206442"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/246057-t-cargo/topic/Stance%20on%20cargo%27s%20API/near/277206442" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Nelson <a href="https://zulip-archive.rust-lang.org/stream/246057-t-cargo/topic/Stance.20on.20cargo&#x27;s.20API.html#277206442">(Mar 30 2022 at 21:29)</a>:</h4>
<p>FWIW, the stance rustdoc has had for forever is "if you want to use rustdoc as an API, fork the crate or use --output-format json"</p>



<a name="277206510"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/246057-t-cargo/topic/Stance%20on%20cargo%27s%20API/near/277206510" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Nelson <a href="https://zulip-archive.rust-lang.org/stream/246057-t-cargo/topic/Stance.20on.20cargo&#x27;s.20API.html#277206510">(Mar 30 2022 at 21:30)</a>:</h4>
<p>to the extent that the only public function is <code>main()</code> (plus a couple things called by <code>error-index-generator</code>)</p>



<a name="277695089"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/246057-t-cargo/topic/Stance%20on%20cargo%27s%20API/near/277695089" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Nick Cameron <a href="https://zulip-archive.rust-lang.org/stream/246057-t-cargo/topic/Stance.20on.20cargo&#x27;s.20API.html#277695089">(Apr 04 2022 at 08:03)</a>:</h4>
<p>I'd also say that if the CLI is the only API that means there is pressure to make the CLI do everything that people might want out of an API, which is probably not good for the CLI's UX for other users. I think having a high quality data dump (like Rustdoc's json) is a good idea in general, but this has not worked out very well in the past, and also takes time to maintain.</p>



<a name="277695247"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/246057-t-cargo/topic/Stance%20on%20cargo%27s%20API/near/277695247" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Nick Cameron <a href="https://zulip-archive.rust-lang.org/stream/246057-t-cargo/topic/Stance.20on.20cargo&#x27;s.20API.html#277695247">(Apr 04 2022 at 08:05)</a>:</h4>
<p>Having an API also often leads to better modularity of design. In combination with making Cargo more modular by factoring out crates, it seems like a public API would almost happen 'for free' (though of course, the stability contract means there is more maintenance burden).</p>



<hr><p>Last updated: Apr 12 2022 at 20:01 UTC</p>
</html>