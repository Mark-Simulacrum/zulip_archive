<html>
<head><meta charset="utf-8"><title>clarifying sources · t-cargo · Zulip Chat Archive</title></head>
<h2>Stream: <a href="https://zulip-archive.rust-lang.org/stream/246057-t-cargo/index.html">t-cargo</a></h2>
<h3>Topic: <a href="https://zulip-archive.rust-lang.org/stream/246057-t-cargo/topic/clarifying.20sources.html">clarifying sources</a></h3>

<hr>

<base href="https://rust-lang.zulipchat.com">

<head><link href="https://zulip-archive.rust-lang.org/style.css" rel="stylesheet"></head>

<a name="261134485"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/246057-t-cargo/topic/clarifying%20sources/near/261134485" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> gspr <a href="https://zulip-archive.rust-lang.org/stream/246057-t-cargo/topic/clarifying.20sources.html#261134485">(Nov 11 2021 at 13:37)</a>:</h4>
<p>Apologies in advance if it's not customary for outsiders to just barge in and create a new topic here. I'm unfamiliar with Zulip. I've been stuck on something I want to do with Cargo (as a user), and it's unclear to me whether it's something I'm just completely misunderstanding or whether it's an actual lacking feature in Cargo. People in #beginners on the Rust discord pointed me here.</p>
<p>I'm struggling to understand how <code>source</code> stanzas are supposed to work in the Cargo config when doing something other than source replacement. Specifically, I currently source-replace <code>source.crates-io</code> with another source <code>source.foo</code>. The latter is of type <code>directory = …</code>, and works exactly like I want it to. What I don't understand (either due to being confused, or, less likely, due to it missing from Cargo) is how I can add <em>another</em> <code>directory = …</code>-type <code>source.bar</code> so that Cargo first looks in <code>source.foo</code>, and if a dependency isn't found there, it goes on and looks in <code>source.bar</code>?</p>



<a name="261136053"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/246057-t-cargo/topic/clarifying%20sources/near/261136053" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> gspr <a href="https://zulip-archive.rust-lang.org/stream/246057-t-cargo/topic/clarifying.20sources.html#261136053">(Nov 11 2021 at 13:50)</a>:</h4>
<p>I'm quire sure I'm just misunderstanding something somewhere. I'm just trying to do the equivalent of setting <code>PYTHONPATH</code> in Python, or <code>LD_LIBRARY_PATH</code> + <code>-I</code>/<code>-L</code> with GCC, etc. Without altering a given project itself, just say to Cargo "go look for dependencies here, then here if you didn't find them, then here". Where there "here"s are just local directories.</p>



<a name="261137108"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/246057-t-cargo/topic/clarifying%20sources/near/261137108" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> bjorn3 <a href="https://zulip-archive.rust-lang.org/stream/246057-t-cargo/topic/clarifying.20sources.html#261137108">(Nov 11 2021 at 14:00)</a>:</h4>
<p>This is not how cargo is normally used. Normally you specify either a dependency from <a href="http://crates.io">crates.io</a> (which will be downloaded automatically), one from a git repo (also downloaded automatically) or a location relative to the current crate (in case you have multiple crates in the same project).</p>



<a name="261137439"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/246057-t-cargo/topic/clarifying%20sources/near/261137439" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> gspr <a href="https://zulip-archive.rust-lang.org/stream/246057-t-cargo/topic/clarifying.20sources.html#261137439">(Nov 11 2021 at 14:03)</a>:</h4>
<p>But seeing as it's very easy to replace <a href="http://crates.io">crates.io</a> with "just a directory" (using source replacement of type <code>directory = …</code>), wouldn't it be nice to be able to add more directory sources too?</p>



<a name="261137548"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/246057-t-cargo/topic/clarifying%20sources/near/261137548" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> gspr <a href="https://zulip-archive.rust-lang.org/stream/246057-t-cargo/topic/clarifying.20sources.html#261137548">(Nov 11 2021 at 14:04)</a>:</h4>
<p>It just seems strange to me that one cannot easily say "look here for the dependencies of the project being built, Cargo" without also having to modify the project itself :(</p>



<a name="261137621"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/246057-t-cargo/topic/clarifying%20sources/near/261137621" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> gspr <a href="https://zulip-archive.rust-lang.org/stream/246057-t-cargo/topic/clarifying.20sources.html#261137621">(Nov 11 2021 at 14:04)</a>:</h4>
<p>(Maybe I'm just strange, but I just don't wanna have code grabbed from the Internet to satisfy my build dependencies. I wanna orchestrate this myself, together with my distro.)</p>



<a name="261137687"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/246057-t-cargo/topic/clarifying%20sources/near/261137687" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> gspr <a href="https://zulip-archive.rust-lang.org/stream/246057-t-cargo/topic/clarifying.20sources.html#261137687">(Nov 11 2021 at 14:05)</a>:</h4>
<p>I realize the "get everything from <a href="http://crates.io">crates.io</a>" is a very convenient default mode of operation, but I'm just confused as to how to opt out of it in a flexible way. All the pieces seem to be there – in particular as <code>directory = …</code>-type sources.</p>



<a name="261138888"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/246057-t-cargo/topic/clarifying%20sources/near/261138888" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> bjorn3 <a href="https://zulip-archive.rust-lang.org/stream/246057-t-cargo/topic/clarifying.20sources.html#261138888">(Nov 11 2021 at 14:16)</a>:</h4>
<p>Replacing <a href="http://crates.io">crates.io</a> with a directory is meant for vendoring when the build has to take place without an internet connection. You still shouldn't actually modify the dependency source. There are hashes to prevent malicious manipulation from a registry (using the trust on first use principle)</p>



<a name="261145186"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/246057-t-cargo/topic/clarifying%20sources/near/261145186" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> gspr <a href="https://zulip-archive.rust-lang.org/stream/246057-t-cargo/topic/clarifying.20sources.html#261145186">(Nov 11 2021 at 15:10)</a>:</h4>
<p>Ah yeah I didn't mean to modify the dependency source. I meant provide a set of local sources for a given project without having to modify that project's Cargo.toml.</p>



<a name="261145380"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/246057-t-cargo/topic/clarifying%20sources/near/261145380" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> gspr <a href="https://zulip-archive.rust-lang.org/stream/246057-t-cargo/topic/clarifying.20sources.html#261145380">(Nov 11 2021 at 15:12)</a>:</h4>
<p>One such local source can easily be provided, as I'm doing today, by source-replacing <code>source.crates-io</code> with a new source <code>source.foo</code> of type <code>directory = /some/local/dir</code>. That's working great. But <code>source.foo</code> only has a subset of what <a href="http://crates.io">crates.io</a> has. I wanna provide also <code>source.bar</code>, another local directory, that has <em>another</em> subset. Then I'd like Cargo to look first in <code>source.foo</code> (due to it source-replacing <code>source.crates-io</code>), then in <code>source.bar</code> if it can't find the deps there.</p>



<a name="261145416"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/246057-t-cargo/topic/clarifying%20sources/near/261145416" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> gspr <a href="https://zulip-archive.rust-lang.org/stream/246057-t-cargo/topic/clarifying.20sources.html#261145416">(Nov 11 2021 at 15:12)</a>:</h4>
<p>(All without having to modify the Cargo.toml of the project I'm building.</p>



<a name="261146720"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/246057-t-cargo/topic/clarifying%20sources/near/261146720" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Eh2406 <a href="https://zulip-archive.rust-lang.org/stream/246057-t-cargo/topic/clarifying.20sources.html#261146720">(Nov 11 2021 at 15:22)</a>:</h4>
<p>I believe the current recommendation is to put all your vendored libraries in one directory.</p>



<a name="261146968"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/246057-t-cargo/topic/clarifying%20sources/near/261146968" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Eh2406 <a href="https://zulip-archive.rust-lang.org/stream/246057-t-cargo/topic/clarifying.20sources.html#261146968">(Nov 11 2021 at 15:24)</a>:</h4>
<p>We do not have a concept of "source fall back". Sources are a specific place to look for code, not a chain of if then statements.<br>
This position has disadvantages. But coincidentally it's been very helpful in protecting against dependency confusion attacks.</p>



<a name="261147116"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/246057-t-cargo/topic/clarifying%20sources/near/261147116" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> gspr <a href="https://zulip-archive.rust-lang.org/stream/246057-t-cargo/topic/clarifying.20sources.html#261147116">(Nov 11 2021 at 15:26)</a>:</h4>
<p>Hmm, so there's no way to have a <em>set</em> of directories that make up local sources?</p>



<a name="261147202"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/246057-t-cargo/topic/clarifying%20sources/near/261147202" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> gspr <a href="https://zulip-archive.rust-lang.org/stream/246057-t-cargo/topic/clarifying.20sources.html#261147202">(Nov 11 2021 at 15:26)</a>:</h4>
<p>Without firing up a full-blown local registry, I mean. Which seems a bit overkill :(</p>



<a name="261147290"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/246057-t-cargo/topic/clarifying%20sources/near/261147290" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> gspr <a href="https://zulip-archive.rust-lang.org/stream/246057-t-cargo/topic/clarifying.20sources.html#261147290">(Nov 11 2021 at 15:27)</a>:</h4>
<p>It would, at a minimum, be nice to be able to explicitly tell Cargo that <em>this time</em> I want you to also look in this directory for dependencies. That should aleviate any dependency confusion concerns, right?</p>



<a name="261147341"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/246057-t-cargo/topic/clarifying%20sources/near/261147341" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Eh2406 <a href="https://zulip-archive.rust-lang.org/stream/246057-t-cargo/topic/clarifying.20sources.html#261147341">(Nov 11 2021 at 15:27)</a>:</h4>
<blockquote>
<p>Hmm, so there's no way to have a set of directories that make up local sources?</p>
</blockquote>
<p>Not that I can think of. But other more creative people may come around.</p>



<a name="261147350"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/246057-t-cargo/topic/clarifying%20sources/near/261147350" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> gspr <a href="https://zulip-archive.rust-lang.org/stream/246057-t-cargo/topic/clarifying.20sources.html#261147350">(Nov 11 2021 at 15:27)</a>:</h4>
<p>(I don't mean to be barging in here telling people how Cargo <em>should</em> behave. I just feel I must be overlooking something if the tooling can't be directed to do something conceptually so simple.)</p>



<a name="261147441"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/246057-t-cargo/topic/clarifying%20sources/near/261147441" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Eh2406 <a href="https://zulip-archive.rust-lang.org/stream/246057-t-cargo/topic/clarifying.20sources.html#261147441">(Nov 11 2021 at 15:28)</a>:</h4>
<p>It is entirely possible that this conversation will lead to an RFC to add this behavior.</p>



<a name="261147450"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/246057-t-cargo/topic/clarifying%20sources/near/261147450" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> gspr <a href="https://zulip-archive.rust-lang.org/stream/246057-t-cargo/topic/clarifying.20sources.html#261147450">(Nov 11 2021 at 15:28)</a>:</h4>
<p>:P</p>



<a name="261147497"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/246057-t-cargo/topic/clarifying%20sources/near/261147497" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> gspr <a href="https://zulip-archive.rust-lang.org/stream/246057-t-cargo/topic/clarifying.20sources.html#261147497">(Nov 11 2021 at 15:28)</a>:</h4>
<p>I did file an issue (<a href="https://github.com/rust-lang/cargo/issues/10045">https://github.com/rust-lang/cargo/issues/10045</a>), but I wasn't sure whether I was just misunderstanding, so I thought I'd have an interactive conversation about it.</p>



<a name="261147558"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/246057-t-cargo/topic/clarifying%20sources/near/261147558" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> gspr <a href="https://zulip-archive.rust-lang.org/stream/246057-t-cargo/topic/clarifying.20sources.html#261147558">(Nov 11 2021 at 15:29)</a>:</h4>
<p>It does seem pretty clear that the functionality just isn't present. And I do totally understand prioritizing the convenience of <a href="http://crates.io">crates.io</a>. But it does seem like a missing feature to me.</p>



<a name="261147582"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/246057-t-cargo/topic/clarifying%20sources/near/261147582" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Eh2406 <a href="https://zulip-archive.rust-lang.org/stream/246057-t-cargo/topic/clarifying.20sources.html#261147582">(Nov 11 2021 at 15:29)</a>:</h4>
<p>We are not great about having responsive discussions in issues. Sorry.</p>



<a name="261147670"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/246057-t-cargo/topic/clarifying%20sources/near/261147670" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> gspr <a href="https://zulip-archive.rust-lang.org/stream/246057-t-cargo/topic/clarifying.20sources.html#261147670">(Nov 11 2021 at 15:30)</a>:</h4>
<p>No worries, I wasn't expecting that at all. To be honest I think GH issues too often get bogged down in endless discussions.</p>



<a name="261148042"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/246057-t-cargo/topic/clarifying%20sources/near/261148042" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> gspr <a href="https://zulip-archive.rust-lang.org/stream/246057-t-cargo/topic/clarifying.20sources.html#261148042">(Nov 11 2021 at 15:33)</a>:</h4>
<p>To elaborate a bit on what I'm trying to do here: I'm perhaps old-fashioned, but I still like the idea of distro-provided, locally installed dependencies. I'm quite new to Rust, but in the half year or so I've been learning, I've found it surprisingly workable to just configure Cargo to run offline and source-replace <code>source.crates-io</code> with a source with <code>directory = /path/to/where/debian/puts/crates</code>. I realize this is a pretty strange corner use case, but this kind of setup would become orders of magnitude more flexible and liveable if one could specify a priority list of sources (possibly requiring an explicit opt-in to avoid dependency confusion attacks).</p>



<a name="261148172"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/246057-t-cargo/topic/clarifying%20sources/near/261148172" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> gspr <a href="https://zulip-archive.rust-lang.org/stream/246057-t-cargo/topic/clarifying.20sources.html#261148172">(Nov 11 2021 at 15:34)</a>:</h4>
<p>And besides my admittedly rather strange desires, I wouldn't be surprised if organizations run their own quite limited registries that individual developers sometimes wanna add just a few crates to. It would be extremely convenient to just be able to drop a few more directories into ~/.cargo/config.toml</p>



<a name="261148181"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/246057-t-cargo/topic/clarifying%20sources/near/261148181" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Eh2406 <a href="https://zulip-archive.rust-lang.org/stream/246057-t-cargo/topic/clarifying.20sources.html#261148181">(Nov 11 2021 at 15:34)</a>:</h4>
<p>We have a lot of experience with what works with Cargo, but that also can make us a little blind to what doesn't work.<br>
A discussion to convince us (with ^ prospective) to change this will need to explain the bigger problem being solved, and why this is a good solution. Like EL5 why this is not an X-Y Problem. (Looks like you started that while I was typing.)</p>



<a name="261148350"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/246057-t-cargo/topic/clarifying%20sources/near/261148350" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Eh2406 <a href="https://zulip-archive.rust-lang.org/stream/246057-t-cargo/topic/clarifying.20sources.html#261148350">(Nov 11 2021 at 15:35)</a>:</h4>
<p>So you want to be able to use the directory registry provided by Debian, and a manually curated list from another directory registry?</p>



<a name="261148969"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/246057-t-cargo/topic/clarifying%20sources/near/261148969" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> gspr <a href="https://zulip-archive.rust-lang.org/stream/246057-t-cargo/topic/clarifying.20sources.html#261148969">(Nov 11 2021 at 15:40)</a>:</h4>
<p>Yeah. Or, more generally, just a manually curated list of prioritized directory registries (that Debian would be one such directory registry is just one example use case).</p>



<a name="261149018"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/246057-t-cargo/topic/clarifying%20sources/near/261149018" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> gspr <a href="https://zulip-archive.rust-lang.org/stream/246057-t-cargo/topic/clarifying.20sources.html#261149018">(Nov 11 2021 at 15:41)</a>:</h4>
<p>(By the way, I'm a bit new to the terminology. Is a "directory registry" the same as a "source with a <code>directory = …</code> key"? I'm semi-assuming so above)</p>



<a name="261149231"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/246057-t-cargo/topic/clarifying%20sources/near/261149231" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Eh2406 <a href="https://zulip-archive.rust-lang.org/stream/246057-t-cargo/topic/clarifying.20sources.html#261149231">(Nov 11 2021 at 15:43)</a>:</h4>
<p>I was intending for them to be equivalent.</p>



<a name="261149282"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/246057-t-cargo/topic/clarifying%20sources/near/261149282" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> gspr <a href="https://zulip-archive.rust-lang.org/stream/246057-t-cargo/topic/clarifying.20sources.html#261149282">(Nov 11 2021 at 15:43)</a>:</h4>
<p>Another use case could an organization which has a centrally managed registry (in place of <a href="http://crates.io">crates.io</a>). It's not unimagineable that people in said organization have to work offline, and could perhaps want to bring in a few single crates from the outside (perhaps obtained from <a href="http://crates.io">crates.io</a> manually, perhaps not) that aren't available in the organization's registry.</p>



<a name="261149509"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/246057-t-cargo/topic/clarifying%20sources/near/261149509" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> gspr <a href="https://zulip-archive.rust-lang.org/stream/246057-t-cargo/topic/clarifying.20sources.html#261149509">(Nov 11 2021 at 15:45)</a>:</h4>
<p>I suppose all of this can always be solved by setting up extra local registries, but that's a pretty heavyweight solution when one may reasonably just want to tell Cargo "look in this directory if your default registry doesn't provide what's needed".</p>



<a name="261149687"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/246057-t-cargo/topic/clarifying%20sources/near/261149687" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Eh2406 <a href="https://zulip-archive.rust-lang.org/stream/246057-t-cargo/topic/clarifying.20sources.html#261149687">(Nov 11 2021 at 15:47)</a>:</h4>
<p>It is conceivable, but so far the companies that have worked with us to find solutions have had systems that were far more complicated than that.<br>
Speaking of which, <a href="https://doc.rust-lang.org/cargo/reference/config.html#patch">https://doc.rust-lang.org/cargo/reference/config.html#patch</a> can probably be made to work. Not as elegantly but stable today.</p>



<a name="261150318"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/246057-t-cargo/topic/clarifying%20sources/near/261150318" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> gspr <a href="https://zulip-archive.rust-lang.org/stream/246057-t-cargo/topic/clarifying.20sources.html#261150318">(Nov 11 2021 at 15:52)</a>:</h4>
<p>Ahh, I didn't know that <code>[patch]</code> could also be used in Cargo's config (I thought it was <code>Cargo.toml</code> only)</p>



<a name="261150329"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/246057-t-cargo/topic/clarifying%20sources/near/261150329" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> gspr <a href="https://zulip-archive.rust-lang.org/stream/246057-t-cargo/topic/clarifying.20sources.html#261150329">(Nov 11 2021 at 15:52)</a>:</h4>
<p>That's useful.</p>



<a name="261150382"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/246057-t-cargo/topic/clarifying%20sources/near/261150382" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Eh2406 <a href="https://zulip-archive.rust-lang.org/stream/246057-t-cargo/topic/clarifying.20sources.html#261150382">(Nov 11 2021 at 15:53)</a>:</h4>
<p>It's a fairly new feature.</p>



<a name="261150433"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/246057-t-cargo/topic/clarifying%20sources/near/261150433" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Eh2406 <a href="https://zulip-archive.rust-lang.org/stream/246057-t-cargo/topic/clarifying.20sources.html#261150433">(Nov 11 2021 at 15:53)</a>:</h4>
<p>An intended to be for "corner cases only"</p>



<a name="261150511"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/246057-t-cargo/topic/clarifying%20sources/near/261150511" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> gspr <a href="https://zulip-archive.rust-lang.org/stream/246057-t-cargo/topic/clarifying.20sources.html#261150511">(Nov 11 2021 at 15:54)</a>:</h4>
<p>I do realize that many organizations' needs are probably vastly more complicated again. I just feel there should be some intermediate solution between "run your own registry" and nothing at all for the simpler versions of this use case.</p>



<a name="261150535"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/246057-t-cargo/topic/clarifying%20sources/near/261150535" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> gspr <a href="https://zulip-archive.rust-lang.org/stream/246057-t-cargo/topic/clarifying.20sources.html#261150535">(Nov 11 2021 at 15:54)</a>:</h4>
<p>Got it. I'll explore it for sure!</p>



<a name="261150720"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/246057-t-cargo/topic/clarifying%20sources/near/261150720" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Eh2406 <a href="https://zulip-archive.rust-lang.org/stream/246057-t-cargo/topic/clarifying.20sources.html#261150720">(Nov 11 2021 at 15:55)</a>:</h4>
<p>I do look forward to hearing the opinions of other members of the team.</p>



<a name="261150809"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/246057-t-cargo/topic/clarifying%20sources/near/261150809" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> gspr <a href="https://zulip-archive.rust-lang.org/stream/246057-t-cargo/topic/clarifying.20sources.html#261150809">(Nov 11 2021 at 15:56)</a>:</h4>
<p>By the way, a stupid question since I'm here anyway: Is there any way to run a "local registry" (by which I mean a full-blown registry, but running on localhost) with <code>net.offline = true</code>?</p>



<a name="261150874"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/246057-t-cargo/topic/clarifying%20sources/near/261150874" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> gspr <a href="https://zulip-archive.rust-lang.org/stream/246057-t-cargo/topic/clarifying.20sources.html#261150874">(Nov 11 2021 at 15:57)</a>:</h4>
<p>Because if I can't wiggle my way out of this corner, I think my next step would be to create some registry that runs locally and essentially overlays a list of priotized directories to emulate what I want.</p>



<a name="261151127"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/246057-t-cargo/topic/clarifying%20sources/near/261151127" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Eh2406 <a href="https://zulip-archive.rust-lang.org/stream/246057-t-cargo/topic/clarifying.20sources.html#261151127">(Nov 11 2021 at 15:58)</a>:</h4>
<p>I don't think so. But proposals to make offline more targeted, are definitely worth thinking about.</p>



<a name="261159281"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/246057-t-cargo/topic/clarifying%20sources/near/261159281" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> bjorn3 <a href="https://zulip-archive.rust-lang.org/stream/246057-t-cargo/topic/clarifying.20sources.html#261159281">(Nov 11 2021 at 17:03)</a>:</h4>
<p><span class="user-mention silent" data-user-id="456876">gspr</span> <a href="#narrow/stream/246057-t-cargo/topic/clarifying.20sources/near/261149282">said</a>:</p>
<blockquote>
<p>Another use case could an organization which has a centrally managed registry (in place of <a href="http://crates.io">crates.io</a>). It's not unimagineable that people in said organization have to work offline, and could perhaps want to bring in a few single crates from the outside (perhaps obtained from <a href="http://crates.io">crates.io</a> manually, perhaps not) that aren't available in the organization's registry.</p>
</blockquote>
<p>You can replace just the crates-io registry for offline availability if crates from <a href="http://crates.io">crates.io</a>, but keep another registry for the organization. You probably shouldn't mix them in the same registry.</p>



<a name="261177308"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/246057-t-cargo/topic/clarifying%20sources/near/261177308" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nnethercote <a href="https://zulip-archive.rust-lang.org/stream/246057-t-cargo/topic/clarifying.20sources.html#261177308">(Nov 11 2021 at 19:48)</a>:</h4>
<p><span class="user-mention" data-user-id="456876">@gspr</span> (BTW, barging in and creating a topic is fine <span aria-label="smile" class="emoji emoji-1f642" role="img" title="smile">:smile:</span> )</p>



<hr><p>Last updated: Apr 12 2022 at 20:01 UTC</p>
</html>