<html>
<head><meta charset="utf-8"><title>How can I distinguish two commits of the same git dep? · t-cargo · Zulip Chat Archive</title></head>
<h2>Stream: <a href="https://zulip-archive.rust-lang.org/stream/246057-t-cargo/index.html">t-cargo</a></h2>
<h3>Topic: <a href="https://zulip-archive.rust-lang.org/stream/246057-t-cargo/topic/How.20can.20I.20distinguish.20two.20commits.20of.20the.20same.20git.20dep.3F.html">How can I distinguish two commits of the same git dep?</a></h3>

<hr>

<base href="https://rust-lang.zulipchat.com">

<head><link href="https://zulip-archive.rust-lang.org/style.css" rel="stylesheet"></head>

<a name="266854230"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/246057-t-cargo/topic/How%20can%20I%20distinguish%20two%20commits%20of%20the%20same%20git%20dep%3F/near/266854230" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Nelson <a href="https://zulip-archive.rust-lang.org/stream/246057-t-cargo/topic/How.20can.20I.20distinguish.20two.20commits.20of.20the.20same.20git.20dep.3F.html#266854230">(Jan 04 2022 at 19:49)</a>:</h4>
<p>I'm trying to update a git dependency from one revision to another. It's giving me the following error:</p>
<div class="codehilite"><pre><span></span><code>$ cargo update -p service-common
error: There are multiple `service-common` packages in your project, and the specification `service-common` is ambiguous.
Please re-run this command with `-p &lt;spec&gt;` where `&lt;spec&gt;` is one of the following:
  ssh://git@redacted/service-common.git#service-common:2020.8.0
  ssh://git@redacted/service-common.git#service-common:2020.8.0
</code></pre></div>
<p>Showing the same spec twice seems like a bug - how can I specify the git hash in the <code>-p</code> argument?</p>



<a name="266854797"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/246057-t-cargo/topic/How%20can%20I%20distinguish%20two%20commits%20of%20the%20same%20git%20dep%3F/near/266854797" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Nelson <a href="https://zulip-archive.rust-lang.org/stream/246057-t-cargo/topic/How.20can.20I.20distinguish.20two.20commits.20of.20the.20same.20git.20dep.3F.html#266854797">(Jan 04 2022 at 19:54)</a>:</h4>
<p>I tried <code>cargo update -p service-common#f2a027a5</code> but it says that <code>#</code> is invalid :(</p>



<a name="266854939"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/246057-t-cargo/topic/How%20can%20I%20distinguish%20two%20commits%20of%20the%20same%20git%20dep%3F/near/266854939" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Eric Huss <a href="https://zulip-archive.rust-lang.org/stream/246057-t-cargo/topic/How.20can.20I.20distinguish.20two.20commits.20of.20the.20same.20git.20dep.3F.html#266854939">(Jan 04 2022 at 19:55)</a>:</h4>
<p>Hm, that's strange.  Do you have two instances of that package in <code>Cargo.lock</code> with that same tag <code>2020.8.0</code>?   That shouldn't happen I think.</p>



<a name="266854952"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/246057-t-cargo/topic/How%20can%20I%20distinguish%20two%20commits%20of%20the%20same%20git%20dep%3F/near/266854952" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Nelson <a href="https://zulip-archive.rust-lang.org/stream/246057-t-cargo/topic/How.20can.20I.20distinguish.20two.20commits.20of.20the.20same.20git.20dep.3F.html#266854952">(Jan 04 2022 at 19:55)</a>:</h4>
<p>yes, but with different git commits</p>



<a name="266855059"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/246057-t-cargo/topic/How%20can%20I%20distinguish%20two%20commits%20of%20the%20same%20git%20dep%3F/near/266855059" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Eric Huss <a href="https://zulip-archive.rust-lang.org/stream/246057-t-cargo/topic/How.20can.20I.20distinguish.20two.20commits.20of.20the.20same.20git.20dep.3F.html#266855059">(Jan 04 2022 at 19:56)</a>:</h4>
<p>Do you know how that might have happened?</p>



<a name="266855078"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/246057-t-cargo/topic/How%20can%20I%20distinguish%20two%20commits%20of%20the%20same%20git%20dep%3F/near/266855078" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Nelson <a href="https://zulip-archive.rust-lang.org/stream/246057-t-cargo/topic/How.20can.20I.20distinguish.20two.20commits.20of.20the.20same.20git.20dep.3F.html#266855078">(Jan 04 2022 at 19:56)</a>:</h4>
<p>err uh hold on</p>



<a name="266855101"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/246057-t-cargo/topic/How%20can%20I%20distinguish%20two%20commits%20of%20the%20same%20git%20dep%3F/near/266855101" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Nelson <a href="https://zulip-archive.rust-lang.org/stream/246057-t-cargo/topic/How.20can.20I.20distinguish.20two.20commits.20of.20the.20same.20git.20dep.3F.html#266855101">(Jan 04 2022 at 19:56)</a>:</h4>
<p>Cargo.lock actually only has one vrsion</p>



<a name="266855135"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/246057-t-cargo/topic/How%20can%20I%20distinguish%20two%20commits%20of%20the%20same%20git%20dep%3F/near/266855135" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Nelson <a href="https://zulip-archive.rust-lang.org/stream/246057-t-cargo/topic/How.20can.20I.20distinguish.20two.20commits.20of.20the.20same.20git.20dep.3F.html#266855135">(Jan 04 2022 at 19:56)</a>:</h4>
<p>but in Cargo.toml we have it pinned to another commit which doesn't match cargo.lock (!!)</p>



<a name="266855187"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/246057-t-cargo/topic/How%20can%20I%20distinguish%20two%20commits%20of%20the%20same%20git%20dep%3F/near/266855187" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Nelson <a href="https://zulip-archive.rust-lang.org/stream/246057-t-cargo/topic/How.20can.20I.20distinguish.20two.20commits.20of.20the.20same.20git.20dep.3F.html#266855187">(Jan 04 2022 at 19:57)</a>:</h4>
<p>if it helps, the version in cargo.lock comes from one of our dependencies</p>



<a name="266855245"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/246057-t-cargo/topic/How%20can%20I%20distinguish%20two%20commits%20of%20the%20same%20git%20dep%3F/near/266855245" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Eric Huss <a href="https://zulip-archive.rust-lang.org/stream/246057-t-cargo/topic/How.20can.20I.20distinguish.20two.20commits.20of.20the.20same.20git.20dep.3F.html#266855245">(Jan 04 2022 at 19:57)</a>:</h4>
<p>What does the line in <code>Cargo.toml</code> look like where you have it pinned?</p>



<a name="266855359"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/246057-t-cargo/topic/How%20can%20I%20distinguish%20two%20commits%20of%20the%20same%20git%20dep%3F/near/266855359" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Nelson <a href="https://zulip-archive.rust-lang.org/stream/246057-t-cargo/topic/How.20can.20I.20distinguish.20two.20commits.20of.20the.20same.20git.20dep.3F.html#266855359">(Jan 04 2022 at 19:58)</a>:</h4>
<div class="codehilite" data-code-language="TOML"><pre><span></span><code><span class="k">[dependencies]</span>
<span class="n">service-common</span> <span class="o">=</span> <span class="p">{</span> <span class="n">git</span> <span class="o">=</span> <span class="s">"ssh://git@redacted/service-common.git"</span><span class="p">,</span> <span class="n">rev</span> <span class="o">=</span> <span class="s">"f2a027a5907b093dd6e5b54b2eb0b2473d2fbb38"</span> <span class="p">}</span>
</code></pre></div>



<a name="266855695"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/246057-t-cargo/topic/How%20can%20I%20distinguish%20two%20commits%20of%20the%20same%20git%20dep%3F/near/266855695" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Nelson <a href="https://zulip-archive.rust-lang.org/stream/246057-t-cargo/topic/How.20can.20I.20distinguish.20two.20commits.20of.20the.20same.20git.20dep.3F.html#266855695">(Jan 04 2022 at 20:01)</a>:</h4>
<p>ok, changing <code>rev</code> to match the version in Cargo.lock successfully unconfuses cargo <span aria-label="tada" class="emoji emoji-1f389" role="img" title="tada">:tada:</span></p>



<a name="266855834"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/246057-t-cargo/topic/How%20can%20I%20distinguish%20two%20commits%20of%20the%20same%20git%20dep%3F/near/266855834" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Nelson <a href="https://zulip-archive.rust-lang.org/stream/246057-t-cargo/topic/How.20can.20I.20distinguish.20two.20commits.20of.20the.20same.20git.20dep.3F.html#266855834">(Jan 04 2022 at 20:03)</a>:</h4>
<p>changing <code>rev = "..."</code> to <code>branch = "master"</code> promptly confuses it again though</p>



<a name="266855920"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/246057-t-cargo/topic/How%20can%20I%20distinguish%20two%20commits%20of%20the%20same%20git%20dep%3F/near/266855920" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Nelson <a href="https://zulip-archive.rust-lang.org/stream/246057-t-cargo/topic/How.20can.20I.20distinguish.20two.20commits.20of.20the.20same.20git.20dep.3F.html#266855920">(Jan 04 2022 at 20:03)</a>:</h4>
<p>I guess we'll have to change it in the upstream dependency, it thinks the branch means it's a different source:</p>
<div class="codehilite"><pre><span></span><code>$ grep service-common Cargo.lock
 &quot;service-common 2020.8.0 (git+ssh://git@redacted/service-common.git?rev=0f5d38a082ec97316ee58002e370d4c030e79e7a)&quot;,
 &quot;service-common 2020.8.0 (git+ssh://git@redacted/service-common.git?rev=0f5d38a082ec97316ee58002e370d4c030e79e7a)&quot;,
 &quot;service-common 2020.8.0 (git+ssh://git@redacted/service-common.git?branch=master)&quot;,
name = &quot;service-common&quot;
source = &quot;git+ssh://git@redacted/service-common.git?branch=master#0f5d38a082ec97316ee58002e370d4c030e79e7a&quot;
name = &quot;service-common&quot;
source = &quot;git+ssh://git@redacted/service-common.git?rev=0f5d38a082ec97316ee58002e370d4c030e79e7a#0f5d38a082ec97316ee58002e370d4c030e79e7a&quot;
</code></pre></div>



<a name="266859123"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/246057-t-cargo/topic/How%20can%20I%20distinguish%20two%20commits%20of%20the%20same%20git%20dep%3F/near/266859123" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Eric Huss <a href="https://zulip-archive.rust-lang.org/stream/246057-t-cargo/topic/How.20can.20I.20distinguish.20two.20commits.20of.20the.20same.20git.20dep.3F.html#266859123">(Jan 04 2022 at 20:31)</a>:</h4>
<p>I'll open an issue on this.  There are a few similar issues related to this, but I'm not sure if they are duplicates.</p>



<a name="266862605"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/246057-t-cargo/topic/How%20can%20I%20distinguish%20two%20commits%20of%20the%20same%20git%20dep%3F/near/266862605" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Eric Huss <a href="https://zulip-archive.rust-lang.org/stream/246057-t-cargo/topic/How.20can.20I.20distinguish.20two.20commits.20of.20the.20same.20git.20dep.3F.html#266862605">(Jan 04 2022 at 21:00)</a>:</h4>
<p>Posted <a href="https://github.com/rust-lang/cargo/issues/10256">https://github.com/rust-lang/cargo/issues/10256</a></p>



<hr><p>Last updated: Apr 12 2022 at 20:01 UTC</p>
</html>