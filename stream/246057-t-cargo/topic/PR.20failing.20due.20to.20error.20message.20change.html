<html>
<head><meta charset="utf-8"><title>PR failing due to error message change · t-cargo · Zulip Chat Archive</title></head>
<h2>Stream: <a href="https://zulip-archive.rust-lang.org/stream/246057-t-cargo/index.html">t-cargo</a></h2>
<h3>Topic: <a href="https://zulip-archive.rust-lang.org/stream/246057-t-cargo/topic/PR.20failing.20due.20to.20error.20message.20change.html">PR failing due to error message change</a></h3>

<hr>

<base href="https://rust-lang.zulipchat.com">

<head><link href="https://zulip-archive.rust-lang.org/style.css" rel="stylesheet"></head>

<a name="261721445"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/246057-t-cargo/topic/PR%20failing%20due%20to%20error%20message%20change/near/261721445" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Chris Denton <a href="https://zulip-archive.rust-lang.org/stream/246057-t-cargo/topic/PR.20failing.20due.20to.20error.20message.20change.html#261721445">(Nov 16 2021 at 23:12)</a>:</h4>
<p>Hi, <a href="https://github.com/rust-lang/rust/issues/87704">#87704</a> failed because it caused some error messages to change in Cargo tests. I'm unsure of the procedure here. Should I be trying to match the previous error output? Or should Cargo's tests be updated?</p>



<a name="261723495"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/246057-t-cargo/topic/PR%20failing%20due%20to%20error%20message%20change/near/261723495" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Eric Huss <a href="https://zulip-archive.rust-lang.org/stream/246057-t-cargo/topic/PR.20failing.20due.20to.20error.20message.20change.html#261723495">(Nov 16 2021 at 23:32)</a>:</h4>
<p><span class="user-mention" data-user-id="260325">@Chris Denton</span> Cargo's tests will need to be updated.</p>
<p>Quick question, do you know why it changed from  ERROR_FILE_NOT_FOUND  to  ERROR_PATH_NOT_FOUND?</p>



<a name="261723754"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/246057-t-cargo/topic/PR%20failing%20due%20to%20error%20message%20change/near/261723754" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Chris Denton <a href="https://zulip-archive.rust-lang.org/stream/246057-t-cargo/topic/PR.20failing.20due.20to.20error.20message.20change.html#261723754">(Nov 16 2021 at 23:35)</a>:</h4>
<p>Err, not off hand. It might just be a side effect of manually testing for its existence.</p>



<a name="261723813"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/246057-t-cargo/topic/PR%20failing%20due%20to%20error%20message%20change/near/261723813" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Chris Denton <a href="https://zulip-archive.rust-lang.org/stream/246057-t-cargo/topic/PR.20failing.20due.20to.20error.20message.20change.html#261723813">(Nov 16 2021 at 23:36)</a>:</h4>
<p>I could investigate but unfortunately not right now.</p>



<a name="261724445"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/246057-t-cargo/topic/PR%20failing%20due%20to%20error%20message%20change/near/261724445" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Eric Huss <a href="https://zulip-archive.rust-lang.org/stream/246057-t-cargo/topic/PR.20failing.20due.20to.20error.20message.20change.html#261724445">(Nov 16 2021 at 23:42)</a>:</h4>
<p>Yea, probably that it is an absolute path with a non-existent directory. Probably not too important.  </p>
<p>I'm trying to think of the best way to unstick your problem.  It's a little tricky because cargo's tests need to pass on stable/beta/nightly, and the nightly we have won't have your PR.  So I think the best way forward is to just ignore the exact error text for now, and we can maybe add it back in the future.</p>



<a name="261724520"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/246057-t-cargo/topic/PR%20failing%20due%20to%20error%20message%20change/near/261724520" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Eric Huss <a href="https://zulip-archive.rust-lang.org/stream/246057-t-cargo/topic/PR.20failing.20due.20to.20error.20message.20change.html#261724520">(Nov 16 2021 at 23:43)</a>:</h4>
<p>If you can make a PR to rust-lang/cargo, I'll try to get the submodule updated to unblock your PR.  The error text can be ignored by replacing the text with <code>[..]</code> in the test (that is equivalent to a <code>.*</code> regex).</p>



<a name="261724823"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/246057-t-cargo/topic/PR%20failing%20due%20to%20error%20message%20change/near/261724823" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Eric Huss <a href="https://zulip-archive.rust-lang.org/stream/246057-t-cargo/topic/PR.20failing.20due.20to.20error.20message.20change.html#261724823">(Nov 16 2021 at 23:45)</a>:</h4>
<p>And maybe add a comment in the tests explaining the situation.</p>



<a name="261727193"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/246057-t-cargo/topic/PR%20failing%20due%20to%20error%20message%20change/near/261727193" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Chris Denton <a href="https://zulip-archive.rust-lang.org/stream/246057-t-cargo/topic/PR.20failing.20due.20to.20error.20message.20change.html#261727193">(Nov 17 2021 at 00:07)</a>:</h4>
<p>OK, thanks for looking into this. I'll make PR but it might be awhile before it's submitted  (maybe tomorrow).</p>



<a name="262120535"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/246057-t-cargo/topic/PR%20failing%20due%20to%20error%20message%20change/near/262120535" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Chris Denton <a href="https://zulip-archive.rust-lang.org/stream/246057-t-cargo/topic/PR.20failing.20due.20to.20error.20message.20change.html#262120535">(Nov 19 2021 at 19:52)</a>:</h4>
<p><span class="user-mention" data-user-id="120518">@Eric Huss</span> </p>
<blockquote>
<p>Quick question, do you know why it changed from ERROR_FILE_NOT_FOUND to ERROR_PATH_NOT_FOUND?</p>
</blockquote>
<p>Just to follow up on this. The answer was pretty much what you assumed. When we were letting <code>CreateProcessW</code> search for a file, it was mapping the underlying errors to <code>ERROR_FILE_NOT_FOUND</code>  (even when using an absolute path). Whereas when giving it a path to use it just tries to open it and reports the error as given. And indeed, the difference between <code>ERROR_FILE_NOT_FOUND</code> and <code>ERROR_PATH_NOT_FOUND</code> is usually that in the latter case an ancestor directory does not exist. Though, as shown here, that distinction isn't always maintained.</p>



<hr><p>Last updated: Apr 12 2022 at 20:01 UTC</p>
</html>