<html>
<head><meta charset="utf-8"><title>Handling stabilized -C strip that hasn&#x27;t hit stable rustc ye · t-cargo · Zulip Chat Archive</title></head>
<h2>Stream: <a href="https://zulip-archive.rust-lang.org/stream/246057-t-cargo/index.html">t-cargo</a></h2>
<h3>Topic: <a href="https://zulip-archive.rust-lang.org/stream/246057-t-cargo/topic/Handling.20stabilized.20-C.20strip.20that.20hasn&#x27;t.20hit.20stable.20rustc.20ye.html">Handling stabilized -C strip that hasn&#x27;t hit stable rustc ye</a></h3>

<hr>

<base href="https://rust-lang.zulipchat.com">

<head><link href="https://zulip-archive.rust-lang.org/style.css" rel="stylesheet"></head>

<a name="261858726"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/246057-t-cargo/topic/Handling%20stabilized%20-C%20strip%20that%20hasn%27t%20hit%20stable%20rustc%20ye/near/261858726" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Josh Triplett <a href="https://zulip-archive.rust-lang.org/stream/246057-t-cargo/topic/Handling.20stabilized.20-C.20strip.20that.20hasn&#x27;t.20hit.20stable.20rustc.20ye.html#261858726">(Nov 17 2021 at 22:17)</a>:</h4>
<p><a href="https://github.com/rust-lang/cargo/pull/10088">https://github.com/rust-lang/cargo/pull/10088</a> ran into the issue that CI is testing against current stable and beta, and the stabilization of <code>-C strip</code> <em>just</em> hit nightly.</p>



<a name="261858781"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/246057-t-cargo/topic/Handling%20stabilized%20-C%20strip%20that%20hasn%27t%20hit%20stable%20rustc%20ye/near/261858781" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Josh Triplett <a href="https://zulip-archive.rust-lang.org/stream/246057-t-cargo/topic/Handling.20stabilized.20-C.20strip.20that.20hasn&#x27;t.20hit.20stable.20rustc.20ye.html#261858781">(Nov 17 2021 at 22:18)</a>:</h4>
<p>What would be the best way to handle that without waiting a full release cycle?</p>



<a name="261858822"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/246057-t-cargo/topic/Handling%20stabilized%20-C%20strip%20that%20hasn%27t%20hit%20stable%20rustc%20ye/near/261858822" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Josh Triplett <a href="https://zulip-archive.rust-lang.org/stream/246057-t-cargo/topic/Handling.20stabilized.20-C.20strip.20that.20hasn&#x27;t.20hit.20stable.20rustc.20ye.html#261858822">(Nov 17 2021 at 22:18)</a>:</h4>
<p>(I'd like to avoid doing any kind of rust version detection.)</p>



<a name="261859088"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/246057-t-cargo/topic/Handling%20stabilized%20-C%20strip%20that%20hasn%27t%20hit%20stable%20rustc%20ye/near/261859088" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Eric Huss <a href="https://zulip-archive.rust-lang.org/stream/246057-t-cargo/topic/Handling.20stabilized.20-C.20strip.20that.20hasn&#x27;t.20hit.20stable.20rustc.20ye.html#261859088">(Nov 17 2021 at 22:19)</a>:</h4>
<p>I think it will be fine to just disable the tests except on nightly.</p>



<a name="261859225"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/246057-t-cargo/topic/Handling%20stabilized%20-C%20strip%20that%20hasn%27t%20hit%20stable%20rustc%20ye/near/261859225" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Josh Triplett <a href="https://zulip-archive.rust-lang.org/stream/246057-t-cargo/topic/Handling.20stabilized.20-C.20strip.20that.20hasn&#x27;t.20hit.20stable.20rustc.20ye.html#261859225">(Nov 17 2021 at 22:20)</a>:</h4>
<p>Do we have a standard equivalent of <code>cfg(bootstrap)</code> for Cargo?</p>



<a name="261859226"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/246057-t-cargo/topic/Handling%20stabilized%20-C%20strip%20that%20hasn%27t%20hit%20stable%20rustc%20ye/near/261859226" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Josh Triplett <a href="https://zulip-archive.rust-lang.org/stream/246057-t-cargo/topic/Handling.20stabilized.20-C.20strip.20that.20hasn&#x27;t.20hit.20stable.20rustc.20ye.html#261859226">(Nov 17 2021 at 22:20)</a>:</h4>
<p>Do we have a standard equivalent of <code>cfg(bootstrap)</code> for Cargo?</p>



<a name="261859232"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/246057-t-cargo/topic/Handling%20stabilized%20-C%20strip%20that%20hasn%27t%20hit%20stable%20rustc%20ye/near/261859232" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Eric Huss <a href="https://zulip-archive.rust-lang.org/stream/246057-t-cargo/topic/Handling.20stabilized.20-C.20strip.20that.20hasn&#x27;t.20hit.20stable.20rustc.20ye.html#261859232">(Nov 17 2021 at 22:20)</a>:</h4>
<p>Like this:</p>
<div class="codehilite" data-code-language="Rust"><pre><span></span><code><span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="o">!</span><span class="n">is_nightly</span><span class="p">()</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">        </span><span class="c1">// -C strip stabilized in 1.58</span>
<span class="w">        </span><span class="k">return</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="p">}</span><span class="w"></span>
</code></pre></div>



<a name="261859239"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/246057-t-cargo/topic/Handling%20stabilized%20-C%20strip%20that%20hasn%27t%20hit%20stable%20rustc%20ye/near/261859239" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Eric Huss <a href="https://zulip-archive.rust-lang.org/stream/246057-t-cargo/topic/Handling.20stabilized.20-C.20strip.20that.20hasn&#x27;t.20hit.20stable.20rustc.20ye.html#261859239">(Nov 17 2021 at 22:20)</a>:</h4>
<p>No</p>



<a name="261859256"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/246057-t-cargo/topic/Handling%20stabilized%20-C%20strip%20that%20hasn%27t%20hit%20stable%20rustc%20ye/near/261859256" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Eric Huss <a href="https://zulip-archive.rust-lang.org/stream/246057-t-cargo/topic/Handling.20stabilized.20-C.20strip.20that.20hasn&#x27;t.20hit.20stable.20rustc.20ye.html#261859256">(Nov 17 2021 at 22:20)</a>:</h4>
<p>I was working on something for the proc-macro</p>



<a name="261859262"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/246057-t-cargo/topic/Handling%20stabilized%20-C%20strip%20that%20hasn%27t%20hit%20stable%20rustc%20ye/near/261859262" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Eric Huss <a href="https://zulip-archive.rust-lang.org/stream/246057-t-cargo/topic/Handling.20stabilized.20-C.20strip.20that.20hasn&#x27;t.20hit.20stable.20rustc.20ye.html#261859262">(Nov 17 2021 at 22:20)</a>:</h4>
<p>But haven't finished.</p>



<a name="261859277"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/246057-t-cargo/topic/Handling%20stabilized%20-C%20strip%20that%20hasn%27t%20hit%20stable%20rustc%20ye/near/261859277" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Eric Huss <a href="https://zulip-archive.rust-lang.org/stream/246057-t-cargo/topic/Handling.20stabilized.20-C.20strip.20that.20hasn&#x27;t.20hit.20stable.20rustc.20ye.html#261859277">(Nov 17 2021 at 22:20)</a>:</h4>
<p><a href="https://github.com/rust-lang/cargo/pull/9892">https://github.com/rust-lang/cargo/pull/9892</a></p>



<a name="261859340"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/246057-t-cargo/topic/Handling%20stabilized%20-C%20strip%20that%20hasn%27t%20hit%20stable%20rustc%20ye/near/261859340" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Eric Huss <a href="https://zulip-archive.rust-lang.org/stream/246057-t-cargo/topic/Handling.20stabilized.20-C.20strip.20that.20hasn&#x27;t.20hit.20stable.20rustc.20ye.html#261859340">(Nov 17 2021 at 22:21)</a>:</h4>
<p>Would look like:</p>
<div class="codehilite" data-code-language="Rust"><pre><span></span><code><span class="cp">#[cargo_test(&gt;=1.58, reason=</span><span class="s">"-C strip stabilized"</span><span class="cp">)]</span><span class="w"></span>
</code></pre></div>



<a name="261859508"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/246057-t-cargo/topic/Handling%20stabilized%20-C%20strip%20that%20hasn%27t%20hit%20stable%20rustc%20ye/near/261859508" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Josh Triplett <a href="https://zulip-archive.rust-lang.org/stream/246057-t-cargo/topic/Handling.20stabilized.20-C.20strip.20that.20hasn&#x27;t.20hit.20stable.20rustc.20ye.html#261859508">(Nov 17 2021 at 22:22)</a>:</h4>
<p>I'll give the is_nightly approach a try. Thank you!</p>



<hr><p>Last updated: Apr 12 2022 at 20:01 UTC</p>
</html>