<html>
<head><meta charset="utf-8"><title>combine compilation speed · t-cargo · Zulip Chat Archive</title></head>
<h2>Stream: <a href="https://zulip-archive.rust-lang.org/stream/246057-t-cargo/index.html">t-cargo</a></h2>
<h3>Topic: <a href="https://zulip-archive.rust-lang.org/stream/246057-t-cargo/topic/combine.20compilation.20speed.html">combine compilation speed</a></h3>

<hr>

<base href="https://rust-lang.zulipchat.com">

<head><link href="https://zulip-archive.rust-lang.org/style.css" rel="stylesheet"></head>

<a name="272844869"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/246057-t-cargo/topic/combine%20compilation%20speed/near/272844869" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Eric Huss <a href="https://zulip-archive.rust-lang.org/stream/246057-t-cargo/topic/combine.20compilation.20speed.html#272844869">(Feb 22 2022 at 18:18)</a>:</h4>
<p>Just thought I'd share an odd performance issue.  I was noticing that <code>combine</code> was taking about 20s to run <code>cargo check</code> on cargo itself, which seemed really fishy (that's slower than every other crate by far). It seems like it is due to some CPU throttling that happens on my laptop when there are too many things building at once.  In isolation, it only takes about 5s to check (which is still pretty slow, but reasonable).  I tried a few different <code>-j</code> values, which made <code>combine</code> build much faster, but didn't help the overall finish time.</p>



<a name="272850172"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/246057-t-cargo/topic/combine%20compilation%20speed/near/272850172" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Josh Triplett <a href="https://zulip-archive.rust-lang.org/stream/246057-t-cargo/topic/combine.20compilation.20speed.html#272850172">(Feb 22 2022 at 18:56)</a>:</h4>
<p><span class="user-mention" data-user-id="120518">@Eric Huss</span> Out of curiosity, what laptop?</p>



<a name="272850185"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/246057-t-cargo/topic/combine%20compilation%20speed/near/272850185" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Josh Triplett <a href="https://zulip-archive.rust-lang.org/stream/246057-t-cargo/topic/combine.20compilation.20speed.html#272850185">(Feb 22 2022 at 18:56)</a>:</h4>
<p>Many recent laptops have serious throttling issues.</p>



<a name="272850257"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/246057-t-cargo/topic/combine%20compilation%20speed/near/272850257" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Josh Triplett <a href="https://zulip-archive.rust-lang.org/stream/246057-t-cargo/topic/combine.20compilation.20speed.html#272850257">(Feb 22 2022 at 18:57)</a>:</h4>
<p><span class="user-mention" data-user-id="120518">@Eric Huss</span> And what OS?</p>



<a name="272853093"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/246057-t-cargo/topic/combine%20compilation%20speed/near/272853093" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Eric Huss <a href="https://zulip-archive.rust-lang.org/stream/246057-t-cargo/topic/combine.20compilation.20speed.html#272853093">(Feb 22 2022 at 19:16)</a>:</h4>
<p>A macbook with an i7 (6 core/12 thread).  I've always felt that macbooks have been terrible at thermal management. I'll hopefully upgrade to a silicone mac some day, which supposedly is much better.</p>



<a name="272854226"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/246057-t-cargo/topic/combine%20compilation%20speed/near/272854226" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Yerkebulan Tulibergenov <a href="https://zulip-archive.rust-lang.org/stream/246057-t-cargo/topic/combine.20compilation.20speed.html#272854226">(Feb 22 2022 at 19:24)</a>:</h4>
<p>My work MBP M1 Max is great. I don’t think I heard the fans on it yet. And it’s much faster.</p>



<a name="272860814"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/246057-t-cargo/topic/combine%20compilation%20speed/near/272860814" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Nick Cameron <a href="https://zulip-archive.rust-lang.org/stream/246057-t-cargo/topic/combine.20compilation.20speed.html#272860814">(Feb 22 2022 at 20:18)</a>:</h4>
<p>Try running a build with the laptop in the freezer</p>



<a name="272889673"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/246057-t-cargo/topic/combine%20compilation%20speed/near/272889673" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Weihang Lo <a href="https://zulip-archive.rust-lang.org/stream/246057-t-cargo/topic/combine.20compilation.20speed.html#272889673">(Feb 23 2022 at 01:05)</a>:</h4>
<p>FWIW,  combine hit some perf issues in rustc like this one: <a href="https://github.com/rust-lang/rust/issues/68666">https://github.com/rust-lang/rust/issues/68666</a></p>



<hr><p>Last updated: Apr 12 2022 at 20:01 UTC</p>
</html>