<html>
<head><meta charset="utf-8"><title>cargo build dependencies only · t-cargo · Zulip Chat Archive</title></head>
<h2>Stream: <a href="https://zulip-archive.rust-lang.org/stream/246057-t-cargo/index.html">t-cargo</a></h2>
<h3>Topic: <a href="https://zulip-archive.rust-lang.org/stream/246057-t-cargo/topic/cargo.20build.20dependencies.20only.html">cargo build dependencies only</a></h3>

<hr>

<base href="https://rust-lang.zulipchat.com">

<head><link href="https://zulip-archive.rust-lang.org/style.css" rel="stylesheet"></head>

<a name="275519125"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/246057-t-cargo/topic/cargo%20build%20dependencies%20only/near/275519125" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sampras Lopes <a href="https://zulip-archive.rust-lang.org/stream/246057-t-cargo/topic/cargo.20build.20dependencies.20only.html#275519125">(Mar 16 2022 at 14:35)</a>:</h4>
<p>does anyone know why <a href="https://github.com/rust-lang/cargo/issues/2644">https://github.com/rust-lang/cargo/issues/2644</a> hasn't been picked up yet,<br>
Based on the comments it seems to be a valid issue with a well-specified requirement,<br>
Is there anything about the implementation that I'm missing?</p>



<a name="275522251"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/246057-t-cargo/topic/cargo%20build%20dependencies%20only/near/275522251" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Eh2406 <a href="https://zulip-archive.rust-lang.org/stream/246057-t-cargo/topic/cargo.20build.20dependencies.20only.html#275522251">(Mar 16 2022 at 14:55)</a>:</h4>
<p>As with so many things in Cargo (but not all) the problems are not "implementation will be hard" they are "designed needs work".<br>
The Cargo Team has responded many times in that thread.<br>
If I recall correctly: It's not clear that it is extensible to be able to support everyone's use case, it's not even clear that there is anyone who wants this exact behavior.</p>



<a name="275531096"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/246057-t-cargo/topic/cargo%20build%20dependencies%20only/near/275531096" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Josh Triplett <a href="https://zulip-archive.rust-lang.org/stream/246057-t-cargo/topic/cargo.20build.20dependencies.20only.html#275531096">(Mar 16 2022 at 15:51)</a>:</h4>
<p>FWIW, I do want this, for both docs and build.</p>



<a name="275531141"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/246057-t-cargo/topic/cargo%20build%20dependencies%20only/near/275531141" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Josh Triplett <a href="https://zulip-archive.rust-lang.org/stream/246057-t-cargo/topic/cargo.20build.20dependencies.20only.html#275531141">(Mar 16 2022 at 15:51)</a>:</h4>
<p>Use case for both: project that doesn't build yet.</p>



<a name="275531282"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/246057-t-cargo/topic/cargo%20build%20dependencies%20only/near/275531282" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Josh Triplett <a href="https://zulip-archive.rust-lang.org/stream/246057-t-cargo/topic/cargo.20build.20dependencies.20only.html#275531282">(Mar 16 2022 at 15:52)</a>:</h4>
<p>Or project that I just added several dependencies to that I'm not yet using, and I want Cargo to go ahead and download and build them.</p>



<a name="275531607"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/246057-t-cargo/topic/cargo%20build%20dependencies%20only/near/275531607" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Eh2406 <a href="https://zulip-archive.rust-lang.org/stream/246057-t-cargo/topic/cargo.20build.20dependencies.20only.html#275531607">(Mar 16 2022 at 15:54)</a>:</h4>
<p>cargo build and ignore the errors?</p>



<a name="275540388"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/246057-t-cargo/topic/cargo%20build%20dependencies%20only/near/275540388" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sampras Lopes <a href="https://zulip-archive.rust-lang.org/stream/246057-t-cargo/topic/cargo.20build.20dependencies.20only.html#275540388">(Mar 16 2022 at 16:41)</a>:</h4>
<p>there's the docker caching use case as well, which has led to a couple of crates <a href="https://crates.io/crates/cargo-build-deps">https://crates.io/crates/cargo-build-deps</a> &amp;https://github.com/LukeMathWalker/cargo-chef</p>
<p>These could be supported better if provided by cargo itself rather than external crates</p>



<a name="275543172"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/246057-t-cargo/topic/cargo%20build%20dependencies%20only/near/275543172" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Eh2406 <a href="https://zulip-archive.rust-lang.org/stream/246057-t-cargo/topic/cargo.20build.20dependencies.20only.html#275543172">(Mar 16 2022 at 16:58)</a>:</h4>
<p>There are a bunch of things that make designing that interface more complicated than it seems. From my limited understanding the first obstacle is that you need the cargo.toml to decide what the dependencies are, but updating that file invalidates the docker cache.<br>
When someone has a third-party library that is widely accepted as having solved the problem, that will be evidence that the design phase is well enough understood to know what we should add to cargo. Big thank you to both of the projects for having gotten started on that work.</p>



<a name="275549146"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/246057-t-cargo/topic/cargo%20build%20dependencies%20only/near/275549146" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sampras Lopes <a href="https://zulip-archive.rust-lang.org/stream/246057-t-cargo/topic/cargo.20build.20dependencies.20only.html#275549146">(Mar 16 2022 at 17:33)</a>:</h4>
<p>yeah, I had faced some issues on these projects related to</p>
<ol>
<li>support for workspaces (or other issues reporting lack of support for some cargo features)</li>
<li>they need to create an empty cargo package which does not work when the Cargo.toml has specified <em>[[bin]]</em> or other settings</li>
</ol>
<p>I'll try to fix these issues in these third party lib (or create my own),<br>
thanks for the input here</p>



<hr><p>Last updated: Apr 12 2022 at 20:01 UTC</p>
</html>