<html>
<head><meta charset="utf-8"><title>Meeting 2021-10-25 · project-portable-simd · Zulip Chat Archive</title></head>
<h2>Stream: <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/index.html">project-portable-simd</a></h2>
<h3>Topic: <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/Meeting.202021-10-25.html">Meeting 2021-10-25</a></h3>

<hr>

<base href="https://rust-lang.zulipchat.com">

<head><link href="https://zulip-archive.rust-lang.org/style.css" rel="stylesheet"></head>

<a name="259018996"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/Meeting%202021-10-25/near/259018996" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jacob Lifshay <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/Meeting.202021-10-25.html#259018996">(Oct 25 2021 at 20:52)</a>:</h4>
<p>hi</p>



<a name="259019075"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/Meeting%202021-10-25/near/259019075" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jubilee <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/Meeting.202021-10-25.html#259019075">(Oct 25 2021 at 20:53)</a>:</h4>
<p>Oh hello.</p>



<a name="259019828"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/Meeting%202021-10-25/near/259019828" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jacob Lifshay <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/Meeting.202021-10-25.html#259019828">(Oct 25 2021 at 21:00)</a>:</h4>
<p><span class="user-mention" data-user-id="312331">@Caleb Zulawski</span> meeting</p>



<a name="259020240"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/Meeting%202021-10-25/near/259020240" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jacob Lifshay <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/Meeting.202021-10-25.html#259020240">(Oct 25 2021 at 21:02)</a>:</h4>
<p>for <a href="https://github.com/rust-lang/portable-simd/issues/177">portable-simd#177</a>, do we want that API, or is <code>f32x8::from_array(s[..8].try_into().unwrap())</code> sufficient?</p>



<a name="259020653"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/Meeting%202021-10-25/near/259020653" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jubilee <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/Meeting.202021-10-25.html#259020653">(Oct 25 2021 at 21:06)</a>:</h4>
<p>I think we should have an explicit variant for convenience.</p>



<a name="259020743"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/Meeting%202021-10-25/near/259020743" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Caleb Zulawski <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/Meeting.202021-10-25.html#259020743">(Oct 25 2021 at 21:07)</a>:</h4>
<p>Hi, apparently my zulip notifications are broken but I got that ping via email</p>



<a name="259020921"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/Meeting%202021-10-25/near/259020921" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Caleb Zulawski <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/Meeting.202021-10-25.html#259020921">(Oct 25 2021 at 21:08)</a>:</h4>
<p>I think we want that API too, probably, but it should use try_into internally</p>



<a name="259020999"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/Meeting%202021-10-25/near/259020999" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Caleb Zulawski <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/Meeting.202021-10-25.html#259020999">(Oct 25 2021 at 21:09)</a>:</h4>
<p>I'm on the fence if we should have one for aligned slice accesses, since that's a little bit contradictory to what a slice means</p>



<a name="259021067"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/Meeting%202021-10-25/near/259021067" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jacob Lifshay <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/Meeting.202021-10-25.html#259021067">(Oct 25 2021 at 21:10)</a>:</h4>
<p>zulip notifications are broken for me too, sadly...</p>



<a name="259021113"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/Meeting%202021-10-25/near/259021113" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Caleb Zulawski <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/Meeting.202021-10-25.html#259021113">(Oct 25 2021 at 21:10)</a>:</h4>
<p>(a function to convert slices of scalars into slices of vectors would be nice)</p>



<a name="259021211"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/Meeting%202021-10-25/near/259021211" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jacob Lifshay <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/Meeting.202021-10-25.html#259021211">(Oct 25 2021 at 21:11)</a>:</h4>
<p>that one would have to get the alignment right, plain <code>from_slice</code> can use an unaligned load.</p>



<a name="259021263"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/Meeting%202021-10-25/near/259021263" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Caleb Zulawski <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/Meeting.202021-10-25.html#259021263">(Oct 25 2021 at 21:11)</a>:</h4>
<p>Yeah, I'm thinking they would be very different</p>



<a name="259021372"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/Meeting%202021-10-25/near/259021372" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jacob Lifshay <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/Meeting.202021-10-25.html#259021372">(Oct 25 2021 at 21:12)</a>:</h4>
<p>maybe we should let safe transmute handle the slice to slice of vectors conversion?</p>



<a name="259021573"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/Meeting%202021-10-25/near/259021573" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jacob Lifshay <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/Meeting.202021-10-25.html#259021573">(Oct 25 2021 at 21:14)</a>:</h4>
<p>maybe via a <code>[T]::aligned_chunks_transmute</code> or similar function?</p>



<a name="259021590"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/Meeting%202021-10-25/near/259021590" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Caleb Zulawski <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/Meeting.202021-10-25.html#259021590">(Oct 25 2021 at 21:14)</a>:</h4>
<p>Yeah I'm willing to hold off with that one, you can do it right now with align_to, it's just unsafe</p>



<a name="259021597"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/Meeting%202021-10-25/near/259021597" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jubilee <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/Meeting.202021-10-25.html#259021597">(Oct 25 2021 at 21:14)</a>:</h4>
<p><span class="user-mention silent" data-user-id="312331">Caleb Zulawski</span> <a href="#narrow/stream/257879-project-portable-simd/topic/Meeting.202021-10-25/near/259021113">said</a>:</p>
<blockquote>
<p>(a function to convert slices of scalars into slices of vectors would be nice)</p>
</blockquote>
<p>Isn't this just <code>fn align_to</code>?</p>



<a name="259021602"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/Meeting%202021-10-25/near/259021602" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jubilee <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/Meeting.202021-10-25.html#259021602">(Oct 25 2021 at 21:14)</a>:</h4>
<p>ah</p>



<a name="259021623"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/Meeting%202021-10-25/near/259021623" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Caleb Zulawski <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/Meeting.202021-10-25.html#259021623">(Oct 25 2021 at 21:14)</a>:</h4>
<p>With vectors you can do it safely, that's the only difference</p>



<a name="259021639"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/Meeting%202021-10-25/near/259021639" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Caleb Zulawski <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/Meeting.202021-10-25.html#259021639">(Oct 25 2021 at 21:14)</a>:</h4>
<p>So yeah, probably safe transmute, not us</p>



<a name="259021815"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/Meeting%202021-10-25/near/259021815" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jubilee <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/Meeting.202021-10-25.html#259021815">(Oct 25 2021 at 21:16)</a>:</h4>
<p>Ah.</p>



<a name="259021827"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/Meeting%202021-10-25/near/259021827" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jubilee <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/Meeting.202021-10-25.html#259021827">(Oct 25 2021 at 21:16)</a>:</h4>
<p>But yeah, I offered my comment: <a href="https://github.com/rust-lang/portable-simd/pull/177#issuecomment-951338180">https://github.com/rust-lang/portable-simd/pull/177#issuecomment-951338180</a></p>



<a name="259021849"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/Meeting%202021-10-25/near/259021849" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jubilee <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/Meeting.202021-10-25.html#259021849">(Oct 25 2021 at 21:16)</a>:</h4>
<p>Basically, "fuck alignment".</p>



<a name="259021862"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/Meeting%202021-10-25/near/259021862" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jubilee <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/Meeting.202021-10-25.html#259021862">(Oct 25 2021 at 21:16)</a>:</h4>
<p>"The processor WILL compensate."</p>



<a name="259022056"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/Meeting%202021-10-25/near/259022056" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jubilee <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/Meeting.202021-10-25.html#259022056">(Oct 25 2021 at 21:18)</a>:</h4>
<p>Anything you can do in a function, and not doing basically type sorcery, will compile in enough branches that we basically shouldn't offer a specially aligned function unless it IS as an unsafe assertion.</p>



<a name="259022142"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/Meeting%202021-10-25/near/259022142" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Caleb Zulawski <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/Meeting.202021-10-25.html#259022142">(Oct 25 2021 at 21:19)</a>:</h4>
<p>I think if you want alignment you might as well do it yourself, the way you want it, with a slice of vectors</p>



<a name="259022157"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/Meeting%202021-10-25/near/259022157" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jubilee <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/Meeting.202021-10-25.html#259022157">(Oct 25 2021 at 21:19)</a>:</h4>
<p>Right.</p>



<a name="259022171"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/Meeting%202021-10-25/near/259022171" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Caleb Zulawski <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/Meeting.202021-10-25.html#259022171">(Oct 25 2021 at 21:19)</a>:</h4>
<p>Because you're going to inherently need to handle the unaligned part</p>



<a name="259022181"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/Meeting%202021-10-25/near/259022181" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jubilee <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/Meeting.202021-10-25.html#259022181">(Oct 25 2021 at 21:19)</a>:</h4>
<p>That's kind of what I mean re: type sorcery.</p>



<a name="259022190"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/Meeting%202021-10-25/near/259022190" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Caleb Zulawski <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/Meeting.202021-10-25.html#259022190">(Oct 25 2021 at 21:19)</a>:</h4>
<p>Yep</p>



<a name="259022266"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/Meeting%202021-10-25/near/259022266" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Caleb Zulawski <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/Meeting.202021-10-25.html#259022266">(Oct 25 2021 at 21:20)</a>:</h4>
<p>Realistically I almost always use unaligned loads and stores and they're fine for most things</p>



<a name="259022369"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/Meeting%202021-10-25/near/259022369" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jubilee <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/Meeting.202021-10-25.html#259022369">(Oct 25 2021 at 21:21)</a>:</h4>
<p>There's this guy who helped design the stdx::simd for C++ API and he has similar notes on basically "yeah, you can achieve better vectorization by using types that are already parameterized by vector lengths".</p>



<a name="259022403"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/Meeting%202021-10-25/near/259022403" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jubilee <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/Meeting.202021-10-25.html#259022403">(Oct 25 2021 at 21:21)</a>:</h4>
<p>I have it saved somewhere in my infinite tabs.</p>



<a name="259022503"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/Meeting%202021-10-25/near/259022503" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jubilee <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/Meeting.202021-10-25.html#259022503">(Oct 25 2021 at 21:22)</a>:</h4>
<blockquote>
<p>My conclusion is that there is no strong reason to require alignment, as modern Arm and x86-64 processors will incur at most a minimal speed penalty. My understanding is that the situation is only slightly worse on PPC, requiring a more recent ISA to be specified. That also helps with x86-64 as everything becomes VEX encoded, which allows certain leniencies.</p>
</blockquote>



<a name="259022549"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/Meeting%202021-10-25/near/259022549" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jubilee <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/Meeting.202021-10-25.html#259022549">(Oct 25 2021 at 21:22)</a>:</h4>
<p>Can you check me on the PPC knowledge, <span class="user-mention" data-user-id="229517">@Jacob Lifshay</span>?</p>



<a name="259022573"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/Meeting%202021-10-25/near/259022573" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jubilee <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/Meeting.202021-10-25.html#259022573">(Oct 25 2021 at 21:23)</a>:</h4>
<p>If you happen to know off the top of your head.</p>



<a name="259022750"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/Meeting%202021-10-25/near/259022750" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jacob Lifshay <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/Meeting.202021-10-25.html#259022750">(Oct 25 2021 at 21:24)</a>:</h4>
<p>sounds about right, though I'm not as familiar with the PPC SIMD instructions (VSX/VMX aka. AltiVec)</p>



<a name="259022808"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/Meeting%202021-10-25/near/259022808" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jubilee <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/Meeting.202021-10-25.html#259022808">(Oct 25 2021 at 21:25)</a>:</h4>
<p>Yeah, the earliest PPC ones are a bit gnarly since you have to reissue the instruction.</p>



<a name="259022813"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/Meeting%202021-10-25/near/259022813" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jubilee <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/Meeting.202021-10-25.html#259022813">(Oct 25 2021 at 21:25)</a>:</h4>
<p>lol</p>



<a name="259022863"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/Meeting%202021-10-25/near/259022863" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jubilee <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/Meeting.202021-10-25.html#259022863">(Oct 25 2021 at 21:25)</a>:</h4>
<p>And to zoom in, I think basically we want to provide at most three things for slices that aren't "vector ops per se":</p>
<blockquote>
<p>So, given that, the known-alignment version would be best off for now as an explicit unsafe variant, to erase checks. You don't have to add that to this PR, and I think it can already be written anyways? A version that might enable iteration for a large slice and multiple reads might be better off optimized by us, but it's not immediately obvious what the best way to write that is, so it should also be left to the future.</p>
</blockquote>
<p>Basically: we can offer <code>movaps</code> as a direct function for people who <strong>know they want to and can use movaps</strong>.</p>



<a name="259022933"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/Meeting%202021-10-25/near/259022933" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jubilee <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/Meeting.202021-10-25.html#259022933">(Oct 25 2021 at 21:26)</a>:</h4>
<p>And <code>from_slice</code> is basically <code>movups</code> and what you should default to.</p>



<a name="259023009"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/Meeting%202021-10-25/near/259023009" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jacob Lifshay <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/Meeting.202021-10-25.html#259023009">(Oct 25 2021 at 21:27)</a>:</h4>
<p>well, there's no problem for SimpleV since all load/stores only require element alignment at most, not whole-vector alignment.</p>



<a name="259023018"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/Meeting%202021-10-25/near/259023018" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jubilee <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/Meeting.202021-10-25.html#259023018">(Oct 25 2021 at 21:27)</a>:</h4>
<p>And then we might want to offer basically a preoptimized stripmining loop.</p>



<a name="259023165"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/Meeting%202021-10-25/near/259023165" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jubilee <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/Meeting.202021-10-25.html#259023165">(Oct 25 2021 at 21:28)</a>:</h4>
<p>Basically: a loop already optimized for <code>align_to</code>.<br>
And right, that kind of loop being optimized on a hardware basis is another thing.</p>



<a name="259023594"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/Meeting%202021-10-25/near/259023594" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jacob Lifshay <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/Meeting.202021-10-25.html#259023594">(Oct 25 2021 at 21:32)</a>:</h4>
<p>I think that loop logic would basically be provided by safe transmute's <code>[T]::aligned_chunks_transmute</code> function I referred to above?</p>



<a name="259023684"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/Meeting%202021-10-25/near/259023684" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jubilee <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/Meeting.202021-10-25.html#259023684">(Oct 25 2021 at 21:33)</a>:</h4>
<p>Ah, then we probably shouldn't bother.</p>



<a name="259023696"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/Meeting%202021-10-25/near/259023696" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jacob Lifshay <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/Meeting.202021-10-25.html#259023696">(Oct 25 2021 at 21:33)</a>:</h4>
<p>maybe a better name is <code>safe_align_to</code></p>



<a name="259024404"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/Meeting%202021-10-25/near/259024404" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jubilee <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/Meeting.202021-10-25.html#259024404">(Oct 25 2021 at 21:40)</a>:</h4>
<p>No idea about the test failures.</p>



<a name="259024420"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/Meeting%202021-10-25/near/259024420" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jacob Lifshay <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/Meeting.202021-10-25.html#259024420">(Oct 25 2021 at 21:40)</a>:</h4>
<p>the unsafe known-alignment known-size version of <code>Simd::from_slice</code> should just be <code>ptr::read(s.as_ptr() as *const _)</code> imho</p>



<a name="259024463"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/Meeting%202021-10-25/near/259024463" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jubilee <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/Meeting.202021-10-25.html#259024463">(Oct 25 2021 at 21:41)</a>:</h4>
<p>Yeah I think leaving it as that would be fine.</p>



<a name="259024482"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/Meeting%202021-10-25/near/259024482" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jubilee <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/Meeting.202021-10-25.html#259024482">(Oct 25 2021 at 21:41)</a>:</h4>
<p>I think we also have <a href="https://github.com/rust-lang/rust/pull/88868">https://github.com/rust-lang/rust/pull/88868</a> as a concern? <span class="user-mention" data-user-id="312331">@Caleb Zulawski</span></p>



<a name="259024502"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/Meeting%202021-10-25/near/259024502" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jacob Lifshay <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/Meeting.202021-10-25.html#259024502">(Oct 25 2021 at 21:42)</a>:</h4>
<p><span class="user-mention silent" data-user-id="281757">Jubilee</span> <a href="#narrow/stream/257879-project-portable-simd/topic/Meeting.202021-10-25/near/259024404">said</a>:</p>
<blockquote>
<p>No idea about the test failures.</p>
</blockquote>
<p>same here, I'd guess it's a llvm bug.</p>



<a name="259024632"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/Meeting%202021-10-25/near/259024632" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jubilee <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/Meeting.202021-10-25.html#259024632">(Oct 25 2021 at 21:43)</a>:</h4>
<p>Love you too, LLVM.</p>



<a name="259025515"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/Meeting%202021-10-25/near/259025515" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jacob Lifshay <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/Meeting.202021-10-25.html#259025515">(Oct 25 2021 at 21:53)</a>:</h4>
<p>created <a href="https://github.com/rust-lang/project-safe-transmute/issues/12">https://github.com/rust-lang/project-safe-transmute/issues/12</a> for <code>safe_align_to</code></p>



<a name="259025904"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/Meeting%202021-10-25/near/259025904" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> scottmcm <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/Meeting.202021-10-25.html#259025904">(Oct 25 2021 at 21:57)</a>:</h4>
<p>Another thought for the <code>align_to</code> conversation: there's (nightly) <code>as_chunks</code> on slices that does <code>&amp;[T]</code> =&gt; <code>(&amp;[[T; N]], &amp;[T])</code>.  Maybe have a specific <code>as_simd</code> on slices that does the <code>&amp;[T]</code> =&gt; <code>(&amp;[T], &amp;[Simd&lt;T, N&gt;], &amp;[T])</code>?</p>



<a name="259025985"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/Meeting%202021-10-25/near/259025985" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> scottmcm <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/Meeting.202021-10-25.html#259025985">(Oct 25 2021 at 21:58)</a>:</h4>
<p>Having it doable through safe transmute would be nice too, but I think the specific version would still be worth having.</p>



<a name="259026060"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/Meeting%202021-10-25/near/259026060" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jubilee <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/Meeting.202021-10-25.html#259026060">(Oct 25 2021 at 21:59)</a>:</h4>
<p>Plausible.</p>



<a name="259026426"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/Meeting%202021-10-25/near/259026426" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jubilee <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/Meeting.202021-10-25.html#259026426">(Oct 25 2021 at 22:02)</a>:</h4>
<p>Ah so... Righto. I think we didn't have much to discuss. ^^;<br>
I am thinking about adding some simplifications to the way the crate is written but uhhh there isn't really much to discuss there until I actually write it, tbh.</p>



<a name="259029184"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/Meeting%202021-10-25/near/259029184" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jubilee <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/Meeting.202021-10-25.html#259029184">(Oct 25 2021 at 22:29)</a>:</h4>
<p><span class="user-mention" data-user-id="312331">@Caleb Zulawski</span> It can't use <code>try_into</code> due to limits on const trait fn.</p>



<a name="259029601"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/Meeting%202021-10-25/near/259029601" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Caleb Zulawski <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/Meeting.202021-10-25.html#259029601">(Oct 25 2021 at 22:34)</a>:</h4>
<p>Ah right</p>



<a name="259029753"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/Meeting%202021-10-25/near/259029753" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Caleb Zulawski <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/Meeting.202021-10-25.html#259029753">(Oct 25 2021 at 22:35)</a>:</h4>
<p>Hopefully the compiler optimizes that well</p>



<a name="259031942"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/Meeting%202021-10-25/near/259031942" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jubilee <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/Meeting.202021-10-25.html#259031942">(Oct 25 2021 at 23:01)</a>:</h4>
<p>It could be non-<code>const fn</code>.</p>



<hr><p>Last updated: Apr 12 2022 at 20:01 UTC</p>
</html>