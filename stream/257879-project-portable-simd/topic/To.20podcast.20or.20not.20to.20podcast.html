<html>
<head><meta charset="utf-8"><title>To podcast or not to podcast · project-portable-simd · Zulip Chat Archive</title></head>
<h2>Stream: <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/index.html">project-portable-simd</a></h2>
<h3>Topic: <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/To.20podcast.20or.20not.20to.20podcast.html">To podcast or not to podcast</a></h3>

<hr>

<base href="https://rust-lang.zulipchat.com">

<head><link href="https://zulip-archive.rust-lang.org/style.css" rel="stylesheet"></head>

<a name="265647477"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/To%20podcast%20or%20not%20to%20podcast/near/265647477" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jubilee <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/To.20podcast.20or.20not.20to.20podcast.html#265647477">(Dec 21 2021 at 04:58)</a>:</h4>
<p>Our library relies a bit on being "Plain ol' data" types to make it easy to bitcast in certain places, but we are considering possibly supporting hypothetically transparent types, <code>Simd&lt;NonNan&lt;f32&gt;, N&gt;</code> or <code>Simd&lt;NonZeroU32, N&gt;</code>. We need a more worked design for how to avoid podcasting in those cases.</p>



<a name="265648013"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/To%20podcast%20or%20not%20to%20podcast/near/265648013" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Caleb Zulawski <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/To.20podcast.20or.20not.20to.20podcast.html#265648013">(Dec 21 2021 at 05:08)</a>:</h4>
<p>I come from C++, so maybe you're just throwing around POD so I want to make sure that's exactly what you mean</p>



<a name="265648109"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/To%20podcast%20or%20not%20to%20podcast/near/265648109" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Caleb Zulawski <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/To.20podcast.20or.20not.20to.20podcast.html#265648109">(Dec 21 2021 at 05:10)</a>:</h4>
<p>C++ deprecated POD since it wasn't particularly useful on its own, it sounds like the comparison to C++ would be the distinction between trivial and standard layout types, where <code>Copy</code> is nearly identical to standard layout, and trivial doesn't really have an equivalent since rust has no default constructors</p>



<a name="265648136"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/To%20podcast%20or%20not%20to%20podcast/near/265648136" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Caleb Zulawski <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/To.20podcast.20or.20not.20to.20podcast.html#265648136">(Dec 21 2021 at 05:11)</a>:</h4>
<p>In C++ the transparent wrappers would all be considered standard layout</p>



<a name="265648356"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/To%20podcast%20or%20not%20to%20podcast/near/265648356" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jubilee <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/To.20podcast.20or.20not.20to.20podcast.html#265648356">(Dec 21 2021 at 05:15)</a>:</h4>
<p>referencing this actually <a href="https://docs.rs/bytemuck/latest/bytemuck/trait.Pod.html">https://docs.rs/bytemuck/latest/bytemuck/trait.Pod.html</a></p>



<a name="265648378"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/To%20podcast%20or%20not%20to%20podcast/near/265648378" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jubilee <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/To.20podcast.20or.20not.20to.20podcast.html#265648378">(Dec 21 2021 at 05:15)</a>:</h4>
<p>I am also an incorrigible punster however.</p>



<a name="265648453"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/To%20podcast%20or%20not%20to%20podcast/near/265648453" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Miguel Raz Guzmán Macedo <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/To.20podcast.20or.20not.20to.20podcast.html#265648453">(Dec 21 2021 at 05:16)</a>:</h4>
<p>What is podcasting and why is having trabslarent types a good thing?</p>



<a name="265648477"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/To%20podcast%20or%20not%20to%20podcast/near/265648477" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jubilee <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/To.20podcast.20or.20not.20to.20podcast.html#265648477">(Dec 21 2021 at 05:17)</a>:</h4>
<p><span class="user-mention silent" data-user-id="246783">Miguel Raz Guzmán Macedo</span> <a href="#narrow/stream/257879-project-portable-simd/topic/To.20podcast.20or.20not.20to.20podcast/near/265648453">said</a>:</p>
<blockquote>
<p>What is podcasting and why is having trabslarent types a good thing?</p>
</blockquote>
<p>if all bitpatterns for a type are admissible, a bitcast is always valid between equally sized types.</p>



<a name="265648529"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/To%20podcast%20or%20not%20to%20podcast/near/265648529" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Miguel Raz Guzmán Macedo <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/To.20podcast.20or.20not.20to.20podcast.html#265648529">(Dec 21 2021 at 05:18)</a>:</h4>
<p>Ah, yeah that would be good for barring NaNs</p>



<a name="265648544"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/To%20podcast%20or%20not%20to%20podcast/near/265648544" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jacob Lifshay <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/To.20podcast.20or.20not.20to.20podcast.html#265648544">(Dec 21 2021 at 05:18)</a>:</h4>
<p>a little off-topic: looking through <code>Pod</code>'s definition -- why does <code>PhantomData&lt;T&gt;: Pod</code> require <code>T: Pod</code>?</p>



<a name="265648566"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/To%20podcast%20or%20not%20to%20podcast/near/265648566" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jubilee <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/To.20podcast.20or.20not.20to.20podcast.html#265648566">(Dec 21 2021 at 05:19)</a>:</h4>
<p>idk, ask <span class="user-mention" data-user-id="224471">@Lokathor</span>?<br>
<span class="user-mention" data-user-id="246783">@Miguel Raz Guzmán Macedo</span>  Well actually that's the problem: NaNs are what make all float bitpatterns valid.</p>



<a name="265648587"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/To%20podcast%20or%20not%20to%20podcast/near/265648587" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jubilee <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/To.20podcast.20or.20not.20to.20podcast.html#265648587">(Dec 21 2021 at 05:19)</a>:</h4>
<p>thus allowing transmute from u32 to f32</p>



<a name="265648640"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/To%20podcast%20or%20not%20to%20podcast/near/265648640" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Miguel Raz Guzmán Macedo <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/To.20podcast.20or.20not.20to.20podcast.html#265648640">(Dec 21 2021 at 05:20)</a>:</h4>
<p>Ah I see</p>



<a name="265648671"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/To%20podcast%20or%20not%20to%20podcast/near/265648671" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Miguel Raz Guzmán Macedo <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/To.20podcast.20or.20not.20to.20podcast.html#265648671">(Dec 21 2021 at 05:21)</a>:</h4>
<p>Hmm</p>



<a name="265648728"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/To%20podcast%20or%20not%20to%20podcast/near/265648728" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Miguel Raz Guzmán Macedo <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/To.20podcast.20or.20not.20to.20podcast.html#265648728">(Dec 21 2021 at 05:22)</a>:</h4>
<p>Well type casting happens - I’m guessing the library problem here is avoiding all the type combination explosions for the different castings</p>



<a name="265648743"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/To%20podcast%20or%20not%20to%20podcast/near/265648743" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Miguel Raz Guzmán Macedo <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/To.20podcast.20or.20not.20to.20podcast.html#265648743">(Dec 21 2021 at 05:22)</a>:</h4>
<p>which gets gnarly with the lane number and lane width</p>



<a name="265648768"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/To%20podcast%20or%20not%20to%20podcast/near/265648768" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jacob Lifshay <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/To.20podcast.20or.20not.20to.20podcast.html#265648768">(Dec 21 2021 at 05:23)</a>:</h4>
<p>wouldn't it work to simply require <code>unsafe</code> wherever <code>std::simd</code>'s api could result in a invalid value (e.g. nonzero add wrapping around to zero)?</p>



<a name="265648959"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/To%20podcast%20or%20not%20to%20podcast/near/265648959" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jubilee <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/To.20podcast.20or.20not.20to.20podcast.html#265648959">(Dec 21 2021 at 05:27)</a>:</h4>
<p>idk, just noting it is a nontrivial difference.</p>



<a name="265650389"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/To%20podcast%20or%20not%20to%20podcast/near/265650389" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Caleb Zulawski <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/To.20podcast.20or.20not.20to.20podcast.html#265650389">(Dec 21 2021 at 05:57)</a>:</h4>
<p>is there any reason a simd element must be valid for all bit patterns?</p>



<a name="265650485"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/To%20podcast%20or%20not%20to%20podcast/near/265650485" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jacob Lifshay <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/To.20podcast.20or.20not.20to.20podcast.html#265650485">(Dec 21 2021 at 05:59)</a>:</h4>
<p>not that I can think of...we'd just not implement <code>Into</code> conversion for <code>_m128i</code> for <code>Simd&lt;NonZeroI32, 4&gt;</code></p>



<a name="265650626"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/To%20podcast%20or%20not%20to%20podcast/near/265650626" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Caleb Zulawski <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/To.20podcast.20or.20not.20to.20podcast.html#265650626">(Dec 21 2021 at 06:01)</a>:</h4>
<p>It's worth noting that while we are going down the POD rabbit hole, it's pretty easy in C++ to create a trivial and standard layout type that semantically disallows particular bit patterns:</p>
<div class="codehilite" data-code-language="C++"><pre><span></span><code><span class="k">template</span><span class="o">&lt;</span><span class="n">std</span><span class="o">::</span><span class="n">integral</span><span class="w"> </span><span class="n">T</span><span class="o">&gt;</span><span class="w"></span>
<span class="k">struct</span> <span class="nc">NonZero</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="k">consteval</span><span class="w"> </span><span class="n">NonZero</span><span class="p">(</span><span class="n">T</span><span class="w"> </span><span class="n">value</span><span class="p">)</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="n">value</span><span class="p">(</span><span class="n">value</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">value</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="k">throw</span><span class="w"> </span><span class="s">"value cannot be zero"</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="p">}</span><span class="w"></span>
<span class="w">    </span><span class="n">NonZero</span><span class="p">()</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">delete</span><span class="p">;</span><span class="w"></span>
<span class="k">private</span><span class="o">:</span><span class="w"></span>
<span class="w">    </span><span class="n">T</span><span class="w"> </span><span class="n">value</span><span class="p">;</span><span class="w"></span>
<span class="p">};</span><span class="w"></span>
</code></pre></div>



<a name="265650706"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/To%20podcast%20or%20not%20to%20podcast/near/265650706" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jacob Lifshay <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/To.20podcast.20or.20not.20to.20podcast.html#265650706">(Dec 21 2021 at 06:02)</a>:</h4>
<p>it's even easier than that: <code>typedef bool MyType;</code></p>



<a name="265650710"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/To%20podcast%20or%20not%20to%20podcast/near/265650710" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Caleb Zulawski <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/To.20podcast.20or.20not.20to.20podcast.html#265650710">(Dec 21 2021 at 06:02)</a>:</h4>
<p>I don't think there's any good reason to define anything stricter than <code>Copy</code> for rust</p>



<a name="265650726"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/To%20podcast%20or%20not%20to%20podcast/near/265650726" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Caleb Zulawski <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/To.20podcast.20or.20not.20to.20podcast.html#265650726">(Dec 21 2021 at 06:02)</a>:</h4>
<p>lmao, I guess that's the clever solution, but yes, bool disallows most bit patterns of course</p>



<a name="265650738"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/To%20podcast%20or%20not%20to%20podcast/near/265650738" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Caleb Zulawski <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/To.20podcast.20or.20not.20to.20podcast.html#265650738">(Dec 21 2021 at 06:03)</a>:</h4>
<p>I guess I was just trying to illustrate that as far as C++ is concerned, <code>NonZero</code> is the equivalent of POD in C++20</p>



<a name="265650802"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/To%20podcast%20or%20not%20to%20podcast/near/265650802" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Caleb Zulawski <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/To.20podcast.20or.20not.20to.20podcast.html#265650802">(Dec 21 2021 at 06:04)</a>:</h4>
<p>Since rust isn't concerned about constructors or inheritance, I think <code>Copy</code> is sufficient</p>



<a name="265651088"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/To%20podcast%20or%20not%20to%20podcast/near/265651088" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jubilee <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/To.20podcast.20or.20not.20to.20podcast.html#265651088">(Dec 21 2021 at 06:11)</a>:</h4>
<p>Mostly it is very concerned about type validity.</p>



<a name="265651181"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/To%20podcast%20or%20not%20to%20podcast/near/265651181" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Caleb Zulawski <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/To.20podcast.20or.20not.20to.20podcast.html#265651181">(Dec 21 2021 at 06:13)</a>:</h4>
<p>What do you mean by type validity?</p>



<a name="265651200"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/To%20podcast%20or%20not%20to%20podcast/near/265651200" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jubilee <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/To.20podcast.20or.20not.20to.20podcast.html#265651200">(Dec 21 2021 at 06:13)</a>:</h4>
<p>I just mean that things unravel if you accidentally declare 2 is a bool.</p>



<a name="265651257"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/To%20podcast%20or%20not%20to%20podcast/near/265651257" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Caleb Zulawski <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/To.20podcast.20or.20not.20to.20podcast.html#265651257">(Dec 21 2021 at 06:14)</a>:</h4>
<p>The same is true for a regular, scalar bool, no?</p>



<a name="265651294"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/To%20podcast%20or%20not%20to%20podcast/near/265651294" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jubilee <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/To.20podcast.20or.20not.20to.20podcast.html#265651294">(Dec 21 2021 at 06:15)</a>:</h4>
<p>I wasn't proposing Simd&lt;bool&gt;, though.</p>



<a name="265651348"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/To%20podcast%20or%20not%20to%20podcast/near/265651348" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Caleb Zulawski <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/To.20podcast.20or.20not.20to.20podcast.html#265651348">(Dec 21 2021 at 06:16)</a>:</h4>
<p>While that's not necessarily a useful type, is there any reason it couldn't exist?</p>



<a name="265651389"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/To%20podcast%20or%20not%20to%20podcast/near/265651389" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jacob Lifshay <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/To.20podcast.20or.20not.20to.20podcast.html#265651389">(Dec 21 2021 at 06:17)</a>:</h4>
<p>likewise I'd like <code>Simd&lt;(), N&gt;</code> and also other ZSTs</p>



<a name="265651445"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/To%20podcast%20or%20not%20to%20podcast/near/265651445" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Caleb Zulawski <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/To.20podcast.20or.20not.20to.20podcast.html#265651445">(Dec 21 2021 at 06:18)</a>:</h4>
<p>Curious, why?</p>



<a name="265651454"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/To%20podcast%20or%20not%20to%20podcast/near/265651454" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jubilee <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/To.20podcast.20or.20not.20to.20podcast.html#265651454">(Dec 21 2021 at 06:18)</a>:</h4>
<p><span class="user-mention silent" data-user-id="312331">Caleb Zulawski</span> <a href="#narrow/stream/257879-project-portable-simd/topic/To.20podcast.20or.20not.20to.20podcast/near/265651348">said</a>:</p>
<blockquote>
<p>While that's not necessarily a useful type, is there any reason it couldn't exist?</p>
</blockquote>
<p>It shouldn't because people would assume it's like std::vector&lt;bool&gt;</p>



<a name="265651479"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/To%20podcast%20or%20not%20to%20podcast/near/265651479" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Caleb Zulawski <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/To.20podcast.20or.20not.20to.20podcast.html#265651479">(Dec 21 2021 at 06:19)</a>:</h4>
<p>I suppose we should ban <code>Vec&lt;bool&gt;</code>, then!</p>



<a name="265651546"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/To%20podcast%20or%20not%20to%20podcast/near/265651546" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jubilee <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/To.20podcast.20or.20not.20to.20podcast.html#265651546">(Dec 21 2021 at 06:20)</a>:</h4>
<p>That's harmless because there isn't a Mask type right next to it. :P</p>



<a name="265651552"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/To%20podcast%20or%20not%20to%20podcast/near/265651552" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jubilee <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/To.20podcast.20or.20not.20to.20podcast.html#265651552">(Dec 21 2021 at 06:20)</a>:</h4>
<p>Which is, in fact, sometimes rather like vector&lt;bool&gt;</p>



<a name="265651562"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/To%20podcast%20or%20not%20to%20podcast/near/265651562" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jubilee <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/To.20podcast.20or.20not.20to.20podcast.html#265651562">(Dec 21 2021 at 06:20)</a>:</h4>
<p><span class="user-mention silent" data-user-id="281757">Jubilee</span> <a href="#narrow/stream/257879-project-portable-simd/topic/To.20podcast.20or.20not.20to.20podcast/near/265651552">said</a>:</p>
<blockquote>
<p>Which is, in fact, sometimes rather like vector&lt;bool&gt;</p>
</blockquote>
<p>To no end of grief etc.</p>



<a name="265651567"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/To%20podcast%20or%20not%20to%20podcast/near/265651567" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Caleb Zulawski <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/To.20podcast.20or.20not.20to.20podcast.html#265651567">(Dec 21 2021 at 06:20)</a>:</h4>
<p>While I don't necessarily think there should be vectors of bools, I don't think it's worth pretending there's a technical reason it couldn't be done</p>



<a name="265651578"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/To%20podcast%20or%20not%20to%20podcast/near/265651578" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Caleb Zulawski <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/To.20podcast.20or.20not.20to.20podcast.html#265651578">(Dec 21 2021 at 06:21)</a>:</h4>
<p>It's an API decision.</p>



<a name="265651580"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/To%20podcast%20or%20not%20to%20podcast/near/265651580" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jubilee <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/To.20podcast.20or.20not.20to.20podcast.html#265651580">(Dec 21 2021 at 06:21)</a>:</h4>
<p>I don't know that there isn't, actually?</p>



<a name="265651584"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/To%20podcast%20or%20not%20to%20podcast/near/265651584" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Caleb Zulawski <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/To.20podcast.20or.20not.20to.20podcast.html#265651584">(Dec 21 2021 at 06:21)</a>:</h4>
<p>Why couldn't there be?</p>



<a name="265651742"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/To%20podcast%20or%20not%20to%20podcast/near/265651742" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jubilee <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/To.20podcast.20or.20not.20to.20podcast.html#265651742">(Dec 21 2021 at 06:25)</a>:</h4>
<p>I mean for one it's banned in<code>compiler::rustc_typeck</code>. :P<br>
For two it's not obvious it monomorphizes and compiles. We certainly thought <code>Simd&lt;f32, 3&gt;</code> would compile without effort, until it didn't.<br>
We can't just handwave these details.</p>



<a name="265651822"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/To%20podcast%20or%20not%20to%20podcast/near/265651822" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jubilee <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/To.20podcast.20or.20not.20to.20podcast.html#265651822">(Dec 21 2021 at 06:26)</a>:</h4>
<p>Unfortunately the person who originally wrote that code didn't also have my habit of rambling about related details alongside their code or didn't know or put those notes elsewhere, or we might be able to simply read those notes and know what would validly compile.</p>



<a name="265651892"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/To%20podcast%20or%20not%20to%20podcast/near/265651892" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Caleb Zulawski <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/To.20podcast.20or.20not.20to.20podcast.html#265651892">(Dec 21 2021 at 06:28)</a>:</h4>
<p>I don't see how that's relevant to handling all bit patterns though. It's certainly possible LLVM wouldn't handle bool specifically, but transparent wrappers of our already supported simd types don't have that problem</p>



<a name="265651911"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/To%20podcast%20or%20not%20to%20podcast/near/265651911" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jubilee <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/To.20podcast.20or.20not.20to.20podcast.html#265651911">(Dec 21 2021 at 06:28)</a>:</h4>
<p>Have you already run the experiment, then?</p>



<a name="265651920"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/To%20podcast%20or%20not%20to%20podcast/near/265651920" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Caleb Zulawski <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/To.20podcast.20or.20not.20to.20podcast.html#265651920">(Dec 21 2021 at 06:29)</a>:</h4>
<p>You wouldn't call intrinsics on a NonZero&lt;u8&gt;, you implement it by obtaining the underlying u8</p>



<a name="265651926"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/To%20podcast%20or%20not%20to%20podcast/near/265651926" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Caleb Zulawski <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/To.20podcast.20or.20not.20to.20podcast.html#265651926">(Dec 21 2021 at 06:29)</a>:</h4>
<p>All that would need to be extended is repr(simd) to calculate the layout</p>



<a name="265651928"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/To%20podcast%20or%20not%20to%20podcast/near/265651928" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jubilee <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/To.20podcast.20or.20not.20to.20podcast.html#265651928">(Dec 21 2021 at 06:29)</a>:</h4>
<p>Yes, but it still has to be valid for <code>#[repr(simd)]</code></p>



<a name="265651934"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/To%20podcast%20or%20not%20to%20podcast/near/265651934" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jubilee <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/To.20podcast.20or.20not.20to.20podcast.html#265651934">(Dec 21 2021 at 06:29)</a>:</h4>
<p>yes.</p>



<a name="265651989"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/To%20podcast%20or%20not%20to%20podcast/near/265651989" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Caleb Zulawski <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/To.20podcast.20or.20not.20to.20podcast.html#265651989">(Dec 21 2021 at 06:30)</a>:</h4>
<p>That's trivial though? That's the whole point of repr(transparent)</p>



<a name="265651997"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/To%20podcast%20or%20not%20to%20podcast/near/265651997" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jubilee <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/To.20podcast.20or.20not.20to.20podcast.html#265651997">(Dec 21 2021 at 06:30)</a>:</h4>
<p>Is it?</p>



<a name="265652030"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/To%20podcast%20or%20not%20to%20podcast/near/265652030" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lokathor <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/To.20podcast.20or.20not.20to.20podcast.html#265652030">(Dec 21 2021 at 06:31)</a>:</h4>
<p><span class="user-mention silent" data-user-id="229517">Jacob Lifshay</span> <a href="#narrow/stream/257879-project-portable-simd/topic/To.20podcast.20or.20not.20to.20podcast/near/265648544">said</a>:</p>
<blockquote>
<p>a little off-topic: looking through <code>Pod</code>'s definition -- why does <code>PhantomData&lt;T&gt;: Pod</code> require <code>T: Pod</code>?</p>
</blockquote>
<p>The thinking is that if you have a <code>PhantomData</code> field <em>at all</em> it's quite weird, and mostly the bound there only affects the <code>derive</code> macro anyway because (unlike <code>Copy</code>!) you can always just override the system and say that your type is Pod even if not all fields are Pod (but probably that's unwise (but i'm not your parents (so do whatever))).</p>



<a name="265652035"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/To%20podcast%20or%20not%20to%20podcast/near/265652035" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jubilee <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/To.20podcast.20or.20not.20to.20podcast.html#265652035">(Dec 21 2021 at 06:31)</a>:</h4>
<p>I mean really I was just noting we will need to, at least, audit our implementation for all the cites of transmutes to make sure they're correct.</p>



<a name="265652036"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/To%20podcast%20or%20not%20to%20podcast/near/265652036" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Caleb Zulawski <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/To.20podcast.20or.20not.20to.20podcast.html#265652036">(Dec 21 2021 at 06:31)</a>:</h4>
<p>Yeah why not? It guarantees the layout and ABI is identical to the field</p>



<a name="265652096"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/To%20podcast%20or%20not%20to%20podcast/near/265652096" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Caleb Zulawski <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/To.20podcast.20or.20not.20to.20podcast.html#265652096">(Dec 21 2021 at 06:32)</a>:</h4>
<p>Yeah, I agree that we will need to, which is why <code>SimdElement</code> is unsafe</p>



<a name="265652100"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/To%20podcast%20or%20not%20to%20podcast/near/265652100" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jacob Lifshay <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/To.20podcast.20or.20not.20to.20podcast.html#265652100">(Dec 21 2021 at 06:32)</a>:</h4>
<p>cuz those ZSTs are useful for generics and macros, e.g.:</p>
<div class="codehilite" data-code-language="Rust"><pre><span></span><code><span class="fm">macro_rules!</span><span class="w"> </span><span class="n">struct_of_arrays</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="p">(</span><span class="w"></span>
<span class="w">        </span><span class="k">struct</span> <span class="cp">$name</span>:<span class="nc">ident</span><span class="p">[</span><span class="cp">$($generics</span>:<span class="nc">tt</span><span class="p">)</span><span class="o">+</span><span class="p">]</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">            </span><span class="cp">$($field</span>:<span class="nc">ident</span>:<span class="cp">$ty</span>:<span class="nc">ty</span><span class="p">,)</span><span class="o">*</span><span class="w"></span>
<span class="w">        </span><span class="p">}</span><span class="w"></span>
<span class="w">    </span><span class="p">)</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">        </span><span class="k">struct</span> <span class="cp">$name</span><span class="o">&lt;</span><span class="cp">$($generics</span><span class="p">)</span><span class="o">+</span><span class="p">,</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="n">LANES</span>: <span class="kt">usize</span><span class="o">&gt;</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">            </span><span class="cp">$($field</span>: <span class="nc">Simd</span><span class="o">&lt;</span><span class="cp">$ty</span><span class="p">,</span><span class="w"> </span><span class="n">LANES</span><span class="o">&gt;</span><span class="p">,)</span><span class="o">*</span><span class="w"></span>
<span class="w">        </span><span class="p">}</span><span class="w"></span>
<span class="w">    </span><span class="p">}</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="n">struct_of_arrays</span><span class="o">!</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="k">struct</span> <span class="nc">MutNodeWalker</span><span class="o">&lt;'</span><span class="na">a</span><span class="p">,</span><span class="w"> </span><span class="n">T</span><span class="o">&gt;</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">        </span><span class="n">node</span>: <span class="nc">NonNull</span><span class="o">&lt;</span><span class="n">Node</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;&gt;</span><span class="p">,</span><span class="w"></span>
<span class="w">        </span><span class="n">prev_node</span>: <span class="nc">NonNull</span><span class="o">&lt;</span><span class="n">Node</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;&gt;</span><span class="p">,</span><span class="w"></span>
<span class="w">        </span><span class="n">_phantom</span>: <span class="nc">PhantomData</span><span class="o">&lt;&amp;'</span><span class="na">a</span><span class="w"> </span><span class="k">mut</span><span class="w"> </span><span class="n">T</span><span class="o">&gt;</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="p">}</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>
</code></pre></div>



<a name="265652139"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/To%20podcast%20or%20not%20to%20podcast/near/265652139" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jacob Lifshay <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/To.20podcast.20or.20not.20to.20podcast.html#265652139">(Dec 21 2021 at 06:33)</a>:</h4>
<p>(deleted)</p>



<a name="265652187"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/To%20podcast%20or%20not%20to%20podcast/near/265652187" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jacob Lifshay <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/To.20podcast.20or.20not.20to.20podcast.html#265652187">(Dec 21 2021 at 06:34)</a>:</h4>
<p>(stupid zulip app)</p>



<a name="265652291"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/To%20podcast%20or%20not%20to%20podcast/near/265652291" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lokathor <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/To.20podcast.20or.20not.20to.20podcast.html#265652291">(Dec 21 2021 at 06:36)</a>:</h4>
<p>Also, notably, I just recently added this &lt;<a href="https://docs.rs/bytemuck/latest/src/bytemuck/pod.rs.html#113-119">https://docs.rs/bytemuck/latest/src/bytemuck/pod.rs.html#113-119</a>&gt;, though it doesn't show up in the <a href="http://docs.rs">docs.rs</a> build right now.</p>



<a name="265652315"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/To%20podcast%20or%20not%20to%20podcast/near/265652315" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lokathor <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/To.20podcast.20or.20not.20to.20podcast.html#265652315">(Dec 21 2021 at 06:36)</a>:</h4>
<p><span class="user-mention silent" data-user-id="312331">Caleb Zulawski</span> <a href="#narrow/stream/257879-project-portable-simd/topic/To.20podcast.20or.20not.20to.20podcast/near/265650710">said</a>:</p>
<blockquote>
<p>I don't think there's any good reason to define anything stricter than <code>Copy</code> for rust</p>
</blockquote>
<p>well, once the full safe-transmute project has happened (&lt;3 u jack) then you're correct. But until it happens, you are not.</p>



<a name="265652384"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/To%20podcast%20or%20not%20to%20podcast/near/265652384" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lokathor <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/To.20podcast.20or.20not.20to.20podcast.html#265652384">(Dec 21 2021 at 06:38)</a>:</h4>
<p>for example, when can we view <code>&amp;mut T</code> as a <code>&amp;mut [u8]</code> instead? It's a fair question, inquiring minds want to know.</p>



<a name="265652391"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/To%20podcast%20or%20not%20to%20podcast/near/265652391" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Caleb Zulawski <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/To.20podcast.20or.20not.20to.20podcast.html#265652391">(Dec 21 2021 at 06:38)</a>:</h4>
<p>My concern is that it feels like my todo list is getting infinitely long, that I now need to implement repr(simd) for transparent types just to get <code>Simd::&lt;i32, _&gt;::clamp</code>, signals are getting crossed between "this design prevents future improvement/is currently somewhat limiting" and "we need to fully test every branch of possible development before even implementing any possible prior components"</p>



<a name="265652549"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/To%20podcast%20or%20not%20to%20podcast/near/265652549" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jacob Lifshay <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/To.20podcast.20or.20not.20to.20podcast.html#265652549">(Dec 21 2021 at 06:41)</a>:</h4>
<p>well....us talking about what we want in the shiny far-off future doesn't stop us from working on the quickly achievable parts now</p>



<a name="265652550"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/To%20podcast%20or%20not%20to%20podcast/near/265652550" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lokathor <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/To.20podcast.20or.20not.20to.20podcast.html#265652550">(Dec 21 2021 at 06:41)</a>:</h4>
<p>Personally, I don't think that <code>repr(transparent)</code> should be a concern at this stage. As long as any current designs don't fully lock out the future possibilities it's probably fine.</p>
<p>And I strongly suspect that special newtype wrappers in general aren't a good fit for simd.</p>



<a name="265652604"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/To%20podcast%20or%20not%20to%20podcast/near/265652604" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lokathor <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/To.20podcast.20or.20not.20to.20podcast.html#265652604">(Dec 21 2021 at 06:42)</a>:</h4>
<p>like, "a float that's non-nan" isn't even a thing that core does, so i really don't suspect that simd will do it any faster</p>



<a name="265652624"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/To%20podcast%20or%20not%20to%20podcast/near/265652624" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lokathor <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/To.20podcast.20or.20not.20to.20podcast.html#265652624">(Dec 21 2021 at 06:42)</a>:</h4>
<p>simple feature parity with core, and in the case of floats with std, is already a very tall task</p>



<a name="265652649"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/To%20podcast%20or%20not%20to%20podcast/near/265652649" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jacob Lifshay <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/To.20podcast.20or.20not.20to.20podcast.html#265652649">(Dec 21 2021 at 06:43)</a>:</h4>
<p>...but i <em>like</em> nan...<span aria-label="bread" class="emoji emoji-1f35e" role="img" title="bread">:bread:</span></p>



<a name="265652650"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/To%20podcast%20or%20not%20to%20podcast/near/265652650" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Caleb Zulawski <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/To.20podcast.20or.20not.20to.20podcast.html#265652650">(Dec 21 2021 at 06:43)</a>:</h4>
<blockquote>
<p>well....us talking about what we want in the shiny far-off future doesn't stop us from working on the quickly achievable parts now</p>
</blockquote>
<p>Well, yes except my PR has been contested for over 2 weeks on the concerns about what it potentially opens up in the future, and we still don't have integer clamp <span aria-label="pensive" class="emoji emoji-1f614" role="img" title="pensive">:pensive:</span></p>



<a name="265652717"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/To%20podcast%20or%20not%20to%20podcast/near/265652717" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lokathor <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/To.20podcast.20or.20not.20to.20podcast.html#265652717">(Dec 21 2021 at 06:44)</a>:</h4>
<p>but you do have varying shift! which i never put into <code>wide</code> (yet?)</p>



<a name="265652753"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/To%20podcast%20or%20not%20to%20podcast/near/265652753" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Caleb Zulawski <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/To.20podcast.20or.20not.20to.20podcast.html#265652753">(Dec 21 2021 at 06:45)</a>:</h4>
<p>My point is that the conversion to traits to reduce the API has been stalled on far future possibilities of weird reprs and types</p>



<a name="265652923"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/To%20podcast%20or%20not%20to%20podcast/near/265652923" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jacob Lifshay <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/To.20podcast.20or.20not.20to.20podcast.html#265652923">(Dec 21 2021 at 06:48)</a>:</h4>
<p>that'd be much easier if we took the approach "SimdElement" is the only trait a user can see, there won't be any parent traits until we decide what those are to prevent unexpected dependencies ... though maybe that's unnecessary cuz it's still all unstable.</p>



<a name="265652959"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/To%20podcast%20or%20not%20to%20podcast/near/265652959" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Caleb Zulawski <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/To.20podcast.20or.20not.20to.20podcast.html#265652959">(Dec 21 2021 at 06:50)</a>:</h4>
<p>That won't really be possible when it's time to implement something like <code>abs</code>, only valid for some element types</p>



<a name="265653120"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/To%20podcast%20or%20not%20to%20podcast/near/265653120" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jacob Lifshay <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/To.20podcast.20or.20not.20to.20podcast.html#265653120">(Dec 21 2021 at 06:52)</a>:</h4>
<div class="codehilite" data-code-language="Rust"><pre><span></span><code><span class="k">pub</span><span class="w"> </span><span class="k">trait</span><span class="w"> </span><span class="n">SimdElement</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="k">const</span><span class="w"> </span><span class="n">HAS_ABS</span>: <span class="kt">bool</span><span class="p">;</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>
</code></pre></div>



<a name="265653142"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/To%20podcast%20or%20not%20to%20podcast/near/265653142" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jacob Lifshay <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/To.20podcast.20or.20not.20to.20podcast.html#265653142">(Dec 21 2021 at 06:52)</a>:</h4>
<p>idk if rustc is far enough along for that to work tho</p>



<a name="265653170"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/To%20podcast%20or%20not%20to%20podcast/near/265653170" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lokathor <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/To.20podcast.20or.20not.20to.20podcast.html#265653170">(Dec 21 2021 at 06:53)</a>:</h4>
<p>It is not the current design to have so many traits, but an Abs trait would be a good fit probably</p>



<a name="265653177"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/To%20podcast%20or%20not%20to%20podcast/near/265653177" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lokathor <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/To.20podcast.20or.20not.20to.20podcast.html#265653177">(Dec 21 2021 at 06:53)</a>:</h4>
<p>and so on for more math ops</p>



<a name="265653204"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/To%20podcast%20or%20not%20to%20podcast/near/265653204" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Caleb Zulawski <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/To.20podcast.20or.20not.20to.20podcast.html#265653204">(Dec 21 2021 at 06:53)</a>:</h4>
<p>I believe the trait would actually be <code>Signed</code>, since we have a handful of other signed ops</p>



<a name="265653250"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/To%20podcast%20or%20not%20to%20podcast/near/265653250" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lokathor <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/To.20podcast.20or.20not.20to.20podcast.html#265653250">(Dec 21 2021 at 06:54)</a>:</h4>
<p>possibly, though usually grouping too many things under one trait gives a bad time. Better to have more traits that are each dead simple.</p>



<a name="265653254"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/To%20podcast%20or%20not%20to%20podcast/near/265653254" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Caleb Zulawski <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/To.20podcast.20or.20not.20to.20podcast.html#265653254">(Dec 21 2021 at 06:54)</a>:</h4>
<p>It is the current design to have so many traits, when it was decided that we couldn't keep the individually implemented functions due to the documentation.</p>



<a name="265653266"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/To%20podcast%20or%20not%20to%20podcast/near/265653266" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lokathor <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/To.20podcast.20or.20not.20to.20podcast.html#265653266">(Dec 21 2021 at 06:55)</a>:</h4>
<p>apologies, i mean the current design of the rest of the standard library</p>



<a name="265653273"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/To%20podcast%20or%20not%20to%20podcast/near/265653273" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Caleb Zulawski <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/To.20podcast.20or.20not.20to.20podcast.html#265653273">(Dec 21 2021 at 06:55)</a>:</h4>
<p>Agreed</p>



<a name="265653281"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/To%20podcast%20or%20not%20to%20podcast/near/265653281" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lokathor <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/To.20podcast.20or.20not.20to.20podcast.html#265653281">(Dec 21 2021 at 06:55)</a>:</h4>
<p>speaking of docs, did you see my idea in the other thread?</p>



<hr><p>Last updated: Apr 12 2022 at 20:01 UTC</p>
</html>