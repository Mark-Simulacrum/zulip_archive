<html>
<head><meta charset="utf-8"><title>Scatter as a user trait? · project-portable-simd · Zulip Chat Archive</title></head>
<h2>Stream: <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/index.html">project-portable-simd</a></h2>
<h3>Topic: <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/Scatter.20as.20a.20user.20trait.3F.html">Scatter as a user trait?</a></h3>

<hr>

<base href="https://rust-lang.zulipchat.com">

<head><link href="https://zulip-archive.rust-lang.org/style.css" rel="stylesheet"></head>

<a name="265365053"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/Scatter%20as%20a%20user%20trait%3F/near/265365053" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Caleb Zulawski <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/Scatter.20as.20a.20user.20trait.3F.html#265365053">(Dec 17 2021 at 21:48)</a>:</h4>
<p>What if what you're scattering to doesn't have indices?</p>



<a name="265365363"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/Scatter%20as%20a%20user%20trait%3F/near/265365363" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jacob Lifshay <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/Scatter.20as.20a.20user.20trait.3F.html#265365363">(Dec 17 2021 at 21:50)</a>:</h4>
<p>scatter to <code>HashSet</code>!!</p>



<a name="265365569"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/Scatter%20as%20a%20user%20trait%3F/near/265365569" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jacob Lifshay <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/Scatter.20as.20a.20user.20trait.3F.html#265365569">(Dec 17 2021 at 21:52)</a>:</h4>
<p><span class="user-mention silent" data-user-id="312331">Caleb Zulawski</span> <a href="#narrow/stream/257879-project-portable-simd/topic/Scatter.20to.20.5BMaybeUninit.3CT.3E.5D/near/265365053">said</a>:</p>
<blockquote>
<p>What if what you're scattering to doesn't have indices?</p>
</blockquote>
<p>set <code>indices</code> to <code>Simd&lt;(), N&gt;</code>, of course!</p>



<a name="265365768"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/Scatter%20as%20a%20user%20trait%3F/near/265365768" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jubilee <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/Scatter.20as.20a.20user.20trait.3F.html#265365768">(Dec 17 2021 at 21:55)</a>:</h4>
<p><span class="user-mention silent" data-user-id="312331">Caleb Zulawski</span> <a href="#narrow/stream/257879-project-portable-simd/topic/Scatter.20to.20.5BMaybeUninit.3CT.3E.5D/near/265365053">said</a>:</p>
<blockquote>
<p>What if what you're scattering to doesn't have indices?</p>
</blockquote>
<p>Uhh example?</p>



<a name="265366567"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/Scatter%20as%20a%20user%20trait%3F/near/265366567" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jubilee <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/Scatter.20as.20a.20user.20trait.3F.html#265366567">(Dec 17 2021 at 22:02)</a>:</h4>
<p>and yeah <span class="user-mention" data-user-id="326176">@Boxy [she/her]</span> was talking about making associated types and constants work Soon-ish for const generics, so I think a trait that used an associated type as an input to one of its implemented functions would be viable.</p>



<a name="265366820"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/Scatter%20as%20a%20user%20trait%3F/near/265366820" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Caleb Zulawski <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/Scatter.20as.20a.20user.20trait.3F.html#265366820">(Dec 17 2021 at 22:05)</a>:</h4>
<p>Well you mentioned the linked list example, you're not scattering to offsets to pointers, you're probably just using those pointers directly</p>



<a name="265366844"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/Scatter%20as%20a%20user%20trait%3F/near/265366844" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jubilee <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/Scatter.20as.20a.20user.20trait.3F.html#265366844">(Dec 17 2021 at 22:05)</a>:</h4>
<p>Oh yes.</p>



<a name="265366999"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/Scatter%20as%20a%20user%20trait%3F/near/265366999" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jubilee <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/Scatter.20as.20a.20user.20trait.3F.html#265366999">(Dec 17 2021 at 22:06)</a>:</h4>
<p>With an associated type it's actually fine if the linked list accepts pointers as """indices""".</p>



<a name="265367014"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/Scatter%20as%20a%20user%20trait%3F/near/265367014" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jacob Lifshay <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/Scatter.20as.20a.20user.20trait.3F.html#265367014">(Dec 17 2021 at 22:06)</a>:</h4>
<p>theoretically you could mush linked lists into that api, the indexes would be cursors or something, and the <code>self</code> would be the linked list itself</p>



<a name="265367025"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/Scatter%20as%20a%20user%20trait%3F/near/265367025" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jubilee <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/Scatter.20as.20a.20user.20trait.3F.html#265367025">(Dec 17 2021 at 22:06)</a>:</h4>
<p>yeah.</p>



<a name="265367078"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/Scatter%20as%20a%20user%20trait%3F/near/265367078" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jacob Lifshay <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/Scatter.20as.20a.20user.20trait.3F.html#265367078">(Dec 17 2021 at 22:07)</a>:</h4>
<p>there are other containers that that doesn't work on, such as sets</p>



<a name="265367098"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/Scatter%20as%20a%20user%20trait%3F/near/265367098" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Caleb Zulawski <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/Scatter.20as.20a.20user.20trait.3F.html#265367098">(Dec 17 2021 at 22:07)</a>:</h4>
<p>It just sounds potentially not ergonomic, and I'm not sure what exactly the gain is?</p>



<a name="265367178"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/Scatter%20as%20a%20user%20trait%3F/near/265367178" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Caleb Zulawski <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/Scatter.20as.20a.20user.20trait.3F.html#265367178">(Dec 17 2021 at 22:08)</a>:</h4>
<p>I'm interested to see an implementation but it seems difficult to make anything much better than something like the fns we already have</p>



<a name="265371342"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/Scatter%20as%20a%20user%20trait%3F/near/265371342" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jubilee <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/Scatter.20as.20a.20user.20trait.3F.html#265371342">(Dec 17 2021 at 22:37)</a>:</h4>
<p><span class="user-mention silent" data-user-id="312331">Caleb Zulawski</span> <a href="#narrow/stream/257879-project-portable-simd/topic/Scatter.20as.20a.20user.20trait.3F/near/265367098">said</a>:</p>
<blockquote>
<p>It just sounds potentially not ergonomic, and I'm not sure what exactly the gain is?</p>
</blockquote>
<p>Mostly it would allow decoupling the scatter methods from a given container. We're providing them for slices because it seems natural but I am increasingly of the opinion that while there is nothing <strong>wrong</strong> with this, at the same time there is nothing <strong>right</strong> either.</p>



<a name="265371639"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/Scatter%20as%20a%20user%20trait%3F/near/265371639" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Caleb Zulawski <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/Scatter.20as.20a.20user.20trait.3F.html#265371639">(Dec 17 2021 at 22:41)</a>:</h4>
<p>The only good argument for slices is that it's a standard type and it's easy to write a safe wrapper, but it does get complicated if you don't want to compromise any performance</p>



<a name="265371685"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/Scatter%20as%20a%20user%20trait%3F/near/265371685" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Caleb Zulawski <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/Scatter.20as.20a.20user.20trait.3F.html#265371685">(Dec 17 2021 at 22:41)</a>:</h4>
<p>Most people would be happy with the regular pointer interface as the bare minimum anyway, I think</p>



<a name="265371762"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/Scatter%20as%20a%20user%20trait%3F/near/265371762" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Caleb Zulawski <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/Scatter.20as.20a.20user.20trait.3F.html#265371762">(Dec 17 2021 at 22:42)</a>:</h4>
<p>Beyond that is just convenience really</p>



<a name="265371782"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/Scatter%20as%20a%20user%20trait%3F/near/265371782" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Caleb Zulawski <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/Scatter.20as.20a.20user.20trait.3F.html#265371782">(Dec 17 2021 at 22:42)</a>:</h4>
<p>I agree none of this is really right or wrong</p>



<a name="265372575"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/Scatter%20as%20a%20user%20trait%3F/near/265372575" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jubilee <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/Scatter.20as.20a.20user.20trait.3F.html#265372575">(Dec 17 2021 at 22:48)</a>:</h4>
<p>Yeah, I think the dealio is that if someone <strong>can</strong> write a performant safe interface for a container, they should be allowed to, and they will have internal knowledge we don't.</p>



<a name="265372670"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/Scatter%20as%20a%20user%20trait%3F/near/265372670" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jubilee <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/Scatter.20as.20a.20user.20trait.3F.html#265372670">(Dec 17 2021 at 22:49)</a>:</h4>
<p>I expect this to be a thing where like users can implement it but in practice people only use the stdlib impls for slices.</p>



<a name="265377865"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/Scatter%20as%20a%20user%20trait%3F/near/265377865" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Thom Chiovoloni <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/Scatter.20as.20a.20user.20trait.3F.html#265377865">(Dec 17 2021 at 23:57)</a>:</h4>
<p>Can we come up with an example for when a user would need to implement this? The bar for user-implemented traits in core is rather high, and usually indicates a fundamental concept</p>



<a name="265378078"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/Scatter%20as%20a%20user%20trait%3F/near/265378078" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jacob Lifshay <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/Scatter.20as.20a.20user.20trait.3F.html#265378078">(Dec 18 2021 at 00:00)</a>:</h4>
<p>it's kinda like <code>std::io::Write::write_vectored</code></p>



<a name="265379120"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/Scatter%20as%20a%20user%20trait%3F/near/265379120" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Thom Chiovoloni <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/Scatter.20as.20a.20user.20trait.3F.html#265379120">(Dec 18 2021 at 00:12)</a>:</h4>
<p>Err, how so?</p>



<hr><p>Last updated: Apr 12 2022 at 20:01 UTC</p>
</html>