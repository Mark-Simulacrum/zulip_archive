<html>
<head><meta charset="utf-8"><title>✔ mask to u8 · project-portable-simd · Zulip Chat Archive</title></head>
<h2>Stream: <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/index.html">project-portable-simd</a></h2>
<h3>Topic: <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/.E2.9C.94.20mask.20to.20u8.html">✔ mask to u8</a></h3>

<hr>

<base href="https://rust-lang.zulipchat.com">

<head><link href="https://zulip-archive.rust-lang.org/style.css" rel="stylesheet"></head>

<a name="267921872"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/%E2%9C%94%20mask%20to%20u8/near/267921872" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Notification Bot <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/.E2.9C.94.20mask.20to.20u8.html#267921872">(Jan 13 2022 at 19:57)</a>:</h4>
<p><span class="user-mention silent" data-user-id="399416">Jorge Leitao</span> has marked this topic as resolved.</p>



<a name="267960271"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/%E2%9C%94%20mask%20to%20u8/near/267960271" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Caleb Zulawski <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/.E2.9C.94.20mask.20to.20u8.html#267960271">(Jan 14 2022 at 02:23)</a>:</h4>
<p><span class="user-mention" data-user-id="229517">@Jacob Lifshay</span> could you take a look at this issue in my branch?</p>



<a name="267960281"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/%E2%9C%94%20mask%20to%20u8/near/267960281" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Caleb Zulawski <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/.E2.9C.94.20mask.20to.20u8.html#267960281">(Jan 14 2022 at 02:23)</a>:</h4>
<p>this test doesn't compile: <a href="https://github.com/rust-lang/portable-simd/blob/feature/better-bitmasks/crates/core_simd/tests/masks.rs#L85-L97">https://github.com/rust-lang/portable-simd/blob/feature/better-bitmasks/crates/core_simd/tests/masks.rs#L85-L97</a></p>



<a name="267960360"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/%E2%9C%94%20mask%20to%20u8/near/267960360" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Caleb Zulawski <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/.E2.9C.94.20mask.20to.20u8.html#267960360">(Jan 14 2022 at 02:24)</a>:</h4>
<p>the error is unusual:</p>
<div class="codehilite"><pre><span></span><code>95  |                 assert_eq!(core_simd::Mask::&lt;$type, 16&gt;::from_bitmask(bitmask), mask);
    |                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ the trait `ToBitMask&lt;[u8; 2]&gt;` is not implemented for `core_simd::Mask&lt;isize, 16_usize&gt;`
</code></pre></div>



<a name="267960388"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/%E2%9C%94%20mask%20to%20u8/near/267960388" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Caleb Zulawski <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/.E2.9C.94.20mask.20to.20u8.html#267960388">(Jan 14 2022 at 02:25)</a>:</h4>
<p>if you look in that commit, that trait is definitely implemented on it</p>



<a name="267960397"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/%E2%9C%94%20mask%20to%20u8/near/267960397" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Caleb Zulawski <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/.E2.9C.94.20mask.20to.20u8.html#267960397">(Jan 14 2022 at 02:25)</a>:</h4>
<p>I'm guessing this is an issue with const generic exprs, but I'm not sure</p>



<a name="267960573"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/%E2%9C%94%20mask%20to%20u8/near/267960573" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jacob Lifshay <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/.E2.9C.94.20mask.20to.20u8.html#267960573">(Jan 14 2022 at 02:28)</a>:</h4>
<p>hmm, iirc const generic exprs sometimes don't really unify with each other correctly...i'm not familiar with const generics machinery in rustc...</p>



<a name="267960647"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/%E2%9C%94%20mask%20to%20u8/near/267960647" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Caleb Zulawski <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/.E2.9C.94.20mask.20to.20u8.html#267960647">(Jan 14 2022 at 02:29)</a>:</h4>
<p>hm, that does seem to be the likely cause of this</p>



<a name="267960692"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/%E2%9C%94%20mask%20to%20u8/near/267960692" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jacob Lifshay <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/.E2.9C.94.20mask.20to.20u8.html#267960692">(Jan 14 2022 at 02:30)</a>:</h4>
<p>maybe ask on <a class="stream" data-stream-id="260443" href="/#narrow/stream/260443-project-const-generics">#project-const-generics</a>?</p>



<a name="267960710"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/%E2%9C%94%20mask%20to%20u8/near/267960710" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Caleb Zulawski <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/.E2.9C.94.20mask.20to.20u8.html#267960710">(Jan 14 2022 at 02:30)</a>:</h4>
<p>I feel like this is the "correct" way to implement the trait, but maybe not there yet..</p>



<a name="267960714"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/%E2%9C%94%20mask%20to%20u8/near/267960714" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Caleb Zulawski <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/.E2.9C.94.20mask.20to.20u8.html#267960714">(Jan 14 2022 at 02:30)</a>:</h4>
<p>yeah maybe. I can try to make a minimal example</p>



<a name="267960719"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/%E2%9C%94%20mask%20to%20u8/near/267960719" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jacob Lifshay <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/.E2.9C.94.20mask.20to.20u8.html#267960719">(Jan 14 2022 at 02:30)</a>:</h4>
<p>also, change title to something searchable</p>



<a name="267960730"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/%E2%9C%94%20mask%20to%20u8/near/267960730" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Caleb Zulawski <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/.E2.9C.94.20mask.20to.20u8.html#267960730">(Jan 14 2022 at 02:30)</a>:</h4>
<p>Title?</p>



<a name="267960741"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/%E2%9C%94%20mask%20to%20u8/near/267960741" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Boxy [she/her] <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/.E2.9C.94.20mask.20to.20u8.html#267960741">(Jan 14 2022 at 02:31)</a>:</h4>
<p>where is the trait impl for <code>ToBitmask&lt;[u8; 2]&gt; for Mask&lt;isize, 16&gt;</code> ?</p>



<a name="267960760"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/%E2%9C%94%20mask%20to%20u8/near/267960760" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Caleb Zulawski <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/.E2.9C.94.20mask.20to.20u8.html#267960760">(Jan 14 2022 at 02:31)</a>:</h4>
<p><a href="https://github.com/rust-lang/portable-simd/blob/feature/better-bitmasks/crates/core_simd/src/masks/to_bitmask.rs#L88-L99">https://github.com/rust-lang/portable-simd/blob/feature/better-bitmasks/crates/core_simd/src/masks/to_bitmask.rs#L88-L99</a></p>



<a name="267960765"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/%E2%9C%94%20mask%20to%20u8/near/267960765" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jacob Lifshay <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/.E2.9C.94.20mask.20to.20u8.html#267960765">(Jan 14 2022 at 02:31)</a>:</h4>
<p>"mask to u8" is kinda about a separate issue...</p>



<a name="267960816"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/%E2%9C%94%20mask%20to%20u8/near/267960816" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Caleb Zulawski <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/.E2.9C.94.20mask.20to.20u8.html#267960816">(Jan 14 2022 at 02:32)</a>:</h4>
<p>perhaps, this the bitmasking issue though...</p>



<a name="268024818"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/%E2%9C%94%20mask%20to%20u8/near/268024818" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Caleb Zulawski <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/.E2.9C.94.20mask.20to.20u8.html#268024818">(Jan 14 2022 at 15:03)</a>:</h4>
<p>a trivial example works, so I'm not sure what specifically is different here: <a href="https://play.rust-lang.org/?version=nightly&amp;mode=debug&amp;edition=2021&amp;gist=d401ea9060d4bd1403aeca3aae1360ac">https://play.rust-lang.org/?version=nightly&amp;mode=debug&amp;edition=2021&amp;gist=d401ea9060d4bd1403aeca3aae1360ac</a></p>



<a name="268024968"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/%E2%9C%94%20mask%20to%20u8/near/268024968" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Caleb Zulawski <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/.E2.9C.94.20mask.20to.20u8.html#268024968">(Jan 14 2022 at 15:04)</a>:</h4>
<p><code>core_simd</code> also produces this warning, where the playground example doesn't</p>
<div class="codehilite"><pre><span></span><code>warning: cannot use constants which depend on generic parameters in types
  |
  = note: `#[warn(const_evaluatable_unchecked)]` on by default
</code></pre></div>



<a name="268026777"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/%E2%9C%94%20mask%20to%20u8/near/268026777" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Caleb Zulawski <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/.E2.9C.94.20mask.20to.20u8.html#268026777">(Jan 14 2022 at 15:17)</a>:</h4>
<p>it's none of the extra where clauses or anything: <a href="https://play.rust-lang.org/?version=nightly&amp;mode=debug&amp;edition=2021&amp;gist=555a50f3bacca5558e0260d2b01eeaf8">https://play.rust-lang.org/?version=nightly&amp;mode=debug&amp;edition=2021&amp;gist=555a50f3bacca5558e0260d2b01eeaf8</a></p>



<a name="268026801"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/%E2%9C%94%20mask%20to%20u8/near/268026801" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Caleb Zulawski <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/.E2.9C.94.20mask.20to.20u8.html#268026801">(Jan 14 2022 at 15:17)</a>:</h4>
<p>at a loss for what the difference between my example and core_simd is</p>



<hr><p>Last updated: Apr 12 2022 at 20:01 UTC</p>
</html>