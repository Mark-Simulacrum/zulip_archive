<html>
<head><meta charset="utf-8"><title>PR open to rust-lang/rust · project-portable-simd · Zulip Chat Archive</title></head>
<h2>Stream: <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/index.html">project-portable-simd</a></h2>
<h3>Topic: <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/PR.20open.20to.20rust-lang.2Frust.html">PR open to rust-lang/rust</a></h3>

<hr>

<base href="https://rust-lang.zulipchat.com">

<head><link href="https://zulip-archive.rust-lang.org/style.css" rel="stylesheet"></head>

<a name="254453151"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/PR%20open%20to%20rust-lang/rust/near/254453151" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jubilee <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/PR.20open.20to.20rust-lang.2Frust.html#254453151">(Sep 22 2021 at 23:00)</a>:</h4>
<p>In <a href="https://github.com/rust-lang/rust/pull/89167">https://github.com/rust-lang/rust/pull/89167</a></p>



<a name="254453935"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/PR%20open%20to%20rust-lang/rust/near/254453935" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Caleb Zulawski <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/PR.20open.20to.20rust-lang.2Frust.html#254453935">(Sep 22 2021 at 23:06)</a>:</h4>
<p>Probably don't need to mention this explicitly in the PR, but we should make a note in our update post that we _do not_ have an RFC yet, and that the RFC comes after we experiment and are ready to propose the change</p>



<a name="254453951"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/PR%20open%20to%20rust-lang/rust/near/254453951" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Caleb Zulawski <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/PR.20open.20to.20rust-lang.2Frust.html#254453951">(Sep 22 2021 at 23:06)</a>:</h4>
<p>Since multiple people have been confused by that</p>



<a name="254453959"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/PR%20open%20to%20rust-lang/rust/near/254453959" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jubilee <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/PR.20open.20to.20rust-lang.2Frust.html#254453959">(Sep 22 2021 at 23:06)</a>:</h4>
<p>Okay.</p>



<a name="254454187"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/PR%20open%20to%20rust-lang/rust/near/254454187" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Caleb Zulawski <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/PR.20open.20to.20rust-lang.2Frust.html#254454187">(Sep 22 2021 at 23:09)</a>:</h4>
<p>Took a quick look at the PR, lgtm</p>



<a name="254457585"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/PR%20open%20to%20rust-lang/rust/near/254457585" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Caleb Zulawski <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/PR.20open.20to.20rust-lang.2Frust.html#254457585">(Sep 22 2021 at 23:46)</a>:</h4>
<p>I just realized no one is actually going to be able to use it due to the x86-64 codegen bug :)</p>



<a name="254457709"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/PR%20open%20to%20rust-lang/rust/near/254457709" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jubilee <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/PR.20open.20to.20rust-lang.2Frust.html#254457709">(Sep 22 2021 at 23:48)</a>:</h4>
<p><span class="user-mention silent" data-user-id="312331">Caleb Zulawski</span> <a href="#narrow/stream/257879-project-portable-simd/topic/PR.20open.20to.20rust-lang.2Frust/near/254457585">said</a>:</p>
<blockquote>
<p>I just realized no one is actually going to be able to use it due to the x86-64 codegen bug :)</p>
</blockquote>
<p>The second LLVM update that fixes that (supposedly) is already in the queue. <a href="https://github.com/rust-lang/rust/pull/89130">https://github.com/rust-lang/rust/pull/89130</a></p>



<a name="254457901"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/PR%20open%20to%20rust-lang/rust/near/254457901" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jubilee <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/PR.20open.20to.20rust-lang.2Frust.html#254457901">(Sep 22 2021 at 23:50)</a>:</h4>
<p>I am Not Mentioning it in the PR because by the time this goes in it <strong>should</strong> work again lmao</p>



<a name="260855743"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/PR%20open%20to%20rust-lang/rust/near/260855743" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jubilee <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/PR.20open.20to.20rust-lang.2Frust.html#260855743">(Nov 09 2021 at 20:26)</a>:</h4>
<p>Okay, hm. Now I have to see if I can follow up on the latest review... <span aria-label="upside down" class="emoji emoji-1f643" role="img" title="upside down">:upside_down:</span></p>



<a name="260855967"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/PR%20open%20to%20rust-lang/rust/near/260855967" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Caleb Zulawski <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/PR.20open.20to.20rust-lang.2Frust.html#260855967">(Nov 09 2021 at 20:28)</a>:</h4>
<p>I didn't comment, but I think the argument for removing the entirety of the module from bootstrap is that we would need to remove way too much interconnected code in std::simd</p>



<a name="260856037"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/PR%20open%20to%20rust-lang/rust/near/260856037" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Caleb Zulawski <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/PR.20open.20to.20rust-lang.2Frust.html#260856037">(Nov 09 2021 at 20:28)</a>:</h4>
<p>It's possible, it would just be a bit of a mess, and yeah we might not even need it anymore</p>



<a name="260860416"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/PR%20open%20to%20rust-lang/rust/near/260860416" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jubilee <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/PR.20open.20to.20rust-lang.2Frust.html#260860416">(Nov 09 2021 at 21:00)</a>:</h4>
<p>It's unfortunately still needed, it seems. I don't pass x.py check otherwise.</p>



<a name="260860495"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/PR%20open%20to%20rust-lang/rust/near/260860495" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jubilee <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/PR.20open.20to.20rust-lang.2Frust.html#260860495">(Nov 09 2021 at 21:01)</a>:</h4>
<p>I think it's actually possible to factor it out though.</p>



<a name="260860651"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/PR%20open%20to%20rust-lang/rust/near/260860651" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Caleb Zulawski <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/PR.20open.20to.20rust-lang.2Frust.html#260860651">(Nov 09 2021 at 21:02)</a>:</h4>
<p>What do you mean?</p>



<a name="260860754"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/PR%20open%20to%20rust-lang/rust/near/260860754" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jubilee <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/PR.20open.20to.20rust-lang.2Frust.html#260860754">(Nov 09 2021 at 21:02)</a>:</h4>
<p>Oh, I think we can attach <code>#[cfg(not(bootstrap))]</code> to an internal module of ours.</p>



<a name="260860793"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/PR%20open%20to%20rust-lang/rust/near/260860793" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jubilee <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/PR.20open.20to.20rust-lang.2Frust.html#260860793">(Nov 09 2021 at 21:03)</a>:</h4>
<p>Yeah, seems to pass just fine.</p>



<a name="260860817"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/PR%20open%20to%20rust-lang/rust/near/260860817" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Caleb Zulawski <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/PR.20open.20to.20rust-lang.2Frust.html#260860817">(Nov 09 2021 at 21:03)</a>:</h4>
<p>Wouldn't we need to remove everything that uses swizzling as well? Or can we do literally just the swizzle module</p>



<a name="260860851"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/PR%20open%20to%20rust-lang/rust/near/260860851" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jubilee <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/PR.20open.20to.20rust-lang.2Frust.html#260860851">(Nov 09 2021 at 21:03)</a>:</h4>
<p>Yeah just the entire swizzle module and the intrinsics.</p>



<a name="260860891"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/PR%20open%20to%20rust-lang/rust/near/260860891" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Caleb Zulawski <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/PR.20open.20to.20rust-lang.2Frust.html#260860891">(Nov 09 2021 at 21:03)</a>:</h4>
<p>The intrinsics within the extern block?</p>



<a name="260860898"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/PR%20open%20to%20rust-lang/rust/near/260860898" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Caleb Zulawski <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/PR.20open.20to.20rust-lang.2Frust.html#260860898">(Nov 09 2021 at 21:03)</a>:</h4>
<p>That's not too bad</p>



<a name="260860901"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/PR%20open%20to%20rust-lang/rust/near/260860901" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jubilee <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/PR.20open.20to.20rust-lang.2Frust.html#260860901">(Nov 09 2021 at 21:04)</a>:</h4>
<p>Yeah.</p>



<a name="260860978"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/PR%20open%20to%20rust-lang/rust/near/260860978" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Caleb Zulawski <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/PR.20open.20to.20rust-lang.2Frust.html#260860978">(Nov 09 2021 at 21:04)</a>:</h4>
<p>Yeah that sounds good to me</p>



<a name="260861845"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/PR%20open%20to%20rust-lang/rust/near/260861845" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jubilee <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/PR.20open.20to.20rust-lang.2Frust.html#260861845">(Nov 09 2021 at 21:11)</a>:</h4>
<p>re: <a href="https://github.com/rust-lang/rust/pull/88868">https://github.com/rust-lang/rust/pull/88868</a><br>
I am confused, why is it okay to disable the test?</p>



<a name="260861988"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/PR%20open%20to%20rust-lang/rust/near/260861988" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Caleb Zulawski <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/PR.20open.20to.20rust-lang.2Frust.html#260861988">(Nov 09 2021 at 21:12)</a>:</h4>
<p>Mostly because we don't actually have any way of confirming if the test works or doesn't on anything big endian</p>



<a name="260862023"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/PR%20open%20to%20rust-lang/rust/near/260862023" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Caleb Zulawski <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/PR.20open.20to.20rust-lang.2Frust.html#260862023">(Nov 09 2021 at 21:12)</a>:</h4>
<p>(in portable-simd we reverse the bits and it worked in our tests)</p>



<a name="260862276"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/PR%20open%20to%20rust-lang/rust/near/260862276" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jubilee <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/PR.20open.20to.20rust-lang.2Frust.html#260862276">(Nov 09 2021 at 21:14)</a>:</h4>
<p>Uhh...</p>



<a name="260862376"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/PR%20open%20to%20rust-lang/rust/near/260862376" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jubilee <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/PR.20open.20to.20rust-lang.2Frust.html#260862376">(Nov 09 2021 at 21:15)</a>:</h4>
<p>For portable-simd I am okay with disabling a test if we can confirm it actually works on a real big endian machine but that seemed like an acceptable choice only because <span class="user-mention" data-user-id="229517">@Jacob Lifshay</span> confirmed it had to be a QEMU bug.</p>



<a name="260862383"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/PR%20open%20to%20rust-lang/rust/near/260862383" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Caleb Zulawski <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/PR.20open.20to.20rust-lang.2Frust.html#260862383">(Nov 09 2021 at 21:15)</a>:</h4>
<p>(there are no big-endian tier 1 targets)</p>



<a name="260862413"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/PR%20open%20to%20rust-lang/rust/near/260862413" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Caleb Zulawski <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/PR.20open.20to.20rust-lang.2Frust.html#260862413">(Nov 09 2021 at 21:15)</a>:</h4>
<p>No, you have it backwards I think</p>



<a name="260862437"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/PR%20open%20to%20rust-lang/rust/near/260862437" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jubilee <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/PR.20open.20to.20rust-lang.2Frust.html#260862437">(Nov 09 2021 at 21:15)</a>:</h4>
<p>I am confused now.</p>



<a name="260862450"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/PR%20open%20to%20rust-lang/rust/near/260862450" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jacob Lifshay <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/PR.20open.20to.20rust-lang.2Frust.html#260862450">(Nov 09 2021 at 21:15)</a>:</h4>
<p>well, powerpc64le is little-endian</p>



<a name="260862521"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/PR%20open%20to%20rust-lang/rust/near/260862521" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jubilee <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/PR.20open.20to.20rust-lang.2Frust.html#260862521">(Nov 09 2021 at 21:16)</a>:</h4>
<p>Oh right.</p>



<a name="260862522"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/PR%20open%20to%20rust-lang/rust/near/260862522" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jacob Lifshay <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/PR.20open.20to.20rust-lang.2Frust.html#260862522">(Nov 09 2021 at 21:16)</a>:</h4>
<p>so failing on that has nothing to do with big-endian</p>



<a name="260862533"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/PR%20open%20to%20rust-lang/rust/near/260862533" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Caleb Zulawski <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/PR.20open.20to.20rust-lang.2Frust.html#260862533">(Nov 09 2021 at 21:16)</a>:</h4>
<p>In that pull request I disabled the rust ui tests</p>



<a name="260862551"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/PR%20open%20to%20rust-lang/rust/near/260862551" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Caleb Zulawski <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/PR.20open.20to.20rust-lang.2Frust.html#260862551">(Nov 09 2021 at 21:16)</a>:</h4>
<p>On big endian</p>



<a name="260862606"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/PR%20open%20to%20rust-lang/rust/near/260862606" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Caleb Zulawski <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/PR.20open.20to.20rust-lang.2Frust.html#260862606">(Nov 09 2021 at 21:17)</a>:</h4>
<p>Because we simply don't even have a big endian tier 1 system anyway so the test could be totally wrong and still pass CI</p>



<a name="260862658"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/PR%20open%20to%20rust-lang/rust/near/260862658" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jubilee <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/PR.20open.20to.20rust-lang.2Frust.html#260862658">(Nov 09 2021 at 21:17)</a>:</h4>
<p>Yeah but the test is meant to be there to let people verify it works before distributing to their distro.</p>



<a name="260862684"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/PR%20open%20to%20rust-lang/rust/near/260862684" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Caleb Zulawski <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/PR.20open.20to.20rust-lang.2Frust.html#260862684">(Nov 09 2021 at 21:17)</a>:</h4>
<p>I'm sure if anyone ever added a big endian system to tier 1, one of the tasks would be sorting out the tests</p>



<a name="260862894"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/PR%20open%20to%20rust-lang/rust/near/260862894" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jacob Lifshay <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/PR.20open.20to.20rust-lang.2Frust.html#260862894">(Nov 09 2021 at 21:19)</a>:</h4>
<p>one idea for big/little-endian bitmasks: just treat the bitmask as an opaque binary blob and rely on bitcasting to a llvm i1 vector and using llvm vector ops to do all operations, rather than trying to read bits directly</p>



<a name="260862974"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/PR%20open%20to%20rust-lang/rust/near/260862974" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jacob Lifshay <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/PR.20open.20to.20rust-lang.2Frust.html#260862974">(Nov 09 2021 at 21:20)</a>:</h4>
<p>that way it doesn't matter how llvm represents it, you always get the right answer</p>



<a name="260863041"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/PR%20open%20to%20rust-lang/rust/near/260863041" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Caleb Zulawski <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/PR.20open.20to.20rust-lang.2Frust.html#260863041">(Nov 09 2021 at 21:20)</a>:</h4>
<p>I think that defeats the purpose a little bit because then it's basically identical to the Mask type</p>



<a name="260863063"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/PR%20open%20to%20rust-lang/rust/near/260863063" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Caleb Zulawski <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/PR.20open.20to.20rust-lang.2Frust.html#260863063">(Nov 09 2021 at 21:20)</a>:</h4>
<p>(that discussion also has nothing to do with this PR, I think)</p>



<a name="260863107"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/PR%20open%20to%20rust-lang/rust/near/260863107" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jacob Lifshay <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/PR.20open.20to.20rust-lang.2Frust.html#260863107">(Nov 09 2021 at 21:20)</a>:</h4>
<p>it has to do with big/little-endian issues...</p>



<a name="260863131"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/PR%20open%20to%20rust-lang/rust/near/260863131" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Caleb Zulawski <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/PR.20open.20to.20rust-lang.2Frust.html#260863131">(Nov 09 2021 at 21:21)</a>:</h4>
<p>Sure but not in the intrinsic</p>



<a name="260863204"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/PR%20open%20to%20rust-lang/rust/near/260863204" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Caleb Zulawski <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/PR.20open.20to.20rust-lang.2Frust.html#260863204">(Nov 09 2021 at 21:21)</a>:</h4>
<p>I was going to suggest multiple bitmasks functions with different orders</p>



<a name="260863234"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/PR%20open%20to%20rust-lang/rust/near/260863234" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Caleb Zulawski <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/PR.20open.20to.20rust-lang.2Frust.html#260863234">(Nov 09 2021 at 21:21)</a>:</h4>
<p>One of which being native order</p>



<a name="260863378"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/PR%20open%20to%20rust-lang/rust/near/260863378" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Caleb Zulawski <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/PR.20open.20to.20rust-lang.2Frust.html#260863378">(Nov 09 2021 at 21:22)</a>:</h4>
<p>Regardless of what we do there, I think we want the intrinsic to do the native order</p>



<a name="260863853"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/PR%20open%20to%20rust-lang/rust/near/260863853" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jacob Lifshay <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/PR.20open.20to.20rust-lang.2Frust.html#260863853">(Nov 09 2021 at 21:26)</a>:</h4>
<p>ummm...wouldn't the intrinsic just bitcast the input bytes to a bit vector, do whatever op we wanted, then bitcast the resulting bit vector back to bytes?</p>



<a name="260864195"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/PR%20open%20to%20rust-lang/rust/near/260864195" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jacob Lifshay <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/PR.20open.20to.20rust-lang.2Frust.html#260864195">(Nov 09 2021 at 21:29)</a>:</h4>
<p>there's also the issue that some arches (such as mc68000 or avr i'd guess) don't really have a native order, llvm is just picking whatever made llvm easier to write.</p>



<a name="260864437"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/PR%20open%20to%20rust-lang/rust/near/260864437" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jubilee <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/PR.20open.20to.20rust-lang.2Frust.html#260864437">(Nov 09 2021 at 21:30)</a>:</h4>
<p>So... okay.<br>
I think in order to proceed with <a href="https://github.com/rust-lang/rust/issues/88868">#88868</a>, we need a very explicit, not-actually-in-a-programming-language definition of what the intrinsic is <em>supposed</em> to do, because I am suddenly feeling deeply unclear about that. We need our own definition that is not beholden to whatever LLVM has written at the moment.</p>



<a name="260864507"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/PR%20open%20to%20rust-lang/rust/near/260864507" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Caleb Zulawski <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/PR.20open.20to.20rust-lang.2Frust.html#260864507">(Nov 09 2021 at 21:31)</a>:</h4>
<p>By definition it's going to return an LLVM-specific order</p>



<a name="260864604"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/PR%20open%20to%20rust-lang/rust/near/260864604" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jubilee <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/PR.20open.20to.20rust-lang.2Frust.html#260864604">(Nov 09 2021 at 21:32)</a>:</h4>
<p><em>waves dismissively</em> We would prefer GCC and Cranelift to be semantically compatible.</p>



<a name="260864614"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/PR%20open%20to%20rust-lang/rust/near/260864614" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Caleb Zulawski <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/PR.20open.20to.20rust-lang.2Frust.html#260864614">(Nov 09 2021 at 21:32)</a>:</h4>
<p>We could define that it needs to return a specific order, but then it's a useless intrinsic if you're forcing the bits to always be flipped</p>



<a name="260864632"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/PR%20open%20to%20rust-lang/rust/near/260864632" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Caleb Zulawski <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/PR.20open.20to.20rust-lang.2Frust.html#260864632">(Nov 09 2021 at 21:32)</a>:</h4>
<p>(on some architectures)</p>



<a name="260864674"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/PR%20open%20to%20rust-lang/rust/near/260864674" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jubilee <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/PR.20open.20to.20rust-lang.2Frust.html#260864674">(Nov 09 2021 at 21:32)</a>:</h4>
<p>It's fine if the value is arch-dependent or CG-dependent, actually.</p>



<a name="260864692"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/PR%20open%20to%20rust-lang/rust/near/260864692" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jubilee <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/PR.20open.20to.20rust-lang.2Frust.html#260864692">(Nov 09 2021 at 21:32)</a>:</h4>
<p>We just need to be able to grasp what we do next.</p>



<a name="260864747"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/PR%20open%20to%20rust-lang/rust/near/260864747" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jacob Lifshay <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/PR.20open.20to.20rust-lang.2Frust.html#260864747">(Nov 09 2021 at 21:33)</a>:</h4>
<p>CG-dependent is a problem, since you want to be able to link gcc with llvm code</p>



<a name="260864775"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/PR%20open%20to%20rust-lang/rust/near/260864775" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jubilee <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/PR.20open.20to.20rust-lang.2Frust.html#260864775">(Nov 09 2021 at 21:33)</a>:</h4>
<p>That is super optimistic lol</p>



<a name="260864812"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/PR%20open%20to%20rust-lang/rust/near/260864812" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Caleb Zulawski <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/PR.20open.20to.20rust-lang.2Frust.html#260864812">(Nov 09 2021 at 21:33)</a>:</h4>
<p>Well, what do we want bitmasks for?</p>



<a name="260864814"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/PR%20open%20to%20rust-lang/rust/near/260864814" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jacob Lifshay <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/PR.20open.20to.20rust-lang.2Frust.html#260864814">(Nov 09 2021 at 21:33)</a>:</h4>
<p>well, we should at least try...</p>



<a name="260864967"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/PR%20open%20to%20rust-lang/rust/near/260864967" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Caleb Zulawski <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/PR.20open.20to.20rust-lang.2Frust.html#260864967">(Nov 09 2021 at 21:34)</a>:</h4>
<p>One use is to check if all lanes are unset (though we have an intrinsic for that)</p>



<a name="260864999"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/PR%20open%20to%20rust-lang/rust/near/260864999" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jacob Lifshay <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/PR.20open.20to.20rust-lang.2Frust.html#260864999">(Nov 09 2021 at 21:34)</a>:</h4>
<p>we want bitmasks as a more-efficient for some archs representation of masks</p>



<a name="260865070"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/PR%20open%20to%20rust-lang/rust/near/260865070" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jacob Lifshay <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/PR.20open.20to.20rust-lang.2Frust.html#260865070">(Nov 09 2021 at 21:35)</a>:</h4>
<p>also conversion to stdarch types</p>



<a name="260865121"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/PR%20open%20to%20rust-lang/rust/near/260865121" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jubilee <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/PR.20open.20to.20rust-lang.2Frust.html#260865121">(Nov 09 2021 at 21:35)</a>:</h4>
<p>Basically, I moreso want a definition I could go implement in Miri or another simulator than one that like forces all CGs to play nice.</p>



<a name="260865212"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/PR%20open%20to%20rust-lang/rust/near/260865212" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jacob Lifshay <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/PR.20open.20to.20rust-lang.2Frust.html#260865212">(Nov 09 2021 at 21:36)</a>:</h4>
<p>one other thing we want bitmasks for, but are not the primary usecase, are conversion of masks to/from integers in some defined bit-order</p>



<a name="260865218"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/PR%20open%20to%20rust-lang/rust/near/260865218" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jubilee <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/PR.20open.20to.20rust-lang.2Frust.html#260865218">(Nov 09 2021 at 21:36)</a>:</h4>
<p>If it could be CG (or more likely, arch-dependent) then a symbex could flip which repr it uses each time through.</p>



<a name="260865273"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/PR%20open%20to%20rust-lang/rust/near/260865273" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Caleb Zulawski <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/PR.20open.20to.20rust-lang.2Frust.html#260865273">(Nov 09 2021 at 21:36)</a>:</h4>
<p>So my point is when we publicly expose bitmasks, we may need to say the order is arbitrary</p>



<a name="260865284"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/PR%20open%20to%20rust-lang/rust/near/260865284" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Caleb Zulawski <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/PR.20open.20to.20rust-lang.2Frust.html#260865284">(Nov 09 2021 at 21:36)</a>:</h4>
<p>Internally we already handle that</p>



<a name="260865294"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/PR%20open%20to%20rust-lang/rust/near/260865294" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jubilee <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/PR.20open.20to.20rust-lang.2Frust.html#260865294">(Nov 09 2021 at 21:37)</a>:</h4>
<p>Right.</p>



<a name="260865352"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/PR%20open%20to%20rust-lang/rust/near/260865352" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jubilee <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/PR.20open.20to.20rust-lang.2Frust.html#260865352">(Nov 09 2021 at 21:37)</a>:</h4>
<p>I mostly want something that helps us reason about it.</p>



<a name="260865497"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/PR%20open%20to%20rust-lang/rust/near/260865497" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Caleb Zulawski <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/PR.20open.20to.20rust-lang.2Frust.html#260865497">(Nov 09 2021 at 21:38)</a>:</h4>
<p>Fixing this intrinsic in the PR really helps us remove unnecessary bounds on our mask type, it doesn't change anything about the bit order we expose</p>



<a name="260865543"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/PR%20open%20to%20rust-lang/rust/near/260865543" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Caleb Zulawski <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/PR.20open.20to.20rust-lang.2Frust.html#260865543">(Nov 09 2021 at 21:38)</a>:</h4>
<p>We don't even need to expose bitmasks publicly, we just do because sometimes people need them</p>



<a name="260865584"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/PR%20open%20to%20rust-lang/rust/near/260865584" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jacob Lifshay <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/PR.20open.20to.20rust-lang.2Frust.html#260865584">(Nov 09 2021 at 21:39)</a>:</h4>
<p>i'd say bitmasks should just be stored in whatever arbitrary way llvm decides bitvectors should be -- bitcast to an array of bytes</p>



<a name="260865650"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/PR%20open%20to%20rust-lang/rust/near/260865650" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jubilee <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/PR.20open.20to.20rust-lang.2Frust.html#260865650">(Nov 09 2021 at 21:40)</a>:</h4>
<p>I am fine with that but I actually don't wanna see "bitcast" in the definition!</p>



<a name="260865846"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/PR%20open%20to%20rust-lang/rust/near/260865846" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jacob Lifshay <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/PR.20open.20to.20rust-lang.2Frust.html#260865846">(Nov 09 2021 at 21:41)</a>:</h4>
<p>other CGs should just pick something consistent with llvm -- if llvm doesn't pick (e.g. doesn't support that arch) then the CG has to hash it out among all other CGs</p>



<a name="260865869"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/PR%20open%20to%20rust-lang/rust/near/260865869" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jubilee <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/PR.20open.20to.20rust-lang.2Frust.html#260865869">(Nov 09 2021 at 21:41)</a>:</h4>
<p>See the reason I am suddenly antsy about this is I want to be able to detect if LLVM has miscompiled something.</p>



<a name="260865898"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/PR%20open%20to%20rust-lang/rust/near/260865898" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Caleb Zulawski <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/PR.20open.20to.20rust-lang.2Frust.html#260865898">(Nov 09 2021 at 21:41)</a>:</h4>
<p>You'll know when you use that bitmask to do something</p>



<a name="260865948"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/PR%20open%20to%20rust-lang/rust/near/260865948" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jacob Lifshay <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/PR.20open.20to.20rust-lang.2Frust.html#260865948">(Nov 09 2021 at 21:42)</a>:</h4>
<p>yup!</p>



<a name="260865955"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/PR%20open%20to%20rust-lang/rust/near/260865955" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Caleb Zulawski <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/PR.20open.20to.20rust-lang.2Frust.html#260865955">(Nov 09 2021 at 21:42)</a>:</h4>
<p>Trivially you can convert it back to a full mask</p>



<a name="260865962"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/PR%20open%20to%20rust-lang/rust/near/260865962" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jubilee <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/PR.20open.20to.20rust-lang.2Frust.html#260865962">(Nov 09 2021 at 21:42)</a>:</h4>
<p>I don't trust that.</p>



<a name="260866066"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/PR%20open%20to%20rust-lang/rust/near/260866066" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Caleb Zulawski <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/PR.20open.20to.20rust-lang.2Frust.html#260866066">(Nov 09 2021 at 21:43)</a>:</h4>
<p>Well, we already have an entire mask architecture predicated on having bitmasks, this PR just allows us to remove trait bounds on the masks</p>



<a name="260866105"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/PR%20open%20to%20rust-lang/rust/near/260866105" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Caleb Zulawski <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/PR.20open.20to.20rust-lang.2Frust.html#260866105">(Nov 09 2021 at 21:43)</a>:</h4>
<p>I don't think this conversation is relevant to approving this PR anyway</p>



<a name="260866162"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/PR%20open%20to%20rust-lang/rust/near/260866162" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jacob Lifshay <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/PR.20open.20to.20rust-lang.2Frust.html#260866162">(Nov 09 2021 at 21:43)</a>:</h4>
<p>well, it should probably be moved to "bitmask endianness"</p>



<a name="260866221"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/PR%20open%20to%20rust-lang/rust/near/260866221" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Caleb Zulawski <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/PR.20open.20to.20rust-lang.2Frust.html#260866221">(Nov 09 2021 at 21:44)</a>:</h4>
<p>I also don't think it's practical to require the masks to have some particular bit order because then the bitmasks become useless, dumping conversion code around every operation</p>



<a name="260866244"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/PR%20open%20to%20rust-lang/rust/near/260866244" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jubilee <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/PR.20open.20to.20rust-lang.2Frust.html#260866244">(Nov 09 2021 at 21:44)</a>:</h4>
<p>It's not about requiring the masks to have some particular bit order.</p>



<a name="260866278"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/PR%20open%20to%20rust-lang/rust/near/260866278" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jubilee <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/PR.20open.20to.20rust-lang.2Frust.html#260866278">(Nov 09 2021 at 21:44)</a>:</h4>
<p>I just want to actually understand and know the change is correct.</p>



<a name="260866339"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/PR%20open%20to%20rust-lang/rust/near/260866339" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Caleb Zulawski <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/PR.20open.20to.20rust-lang.2Frust.html#260866339">(Nov 09 2021 at 21:45)</a>:</h4>
<p>I don't see how LLVM's bit order is relevant to the change, then, because this change doesn't touch bit order</p>



<a name="260866361"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/PR%20open%20to%20rust-lang/rust/near/260866361" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jacob Lifshay <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/PR.20open.20to.20rust-lang.2Frust.html#260866361">(Nov 09 2021 at 21:45)</a>:</h4>
<p>imho the only way llvm could detectably miscompile bitmasks is if it's inconsistent with itself, since llvm is the definition of how our bitmasks are represented</p>



<a name="260866372"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/PR%20open%20to%20rust-lang/rust/near/260866372" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jubilee <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/PR.20open.20to.20rust-lang.2Frust.html#260866372">(Nov 09 2021 at 21:45)</a>:</h4>
<p>YES.</p>



<a name="260866399"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/PR%20open%20to%20rust-lang/rust/near/260866399" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jubilee <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/PR.20open.20to.20rust-lang.2Frust.html#260866399">(Nov 09 2021 at 21:45)</a>:</h4>
<p>I AM ASSUMING LLVM CAN BE INCONSISTENT WITH ITSELF</p>



<a name="260866479"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/PR%20open%20to%20rust-lang/rust/near/260866479" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jubilee <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/PR.20open.20to.20rust-lang.2Frust.html#260866479">(Nov 09 2021 at 21:46)</a>:</h4>
<p>aaaa</p>



<a name="260866495"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/PR%20open%20to%20rust-lang/rust/near/260866495" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jacob Lifshay <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/PR.20open.20to.20rust-lang.2Frust.html#260866495">(Nov 09 2021 at 21:46)</a>:</h4>
<p>well, when we see inconsistency, we report an llvm bug, just like any other inconsistency</p>



<a name="260866540"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/PR%20open%20to%20rust-lang/rust/near/260866540" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jubilee <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/PR.20open.20to.20rust-lang.2Frust.html#260866540">(Nov 09 2021 at 21:47)</a>:</h4>
<p>how do we know what's inconsistent and what is just us being wrong</p>



<a name="260866600"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/PR%20open%20to%20rust-lang/rust/near/260866600" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Caleb Zulawski <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/PR.20open.20to.20rust-lang.2Frust.html#260866600">(Nov 09 2021 at 21:47)</a>:</h4>
<p>Well, like I said, you can trivially convert any bitmask back to a full mask, which has a defined layout</p>



<a name="260866627"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/PR%20open%20to%20rust-lang/rust/near/260866627" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jacob Lifshay <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/PR.20open.20to.20rust-lang.2Frust.html#260866627">(Nov 09 2021 at 21:47)</a>:</h4>
<p>look at bitvectors from avx512 code on x86 c++?</p>



<a name="260866716"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/PR%20open%20to%20rust-lang/rust/near/260866716" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jubilee <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/PR.20open.20to.20rust-lang.2Frust.html#260866716">(Nov 09 2021 at 21:48)</a>:</h4>
<p>how do we know if the conversion is correct</p>



<a name="260866780"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/PR%20open%20to%20rust-lang/rust/near/260866780" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jacob Lifshay <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/PR.20open.20to.20rust-lang.2Frust.html#260866780">(Nov 09 2021 at 21:49)</a>:</h4>
<p>it's correct if it gives us the correct answer...defined by what operations produced the bitmask, not by the bytes in the bitmask</p>



<a name="260866798"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/PR%20open%20to%20rust-lang/rust/near/260866798" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Caleb Zulawski <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/PR.20open.20to.20rust-lang.2Frust.html#260866798">(Nov 09 2021 at 21:49)</a>:</h4>
<p>I don't really see how this is different than saying we can't use alloca load and store because if any of those are wrong but externally consistent we'd never know</p>



<a name="260866803"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/PR%20open%20to%20rust-lang/rust/near/260866803" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jubilee <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/PR.20open.20to.20rust-lang.2Frust.html#260866803">(Nov 09 2021 at 21:49)</a>:</h4>
<p>if it's so trivial why can't anyone write it down</p>



<a name="260866832"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/PR%20open%20to%20rust-lang/rust/near/260866832" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jacob Lifshay <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/PR.20open.20to.20rust-lang.2Frust.html#260866832">(Nov 09 2021 at 21:49)</a>:</h4>
<p>the bytes are opaque, llvm gets to put whatever it feels like there</p>



<a name="260866966"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/PR%20open%20to%20rust-lang/rust/near/260866966" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jacob Lifshay <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/PR.20open.20to.20rust-lang.2Frust.html#260866966">(Nov 09 2021 at 21:50)</a>:</h4>
<p>we can't write it down cuz we didn't dig through llvm's code to find out how it represents bitvectors</p>



<a name="260866999"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/PR%20open%20to%20rust-lang/rust/near/260866999" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jacob Lifshay <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/PR.20open.20to.20rust-lang.2Frust.html#260866999">(Nov 09 2021 at 21:51)</a>:</h4>
<p>gtg, ttyl</p>



<a name="260867024"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/PR%20open%20to%20rust-lang/rust/near/260867024" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Caleb Zulawski <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/PR.20open.20to.20rust-lang.2Frust.html#260867024">(Nov 09 2021 at 21:51)</a>:</h4>
<p>On every arch I tested the bit order corresponds to the endianness</p>



<a name="260867032"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/PR%20open%20to%20rust-lang/rust/near/260867032" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jubilee <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/PR.20open.20to.20rust-lang.2Frust.html#260867032">(Nov 09 2021 at 21:51)</a>:</h4>
<p>We need a definition of the platform intrinsic that isn't just linkage to an LLVM intrinsic.</p>



<a name="260867065"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/PR%20open%20to%20rust-lang/rust/near/260867065" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jubilee <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/PR.20open.20to.20rust-lang.2Frust.html#260867065">(Nov 09 2021 at 21:51)</a>:</h4>
<p>It's not actually about the bit order.</p>



<a name="260867078"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/PR%20open%20to%20rust-lang/rust/near/260867078" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jubilee <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/PR.20open.20to.20rust-lang.2Frust.html#260867078">(Nov 09 2021 at 21:52)</a>:</h4>
<p>It's about understanding what the possibilities are.</p>



<a name="260867101"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/PR%20open%20to%20rust-lang/rust/near/260867101" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jubilee <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/PR.20open.20to.20rust-lang.2Frust.html#260867101">(Nov 09 2021 at 21:52)</a>:</h4>
<p>And writing them down, so I stop wondering what is a correct change and what's not.</p>



<a name="260867124"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/PR%20open%20to%20rust-lang/rust/near/260867124" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Caleb Zulawski <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/PR.20open.20to.20rust-lang.2Frust.html#260867124">(Nov 09 2021 at 21:52)</a>:</h4>
<p>It does the conversion such that it's consistent with bitmask_select, that's it</p>



<a name="260867233"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/PR%20open%20to%20rust-lang/rust/near/260867233" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Caleb Zulawski <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/PR.20open.20to.20rust-lang.2Frust.html#260867233">(Nov 09 2021 at 21:53)</a>:</h4>
<p>Beyond that it can do whatever it wants for any particular target</p>



<a name="260867242"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/PR%20open%20to%20rust-lang/rust/near/260867242" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Caleb Zulawski <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/PR.20open.20to.20rust-lang.2Frust.html#260867242">(Nov 09 2021 at 21:53)</a>:</h4>
<p>And any particular codegen</p>



<a name="260867245"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/PR%20open%20to%20rust-lang/rust/near/260867245" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jubilee <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/PR.20open.20to.20rust-lang.2Frust.html#260867245">(Nov 09 2021 at 21:53)</a>:</h4>
<p>Okay, fine?<br>
That's... what I needed.</p>



<a name="260867381"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/PR%20open%20to%20rust-lang/rust/near/260867381" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Caleb Zulawski <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/PR.20open.20to.20rust-lang.2Frust.html#260867381">(Nov 09 2021 at 21:54)</a>:</h4>
<p>Fwiw those requirements didn't change at all with this PR, in the current compiler the intrinsic is still opaque to rustc</p>



<a name="260867508"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/PR%20open%20to%20rust-lang/rust/near/260867508" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jubilee <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/PR.20open.20to.20rust-lang.2Frust.html#260867508">(Nov 09 2021 at 21:55)</a>:</h4>
<p>I know the requirements we are expecting were not supposed to change.</p>



<a name="260867739"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/PR%20open%20to%20rust-lang/rust/near/260867739" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jubilee <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/PR.20open.20to.20rust-lang.2Frust.html#260867739">(Nov 09 2021 at 21:57)</a>:</h4>
<p>I feel like I am being deliberately misunderstood here because I asked a simple question.</p>



<a name="260867949"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/PR%20open%20to%20rust-lang/rust/near/260867949" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Caleb Zulawski <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/PR.20open.20to.20rust-lang.2Frust.html#260867949">(Nov 09 2021 at 21:59)</a>:</h4>
<p>Sorry, you originally suggested that you don't want it to be dependent on LLVM</p>



<a name="260867991"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/PR%20open%20to%20rust-lang/rust/near/260867991" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Caleb Zulawski <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/PR.20open.20to.20rust-lang.2Frust.html#260867991">(Nov 09 2021 at 21:59)</a>:</h4>
<p>I think we're just saying by definition it has to be</p>



<a name="260868197"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/PR%20open%20to%20rust-lang/rust/near/260868197" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jubilee <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/PR.20open.20to.20rust-lang.2Frust.html#260868197">(Nov 09 2021 at 22:00)</a>:</h4>
<p>The value is defined by <code>simd_bitmask</code>, and we pass that value to other functions, and we need to know what functions can legally accept that value.</p>



<a name="260868291"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/PR%20open%20to%20rust-lang/rust/near/260868291" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jubilee <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/PR.20open.20to.20rust-lang.2Frust.html#260868291">(Nov 09 2021 at 22:01)</a>:</h4>
<p>If the answer is "<code>simd_select_bitmask</code> and nothing else" then we now know what our constraints are.</p>



<a name="260868302"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/PR%20open%20to%20rust-lang/rust/near/260868302" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Caleb Zulawski <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/PR.20open.20to.20rust-lang.2Frust.html#260868302">(Nov 09 2021 at 22:01)</a>:</h4>
<p>Yeah. So right now it's just bitmask select.  We are making assumptions about it in the portable-simd API based on what the function actually does, but maybe that's not legal</p>



<a name="260868313"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/PR%20open%20to%20rust-lang/rust/near/260868313" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jubilee <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/PR.20open.20to.20rust-lang.2Frust.html#260868313">(Nov 09 2021 at 22:01)</a>:</h4>
<p>We know what to test for consistency, and what not.</p>



<a name="260868375"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/PR%20open%20to%20rust-lang/rust/near/260868375" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Caleb Zulawski <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/PR.20open.20to.20rust-lang.2Frust.html#260868375">(Nov 09 2021 at 22:02)</a>:</h4>
<p>(but that's a documentation issue more than anything else)</p>



<a name="260868440"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/PR%20open%20to%20rust-lang/rust/near/260868440" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jubilee <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/PR.20open.20to.20rust-lang.2Frust.html#260868440">(Nov 09 2021 at 22:02)</a>:</h4>
<p>Perhaps it is just a documentation issue, but I can actually sign off on <a href="https://github.com/rust-lang/rust/issues/88868">#88868</a> if I understand what the future issues will be.</p>



<a name="260868553"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/PR%20open%20to%20rust-lang/rust/near/260868553" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Caleb Zulawski <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/PR.20open.20to.20rust-lang.2Frust.html#260868553">(Nov 09 2021 at 22:03)</a>:</h4>
<p>We can theoretically provide a function (or maybe even a const or something??) that actually gives you the bit index for a particular lane, but that won't be consistent between cg, architecture, etc</p>



<a name="260868666"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/PR%20open%20to%20rust-lang/rust/near/260868666" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Caleb Zulawski <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/PR.20open.20to.20rust-lang.2Frust.html#260868666">(Nov 09 2021 at 22:04)</a>:</h4>
<p>It doesn't have to be entirely opaque, but it's going to be somewhat arbitrary</p>



<a name="260868830"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/PR%20open%20to%20rust-lang/rust/near/260868830" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jubilee <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/PR.20open.20to.20rust-lang.2Frust.html#260868830">(Nov 09 2021 at 22:05)</a>:</h4>
<p>A definition that says that the bit order could be, in a hypothetical 8-lane <code>BitMask</code>, = <code>[0, 7, 1, 6, 2, 5, 3, 4]</code> OR <code>[0, 1, 2, 3, 4, 5, 6, 7]</code> but either way <code>simd_select_bitmask</code> will correctly "index off" it, and if we expand it into e.g. <code>u16s</code> on e.g. an LE system, it will have a given order of bytes, is fine.</p>



<a name="260868930"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/PR%20open%20to%20rust-lang/rust/near/260868930" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Caleb Zulawski <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/PR.20open.20to.20rust-lang.2Frust.html#260868930">(Nov 09 2021 at 22:06)</a>:</h4>
<p>Yep</p>



<a name="260868931"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/PR%20open%20to%20rust-lang/rust/near/260868931" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jubilee <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/PR.20open.20to.20rust-lang.2Frust.html#260868931">(Nov 09 2021 at 22:06)</a>:</h4>
<p>It's that equational reasoning that I have suddenly become interested in.</p>



<a name="260868968"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/PR%20open%20to%20rust-lang/rust/near/260868968" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jubilee <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/PR.20open.20to.20rust-lang.2Frust.html#260868968">(Nov 09 2021 at 22:06)</a>:</h4>
<p>... speaking of, what IS the order we want the <code>u16x8</code> to be in?</p>



<a name="260869012"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/PR%20open%20to%20rust-lang/rust/near/260869012" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Caleb Zulawski <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/PR.20open.20to.20rust-lang.2Frust.html#260869012">(Nov 09 2021 at 22:07)</a>:</h4>
<p>Same as an array</p>



<a name="260869022"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/PR%20open%20to%20rust-lang/rust/near/260869022" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jubilee <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/PR.20open.20to.20rust-lang.2Frust.html#260869022">(Nov 09 2021 at 22:07)</a>:</h4>
<p>It has to be [0, 1, 2, 3, 4, 5, 6, 7] in Rustworld, right? Because it's an array.<br>
Yeah.</p>



<a name="260869033"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/PR%20open%20to%20rust-lang/rust/near/260869033" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Caleb Zulawski <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/PR.20open.20to.20rust-lang.2Frust.html#260869033">(Nov 09 2021 at 22:07)</a>:</h4>
<p>It doesn't change with endianness or anything</p>



<a name="260869038"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/PR%20open%20to%20rust-lang/rust/near/260869038" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Caleb Zulawski <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/PR.20open.20to.20rust-lang.2Frust.html#260869038">(Nov 09 2021 at 22:07)</a>:</h4>
<p>Yep</p>



<a name="260869153"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/PR%20open%20to%20rust-lang/rust/near/260869153" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jubilee <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/PR.20open.20to.20rust-lang.2Frust.html#260869153">(Nov 09 2021 at 22:08)</a>:</h4>
<p>And what is our conversion function for that, again?</p>



<a name="260869299"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/PR%20open%20to%20rust-lang/rust/near/260869299" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jubilee <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/PR.20open.20to.20rust-lang.2Frust.html#260869299">(Nov 09 2021 at 22:09)</a>:</h4>
<p>Ah, also <code>simd_select_bitmask</code></p>



<a name="260869871"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/PR%20open%20to%20rust-lang/rust/near/260869871" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jubilee <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/PR.20open.20to.20rust-lang.2Frust.html#260869871">(Nov 09 2021 at 22:13)</a>:</h4>
<p>And the invariants are that <code>simd_bitmask</code> has to be used on integers with the value <code>0</code>, <code>uN::MAX</code>, or <code>iN::-1</code>, or it stops making sense.</p>



<a name="260869970"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/PR%20open%20to%20rust-lang/rust/near/260869970" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Caleb Zulawski <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/PR.20open.20to.20rust-lang.2Frust.html#260869970">(Nov 09 2021 at 22:14)</a>:</h4>
<p>Yeah, basically</p>



<a name="260870135"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/PR%20open%20to%20rust-lang/rust/near/260870135" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jubilee <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/PR.20open.20to.20rust-lang.2Frust.html#260870135">(Nov 09 2021 at 22:15)</a>:</h4>
<p>hypothetically, we could have it used on <code>0b1000_0000_0000_0000</code> or <code>0b0000_0000_0000_0001</code> or e.g. the inversion of either of those and it would not be known with absolute certainty which boolean value it would produce on a given platform.</p>



<a name="260870276"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/PR%20open%20to%20rust-lang/rust/near/260870276" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Caleb Zulawski <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/PR.20open.20to.20rust-lang.2Frust.html#260870276">(Nov 09 2021 at 22:16)</a>:</h4>
<p>Yeah, so the previous tests assumed the order is based on endianness</p>



<a name="260870361"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/PR%20open%20to%20rust-lang/rust/near/260870361" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Caleb Zulawski <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/PR.20open.20to.20rust-lang.2Frust.html#260870361">(Nov 09 2021 at 22:17)</a>:</h4>
<p>We could add that extra bit if we really wanted to</p>



<a name="260870459"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/PR%20open%20to%20rust-lang/rust/near/260870459" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jubilee <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/PR.20open.20to.20rust-lang.2Frust.html#260870459">(Nov 09 2021 at 22:18)</a>:</h4>
<p>Do we have any tests that mandate the equational reasoning I have defined so far?</p>



<a name="260870539"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/PR%20open%20to%20rust-lang/rust/near/260870539" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Caleb Zulawski <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/PR.20open.20to.20rust-lang.2Frust.html#260870539">(Nov 09 2021 at 22:18)</a>:</h4>
<p>I'm not sure what you specifically mean by equational reasoning</p>



<a name="260871187"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/PR%20open%20to%20rust-lang/rust/near/260871187" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jubilee <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/PR.20open.20to.20rust-lang.2Frust.html#260871187">(Nov 09 2021 at 22:24)</a>:</h4>
<p>for all SIMD vectors of integers <code>vi</code><br>
where all the integers are the "SIMD Boolean" values (all bits set or unset)<br>
we want the use of <code>simd_select</code> on <code>vi</code><br>
and <code>simd_select_bitmask</code> on <code>simd_bitmask(vi)</code> to produce the same results.</p>



<a name="260871244"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/PR%20open%20to%20rust-lang/rust/near/260871244" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Caleb Zulawski <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/PR.20open.20to.20rust-lang.2Frust.html#260871244">(Nov 09 2021 at 22:25)</a>:</h4>
<p>Right now it tests one better, a specific bit order</p>



<a name="260871279"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/PR%20open%20to%20rust-lang/rust/near/260871279" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jubilee <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/PR.20open.20to.20rust-lang.2Frust.html#260871279">(Nov 09 2021 at 22:25)</a>:</h4>
<p>Right, but only on LE, yes?</p>



<a name="260871303"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/PR%20open%20to%20rust-lang/rust/near/260871303" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Caleb Zulawski <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/PR.20open.20to.20rust-lang.2Frust.html#260871303">(Nov 09 2021 at 22:25)</a>:</h4>
<p>Only LE platforms are tested</p>



<a name="260871327"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/PR%20open%20to%20rust-lang/rust/near/260871327" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Caleb Zulawski <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/PR.20open.20to.20rust-lang.2Frust.html#260871327">(Nov 09 2021 at 22:26)</a>:</h4>
<p>There are no BE tier 1 platforms</p>



<a name="260871399"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/PR%20open%20to%20rust-lang/rust/near/260871399" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jubilee <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/PR.20open.20to.20rust-lang.2Frust.html#260871399">(Nov 09 2021 at 22:26)</a>:</h4>
<p>Yes, in CI, but people run tier 2 tests on their own platforms and on their own recognizance.</p>



<a name="260871445"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/PR%20open%20to%20rust-lang/rust/near/260871445" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Caleb Zulawski <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/PR.20open.20to.20rust-lang.2Frust.html#260871445">(Nov 09 2021 at 22:27)</a>:</h4>
<p>Yes. I thought you indicated in the PR that other bitmask tests were already disabled on BE</p>



<a name="260871567"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/PR%20open%20to%20rust-lang/rust/near/260871567" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jubilee <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/PR.20open.20to.20rust-lang.2Frust.html#260871567">(Nov 09 2021 at 22:28)</a>:</h4>
<p>Yes, and I think that is a bad thing. <span aria-label="upside down" class="emoji emoji-1f643" role="img" title="upside down">:upside_down:</span> I would like a test that establishes the part we would like to rely on actually is platform-invariant.</p>



<a name="260871610"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/PR%20open%20to%20rust-lang/rust/near/260871610" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Caleb Zulawski <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/PR.20open.20to.20rust-lang.2Frust.html#260871610">(Nov 09 2021 at 22:28)</a>:</h4>
<p>I guess we could, though that isn't what the PR is about</p>



<a name="260871694"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/PR%20open%20to%20rust-lang/rust/near/260871694" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Caleb Zulawski <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/PR.20open.20to.20rust-lang.2Frust.html#260871694">(Nov 09 2021 at 22:29)</a>:</h4>
<p>We could just do it, but I don't really like writing tests I don't run</p>



<a name="260871921"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/PR%20open%20to%20rust-lang/rust/near/260871921" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jubilee <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/PR.20open.20to.20rust-lang.2Frust.html#260871921">(Nov 09 2021 at 22:31)</a>:</h4>
<p>Hmmm.</p>



<a name="260872584"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/PR%20open%20to%20rust-lang/rust/near/260872584" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jubilee <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/PR.20open.20to.20rust-lang.2Frust.html#260872584">(Nov 09 2021 at 22:37)</a>:</h4>
<p>That is a reasonable objection and I am going to think a bit about that.</p>



<a name="260874143"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/PR%20open%20to%20rust-lang/rust/near/260874143" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jubilee <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/PR.20open.20to.20rust-lang.2Frust.html#260874143">(Nov 09 2021 at 22:52)</a>:</h4>
<p>Part of the reason I suddenly looked at this is because I think we may have to also <code>cfg(not(bootstrap))</code> on <code>simd_bitmask</code>.</p>



<a name="260874190"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/PR%20open%20to%20rust-lang/rust/near/260874190" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jubilee <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/PR.20open.20to.20rust-lang.2Frust.html#260874190">(Nov 09 2021 at 22:52)</a>:</h4>
<p>And THAT is more of a pain.</p>



<a name="260874251"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/PR%20open%20to%20rust-lang/rust/near/260874251" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jubilee <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/PR.20open.20to.20rust-lang.2Frust.html#260874251">(Nov 09 2021 at 22:53)</a>:</h4>
<p>I guess it's fine if the symbol stays the same but we change the definition...?</p>



<a name="260874699"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/PR%20open%20to%20rust-lang/rust/near/260874699" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jubilee <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/PR.20open.20to.20rust-lang.2Frust.html#260874699">(Nov 09 2021 at 22:57)</a>:</h4>
<p>...it has to be, otherwise every single compilation adjustment would require <code>cfg(not(bootstrap))</code> lol.</p>



<a name="260876973"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/PR%20open%20to%20rust-lang/rust/near/260876973" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jubilee <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/PR.20open.20to.20rust-lang.2Frust.html#260876973">(Nov 09 2021 at 23:16)</a>:</h4>
<p>...does the stdarch test suite pass?</p>



<a name="260877018"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/PR%20open%20to%20rust-lang/rust/near/260877018" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Caleb Zulawski <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/PR.20open.20to.20rust-lang.2Frust.html#260877018">(Nov 09 2021 at 23:16)</a>:</h4>
<p>Why wouldn't it?</p>



<a name="260877042"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/PR%20open%20to%20rust-lang/rust/near/260877042" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jubilee <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/PR.20open.20to.20rust-lang.2Frust.html#260877042">(Nov 09 2021 at 23:17)</a>:</h4>
<p>I don't believe rust-lang/rust runs it in CI.</p>



<a name="260877170"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/PR%20open%20to%20rust-lang/rust/near/260877170" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Caleb Zulawski <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/PR.20open.20to.20rust-lang.2Frust.html#260877170">(Nov 09 2021 at 23:18)</a>:</h4>
<p>No clue, I've never run them</p>



<a name="260878114"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/PR%20open%20to%20rust-lang/rust/near/260878114" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jubilee <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/PR.20open.20to.20rust-lang.2Frust.html#260878114">(Nov 09 2021 at 23:31)</a>:</h4>
<p>Okay, I spoke with Eddy and yes we will be fine if we apply <code>cfg(not(bootstrap))</code> to only <code>simd_shuffle</code> but that's going to block your byte array change re: <a href="https://github.com/rust-lang/portable-simd/issues/159">portable-simd#159</a></p>



<a name="260878239"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/PR%20open%20to%20rust-lang/rust/near/260878239" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Caleb Zulawski <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/PR.20open.20to.20rust-lang.2Frust.html#260878239">(Nov 09 2021 at 23:32)</a>:</h4>
<p>Probably fine for now</p>



<a name="260878385"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/PR%20open%20to%20rust-lang/rust/near/260878385" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jubilee <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/PR.20open.20to.20rust-lang.2Frust.html#260878385">(Nov 09 2021 at 23:34)</a>:</h4>
<p>( I am also game to start smearing half the code with <code>cfg(not(bootstrap))</code> but, well, it's only a temporary thing either way. )</p>



<a name="260878434"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/PR%20open%20to%20rust-lang/rust/near/260878434" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Caleb Zulawski <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/PR.20open.20to.20rust-lang.2Frust.html#260878434">(Nov 09 2021 at 23:35)</a>:</h4>
<p>I guess my question is why not just cfg the whole module at that point</p>



<a name="260878470"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/PR%20open%20to%20rust-lang/rust/near/260878470" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jubilee <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/PR.20open.20to.20rust-lang.2Frust.html#260878470">(Nov 09 2021 at 23:35)</a>:</h4>
<p>^^;</p>



<a name="260878483"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/PR%20open%20to%20rust-lang/rust/near/260878483" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jubilee <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/PR.20open.20to.20rust-lang.2Frust.html#260878483">(Nov 09 2021 at 23:35)</a>:</h4>
<p>A good point.</p>



<a name="260878933"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/PR%20open%20to%20rust-lang/rust/near/260878933" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> simulacrum <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/PR.20open.20to.20rust-lang.2Frust.html#260878933">(Nov 09 2021 at 23:40)</a>:</h4>
<p>I didn't read the whole discussion here</p>



<a name="260878975"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/PR%20open%20to%20rust-lang/rust/near/260878975" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jubilee <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/PR.20open.20to.20rust-lang.2Frust.html#260878975">(Nov 09 2021 at 23:41)</a>:</h4>
<p>It included a lot of not-necessarily-relevant back and forth so that's fine.</p>



<a name="260879013"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/PR%20open%20to%20rust-lang/rust/near/260879013" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> simulacrum <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/PR.20open.20to.20rust-lang.2Frust.html#260879013">(Nov 09 2021 at 23:41)</a>:</h4>
<p>do you need some other solution or whatever, or do you have a plan?</p>



<a name="260879026"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/PR%20open%20to%20rust-lang/rust/near/260879026" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> simulacrum <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/PR.20open.20to.20rust-lang.2Frust.html#260879026">(Nov 09 2021 at 23:41)</a>:</h4>
<p>(I hope my concern was clear)</p>



<a name="260879124"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/PR%20open%20to%20rust-lang/rust/near/260879124" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jubilee <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/PR.20open.20to.20rust-lang.2Frust.html#260879124">(Nov 09 2021 at 23:42)</a>:</h4>
<p>Yeah at first I was going to adjust the library so that it cfgs out the swizzle stuff, but then we realized we plan on landing a change to how we can get bitmasks returned from the compiler.</p>



<a name="260879197"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/PR%20open%20to%20rust-lang/rust/near/260879197" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jubilee <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/PR.20open.20to.20rust-lang.2Frust.html#260879197">(Nov 09 2021 at 23:43)</a>:</h4>
<p>And unfortunately bitmasks have to do with SIMD equality tests.</p>



<a name="260879243"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/PR%20open%20to%20rust-lang/rust/near/260879243" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jubilee <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/PR.20open.20to.20rust-lang.2Frust.html#260879243">(Nov 09 2021 at 23:44)</a>:</h4>
<p>Which means it is <strong>everywhere</strong>.</p>



<a name="260879340"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/PR%20open%20to%20rust-lang/rust/near/260879340" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> simulacrum <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/PR.20open.20to.20rust-lang.2Frust.html#260879340">(Nov 09 2021 at 23:45)</a>:</h4>
<p>Do we expect that to be common? I think it would potentially mean that we just for now always leave the cfg on there (i.e., never compile in stage 0)</p>



<a name="260879371"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/PR%20open%20to%20rust-lang/rust/near/260879371" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> simulacrum <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/PR.20open.20to.20rust-lang.2Frust.html#260879371">(Nov 09 2021 at 23:46)</a>:</h4>
<p>which is fine!</p>



<a name="260879389"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/PR%20open%20to%20rust-lang/rust/near/260879389" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> simulacrum <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/PR.20open.20to.20rust-lang.2Frust.html#260879389">(Nov 09 2021 at 23:46)</a>:</h4>
<p>just means std/core/rustc can't really use it</p>



<a name="260879443"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/PR%20open%20to%20rust-lang/rust/near/260879443" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> simulacrum <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/PR.20open.20to.20rust-lang.2Frust.html#260879443">(Nov 09 2021 at 23:46)</a>:</h4>
<p>it'll become less fine if there's eventually usage in rustc deps and such, so we need to figure it out and stop doing that, but it doesn't <em>have to</em> block merging initially</p>



<a name="260879480"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/PR%20open%20to%20rust-lang/rust/near/260879480" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jubilee <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/PR.20open.20to.20rust-lang.2Frust.html#260879480">(Nov 09 2021 at 23:47)</a>:</h4>
<p>Yeah, I think we don't expect that to be super-common, it's just gonna be a thing For Now, mostly.</p>



<a name="260879577"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/PR%20open%20to%20rust-lang/rust/near/260879577" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jubilee <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/PR.20open.20to.20rust-lang.2Frust.html#260879577">(Nov 09 2021 at 23:48)</a>:</h4>
<p>Because we're trying to squeeze more... coherent? logic-friendly? less arbitrary? behaviors out of the codegen backend.</p>



<a name="260879666"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/PR%20open%20to%20rust-lang/rust/near/260879666" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> simulacrum <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/PR.20open.20to.20rust-lang.2Frust.html#260879666">(Nov 09 2021 at 23:48)</a>:</h4>
<p>Seems OK. If that's the case I think we can probably just go ahead with the PR and deal with cfg(bootstrap) and such as this arises in the future</p>



<a name="260879689"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/PR%20open%20to%20rust-lang/rust/near/260879689" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> simulacrum <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/PR.20open.20to.20rust-lang.2Frust.html#260879689">(Nov 09 2021 at 23:49)</a>:</h4>
<p>(I forget if I had other concerns. I don't think so)</p>



<a name="260879697"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/PR%20open%20to%20rust-lang/rust/near/260879697" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jubilee <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/PR.20open.20to.20rust-lang.2Frust.html#260879697">(Nov 09 2021 at 23:49)</a>:</h4>
<p>Yeah.<br>
I could only see us changing the repr of bitmasks in one other way in the future.</p>



<a name="260879728"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/PR%20open%20to%20rust-lang/rust/near/260879728" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> simulacrum <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/PR.20open.20to.20rust-lang.2Frust.html#260879728">(Nov 09 2021 at 23:49)</a>:</h4>
<p>if that's the only thing I noted feel free to drop a comment and r=me or otherwise mark as waiting on review</p>



<a name="260879731"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/PR%20open%20to%20rust-lang/rust/near/260879731" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jubilee <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/PR.20open.20to.20rust-lang.2Frust.html#260879731">(Nov 09 2021 at 23:49)</a>:</h4>
<p>And that would basically only happen if rustc essentially embedded a new type to represent what LLVM calls <code>i1xN</code>.</p>



<a name="260879894"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/PR%20open%20to%20rust-lang/rust/near/260879894" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jacob Lifshay <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/PR.20open.20to.20rust-lang.2Frust.html#260879894">(Nov 09 2021 at 23:51)</a>:</h4>
<p>note that even on powerpc64 big-endian, bitmasks for SimpleV are lane #<code>n</code> corresponds to bit <code>1 &lt;&lt; n</code></p>



<a name="260885791"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/PR%20open%20to%20rust-lang/rust/near/260885791" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Caleb Zulawski <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/PR.20open.20to.20rust-lang.2Frust.html#260885791">(Nov 10 2021 at 00:54)</a>:</h4>
<p><span class="user-mention" data-user-id="229517">@Jacob Lifshay</span> do you know why endianness effects bitmask bit order?</p>



<a name="260885828"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/PR%20open%20to%20rust-lang/rust/near/260885828" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Caleb Zulawski <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/PR.20open.20to.20rust-lang.2Frust.html#260885828">(Nov 10 2021 at 00:55)</a>:</h4>
<p>I was thinking about it more and now I'm starting to wonder why it <em>isn't</em> simply in LSB-&gt;MSB order</p>



<a name="260885845"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/PR%20open%20to%20rust-lang/rust/near/260885845" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jubilee <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/PR.20open.20to.20rust-lang.2Frust.html#260885845">(Nov 10 2021 at 00:55)</a>:</h4>
<p>oh no I infected you too</p>



<a name="260885909"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/PR%20open%20to%20rust-lang/rust/near/260885909" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jacob Lifshay <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/PR.20open.20to.20rust-lang.2Frust.html#260885909">(Nov 10 2021 at 00:56)</a>:</h4>
<p>cuz bit endianness is an independent variable from byte endianness</p>



<a name="260885945"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/PR%20open%20to%20rust-lang/rust/near/260885945" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Caleb Zulawski <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/PR.20open.20to.20rust-lang.2Frust.html#260885945">(Nov 10 2021 at 00:56)</a>:</h4>
<p>so it just happens to be for every platform we've tested, they're the same?</p>



<a name="260885983"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/PR%20open%20to%20rust-lang/rust/near/260885983" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jacob Lifshay <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/PR.20open.20to.20rust-lang.2Frust.html#260885983">(Nov 10 2021 at 00:57)</a>:</h4>
<p>yes, more or less</p>



<a name="260886034"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/PR%20open%20to%20rust-lang/rust/near/260886034" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Caleb Zulawski <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/PR.20open.20to.20rust-lang.2Frust.html#260886034">(Nov 10 2021 at 00:58)</a>:</h4>
<p>does ppc64 actually have an instruction similar to movemask, and on ppc64le the bit order is swapped?</p>



<a name="260886046"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/PR%20open%20to%20rust-lang/rust/near/260886046" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jacob Lifshay <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/PR.20open.20to.20rust-lang.2Frust.html#260886046">(Nov 10 2021 at 00:58)</a>:</h4>
<p>lemme look...</p>



<a name="260886048"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/PR%20open%20to%20rust-lang/rust/near/260886048" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Caleb Zulawski <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/PR.20open.20to.20rust-lang.2Frust.html#260886048">(Nov 10 2021 at 00:58)</a>:</h4>
<p>or is this an LLVM decision...</p>



<a name="260886064"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/PR%20open%20to%20rust-lang/rust/near/260886064" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Caleb Zulawski <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/PR.20open.20to.20rust-lang.2Frust.html#260886064">(Nov 10 2021 at 00:58)</a>:</h4>
<p>and should there be <code>cfg(bit_endian)</code></p>



<a name="260886096"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/PR%20open%20to%20rust-lang/rust/near/260886096" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Caleb Zulawski <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/PR.20open.20to.20rust-lang.2Frust.html#260886096">(Nov 10 2021 at 00:59)</a>:</h4>
<p>and is there any reason to believe LLVM will ever produce something that's not in one of these two bit orders?</p>



<a name="260886331"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/PR%20open%20to%20rust-lang/rust/near/260886331" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jacob Lifshay <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/PR.20open.20to.20rust-lang.2Frust.html#260886331">(Nov 10 2021 at 01:02)</a>:</h4>
<p>it might produce something where each byte has bits in lsb to msb order, but bytes are in big-endian</p>



<a name="260886385"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/PR%20open%20to%20rust-lang/rust/near/260886385" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jacob Lifshay <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/PR.20open.20to.20rust-lang.2Frust.html#260886385">(Nov 10 2021 at 01:02)</a>:</h4>
<p>powerpc movemask: <a href="https://github.com/WebAssembly/simd/issues/131">https://github.com/WebAssembly/simd/issues/131</a></p>



<a name="260886432"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/PR%20open%20to%20rust-lang/rust/near/260886432" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jacob Lifshay <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/PR.20open.20to.20rust-lang.2Frust.html#260886432">(Nov 10 2021 at 01:03)</a>:</h4>
<p>basically powerpc just uses a extract-arbitrary-bits-from-128-bit-vector-reg instruction</p>



<a name="260886461"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/PR%20open%20to%20rust-lang/rust/near/260886461" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Caleb Zulawski <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/PR.20open.20to.20rust-lang.2Frust.html#260886461">(Nov 10 2021 at 01:03)</a>:</h4>
<p>hmm, so then it's LLVM deciding the bit order changes?</p>



<a name="260886501"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/PR%20open%20to%20rust-lang/rust/near/260886501" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jacob Lifshay <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/PR.20open.20to.20rust-lang.2Frust.html#260886501">(Nov 10 2021 at 01:04)</a>:</h4>
<p>yup, afaict</p>



<a name="260886534"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/PR%20open%20to%20rust-lang/rust/near/260886534" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Caleb Zulawski <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/PR.20open.20to.20rust-lang.2Frust.html#260886534">(Nov 10 2021 at 01:04)</a>:</h4>
<p>I wonder if we can figure out what bit order LLVM actually uses</p>



<a name="260886547"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/PR%20open%20to%20rust-lang/rust/near/260886547" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Caleb Zulawski <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/PR.20open.20to.20rust-lang.2Frust.html#260886547">(Nov 10 2021 at 01:05)</a>:</h4>
<p>like, a general rule</p>



<a name="260886732"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/PR%20open%20to%20rust-lang/rust/near/260886732" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jacob Lifshay <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/PR.20open.20to.20rust-lang.2Frust.html#260886732">(Nov 10 2021 at 01:07)</a>:</h4>
<p>apparently stackoverflow doesn't know: <a href="https://stackoverflow.com/questions/61647221/is-llvm-bitcast-from-vector-of-bool-i1-to-i8-i16-etc-well-defined">https://stackoverflow.com/questions/61647221/is-llvm-bitcast-from-vector-of-bool-i1-to-i8-i16-etc-well-defined</a></p>



<a name="260886741"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/PR%20open%20to%20rust-lang/rust/near/260886741" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jacob Lifshay <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/PR.20open.20to.20rust-lang.2Frust.html#260886741">(Nov 10 2021 at 01:07)</a>:</h4>
<p>a top result from google</p>



<a name="260886800"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/PR%20open%20to%20rust-lang/rust/near/260886800" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Caleb Zulawski <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/PR.20open.20to.20rust-lang.2Frust.html#260886800">(Nov 10 2021 at 01:08)</a>:</h4>
<p>I read some stuff a while back that seemed to indicate it's fine, and consistent</p>



<a name="260886813"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/PR%20open%20to%20rust-lang/rust/near/260886813" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Caleb Zulawski <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/PR.20open.20to.20rust-lang.2Frust.html#260886813">(Nov 10 2021 at 01:08)</a>:</h4>
<p>as in it's guaranteed to pack your bits down, nothing about bit order</p>



<a name="260886827"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/PR%20open%20to%20rust-lang/rust/near/260886827" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jacob Lifshay <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/PR.20open.20to.20rust-lang.2Frust.html#260886827">(Nov 10 2021 at 01:08)</a>:</h4>
<p>yeah</p>



<a name="260886853"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/PR%20open%20to%20rust-lang/rust/near/260886853" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jacob Lifshay <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/PR.20open.20to.20rust-lang.2Frust.html#260886853">(Nov 10 2021 at 01:09)</a>:</h4>
<p>that's the basic summary of the answer to that SO question</p>



<a name="260886885"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/PR%20open%20to%20rust-lang/rust/near/260886885" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Thom Chiovoloni <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/PR.20open.20to.20rust-lang.2Frust.html#260886885">(Nov 10 2021 at 01:09)</a>:</h4>
<p>i think the 68000 had opposite bitorder and byte order. ive at least heard "least significant bit is 0, most significant byte is 0" called "motorola style"</p>



<a name="260886971"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/PR%20open%20to%20rust-lang/rust/near/260886971" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Thom Chiovoloni <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/PR.20open.20to.20rust-lang.2Frust.html#260886971">(Nov 10 2021 at 01:10)</a>:</h4>
<p>i think gcc-rs/rustc-codegen-gcc would enable us to target that platform so it might not entirely be an academic concern</p>



<a name="260886996"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/PR%20open%20to%20rust-lang/rust/near/260886996" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Caleb Zulawski <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/PR.20open.20to.20rust-lang.2Frust.html#260886996">(Nov 10 2021 at 01:10)</a>:</h4>
<p>I suppose for now we can assume they're the same, but if it comes up for any platforms, we can add a separate bit order cfg value</p>



<a name="260887024"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/PR%20open%20to%20rust-lang/rust/near/260887024" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jacob Lifshay <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/PR.20open.20to.20rust-lang.2Frust.html#260887024">(Nov 10 2021 at 01:11)</a>:</h4>
<p>powerpc's spec is msb bit is bit 0, bytes are in either little/big endian. SV specifically defines bit masks using element #n is in bit <code>1 &lt;&lt; n</code></p>



<a name="260887047"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/PR%20open%20to%20rust-lang/rust/near/260887047" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jacob Lifshay <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/PR.20open.20to.20rust-lang.2Frust.html#260887047">(Nov 10 2021 at 01:11)</a>:</h4>
<p><a href="https://lists.llvm.org/pipermail/llvm-dev/2016-August/103678.html">https://lists.llvm.org/pipermail/llvm-dev/2016-August/103678.html</a></p>



<a name="260887109"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/PR%20open%20to%20rust-lang/rust/near/260887109" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jacob Lifshay <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/PR.20open.20to.20rust-lang.2Frust.html#260887109">(Nov 10 2021 at 01:12)</a>:</h4>
<blockquote>
<p>I highly recommend that you use only vectors of elements which have a size which is a whole number of bytes. There are known issues with how we handle the more-general cases</p>
</blockquote>



<a name="260887119"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/PR%20open%20to%20rust-lang/rust/near/260887119" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Caleb Zulawski <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/PR.20open.20to.20rust-lang.2Frust.html#260887119">(Nov 10 2021 at 01:12)</a>:</h4>
<p>yeah, we do pad it</p>



<a name="260887151"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/PR%20open%20to%20rust-lang/rust/near/260887151" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Caleb Zulawski <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/PR.20open.20to.20rust-lang.2Frust.html#260887151">(Nov 10 2021 at 01:13)</a>:</h4>
<p>in that case, LLVM isn't using bit order for PPC then</p>



<a name="260887178"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/PR%20open%20to%20rust-lang/rust/near/260887178" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jacob Lifshay <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/PR.20open.20to.20rust-lang.2Frust.html#260887178">(Nov 10 2021 at 01:13)</a>:</h4>
<p>that quote was for <code>&lt;8 x i1&gt;</code></p>



<a name="260887379"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/PR%20open%20to%20rust-lang/rust/near/260887379" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Caleb Zulawski <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/PR.20open.20to.20rust-lang.2Frust.html#260887379">(Nov 10 2021 at 01:16)</a>:</h4>
<p>yeah, I mean that we pad it to a whole number of bytes before casting</p>



<a name="260887399"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/PR%20open%20to%20rust-lang/rust/near/260887399" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Caleb Zulawski <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/PR.20open.20to.20rust-lang.2Frust.html#260887399">(Nov 10 2021 at 01:17)</a>:</h4>
<p>but yeah, ppc64le comes out LSB first</p>



<a name="260888464"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/PR%20open%20to%20rust-lang/rust/near/260888464" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jacob Lifshay <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/PR.20open.20to.20rust-lang.2Frust.html#260888464">(Nov 10 2021 at 01:32)</a>:</h4>
<p>well, apparently llvm uses byte endian-ness for bit-endian-ness too: <a href="https://github.com/llvm/llvm-project/blob/18334a1c1afe1b8a83c2a6108413bc48d80107df/llvm/lib/Analysis/ConstantFolding.cpp#L218">https://github.com/llvm/llvm-project/blob/18334a1c1afe1b8a83c2a6108413bc48d80107df/llvm/lib/Analysis/ConstantFolding.cpp#L218</a></p>



<a name="260888488"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/PR%20open%20to%20rust-lang/rust/near/260888488" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Caleb Zulawski <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/PR.20open.20to.20rust-lang.2Frust.html#260888488">(Nov 10 2021 at 01:33)</a>:</h4>
<p>well, that answers that</p>



<a name="260888499"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/PR%20open%20to%20rust-lang/rust/near/260888499" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jacob Lifshay <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/PR.20open.20to.20rust-lang.2Frust.html#260888499">(Nov 10 2021 at 01:33)</a>:</h4>
<p>which is not always correct imho...</p>



<a name="260888581"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/PR%20open%20to%20rust-lang/rust/near/260888581" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Caleb Zulawski <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/PR.20open.20to.20rust-lang.2Frust.html#260888581">(Nov 10 2021 at 01:34)</a>:</h4>
<p>I think it's arbitrary</p>



<a name="260888625"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/PR%20open%20to%20rust-lang/rust/near/260888625" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jacob Lifshay <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/PR.20open.20to.20rust-lang.2Frust.html#260888625">(Nov 10 2021 at 01:35)</a>:</h4>
<p>i think it's just that llvm never needed to support something where bit endianness != byte endianness</p>



<a name="260888656"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/PR%20open%20to%20rust-lang/rust/near/260888656" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jubilee <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/PR.20open.20to.20rust-lang.2Frust.html#260888656">(Nov 10 2021 at 01:35)</a>:</h4>
<p>I wonder if that's the root of issues regarding PPC64LE...?</p>



<a name="260888744"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/PR%20open%20to%20rust-lang/rust/near/260888744" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jacob Lifshay <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/PR.20open.20to.20rust-lang.2Frust.html#260888744">(Nov 10 2021 at 01:36)</a>:</h4>
<p>ppc64le should behave identially to x86 in that respect, so i don't think that's the issue...</p>



<a name="260888747"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/PR%20open%20to%20rust-lang/rust/near/260888747" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Caleb Zulawski <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/PR.20open.20to.20rust-lang.2Frust.html#260888747">(Nov 10 2021 at 01:36)</a>:</h4>
<p>well, except our code runs fine on an actual ppc64le system</p>



<a name="260888814"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/PR%20open%20to%20rust-lang/rust/near/260888814" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jacob Lifshay <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/PR.20open.20to.20rust-lang.2Frust.html#260888814">(Nov 10 2021 at 01:37)</a>:</h4>
<p>i'd guess that qemu isn't tested that well in some of the weirder vector instructions</p>



<a name="260888823"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/PR%20open%20to%20rust-lang/rust/near/260888823" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jubilee <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/PR.20open.20to.20rust-lang.2Frust.html#260888823">(Nov 10 2021 at 01:37)</a>:</h4>
<p>Ahh.</p>



<a name="260888917"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/PR%20open%20to%20rust-lang/rust/near/260888917" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jacob Lifshay <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/PR.20open.20to.20rust-lang.2Frust.html#260888917">(Nov 10 2021 at 01:39)</a>:</h4>
<p>i'd expect that those who need powerpc64le almost always just use a native cpu, so not many have encountered the qemu bugs</p>



<a name="260889025"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/PR%20open%20to%20rust-lang/rust/near/260889025" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jacob Lifshay <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/PR.20open.20to.20rust-lang.2Frust.html#260889025">(Nov 10 2021 at 01:40)</a>:</h4>
<p>as an example...qemu just plain doesn't implement the BCD instructions that the openpower spec declares are required on all cpus, even the tiniest ones.</p>



<a name="260889065"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/PR%20open%20to%20rust-lang/rust/near/260889065" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jacob Lifshay <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/PR.20open.20to.20rust-lang.2Frust.html#260889065">(Nov 10 2021 at 01:41)</a>:</h4>
<p>it also doesn't match power9's behavior around the integer divide/remainder instructions</p>



<a name="260889338"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/PR%20open%20to%20rust-lang/rust/near/260889338" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jubilee <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/PR.20open.20to.20rust-lang.2Frust.html#260889338">(Nov 10 2021 at 01:44)</a>:</h4>
<p>Alas.</p>



<a name="260889538"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/PR%20open%20to%20rust-lang/rust/near/260889538" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jacob Lifshay <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/PR.20open.20to.20rust-lang.2Frust.html#260889538">(Nov 10 2021 at 01:47)</a>:</h4>
<p>for bit endianness, it may be easier for libre-soc to just switch predicate endian-ness on big-endian mode rather than add support to llvm for different bit/byte endianness</p>



<a name="260889665"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/PR%20open%20to%20rust-lang/rust/near/260889665" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jacob Lifshay <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/PR.20open.20to.20rust-lang.2Frust.html#260889665">(Nov 10 2021 at 01:49)</a>:</h4>
<p>libre-soc bug for tracking endianness: <a href="https://bugs.libre-soc.org/show_bug.cgi?id=744">https://bugs.libre-soc.org/show_bug.cgi?id=744</a></p>



<a name="260890023"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/PR%20open%20to%20rust-lang/rust/near/260890023" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Caleb Zulawski <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/PR.20open.20to.20rust-lang.2Frust.html#260890023">(Nov 10 2021 at 01:55)</a>:</h4>
<p><span class="user-mention" data-user-id="281757">@Jubilee</span> since it does appear that bit- and byte-endianness are assumed to be the same by LLVM, I just documented that specifically</p>



<a name="260890035"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/PR%20open%20to%20rust-lang/rust/near/260890035" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Caleb Zulawski <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/PR.20open.20to.20rust-lang.2Frust.html#260890035">(Nov 10 2021 at 01:55)</a>:</h4>
<p>If anything else ever occurs we can consider it a bug and go from there</p>



<a name="260890907"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/PR%20open%20to%20rust-lang/rust/near/260890907" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jubilee <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/PR.20open.20to.20rust-lang.2Frust.html#260890907">(Nov 10 2021 at 02:10)</a>:</h4>
<p>Fair enough!</p>



<a name="260891143"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/PR%20open%20to%20rust-lang/rust/near/260891143" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jubilee <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/PR.20open.20to.20rust-lang.2Frust.html#260891143">(Nov 10 2021 at 02:15)</a>:</h4>
<p>If you can squishy the fixups in <a href="https://github.com/rust-lang/portable-simd/issues/175">portable-simd#175</a> then that can be added in too.</p>



<a name="260892019"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/PR%20open%20to%20rust-lang/rust/near/260892019" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Caleb Zulawski <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/PR.20open.20to.20rust-lang.2Frust.html#260892019">(Nov 10 2021 at 02:21)</a>:</h4>
<p>Done</p>



<a name="260892839"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/PR%20open%20to%20rust-lang/rust/near/260892839" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jubilee <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/PR.20open.20to.20rust-lang.2Frust.html#260892839">(Nov 10 2021 at 02:21)</a>:</h4>
<p>Nice.<br>
Drafting a smol fix to catch future warnings in CI.</p>



<a name="261040847"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/PR%20open%20to%20rust-lang/rust/near/261040847" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jubilee <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/PR.20open.20to.20rust-lang.2Frust.html#261040847">(Nov 10 2021 at 19:22)</a>:</h4>
<p><span class="user-mention" data-user-id="312331">@Caleb Zulawski</span> Sorry about your SAN loss</p>



<a name="261041213"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/PR%20open%20to%20rust-lang/rust/near/261041213" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Caleb Zulawski <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/PR.20open.20to.20rust-lang.2Frust.html#261041213">(Nov 10 2021 at 19:24)</a>:</h4>
<p>I'll just be glad when we can catch errors before PRs to upstream</p>



<a name="261048071"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/PR%20open%20to%20rust-lang/rust/near/261048071" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jubilee <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/PR.20open.20to.20rust-lang.2Frust.html#261048071">(Nov 10 2021 at 20:13)</a>:</h4>
<p>Thrash for an hour and then remember that conditioning data is an option (again), lol.</p>



<a name="261053000"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/PR%20open%20to%20rust-lang/rust/near/261053000" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jubilee <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/PR.20open.20to.20rust-lang.2Frust.html#261053000">(Nov 10 2021 at 20:52)</a>:</h4>
<p><span class="user-mention" data-user-id="229517">@Jacob Lifshay</span> I appreciate the help I just am deliberately keeping the scope down to things at roughly the complexity band of "x86_64_v4"</p>



<a name="261053743"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/PR%20open%20to%20rust-lang/rust/near/261053743" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jacob Lifshay <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/PR.20open.20to.20rust-lang.2Frust.html#261053743">(Nov 10 2021 at 20:58)</a>:</h4>
<p>k, in that case you can specifically look for x86-64-v4: <a href="https://unix.stackexchange.com/questions/631217/how-do-i-check-if-my-cpu-supports-x86-64-v2/646289#646289">https://unix.stackexchange.com/questions/631217/how-do-i-check-if-my-cpu-supports-x86-64-v2/646289#646289</a></p>



<a name="261053768"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/PR%20open%20to%20rust-lang/rust/near/261053768" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jacob Lifshay <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/PR.20open.20to.20rust-lang.2Frust.html#261053768">(Nov 10 2021 at 20:59)</a>:</h4>
<p>seems like the best path</p>



<a name="261054023"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/PR%20open%20to%20rust-lang/rust/near/261054023" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jubilee <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/PR.20open.20to.20rust-lang.2Frust.html#261054023">(Nov 10 2021 at 21:00)</a>:</h4>
<p>Mmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmm that is also "rewrite entire thing in Rust" tier.<br>
My current version works right now with GItHub's fleet and I am content with the knowledge it is transient if <span class="user-mention" data-user-id="312331">@Caleb Zulawski</span> is?</p>



<a name="261054307"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/PR%20open%20to%20rust-lang/rust/near/261054307" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jacob Lifshay <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/PR.20open.20to.20rust-lang.2Frust.html#261054307">(Nov 10 2021 at 21:02)</a>:</h4>
<p>i'd expect it to be as simple as <code>/path/to/ld.so --help | grep 'x86-64-v4.*supported'</code></p>



<a name="261054469"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/PR%20open%20to%20rust-lang/rust/near/261054469" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jubilee <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/PR.20open.20to.20rust-lang.2Frust.html#261054469">(Nov 10 2021 at 21:03)</a>:</h4>
<p><em>sighs</em> I am also fine with it just using <code>avx512f</code> if that's all that's available, atm.</p>



<a name="261054632"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/PR%20open%20to%20rust-lang/rust/near/261054632" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jubilee <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/PR.20open.20to.20rust-lang.2Frust.html#261054632">(Nov 10 2021 at 21:05)</a>:</h4>
<p>I really need to detect when I offer a misleading example better.</p>



<a name="261054741"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/PR%20open%20to%20rust-lang/rust/near/261054741" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jacob Lifshay <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/PR.20open.20to.20rust-lang.2Frust.html#261054741">(Nov 10 2021 at 21:06)</a>:</h4>
<p>the C flag should be similar to clang's <code>-march=x86-64-v4</code></p>



<a name="261054871"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/PR%20open%20to%20rust-lang/rust/near/261054871" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jacob Lifshay <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/PR.20open.20to.20rust-lang.2Frust.html#261054871">(Nov 10 2021 at 21:07)</a>:</h4>
<p>we can fix it later and just land what you have now</p>



<a name="261054925"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/PR%20open%20to%20rust-lang/rust/near/261054925" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jubilee <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/PR.20open.20to.20rust-lang.2Frust.html#261054925">(Nov 10 2021 at 21:07)</a>:</h4>
<p>Yeah, I am pretty game for improvements / fixing it later. ^^; I just want a solution that defers the existing problem (not detecting this class of errors) for like... a year or so.</p>



<a name="261054991"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/PR%20open%20to%20rust-lang/rust/near/261054991" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Caleb Zulawski <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/PR.20open.20to.20rust-lang.2Frust.html#261054991">(Nov 10 2021 at 21:08)</a>:</h4>
<p>Can I suggest instead keeping it so avx512 is a separate job in the matrix, but it only runs when it's on a proper agent?</p>



<a name="261055023"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/PR%20open%20to%20rust-lang/rust/near/261055023" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jubilee <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/PR.20open.20to.20rust-lang.2Frust.html#261055023">(Nov 10 2021 at 21:08)</a>:</h4>
<p>Hmmm.</p>



<a name="261055055"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/PR%20open%20to%20rust-lang/rust/near/261055055" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Caleb Zulawski <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/PR.20open.20to.20rust-lang.2Frust.html#261055055">(Nov 10 2021 at 21:08)</a>:</h4>
<p>So nearly identical to what you have, just a slightly different job</p>



<a name="261055059"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/PR%20open%20to%20rust-lang/rust/near/261055059" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jubilee <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/PR.20open.20to.20rust-lang.2Frust.html#261055059">(Nov 10 2021 at 21:08)</a>:</h4>
<p>I thiiiink I can get that going.</p>



<a name="261055105"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/PR%20open%20to%20rust-lang/rust/near/261055105" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Caleb Zulawski <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/PR.20open.20to.20rust-lang.2Frust.html#261055105">(Nov 10 2021 at 21:09)</a>:</h4>
<p>It doesn't have to be in the matrix technically, but that would be nice</p>



<a name="261055151"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/PR%20open%20to%20rust-lang/rust/near/261055151" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Caleb Zulawski <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/PR.20open.20to.20rust-lang.2Frust.html#261055151">(Nov 10 2021 at 21:09)</a>:</h4>
<p>Also, I think you can use GHA rules to selectively disable the job</p>



<a name="261055219"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/PR%20open%20to%20rust-lang/rust/near/261055219" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Caleb Zulawski <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/PR.20open.20to.20rust-lang.2Frust.html#261055219">(Nov 10 2021 at 21:10)</a>:</h4>
<p>To disable the specific step after detection, really</p>



<a name="261055339"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/PR%20open%20to%20rust-lang/rust/near/261055339" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jubilee <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/PR.20open.20to.20rust-lang.2Frust.html#261055339">(Nov 10 2021 at 21:11)</a>:</h4>
<p>yeah.</p>



<a name="261055503"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/PR%20open%20to%20rust-lang/rust/near/261055503" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Caleb Zulawski <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/PR.20open.20to.20rust-lang.2Frust.html#261055503">(Nov 10 2021 at 21:12)</a>:</h4>
<p>Perhaps you can put it in the x86-tests then</p>



<a name="261056409"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/PR%20open%20to%20rust-lang/rust/near/261056409" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jubilee <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/PR.20open.20to.20rust-lang.2Frust.html#261056409">(Nov 10 2021 at 21:20)</a>:</h4>
<p>Nice, yes, I can get it to skip one.</p>



<a name="261057118"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/PR%20open%20to%20rust-lang/rust/near/261057118" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jubilee <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/PR.20open.20to.20rust-lang.2Frust.html#261057118">(Nov 10 2021 at 21:26)</a>:</h4>
<p><span class="user-mention" data-user-id="312331">@Caleb Zulawski</span> I would like to further improve things and clean stuff up so we don't run like 67 computers in CI unconditionally, but does this look like an improvement enough atm?</p>



<a name="261057220"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/PR%20open%20to%20rust-lang/rust/near/261057220" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Caleb Zulawski <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/PR.20open.20to.20rust-lang.2Frust.html#261057220">(Nov 10 2021 at 21:27)</a>:</h4>
<p>Yeah I would like it to not take literally forever</p>



<a name="261057438"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/PR%20open%20to%20rust-lang/rust/near/261057438" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Caleb Zulawski <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/PR.20open.20to.20rust-lang.2Frust.html#261057438">(Nov 10 2021 at 21:29)</a>:</h4>
<p>So what happens if there isn't any avx512 at all?</p>



<a name="261057446"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/PR%20open%20to%20rust-lang/rust/near/261057446" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jubilee <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/PR.20open.20to.20rust-lang.2Frust.html#261057446">(Nov 10 2021 at 21:29)</a>:</h4>
<p>It just doesn't run lol</p>



<a name="261057458"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/PR%20open%20to%20rust-lang/rust/near/261057458" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jubilee <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/PR.20open.20to.20rust-lang.2Frust.html#261057458">(Nov 10 2021 at 21:29)</a>:</h4>
<p>or well, it reruns the default checks</p>



<a name="261057530"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/PR%20open%20to%20rust-lang/rust/near/261057530" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Caleb Zulawski <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/PR.20open.20to.20rust-lang.2Frust.html#261057530">(Nov 10 2021 at 21:30)</a>:</h4>
<p>Gotcha. Could you maybe change it to skip that step entirely if there's no avx512?</p>



<a name="261057557"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/PR%20open%20to%20rust-lang/rust/near/261057557" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Caleb Zulawski <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/PR.20open.20to.20rust-lang.2Frust.html#261057557">(Nov 10 2021 at 21:30)</a>:</h4>
<p>Just so we can at least see when it runs and when it doesn't</p>



<a name="261057643"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/PR%20open%20to%20rust-lang/rust/near/261057643" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jacob Lifshay <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/PR.20open.20to.20rust-lang.2Frust.html#261057643">(Nov 10 2021 at 21:31)</a>:</h4>
<p>can you tell github actions to skip it with a message "avx512 not supported on this server, test skipped"?</p>



<a name="261057671"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/PR%20open%20to%20rust-lang/rust/near/261057671" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jacob Lifshay <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/PR.20open.20to.20rust-lang.2Frust.html#261057671">(Nov 10 2021 at 21:31)</a>:</h4>
<p>or similar?</p>



<a name="261057715"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/PR%20open%20to%20rust-lang/rust/near/261057715" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jubilee <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/PR.20open.20to.20rust-lang.2Frust.html#261057715">(Nov 10 2021 at 21:31)</a>:</h4>
<p>Let me try...</p>



<a name="261057719"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/PR%20open%20to%20rust-lang/rust/near/261057719" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Caleb Zulawski <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/PR.20open.20to.20rust-lang.2Frust.html#261057719">(Nov 10 2021 at 21:31)</a>:</h4>
<p>Yeah that would be perfect, if it can do that then it looks good to me</p>



<a name="261057834"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/PR%20open%20to%20rust-lang/rust/near/261057834" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jubilee <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/PR.20open.20to.20rust-lang.2Frust.html#261057834">(Nov 10 2021 at 21:32)</a>:</h4>
<p>It will just have a <span aria-label="not allowed" class="emoji emoji-1f6ab" role="img" title="not allowed">:not_allowed:</span> symbol where the job would be atm.</p>



<a name="261057912"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/PR%20open%20to%20rust-lang/rust/near/261057912" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jubilee <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/PR.20open.20to.20rust-lang.2Frust.html#261057912">(Nov 10 2021 at 21:32)</a>:</h4>
<p>I am not entirely clear on GHA's tools for tweaking job appearance but I know people have been asking for more, so I don't want to find out exactly how disappointed I would be yet.</p>



<a name="261059694"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/PR%20open%20to%20rust-lang/rust/near/261059694" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jubilee <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/PR.20open.20to.20rust-lang.2Frust.html#261059694">(Nov 10 2021 at 21:49)</a>:</h4>
<p><span class="user-mention" data-user-id="312331">@Caleb Zulawski</span> It looks like this atm. <a href="https://github.com/rust-lang/portable-simd/runs/4171171231?check_suite_focus=true">https://github.com/rust-lang/portable-simd/runs/4171171231?check_suite_focus=true</a></p>



<a name="261060078"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/PR%20open%20to%20rust-lang/rust/near/261060078" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Caleb Zulawski <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/PR.20open.20to.20rust-lang.2Frust.html#261060078">(Nov 10 2021 at 21:52)</a>:</h4>
<p>That looks fine to me</p>



<a name="261060134"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/PR%20open%20to%20rust-lang/rust/near/261060134" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Caleb Zulawski <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/PR.20open.20to.20rust-lang.2Frust.html#261060134">(Nov 10 2021 at 21:53)</a>:</h4>
<p>Is there a reason it's in the check cargo features job though?</p>



<a name="261060808"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/PR%20open%20to%20rust-lang/rust/near/261060808" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jubilee <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/PR.20open.20to.20rust-lang.2Frust.html#261060808">(Nov 10 2021 at 21:58)</a>:</h4>
<p>uhh.</p>



<a name="261061225"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/PR%20open%20to%20rust-lang/rust/near/261061225" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jubilee <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/PR.20open.20to.20rust-lang.2Frust.html#261061225">(Nov 10 2021 at 22:01)</a>:</h4>
<p>To limit my scope to something I can finish and merge before rewriting all 261 lines of <code>ci.yml</code> tbh.</p>



<a name="261079158"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/PR%20open%20to%20rust-lang/rust/near/261079158" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Caleb Zulawski <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/PR.20open.20to.20rust-lang.2Frust.html#261079158">(Nov 11 2021 at 01:00)</a>:</h4>
<p>hmm question: doesn't the <code>native</code> target feature in the x86-tests job cover AVX-512 in this scenario already?</p>



<a name="261079287"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/PR%20open%20to%20rust-lang/rust/near/261079287" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Caleb Zulawski <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/PR.20open.20to.20rust-lang.2Frust.html#261079287">(Nov 11 2021 at 01:02)</a>:</h4>
<p>and do basically what that test is doing, but without all of the detection kludge (though I am impressed by it)</p>



<a name="261079331"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/PR%20open%20to%20rust-lang/rust/near/261079331" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jacob Lifshay <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/PR.20open.20to.20rust-lang.2Frust.html#261079331">(Nov 11 2021 at 01:02)</a>:</h4>
<p>yes...</p>



<a name="261079375"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/PR%20open%20to%20rust-lang/rust/near/261079375" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jubilee <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/PR.20open.20to.20rust-lang.2Frust.html#261079375">(Nov 11 2021 at 01:03)</a>:</h4>
<p>I think so.</p>



<a name="261079456"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/PR%20open%20to%20rust-lang/rust/near/261079456" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Caleb Zulawski <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/PR.20open.20to.20rust-lang.2Frust.html#261079456">(Nov 11 2021 at 01:04)</a>:</h4>
<p>I think we can probably take out the avx-512 specific stuff entirely, but we should probably comment that the native code _sometimes_ tests avx-512, since it's inconsistent</p>



<a name="261079552"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/PR%20open%20to%20rust-lang/rust/near/261079552" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Caleb Zulawski <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/PR.20open.20to.20rust-lang.2Frust.html#261079552">(Nov 11 2021 at 01:05)</a>:</h4>
<p>(also this is better because that job actually runs the tests, not just a build test)</p>



<a name="261079573"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/PR%20open%20to%20rust-lang/rust/near/261079573" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Caleb Zulawski <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/PR.20open.20to.20rust-lang.2Frust.html#261079573">(Nov 11 2021 at 01:05)</a>:</h4>
<p>though I now feel better knowing apparently we were testing avx-512 this whole time, maybe</p>



<a name="261079640"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/PR%20open%20to%20rust-lang/rust/near/261079640" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Caleb Zulawski <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/PR.20open.20to.20rust-lang.2Frust.html#261079640">(Nov 11 2021 at 01:06)</a>:</h4>
<p>unless someone is using build-std or whatever no one can actually activate that code anyway, though</p>



<a name="261079642"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/PR%20open%20to%20rust-lang/rust/near/261079642" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jubilee <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/PR.20open.20to.20rust-lang.2Frust.html#261079642">(Nov 11 2021 at 01:06)</a>:</h4>
<p>Hmmm I think I would still want to leave in a job that signals whether or not AVX is present.</p>



<a name="261079661"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/PR%20open%20to%20rust-lang/rust/near/261079661" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Caleb Zulawski <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/PR.20open.20to.20rust-lang.2Frust.html#261079661">(Nov 11 2021 at 01:06)</a>:</h4>
<p>maybe just put a step in that job?</p>



<a name="261079668"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/PR%20open%20to%20rust-lang/rust/near/261079668" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jubilee <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/PR.20open.20to.20rust-lang.2Frust.html#261079668">(Nov 11 2021 at 01:06)</a>:</h4>
<p>Yeah probably.</p>



<a name="261079680"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/PR%20open%20to%20rust-lang/rust/near/261079680" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Caleb Zulawski <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/PR.20open.20to.20rust-lang.2Frust.html#261079680">(Nov 11 2021 at 01:07)</a>:</h4>
<p>I don't know if it's possible, but can we somehow get rustc to dump what <code>native</code> actually means</p>



<a name="261079682"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/PR%20open%20to%20rust-lang/rust/near/261079682" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Caleb Zulawski <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/PR.20open.20to.20rust-lang.2Frust.html#261079682">(Nov 11 2021 at 01:07)</a>:</h4>
<p>?</p>



<a name="261079690"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/PR%20open%20to%20rust-lang/rust/near/261079690" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jubilee <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/PR.20open.20to.20rust-lang.2Frust.html#261079690">(Nov 11 2021 at 01:07)</a>:</h4>
<p>I think so.</p>



<a name="261079816"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/PR%20open%20to%20rust-lang/rust/near/261079816" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jubilee <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/PR.20open.20to.20rust-lang.2Frust.html#261079816">(Nov 11 2021 at 01:09)</a>:</h4>
<p>Yeah we do that here:</p>
<div class="codehilite" data-code-language="YAML+Jinja"><pre><span></span><code>      <span class="c1"># Super useful for debugging why a SIGILL occurred.</span>
      <span class="p p-Indicator">-</span> <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">Dump target configuration and support</span>
        <span class="nt">run</span><span class="p">:</span> <span class="p p-Indicator">|</span>
          <span class="no">rustc -Vv</span>
          <span class="no">echo "Caveat: not all target features are expected to be logged"</span>
          <span class="no">echo "## Requested target configuration (RUSTFLAGS=$RUSTFLAGS)"</span>
          <span class="no">rustc --print=cfg --target=$</span><span class="cp">{{</span> <span class="nv">matrix.target</span> <span class="cp">}}</span><span class="no"> $RUSTFLAGS</span>
          <span class="no">echo "## Supported target configuration for --target=$</span><span class="cp">{{</span> <span class="nv">matrix.target</span> <span class="cp">}}</span><span class="no">"</span>
          <span class="no">rustc --print=cfg --target=$</span><span class="cp">{{</span> <span class="nv">matrix.target</span> <span class="cp">}}</span><span class="no"> -Ctarget-cpu=native</span>
          <span class="no">echo "## Natively supported target configuration"</span>
          <span class="no">rustc --print=cfg -Ctarget-cpu=native</span>
</code></pre></div>



<a name="261079849"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/PR%20open%20to%20rust-lang/rust/near/261079849" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Caleb Zulawski <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/PR.20open.20to.20rust-lang.2Frust.html#261079849">(Nov 11 2021 at 01:09)</a>:</h4>
<p>oh I literally just didn't scroll down, lol</p>



<a name="261080169"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/PR%20open%20to%20rust-lang/rust/near/261080169" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jubilee <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/PR.20open.20to.20rust-lang.2Frust.html#261080169">(Nov 11 2021 at 01:13)</a>:</h4>
<p>tbh half the exercise of that entire kludge was figuring out how to do conditionals on GHA somewhat proper-like.</p>



<a name="261097388"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/PR%20open%20to%20rust-lang/rust/near/261097388" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jacob Lifshay <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/PR.20open.20to.20rust-lang.2Frust.html#261097388">(Nov 11 2021 at 06:11)</a>:</h4>
<p>SIGSEGV -- fun!</p>



<a name="261097407"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/PR%20open%20to%20rust-lang/rust/near/261097407" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jacob Lifshay <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/PR.20open.20to.20rust-lang.2Frust.html#261097407">(Nov 11 2021 at 06:11)</a>:</h4>
<p><a href="https://github.com/rust-lang/rust/pull/89167#issuecomment-966009262">https://github.com/rust-lang/rust/pull/89167#issuecomment-966009262</a></p>



<a name="261097484"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/PR%20open%20to%20rust-lang/rust/near/261097484" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jacob Lifshay <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/PR.20open.20to.20rust-lang.2Frust.html#261097484">(Nov 11 2021 at 06:13)</a>:</h4>
<p>is llvm compiled with debug asserts enabled? if not, that might be why it's crashing...we're somehow feeding it invalid llvm ir</p>



<a name="261097542"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/PR%20open%20to%20rust-lang/rust/near/261097542" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Caleb Zulawski <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/PR.20open.20to.20rust-lang.2Frust.html#261097542">(Nov 11 2021 at 06:14)</a>:</h4>
<p>This change also shouldn't in any way change compilation of existing crates...</p>



<a name="261097572"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/PR%20open%20to%20rust-lang/rust/near/261097572" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jacob Lifshay <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/PR.20open.20to.20rust-lang.2Frust.html#261097572">(Nov 11 2021 at 06:15)</a>:</h4>
<p>rerun? maybe it's spurious</p>



<a name="261097657"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/PR%20open%20to%20rust-lang/rust/near/261097657" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jacob Lifshay <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/PR.20open.20to.20rust-lang.2Frust.html#261097657">(Nov 11 2021 at 06:17)</a>:</h4>
<p>llvm ir: in my experience using llvm as a library, if you feed it invalid ir it loves to segfault if assertions are disabled, it would assert failure if assertions are enabled</p>



<a name="261190474"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/PR%20open%20to%20rust-lang/rust/near/261190474" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jubilee <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/PR.20open.20to.20rust-lang.2Frust.html#261190474">(Nov 11 2021 at 22:19)</a>:</h4>
<p><a href="https://github.com/rust-lang/rust/pull/89167#issuecomment-966665501">https://github.com/rust-lang/rust/pull/89167#issuecomment-966665501</a><br>
<span class="user-mention" data-user-id="229517">@Jacob Lifshay</span> I was wrong, I was forgetting it's a Canadian cross, effectively.</p>



<a name="261190758"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/PR%20open%20to%20rust-lang/rust/near/261190758" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jacob Lifshay <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/PR.20open.20to.20rust-lang.2Frust.html#261190758">(Nov 11 2021 at 22:22)</a>:</h4>
<p>ah</p>



<a name="261339459"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/PR%20open%20to%20rust-lang/rust/near/261339459" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jubilee <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/PR.20open.20to.20rust-lang.2Frust.html#261339459">(Nov 13 2021 at 04:43)</a>:</h4>
<p>Two ARM compat fixes later. x_x<br>
...I think maybe the conversion functions should actually live in stdarch, since they depend a lot more on the nuances of those targets. Unless... I guess since it's a From, but...?</p>



<a name="261339584"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/PR%20open%20to%20rust-lang/rust/near/261339584" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Caleb Zulawski <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/PR.20open.20to.20rust-lang.2Frust.html#261339584">(Nov 13 2021 at 04:46)</a>:</h4>
<p>Yeah, perhaps they should be migrated there</p>



<a name="261339590"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/PR%20open%20to%20rust-lang/rust/near/261339590" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Caleb Zulawski <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/PR.20open.20to.20rust-lang.2Frust.html#261339590">(Nov 13 2021 at 04:46)</a>:</h4>
<p>That really would make more sense</p>



<a name="261342203"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/PR%20open%20to%20rust-lang/rust/near/261342203" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Caleb Zulawski <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/PR.20open.20to.20rust-lang.2Frust.html#261342203">(Nov 13 2021 at 05:47)</a>:</h4>
<p>Did the merge really complete or am I hallucinating?  I just kind of assumed there would be infinite errors</p>



<a name="261342256"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/PR%20open%20to%20rust-lang/rust/near/261342256" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Caleb Zulawski <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/PR.20open.20to.20rust-lang.2Frust.html#261342256">(Nov 13 2021 at 05:48)</a>:</h4>
<p>Maybe we should write up an official post since we did that once</p>



<a name="261342292"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/PR%20open%20to%20rust-lang/rust/near/261342292" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jubilee <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/PR.20open.20to.20rust-lang.2Frust.html#261342292">(Nov 13 2021 at 05:49)</a>:</h4>
<p><span class="user-mention silent" data-user-id="312331">Caleb Zulawski</span> <a href="#narrow/stream/257879-project-portable-simd/topic/PR.20open.20to.20rust-lang.2Frust/near/261342203">said</a>:</p>
<blockquote>
<p>Did the merge really complete or am I hallucinating?  I just kind of assumed there would be infinite errors</p>
</blockquote>
<p>same tbh, I've felt more sober and grounded on <code>${HIGHLY_CONTROLLED_SUBSTANCE}</code></p>



<a name="261342434"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/PR%20open%20to%20rust-lang/rust/near/261342434" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Caleb Zulawski <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/PR.20open.20to.20rust-lang.2Frust.html#261342434">(Nov 13 2021 at 05:52)</a>:</h4>
<p>Thanks for finding and fixing every bug we didn't know we had, lol</p>



<a name="261350480"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/PR%20open%20to%20rust-lang/rust/near/261350480" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Josh Triplett <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/PR.20open.20to.20rust-lang.2Frust.html#261350480">(Nov 13 2021 at 09:18)</a>:</h4>
<p>Massive congratulations to the portable-simd project!</p>



<a name="261364583"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/PR%20open%20to%20rust-lang/rust/near/261364583" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lokathor <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/PR.20open.20to.20rust-lang.2Frust.html#261364583">(Nov 13 2021 at 15:01)</a>:</h4>
<p>big congrats indeed</p>



<a name="261366481"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/PR%20open%20to%20rust-lang/rust/near/261366481" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Caleb Zulawski <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/PR.20open.20to.20rust-lang.2Frust.html#261366481">(Nov 13 2021 at 15:43)</a>:</h4>
<p><span class="user-mention" data-user-id="281757">@Jubilee</span> I started a post for inside rust: <a href="https://hackmd.io/VGGIcV3VQjeUPcKwXZ1TBA">https://hackmd.io/VGGIcV3VQjeUPcKwXZ1TBA</a><br>
not really sure where to go with it, feel free to change whatever you'd like</p>



<a name="261372194"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/PR%20open%20to%20rust-lang/rust/near/261372194" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lokathor <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/PR.20open.20to.20rust-lang.2Frust.html#261372194">(Nov 13 2021 at 17:57)</a>:</h4>
<p>it doesn't appear to be in today's docs :(</p>



<a name="261372247"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/PR%20open%20to%20rust-lang/rust/near/261372247" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Caleb Zulawski <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/PR.20open.20to.20rust-lang.2Frust.html#261372247">(Nov 13 2021 at 17:58)</a>:</h4>
<p>I think the build is around midnight UTC so we have another 6 hours or something?</p>



<a name="261372256"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/PR%20open%20to%20rust-lang/rust/near/261372256" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Caleb Zulawski <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/PR.20open.20to.20rust-lang.2Frust.html#261372256">(Nov 13 2021 at 17:58)</a>:</h4>
<p>So basically tomorrow</p>



<a name="261372567"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/PR%20open%20to%20rust-lang/rust/near/261372567" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jubilee <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/PR.20open.20to.20rust-lang.2Frust.html#261372567">(Nov 13 2021 at 18:05)</a>:</h4>
<p>Yeah I had checked the commit and we had missed the cutoff point by a while.</p>



<a name="261379160"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/PR%20open%20to%20rust-lang/rust/near/261379160" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jubilee <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/PR.20open.20to.20rust-lang.2Frust.html#261379160">(Nov 13 2021 at 20:44)</a>:</h4>
<p>And thank you for everyone putting up with me asking one million questions and starting to <strong>lose my mind</strong>.</p>



<a name="261379180"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/PR%20open%20to%20rust-lang/rust/near/261379180" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jubilee <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/PR.20open.20to.20rust-lang.2Frust.html#261379180">(Nov 13 2021 at 20:45)</a>:</h4>
<p>Team work makes the dream work. \,,/</p>



<a name="261379954"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/PR%20open%20to%20rust-lang/rust/near/261379954" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Caleb Zulawski <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/PR.20open.20to.20rust-lang.2Frust.html#261379954">(Nov 13 2021 at 21:05)</a>:</h4>
<p>I just expanded the blog post with some examples, I think I've added all I wanted for now</p>



<a name="261392387"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/PR%20open%20to%20rust-lang/rust/near/261392387" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jubilee <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/PR.20open.20to.20rust-lang.2Frust.html#261392387">(Nov 14 2021 at 02:04)</a>:</h4>
<p>obligatory tweet <a href="https://twitter.com/workingjubilee/status/1459702038959251457">https://twitter.com/workingjubilee/status/1459702038959251457</a></p>
<div class="inline-preview-twitter"><div class="twitter-tweet"><a href="https://twitter.com/workingjubilee/status/1459702038959251457"><img class="twitter-avatar" src="https://uploads.zulipusercontent.net/b918d32b7ab0e274b678c4f5dfa1cb06074b0d52/68747470733a2f2f7062732e7477696d672e636f6d2f70726f66696c655f696d616765732f313335393238383834383733323138303438342f52675f333955665f5f6e6f726d616c2e6a7067"></a><p>Finally. <a href="https://t.co/RsSrv7ocsg">https://twitter.com/workingjubilee/status/1459702038959251457/photo/1</a></p><span>- future🦹jubilee (@workingjubilee)</span><div class="twitter-image"><a href="https://t.co/RsSrv7ocsg"><img src="https://uploads.zulipusercontent.net/e624258e2e69a88e954d9c4f7cb98c2efe44ae61/68747470733a2f2f7062732e7477696d672e636f6d2f6d656469612f4645486e524d4a566b41556b654d382e6a70673a7468756d62"></a></div></div></div>



<a name="261393426"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/PR%20open%20to%20rust-lang/rust/near/261393426" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Caleb Zulawski <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/PR.20open.20to.20rust-lang.2Frust.html#261393426">(Nov 14 2021 at 02:33)</a>:</h4>
<p>Nice</p>



<a name="261393475"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/PR%20open%20to%20rust-lang/rust/near/261393475" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Caleb Zulawski <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/PR.20open.20to.20rust-lang.2Frust.html#261393475">(Nov 14 2021 at 02:34)</a>:</h4>
<p>Did you happen to get a chance to look at the announcement?</p>



<a name="261393555"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/PR%20open%20to%20rust-lang/rust/near/261393555" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jubilee <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/PR.20open.20to.20rust-lang.2Frust.html#261393555">(Nov 14 2021 at 02:36)</a>:</h4>
<p>I did, and I am appreciating it, and my eyes are also slightly crosseyed.</p>



<a name="261393559"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/PR%20open%20to%20rust-lang/rust/near/261393559" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Caleb Zulawski <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/PR.20open.20to.20rust-lang.2Frust.html#261393559">(Nov 14 2021 at 02:36)</a>:</h4>
<p>Hahaha. That's a good start then</p>



<a name="261393562"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/PR%20open%20to%20rust-lang/rust/near/261393562" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Caleb Zulawski <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/PR.20open.20to.20rust-lang.2Frust.html#261393562">(Nov 14 2021 at 02:36)</a>:</h4>
<p>I'll take it</p>



<a name="261393718"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/PR%20open%20to%20rust-lang/rust/near/261393718" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jubilee <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/PR.20open.20to.20rust-lang.2Frust.html#261393718">(Nov 14 2021 at 02:40)</a>:</h4>
<p>Man, like it's good but also makes me wish <code>array_chunks</code> was in std. I wonder if it compiles the same anyways?</p>



<a name="261393781"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/PR%20open%20to%20rust-lang/rust/near/261393781" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Caleb Zulawski <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/PR.20open.20to.20rust-lang.2Frust.html#261393781">(Nov 14 2021 at 02:42)</a>:</h4>
<p>It depends if LLVM is smart enough to remove the slice length assert</p>



<a name="261393795"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/PR%20open%20to%20rust-lang/rust/near/261393795" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Caleb Zulawski <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/PR.20open.20to.20rust-lang.2Frust.html#261393795">(Nov 14 2021 at 02:43)</a>:</h4>
<p>when I was writing fourier transforms I found I generally needed to write custom iterators to do exactly what I wanted, so as far as the example goes I think <code>chunks</code> is probably fine for illustrating the point</p>



<a name="261394288"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/PR%20open%20to%20rust-lang/rust/near/261394288" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jubilee <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/PR.20open.20to.20rust-lang.2Frust.html#261394288">(Nov 14 2021 at 02:57)</a>:</h4>
<p>That's fair.</p>



<a name="261423369"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/PR%20open%20to%20rust-lang/rust/near/261423369" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Caleb Zulawski <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/PR.20open.20to.20rust-lang.2Frust.html#261423369">(Nov 14 2021 at 15:37)</a>:</h4>
<p>Good idea adding the feature gate to the example</p>



<a name="261423618"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/PR%20open%20to%20rust-lang/rust/near/261423618" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Caleb Zulawski <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/PR.20open.20to.20rust-lang.2Frust.html#261423618">(Nov 14 2021 at 15:44)</a>:</h4>
<p>I read it over again, looks good to me so just lmk and I can open the PR</p>



<a name="261423622"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/PR%20open%20to%20rust-lang/rust/near/261423622" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Caleb Zulawski <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/PR.20open.20to.20rust-lang.2Frust.html#261423622">(Nov 14 2021 at 15:44)</a>:</h4>
<p><span class="user-mention" data-user-id="229517">@Jacob Lifshay</span> if you want to read it over, too</p>



<a name="261430726"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/PR%20open%20to%20rust-lang/rust/near/261430726" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jacob Lifshay <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/PR.20open.20to.20rust-lang.2Frust.html#261430726">(Nov 14 2021 at 18:13)</a>:</h4>
<p>lgtm!</p>



<a name="261435846"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/PR%20open%20to%20rust-lang/rust/near/261435846" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jubilee <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/PR.20open.20to.20rust-lang.2Frust.html#261435846">(Nov 14 2021 at 20:07)</a>:</h4>
<p>considering if we want to explain design rationales a bit?</p>



<a name="261436009"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/PR%20open%20to%20rust-lang/rust/near/261436009" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jacob Lifshay <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/PR.20open.20to.20rust-lang.2Frust.html#261436009">(Nov 14 2021 at 20:10)</a>:</h4>
<p>hmm, if we're going to have design rationale, maybe we should just put that in portable-simd's docs and link to that?</p>



<a name="261436027"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/PR%20open%20to%20rust-lang/rust/near/261436027" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jacob Lifshay <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/PR.20open.20to.20rust-lang.2Frust.html#261436027">(Nov 14 2021 at 20:11)</a>:</h4>
<p>seems more useful that way, since that way it won't be a one-time thing</p>



<a name="261436093"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/PR%20open%20to%20rust-lang/rust/near/261436093" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jubilee <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/PR.20open.20to.20rust-lang.2Frust.html#261436093">(Nov 14 2021 at 20:12)</a>:</h4>
<p>eh, all design rationales are mutable over time.</p>



<a name="261436344"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/PR%20open%20to%20rust-lang/rust/near/261436344" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Caleb Zulawski <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/PR.20open.20to.20rust-lang.2Frust.html#261436344">(Nov 14 2021 at 20:19)</a>:</h4>
<p>Yeah, I was wondering if we should too</p>



<a name="261436351"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/PR%20open%20to%20rust-lang/rust/near/261436351" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Caleb Zulawski <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/PR.20open.20to.20rust-lang.2Frust.html#261436351">(Nov 14 2021 at 20:19)</a>:</h4>
<p>I agree that they're mutable and really just reflects our current mindset</p>



<a name="261436402"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/PR%20open%20to%20rust-lang/rust/near/261436402" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Caleb Zulawski <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/PR.20open.20to.20rust-lang.2Frust.html#261436402">(Nov 14 2021 at 20:20)</a>:</h4>
<p>What were you thinking we should add?</p>



<a name="261438583"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/PR%20open%20to%20rust-lang/rust/near/261438583" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jubilee <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/PR.20open.20to.20rust-lang.2Frust.html#261438583">(Nov 14 2021 at 21:12)</a>:</h4>
<p><a href="https://twitter.com/symeoncarle/status/1459865633542262784">https://twitter.com/symeoncarle/status/1459865633542262784</a> we should clearly change the character we use for the type aliases just because everyone thinks it is that.</p>
<div class="inline-preview-twitter"><div class="twitter-tweet"><a href="https://twitter.com/symeoncarle/status/1459865633542262784"><img class="twitter-avatar" src="https://uploads.zulipusercontent.net/3d5c0584d6fe48722da5ba504f8006eba1647d1b/68747470733a2f2f7062732e7477696d672e636f6d2f70726f66696c655f696d616765732f313430373335323933343231323535303636362f34483768325062785f6e6f726d616c2e6a7067"></a><p><a href="https://twitter.com/workingjubilee">@workingjubilee</a> <a href="https://twitter.com/fasterthanlime">@fasterthanlime</a> <a href="https://t.co/QmaH0ChESc">https://twitter.com/symeoncarle/status/1459865633542262784/photo/1</a></p><span>- Syméon Carle (@symeoncarle)</span><div class="twitter-image"><a href="https://t.co/QmaH0ChESc"><img src="https://uploads.zulipusercontent.net/cf708644b3436d7d2815ce032995e6be0823c9e5/68747470733a2f2f7062732e7477696d672e636f6d2f6d656469612f46454a3844436d5877417770365f422e6a70673a7468756d62"></a></div></div></div>



<a name="261443077"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/PR%20open%20to%20rust-lang/rust/near/261443077" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Caleb Zulawski <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/PR.20open.20to.20rust-lang.2Frust.html#261443077">(Nov 14 2021 at 23:03)</a>:</h4>
<p>lol, i'll get right on that</p>



<a name="261444064"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/PR%20open%20to%20rust-lang/rust/near/261444064" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Caleb Zulawski <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/PR.20open.20to.20rust-lang.2Frust.html#261444064">(Nov 14 2021 at 23:22)</a>:</h4>
<p><span class="user-mention" data-user-id="281757">@Jubilee</span> regarding design rationale, I just added the single sentence</p>
<blockquote>
<p>This design allows SIMD vectors to be treated like containers, much like arrays or <code>Vec</code>.</p>
</blockquote>



<a name="261444109"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/PR%20open%20to%20rust-lang/rust/near/261444109" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Caleb Zulawski <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/PR.20open.20to.20rust-lang.2Frust.html#261444109">(Nov 14 2021 at 23:23)</a>:</h4>
<p>I think that mostly sums up our design principles, I'm just not sure if that's the right way of phrasing it</p>



<a name="261445421"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/PR%20open%20to%20rust-lang/rust/near/261445421" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jubilee <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/PR.20open.20to.20rust-lang.2Frust.html#261445421">(Nov 14 2021 at 23:55)</a>:</h4>
<p>Yeah, our <code>Simd</code> type is essentially an array that you can interact with like it is a "single" number.</p>



<a name="261447476"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/PR%20open%20to%20rust-lang/rust/near/261447476" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Caleb Zulawski <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/PR.20open.20to.20rust-lang.2Frust.html#261447476">(Nov 15 2021 at 00:45)</a>:</h4>
<p>anything else you think should be added?</p>



<a name="261491190"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/PR%20open%20to%20rust-lang/rust/near/261491190" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jubilee <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/PR.20open.20to.20rust-lang.2Frust.html#261491190">(Nov 15 2021 at 12:38)</a>:</h4>
<p>Question I am seeing: "does this work for ${target}?"</p>



<a name="261491244"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/PR%20open%20to%20rust-lang/rust/near/261491244" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Caleb Zulawski <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/PR.20open.20to.20rust-lang.2Frust.html#261491244">(Nov 15 2021 at 12:39)</a>:</h4>
<p>Hmm I thought that was implied...</p>



<a name="261491853"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/PR%20open%20to%20rust-lang/rust/near/261491853" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jubilee <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/PR.20open.20to.20rust-lang.2Frust.html#261491853">(Nov 15 2021 at 12:46)</a>:</h4>
<p>I think people may have a legitimate question like<br>
"Wait, how would it work for ${TARGET_WITHOUT_SIMD_ISA}?"</p>



<a name="261491876"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/PR%20open%20to%20rust-lang/rust/near/261491876" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Caleb Zulawski <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/PR.20open.20to.20rust-lang.2Frust.html#261491876">(Nov 15 2021 at 12:47)</a>:</h4>
<p>That's true</p>



<a name="261511033"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/PR%20open%20to%20rust-lang/rust/near/261511033" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Caleb Zulawski <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/PR.20open.20to.20rust-lang.2Frust.html#261511033">(Nov 15 2021 at 15:19)</a>:</h4>
<p><span class="user-mention" data-user-id="281757">@Jubilee</span> I rearranged and added a little bit to explain what portable means</p>



<a name="261559351"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/PR%20open%20to%20rust-lang/rust/near/261559351" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jubilee <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/PR.20open.20to.20rust-lang.2Frust.html#261559351">(Nov 15 2021 at 21:09)</a>:</h4>
<p><span class="user-mention" data-user-id="312331">@Caleb Zulawski</span> pong, I added some deets.</p>



<a name="261559604"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/PR%20open%20to%20rust-lang/rust/near/261559604" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jubilee <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/PR.20open.20to.20rust-lang.2Frust.html#261559604">(Nov 15 2021 at 21:11)</a>:</h4>
<p>basically FAQing what people are tweeting at me</p>



<a name="261559645"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/PR%20open%20to%20rust-lang/rust/near/261559645" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jacob Lifshay <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/PR.20open.20to.20rust-lang.2Frust.html#261559645">(Nov 15 2021 at 21:11)</a>:</h4>
<p>mind splitting out the blog stuff into a separate zulip topic? it'll make it much easier to find</p>



<a name="261560183"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/PR%20open%20to%20rust-lang/rust/near/261560183" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Caleb Zulawski <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/PR.20open.20to.20rust-lang.2Frust.html#261560183">(Nov 15 2021 at 21:15)</a>:</h4>
<p><span class="user-mention" data-user-id="281757">@Jubilee</span> do you mind if I add some of what you added into the what is portable section?  I think it's a little repetitive as it stands now</p>



<a name="261560277"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/PR%20open%20to%20rust-lang/rust/near/261560277" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jubilee <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/PR.20open.20to.20rust-lang.2Frust.html#261560277">(Nov 15 2021 at 21:16)</a>:</h4>
<p>Yes, please feel free to revise it, <span class="user-mention" data-user-id="312331">@Caleb Zulawski</span></p>



<a name="261563760"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/PR%20open%20to%20rust-lang/rust/near/261563760" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Caleb Zulawski <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/PR.20open.20to.20rust-lang.2Frust.html#261563760">(Nov 15 2021 at 21:44)</a>:</h4>
<p>Okay <span class="user-mention" data-user-id="281757">@Jubilee</span>, I made some changes</p>



<a name="261563783"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/PR%20open%20to%20rust-lang/rust/near/261563783" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Caleb Zulawski <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/PR.20open.20to.20rust-lang.2Frust.html#261563783">(Nov 15 2021 at 21:44)</a>:</h4>
<p>I tried to integrate what you added into the existing paragraphs</p>



<a name="261563854"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/PR%20open%20to%20rust-lang/rust/near/261563854" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Caleb Zulawski <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/PR.20open.20to.20rust-lang.2Frust.html#261563854">(Nov 15 2021 at 21:45)</a>:</h4>
<p>I also removed some of the things about optimization and LLVM representation because I think it was a little too specific, since we want this API to work with any backend anyway</p>



<a name="261563899"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/PR%20open%20to%20rust-lang/rust/near/261563899" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Caleb Zulawski <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/PR.20open.20to.20rust-lang.2Frust.html#261563899">(Nov 15 2021 at 21:45)</a>:</h4>
<p>I kind of rephrased that to say sometimes you may just need specific target instructions</p>



<hr><p>Last updated: Apr 12 2022 at 20:01 UTC</p>
</html>