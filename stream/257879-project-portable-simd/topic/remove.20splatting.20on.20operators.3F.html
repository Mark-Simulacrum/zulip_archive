<html>
<head><meta charset="utf-8"><title>remove splatting on operators? · project-portable-simd · Zulip Chat Archive</title></head>
<h2>Stream: <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/index.html">project-portable-simd</a></h2>
<h3>Topic: <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/remove.20splatting.20on.20operators.3F.html">remove splatting on operators?</a></h3>

<hr>

<base href="https://rust-lang.zulipchat.com">

<head><link href="https://zulip-archive.rust-lang.org/style.css" rel="stylesheet"></head>

<a name="262023960"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/remove%20splatting%20on%20operators%3F/near/262023960" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jubilee <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/remove.20splatting.20on.20operators.3F.html#262023960">(Nov 19 2021 at 03:50)</a>:</h4>
<p>Oh, the other reason LHS splatting is a touch odd goes for both commutative ops and non-commutative ops. Because we can't do</p>
<div class="codehilite" data-code-language="Rust"><pre><span></span><code><span class="n">scalar</span><span class="w"> </span><span class="o">/=</span><span class="w"> </span><span class="n">vector</span><span class="p">;</span><span class="w"></span>
</code></pre></div>



<a name="262023969"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/remove%20splatting%20on%20operators%3F/near/262023969" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Caleb Zulawski <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/remove.20splatting.20on.20operators.3F.html#262023969">(Nov 19 2021 at 03:50)</a>:</h4>
<p>yep</p>



<a name="262024046"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/remove%20splatting%20on%20operators%3F/near/262024046" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jubilee <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/remove.20splatting.20on.20operators.3F.html#262024046">(Nov 19 2021 at 03:52)</a>:</h4>
<p>So, while I am not in favor of removing LHS splatting entirely, reserving implicit splatting on the LHS for the commutative cases seems fine for discouraging the habit.</p>



<a name="262024057"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/remove%20splatting%20on%20operators%3F/near/262024057" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Caleb Zulawski <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/remove.20splatting.20on.20operators.3F.html#262024057">(Nov 19 2021 at 03:53)</a>:</h4>
<p>I feel like it's odd if you can only splat on the rhs</p>



<a name="262024070"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/remove%20splatting%20on%20operators%3F/near/262024070" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Caleb Zulawski <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/remove.20splatting.20on.20operators.3F.html#262024070">(Nov 19 2021 at 03:53)</a>:</h4>
<p>well, or should I say, I think it's more odd, both are odd</p>



<a name="262024093"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/remove%20splatting%20on%20operators%3F/near/262024093" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jubilee <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/remove.20splatting.20on.20operators.3F.html#262024093">(Nov 19 2021 at 03:54)</a>:</h4>
<p>Also: there are apparently type inference special casings in the Rust compiler for the lhs of <code>&lt;&lt;</code> and <code>&gt;&gt;</code>.</p>



<a name="262024154"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/remove%20splatting%20on%20operators%3F/near/262024154" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Caleb Zulawski <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/remove.20splatting.20on.20operators.3F.html#262024154">(Nov 19 2021 at 03:55)</a>:</h4>
<p>woo</p>



<a name="262024156"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/remove%20splatting%20on%20operators%3F/near/262024156" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jacob Lifshay <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/remove.20splatting.20on.20operators.3F.html#262024156">(Nov 19 2021 at 03:55)</a>:</h4>
<p>well....we could add more...</p>



<a name="262024160"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/remove%20splatting%20on%20operators%3F/near/262024160" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jacob Lifshay <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/remove.20splatting.20on.20operators.3F.html#262024160">(Nov 19 2021 at 03:55)</a>:</h4>
<p>or not</p>



<a name="262024238"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/remove%20splatting%20on%20operators%3F/near/262024238" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jacob Lifshay <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/remove.20splatting.20on.20operators.3F.html#262024238">(Nov 19 2021 at 03:57)</a>:</h4>
<p>one idea is to just not have splatting on operators, kinda like we don't have automatic int-&gt;float on operators</p>



<a name="262024345"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/remove%20splatting%20on%20operators%3F/near/262024345" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jacob Lifshay <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/remove.20splatting.20on.20operators.3F.html#262024345">(Nov 19 2021 at 03:59)</a>:</h4>
<p>it would greatly simplify implementing all the operator overloads we need</p>



<a name="262024361"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/remove%20splatting%20on%20operators%3F/near/262024361" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jacob Lifshay <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/remove.20splatting.20on.20operators.3F.html#262024361">(Nov 19 2021 at 03:59)</a>:</h4>
<p>cuz both lhs and rhs would be <code>Simd</code></p>



<a name="262024703"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/remove%20splatting%20on%20operators%3F/near/262024703" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jubilee <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/remove.20splatting.20on.20operators.3F.html#262024703">(Nov 19 2021 at 04:05)</a>:</h4>
<p>I think that's probably a bit much when often even assembly instruction sets overload vector addition for the rhs.<br>
No joke.</p>



<a name="262024798"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/remove%20splatting%20on%20operators%3F/near/262024798" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jacob Lifshay <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/remove.20splatting.20on.20operators.3F.html#262024798">(Nov 19 2021 at 04:06)</a>:</h4>
<p>well, assembly overloads cuz of speed, not cuz of ease of use</p>



<a name="262024887"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/remove%20splatting%20on%20operators%3F/near/262024887" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jubilee <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/remove.20splatting.20on.20operators.3F.html#262024887">(Nov 19 2021 at 04:08)</a>:</h4>
<p>Mmmh. The assembly language is encoding many slightly different instructions with the same name too.</p>



<a name="262024895"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/remove%20splatting%20on%20operators%3F/near/262024895" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Caleb Zulawski <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/remove.20splatting.20on.20operators.3F.html#262024895">(Nov 19 2021 at 04:09)</a>:</h4>
<p>I'm now imagining and chuckling about the person designing a commercial instruction set who's concerned about ease of use</p>



<a name="262024908"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/remove%20splatting%20on%20operators%3F/near/262024908" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jacob Lifshay <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/remove.20splatting.20on.20operators.3F.html#262024908">(Nov 19 2021 at 04:09)</a>:</h4>
<p>depends on the architecture, e.g. riscv has the mnemonic change</p>



<a name="262024922"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/remove%20splatting%20on%20operators%3F/near/262024922" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jacob Lifshay <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/remove.20splatting.20on.20operators.3F.html#262024922">(Nov 19 2021 at 04:09)</a>:</h4>
<blockquote>
<p>I'm now imagining and chuckling about the person designing a commercial instruction set who's concerned about ease of use</p>
</blockquote>
<p>you mean VAX?</p>



<a name="262024988"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/remove%20splatting%20on%20operators%3F/near/262024988" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jacob Lifshay <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/remove.20splatting.20on.20operators.3F.html#262024988">(Nov 19 2021 at 04:11)</a>:</h4>
<p>VAX is famously orthogonal, at the cost of cpu complexity and speed</p>



<a name="262024989"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/remove%20splatting%20on%20operators%3F/near/262024989" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jubilee <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/remove.20splatting.20on.20operators.3F.html#262024989">(Nov 19 2021 at 04:11)</a>:</h4>
<p>I mean, my impression is that,<br>
without offense intended,<br>
a lot of RISCV's proposals have a lot of design input from the Unix greybeard type,<br>
and we know what their tastes tend to be like.</p>



<a name="262025041"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/remove%20splatting%20on%20operators%3F/near/262025041" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jacob Lifshay <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/remove.20splatting.20on.20operators.3F.html#262025041">(Nov 19 2021 at 04:12)</a>:</h4>
<p>well, lots of other isas also have similar mnemonic changes too...</p>



<a name="262025057"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/remove%20splatting%20on%20operators%3F/near/262025057" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jubilee <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/remove.20splatting.20on.20operators.3F.html#262025057">(Nov 19 2021 at 04:12)</a>:</h4>
<p>Yes, but they tend to have more things live under the same mnemonic.</p>



<a name="262025072"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/remove%20splatting%20on%20operators%3F/near/262025072" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jacob Lifshay <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/remove.20splatting.20on.20operators.3F.html#262025072">(Nov 19 2021 at 04:13)</a>:</h4>
<p>reminds me of <code>mov[bwlq]</code> in x86 at&amp;t syntax</p>



<a name="262025143"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/remove%20splatting%20on%20operators%3F/near/262025143" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jubilee <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/remove.20splatting.20on.20operators.3F.html#262025143">(Nov 19 2021 at 04:14)</a>:</h4>
<p>Right, from the RISC view, Intel's <code>mov</code> is overloading load and store to begin with. <span aria-label="laughing" class="emoji emoji-1f606" role="img" title="laughing">:laughing:</span></p>



<a name="262025156"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/remove%20splatting%20on%20operators%3F/near/262025156" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jacob Lifshay <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/remove.20splatting.20on.20operators.3F.html#262025156">(Nov 19 2021 at 04:15)</a>:</h4>
<p>simplev has registers suffixed with <code>.s</code> and <code>.v</code> to select between scalar (splatted) and vector</p>



<a name="262025158"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/remove%20splatting%20on%20operators%3F/near/262025158" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Caleb Zulawski <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/remove.20splatting.20on.20operators.3F.html#262025158">(Nov 19 2021 at 04:15)</a>:</h4>
<p>I think from the risc view, mov is overloading basically everything</p>



<a name="262025169"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/remove%20splatting%20on%20operators%3F/near/262025169" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jacob Lifshay <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/remove.20splatting.20on.20operators.3F.html#262025169">(Nov 19 2021 at 04:15)</a>:</h4>
<p>e.g. <code>sv.add r30.v, r80.s, r100.v</code></p>



<a name="262025214"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/remove%20splatting%20on%20operators%3F/near/262025214" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jubilee <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/remove.20splatting.20on.20operators.3F.html#262025214">(Nov 19 2021 at 04:16)</a>:</h4>
<p><a href="https://github.com/Battelle/movfuscator">https://github.com/Battelle/movfuscator</a> literally, <span class="user-mention" data-user-id="312331">@Caleb Zulawski</span> ?</p>



<a name="262025224"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/remove%20splatting%20on%20operators%3F/near/262025224" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Caleb Zulawski <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/remove.20splatting.20on.20operators.3F.html#262025224">(Nov 19 2021 at 04:16)</a>:</h4>
<p>exactly what I was thinking about haha</p>



<a name="262025226"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/remove%20splatting%20on%20operators%3F/near/262025226" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Caleb Zulawski <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/remove.20splatting.20on.20operators.3F.html#262025226">(Nov 19 2021 at 04:16)</a>:</h4>
<p>considering you can even jump with faults</p>



<a name="262025257"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/remove%20splatting%20on%20operators%3F/near/262025257" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jacob Lifshay <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/remove.20splatting.20on.20operators.3F.html#262025257">(Nov 19 2021 at 04:17)</a>:</h4>
<p>oh, i was just going to find the movfuscstor link, you're faster than I</p>



<a name="262025319"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/remove%20splatting%20on%20operators%3F/near/262025319" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jacob Lifshay <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/remove.20splatting.20on.20operators.3F.html#262025319">(Nov 19 2021 at 04:18)</a>:</h4>
<p>though, realistically, there are whole cpus that support only the mov instruction</p>



<a name="262025345"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/remove%20splatting%20on%20operators%3F/near/262025345" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jacob Lifshay <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/remove.20splatting.20on.20operators.3F.html#262025345">(Nov 19 2021 at 04:19)</a>:</h4>
<p><a href="https://en.wikipedia.org/wiki/Transport_triggered_architecture">https://en.wikipedia.org/wiki/Transport_triggered_architecture</a></p>



<a name="262025406"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/remove%20splatting%20on%20operators%3F/near/262025406" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jacob Lifshay <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/remove.20splatting.20on.20operators.3F.html#262025406">(Nov 19 2021 at 04:20)</a>:</h4>
<p>I built one once, i got it to run a linear congruential random number generator</p>



<a name="262025440"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/remove%20splatting%20on%20operators%3F/near/262025440" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jacob Lifshay <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/remove.20splatting.20on.20operators.3F.html#262025440">(Nov 19 2021 at 04:21)</a>:</h4>
<p>and, unlike x86, it is <em>only</em> moving, no fancy address calculations</p>



<a name="262072805"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/remove%20splatting%20on%20operators%3F/near/262072805" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lokathor <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/remove.20splatting.20on.20operators.3F.html#262072805">(Nov 19 2021 at 14:28)</a>:</h4>
<p>I suggest we keep auto-splat for add and mul, but not sub and div</p>



<a name="262091225"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/remove%20splatting%20on%20operators%3F/near/262091225" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Thom Chiovoloni <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/remove.20splatting.20on.20operators.3F.html#262091225">(Nov 19 2021 at 16:34)</a>:</h4>
<p>that seems pretty odd on its own, tbh. i kind of feel like the autosplat isn't particularly idiomatic for rust (which generally requires explicit conversions in many places), but it is very convenient</p>



<a name="262091832"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/remove%20splatting%20on%20operators%3F/near/262091832" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jacob Lifshay <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/remove.20splatting.20on.20operators.3F.html#262091832">(Nov 19 2021 at 16:38)</a>:</h4>
<p>imho, if we have autosplat on any of the arithmetic/logical operators, we should have it on all.</p>



<a name="262092193"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/remove%20splatting%20on%20operators%3F/near/262092193" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Caleb Zulawski <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/remove.20splatting.20on.20operators.3F.html#262092193">(Nov 19 2021 at 16:41)</a>:</h4>
<p>Agreed</p>



<a name="262093475"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/remove%20splatting%20on%20operators%3F/near/262093475" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jacob Lifshay <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/remove.20splatting.20on.20operators.3F.html#262093475">(Nov 19 2021 at 16:49)</a>:</h4>
<p>maybe if we introduced a <code>Splat</code> trait and/or global function, splatting would be sufficiently ergonomic without needing autosplatting:<br>
either (or both):</p>
<div class="codehilite" data-code-language="Rust"><pre><span></span><code><span class="k">use</span><span class="w"> </span><span class="n">core</span>::<span class="n">simd</span>::<span class="p">{</span><span class="n">splat</span><span class="p">,</span><span class="w"> </span><span class="n">f32x4</span><span class="p">};</span><span class="w"></span>

<span class="k">pub</span><span class="w"> </span><span class="k">fn</span> <span class="nf">my_fn</span><span class="p">(</span><span class="n">a</span>: <span class="kt">f32</span><span class="p">,</span><span class="w"> </span><span class="n">b</span>: <span class="nc">f32x4</span><span class="p">,</span><span class="w"> </span><span class="n">c</span>: <span class="kt">f32</span><span class="p">)</span><span class="w"> </span>-&gt; <span class="nc">f32x4</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="n">splat</span><span class="p">(</span><span class="n">a</span><span class="p">)</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="n">b</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">splat</span><span class="p">(</span><span class="n">c</span><span class="p">)</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>
</code></pre></div>
<p>and/or:</p>
<div class="codehilite" data-code-language="Rust"><pre><span></span><code><span class="k">use</span><span class="w"> </span><span class="n">core</span>::<span class="n">simd</span>::<span class="p">{</span><span class="n">Splat</span><span class="p">,</span><span class="w"> </span><span class="n">f32x4</span><span class="p">};</span><span class="w"></span>

<span class="k">pub</span><span class="w"> </span><span class="k">fn</span> <span class="nf">my_fn</span><span class="p">(</span><span class="n">a</span>: <span class="kt">f32</span><span class="p">,</span><span class="w"> </span><span class="n">b</span>: <span class="nc">f32x4</span><span class="p">,</span><span class="w"> </span><span class="n">c</span>: <span class="kt">f32</span><span class="p">)</span><span class="w"> </span>-&gt; <span class="nc">f32x4</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="n">a</span><span class="p">.</span><span class="n">splat</span><span class="p">()</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="n">b</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">c</span><span class="p">.</span><span class="n">splat</span><span class="p">()</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>
</code></pre></div>



<a name="262093653"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/remove%20splatting%20on%20operators%3F/near/262093653" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Caleb Zulawski <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/remove.20splatting.20on.20operators.3F.html#262093653">(Nov 19 2021 at 16:50)</a>:</h4>
<p>Well, right now it's as trivial as calling Simd::splat, I think type inference is the issue</p>



<a name="262093798"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/remove%20splatting%20on%20operators%3F/near/262093798" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jacob Lifshay <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/remove.20splatting.20on.20operators.3F.html#262093798">(Nov 19 2021 at 16:51)</a>:</h4>
<p>k, though imho <code>Simd::splat</code> is still kinda long to put everywhere, <code>splat</code> is much shorter</p>



<a name="262094516"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/remove%20splatting%20on%20operators%3F/near/262094516" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lokathor <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/remove.20splatting.20on.20operators.3F.html#262094516">(Nov 19 2021 at 16:55)</a>:</h4>
<p>yeah if i have to type :: even once in my code I'm already upset</p>



<a name="262099577"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/remove%20splatting%20on%20operators%3F/near/262099577" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jacob Lifshay <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/remove.20splatting.20on.20operators.3F.html#262099577">(Nov 19 2021 at 17:29)</a>:</h4>
<p>hmm, i didn't see any type inference issues <a href="https://play.rust-lang.org/?version=stable&amp;mode=debug&amp;edition=2021&amp;gist=d1705a9517aacc38802e74dfc000e20a">https://play.rust-lang.org/?version=stable&amp;mode=debug&amp;edition=2021&amp;gist=d1705a9517aacc38802e74dfc000e20a</a> -- <span class="user-mention" data-user-id="312331">@Caleb Zulawski</span> have any demos?</p>



<a name="262099731"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/remove%20splatting%20on%20operators%3F/near/262099731" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Caleb Zulawski <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/remove.20splatting.20on.20operators.3F.html#262099731">(Nov 19 2021 at 17:30)</a>:</h4>
<p>Nope, I was just recalling what happened in the past when we last discussed it</p>



<a name="262100356"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/remove%20splatting%20on%20operators%3F/near/262100356" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jacob Lifshay <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/remove.20splatting.20on.20operators.3F.html#262100356">(Nov 19 2021 at 17:35)</a>:</h4>
<p><a href="https://github.com/rust-lang/portable-simd/pull/10#issuecomment-701658659">https://github.com/rust-lang/portable-simd/pull/10#issuecomment-701658659</a></p>



<a name="262100535"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/remove%20splatting%20on%20operators%3F/near/262100535" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jacob Lifshay <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/remove.20splatting.20on.20operators.3F.html#262100535">(Nov 19 2021 at 17:36)</a>:</h4>
<p>from what I can tell, the issue was with using <code>.into()</code>, imho <code>splat</code> shouldn't have that problem cuz it's less general -- the output type is tied to the input type.</p>



<a name="262100597"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/remove%20splatting%20on%20operators%3F/near/262100597" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Caleb Zulawski <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/remove.20splatting.20on.20operators.3F.html#262100597">(Nov 19 2021 at 17:36)</a>:</h4>
<p>Oh, yeah, that makes sense</p>



<a name="262101212"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/remove%20splatting%20on%20operators%3F/near/262101212" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jacob Lifshay <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/remove.20splatting.20on.20operators.3F.html#262101212">(Nov 19 2021 at 17:41)</a>:</h4>
<p>if <code>splat</code> is too wordy, maybe we could come up with some shorthand function name? <code>sv</code> (splat vector);  <code>ss</code> (splat simd);  <code>simd</code>?</p>



<a name="262101496"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/remove%20splatting%20on%20operators%3F/near/262101496" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jacob Lifshay <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/remove.20splatting.20on.20operators.3F.html#262101496">(Nov 19 2021 at 17:43)</a>:</h4>
<p>maybe we could add <code>1.23_f32x4</code> and <code>1.23_f32xN</code> literals?</p>



<a name="262101499"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/remove%20splatting%20on%20operators%3F/near/262101499" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Caleb Zulawski <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/remove.20splatting.20on.20operators.3F.html#262101499">(Nov 19 2021 at 17:43)</a>:</h4>
<p>I think you're going in the opposite direction from me, not only am I not concerned about wordiness, I think a free function rather than an associated function on Simd is odd</p>



<a name="262101774"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/remove%20splatting%20on%20operators%3F/near/262101774" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jacob Lifshay <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/remove.20splatting.20on.20operators.3F.html#262101774">(Nov 19 2021 at 17:44)</a>:</h4>
<p>imho we need something more ergonomic than <code>Simd::splat</code> everywhere -- that's just too long, splatting is a very common operation</p>



<a name="262101967"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/remove%20splatting%20on%20operators%3F/near/262101967" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jacob Lifshay <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/remove.20splatting.20on.20operators.3F.html#262101967">(Nov 19 2021 at 17:46)</a>:</h4>
<p>maybe Rust could gain support for <code>use core::simd::Simd::splat;</code></p>



<a name="262102152"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/remove%20splatting%20on%20operators%3F/near/262102152" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jacob Lifshay <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/remove.20splatting.20on.20operators.3F.html#262102152">(Nov 19 2021 at 17:47)</a>:</h4>
<p>i'm not against also having an associated function</p>



<a name="262102986"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/remove%20splatting%20on%20operators%3F/near/262102986" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jacob Lifshay <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/remove.20splatting.20on.20operators.3F.html#262102986">(Nov 19 2021 at 17:52)</a>:</h4>
<p>maybe we should add Simd splatting/casting to <code>as</code></p>



<a name="262103059"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/remove%20splatting%20on%20operators%3F/near/262103059" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Thom Chiovoloni <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/remove.20splatting.20on.20operators.3F.html#262103059">(Nov 19 2021 at 17:53)</a>:</h4>
<p>as is so unpopular i doubt this would go over well</p>



<a name="262103076"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/remove%20splatting%20on%20operators%3F/near/262103076" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jacob Lifshay <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/remove.20splatting.20on.20operators.3F.html#262103076">(Nov 19 2021 at 17:53)</a>:</h4>
<p>k</p>



<a name="262109111"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/remove%20splatting%20on%20operators%3F/near/262109111" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jubilee <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/remove.20splatting.20on.20operators.3F.html#262109111">(Nov 19 2021 at 18:35)</a>:</h4>
<p><code>as</code> is <strong>desperately</strong> unpopular and basically being aimed at for "removed from the language entirely".</p>



<a name="262119883"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/remove%20splatting%20on%20operators%3F/near/262119883" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jubilee <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/remove.20splatting.20on.20operators.3F.html#262119883">(Nov 19 2021 at 19:47)</a>:</h4>
<p>Anyways, I don't see any need to preserve symmetry across all arithmetic operators because not all arithmetic operators are symmetric.</p>



<a name="262120191"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/remove%20splatting%20on%20operators%3F/near/262120191" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Thom Chiovoloni <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/remove.20splatting.20on.20operators.3F.html#262120191">(Nov 19 2021 at 19:49)</a>:</h4>
<p>thats true, but a lot of users think of the math operators as "two numbers in, math stuff happens, number out"</p>



<a name="262120214"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/remove%20splatting%20on%20operators%3F/near/262120214" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Thom Chiovoloni <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/remove.20splatting.20on.20operators.3F.html#262120214">(Nov 19 2021 at 19:49)</a>:</h4>
<p>which appears symmetric if you squint</p>



<a name="262120216"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/remove%20splatting%20on%20operators%3F/near/262120216" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jacob Lifshay <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/remove.20splatting.20on.20operators.3F.html#262120216">(Nov 19 2021 at 19:49)</a>:</h4>
<p>i'd be ok if we decided to just splat on the lhs or rhs of operators, but we shouldn't have splat on just <code>+</code> and <code>*</code> but not <code>-</code> and <code>/</code></p>



<a name="262120379"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/remove%20splatting%20on%20operators%3F/near/262120379" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Thom Chiovoloni <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/remove.20splatting.20on.20operators.3F.html#262120379">(Nov 19 2021 at 19:50)</a>:</h4>
<p>the asymmetry of + on String is a constant source of confusion with beginners tbh, i dont think we should repeat that</p>



<a name="262120405"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/remove%20splatting%20on%20operators%3F/near/262120405" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Thom Chiovoloni <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/remove.20splatting.20on.20operators.3F.html#262120405">(Nov 19 2021 at 19:50)</a>:</h4>
<p>without a very good reason anyway (perhaps strings reason is good enough)</p>



<a name="262120478"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/remove%20splatting%20on%20operators%3F/near/262120478" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jacob Lifshay <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/remove.20splatting.20on.20operators.3F.html#262120478">(Nov 19 2021 at 19:51)</a>:</h4>
<p>splatting should be all or nothing when looking at what happens across the dimension of arithmetic/logical operators</p>



<a name="262120630"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/remove%20splatting%20on%20operators%3F/near/262120630" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Thom Chiovoloni <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/remove.20splatting.20on.20operators.3F.html#262120630">(Nov 19 2021 at 19:52)</a>:</h4>
<p>i just meant the rhs/lhs dependence</p>



<a name="262120675"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/remove%20splatting%20on%20operators%3F/near/262120675" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jacob Lifshay <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/remove.20splatting.20on.20operators.3F.html#262120675">(Nov 19 2021 at 19:52)</a>:</h4>
<p>yup, i'm describing an orthogonal issue</p>



<a name="262120957"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/remove%20splatting%20on%20operators%3F/near/262120957" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jacob Lifshay <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/remove.20splatting.20on.20operators.3F.html#262120957">(Nov 19 2021 at 19:54)</a>:</h4>
<p>tbh i was mildly surprised when I first read our source code and saw that splatting was used, I thought "I thought Rust didn't do automatic type conversion in operators?!"</p>



<a name="262121073"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/remove%20splatting%20on%20operators%3F/near/262121073" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jubilee <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/remove.20splatting.20on.20operators.3F.html#262121073">(Nov 19 2021 at 19:55)</a>:</h4>
<blockquote>
<p>It is not a great amount of simplification, and having to manually splat everywhere makes reading the resulting code more complicated. Comparing it to the absence of numeric promotion is a false analogy, as the lanewise behavior does not vary, whereas numeric promotion does change lanewise behavior.</p>
</blockquote>



<a name="262121224"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/remove%20splatting%20on%20operators%3F/near/262121224" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Thom Chiovoloni <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/remove.20splatting.20on.20operators.3F.html#262121224">(Nov 19 2021 at 19:56)</a>:</h4>
<p>if we lose autosplatting, i suspect most of the inference errors related to simd in non-simd code will go away too</p>



<a name="262121282"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/remove%20splatting%20on%20operators%3F/near/262121282" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jubilee <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/remove.20splatting.20on.20operators.3F.html#262121282">(Nov 19 2021 at 19:57)</a>:</h4>
<p><strong>That</strong> would probably be worth it, tbh.</p>



<a name="262121608"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/remove%20splatting%20on%20operators%3F/near/262121608" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Caleb Zulawski <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/remove.20splatting.20on.20operators.3F.html#262121608">(Nov 19 2021 at 19:59)</a>:</h4>
<p>I'm okay with either no autosplatting, or every operation does</p>



<a name="262121787"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/remove%20splatting%20on%20operators%3F/near/262121787" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Caleb Zulawski <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/remove.20splatting.20on.20operators.3F.html#262121787">(Nov 19 2021 at 20:00)</a>:</h4>
<p>I'm leaning towards none with that argument, and because of the complexity of the bounds on it</p>



<a name="262122445"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/remove%20splatting%20on%20operators%3F/near/262122445" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jubilee <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/remove.20splatting.20on.20operators.3F.html#262122445">(Nov 19 2021 at 20:05)</a>:</h4>
<p>I am against any decisionmaking on "the complexity of the bounds", that's complexity we're asked to take up, not push onto our users.</p>



<a name="262122585"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/remove%20splatting%20on%20operators%3F/near/262122585" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Caleb Zulawski <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/remove.20splatting.20on.20operators.3F.html#262122585">(Nov 19 2021 at 20:06)</a>:</h4>
<p>I just meant that the trait implementations literally have very complex bounds, which is maybe indicating a deeper issue</p>



<a name="262122612"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/remove%20splatting%20on%20operators%3F/near/262122612" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jacob Lifshay <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/remove.20splatting.20on.20operators.3F.html#262122612">(Nov 19 2021 at 20:06)</a>:</h4>
<p>those bounds propagate to user code that wants to be generic...so the complexity is a somewhat significant issue</p>



<a name="262122673"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/remove%20splatting%20on%20operators%3F/near/262122673" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Thom Chiovoloni <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/remove.20splatting.20on.20operators.3F.html#262122673">(Nov 19 2021 at 20:07)</a>:</h4>
<p>inferred bounds will probably eventually get here in some form or another, supposedly</p>



<a name="262122828"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/remove%20splatting%20on%20operators%3F/near/262122828" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jubilee <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/remove.20splatting.20on.20operators.3F.html#262122828">(Nov 19 2021 at 20:08)</a>:</h4>
<p>User code that wants to be generic doesn't want these shitty bounds that we foist on users, it wants something higher level like <code>Int</code> or <code>UInt</code>, As I Keep Saying.</p>



<a name="262122842"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/remove%20splatting%20on%20operators%3F/near/262122842" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jacob Lifshay <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/remove.20splatting.20on.20operators.3F.html#262122842">(Nov 19 2021 at 20:08)</a>:</h4>
<p>hmm, not sure we'd want code to infer all the bounds...</p>



<a name="262122929"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/remove%20splatting%20on%20operators%3F/near/262122929" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jacob Lifshay <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/remove.20splatting.20on.20operators.3F.html#262122929">(Nov 19 2021 at 20:09)</a>:</h4>
<p>maybe this is our cue to merge num-traits back into std?</p>



<a name="262122944"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/remove%20splatting%20on%20operators%3F/near/262122944" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jubilee <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/remove.20splatting.20on.20operators.3F.html#262122944">(Nov 19 2021 at 20:09)</a>:</h4>
<p>It is precisely this hostility to including a drop of complexity in <code>std</code> that makes this shit unmanageable for users.</p>



<a name="262123115"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/remove%20splatting%20on%20operators%3F/near/262123115" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Caleb Zulawski <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/remove.20splatting.20on.20operators.3F.html#262123115">(Nov 19 2021 at 20:10)</a>:</h4>
<p><code>where</code> bounds are not "inherited" by supertraits and will be dragged along with the code no matter what</p>



<a name="262123125"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/remove%20splatting%20on%20operators%3F/near/262123125" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jubilee <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/remove.20splatting.20on.20operators.3F.html#262123125">(Nov 19 2021 at 20:10)</a>:</h4>
<p>And rank promotion is a <strong>long</strong> established convention that does not actually have a problem in practice. Show me the user code that is greatly complicated by it. Show me the CVEs against fucking APL.</p>



<a name="262123207"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/remove%20splatting%20on%20operators%3F/near/262123207" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jacob Lifshay <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/remove.20splatting.20on.20operators.3F.html#262123207">(Nov 19 2021 at 20:10)</a>:</h4>
<p>though we couldn't use num-traits right away cuz we have <code>i128</code>/<code>u128</code> issues</p>



<a name="262123229"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/remove%20splatting%20on%20operators%3F/near/262123229" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jacob Lifshay <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/remove.20splatting.20on.20operators.3F.html#262123229">(Nov 19 2021 at 20:11)</a>:</h4>
<p>who still uses APL?</p>



<a name="262123241"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/remove%20splatting%20on%20operators%3F/near/262123241" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jubilee <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/remove.20splatting.20on.20operators.3F.html#262123241">(Nov 19 2021 at 20:11)</a>:</h4>
<p>A lot of people, actually.</p>



<a name="262123381"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/remove%20splatting%20on%20operators%3F/near/262123381" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jubilee <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/remove.20splatting.20on.20operators.3F.html#262123381">(Nov 19 2021 at 20:12)</a>:</h4>
<p>Banks still run large swathes of software on some of the descendants of APL (mostly the ones that preferentially use ASCII operators).</p>



<a name="262123392"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/remove%20splatting%20on%20operators%3F/near/262123392" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jacob Lifshay <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/remove.20splatting.20on.20operators.3F.html#262123392">(Nov 19 2021 at 20:12)</a>:</h4>
<p>hmm, just cuz it's a class in college and cuz some megacompany has old code they don't want to rewrite?</p>



<a name="262123427"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/remove%20splatting%20on%20operators%3F/near/262123427" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jubilee <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/remove.20splatting.20on.20operators.3F.html#262123427">(Nov 19 2021 at 20:12)</a>:</h4>
<p>This is, actually, <strong>not</strong> a source of problems for them.</p>



<a name="262123541"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/remove%20splatting%20on%20operators%3F/near/262123541" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jubilee <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/remove.20splatting.20on.20operators.3F.html#262123541">(Nov 19 2021 at 20:13)</a>:</h4>
<p>Every piece of code, including the "Rust compiler", currently in existence, is old code that someone doesn't want to rewrite.</p>



<a name="262123551"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/remove%20splatting%20on%20operators%3F/near/262123551" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jacob Lifshay <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/remove.20splatting.20on.20operators.3F.html#262123551">(Nov 19 2021 at 20:13)</a>:</h4>
<p>i wouldn't look at the average bank as the source of code advice worth following...they tend to use very old software and insecure crufty protocols</p>



<a name="262123687"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/remove%20splatting%20on%20operators%3F/near/262123687" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jubilee <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/remove.20splatting.20on.20operators.3F.html#262123687">(Nov 19 2021 at 20:14)</a>:</h4>
<p>The insecure crufty protocols are because no one fucking requires them to be secure.</p>



<a name="262123790"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/remove%20splatting%20on%20operators%3F/near/262123790" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jacob Lifshay <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/remove.20splatting.20on.20operators.3F.html#262123790">(Nov 19 2021 at 20:15)</a>:</h4>
<p>yup! hopefully that'll change before all my pii is scattered to the four winds</p>



<a name="262123820"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/remove%20splatting%20on%20operators%3F/near/262123820" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jubilee <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/remove.20splatting.20on.20operators.3F.html#262123820">(Nov 19 2021 at 20:15)</a>:</h4>
<p>Too late, Amazon already did that.</p>



<a name="262123943"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/remove%20splatting%20on%20operators%3F/near/262123943" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jacob Lifshay <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/remove.20splatting.20on.20operators.3F.html#262123943">(Nov 19 2021 at 20:16)</a>:</h4>
<p>well, at least amazon uses reasonably secure software, or at least appears to</p>



<a name="262123955"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/remove%20splatting%20on%20operators%3F/near/262123955" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jubilee <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/remove.20splatting.20on.20operators.3F.html#262123955">(Nov 19 2021 at 20:16)</a>:</h4>
<p>Didn't you see the news? They can't actually map all the places they copied user data to.</p>



<a name="262123986"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/remove%20splatting%20on%20operators%3F/near/262123986" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jubilee <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/remove.20splatting.20on.20operators.3F.html#262123986">(Nov 19 2021 at 20:16)</a>:</h4>
<p>"S3 bucket left open" is the like no. 1 security vuln in practice.</p>



<a name="262124030"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/remove%20splatting%20on%20operators%3F/near/262124030" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Caleb Zulawski <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/remove.20splatting.20on.20operators.3F.html#262124030">(Nov 19 2021 at 20:17)</a>:</h4>
<p>Instead of relitigating ancient code I think it would be fair to say the autosplatting has caused enough problems and can be trivially avoided in user code, should we just agree to remove it without going into our personal reasons for removal?</p>



<a name="262124038"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/remove%20splatting%20on%20operators%3F/near/262124038" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jubilee <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/remove.20splatting.20on.20operators.3F.html#262124038">(Nov 19 2021 at 20:17)</a>:</h4>
<p>Since there isn't any software so secure a user can't break it.</p>



<a name="262124057"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/remove%20splatting%20on%20operators%3F/near/262124057" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jubilee <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/remove.20splatting.20on.20operators.3F.html#262124057">(Nov 19 2021 at 20:17)</a>:</h4>
<p><span class="user-mention" data-user-id="312331">@Caleb Zulawski</span> No.</p>



<a name="262124088"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/remove%20splatting%20on%20operators%3F/near/262124088" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jubilee <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/remove.20splatting.20on.20operators.3F.html#262124088">(Nov 19 2021 at 20:17)</a>:</h4>
<p>We're relitigating it precisely because we can't agree.</p>



<a name="262124162"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/remove%20splatting%20on%20operators%3F/near/262124162" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Caleb Zulawski <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/remove.20splatting.20on.20operators.3F.html#262124162">(Nov 19 2021 at 20:18)</a>:</h4>
<p>Who is still in favor of it existing?</p>



<a name="262124171"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/remove%20splatting%20on%20operators%3F/near/262124171" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jubilee <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/remove.20splatting.20on.20operators.3F.html#262124171">(Nov 19 2021 at 20:18)</a>:</h4>
<p>Hi.</p>



<a name="262124174"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/remove%20splatting%20on%20operators%3F/near/262124174" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jacob Lifshay <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/remove.20splatting.20on.20operators.3F.html#262124174">(Nov 19 2021 at 20:18)</a>:</h4>
<blockquote>
<p>Since there isn't any software so secure a user can't break it.</p>
</blockquote>
<p>well, i'm going to at least try to make it better...</p>



<a name="262124211"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/remove%20splatting%20on%20operators%3F/near/262124211" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Caleb Zulawski <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/remove.20splatting.20on.20operators.3F.html#262124211">(Nov 19 2021 at 20:18)</a>:</h4>
<p>I thought you just suggested removing it to avoid the inference issues</p>



<a name="262124222"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/remove%20splatting%20on%20operators%3F/near/262124222" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jubilee <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/remove.20splatting.20on.20operators.3F.html#262124222">(Nov 19 2021 at 20:18)</a>:</h4>
<p>Trying to automate the user away is the source of most problems (and is the only way to make a system definitionally secure against a user).</p>



<a name="262124315"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/remove%20splatting%20on%20operators%3F/near/262124315" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jacob Lifshay <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/remove.20splatting.20on.20operators.3F.html#262124315">(Nov 19 2021 at 20:19)</a>:</h4>
<p>not trying is the easiest way to fail</p>



<a name="262124411"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/remove%20splatting%20on%20operators%3F/near/262124411" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jubilee <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/remove.20splatting.20on.20operators.3F.html#262124411">(Nov 19 2021 at 20:20)</a>:</h4>
<p>Not trying to make autosplatting work <strong>correctly</strong> is the easiest way to inflict RSI on all our users, yes.</p>



<a name="262124435"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/remove%20splatting%20on%20operators%3F/near/262124435" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jacob Lifshay <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/remove.20splatting.20on.20operators.3F.html#262124435">(Nov 19 2021 at 20:20)</a>:</h4>
<p>anyway, back to splatting, I'm mildly in favor of removing autosplatting</p>



<a name="262124479"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/remove%20splatting%20on%20operators%3F/near/262124479" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Caleb Zulawski <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/remove.20splatting.20on.20operators.3F.html#262124479">(Nov 19 2021 at 20:20)</a>:</h4>
<p>Yeah, I'm mildly in favor, though with the proposed trait changes even more in favor</p>



<a name="262124520"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/remove%20splatting%20on%20operators%3F/near/262124520" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jubilee <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/remove.20splatting.20on.20operators.3F.html#262124520">(Nov 19 2021 at 20:21)</a>:</h4>
<p>Ugh fuck it.</p>



<a name="262124558"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/remove%20splatting%20on%20operators%3F/near/262124558" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jubilee <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/remove.20splatting.20on.20operators.3F.html#262124558">(Nov 19 2021 at 20:21)</a>:</h4>
<p>a<br>
<span class="user-mention silent" data-user-id="312331">Caleb Zulawski</span> <a href="#narrow/stream/257879-project-portable-simd/topic/remove.20splatting.20on.20operators.3F/near/262124211">said</a>:</p>
<blockquote>
<p>I thought you just suggested removing it to avoid the inference issues</p>
</blockquote>
<p>I acknowledged it would be the best reason to, I am very upset with the way I am continuously misunderstood.</p>



<a name="262124620"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/remove%20splatting%20on%20operators%3F/near/262124620" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Caleb Zulawski <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/remove.20splatting.20on.20operators.3F.html#262124620">(Nov 19 2021 at 20:22)</a>:</h4>
<p>I think you should be able to do <code>v * 2</code> but it seems to cause more problems than it's worth</p>



<a name="262124695"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/remove%20splatting%20on%20operators%3F/near/262124695" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Caleb Zulawski <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/remove.20splatting.20on.20operators.3F.html#262124695">(Nov 19 2021 at 20:22)</a>:</h4>
<p>Well fwiw I'm having a lot of trouble following your argument when it's immediately followed by a discussion of APL and Amazon and lots of other things I'm not really following</p>



<a name="262124727"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/remove%20splatting%20on%20operators%3F/near/262124727" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jubilee <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/remove.20splatting.20on.20operators.3F.html#262124727">(Nov 19 2021 at 20:23)</a>:</h4>
<p>Then ask.</p>



<a name="262124739"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/remove%20splatting%20on%20operators%3F/near/262124739" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Caleb Zulawski <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/remove.20splatting.20on.20operators.3F.html#262124739">(Nov 19 2021 at 20:23)</a>:</h4>
<p>I did haha</p>



<a name="262124746"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/remove%20splatting%20on%20operators%3F/near/262124746" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jacob Lifshay <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/remove.20splatting.20on.20operators.3F.html#262124746">(Nov 19 2021 at 20:23)</a>:</h4>
<p>well, one idea is adding splatted literals: <code>3.5_f32x4</code> or <code>3.5_f32x_</code></p>



<a name="262124751"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/remove%20splatting%20on%20operators%3F/near/262124751" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jubilee <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/remove.20splatting.20on.20operators.3F.html#262124751">(Nov 19 2021 at 20:23)</a>:</h4>
<p>No, you did not.</p>



<a name="262124942"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/remove%20splatting%20on%20operators%3F/near/262124942" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jacob Lifshay <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/remove.20splatting.20on.20operators.3F.html#262124942">(Nov 19 2021 at 20:25)</a>:</h4>
<p>though honestly, splatted literals seem a little too much, <code>3.5.sp()</code> is short enough</p>



<a name="262124955"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/remove%20splatting%20on%20operators%3F/near/262124955" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Caleb Zulawski <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/remove.20splatting.20on.20operators.3F.html#262124955">(Nov 19 2021 at 20:25)</a>:</h4>
<p>I think it would generally be reasonable to call <code>splat(scalar)</code></p>



<a name="262124973"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/remove%20splatting%20on%20operators%3F/near/262124973" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Caleb Zulawski <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/remove.20splatting.20on.20operators.3F.html#262124973">(Nov 19 2021 at 20:25)</a>:</h4>
<p>I'm really not in favor of abbreviations</p>



<a name="262124990"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/remove%20splatting%20on%20operators%3F/near/262124990" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jacob Lifshay <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/remove.20splatting.20on.20operators.3F.html#262124990">(Nov 19 2021 at 20:25)</a>:</h4>
<p>k</p>



<a name="262125006"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/remove%20splatting%20on%20operators%3F/near/262125006" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jubilee <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/remove.20splatting.20on.20operators.3F.html#262125006">(Nov 19 2021 at 20:25)</a>:</h4>
<p>You just assumed you knew what I was saying and jumped off of that.<br>
If acknowledging a cost is real is treated as agreement that we should make a decision based on that alone, then no, you are not listening to what I am saying.</p>



<a name="262125010"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/remove%20splatting%20on%20operators%3F/near/262125010" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Caleb Zulawski <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/remove.20splatting.20on.20operators.3F.html#262125010">(Nov 19 2021 at 20:25)</a>:</h4>
<p>It's unfortunate that you can't import an associated function</p>



<a name="262125169"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/remove%20splatting%20on%20operators%3F/near/262125169" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jacob Lifshay <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/remove.20splatting.20on.20operators.3F.html#262125169">(Nov 19 2021 at 20:26)</a>:</h4>
<blockquote>
<p>It's unfortunate that you can't import an associated function</p>
</blockquote>
<p>that's why I proposed the <code>splat</code> global fn</p>



<a name="262125178"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/remove%20splatting%20on%20operators%3F/near/262125178" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jubilee <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/remove.20splatting.20on.20operators.3F.html#262125178">(Nov 19 2021 at 20:26)</a>:</h4>
<p>Frankly, I am done with this entire project if my continued participation is going to be treated as a reason to reject, refuse, and ignore me.</p>



<a name="262125242"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/remove%20splatting%20on%20operators%3F/near/262125242" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jacob Lifshay <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/remove.20splatting.20on.20operators.3F.html#262125242">(Nov 19 2021 at 20:27)</a>:</h4>
<p>i'm not ignoring you, i'm disagreeing</p>



<a name="262125376"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/remove%20splatting%20on%20operators%3F/near/262125376" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jacob Lifshay <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/remove.20splatting.20on.20operators.3F.html#262125376">(Nov 19 2021 at 20:28)</a>:</h4>
<p>I do appreciate your efforts</p>



<a name="262125422"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/remove%20splatting%20on%20operators%3F/near/262125422" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jubilee <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/remove.20splatting.20on.20operators.3F.html#262125422">(Nov 19 2021 at 20:28)</a>:</h4>
<p>Then why can't I actually speak honestly without it being misinterpreted?</p>



<a name="262125503"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/remove%20splatting%20on%20operators%3F/near/262125503" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jacob Lifshay <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/remove.20splatting.20on.20operators.3F.html#262125503">(Nov 19 2021 at 20:29)</a>:</h4>
<p>cuz i'm not perfect, i don't necessarily get your exact meaning the first (or second or third...)  time</p>



<a name="262125934"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/remove%20splatting%20on%20operators%3F/near/262125934" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Thom Chiovoloni <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/remove.20splatting.20on.20operators.3F.html#262125934">(Nov 19 2021 at 20:33)</a>:</h4>
<p><span class="user-mention silent" data-user-id="312331">Caleb Zulawski</span> <a href="#narrow/stream/257879-project-portable-simd/topic/remove.20splatting.20on.20operators.3F/near/262124162">said</a>:</p>
<blockquote>
<p>Who is still in favor of it existing?</p>
</blockquote>
<p>i am, but weakly. i think that my opinion depends mostly on the severity of the inference breakage</p>



<a name="262125956"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/remove%20splatting%20on%20operators%3F/near/262125956" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Thom Chiovoloni <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/remove.20splatting.20on.20operators.3F.html#262125956">(Nov 19 2021 at 20:33)</a>:</h4>
<p>and if removing splatting actually helps there</p>



<a name="262126445"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/remove%20splatting%20on%20operators%3F/near/262126445" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Thom Chiovoloni <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/remove.20splatting.20on.20operators.3F.html#262126445">(Nov 19 2021 at 20:37)</a>:</h4>
<p>actually, i'm probably not weakly in favor, i'm fully in favor of it with the caveats that</p>
<ul>
<li>widespread inference breakage would not be worth saving the papercut of needing to manually splat</li>
<li>even if there are real differences between this and primitive arithmetic conversions, it <em>feels</em> similar</li>
</ul>



<a name="262126464"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/remove%20splatting%20on%20operators%3F/near/262126464" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jubilee <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/remove.20splatting.20on.20operators.3F.html#262126464">(Nov 19 2021 at 20:37)</a>:</h4>
<p>It is possible it doesn't, and it is likely that the changes to have it work on bounds, instead of individual implementations on every single variation of a type, will actually cause certain things to fail inference less often, because the <code>where</code> bounds will eliminate certain possibilities during candidate weeding.</p>
<p>I am going to finish rewriting this fix to the library so our code does not have an explosive number of implementations, I am done with this conversation, I am against removing splatting, I wanted only to bring up how it is odd that the asymmetric operators have symmetric splatting, and how the existing way type inference works can privilege the LHS. That's it.</p>



<a name="262126871"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/remove%20splatting%20on%20operators%3F/near/262126871" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jacob Lifshay <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/remove.20splatting.20on.20operators.3F.html#262126871">(Nov 19 2021 at 20:41)</a>:</h4>
<p>yeah, I agree that privileging the LHS is a problem, I also encountered that when trying to build a DSL in Rust for a hardware description language, i ended up having to build a proc macro that parses the experssions and calls a totally separate set of operator traits</p>
<p><code>val!</code> in<br>
<a href="https://salsa.debian.org/Kazan-team/rust-hdl/-/blob/master/examples/blinky.rs">https://salsa.debian.org/Kazan-team/rust-hdl/-/blob/master/examples/blinky.rs</a></p>



<a name="262126929"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/remove%20splatting%20on%20operators%3F/near/262126929" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jubilee <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/remove.20splatting.20on.20operators.3F.html#262126929">(Nov 19 2021 at 20:42)</a>:</h4>
<p>Removing splatting specifically on the LHS on the asymmetric operators would be quite probable to fix the remaining type inference issues some ~95% of the time. Making custom literals work would also be good, but is an even more ambitious plan than my wildest dreams tbh.</p>



<a name="262127226"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/remove%20splatting%20on%20operators%3F/near/262127226" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jacob Lifshay <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/remove.20splatting.20on.20operators.3F.html#262127226">(Nov 19 2021 at 20:44)</a>:</h4>
<p>i'd be ok with that, as long as we don't do it differently for <code>+</code> vs. other operators</p>



<a name="262127267"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/remove%20splatting%20on%20operators%3F/near/262127267" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Caleb Zulawski <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/remove.20splatting.20on.20operators.3F.html#262127267">(Nov 19 2021 at 20:45)</a>:</h4>
<p>From a technical point of view I agree, but from the original justification of autosplatting I don't see any reason for <code>v * 2</code> to work but not <code>2 * v</code> to the extent that it seems negatively inconsistent</p>



<a name="262127298"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/remove%20splatting%20on%20operators%3F/near/262127298" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jacob Lifshay <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/remove.20splatting.20on.20operators.3F.html#262127298">(Nov 19 2021 at 20:45)</a>:</h4>
<p><span class="user-mention" data-user-id="312331">@Caleb Zulawski</span> true</p>



<a name="262127446"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/remove%20splatting%20on%20operators%3F/near/262127446" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jubilee <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/remove.20splatting.20on.20operators.3F.html#262127446">(Nov 19 2021 at 20:46)</a>:</h4>
<p>The way type inference works on <code>+</code> is not the same way type inference works on <code>&lt;&lt;</code>.</p>



<a name="262127525"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/remove%20splatting%20on%20operators%3F/near/262127525" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jacob Lifshay <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/remove.20splatting.20on.20operators.3F.html#262127525">(Nov 19 2021 at 20:47)</a>:</h4>
<p>yes, but <code>&lt;&lt;</code> and <code>&gt;&gt;</code> are the only exception out of the arith/logical ops</p>



<a name="262127632"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/remove%20splatting%20on%20operators%3F/near/262127632" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jubilee <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/remove.20splatting.20on.20operators.3F.html#262127632">(Nov 19 2021 at 20:48)</a>:</h4>
<p>Perhaps we should make an exception for the only exception.<br>
That is literally what I was trying to say in the beginning.<br>
And... I am going to actually close this tab, since apparently I have no self control.</p>



<a name="262127819"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/remove%20splatting%20on%20operators%3F/near/262127819" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jacob Lifshay <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/remove.20splatting.20on.20operators.3F.html#262127819">(Nov 19 2021 at 20:50)</a>:</h4>
<p>tbh i'd say we should restrict simd shifting more, where the shift count can be a scalar or the exact same simd type</p>



<a name="262127888"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/remove%20splatting%20on%20operators%3F/near/262127888" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jacob Lifshay <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/remove.20splatting.20on.20operators.3F.html#262127888">(Nov 19 2021 at 20:50)</a>:</h4>
<p>we can claim efficiency as the reason...</p>



<a name="262128016"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/remove%20splatting%20on%20operators%3F/near/262128016" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Caleb Zulawski <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/remove.20splatting.20on.20operators.3F.html#262128016">(Nov 19 2021 at 20:51)</a>:</h4>
<p>It doesn't really make sense to shift a scalar by a vector, but it does make sense to divide a scalar by a vector, they aren't the same thing so I agree</p>



<a name="262128372"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/remove%20splatting%20on%20operators%3F/near/262128372" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jacob Lifshay <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/remove.20splatting.20on.20operators.3F.html#262128372">(Nov 19 2021 at 20:54)</a>:</h4>
<p>it totally makes sense to shift a scalar by a vector, if you have autosplatting...one example is building a mask to extract a different bit in each simd lane</p>



<a name="262128398"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/remove%20splatting%20on%20operators%3F/near/262128398" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Caleb Zulawski <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/remove.20splatting.20on.20operators.3F.html#262128398">(Nov 19 2021 at 20:54)</a>:</h4>
<p>That is true</p>



<a name="262128469"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/remove%20splatting%20on%20operators%3F/near/262128469" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Caleb Zulawski <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/remove.20splatting.20on.20operators.3F.html#262128469">(Nov 19 2021 at 20:55)</a>:</h4>
<p>I guess I keep coming back to the argument that either every argument needs to support it, or none</p>



<a name="262128498"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/remove%20splatting%20on%20operators%3F/near/262128498" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Thom Chiovoloni <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/remove.20splatting.20on.20operators.3F.html#262128498">(Nov 19 2021 at 20:55)</a>:</h4>
<p><span class="user-mention silent" data-user-id="281757">Jubilee</span> <a href="#narrow/stream/257879-project-portable-simd/topic/remove.20splatting.20on.20operators.3F/near/262126929">said</a>:</p>
<blockquote>
<p>Removing splatting specifically on the LHS on the asymmetric operators would be quite probable to fix the remaining type inference issues some ~95% of the time. Making custom literals work would also be good, but is an even more ambitious plan than my wildest dreams tbh.</p>
</blockquote>
<p>Tbh... I'm really against having autosplatting only happen on one side or another, because i've done a lot of rust teaching work and have found the issue with String + &amp;str working, but &amp;str + String not working, being extremely confusing to newcomers. I think we shouldn't add more asymmetry to operators that are conceptually commutative.</p>



<a name="262128501"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/remove%20splatting%20on%20operators%3F/near/262128501" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Caleb Zulawski <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/remove.20splatting.20on.20operators.3F.html#262128501">(Nov 19 2021 at 20:55)</a>:</h4>
<p>I don't think we're helping anyone if it's inconsistent</p>



<a name="262128529"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/remove%20splatting%20on%20operators%3F/near/262128529" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Thom Chiovoloni <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/remove.20splatting.20on.20operators.3F.html#262128529">(Nov 19 2021 at 20:55)</a>:</h4>
<p>I'd rather have no autosplatting than that, and I do like the autosplatting (since it cleans up a lot of code)</p>



<a name="262128628"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/remove%20splatting%20on%20operators%3F/near/262128628" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Caleb Zulawski <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/remove.20splatting.20on.20operators.3F.html#262128628">(Nov 19 2021 at 20:56)</a>:</h4>
<p>I completely agree with that</p>



<a name="262128660"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/remove%20splatting%20on%20operators%3F/near/262128660" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Caleb Zulawski <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/remove.20splatting.20on.20operators.3F.html#262128660">(Nov 19 2021 at 20:56)</a>:</h4>
<p>I'm like autosplatting as long as it's consistent and available everywhere</p>



<a name="262133072"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/remove%20splatting%20on%20operators%3F/near/262133072" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lokathor <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/remove.20splatting.20on.20operators.3F.html#262133072">(Nov 19 2021 at 21:33)</a>:</h4>
<p><span class="user-mention" data-user-id="312331">@Caleb Zulawski</span> I'm in big favor of it existing.</p>
<p>I think the ideal should be that you can write a fn foo(x : f32) -&gt; f32 and then just stick some "x4" on there and it goes 4 wide.</p>



<a name="262133404"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/remove%20splatting%20on%20operators%3F/near/262133404" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lokathor <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/remove.20splatting.20on.20operators.3F.html#262133404">(Nov 19 2021 at 21:36)</a>:</h4>
<p>also yall have convinced me that occasional splatting such as by left or right side is a bad idea</p>



<a name="262645214"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/remove%20splatting%20on%20operators%3F/near/262645214" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> scottmcm <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/remove.20splatting.20on.20operators.3F.html#262645214">(Nov 24 2021 at 22:03)</a>:</h4>
<p>What does splatting look like if it's not automatic?  <code>Simd::from(x)</code> or is there something shorter?</p>



<a name="262645294"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/remove%20splatting%20on%20operators%3F/near/262645294" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jubilee <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/remove.20splatting.20on.20operators.3F.html#262645294">(Nov 24 2021 at 22:04)</a>:</h4>
<p><code>Simd::splat(x)</code> yes</p>



<hr><p>Last updated: Apr 12 2022 at 20:01 UTC</p>
</html>