<html>
<head><meta charset="utf-8"><title>Rearranging everything · project-portable-simd · Zulip Chat Archive</title></head>
<h2>Stream: <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/index.html">project-portable-simd</a></h2>
<h3>Topic: <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/Rearranging.20everything.html">Rearranging everything</a></h3>

<hr>

<base href="https://rust-lang.zulipchat.com">

<head><link href="https://zulip-archive.rust-lang.org/style.css" rel="stylesheet"></head>

<a name="253027052"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/Rearranging%20everything/near/253027052" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jubilee <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/Rearranging.20everything.html#253027052">(Sep 13 2021 at 01:54)</a>:</h4>
<p>I have been constructing the PR to import portable-simd into <code>rust/library/core</code> and it will probably require heavily rearranging a Lot internally to us to duplicate the particulars of this cursed architecture, just to give you a heads up <span class="user-mention" data-user-id="312331">@Caleb Zulawski</span>. <span aria-label="upside down" class="emoji emoji-1f643" role="img" title="upside down">:upside_down:</span></p>



<a name="253027074"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/Rearranging%20everything/near/253027074" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Caleb Zulawski <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/Rearranging.20everything.html#253027074">(Sep 13 2021 at 01:55)</a>:</h4>
<p>Woo! But also oh no!</p>



<a name="253027083"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/Rearranging%20everything/near/253027083" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Caleb Zulawski <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/Rearranging.20everything.html#253027083">(Sep 13 2021 at 01:55)</a>:</h4>
<p>What kinds of changes are you expecting, generally?</p>



<a name="253027131"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/Rearranging%20everything/near/253027131" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jubilee <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/Rearranging.20everything.html#253027131">(Sep 13 2021 at 01:56)</a>:</h4>
<p>Mostly making things internally slightly more nested rather than flat.</p>



<a name="253027144"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/Rearranging%20everything/near/253027144" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Caleb Zulawski <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/Rearranging.20everything.html#253027144">(Sep 13 2021 at 01:56)</a>:</h4>
<p>I think that's probably better, anyway</p>



<a name="253027160"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/Rearranging%20everything/near/253027160" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jubilee <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/Rearranging.20everything.html#253027160">(Sep 13 2021 at 01:57)</a>:</h4>
<p>It causes problems if the rest of the crate is expecting literally <strong>everything</strong> in the root <code>lib.rs</code></p>



<a name="253027167"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/Rearranging%20everything/near/253027167" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Caleb Zulawski <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/Rearranging.20everything.html#253027167">(Sep 13 2021 at 01:57)</a>:</h4>
<p>Hmm</p>



<a name="253027181"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/Rearranging%20everything/near/253027181" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jubilee <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/Rearranging.20everything.html#253027181">(Sep 13 2021 at 01:57)</a>:</h4>
<p>It can still be made to look flat to <strong>external</strong> users.</p>



<a name="253027319"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/Rearranging%20everything/near/253027319" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jubilee <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/Rearranging.20everything.html#253027319">(Sep 13 2021 at 02:00)</a>:</h4>
<p>it just has to be able to pathfind internally relative to actually being uh a module of libcore.</p>



<a name="253027667"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/Rearranging%20everything/near/253027667" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jubilee <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/Rearranging.20everything.html#253027667">(Sep 13 2021 at 02:05)</a>:</h4>
<p>I will try a couple different arrangements to see what satisfies my aesthetic preferences the most, but in the end, it shouldn't be anything disastrous.</p>



<a name="253027867"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/Rearranging%20everything/near/253027867" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Caleb Zulawski <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/Rearranging.20everything.html#253027867">(Sep 13 2021 at 02:09)</a>:</h4>
<p>Sounds good to me</p>



<a name="253027945"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/Rearranging%20everything/near/253027945" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Caleb Zulawski <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/Rearranging.20everything.html#253027945">(Sep 13 2021 at 02:10)</a>:</h4>
<p>I have a PR for true swizzles that I would like to get in before getting to nightly pending <a href="https://github.com/rust-lang/rust/issues/88855">#88855</a>, but after that I don't have anything I really want to change</p>



<a name="253027958"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/Rearranging%20everything/near/253027958" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Caleb Zulawski <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/Rearranging.20everything.html#253027958">(Sep 13 2021 at 02:11)</a>:</h4>
<p>It's been approved so should be in the next few days</p>



<a name="253049110"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/Rearranging%20everything/near/253049110" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lokathor <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/Rearranging.20everything.html#253049110">(Sep 13 2021 at 07:35)</a>:</h4>
<p><code>mod foo; pub use foo::*;</code></p>
<p>you may not like it, but it's what peak crate design looks like.</p>



<a name="253142649"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/Rearranging%20everything/near/253142649" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jubilee <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/Rearranging.20everything.html#253142649">(Sep 13 2021 at 19:06)</a>:</h4>
<p>yep.</p>



<a name="253203314"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/Rearranging%20everything/near/253203314" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jubilee <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/Rearranging.20everything.html#253203314">(Sep 14 2021 at 06:16)</a>:</h4>
<p><code>x.py check</code> passed.</p>



<a name="253203466"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/Rearranging%20everything/near/253203466" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jubilee <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/Rearranging.20everything.html#253203466">(Sep 14 2021 at 06:19)</a>:</h4>
<p>there are... many lines in this diff.</p>



<a name="253884325"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/Rearranging%20everything/near/253884325" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jubilee <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/Rearranging.20everything.html#253884325">(Sep 18 2021 at 18:05)</a>:</h4>
<p>Okay, let me try to make this smaller so that it actually survives review and rebasing.</p>



<a name="253908320"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/Rearranging%20everything/near/253908320" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jubilee <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/Rearranging.20everything.html#253908320">(Sep 19 2021 at 01:53)</a>:</h4>
<p><a href="https://github.com/rust-lang/portable-simd/pull/160">https://github.com/rust-lang/portable-simd/pull/160</a> Okay, easiest way to make this trivial to rebase is to hit us first with it. :P</p>



<a name="253968484"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/Rearranging%20everything/near/253968484" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Caleb Zulawski <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/Rearranging.20everything.html#253968484">(Sep 19 2021 at 20:06)</a>:</h4>
<p>So I just remembered we are using cargo features</p>



<a name="253968555"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/Rearranging%20everything/near/253968555" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Caleb Zulawski <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/Rearranging.20everything.html#253968555">(Sep 19 2021 at 20:07)</a>:</h4>
<p><span class="user-mention" data-user-id="281757">@Jubilee</span> did you happen to see if what we do is compatible with core?</p>



<a name="253973227"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/Rearranging%20everything/near/253973227" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jubilee <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/Rearranging.20everything.html#253973227">(Sep 19 2021 at 21:30)</a>:</h4>
<p><span class="user-mention silent" data-user-id="312331">Caleb Zulawski</span> <a href="#narrow/stream/257879-project-portable-simd/topic/Rearranging.20everything/near/253968555">said</a>:</p>
<blockquote>
<p><span class="user-mention silent" data-user-id="281757">Jubilee</span> did you happen to see if what we do is compatible with core?</p>
</blockquote>
<p>Yes, I believe it should be fine.<br>
My only concern atm is the <code>std</code>-requiring ones.</p>



<a name="253973235"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/Rearranging%20everything/near/253973235" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jubilee <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/Rearranging.20everything.html#253973235">(Sep 19 2021 at 21:30)</a>:</h4>
<p>at worst, we need to make them rustc-level features</p>



<a name="253974214"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/Rearranging%20everything/near/253974214" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> bjorn3 <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/Rearranging.20everything.html#253974214">(Sep 19 2021 at 21:48)</a>:</h4>
<p>I think these methods will have to be split into a separate crate included into libstd, similiar to std_detect.</p>



<a name="253975113"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/Rearranging%20everything/near/253975113" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jubilee <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/Rearranging.20everything.html#253975113">(Sep 19 2021 at 22:05)</a>:</h4>
<p>Righto then.</p>



<a name="253975218"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/Rearranging%20everything/near/253975218" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Caleb Zulawski <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/Rearranging.20everything.html#253975218">(Sep 19 2021 at 22:07)</a>:</h4>
<p>Definitely doable</p>



<a name="253975289"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/Rearranging%20everything/near/253975289" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Caleb Zulawski <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/Rearranging.20everything.html#253975289">(Sep 19 2021 at 22:08)</a>:</h4>
<p>We may want to invert the const generic feature we have (I forget what it's called now), so we can enable it to disable those functions</p>



<a name="253975296"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/Rearranging%20everything/near/253975296" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Caleb Zulawski <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/Rearranging.20everything.html#253975296">(Sep 19 2021 at 22:08)</a>:</h4>
<p>And only enable that feature for testing</p>



<a name="254008470"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/Rearranging%20everything/near/254008470" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jubilee <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/Rearranging.20everything.html#254008470">(Sep 20 2021 at 07:31)</a>:</h4>
<p>I will make sure a few tests come in to main to make sure core::simd doesn't do anything naughty.<br>
Looks like most tests build with the library in.</p>
<p>We only break a suggestion:</p>
<div class="codehilite" data-code-language="Bash"><pre><span></span><code>---- <span class="o">[</span>ui<span class="o">]</span> ui<span class="se">\s</span>uggestions<span class="se">\i</span>ssue-71394-no-from-impl.rs stdout ----
<span class="nv">$DIR</span><span class="se">\i</span>ssue-71394-no-from-impl.rs
diff of stderr:

<span class="m">4</span>       LL <span class="p">|</span>     <span class="nb">let</span> _: <span class="p">&amp;</span><span class="o">[</span>i8<span class="o">]</span> <span class="o">=</span> data.into<span class="o">()</span><span class="p">;</span>
<span class="m">5</span>          <span class="p">|</span>                         ^^^^ the trait <span class="sb">`</span>From&lt;<span class="p">&amp;</span><span class="o">[</span>u8<span class="o">]</span>&gt;<span class="sb">`</span> is not implemented <span class="k">for</span> <span class="sb">`</span><span class="p">&amp;</span><span class="o">[</span>i8<span class="o">]</span><span class="sb">`</span>
<span class="m">6</span>          <span class="p">|</span>
+          <span class="o">=</span> help: the following implementations were found:
+                    &lt;<span class="o">[</span>T<span class="p">;</span> LANES<span class="o">]</span> as From&lt;core::core_simd::vector::Simd&lt;T, LANES&gt;&gt;&gt;
+                    &lt;<span class="o">[</span>bool<span class="p">;</span> LANES<span class="o">]</span> as From&lt;core::core_simd::masks::Mask&lt;T, LANES&gt;&gt;&gt;
<span class="nv">7</span>          <span class="o">=</span> note: required because of the requirements on the impl of <span class="sb">`</span>Into&lt;<span class="p">&amp;</span><span class="o">[</span>i8<span class="o">]</span>&gt;<span class="sb">`</span> <span class="k">for</span> <span class="sb">`</span><span class="p">&amp;</span><span class="o">[</span>u8<span class="o">]</span><span class="sb">`</span>
<span class="m">8</span>
<span class="m">9</span>       error: aborting due to previous error
</code></pre></div>
<p>Though that is mildly concerning.</p>



<a name="254115509"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/Rearranging%20everything/near/254115509" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jubilee <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/Rearranging.20everything.html#254115509">(Sep 20 2021 at 20:48)</a>:</h4>
<p>Based on what Esteban says the issue is the relevant privacy check not being principled, so we should make sure that doesn't affect stable Rust but we don't <strong>have</strong> to fix it before launching... just within ~6 weeks.</p>



<a name="254116197"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/Rearranging%20everything/near/254116197" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jubilee <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/Rearranging.20everything.html#254116197">(Sep 20 2021 at 20:53)</a>:</h4>
<p>Oh okay.</p>



<a name="254118309"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/Rearranging%20everything/near/254118309" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jubilee <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/Rearranging.20everything.html#254118309">(Sep 20 2021 at 21:07)</a>:</h4>
<div class="codehilite" data-code-language="Bash"><pre><span></span><code><span class="nv">7</span>          <span class="o">=</span> help: the following implementations were found:
-                    &lt;<span class="o">[</span>T<span class="p">;</span> LANES<span class="o">]</span> as From&lt;core::core_simd::vector::Simd&lt;T, LANES&gt;&gt;&gt;
-                    &lt;<span class="o">[</span>bool<span class="p">;</span> LANES<span class="o">]</span> as From&lt;core::core_simd::masks::Mask&lt;T, LANES&gt;&gt;&gt;
+                    &lt;<span class="o">[</span>T<span class="p">;</span> LANES<span class="o">]</span> as From&lt;Simd&lt;T, LANES&gt;&gt;&gt;
+                    &lt;<span class="o">[</span>bool<span class="p">;</span> LANES<span class="o">]</span> as From&lt;Mask&lt;T, LANES&gt;&gt;&gt;
</code></pre></div>
<p>It fixes itself (due to the very same being unprincipled, lmao) when I pull this into <code>std::simd</code>.</p>



<a name="254131328"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/Rearranging%20everything/near/254131328" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jubilee <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/Rearranging.20everything.html#254131328">(Sep 20 2021 at 23:00)</a>:</h4>
<div class="codehilite" data-code-language="Bash"><pre><span></span><code>error<span class="o">[</span>E0599<span class="o">]</span>: no method named <span class="sb">`</span>ceil<span class="sb">`</span> found <span class="k">for</span> struct <span class="sb">`</span>Simd<span class="sb">`</span> <span class="k">in</span> the current scope
  --&gt; <span class="nv">$DIR</span>/libm-no_std-cant-float.rs:14:16
   <span class="p">|</span>
LL <span class="p">|</span>     <span class="nb">let</span> <span class="nv">xc</span> <span class="o">=</span> x.ceil<span class="o">()</span><span class="p">;</span>
   <span class="p">|</span>                ^^^^ method not found <span class="k">in</span> <span class="sb">`</span>Simd&lt;f32, 4_usize&gt;<span class="sb">`</span>

error<span class="o">[</span>E0599<span class="o">]</span>: no method named <span class="sb">`</span>floor<span class="sb">`</span> found <span class="k">for</span> struct <span class="sb">`</span>Simd<span class="sb">`</span> <span class="k">in</span> the current scope
  --&gt; <span class="nv">$DIR</span>/libm-no_std-cant-float.rs:15:16
   <span class="p">|</span>
LL <span class="p">|</span>     <span class="nb">let</span> <span class="nv">xf</span> <span class="o">=</span> x.floor<span class="o">()</span><span class="p">;</span>
   <span class="p">|</span>                ^^^^^ method not found <span class="k">in</span> <span class="sb">`</span>Simd&lt;f32, 4_usize&gt;<span class="sb">`</span>

error<span class="o">[</span>E0599<span class="o">]</span>: no method named <span class="sb">`</span>round<span class="sb">`</span> found <span class="k">for</span> struct <span class="sb">`</span>Simd<span class="sb">`</span> <span class="k">in</span> the current scope
  --&gt; <span class="nv">$DIR</span>/libm-no_std-cant-float.rs:16:16
   <span class="p">|</span>
LL <span class="p">|</span>     <span class="nb">let</span> <span class="nv">xr</span> <span class="o">=</span> x.round<span class="o">()</span><span class="p">;</span>
   <span class="p">|</span>                ^^^^^ method not found <span class="k">in</span> <span class="sb">`</span>Simd&lt;f32, 4_usize&gt;<span class="sb">`</span>

error<span class="o">[</span>E0599<span class="o">]</span>: no method named <span class="sb">`</span>trunc<span class="sb">`</span> found <span class="k">for</span> struct <span class="sb">`</span>Simd<span class="sb">`</span> <span class="k">in</span> the current scope
  --&gt; <span class="nv">$DIR</span>/libm-no_std-cant-float.rs:17:16
   <span class="p">|</span>
LL <span class="p">|</span>     <span class="nb">let</span> <span class="nv">xt</span> <span class="o">=</span> x.trunc<span class="o">()</span><span class="p">;</span>
   <span class="p">|</span>                ^^^^^ method not found <span class="k">in</span> <span class="sb">`</span>Simd&lt;f32, 4_usize&gt;<span class="sb">`</span>

error: aborting due to <span class="m">4</span> previous errors

For more information about this error, try <span class="sb">`</span>rustc --explain E0599<span class="sb">`</span>.
</code></pre></div>
<p>We're good on this front.</p>



<a name="254145844"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/Rearranging%20everything/near/254145844" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jubilee <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/Rearranging.20everything.html#254145844">(Sep 21 2021 at 02:09)</a>:</h4>
<p>Yeah, I think we will have to reify the float stuff into its own feature.</p>



<a name="254299558"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/Rearranging%20everything/near/254299558" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Caleb Zulawski <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/Rearranging.20everything.html#254299558">(Sep 22 2021 at 00:45)</a>:</h4>
<p><span class="user-mention" data-user-id="281757">@Jubilee</span> I'm running into something a little odd related to this reorganization</p>



<a name="254299573"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/Rearranging%20everything/near/254299573" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jubilee <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/Rearranging.20everything.html#254299573">(Sep 22 2021 at 00:46)</a>:</h4>
<p>oh?</p>



<a name="254299629"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/Rearranging%20everything/near/254299629" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Caleb Zulawski <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/Rearranging.20everything.html#254299629">(Sep 22 2021 at 00:46)</a>:</h4>
<p>I'm trying out a macro, and inside the macro I want to reference <code>$crate::simd</code>, which I would have expected to work with both <code>core::simd</code> and <code>core_simd::simd</code></p>



<a name="254299637"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/Rearranging%20everything/near/254299637" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jubilee <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/Rearranging.20everything.html#254299637">(Sep 22 2021 at 00:46)</a>:</h4>
<p>y u p.</p>



<a name="254299651"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/Rearranging%20everything/near/254299651" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jubilee <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/Rearranging.20everything.html#254299651">(Sep 22 2021 at 00:46)</a>:</h4>
<p>I had that exact sweat-drop moment today.</p>



<a name="254299666"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/Rearranging%20everything/near/254299666" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Caleb Zulawski <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/Rearranging.20everything.html#254299666">(Sep 22 2021 at 00:47)</a>:</h4>
<p>haha, okay.</p>



<a name="254299682"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/Rearranging%20everything/near/254299682" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Caleb Zulawski <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/Rearranging.20everything.html#254299682">(Sep 22 2021 at 00:47)</a>:</h4>
<p>We didn't have any macros previously, so it didn't come up</p>



<a name="254299684"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/Rearranging%20everything/near/254299684" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jubilee <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/Rearranging.20everything.html#254299684">(Sep 22 2021 at 00:47)</a>:</h4>
<p>If you have an idea for a good solution I am listening.</p>



<a name="254299699"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/Rearranging%20everything/near/254299699" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jubilee <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/Rearranging.20everything.html#254299699">(Sep 22 2021 at 00:47)</a>:</h4>
<p>"we didn't have any macros previously" eh. <span aria-label="eyes" class="emoji emoji-1f440" role="img" title="eyes">:eyes:</span></p>



<a name="254299704"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/Rearranging%20everything/near/254299704" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Caleb Zulawski <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/Rearranging.20everything.html#254299704">(Sep 22 2021 at 00:47)</a>:</h4>
<p>external macros <span aria-label="smile" class="emoji emoji-1f642" role="img" title="smile">:smile:</span></p>



<a name="254299757"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/Rearranging%20everything/near/254299757" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Caleb Zulawski <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/Rearranging.20everything.html#254299757">(Sep 22 2021 at 00:48)</a>:</h4>
<p>I was going to suggest maybe we just rearrange the crate to have the same structure as core entirely, with a <code>simd</code> module and everything lives in there</p>



<a name="254299780"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/Rearranging%20everything/near/254299780" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Caleb Zulawski <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/Rearranging.20everything.html#254299780">(Sep 22 2021 at 00:49)</a>:</h4>
<p>So the tests would look something like <code>use core_simd::simd::*;</code></p>



<a name="254299785"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/Rearranging%20everything/near/254299785" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jubilee <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/Rearranging.20everything.html#254299785">(Sep 22 2021 at 00:49)</a>:</h4>
<p>So I merged a PR this morning that does a sly trick, actually.</p>



<a name="254299796"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/Rearranging%20everything/near/254299796" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Caleb Zulawski <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/Rearranging.20everything.html#254299796">(Sep 22 2021 at 00:49)</a>:</h4>
<p>Ah, I haven't rebased</p>



<a name="254299936"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/Rearranging%20everything/near/254299936" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jubilee <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/Rearranging.20everything.html#254299936">(Sep 22 2021 at 00:51)</a>:</h4>
<div class="codehilite" data-code-language="Diff"><pre><span></span><code><span class="gd">-pub use self::core_simd::simd::*;</span>
<span class="gi">+use self::core_simd::simd;</span>
<span class="gi">+pub use simd::*;</span>
</code></pre></div>



<a name="254300088"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/Rearranging%20everything/near/254300088" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Caleb Zulawski <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/Rearranging.20everything.html#254300088">(Sep 22 2021 at 00:53)</a>:</h4>
<p>Hmm I think that's pretty close to what I mean</p>



<a name="254300142"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/Rearranging%20everything/near/254300142" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Caleb Zulawski <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/Rearranging.20everything.html#254300142">(Sep 22 2021 at 00:54)</a>:</h4>
<p>why not just remove the <code>core_simd</code> module entirely, and make <code>simd</code> top level?</p>



<a name="254300486"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/Rearranging%20everything/near/254300486" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jubilee <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/Rearranging.20everything.html#254300486">(Sep 22 2021 at 01:00)</a>:</h4>
<p>Many things break. I assure you. I tried it.</p>



<a name="254300598"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/Rearranging%20everything/near/254300598" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Caleb Zulawski <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/Rearranging.20everything.html#254300598">(Sep 22 2021 at 01:01)</a>:</h4>
<p>lol, okay</p>



<a name="254300616"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/Rearranging%20everything/near/254300616" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Caleb Zulawski <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/Rearranging.20everything.html#254300616">(Sep 22 2021 at 01:02)</a>:</h4>
<p>on the core end or on the side of our crate?</p>



<a name="254300665"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/Rearranging%20everything/near/254300665" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Caleb Zulawski <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/Rearranging.20everything.html#254300665">(Sep 22 2021 at 01:02)</a>:</h4>
<p>either way, I do think we should just rearrange our crate to be <code>crate::simd::Simd</code> etc</p>



<a name="254300684"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/Rearranging%20everything/near/254300684" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Caleb Zulawski <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/Rearranging.20everything.html#254300684">(Sep 22 2021 at 01:02)</a>:</h4>
<p>which would be as simple as changing your <code>use self::core_simd::simd;</code> to pub, I think</p>



<a name="254304892"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/Rearranging%20everything/near/254304892" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jubilee <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/Rearranging.20everything.html#254304892">(Sep 22 2021 at 02:04)</a>:</h4>
<p><span class="user-mention silent" data-user-id="312331">Caleb Zulawski</span> <a href="#narrow/stream/257879-project-portable-simd/topic/Rearranging.20everything/near/254300616">said</a>:</p>
<blockquote>
<p>on the core end or on the side of our crate?</p>
</blockquote>
<p>wookie noise</p>



<a name="254435900"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/Rearranging%20everything/near/254435900" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jubilee <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/Rearranging.20everything.html#254435900">(Sep 22 2021 at 20:42)</a>:</h4>
<p>Caleb, why does MaskElement have <code>#[doc(hidden)]</code> on its fn?</p>



<a name="254436368"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/Rearranging%20everything/near/254436368" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Caleb Zulawski <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/Rearranging.20everything.html#254436368">(Sep 22 2021 at 20:45)</a>:</h4>
<p>Okay, so those are all implementation details.  They are used to make the public API work, but they aren't strictly necessary on their own</p>



<a name="254436512"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/Rearranging%20everything/near/254436512" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Caleb Zulawski <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/Rearranging.20everything.html#254436512">(Sep 22 2021 at 20:46)</a>:</h4>
<p>eq, for example, was because I didn't want to make <code>MaskElement: PartialEq</code> because that could have implications down the line</p>



<a name="254436667"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/Rearranging%20everything/near/254436667" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Caleb Zulawski <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/Rearranging.20everything.html#254436667">(Sep 22 2021 at 20:48)</a>:</h4>
<p>Those values and fns should never be stabilized</p>



<a name="254436987"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/Rearranging%20everything/near/254436987" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Caleb Zulawski <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/Rearranging.20everything.html#254436987">(Sep 22 2021 at 20:50)</a>:</h4>
<p>To clarify a bit.</p>



<a name="254437197"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/Rearranging%20everything/near/254437197" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Caleb Zulawski <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/Rearranging.20everything.html#254437197">(Sep 22 2021 at 20:51)</a>:</h4>
<p>If you look at the functions such as <code>from_int</code>, you'll see that it's implemented for ALL masks.  The only way to do that is for all masks to have a method for checking int validity, hence <code>valid</code> in the trait.  But <code>valid</code> isn't of any use to a user itself</p>



<a name="254437390"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/Rearranging%20everything/near/254437390" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Caleb Zulawski <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/Rearranging.20everything.html#254437390">(Sep 22 2021 at 20:52)</a>:</h4>
<p>Since <code>MaskElement</code> is sealed it doesn't really matter what's in the trait</p>



<a name="254440404"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/Rearranging%20everything/near/254440404" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jubilee <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/Rearranging.20everything.html#254440404">(Sep 22 2021 at 21:12)</a>:</h4>
<p>Okay, so, I am going to give these stub documentation and unhide them so that you see them every time you hit <code>cargo doc --open</code> on our repo, so that they annoy you.</p>
<p>You see, the linkchecker currently breaks on hidden functions like these, which means this doesn't work in <code>rust-lang/rust master</code>.</p>



<a name="254440449"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/Rearranging%20everything/near/254440449" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jubilee <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/Rearranging.20everything.html#254440449">(Sep 22 2021 at 21:12)</a>:</h4>
<p>I am going to report that as a bug, ofc, so maybe this will get fixed on that end.</p>



<a name="254440583"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/Rearranging%20everything/near/254440583" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jubilee <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/Rearranging.20everything.html#254440583">(Sep 22 2021 at 21:14)</a>:</h4>
<p>In essence, they actually <strong>are not hidden at all</strong>.</p>



<a name="254441126"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/Rearranging%20everything/near/254441126" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jubilee <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/Rearranging.20everything.html#254441126">(Sep 22 2021 at 21:18)</a>:</h4>
<p>( And this isn't about annoying you per se, it's going to annoy me as well, I just know that if I use any other means of making this problem "go away" that the actual problem will remain and not get fixed. )</p>



<a name="254441183"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/Rearranging%20everything/near/254441183" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jubilee <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/Rearranging.20everything.html#254441183">(Sep 22 2021 at 21:19)</a>:</h4>
<p>My apologies.</p>



<a name="254442201"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/Rearranging%20everything/near/254442201" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jubilee <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/Rearranging.20everything.html#254442201">(Sep 22 2021 at 21:27)</a>:</h4>
<p>oh, jyn beat me to it. <a href="https://github.com/rust-lang/rust/issues/89186">https://github.com/rust-lang/rust/issues/89186</a></p>



<a name="254442323"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/Rearranging%20everything/near/254442323" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Caleb Zulawski <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/Rearranging.20everything.html#254442323">(Sep 22 2021 at 21:28)</a>:</h4>
<p>Is this a recent regression?</p>



<a name="254442364"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/Rearranging%20everything/near/254442364" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Caleb Zulawski <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/Rearranging.20everything.html#254442364">(Sep 22 2021 at 21:29)</a>:</h4>
<p>I don't believe unhiding them is the correct action, they aren't part of the API</p>



<a name="254442515"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/Rearranging%20everything/near/254442515" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Caleb Zulawski <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/Rearranging.20everything.html#254442515">(Sep 22 2021 at 21:30)</a>:</h4>
<p>I am specifically concerned about code which may be written against nightly relying on things that aren't part of the API.</p>



<a name="254442601"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/Rearranging%20everything/near/254442601" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jubilee <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/Rearranging.20everything.html#254442601">(Sep 22 2021 at 21:31)</a>:</h4>
<p>No, it's not a regression.</p>



<a name="254442612"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/Rearranging%20everything/near/254442612" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jubilee <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/Rearranging.20everything.html#254442612">(Sep 22 2021 at 21:31)</a>:</h4>
<p>we just weren't checking.</p>



<a name="254442632"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/Rearranging%20everything/near/254442632" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Caleb Zulawski <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/Rearranging.20everything.html#254442632">(Sep 22 2021 at 21:31)</a>:</h4>
<p>Are there no hidden items in the entirety of core/std? I find that hard to believe</p>



<a name="254442649"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/Rearranging%20everything/near/254442649" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jubilee <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/Rearranging.20everything.html#254442649">(Sep 22 2021 at 21:31)</a>:</h4>
<p>No no, you misunderstand.</p>



<a name="254442663"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/Rearranging%20everything/near/254442663" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jubilee <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/Rearranging.20everything.html#254442663">(Sep 22 2021 at 21:31)</a>:</h4>
<p>The <strong>implementation</strong> does not get hidden.</p>



<a name="254442672"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/Rearranging%20everything/near/254442672" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Caleb Zulawski <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/Rearranging.20everything.html#254442672">(Sep 22 2021 at 21:32)</a>:</h4>
<p>Huh</p>



<a name="254442796"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/Rearranging%20everything/near/254442796" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Caleb Zulawski <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/Rearranging.20everything.html#254442796">(Sep 22 2021 at 21:32)</a>:</h4>
<p>Because of that you need to document it in the trait itself?</p>



<a name="254442854"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/Rearranging%20everything/near/254442854" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jubilee <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/Rearranging.20everything.html#254442854">(Sep 22 2021 at 21:33)</a>:</h4>
<p>It means the function is fully visible to users on <code>i32</code> and other marked primitives.</p>



<a name="254442983"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/Rearranging%20everything/near/254442983" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jubilee <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/Rearranging.20everything.html#254442983">(Sep 22 2021 at 21:34)</a>:</h4>
<p>And the entire thing can be busted by simply importing the trait and then invoking fn on it.</p>



<a name="254443068"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/Rearranging%20everything/near/254443068" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Caleb Zulawski <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/Rearranging.20everything.html#254443068">(Sep 22 2021 at 21:35)</a>:</h4>
<p>Well, the intention is those particular values/fns would also remain unstable</p>



<a name="254443131"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/Rearranging%20everything/near/254443131" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Caleb Zulawski <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/Rearranging.20everything.html#254443131">(Sep 22 2021 at 21:35)</a>:</h4>
<p>I'm just wondering if there's a way around it other than making those public and implying they're part of the API</p>



<a name="254443300"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/Rearranging%20everything/near/254443300" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jubilee <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/Rearranging.20everything.html#254443300">(Sep 22 2021 at 21:37)</a>:</h4>
<p>oh, the documentation is going to be "this is supposed to be hidden <span aria-label="upside down" class="emoji emoji-1f643" role="img" title="upside down">:upside_down:</span>"</p>



<a name="254443748"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/Rearranging%20everything/near/254443748" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jubilee <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/Rearranging.20everything.html#254443748">(Sep 22 2021 at 21:41)</a>:</h4>
<div class="codehilite" data-code-language="Rust"><pre><span></span><code><span class="w">    </span><span class="sd">/// This is supposed to be a hidden helper function. Before stabilizing</span>
<span class="w">    </span><span class="sd">/// this trait, it should be documented or erased from public access.</span>
</code></pre></div>



<a name="254444050"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/Rearranging%20everything/near/254444050" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jubilee <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/Rearranging.20everything.html#254444050">(Sep 22 2021 at 21:44)</a>:</h4>
<p>On the primitive pages, it looks like this: <a href="/user_uploads/4715/-Ggul1DqT_ZeYLMFxnHlaQOH/image.png">image.png</a></p>
<div class="message_inline_image"><a href="/user_uploads/4715/-Ggul1DqT_ZeYLMFxnHlaQOH/image.png" title="image.png"><img src="/user_uploads/4715/-Ggul1DqT_ZeYLMFxnHlaQOH/image.png"></a></div>



<a name="254444166"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/Rearranging%20everything/near/254444166" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Caleb Zulawski <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/Rearranging.20everything.html#254444166">(Sep 22 2021 at 21:45)</a>:</h4>
<p>I wouldn't even say it should be documented, it should just be erased lol</p>



<a name="254444239"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/Rearranging%20everything/near/254444239" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Caleb Zulawski <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/Rearranging.20everything.html#254444239">(Sep 22 2021 at 21:46)</a>:</h4>
<p>If all we can do right now is document it, so be it</p>



<a name="254444261"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/Rearranging%20everything/near/254444261" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Caleb Zulawski <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/Rearranging.20everything.html#254444261">(Sep 22 2021 at 21:46)</a>:</h4>
<p>We should probably open a portable-simd issue too</p>



<a name="254444288"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/Rearranging%20everything/near/254444288" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jubilee <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/Rearranging.20everything.html#254444288">(Sep 22 2021 at 21:46)</a>:</h4>
<p>kk!<br>
we could remove it in linkcheck but that Wouldn't Solve The Problem, y'see.</p>



<a name="254444358"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/Rearranging%20everything/near/254444358" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Caleb Zulawski <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/Rearranging.20everything.html#254444358">(Sep 22 2021 at 21:47)</a>:</h4>
<p>I think we just need to make it exceptionally clear it's not part of the API and never will be</p>



<a name="254444590"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/Rearranging%20everything/near/254444590" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jubilee <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/Rearranging.20everything.html#254444590">(Sep 22 2021 at 21:49)</a>:</h4>
<p>like, it would still be there. visible. we just wouldn't solve the problem.<br>
okay, writing this then:</p>
<div class="codehilite" data-code-language="Rust"><pre><span></span><code><span class="w">    </span><span class="sd">/// This is supposed to be a hidden helper function. Before stabilizing</span>
<span class="w">    </span><span class="sd">/// this trait, it should be erased from public access.</span>
</code></pre></div>



<a name="254448729"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/Rearranging%20everything/near/254448729" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jacob Lifshay <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/Rearranging.20everything.html#254448729">(Sep 22 2021 at 22:23)</a>:</h4>
<p>we could take the approach <span class="user-mention" data-user-id="312331">@Caleb Zulawski</span> did in his swizzle pr:<br>
<a href="https://github.com/rust-lang/portable-simd/blob/f5027828efc94a87e9e31d763a732bf081f9ae31/crates/core_simd/src/swizzle.rs#L136-L146">https://github.com/rust-lang/portable-simd/blob/f5027828efc94a87e9e31d763a732bf081f9ae31/crates/core_simd/src/swizzle.rs#L136-L146</a></p>



<a name="254448841"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/Rearranging%20everything/near/254448841" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jacob Lifshay <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/Rearranging.20everything.html#254448841">(Sep 22 2021 at 22:24)</a>:</h4>
<p>where we split the pub trait into a separate private trait with the impl details</p>



<a name="254448886"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/Rearranging%20everything/near/254448886" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Caleb Zulawski <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/Rearranging.20everything.html#254448886">(Sep 22 2021 at 22:24)</a>:</h4>
<p>I don't think that would work here, because those functions could only be implemented for some types, in the PR it's implemented for all because the compiler intrinsic doesn't have bounds attached to it</p>



<a name="254448962"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/Rearranging%20everything/near/254448962" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jacob Lifshay <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/Rearranging.20everything.html#254448962">(Sep 22 2021 at 22:25)</a>:</h4>
<p>impl the private trait for just the types you want</p>



<a name="254449078"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/Rearranging%20everything/near/254449078" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Caleb Zulawski <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/Rearranging.20everything.html#254449078">(Sep 22 2021 at 22:26)</a>:</h4>
<p>But then you can't reference it from the public trait impl, because that's implemented for all MaskElements</p>



<a name="254449146"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/Rearranging%20everything/near/254449146" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jacob Lifshay <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/Rearranging.20everything.html#254449146">(Sep 22 2021 at 22:27)</a>:</h4>
<p>make it a sealed trait, where the impl details are in the private mod?</p>



<a name="254449179"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/Rearranging%20everything/near/254449179" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Caleb Zulawski <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/Rearranging.20everything.html#254449179">(Sep 22 2021 at 22:27)</a>:</h4>
<p>Yeah, I was just going to say it could be sealed.</p>



<a name="254449450"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/Rearranging%20everything/near/254449450" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jacob Lifshay <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/Rearranging.20everything.html#254449450">(Sep 22 2021 at 22:28)</a>:</h4>
<div class="codehilite" data-code-language="Rust"><pre><span></span><code><span class="k">pub</span><span class="w"> </span><span class="k">trait</span><span class="w"> </span><span class="n">PublicAPI</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="k">fn</span> <span class="nf">f</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span><span class="w"> </span><span class="k">where</span><span class="w"> </span><span class="bp">Self</span>: <span class="nc">private</span>::<span class="n">PrivateAPI</span><span class="w"> </span><span class="p">{</span><span class="o">..</span><span class="p">.}</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>
<span class="k">mod</span> <span class="nn">private</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="k">pub</span><span class="w"> </span><span class="k">trait</span><span class="w"> </span><span class="n">PrivateAPI</span><span class="w"> </span><span class="p">{</span><span class="o">..</span><span class="p">.}</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>
</code></pre></div>



<a name="254449672"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/Rearranging%20everything/near/254449672" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Caleb Zulawski <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/Rearranging.20everything.html#254449672">(Sep 22 2021 at 22:29)</a>:</h4>
<p>That's probably the way to go here, it's even cleaner than hiding the various fns</p>



<a name="254449831"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/Rearranging%20everything/near/254449831" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jacob Lifshay <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/Rearranging.20everything.html#254449831">(Sep 22 2021 at 22:30)</a>:</h4>
<p>though, now that i think of that, it makes it hard to use <code>f</code> in generic contexts where you can't name <code>PrivateAPI</code></p>



<a name="254449907"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/Rearranging%20everything/near/254449907" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Caleb Zulawski <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/Rearranging.20everything.html#254449907">(Sep 22 2021 at 22:31)</a>:</h4>
<p>Make it a subtrait instead</p>



<a name="254449923"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/Rearranging%20everything/near/254449923" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Caleb Zulawski <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/Rearranging.20everything.html#254449923">(Sep 22 2021 at 22:31)</a>:</h4>
<p>The trait is already sealed anyway</p>



<a name="254449924"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/Rearranging%20everything/near/254449924" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jacob Lifshay <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/Rearranging.20everything.html#254449924">(Sep 22 2021 at 22:31)</a>:</h4>
<p>maybe Rust needs:</p>
<div class="codehilite" data-code-language="Rust"><pre><span></span><code><span class="k">pub</span><span class="w"> </span><span class="k">trait</span><span class="w"> </span><span class="n">Trait</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="k">pub</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span><span class="w"> </span><span class="k">fn</span> <span class="nf">impl_details</span><span class="p">();</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>
</code></pre></div>



<a name="254450149"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/Rearranging%20everything/near/254450149" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Caleb Zulawski <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/Rearranging.20everything.html#254450149">(Sep 22 2021 at 22:33)</a>:</h4>
<p><span class="user-mention" data-user-id="281757">@Jubilee</span> if you want to wait a bit, I think I'd like to seal the trait and do it this way instead</p>



<a name="254450169"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/Rearranging%20everything/near/254450169" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Caleb Zulawski <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/Rearranging.20everything.html#254450169">(Sep 22 2021 at 22:33)</a>:</h4>
<p>I can take care of it shortly</p>



<a name="254450293"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/Rearranging%20everything/near/254450293" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jacob Lifshay <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/Rearranging.20everything.html#254450293">(Sep 22 2021 at 22:34)</a>:</h4>
<p>if it's a subtrait: <code>PublicAPI: PrivateAPI</code> then private api things can still be named through inheritance, <code>PrivateAPI: PublicAPI</code> then generic contexts still can't do <code>T: PrivateAPI</code> due to privacy</p>



<a name="254450376"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/Rearranging%20everything/near/254450376" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jubilee <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/Rearranging.20everything.html#254450376">(Sep 22 2021 at 22:35)</a>:</h4>
<p><span class="user-mention silent" data-user-id="312331">Caleb Zulawski</span> <a href="#narrow/stream/257879-project-portable-simd/topic/Rearranging.20everything/near/254450149">said</a>:</p>
<blockquote>
<p><span class="user-mention silent" data-user-id="281757">Jubilee</span> if you want to wait a bit, I think I'd like to seal the trait and do it this way instead</p>
</blockquote>
<p>I already diffed the files and pushed, am waiting on rust-lang/rust CI to green or not.</p>



<a name="254450443"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/Rearranging%20everything/near/254450443" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Caleb Zulawski <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/Rearranging.20everything.html#254450443">(Sep 22 2021 at 22:36)</a>:</h4>
<p>It won't need to, subtrait are satisfied at impl not when you call fns on the trait</p>



<a name="254450505"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/Rearranging%20everything/near/254450505" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Caleb Zulawski <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/Rearranging.20everything.html#254450505">(Sep 22 2021 at 22:36)</a>:</h4>
<p><span class="user-mention" data-user-id="281757">@Jubilee</span> okay, well I'd like to make that change anyway, hopefully we can get it in sooner rather than later</p>



<a name="254450551"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/Rearranging%20everything/near/254450551" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Caleb Zulawski <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/Rearranging.20everything.html#254450551">(Sep 22 2021 at 22:37)</a>:</h4>
<p>Tbh I'd like to wrap up the swizzle thing too before we "go public", at least to the extent of advertising it</p>



<a name="254450556"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/Rearranging%20everything/near/254450556" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jacob Lifshay <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/Rearranging.20everything.html#254450556">(Sep 22 2021 at 22:37)</a>:</h4>
<p>then how do you do: <code>fn user_fn&lt;T: PublicAPI&gt;(v: T) { v.requires_private_api() }</code></p>



<a name="254450587"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/Rearranging%20everything/near/254450587" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Caleb Zulawski <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/Rearranging.20everything.html#254450587">(Sep 22 2021 at 22:37)</a>:</h4>
<p>I'm just going to write the commit and see <span aria-label="laughing" class="emoji emoji-1f606" role="img" title="laughing">:laughing:</span></p>



<a name="254450686"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/Rearranging%20everything/near/254450686" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jubilee <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/Rearranging.20everything.html#254450686">(Sep 22 2021 at 22:38)</a>:</h4>
<p>~soft launch~</p>



<a name="254450729"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/Rearranging%20everything/near/254450729" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jacob Lifshay <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/Rearranging.20everything.html#254450729">(Sep 22 2021 at 22:39)</a>:</h4>
<p>people will notice as soon as twir comes out...</p>



<a name="254450733"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/Rearranging%20everything/near/254450733" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jubilee <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/Rearranging.20everything.html#254450733">(Sep 22 2021 at 22:39)</a>:</h4>
<p>rust-lang/rust can be resynced again, dw.</p>



<a name="254450776"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/Rearranging%20everything/near/254450776" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jubilee <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/Rearranging.20everything.html#254450776">(Sep 22 2021 at 22:39)</a>:</h4>
<p>Also I am not afraid of renaming every single function in the API by a letter.</p>



<a name="254450809"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/Rearranging%20everything/near/254450809" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Caleb Zulawski <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/Rearranging.20everything.html#254450809">(Sep 22 2021 at 22:40)</a>:</h4>
<p>I wonder--whats the deal with updating the subtree. How big of a deal is it?</p>



<a name="254450893"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/Rearranging%20everything/near/254450893" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Caleb Zulawski <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/Rearranging.20everything.html#254450893">(Sep 22 2021 at 22:40)</a>:</h4>
<p>Can we do it on a whim whenever we merge a significant PR?</p>



<a name="254450920"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/Rearranging%20everything/near/254450920" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jubilee <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/Rearranging.20everything.html#254450920">(Sep 22 2021 at 22:40)</a>:</h4>
<p>I believe it's actually only resyncing from rust-lang/rust that's a pain.</p>



<a name="254450932"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/Rearranging%20everything/near/254450932" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jacob Lifshay <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/Rearranging.20everything.html#254450932">(Sep 22 2021 at 22:41)</a>:</h4>
<p>rename it to <code>std:: 🎉simd 🎉::f32x4</code> :P</p>



<a name="254451226"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/Rearranging%20everything/near/254451226" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jubilee <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/Rearranging.20everything.html#254451226">(Sep 22 2021 at 22:42)</a>:</h4>
<p><code>std::🚀simd🚀</code></p>



<a name="254451428"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/Rearranging%20everything/near/254451428" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jubilee <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/Rearranging.20everything.html#254451428">(Sep 22 2021 at 22:44)</a>:</h4>
<p><span class="user-mention" data-user-id="312331">@Caleb Zulawski</span> So, I applied patches upstream and pulled them in as I worked on making the tests/plumbing good because that was easier than applying them in rust-lang/rust and resyncing "up" to portable-simd.</p>



<a name="254451487"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/Rearranging%20everything/near/254451487" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jubilee <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/Rearranging.20everything.html#254451487">(Sep 22 2021 at 22:45)</a>:</h4>
<p>It should be trivial to pull additional PRs in from rust-lang/portable-simd into rust-lang/rust/library/portable-simd</p>



<a name="254451571"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/Rearranging%20everything/near/254451571" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jubilee <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/Rearranging.20everything.html#254451571">(Sep 22 2021 at 22:46)</a>:</h4>
<p>reversing the flow actually breaks git unless you patch it lol</p>



<a name="254451630"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/Rearranging%20everything/near/254451630" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Caleb Zulawski <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/Rearranging.20everything.html#254451630">(Sep 22 2021 at 22:47)</a>:</h4>
<p>Is there a way to prevent people from making the changes directly to rust-lang/rust?</p>



<hr><p>Last updated: Apr 12 2022 at 20:01 UTC</p>
</html>