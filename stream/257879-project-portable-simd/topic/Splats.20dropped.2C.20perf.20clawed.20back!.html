<html>
<head><meta charset="utf-8"><title>Splats dropped, perf clawed back! · project-portable-simd · Zulip Chat Archive</title></head>
<h2>Stream: <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/index.html">project-portable-simd</a></h2>
<h3>Topic: <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/Splats.20dropped.2C.20perf.20clawed.20back!.html">Splats dropped, perf clawed back!</a></h3>

<hr>

<base href="https://rust-lang.zulipchat.com">

<head><link href="https://zulip-archive.rust-lang.org/style.css" rel="stylesheet"></head>

<a name="264224270"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/Splats%20dropped%2C%20perf%20clawed%20back%21/near/264224270" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jubilee <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/Splats.20dropped.2C.20perf.20clawed.20back!.html#264224270">(Dec 08 2021 at 21:36)</a>:</h4>
<p>As it turns out, <a href="https://github.com/rust-lang/rust/pull/91484#issuecomment-988532000">https://github.com/rust-lang/rust/pull/91484#issuecomment-988532000</a><br>
While it is somewhat offset by the fact we also initially landed by delivering a hit to rustdoc perf, the generic versions also significantly claw back the damage done. Huzzah! Even for some non-doc things, too, which is surprising. Maybe just noise?</p>



<a name="264224592"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/Splats%20dropped%2C%20perf%20clawed%20back%21/near/264224592" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Caleb Zulawski <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/Splats.20dropped.2C.20perf.20clawed.20back!.html#264224592">(Dec 08 2021 at 21:39)</a>:</h4>
<p>Massive improvement</p>



<a name="264224827"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/Splats%20dropped%2C%20perf%20clawed%20back%21/near/264224827" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lokathor <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/Splats.20dropped.2C.20perf.20clawed.20back!.html#264224827">(Dec 08 2021 at 21:41)</a>:</h4>
<p>was the only splat breakage from <code>&amp;scalar</code>?</p>
<p>Because if vec+scalar is allowed without vec+&amp;scalar I could live with that. I just want my lovely literals to work right.</p>



<a name="264224960"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/Splats%20dropped%2C%20perf%20clawed%20back%21/near/264224960" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Caleb Zulawski <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/Splats.20dropped.2C.20perf.20clawed.20back!.html#264224960">(Dec 08 2021 at 21:42)</a>:</h4>
<p>I think since we have <code>SimdElement</code> now it would be reasonable to add a splat function to that, as a compromise</p>



<a name="264225048"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/Splats%20dropped%2C%20perf%20clawed%20back%21/near/264225048" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Caleb Zulawski <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/Splats.20dropped.2C.20perf.20clawed.20back!.html#264225048">(Dec 08 2021 at 21:43)</a>:</h4>
<p>Assuming the type inference works, that would be a little less verbose than the splat constructor</p>



<a name="264225062"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/Splats%20dropped%2C%20perf%20clawed%20back%21/near/264225062" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jubilee <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/Splats.20dropped.2C.20perf.20clawed.20back!.html#264225062">(Dec 08 2021 at 21:43)</a>:</h4>
<p><span class="user-mention silent" data-user-id="224471">Lokathor</span> <a href="#narrow/stream/257879-project-portable-simd/topic/Splats.20dropped.2C.20perf.20clawed.20back!/near/264224827">said</a>:</p>
<blockquote>
<p>was the only splat breakage from <code>&amp;scalar</code>?</p>
<p>Because if vec+scalar is allowed without vec+&amp;scalar I could live with that. I just want my lovely literals to work right.</p>
</blockquote>
<p>I <strong>think</strong> so.</p>



<a name="264225118"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/Splats%20dropped%2C%20perf%20clawed%20back%21/near/264225118" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jubilee <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/Splats.20dropped.2C.20perf.20clawed.20back!.html#264225118">(Dec 08 2021 at 21:44)</a>:</h4>
<p>But we're waiting for crater to get back to us.</p>



<a name="264225967"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/Splats%20dropped%2C%20perf%20clawed%20back%21/near/264225967" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jubilee <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/Splats.20dropped.2C.20perf.20clawed.20back!.html#264225967">(Dec 08 2021 at 21:51)</a>:</h4>
<p>Also that PR broke Miri because Ralf didn't even know all the weird shit we're doing but he intuitively tried <code>{vector} $OP {scalar}</code>, expecting it to work:<br>
<a href="https://github.com/rust-lang/rust/issues/91649#issuecomment-988885509">https://github.com/rust-lang/rust/issues/91649#issuecomment-988885509</a><br>
And it did, ofc, until we dropped autosplats. <span aria-label="sweat smile" class="emoji emoji-1f605" role="img" title="sweat smile">:sweat_smile:</span></p>



<a name="264228666"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/Splats%20dropped%2C%20perf%20clawed%20back%21/near/264228666" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lokathor <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/Splats.20dropped.2C.20perf.20clawed.20back!.html#264228666">(Dec 08 2021 at 22:14)</a>:</h4>
<p>&lt;3</p>



<hr><p>Last updated: Apr 12 2022 at 20:01 UTC</p>
</html>