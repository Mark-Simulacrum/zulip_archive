<html>
<head><meta charset="utf-8"><title>-Ctarget-cpu and such · project-portable-simd · Zulip Chat Archive</title></head>
<h2>Stream: <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/index.html">project-portable-simd</a></h2>
<h3>Topic: <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/-Ctarget-cpu.20and.20such.html">-Ctarget-cpu and such</a></h3>

<hr>

<base href="https://rust-lang.zulipchat.com">

<head><link href="https://zulip-archive.rust-lang.org/style.css" rel="stylesheet"></head>

<a name="277551702"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/-Ctarget-cpu%20and%20such/near/277551702" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jubilee <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/-Ctarget-cpu.20and.20such.html#277551702">(Apr 02 2022 at 21:07)</a>:</h4>
<p>But in general, a processor that can e.g. run v2 code <strong>may</strong> sigill on higher feature levels, it's not guaranteed for or against. In explicit SIMD code you can safely (well, <code>unsafe</code>, actually...) assume it will in fact hit something that causes a sigill though.</p>



<a name="277551929"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/-Ctarget-cpu%20and%20such/near/277551929" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jubilee <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/-Ctarget-cpu.20and.20such.html#277551929">(Apr 02 2022 at 21:11)</a>:</h4>
<p>It also should be noted: compiler flags are essentially like <code>unsafe</code> code. This goes double for ones that alter the ISA features in play. They allow rustc to emit code that is actually architecturally UB to run on your computer. Rust is not responsible for what you do with that binary, only for making sure the binary itself is correct.</p>



<a name="277580360"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/-Ctarget-cpu%20and%20such/near/277580360" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lokathor <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/-Ctarget-cpu.20and.20such.html#277580360">(Apr 03 2022 at 06:00)</a>:</h4>
<p>there's an unfortunate 7% gap in the Steam Hardware Survey where folks have AVX but not AVX2 (though it goes down every so often)</p>



<a name="277581237"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/-Ctarget-cpu%20and%20such/near/277581237" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> scottmcm <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/-Ctarget-cpu.20and.20such.html#277581237">(Apr 03 2022 at 06:08)</a>:</h4>
<p>What's the main difference between them?  A quick scan suggests AVX is more floating point, AVX2 is more integers?</p>



<a name="277590435"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257879-project-portable-simd/topic/-Ctarget-cpu%20and%20such/near/277590435" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jubilee <a href="https://zulip-archive.rust-lang.org/stream/257879-project-portable-simd/topic/-Ctarget-cpu.20and.20such.html#277590435">(Apr 03 2022 at 07:35)</a>:</h4>
<p><span class="user-mention silent" data-user-id="125270">scottmcm</span> <a href="#narrow/stream/257879-project-portable-simd/topic/-Ctarget-cpu.20and.20such/near/277581237">said</a>:</p>
<blockquote>
<p>What's the main difference between them?  A quick scan suggests AVX is more floating point, AVX2 is more integers?</p>
</blockquote>
<p>AVX introduces the VEX encoding scheme, 256-bit vectors, and partial permutes.<br>
AVX2 introduces what are called "lane-crossing" shuffles.</p>
<p>That is, AVX instructions tend to rearrange data in a way that looks like "two SSE2 registers side to side", whereas only AVX2 has the "swizzle everything mostly freely" instructions.</p>



<hr><p>Last updated: Apr 12 2022 at 20:01 UTC</p>
</html>