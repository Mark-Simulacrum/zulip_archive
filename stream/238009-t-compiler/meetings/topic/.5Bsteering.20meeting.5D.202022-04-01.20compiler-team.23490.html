<html>
<head><meta charset="utf-8"><title>[steering meeting] 2022-04-01 compiler-team#490 · t-compiler/meetings · Zulip Chat Archive</title></head>
<h2>Stream: <a href="https://zulip-archive.rust-lang.org/stream/238009-t-compiler/meetings/index.html">t-compiler/meetings</a></h2>
<h3>Topic: <a href="https://zulip-archive.rust-lang.org/stream/238009-t-compiler/meetings/topic/.5Bsteering.20meeting.5D.202022-04-01.20compiler-team.23490.html">[steering meeting] 2022-04-01 compiler-team#490</a></h3>

<hr>

<base href="https://rust-lang.zulipchat.com">

<head><link href="https://zulip-archive.rust-lang.org/style.css" rel="stylesheet"></head>

<a name="277004037"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/238009-t-compiler/meetings/topic/%5Bsteering%20meeting%5D%202022-04-01%20compiler-team%23490/near/277004037" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pnkfelix <a href="https://zulip-archive.rust-lang.org/stream/238009-t-compiler/meetings/topic/.5Bsteering.20meeting.5D.202022-04-01.20compiler-team.23490.html#277004037">(Mar 29 2022 at 13:26)</a>:</h4>
<p>this friday's meeting on robust incr-comp will take place here.</p>



<a name="277440293"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/238009-t-compiler/meetings/topic/%5Bsteering%20meeting%5D%202022-04-01%20compiler-team%23490/near/277440293" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pnkfelix <a href="https://zulip-archive.rust-lang.org/stream/238009-t-compiler/meetings/topic/.5Bsteering.20meeting.5D.202022-04-01.20compiler-team.23490.html#277440293">(Apr 01 2022 at 16:03)</a>:</h4>
<p>hi <span class="user-group-mention" data-user-group-id="897">@T-compiler/meeting</span> , its time for the meeting on robust incr-comp, I believe</p>



<a name="277440313"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/238009-t-compiler/meetings/topic/%5Bsteering%20meeting%5D%202022-04-01%20compiler-team%23490/near/277440313" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pnkfelix <a href="https://zulip-archive.rust-lang.org/stream/238009-t-compiler/meetings/topic/.5Bsteering.20meeting.5D.202022-04-01.20compiler-team.23490.html#277440313">(Apr 01 2022 at 16:03)</a>:</h4>
<p>put a <span aria-label="wave" class="emoji emoji-1f44b" role="img" title="wave">:wave:</span> above to show you're here</p>



<a name="277440353"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/238009-t-compiler/meetings/topic/%5Bsteering%20meeting%5D%202022-04-01%20compiler-team%23490/near/277440353" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pnkfelix <a href="https://zulip-archive.rust-lang.org/stream/238009-t-compiler/meetings/topic/.5Bsteering.20meeting.5D.202022-04-01.20compiler-team.23490.html#277440353">(Apr 01 2022 at 16:03)</a>:</h4>
<p><span class="user-mention" data-user-id="124287">@mw</span> has prepared a doc. (Arguably two docs!)</p>



<a name="277440390"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/238009-t-compiler/meetings/topic/%5Bsteering%20meeting%5D%202022-04-01%20compiler-team%23490/near/277440390" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wesley Wiser <a href="https://zulip-archive.rust-lang.org/stream/238009-t-compiler/meetings/topic/.5Bsteering.20meeting.5D.202022-04-01.20compiler-team.23490.html#277440390">(Apr 01 2022 at 16:03)</a>:</h4>
<p>Thanks <span class="user-mention" data-user-id="124287">@mw</span>!</p>



<a name="277440418"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/238009-t-compiler/meetings/topic/%5Bsteering%20meeting%5D%202022-04-01%20compiler-team%23490/near/277440418" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> mw <a href="https://zulip-archive.rust-lang.org/stream/238009-t-compiler/meetings/topic/.5Bsteering.20meeting.5D.202022-04-01.20compiler-team.23490.html#277440418">(Apr 01 2022 at 16:03)</a>:</h4>
<p><a href="https://hackmd.io/@michaelwoerister/SJRXZBVQ5">https://hackmd.io/@michaelwoerister/SJRXZBVQ5</a></p>



<a name="277440423"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/238009-t-compiler/meetings/topic/%5Bsteering%20meeting%5D%202022-04-01%20compiler-team%23490/near/277440423" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pnkfelix <a href="https://zulip-archive.rust-lang.org/stream/238009-t-compiler/meetings/topic/.5Bsteering.20meeting.5D.202022-04-01.20compiler-team.23490.html#277440423">(Apr 01 2022 at 16:03)</a>:</h4>
<p><span class="user-mention" data-user-id="124287">@mw</span> do you want me to drive the structure of the meeting itself?</p>



<a name="277440471"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/238009-t-compiler/meetings/topic/%5Bsteering%20meeting%5D%202022-04-01%20compiler-team%23490/near/277440471" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pnkfelix <a href="https://zulip-archive.rust-lang.org/stream/238009-t-compiler/meetings/topic/.5Bsteering.20meeting.5D.202022-04-01.20compiler-team.23490.html#277440471">(Apr 01 2022 at 16:04)</a>:</h4>
<p>or would you prefer to drive?</p>



<a name="277440507"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/238009-t-compiler/meetings/topic/%5Bsteering%20meeting%5D%202022-04-01%20compiler-team%23490/near/277440507" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> mw <a href="https://zulip-archive.rust-lang.org/stream/238009-t-compiler/meetings/topic/.5Bsteering.20meeting.5D.202022-04-01.20compiler-team.23490.html#277440507">(Apr 01 2022 at 16:04)</a>:</h4>
<p>I'm fine with you driving</p>



<a name="277440510"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/238009-t-compiler/meetings/topic/%5Bsteering%20meeting%5D%202022-04-01%20compiler-team%23490/near/277440510" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pnkfelix <a href="https://zulip-archive.rust-lang.org/stream/238009-t-compiler/meetings/topic/.5Bsteering.20meeting.5D.202022-04-01.20compiler-team.23490.html#277440510">(Apr 01 2022 at 16:04)</a>:</h4>
<p>okay</p>



<a name="277440584"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/238009-t-compiler/meetings/topic/%5Bsteering%20meeting%5D%202022-04-01%20compiler-team%23490/near/277440584" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pnkfelix <a href="https://zulip-archive.rust-lang.org/stream/238009-t-compiler/meetings/topic/.5Bsteering.20meeting.5D.202022-04-01.20compiler-team.23490.html#277440584">(Apr 01 2022 at 16:04)</a>:</h4>
<p>its the usual: click the <span aria-label="book" class="emoji emoji-1f4d6" role="img" title="book">:book:</span> when you start reading. when you finish, leave it clicked, and click the <span aria-label="checkered flag" class="emoji emoji-1f3c1" role="img" title="checkered flag">:checkered_flag:</span> to signal that you have finished.</p>



<a name="277440635"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/238009-t-compiler/meetings/topic/%5Bsteering%20meeting%5D%202022-04-01%20compiler-team%23490/near/277440635" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pierwill <a href="https://zulip-archive.rust-lang.org/stream/238009-t-compiler/meetings/topic/.5Bsteering.20meeting.5D.202022-04-01.20compiler-team.23490.html#277440635">(Apr 01 2022 at 16:05)</a>:</h4>
<p>Just the one doc, yes?</p>



<a name="277440640"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/238009-t-compiler/meetings/topic/%5Bsteering%20meeting%5D%202022-04-01%20compiler-team%23490/near/277440640" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pnkfelix <a href="https://zulip-archive.rust-lang.org/stream/238009-t-compiler/meetings/topic/.5Bsteering.20meeting.5D.202022-04-01.20compiler-team.23490.html#277440640">(Apr 01 2022 at 16:05)</a>:</h4>
<p>leave questions about content on the side bar, but big topics / big questions for discussion should be enqueued at the end of the doc</p>



<a name="277440678"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/238009-t-compiler/meetings/topic/%5Bsteering%20meeting%5D%202022-04-01%20compiler-team%23490/near/277440678" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pnkfelix <a href="https://zulip-archive.rust-lang.org/stream/238009-t-compiler/meetings/topic/.5Bsteering.20meeting.5D.202022-04-01.20compiler-team.23490.html#277440678">(Apr 01 2022 at 16:05)</a>:</h4>
<p><span class="user-mention" data-user-id="124287">@mw</span> my impression is that we'll just focus on reading the one doc, right?</p>



<a name="277440696"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/238009-t-compiler/meetings/topic/%5Bsteering%20meeting%5D%202022-04-01%20compiler-team%23490/near/277440696" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> mw <a href="https://zulip-archive.rust-lang.org/stream/238009-t-compiler/meetings/topic/.5Bsteering.20meeting.5D.202022-04-01.20compiler-team.23490.html#277440696">(Apr 01 2022 at 16:05)</a>:</h4>
<p>Yes, I'd say so too</p>



<a name="277440715"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/238009-t-compiler/meetings/topic/%5Bsteering%20meeting%5D%202022-04-01%20compiler-team%23490/near/277440715" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> mw <a href="https://zulip-archive.rust-lang.org/stream/238009-t-compiler/meetings/topic/.5Bsteering.20meeting.5D.202022-04-01.20compiler-team.23490.html#277440715">(Apr 01 2022 at 16:05)</a>:</h4>
<p>there's also the pre-existing doc here: <a href="https://hackmd.io/@michaelwoerister/SJf9VU1-5">https://hackmd.io/@michaelwoerister/SJf9VU1-5</a></p>



<a name="277440725"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/238009-t-compiler/meetings/topic/%5Bsteering%20meeting%5D%202022-04-01%20compiler-team%23490/near/277440725" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pnkfelix <a href="https://zulip-archive.rust-lang.org/stream/238009-t-compiler/meetings/topic/.5Bsteering.20meeting.5D.202022-04-01.20compiler-team.23490.html#277440725">(Apr 01 2022 at 16:05)</a>:</h4>
<p>(maybe we'll take everyone's temperature at the end of the read to see if we need to dive into the other one)</p>



<a name="277440780"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/238009-t-compiler/meetings/topic/%5Bsteering%20meeting%5D%202022-04-01%20compiler-team%23490/near/277440780" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> mw <a href="https://zulip-archive.rust-lang.org/stream/238009-t-compiler/meetings/topic/.5Bsteering.20meeting.5D.202022-04-01.20compiler-team.23490.html#277440780">(Apr 01 2022 at 16:06)</a>:</h4>
<p>but it goes into too much detail</p>



<a name="277440946"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/238009-t-compiler/meetings/topic/%5Bsteering%20meeting%5D%202022-04-01%20compiler-team%23490/near/277440946" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> mw <a href="https://zulip-archive.rust-lang.org/stream/238009-t-compiler/meetings/topic/.5Bsteering.20meeting.5D.202022-04-01.20compiler-team.23490.html#277440946">(Apr 01 2022 at 16:07)</a>:</h4>
<p>to be clear: <a href="https://hackmd.io/@michaelwoerister/SJRXZBVQ5">https://hackmd.io/@michaelwoerister/SJRXZBVQ5</a> is the doc for this meeting</p>



<a name="277442004"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/238009-t-compiler/meetings/topic/%5Bsteering%20meeting%5D%202022-04-01%20compiler-team%23490/near/277442004" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nagisa <a href="https://zulip-archive.rust-lang.org/stream/238009-t-compiler/meetings/topic/.5Bsteering.20meeting.5D.202022-04-01.20compiler-team.23490.html#277442004">(Apr 01 2022 at 16:14)</a>:</h4>
<p>As usual I don't have a hackmd acct to post comments inline, but one thing I want to point out is that current query system no longer serves “just” the incremental compilation use-case. It also serves as an infrastructure to provide data from some parts of the compiler to the others. An example that comes to mind could be the backend providing some information to the frontend as necessary to derive e.g. <code>cfg</code>s.</p>



<a name="277442118"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/238009-t-compiler/meetings/topic/%5Bsteering%20meeting%5D%202022-04-01%20compiler-team%23490/near/277442118" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Aaron Hill <a href="https://zulip-archive.rust-lang.org/stream/238009-t-compiler/meetings/topic/.5Bsteering.20meeting.5D.202022-04-01.20compiler-team.23490.html#277442118">(Apr 01 2022 at 16:15)</a>:</h4>
<p>Are you referring to the 'query provider' setup?</p>



<a name="277442125"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/238009-t-compiler/meetings/topic/%5Bsteering%20meeting%5D%202022-04-01%20compiler-team%23490/near/277442125" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pnkfelix <a href="https://zulip-archive.rust-lang.org/stream/238009-t-compiler/meetings/topic/.5Bsteering.20meeting.5D.202022-04-01.20compiler-team.23490.html#277442125">(Apr 01 2022 at 16:15)</a>:</h4>
<p>it looks like the <span aria-label="checkered flag" class="emoji emoji-1f3c1" role="img" title="checkered flag">:checkered_flag:</span> has caught up to the <span aria-label="book" class="emoji emoji-1f4d6" role="img" title="book">:book:</span></p>



<a name="277442177"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/238009-t-compiler/meetings/topic/%5Bsteering%20meeting%5D%202022-04-01%20compiler-team%23490/near/277442177" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pnkfelix <a href="https://zulip-archive.rust-lang.org/stream/238009-t-compiler/meetings/topic/.5Bsteering.20meeting.5D.202022-04-01.20compiler-team.23490.html#277442177">(Apr 01 2022 at 16:15)</a>:</h4>
<p>so let me just ask: since we finished reading this doc so quickly, should we consider looking at the other one too?</p>



<a name="277442184"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/238009-t-compiler/meetings/topic/%5Bsteering%20meeting%5D%202022-04-01%20compiler-team%23490/near/277442184" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nagisa <a href="https://zulip-archive.rust-lang.org/stream/238009-t-compiler/meetings/topic/.5Bsteering.20meeting.5D.202022-04-01.20compiler-team.23490.html#277442184">(Apr 01 2022 at 16:15)</a>:</h4>
<p><span class="user-mention silent" data-user-id="125294">Aaron Hill</span> <a href="#narrow/stream/238009-t-compiler.2Fmeetings/topic/.5Bsteering.20meeting.5D.202022-04-01.20compiler-team.23490/near/277442118">said</a>:</p>
<blockquote>
<p>Are you referring to the 'query provider' setup?</p>
</blockquote>
<p>in a way yes, since that's  part of the relevant infrastructure.</p>



<a name="277442245"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/238009-t-compiler/meetings/topic/%5Bsteering%20meeting%5D%202022-04-01%20compiler-team%23490/near/277442245" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pnkfelix <a href="https://zulip-archive.rust-lang.org/stream/238009-t-compiler/meetings/topic/.5Bsteering.20meeting.5D.202022-04-01.20compiler-team.23490.html#277442245">(Apr 01 2022 at 16:16)</a>:</h4>
<p><span class="user-mention silent" data-user-id="116083">pnkfelix</span> <a href="#narrow/stream/238009-t-compiler.2Fmeetings/topic/.5Bsteering.20meeting.5D.202022-04-01.20compiler-team.23490/near/277442177">said</a>:</p>
<blockquote>
<p>so let me just ask: since we finished reading this doc so quickly, should we consider looking at the other one too?</p>
</blockquote>
<p>I'm guessing the answer is "no, lets make a decision based on what is written here."</p>



<a name="277442320"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/238009-t-compiler/meetings/topic/%5Bsteering%20meeting%5D%202022-04-01%20compiler-team%23490/near/277442320" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pnkfelix <a href="https://zulip-archive.rust-lang.org/stream/238009-t-compiler/meetings/topic/.5Bsteering.20meeting.5D.202022-04-01.20compiler-team.23490.html#277442320">(Apr 01 2022 at 16:16)</a>:</h4>
<p><span class="user-mention silent" data-user-id="123586">nagisa</span> <a href="#narrow/stream/238009-t-compiler.2Fmeetings/topic/.5Bsteering.20meeting.5D.202022-04-01.20compiler-team.23490/near/277442004">said</a>:</p>
<blockquote>
<p>As usual I don't have a hackmd acct to post comments inline</p>
</blockquote>
<p>i hadn't realized there was a fundamental workflow problem here</p>



<a name="277442326"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/238009-t-compiler/meetings/topic/%5Bsteering%20meeting%5D%202022-04-01%20compiler-team%23490/near/277442326" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wesley Wiser <a href="https://zulip-archive.rust-lang.org/stream/238009-t-compiler/meetings/topic/.5Bsteering.20meeting.5D.202022-04-01.20compiler-team.23490.html#277442326">(Apr 01 2022 at 16:17)</a>:</h4>
<p>If someone feels like there is some other possibility that is strongly motivated by data in the other doc, then it might be worth reading but I'm satisfied by the possibilities outlined in the current document.</p>



<a name="277442336"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/238009-t-compiler/meetings/topic/%5Bsteering%20meeting%5D%202022-04-01%20compiler-team%23490/near/277442336" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pierwill <a href="https://zulip-archive.rust-lang.org/stream/238009-t-compiler/meetings/topic/.5Bsteering.20meeting.5D.202022-04-01.20compiler-team.23490.html#277442336">(Apr 01 2022 at 16:17)</a>:</h4>
<p>Is anyone here involved with work on Salsa?</p>



<a name="277442365"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/238009-t-compiler/meetings/topic/%5Bsteering%20meeting%5D%202022-04-01%20compiler-team%23490/near/277442365" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pierwill <a href="https://zulip-archive.rust-lang.org/stream/238009-t-compiler/meetings/topic/.5Bsteering.20meeting.5D.202022-04-01.20compiler-team.23490.html#277442365">(Apr 01 2022 at 16:17)</a>:</h4>
<p>Would want to know if there'd realistically be owners for option 2.</p>



<a name="277442381"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/238009-t-compiler/meetings/topic/%5Bsteering%20meeting%5D%202022-04-01%20compiler-team%23490/near/277442381" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pnkfelix <a href="https://zulip-archive.rust-lang.org/stream/238009-t-compiler/meetings/topic/.5Bsteering.20meeting.5D.202022-04-01.20compiler-team.23490.html#277442381">(Apr 01 2022 at 16:17)</a>:</h4>
<p><span class="user-mention" data-user-id="123586">@nagisa</span> is there any particular reason you do not want to make a hackmd account? Or is it just "I don't want to bother with yet another account for yet another service" ?</p>



<a name="277442466"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/238009-t-compiler/meetings/topic/%5Bsteering%20meeting%5D%202022-04-01%20compiler-team%23490/near/277442466" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> cjgillot <a href="https://zulip-archive.rust-lang.org/stream/238009-t-compiler/meetings/topic/.5Bsteering.20meeting.5D.202022-04-01.20compiler-team.23490.html#277442466">(Apr 01 2022 at 16:18)</a>:</h4>
<p><span class="user-mention silent" data-user-id="316352">pierwill</span> <a href="#narrow/stream/238009-t-compiler.2Fmeetings/topic/.5Bsteering.20meeting.5D.202022-04-01.20compiler-team.23490/near/277442365">said</a>:</p>
<blockquote>
<p>Would want to know if there'd realistically be owners for option 2.</p>
</blockquote>
<p>I'd be interested, but I need to talk to niko beforehand in order to understand the model better.</p>



<a name="277442509"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/238009-t-compiler/meetings/topic/%5Bsteering%20meeting%5D%202022-04-01%20compiler-team%23490/near/277442509" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Aaron Hill <a href="https://zulip-archive.rust-lang.org/stream/238009-t-compiler/meetings/topic/.5Bsteering.20meeting.5D.202022-04-01.20compiler-team.23490.html#277442509">(Apr 01 2022 at 16:18)</a>:</h4>
<p>From my perspective, the continued reliance on dynamically detecting query dependencies (e.g. recording every time we make a call to a query) is a significant drawback of options 1 and 2</p>



<a name="277442515"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/238009-t-compiler/meetings/topic/%5Bsteering%20meeting%5D%202022-04-01%20compiler-team%23490/near/277442515" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nagisa <a href="https://zulip-archive.rust-lang.org/stream/238009-t-compiler/meetings/topic/.5Bsteering.20meeting.5D.202022-04-01.20compiler-team.23490.html#277442515">(Apr 01 2022 at 16:18)</a>:</h4>
<p><span class="user-mention silent" data-user-id="116083">pnkfelix</span> <a href="#narrow/stream/238009-t-compiler.2Fmeetings/topic/.5Bsteering.20meeting.5D.202022-04-01.20compiler-team.23490/near/277442381">said</a>:</p>
<blockquote>
<p><span class="user-mention silent" data-user-id="123586">nagisa</span> is there any particular reason you do not want to make a hackmd account? Or is it just "I don't want to bother with yet another account for yet another service" ?</p>
</blockquote>
<p>I don't really have use-case for one, and when a use-case does come up its in a middle of a meeting. So I end up never registering.</p>



<a name="277442516"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/238009-t-compiler/meetings/topic/%5Bsteering%20meeting%5D%202022-04-01%20compiler-team%23490/near/277442516" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pnkfelix <a href="https://zulip-archive.rust-lang.org/stream/238009-t-compiler/meetings/topic/.5Bsteering.20meeting.5D.202022-04-01.20compiler-team.23490.html#277442516">(Apr 01 2022 at 16:18)</a>:</h4>
<p><span class="user-mention silent" data-user-id="116083">pnkfelix</span> <a href="#narrow/stream/238009-t-compiler.2Fmeetings/topic/.5Bsteering.20meeting.5D.202022-04-01.20compiler-team.23490/near/277442381">said</a>:</p>
<blockquote>
<p><span class="user-mention silent" data-user-id="123586">nagisa</span> is there any particular reason you do not want to make a hackmd account? Or is it just "I don't want to bother with yet another account for yet another service" ?</p>
</blockquote>
<p>My question is motivated by: I've been assuming this workflow works for everyone, but now I'm worried it is exclusionary</p>



<a name="277442563"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/238009-t-compiler/meetings/topic/%5Bsteering%20meeting%5D%202022-04-01%20compiler-team%23490/near/277442563" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pnkfelix <a href="https://zulip-archive.rust-lang.org/stream/238009-t-compiler/meetings/topic/.5Bsteering.20meeting.5D.202022-04-01.20compiler-team.23490.html#277442563">(Apr 01 2022 at 16:18)</a>:</h4>
<p><span class="user-mention silent" data-user-id="123586">nagisa</span> <a href="#narrow/stream/238009-t-compiler.2Fmeetings/topic/.5Bsteering.20meeting.5D.202022-04-01.20compiler-team.23490/near/277442515">said</a>:</p>
<blockquote>
<p>I don't really have use-case for one, and when a use-case does come up its in a middle of a meeting.</p>
</blockquote>
<p>okay</p>



<a name="277442626"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/238009-t-compiler/meetings/topic/%5Bsteering%20meeting%5D%202022-04-01%20compiler-team%23490/near/277442626" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> mw <a href="https://zulip-archive.rust-lang.org/stream/238009-t-compiler/meetings/topic/.5Bsteering.20meeting.5D.202022-04-01.20compiler-team.23490.html#277442626">(Apr 01 2022 at 16:19)</a>:</h4>
<p><span class="user-mention silent" data-user-id="125294">Aaron Hill</span> <a href="#narrow/stream/238009-t-compiler.2Fmeetings/topic/.5Bsteering.20meeting.5D.202022-04-01.20compiler-team.23490/near/277442509">said</a>:</p>
<blockquote>
<p>From my perspective, the continued reliance on dynamically detecting query dependencies (e.g. recording every time we make a call to a query) is a significant drawback of options 1 and 2</p>
</blockquote>
<p>Do you know of an alternative?</p>



<a name="277442638"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/238009-t-compiler/meetings/topic/%5Bsteering%20meeting%5D%202022-04-01%20compiler-team%23490/near/277442638" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Aaron Hill <a href="https://zulip-archive.rust-lang.org/stream/238009-t-compiler/meetings/topic/.5Bsteering.20meeting.5D.202022-04-01.20compiler-team.23490.html#277442638">(Apr 01 2022 at 16:19)</a>:</h4>
<p>You can sign in to hackmd with github</p>



<a name="277442642"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/238009-t-compiler/meetings/topic/%5Bsteering%20meeting%5D%202022-04-01%20compiler-team%23490/near/277442642" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pnkfelix <a href="https://zulip-archive.rust-lang.org/stream/238009-t-compiler/meetings/topic/.5Bsteering.20meeting.5D.202022-04-01.20compiler-team.23490.html#277442642">(Apr 01 2022 at 16:19)</a>:</h4>
<p><span class="user-mention silent" data-user-id="316352">pierwill</span> <a href="#narrow/stream/238009-t-compiler.2Fmeetings/topic/.5Bsteering.20meeting.5D.202022-04-01.20compiler-team.23490/near/277442336">said</a>:</p>
<blockquote>
<p>Is anyone here involved with work on Salsa?</p>
</blockquote>
<p>Salsa is used in rust-analyzer, right?</p>



<a name="277442687"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/238009-t-compiler/meetings/topic/%5Bsteering%20meeting%5D%202022-04-01%20compiler-team%23490/near/277442687" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pnkfelix <a href="https://zulip-archive.rust-lang.org/stream/238009-t-compiler/meetings/topic/.5Bsteering.20meeting.5D.202022-04-01.20compiler-team.23490.html#277442687">(Apr 01 2022 at 16:19)</a>:</h4>
<p>i.e. it seems like a worthwhile investment to get more members of this team familar with it</p>



<a name="277442765"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/238009-t-compiler/meetings/topic/%5Bsteering%20meeting%5D%202022-04-01%20compiler-team%23490/near/277442765" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pnkfelix <a href="https://zulip-archive.rust-lang.org/stream/238009-t-compiler/meetings/topic/.5Bsteering.20meeting.5D.202022-04-01.20compiler-team.23490.html#277442765">(Apr 01 2022 at 16:20)</a>:</h4>
<p>(and I say that as someone who has not used it myself.)</p>



<a name="277442786"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/238009-t-compiler/meetings/topic/%5Bsteering%20meeting%5D%202022-04-01%20compiler-team%23490/near/277442786" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Aaron Hill <a href="https://zulip-archive.rust-lang.org/stream/238009-t-compiler/meetings/topic/.5Bsteering.20meeting.5D.202022-04-01.20compiler-team.23490.html#277442786">(Apr 01 2022 at 16:20)</a>:</h4>
<p><span class="user-mention" data-user-id="124287">@mw</span> Unfortunately, the only alternative I can think of would be the radical simplification in option 3</p>



<a name="277442818"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/238009-t-compiler/meetings/topic/%5Bsteering%20meeting%5D%202022-04-01%20compiler-team%23490/near/277442818" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Aaron Hill <a href="https://zulip-archive.rust-lang.org/stream/238009-t-compiler/meetings/topic/.5Bsteering.20meeting.5D.202022-04-01.20compiler-team.23490.html#277442818">(Apr 01 2022 at 16:20)</a>:</h4>
<p>Which of course brings its own set of problems</p>



<a name="277442857"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/238009-t-compiler/meetings/topic/%5Bsteering%20meeting%5D%202022-04-01%20compiler-team%23490/near/277442857" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Aaron Hill <a href="https://zulip-archive.rust-lang.org/stream/238009-t-compiler/meetings/topic/.5Bsteering.20meeting.5D.202022-04-01.20compiler-team.23490.html#277442857">(Apr 01 2022 at 16:20)</a>:</h4>
<p>However, the dynamic registration is the single biggest issue with the current system, in my mind</p>



<a name="277442893"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/238009-t-compiler/meetings/topic/%5Bsteering%20meeting%5D%202022-04-01%20compiler-team%23490/near/277442893" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> bjorn3 <a href="https://zulip-archive.rust-lang.org/stream/238009-t-compiler/meetings/topic/.5Bsteering.20meeting.5D.202022-04-01.20compiler-team.23490.html#277442893">(Apr 01 2022 at 16:21)</a>:</h4>
<p><span class="user-mention silent" data-user-id="124287">mw</span> <a href="#narrow/stream/238009-t-compiler.2Fmeetings/topic/.5Bsteering.20meeting.5D.202022-04-01.20compiler-team.23490/near/277442626">said</a>:</p>
<blockquote>
<p><span class="user-mention silent" data-user-id="125294">Aaron Hill</span> <a href="#narrow/stream/238009-t-compiler.2Fmeetings/topic/.5Bsteering.20meeting.5D.202022-04-01.20compiler-team.23490/near/277442509">said</a>:</p>
<blockquote>
<p>From my perspective, the continued reliance on dynamically detecting query dependencies (e.g. recording every time we make a call to a query) is a significant drawback of options 1 and 2</p>
</blockquote>
<p>Do you know of an alternative?</p>
</blockquote>
<p>I think it part of the cases we can pass dependency results directly into the query function.</p>



<a name="277442924"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/238009-t-compiler/meetings/topic/%5Bsteering%20meeting%5D%202022-04-01%20compiler-team%23490/near/277442924" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pierwill <a href="https://zulip-archive.rust-lang.org/stream/238009-t-compiler/meetings/topic/.5Bsteering.20meeting.5D.202022-04-01.20compiler-team.23490.html#277442924">(Apr 01 2022 at 16:21)</a>:</h4>
<p>Does anyone feel strongly that we _need to_ move away from the current system?</p>



<a name="277442933"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/238009-t-compiler/meetings/topic/%5Bsteering%20meeting%5D%202022-04-01%20compiler-team%23490/near/277442933" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Aaron Hill <a href="https://zulip-archive.rust-lang.org/stream/238009-t-compiler/meetings/topic/.5Bsteering.20meeting.5D.202022-04-01.20compiler-team.23490.html#277442933">(Apr 01 2022 at 16:21)</a>:</h4>
<p>It makes it easy for different compiler developers to make changes that are all reasonable in isolation, but that break incr comp when combined:</p>



<a name="277442940"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/238009-t-compiler/meetings/topic/%5Bsteering%20meeting%5D%202022-04-01%20compiler-team%23490/near/277442940" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wesley Wiser <a href="https://zulip-archive.rust-lang.org/stream/238009-t-compiler/meetings/topic/.5Bsteering.20meeting.5D.202022-04-01.20compiler-team.23490.html#277442940">(Apr 01 2022 at 16:21)</a>:</h4>
<p>Is the dynamic registration a <em>robustness</em> issue or a <em>performance</em> issue?</p>



<a name="277442949"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/238009-t-compiler/meetings/topic/%5Bsteering%20meeting%5D%202022-04-01%20compiler-team%23490/near/277442949" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Aaron Hill <a href="https://zulip-archive.rust-lang.org/stream/238009-t-compiler/meetings/topic/.5Bsteering.20meeting.5D.202022-04-01.20compiler-team.23490.html#277442949">(Apr 01 2022 at 16:21)</a>:</h4>
<p>Robustness</p>



<a name="277442955"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/238009-t-compiler/meetings/topic/%5Bsteering%20meeting%5D%202022-04-01%20compiler-team%23490/near/277442955" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Aaron Hill <a href="https://zulip-archive.rust-lang.org/stream/238009-t-compiler/meetings/topic/.5Bsteering.20meeting.5D.202022-04-01.20compiler-team.23490.html#277442955">(Apr 01 2022 at 16:21)</a>:</h4>
<p>E.g:</p>



<a name="277443041"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/238009-t-compiler/meetings/topic/%5Bsteering%20meeting%5D%202022-04-01%20compiler-team%23490/near/277443041" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Aaron Hill <a href="https://zulip-archive.rust-lang.org/stream/238009-t-compiler/meetings/topic/.5Bsteering.20meeting.5D.202022-04-01.20compiler-team.23490.html#277443041">(Apr 01 2022 at 16:22)</a>:</h4>
<p>One developer adds a thread_local cache to one part of the compiler, and computes entries by calling some function in another part of the compiler</p>



<a name="277443108"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/238009-t-compiler/meetings/topic/%5Bsteering%20meeting%5D%202022-04-01%20compiler-team%23490/near/277443108" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Aaron Hill <a href="https://zulip-archive.rust-lang.org/stream/238009-t-compiler/meetings/topic/.5Bsteering.20meeting.5D.202022-04-01.20compiler-team.23490.html#277443108">(Apr 01 2022 at 16:22)</a>:</h4>
<p>Later on, another developer changes the callee to invoke a query</p>



<a name="277443169"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/238009-t-compiler/meetings/topic/%5Bsteering%20meeting%5D%202022-04-01%20compiler-team%23490/near/277443169" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Aaron Hill <a href="https://zulip-archive.rust-lang.org/stream/238009-t-compiler/meetings/topic/.5Bsteering.20meeting.5D.202022-04-01.20compiler-team.23490.html#277443169">(Apr 01 2022 at 16:22)</a>:</h4>
<p>This can happen by accident, since there are some places where we pull a tcx out of thin air (e.g. <code>Debug</code> impls)</p>



<a name="277443183"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/238009-t-compiler/meetings/topic/%5Bsteering%20meeting%5D%202022-04-01%20compiler-team%23490/near/277443183" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> bjorn3 <a href="https://zulip-archive.rust-lang.org/stream/238009-t-compiler/meetings/topic/.5Bsteering.20meeting.5D.202022-04-01.20compiler-team.23490.html#277443183">(Apr 01 2022 at 16:22)</a>:</h4>
<p>I would personally like to see all caches not stored in TyCtxt to be gone.</p>



<a name="277443240"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/238009-t-compiler/meetings/topic/%5Bsteering%20meeting%5D%202022-04-01%20compiler-team%23490/near/277443240" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Aaron Hill <a href="https://zulip-archive.rust-lang.org/stream/238009-t-compiler/meetings/topic/.5Bsteering.20meeting.5D.202022-04-01.20compiler-team.23490.html#277443240">(Apr 01 2022 at 16:23)</a>:</h4>
<p>Unfortunately, I think that would incur a pretty big performance hit in some cases</p>



<a name="277443255"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/238009-t-compiler/meetings/topic/%5Bsteering%20meeting%5D%202022-04-01%20compiler-team%23490/near/277443255" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Aaron Hill <a href="https://zulip-archive.rust-lang.org/stream/238009-t-compiler/meetings/topic/.5Bsteering.20meeting.5D.202022-04-01.20compiler-team.23490.html#277443255">(Apr 01 2022 at 16:23)</a>:</h4>
<p>Especially around HashStable impls</p>



<a name="277443278"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/238009-t-compiler/meetings/topic/%5Bsteering%20meeting%5D%202022-04-01%20compiler-team%23490/near/277443278" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> mw <a href="https://zulip-archive.rust-lang.org/stream/238009-t-compiler/meetings/topic/.5Bsteering.20meeting.5D.202022-04-01.20compiler-team.23490.html#277443278">(Apr 01 2022 at 16:23)</a>:</h4>
<p><span class="user-mention silent" data-user-id="133247">bjorn3</span> <a href="#narrow/stream/238009-t-compiler.2Fmeetings/topic/.5Bsteering.20meeting.5D.202022-04-01.20compiler-team.23490/near/277443183">said</a>:</p>
<blockquote>
<p>I would personally like to see all caches not stored in TyCtxt to be gone.</p>
</blockquote>
<p>Yes, I think that would necessarily be part of fixing the current system</p>



<a name="277443280"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/238009-t-compiler/meetings/topic/%5Bsteering%20meeting%5D%202022-04-01%20compiler-team%23490/near/277443280" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Aaron Hill <a href="https://zulip-archive.rust-lang.org/stream/238009-t-compiler/meetings/topic/.5Bsteering.20meeting.5D.202022-04-01.20compiler-team.23490.html#277443280">(Apr 01 2022 at 16:23)</a>:</h4>
<p>but we should benchmark it if we haven't already</p>



<a name="277443365"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/238009-t-compiler/meetings/topic/%5Bsteering%20meeting%5D%202022-04-01%20compiler-team%23490/near/277443365" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> lcnr <a href="https://zulip-archive.rust-lang.org/stream/238009-t-compiler/meetings/topic/.5Bsteering.20meeting.5D.202022-04-01.20compiler-team.23490.html#277443365">(Apr 01 2022 at 16:24)</a>:</h4>
<p>i would even like most caches stored in the <code>TyCtxt</code> gone '^^</p>



<a name="277443371"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/238009-t-compiler/meetings/topic/%5Bsteering%20meeting%5D%202022-04-01%20compiler-team%23490/near/277443371" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> mw <a href="https://zulip-archive.rust-lang.org/stream/238009-t-compiler/meetings/topic/.5Bsteering.20meeting.5D.202022-04-01.20compiler-team.23490.html#277443371">(Apr 01 2022 at 16:24)</a>:</h4>
<p><span class="user-mention silent" data-user-id="125294">Aaron Hill</span> <a href="#narrow/stream/238009-t-compiler.2Fmeetings/topic/.5Bsteering.20meeting.5D.202022-04-01.20compiler-team.23490/near/277443255">said</a>:</p>
<blockquote>
<p>Especially around HashStable impls</p>
</blockquote>
<p>The cached hashes could potentially be moved into the values themselves</p>



<a name="277443384"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/238009-t-compiler/meetings/topic/%5Bsteering%20meeting%5D%202022-04-01%20compiler-team%23490/near/277443384" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pnkfelix <a href="https://zulip-archive.rust-lang.org/stream/238009-t-compiler/meetings/topic/.5Bsteering.20meeting.5D.202022-04-01.20compiler-team.23490.html#277443384">(Apr 01 2022 at 16:24)</a>:</h4>
<p>the other doc had a number of items where it suggested adding specific lints to detect coding patterns that we do not want in rustc. So it seems important to tease out whether we're worried about such caches being added by accident (because someone was not aware of the right pattern), or being added deliberately because "the right way" is too slow.</p>



<a name="277443426"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/238009-t-compiler/meetings/topic/%5Bsteering%20meeting%5D%202022-04-01%20compiler-team%23490/near/277443426" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Aaron Hill <a href="https://zulip-archive.rust-lang.org/stream/238009-t-compiler/meetings/topic/.5Bsteering.20meeting.5D.202022-04-01.20compiler-team.23490.html#277443426">(Apr 01 2022 at 16:24)</a>:</h4>
<p>My main concern is accidental addition</p>



<a name="277443428"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/238009-t-compiler/meetings/topic/%5Bsteering%20meeting%5D%202022-04-01%20compiler-team%23490/near/277443428" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pnkfelix <a href="https://zulip-archive.rust-lang.org/stream/238009-t-compiler/meetings/topic/.5Bsteering.20meeting.5D.202022-04-01.20compiler-team.23490.html#277443428">(Apr 01 2022 at 16:24)</a>:</h4>
<p>and determining that, as <span class="user-mention" data-user-id="125294">@Aaron Hill</span> says, requires benchmarking.</p>



<a name="277443447"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/238009-t-compiler/meetings/topic/%5Bsteering%20meeting%5D%202022-04-01%20compiler-team%23490/near/277443447" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> lcnr <a href="https://zulip-archive.rust-lang.org/stream/238009-t-compiler/meetings/topic/.5Bsteering.20meeting.5D.202022-04-01.20compiler-team.23490.html#277443447">(Apr 01 2022 at 16:24)</a>:</h4>
<p><span class="user-mention silent" data-user-id="216206">lcnr</span> <a href="#narrow/stream/238009-t-compiler.2Fmeetings/topic/.5Bsteering.20meeting.5D.202022-04-01.20compiler-team.23490/near/277443365">said</a>:</p>
<blockquote>
<p>i would even like most caches stored in the <code>TyCtxt</code> gone '^^</p>
</blockquote>
<p>is there a way to have a sound cache (outside of the query system) which caches a computation which calls some other query?</p>



<a name="277443464"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/238009-t-compiler/meetings/topic/%5Bsteering%20meeting%5D%202022-04-01%20compiler-team%23490/near/277443464" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pnkfelix <a href="https://zulip-archive.rust-lang.org/stream/238009-t-compiler/meetings/topic/.5Bsteering.20meeting.5D.202022-04-01.20compiler-team.23490.html#277443464">(Apr 01 2022 at 16:24)</a>:</h4>
<p>okay, well, accidental addition might be addressable via lints</p>



<a name="277443483"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/238009-t-compiler/meetings/topic/%5Bsteering%20meeting%5D%202022-04-01%20compiler-team%23490/near/277443483" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pnkfelix <a href="https://zulip-archive.rust-lang.org/stream/238009-t-compiler/meetings/topic/.5Bsteering.20meeting.5D.202022-04-01.20compiler-team.23490.html#277443483">(Apr 01 2022 at 16:24)</a>:</h4>
<p>(they'd have to be pretty sophisticated lints, perhaps)</p>



<a name="277443494"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/238009-t-compiler/meetings/topic/%5Bsteering%20meeting%5D%202022-04-01%20compiler-team%23490/near/277443494" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> mw <a href="https://zulip-archive.rust-lang.org/stream/238009-t-compiler/meetings/topic/.5Bsteering.20meeting.5D.202022-04-01.20compiler-team.23490.html#277443494">(Apr 01 2022 at 16:25)</a>:</h4>
<p>I am not certain lints can catch everything, but they seem a step in the right direction</p>



<a name="277443504"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/238009-t-compiler/meetings/topic/%5Bsteering%20meeting%5D%202022-04-01%20compiler-team%23490/near/277443504" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Aaron Hill <a href="https://zulip-archive.rust-lang.org/stream/238009-t-compiler/meetings/topic/.5Bsteering.20meeting.5D.202022-04-01.20compiler-team.23490.html#277443504">(Apr 01 2022 at 16:25)</a>:</h4>
<p>More fundamentally, my concern is that we're relying on a relative fragile model (queries are pure functions, but we always have to call them in the same way)</p>



<a name="277443531"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/238009-t-compiler/meetings/topic/%5Bsteering%20meeting%5D%202022-04-01%20compiler-team%23490/near/277443531" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pierwill <a href="https://zulip-archive.rust-lang.org/stream/238009-t-compiler/meetings/topic/.5Bsteering.20meeting.5D.202022-04-01.20compiler-team.23490.html#277443531">(Apr 01 2022 at 16:25)</a>:</h4>
<blockquote>
<p>all caches not stored in TyCtxt to be gone</p>
</blockquote>
<p>Noob quetsion: What's an example of a cache stored outside the TyCtx</p>



<a name="277443532"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/238009-t-compiler/meetings/topic/%5Bsteering%20meeting%5D%202022-04-01%20compiler-team%23490/near/277443532" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Aaron Hill <a href="https://zulip-archive.rust-lang.org/stream/238009-t-compiler/meetings/topic/.5Bsteering.20meeting.5D.202022-04-01.20compiler-team.23490.html#277443532">(Apr 01 2022 at 16:25)</a>:</h4>
<p>and then trying to fix some of the deficiencies with lints</p>



<a name="277443558"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/238009-t-compiler/meetings/topic/%5Bsteering%20meeting%5D%202022-04-01%20compiler-team%23490/near/277443558" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> cjgillot <a href="https://zulip-archive.rust-lang.org/stream/238009-t-compiler/meetings/topic/.5Bsteering.20meeting.5D.202022-04-01.20compiler-team.23490.html#277443558">(Apr 01 2022 at 16:25)</a>:</h4>
<p><span class="user-mention silent" data-user-id="216206">lcnr</span> <a href="#narrow/stream/238009-t-compiler.2Fmeetings/topic/.5Bsteering.20meeting.5D.202022-04-01.20compiler-team.23490/near/277443447">said</a>:</p>
<blockquote>
<p><span class="user-mention silent" data-user-id="216206">lcnr</span> <a href="#narrow/stream/238009-t-compiler.2Fmeetings/topic/.5Bsteering.20meeting.5D.202022-04-01.20compiler-team.23490/near/277443365">said</a>:</p>
<blockquote>
<p>i would even like most caches stored in the <code>TyCtxt</code> gone '^^</p>
</blockquote>
<p>is there a way to have a sound cache (outside of the query system) which caches a computation which calls some other query?</p>
</blockquote>
<p>There is a datastructure un rustc_query_system::cache created for the trait system.</p>



<a name="277443592"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/238009-t-compiler/meetings/topic/%5Bsteering%20meeting%5D%202022-04-01%20compiler-team%23490/near/277443592" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Aaron Hill <a href="https://zulip-archive.rust-lang.org/stream/238009-t-compiler/meetings/topic/.5Bsteering.20meeting.5D.202022-04-01.20compiler-team.23490.html#277443592">(Apr 01 2022 at 16:25)</a>:</h4>
<p>this seems like a recipe for a continuous stream of incr comp bugs (albeit at a lower rate than we currently have them)</p>



<a name="277443619"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/238009-t-compiler/meetings/topic/%5Bsteering%20meeting%5D%202022-04-01%20compiler-team%23490/near/277443619" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Aaron Hill <a href="https://zulip-archive.rust-lang.org/stream/238009-t-compiler/meetings/topic/.5Bsteering.20meeting.5D.202022-04-01.20compiler-team.23490.html#277443619">(Apr 01 2022 at 16:26)</a>:</h4>
<p><span class="user-mention" data-user-id="316352">@pierwill</span> The HashStable impl for ExpnId, IIRC</p>



<a name="277443663"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/238009-t-compiler/meetings/topic/%5Bsteering%20meeting%5D%202022-04-01%20compiler-team%23490/near/277443663" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> bjorn3 <a href="https://zulip-archive.rust-lang.org/stream/238009-t-compiler/meetings/topic/.5Bsteering.20meeting.5D.202022-04-01.20compiler-team.23490.html#277443663">(Apr 01 2022 at 16:26)</a>:</h4>
<p><span class="user-mention silent" data-user-id="316352">pierwill</span> <a href="#narrow/stream/238009-t-compiler.2Fmeetings/topic/.5Bsteering.20meeting.5D.202022-04-01.20compiler-team.23490/near/277443531">said</a>:</p>
<blockquote>
<blockquote>
<p>all caches not stored in TyCtxt to be gone</p>
</blockquote>
<p>Noob quetsion: What's an example of a cache stored outside the TyCtx</p>
</blockquote>
<p>Several <code>HashStable</code> impls cache intermediate `Fingerprint's.</p>



<a name="277443673"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/238009-t-compiler/meetings/topic/%5Bsteering%20meeting%5D%202022-04-01%20compiler-team%23490/near/277443673" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Aaron Hill <a href="https://zulip-archive.rust-lang.org/stream/238009-t-compiler/meetings/topic/.5Bsteering.20meeting.5D.202022-04-01.20compiler-team.23490.html#277443673">(Apr 01 2022 at 16:26)</a>:</h4>
<p>I'm on mobile atm, so it's hard for me to check</p>



<a name="277443716"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/238009-t-compiler/meetings/topic/%5Bsteering%20meeting%5D%202022-04-01%20compiler-team%23490/near/277443716" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> bjorn3 <a href="https://zulip-archive.rust-lang.org/stream/238009-t-compiler/meetings/topic/.5Bsteering.20meeting.5D.202022-04-01.20compiler-team.23490.html#277443716">(Apr 01 2022 at 16:26)</a>:</h4>
<p>eg <a href="https://github.com/rust-lang/rust/blob/0677edc86e342f333d4828b0ee1ef395a4e70fe5/compiler/rustc_middle/src/ty/adt.rs#L139-L141">https://github.com/rust-lang/rust/blob/0677edc86e342f333d4828b0ee1ef395a4e70fe5/compiler/rustc_middle/src/ty/adt.rs#L139-L141</a></p>



<a name="277443723"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/238009-t-compiler/meetings/topic/%5Bsteering%20meeting%5D%202022-04-01%20compiler-team%23490/near/277443723" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> lcnr <a href="https://zulip-archive.rust-lang.org/stream/238009-t-compiler/meetings/topic/.5Bsteering.20meeting.5D.202022-04-01.20compiler-team.23490.html#277443723">(Apr 01 2022 at 16:26)</a>:</h4>
<p><code>List&lt;T&gt;</code> cache their <code>HashStable</code> with a <code>HashMap&lt;ptr_to_list, FingerPrint&gt;</code></p>



<a name="277443852"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/238009-t-compiler/meetings/topic/%5Bsteering%20meeting%5D%202022-04-01%20compiler-team%23490/near/277443852" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pnkfelix <a href="https://zulip-archive.rust-lang.org/stream/238009-t-compiler/meetings/topic/.5Bsteering.20meeting.5D.202022-04-01.20compiler-team.23490.html#277443852">(Apr 01 2022 at 16:27)</a>:</h4>
<p>i'm struck by the fact that the main example we have of caches (as a thing that could break incr-comp) are there to support incr-comp</p>



<a name="277443880"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/238009-t-compiler/meetings/topic/%5Bsteering%20meeting%5D%202022-04-01%20compiler-team%23490/near/277443880" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pierwill <a href="https://zulip-archive.rust-lang.org/stream/238009-t-compiler/meetings/topic/.5Bsteering.20meeting.5D.202022-04-01.20compiler-team.23490.html#277443880">(Apr 01 2022 at 16:27)</a>:</h4>
<blockquote>
<p>all caches not stored in TyCtxt to be gone.</p>
</blockquote>
<p>Is there a possibility this could unlock performance gains <em>outside</em> incr comp/query system?</p>



<a name="277444036"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/238009-t-compiler/meetings/topic/%5Bsteering%20meeting%5D%202022-04-01%20compiler-team%23490/near/277444036" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Aaron Hill <a href="https://zulip-archive.rust-lang.org/stream/238009-t-compiler/meetings/topic/.5Bsteering.20meeting.5D.202022-04-01.20compiler-team.23490.html#277444036">(Apr 01 2022 at 16:28)</a>:</h4>
<p>Those caches are effectively global (in the single-threaded compiler), so I don't think moving them to TyCtxt or deleting them will give any performance wins</p>



<a name="277444077"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/238009-t-compiler/meetings/topic/%5Bsteering%20meeting%5D%202022-04-01%20compiler-team%23490/near/277444077" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Aaron Hill <a href="https://zulip-archive.rust-lang.org/stream/238009-t-compiler/meetings/topic/.5Bsteering.20meeting.5D.202022-04-01.20compiler-team.23490.html#277444077">(Apr 01 2022 at 16:28)</a>:</h4>
<p>Except for a possible speedup from avoiding TLS access</p>



<a name="277444099"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/238009-t-compiler/meetings/topic/%5Bsteering%20meeting%5D%202022-04-01%20compiler-team%23490/near/277444099" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Nelson <a href="https://zulip-archive.rust-lang.org/stream/238009-t-compiler/meetings/topic/.5Bsteering.20meeting.5D.202022-04-01.20compiler-team.23490.html#277444099">(Apr 01 2022 at 16:29)</a>:</h4>
<p>It seems weird to bring performance improvements into this. We should focus on improving robustness IMO.</p>



<a name="277444150"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/238009-t-compiler/meetings/topic/%5Bsteering%20meeting%5D%202022-04-01%20compiler-team%23490/near/277444150" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> bjorn3 <a href="https://zulip-archive.rust-lang.org/stream/238009-t-compiler/meetings/topic/.5Bsteering.20meeting.5D.202022-04-01.20compiler-team.23490.html#277444150">(Apr 01 2022 at 16:29)</a>:</h4>
<p>I was also thinking of if <code>thread_local!</code> is no longer used in the compiler it would become sound to run the compiler on the main thread (as is mecessary on eg wasm). Currently every compilation session needs it's own thread to isolate thread locals.</p>



<a name="277444178"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/238009-t-compiler/meetings/topic/%5Bsteering%20meeting%5D%202022-04-01%20compiler-team%23490/near/277444178" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Aaron Hill <a href="https://zulip-archive.rust-lang.org/stream/238009-t-compiler/meetings/topic/.5Bsteering.20meeting.5D.202022-04-01.20compiler-team.23490.html#277444178">(Apr 01 2022 at 16:29)</a>:</h4>
<p>However, even TyCtxt caches can lead to incr comp issues - the main example being the trait selection cache</p>



<a name="277444278"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/238009-t-compiler/meetings/topic/%5Bsteering%20meeting%5D%202022-04-01%20compiler-team%23490/near/277444278" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pierwill <a href="https://zulip-archive.rust-lang.org/stream/238009-t-compiler/meetings/topic/.5Bsteering.20meeting.5D.202022-04-01.20compiler-team.23490.html#277444278">(Apr 01 2022 at 16:30)</a>:</h4>
<p><span class="user-mention silent" data-user-id="316352">pierwill</span> <a href="#narrow/stream/238009-t-compiler.2Fmeetings/topic/.5Bsteering.20meeting.5D.202022-04-01.20compiler-team.23490/near/277443880">said</a>:</p>
<blockquote>
<blockquote>
<p>all caches not stored in TyCtxt to be gone.</p>
</blockquote>
<p>Is there a possibility this could unlock performance gains <em>outside</em> incr comp/query system?</p>
</blockquote>
<p>I ask because of unexpected performance gains from work on <a href="https://github.com/rust-lang/rust/issues/90317">https://github.com/rust-lang/rust/issues/90317</a> (altho now i think this is unrelated to the topic discussed here...)</p>



<a name="277444294"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/238009-t-compiler/meetings/topic/%5Bsteering%20meeting%5D%202022-04-01%20compiler-team%23490/near/277444294" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Aaron Hill <a href="https://zulip-archive.rust-lang.org/stream/238009-t-compiler/meetings/topic/.5Bsteering.20meeting.5D.202022-04-01.20compiler-team.23490.html#277444294">(Apr 01 2022 at 16:30)</a>:</h4>
<p>The fact that we have to use the weird 'anon dep bode' thing isn't really due to anything specific to trait selection</p>



<a name="277444305"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/238009-t-compiler/meetings/topic/%5Bsteering%20meeting%5D%202022-04-01%20compiler-team%23490/near/277444305" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> lcnr <a href="https://zulip-archive.rust-lang.org/stream/238009-t-compiler/meetings/topic/.5Bsteering.20meeting.5D.202022-04-01.20compiler-team.23490.html#277444305">(Apr 01 2022 at 16:30)</a>:</h4>
<p><span class="user-mention silent" data-user-id="125294">Aaron Hill</span> <a href="#narrow/stream/238009-t-compiler.2Fmeetings/topic/.5Bsteering.20meeting.5D.202022-04-01.20compiler-team.23490/near/277444178">said</a>:</p>
<blockquote>
<p>However, even TyCtxt caches can lead to incr comp issues - the main example being the trait selection cache</p>
</blockquote>
<p>could we make the query system strong enough so that that cache can just be implicitly be part of the query system?</p>



<a name="277444319"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/238009-t-compiler/meetings/topic/%5Bsteering%20meeting%5D%202022-04-01%20compiler-team%23490/near/277444319" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Nelson <a href="https://zulip-archive.rust-lang.org/stream/238009-t-compiler/meetings/topic/.5Bsteering.20meeting.5D.202022-04-01.20compiler-team.23490.html#277444319">(Apr 01 2022 at 16:30)</a>:</h4>
<p><span class="user-mention" data-user-id="125294">@Aaron Hill</span> can you explain the distinction you see between "tyctxt caches" and the query system? I thought they were the same.</p>



<a name="277444355"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/238009-t-compiler/meetings/topic/%5Bsteering%20meeting%5D%202022-04-01%20compiler-team%23490/near/277444355" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Aaron Hill <a href="https://zulip-archive.rust-lang.org/stream/238009-t-compiler/meetings/topic/.5Bsteering.20meeting.5D.202022-04-01.20compiler-team.23490.html#277444355">(Apr 01 2022 at 16:31)</a>:</h4>
<p>We have some fields in TyCtxt that are used to cache some results from trait selection</p>



<a name="277444360"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/238009-t-compiler/meetings/topic/%5Bsteering%20meeting%5D%202022-04-01%20compiler-team%23490/near/277444360" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> lcnr <a href="https://zulip-archive.rust-lang.org/stream/238009-t-compiler/meetings/topic/.5Bsteering.20meeting.5D.202022-04-01.20compiler-team.23490.html#277444360">(Apr 01 2022 at 16:31)</a>:</h4>
<p><span class="user-mention silent" data-user-id="216206">lcnr</span> <a href="#narrow/stream/238009-t-compiler.2Fmeetings/topic/.5Bsteering.20meeting.5D.202022-04-01.20compiler-team.23490/near/277444305">said</a>:</p>
<blockquote>
<p><span class="user-mention silent" data-user-id="125294">Aaron Hill</span> <a href="#narrow/stream/238009-t-compiler.2Fmeetings/topic/.5Bsteering.20meeting.5D.202022-04-01.20compiler-team.23490/near/277444178">said</a>:</p>
<blockquote>
<p>However, even TyCtxt caches can lead to incr comp issues - the main example being the trait selection cache</p>
</blockquote>
<p>could we make the query system strong enough so that that cache can just be implicitly be part of the query system?</p>
</blockquote>
<p>e.g. how well do we have to handle cycles to deal with that</p>



<a name="277444369"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/238009-t-compiler/meetings/topic/%5Bsteering%20meeting%5D%202022-04-01%20compiler-team%23490/near/277444369" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> mw <a href="https://zulip-archive.rust-lang.org/stream/238009-t-compiler/meetings/topic/.5Bsteering.20meeting.5D.202022-04-01.20compiler-team.23490.html#277444369">(Apr 01 2022 at 16:31)</a>:</h4>
<p>Before diving too much into details, maybe we can try to answer one question: Does anybody here think it is realistic that we remove incremental compilation altogether?</p>



<a name="277444377"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/238009-t-compiler/meetings/topic/%5Bsteering%20meeting%5D%202022-04-01%20compiler-team%23490/near/277444377" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> cjgillot <a href="https://zulip-archive.rust-lang.org/stream/238009-t-compiler/meetings/topic/.5Bsteering.20meeting.5D.202022-04-01.20compiler-team.23490.html#277444377">(Apr 01 2022 at 16:31)</a>:</h4>
<p>IIRC, the 2 caches we have are either: stable hashes, and trait selection.  The first one may be managed by an interning scheme, and the second gets us back to the everlasting issus of cycles.</p>



<a name="277444387"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/238009-t-compiler/meetings/topic/%5Bsteering%20meeting%5D%202022-04-01%20compiler-team%23490/near/277444387" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Aaron Hill <a href="https://zulip-archive.rust-lang.org/stream/238009-t-compiler/meetings/topic/.5Bsteering.20meeting.5D.202022-04-01.20compiler-team.23490.html#277444387">(Apr 01 2022 at 16:31)</a>:</h4>
<p>E.g. candidate selection and evaluation</p>



<a name="277444436"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/238009-t-compiler/meetings/topic/%5Bsteering%20meeting%5D%202022-04-01%20compiler-team%23490/near/277444436" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pnkfelix <a href="https://zulip-archive.rust-lang.org/stream/238009-t-compiler/meetings/topic/.5Bsteering.20meeting.5D.202022-04-01.20compiler-team.23490.html#277444436">(Apr 01 2022 at 16:31)</a>:</h4>
<p><span class="user-mention silent" data-user-id="124287">mw</span> <a href="#narrow/stream/238009-t-compiler.2Fmeetings/topic/.5Bsteering.20meeting.5D.202022-04-01.20compiler-team.23490/near/277444369">said</a>:</p>
<blockquote>
<p>Before diving too much into details, maybe we can try to answer one question: Does anybody here think it is realistic that we remove incremental compilation altogether?</p>
</blockquote>
<p>yeah, okay, lets pause on cache discussion and focus on this</p>



<a name="277444437"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/238009-t-compiler/meetings/topic/%5Bsteering%20meeting%5D%202022-04-01%20compiler-team%23490/near/277444437" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Aaron Hill <a href="https://zulip-archive.rust-lang.org/stream/238009-t-compiler/meetings/topic/.5Bsteering.20meeting.5D.202022-04-01.20compiler-team.23490.html#277444437">(Apr 01 2022 at 16:31)</a>:</h4>
<p>I think having some form of incremental compilation is a must</p>



<a name="277444473"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/238009-t-compiler/meetings/topic/%5Bsteering%20meeting%5D%202022-04-01%20compiler-team%23490/near/277444473" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Aaron Hill <a href="https://zulip-archive.rust-lang.org/stream/238009-t-compiler/meetings/topic/.5Bsteering.20meeting.5D.202022-04-01.20compiler-team.23490.html#277444473">(Apr 01 2022 at 16:31)</a>:</h4>
<p>in order for the compiler performance to be generally acceptable</p>



<a name="277444486"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/238009-t-compiler/meetings/topic/%5Bsteering%20meeting%5D%202022-04-01%20compiler-team%23490/near/277444486" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wesley Wiser <a href="https://zulip-archive.rust-lang.org/stream/238009-t-compiler/meetings/topic/.5Bsteering.20meeting.5D.202022-04-01.20compiler-team.23490.html#277444486">(Apr 01 2022 at 16:32)</a>:</h4>
<p><span class="user-mention silent" data-user-id="124287">mw</span> <a href="#narrow/stream/238009-t-compiler.2Fmeetings/topic/.5Bsteering.20meeting.5D.202022-04-01.20compiler-team.23490/near/277444369">said</a>:</p>
<blockquote>
<p>Before diving too much into details, maybe we can try to answer one question: Does anybody here think it is realistic that we remove incremental compilation altogether?</p>
</blockquote>
<p>I would say no, given the current "from scratch" performance of rustc, incremental compilation is a must.</p>



<a name="277444539"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/238009-t-compiler/meetings/topic/%5Bsteering%20meeting%5D%202022-04-01%20compiler-team%23490/near/277444539" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pnkfelix <a href="https://zulip-archive.rust-lang.org/stream/238009-t-compiler/meetings/topic/.5Bsteering.20meeting.5D.202022-04-01.20compiler-team.23490.html#277444539">(Apr 01 2022 at 16:32)</a>:</h4>
<p>The only way I could imagine us being able to get rid of incr-comp would be if we landed <em>amazing parallel comp</em></p>



<a name="277444559"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/238009-t-compiler/meetings/topic/%5Bsteering%20meeting%5D%202022-04-01%20compiler-team%23490/near/277444559" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pnkfelix <a href="https://zulip-archive.rust-lang.org/stream/238009-t-compiler/meetings/topic/.5Bsteering.20meeting.5D.202022-04-01.20compiler-team.23490.html#277444559">(Apr 01 2022 at 16:32)</a>:</h4>
<p>and that's too far off</p>



<a name="277444587"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/238009-t-compiler/meetings/topic/%5Bsteering%20meeting%5D%202022-04-01%20compiler-team%23490/near/277444587" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Aaron Hill <a href="https://zulip-archive.rust-lang.org/stream/238009-t-compiler/meetings/topic/.5Bsteering.20meeting.5D.202022-04-01.20compiler-team.23490.html#277444587">(Apr 01 2022 at 16:32)</a>:</h4>
<p>Even with that, I think we'd still want some form of incr comp for LLVM</p>



<a name="277444593"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/238009-t-compiler/meetings/topic/%5Bsteering%20meeting%5D%202022-04-01%20compiler-team%23490/near/277444593" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wesley Wiser <a href="https://zulip-archive.rust-lang.org/stream/238009-t-compiler/meetings/topic/.5Bsteering.20meeting.5D.202022-04-01.20compiler-team.23490.html#277444593">(Apr 01 2022 at 16:32)</a>:</h4>
<p>Or if we just magically got like 5x faster or something <span aria-label="laughing" class="emoji emoji-1f606" role="img" title="laughing">:laughing:</span></p>



<a name="277444617"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/238009-t-compiler/meetings/topic/%5Bsteering%20meeting%5D%202022-04-01%20compiler-team%23490/near/277444617" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Aaron Hill <a href="https://zulip-archive.rust-lang.org/stream/238009-t-compiler/meetings/topic/.5Bsteering.20meeting.5D.202022-04-01.20compiler-team.23490.html#277444617">(Apr 01 2022 at 16:32)</a>:</h4>
<p>In release mode, LLVM tends to dominate the compilation time</p>



<a name="277444633"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/238009-t-compiler/meetings/topic/%5Bsteering%20meeting%5D%202022-04-01%20compiler-team%23490/near/277444633" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Aaron Hill <a href="https://zulip-archive.rust-lang.org/stream/238009-t-compiler/meetings/topic/.5Bsteering.20meeting.5D.202022-04-01.20compiler-team.23490.html#277444633">(Apr 01 2022 at 16:33)</a>:</h4>
<p>and CGU reuse is very important for keeping that time down</p>



<a name="277444635"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/238009-t-compiler/meetings/topic/%5Bsteering%20meeting%5D%202022-04-01%20compiler-team%23490/near/277444635" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> mw <a href="https://zulip-archive.rust-lang.org/stream/238009-t-compiler/meetings/topic/.5Bsteering.20meeting.5D.202022-04-01.20compiler-team.23490.html#277444635">(Apr 01 2022 at 16:33)</a>:</h4>
<p>"magic happens here" steps are not allowed :P</p>



<a name="277444636"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/238009-t-compiler/meetings/topic/%5Bsteering%20meeting%5D%202022-04-01%20compiler-team%23490/near/277444636" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Nelson <a href="https://zulip-archive.rust-lang.org/stream/238009-t-compiler/meetings/topic/.5Bsteering.20meeting.5D.202022-04-01.20compiler-team.23490.html#277444636">(Apr 01 2022 at 16:33)</a>:</h4>
<p>I don't know if parallel is enough even. There's only so many cores on a given machine and cargo tends to use a lot of them already.</p>



<a name="277444642"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/238009-t-compiler/meetings/topic/%5Bsteering%20meeting%5D%202022-04-01%20compiler-team%23490/near/277444642" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pnkfelix <a href="https://zulip-archive.rust-lang.org/stream/238009-t-compiler/meetings/topic/.5Bsteering.20meeting.5D.202022-04-01.20compiler-team.23490.html#277444642">(Apr 01 2022 at 16:33)</a>:</h4>
<p><span class="user-mention" data-user-id="125294">@Aaron Hill</span> does it "dominate"? I thought it was like 50% ?</p>



<a name="277444657"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/238009-t-compiler/meetings/topic/%5Bsteering%20meeting%5D%202022-04-01%20compiler-team%23490/near/277444657" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pnkfelix <a href="https://zulip-archive.rust-lang.org/stream/238009-t-compiler/meetings/topic/.5Bsteering.20meeting.5D.202022-04-01.20compiler-team.23490.html#277444657">(Apr 01 2022 at 16:33)</a>:</h4>
<p>which, okay, can be seen as "dominating"</p>



<a name="277444683"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/238009-t-compiler/meetings/topic/%5Bsteering%20meeting%5D%202022-04-01%20compiler-team%23490/near/277444683" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wesley Wiser <a href="https://zulip-archive.rust-lang.org/stream/238009-t-compiler/meetings/topic/.5Bsteering.20meeting.5D.202022-04-01.20compiler-team.23490.html#277444683">(Apr 01 2022 at 16:33)</a>:</h4>
<p>It's usually more in the 60-70% + range from what I've seen.</p>



<a name="277444686"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/238009-t-compiler/meetings/topic/%5Bsteering%20meeting%5D%202022-04-01%20compiler-team%23490/near/277444686" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> mw <a href="https://zulip-archive.rust-lang.org/stream/238009-t-compiler/meetings/topic/.5Bsteering.20meeting.5D.202022-04-01.20compiler-team.23490.html#277444686">(Apr 01 2022 at 16:33)</a>:</h4>
<p>70-80% is not uncommon for opt builds</p>



<a name="277444688"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/238009-t-compiler/meetings/topic/%5Bsteering%20meeting%5D%202022-04-01%20compiler-team%23490/near/277444688" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pnkfelix <a href="https://zulip-archive.rust-lang.org/stream/238009-t-compiler/meetings/topic/.5Bsteering.20meeting.5D.202022-04-01.20compiler-team.23490.html#277444688">(Apr 01 2022 at 16:33)</a>:</h4>
<p>hmm okay</p>



<a name="277444699"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/238009-t-compiler/meetings/topic/%5Bsteering%20meeting%5D%202022-04-01%20compiler-team%23490/near/277444699" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wesley Wiser <a href="https://zulip-archive.rust-lang.org/stream/238009-t-compiler/meetings/topic/.5Bsteering.20meeting.5D.202022-04-01.20compiler-team.23490.html#277444699">(Apr 01 2022 at 16:33)</a>:</h4>
<p>Unless you're playing games with the type system.</p>



<a name="277444715"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/238009-t-compiler/meetings/topic/%5Bsteering%20meeting%5D%202022-04-01%20compiler-team%23490/near/277444715" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Aaron Hill <a href="https://zulip-archive.rust-lang.org/stream/238009-t-compiler/meetings/topic/.5Bsteering.20meeting.5D.202022-04-01.20compiler-team.23490.html#277444715">(Apr 01 2022 at 16:33)</a>:</h4>
<p>Yeah, thats been my experience</p>



<a name="277444769"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/238009-t-compiler/meetings/topic/%5Bsteering%20meeting%5D%202022-04-01%20compiler-team%23490/near/277444769" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> bjorn3 <a href="https://zulip-archive.rust-lang.org/stream/238009-t-compiler/meetings/topic/.5Bsteering.20meeting.5D.202022-04-01.20compiler-team.23490.html#277444769">(Apr 01 2022 at 16:34)</a>:</h4>
<p><span class="user-mention silent" data-user-id="125294">Aaron Hill</span> <a href="#narrow/stream/238009-t-compiler.2Fmeetings/topic/.5Bsteering.20meeting.5D.202022-04-01.20compiler-team.23490/near/277444617">said</a>:</p>
<blockquote>
<p>In release mode, LLVM tends to dominate the compilation time</p>
</blockquote>
<p>Release mode has incr comp disabled by default as incr comp forces 256 cgus for better cgu reusing which makes the resulting binaries slower.</p>



<a name="277444794"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/238009-t-compiler/meetings/topic/%5Bsteering%20meeting%5D%202022-04-01%20compiler-team%23490/near/277444794" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pnkfelix <a href="https://zulip-archive.rust-lang.org/stream/238009-t-compiler/meetings/topic/.5Bsteering.20meeting.5D.202022-04-01.20compiler-team.23490.html#277444794">(Apr 01 2022 at 16:34)</a>:</h4>
<p>anyway, the argument is pretty solid: the only way we can reduce LLVM cost is by reusing build products</p>



<a name="277444799"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/238009-t-compiler/meetings/topic/%5Bsteering%20meeting%5D%202022-04-01%20compiler-team%23490/near/277444799" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pnkfelix <a href="https://zulip-archive.rust-lang.org/stream/238009-t-compiler/meetings/topic/.5Bsteering.20meeting.5D.202022-04-01.20compiler-team.23490.html#277444799">(Apr 01 2022 at 16:34)</a>:</h4>
<p>thus, incr-comp is a must</p>



<a name="277444813"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/238009-t-compiler/meetings/topic/%5Bsteering%20meeting%5D%202022-04-01%20compiler-team%23490/near/277444813" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Aaron Hill <a href="https://zulip-archive.rust-lang.org/stream/238009-t-compiler/meetings/topic/.5Bsteering.20meeting.5D.202022-04-01.20compiler-team.23490.html#277444813">(Apr 01 2022 at 16:34)</a>:</h4>
<p>Ah,  guess that's because I mostly work on rustc, where we turn it on</p>



<a name="277444874"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/238009-t-compiler/meetings/topic/%5Bsteering%20meeting%5D%202022-04-01%20compiler-team%23490/near/277444874" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wesley Wiser <a href="https://zulip-archive.rust-lang.org/stream/238009-t-compiler/meetings/topic/.5Bsteering.20meeting.5D.202022-04-01.20compiler-team.23490.html#277444874">(Apr 01 2022 at 16:35)</a>:</h4>
<p>It sounds like we've pretty conclusively ruled out option 4.</p>



<a name="277444875"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/238009-t-compiler/meetings/topic/%5Bsteering%20meeting%5D%202022-04-01%20compiler-team%23490/near/277444875" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> mw <a href="https://zulip-archive.rust-lang.org/stream/238009-t-compiler/meetings/topic/.5Bsteering.20meeting.5D.202022-04-01.20compiler-team.23490.html#277444875">(Apr 01 2022 at 16:35)</a>:</h4>
<p>OK, let's try to prune the decision tree some more: does anybody here think it is realistic to switch the compiler away from a query-based system (i.e. approach 3)</p>



<a name="277445024"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/238009-t-compiler/meetings/topic/%5Bsteering%20meeting%5D%202022-04-01%20compiler-team%23490/near/277445024" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pnkfelix <a href="https://zulip-archive.rust-lang.org/stream/238009-t-compiler/meetings/topic/.5Bsteering.20meeting.5D.202022-04-01.20compiler-team.23490.html#277445024">(Apr 01 2022 at 16:36)</a>:</h4>
<p>it sounds like a potentially interesting research project</p>



<a name="277445027"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/238009-t-compiler/meetings/topic/%5Bsteering%20meeting%5D%202022-04-01%20compiler-team%23490/near/277445027" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> bjorn3 <a href="https://zulip-archive.rust-lang.org/stream/238009-t-compiler/meetings/topic/.5Bsteering.20meeting.5D.202022-04-01.20compiler-team.23490.html#277445027">(Apr 01 2022 at 16:36)</a>:</h4>
<p>I don't think it is very realistic. The various compilation passes are too intermingled. Even without incr comp we would need queries to handle the const eval &lt;-&gt; type checking cycle.</p>



<a name="277445028"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/238009-t-compiler/meetings/topic/%5Bsteering%20meeting%5D%202022-04-01%20compiler-team%23490/near/277445028" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> cjgillot <a href="https://zulip-archive.rust-lang.org/stream/238009-t-compiler/meetings/topic/.5Bsteering.20meeting.5D.202022-04-01.20compiler-team.23490.html#277445028">(Apr 01 2022 at 16:36)</a>:</h4>
<p>Apart from the though experiment, I don't think we should.</p>



<a name="277445043"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/238009-t-compiler/meetings/topic/%5Bsteering%20meeting%5D%202022-04-01%20compiler-team%23490/near/277445043" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pnkfelix <a href="https://zulip-archive.rust-lang.org/stream/238009-t-compiler/meetings/topic/.5Bsteering.20meeting.5D.202022-04-01.20compiler-team.23490.html#277445043">(Apr 01 2022 at 16:36)</a>:</h4>
<p>but not something I would pick as a strategy</p>



<a name="277445107"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/238009-t-compiler/meetings/topic/%5Bsteering%20meeting%5D%202022-04-01%20compiler-team%23490/near/277445107" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pnkfelix <a href="https://zulip-archive.rust-lang.org/stream/238009-t-compiler/meetings/topic/.5Bsteering.20meeting.5D.202022-04-01.20compiler-team.23490.html#277445107">(Apr 01 2022 at 16:36)</a>:</h4>
<p>It <em>does</em> address the "LLVM is too expensive" issue</p>



<a name="277445131"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/238009-t-compiler/meetings/topic/%5Bsteering%20meeting%5D%202022-04-01%20compiler-team%23490/near/277445131" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wesley Wiser <a href="https://zulip-archive.rust-lang.org/stream/238009-t-compiler/meetings/topic/.5Bsteering.20meeting.5D.202022-04-01.20compiler-team.23490.html#277445131">(Apr 01 2022 at 16:36)</a>:</h4>
<p>Agreed, if we determine we cannot support any form of fine grained incremental, then it seems like the obvious fallback but that isn't a foregone conclusion in my mind.</p>



<a name="277445153"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/238009-t-compiler/meetings/topic/%5Bsteering%20meeting%5D%202022-04-01%20compiler-team%23490/near/277445153" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Aaron Hill <a href="https://zulip-archive.rust-lang.org/stream/238009-t-compiler/meetings/topic/.5Bsteering.20meeting.5D.202022-04-01.20compiler-team.23490.html#277445153">(Apr 01 2022 at 16:37)</a>:</h4>
<p>I think we should separate the discussion of 'general query system's vs 'wuery tracking for incr comp'</p>



<a name="277445211"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/238009-t-compiler/meetings/topic/%5Bsteering%20meeting%5D%202022-04-01%20compiler-team%23490/near/277445211" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> mw <a href="https://zulip-archive.rust-lang.org/stream/238009-t-compiler/meetings/topic/.5Bsteering.20meeting.5D.202022-04-01.20compiler-team.23490.html#277445211">(Apr 01 2022 at 16:37)</a>:</h4>
<p><span class="user-mention silent" data-user-id="125294">Aaron Hill</span> <a href="#narrow/stream/238009-t-compiler.2Fmeetings/topic/.5Bsteering.20meeting.5D.202022-04-01.20compiler-team.23490/near/277445153">said</a>:</p>
<blockquote>
<p>I think we should separate the discussion of 'general query system's vs 'wuery tracking for incr comp'</p>
</blockquote>
<p>can you elaborate?</p>



<a name="277445220"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/238009-t-compiler/meetings/topic/%5Bsteering%20meeting%5D%202022-04-01%20compiler-team%23490/near/277445220" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pnkfelix <a href="https://zulip-archive.rust-lang.org/stream/238009-t-compiler/meetings/topic/.5Bsteering.20meeting.5D.202022-04-01.20compiler-team.23490.html#277445220">(Apr 01 2022 at 16:37)</a>:</h4>
<p><span class="user-mention" data-user-id="125294">@Aaron Hill</span> you mean, you can see a world where rustc offers a query system, but it is not the basis for incr-comp ?</p>



<a name="277445236"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/238009-t-compiler/meetings/topic/%5Bsteering%20meeting%5D%202022-04-01%20compiler-team%23490/near/277445236" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Aaron Hill <a href="https://zulip-archive.rust-lang.org/stream/238009-t-compiler/meetings/topic/.5Bsteering.20meeting.5D.202022-04-01.20compiler-team.23490.html#277445236">(Apr 01 2022 at 16:37)</a>:</h4>
<p>Yes</p>



<a name="277445265"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/238009-t-compiler/meetings/topic/%5Bsteering%20meeting%5D%202022-04-01%20compiler-team%23490/near/277445265" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Aaron Hill <a href="https://zulip-archive.rust-lang.org/stream/238009-t-compiler/meetings/topic/.5Bsteering.20meeting.5D.202022-04-01.20compiler-team.23490.html#277445265">(Apr 01 2022 at 16:37)</a>:</h4>
<p>That is, we still have global caching, and query providers in different crates</p>



<a name="277445280"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/238009-t-compiler/meetings/topic/%5Bsteering%20meeting%5D%202022-04-01%20compiler-team%23490/near/277445280" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Aaron Hill <a href="https://zulip-archive.rust-lang.org/stream/238009-t-compiler/meetings/topic/.5Bsteering.20meeting.5D.202022-04-01.20compiler-team.23490.html#277445280">(Apr 01 2022 at 16:37)</a>:</h4>
<p>But we don't persist any of that to disk</p>



<a name="277445386"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/238009-t-compiler/meetings/topic/%5Bsteering%20meeting%5D%202022-04-01%20compiler-team%23490/near/277445386" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Aaron Hill <a href="https://zulip-archive.rust-lang.org/stream/238009-t-compiler/meetings/topic/.5Bsteering.20meeting.5D.202022-04-01.20compiler-team.23490.html#277445386">(Apr 01 2022 at 16:38)</a>:</h4>
<p>We could combine that approach with the option-3 style incremental compilation</p>



<a name="277445390"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/238009-t-compiler/meetings/topic/%5Bsteering%20meeting%5D%202022-04-01%20compiler-team%23490/near/277445390" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> mw <a href="https://zulip-archive.rust-lang.org/stream/238009-t-compiler/meetings/topic/.5Bsteering.20meeting.5D.202022-04-01.20compiler-team.23490.html#277445390">(Apr 01 2022 at 16:38)</a>:</h4>
<p>how would you implement incr. comp. with that?</p>



<a name="277445475"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/238009-t-compiler/meetings/topic/%5Bsteering%20meeting%5D%202022-04-01%20compiler-team%23490/near/277445475" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> mw <a href="https://zulip-archive.rust-lang.org/stream/238009-t-compiler/meetings/topic/.5Bsteering.20meeting.5D.202022-04-01.20compiler-team.23490.html#277445475">(Apr 01 2022 at 16:39)</a>:</h4>
<p>so, we'd basically produce LLVM bitcode files and check those for changes?</p>



<a name="277445518"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/238009-t-compiler/meetings/topic/%5Bsteering%20meeting%5D%202022-04-01%20compiler-team%23490/near/277445518" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pnkfelix <a href="https://zulip-archive.rust-lang.org/stream/238009-t-compiler/meetings/topic/.5Bsteering.20meeting.5D.202022-04-01.20compiler-team.23490.html#277445518">(Apr 01 2022 at 16:39)</a>:</h4>
<p>or we generate stable-MIR to disk and check <em>those</em> for changes...</p>



<a name="277445542"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/238009-t-compiler/meetings/topic/%5Bsteering%20meeting%5D%202022-04-01%20compiler-team%23490/near/277445542" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Aaron Hill <a href="https://zulip-archive.rust-lang.org/stream/238009-t-compiler/meetings/topic/.5Bsteering.20meeting.5D.202022-04-01.20compiler-team.23490.html#277445542">(Apr 01 2022 at 16:39)</a>:</h4>
<p>I still need to think through exactly what option 3 would look like</p>



<a name="277445561"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/238009-t-compiler/meetings/topic/%5Bsteering%20meeting%5D%202022-04-01%20compiler-team%23490/near/277445561" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pnkfelix <a href="https://zulip-archive.rust-lang.org/stream/238009-t-compiler/meetings/topic/.5Bsteering.20meeting.5D.202022-04-01.20compiler-team.23490.html#277445561">(Apr 01 2022 at 16:39)</a>:</h4>
<p>(and maintain a mapping from stable-MIR to the associated LLVM for it)</p>



<a name="277445694"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/238009-t-compiler/meetings/topic/%5Bsteering%20meeting%5D%202022-04-01%20compiler-team%23490/near/277445694" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Aaron Hill <a href="https://zulip-archive.rust-lang.org/stream/238009-t-compiler/meetings/topic/.5Bsteering.20meeting.5D.202022-04-01.20compiler-team.23490.html#277445694">(Apr 01 2022 at 16:40)</a>:</h4>
<p>But I think the non-incremental wuey system is more of an overall compiler architecture decision, and wouldn't <em>necessarily</em> interfere with some other form of incremental compilation, and more than some other part of the compiler would</p>



<a name="277445699"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/238009-t-compiler/meetings/topic/%5Bsteering%20meeting%5D%202022-04-01%20compiler-team%23490/near/277445699" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> mw <a href="https://zulip-archive.rust-lang.org/stream/238009-t-compiler/meetings/topic/.5Bsteering.20meeting.5D.202022-04-01.20compiler-team.23490.html#277445699">(Apr 01 2022 at 16:40)</a>:</h4>
<p>it's certainly interesting to think about what we could do with such an approach</p>



<a name="277445717"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/238009-t-compiler/meetings/topic/%5Bsteering%20meeting%5D%202022-04-01%20compiler-team%23490/near/277445717" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> cjgillot <a href="https://zulip-archive.rust-lang.org/stream/238009-t-compiler/meetings/topic/.5Bsteering.20meeting.5D.202022-04-01.20compiler-team.23490.html#277445717">(Apr 01 2022 at 16:40)</a>:</h4>
<p><span class="user-mention silent" data-user-id="124287">mw</span> <a href="#narrow/stream/238009-t-compiler.2Fmeetings/topic/.5Bsteering.20meeting.5D.202022-04-01.20compiler-team.23490/near/277445390">said</a>:</p>
<blockquote>
<p>how would you implement incr. comp. with that?</p>
</blockquote>
<p>I am not sure this is easy. incr-comp needs to control information flow. If by query, we mean that any code can access any information on demand, this will be hard.</p>



<a name="277445741"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/238009-t-compiler/meetings/topic/%5Bsteering%20meeting%5D%202022-04-01%20compiler-team%23490/near/277445741" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Aaron Hill <a href="https://zulip-archive.rust-lang.org/stream/238009-t-compiler/meetings/topic/.5Bsteering.20meeting.5D.202022-04-01.20compiler-team.23490.html#277445741">(Apr 01 2022 at 16:41)</a>:</h4>
<p>However, I recognize that such and approach would likely take a huge amount of work</p>



<a name="277445753"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/238009-t-compiler/meetings/topic/%5Bsteering%20meeting%5D%202022-04-01%20compiler-team%23490/near/277445753" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pnkfelix <a href="https://zulip-archive.rust-lang.org/stream/238009-t-compiler/meetings/topic/.5Bsteering.20meeting.5D.202022-04-01.20compiler-team.23490.html#277445753">(Apr 01 2022 at 16:41)</a>:</h4>
<p>my gut is still in the mode of "this is an interesting research idea, but I wouldn't want to commit to it as our strategy." at least, not without better understanding how bad it is to try to fix the current system, or adopt a richer query system like Salsa.</p>



<a name="277445821"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/238009-t-compiler/meetings/topic/%5Bsteering%20meeting%5D%202022-04-01%20compiler-team%23490/near/277445821" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> mw <a href="https://zulip-archive.rust-lang.org/stream/238009-t-compiler/meetings/topic/.5Bsteering.20meeting.5D.202022-04-01.20compiler-team.23490.html#277445821">(Apr 01 2022 at 16:41)</a>:</h4>
<p>it would certainly perform a lot worse than what we have now</p>



<a name="277445901"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/238009-t-compiler/meetings/topic/%5Bsteering%20meeting%5D%202022-04-01%20compiler-team%23490/near/277445901" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> mw <a href="https://zulip-archive.rust-lang.org/stream/238009-t-compiler/meetings/topic/.5Bsteering.20meeting.5D.202022-04-01.20compiler-team.23490.html#277445901">(Apr 01 2022 at 16:42)</a>:</h4>
<p>but it might be an interesting idea to have it as a fallback for when we would need to turn off incremental otherwise</p>



<a name="277445913"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/238009-t-compiler/meetings/topic/%5Bsteering%20meeting%5D%202022-04-01%20compiler-team%23490/near/277445913" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pierwill <a href="https://zulip-archive.rust-lang.org/stream/238009-t-compiler/meetings/topic/.5Bsteering.20meeting.5D.202022-04-01.20compiler-team.23490.html#277445913">(Apr 01 2022 at 16:42)</a>:</h4>
<p>My high-level question: what are the <em>soundness</em> concerns with current system that <em>need</em> to be solved?</p>



<a name="277445952"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/238009-t-compiler/meetings/topic/%5Bsteering%20meeting%5D%202022-04-01%20compiler-team%23490/near/277445952" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pierwill <a href="https://zulip-archive.rust-lang.org/stream/238009-t-compiler/meetings/topic/.5Bsteering.20meeting.5D.202022-04-01.20compiler-team.23490.html#277445952">(Apr 01 2022 at 16:42)</a>:</h4>
<p>Not including engineering, maintenance concerns, etc</p>



<a name="277445970"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/238009-t-compiler/meetings/topic/%5Bsteering%20meeting%5D%202022-04-01%20compiler-team%23490/near/277445970" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pnkfelix <a href="https://zulip-archive.rust-lang.org/stream/238009-t-compiler/meetings/topic/.5Bsteering.20meeting.5D.202022-04-01.20compiler-team.23490.html#277445970">(Apr 01 2022 at 16:42)</a>:</h4>
<p>well, there's two levels: One is soundness, for bugs that actually leak through into codegen issues</p>



<a name="277445977"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/238009-t-compiler/meetings/topic/%5Bsteering%20meeting%5D%202022-04-01%20compiler-team%23490/near/277445977" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pnkfelix <a href="https://zulip-archive.rust-lang.org/stream/238009-t-compiler/meetings/topic/.5Bsteering.20meeting.5D.202022-04-01.20compiler-team.23490.html#277445977">(Apr 01 2022 at 16:42)</a>:</h4>
<p>the other level is ICE's</p>



<a name="277445986"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/238009-t-compiler/meetings/topic/%5Bsteering%20meeting%5D%202022-04-01%20compiler-team%23490/near/277445986" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pnkfelix <a href="https://zulip-archive.rust-lang.org/stream/238009-t-compiler/meetings/topic/.5Bsteering.20meeting.5D.202022-04-01.20compiler-team.23490.html#277445986">(Apr 01 2022 at 16:43)</a>:</h4>
<p>that prevent soundness bugs, but are still terrible UX</p>



<a name="277446003"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/238009-t-compiler/meetings/topic/%5Bsteering%20meeting%5D%202022-04-01%20compiler-team%23490/near/277446003" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Aaron Hill <a href="https://zulip-archive.rust-lang.org/stream/238009-t-compiler/meetings/topic/.5Bsteering.20meeting.5D.202022-04-01.20compiler-team.23490.html#277446003">(Apr 01 2022 at 16:43)</a>:</h4>
<p><a href="https://hackmd.io/@michaelwoerister/SJf9VU1-5">https://hackmd.io/@michaelwoerister/SJf9VU1-5</a></p>



<a name="277446010"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/238009-t-compiler/meetings/topic/%5Bsteering%20meeting%5D%202022-04-01%20compiler-team%23490/near/277446010" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> mw <a href="https://zulip-archive.rust-lang.org/stream/238009-t-compiler/meetings/topic/.5Bsteering.20meeting.5D.202022-04-01.20compiler-team.23490.html#277446010">(Apr 01 2022 at 16:43)</a>:</h4>
<p><span class="user-mention silent" data-user-id="316352">pierwill</span> <a href="#narrow/stream/238009-t-compiler.2Fmeetings/topic/.5Bsteering.20meeting.5D.202022-04-01.20compiler-team.23490/near/277445913">said</a>:</p>
<blockquote>
<p>My high-level question: what are the <em>soundness</em> concerns with current system that <em>need</em> to be solved?</p>
</blockquote>
<p>As far as I know, there are no soundness problems. but it depends on invariants that are hard to guarantee in practice</p>



<a name="277446025"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/238009-t-compiler/meetings/topic/%5Bsteering%20meeting%5D%202022-04-01%20compiler-team%23490/near/277446025" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Aaron Hill <a href="https://zulip-archive.rust-lang.org/stream/238009-t-compiler/meetings/topic/.5Bsteering.20meeting.5D.202022-04-01.20compiler-team.23490.html#277446025">(Apr 01 2022 at 16:43)</a>:</h4>
<p>goes into detail about of the specific bugs</p>



<a name="277446084"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/238009-t-compiler/meetings/topic/%5Bsteering%20meeting%5D%202022-04-01%20compiler-team%23490/near/277446084" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pierwill <a href="https://zulip-archive.rust-lang.org/stream/238009-t-compiler/meetings/topic/.5Bsteering.20meeting.5D.202022-04-01.20compiler-team.23490.html#277446084">(Apr 01 2022 at 16:43)</a>:</h4>
<p><span class="user-mention silent" data-user-id="124287">mw</span> <a href="#narrow/stream/238009-t-compiler.2Fmeetings/topic/.5Bsteering.20meeting.5D.202022-04-01.20compiler-team.23490/near/277446010">said</a>:</p>
<blockquote>
<p><span class="user-mention silent" data-user-id="316352">pierwill</span> <a href="#narrow/stream/238009-t-compiler.2Fmeetings/topic/.5Bsteering.20meeting.5D.202022-04-01.20compiler-team.23490/near/277445913">said</a>:</p>
<blockquote>
<p>My high-level question: what are the <em>soundness</em> concerns with current system that <em>need</em> to be solved?</p>
</blockquote>
<p>As far as I know, there are no soundness problems. but it depends on invariants that are hard to guarantee in practice</p>
</blockquote>
<p>Okay this is good to know <span class="user-mention" data-user-id="125294">@Aaron Hill</span>. To me that really clarifies the stakes here.</p>



<a name="277446132"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/238009-t-compiler/meetings/topic/%5Bsteering%20meeting%5D%202022-04-01%20compiler-team%23490/near/277446132" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> cjgillot <a href="https://zulip-archive.rust-lang.org/stream/238009-t-compiler/meetings/topic/.5Bsteering.20meeting.5D.202022-04-01.20compiler-team.23490.html#277446132">(Apr 01 2022 at 16:44)</a>:</h4>
<p>I tend to file the leaks in information flow (= all untracked state) as possible soundness issues.</p>



<a name="277446167"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/238009-t-compiler/meetings/topic/%5Bsteering%20meeting%5D%202022-04-01%20compiler-team%23490/near/277446167" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pierwill <a href="https://zulip-archive.rust-lang.org/stream/238009-t-compiler/meetings/topic/.5Bsteering.20meeting.5D.202022-04-01.20compiler-team.23490.html#277446167">(Apr 01 2022 at 16:44)</a>:</h4>
<p>Ah yes.</p>



<a name="277446176"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/238009-t-compiler/meetings/topic/%5Bsteering%20meeting%5D%202022-04-01%20compiler-team%23490/near/277446176" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> cjgillot <a href="https://zulip-archive.rust-lang.org/stream/238009-t-compiler/meetings/topic/.5Bsteering.20meeting.5D.202022-04-01.20compiler-team.23490.html#277446176">(Apr 01 2022 at 16:44)</a>:</h4>
<p>Because by definition, we don't know when they will matter.</p>



<a name="277446181"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/238009-t-compiler/meetings/topic/%5Bsteering%20meeting%5D%202022-04-01%20compiler-team%23490/near/277446181" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pierwill <a href="https://zulip-archive.rust-lang.org/stream/238009-t-compiler/meetings/topic/.5Bsteering.20meeting.5D.202022-04-01.20compiler-team.23490.html#277446181">(Apr 01 2022 at 16:44)</a>:</h4>
<p>That's the kind of thing I had in mind.</p>



<a name="277446188"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/238009-t-compiler/meetings/topic/%5Bsteering%20meeting%5D%202022-04-01%20compiler-team%23490/near/277446188" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> mw <a href="https://zulip-archive.rust-lang.org/stream/238009-t-compiler/meetings/topic/.5Bsteering.20meeting.5D.202022-04-01.20compiler-team.23490.html#277446188">(Apr 01 2022 at 16:44)</a>:</h4>
<p>to clarify: I'm talking about soundness of the underlying model</p>



<a name="277446217"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/238009-t-compiler/meetings/topic/%5Bsteering%20meeting%5D%202022-04-01%20compiler-team%23490/near/277446217" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> mw <a href="https://zulip-archive.rust-lang.org/stream/238009-t-compiler/meetings/topic/.5Bsteering.20meeting.5D.202022-04-01.20compiler-team.23490.html#277446217">(Apr 01 2022 at 16:44)</a>:</h4>
<p>bugs can certainly cause real miscompilations</p>



<a name="277446222"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/238009-t-compiler/meetings/topic/%5Bsteering%20meeting%5D%202022-04-01%20compiler-team%23490/near/277446222" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pnkfelix <a href="https://zulip-archive.rust-lang.org/stream/238009-t-compiler/meetings/topic/.5Bsteering.20meeting.5D.202022-04-01.20compiler-team.23490.html#277446222">(Apr 01 2022 at 16:45)</a>:</h4>
<p>ah; I'm talking about soundness of the actual implementation due to bugs</p>



<a name="277446228"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/238009-t-compiler/meetings/topic/%5Bsteering%20meeting%5D%202022-04-01%20compiler-team%23490/near/277446228" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Aaron Hill <a href="https://zulip-archive.rust-lang.org/stream/238009-t-compiler/meetings/topic/.5Bsteering.20meeting.5D.202022-04-01.20compiler-team.23490.html#277446228">(Apr 01 2022 at 16:45)</a>:</h4>
<p>I think one of the main practical issues with this is that it requires almost every component of the compiler to be 'aware' of incr comp in some way</p>



<a name="277446250"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/238009-t-compiler/meetings/topic/%5Bsteering%20meeting%5D%202022-04-01%20compiler-team%23490/near/277446250" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Aaron Hill <a href="https://zulip-archive.rust-lang.org/stream/238009-t-compiler/meetings/topic/.5Bsteering.20meeting.5D.202022-04-01.20compiler-team.23490.html#277446250">(Apr 01 2022 at 16:45)</a>:</h4>
<p>E.g. don't cache query calls</p>



<a name="277446265"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/238009-t-compiler/meetings/topic/%5Bsteering%20meeting%5D%202022-04-01%20compiler-team%23490/near/277446265" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Aaron Hill <a href="https://zulip-archive.rust-lang.org/stream/238009-t-compiler/meetings/topic/.5Bsteering.20meeting.5D.202022-04-01.20compiler-team.23490.html#277446265">(Apr 01 2022 at 16:45)</a>:</h4>
<p>This can be partially addressed with lints</p>



<a name="277446287"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/238009-t-compiler/meetings/topic/%5Bsteering%20meeting%5D%202022-04-01%20compiler-team%23490/near/277446287" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Aaron Hill <a href="https://zulip-archive.rust-lang.org/stream/238009-t-compiler/meetings/topic/.5Bsteering.20meeting.5D.202022-04-01.20compiler-team.23490.html#277446287">(Apr 01 2022 at 16:45)</a>:</h4>
<p>but I think it's a pretty unfortunate state of affairs</p>



<a name="277446304"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/238009-t-compiler/meetings/topic/%5Bsteering%20meeting%5D%202022-04-01%20compiler-team%23490/near/277446304" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> mw <a href="https://zulip-archive.rust-lang.org/stream/238009-t-compiler/meetings/topic/.5Bsteering.20meeting.5D.202022-04-01.20compiler-team.23490.html#277446304">(Apr 01 2022 at 16:45)</a>:</h4>
<p><span class="user-mention silent" data-user-id="125294">Aaron Hill</span> <a href="#narrow/stream/238009-t-compiler.2Fmeetings/topic/.5Bsteering.20meeting.5D.202022-04-01.20compiler-team.23490/near/277446265">said</a>:</p>
<blockquote>
<p>This can be partially addressed with lints</p>
</blockquote>
<p>or maybe an effect system if we ever get it :)</p>



<a name="277446372"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/238009-t-compiler/meetings/topic/%5Bsteering%20meeting%5D%202022-04-01%20compiler-team%23490/near/277446372" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pnkfelix <a href="https://zulip-archive.rust-lang.org/stream/238009-t-compiler/meetings/topic/.5Bsteering.20meeting.5D.202022-04-01.20compiler-team.23490.html#277446372">(Apr 01 2022 at 16:46)</a>:</h4>
<p>We do have the advantage that we literally control our compiler</p>



<a name="277446405"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/238009-t-compiler/meetings/topic/%5Bsteering%20meeting%5D%202022-04-01%20compiler-team%23490/near/277446405" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> bjorn3 <a href="https://zulip-archive.rust-lang.org/stream/238009-t-compiler/meetings/topic/.5Bsteering.20meeting.5D.202022-04-01.20compiler-team.23490.html#277446405">(Apr 01 2022 at 16:46)</a>:</h4>
<p>Just make <code>const fn</code> more powerful so we can implement most of the compiler using them :)</p>



<a name="277446440"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/238009-t-compiler/meetings/topic/%5Bsteering%20meeting%5D%202022-04-01%20compiler-team%23490/near/277446440" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pnkfelix <a href="https://zulip-archive.rust-lang.org/stream/238009-t-compiler/meetings/topic/.5Bsteering.20meeting.5D.202022-04-01.20compiler-team.23490.html#277446440">(Apr 01 2022 at 16:46)</a>:</h4>
<p><span class="user-mention silent" data-user-id="124287">mw</span> <a href="#narrow/stream/238009-t-compiler.2Fmeetings/topic/.5Bsteering.20meeting.5D.202022-04-01.20compiler-team.23490/near/277446304">said</a>:</p>
<blockquote>
<p><span class="user-mention silent" data-user-id="125294">Aaron Hill</span> <a href="#narrow/stream/238009-t-compiler.2Fmeetings/topic/.5Bsteering.20meeting.5D.202022-04-01.20compiler-team.23490/near/277446265">said</a>:</p>
<blockquote>
<p>This can be partially addressed with lints</p>
</blockquote>
<p>or maybe an effect system if we ever get it :)</p>
</blockquote>
<p>haven't you heard, Oli's decided to make one</p>



<a name="277446481"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/238009-t-compiler/meetings/topic/%5Bsteering%20meeting%5D%202022-04-01%20compiler-team%23490/near/277446481" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pnkfelix <a href="https://zulip-archive.rust-lang.org/stream/238009-t-compiler/meetings/topic/.5Bsteering.20meeting.5D.202022-04-01.20compiler-team.23490.html#277446481">(Apr 01 2022 at 16:47)</a>:</h4>
<p><a href="https://twitter.com/oli_obk/status/1509800194761764864">https://twitter.com/oli_obk/status/1509800194761764864</a></p>
<div class="inline-preview-twitter"><div class="twitter-tweet"><a href="https://twitter.com/oli_obk/status/1509800194761764864"><img class="twitter-avatar" src="https://uploads.zulipusercontent.net/1465a9e34a342d74efa235252bf7bccac19351e5/68747470733a2f2f7062732e7477696d672e636f6d2f70726f66696c655f696d616765732f3235303831323937392f6176617461725f6e6f726d616c2e706e67"></a><p>I have come to the conclusion that the best course of action for CTFE (and async and possibly others) is to add an effect system to the Rust type system</p><span>- Dr. const fn oli (@oli_obk)</span></div></div>



<a name="277446498"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/238009-t-compiler/meetings/topic/%5Bsteering%20meeting%5D%202022-04-01%20compiler-team%23490/near/277446498" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> mw <a href="https://zulip-archive.rust-lang.org/stream/238009-t-compiler/meetings/topic/.5Bsteering.20meeting.5D.202022-04-01.20compiler-team.23490.html#277446498">(Apr 01 2022 at 16:47)</a>:</h4>
<p><span class="user-mention silent" data-user-id="125294">Aaron Hill</span> <a href="#narrow/stream/238009-t-compiler.2Fmeetings/topic/.5Bsteering.20meeting.5D.202022-04-01.20compiler-team.23490/near/277446287">said</a>:</p>
<blockquote>
<p>but I think it's a pretty unfortunate state of affairs</p>
</blockquote>
<p>the question is: can we mitigate this enough for being practical</p>



<a name="277446532"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/238009-t-compiler/meetings/topic/%5Bsteering%20meeting%5D%202022-04-01%20compiler-team%23490/near/277446532" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wesley Wiser <a href="https://zulip-archive.rust-lang.org/stream/238009-t-compiler/meetings/topic/.5Bsteering.20meeting.5D.202022-04-01.20compiler-team.23490.html#277446532">(Apr 01 2022 at 16:47)</a>:</h4>
<p>Just to make sure we keep moving along, it sounds like we shouldn't take option 3 off the table completely but it's not anyone's preferred next step?</p>



<a name="277446575"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/238009-t-compiler/meetings/topic/%5Bsteering%20meeting%5D%202022-04-01%20compiler-team%23490/near/277446575" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Aaron Hill <a href="https://zulip-archive.rust-lang.org/stream/238009-t-compiler/meetings/topic/.5Bsteering.20meeting.5D.202022-04-01.20compiler-team.23490.html#277446575">(Apr 01 2022 at 16:48)</a>:</h4>
<p>Well, I personally prefer it :)</p>



<a name="277446618"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/238009-t-compiler/meetings/topic/%5Bsteering%20meeting%5D%202022-04-01%20compiler-team%23490/near/277446618" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pnkfelix <a href="https://zulip-archive.rust-lang.org/stream/238009-t-compiler/meetings/topic/.5Bsteering.20meeting.5D.202022-04-01.20compiler-team.23490.html#277446618">(Apr 01 2022 at 16:48)</a>:</h4>
<p><span class="user-mention silent" data-user-id="124287">mw</span> <a href="#narrow/stream/238009-t-compiler.2Fmeetings/topic/.5Bsteering.20meeting.5D.202022-04-01.20compiler-team.23490/near/277446498">said</a>:</p>
<blockquote>
<p><span class="user-mention silent" data-user-id="125294">Aaron Hill</span> <a href="#narrow/stream/238009-t-compiler.2Fmeetings/topic/.5Bsteering.20meeting.5D.202022-04-01.20compiler-team.23490/near/277446287">said</a>:</p>
<blockquote>
<p>but I think it's a pretty unfortunate state of affairs</p>
</blockquote>
<p>the question is: can we mitigate this enough for being practical</p>
</blockquote>
<p>I'd kind of like a survey of how many violations we know of of such a set of lints</p>



<a name="277446630"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/238009-t-compiler/meetings/topic/%5Bsteering%20meeting%5D%202022-04-01%20compiler-team%23490/near/277446630" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Aaron Hill <a href="https://zulip-archive.rust-lang.org/stream/238009-t-compiler/meetings/topic/.5Bsteering.20meeting.5D.202022-04-01.20compiler-team.23490.html#277446630">(Apr 01 2022 at 16:48)</a>:</h4>
<p>But at a minimum it's a very long-term goal</p>



<a name="277446682"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/238009-t-compiler/meetings/topic/%5Bsteering%20meeting%5D%202022-04-01%20compiler-team%23490/near/277446682" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wesley Wiser <a href="https://zulip-archive.rust-lang.org/stream/238009-t-compiler/meetings/topic/.5Bsteering.20meeting.5D.202022-04-01.20compiler-team.23490.html#277446682">(Apr 01 2022 at 16:48)</a>:</h4>
<p>but you're not thinking we should try to do that <em>right now</em>? Instead of some other option?</p>



<a name="277446688"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/238009-t-compiler/meetings/topic/%5Bsteering%20meeting%5D%202022-04-01%20compiler-team%23490/near/277446688" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> cjgillot <a href="https://zulip-archive.rust-lang.org/stream/238009-t-compiler/meetings/topic/.5Bsteering.20meeting.5D.202022-04-01.20compiler-team.23490.html#277446688">(Apr 01 2022 at 16:48)</a>:</h4>
<p><span class="user-mention silent" data-user-id="116083">pnkfelix</span> <a href="#narrow/stream/238009-t-compiler.2Fmeetings/topic/.5Bsteering.20meeting.5D.202022-04-01.20compiler-team.23490/near/277446618">said</a>:</p>
<blockquote>
<p><span class="user-mention silent" data-user-id="124287">mw</span> <a href="#narrow/stream/238009-t-compiler.2Fmeetings/topic/.5Bsteering.20meeting.5D.202022-04-01.20compiler-team.23490/near/277446498">said</a>:</p>
<blockquote>
<p><span class="user-mention silent" data-user-id="125294">Aaron Hill</span> <a href="#narrow/stream/238009-t-compiler.2Fmeetings/topic/.5Bsteering.20meeting.5D.202022-04-01.20compiler-team.23490/near/277446287">said</a>:</p>
<blockquote>
<p>but I think it's a pretty unfortunate state of affairs</p>
</blockquote>
<p>the question is: can we mitigate this enough for being practical</p>
</blockquote>
<p>I'd kind of like a survey of how many violations we know of of such a set of lints</p>
</blockquote>
<p>The lint over hash-map iteration exists, I don't think anybody started enforcing it.</p>



<a name="277446701"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/238009-t-compiler/meetings/topic/%5Bsteering%20meeting%5D%202022-04-01%20compiler-team%23490/near/277446701" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pierwill <a href="https://zulip-archive.rust-lang.org/stream/238009-t-compiler/meetings/topic/.5Bsteering.20meeting.5D.202022-04-01.20compiler-team.23490.html#277446701">(Apr 01 2022 at 16:48)</a>:</h4>
<p>I do think the idea of having the system work with a future stable MIR deserves some thought...</p>



<a name="277446730"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/238009-t-compiler/meetings/topic/%5Bsteering%20meeting%5D%202022-04-01%20compiler-team%23490/near/277446730" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pierwill <a href="https://zulip-archive.rust-lang.org/stream/238009-t-compiler/meetings/topic/.5Bsteering.20meeting.5D.202022-04-01.20compiler-team.23490.html#277446730">(Apr 01 2022 at 16:49)</a>:</h4>
<p>It could be easier to model...</p>



<a name="277446774"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/238009-t-compiler/meetings/topic/%5Bsteering%20meeting%5D%202022-04-01%20compiler-team%23490/near/277446774" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pnkfelix <a href="https://zulip-archive.rust-lang.org/stream/238009-t-compiler/meetings/topic/.5Bsteering.20meeting.5D.202022-04-01.20compiler-team.23490.html#277446774">(Apr 01 2022 at 16:49)</a>:</h4>
<p><span class="user-mention silent" data-user-id="316352">pierwill</span> <a href="#narrow/stream/238009-t-compiler.2Fmeetings/topic/.5Bsteering.20meeting.5D.202022-04-01.20compiler-team.23490/near/277446701">said</a>:</p>
<blockquote>
<p>I do think the idea of having the system work with a future stable MIR deserves some thought...</p>
</blockquote>
<p>I'll be meeting with Oli and Celina on Monday re stable-MIR, i'll definitely bring it up with them then as a potential use-case</p>



<a name="277446795"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/238009-t-compiler/meetings/topic/%5Bsteering%20meeting%5D%202022-04-01%20compiler-team%23490/near/277446795" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Aaron Hill <a href="https://zulip-archive.rust-lang.org/stream/238009-t-compiler/meetings/topic/.5Bsteering.20meeting.5D.202022-04-01.20compiler-team.23490.html#277446795">(Apr 01 2022 at 16:49)</a>:</h4>
<p>I think hashmao iteration is a good example of the kind of issues that we can run into with lints</p>



<a name="277446826"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/238009-t-compiler/meetings/topic/%5Bsteering%20meeting%5D%202022-04-01%20compiler-team%23490/near/277446826" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> mw <a href="https://zulip-archive.rust-lang.org/stream/238009-t-compiler/meetings/topic/.5Bsteering.20meeting.5D.202022-04-01.20compiler-team.23490.html#277446826">(Apr 01 2022 at 16:49)</a>:</h4>
<p>does the lint not work?</p>



<a name="277446911"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/238009-t-compiler/meetings/topic/%5Bsteering%20meeting%5D%202022-04-01%20compiler-team%23490/near/277446911" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> cjgillot <a href="https://zulip-archive.rust-lang.org/stream/238009-t-compiler/meetings/topic/.5Bsteering.20meeting.5D.202022-04-01.20compiler-team.23490.html#277446911">(Apr 01 2022 at 16:50)</a>:</h4>
<p>It's allowed in almost all crates.</p>



<a name="277446932"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/238009-t-compiler/meetings/topic/%5Bsteering%20meeting%5D%202022-04-01%20compiler-team%23490/near/277446932" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> mw <a href="https://zulip-archive.rust-lang.org/stream/238009-t-compiler/meetings/topic/.5Bsteering.20meeting.5D.202022-04-01.20compiler-team.23490.html#277446932">(Apr 01 2022 at 16:50)</a>:</h4>
<p>oh :D</p>



<a name="277446938"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/238009-t-compiler/meetings/topic/%5Bsteering%20meeting%5D%202022-04-01%20compiler-team%23490/near/277446938" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Aaron Hill <a href="https://zulip-archive.rust-lang.org/stream/238009-t-compiler/meetings/topic/.5Bsteering.20meeting.5D.202022-04-01.20compiler-team.23490.html#277446938">(Apr 01 2022 at 16:50)</a>:</h4>
<p>We need to ensure that all types with untracked data (e.g. the raw number in DefId) are inaccessible, which require not imlementing traits that would otherwise be useful</p>



<a name="277446952"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/238009-t-compiler/meetings/topic/%5Bsteering%20meeting%5D%202022-04-01%20compiler-team%23490/near/277446952" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Aaron Hill <a href="https://zulip-archive.rust-lang.org/stream/238009-t-compiler/meetings/topic/.5Bsteering.20meeting.5D.202022-04-01.20compiler-team.23490.html#277446952">(Apr 01 2022 at 16:50)</a>:</h4>
<p>E.g Hash</p>



<a name="277446987"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/238009-t-compiler/meetings/topic/%5Bsteering%20meeting%5D%202022-04-01%20compiler-team%23490/near/277446987" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> lcnr <a href="https://zulip-archive.rust-lang.org/stream/238009-t-compiler/meetings/topic/.5Bsteering.20meeting.5D.202022-04-01.20compiler-team.23490.html#277446987">(Apr 01 2022 at 16:50)</a>:</h4>
<p><span class="user-mention silent" data-user-id="124287">mw</span> <a href="#narrow/stream/238009-t-compiler.2Fmeetings/topic/.5Bsteering.20meeting.5D.202022-04-01.20compiler-team.23490/near/277446826">said</a>:</p>
<blockquote>
<p>does the lint not work?</p>
</blockquote>
<p>it does, but fixing rustc while not being able to use the bootstrap compiler was annoying, so i didn't do it.</p>
<p>and after the last beta cutoff i wanted to wait for this meeting ^^</p>



<a name="277447003"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/238009-t-compiler/meetings/topic/%5Bsteering%20meeting%5D%202022-04-01%20compiler-team%23490/near/277447003" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> mw <a href="https://zulip-archive.rust-lang.org/stream/238009-t-compiler/meetings/topic/.5Bsteering.20meeting.5D.202022-04-01.20compiler-team.23490.html#277447003">(Apr 01 2022 at 16:51)</a>:</h4>
<p><span class="user-mention silent" data-user-id="125294">Aaron Hill</span> <a href="#narrow/stream/238009-t-compiler.2Fmeetings/topic/.5Bsteering.20meeting.5D.202022-04-01.20compiler-team.23490/near/277446938">said</a>:</p>
<blockquote>
<p>We need to ensure that all types with untracked data (e.g. the raw number in DefId) are inaccessible, which require not imlementing traits that would otherwise be useful</p>
</blockquote>
<p>Yes, I think that approach is a dead end</p>



<a name="277447011"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/238009-t-compiler/meetings/topic/%5Bsteering%20meeting%5D%202022-04-01%20compiler-team%23490/near/277447011" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pierwill <a href="https://zulip-archive.rust-lang.org/stream/238009-t-compiler/meetings/topic/.5Bsteering.20meeting.5D.202022-04-01.20compiler-team.23490.html#277447011">(Apr 01 2022 at 16:51)</a>:</h4>
<p><span class="user-mention silent" data-user-id="125294">Aaron Hill</span> <a href="#narrow/stream/238009-t-compiler.2Fmeetings/topic/.5Bsteering.20meeting.5D.202022-04-01.20compiler-team.23490/near/277446952">said</a>:</p>
<blockquote>
<p>E.g Hash</p>
</blockquote>
<p>also <code>Ord</code> <span aria-label="smiling devil" class="emoji emoji-1f608" role="img" title="smiling devil">:smiling_devil:</span></p>



<a name="277447032"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/238009-t-compiler/meetings/topic/%5Bsteering%20meeting%5D%202022-04-01%20compiler-team%23490/near/277447032" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Aaron Hill <a href="https://zulip-archive.rust-lang.org/stream/238009-t-compiler/meetings/topic/.5Bsteering.20meeting.5D.202022-04-01.20compiler-team.23490.html#277447032">(Apr 01 2022 at 16:51)</a>:</h4>
<p>If we don't do that, then we run the risk of someone adding a new type that presents the same kind of problems as hashmap iteration, but the lint doesn't know about</p>



<a name="277447048"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/238009-t-compiler/meetings/topic/%5Bsteering%20meeting%5D%202022-04-01%20compiler-team%23490/near/277447048" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pnkfelix <a href="https://zulip-archive.rust-lang.org/stream/238009-t-compiler/meetings/topic/.5Bsteering.20meeting.5D.202022-04-01.20compiler-team.23490.html#277447048">(Apr 01 2022 at 16:51)</a>:</h4>
<p>wait, <span class="user-mention" data-user-id="125294">@Aaron Hill</span> : Not implementing traits like <code>Hash</code>, or not <em>deriving</em> them ?</p>



<a name="277447084"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/238009-t-compiler/meetings/topic/%5Bsteering%20meeting%5D%202022-04-01%20compiler-team%23490/near/277447084" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pierwill <a href="https://zulip-archive.rust-lang.org/stream/238009-t-compiler/meetings/topic/.5Bsteering.20meeting.5D.202022-04-01.20compiler-team.23490.html#277447084">(Apr 01 2022 at 16:51)</a>:</h4>
<p>This is what HashStable is for, no?</p>



<a name="277447085"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/238009-t-compiler/meetings/topic/%5Bsteering%20meeting%5D%202022-04-01%20compiler-team%23490/near/277447085" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pnkfelix <a href="https://zulip-archive.rust-lang.org/stream/238009-t-compiler/meetings/topic/.5Bsteering.20meeting.5D.202022-04-01.20compiler-team.23490.html#277447085">(Apr 01 2022 at 16:51)</a>:</h4>
<p>like, maybe we need our own specialized derive's that are aware of tracked/untracked attributes?</p>



<a name="277447123"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/238009-t-compiler/meetings/topic/%5Bsteering%20meeting%5D%202022-04-01%20compiler-team%23490/near/277447123" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Aaron Hill <a href="https://zulip-archive.rust-lang.org/stream/238009-t-compiler/meetings/topic/.5Bsteering.20meeting.5D.202022-04-01.20compiler-team.23490.html#277447123">(Apr 01 2022 at 16:52)</a>:</h4>
<p>If we implement them, then they need to do through the 'tracked' data</p>



<a name="277447142"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/238009-t-compiler/meetings/topic/%5Bsteering%20meeting%5D%202022-04-01%20compiler-team%23490/near/277447142" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> cjgillot <a href="https://zulip-archive.rust-lang.org/stream/238009-t-compiler/meetings/topic/.5Bsteering.20meeting.5D.202022-04-01.20compiler-team.23490.html#277447142">(Apr 01 2022 at 16:52)</a>:</h4>
<p><span class="user-mention silent" data-user-id="124287">mw</span> <a href="#narrow/stream/238009-t-compiler.2Fmeetings/topic/.5Bsteering.20meeting.5D.202022-04-01.20compiler-team.23490/near/277447003">said</a>:</p>
<blockquote>
<p><span class="user-mention silent" data-user-id="125294">Aaron Hill</span> <a href="#narrow/stream/238009-t-compiler.2Fmeetings/topic/.5Bsteering.20meeting.5D.202022-04-01.20compiler-team.23490/near/277446938">said</a>:</p>
<blockquote>
<p>We need to ensure that all types with untracked data (e.g. the raw number in DefId) are inaccessible, which require not imlementing traits that would otherwise be useful</p>
</blockquote>
<p>Yes, I think that approach is a dead end</p>
</blockquote>
<p>We can replace such types with an incr-comp aware interning scheme (only one), and ban custom HashStable impls altogether.</p>



<a name="277447194"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/238009-t-compiler/meetings/topic/%5Bsteering%20meeting%5D%202022-04-01%20compiler-team%23490/near/277447194" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pnkfelix <a href="https://zulip-archive.rust-lang.org/stream/238009-t-compiler/meetings/topic/.5Bsteering.20meeting.5D.202022-04-01.20compiler-team.23490.html#277447194">(Apr 01 2022 at 16:52)</a>:</h4>
<p><span class="user-mention silent" data-user-id="316352">pierwill</span> <a href="#narrow/stream/238009-t-compiler.2Fmeetings/topic/.5Bsteering.20meeting.5D.202022-04-01.20compiler-team.23490/near/277447084">said</a>:</p>
<blockquote>
<p>This is what HashStable is for, no?</p>
</blockquote>
<p>hash-stable handles making fingerprints, but its not used for impelemnting Hash itself to my knowledge</p>



<a name="277447202"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/238009-t-compiler/meetings/topic/%5Bsteering%20meeting%5D%202022-04-01%20compiler-team%23490/near/277447202" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Aaron Hill <a href="https://zulip-archive.rust-lang.org/stream/238009-t-compiler/meetings/topic/.5Bsteering.20meeting.5D.202022-04-01.20compiler-team.23490.html#277447202">(Apr 01 2022 at 16:52)</a>:</h4>
<p>For Hash, that would mean pulling a tcx out of thin airz and grabbing the DefPathHash</p>



<a name="277447313"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/238009-t-compiler/meetings/topic/%5Bsteering%20meeting%5D%202022-04-01%20compiler-team%23490/near/277447313" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> bjorn3 <a href="https://zulip-archive.rust-lang.org/stream/238009-t-compiler/meetings/topic/.5Bsteering.20meeting.5D.202022-04-01.20compiler-team.23490.html#277447313">(Apr 01 2022 at 16:53)</a>:</h4>
<p>We have <code>tcx</code> stored in a thread local variable you can access.</p>



<a name="277447319"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/238009-t-compiler/meetings/topic/%5Bsteering%20meeting%5D%202022-04-01%20compiler-team%23490/near/277447319" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pnkfelix <a href="https://zulip-archive.rust-lang.org/stream/238009-t-compiler/meetings/topic/.5Bsteering.20meeting.5D.202022-04-01.20compiler-team.23490.html#277447319">(Apr 01 2022 at 16:53)</a>:</h4>
<p><span class="user-mention silent" data-user-id="125294">Aaron Hill</span> <a href="#narrow/stream/238009-t-compiler.2Fmeetings/topic/.5Bsteering.20meeting.5D.202022-04-01.20compiler-team.23490/near/277447123">said</a>:</p>
<blockquote>
<p>If we implement them, then they need to do through the 'tracked' data</p>
</blockquote>
<p>ah, because its not enough to just look at the embedded tracked fields, but rather we have to connect it up to the info in the tcx ?</p>



<a name="277447328"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/238009-t-compiler/meetings/topic/%5Bsteering%20meeting%5D%202022-04-01%20compiler-team%23490/near/277447328" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> mw <a href="https://zulip-archive.rust-lang.org/stream/238009-t-compiler/meetings/topic/.5Bsteering.20meeting.5D.202022-04-01.20compiler-team.23490.html#277447328">(Apr 01 2022 at 16:53)</a>:</h4>
<p><span class="user-mention silent" data-user-id="248906">cjgillot</span> <a href="#narrow/stream/238009-t-compiler.2Fmeetings/topic/.5Bsteering.20meeting.5D.202022-04-01.20compiler-team.23490/near/277447142">said</a>:</p>
<blockquote>
<p><span class="user-mention silent" data-user-id="124287">mw</span> <a href="#narrow/stream/238009-t-compiler.2Fmeetings/topic/.5Bsteering.20meeting.5D.202022-04-01.20compiler-team.23490/near/277447003">said</a>:</p>
<blockquote>
<p><span class="user-mention silent" data-user-id="125294">Aaron Hill</span> <a href="#narrow/stream/238009-t-compiler.2Fmeetings/topic/.5Bsteering.20meeting.5D.202022-04-01.20compiler-team.23490/near/277446938">said</a>:</p>
<blockquote>
<p>We need to ensure that all types with untracked data (e.g. the raw number in DefId) are inaccessible, which require not imlementing traits that would otherwise be useful</p>
</blockquote>
<p>Yes, I think that approach is a dead end</p>
</blockquote>
<p>We can replace such types with an incr-comp aware interning scheme (only one), and ban custom HashStable impls altogether.</p>
</blockquote>
<p>That sounds similar to <a href="https://hackmd.io/@michaelwoerister/SJf9VU1-5#Make-pointer-like-IDs-stable-across-compilation-session-boundaries-STABLE_IDS">https://hackmd.io/@michaelwoerister/SJf9VU1-5#Make-pointer-like-IDs-stable-across-compilation-session-boundaries-STABLE_IDS</a>, right?</p>



<a name="277447381"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/238009-t-compiler/meetings/topic/%5Bsteering%20meeting%5D%202022-04-01%20compiler-team%23490/near/277447381" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Aaron Hill <a href="https://zulip-archive.rust-lang.org/stream/238009-t-compiler/meetings/topic/.5Bsteering.20meeting.5D.202022-04-01.20compiler-team.23490.html#277447381">(Apr 01 2022 at 16:53)</a>:</h4>
<p>We don't currently embed the tracked data into a DefId</p>



<a name="277447391"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/238009-t-compiler/meetings/topic/%5Bsteering%20meeting%5D%202022-04-01%20compiler-team%23490/near/277447391" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Aaron Hill <a href="https://zulip-archive.rust-lang.org/stream/238009-t-compiler/meetings/topic/.5Bsteering.20meeting.5D.202022-04-01.20compiler-team.23490.html#277447391">(Apr 01 2022 at 16:53)</a>:</h4>
<p>same with ExpnId</p>



<a name="277447434"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/238009-t-compiler/meetings/topic/%5Bsteering%20meeting%5D%202022-04-01%20compiler-team%23490/near/277447434" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> bjorn3 <a href="https://zulip-archive.rust-lang.org/stream/238009-t-compiler/meetings/topic/.5Bsteering.20meeting.5D.202022-04-01.20compiler-team.23490.html#277447434">(Apr 01 2022 at 16:53)</a>:</h4>
<p><span class="user-mention silent" data-user-id="133247">bjorn3</span> <a href="#narrow/stream/238009-t-compiler.2Fmeetings/topic/.5Bsteering.20meeting.5D.202022-04-01.20compiler-team.23490/near/277447313">said</a>:</p>
<blockquote>
<p>We have <code>tcx</code> stored in a thread local variable you can access.</p>
</blockquote>
<p><code>rustc_middle::ty::tls::with_context</code></p>



<a name="277447436"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/238009-t-compiler/meetings/topic/%5Bsteering%20meeting%5D%202022-04-01%20compiler-team%23490/near/277447436" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Aaron Hill <a href="https://zulip-archive.rust-lang.org/stream/238009-t-compiler/meetings/topic/.5Bsteering.20meeting.5D.202022-04-01.20compiler-team.23490.html#277447436">(Apr 01 2022 at 16:53)</a>:</h4>
<p>My concern is that in the future, someone may want to add/implement some new datastructre in the compiler (e.g. some kind of custom hashmap), and accidentally ends up using untracked data in a 'bad' way</p>



<a name="277447444"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/238009-t-compiler/meetings/topic/%5Bsteering%20meeting%5D%202022-04-01%20compiler-team%23490/near/277447444" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> mw <a href="https://zulip-archive.rust-lang.org/stream/238009-t-compiler/meetings/topic/.5Bsteering.20meeting.5D.202022-04-01.20compiler-team.23490.html#277447444">(Apr 01 2022 at 16:53)</a>:</h4>
<p>I think we should look into making these ID's be interned pointers</p>



<a name="277447481"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/238009-t-compiler/meetings/topic/%5Bsteering%20meeting%5D%202022-04-01%20compiler-team%23490/near/277447481" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> mw <a href="https://zulip-archive.rust-lang.org/stream/238009-t-compiler/meetings/topic/.5Bsteering.20meeting.5D.202022-04-01.20compiler-team.23490.html#277447481">(Apr 01 2022 at 16:54)</a>:</h4>
<p>as @oli already does, I think</p>



<a name="277447516"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/238009-t-compiler/meetings/topic/%5Bsteering%20meeting%5D%202022-04-01%20compiler-team%23490/near/277447516" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Aaron Hill <a href="https://zulip-archive.rust-lang.org/stream/238009-t-compiler/meetings/topic/.5Bsteering.20meeting.5D.202022-04-01.20compiler-team.23490.html#277447516">(Apr 01 2022 at 16:54)</a>:</h4>
<p>but in a way that would be completely fine if we didn't have to worry about incremental comp problems</p>



<a name="277447573"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/238009-t-compiler/meetings/topic/%5Bsteering%20meeting%5D%202022-04-01%20compiler-team%23490/near/277447573" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Aaron Hill <a href="https://zulip-archive.rust-lang.org/stream/238009-t-compiler/meetings/topic/.5Bsteering.20meeting.5D.202022-04-01.20compiler-team.23490.html#277447573">(Apr 01 2022 at 16:54)</a>:</h4>
<p>Since the lint needs to specifically ban patterns that correspond to 'bad' uses of untracked data</p>



<a name="277447578"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/238009-t-compiler/meetings/topic/%5Bsteering%20meeting%5D%202022-04-01%20compiler-team%23490/near/277447578" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> mw <a href="https://zulip-archive.rust-lang.org/stream/238009-t-compiler/meetings/topic/.5Bsteering.20meeting.5D.202022-04-01.20compiler-team.23490.html#277447578">(Apr 01 2022 at 16:54)</a>:</h4>
<p>data can only become untracked if it is ignored by HashStable and Eq, right?</p>



<a name="277447613"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/238009-t-compiler/meetings/topic/%5Bsteering%20meeting%5D%202022-04-01%20compiler-team%23490/near/277447613" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pierwill <a href="https://zulip-archive.rust-lang.org/stream/238009-t-compiler/meetings/topic/.5Bsteering.20meeting.5D.202022-04-01.20compiler-team.23490.html#277447613">(Apr 01 2022 at 16:55)</a>:</h4>
<p>Another high-level Q: Are there any bug classes with current incr comp that fall outside of this general description: Problems with <em>untracked state</em>?</p>



<a name="277447664"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/238009-t-compiler/meetings/topic/%5Bsteering%20meeting%5D%202022-04-01%20compiler-team%23490/near/277447664" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> bjorn3 <a href="https://zulip-archive.rust-lang.org/stream/238009-t-compiler/meetings/topic/.5Bsteering.20meeting.5D.202022-04-01.20compiler-team.23490.html#277447664">(Apr 01 2022 at 16:55)</a>:</h4>
<p><span class="user-mention silent" data-user-id="124287">mw</span> <a href="#narrow/stream/238009-t-compiler.2Fmeetings/topic/.5Bsteering.20meeting.5D.202022-04-01.20compiler-team.23490/near/277447578">said</a>:</p>
<blockquote>
<p>data can only become untracked if it is ignored by HashStable and Eq, right?</p>
</blockquote>
<p>We also have the <code>Session</code> being partially untracked.</p>



<a name="277447667"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/238009-t-compiler/meetings/topic/%5Bsteering%20meeting%5D%202022-04-01%20compiler-team%23490/near/277447667" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> mw <a href="https://zulip-archive.rust-lang.org/stream/238009-t-compiler/meetings/topic/.5Bsteering.20meeting.5D.202022-04-01.20compiler-team.23490.html#277447667">(Apr 01 2022 at 16:55)</a>:</h4>
<p><span class="user-mention silent" data-user-id="316352">pierwill</span> <a href="#narrow/stream/238009-t-compiler.2Fmeetings/topic/.5Bsteering.20meeting.5D.202022-04-01.20compiler-team.23490/near/277447613">said</a>:</p>
<blockquote>
<p>Another high-level Q: Are there any bug classes with current incr comp that fall outside of this general description: Problems with <em>untracked state</em>?</p>
</blockquote>
<p><a href="https://hackmd.io/@michaelwoerister/SJf9VU1-5">https://hackmd.io/@michaelwoerister/SJf9VU1-5</a> list bug classes</p>



<a name="277447691"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/238009-t-compiler/meetings/topic/%5Bsteering%20meeting%5D%202022-04-01%20compiler-team%23490/near/277447691" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pierwill <a href="https://zulip-archive.rust-lang.org/stream/238009-t-compiler/meetings/topic/.5Bsteering.20meeting.5D.202022-04-01.20compiler-team.23490.html#277447691">(Apr 01 2022 at 16:55)</a>:</h4>
<p>I did see that, yes</p>



<a name="277447721"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/238009-t-compiler/meetings/topic/%5Bsteering%20meeting%5D%202022-04-01%20compiler-team%23490/near/277447721" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> mw <a href="https://zulip-archive.rust-lang.org/stream/238009-t-compiler/meetings/topic/.5Bsteering.20meeting.5D.202022-04-01.20compiler-team.23490.html#277447721">(Apr 01 2022 at 16:55)</a>:</h4>
<p><span class="user-mention silent" data-user-id="133247">bjorn3</span> <a href="#narrow/stream/238009-t-compiler.2Fmeetings/topic/.5Bsteering.20meeting.5D.202022-04-01.20compiler-team.23490/near/277447664">said</a>:</p>
<blockquote>
<p><span class="user-mention silent" data-user-id="124287">mw</span> <a href="#narrow/stream/238009-t-compiler.2Fmeetings/topic/.5Bsteering.20meeting.5D.202022-04-01.20compiler-team.23490/near/277447578">said</a>:</p>
<blockquote>
<p>data can only become untracked if it is ignored by HashStable and Eq, right?</p>
</blockquote>
<p>We also have the <code>Session</code> being partially untracked.</p>
</blockquote>
<p>Yes, but that's a different kind of untracked, I think :)</p>



<a name="277447780"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/238009-t-compiler/meetings/topic/%5Bsteering%20meeting%5D%202022-04-01%20compiler-team%23490/near/277447780" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pierwill <a href="https://zulip-archive.rust-lang.org/stream/238009-t-compiler/meetings/topic/.5Bsteering.20meeting.5D.202022-04-01.20compiler-team.23490.html#277447780">(Apr 01 2022 at 16:56)</a>:</h4>
<p>I wondered if they could possibly be reduced to a single idea</p>



<a name="277447788"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/238009-t-compiler/meetings/topic/%5Bsteering%20meeting%5D%202022-04-01%20compiler-team%23490/near/277447788" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pnkfelix <a href="https://zulip-archive.rust-lang.org/stream/238009-t-compiler/meetings/topic/.5Bsteering.20meeting.5D.202022-04-01.20compiler-team.23490.html#277447788">(Apr 01 2022 at 16:56)</a>:</h4>
<p>if you squint, maybe they're all "kinds of untracked state"</p>



<a name="277447821"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/238009-t-compiler/meetings/topic/%5Bsteering%20meeting%5D%202022-04-01%20compiler-team%23490/near/277447821" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pnkfelix <a href="https://zulip-archive.rust-lang.org/stream/238009-t-compiler/meetings/topic/.5Bsteering.20meeting.5D.202022-04-01.20compiler-team.23490.html#277447821">(Apr 01 2022 at 16:56)</a>:</h4>
<p>but the different kinds of ways it arises is important, I think. Maybe.</p>



<a name="277447823"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/238009-t-compiler/meetings/topic/%5Bsteering%20meeting%5D%202022-04-01%20compiler-team%23490/near/277447823" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> mw <a href="https://zulip-archive.rust-lang.org/stream/238009-t-compiler/meetings/topic/.5Bsteering.20meeting.5D.202022-04-01.20compiler-team.23490.html#277447823">(Apr 01 2022 at 16:56)</a>:</h4>
<p>"Fingerprinting doesnt catch it" vs "we are not adding a dependency edge"</p>



<a name="277447889"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/238009-t-compiler/meetings/topic/%5Bsteering%20meeting%5D%202022-04-01%20compiler-team%23490/near/277447889" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nagisa <a href="https://zulip-archive.rust-lang.org/stream/238009-t-compiler/meetings/topic/.5Bsteering.20meeting.5D.202022-04-01.20compiler-team.23490.html#277447889">(Apr 01 2022 at 16:56)</a>:</h4>
<p>well there might be a logic bug in the infrastructure somewhere and somehow too, but its not a kind of issue we've seen in practice, have we?</p>



<a name="277447920"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/238009-t-compiler/meetings/topic/%5Bsteering%20meeting%5D%202022-04-01%20compiler-team%23490/near/277447920" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pierwill <a href="https://zulip-archive.rust-lang.org/stream/238009-t-compiler/meetings/topic/.5Bsteering.20meeting.5D.202022-04-01.20compiler-team.23490.html#277447920">(Apr 01 2022 at 16:57)</a>:</h4>
<p>I think <span class="user-mention" data-user-id="248906">@cjgillot</span> is onto something by thinking of things in terms of <em>information flow</em></p>



<a name="277447948"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/238009-t-compiler/meetings/topic/%5Bsteering%20meeting%5D%202022-04-01%20compiler-team%23490/near/277447948" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Aaron Hill <a href="https://zulip-archive.rust-lang.org/stream/238009-t-compiler/meetings/topic/.5Bsteering.20meeting.5D.202022-04-01.20compiler-team.23490.html#277447948">(Apr 01 2022 at 16:57)</a>:</h4>
<p>Recently, there was the issue of deserialization invoking queries</p>



<a name="277447993"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/238009-t-compiler/meetings/topic/%5Bsteering%20meeting%5D%202022-04-01%20compiler-team%23490/near/277447993" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wesley Wiser <a href="https://zulip-archive.rust-lang.org/stream/238009-t-compiler/meetings/topic/.5Bsteering.20meeting.5D.202022-04-01.20compiler-team.23490.html#277447993">(Apr 01 2022 at 16:57)</a>:</h4>
<p>So, not to completely disrupt the conversation, but we have five minutes left. Is there general consensus for option 1 or option 2 as the current next step (with potentially some details still to be hashed out)? Or do we need to schedule another design meeting to continue investigating our options?</p>



<a name="277447995"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/238009-t-compiler/meetings/topic/%5Bsteering%20meeting%5D%202022-04-01%20compiler-team%23490/near/277447995" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Aaron Hill <a href="https://zulip-archive.rust-lang.org/stream/238009-t-compiler/meetings/topic/.5Bsteering.20meeting.5D.202022-04-01.20compiler-team.23490.html#277447995">(Apr 01 2022 at 16:57)</a>:</h4>
<p>We now ban that entirely, but we could potentially have similar issues with queries being invoked in weird places</p>



<a name="277448027"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/238009-t-compiler/meetings/topic/%5Bsteering%20meeting%5D%202022-04-01%20compiler-team%23490/near/277448027" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Aaron Hill <a href="https://zulip-archive.rust-lang.org/stream/238009-t-compiler/meetings/topic/.5Bsteering.20meeting.5D.202022-04-01.20compiler-team.23490.html#277448027">(Apr 01 2022 at 16:57)</a>:</h4>
<p>any kind of re-entrant invocation in particular</p>



<a name="277448040"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/238009-t-compiler/meetings/topic/%5Bsteering%20meeting%5D%202022-04-01%20compiler-team%23490/near/277448040" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pnkfelix <a href="https://zulip-archive.rust-lang.org/stream/238009-t-compiler/meetings/topic/.5Bsteering.20meeting.5D.202022-04-01.20compiler-team.23490.html#277448040">(Apr 01 2022 at 16:57)</a>:</h4>
<p>I think we might need another meeting to figure out Option 1 vs Option 2 for short-term</p>



<a name="277448101"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/238009-t-compiler/meetings/topic/%5Bsteering%20meeting%5D%202022-04-01%20compiler-team%23490/near/277448101" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pnkfelix <a href="https://zulip-archive.rust-lang.org/stream/238009-t-compiler/meetings/topic/.5Bsteering.20meeting.5D.202022-04-01.20compiler-team.23490.html#277448101">(Apr 01 2022 at 16:58)</a>:</h4>
<p>it seems like it deserves its own doc</p>



<a name="277448111"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/238009-t-compiler/meetings/topic/%5Bsteering%20meeting%5D%202022-04-01%20compiler-team%23490/near/277448111" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pierwill <a href="https://zulip-archive.rust-lang.org/stream/238009-t-compiler/meetings/topic/.5Bsteering.20meeting.5D.202022-04-01.20compiler-team.23490.html#277448111">(Apr 01 2022 at 16:58)</a>:</h4>
<p>Yes. Research into Option 2 seems required for going forward</p>



<a name="277448151"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/238009-t-compiler/meetings/topic/%5Bsteering%20meeting%5D%202022-04-01%20compiler-team%23490/near/277448151" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> mw <a href="https://zulip-archive.rust-lang.org/stream/238009-t-compiler/meetings/topic/.5Bsteering.20meeting.5D.202022-04-01.20compiler-team.23490.html#277448151">(Apr 01 2022 at 16:58)</a>:</h4>
<p>maybe we can get niko to present Salsa with Entities before that</p>



<a name="277448194"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/238009-t-compiler/meetings/topic/%5Bsteering%20meeting%5D%202022-04-01%20compiler-team%23490/near/277448194" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> mw <a href="https://zulip-archive.rust-lang.org/stream/238009-t-compiler/meetings/topic/.5Bsteering.20meeting.5D.202022-04-01.20compiler-team.23490.html#277448194">(Apr 01 2022 at 16:58)</a>:</h4>
<p>I think he is generally interested in doing so</p>



<a name="277448262"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/238009-t-compiler/meetings/topic/%5Bsteering%20meeting%5D%202022-04-01%20compiler-team%23490/near/277448262" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pnkfelix <a href="https://zulip-archive.rust-lang.org/stream/238009-t-compiler/meetings/topic/.5Bsteering.20meeting.5D.202022-04-01.20compiler-team.23490.html#277448262">(Apr 01 2022 at 16:59)</a>:</h4>
<p>incidentally,. <span class="user-mention" data-user-id="316352">@pierwill</span> , would you be interested in trying to assist with co-authoring a follow-up doc? I think its useful to have perspective from someone asking the kinds of questions you are posing.</p>



<a name="277448288"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/238009-t-compiler/meetings/topic/%5Bsteering%20meeting%5D%202022-04-01%20compiler-team%23490/near/277448288" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pnkfelix <a href="https://zulip-archive.rust-lang.org/stream/238009-t-compiler/meetings/topic/.5Bsteering.20meeting.5D.202022-04-01.20compiler-team.23490.html#277448288">(Apr 01 2022 at 16:59)</a>:</h4>
<p>(arguably that shluld have been a privmsg <span aria-label="lol" class="emoji emoji-1f606" role="img" title="lol">:lol:</span> )</p>



<a name="277448300"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/238009-t-compiler/meetings/topic/%5Bsteering%20meeting%5D%202022-04-01%20compiler-team%23490/near/277448300" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pierwill <a href="https://zulip-archive.rust-lang.org/stream/238009-t-compiler/meetings/topic/.5Bsteering.20meeting.5D.202022-04-01.20compiler-team.23490.html#277448300">(Apr 01 2022 at 16:59)</a>:</h4>
<p>Sure. I'd be happy to help</p>



<a name="277448460"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/238009-t-compiler/meetings/topic/%5Bsteering%20meeting%5D%202022-04-01%20compiler-team%23490/near/277448460" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wesley Wiser <a href="https://zulip-archive.rust-lang.org/stream/238009-t-compiler/meetings/topic/.5Bsteering.20meeting.5D.202022-04-01.20compiler-team.23490.html#277448460">(Apr 01 2022 at 17:00)</a>:</h4>
<p>Ok, so it seems like the actual next steps are to bug <span class="user-mention" data-user-id="116009">@nikomatsakis</span> to talk about "salsa with entities", put in another meeting proposal to continue the discussion after that and make a decision for the short-medium term.</p>



<a name="277448479"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/238009-t-compiler/meetings/topic/%5Bsteering%20meeting%5D%202022-04-01%20compiler-team%23490/near/277448479" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> mw <a href="https://zulip-archive.rust-lang.org/stream/238009-t-compiler/meetings/topic/.5Bsteering.20meeting.5D.202022-04-01.20compiler-team.23490.html#277448479">(Apr 01 2022 at 17:00)</a>:</h4>
<p>I think this meeting was quite productive :)</p>



<a name="277448525"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/238009-t-compiler/meetings/topic/%5Bsteering%20meeting%5D%202022-04-01%20compiler-team%23490/near/277448525" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pnkfelix <a href="https://zulip-archive.rust-lang.org/stream/238009-t-compiler/meetings/topic/.5Bsteering.20meeting.5D.202022-04-01.20compiler-team.23490.html#277448525">(Apr 01 2022 at 17:01)</a>:</h4>
<p><span class="user-mention" data-user-id="125250">@Wesley Wiser</span> do you think a presentation from Niko is a prereq for the follow-up meeting itself?</p>



<a name="277448535"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/238009-t-compiler/meetings/topic/%5Bsteering%20meeting%5D%202022-04-01%20compiler-team%23490/near/277448535" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pnkfelix <a href="https://zulip-archive.rust-lang.org/stream/238009-t-compiler/meetings/topic/.5Bsteering.20meeting.5D.202022-04-01.20compiler-team.23490.html#277448535">(Apr 01 2022 at 17:01)</a>:</h4>
<p>it is not a prereq for writing the <em>proposal</em></p>



<a name="277448545"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/238009-t-compiler/meetings/topic/%5Bsteering%20meeting%5D%202022-04-01%20compiler-team%23490/near/277448545" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> cjgillot <a href="https://zulip-archive.rust-lang.org/stream/238009-t-compiler/meetings/topic/.5Bsteering.20meeting.5D.202022-04-01.20compiler-team.23490.html#277448545">(Apr 01 2022 at 17:01)</a>:</h4>
<p>Should it be the meeting itself?</p>



<a name="277448567"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/238009-t-compiler/meetings/topic/%5Bsteering%20meeting%5D%202022-04-01%20compiler-team%23490/near/277448567" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pnkfelix <a href="https://zulip-archive.rust-lang.org/stream/238009-t-compiler/meetings/topic/.5Bsteering.20meeting.5D.202022-04-01.20compiler-team.23490.html#277448567">(Apr 01 2022 at 17:01)</a>:</h4>
<p>but if it will heavily inform the doc writing, then that seems like it would affect schedule</p>



<a name="277448578"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/238009-t-compiler/meetings/topic/%5Bsteering%20meeting%5D%202022-04-01%20compiler-team%23490/near/277448578" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wesley Wiser <a href="https://zulip-archive.rust-lang.org/stream/238009-t-compiler/meetings/topic/.5Bsteering.20meeting.5D.202022-04-01.20compiler-team.23490.html#277448578">(Apr 01 2022 at 17:01)</a>:</h4>
<p>If someone else is willing to dive more into salsa so they can answer questions about what option 2 looks like specifically, that's fine.</p>



<a name="277448611"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/238009-t-compiler/meetings/topic/%5Bsteering%20meeting%5D%202022-04-01%20compiler-team%23490/near/277448611" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pnkfelix <a href="https://zulip-archive.rust-lang.org/stream/238009-t-compiler/meetings/topic/.5Bsteering.20meeting.5D.202022-04-01.20compiler-team.23490.html#277448611">(Apr 01 2022 at 17:01)</a>:</h4>
<p>I'm not sure if it should be the meeting itself. It <em>could</em> be, but I'm not sure if we'll walk away with action items from a informational presentation.</p>



<a name="277448618"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/238009-t-compiler/meetings/topic/%5Bsteering%20meeting%5D%202022-04-01%20compiler-team%23490/near/277448618" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wesley Wiser <a href="https://zulip-archive.rust-lang.org/stream/238009-t-compiler/meetings/topic/.5Bsteering.20meeting.5D.202022-04-01.20compiler-team.23490.html#277448618">(Apr 01 2022 at 17:01)</a>:</h4>
<p>But without that, it seems like we'll just be guessing a bit as to what option 2 actually looks like.</p>



<a name="277448623"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/238009-t-compiler/meetings/topic/%5Bsteering%20meeting%5D%202022-04-01%20compiler-team%23490/near/277448623" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> mw <a href="https://zulip-archive.rust-lang.org/stream/238009-t-compiler/meetings/topic/.5Bsteering.20meeting.5D.202022-04-01.20compiler-team.23490.html#277448623">(Apr 01 2022 at 17:02)</a>:</h4>
<p>I think Salsa with Entities is still rather experimental</p>



<a name="277448681"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/238009-t-compiler/meetings/topic/%5Bsteering%20meeting%5D%202022-04-01%20compiler-team%23490/near/277448681" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> mw <a href="https://zulip-archive.rust-lang.org/stream/238009-t-compiler/meetings/topic/.5Bsteering.20meeting.5D.202022-04-01.20compiler-team.23490.html#277448681">(Apr 01 2022 at 17:02)</a>:</h4>
<p>so looking a vanilla salsa won't be very informative</p>



<a name="277448736"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/238009-t-compiler/meetings/topic/%5Bsteering%20meeting%5D%202022-04-01%20compiler-team%23490/near/277448736" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pnkfelix <a href="https://zulip-archive.rust-lang.org/stream/238009-t-compiler/meetings/topic/.5Bsteering.20meeting.5D.202022-04-01.20compiler-team.23490.html#277448736">(Apr 01 2022 at 17:02)</a>:</h4>
<p><span class="user-mention" data-user-id="124287">@mw</span> you mean because Salsa as it stands today wouldn't represent the kinds of capabilties that you think are necessary to go down the path of Option 2 ?</p>



<a name="277448780"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/238009-t-compiler/meetings/topic/%5Bsteering%20meeting%5D%202022-04-01%20compiler-team%23490/near/277448780" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> mw <a href="https://zulip-archive.rust-lang.org/stream/238009-t-compiler/meetings/topic/.5Bsteering.20meeting.5D.202022-04-01.20compiler-team.23490.html#277448780">(Apr 01 2022 at 17:03)</a>:</h4>
<p>yes, today's Salsa is very similar to our query system</p>



<a name="277448790"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/238009-t-compiler/meetings/topic/%5Bsteering%20meeting%5D%202022-04-01%20compiler-team%23490/near/277448790" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> mw <a href="https://zulip-archive.rust-lang.org/stream/238009-t-compiler/meetings/topic/.5Bsteering.20meeting.5D.202022-04-01.20compiler-team.23490.html#277448790">(Apr 01 2022 at 17:03)</a>:</h4>
<p>afaik</p>



<a name="277448822"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/238009-t-compiler/meetings/topic/%5Bsteering%20meeting%5D%202022-04-01%20compiler-team%23490/near/277448822" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pnkfelix <a href="https://zulip-archive.rust-lang.org/stream/238009-t-compiler/meetings/topic/.5Bsteering.20meeting.5D.202022-04-01.20compiler-team.23490.html#277448822">(Apr 01 2022 at 17:03)</a>:</h4>
<p>okay.</p>



<a name="277448856"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/238009-t-compiler/meetings/topic/%5Bsteering%20meeting%5D%202022-04-01%20compiler-team%23490/near/277448856" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> mw <a href="https://zulip-archive.rust-lang.org/stream/238009-t-compiler/meetings/topic/.5Bsteering.20meeting.5D.202022-04-01.20compiler-team.23490.html#277448856">(Apr 01 2022 at 17:03)</a>:</h4>
<p>the new salsa exists somewhere, it's not just on paper</p>



<a name="277448920"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/238009-t-compiler/meetings/topic/%5Bsteering%20meeting%5D%202022-04-01%20compiler-team%23490/near/277448920" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pnkfelix <a href="https://zulip-archive.rust-lang.org/stream/238009-t-compiler/meetings/topic/.5Bsteering.20meeting.5D.202022-04-01.20compiler-team.23490.html#277448920">(Apr 01 2022 at 17:04)</a>:</h4>
<p>Until we decide between Option 1 or Option 2, it seems like a mistake to invest time digging into the details of each of the proposed tactics to making Option 1 workable</p>



<a name="277448923"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/238009-t-compiler/meetings/topic/%5Bsteering%20meeting%5D%202022-04-01%20compiler-team%23490/near/277448923" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> mw <a href="https://zulip-archive.rust-lang.org/stream/238009-t-compiler/meetings/topic/.5Bsteering.20meeting.5D.202022-04-01.20compiler-team.23490.html#277448923">(Apr 01 2022 at 17:04)</a>:</h4>
<p><a href="https://dada-lang.org/">https://dada-lang.org/</a> is built on top of it, I think</p>



<a name="277448967"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/238009-t-compiler/meetings/topic/%5Bsteering%20meeting%5D%202022-04-01%20compiler-team%23490/near/277448967" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> mw <a href="https://zulip-archive.rust-lang.org/stream/238009-t-compiler/meetings/topic/.5Bsteering.20meeting.5D.202022-04-01.20compiler-team.23490.html#277448967">(Apr 01 2022 at 17:04)</a>:</h4>
<p>in my opinion, option 2 is mostly a superset of option 1</p>



<a name="277449242"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/238009-t-compiler/meetings/topic/%5Bsteering%20meeting%5D%202022-04-01%20compiler-team%23490/near/277449242" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pnkfelix <a href="https://zulip-archive.rust-lang.org/stream/238009-t-compiler/meetings/topic/.5Bsteering.20meeting.5D.202022-04-01.20compiler-team.23490.html#277449242">(Apr 01 2022 at 17:07)</a>:</h4>
<p>yeah, okay, I need to go back and look again at which items from Option 1 <em>don't</em> end up duplicated in Option 2.</p>



<a name="277449290"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/238009-t-compiler/meetings/topic/%5Bsteering%20meeting%5D%202022-04-01%20compiler-team%23490/near/277449290" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pnkfelix <a href="https://zulip-archive.rust-lang.org/stream/238009-t-compiler/meetings/topic/.5Bsteering.20meeting.5D.202022-04-01.20compiler-team.23490.html#277449290">(Apr 01 2022 at 17:07)</a>:</h4>
<p>because it may well be that the outcome of this meeting <em>does</em> imply that we can invest effort on the tasks that fall under the intersection of Option 1 and Option 2.</p>



<a name="277449512"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/238009-t-compiler/meetings/topic/%5Bsteering%20meeting%5D%202022-04-01%20compiler-team%23490/near/277449512" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pnkfelix <a href="https://zulip-archive.rust-lang.org/stream/238009-t-compiler/meetings/topic/.5Bsteering.20meeting.5D.202022-04-01.20compiler-team.23490.html#277449512">(Apr 01 2022 at 17:08)</a>:</h4>
<p><span class="user-mention" data-user-id="124287">@mw</span> by the way, what <em>is</em> your answer for handling Spans in a robust+correct manner?</p>



<a name="277449573"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/238009-t-compiler/meetings/topic/%5Bsteering%20meeting%5D%202022-04-01%20compiler-team%23490/near/277449573" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> mw <a href="https://zulip-archive.rust-lang.org/stream/238009-t-compiler/meetings/topic/.5Bsteering.20meeting.5D.202022-04-01.20compiler-team.23490.html#277449573">(Apr 01 2022 at 17:09)</a>:</h4>
<p>If only I had one :(</p>



<a name="277449730"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/238009-t-compiler/meetings/topic/%5Bsteering%20meeting%5D%202022-04-01%20compiler-team%23490/near/277449730" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pnkfelix <a href="https://zulip-archive.rust-lang.org/stream/238009-t-compiler/meetings/topic/.5Bsteering.20meeting.5D.202022-04-01.20compiler-team.23490.html#277449730">(Apr 01 2022 at 17:10)</a>:</h4>
<p>mmm, okay.</p>



<a name="277449990"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/238009-t-compiler/meetings/topic/%5Bsteering%20meeting%5D%202022-04-01%20compiler-team%23490/near/277449990" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> cjgillot <a href="https://zulip-archive.rust-lang.org/stream/238009-t-compiler/meetings/topic/.5Bsteering.20meeting.5D.202022-04-01.20compiler-team.23490.html#277449990">(Apr 01 2022 at 17:12)</a>:</h4>
<p>What is the issue with spans?  Beside the untrackedness of the source_map?</p>



<a name="277450073"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/238009-t-compiler/meetings/topic/%5Bsteering%20meeting%5D%202022-04-01%20compiler-team%23490/near/277450073" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> mw <a href="https://zulip-archive.rust-lang.org/stream/238009-t-compiler/meetings/topic/.5Bsteering.20meeting.5D.202022-04-01.20compiler-team.23490.html#277450073">(Apr 01 2022 at 17:13)</a>:</h4>
<p>They require so much special handling right now</p>



<a name="277450116"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/238009-t-compiler/meetings/topic/%5Bsteering%20meeting%5D%202022-04-01%20compiler-team%23490/near/277450116" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> mw <a href="https://zulip-archive.rust-lang.org/stream/238009-t-compiler/meetings/topic/.5Bsteering.20meeting.5D.202022-04-01.20compiler-team.23490.html#277450116">(Apr 01 2022 at 17:13)</a>:</h4>
<p>it does not seem very robust</p>



<a name="277450160"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/238009-t-compiler/meetings/topic/%5Bsteering%20meeting%5D%202022-04-01%20compiler-team%23490/near/277450160" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> mw <a href="https://zulip-archive.rust-lang.org/stream/238009-t-compiler/meetings/topic/.5Bsteering.20meeting.5D.202022-04-01.20compiler-team.23490.html#277450160">(Apr 01 2022 at 17:13)</a>:</h4>
<p>and I personally don't have a good understanding of SyntaxContexts and their interactions with incr. comp.</p>



<a name="277450400"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/238009-t-compiler/meetings/topic/%5Bsteering%20meeting%5D%202022-04-01%20compiler-team%23490/near/277450400" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> mw <a href="https://zulip-archive.rust-lang.org/stream/238009-t-compiler/meetings/topic/.5Bsteering.20meeting.5D.202022-04-01.20compiler-team.23490.html#277450400">(Apr 01 2022 at 17:15)</a>:</h4>
<p>If we actually implement something as discussed at <a href="#narrow/stream/131828-t-compiler/topic/interned.20crate.20and.20def.20ids">https://rust-lang.zulipchat.com/#narrow/stream/131828-t-compiler/topic/interned.20crate.20and.20def.20ids</a>, Spans might also be the only thing left that require context information for stable hashing</p>



<a name="277450433"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/238009-t-compiler/meetings/topic/%5Bsteering%20meeting%5D%202022-04-01%20compiler-team%23490/near/277450433" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> mw <a href="https://zulip-archive.rust-lang.org/stream/238009-t-compiler/meetings/topic/.5Bsteering.20meeting.5D.202022-04-01.20compiler-team.23490.html#277450433">(Apr 01 2022 at 17:15)</a>:</h4>
<p>(I could be wrong about that)</p>



<a name="277456329"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/238009-t-compiler/meetings/topic/%5Bsteering%20meeting%5D%202022-04-01%20compiler-team%23490/near/277456329" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> The 8472 <a href="https://zulip-archive.rust-lang.org/stream/238009-t-compiler/meetings/topic/.5Bsteering.20meeting.5D.202022-04-01.20compiler-team.23490.html#277456329">(Apr 01 2022 at 17:59)</a>:</h4>
<p><span class="user-mention silent" data-user-id="232545">Joshua Nelson</span> <a href="#narrow/stream/238009-t-compiler.2Fmeetings/topic/.5Bsteering.20meeting.5D.202022-04-01.20compiler-team.23490/near/277444636">said</a>:</p>
<blockquote>
<p>I don't know if parallel is enough even. There's only so many cores on a given machine and cargo tends to use a lot of them already.</p>
</blockquote>
<p><a href="/user_uploads/4715/I_tuXQ5domp1m9P1usWbLXdn/image.png">image.png</a> </p>
<div class="message_inline_image"><a href="/user_uploads/4715/I_tuXQ5domp1m9P1usWbLXdn/image.png" title="image.png"><img src="/user_uploads/4715/I_tuXQ5domp1m9P1usWbLXdn/image.png"></a></div><p>This is the CPU utilization for building core/alloc/std + rustc in non-incremental mode, without sccache on a 24c/48t CPU. wall time is 1:42s. There are plenty of unusued core-seconds.</p>



<a name="277457185"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/238009-t-compiler/meetings/topic/%5Bsteering%20meeting%5D%202022-04-01%20compiler-team%23490/near/277457185" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nagisa <a href="https://zulip-archive.rust-lang.org/stream/238009-t-compiler/meetings/topic/.5Bsteering.20meeting.5D.202022-04-01.20compiler-team.23490.html#277457185">(Apr 01 2022 at 18:04)</a>:</h4>
<p>I was once really disappointed to see that spinning up a 64c instance in the clouds didn't make my builds any faster</p>



<a name="277457258"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/238009-t-compiler/meetings/topic/%5Bsteering%20meeting%5D%202022-04-01%20compiler-team%23490/near/277457258" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Nelson <a href="https://zulip-archive.rust-lang.org/stream/238009-t-compiler/meetings/topic/.5Bsteering.20meeting.5D.202022-04-01.20compiler-team.23490.html#277457258">(Apr 01 2022 at 18:04)</a>:</h4>
<p>Sure. libstd doesn't have many dependencies though, that graph would look different for large projects. and large projects IMO benefit even more from incremental.</p>



<a name="277457469"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/238009-t-compiler/meetings/topic/%5Bsteering%20meeting%5D%202022-04-01%20compiler-team%23490/near/277457469" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> The 8472 <a href="https://zulip-archive.rust-lang.org/stream/238009-t-compiler/meetings/topic/.5Bsteering.20meeting.5D.202022-04-01.20compiler-team.23490.html#277457469">(Apr 01 2022 at 18:06)</a>:</h4>
<p>Got one in mind that's easy to test? There might be sequential bottlenecks too, depending on the build graph.</p>



<a name="277458529"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/238009-t-compiler/meetings/topic/%5Bsteering%20meeting%5D%202022-04-01%20compiler-team%23490/near/277458529" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Nelson <a href="https://zulip-archive.rust-lang.org/stream/238009-t-compiler/meetings/topic/.5Bsteering.20meeting.5D.202022-04-01.20compiler-team.23490.html#277458529">(Apr 01 2022 at 18:13)</a>:</h4>
<p>hmm, <a href="http://docs.rs">docs.rs</a> has a bunch of dependencies, might be interesting to try</p>



<a name="277458568"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/238009-t-compiler/meetings/topic/%5Bsteering%20meeting%5D%202022-04-01%20compiler-team%23490/near/277458568" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Nelson <a href="https://zulip-archive.rust-lang.org/stream/238009-t-compiler/meetings/topic/.5Bsteering.20meeting.5D.202022-04-01.20compiler-team.23490.html#277458568">(Apr 01 2022 at 18:13)</a>:</h4>
<p>(was thinking of my work codebase originally, but it's closed source)</p>



<a name="277459520"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/238009-t-compiler/meetings/topic/%5Bsteering%20meeting%5D%202022-04-01%20compiler-team%23490/near/277459520" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> The 8472 <a href="https://zulip-archive.rust-lang.org/stream/238009-t-compiler/meetings/topic/.5Bsteering.20meeting.5D.202022-04-01.20compiler-team.23490.html#277459520">(Apr 01 2022 at 18:20)</a>:</h4>
<p><a href="http://docs.rs">docs.rs</a>, release build, 41.7s wall time. initially it uses all cores, towards the end it falls off as there are not enough crates left to feed it.</p>
<p><a href="/user_uploads/4715/Rmg-Tk785JJalGWrkruEugc_/image.png">image.png</a></p>
<div class="message_inline_image"><a href="/user_uploads/4715/Rmg-Tk785JJalGWrkruEugc_/image.png" title="image.png"><img src="/user_uploads/4715/Rmg-Tk785JJalGWrkruEugc_/image.png"></a></div>



<hr><p>Last updated: Apr 12 2022 at 20:01 UTC</p>
</html>