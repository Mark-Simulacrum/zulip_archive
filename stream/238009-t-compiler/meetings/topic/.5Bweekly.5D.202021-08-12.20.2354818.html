<html>
<head><meta charset="utf-8"><title>[weekly] 2021-08-12 #54818 · t-compiler/meetings · Zulip Chat Archive</title></head>
<h2>Stream: <a href="https://zulip-archive.rust-lang.org/stream/238009-t-compiler/meetings/index.html">t-compiler/meetings</a></h2>
<h3>Topic: <a href="https://zulip-archive.rust-lang.org/stream/238009-t-compiler/meetings/topic/.5Bweekly.5D.202021-08-12.20.2354818.html">[weekly] 2021-08-12 #54818</a></h3>

<hr>

<base href="https://rust-lang.zulipchat.com">

<head><link href="https://zulip-archive.rust-lang.org/style.css" rel="stylesheet"></head>

<a name="249226246"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/238009-t-compiler/meetings/topic/%5Bweekly%5D%202021-08-12%20%2354818/near/249226246" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> apiraino <a href="https://zulip-archive.rust-lang.org/stream/238009-t-compiler/meetings/topic/.5Bweekly.5D.202021-08-12.20.2354818.html#249226246">(Aug 12 2021 at 12:11)</a>:</h4>
<p>Hi <span class="user-group-mention" data-user-group-id="897">@T-compiler/meeting</span>; the triage meeting will take place in about 1h50<br>
<em>WG-prioritization</em> has done pre-triage in <a class="stream" data-stream-id="245100" href="/#narrow/stream/245100-t-compiler.2Fwg-prioritization.2Falerts">#t-compiler/wg-prioritization/alerts</a> and prepared the <a href="https://hackmd.io/f45z2GqQTNW9QH0wO4lTEg">meeting agenda</a></p>
<p>Scheduled checkins from:</p>
<ul>
<li><span class="user-group-mention" data-user-group-id="1175">@WG-rfc-2229</span>  by <span class="user-mention" data-user-id="116009">@nikomatsakis</span>  and <span class="user-mention" data-user-id="116118">@Matthew Jasper</span> : anything to share?</li>
<li><span class="user-group-mention" data-user-group-id="1060">@WG-rls2.0</span>  by <span class="user-mention" data-user-id="133169">@matklad</span> : anything to share?</li>
</ul>



<a name="249232039"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/238009-t-compiler/meetings/topic/%5Bweekly%5D%202021-08-12%20%2354818/near/249232039" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> eddyb <a href="https://zulip-archive.rust-lang.org/stream/238009-t-compiler/meetings/topic/.5Bweekly.5D.202021-08-12.20.2354818.html#249232039">(Aug 12 2021 at 13:09)</a>:</h4>
<p><span class="user-mention" data-user-id="250987">@apiraino</span> how/when are <code>I-nominated</code> collected? I was hoping this would make it in (idk if there will be time to discuss it, but at leas I wanted to try) <a href="https://github.com/rust-lang/rfcs/pull/3161#event-5143610622">https://github.com/rust-lang/rfcs/pull/3161#event-5143610622</a></p>



<a name="249232225"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/238009-t-compiler/meetings/topic/%5Bweekly%5D%202021-08-12%20%2354818/near/249232225" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> apiraino <a href="https://zulip-archive.rust-lang.org/stream/238009-t-compiler/meetings/topic/.5Bweekly.5D.202021-08-12.20.2354818.html#249232225">(Aug 12 2021 at 13:10)</a>:</h4>
<p>that pr was nominated 20 hours ago, strange that it didnt make it into the agenda. I'm updating the agenda with it (I usually finalize the agenda a few hrs before)</p>



<a name="249232437"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/238009-t-compiler/meetings/topic/%5Bweekly%5D%202021-08-12%20%2354818/near/249232437" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> apiraino <a href="https://zulip-archive.rust-lang.org/stream/238009-t-compiler/meetings/topic/.5Bweekly.5D.202021-08-12.20.2354818.html#249232437">(Aug 12 2021 at 13:12)</a>:</h4>
<p>if it's urgent we can also push it at the beginning of the meeting</p>



<a name="249232756"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/238009-t-compiler/meetings/topic/%5Bweekly%5D%202021-08-12%20%2354818/near/249232756" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> eddyb <a href="https://zulip-archive.rust-lang.org/stream/238009-t-compiler/meetings/topic/.5Bweekly.5D.202021-08-12.20.2354818.html#249232756">(Aug 12 2021 at 13:14)</a>:</h4>
<p>thanks, just wanted to double-check (in the past I've forgotten e.g. <code>T-compiler</code> labels) - and it's not urgent, no worries there (unless someone else wants the mangling switchover to happen ASAP)</p>



<a name="249238334"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/238009-t-compiler/meetings/topic/%5Bweekly%5D%202021-08-12%20%2354818/near/249238334" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pnkfelix <a href="https://zulip-archive.rust-lang.org/stream/238009-t-compiler/meetings/topic/.5Bweekly.5D.202021-08-12.20.2354818.html#249238334">(Aug 12 2021 at 14:02)</a>:</h4>
<p>Hi <span class="user-group-mention" data-user-group-id="897">@T-compiler/meeting</span> , its time for the triage meeting. Leave a <span aria-label="wave" class="emoji emoji-1f44b" role="img" title="wave">:wave:</span> to show you’re here.</p>



<a name="249238403"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/238009-t-compiler/meetings/topic/%5Bweekly%5D%202021-08-12%20%2354818/near/249238403" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pnkfelix <a href="https://zulip-archive.rust-lang.org/stream/238009-t-compiler/meetings/topic/.5Bweekly.5D.202021-08-12.20.2354818.html#249238403">(Aug 12 2021 at 14:03)</a>:</h4>
<p>We’ll start off with ~7 minutes for </p>
<h2>Announcements</h2>



<a name="249238529"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/238009-t-compiler/meetings/topic/%5Bweekly%5D%202021-08-12%20%2354818/near/249238529" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pnkfelix <a href="https://zulip-archive.rust-lang.org/stream/238009-t-compiler/meetings/topic/.5Bweekly.5D.202021-08-12.20.2354818.html#249238529">(Aug 12 2021 at 14:04)</a>:</h4>
<ul>
<li>We have no steering meeting tomorrow. The next steering meeting will be on <time datetime="2021-08-20T14:00:00Z">2021-08-20T10:00:00-04:00</time> to discuss how to increase the number of reviewers available to handle the review queue load.</li>
</ul>



<a name="249238563"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/238009-t-compiler/meetings/topic/%5Bweekly%5D%202021-08-12%20%2354818/near/249238563" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pnkfelix <a href="https://zulip-archive.rust-lang.org/stream/238009-t-compiler/meetings/topic/.5Bweekly.5D.202021-08-12.20.2354818.html#249238563">(Aug 12 2021 at 14:04)</a>:</h4>
<ul>
<li>New MCPs (take a look, see if you like them!)<ul>
<li>"Add <code>TyKind::Const</code> and remove <code>GenericArgKind::Const</code>" <a href="https://github.com/rust-lang/compiler-team/issues/453">compiler-team#453</a></li>
</ul>
</li>
</ul>



<a name="249238606"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/238009-t-compiler/meetings/topic/%5Bweekly%5D%202021-08-12%20%2354818/near/249238606" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pnkfelix <a href="https://zulip-archive.rust-lang.org/stream/238009-t-compiler/meetings/topic/.5Bweekly.5D.202021-08-12.20.2354818.html#249238606">(Aug 12 2021 at 14:04)</a>:</h4>
<ul>
<li>Old MCPs (not seconded, take a look)<ul>
<li>"Add different entry points for x.py" <a href="https://github.com/rust-lang/compiler-team/issues/396">compiler-team#396</a> (last comments: GH 7m ago, Zulip 4d ago)</li>
<li>"rustdoc is using rustc_ast_pretty, would it be possible to make it somewhat "stable"?" <a href="https://github.com/rust-lang/compiler-team/issues/403">compiler-team#403</a> (last comments: GH 6m ago, Zulip 43d ago)</li>
<li>"Don't steal the resolver when lowering HIR; instead store an immutable resolver in TyCtxt" <a href="https://github.com/rust-lang/compiler-team/issues/437">compiler-team#437</a> (last comments: GH 2m ago, Zulip 49d ago)</li>
<li>"CI should exercise (subset of) tests under --stage 1" <a href="https://github.com/rust-lang/compiler-team/issues/439">compiler-team#439</a> (last comments: GH 49d ago, Zulip none)</li>
<li>"Accept <code>pc</code> in place of <code>unknown</code> and <code>unknown</code> in place of <code>pc</code> for <code>x86_64</code> and <code>i?86</code> targets" <a href="https://github.com/rust-lang/compiler-team/issues/441">compiler-team#441</a> (last comments: GH 34d ago, Zulip 52d ago)</li>
<li>"Non exhaustive reachable patterns lint" <a href="https://github.com/rust-lang/compiler-team/issues/445">compiler-team#445</a> (last comments: GH 28d ago, Zulip 20d ago)</li>
<li>"Make <code>resolve_instance</code> fallible" <a href="https://github.com/rust-lang/compiler-team/issues/449">compiler-team#449</a> (last comments: GH 10d ago, Zulip none)</li>
<li>"Reproducible command line + determinism" <a href="https://github.com/rust-lang/compiler-team/issues/450">compiler-team#450</a> (last comments: GH 9d ago, Zulip 11d ago)</li>
<li>"Make AST-&gt;HIR lowering incremental" <a href="https://github.com/rust-lang/compiler-team/issues/452">compiler-team#452</a> (last comment: GH 10 days ago, Zulip None)</li>
</ul>
</li>
</ul>



<a name="249238629"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/238009-t-compiler/meetings/topic/%5Bweekly%5D%202021-08-12%20%2354818/near/249238629" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pnkfelix <a href="https://zulip-archive.rust-lang.org/stream/238009-t-compiler/meetings/topic/.5Bweekly.5D.202021-08-12.20.2354818.html#249238629">(Aug 12 2021 at 14:05)</a>:</h4>
<ul>
<li>Pending FCP requests (check your boxes!)<ul>
<li>"Write text output files to stdout if options like <code>-o -</code> or <code>--emit asm=-</code> are provided" <a href="https://github.com/rust-lang/compiler-team/issues/431">compiler-team#431</a> </li>
<li>"Preserve, clarify, and extend debug information" <a href="https://github.com/rust-lang/rust/pull/83947">rust#83947</a></li>
</ul>
</li>
</ul>



<a name="249238645"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/238009-t-compiler/meetings/topic/%5Bweekly%5D%202021-08-12%20%2354818/near/249238645" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pnkfelix <a href="https://zulip-archive.rust-lang.org/stream/238009-t-compiler/meetings/topic/.5Bweekly.5D.202021-08-12.20.2354818.html#249238645">(Aug 12 2021 at 14:05)</a>:</h4>
<ul>
<li>Things in FCP (make sure you're good with it)<ul>
<li>"Rename various internal things" <a href="https://github.com/rust-lang/compiler-team/issues/451">compiler-team#451</a></li>
</ul>
</li>
</ul>



<a name="249238656"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/238009-t-compiler/meetings/topic/%5Bweekly%5D%202021-08-12%20%2354818/near/249238656" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pnkfelix <a href="https://zulip-archive.rust-lang.org/stream/238009-t-compiler/meetings/topic/.5Bweekly.5D.202021-08-12.20.2354818.html#249238656">(Aug 12 2021 at 14:05)</a>:</h4>
<ul>
<li>Accepted MCPs<ul>
<li>"Don't abort compilation after giving a lint error" <a href="https://github.com/rust-lang/compiler-team/issues/447">compiler-team#447</a></li>
</ul>
</li>
</ul>



<a name="249238665"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/238009-t-compiler/meetings/topic/%5Bweekly%5D%202021-08-12%20%2354818/near/249238665" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pnkfelix <a href="https://zulip-archive.rust-lang.org/stream/238009-t-compiler/meetings/topic/.5Bweekly.5D.202021-08-12.20.2354818.html#249238665">(Aug 12 2021 at 14:05)</a>:</h4>
<ul>
<li>Finalized FCPs (disposition merge)<ul>
<li>No new finished FCP (disposition merge) this time.</li>
</ul>
</li>
</ul>



<a name="249238773"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/238009-t-compiler/meetings/topic/%5Bweekly%5D%202021-08-12%20%2354818/near/249238773" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pnkfelix <a href="https://zulip-archive.rust-lang.org/stream/238009-t-compiler/meetings/topic/.5Bweekly.5D.202021-08-12.20.2354818.html#249238773">(Aug 12 2021 at 14:06)</a>:</h4>
<h3>WG checkins</h3>
<p>There is a scheduled check-in from <span class="user-group-mention" data-user-group-id="1175">@WG-rfc-2229</span> , but <span class="user-mention" data-user-id="116009">@nikomatsakis</span> is on vacation and I don’t expect to hear from <span class="user-mention" data-user-id="116118">@Matthew Jasper</span></p>



<a name="249238836"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/238009-t-compiler/meetings/topic/%5Bweekly%5D%202021-08-12%20%2354818/near/249238836" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pnkfelix <a href="https://zulip-archive.rust-lang.org/stream/238009-t-compiler/meetings/topic/.5Bweekly.5D.202021-08-12.20.2354818.html#249238836">(Aug 12 2021 at 14:06)</a>:</h4>
<p><span class="user-group-mention" data-user-group-id="1060">@WG-rls2.0</span> by <span class="user-mention" data-user-id="133169">@matklad</span> (<a href="https://hackmd.io/zhv96UdPQI-HI9BlW0XuTw">latest report</a>)</p>
<p>Steering issue covered by this checkin:</p>
<ul>
<li><a href="https://github.com/rust-analyzer/rust-analyzer/issues/9580">https://github.com/rust-analyzer/rust-analyzer/issues/9580</a></li>
</ul>
<p>This has been mostly reactive sprint. I don't think we did anything super "big" this time, but we shipped a lot new features, fixed a bunch of bad bugs, and did some observability improvements (eg, we now know that roughly 2/3 of code is source code, and 1/3 is macro-generated code).</p>
<p>One interesting big thing is that we realized that we've used a wrong model for macro expansion this whole time: <a href="https://github.com/rust-analyzer/rust-analyzer/issues/9403">https://github.com/rust-analyzer/rust-analyzer/issues/9403</a></p>



<a name="249239338"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/238009-t-compiler/meetings/topic/%5Bweekly%5D%202021-08-12%20%2354818/near/249239338" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pnkfelix <a href="https://zulip-archive.rust-lang.org/stream/238009-t-compiler/meetings/topic/.5Bweekly.5D.202021-08-12.20.2354818.html#249239338">(Aug 12 2021 at 14:10)</a>:</h4>
<p>Anyone with any other announcements?</p>



<a name="249239442"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/238009-t-compiler/meetings/topic/%5Bweekly%5D%202021-08-12%20%2354818/near/249239442" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pnkfelix <a href="https://zulip-archive.rust-lang.org/stream/238009-t-compiler/meetings/topic/.5Bweekly.5D.202021-08-12.20.2354818.html#249239442">(Aug 12 2021 at 14:11)</a>:</h4>
<p>Oh I guess I throw my hat in the ring: I’ve been looking at <a href="https://github.com/rust-lang/rust/issues/82151">#82151</a> . Is there anyone present who might consider themself a <code>.dylib</code> expert? I’ve been trying to tease out what the expected behaviors are for various cases.</p>



<a name="249239644"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/238009-t-compiler/meetings/topic/%5Bweekly%5D%202021-08-12%20%2354818/near/249239644" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pnkfelix <a href="https://zulip-archive.rust-lang.org/stream/238009-t-compiler/meetings/topic/.5Bweekly.5D.202021-08-12.20.2354818.html#249239644">(Aug 12 2021 at 14:12)</a>:</h4>
<p>If you have experience working with <code>.dylib</code>, or if you care about how they behave (i.e. are a stakeholder in their semantics), I’d love if you could ping me. If I can get a group together, then I’ll make a dedicated topic for it.</p>



<a name="249239660"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/238009-t-compiler/meetings/topic/%5Bweekly%5D%202021-08-12%20%2354818/near/249239660" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pnkfelix <a href="https://zulip-archive.rust-lang.org/stream/238009-t-compiler/meetings/topic/.5Bweekly.5D.202021-08-12.20.2354818.html#249239660">(Aug 12 2021 at 14:13)</a>:</h4>
<p>That having been said, let’s move along</p>



<a name="249239695"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/238009-t-compiler/meetings/topic/%5Bweekly%5D%202021-08-12%20%2354818/near/249239695" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pnkfelix <a href="https://zulip-archive.rust-lang.org/stream/238009-t-compiler/meetings/topic/.5Bweekly.5D.202021-08-12.20.2354818.html#249239695">(Aug 12 2021 at 14:13)</a>:</h4>
<h2>Backport nominations</h2>
<p><a href="https://github.com/rust-lang/rust/issues?q=is%3Aall+label%3Abeta-nominated+-label%3Abeta-accepted+label%3AT-compiler">T-compiler stable</a> / <a href="https://github.com/rust-lang/rust/issues?q=is%3Aall+label%3Astable-nominated+-label%3Astable-accepted+label%3AT-compiler">T-compiler beta</a></p>



<a name="249239717"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/238009-t-compiler/meetings/topic/%5Bweekly%5D%202021-08-12%20%2354818/near/249239717" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pnkfelix <a href="https://zulip-archive.rust-lang.org/stream/238009-t-compiler/meetings/topic/.5Bweekly.5D.202021-08-12.20.2354818.html#249239717">(Aug 12 2021 at 14:13)</a>:</h4>
<ul>
<li><img alt=":beta:" class="emoji" src="https://zulip-avatars.s3.amazonaws.com/4715/emoji/images/20717.png" title="beta"> "Always preserve sub-obligations in the projection cache" <a href="https://github.com/rust-lang/rust/pull/85868">rust#85868</a> <ul>
<li><a href="#narrow/stream/238009-t-compiler.2Fmeetings/topic/.5Bweekly.5D.202021-07-29.20.2354818/near/247588561">discussed last week</a></li>
<li><span class="user-mention" data-user-id="125250">@Wesley Wiser</span> <a href="#narrow/stream/238009-t-compiler.2Fmeetings/topic/.5Bweekly.5D.202021-07-29.20.2354818/near/247588679">comments</a> this should reviewed &amp; merged on nightly before we talk about beta backports</li>
<li><span class="user-mention" data-user-id="116083">@pnkfelix</span> <a href="#narrow/stream/238009-t-compiler.2Fmeetings/topic/.5Bweekly.5D.202021-07-29.20.2354818/near/247588695">comments</a>: also premature to discuss beta</li>
</ul>
</li>
</ul>



<a name="249239825"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/238009-t-compiler/meetings/topic/%5Bweekly%5D%202021-08-12%20%2354818/near/249239825" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> mw <a href="https://zulip-archive.rust-lang.org/stream/238009-t-compiler/meetings/topic/.5Bweekly.5D.202021-08-12.20.2354818.html#249239825">(Aug 12 2021 at 14:14)</a>:</h4>
<p>I would be great if we could get this merged as long as we are still early in the cycle</p>



<a name="249239939"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/238009-t-compiler/meetings/topic/%5Bweekly%5D%202021-08-12%20%2354818/near/249239939" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pnkfelix <a href="https://zulip-archive.rust-lang.org/stream/238009-t-compiler/meetings/topic/.5Bweekly.5D.202021-08-12.20.2354818.html#249239939">(Aug 12 2021 at 14:15)</a>:</h4>
<p>Yeah. I believe Niko will be back next week. It sounds like <span class="user-mention" data-user-id="232957">@Jack Huey</span> would be more willing to take it on with Niko to provide some backup assistance.</p>



<a name="249239987"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/238009-t-compiler/meetings/topic/%5Bweekly%5D%202021-08-12%20%2354818/near/249239987" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pnkfelix <a href="https://zulip-archive.rust-lang.org/stream/238009-t-compiler/meetings/topic/.5Bweekly.5D.202021-08-12.20.2354818.html#249239987">(Aug 12 2021 at 14:15)</a>:</h4>
<ul>
<li>
<p><img alt=":beta:" class="emoji" src="https://zulip-avatars.s3.amazonaws.com/4715/emoji/images/20717.png" title="beta"> "Do not ICE on HIR based WF check when involving lifetimes"<br>
<a href="https://github.com/rust-lang/rust/pull/87811">rust#87811</a> </p>
<ul>
<li>Fixes <a href="https://github.com/rust-lang/rust/issues/87549">#87549</a> (a regression causing a ICE on incoreect code compiled with <code>incremental=true</code>)</li>
<li>PR provided by <span class="user-mention" data-user-id="119031">@Esteban Küber</span> and nominated for backport</li>
</ul>
</li>
</ul>



<a name="249240127"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/238009-t-compiler/meetings/topic/%5Bweekly%5D%202021-08-12%20%2354818/near/249240127" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Esteban Küber <a href="https://zulip-archive.rust-lang.org/stream/238009-t-compiler/meetings/topic/.5Bweekly.5D.202021-08-12.20.2354818.html#249240127">(Aug 12 2021 at 14:16)</a>:</h4>
<p>(abstaining because my default position is to <span aria-label="back" class="emoji emoji-1f519" role="img" title="back">:back:</span>)</p>



<a name="249240141"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/238009-t-compiler/meetings/topic/%5Bweekly%5D%202021-08-12%20%2354818/near/249240141" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pnkfelix <a href="https://zulip-archive.rust-lang.org/stream/238009-t-compiler/meetings/topic/.5Bweekly.5D.202021-08-12.20.2354818.html#249240141">(Aug 12 2021 at 14:16)</a>:</h4>
<p>It seems fine to me</p>



<a name="249240156"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/238009-t-compiler/meetings/topic/%5Bweekly%5D%202021-08-12%20%2354818/near/249240156" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pnkfelix <a href="https://zulip-archive.rust-lang.org/stream/238009-t-compiler/meetings/topic/.5Bweekly.5D.202021-08-12.20.2354818.html#249240156">(Aug 12 2021 at 14:16)</a>:</h4>
<p>if no one objects, we’ll go with backport approved</p>



<a name="249240167"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/238009-t-compiler/meetings/topic/%5Bweekly%5D%202021-08-12%20%2354818/near/249240167" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jack Huey <a href="https://zulip-archive.rust-lang.org/stream/238009-t-compiler/meetings/topic/.5Bweekly.5D.202021-08-12.20.2354818.html#249240167">(Aug 12 2021 at 14:16)</a>:</h4>
<p>Yes. I just need to find some time to dive into it. But with Niko coming back, it might just be easier to wait for him.</p>



<a name="249240196"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/238009-t-compiler/meetings/topic/%5Bweekly%5D%202021-08-12%20%2354818/near/249240196" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pnkfelix <a href="https://zulip-archive.rust-lang.org/stream/238009-t-compiler/meetings/topic/.5Bweekly.5D.202021-08-12.20.2354818.html#249240196">(Aug 12 2021 at 14:17)</a>:</h4>
<ul>
<li>No stable nominations for <code>T-compiler</code> this time.</li>
</ul>



<a name="249240214"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/238009-t-compiler/meetings/topic/%5Bweekly%5D%202021-08-12%20%2354818/near/249240214" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pnkfelix <a href="https://zulip-archive.rust-lang.org/stream/238009-t-compiler/meetings/topic/.5Bweekly.5D.202021-08-12.20.2354818.html#249240214">(Aug 12 2021 at 14:17)</a>:</h4>
<p><a href="https://github.com/rust-lang/rust/issues?q=is%3Aall+label%3Abeta-nominated+-label%3Abeta-accepted+label%3AT-rustdoc">T-rustdoc stable</a> / <a href="https://github.com/rust-lang/rust/issues?q=is%3Aall+label%3Astable-nominated+-label%3Astable-accepted+label%3AT-rustdoc">T-rustdoc beta</a></p>
<ul>
<li>No beta nominations for <code>T-rustdoc</code> this time.</li>
<li>No stable nominations for <code>T-rustdoc</code> this time.</li>
</ul>



<a name="249240233"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/238009-t-compiler/meetings/topic/%5Bweekly%5D%202021-08-12%20%2354818/near/249240233" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pnkfelix <a href="https://zulip-archive.rust-lang.org/stream/238009-t-compiler/meetings/topic/.5Bweekly.5D.202021-08-12.20.2354818.html#249240233">(Aug 12 2021 at 14:17)</a>:</h4>
<h2>PRs S-waiting-on-team</h2>
<p><a href="https://github.com/rust-lang/rust/pulls?utf8=%E2%9C%93&amp;q=is%3Aopen+label%3AS-waiting-on-team+label%3AT-compiler">T-compiler</a></p>



<a name="249240258"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/238009-t-compiler/meetings/topic/%5Bweekly%5D%202021-08-12%20%2354818/near/249240258" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pnkfelix <a href="https://zulip-archive.rust-lang.org/stream/238009-t-compiler/meetings/topic/.5Bweekly.5D.202021-08-12.20.2354818.html#249240258">(Aug 12 2021 at 14:17)</a>:</h4>
<ul>
<li>"Encode spans relative to the enclosing item" <a href="https://github.com/rust-lang/rust/pull/84373">rust#84373</a><ul>
<li>opened by <span class="user-mention" data-user-id="248906">@cjgillot</span> </li>
<li>assigned to <span class="user-mention" data-user-id="125294">@Aaron Hill</span> <span class="user-mention" data-user-id="124287">@mw</span> <span class="user-mention" data-user-id="123856">@Vadim Petrochenkov</span></li>
<li><span class="user-mention" data-user-id="248906">@cjgillot</span> opened <a href="https://github.com/rust-lang/compiler-team/issues/443">MCP #443</a> (currently in closing FCP phase)</li>
<li><a href="#narrow/stream/238009-t-compiler.2Fmeetings/topic/.5Bweekly.5D.202021-07-22.20.2354818/near/246853451">discussed last week</a>, <span class="user-group-mention" data-user-group-id="3282">@wg-incr-comp</span> could have a discussion about this after the 1.54 release and the next beta cut</li>
</ul>
</li>
</ul>



<a name="249240338"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/238009-t-compiler/meetings/topic/%5Bweekly%5D%202021-08-12%20%2354818/near/249240338" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pnkfelix <a href="https://zulip-archive.rust-lang.org/stream/238009-t-compiler/meetings/topic/.5Bweekly.5D.202021-08-12.20.2354818.html#249240338">(Aug 12 2021 at 14:18)</a>:</h4>
<p>Sigh, I really had intended to follow through on getting some wg-incr-comp discussion going here</p>



<a name="249240410"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/238009-t-compiler/meetings/topic/%5Bweekly%5D%202021-08-12%20%2354818/near/249240410" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> mw <a href="https://zulip-archive.rust-lang.org/stream/238009-t-compiler/meetings/topic/.5Bweekly.5D.202021-08-12.20.2354818.html#249240410">(Aug 12 2021 at 14:18)</a>:</h4>
<p>yes, let's schedule a discussion</p>



<a name="249240414"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/238009-t-compiler/meetings/topic/%5Bweekly%5D%202021-08-12%20%2354818/near/249240414" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pnkfelix <a href="https://zulip-archive.rust-lang.org/stream/238009-t-compiler/meetings/topic/.5Bweekly.5D.202021-08-12.20.2354818.html#249240414">(Aug 12 2021 at 14:18)</a>:</h4>
<p><span class="user-mention" data-user-id="124287">@mw</span> , I think <span class="user-mention" data-user-id="125250">@Wesley Wiser</span> will be back next week. Maybe we can the three of us figure out when a good time is to have a synchronous meeting to discuss this?</p>



<a name="249240458"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/238009-t-compiler/meetings/topic/%5Bweekly%5D%202021-08-12%20%2354818/near/249240458" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pnkfelix <a href="https://zulip-archive.rust-lang.org/stream/238009-t-compiler/meetings/topic/.5Bweekly.5D.202021-08-12.20.2354818.html#249240458">(Aug 12 2021 at 14:19)</a>:</h4>
<ul>
<li>"Remove all json handling from rustc_serialize" <a href="https://github.com/rust-lang/rust/pull/85993">rust#85993</a> <ul>
<li>PR nominated for discussion (see nominations)</li>
</ul>
</li>
</ul>



<a name="249240481"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/238009-t-compiler/meetings/topic/%5Bweekly%5D%202021-08-12%20%2354818/near/249240481" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> mw <a href="https://zulip-archive.rust-lang.org/stream/238009-t-compiler/meetings/topic/.5Bweekly.5D.202021-08-12.20.2354818.html#249240481">(Aug 12 2021 at 14:19)</a>:</h4>
<p>I think we'll want <span class="user-mention" data-user-id="123856">@Vadim Petrochenkov</span> and <span class="user-mention" data-user-id="248906">@cjgillot</span> in on the discussion too, right?</p>



<a name="249240519"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/238009-t-compiler/meetings/topic/%5Bweekly%5D%202021-08-12%20%2354818/near/249240519" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pnkfelix <a href="https://zulip-archive.rust-lang.org/stream/238009-t-compiler/meetings/topic/.5Bweekly.5D.202021-08-12.20.2354818.html#249240519">(Aug 12 2021 at 14:19)</a>:</h4>
<p>if we can, yes</p>



<a name="249240788"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/238009-t-compiler/meetings/topic/%5Bweekly%5D%202021-08-12%20%2354818/near/249240788" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> mw <a href="https://zulip-archive.rust-lang.org/stream/238009-t-compiler/meetings/topic/.5Bweekly.5D.202021-08-12.20.2354818.html#249240788">(Aug 12 2021 at 14:21)</a>:</h4>
<p>I'd love for "Remove all json handling from rustc_serialize" <a href="https://github.com/rust-lang/rust/issues/85993">rust#85993</a> to land</p>



<a name="249240882"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/238009-t-compiler/meetings/topic/%5Bweekly%5D%202021-08-12%20%2354818/near/249240882" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> mw <a href="https://zulip-archive.rust-lang.org/stream/238009-t-compiler/meetings/topic/.5Bweekly.5D.202021-08-12.20.2354818.html#249240882">(Aug 12 2021 at 14:22)</a>:</h4>
<p>or at least, I'd like it if we could remove JSON support from rustc_serialize one way or other</p>



<a name="249240888"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/238009-t-compiler/meetings/topic/%5Bweekly%5D%202021-08-12%20%2354818/near/249240888" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Aaron Hill <a href="https://zulip-archive.rust-lang.org/stream/238009-t-compiler/meetings/topic/.5Bweekly.5D.202021-08-12.20.2354818.html#249240888">(Aug 12 2021 at 14:22)</a>:</h4>
<p>I agree, but I don't think it should become at the expense of <code>-Z ast-json</code></p>



<a name="249240939"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/238009-t-compiler/meetings/topic/%5Bweekly%5D%202021-08-12%20%2354818/near/249240939" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> mw <a href="https://zulip-archive.rust-lang.org/stream/238009-t-compiler/meetings/topic/.5Bweekly.5D.202021-08-12.20.2354818.html#249240939">(Aug 12 2021 at 14:22)</a>:</h4>
<p>yes, that seems to be the main blocker</p>



<a name="249240949"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/238009-t-compiler/meetings/topic/%5Bweekly%5D%202021-08-12%20%2354818/near/249240949" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> eddyb <a href="https://zulip-archive.rust-lang.org/stream/238009-t-compiler/meetings/topic/.5Bweekly.5D.202021-08-12.20.2354818.html#249240949">(Aug 12 2021 at 14:22)</a>:</h4>
<p>when I tried to do this, I "just" added serde derives to <code>rustc_ast</code></p>



<a name="249240993"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/238009-t-compiler/meetings/topic/%5Bweekly%5D%202021-08-12%20%2354818/near/249240993" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pnkfelix <a href="https://zulip-archive.rust-lang.org/stream/238009-t-compiler/meetings/topic/.5Bweekly.5D.202021-08-12.20.2354818.html#249240993">(Aug 12 2021 at 14:23)</a>:</h4>
<p><span class="user-mention" data-user-id="124288">@oli</span> had suggested writing an MCP</p>



<a name="249240994"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/238009-t-compiler/meetings/topic/%5Bweekly%5D%202021-08-12%20%2354818/near/249240994" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> mw <a href="https://zulip-archive.rust-lang.org/stream/238009-t-compiler/meetings/topic/.5Bweekly.5D.202021-08-12.20.2354818.html#249240994">(Aug 12 2021 at 14:23)</a>:</h4>
<p>what was your experience with that, <span class="user-mention" data-user-id="119009">@eddyb</span> ?</p>



<a name="249241062"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/238009-t-compiler/meetings/topic/%5Bweekly%5D%202021-08-12%20%2354818/near/249241062" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> mw <a href="https://zulip-archive.rust-lang.org/stream/238009-t-compiler/meetings/topic/.5Bweekly.5D.202021-08-12.20.2354818.html#249241062">(Aug 12 2021 at 14:23)</a>:</h4>
<p>didn't we already have an MCP for that at some point?</p>



<a name="249241074"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/238009-t-compiler/meetings/topic/%5Bweekly%5D%202021-08-12%20%2354818/near/249241074" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> eddyb <a href="https://zulip-archive.rust-lang.org/stream/238009-t-compiler/meetings/topic/.5Bweekly.5D.202021-08-12.20.2354818.html#249241074">(Aug 12 2021 at 14:23)</a>:</h4>
<p>I think it worked. that stuff didn't land because proc macros still had bootstrap issues</p>



<a name="249241104"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/238009-t-compiler/meetings/topic/%5Bweekly%5D%202021-08-12%20%2354818/near/249241104" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pnkfelix <a href="https://zulip-archive.rust-lang.org/stream/238009-t-compiler/meetings/topic/.5Bweekly.5D.202021-08-12.20.2354818.html#249241104">(Aug 12 2021 at 14:23)</a>:</h4>
<p><span class="user-mention silent" data-user-id="124287">mw</span> <a href="#narrow/stream/238009-t-compiler.2Fmeetings/topic/.5Bweekly.5D.202021-08-12.20.2354818/near/249241062">said</a>:</p>
<blockquote>
<p>didn't we already have an MCP for that at some point?</p>
</blockquote>
<p>for moving the JSON implementation to serde?</p>



<a name="249241173"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/238009-t-compiler/meetings/topic/%5Bweekly%5D%202021-08-12%20%2354818/near/249241173" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> mw <a href="https://zulip-archive.rust-lang.org/stream/238009-t-compiler/meetings/topic/.5Bweekly.5D.202021-08-12.20.2354818.html#249241173">(Aug 12 2021 at 14:24)</a>:</h4>
<p><a href="https://github.com/rust-lang/compiler-team/issues/418">https://github.com/rust-lang/compiler-team/issues/418</a></p>



<a name="249241208"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/238009-t-compiler/meetings/topic/%5Bweekly%5D%202021-08-12%20%2354818/near/249241208" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pnkfelix <a href="https://zulip-archive.rust-lang.org/stream/238009-t-compiler/meetings/topic/.5Bweekly.5D.202021-08-12.20.2354818.html#249241208">(Aug 12 2021 at 14:24)</a>:</h4>
<p>look at that</p>



<a name="249241242"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/238009-t-compiler/meetings/topic/%5Bweekly%5D%202021-08-12%20%2354818/near/249241242" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> eddyb <a href="https://zulip-archive.rust-lang.org/stream/238009-t-compiler/meetings/topic/.5Bweekly.5D.202021-08-12.20.2354818.html#249241242">(Aug 12 2021 at 14:24)</a>:</h4>
<p>we should only have derives for the rustc-specific tcx-aware traits, and for <code>serde</code>, IMO</p>



<a name="249241302"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/238009-t-compiler/meetings/topic/%5Bweekly%5D%202021-08-12%20%2354818/near/249241302" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> bjorn3 <a href="https://zulip-archive.rust-lang.org/stream/238009-t-compiler/meetings/topic/.5Bweekly.5D.202021-08-12.20.2354818.html#249241302">(Aug 12 2021 at 14:25)</a>:</h4>
<p><span class="user-mention silent" data-user-id="119009">eddyb</span> <a href="#narrow/stream/238009-t-compiler.2Fmeetings/topic/.5Bweekly.5D.202021-08-12.20.2354818/near/249240949">said</a>:</p>
<blockquote>
<p>when I tried to do this, I "just" added serde derives to <code>rustc_ast</code></p>
</blockquote>
<p>I am afraid for the code bloat that will cause.</p>



<a name="249241324"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/238009-t-compiler/meetings/topic/%5Bweekly%5D%202021-08-12%20%2354818/near/249241324" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> eddyb <a href="https://zulip-archive.rust-lang.org/stream/238009-t-compiler/meetings/topic/.5Bweekly.5D.202021-08-12.20.2354818.html#249241324">(Aug 12 2021 at 14:25)</a>:</h4>
<p>we can test that though</p>



<a name="249241342"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/238009-t-compiler/meetings/topic/%5Bweekly%5D%202021-08-12%20%2354818/near/249241342" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> mw <a href="https://zulip-archive.rust-lang.org/stream/238009-t-compiler/meetings/topic/.5Bweekly.5D.202021-08-12.20.2354818.html#249241342">(Aug 12 2021 at 14:25)</a>:</h4>
<p>can we cfg that on nightly?</p>



<a name="249241349"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/238009-t-compiler/meetings/topic/%5Bweekly%5D%202021-08-12%20%2354818/near/249241349" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> eddyb <a href="https://zulip-archive.rust-lang.org/stream/238009-t-compiler/meetings/topic/.5Bweekly.5D.202021-08-12.20.2354818.html#249241349">(Aug 12 2021 at 14:25)</a>:</h4>
<p>also we shouldn't need the non-<code>serde</code> derives at all</p>



<a name="249241371"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/238009-t-compiler/meetings/topic/%5Bweekly%5D%202021-08-12%20%2354818/near/249241371" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> bjorn3 <a href="https://zulip-archive.rust-lang.org/stream/238009-t-compiler/meetings/topic/.5Bweekly.5D.202021-08-12.20.2354818.html#249241371">(Aug 12 2021 at 14:25)</a>:</h4>
<p>Part of them are necessary for serializing macros.</p>



<a name="249241395"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/238009-t-compiler/meetings/topic/%5Bweekly%5D%202021-08-12%20%2354818/near/249241395" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> eddyb <a href="https://zulip-archive.rust-lang.org/stream/238009-t-compiler/meetings/topic/.5Bweekly.5D.202021-08-12.20.2354818.html#249241395">(Aug 12 2021 at 14:25)</a>:</h4>
<p><em>also</em> we can try using the <code>dyn Trait</code>-based serde-like thing</p>



<a name="249241406"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/238009-t-compiler/meetings/topic/%5Bweekly%5D%202021-08-12%20%2354818/near/249241406" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> bjorn3 <a href="https://zulip-archive.rust-lang.org/stream/238009-t-compiler/meetings/topic/.5Bweekly.5D.202021-08-12.20.2354818.html#249241406">(Aug 12 2021 at 14:25)</a>:</h4>
<p>And for serializing attributes.</p>



<a name="249241469"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/238009-t-compiler/meetings/topic/%5Bweekly%5D%202021-08-12%20%2354818/near/249241469" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> eddyb <a href="https://zulip-archive.rust-lang.org/stream/238009-t-compiler/meetings/topic/.5Bweekly.5D.202021-08-12.20.2354818.html#249241469">(Aug 12 2021 at 14:26)</a>:</h4>
<p>oh right attributes... yeah we have to split that from the AST</p>



<a name="249241502"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/238009-t-compiler/meetings/topic/%5Bweekly%5D%202021-08-12%20%2354818/near/249241502" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> eddyb <a href="https://zulip-archive.rust-lang.org/stream/238009-t-compiler/meetings/topic/.5Bweekly.5D.202021-08-12.20.2354818.html#249241502">(Aug 12 2021 at 14:26)</a>:</h4>
<p>neither macros nor attributes should need to refer to the AST</p>



<a name="249241516"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/238009-t-compiler/meetings/topic/%5Bweekly%5D%202021-08-12%20%2354818/near/249241516" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> eddyb <a href="https://zulip-archive.rust-lang.org/stream/238009-t-compiler/meetings/topic/.5Bweekly.5D.202021-08-12.20.2354818.html#249241516">(Aug 12 2021 at 14:26)</a>:</h4>
<p>anyway this is getting into the weeds</p>



<a name="249241557"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/238009-t-compiler/meetings/topic/%5Bweekly%5D%202021-08-12%20%2354818/near/249241557" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> eddyb <a href="https://zulip-archive.rust-lang.org/stream/238009-t-compiler/meetings/topic/.5Bweekly.5D.202021-08-12.20.2354818.html#249241557">(Aug 12 2021 at 14:26)</a>:</h4>
<p><span class="user-mention silent" data-user-id="119009">eddyb</span> <a href="#narrow/stream/238009-t-compiler.2Fmeetings/topic/.5Bweekly.5D.202021-08-12.20.2354818/near/249241395">said</a>:</p>
<blockquote>
<p><em>also</em> we can try using the <code>dyn Trait</code>-based serde-like thing</p>
</blockquote>
<p><a href="https://docs.rs/miniserde">https://docs.rs/miniserde</a></p>



<a name="249241572"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/238009-t-compiler/meetings/topic/%5Bweekly%5D%202021-08-12%20%2354818/near/249241572" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> eddyb <a href="https://zulip-archive.rust-lang.org/stream/238009-t-compiler/meetings/topic/.5Bweekly.5D.202021-08-12.20.2354818.html#249241572">(Aug 12 2021 at 14:26)</a>:</h4>
<p>for <code>-Z ast-json</code> we don't need high-performance</p>



<a name="249241575"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/238009-t-compiler/meetings/topic/%5Bweekly%5D%202021-08-12%20%2354818/near/249241575" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> bjorn3 <a href="https://zulip-archive.rust-lang.org/stream/238009-t-compiler/meetings/topic/.5Bweekly.5D.202021-08-12.20.2354818.html#249241575">(Aug 12 2021 at 14:26)</a>:</h4>
<p>Proc-macro attributes need to refer to the AST due to things like <code>$foo:expr</code>.</p>



<a name="249241627"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/238009-t-compiler/meetings/topic/%5Bweekly%5D%202021-08-12%20%2354818/near/249241627" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> eddyb <a href="https://zulip-archive.rust-lang.org/stream/238009-t-compiler/meetings/topic/.5Bweekly.5D.202021-08-12.20.2354818.html#249241627">(Aug 12 2021 at 14:27)</a>:</h4>
<p>also we only need to <em>encode</em>, not <em>decode</em></p>



<a name="249241649"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/238009-t-compiler/meetings/topic/%5Bweekly%5D%202021-08-12%20%2354818/near/249241649" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> eddyb <a href="https://zulip-archive.rust-lang.org/stream/238009-t-compiler/meetings/topic/.5Bweekly.5D.202021-08-12.20.2354818.html#249241649">(Aug 12 2021 at 14:27)</a>:</h4>
<p>so <code>miniserde::Serialize</code> should suffice</p>



<a name="249241761"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/238009-t-compiler/meetings/topic/%5Bweekly%5D%202021-08-12%20%2354818/near/249241761" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pnkfelix <a href="https://zulip-archive.rust-lang.org/stream/238009-t-compiler/meetings/topic/.5Bweekly.5D.202021-08-12.20.2354818.html#249241761">(Aug 12 2021 at 14:28)</a>:</h4>
<p>Okay then it sounds like <span class="user-mention" data-user-id="133247">@bjorn3</span> is going to go try that then?</p>



<a name="249241763"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/238009-t-compiler/meetings/topic/%5Bweekly%5D%202021-08-12%20%2354818/near/249241763" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> mw <a href="https://zulip-archive.rust-lang.org/stream/238009-t-compiler/meetings/topic/.5Bweekly.5D.202021-08-12.20.2354818.html#249241763">(Aug 12 2021 at 14:28)</a>:</h4>
<p>sounds like we have something to experiment with, right?</p>



<a name="249241830"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/238009-t-compiler/meetings/topic/%5Bweekly%5D%202021-08-12%20%2354818/near/249241830" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pnkfelix <a href="https://zulip-archive.rust-lang.org/stream/238009-t-compiler/meetings/topic/.5Bweekly.5D.202021-08-12.20.2354818.html#249241830">(Aug 12 2021 at 14:28)</a>:</h4>
<p>next</p>



<a name="249241832"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/238009-t-compiler/meetings/topic/%5Bweekly%5D%202021-08-12%20%2354818/near/249241832" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pnkfelix <a href="https://zulip-archive.rust-lang.org/stream/238009-t-compiler/meetings/topic/.5Bweekly.5D.202021-08-12.20.2354818.html#249241832">(Aug 12 2021 at 14:28)</a>:</h4>
<ul>
<li>"Preserve, clarify, and extend debug information" <a href="https://github.com/rust-lang/rust/pull/83947">rust#83947</a><ul>
<li><span class="user-mention" data-user-id="123856">@Vadim Petrochenkov</span> added more comments labeled with <code>S-waiting-on-team</code></li>
</ul>
</li>
</ul>



<a name="249241856"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/238009-t-compiler/meetings/topic/%5Bweekly%5D%202021-08-12%20%2354818/near/249241856" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> bjorn3 <a href="https://zulip-archive.rust-lang.org/stream/238009-t-compiler/meetings/topic/.5Bweekly.5D.202021-08-12.20.2354818.html#249241856">(Aug 12 2021 at 14:29)</a>:</h4>
<p>Wait, it seems that miniserde doesn't support enums.</p>



<a name="249241875"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/238009-t-compiler/meetings/topic/%5Bweekly%5D%202021-08-12%20%2354818/near/249241875" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> bjorn3 <a href="https://zulip-archive.rust-lang.org/stream/238009-t-compiler/meetings/topic/.5Bweekly.5D.202021-08-12.20.2354818.html#249241875">(Aug 12 2021 at 14:29)</a>:</h4>
<blockquote>
<p>The miniserde derive macros will refuse anything other than a braced struct with named fields. Enums and tuple structs are not supported.</p>
</blockquote>



<a name="249241911"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/238009-t-compiler/meetings/topic/%5Bweekly%5D%202021-08-12%20%2354818/near/249241911" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pnkfelix <a href="https://zulip-archive.rust-lang.org/stream/238009-t-compiler/meetings/topic/.5Bweekly.5D.202021-08-12.20.2354818.html#249241911">(Aug 12 2021 at 14:29)</a>:</h4>
<p>clearly we just rewrite the AST to not use enums. <span aria-label="laughing" class="emoji emoji-1f606" role="img" title="laughing">:laughing:</span></p>



<a name="249241930"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/238009-t-compiler/meetings/topic/%5Bweekly%5D%202021-08-12%20%2354818/near/249241930" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> eddyb <a href="https://zulip-archive.rust-lang.org/stream/238009-t-compiler/meetings/topic/.5Bweekly.5D.202021-08-12.20.2354818.html#249241930">(Aug 12 2021 at 14:29)</a>:</h4>
<p>ugh. well, we should discuss it after the meeting</p>



<a name="249241947"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/238009-t-compiler/meetings/topic/%5Bweekly%5D%202021-08-12%20%2354818/near/249241947" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> bjorn3 <a href="https://zulip-archive.rust-lang.org/stream/238009-t-compiler/meetings/topic/.5Bweekly.5D.202021-08-12.20.2354818.html#249241947">(Aug 12 2021 at 14:29)</a>:</h4>
<p>sure</p>



<a name="249242101"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/238009-t-compiler/meetings/topic/%5Bweekly%5D%202021-08-12%20%2354818/near/249242101" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> eddyb <a href="https://zulip-archive.rust-lang.org/stream/238009-t-compiler/meetings/topic/.5Bweekly.5D.202021-08-12.20.2354818.html#249242101">(Aug 12 2021 at 14:30)</a>:</h4>
<p><span class="user-mention silent" data-user-id="116083">pnkfelix</span> <a href="#narrow/stream/238009-t-compiler.2Fmeetings/topic/.5Bweekly.5D.202021-08-12.20.2354818/near/249241832">said</a>:</p>
<blockquote>
<ul>
<li>"Preserve, clarify, and extend debug information" <a href="https://github.com/rust-lang/rust/pull/83947">rust#83947</a></li>
</ul>
</blockquote>
<p>one thing I can say is this is about <code>-C debuginfo</code> choices, but the title sounds like it's far more</p>



<a name="249242154"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/238009-t-compiler/meetings/topic/%5Bweekly%5D%202021-08-12%20%2354818/near/249242154" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> mw <a href="https://zulip-archive.rust-lang.org/stream/238009-t-compiler/meetings/topic/.5Bweekly.5D.202021-08-12.20.2354818.html#249242154">(Aug 12 2021 at 14:30)</a>:</h4>
<p>I think <span class="user-mention" data-user-id="123856">@Vadim Petrochenkov</span>'s comments make sense (although the wording in <a href="https://github.com/rust-lang/rust/pull/83947#discussion_r686959773">https://github.com/rust-lang/rust/pull/83947#discussion_r686959773</a> is a bit harsh -- maybe we could rephrase that to be more friendly?)</p>



<a name="249242161"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/238009-t-compiler/meetings/topic/%5Bweekly%5D%202021-08-12%20%2354818/near/249242161" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> eddyb <a href="https://zulip-archive.rust-lang.org/stream/238009-t-compiler/meetings/topic/.5Bweekly.5D.202021-08-12.20.2354818.html#249242161">(Aug 12 2021 at 14:31)</a>:</h4>
<p>(IIRC it splits one of the options into 2, or 2 of them into 3)</p>



<a name="249242280"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/238009-t-compiler/meetings/topic/%5Bweekly%5D%202021-08-12%20%2354818/near/249242280" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> mw <a href="https://zulip-archive.rust-lang.org/stream/238009-t-compiler/meetings/topic/.5Bweekly.5D.202021-08-12.20.2354818.html#249242280">(Aug 12 2021 at 14:31)</a>:</h4>
<p>I think we basically decided to merge this in some form other via the FCP, but the author did not respond, right?</p>



<a name="249242343"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/238009-t-compiler/meetings/topic/%5Bweekly%5D%202021-08-12%20%2354818/near/249242343" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pnkfelix <a href="https://zulip-archive.rust-lang.org/stream/238009-t-compiler/meetings/topic/.5Bweekly.5D.202021-08-12.20.2354818.html#249242343">(Aug 12 2021 at 14:32)</a>:</h4>
<p>I interpret <span class="user-mention" data-user-id="123856">@Vadim Petrochenkov</span> ’s main concerns as being about documentation: the internal comments, and the user visible docs</p>



<a name="249242384"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/238009-t-compiler/meetings/topic/%5Bweekly%5D%202021-08-12%20%2354818/near/249242384" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> eddyb <a href="https://zulip-archive.rust-lang.org/stream/238009-t-compiler/meetings/topic/.5Bweekly.5D.202021-08-12.20.2354818.html#249242384">(Aug 12 2021 at 14:32)</a>:</h4>
<p>the other thing is that I have no intuition for line "directives" vs "tables" - I would've expected both to be the same?</p>



<a name="249242404"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/238009-t-compiler/meetings/topic/%5Bweekly%5D%202021-08-12%20%2354818/near/249242404" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pnkfelix <a href="https://zulip-archive.rust-lang.org/stream/238009-t-compiler/meetings/topic/.5Bweekly.5D.202021-08-12.20.2354818.html#249242404">(Aug 12 2021 at 14:32)</a>:</h4>
<p>and someone not understanding what these things mean. (A concern I understand, because I do not understand what these distinctions mean)</p>



<a name="249242470"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/238009-t-compiler/meetings/topic/%5Bweekly%5D%202021-08-12%20%2354818/near/249242470" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> mw <a href="https://zulip-archive.rust-lang.org/stream/238009-t-compiler/meetings/topic/.5Bweekly.5D.202021-08-12.20.2354818.html#249242470">(Aug 12 2021 at 14:33)</a>:</h4>
<p>yeah, one has to dig into the relevant LLVM commits to get a rough idea</p>



<a name="249242492"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/238009-t-compiler/meetings/topic/%5Bweekly%5D%202021-08-12%20%2354818/near/249242492" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> mw <a href="https://zulip-archive.rust-lang.org/stream/238009-t-compiler/meetings/topic/.5Bweekly.5D.202021-08-12.20.2354818.html#249242492">(Aug 12 2021 at 14:33)</a>:</h4>
<p>we should not require rustc users to do that :)</p>



<a name="249242498"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/238009-t-compiler/meetings/topic/%5Bweekly%5D%202021-08-12%20%2354818/near/249242498" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pnkfelix <a href="https://zulip-archive.rust-lang.org/stream/238009-t-compiler/meetings/topic/.5Bweekly.5D.202021-08-12.20.2354818.html#249242498">(Aug 12 2021 at 14:33)</a>:</h4>
<p>but what is the best way to move this forward? Do we think the PR author is going to be capable of improving the internal and external docs?</p>



<a name="249242526"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/238009-t-compiler/meetings/topic/%5Bweekly%5D%202021-08-12%20%2354818/near/249242526" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> eddyb <a href="https://zulip-archive.rust-lang.org/stream/238009-t-compiler/meetings/topic/.5Bweekly.5D.202021-08-12.20.2354818.html#249242526">(Aug 12 2021 at 14:33)</a>:</h4>
<p>like I know what "line info" is, and <code>debuginfo=1</code> is <em>almost only that</em> (plus some <code>fn</code> definitions and inlining scopes), but what is the difference between "directives" and "tables"</p>



<a name="249242577"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/238009-t-compiler/meetings/topic/%5Bweekly%5D%202021-08-12%20%2354818/near/249242577" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> eddyb <a href="https://zulip-archive.rust-lang.org/stream/238009-t-compiler/meetings/topic/.5Bweekly.5D.202021-08-12.20.2354818.html#249242577">(Aug 12 2021 at 14:34)</a>:</h4>
<p>I don't think we just need better docs, but names that don't sound redundant</p>



<a name="249242624"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/238009-t-compiler/meetings/topic/%5Bweekly%5D%202021-08-12%20%2354818/near/249242624" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pnkfelix <a href="https://zulip-archive.rust-lang.org/stream/238009-t-compiler/meetings/topic/.5Bweekly.5D.202021-08-12.20.2354818.html#249242624">(Aug 12 2021 at 14:34)</a>:</h4>
<p><span class="user-mention silent" data-user-id="119009">eddyb</span> <a href="#narrow/stream/238009-t-compiler.2Fmeetings/topic/.5Bweekly.5D.202021-08-12.20.2354818/near/249242101">said</a>:</p>
<blockquote>
<p><span class="user-mention silent" data-user-id="116083">pnkfelix</span> <a href="#narrow/stream/238009-t-compiler.2Fmeetings/topic/.5Bweekly.5D.202021-08-12.20.2354818/near/249241832">said</a>:</p>
<blockquote>
<ul>
<li>"Preserve, clarify, and extend debug information" <a href="https://github.com/rust-lang/rust/pull/83947">rust#83947</a></li>
</ul>
</blockquote>
<p>one thing I can say is this is about <code>-C debuginfo</code> choices, but the title sounds like it's far more</p>
</blockquote>
<p>I’m going to change the title to reflect that</p>



<a name="249242630"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/238009-t-compiler/meetings/topic/%5Bweekly%5D%202021-08-12%20%2354818/near/249242630" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> mw <a href="https://zulip-archive.rust-lang.org/stream/238009-t-compiler/meetings/topic/.5Bweekly.5D.202021-08-12.20.2354818.html#249242630">(Aug 12 2021 at 14:34)</a>:</h4>
<p>Do we have someone here who cares about this being supported sooner rather than later?</p>



<a name="249242658"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/238009-t-compiler/meetings/topic/%5Bweekly%5D%202021-08-12%20%2354818/near/249242658" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> bjorn3 <a href="https://zulip-archive.rust-lang.org/stream/238009-t-compiler/meetings/topic/.5Bweekly.5D.202021-08-12.20.2354818.html#249242658">(Aug 12 2021 at 14:34)</a>:</h4>
<blockquote>
<p>but what is the difference between "directives" and "tables"</p>
</blockquote>
<p>I think the author used them as synonyms.</p>



<a name="249242675"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/238009-t-compiler/meetings/topic/%5Bweekly%5D%202021-08-12%20%2354818/near/249242675" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> eddyb <a href="https://zulip-archive.rust-lang.org/stream/238009-t-compiler/meetings/topic/.5Bweekly.5D.202021-08-12.20.2354818.html#249242675">(Aug 12 2021 at 14:34)</a>:</h4>
<p>(I can't even tell which of "directives" and "tables" implies the other)</p>



<a name="249242729"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/238009-t-compiler/meetings/topic/%5Bweekly%5D%202021-08-12%20%2354818/near/249242729" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> mw <a href="https://zulip-archive.rust-lang.org/stream/238009-t-compiler/meetings/topic/.5Bweekly.5D.202021-08-12.20.2354818.html#249242729">(Aug 12 2021 at 14:35)</a>:</h4>
<p>IIRC, the terminology comes from the (rather undocumented) LLVM commits</p>



<a name="249242736"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/238009-t-compiler/meetings/topic/%5Bweekly%5D%202021-08-12%20%2354818/near/249242736" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> eddyb <a href="https://zulip-archive.rust-lang.org/stream/238009-t-compiler/meetings/topic/.5Bweekly.5D.202021-08-12.20.2354818.html#249242736">(Aug 12 2021 at 14:35)</a>:</h4>
<p><span class="user-mention silent" data-user-id="133247">bjorn3</span> <a href="#narrow/stream/238009-t-compiler.2Fmeetings/topic/.5Bweekly.5D.202021-08-12.20.2354818/near/249242658">said</a>:</p>
<blockquote>
<blockquote>
<p>but what is the difference between "directives" and "tables"</p>
</blockquote>
<p>I think the author used them as synonyms.</p>
</blockquote>
<p>the implementation doesn't look like it conflates them?</p>



<a name="249242816"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/238009-t-compiler/meetings/topic/%5Bweekly%5D%202021-08-12%20%2354818/near/249242816" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pnkfelix <a href="https://zulip-archive.rust-lang.org/stream/238009-t-compiler/meetings/topic/.5Bweekly.5D.202021-08-12.20.2354818.html#249242816">(Aug 12 2021 at 14:35)</a>:</h4>
<p>Lets leave a comment specifically saying that elaborating on these details is what is blocking the PR</p>



<a name="249242817"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/238009-t-compiler/meetings/topic/%5Bweekly%5D%202021-08-12%20%2354818/near/249242817" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> eddyb <a href="https://zulip-archive.rust-lang.org/stream/238009-t-compiler/meetings/topic/.5Bweekly.5D.202021-08-12.20.2354818.html#249242817">(Aug 12 2021 at 14:35)</a>:</h4>
<p>"line directives" goes into <code>DebugDirectivesOnly</code> while "line tables" goes into <code>LineTablesOnly</code>, so the former is likely the one that needs to be renamed</p>



<a name="249242887"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/238009-t-compiler/meetings/topic/%5Bweekly%5D%202021-08-12%20%2354818/near/249242887" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> bjorn3 <a href="https://zulip-archive.rust-lang.org/stream/238009-t-compiler/meetings/topic/.5Bweekly.5D.202021-08-12.20.2354818.html#249242887">(Aug 12 2021 at 14:36)</a>:</h4>
<p>I see</p>



<a name="249242931"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/238009-t-compiler/meetings/topic/%5Bweekly%5D%202021-08-12%20%2354818/near/249242931" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pnkfelix <a href="https://zulip-archive.rust-lang.org/stream/238009-t-compiler/meetings/topic/.5Bweekly.5D.202021-08-12.20.2354818.html#249242931">(Aug 12 2021 at 14:36)</a>:</h4>
<p>next</p>



<a name="249242945"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/238009-t-compiler/meetings/topic/%5Bweekly%5D%202021-08-12%20%2354818/near/249242945" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pnkfelix <a href="https://zulip-archive.rust-lang.org/stream/238009-t-compiler/meetings/topic/.5Bweekly.5D.202021-08-12.20.2354818.html#249242945">(Aug 12 2021 at 14:36)</a>:</h4>
<h2>Issues of Note</h2>
<h3>Short Summary</h3>
<ul>
<li><a href="https://github.com/rust-lang/rust/issues?q=is%3Aopen+label%3AT-compiler+label%3AP-critical">0 T-compiler P-critical issues</a><ul>
<li><a href="https://github.com/rust-lang/rust/issues?q=is%3Aopen+label%3AT-compiler+label%3AP-critical+no%3Aassignee">0 of those are unassigned</a></li>
</ul>
</li>
<li><a href="https://github.com/rust-lang/rust/issues?q=is%3Aopen+label%3AT-compiler+label%3AP-high">85 T-compiler P-high issues</a><ul>
<li><a href="https://github.com/rust-lang/rust/issues?q=is%3Aopen+label%3AT-compiler+label%3AP-high+no%3Aassignee">57 of those are unassigned</a></li>
</ul>
</li>
<li><a href="https://github.com/rust-lang/rust/labels/regression-from-stable-to-beta">1 P-critical, 1 P-high, 0 P-medium, 0 P-low regression-from-stable-to-beta</a></li>
<li><a href="https://github.com/rust-lang/rust/labels/regression-from-stable-to-nightly">0 P-critical, 4 P-high, 2 P-medium, 2 P-low regression-from-stable-to-nightly</a></li>
<li><a href="https://github.com/rust-lang/rust/labels/regression-from-stable-to-stable">0 P-critical, 49 P-high, 81 P-medium, 9 P-low regression-from-stable-to-stable</a></li>
</ul>



<a name="249242959"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/238009-t-compiler/meetings/topic/%5Bweekly%5D%202021-08-12%20%2354818/near/249242959" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pnkfelix <a href="https://zulip-archive.rust-lang.org/stream/238009-t-compiler/meetings/topic/.5Bweekly.5D.202021-08-12.20.2354818.html#249242959">(Aug 12 2021 at 14:36)</a>:</h4>
<h3>P-critical</h3>
<p><a href="https://github.com/rust-lang/rust/issues?utf8=%E2%9C%93&amp;q=is%3Aopen+label%3AP-critical+label%3AT-compiler">T-compiler</a></p>
<ul>
<li>No <code>P-critical</code> issues for <code>T-compiler</code> this time.</li>
</ul>
<p><a href="https://github.com/rust-lang/rust/issues?utf8=%E2%9C%93&amp;q=is%3Aopen+label%3AP-critical+label%3AT-rustdoc">T-rustdoc</a></p>
<ul>
<li>No <code>P-critical</code> issues for <code>T-rustdoc</code> this time.</li>
</ul>



<a name="249242971"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/238009-t-compiler/meetings/topic/%5Bweekly%5D%202021-08-12%20%2354818/near/249242971" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pnkfelix <a href="https://zulip-archive.rust-lang.org/stream/238009-t-compiler/meetings/topic/.5Bweekly.5D.202021-08-12.20.2354818.html#249242971">(Aug 12 2021 at 14:36)</a>:</h4>
<h3>P-high regressions</h3>
<p><a href="https://github.com/rust-lang/rust/issues?q=is%3Aopen+label%3Aregression-from-stable-to-beta+label%3AP-high+-label%3AT-infra+-label%3AT-libs+-label%3AT-release+-label%3AT-rustdoc+-label%3AT-core">P-high beta regressions</a></p>



<a name="249242982"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/238009-t-compiler/meetings/topic/%5Bweekly%5D%202021-08-12%20%2354818/near/249242982" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pnkfelix <a href="https://zulip-archive.rust-lang.org/stream/238009-t-compiler/meetings/topic/.5Bweekly.5D.202021-08-12.20.2354818.html#249242982">(Aug 12 2021 at 14:37)</a>:</h4>
<ul>
<li>"ICE: unexpected concrete region in borrowck: ReStatic" <a href="https://github.com/rust-lang/rust/issues/87455">rust#87455</a> <ul>
<li>opened by <span class="user-mention" data-user-id="120518">@Eric Huss</span></li>
<li>needs <a href="https://github.com/rust-lang/rust/pull/87483">rust#87483</a> to be backported (was beta-accepted <a href="#narrow/stream/238009-t-compiler.2Fmeetings/topic/.5Bweekly.5D.202021-08-05.20.2354818/near/248489051">last week</a>)</li>
</ul>
</li>
</ul>



<a name="249243019"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/238009-t-compiler/meetings/topic/%5Bweekly%5D%202021-08-12%20%2354818/near/249243019" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pnkfelix <a href="https://zulip-archive.rust-lang.org/stream/238009-t-compiler/meetings/topic/.5Bweekly.5D.202021-08-12.20.2354818.html#249243019">(Aug 12 2021 at 14:37)</a>:</h4>
<p>I’ll own the backport</p>



<a name="249243049"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/238009-t-compiler/meetings/topic/%5Bweekly%5D%202021-08-12%20%2354818/near/249243049" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> tmandry <a href="https://zulip-archive.rust-lang.org/stream/238009-t-compiler/meetings/topic/.5Bweekly.5D.202021-08-12.20.2354818.html#249243049">(Aug 12 2021 at 14:37)</a>:</h4>
<p>debug directives sounds a lot like unwind info to me, I’m wondering if there’s a relation</p>



<a name="249243119"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/238009-t-compiler/meetings/topic/%5Bweekly%5D%202021-08-12%20%2354818/near/249243119" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pnkfelix <a href="https://zulip-archive.rust-lang.org/stream/238009-t-compiler/meetings/topic/.5Bweekly.5D.202021-08-12.20.2354818.html#249243119">(Aug 12 2021 at 14:38)</a>:</h4>
<p><a href="https://github.com/rust-lang/rust/issues?q=is%3Aopen+label%3Aregression-from-stable-to-nightly+label%3AP-high+no%3Aassignee+-label%3AT-infra+-label%3AT-libs+-label%3AT-release+-label%3AT-rustdoc+-label%3AT-core">Unassigned P-high nightly regressions</a></p>
<ul>
<li>No unassigned <code>P-high</code> nightly regressions this time.</li>
</ul>



<a name="249243140"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/238009-t-compiler/meetings/topic/%5Bweekly%5D%202021-08-12%20%2354818/near/249243140" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pnkfelix <a href="https://zulip-archive.rust-lang.org/stream/238009-t-compiler/meetings/topic/.5Bweekly.5D.202021-08-12.20.2354818.html#249243140">(Aug 12 2021 at 14:38)</a>:</h4>
<h2>Performance logs</h2>
<blockquote>
<p><a href="https://github.com/rust-lang/rustc-perf/blob/master/triage/2021-08-11.md">triage logs for 2021-08-11</a></p>
</blockquote>
<p>A quiet week for performance. Changes, both positive and negative, tended to be isolated to few benchmarks.</p>
<p>Triage done by <strong>@pnkfelix</strong>.<br>
Revision range: <a href="https://perf.rust-lang.org/?start=3354a44d2fa8d5ba6b8d6b40d2596de2c8292ec1&amp;end=6b20506d17f4e5e5bf5bcad7e94add4d754b0ae3&amp;absolute=false&amp;stat=instructions%3Au">3354a44d2fa8d5ba6b8d6b40d2596de2c8292ec1..6b20506d17f4e5e5bf5bcad7e94add4d754b0ae3</a></p>
<p>2 Regressions, 1 Improvements, 0 Mixed; 0 of them in rollups</p>



<a name="249243151"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/238009-t-compiler/meetings/topic/%5Bweekly%5D%202021-08-12%20%2354818/near/249243151" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pnkfelix <a href="https://zulip-archive.rust-lang.org/stream/238009-t-compiler/meetings/topic/.5Bweekly.5D.202021-08-12.20.2354818.html#249243151">(Aug 12 2021 at 14:38)</a>:</h4>
<h4>Regressions</h4>
<p>Use zeroed allocations in the mir interpreter instead eagerly touching the memory <a href="https://github.com/rust-lang/rust/issues/87777">#87777</a></p>
<ul>
<li>Moderate regression in <a href="https://perf.rust-lang.org/compare.html?start=1f94abcda6884893d4723304102089198caa0839&amp;end=4c29cc8fd09889880880cb6081174c79744ab1b6&amp;stat=instructions:u">instruction counts</a> (up to 1.7% on <code>incr-unchanged</code> builds of <code>ctfe-stress-4-check</code>)</li>
<li>The motivation for this PR was to reduce the number of page faults, for the same family of ctfe-stress-4 benchmarks.</li>
<li>So, perf runs were done on the PR itself, to illustrate the motivated change.</li>
<li>The number of page faults <a href="https://perf.rust-lang.org/compare.html?start=1f94abcda6884893d4723304102089198caa0839&amp;end=4c29cc8fd09889880880cb6081174c79744ab1b6&amp;stat=faults">did decrease (by up to 25%)</a>.</li>
<li>The regression with respect to instruction counts appears isolated to just the ctfe-stress-4 family; the page fault reduction outweighs instruction count hit.</li>
<li>(Unfortunately the page fault decrease did not yield a corresponding improvement to reported wall-clock or task-clock times.)</li>
</ul>
<p>Hide allocator details from TryReserveError <a href="https://github.com/rust-lang/rust/issues/87408">#87408</a></p>
<ul>
<li>Moderate regression in <a href="https://perf.rust-lang.org/compare.html?start=db3cb435c1197ef3e3919c03b7f81ca8bffbd007&amp;end=996ff2e0a0f911f52bb1de6bdd0cfd5704de1fc9&amp;stat=instructions:u">instruction counts</a> (up to 4.2% on <code>full</code> builds of <code>html5ever-opt</code>)</li>
<li>The regression with respect to instruction counts appears isolated to just the html5ever-opt benchmark; all other reported changes pale in significance.</li>
<li>Potentially significant: the max-rss for html5ever-opt also regressed here, by 8%.</li>
<li>(Skimming over the PR itself, I do not see any obvious reason for this significant of a regression to max-rss.)</li>
<li>Some other benchmarks also regressed with respect to max-rss, but none so significantly.</li>
<li>Left a <a href="https://github.com/rust-lang/rust/pull/87408#issuecomment-896924754">comment on the PR</a> as a heads up.</li>
</ul>



<a name="249243184"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/238009-t-compiler/meetings/topic/%5Bweekly%5D%202021-08-12%20%2354818/near/249243184" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pnkfelix <a href="https://zulip-archive.rust-lang.org/stream/238009-t-compiler/meetings/topic/.5Bweekly.5D.202021-08-12.20.2354818.html#249243184">(Aug 12 2021 at 14:38)</a>:</h4>
<h4>Improvements</h4>
<ul>
<li>#[inline] slice::Iter::advance_by <a href="https://github.com/rust-lang/rust/issues/87736">#87736</a></li>
<li>(this was a targetted PR to address a previously flagged regression)</li>
</ul>



<a name="249243192"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/238009-t-compiler/meetings/topic/%5Bweekly%5D%202021-08-12%20%2354818/near/249243192" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pnkfelix <a href="https://zulip-archive.rust-lang.org/stream/238009-t-compiler/meetings/topic/.5Bweekly.5D.202021-08-12.20.2354818.html#249243192">(Aug 12 2021 at 14:38)</a>:</h4>
<h4>Mixed</h4>
<p>None</p>



<a name="249243239"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/238009-t-compiler/meetings/topic/%5Bweekly%5D%202021-08-12%20%2354818/near/249243239" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pnkfelix <a href="https://zulip-archive.rust-lang.org/stream/238009-t-compiler/meetings/topic/.5Bweekly.5D.202021-08-12.20.2354818.html#249243239">(Aug 12 2021 at 14:39)</a>:</h4>
<h4>Untriaged Pull Requests</h4>
<ul>
<li><a href="https://github.com/rust-lang/rust/pull/87640">#87640 Rollup of 9 pull requests</a></li>
<li><a href="https://github.com/rust-lang/rust/pull/87587">#87587 Various refactorings of the TAIT infrastructure</a></li>
<li><a href="https://github.com/rust-lang/rust/pull/87244">#87244 Better diagnostics with mismatched types due to implicit static lifetime</a></li>
<li><a href="https://github.com/rust-lang/rust/pull/86777">#86777 Include terminators in instance size estimate</a></li>
<li><a href="https://github.com/rust-lang/rust/pull/86698">#86698 Move OnDiskCache to rustc_query_impl.</a></li>
<li><a href="https://github.com/rust-lang/rust/pull/86588">#86588 Rollup of 8 pull requests</a></li>
<li><a href="https://github.com/rust-lang/rust/pull/86034">#86034 Change entry point to 🛡️ against 💥 💥-payloads</a></li>
<li><a href="https://github.com/rust-lang/rust/pull/84560">#84560 Inline Iterator as IntoIterator.</a></li>
</ul>



<a name="249243255"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/238009-t-compiler/meetings/topic/%5Bweekly%5D%202021-08-12%20%2354818/near/249243255" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pnkfelix <a href="https://zulip-archive.rust-lang.org/stream/238009-t-compiler/meetings/topic/.5Bweekly.5D.202021-08-12.20.2354818.html#249243255">(Aug 12 2021 at 14:39)</a>:</h4>
<h2>Nominated Issues</h2>
<p><a href="https://github.com/rust-lang/rust/issues?q=is%3Aopen+label%3AI-nominated+label%3AT-compiler">T-compiler</a></p>



<a name="249243265"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/238009-t-compiler/meetings/topic/%5Bweekly%5D%202021-08-12%20%2354818/near/249243265" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pnkfelix <a href="https://zulip-archive.rust-lang.org/stream/238009-t-compiler/meetings/topic/.5Bweekly.5D.202021-08-12.20.2354818.html#249243265">(Aug 12 2021 at 14:39)</a>:</h4>
<ul>
<li>"Remove all json handling from rustc_serialize" <a href="https://github.com/rust-lang/rust/pull/85993">rust#85993</a><ul>
<li>Nominated by <span class="user-mention" data-user-id="125294">@Aaron Hill</span>  to point out that <a href="https://github.com/rust-lang/rust/pull/85993#issuecomment-894686998">a broader discussion is needed</a></li>
<li><span class="user-mention" data-user-id="124288">@oli</span> <a href="https://github.com/rust-lang/rust/pull/85993#issuecomment-895309985">suggests an MCP</a></li>
</ul>
</li>
</ul>



<a name="249243285"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/238009-t-compiler/meetings/topic/%5Bweekly%5D%202021-08-12%20%2354818/near/249243285" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pnkfelix <a href="https://zulip-archive.rust-lang.org/stream/238009-t-compiler/meetings/topic/.5Bweekly.5D.202021-08-12.20.2354818.html#249243285">(Aug 12 2021 at 14:39)</a>:</h4>
<p>(we discussed this already, up above. lets get through rest of list first)</p>



<a name="249243296"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/238009-t-compiler/meetings/topic/%5Bweekly%5D%202021-08-12%20%2354818/near/249243296" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pnkfelix <a href="https://zulip-archive.rust-lang.org/stream/238009-t-compiler/meetings/topic/.5Bweekly.5D.202021-08-12.20.2354818.html#249243296">(Aug 12 2021 at 14:39)</a>:</h4>
<ul>
<li>"Binary size is significant increased from <code>1.46.0</code> to <code>1.51.0</code>" <a href="https://github.com/rust-lang/rust/issues/86610">rust#86610</a> <ul>
<li>Added an action item on <a href="https://hackmd.io/5BtjuenFTn6M74IDwLOjgw#T-compiler-Unowned">HackMD</a>, needs an owner</li>
</ul>
</li>
</ul>



<a name="249243450"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/238009-t-compiler/meetings/topic/%5Bweekly%5D%202021-08-12%20%2354818/near/249243450" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pnkfelix <a href="https://zulip-archive.rust-lang.org/stream/238009-t-compiler/meetings/topic/.5Bweekly.5D.202021-08-12.20.2354818.html#249243450">(Aug 12 2021 at 14:40)</a>:</h4>
<p>(the action item is : add binary size tracking to perf.rlo )</p>



<a name="249243466"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/238009-t-compiler/meetings/topic/%5Bweekly%5D%202021-08-12%20%2354818/near/249243466" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pnkfelix <a href="https://zulip-archive.rust-lang.org/stream/238009-t-compiler/meetings/topic/.5Bweekly.5D.202021-08-12.20.2354818.html#249243466">(Aug 12 2021 at 14:40)</a>:</h4>
<p>its not high priority, but something we should try to get around to doing</p>



<a name="249243492"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/238009-t-compiler/meetings/topic/%5Bweekly%5D%202021-08-12%20%2354818/near/249243492" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pnkfelix <a href="https://zulip-archive.rust-lang.org/stream/238009-t-compiler/meetings/topic/.5Bweekly.5D.202021-08-12.20.2354818.html#249243492">(Aug 12 2021 at 14:41)</a>:</h4>
<p><a href="https://github.com/rust-lang/rfcs/issues?q=is%3Aopen+label%3AI-nominated+label%3AT-compiler">RFC</a></p>



<a name="249243501"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/238009-t-compiler/meetings/topic/%5Bweekly%5D%202021-08-12%20%2354818/near/249243501" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pnkfelix <a href="https://zulip-archive.rust-lang.org/stream/238009-t-compiler/meetings/topic/.5Bweekly.5D.202021-08-12.20.2354818.html#249243501">(Aug 12 2021 at 14:41)</a>:</h4>
<ul>
<li>"[RFC2603] Extend <code>&lt;const&gt;</code> to include <code>str</code> and structural constants." <a href="https://github.com/rust-lang/rfcs/pull/3161">rfcs#3161</a><ul>
<li>nominated by <span class="user-mention" data-user-id="119009">@eddyb</span> </li>
<li><a href="https://github.com/rust-lang/rfcs/pull/3161#issuecomment-896587191">review and concerns</a></li>
</ul>
</li>
</ul>



<a name="249243536"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/238009-t-compiler/meetings/topic/%5Bweekly%5D%202021-08-12%20%2354818/near/249243536" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pnkfelix <a href="https://zulip-archive.rust-lang.org/stream/238009-t-compiler/meetings/topic/.5Bweekly.5D.202021-08-12.20.2354818.html#249243536">(Aug 12 2021 at 14:41)</a>:</h4>
<p>So we’re way ahead of our usual schedule on this meeting. Lets take advantage and discuss <a href="https://github.com/rust-lang/rfcs/issues/3161">rfcs#3161</a></p>



<a name="249243641"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/238009-t-compiler/meetings/topic/%5Bweekly%5D%202021-08-12%20%2354818/near/249243641" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> eddyb <a href="https://zulip-archive.rust-lang.org/stream/238009-t-compiler/meetings/topic/.5Bweekly.5D.202021-08-12.20.2354818.html#249243641">(Aug 12 2021 at 14:42)</a>:</h4>
<p>we're getting very close to <code>v0</code> being able to handle everything, including unstable const generics usage</p>



<a name="249243684"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/238009-t-compiler/meetings/topic/%5Bweekly%5D%202021-08-12%20%2354818/near/249243684" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> eddyb <a href="https://zulip-archive.rust-lang.org/stream/238009-t-compiler/meetings/topic/.5Bweekly.5D.202021-08-12.20.2354818.html#249243684">(Aug 12 2021 at 14:42)</a>:</h4>
<p>and tooling out there is starting to have support for it trickle in (e.g. <code>c++filt</code>, <code>gdb</code>, etc.)</p>



<a name="249243707"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/238009-t-compiler/meetings/topic/%5Bweekly%5D%202021-08-12%20%2354818/near/249243707" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pnkfelix <a href="https://zulip-archive.rust-lang.org/stream/238009-t-compiler/meetings/topic/.5Bweekly.5D.202021-08-12.20.2354818.html#249243707">(Aug 12 2021 at 14:42)</a>:</h4>
<p>is the essential idea here that we need to be able to mangle arbitrary <code>const</code> values so that they can appear in the symbols we generate after monomorphizing a type with such a value in it?</p>



<a name="249243724"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/238009-t-compiler/meetings/topic/%5Bweekly%5D%202021-08-12%20%2354818/near/249243724" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> mw <a href="https://zulip-archive.rust-lang.org/stream/238009-t-compiler/meetings/topic/.5Bweekly.5D.202021-08-12.20.2354818.html#249243724">(Aug 12 2021 at 14:42)</a>:</h4>
<p>yes</p>



<a name="249243730"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/238009-t-compiler/meetings/topic/%5Bweekly%5D%202021-08-12%20%2354818/near/249243730" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> eddyb <a href="https://zulip-archive.rust-lang.org/stream/238009-t-compiler/meetings/topic/.5Bweekly.5D.202021-08-12.20.2354818.html#249243730">(Aug 12 2021 at 14:42)</a>:</h4>
<p>so we could switch to it as the default <em>very</em> soon, hence wanting more eyes on it</p>



<a name="249243765"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/238009-t-compiler/meetings/topic/%5Bweekly%5D%202021-08-12%20%2354818/near/249243765" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> mw <a href="https://zulip-archive.rust-lang.org/stream/238009-t-compiler/meetings/topic/.5Bweekly.5D.202021-08-12.20.2354818.html#249243765">(Aug 12 2021 at 14:43)</a>:</h4>
<p>that's what the crater run turned up to be the only thing not working at the moment</p>



<a name="249243788"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/238009-t-compiler/meetings/topic/%5Bweekly%5D%202021-08-12%20%2354818/near/249243788" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> eddyb <a href="https://zulip-archive.rust-lang.org/stream/238009-t-compiler/meetings/topic/.5Bweekly.5D.202021-08-12.20.2354818.html#249243788">(Aug 12 2021 at 14:43)</a>:</h4>
<p>and yeah, any type that can exist after monomorphization has to be representable, including constants (including weird constants)</p>



<a name="249243832"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/238009-t-compiler/meetings/topic/%5Bweekly%5D%202021-08-12%20%2354818/near/249243832" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> eddyb <a href="https://zulip-archive.rust-lang.org/stream/238009-t-compiler/meetings/topic/.5Bweekly.5D.202021-08-12.20.2354818.html#249243832">(Aug 12 2021 at 14:43)</a>:</h4>
<p>there are some fascinating uses in the wild already</p>



<a name="249243888"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/238009-t-compiler/meetings/topic/%5Bweekly%5D%202021-08-12%20%2354818/near/249243888" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pnkfelix <a href="https://zulip-archive.rust-lang.org/stream/238009-t-compiler/meetings/topic/.5Bweekly.5D.202021-08-12.20.2354818.html#249243888">(Aug 12 2021 at 14:44)</a>:</h4>
<p>in the added forms, "A…E” … that’s literally five characters, ‘A’, ‘.’, ‘.’, ‘.’, ‘E’ ?</p>



<a name="249243934"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/238009-t-compiler/meetings/topic/%5Bweekly%5D%202021-08-12%20%2354818/near/249243934" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> eddyb <a href="https://zulip-archive.rust-lang.org/stream/238009-t-compiler/meetings/topic/.5Bweekly.5D.202021-08-12.20.2354818.html#249243934">(Aug 12 2021 at 14:44)</a>:</h4>
<p>it's me summarizing the grammar. if you look at the diff, it's <code>"A" {&lt;const&gt;} "E"</code></p>



<a name="249243943"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/238009-t-compiler/meetings/topic/%5Bweekly%5D%202021-08-12%20%2354818/near/249243943" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Aaron Hill <a href="https://zulip-archive.rust-lang.org/stream/238009-t-compiler/meetings/topic/.5Bweekly.5D.202021-08-12.20.2354818.html#249243943">(Aug 12 2021 at 14:44)</a>:</h4>
<p>Would we need to wait for all of the external tools to update to this RFC?</p>



<a name="249243949"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/238009-t-compiler/meetings/topic/%5Bweekly%5D%202021-08-12%20%2354818/near/249243949" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pnkfelix <a href="https://zulip-archive.rust-lang.org/stream/238009-t-compiler/meetings/topic/.5Bweekly.5D.202021-08-12.20.2354818.html#249243949">(Aug 12 2021 at 14:44)</a>:</h4>
<p>okay, thank you</p>



<a name="249243973"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/238009-t-compiler/meetings/topic/%5Bweekly%5D%202021-08-12%20%2354818/near/249243973" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Aaron Hill <a href="https://zulip-archive.rust-lang.org/stream/238009-t-compiler/meetings/topic/.5Bweekly.5D.202021-08-12.20.2354818.html#249243973">(Aug 12 2021 at 14:44)</a>:</h4>
<p>Or would that only matter when we want to start supporting arbitrary? types in const generics?</p>



<a name="249243980"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/238009-t-compiler/meetings/topic/%5Bweekly%5D%202021-08-12%20%2354818/near/249243980" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> eddyb <a href="https://zulip-archive.rust-lang.org/stream/238009-t-compiler/meetings/topic/.5Bweekly.5D.202021-08-12.20.2354818.html#249243980">(Aug 12 2021 at 14:44)</a>:</h4>
<p><span class="user-mention silent" data-user-id="125294">Aaron Hill</span> <a href="#narrow/stream/238009-t-compiler.2Fmeetings/topic/.5Bweekly.5D.202021-08-12.20.2354818/near/249243943">said</a>:</p>
<blockquote>
<p>Would we need to wait for all of the external tools to update to this RFC?</p>
</blockquote>
<p>not at all, this is all unstable support</p>



<a name="249244003"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/238009-t-compiler/meetings/topic/%5Bweekly%5D%202021-08-12%20%2354818/near/249244003" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> eddyb <a href="https://zulip-archive.rust-lang.org/stream/238009-t-compiler/meetings/topic/.5Bweekly.5D.202021-08-12.20.2354818.html#249244003">(Aug 12 2021 at 14:45)</a>:</h4>
<p>that is, it's supported, but not on stable</p>



<a name="249244051"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/238009-t-compiler/meetings/topic/%5Bweekly%5D%202021-08-12%20%2354818/near/249244051" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> eddyb <a href="https://zulip-archive.rust-lang.org/stream/238009-t-compiler/meetings/topic/.5Bweekly.5D.202021-08-12.20.2354818.html#249244051">(Aug 12 2021 at 14:45)</a>:</h4>
<p>if you're using the unstable const generics, you can e.g. use <code>rustfilt</code> and it will support the new mangling right away</p>



<a name="249244101"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/238009-t-compiler/meetings/topic/%5Bweekly%5D%202021-08-12%20%2354818/near/249244101" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> eddyb <a href="https://zulip-archive.rust-lang.org/stream/238009-t-compiler/meetings/topic/.5Bweekly.5D.202021-08-12.20.2354818.html#249244101">(Aug 12 2021 at 14:45)</a>:</h4>
<p>so among other things, <span class="user-mention" data-user-id="123856">@Vadim Petrochenkov</span> had some interesting concerns over how much detail we should include, which frankly I hadn't considered</p>



<a name="249244103"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/238009-t-compiler/meetings/topic/%5Bweekly%5D%202021-08-12%20%2354818/near/249244103" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> mw <a href="https://zulip-archive.rust-lang.org/stream/238009-t-compiler/meetings/topic/.5Bweekly.5D.202021-08-12.20.2354818.html#249244103">(Aug 12 2021 at 14:45)</a>:</h4>
<p>can we merge support for this in the compiler and rustc-demangle before amending the RFC?</p>



<a name="249244166"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/238009-t-compiler/meetings/topic/%5Bweekly%5D%202021-08-12%20%2354818/near/249244166" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> mw <a href="https://zulip-archive.rust-lang.org/stream/238009-t-compiler/meetings/topic/.5Bweekly.5D.202021-08-12.20.2354818.html#249244166">(Aug 12 2021 at 14:46)</a>:</h4>
<p>so that we get testing before setting the grammar in stone?</p>



<a name="249244244"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/238009-t-compiler/meetings/topic/%5Bweekly%5D%202021-08-12%20%2354818/near/249244244" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> eddyb <a href="https://zulip-archive.rust-lang.org/stream/238009-t-compiler/meetings/topic/.5Bweekly.5D.202021-08-12.20.2354818.html#249244244">(Aug 12 2021 at 14:46)</a>:</h4>
<p>I had initially assumed we would want to be able to demangle to roughly the expression syntax for creating those constants, even if that results in <em>technically</em> unnecessary information (such as field names)</p>



<a name="249244288"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/238009-t-compiler/meetings/topic/%5Bweekly%5D%202021-08-12%20%2354818/near/249244288" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> eddyb <a href="https://zulip-archive.rust-lang.org/stream/238009-t-compiler/meetings/topic/.5Bweekly.5D.202021-08-12.20.2354818.html#249244288">(Aug 12 2021 at 14:47)</a>:</h4>
<p><span class="user-mention silent" data-user-id="124287">mw</span> <a href="#narrow/stream/238009-t-compiler.2Fmeetings/topic/.5Bweekly.5D.202021-08-12.20.2354818/near/249244103">said</a>:</p>
<blockquote>
<p>can we merge support for this in the compiler and rustc-demangle before amending the RFC?</p>
</blockquote>
<p>ah good question - I'm fine with it if that's what we decide on</p>



<a name="249244297"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/238009-t-compiler/meetings/topic/%5Bweekly%5D%202021-08-12%20%2354818/near/249244297" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pnkfelix <a href="https://zulip-archive.rust-lang.org/stream/238009-t-compiler/meetings/topic/.5Bweekly.5D.202021-08-12.20.2354818.html#249244297">(Aug 12 2021 at 14:47)</a>:</h4>
<p><span class="user-mention silent" data-user-id="124287">mw</span> <a href="#narrow/stream/238009-t-compiler.2Fmeetings/topic/.5Bweekly.5D.202021-08-12.20.2354818/near/249244166">said</a>:</p>
<blockquote>
<p>so that we get testing before setting the grammar in stone?</p>
</blockquote>
<p>well, RFC’s are sort of living documents anyway</p>



<a name="249244316"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/238009-t-compiler/meetings/topic/%5Bweekly%5D%202021-08-12%20%2354818/near/249244316" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> mw <a href="https://zulip-archive.rust-lang.org/stream/238009-t-compiler/meetings/topic/.5Bweekly.5D.202021-08-12.20.2354818.html#249244316">(Aug 12 2021 at 14:47)</a>:</h4>
<p>there is some precedent for omitting field names in C++, right?</p>



<a name="249244375"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/238009-t-compiler/meetings/topic/%5Bweekly%5D%202021-08-12%20%2354818/near/249244375" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pnkfelix <a href="https://zulip-archive.rust-lang.org/stream/238009-t-compiler/meetings/topic/.5Bweekly.5D.202021-08-12.20.2354818.html#249244375">(Aug 12 2021 at 14:47)</a>:</h4>
<p>So while I’m fine with the idea of landing the implementation first before amending the RFC in this case, I just want to point out that I don’t think it is something we need to stress too much about in the long run?</p>



<a name="249244434"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/238009-t-compiler/meetings/topic/%5Bweekly%5D%202021-08-12%20%2354818/near/249244434" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> mw <a href="https://zulip-archive.rust-lang.org/stream/238009-t-compiler/meetings/topic/.5Bweekly.5D.202021-08-12.20.2354818.html#249244434">(Aug 12 2021 at 14:48)</a>:</h4>
<p>yes</p>



<a name="249244474"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/238009-t-compiler/meetings/topic/%5Bweekly%5D%202021-08-12%20%2354818/near/249244474" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> eddyb <a href="https://zulip-archive.rust-lang.org/stream/238009-t-compiler/meetings/topic/.5Bweekly.5D.202021-08-12.20.2354818.html#249244474">(Aug 12 2021 at 14:48)</a>:</h4>
<p>I haven't actually looked at what C++ does to be quite honest - since they use an expression AST, I doubt they could even use field names, since that's a GNU extension (or used to be a for a while, maybe it's standard now)</p>



<a name="249244493"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/238009-t-compiler/meetings/topic/%5Bweekly%5D%202021-08-12%20%2354818/near/249244493" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> mw <a href="https://zulip-archive.rust-lang.org/stream/238009-t-compiler/meetings/topic/.5Bweekly.5D.202021-08-12.20.2354818.html#249244493">(Aug 12 2021 at 14:48)</a>:</h4>
<p>we'd be saving us a potential "fix some bugs" RFC amendment, but not much more, right?</p>



<a name="249244625"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/238009-t-compiler/meetings/topic/%5Bweekly%5D%202021-08-12%20%2354818/near/249244625" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> mw <a href="https://zulip-archive.rust-lang.org/stream/238009-t-compiler/meetings/topic/.5Bweekly.5D.202021-08-12.20.2354818.html#249244625">(Aug 12 2021 at 14:49)</a>:</h4>
<p>I mean at the source level  it supports something like <code>Foo x = { 1, 2, 3 };</code></p>



<a name="249244645"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/238009-t-compiler/meetings/topic/%5Bweekly%5D%202021-08-12%20%2354818/near/249244645" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> mw <a href="https://zulip-archive.rust-lang.org/stream/238009-t-compiler/meetings/topic/.5Bweekly.5D.202021-08-12.20.2354818.html#249244645">(Aug 12 2021 at 14:49)</a>:</h4>
<p>where Foo is a struct with field names</p>



<a name="249244816"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/238009-t-compiler/meetings/topic/%5Bweekly%5D%202021-08-12%20%2354818/near/249244816" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pnkfelix <a href="https://zulip-archive.rust-lang.org/stream/238009-t-compiler/meetings/topic/.5Bweekly.5D.202021-08-12.20.2354818.html#249244816">(Aug 12 2021 at 14:50)</a>:</h4>
<p>if we omit the field names</p>



<a name="249244833"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/238009-t-compiler/meetings/topic/%5Bweekly%5D%202021-08-12%20%2354818/near/249244833" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pnkfelix <a href="https://zulip-archive.rust-lang.org/stream/238009-t-compiler/meetings/topic/.5Bweekly.5D.202021-08-12.20.2354818.html#249244833">(Aug 12 2021 at 14:51)</a>:</h4>
<p>then I guess we use, what, declaration ordering?</p>



<a name="249244857"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/238009-t-compiler/meetings/topic/%5Bweekly%5D%202021-08-12%20%2354818/near/249244857" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> eddyb <a href="https://zulip-archive.rust-lang.org/stream/238009-t-compiler/meetings/topic/.5Bweekly.5D.202021-08-12.20.2354818.html#249244857">(Aug 12 2021 at 14:51)</a>:</h4>
<p>yeah</p>



<a name="249244858"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/238009-t-compiler/meetings/topic/%5Bweekly%5D%202021-08-12%20%2354818/near/249244858" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pnkfelix <a href="https://zulip-archive.rust-lang.org/stream/238009-t-compiler/meetings/topic/.5Bweekly.5D.202021-08-12.20.2354818.html#249244858">(Aug 12 2021 at 14:51)</a>:</h4>
<p>I guess that’s fine</p>



<a name="249244900"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/238009-t-compiler/meetings/topic/%5Bweekly%5D%202021-08-12%20%2354818/near/249244900" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> eddyb <a href="https://zulip-archive.rust-lang.org/stream/238009-t-compiler/meetings/topic/.5Bweekly.5D.202021-08-12.20.2354818.html#249244900">(Aug 12 2021 at 14:51)</a>:</h4>
<p>I think initially I wanted a simpler <code>(constructor, [child values])</code> kind of tree, but decided against it when I realized it would be easy to recover user-friendly syntax</p>



<a name="249244956"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/238009-t-compiler/meetings/topic/%5Bweekly%5D%202021-08-12%20%2354818/near/249244956" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pnkfelix <a href="https://zulip-archive.rust-lang.org/stream/238009-t-compiler/meetings/topic/.5Bweekly.5D.202021-08-12.20.2354818.html#249244956">(Aug 12 2021 at 14:52)</a>:</h4>
<p>would it be a bad idea to support both encodings?</p>



<a name="249245003"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/238009-t-compiler/meetings/topic/%5Bweekly%5D%202021-08-12%20%2354818/near/249245003" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> mw <a href="https://zulip-archive.rust-lang.org/stream/238009-t-compiler/meetings/topic/.5Bweekly.5D.202021-08-12.20.2354818.html#249245003">(Aug 12 2021 at 14:52)</a>:</h4>
<p>we could make field names optional, but I'm not sure we want that</p>



<a name="249245015"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/238009-t-compiler/meetings/topic/%5Bweekly%5D%202021-08-12%20%2354818/near/249245015" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> eddyb <a href="https://zulip-archive.rust-lang.org/stream/238009-t-compiler/meetings/topic/.5Bweekly.5D.202021-08-12.20.2354818.html#249245015">(Aug 12 2021 at 14:52)</a>:</h4>
<p>you can just encode them any way you want honestly</p>



<a name="249245020"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/238009-t-compiler/meetings/topic/%5Bweekly%5D%202021-08-12%20%2354818/near/249245020" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pnkfelix <a href="https://zulip-archive.rust-lang.org/stream/238009-t-compiler/meetings/topic/.5Bweekly.5D.202021-08-12.20.2354818.html#249245020">(Aug 12 2021 at 14:52)</a>:</h4>
<p>i.e. to make the grammar have one struct encoding that included field names and one that does not include hem</p>



<a name="249245044"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/238009-t-compiler/meetings/topic/%5Bweekly%5D%202021-08-12%20%2354818/near/249245044" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> eddyb <a href="https://zulip-archive.rust-lang.org/stream/238009-t-compiler/meetings/topic/.5Bweekly.5D.202021-08-12.20.2354818.html#249245044">(Aug 12 2021 at 14:52)</a>:</h4>
<p>the encoding has much more flexibility than one might assume</p>



<a name="249245070"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/238009-t-compiler/meetings/topic/%5Bweekly%5D%202021-08-12%20%2354818/near/249245070" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> eddyb <a href="https://zulip-archive.rust-lang.org/stream/238009-t-compiler/meetings/topic/.5Bweekly.5D.202021-08-12.20.2354818.html#249245070">(Aug 12 2021 at 14:52)</a>:</h4>
<p>you can e.g. have zero-length identifiers</p>



<a name="249245101"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/238009-t-compiler/meetings/topic/%5Bweekly%5D%202021-08-12%20%2354818/near/249245101" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> eddyb <a href="https://zulip-archive.rust-lang.org/stream/238009-t-compiler/meetings/topic/.5Bweekly.5D.202021-08-12.20.2354818.html#249245101">(Aug 12 2021 at 14:52)</a>:</h4>
<p>tho it would look weird</p>



<a name="249245115"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/238009-t-compiler/meetings/topic/%5Bweekly%5D%202021-08-12%20%2354818/near/249245115" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> eddyb <a href="https://zulip-archive.rust-lang.org/stream/238009-t-compiler/meetings/topic/.5Bweekly.5D.202021-08-12.20.2354818.html#249245115">(Aug 12 2021 at 14:53)</a>:</h4>
<p>or you can use the tuple struct form</p>



<a name="249245133"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/238009-t-compiler/meetings/topic/%5Bweekly%5D%202021-08-12%20%2354818/near/249245133" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> mw <a href="https://zulip-archive.rust-lang.org/stream/238009-t-compiler/meetings/topic/.5Bweekly.5D.202021-08-12.20.2354818.html#249245133">(Aug 12 2021 at 14:53)</a>:</h4>
<p>I think the length of symbol names is the main concern here</p>



<a name="249245159"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/238009-t-compiler/meetings/topic/%5Bweekly%5D%202021-08-12%20%2354818/near/249245159" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> mw <a href="https://zulip-archive.rust-lang.org/stream/238009-t-compiler/meetings/topic/.5Bweekly.5D.202021-08-12.20.2354818.html#249245159">(Aug 12 2021 at 14:53)</a>:</h4>
<p>because it has implications on compile times and binary size</p>



<a name="249245194"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/238009-t-compiler/meetings/topic/%5Bweekly%5D%202021-08-12%20%2354818/near/249245194" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pnkfelix <a href="https://zulip-archive.rust-lang.org/stream/238009-t-compiler/meetings/topic/.5Bweekly.5D.202021-08-12.20.2354818.html#249245194">(Aug 12 2021 at 14:53)</a>:</h4>
<p>The flexibilty of the encoding that eddyb mentions, does it end up yielding essentially equivalent savings in <del>binary size</del> symbol length?</p>



<a name="249245291"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/238009-t-compiler/meetings/topic/%5Bweekly%5D%202021-08-12%20%2354818/near/249245291" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> mw <a href="https://zulip-archive.rust-lang.org/stream/238009-t-compiler/meetings/topic/.5Bweekly.5D.202021-08-12.20.2354818.html#249245291">(Aug 12 2021 at 14:54)</a>:</h4>
<p>not quite, right <span class="user-mention" data-user-id="119009">@eddyb</span> ?</p>



<a name="249245296"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/238009-t-compiler/meetings/topic/%5Bweekly%5D%202021-08-12%20%2354818/near/249245296" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pnkfelix <a href="https://zulip-archive.rust-lang.org/stream/238009-t-compiler/meetings/topic/.5Bweekly.5D.202021-08-12.20.2354818.html#249245296">(Aug 12 2021 at 14:54)</a>:</h4>
<p>my attittude at this point is: We’re commiting to an aspect of an ABI here</p>



<a name="249245312"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/238009-t-compiler/meetings/topic/%5Bweekly%5D%202021-08-12%20%2354818/near/249245312" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pnkfelix <a href="https://zulip-archive.rust-lang.org/stream/238009-t-compiler/meetings/topic/.5Bweekly.5D.202021-08-12.20.2354818.html#249245312">(Aug 12 2021 at 14:54)</a>:</h4>
<p>to me, the best thing is to ensure that we don’t box ourselves in</p>



<a name="249245329"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/238009-t-compiler/meetings/topic/%5Bweekly%5D%202021-08-12%20%2354818/near/249245329" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> eddyb <a href="https://zulip-archive.rust-lang.org/stream/238009-t-compiler/meetings/topic/.5Bweekly.5D.202021-08-12.20.2354818.html#249245329">(Aug 12 2021 at 14:54)</a>:</h4>
<p>if you use the tuple form, it's only one extra character than if we only had one struct form</p>



<a name="249245345"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/238009-t-compiler/meetings/topic/%5Bweekly%5D%202021-08-12%20%2354818/near/249245345" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> mw <a href="https://zulip-archive.rust-lang.org/stream/238009-t-compiler/meetings/topic/.5Bweekly.5D.202021-08-12.20.2354818.html#249245345">(Aug 12 2021 at 14:54)</a>:</h4>
<p>the symbol names are still "implementation defined" per the original RFC</p>



<a name="249245373"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/238009-t-compiler/meetings/topic/%5Bweekly%5D%202021-08-12%20%2354818/near/249245373" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> mw <a href="https://zulip-archive.rust-lang.org/stream/238009-t-compiler/meetings/topic/.5Bweekly.5D.202021-08-12.20.2354818.html#249245373">(Aug 12 2021 at 14:55)</a>:</h4>
<p><span class="user-mention" data-user-id="116083">@pnkfelix</span> ^</p>



<a name="249245391"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/238009-t-compiler/meetings/topic/%5Bweekly%5D%202021-08-12%20%2354818/near/249245391" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> eddyb <a href="https://zulip-archive.rust-lang.org/stream/238009-t-compiler/meetings/topic/.5Bweekly.5D.202021-08-12.20.2354818.html#249245391">(Aug 12 2021 at 14:55)</a>:</h4>
<p><span class="user-mention silent" data-user-id="116083">pnkfelix</span> <a href="#narrow/stream/238009-t-compiler.2Fmeetings/topic/.5Bweekly.5D.202021-08-12.20.2354818/near/249245312">said</a>:</p>
<blockquote>
<p>to me, the best thing is to ensure that we don’t box ourselves in</p>
</blockquote>
<p>we're specifying what demanglers should handle, but not necessarily promising what we'll emit - especially since this is still unstable-const-generics-only territory</p>



<a name="249245392"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/238009-t-compiler/meetings/topic/%5Bweekly%5D%202021-08-12%20%2354818/near/249245392" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pnkfelix <a href="https://zulip-archive.rust-lang.org/stream/238009-t-compiler/meetings/topic/.5Bweekly.5D.202021-08-12.20.2354818.html#249245392">(Aug 12 2021 at 14:55)</a>:</h4>
<p><span class="user-mention" data-user-id="124287">@mw</span> but the format itself is being defined</p>



<a name="249245424"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/238009-t-compiler/meetings/topic/%5Bweekly%5D%202021-08-12%20%2354818/near/249245424" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> tmandry <a href="https://zulip-archive.rust-lang.org/stream/238009-t-compiler/meetings/topic/.5Bweekly.5D.202021-08-12.20.2354818.html#249245424">(Aug 12 2021 at 14:55)</a>:</h4>
<p>binary size only affects unstripped binaries though, right</p>



<a name="249245469"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/238009-t-compiler/meetings/topic/%5Bweekly%5D%202021-08-12%20%2354818/near/249245469" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> eddyb <a href="https://zulip-archive.rust-lang.org/stream/238009-t-compiler/meetings/topic/.5Bweekly.5D.202021-08-12.20.2354818.html#249245469">(Aug 12 2021 at 14:55)</a>:</h4>
<p>can you strip symbol tables? I guess you can if you're "linked enough"</p>



<a name="249245510"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/238009-t-compiler/meetings/topic/%5Bweekly%5D%202021-08-12%20%2354818/near/249245510" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> eddyb <a href="https://zulip-archive.rust-lang.org/stream/238009-t-compiler/meetings/topic/.5Bweekly.5D.202021-08-12.20.2354818.html#249245510">(Aug 12 2021 at 14:55)</a>:</h4>
<p>(we're not talking about debuginfo, to be clear)</p>



<a name="249245564"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/238009-t-compiler/meetings/topic/%5Bweekly%5D%202021-08-12%20%2354818/near/249245564" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pnkfelix <a href="https://zulip-archive.rust-lang.org/stream/238009-t-compiler/meetings/topic/.5Bweekly.5D.202021-08-12.20.2354818.html#249245564">(Aug 12 2021 at 14:56)</a>:</h4>
<p><span class="user-mention" data-user-id="119009">@eddyb</span> right, okay. so I’m just trying to say: As long as we ensure that demanglers are told that they should be <em>prepared</em> to handle either choice of encoding for a symbol, then this all sounds fine to me. I.e. that sounds like a way to address <span class="user-mention" data-user-id="123856">@Vadim Petrochenkov</span> ’s concern.</p>



<a name="249245572"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/238009-t-compiler/meetings/topic/%5Bweekly%5D%202021-08-12%20%2354818/near/249245572" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> bjorn3 <a href="https://zulip-archive.rust-lang.org/stream/238009-t-compiler/meetings/topic/.5Bweekly.5D.202021-08-12.20.2354818.html#249245572">(Aug 12 2021 at 14:56)</a>:</h4>
<p>You can strip the regular symbol table, but not the dynamic symbol table used during dynamic linking.</p>



<a name="249245624"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/238009-t-compiler/meetings/topic/%5Bweekly%5D%202021-08-12%20%2354818/near/249245624" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> mw <a href="https://zulip-archive.rust-lang.org/stream/238009-t-compiler/meetings/topic/.5Bweekly.5D.202021-08-12.20.2354818.html#249245624">(Aug 12 2021 at 14:56)</a>:</h4>
<p>from a user's point of view: how valuable are the field names really?</p>



<a name="249245639"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/238009-t-compiler/meetings/topic/%5Bweekly%5D%202021-08-12%20%2354818/near/249245639" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> eddyb <a href="https://zulip-archive.rust-lang.org/stream/238009-t-compiler/meetings/topic/.5Bweekly.5D.202021-08-12.20.2354818.html#249245639">(Aug 12 2021 at 14:56)</a>:</h4>
<p>one example of both "interesting usage in the wild", but also of "useful field names":</p>
<div class="codehilite" data-code-language="Rust"><pre><span></span><code><span class="n">tiny_uom</span>::<span class="n">Quantity</span><span class="o">&lt;</span><span class="n">tiny_uom</span>::<span class="n">Unit</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="n">m</span>: <span class="mi">1_</span><span class="k">i8</span><span class="p">,</span><span class="w"> </span><span class="n">kg</span>: <span class="mi">0_</span><span class="k">i8</span><span class="p">,</span><span class="w"> </span><span class="n">s</span>: <span class="o">-</span><span class="mi">1_</span><span class="k">i8</span><span class="p">,</span><span class="w"> </span><span class="n">A</span>: <span class="mi">0_</span><span class="k">i8</span><span class="p">,</span><span class="w"> </span><span class="n">K</span>: <span class="mi">0_</span><span class="k">i8</span><span class="p">,</span><span class="w"> </span><span class="n">mol</span>: <span class="mi">0_</span><span class="k">i8</span><span class="p">,</span><span class="w"> </span><span class="n">cd</span>: <span class="mi">0_</span><span class="k">i8</span><span class="w"> </span><span class="p">}</span><span class="o">&gt;</span><span class="w"></span>
</code></pre></div>



<a name="249245685"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/238009-t-compiler/meetings/topic/%5Bweekly%5D%202021-08-12%20%2354818/near/249245685" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> eddyb <a href="https://zulip-archive.rust-lang.org/stream/238009-t-compiler/meetings/topic/.5Bweekly.5D.202021-08-12.20.2354818.html#249245685">(Aug 12 2021 at 14:57)</a>:</h4>
<p>encoding SI units as a <code>struct</code> of powers of various fundamentals</p>



<a name="249245759"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/238009-t-compiler/meetings/topic/%5Bweekly%5D%202021-08-12%20%2354818/near/249245759" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> tmandry <a href="https://zulip-archive.rust-lang.org/stream/238009-t-compiler/meetings/topic/.5Bweekly.5D.202021-08-12.20.2354818.html#249245759">(Aug 12 2021 at 14:57)</a>:</h4>
<p>when would we link generic monomorphizations dynamically?</p>



<a name="249245786"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/238009-t-compiler/meetings/topic/%5Bweekly%5D%202021-08-12%20%2354818/near/249245786" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> eddyb <a href="https://zulip-archive.rust-lang.org/stream/238009-t-compiler/meetings/topic/.5Bweekly.5D.202021-08-12.20.2354818.html#249245786">(Aug 12 2021 at 14:57)</a>:</h4>
<p>these will show up in backtraces, for example</p>



<a name="249245801"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/238009-t-compiler/meetings/topic/%5Bweekly%5D%202021-08-12%20%2354818/near/249245801" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> bjorn3 <a href="https://zulip-archive.rust-lang.org/stream/238009-t-compiler/meetings/topic/.5Bweekly.5D.202021-08-12.20.2354818.html#249245801">(Aug 12 2021 at 14:58)</a>:</h4>
<p>If you combine <code>-Zshare-generics</code> with dynamic libraries.</p>



<a name="249245876"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/238009-t-compiler/meetings/topic/%5Bweekly%5D%202021-08-12%20%2354818/near/249245876" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pnkfelix <a href="https://zulip-archive.rust-lang.org/stream/238009-t-compiler/meetings/topic/.5Bweekly.5D.202021-08-12.20.2354818.html#249245876">(Aug 12 2021 at 14:58)</a>:</h4>
<p><span class="user-mention silent" data-user-id="124287">mw</span> <a href="#narrow/stream/238009-t-compiler.2Fmeetings/topic/.5Bweekly.5D.202021-08-12.20.2354818/near/249245624">said</a>:</p>
<blockquote>
<p>from a user's point of view: how valuable are the field names really?</p>
</blockquote>
<p>If I have easy access to source (and appropriate type names or source code mapping info) or high quality debug info, then presumably the field names are not useful at all. But in my experience, you cannot rely on those being present when you are at your darkest moment.</p>



<a name="249245917"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/238009-t-compiler/meetings/topic/%5Bweekly%5D%202021-08-12%20%2354818/near/249245917" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> eddyb <a href="https://zulip-archive.rust-lang.org/stream/238009-t-compiler/meetings/topic/.5Bweekly.5D.202021-08-12.20.2354818.html#249245917">(Aug 12 2021 at 14:58)</a>:</h4>
<p><span class="user-mention silent" data-user-id="116883">tmandry</span> <a href="#narrow/stream/238009-t-compiler.2Fmeetings/topic/.5Bweekly.5D.202021-08-12.20.2354818/near/249245759">said</a>:</p>
<blockquote>
<p>when would we link generic monomorphizations dynamically?</p>
</blockquote>
<p>a function doesn't have to be generic to end up with generics in its mangling</p>



<a name="249245993"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/238009-t-compiler/meetings/topic/%5Bweekly%5D%202021-08-12%20%2354818/near/249245993" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> eddyb <a href="https://zulip-archive.rust-lang.org/stream/238009-t-compiler/meetings/topic/.5Bweekly.5D.202021-08-12.20.2354818.html#249245993">(Aug 12 2021 at 14:59)</a>:</h4>
<p>(usually methods in an <code>impl</code> will result in the <code>Self</code> type being included)</p>



<a name="249246025"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/238009-t-compiler/meetings/topic/%5Bweekly%5D%202021-08-12%20%2354818/near/249246025" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pnkfelix <a href="https://zulip-archive.rust-lang.org/stream/238009-t-compiler/meetings/topic/.5Bweekly.5D.202021-08-12.20.2354818.html#249246025">(Aug 12 2021 at 14:59)</a>:</h4>
<p>are there any concerns to discuss here besides the ones that <span class="user-mention" data-user-id="123856">@Vadim Petrochenkov</span> had raised?</p>



<a name="249246218"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/238009-t-compiler/meetings/topic/%5Bweekly%5D%202021-08-12%20%2354818/near/249246218" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> mw <a href="https://zulip-archive.rust-lang.org/stream/238009-t-compiler/meetings/topic/.5Bweekly.5D.202021-08-12.20.2354818.html#249246218">(Aug 12 2021 at 15:00)</a>:</h4>
<p>I don't think so</p>



<a name="249246264"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/238009-t-compiler/meetings/topic/%5Bweekly%5D%202021-08-12%20%2354818/near/249246264" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> tmandry <a href="https://zulip-archive.rust-lang.org/stream/238009-t-compiler/meetings/topic/.5Bweekly.5D.202021-08-12.20.2354818.html#249246264">(Aug 12 2021 at 15:00)</a>:</h4>
<p>yeah so it would be a large effort but I’ll point out that we don’t <em>have</em> to do symbolization in-process like we do now (fuchsia doesn’t) and instead invest in tooling that makes it easy to split that info out of the binary and stitch it up later</p>



<a name="249246330"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/238009-t-compiler/meetings/topic/%5Bweekly%5D%202021-08-12%20%2354818/near/249246330" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> eddyb <a href="https://zulip-archive.rust-lang.org/stream/238009-t-compiler/meetings/topic/.5Bweekly.5D.202021-08-12.20.2354818.html#249246330">(Aug 12 2021 at 15:01)</a>:</h4>
<p><span class="user-mention silent" data-user-id="116083">pnkfelix</span> <a href="#narrow/stream/238009-t-compiler.2Fmeetings/topic/.5Bweekly.5D.202021-08-12.20.2354818/near/249245564">said</a>:</p>
<blockquote>
<p><span class="user-mention silent" data-user-id="119009">eddyb</span> right, okay. so I’m just trying to say: As long as we ensure that demanglers are told that they should be <em>prepared</em> to handle either choice of encoding for a symbol, then this all sounds fine to me. I.e. that sounds like a way to address <span class="user-mention silent" data-user-id="123856">Vadim Petrochenkov</span> ’s concern.</p>
</blockquote>
<p>I guess there's two paths we could take: either have a field-name-oriented grammar and have the ability to not include the extra information in the mangler, <em>or</em> have two grammars</p>
<p>the difference being that the former requires no more effort right now</p>



<a name="249246343"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/238009-t-compiler/meetings/topic/%5Bweekly%5D%202021-08-12%20%2354818/near/249246343" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> tmandry <a href="https://zulip-archive.rust-lang.org/stream/238009-t-compiler/meetings/topic/.5Bweekly.5D.202021-08-12.20.2354818.html#249246343">(Aug 12 2021 at 15:01)</a>:</h4>
<p>(modulo the dynamic linking symbol names, can’t do anything about that)</p>



<a name="249246428"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/238009-t-compiler/meetings/topic/%5Bweekly%5D%202021-08-12%20%2354818/near/249246428" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> bjorn3 <a href="https://zulip-archive.rust-lang.org/stream/238009-t-compiler/meetings/topic/.5Bweekly.5D.202021-08-12.20.2354818.html#249246428">(Aug 12 2021 at 15:01)</a>:</h4>
<p><span class="user-mention silent" data-user-id="116883">tmandry</span> <a href="#narrow/stream/238009-t-compiler.2Fmeetings/topic/.5Bweekly.5D.202021-08-12.20.2354818/near/249246264">said</a>:</p>
<blockquote>
<p>yeah so it would be a large effort but I’ll point out that we don’t <em>have</em> to do symbolization in-process like we do now (fuchsia doesn’t) and instead invest in tooling that makes it easy to split that info out of the binary and stitch it up later</p>
</blockquote>
<p>Like <code>objcopy --extract-symbol</code>?</p>



<a name="249246498"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/238009-t-compiler/meetings/topic/%5Bweekly%5D%202021-08-12%20%2354818/near/249246498" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> mw <a href="https://zulip-archive.rust-lang.org/stream/238009-t-compiler/meetings/topic/.5Bweekly.5D.202021-08-12.20.2354818.html#249246498">(Aug 12 2021 at 15:02)</a>:</h4>
<p>my concern is: if we decide to support both options, how to we decide what the compiler emits by default?</p>



<a name="249246554"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/238009-t-compiler/meetings/topic/%5Bweekly%5D%202021-08-12%20%2354818/near/249246554" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> tmandry <a href="https://zulip-archive.rust-lang.org/stream/238009-t-compiler/meetings/topic/.5Bweekly.5D.202021-08-12.20.2354818.html#249246554">(Aug 12 2021 at 15:02)</a>:</h4>
<p><span class="user-mention" data-user-id="133247">@bjorn3</span> probably, I haven’t used that flag specifically though</p>



<a name="249246587"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/238009-t-compiler/meetings/topic/%5Bweekly%5D%202021-08-12%20%2354818/near/249246587" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pnkfelix <a href="https://zulip-archive.rust-lang.org/stream/238009-t-compiler/meetings/topic/.5Bweekly.5D.202021-08-12.20.2354818.html#249246587">(Aug 12 2021 at 15:02)</a>:</h4>
<p><span class="user-mention silent" data-user-id="124287">mw</span> <a href="#narrow/stream/238009-t-compiler.2Fmeetings/topic/.5Bweekly.5D.202021-08-12.20.2354818/near/249246498">said</a>:</p>
<blockquote>
<p>my concern is: if we decide to support both options, how to we decide what the compiler emits by default?</p>
</blockquote>
<p>Either flags or source attributes?</p>



<a name="249246637"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/238009-t-compiler/meetings/topic/%5Bweekly%5D%202021-08-12%20%2354818/near/249246637" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pnkfelix <a href="https://zulip-archive.rust-lang.org/stream/238009-t-compiler/meetings/topic/.5Bweekly.5D.202021-08-12.20.2354818.html#249246637">(Aug 12 2021 at 15:03)</a>:</h4>
<p>It seems like a solvable problem</p>



<a name="249246640"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/238009-t-compiler/meetings/topic/%5Bweekly%5D%202021-08-12%20%2354818/near/249246640" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> eddyb <a href="https://zulip-archive.rust-lang.org/stream/238009-t-compiler/meetings/topic/.5Bweekly.5D.202021-08-12.20.2354818.html#249246640">(Aug 12 2021 at 15:03)</a>:</h4>
<p><span class="user-mention" data-user-id="124287">@mw</span> I'd defer that question to when those const generics are stabilized, but maybe that's not a good enough answer, heh</p>



<a name="249246647"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/238009-t-compiler/meetings/topic/%5Bweekly%5D%202021-08-12%20%2354818/near/249246647" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> tmandry <a href="https://zulip-archive.rust-lang.org/stream/238009-t-compiler/meetings/topic/.5Bweekly.5D.202021-08-12.20.2354818.html#249246647">(Aug 12 2021 at 15:03)</a>:</h4>
<p>(all you need in the process is unwind info to get the stack of PC counters and you can do everything else out of process)</p>



<a name="249246770"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/238009-t-compiler/meetings/topic/%5Bweekly%5D%202021-08-12%20%2354818/near/249246770" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> mw <a href="https://zulip-archive.rust-lang.org/stream/238009-t-compiler/meetings/topic/.5Bweekly.5D.202021-08-12.20.2354818.html#249246770">(Aug 12 2021 at 15:04)</a>:</h4>
<p><span class="user-mention silent" data-user-id="116083">pnkfelix</span> <a href="#narrow/stream/238009-t-compiler.2Fmeetings/topic/.5Bweekly.5D.202021-08-12.20.2354818/near/249246587">said</a>:</p>
<blockquote>
<p><span class="user-mention silent" data-user-id="124287">mw</span> <a href="#narrow/stream/238009-t-compiler.2Fmeetings/topic/.5Bweekly.5D.202021-08-12.20.2354818/near/249246498">said</a>:</p>
<blockquote>
<p>my concern is: if we decide to support both options, how to we decide what the compiler emits by default?</p>
</blockquote>
<p>Either (command-line) flags or source attributes?</p>
</blockquote>
<p>Yes, you can make it configurable. But most users will just use the default -- and "in their darkest hour" be stuck with that</p>



<a name="249246803"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/238009-t-compiler/meetings/topic/%5Bweekly%5D%202021-08-12%20%2354818/near/249246803" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pnkfelix <a href="https://zulip-archive.rust-lang.org/stream/238009-t-compiler/meetings/topic/.5Bweekly.5D.202021-08-12.20.2354818.html#249246803">(Aug 12 2021 at 15:04)</a>:</h4>
<p>Yeah. And so that will indeed be a discussion we’ll need to have, in terms of what the <em>right</em> defaults are</p>



<a name="249246830"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/238009-t-compiler/meetings/topic/%5Bweekly%5D%202021-08-12%20%2354818/near/249246830" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pnkfelix <a href="https://zulip-archive.rust-lang.org/stream/238009-t-compiler/meetings/topic/.5Bweekly.5D.202021-08-12.20.2354818.html#249246830">(Aug 12 2021 at 15:04)</a>:</h4>
<p>we can’t decide that right now anyway, since there’s negative 4 minutes left in the meeting.</p>



<a name="249246864"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/238009-t-compiler/meetings/topic/%5Bweekly%5D%202021-08-12%20%2354818/near/249246864" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pnkfelix <a href="https://zulip-archive.rust-lang.org/stream/238009-t-compiler/meetings/topic/.5Bweekly.5D.202021-08-12.20.2354818.html#249246864">(Aug 12 2021 at 15:04)</a>:</h4>
<p>Thanks to everyone in <span class="user-group-mention" data-user-group-id="897">@T-compiler/meeting</span> for attending! Be well, everyone!</p>



<a name="249247044"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/238009-t-compiler/meetings/topic/%5Bweekly%5D%202021-08-12%20%2354818/near/249247044" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pnkfelix <a href="https://zulip-archive.rust-lang.org/stream/238009-t-compiler/meetings/topic/.5Bweekly.5D.202021-08-12.20.2354818.html#249247044">(Aug 12 2021 at 15:06)</a>:</h4>
<p><span class="user-mention silent" data-user-id="116083">pnkfelix</span> <a href="#narrow/stream/238009-t-compiler.2Fmeetings/topic/.5Bweekly.5D.202021-08-12.20.2354818/near/249246803">said</a>:</p>
<blockquote>
<p>Yeah. And so that will indeed be a discussion we’ll need to have, in terms of what the <em>right</em> defaults are</p>
</blockquote>
<p>(I was briefly musing, maybe use —release vs non-release as the basis, in terms of how the crate that <em>defines</em> the symbol is compiled.)</p>



<a name="249247119"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/238009-t-compiler/meetings/topic/%5Bweekly%5D%202021-08-12%20%2354818/near/249247119" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> mw <a href="https://zulip-archive.rust-lang.org/stream/238009-t-compiler/meetings/topic/.5Bweekly.5D.202021-08-12.20.2354818.html#249247119">(Aug 12 2021 at 15:06)</a>:</h4>
<p>my proposal: </p>
<ol>
<li>merge the implementation with both options available (both in the mangler and demangler)</li>
<li>don't merge the RFC amendment yet</li>
<li>gather some real world data once we can do that easily</li>
</ol>



<a name="249247126"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/238009-t-compiler/meetings/topic/%5Bweekly%5D%202021-08-12%20%2354818/near/249247126" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pnkfelix <a href="https://zulip-archive.rust-lang.org/stream/238009-t-compiler/meetings/topic/.5Bweekly.5D.202021-08-12.20.2354818.html#249247126">(Aug 12 2021 at 15:06)</a>:</h4>
<p>but then again, my "darkest hour” is usually associated with release builds. :)</p>



<a name="249247184"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/238009-t-compiler/meetings/topic/%5Bweekly%5D%202021-08-12%20%2354818/near/249247184" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> mw <a href="https://zulip-archive.rust-lang.org/stream/238009-t-compiler/meetings/topic/.5Bweekly.5D.202021-08-12.20.2354818.html#249247184">(Aug 12 2021 at 15:07)</a>:</h4>
<p>that's basically <span class="user-mention" data-user-id="119009">@eddyb</span>'s "defer until const generics stabilization", I guess</p>



<a name="249247230"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/238009-t-compiler/meetings/topic/%5Bweekly%5D%202021-08-12%20%2354818/near/249247230" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> mw <a href="https://zulip-archive.rust-lang.org/stream/238009-t-compiler/meetings/topic/.5Bweekly.5D.202021-08-12.20.2354818.html#249247230">(Aug 12 2021 at 15:07)</a>:</h4>
<p>but it would unblock making the new scheme the new default</p>



<a name="249247390"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/238009-t-compiler/meetings/topic/%5Bweekly%5D%202021-08-12%20%2354818/near/249247390" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pnkfelix <a href="https://zulip-archive.rust-lang.org/stream/238009-t-compiler/meetings/topic/.5Bweekly.5D.202021-08-12.20.2354818.html#249247390">(Aug 12 2021 at 15:08)</a>:</h4>
<p>(I’m good with that.)</p>



<a name="249247639"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/238009-t-compiler/meetings/topic/%5Bweekly%5D%202021-08-12%20%2354818/near/249247639" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> eddyb <a href="https://zulip-archive.rust-lang.org/stream/238009-t-compiler/meetings/topic/.5Bweekly.5D.202021-08-12.20.2354818.html#249247639">(Aug 12 2021 at 15:10)</a>:</h4>
<p>ah there were a couple things I forgot to mention - there's a separate concern about e.g. <code>Foo</code> vs <code>Foo {}</code>, and also we need a choice of variant for <code>enum</code>s, but for <code>struct</code>s even the path of the <code>struct</code> is redundant</p>



<a name="249247679"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/238009-t-compiler/meetings/topic/%5Bweekly%5D%202021-08-12%20%2354818/near/249247679" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> eddyb <a href="https://zulip-archive.rust-lang.org/stream/238009-t-compiler/meetings/topic/.5Bweekly.5D.202021-08-12.20.2354818.html#249247679">(Aug 12 2021 at 15:10)</a>:</h4>
<p>so there's a tradeoff sliding scale of "how much redundant information is kept in"</p>



<a name="249247727"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/238009-t-compiler/meetings/topic/%5Bweekly%5D%202021-08-12%20%2354818/near/249247727" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> mw <a href="https://zulip-archive.rust-lang.org/stream/238009-t-compiler/meetings/topic/.5Bweekly.5D.202021-08-12.20.2354818.html#249247727">(Aug 12 2021 at 15:11)</a>:</h4>
<blockquote>
<p>also we need a choice of variant for enums, but for structs even the path of the struct is redundant</p>
</blockquote>
<p>Can you elaborate on these two points?</p>



<a name="249247787"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/238009-t-compiler/meetings/topic/%5Bweekly%5D%202021-08-12%20%2354818/near/249247787" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> eddyb <a href="https://zulip-archive.rust-lang.org/stream/238009-t-compiler/meetings/topic/.5Bweekly.5D.202021-08-12.20.2354818.html#249247787">(Aug 12 2021 at 15:11)</a>:</h4>
<p>right now <code>enum</code> values are encoded as if their variants were <code>struct</code>s</p>



<a name="249247864"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/238009-t-compiler/meetings/topic/%5Bweekly%5D%202021-08-12%20%2354818/near/249247864" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> eddyb <a href="https://zulip-archive.rust-lang.org/stream/238009-t-compiler/meetings/topic/.5Bweekly.5D.202021-08-12.20.2354818.html#249247864">(Aug 12 2021 at 15:12)</a>:</h4>
<p>so you end up with <code>core::option::Option::Some(...)</code> <em>as if</em> <code>Some</code> was a tuple <code>struct</code></p>



<a name="249247912"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/238009-t-compiler/meetings/topic/%5Bweekly%5D%202021-08-12%20%2354818/near/249247912" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pnkfelix <a href="https://zulip-archive.rust-lang.org/stream/238009-t-compiler/meetings/topic/.5Bweekly.5D.202021-08-12.20.2354818.html#249247912">(Aug 12 2021 at 15:12)</a>:</h4>
<p>The path of the struct is redundant because you can infer it from the overall context as you traverse, right?</p>



<a name="249247913"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/238009-t-compiler/meetings/topic/%5Bweekly%5D%202021-08-12%20%2354818/near/249247913" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> eddyb <a href="https://zulip-archive.rust-lang.org/stream/238009-t-compiler/meetings/topic/.5Bweekly.5D.202021-08-12.20.2354818.html#249247913">(Aug 12 2021 at 15:12)</a>:</h4>
<p>that's why the docs on the grammar and whatnot say variant/struct (or should, at least)</p>



<a name="249247990"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/238009-t-compiler/meetings/topic/%5Bweekly%5D%202021-08-12%20%2354818/near/249247990" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pnkfelix <a href="https://zulip-archive.rust-lang.org/stream/238009-t-compiler/meetings/topic/.5Bweekly.5D.202021-08-12.20.2354818.html#249247990">(Aug 12 2021 at 15:12)</a>:</h4>
<p>i.e. you only need the topmost path</p>



<a name="249247993"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/238009-t-compiler/meetings/topic/%5Bweekly%5D%202021-08-12%20%2354818/near/249247993" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> eddyb <a href="https://zulip-archive.rust-lang.org/stream/238009-t-compiler/meetings/topic/.5Bweekly.5D.202021-08-12.20.2354818.html#249247993">(Aug 12 2021 at 15:12)</a>:</h4>
<p><span class="user-mention silent" data-user-id="116083">pnkfelix</span> <a href="#narrow/stream/238009-t-compiler.2Fmeetings/topic/.5Bweekly.5D.202021-08-12.20.2354818/near/249247912">said</a>:</p>
<blockquote>
<p>The path of the struct is redundant because you can infer it from the overall context as you traverse, right?</p>
</blockquote>
<p>right, the type is fixed by whatever generic you're instantiating</p>



<a name="249248018"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/238009-t-compiler/meetings/topic/%5Bweekly%5D%202021-08-12%20%2354818/near/249248018" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> mw <a href="https://zulip-archive.rust-lang.org/stream/238009-t-compiler/meetings/topic/.5Bweekly.5D.202021-08-12.20.2354818.html#249248018">(Aug 12 2021 at 15:13)</a>:</h4>
<p>OK, I understand</p>



<a name="249248050"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/238009-t-compiler/meetings/topic/%5Bweekly%5D%202021-08-12%20%2354818/near/249248050" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> mw <a href="https://zulip-archive.rust-lang.org/stream/238009-t-compiler/meetings/topic/.5Bweekly.5D.202021-08-12.20.2354818.html#249248050">(Aug 12 2021 at 15:13)</a>:</h4>
<p>you could just emit <code>Some(2)</code></p>



<a name="249248117"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/238009-t-compiler/meetings/topic/%5Bweekly%5D%202021-08-12%20%2354818/near/249248117" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pnkfelix <a href="https://zulip-archive.rust-lang.org/stream/238009-t-compiler/meetings/topic/.5Bweekly.5D.202021-08-12.20.2354818.html#249248117">(Aug 12 2021 at 15:13)</a>:</h4>
<p>oy. Talk about darkest hours</p>



<a name="249248127"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/238009-t-compiler/meetings/topic/%5Bweekly%5D%202021-08-12%20%2354818/near/249248127" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> mw <a href="https://zulip-archive.rust-lang.org/stream/238009-t-compiler/meetings/topic/.5Bweekly.5D.202021-08-12.20.2354818.html#249248127">(Aug 12 2021 at 15:14)</a>:</h4>
<p>or for a struct <code>foo::bar::Baz { x: 2, y: 3 }</code> it would be enough to emit <code>{ 2, 3 }</code> in the extreme</p>



<a name="249248214"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/238009-t-compiler/meetings/topic/%5Bweekly%5D%202021-08-12%20%2354818/near/249248214" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> eddyb <a href="https://zulip-archive.rust-lang.org/stream/238009-t-compiler/meetings/topic/.5Bweekly.5D.202021-08-12.20.2354818.html#249248214">(Aug 12 2021 at 15:14)</a>:</h4>
<p>or <code>None</code> =&gt; <code>0</code>, <code>Some(2)</code> =&gt; <code>(1, 2)</code> :P</p>



<a name="249248230"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/238009-t-compiler/meetings/topic/%5Bweekly%5D%202021-08-12%20%2354818/near/249248230" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pnkfelix <a href="https://zulip-archive.rust-lang.org/stream/238009-t-compiler/meetings/topic/.5Bweekly.5D.202021-08-12.20.2354818.html#249248230">(Aug 12 2021 at 15:14)</a>:</h4>
<p>you don’t need the path for a struct, but you need any types it got instantiated with</p>



<a name="249248253"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/238009-t-compiler/meetings/topic/%5Bweekly%5D%202021-08-12%20%2354818/near/249248253" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pnkfelix <a href="https://zulip-archive.rust-lang.org/stream/238009-t-compiler/meetings/topic/.5Bweekly.5D.202021-08-12.20.2354818.html#249248253">(Aug 12 2021 at 15:14)</a>:</h4>
<p>or … i guess you can get that from context too …?</p>



<a name="249248274"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/238009-t-compiler/meetings/topic/%5Bweekly%5D%202021-08-12%20%2354818/near/249248274" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> eddyb <a href="https://zulip-archive.rust-lang.org/stream/238009-t-compiler/meetings/topic/.5Bweekly.5D.202021-08-12.20.2354818.html#249248274">(Aug 12 2021 at 15:15)</a>:</h4>
<p><span class="user-mention" data-user-id="116083">@pnkfelix</span> the entire type of the <code>const</code> generic parameter has to be determined from elsewhere</p>



<a name="249248305"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/238009-t-compiler/meetings/topic/%5Bweekly%5D%202021-08-12%20%2354818/near/249248305" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> eddyb <a href="https://zulip-archive.rust-lang.org/stream/238009-t-compiler/meetings/topic/.5Bweekly.5D.202021-08-12.20.2354818.html#249248305">(Aug 12 2021 at 15:15)</a>:</h4>
<p>it can't be polymorphic on its own</p>



<a name="249248319"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/238009-t-compiler/meetings/topic/%5Bweekly%5D%202021-08-12%20%2354818/near/249248319" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pnkfelix <a href="https://zulip-archive.rust-lang.org/stream/238009-t-compiler/meetings/topic/.5Bweekly.5D.202021-08-12.20.2354818.html#249248319">(Aug 12 2021 at 15:15)</a>:</h4>
<p>yeah okay</p>



<a name="249248427"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/238009-t-compiler/meetings/topic/%5Bweekly%5D%202021-08-12%20%2354818/near/249248427" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> eddyb <a href="https://zulip-archive.rust-lang.org/stream/238009-t-compiler/meetings/topic/.5Bweekly.5D.202021-08-12.20.2354818.html#249248427">(Aug 12 2021 at 15:16)</a>:</h4>
<p>anyway, I picked the approach that results in valid Rust syntax, but that also means the most redundancy</p>



<a name="249248477"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/238009-t-compiler/meetings/topic/%5Bweekly%5D%202021-08-12%20%2354818/near/249248477" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> mw <a href="https://zulip-archive.rust-lang.org/stream/238009-t-compiler/meetings/topic/.5Bweekly.5D.202021-08-12.20.2354818.html#249248477">(Aug 12 2021 at 15:16)</a>:</h4>
<p>it does seem a bit wasteful...</p>



<a name="249248742"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/238009-t-compiler/meetings/topic/%5Bweekly%5D%202021-08-12%20%2354818/near/249248742" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pnkfelix <a href="https://zulip-archive.rust-lang.org/stream/238009-t-compiler/meetings/topic/.5Bweekly.5D.202021-08-12.20.2354818.html#249248742">(Aug 12 2021 at 15:18)</a>:</h4>
<p>I’m pretty torn here</p>



<a name="249248753"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/238009-t-compiler/meetings/topic/%5Bweekly%5D%202021-08-12%20%2354818/near/249248753" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> eddyb <a href="https://zulip-archive.rust-lang.org/stream/238009-t-compiler/meetings/topic/.5Bweekly.5D.202021-08-12.20.2354818.html#249248753">(Aug 12 2021 at 15:18)</a>:</h4>
<p>we still don't know how widespread <code>const</code> generic parameters of user-defined types will be</p>



<a name="249248786"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/238009-t-compiler/meetings/topic/%5Bweekly%5D%202021-08-12%20%2354818/near/249248786" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> eddyb <a href="https://zulip-archive.rust-lang.org/stream/238009-t-compiler/meetings/topic/.5Bweekly.5D.202021-08-12.20.2354818.html#249248786">(Aug 12 2021 at 15:18)</a>:</h4>
<p>hard to make any "data-driven" decisions here at this point</p>



<a name="249248788"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/238009-t-compiler/meetings/topic/%5Bweekly%5D%202021-08-12%20%2354818/near/249248788" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> mw <a href="https://zulip-archive.rust-lang.org/stream/238009-t-compiler/meetings/topic/.5Bweekly.5D.202021-08-12.20.2354818.html#249248788">(Aug 12 2021 at 15:18)</a>:</h4>
<p>I think we'll need to experiment with both</p>



<a name="249248869"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/238009-t-compiler/meetings/topic/%5Bweekly%5D%202021-08-12%20%2354818/near/249248869" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pnkfelix <a href="https://zulip-archive.rust-lang.org/stream/238009-t-compiler/meetings/topic/.5Bweekly.5D.202021-08-12.20.2354818.html#249248869">(Aug 12 2021 at 15:19)</a>:</h4>
<p>yeah. So land current design, but also try to throw together a more optimized one?</p>



<a name="249248904"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/238009-t-compiler/meetings/topic/%5Bweekly%5D%202021-08-12%20%2354818/near/249248904" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> eddyb <a href="https://zulip-archive.rust-lang.org/stream/238009-t-compiler/meetings/topic/.5Bweekly.5D.202021-08-12.20.2354818.html#249248904">(Aug 12 2021 at 15:19)</a>:</h4>
<p>the nice thing about the more verbose/redundant encoding is you can elide aspects and demanglers will handle it just fine</p>



<a name="249249019"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/238009-t-compiler/meetings/topic/%5Bweekly%5D%202021-08-12%20%2354818/near/249249019" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> mw <a href="https://zulip-archive.rust-lang.org/stream/238009-t-compiler/meetings/topic/.5Bweekly.5D.202021-08-12.20.2354818.html#249249019">(Aug 12 2021 at 15:20)</a>:</h4>
<p>how many bytes is an empty identifier?</p>



<a name="249249036"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/238009-t-compiler/meetings/topic/%5Bweekly%5D%202021-08-12%20%2354818/near/249249036" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> mw <a href="https://zulip-archive.rust-lang.org/stream/238009-t-compiler/meetings/topic/.5Bweekly.5D.202021-08-12.20.2354818.html#249249036">(Aug 12 2021 at 15:20)</a>:</h4>
<p>one?</p>



<a name="249249042"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/238009-t-compiler/meetings/topic/%5Bweekly%5D%202021-08-12%20%2354818/near/249249042" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> mw <a href="https://zulip-archive.rust-lang.org/stream/238009-t-compiler/meetings/topic/.5Bweekly.5D.202021-08-12.20.2354818.html#249249042">(Aug 12 2021 at 15:20)</a>:</h4>
<p><code>0</code></p>



<a name="249249053"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/238009-t-compiler/meetings/topic/%5Bweekly%5D%202021-08-12%20%2354818/near/249249053" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> eddyb <a href="https://zulip-archive.rust-lang.org/stream/238009-t-compiler/meetings/topic/.5Bweekly.5D.202021-08-12.20.2354818.html#249249053">(Aug 12 2021 at 15:20)</a>:</h4>
<p>yeah</p>



<a name="249249138"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/238009-t-compiler/meetings/topic/%5Bweekly%5D%202021-08-12%20%2354818/near/249249138" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> eddyb <a href="https://zulip-archive.rust-lang.org/stream/238009-t-compiler/meetings/topic/.5Bweekly.5D.202021-08-12.20.2354818.html#249249138">(Aug 12 2021 at 15:21)</a>:</h4>
<p>honestly we lose a lot either way because of the lack of cross-symbol subtree reuse, I wish tooling had anything remotely close to something like that (cc <span class="user-mention" data-user-id="116883">@tmandry</span>)</p>



<a name="249249146"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/238009-t-compiler/meetings/topic/%5Bweekly%5D%202021-08-12%20%2354818/near/249249146" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> mw <a href="https://zulip-archive.rust-lang.org/stream/238009-t-compiler/meetings/topic/.5Bweekly.5D.202021-08-12.20.2354818.html#249249146">(Aug 12 2021 at 15:21)</a>:</h4>
<p>but the grammar would allow us to just make the field names and paths optional, right?</p>



<a name="249249212"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/238009-t-compiler/meetings/topic/%5Bweekly%5D%202021-08-12%20%2354818/near/249249212" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> eddyb <a href="https://zulip-archive.rust-lang.org/stream/238009-t-compiler/meetings/topic/.5Bweekly.5D.202021-08-12.20.2354818.html#249249212">(Aug 12 2021 at 15:21)</a>:</h4>
<p>I mean, yeah, but you can also "just" use tuples etc.</p>



<a name="249249219"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/238009-t-compiler/meetings/topic/%5Bweekly%5D%202021-08-12%20%2354818/near/249249219" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pnkfelix <a href="https://zulip-archive.rust-lang.org/stream/238009-t-compiler/meetings/topic/.5Bweekly.5D.202021-08-12.20.2354818.html#249249219">(Aug 12 2021 at 15:21)</a>:</h4>
<p>just to keep pulling at this thread: the logic you’re working through here also implies that the “R” for &amp;value and “Q” for &amp;mut value are unncessary too, right?</p>



<a name="249249297"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/238009-t-compiler/meetings/topic/%5Bweekly%5D%202021-08-12%20%2354818/near/249249297" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> eddyb <a href="https://zulip-archive.rust-lang.org/stream/238009-t-compiler/meetings/topic/.5Bweekly.5D.202021-08-12.20.2354818.html#249249297">(Aug 12 2021 at 15:22)</a>:</h4>
<p>you don't even need nesting, if you go far enough</p>



<a name="249249342"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/238009-t-compiler/meetings/topic/%5Bweekly%5D%202021-08-12%20%2354818/near/249249342" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> eddyb <a href="https://zulip-archive.rust-lang.org/stream/238009-t-compiler/meetings/topic/.5Bweekly.5D.202021-08-12.20.2354818.html#249249342">(Aug 12 2021 at 15:22)</a>:</h4>
<p>just a flat list of integer/<code>str</code> leaves</p>



<a name="249249353"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/238009-t-compiler/meetings/topic/%5Bweekly%5D%202021-08-12%20%2354818/near/249249353" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pnkfelix <a href="https://zulip-archive.rust-lang.org/stream/238009-t-compiler/meetings/topic/.5Bweekly.5D.202021-08-12.20.2354818.html#249249353">(Aug 12 2021 at 15:22)</a>:</h4>
<p>right, okay</p>



<a name="249249468"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/238009-t-compiler/meetings/topic/%5Bweekly%5D%202021-08-12%20%2354818/near/249249468" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> eddyb <a href="https://zulip-archive.rust-lang.org/stream/238009-t-compiler/meetings/topic/.5Bweekly.5D.202021-08-12.20.2354818.html#249249468">(Aug 12 2021 at 15:23)</a>:</h4>
<p>I don't have strong opinions, other than I would like <code>v0</code> to become the default without me having to justify more time away from more-Rust-GPU-specific things :P</p>



<a name="249249535"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/238009-t-compiler/meetings/topic/%5Bweekly%5D%202021-08-12%20%2354818/near/249249535" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> mw <a href="https://zulip-archive.rust-lang.org/stream/238009-t-compiler/meetings/topic/.5Bweekly.5D.202021-08-12.20.2354818.html#249249535">(Aug 12 2021 at 15:24)</a>:</h4>
<p>yes, I'd say let's revisit once const generics get stabilized</p>



<a name="249249589"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/238009-t-compiler/meetings/topic/%5Bweekly%5D%202021-08-12%20%2354818/near/249249589" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> eddyb <a href="https://zulip-archive.rust-lang.org/stream/238009-t-compiler/meetings/topic/.5Bweekly.5D.202021-08-12.20.2354818.html#249249589">(Aug 12 2021 at 15:24)</a>:</h4>
<p>(or are anywhere close to)</p>



<a name="249249612"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/238009-t-compiler/meetings/topic/%5Bweekly%5D%202021-08-12%20%2354818/near/249249612" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> mw <a href="https://zulip-archive.rust-lang.org/stream/238009-t-compiler/meetings/topic/.5Bweekly.5D.202021-08-12.20.2354818.html#249249612">(Aug 12 2021 at 15:24)</a>:</h4>
<p>yes</p>



<a name="249249616"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/238009-t-compiler/meetings/topic/%5Bweekly%5D%202021-08-12%20%2354818/near/249249616" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pnkfelix <a href="https://zulip-archive.rust-lang.org/stream/238009-t-compiler/meetings/topic/.5Bweekly.5D.202021-08-12.20.2354818.html#249249616">(Aug 12 2021 at 15:24)</a>:</h4>
<p>having an easy way for someone to opt into one choice or the other (flattened vs tree) would be nice</p>



<a name="249249634"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/238009-t-compiler/meetings/topic/%5Bweekly%5D%202021-08-12%20%2354818/near/249249634" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> eddyb <a href="https://zulip-archive.rust-lang.org/stream/238009-t-compiler/meetings/topic/.5Bweekly.5D.202021-08-12.20.2354818.html#249249634">(Aug 12 2021 at 15:24)</a>:</h4>
<p>ideally we have this sorted out before the stabilization button is pushed</p>



<a name="249249725"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/238009-t-compiler/meetings/topic/%5Bweekly%5D%202021-08-12%20%2354818/near/249249725" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> mw <a href="https://zulip-archive.rust-lang.org/stream/238009-t-compiler/meetings/topic/.5Bweekly.5D.202021-08-12.20.2354818.html#249249725">(Aug 12 2021 at 15:25)</a>:</h4>
<p><span class="user-mention silent" data-user-id="116083">pnkfelix</span> <a href="#narrow/stream/238009-t-compiler.2Fmeetings/topic/.5Bweekly.5D.202021-08-12.20.2354818/near/249249616">said</a>:</p>
<blockquote>
<p>having an easy way for someone to opt into one choice or the other (flattened vs tree) would be nice</p>
</blockquote>
<p>I think that's doable</p>



<a name="249249829"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/238009-t-compiler/meetings/topic/%5Bweekly%5D%202021-08-12%20%2354818/near/249249829" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> eddyb <a href="https://zulip-archive.rust-lang.org/stream/238009-t-compiler/meetings/topic/.5Bweekly.5D.202021-08-12.20.2354818.html#249249829">(Aug 12 2021 at 15:25)</a>:</h4>
<p>we can literally just dump out a big tuple or array, using the "fancy" encoding, but in a limited fashion</p>



<a name="249249874"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/238009-t-compiler/meetings/topic/%5Bweekly%5D%202021-08-12%20%2354818/near/249249874" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> eddyb <a href="https://zulip-archive.rust-lang.org/stream/238009-t-compiler/meetings/topic/.5Bweekly.5D.202021-08-12.20.2354818.html#249249874">(Aug 12 2021 at 15:25)</a>:</h4>
<p>in a sense, the mangling grammar is like a tiny subset of Rust ASTs, I guess</p>



<a name="249250084"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/238009-t-compiler/meetings/topic/%5Bweekly%5D%202021-08-12%20%2354818/near/249250084" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> eddyb <a href="https://zulip-archive.rust-lang.org/stream/238009-t-compiler/meetings/topic/.5Bweekly.5D.202021-08-12.20.2354818.html#249250084">(Aug 12 2021 at 15:27)</a>:</h4>
<p>if people want the absolute minimum, we could also try to find a way to flatten a constant tree into a single bitstream that we then encode in base 62 (instead of hex), there'd just not be any good way to get much out of it :P</p>



<a name="249250135"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/238009-t-compiler/meetings/topic/%5Bweekly%5D%202021-08-12%20%2354818/near/249250135" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> eddyb <a href="https://zulip-archive.rust-lang.org/stream/238009-t-compiler/meetings/topic/.5Bweekly.5D.202021-08-12.20.2354818.html#249250135">(Aug 12 2021 at 15:27)</a>:</h4>
<p>(like, we can add an alternative to <code>K</code> that's "const generic argument, compact")</p>



<a name="249250151"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/238009-t-compiler/meetings/topic/%5Bweekly%5D%202021-08-12%20%2354818/near/249250151" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> mw <a href="https://zulip-archive.rust-lang.org/stream/238009-t-compiler/meetings/topic/.5Bweekly.5D.202021-08-12.20.2354818.html#249250151">(Aug 12 2021 at 15:27)</a>:</h4>
<p>At that point we can just start introducing hashes again :)</p>



<a name="249250241"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/238009-t-compiler/meetings/topic/%5Bweekly%5D%202021-08-12%20%2354818/near/249250241" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> eddyb <a href="https://zulip-archive.rust-lang.org/stream/238009-t-compiler/meetings/topic/.5Bweekly.5D.202021-08-12.20.2354818.html#249250241">(Aug 12 2021 at 15:28)</a>:</h4>
<p>nope, all the data is there, so it's still isomorphic :P</p>



<a name="249250432"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/238009-t-compiler/meetings/topic/%5Bweekly%5D%202021-08-12%20%2354818/near/249250432" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> mw <a href="https://zulip-archive.rust-lang.org/stream/238009-t-compiler/meetings/topic/.5Bweekly.5D.202021-08-12.20.2354818.html#249250432">(Aug 12 2021 at 15:30)</a>:</h4>
<p>we can add a side note about a "sufficiently smart demangler" to the RFC <span aria-label="+1" class="emoji emoji-1f44d" role="img" title="+1">:+1:</span></p>



<a name="249250570"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/238009-t-compiler/meetings/topic/%5Bweekly%5D%202021-08-12%20%2354818/near/249250570" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> eddyb <a href="https://zulip-archive.rust-lang.org/stream/238009-t-compiler/meetings/topic/.5Bweekly.5D.202021-08-12.20.2354818.html#249250570">(Aug 12 2021 at 15:30)</a>:</h4>
<p><span class="user-mention" data-user-id="124287">@mw</span> <span class="user-mention" data-user-id="116083">@pnkfelix</span> anyway, I gtg, but thank you so much for indulging this, it really helped!</p>



<a name="249250659"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/238009-t-compiler/meetings/topic/%5Bweekly%5D%202021-08-12%20%2354818/near/249250659" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> mw <a href="https://zulip-archive.rust-lang.org/stream/238009-t-compiler/meetings/topic/.5Bweekly.5D.202021-08-12.20.2354818.html#249250659">(Aug 12 2021 at 15:31)</a>:</h4>
<p>Thanks for all the work you're putting into this, <span class="user-mention" data-user-id="119009">@eddyb</span>!</p>



<a name="249250689"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/238009-t-compiler/meetings/topic/%5Bweekly%5D%202021-08-12%20%2354818/near/249250689" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pnkfelix <a href="https://zulip-archive.rust-lang.org/stream/238009-t-compiler/meetings/topic/.5Bweekly.5D.202021-08-12.20.2354818.html#249250689">(Aug 12 2021 at 15:31)</a>:</h4>
<p><span class="user-mention" data-user-id="119009">@eddyb</span> hey, wait: Can consts be graph structured?</p>



<a name="249250771"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/238009-t-compiler/meetings/topic/%5Bweekly%5D%202021-08-12%20%2354818/near/249250771" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> eddyb <a href="https://zulip-archive.rust-lang.org/stream/238009-t-compiler/meetings/topic/.5Bweekly.5D.202021-08-12.20.2354818.html#249250771">(Aug 12 2021 at 15:32)</a>:</h4>
<p>nope, they have to behave like type constructors</p>



<a name="249250779"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/238009-t-compiler/meetings/topic/%5Bweekly%5D%202021-08-12%20%2354818/near/249250779" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pnkfelix <a href="https://zulip-archive.rust-lang.org/stream/238009-t-compiler/meetings/topic/.5Bweekly.5D.202021-08-12.20.2354818.html#249250779">(Aug 12 2021 at 15:32)</a>:</h4>
<p>Okay</p>



<a name="249250799"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/238009-t-compiler/meetings/topic/%5Bweekly%5D%202021-08-12%20%2354818/near/249250799" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> eddyb <a href="https://zulip-archive.rust-lang.org/stream/238009-t-compiler/meetings/topic/.5Bweekly.5D.202021-08-12.20.2354818.html#249250799">(Aug 12 2021 at 15:32)</a>:</h4>
<p>so there should be no travesal that can descend infinitely or anything</p>



<a name="249250868"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/238009-t-compiler/meetings/topic/%5Bweekly%5D%202021-08-12%20%2354818/near/249250868" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pnkfelix <a href="https://zulip-archive.rust-lang.org/stream/238009-t-compiler/meetings/topic/.5Bweekly.5D.202021-08-12.20.2354818.html#249250868">(Aug 12 2021 at 15:33)</a>:</h4>
<p>right. I was worried about 1. infinite traversal but also 2. exponential blowup via shared in an directed acyclic graph</p>



<a name="249250880"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/238009-t-compiler/meetings/topic/%5Bweekly%5D%202021-08-12%20%2354818/near/249250880" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> eddyb <a href="https://zulip-archive.rust-lang.org/stream/238009-t-compiler/meetings/topic/.5Bweekly.5D.202021-08-12.20.2354818.html#249250880">(Aug 12 2021 at 15:33)</a>:</h4>
<p><span class="user-mention" data-user-id="124288">@oli</span>'s "valtree" work cements this deeper by not using miri allocations from the typesystem, but instead a pure representation of value constructors and their children</p>



<a name="249250949"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/238009-t-compiler/meetings/topic/%5Bweekly%5D%202021-08-12%20%2354818/near/249250949" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> eddyb <a href="https://zulip-archive.rust-lang.org/stream/238009-t-compiler/meetings/topic/.5Bweekly.5D.202021-08-12.20.2354818.html#249250949">(Aug 12 2021 at 15:33)</a>:</h4>
<p><span class="user-mention silent" data-user-id="116083">pnkfelix</span> <a href="#narrow/stream/238009-t-compiler.2Fmeetings/topic/.5Bweekly.5D.202021-08-12.20.2354818/near/249250868">said</a>:</p>
<blockquote>
<p>right. I was worried about 1. infinite traversal but also 2. exponential blowup via shared in an directed acyclic graph</p>
</blockquote>
<p>ah because sharing gets optimized today?</p>



<a name="249250989"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/238009-t-compiler/meetings/topic/%5Bweekly%5D%202021-08-12%20%2354818/near/249250989" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> eddyb <a href="https://zulip-archive.rust-lang.org/stream/238009-t-compiler/meetings/topic/.5Bweekly.5D.202021-08-12.20.2354818.html#249250989">(Aug 12 2021 at 15:33)</a>:</h4>
<p>anyway, bbl</p>



<a name="249250995"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/238009-t-compiler/meetings/topic/%5Bweekly%5D%202021-08-12%20%2354818/near/249250995" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pnkfelix <a href="https://zulip-archive.rust-lang.org/stream/238009-t-compiler/meetings/topic/.5Bweekly.5D.202021-08-12.20.2354818.html#249250995">(Aug 12 2021 at 15:34)</a>:</h4>
<p>later</p>



<a name="249255901"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/238009-t-compiler/meetings/topic/%5Bweekly%5D%202021-08-12%20%2354818/near/249255901" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> apiraino <a href="https://zulip-archive.rust-lang.org/stream/238009-t-compiler/meetings/topic/.5Bweekly.5D.202021-08-12.20.2354818.html#249255901">(Aug 12 2021 at 16:14)</a>:</h4>
<p>Draft for next week's agenda is available at:<br>
<a href="https://hackmd.io/VNIxtjGBT8Owfkb92Vzt6w?view">https://hackmd.io/VNIxtjGBT8Owfkb92Vzt6w?view</a></p>
<p>Scheduled checkins from:</p>
<ul>
<li><span class="user-group-mention" data-user-group-id="1123">@WG-self-profile</span>  by <span class="user-mention" data-user-id="124287">@mw</span>  <span class="user-mention" data-user-id="125250">@Wesley Wiser</span>  (<a href="https://hackmd.io/tuLB5d6ETKCZGS3cpzzRiA#WG-checkins">latest checkin</a>)</li>
</ul>



<a name="249264076"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/238009-t-compiler/meetings/topic/%5Bweekly%5D%202021-08-12%20%2354818/near/249264076" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Aman Arora <a href="https://zulip-archive.rust-lang.org/stream/238009-t-compiler/meetings/topic/.5Bweekly.5D.202021-08-12.20.2354818.html#249264076">(Aug 12 2021 at 17:17)</a>:</h4>
<p>Sorry I missed the update wg-2229 had to provide, for some reason I thought that was next week.</p>
<p>We have mostly been working mostly just been on bug fixes as more people try 2021 edition.</p>



<a name="249992946"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/238009-t-compiler/meetings/topic/%5Bweekly%5D%202021-08-12%20%2354818/near/249992946" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pnkfelix <a href="https://zulip-archive.rust-lang.org/stream/238009-t-compiler/meetings/topic/.5Bweekly.5D.202021-08-12.20.2354818.html#249992946">(Aug 19 2021 at 14:17)</a>:</h4>
<p>(deleted)</p>



<hr><p>Last updated: Apr 12 2022 at 20:01 UTC</p>
</html>