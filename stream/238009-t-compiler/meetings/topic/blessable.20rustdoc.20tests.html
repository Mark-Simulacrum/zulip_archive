<html>
<head><meta charset="utf-8"><title>blessable rustdoc tests · t-compiler/meetings · Zulip Chat Archive</title></head>
<h2>Stream: <a href="https://zulip-archive.rust-lang.org/stream/238009-t-compiler/meetings/index.html">t-compiler/meetings</a></h2>
<h3>Topic: <a href="https://zulip-archive.rust-lang.org/stream/238009-t-compiler/meetings/topic/blessable.20rustdoc.20tests.html">blessable rustdoc tests</a></h3>

<hr>

<base href="https://rust-lang.zulipchat.com">

<head><link href="https://zulip-archive.rust-lang.org/style.css" rel="stylesheet"></head>

<a name="250940988"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/238009-t-compiler/meetings/topic/blessable%20rustdoc%20tests/near/250940988" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Nelson <a href="https://zulip-archive.rust-lang.org/stream/238009-t-compiler/meetings/topic/blessable.20rustdoc.20tests.html#250940988">(Aug 27 2021 at 14:37)</a>:</h4>
<p><span class="user-mention" data-user-id="124288">@oli</span> <span class="user-mention" data-user-id="210316">@GuillaumeGomez</span> let's move discussion here</p>



<a name="250941304"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/238009-t-compiler/meetings/topic/blessable%20rustdoc%20tests/near/250941304" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> GuillaumeGomez <a href="https://zulip-archive.rust-lang.org/stream/238009-t-compiler/meetings/topic/blessable.20rustdoc.20tests.html#250941304">(Aug 27 2021 at 14:39)</a>:</h4>
<p>Just to sum up things:</p>
<ul>
<li><code>tests/rustdoc</code> aren't blessable</li>
<li><code>tests/rustdoc-ui</code> are blessable and very much like the "normal" ui tests</li>
</ul>
<p>What we want here is to have a way to check the generated output from ast_pretty and a way (blessable?) to check what is generated from these functions.</p>
<p>Did I miss something?</p>



<a name="251058120"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/238009-t-compiler/meetings/topic/blessable%20rustdoc%20tests/near/251058120" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Nelson <a href="https://zulip-archive.rust-lang.org/stream/238009-t-compiler/meetings/topic/blessable.20rustdoc.20tests.html#251058120">(Aug 28 2021 at 13:59)</a>:</h4>
<p>I don't understand how this is possible, though. The checks in src/test/rustdoc are error annotations, not the output itself. It's <em>intentional</em> you have to manually update them so they don't change by accident.</p>



<a name="251061861"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/238009-t-compiler/meetings/topic/blessable%20rustdoc%20tests/near/251061861" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> oli <a href="https://zulip-archive.rust-lang.org/stream/238009-t-compiler/meetings/topic/blessable.20rustdoc.20tests.html#251061861">(Aug 28 2021 at 15:05)</a>:</h4>
<p>can we start out by using some -Z flag in a regular ui test that dumps the ast_pretty?</p>



<a name="251061920"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/238009-t-compiler/meetings/topic/blessable%20rustdoc%20tests/near/251061920" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Nelson <a href="https://zulip-archive.rust-lang.org/stream/238009-t-compiler/meetings/topic/blessable.20rustdoc.20tests.html#251061920">(Aug 28 2021 at 15:06)</a>:</h4>
<p>how would that help?</p>



<a name="251061934"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/238009-t-compiler/meetings/topic/blessable%20rustdoc%20tests/near/251061934" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> oli <a href="https://zulip-archive.rust-lang.org/stream/238009-t-compiler/meetings/topic/blessable.20rustdoc.20tests.html#251061934">(Aug 28 2021 at 15:06)</a>:</h4>
<p>blessing will put that dump into a .stdout file, and T-rustdoc can get notified on changes to these tests</p>



<a name="251061941"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/238009-t-compiler/meetings/topic/blessable%20rustdoc%20tests/near/251061941" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Nelson <a href="https://zulip-archive.rust-lang.org/stream/238009-t-compiler/meetings/topic/blessable.20rustdoc.20tests.html#251061941">(Aug 28 2021 at 15:07)</a>:</h4>
<p>ah ok - sure, that seems reasonable</p>



<a name="252318803"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/238009-t-compiler/meetings/topic/blessable%20rustdoc%20tests/near/252318803" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pnkfelix <a href="https://zulip-archive.rust-lang.org/stream/238009-t-compiler/meetings/topic/blessable.20rustdoc.20tests.html#252318803">(Sep 07 2021 at 14:57)</a>:</h4>
<p><span class="user-mention silent" data-user-id="232545">Joshua Nelson</span> <a href="#narrow/stream/238009-t-compiler.2Fmeetings/topic/blessable.20rustdoc.20tests/near/251058120">said</a>:</p>
<blockquote>
<p>It's <em>intentional</em> you have to manually update them so they don't change by accident.</p>
</blockquote>
<p>Putting on my “pedantic” hat: I’d say that its intentional for all tests, even blessable ones, that they don’t change by accident. Just because we provide an easier path for updates doesn’t mean that we intend for it to be an automatic process (though I admit that it ends up being somewhat automatic in practice, what with rubber-stamp r+ approvals in many cases).</p>



<a name="252319294"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/238009-t-compiler/meetings/topic/blessable%20rustdoc%20tests/near/252319294" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pnkfelix <a href="https://zulip-archive.rust-lang.org/stream/238009-t-compiler/meetings/topic/blessable.20rustdoc.20tests.html#252319294">(Sep 07 2021 at 15:00)</a>:</h4>
<p>In most cases where one cannot “bless”, I’d say its due to tooling limitations (e.g. not wanting to hack something up that goes in and automatically editting source files to add <code>//~ERROR</code> lines), because we assume that humans will do a better job of deciding what to put in there.</p>



<hr><p>Last updated: Apr 12 2022 at 20:01 UTC</p>
</html>