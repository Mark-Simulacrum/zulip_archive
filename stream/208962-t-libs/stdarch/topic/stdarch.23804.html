<html>
<head><meta charset="utf-8"><title>stdarch#804 · t-libs/stdarch · Zulip Chat Archive</title></head>
<h2>Stream: <a href="https://zulip-archive.rust-lang.org/stream/208962-t-libs/stdarch/index.html">t-libs/stdarch</a></h2>
<h3>Topic: <a href="https://zulip-archive.rust-lang.org/stream/208962-t-libs/stdarch/topic/stdarch.23804.html">stdarch#804</a></h3>

<hr>

<base href="https://rust-lang.zulipchat.com">

<head><link href="https://zulip-archive.rust-lang.org/style.css" rel="stylesheet"></head>

<a name="175907088"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/208962-t-libs/stdarch/topic/stdarch%23804/near/175907088" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Luca Barbato <a href="https://zulip-archive.rust-lang.org/stream/208962-t-libs/stdarch/topic/stdarch.23804.html#175907088">(Sep 17 2019 at 13:43)</a>:</h4>
<p>Here the first draft <a href="https://github.com/rust-lang/stdarch/issues/808" target="_blank" title="https://github.com/rust-lang/stdarch/issues/808">stdarch#808</a> I tested it and seems working as intended</p>



<a name="175912655"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/208962-t-libs/stdarch/topic/stdarch%23804/near/175912655" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Luca Barbato <a href="https://zulip-archive.rust-lang.org/stream/208962-t-libs/stdarch/topic/stdarch.23804.html#175912655">(Sep 17 2019 at 14:40)</a>:</h4>
<p>I wonder if would be fine to conflate the feature with file_io</p>



<a name="175915003"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/208962-t-libs/stdarch/topic/stdarch%23804/near/175915003" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> gnzlbg <a href="https://zulip-archive.rust-lang.org/stream/208962-t-libs/stdarch/topic/stdarch.23804.html#175915003">(Sep 17 2019 at 15:02)</a>:</h4>
<p>I prefer to keep them separate</p>



<a name="175915040"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/208962-t-libs/stdarch/topic/stdarch%23804/near/175915040" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> gnzlbg <a href="https://zulip-archive.rust-lang.org/stream/208962-t-libs/stdarch/topic/stdarch.23804.html#175915040">(Sep 17 2019 at 15:03)</a>:</h4>
<p>Also this thread has the wrong topic</p>



<a name="175918833"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/208962-t-libs/stdarch/topic/stdarch%23804/near/175918833" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Luca Barbato <a href="https://zulip-archive.rust-lang.org/stream/208962-t-libs/stdarch/topic/stdarch.23804.html#175918833">(Sep 17 2019 at 15:38)</a>:</h4>
<p>Ok... there is something fishy going with the cupid test</p>



<a name="175918881"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/208962-t-libs/stdarch/topic/stdarch%23804/near/175918881" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Luca Barbato <a href="https://zulip-archive.rust-lang.org/stream/208962-t-libs/stdarch/topic/stdarch.23804.html#175918881">(Sep 17 2019 at 15:39)</a>:</h4>
<p>I tried to use the env-var with the cupid test, avx2 gets disabled correctly, while sse2 stays on no matter what.</p>



<a name="175919017"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/208962-t-libs/stdarch/topic/stdarch%23804/near/175919017" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Luca Barbato <a href="https://zulip-archive.rust-lang.org/stream/208962-t-libs/stdarch/topic/stdarch.23804.html#175919017">(Sep 17 2019 at 15:40)</a>:</h4>
<p>do you see any reason why it should?</p>



<a name="175919058"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/208962-t-libs/stdarch/topic/stdarch%23804/near/175919058" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> gnzlbg <a href="https://zulip-archive.rust-lang.org/stream/208962-t-libs/stdarch/topic/stdarch.23804.html#175919058">(Sep 17 2019 at 15:40)</a>:</h4>
<p>you can't disable sse2</p>



<a name="175919063"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/208962-t-libs/stdarch/topic/stdarch%23804/near/175919063" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> gnzlbg <a href="https://zulip-archive.rust-lang.org/stream/208962-t-libs/stdarch/topic/stdarch.23804.html#175919063">(Sep 17 2019 at 15:40)</a>:</h4>
<p>its enabled at compile-time</p>



<a name="175919083"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/208962-t-libs/stdarch/topic/stdarch%23804/near/175919083" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Luca Barbato <a href="https://zulip-archive.rust-lang.org/stream/208962-t-libs/stdarch/topic/stdarch.23804.html#175919083">(Sep 17 2019 at 15:41)</a>:</h4>
<p>Ah, ok, so it is working as intended</p>



<a name="175919097"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/208962-t-libs/stdarch/topic/stdarch%23804/near/175919097" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> gnzlbg <a href="https://zulip-archive.rust-lang.org/stream/208962-t-libs/stdarch/topic/stdarch.23804.html#175919097">(Sep 17 2019 at 15:41)</a>:</h4>
<p>you can only disable at run-time features that are not enabled for the target at compile-time</p>



<a name="175919128"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/208962-t-libs/stdarch/topic/stdarch%23804/near/175919128" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> gnzlbg <a href="https://zulip-archive.rust-lang.org/stream/208962-t-libs/stdarch/topic/stdarch.23804.html#175919128">(Sep 17 2019 at 15:41)</a>:</h4>
<p>yes that sounds right</p>



<a name="175919150"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/208962-t-libs/stdarch/topic/stdarch%23804/near/175919150" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> gnzlbg <a href="https://zulip-archive.rust-lang.org/stream/208962-t-libs/stdarch/topic/stdarch.23804.html#175919150">(Sep 17 2019 at 15:41)</a>:</h4>
<p>you can move messages here across threads</p>



<a name="175919168"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/208962-t-libs/stdarch/topic/stdarch%23804/near/175919168" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> gnzlbg <a href="https://zulip-archive.rust-lang.org/stream/208962-t-libs/stdarch/topic/stdarch.23804.html#175919168">(Sep 17 2019 at 15:42)</a>:</h4>
<p>by clicking on the message, and changing its thread</p>



<a name="175919230"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/208962-t-libs/stdarch/topic/stdarch%23804/near/175919230" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> gnzlbg <a href="https://zulip-archive.rust-lang.org/stream/208962-t-libs/stdarch/topic/stdarch.23804.html#175919230">(Sep 17 2019 at 15:42)</a>:</h4>
<p>happens quite often that one answers in the wrong thread</p>



<a name="175919241"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/208962-t-libs/stdarch/topic/stdarch%23804/near/175919241" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Luca Barbato <a href="https://zulip-archive.rust-lang.org/stream/208962-t-libs/stdarch/topic/stdarch.23804.html#175919241">(Sep 17 2019 at 15:42)</a>:</h4>
<p>:)</p>



<a name="175919256"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/208962-t-libs/stdarch/topic/stdarch%23804/near/175919256" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Luca Barbato <a href="https://zulip-archive.rust-lang.org/stream/208962-t-libs/stdarch/topic/stdarch.23804.html#175919256">(Sep 17 2019 at 15:42)</a>:</h4>
<p>I'm liking zulip more and more</p>



<a name="175919266"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/208962-t-libs/stdarch/topic/stdarch%23804/near/175919266" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Luca Barbato <a href="https://zulip-archive.rust-lang.org/stream/208962-t-libs/stdarch/topic/stdarch.23804.html#175919266">(Sep 17 2019 at 15:42)</a>:</h4>
<p>so, how to make a test that works for sure?</p>



<a name="175919302"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/208962-t-libs/stdarch/topic/stdarch%23804/near/175919302" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Luca Barbato <a href="https://zulip-archive.rust-lang.org/stream/208962-t-libs/stdarch/topic/stdarch.23804.html#175919302">(Sep 17 2019 at 15:43)</a>:</h4>
<p>run the cuvid test and expect it to fail?</p>



<a name="175919313"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/208962-t-libs/stdarch/topic/stdarch%23804/near/175919313" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> gnzlbg <a href="https://zulip-archive.rust-lang.org/stream/208962-t-libs/stdarch/topic/stdarch.23804.html#175919313">(Sep 17 2019 at 15:43)</a>:</h4>
<p>create a new build job, for x86_64</p>



<a name="175919317"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/208962-t-libs/stdarch/topic/stdarch%23804/near/175919317" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Luca Barbato <a href="https://zulip-archive.rust-lang.org/stream/208962-t-libs/stdarch/topic/stdarch.23804.html#175919317">(Sep 17 2019 at 15:43)</a>:</h4>
<p>we need to override the env outside the test runner</p>



<a name="175919323"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/208962-t-libs/stdarch/topic/stdarch%23804/near/175919323" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> gnzlbg <a href="https://zulip-archive.rust-lang.org/stream/208962-t-libs/stdarch/topic/stdarch.23804.html#175919323">(Sep 17 2019 at 15:43)</a>:</h4>
<p>and disable, e.g., AVX using an environment variable</p>



<a name="175919355"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/208962-t-libs/stdarch/topic/stdarch%23804/near/175919355" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> gnzlbg <a href="https://zulip-archive.rust-lang.org/stream/208962-t-libs/stdarch/topic/stdarch.23804.html#175919355">(Sep 17 2019 at 15:43)</a>:</h4>
<p>then just go to std_detect, and run cargo test my_test</p>



<a name="175919427"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/208962-t-libs/stdarch/topic/stdarch%23804/near/175919427" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Luca Barbato <a href="https://zulip-archive.rust-lang.org/stream/208962-t-libs/stdarch/topic/stdarch.23804.html#175919427">(Sep 17 2019 at 15:44)</a>:</h4>
<p>uhm can you point me to the file?</p>



<a name="175919467"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/208962-t-libs/stdarch/topic/stdarch%23804/near/175919467" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> gnzlbg <a href="https://zulip-archive.rust-lang.org/stream/208962-t-libs/stdarch/topic/stdarch.23804.html#175919467">(Sep 17 2019 at 15:44)</a>:</h4>
<p>ci/azure.yml for a new build job</p>



<a name="175919502"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/208962-t-libs/stdarch/topic/stdarch%23804/near/175919502" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> gnzlbg <a href="https://zulip-archive.rust-lang.org/stream/208962-t-libs/stdarch/topic/stdarch.23804.html#175919502">(Sep 17 2019 at 15:44)</a>:</h4>
<p>and maybe add a shell script to ci, e.g. ci/std_detect_env_override.sh that implements the test</p>



<a name="175919537"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/208962-t-libs/stdarch/topic/stdarch%23804/near/175919537" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> gnzlbg <a href="https://zulip-archive.rust-lang.org/stream/208962-t-libs/stdarch/topic/stdarch.23804.html#175919537">(Sep 17 2019 at 15:45)</a>:</h4>
<p>you can then just add a normal test to std_detect/tests/env_override.rs</p>



<a name="175919555"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/208962-t-libs/stdarch/topic/stdarch%23804/near/175919555" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Luca Barbato <a href="https://zulip-archive.rust-lang.org/stream/208962-t-libs/stdarch/topic/stdarch.23804.html#175919555">(Sep 17 2019 at 15:45)</a>:</h4>
<p>can I copy   - job: AutomaticVerification ?</p>



<a name="175919593"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/208962-t-libs/stdarch/topic/stdarch%23804/near/175919593" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> gnzlbg <a href="https://zulip-archive.rust-lang.org/stream/208962-t-libs/stdarch/topic/stdarch.23804.html#175919593">(Sep 17 2019 at 15:45)</a>:</h4>
<p>and that test should check the cfg(feature = "env override"), and check the env:: that AVX is disabled, and then check that is_x86_feature_detected!("avx") returns false, but that "avx2" is true</p>



<a name="175919619"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/208962-t-libs/stdarch/topic/stdarch%23804/near/175919619" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> gnzlbg <a href="https://zulip-archive.rust-lang.org/stream/208962-t-libs/stdarch/topic/stdarch.23804.html#175919619">(Sep 17 2019 at 15:46)</a>:</h4>
<p>you probably want to copy the Linux docker</p>



<a name="175919680"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/208962-t-libs/stdarch/topic/stdarch%23804/near/175919680" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> gnzlbg <a href="https://zulip-archive.rust-lang.org/stream/208962-t-libs/stdarch/topic/stdarch.23804.html#175919680">(Sep 17 2019 at 15:46)</a>:</h4>
<p>and in the stragegy matrix just leave x86_64-uknown-linux-gnu</p>



<a name="175919722"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/208962-t-libs/stdarch/topic/stdarch%23804/near/175919722" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> gnzlbg <a href="https://zulip-archive.rust-lang.org/stream/208962-t-libs/stdarch/topic/stdarch.23804.html#175919722">(Sep 17 2019 at 15:46)</a>:</h4>
<p>write the script locally, and then adding the build job is not a big deal at the end</p>



<a name="175919742"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/208962-t-libs/stdarch/topic/stdarch%23804/near/175919742" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> gnzlbg <a href="https://zulip-archive.rust-lang.org/stream/208962-t-libs/stdarch/topic/stdarch.23804.html#175919742">(Sep 17 2019 at 15:47)</a>:</h4>
<p>i'll comment in the PR about how to add it</p>



<a name="175920609"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/208962-t-libs/stdarch/topic/stdarch%23804/near/175920609" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Luca Barbato <a href="https://zulip-archive.rust-lang.org/stream/208962-t-libs/stdarch/topic/stdarch.23804.html#175920609">(Sep 17 2019 at 15:56)</a>:</h4>
<p>Test prepared</p>



<a name="175937968"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/208962-t-libs/stdarch/topic/stdarch%23804/near/175937968" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Luca Barbato <a href="https://zulip-archive.rust-lang.org/stream/208962-t-libs/stdarch/topic/stdarch.23804.html#175937968">(Sep 17 2019 at 19:00)</a>:</h4>
<p>Ouch</p>



<a name="175937997"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/208962-t-libs/stdarch/topic/stdarch%23804/near/175937997" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Luca Barbato <a href="https://zulip-archive.rust-lang.org/stream/208962-t-libs/stdarch/topic/stdarch.23804.html#175937997">(Sep 17 2019 at 19:00)</a>:</h4>
<p>I typoed a push ...</p>



<a name="175938030"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/208962-t-libs/stdarch/topic/stdarch%23804/near/175938030" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Luca Barbato <a href="https://zulip-archive.rust-lang.org/stream/208962-t-libs/stdarch/topic/stdarch.23804.html#175938030">(Sep 17 2019 at 19:00)</a>:</h4>
<p>Is ok to undo?</p>



<a name="175938117"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/208962-t-libs/stdarch/topic/stdarch%23804/near/175938117" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> gnzlbg <a href="https://zulip-archive.rust-lang.org/stream/208962-t-libs/stdarch/topic/stdarch.23804.html#175938117">(Sep 17 2019 at 19:01)</a>:</h4>
<p>I've commented onthe branch</p>



<a name="175938127"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/208962-t-libs/stdarch/topic/stdarch%23804/near/175938127" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> gnzlbg <a href="https://zulip-archive.rust-lang.org/stream/208962-t-libs/stdarch/topic/stdarch.23804.html#175938127">(Sep 17 2019 at 19:01)</a>:</h4>
<p>don't worry, it happens</p>



<a name="175938141"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/208962-t-libs/stdarch/topic/stdarch%23804/near/175938141" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> gnzlbg <a href="https://zulip-archive.rust-lang.org/stream/208962-t-libs/stdarch/topic/stdarch.23804.html#175938141">(Sep 17 2019 at 19:01)</a>:</h4>
<p>just create a new branch</p>



<a name="175938151"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/208962-t-libs/stdarch/topic/stdarch%23804/near/175938151" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> gnzlbg <a href="https://zulip-archive.rust-lang.org/stream/208962-t-libs/stdarch/topic/stdarch.23804.html#175938151">(Sep 17 2019 at 19:02)</a>:</h4>
<p>fix things, and open a new PR</p>



<a name="175938223"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/208962-t-libs/stdarch/topic/stdarch%23804/near/175938223" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> gnzlbg <a href="https://zulip-archive.rust-lang.org/stream/208962-t-libs/stdarch/topic/stdarch.23804.html#175938223">(Sep 17 2019 at 19:02)</a>:</h4>
<p>don't force push to master</p>



<a name="175938224"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/208962-t-libs/stdarch/topic/stdarch%23804/near/175938224" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> gnzlbg <a href="https://zulip-archive.rust-lang.org/stream/208962-t-libs/stdarch/topic/stdarch.23804.html#175938224">(Sep 17 2019 at 19:02)</a>:</h4>
<p>ever</p>



<a name="175938274"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/208962-t-libs/stdarch/topic/stdarch%23804/near/175938274" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> gnzlbg <a href="https://zulip-archive.rust-lang.org/stream/208962-t-libs/stdarch/topic/stdarch.23804.html#175938274">(Sep 17 2019 at 19:03)</a>:</h4>
<p>as in, don't try to undo things with a force push</p>



<a name="175938410"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/208962-t-libs/stdarch/topic/stdarch%23804/near/175938410" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Luca Barbato <a href="https://zulip-archive.rust-lang.org/stream/208962-t-libs/stdarch/topic/stdarch.23804.html#175938410">(Sep 17 2019 at 19:04)</a>:</h4>
<p>In theory IF I amended correctly the branch pushed is fine.</p>



<a name="175938453"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/208962-t-libs/stdarch/topic/stdarch%23804/near/175938453" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> gnzlbg <a href="https://zulip-archive.rust-lang.org/stream/208962-t-libs/stdarch/topic/stdarch.23804.html#175938453">(Sep 17 2019 at 19:05)</a>:</h4>
<p>you'd need to rebase the branch I think</p>



<a name="175938460"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/208962-t-libs/stdarch/topic/stdarch%23804/near/175938460" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> gnzlbg <a href="https://zulip-archive.rust-lang.org/stream/208962-t-libs/stdarch/topic/stdarch.23804.html#175938460">(Sep 17 2019 at 19:05)</a>:</h4>
<p>might work or be messy</p>



<a name="175938522"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/208962-t-libs/stdarch/topic/stdarch%23804/near/175938522" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Luca Barbato <a href="https://zulip-archive.rust-lang.org/stream/208962-t-libs/stdarch/topic/stdarch.23804.html#175938522">(Sep 17 2019 at 19:06)</a>:</h4>
<p>I was amending <code>pub fn from_str(_s: &amp;str) -&gt; Result&lt;Feature, ()&gt; { Err(()) }</code></p>



<a name="175938529"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/208962-t-libs/stdarch/topic/stdarch%23804/near/175938529" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> gnzlbg <a href="https://zulip-archive.rust-lang.org/stream/208962-t-libs/stdarch/topic/stdarch.23804.html#175938529">(Sep 17 2019 at 19:06)</a>:</h4>
<p>creating a new branch from master, fixing things there, submitting a PR and letting CI run and pass is the calm way to go</p>



<a name="175938539"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/208962-t-libs/stdarch/topic/stdarch%23804/near/175938539" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> gnzlbg <a href="https://zulip-archive.rust-lang.org/stream/208962-t-libs/stdarch/topic/stdarch.23804.html#175938539">(Sep 17 2019 at 19:06)</a>:</h4>
<p>it doesn't matter that much that master is broken</p>



<a name="175938543"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/208962-t-libs/stdarch/topic/stdarch%23804/near/175938543" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Luca Barbato <a href="https://zulip-archive.rust-lang.org/stream/208962-t-libs/stdarch/topic/stdarch.23804.html#175938543">(Sep 17 2019 at 19:06)</a>:</h4>
<p>but it happened on the wrong shell</p>



<a name="175938553"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/208962-t-libs/stdarch/topic/stdarch%23804/near/175938553" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> gnzlbg <a href="https://zulip-archive.rust-lang.org/stream/208962-t-libs/stdarch/topic/stdarch.23804.html#175938553">(Sep 17 2019 at 19:06)</a>:</h4>
<p>but since other repos use stdarch as a submodule</p>



<a name="175938555"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/208962-t-libs/stdarch/topic/stdarch%23804/near/175938555" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> gnzlbg <a href="https://zulip-archive.rust-lang.org/stream/208962-t-libs/stdarch/topic/stdarch.23804.html#175938555">(Sep 17 2019 at 19:06)</a>:</h4>
<p>we can't really force push to it</p>



<a name="175938564"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/208962-t-libs/stdarch/topic/stdarch%23804/near/175938564" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> gnzlbg <a href="https://zulip-archive.rust-lang.org/stream/208962-t-libs/stdarch/topic/stdarch.23804.html#175938564">(Sep 17 2019 at 19:06)</a>:</h4>
<p>otherwise we break those</p>



<a name="175938575"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/208962-t-libs/stdarch/topic/stdarch%23804/near/175938575" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> gnzlbg <a href="https://zulip-archive.rust-lang.org/stream/208962-t-libs/stdarch/topic/stdarch.23804.html#175938575">(Sep 17 2019 at 19:06)</a>:</h4>
<p>i understand, I've also made that mistake sometimes</p>



<a name="175938585"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/208962-t-libs/stdarch/topic/stdarch%23804/near/175938585" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Luca Barbato <a href="https://zulip-archive.rust-lang.org/stream/208962-t-libs/stdarch/topic/stdarch.23804.html#175938585">(Sep 17 2019 at 19:07)</a>:</h4>
<p>where is the link of the current CI run?</p>



<a name="175938586"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/208962-t-libs/stdarch/topic/stdarch%23804/near/175938586" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> gnzlbg <a href="https://zulip-archive.rust-lang.org/stream/208962-t-libs/stdarch/topic/stdarch.23804.html#175938586">(Sep 17 2019 at 19:07)</a>:</h4>
<p>:D</p>



<a name="175938616"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/208962-t-libs/stdarch/topic/stdarch%23804/near/175938616" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> gnzlbg <a href="https://zulip-archive.rust-lang.org/stream/208962-t-libs/stdarch/topic/stdarch.23804.html#175938616">(Sep 17 2019 at 19:07)</a>:</h4>
<p><a href="https://dev.azure.com/rust-lang2/stdarch/_build?definitionId=2" target="_blank" title="https://dev.azure.com/rust-lang2/stdarch/_build?definitionId=2">https://dev.azure.com/rust-lang2/stdarch/_build?definitionId=2</a></p>



<a name="175938631"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/208962-t-libs/stdarch/topic/stdarch%23804/near/175938631" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> gnzlbg <a href="https://zulip-archive.rust-lang.org/stream/208962-t-libs/stdarch/topic/stdarch.23804.html#175938631">(Sep 17 2019 at 19:07)</a>:</h4>
<p>all is stopped, so don't stress, when you open a new PR, we'll see what CI says</p>



<a name="175938647"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/208962-t-libs/stdarch/topic/stdarch%23804/near/175938647" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> gnzlbg <a href="https://zulip-archive.rust-lang.org/stream/208962-t-libs/stdarch/topic/stdarch.23804.html#175938647">(Sep 17 2019 at 19:07)</a>:</h4>
<p>i'm updating stdarch in rust-lang/rust</p>



<a name="175938661"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/208962-t-libs/stdarch/topic/stdarch%23804/near/175938661" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> gnzlbg <a href="https://zulip-archive.rust-lang.org/stream/208962-t-libs/stdarch/topic/stdarch.23804.html#175938661">(Sep 17 2019 at 19:08)</a>:</h4>
<p>so we have time till the next update</p>



<a name="175938718"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/208962-t-libs/stdarch/topic/stdarch%23804/near/175938718" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> gnzlbg <a href="https://zulip-archive.rust-lang.org/stream/208962-t-libs/stdarch/topic/stdarch.23804.html#175938718">(Sep 17 2019 at 19:08)</a>:</h4>
<p>(i have a PR open for that before your changes)</p>



<a name="175938753"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/208962-t-libs/stdarch/topic/stdarch%23804/near/175938753" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Luca Barbato <a href="https://zulip-archive.rust-lang.org/stream/208962-t-libs/stdarch/topic/stdarch.23804.html#175938753">(Sep 17 2019 at 19:09)</a>:</h4>
<p>What else was to change beside the typo on Err(())?</p>



<a name="175939395"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/208962-t-libs/stdarch/topic/stdarch%23804/near/175939395" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> gnzlbg <a href="https://zulip-archive.rust-lang.org/stream/208962-t-libs/stdarch/topic/stdarch.23804.html#175939395">(Sep 17 2019 at 19:16)</a>:</h4>
<p>I don't know, ping me there if there are more errors or you get stuck</p>



<a name="175944162"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/208962-t-libs/stdarch/topic/stdarch%23804/near/175944162" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Luca Barbato <a href="https://zulip-archive.rust-lang.org/stream/208962-t-libs/stdarch/topic/stdarch.23804.html#175944162">(Sep 17 2019 at 20:12)</a>:</h4>
<div class="codehilite"><pre><span></span>error[E0635]: unknown feature `stdsimd_internal`
 --&gt; crates/std_detect/tests/features.rs:2:12
  |
2 | #![feature(stdsimd_internal)]
</pre></div>



<a name="175944200"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/208962-t-libs/stdarch/topic/stdarch%23804/near/175944200" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Luca Barbato <a href="https://zulip-archive.rust-lang.org/stream/208962-t-libs/stdarch/topic/stdarch.23804.html#175944200">(Sep 17 2019 at 20:13)</a>:</h4>
<p>this is strange</p>



<a name="175976404"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/208962-t-libs/stdarch/topic/stdarch%23804/near/175976404" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> gnzlbg <a href="https://zulip-archive.rust-lang.org/stream/208962-t-libs/stdarch/topic/stdarch.23804.html#175976404">(Sep 18 2019 at 07:00)</a>:</h4>
<p>You can't use <code>Feature</code> outside of stdsimd</p>



<a name="175976420"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/208962-t-libs/stdarch/topic/stdarch%23804/near/175976420" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> gnzlbg <a href="https://zulip-archive.rust-lang.org/stream/208962-t-libs/stdarch/topic/stdarch.23804.html#175976420">(Sep 18 2019 at 07:01)</a>:</h4>
<p>In fact, I think it can be private now</p>



<a name="175976503"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/208962-t-libs/stdarch/topic/stdarch%23804/near/175976503" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> gnzlbg <a href="https://zulip-archive.rust-lang.org/stream/208962-t-libs/stdarch/topic/stdarch.23804.html#175976503">(Sep 18 2019 at 07:02)</a>:</h4>
<p><code>check_for</code> can be private as well</p>



<a name="175982745"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/208962-t-libs/stdarch/topic/stdarch%23804/near/175982745" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Luca Barbato <a href="https://zulip-archive.rust-lang.org/stream/208962-t-libs/stdarch/topic/stdarch.23804.html#175982745">(Sep 18 2019 at 08:34)</a>:</h4>
<blockquote>
<p>You can't use <code>Feature</code> outside of stdsimd</p>
</blockquote>
<p>that makes writing tests outside <code>src/</code> problematic :)</p>



<a name="176074119"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/208962-t-libs/stdarch/topic/stdarch%23804/near/176074119" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> gnzlbg <a href="https://zulip-archive.rust-lang.org/stream/208962-t-libs/stdarch/topic/stdarch.23804.html#176074119">(Sep 19 2019 at 07:01)</a>:</h4>
<p>Yeah, that's why some test were in the source. </p>
<p>But to test the feature you don't need that. You should be able to observe whether the env override works by just using <code>is_x86_feature_detected!</code>.</p>



<a name="176074134"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/208962-t-libs/stdarch/topic/stdarch%23804/near/176074134" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> gnzlbg <a href="https://zulip-archive.rust-lang.org/stream/208962-t-libs/stdarch/topic/stdarch.23804.html#176074134">(Sep 19 2019 at 07:01)</a>:</h4>
<p>You can add a small test for <code>from_str</code> in src/ if you want as long as it is properly cfg(test) out</p>



<a name="176074140"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/208962-t-libs/stdarch/topic/stdarch%23804/near/176074140" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> gnzlbg <a href="https://zulip-archive.rust-lang.org/stream/208962-t-libs/stdarch/topic/stdarch.23804.html#176074140">(Sep 19 2019 at 07:01)</a>:</h4>
<p>(<code>#[test]</code> does that I think)</p>



<a name="176079338"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/208962-t-libs/stdarch/topic/stdarch%23804/near/176079338" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Luca Barbato <a href="https://zulip-archive.rust-lang.org/stream/208962-t-libs/stdarch/topic/stdarch.23804.html#176079338">(Sep 19 2019 at 08:42)</a>:</h4>
<p>Sure</p>



<hr><p>Last updated: Apr 12 2022 at 20:01 UTC</p>
</html>