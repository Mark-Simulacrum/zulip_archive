<html>
<head><meta charset="utf-8"><title>std_detect release? · t-libs/stdarch · Zulip Chat Archive</title></head>
<h2>Stream: <a href="https://zulip-archive.rust-lang.org/stream/208962-t-libs/stdarch/index.html">t-libs/stdarch</a></h2>
<h3>Topic: <a href="https://zulip-archive.rust-lang.org/stream/208962-t-libs/stdarch/topic/std_detect.20release.3F.html">std_detect release?</a></h3>

<hr>

<base href="https://rust-lang.zulipchat.com">

<head><link href="https://zulip-archive.rust-lang.org/style.css" rel="stylesheet"></head>

<a name="177758733"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/208962-t-libs/stdarch/topic/std_detect%20release%3F/near/177758733" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Luca Barbato <a href="https://zulip-archive.rust-lang.org/stream/208962-t-libs/stdarch/topic/std_detect.20release.3F.html#177758733">(Oct 09 2019 at 21:40)</a>:</h4>
<p>Can we have a new release? I would use it in rav1e potentially.</p>



<a name="253428532"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/208962-t-libs/stdarch/topic/std_detect%20release%3F/near/253428532" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Luca Barbato <a href="https://zulip-archive.rust-lang.org/stream/208962-t-libs/stdarch/topic/std_detect.20release.3F.html#253428532">(Sep 15 2021 at 14:59)</a>:</h4>
<p>Ping on this.</p>



<a name="253428820"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/208962-t-libs/stdarch/topic/std_detect%20release%3F/near/253428820" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> bjorn3 <a href="https://zulip-archive.rust-lang.org/stream/208962-t-libs/stdarch/topic/std_detect.20release.3F.html#253428820">(Sep 15 2021 at 15:01)</a>:</h4>
<p>std_detect is part of libstd already. See the <code>is_*_feature_detected!()</code> macros.</p>



<a name="253429587"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/208962-t-libs/stdarch/topic/std_detect%20release%3F/near/253429587" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Luca Barbato <a href="https://zulip-archive.rust-lang.org/stream/208962-t-libs/stdarch/topic/std_detect.20release.3F.html#253429587">(Sep 15 2021 at 15:05)</a>:</h4>
<p>the env override is not enabled</p>



<a name="253429739"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/208962-t-libs/stdarch/topic/std_detect%20release%3F/near/253429739" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Luca Barbato <a href="https://zulip-archive.rust-lang.org/stream/208962-t-libs/stdarch/topic/std_detect.20release.3F.html#253429739">(Sep 15 2021 at 15:06)</a>:</h4>
<p>So either we enable it like we do for the proc parsing or would be nice to have a release</p>



<a name="253429766"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/208962-t-libs/stdarch/topic/std_detect%20release%3F/near/253429766" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Amanieu <a href="https://zulip-archive.rust-lang.org/stream/208962-t-libs/stdarch/topic/std_detect.20release.3F.html#253429766">(Sep 15 2021 at 15:06)</a>:</h4>
<p>We don't plan on publishing these crates to <a href="http://crates.io">crates.io</a></p>



<a name="253429838"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/208962-t-libs/stdarch/topic/std_detect%20release%3F/near/253429838" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Amanieu <a href="https://zulip-archive.rust-lang.org/stream/208962-t-libs/stdarch/topic/std_detect.20release.3F.html#253429838">(Sep 15 2021 at 15:06)</a>:</h4>
<p>However I think you can pass features to them with -Zbuild-std-features</p>



<a name="253430119"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/208962-t-libs/stdarch/topic/std_detect%20release%3F/near/253430119" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Luca Barbato <a href="https://zulip-archive.rust-lang.org/stream/208962-t-libs/stdarch/topic/std_detect.20release.3F.html#253430119">(Sep 15 2021 at 15:08)</a>:</h4>
<p>I'll start adding the feature to std so that can be done</p>



<a name="253430223"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/208962-t-libs/stdarch/topic/std_detect%20release%3F/near/253430223" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Luca Barbato <a href="https://zulip-archive.rust-lang.org/stream/208962-t-libs/stdarch/topic/std_detect.20release.3F.html#253430223">(Sep 15 2021 at 15:08)</a>:</h4>
<p>but would be quite nice to have it in std w/out asking the user to use a nightly compiler ^^;</p>



<a name="253430629"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/208962-t-libs/stdarch/topic/std_detect%20release%3F/near/253430629" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> bjorn3 <a href="https://zulip-archive.rust-lang.org/stream/208962-t-libs/stdarch/topic/std_detect.20release.3F.html#253430629">(Sep 15 2021 at 15:11)</a>:</h4>
<p>The env override is a security issue. If you enable a feature that is not actually supported by the current processor, it is possible that the current processor will interpret certain instructions that are part of said feature as other instructions that do something completely different. This is not a hypothetical scenario. For example older x86 cpu's without SSE2(?) interpret lzcnt as bsr.</p>



<a name="253431463"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/208962-t-libs/stdarch/topic/std_detect%20release%3F/near/253431463" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Luca Barbato <a href="https://zulip-archive.rust-lang.org/stream/208962-t-libs/stdarch/topic/std_detect.20release.3F.html#253431463">(Sep 15 2021 at 15:16)</a>:</h4>
<p>the env override is to disable extensions not enable them</p>



<a name="253431481"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/208962-t-libs/stdarch/topic/std_detect%20release%3F/near/253431481" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Luca Barbato <a href="https://zulip-archive.rust-lang.org/stream/208962-t-libs/stdarch/topic/std_detect.20release.3F.html#253431481">(Sep 15 2021 at 15:16)</a>:</h4>
<p>so that cannot happen</p>



<a name="253431665"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/208962-t-libs/stdarch/topic/std_detect%20release%3F/near/253431665" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Luca Barbato <a href="https://zulip-archive.rust-lang.org/stream/208962-t-libs/stdarch/topic/std_detect.20release.3F.html#253431665">(Sep 15 2021 at 15:17)</a>:</h4>
<p>It takes the detected value and unsets bits</p>



<a name="253432186"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/208962-t-libs/stdarch/topic/std_detect%20release%3F/near/253432186" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> bjorn3 <a href="https://zulip-archive.rust-lang.org/stream/208962-t-libs/stdarch/topic/std_detect.20release.3F.html#253432186">(Sep 15 2021 at 15:20)</a>:</h4>
<p>Right, my bad.</p>



<a name="253432288"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/208962-t-libs/stdarch/topic/std_detect%20release%3F/near/253432288" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Luca Barbato <a href="https://zulip-archive.rust-lang.org/stream/208962-t-libs/stdarch/topic/std_detect.20release.3F.html#253432288">(Sep 15 2021 at 15:21)</a>:</h4>
<p>The name could be less misleading I guess :)</p>



<a name="253432372"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/208962-t-libs/stdarch/topic/std_detect%20release%3F/near/253432372" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Luca Barbato <a href="https://zulip-archive.rust-lang.org/stream/208962-t-libs/stdarch/topic/std_detect.20release.3F.html#253432372">(Sep 15 2021 at 15:22)</a>:</h4>
<p>And the env might be changed to <code>RUST_STD_DETECT_UNSTABLE</code> -&gt; <code>RUST_STD_DETECT_DISABLE_UNSTABLE</code></p>



<hr><p>Last updated: Apr 12 2022 at 20:01 UTC</p>
</html>