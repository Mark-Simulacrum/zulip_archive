<html>
<head><meta charset="utf-8"><title>const_trait_impl&#x27;s syntax · t-compiler/const-eval · Zulip Chat Archive</title></head>
<h2>Stream: <a href="https://zulip-archive.rust-lang.org/stream/146212-t-compiler/const-eval/index.html">t-compiler/const-eval</a></h2>
<h3>Topic: <a href="https://zulip-archive.rust-lang.org/stream/146212-t-compiler/const-eval/topic/const_trait_impl&#x27;s.20syntax.html">const_trait_impl&#x27;s syntax</a></h3>

<hr>

<base href="https://rust-lang.zulipchat.com">

<head><link href="https://zulip-archive.rust-lang.org/style.css" rel="stylesheet"></head>

<a name="249682641"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/146212-t-compiler/const-eval/topic/const_trait_impl%27s%20syntax/near/249682641" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> fee1-dead <a href="https://zulip-archive.rust-lang.org/stream/146212-t-compiler/const-eval/topic/const_trait_impl&#x27;s.20syntax.html#249682641">(Aug 17 2021 at 06:22)</a>:</h4>
<p>I have been doing a lot of work with <code>const_trait_impl</code>, and I begin to realize the syntax proposed by the RFC is not the best.</p>
<p>We currently have <code>impl const Trait</code>, but we don't have <code>T: const Trait</code>. This feels inconsistent when you have to look for <code>T: Trait</code> as well as <code>T: ?const Trait</code> to find non-const bounds (and the former can be acually a const bound when on a const function!)</p>
<p>I really like <code>T: const Trait</code>, because we can now put constness as a part of a TraitRef. So the rest of the world becomes pretty consistent: <code>impl TraitRef</code> the constness is part of TraitRef and not part of the <code>impl</code>'s header. We could disallow other places for now such as <code>&lt;T as const Trait&gt;::blah()</code>, and it would make other things easier to come: const fn pointer, const dyn traits...</p>
<p>cc <span class="user-mention" data-user-id="124288">@oli</span></p>



<a name="249692743"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/146212-t-compiler/const-eval/topic/const_trait_impl%27s%20syntax/near/249692743" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> RalfJ <a href="https://zulip-archive.rust-lang.org/stream/146212-t-compiler/const-eval/topic/const_trait_impl&#x27;s.20syntax.html#249692743">(Aug 17 2021 at 08:54)</a>:</h4>
<blockquote>
<p>and it would make other things easier to come: const fn pointer, const dyn traits...</p>
</blockquote>
<p>Are you referring to the issues <a href="https://github.com/rust-lang/rfcs/pull/2632/files#diff-35cd717db1fda75bddd264a534c83b255ae6afba2458b47d9ae74c70ecf3b9efR619">raised here</a> and the alternative <a href="https://github.com/rust-lang/rfcs/pull/2632/files#diff-35cd717db1fda75bddd264a534c83b255ae6afba2458b47d9ae74c70ecf3b9efR705">described here</a>?</p>



<a name="249693064"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/146212-t-compiler/const-eval/topic/const_trait_impl%27s%20syntax/near/249693064" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> RalfJ <a href="https://zulip-archive.rust-lang.org/stream/146212-t-compiler/const-eval/topic/const_trait_impl&#x27;s.20syntax.html#249693064">(Aug 17 2021 at 08:58)</a>:</h4>
<p>If yes, I think I agree. However, there are two different things you could be meaning here:</p>
<div class="codehilite" data-code-language="Rust"><pre><span></span><code><span class="k">const</span><span class="w"> </span><span class="k">fn</span> <span class="nf">do_add</span><span class="o">&lt;</span><span class="n">T</span>: <span class="nc">const</span><span class="w"> </span><span class="n">Add</span><span class="o">&gt;</span><span class="p">(</span><span class="n">x</span>: <span class="nc">T</span><span class="p">,</span><span class="w"> </span><span class="n">y</span>: <span class="nc">T</span><span class="p">)</span><span class="w"> </span>-&gt; <span class="nc">T</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="n">x</span><span class="o">+</span><span class="n">y</span><span class="w"> </span><span class="p">}</span><span class="w"></span>
</code></pre></div>
<p>Does this mean that the function <em>always</em> requires a <code>impl const Add</code> or just when called in a context that might be evaluated at compiletime? IOW, does this build?</p>
<div class="codehilite" data-code-language="Rust"><pre><span></span><code><span class="cp">#[derive(Copy,Clone)]</span><span class="w"></span>
<span class="k">struct</span> <span class="nc">MyType</span><span class="p">(</span><span class="kt">i32</span><span class="p">);</span><span class="w"></span>

<span class="k">impl</span><span class="w"> </span><span class="n">Add</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">MyType</span><span class="w"> </span><span class="p">{</span><span class="o">..</span><span class="p">.}</span><span class="w"></span>

<span class="c1">// Runtime-only function!</span>
<span class="k">fn</span> <span class="nf">foo</span><span class="p">(</span><span class="n">x</span>: <span class="nc">MyType</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">  </span><span class="n">do_add</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="w"> </span><span class="n">x</span><span class="p">);</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>
</code></pre></div>
<p>(This is related to <code>?const Add</code> in the RFC)</p>



<a name="249697125"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/146212-t-compiler/const-eval/topic/const_trait_impl%27s%20syntax/near/249697125" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> oli <a href="https://zulip-archive.rust-lang.org/stream/146212-t-compiler/const-eval/topic/const_trait_impl&#x27;s.20syntax.html#249697125">(Aug 17 2021 at 09:49)</a>:</h4>
<p>yea, the one concern I have with this is <code>fn foo&lt;T: const Trait&gt;()</code> and what that's supposed to mean. In full "const effect" syntax we want something like a generic parameter: <code>for&lt;const C: bool&gt; const&lt;C&gt; fn foo&lt;T: const&lt;C&gt; Trait&gt;()</code>so we can use the functions constness to change whether the bound is const</p>



<a name="249697317"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/146212-t-compiler/const-eval/topic/const_trait_impl%27s%20syntax/near/249697317" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> oli <a href="https://zulip-archive.rust-lang.org/stream/146212-t-compiler/const-eval/topic/const_trait_impl&#x27;s.20syntax.html#249697317">(Aug 17 2021 at 09:51)</a>:</h4>
<p>we may one day want to allow <code>fn foo&lt;T: const Trait&gt;() { let x = const { T::method() } }</code>, so the plain const bound syntax is not clearly the right thing to me</p>



<a name="249700378"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/146212-t-compiler/const-eval/topic/const_trait_impl%27s%20syntax/near/249700378" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> RalfJ <a href="https://zulip-archive.rust-lang.org/stream/146212-t-compiler/const-eval/topic/const_trait_impl&#x27;s.20syntax.html#249700378">(Aug 17 2021 at 10:28)</a>:</h4>
<blockquote>
<p>fn foo&lt;T: const Trait&gt;() and what that's supposed to mean</p>
</blockquote>
<p>as I keep saying -- I think that whatever it means, it should be consistent with <code>fn foo(x: &amp;dyn const Trait)</code> (and likewise for <code>T: Trait</code> and <code>&amp;dyn Trait</code>)</p>



<a name="249700414"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/146212-t-compiler/const-eval/topic/const_trait_impl%27s%20syntax/near/249700414" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> RalfJ <a href="https://zulip-archive.rust-lang.org/stream/146212-t-compiler/const-eval/topic/const_trait_impl&#x27;s.20syntax.html#249700414">(Aug 17 2021 at 10:29)</a>:</h4>
<p><span class="user-mention silent" data-user-id="124288">oli</span> <a href="#narrow/stream/146212-t-compiler.2Fconst-eval/topic/const_trait_impl's.20syntax/near/249697317">said</a>:</p>
<blockquote>
<p>we may one day want to allow <code>fn foo&lt;T: const Trait&gt;() { let x = const { T::method() } }</code>, so the plain const bound syntax is not clearly the right thing to me</p>
</blockquote>
<p>not sure what "the plain const bound syntax" is, but I guess you are bringing this up as an argument for <em>not</em> accepting the code in my example above?</p>



<a name="249701567"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/146212-t-compiler/const-eval/topic/const_trait_impl%27s%20syntax/near/249701567" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> oli <a href="https://zulip-archive.rust-lang.org/stream/146212-t-compiler/const-eval/topic/const_trait_impl&#x27;s.20syntax.html#249701567">(Aug 17 2021 at 10:46)</a>:</h4>
<p>if your example compiles, then the <code>const</code> in <code>const Add</code> depends on the call site. That makes little sense for non-const fn, so imo we should treat <code>const Trait</code> bounds as "always require constness" and figure something out that is not as horrible as the "effect syntax"</p>



<a name="249701579"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/146212-t-compiler/const-eval/topic/const_trait_impl%27s%20syntax/near/249701579" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> oli <a href="https://zulip-archive.rust-lang.org/stream/146212-t-compiler/const-eval/topic/const_trait_impl&#x27;s.20syntax.html#249701579">(Aug 17 2021 at 10:46)</a>:</h4>
<p><span class="user-mention silent" data-user-id="120791">RalfJ</span> <a href="#narrow/stream/146212-t-compiler.2Fconst-eval/topic/const_trait_impl's.20syntax/near/249700414">said</a>:</p>
<blockquote>
<p>I guess you are bringing this up as an argument for <em>not</em> accepting the code in my example above?</p>
</blockquote>
<p>yes</p>



<a name="249701610"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/146212-t-compiler/const-eval/topic/const_trait_impl%27s%20syntax/near/249701610" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> oli <a href="https://zulip-archive.rust-lang.org/stream/146212-t-compiler/const-eval/topic/const_trait_impl&#x27;s.20syntax.html#249701610">(Aug 17 2021 at 10:47)</a>:</h4>
<p>"the plain const bound syntax" -&gt; <code>const Trait</code> in bounds</p>



<a name="249704217"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/146212-t-compiler/const-eval/topic/const_trait_impl%27s%20syntax/near/249704217" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> RalfJ <a href="https://zulip-archive.rust-lang.org/stream/146212-t-compiler/const-eval/topic/const_trait_impl&#x27;s.20syntax.html#249704217">(Aug 17 2021 at 11:20)</a>:</h4>
<blockquote>
<p>That makes little sense for non-const fn,</p>
</blockquote>
<p>Ah okay; originally I thought the plan might be to only allow this on <code>const fn</code></p>



<a name="249704227"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/146212-t-compiler/const-eval/topic/const_trait_impl%27s%20syntax/near/249704227" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> RalfJ <a href="https://zulip-archive.rust-lang.org/stream/146212-t-compiler/const-eval/topic/const_trait_impl&#x27;s.20syntax.html#249704227">(Aug 17 2021 at 11:20)</a>:</h4>
<blockquote>
<p>figure something out that is not as horrible as the "effect syntax"</p>
</blockquote>
<p>didn't you propose <code>const?</code> for this?</p>



<a name="249705165"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/146212-t-compiler/const-eval/topic/const_trait_impl%27s%20syntax/near/249705165" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> oli <a href="https://zulip-archive.rust-lang.org/stream/146212-t-compiler/const-eval/topic/const_trait_impl&#x27;s.20syntax.html#249705165">(Aug 17 2021 at 11:32)</a>:</h4>
<p>well, I did propose <code>?const</code> with the meaning like <code>?Sized</code> (so can be const or not, we don't care in any situation). We could come up with arbitrary other syntax, but I don't think we should re-use <code>?const</code> in a way that means "const if in const context, otherwise not", as that seems to differ too much from how <code>?Sized</code> works</p>



<a name="249705206"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/146212-t-compiler/const-eval/topic/const_trait_impl%27s%20syntax/near/249705206" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> oli <a href="https://zulip-archive.rust-lang.org/stream/146212-t-compiler/const-eval/topic/const_trait_impl&#x27;s.20syntax.html#249705206">(Aug 17 2021 at 11:32)</a>:</h4>
<p>That said. idk what <code>dyn const Trait</code> even means outside of const contexts</p>



<a name="249705232"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/146212-t-compiler/const-eval/topic/const_trait_impl%27s%20syntax/near/249705232" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> RalfJ <a href="https://zulip-archive.rust-lang.org/stream/146212-t-compiler/const-eval/topic/const_trait_impl&#x27;s.20syntax.html#249705232">(Aug 17 2021 at 11:33)</a>:</h4>
<p><span class="user-mention silent" data-user-id="124288">oli</span> <a href="#narrow/stream/146212-t-compiler.2Fconst-eval/topic/const_trait_impl's.20syntax/near/249705206">said</a>:</p>
<blockquote>
<p>That said. idk what <code>dyn const Trait</code> even means outside of const contexts</p>
</blockquote>
<p>it means the vtable comes from an <code>impl const Trait</code></p>



<a name="249705242"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/146212-t-compiler/const-eval/topic/const_trait_impl%27s%20syntax/near/249705242" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> RalfJ <a href="https://zulip-archive.rust-lang.org/stream/146212-t-compiler/const-eval/topic/const_trait_impl&#x27;s.20syntax.html#249705242">(Aug 17 2021 at 11:33)</a>:</h4>
<p>whether that's useful though is another question^^</p>



<a name="249705253"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/146212-t-compiler/const-eval/topic/const_trait_impl%27s%20syntax/near/249705253" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> oli <a href="https://zulip-archive.rust-lang.org/stream/146212-t-compiler/const-eval/topic/const_trait_impl&#x27;s.20syntax.html#249705253">(Aug 17 2021 at 11:33)</a>:</h4>
<p><span class="user-mention silent" data-user-id="120791">RalfJ</span> <a href="#narrow/stream/146212-t-compiler.2Fconst-eval/topic/const_trait_impl's.20syntax/near/249705242">said</a>:</p>
<blockquote>
<p>whether that's useful though is another question^^</p>
</blockquote>
<p>ok, yea I know what it means, but what it's for is unclear</p>



<a name="249705267"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/146212-t-compiler/const-eval/topic/const_trait_impl%27s%20syntax/near/249705267" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> oli <a href="https://zulip-archive.rust-lang.org/stream/146212-t-compiler/const-eval/topic/const_trait_impl&#x27;s.20syntax.html#249705267">(Aug 17 2021 at 11:33)</a>:</h4>
<p>unless we have some guarantees that const bounds bring that we can't have otherwise</p>



<a name="249705270"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/146212-t-compiler/const-eval/topic/const_trait_impl%27s%20syntax/near/249705270" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> oli <a href="https://zulip-archive.rust-lang.org/stream/146212-t-compiler/const-eval/topic/const_trait_impl&#x27;s.20syntax.html#249705270">(Aug 17 2021 at 11:33)</a>:</h4>
<p>but even then</p>



<a name="249705340"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/146212-t-compiler/const-eval/topic/const_trait_impl%27s%20syntax/near/249705340" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> oli <a href="https://zulip-archive.rust-lang.org/stream/146212-t-compiler/const-eval/topic/const_trait_impl&#x27;s.20syntax.html#249705340">(Aug 17 2021 at 11:34)</a>:</h4>
<p>if we make it "const if in const context" if used on <code>const fn</code> args, what do we do on non-const fn?</p>



<a name="249705430"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/146212-t-compiler/const-eval/topic/const_trait_impl%27s%20syntax/near/249705430" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> oli <a href="https://zulip-archive.rust-lang.org/stream/146212-t-compiler/const-eval/topic/const_trait_impl&#x27;s.20syntax.html#249705430">(Aug 17 2021 at 11:35)</a>:</h4>
<p>mixing the "must have an <code>impl const Trait</code>" with "must have an <code>impl const Trait</code> if in const context" seems like an aweful situation</p>



<a name="249705482"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/146212-t-compiler/const-eval/topic/const_trait_impl%27s%20syntax/near/249705482" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> oli <a href="https://zulip-archive.rust-lang.org/stream/146212-t-compiler/const-eval/topic/const_trait_impl&#x27;s.20syntax.html#249705482">(Aug 17 2021 at 11:35)</a>:</h4>
<p>If we forbid it on non-const fn, this problem is resolved</p>



<a name="249705557"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/146212-t-compiler/const-eval/topic/const_trait_impl%27s%20syntax/near/249705557" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> oli <a href="https://zulip-archive.rust-lang.org/stream/146212-t-compiler/const-eval/topic/const_trait_impl&#x27;s.20syntax.html#249705557">(Aug 17 2021 at 11:36)</a>:</h4>
<p>but then we have no syntax for actually requiring a <code>const Trait</code> bound outside of <code>const fn</code> used in a const context</p>



<a name="249705605"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/146212-t-compiler/const-eval/topic/const_trait_impl%27s%20syntax/near/249705605" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> oli <a href="https://zulip-archive.rust-lang.org/stream/146212-t-compiler/const-eval/topic/const_trait_impl&#x27;s.20syntax.html#249705605">(Aug 17 2021 at 11:37)</a>:</h4>
<p>which is fine if we never need such a feature, but we should at least consider if we want to throw away the obvious syntax for that forever</p>



<a name="249705747"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/146212-t-compiler/const-eval/topic/const_trait_impl%27s%20syntax/near/249705747" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> RalfJ <a href="https://zulip-archive.rust-lang.org/stream/146212-t-compiler/const-eval/topic/const_trait_impl&#x27;s.20syntax.html#249705747">(Aug 17 2021 at 11:38)</a>:</h4>
<p><span class="user-mention silent" data-user-id="124288">oli</span> <a href="#narrow/stream/146212-t-compiler.2Fconst-eval/topic/const_trait_impl's.20syntax/near/249705482">said</a>:</p>
<blockquote>
<p>If we forbid it on non-const fn, this problem is resolved</p>
</blockquote>
<p>except what do we do with bounds in <code>impl</code> blocks?</p>



<a name="249705778"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/146212-t-compiler/const-eval/topic/const_trait_impl%27s%20syntax/near/249705778" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> oli <a href="https://zulip-archive.rust-lang.org/stream/146212-t-compiler/const-eval/topic/const_trait_impl&#x27;s.20syntax.html#249705778">(Aug 17 2021 at 11:38)</a>:</h4>
<p>the same thing as in <code>const fn</code>?</p>



<a name="249705793"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/146212-t-compiler/const-eval/topic/const_trait_impl%27s%20syntax/near/249705793" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> oli <a href="https://zulip-archive.rust-lang.org/stream/146212-t-compiler/const-eval/topic/const_trait_impl&#x27;s.20syntax.html#249705793">(Aug 17 2021 at 11:39)</a>:</h4>
<p>bounds are the same everywhere</p>



<a name="249705806"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/146212-t-compiler/const-eval/topic/const_trait_impl%27s%20syntax/near/249705806" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> oli <a href="https://zulip-archive.rust-lang.org/stream/146212-t-compiler/const-eval/topic/const_trait_impl&#x27;s.20syntax.html#249705806">(Aug 17 2021 at 11:39)</a>:</h4>
<p>or am I missing something?</p>



<a name="249705814"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/146212-t-compiler/const-eval/topic/const_trait_impl%27s%20syntax/near/249705814" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> RalfJ <a href="https://zulip-archive.rust-lang.org/stream/146212-t-compiler/const-eval/topic/const_trait_impl&#x27;s.20syntax.html#249705814">(Aug 17 2021 at 11:39)</a>:</h4>
<p>is this allowed?</p>
<div class="codehilite" data-code-language="Rust"><pre><span></span><code><span class="k">impl</span><span class="o">&lt;</span><span class="n">T</span>: <span class="nc">const</span><span class="w"> </span><span class="n">Trait</span><span class="o">&gt;</span><span class="w"> </span><span class="n">Something</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">  </span><span class="k">const</span><span class="w"> </span><span class="k">fn</span> <span class="nf">foo</span><span class="p">(</span><span class="o">..</span><span class="p">.)</span><span class="w"> </span><span class="p">{</span><span class="o">..</span><span class="p">.}</span><span class="w"></span>
<span class="w">  </span><span class="k">fn</span> <span class="nf">bar</span><span class="p">(</span><span class="o">..</span><span class="p">.)</span><span class="w"> </span><span class="p">{</span><span class="o">..</span><span class="p">.}</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>
</code></pre></div>



<a name="249705831"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/146212-t-compiler/const-eval/topic/const_trait_impl%27s%20syntax/near/249705831" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> oli <a href="https://zulip-archive.rust-lang.org/stream/146212-t-compiler/const-eval/topic/const_trait_impl&#x27;s.20syntax.html#249705831">(Aug 17 2021 at 11:39)</a>:</h4>
<p>heh</p>



<a name="249705834"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/146212-t-compiler/const-eval/topic/const_trait_impl%27s%20syntax/near/249705834" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> oli <a href="https://zulip-archive.rust-lang.org/stream/146212-t-compiler/const-eval/topic/const_trait_impl&#x27;s.20syntax.html#249705834">(Aug 17 2021 at 11:39)</a>:</h4>
<p>ok</p>



<a name="249705842"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/146212-t-compiler/const-eval/topic/const_trait_impl%27s%20syntax/near/249705842" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> oli <a href="https://zulip-archive.rust-lang.org/stream/146212-t-compiler/const-eval/topic/const_trait_impl&#x27;s.20syntax.html#249705842">(Aug 17 2021 at 11:39)</a>:</h4>
<p>those impl blocks</p>



<a name="249705849"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/146212-t-compiler/const-eval/topic/const_trait_impl%27s%20syntax/near/249705849" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> oli <a href="https://zulip-archive.rust-lang.org/stream/146212-t-compiler/const-eval/topic/const_trait_impl&#x27;s.20syntax.html#249705849">(Aug 17 2021 at 11:40)</a>:</h4>
<p>forgot about inherent ones</p>



<a name="249705851"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/146212-t-compiler/const-eval/topic/const_trait_impl%27s%20syntax/near/249705851" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> oli <a href="https://zulip-archive.rust-lang.org/stream/146212-t-compiler/const-eval/topic/const_trait_impl&#x27;s.20syntax.html#249705851">(Aug 17 2021 at 11:40)</a>:</h4>
<p>yea</p>



<a name="249705857"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/146212-t-compiler/const-eval/topic/const_trait_impl%27s%20syntax/near/249705857" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> oli <a href="https://zulip-archive.rust-lang.org/stream/146212-t-compiler/const-eval/topic/const_trait_impl&#x27;s.20syntax.html#249705857">(Aug 17 2021 at 11:40)</a>:</h4>
<p>uh</p>



<a name="249705914"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/146212-t-compiler/const-eval/topic/const_trait_impl%27s%20syntax/near/249705914" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> oli <a href="https://zulip-archive.rust-lang.org/stream/146212-t-compiler/const-eval/topic/const_trait_impl&#x27;s.20syntax.html#249705914">(Aug 17 2021 at 11:40)</a>:</h4>
<p>it's all not great. Ignoring the <code>const</code> for non-const functions seems like a real mess</p>



<a name="249705955"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/146212-t-compiler/const-eval/topic/const_trait_impl%27s%20syntax/near/249705955" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> oli <a href="https://zulip-archive.rust-lang.org/stream/146212-t-compiler/const-eval/topic/const_trait_impl&#x27;s.20syntax.html#249705955">(Aug 17 2021 at 11:41)</a>:</h4>
<p>I mean... we could just require you to re-state bounds you want const on the function</p>



<a name="249705965"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/146212-t-compiler/const-eval/topic/const_trait_impl%27s%20syntax/near/249705965" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> oli <a href="https://zulip-archive.rust-lang.org/stream/146212-t-compiler/const-eval/topic/const_trait_impl&#x27;s.20syntax.html#249705965">(Aug 17 2021 at 11:41)</a>:</h4>
<p>"problem solved"</p>



<a name="249705975"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/146212-t-compiler/const-eval/topic/const_trait_impl%27s%20syntax/near/249705975" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> RalfJ <a href="https://zulip-archive.rust-lang.org/stream/146212-t-compiler/const-eval/topic/const_trait_impl&#x27;s.20syntax.html#249705975">(Aug 17 2021 at 11:41)</a>:</h4>
<p>basically that block should be equivalent to having the <code>&lt;T: const Trait&gt;</code> on each fn separately, I'd say</p>



<a name="249705985"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/146212-t-compiler/const-eval/topic/const_trait_impl%27s%20syntax/near/249705985" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> RalfJ <a href="https://zulip-archive.rust-lang.org/stream/146212-t-compiler/const-eval/topic/const_trait_impl&#x27;s.20syntax.html#249705985">(Aug 17 2021 at 11:41)</a>:</h4>
<p>if that would be rejected, then this block should be rejected</p>



<a name="249705988"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/146212-t-compiler/const-eval/topic/const_trait_impl%27s%20syntax/near/249705988" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> oli <a href="https://zulip-archive.rust-lang.org/stream/146212-t-compiler/const-eval/topic/const_trait_impl&#x27;s.20syntax.html#249705988">(Aug 17 2021 at 11:41)</a>:</h4>
<p>yea</p>



<a name="249706074"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/146212-t-compiler/const-eval/topic/const_trait_impl%27s%20syntax/near/249706074" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> oli <a href="https://zulip-archive.rust-lang.org/stream/146212-t-compiler/const-eval/topic/const_trait_impl&#x27;s.20syntax.html#249706074">(Aug 17 2021 at 11:42)</a>:</h4>
<div class="codehilite" data-code-language="Rust"><pre><span></span><code><span class="k">impl</span><span class="o">&lt;</span><span class="n">T</span>: <span class="nc">const</span><span class="w"> </span><span class="n">Trait</span><span class="o">&gt;</span><span class="w"> </span><span class="n">Something</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">  </span><span class="k">const</span><span class="w"> </span><span class="k">fn</span> <span class="nf">foo</span><span class="p">(</span><span class="o">..</span><span class="p">.)</span><span class="w"> </span><span class="p">{</span><span class="o">..</span><span class="p">.}</span><span class="w"></span>
<span class="w">  </span><span class="k">const</span><span class="w"> </span><span class="k">fn</span> <span class="nf">bar</span><span class="p">(</span><span class="o">..</span><span class="p">.)</span><span class="w"> </span><span class="p">{</span><span class="o">..</span><span class="p">.}</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>
</code></pre></div>
<p>should not be rejected then</p>



<a name="249706078"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/146212-t-compiler/const-eval/topic/const_trait_impl%27s%20syntax/near/249706078" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> RalfJ <a href="https://zulip-archive.rust-lang.org/stream/146212-t-compiler/const-eval/topic/const_trait_impl&#x27;s.20syntax.html#249706078">(Aug 17 2021 at 11:42)</a>:</h4>
<p>though doesnt this become even more interesting for trait impls, in particular if the trait contains both <code>fn</code> and <code>const fn</code>?</p>



<a name="249706098"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/146212-t-compiler/const-eval/topic/const_trait_impl%27s%20syntax/near/249706098" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> oli <a href="https://zulip-archive.rust-lang.org/stream/146212-t-compiler/const-eval/topic/const_trait_impl&#x27;s.20syntax.html#249706098">(Aug 17 2021 at 11:42)</a>:</h4>
<p>traits can't do that</p>



<a name="249706108"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/146212-t-compiler/const-eval/topic/const_trait_impl%27s%20syntax/near/249706108" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> RalfJ <a href="https://zulip-archive.rust-lang.org/stream/146212-t-compiler/const-eval/topic/const_trait_impl&#x27;s.20syntax.html#249706108">(Aug 17 2021 at 11:42)</a>:</h4>
<p>not yet</p>



<a name="249706116"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/146212-t-compiler/const-eval/topic/const_trait_impl%27s%20syntax/near/249706116" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> RalfJ <a href="https://zulip-archive.rust-lang.org/stream/146212-t-compiler/const-eval/topic/const_trait_impl&#x27;s.20syntax.html#249706116">(Aug 17 2021 at 11:42)</a>:</h4>
<p>seems like a reasonable extension though</p>



<a name="249706130"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/146212-t-compiler/const-eval/topic/const_trait_impl%27s%20syntax/near/249706130" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> oli <a href="https://zulip-archive.rust-lang.org/stream/146212-t-compiler/const-eval/topic/const_trait_impl&#x27;s.20syntax.html#249706130">(Aug 17 2021 at 11:42)</a>:</h4>
<p>sure <span aria-label="grinning" class="emoji emoji-1f600" role="img" title="grinning">:grinning:</span> but we're in "throw away all nice syntax for future extensions" mode already</p>



<a name="249706188"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/146212-t-compiler/const-eval/topic/const_trait_impl%27s%20syntax/near/249706188" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> RalfJ <a href="https://zulip-archive.rust-lang.org/stream/146212-t-compiler/const-eval/topic/const_trait_impl&#x27;s.20syntax.html#249706188">(Aug 17 2021 at 11:43)</a>:</h4>
<p>are we?^^ it's less about "nice" and more about being internally coherent</p>



<a name="249706311"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/146212-t-compiler/const-eval/topic/const_trait_impl%27s%20syntax/near/249706311" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> oli <a href="https://zulip-archive.rust-lang.org/stream/146212-t-compiler/const-eval/topic/const_trait_impl&#x27;s.20syntax.html#249706311">(Aug 17 2021 at 11:44)</a>:</h4>
<p>well... you could add where bounds on the const fn</p>



<a name="249706387"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/146212-t-compiler/const-eval/topic/const_trait_impl%27s%20syntax/near/249706387" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> oli <a href="https://zulip-archive.rust-lang.org/stream/146212-t-compiler/const-eval/topic/const_trait_impl&#x27;s.20syntax.html#249706387">(Aug 17 2021 at 11:45)</a>:</h4>
<p>oh, one thing: non-const impl blocks can't use generic params to call methods in their assoc consts if we go with <code>const Trait</code> not being allowed outside of const fn</p>



<a name="249706643"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/146212-t-compiler/const-eval/topic/const_trait_impl%27s%20syntax/near/249706643" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> RalfJ <a href="https://zulip-archive.rust-lang.org/stream/146212-t-compiler/const-eval/topic/const_trait_impl&#x27;s.20syntax.html#249706643">(Aug 17 2021 at 11:48)</a>:</h4>
<p><span class="user-mention silent" data-user-id="124288">oli</span> <a href="#narrow/stream/146212-t-compiler.2Fconst-eval/topic/const_trait_impl's.20syntax/near/249706387">said</a>:</p>
<blockquote>
<p>oh, one thing: non-const impl blocks can't use generic params to call methods in their assoc consts if we go with <code>const Trait</code> not being allowed outside of const fn</p>
</blockquote>
<p>I dont follow, do you have an example?</p>



<a name="249706710"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/146212-t-compiler/const-eval/topic/const_trait_impl%27s%20syntax/near/249706710" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> oli <a href="https://zulip-archive.rust-lang.org/stream/146212-t-compiler/const-eval/topic/const_trait_impl&#x27;s.20syntax.html#249706710">(Aug 17 2021 at 11:49)</a>:</h4>
<div class="codehilite" data-code-language="Rust"><pre><span></span><code><span class="k">impl</span><span class="o">&lt;</span><span class="n">T</span>: <span class="nc">Bound</span><span class="o">&gt;</span><span class="w"> </span><span class="n">SomeTrait</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">SomeType</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="k">const</span><span class="w"> </span><span class="n">FOO</span>: <span class="kt">i32</span> <span class="o">=</span><span class="w"> </span><span class="n">T</span>::<span class="n">assoc_fn</span><span class="p">();</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>
</code></pre></div>



<a name="249707026"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/146212-t-compiler/const-eval/topic/const_trait_impl%27s%20syntax/near/249707026" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> oli <a href="https://zulip-archive.rust-lang.org/stream/146212-t-compiler/const-eval/topic/const_trait_impl&#x27;s.20syntax.html#249707026">(Aug 17 2021 at 11:52)</a>:</h4>
<p>to me, the obvious syntax here is <code>T: const Bound</code></p>



<a name="249707686"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/146212-t-compiler/const-eval/topic/const_trait_impl%27s%20syntax/near/249707686" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> oli <a href="https://zulip-archive.rust-lang.org/stream/146212-t-compiler/const-eval/topic/const_trait_impl&#x27;s.20syntax.html#249707686">(Aug 17 2021 at 11:58)</a>:</h4>
<p>I mean... we could go with allowing <code>const Trait</code> bounds everywhere and only allowing <code>?const Trait</code> bounds (or other syntax) only on <code>const fn</code> and <code>impl const Trait</code> to mean "if used in const context"</p>



<a name="249708536"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/146212-t-compiler/const-eval/topic/const_trait_impl%27s%20syntax/near/249708536" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> RalfJ <a href="https://zulip-archive.rust-lang.org/stream/146212-t-compiler/const-eval/topic/const_trait_impl&#x27;s.20syntax.html#249708536">(Aug 17 2021 at 12:06)</a>:</h4>
<p>ah so that is basically the same case as the "trait that mixes fn and const fn" that I brought up above</p>



<a name="249708550"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/146212-t-compiler/const-eval/topic/const_trait_impl%27s%20syntax/near/249708550" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> RalfJ <a href="https://zulip-archive.rust-lang.org/stream/146212-t-compiler/const-eval/topic/const_trait_impl&#x27;s.20syntax.html#249708550">(Aug 17 2021 at 12:06)</a>:</h4>
<p>except the trait would mix fn and assoc consts</p>



<a name="249708551"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/146212-t-compiler/const-eval/topic/const_trait_impl%27s%20syntax/near/249708551" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> oli <a href="https://zulip-archive.rust-lang.org/stream/146212-t-compiler/const-eval/topic/const_trait_impl&#x27;s.20syntax.html#249708551">(Aug 17 2021 at 12:06)</a>:</h4>
<p>yea</p>



<a name="249708584"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/146212-t-compiler/const-eval/topic/const_trait_impl%27s%20syntax/near/249708584" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> oli <a href="https://zulip-archive.rust-lang.org/stream/146212-t-compiler/const-eval/topic/const_trait_impl&#x27;s.20syntax.html#249708584">(Aug 17 2021 at 12:07)</a>:</h4>
<p>but you can't add bounds on assoc consts I think?</p>



<a name="249708611"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/146212-t-compiler/const-eval/topic/const_trait_impl%27s%20syntax/near/249708611" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> RalfJ <a href="https://zulip-archive.rust-lang.org/stream/146212-t-compiler/const-eval/topic/const_trait_impl&#x27;s.20syntax.html#249708611">(Aug 17 2021 at 12:07)</a>:</h4>
<p>yeah</p>



<a name="249708617"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/146212-t-compiler/const-eval/topic/const_trait_impl%27s%20syntax/near/249708617" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> oli <a href="https://zulip-archive.rust-lang.org/stream/146212-t-compiler/const-eval/topic/const_trait_impl&#x27;s.20syntax.html#249708617">(Aug 17 2021 at 12:07)</a>:</h4>
<p>and on a trait impl... that makes no sense anyway</p>



<a name="249708632"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/146212-t-compiler/const-eval/topic/const_trait_impl%27s%20syntax/near/249708632" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> RalfJ <a href="https://zulip-archive.rust-lang.org/stream/146212-t-compiler/const-eval/topic/const_trait_impl&#x27;s.20syntax.html#249708632">(Aug 17 2021 at 12:07)</a>:</h4>
<p>but this also indicates that the semantics should really be "must be <code>const</code>, period"</p>



<a name="249708638"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/146212-t-compiler/const-eval/topic/const_trait_impl%27s%20syntax/near/249708638" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> oli <a href="https://zulip-archive.rust-lang.org/stream/146212-t-compiler/const-eval/topic/const_trait_impl&#x27;s.20syntax.html#249708638">(Aug 17 2021 at 12:08)</a>:</h4>
<p>I agree</p>



<a name="249708691"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/146212-t-compiler/const-eval/topic/const_trait_impl%27s%20syntax/near/249708691" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> oli <a href="https://zulip-archive.rust-lang.org/stream/146212-t-compiler/const-eval/topic/const_trait_impl&#x27;s.20syntax.html#249708691">(Aug 17 2021 at 12:08)</a>:</h4>
<p><span class="user-mention silent" data-user-id="124288">oli</span> <a href="#narrow/stream/146212-t-compiler.2Fconst-eval/topic/const_trait_impl's.20syntax/near/249707686">said</a>:</p>
<blockquote>
<p>I mean... we could go with allowing <code>const Trait</code> bounds everywhere and only allowing <code>?const Trait</code> bounds (or other syntax) only on <code>const fn</code> and <code>impl const Trait</code> to mean "if used in const context"</p>
</blockquote>
<p>this</p>



<a name="249708711"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/146212-t-compiler/const-eval/topic/const_trait_impl%27s%20syntax/near/249708711" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> RalfJ <a href="https://zulip-archive.rust-lang.org/stream/146212-t-compiler/const-eval/topic/const_trait_impl&#x27;s.20syntax.html#249708711">(Aug 17 2021 at 12:08)</a>:</h4>
<p>otherwise what the heck happens in cases like this?</p>
<div class="codehilite" data-code-language="Rust"><pre><span></span><code><span class="k">impl</span><span class="o">&lt;</span><span class="n">T</span>: <span class="nc">const</span><span class="w"> </span><span class="n">Bound</span><span class="o">&gt;</span><span class="w"> </span><span class="n">SomeTrait</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">SomeType</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="k">const</span><span class="w"> </span><span class="n">FOO</span>: <span class="kt">i32</span> <span class="o">=</span><span class="w"> </span><span class="n">T</span>::<span class="n">assoc_fn</span><span class="p">();</span><span class="w"></span>

<span class="w">    </span><span class="k">fn</span> <span class="nf">foo</span><span class="p">()</span><span class="w"> </span>-&gt; <span class="kt">i32</span> <span class="p">{</span><span class="w"> </span><span class="bp">Self</span>::<span class="n">FOO</span><span class="w"> </span><span class="p">}</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>
</code></pre></div>



<a name="249708735"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/146212-t-compiler/const-eval/topic/const_trait_impl%27s%20syntax/near/249708735" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> oli <a href="https://zulip-archive.rust-lang.org/stream/146212-t-compiler/const-eval/topic/const_trait_impl&#x27;s.20syntax.html#249708735">(Aug 17 2021 at 12:08)</a>:</h4>
<p>bugs, likely bugs will happen</p>



<a name="249708768"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/146212-t-compiler/const-eval/topic/const_trait_impl%27s%20syntax/near/249708768" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> RalfJ <a href="https://zulip-archive.rust-lang.org/stream/146212-t-compiler/const-eval/topic/const_trait_impl&#x27;s.20syntax.html#249708768">(Aug 17 2021 at 12:09)</a>:</h4>
<p>no I mean what would even be the correct thing to do, if <code>T: const Bound</code> means "const when used in const context"</p>



<a name="249708786"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/146212-t-compiler/const-eval/topic/const_trait_impl%27s%20syntax/near/249708786" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> RalfJ <a href="https://zulip-archive.rust-lang.org/stream/146212-t-compiler/const-eval/topic/const_trait_impl&#x27;s.20syntax.html#249708786">(Aug 17 2021 at 12:09)</a>:</h4>
<p>the syntax is irrelevant -- what would any kind of "const when used in const context" system do here?</p>



<a name="249708920"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/146212-t-compiler/const-eval/topic/const_trait_impl%27s%20syntax/near/249708920" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> RalfJ <a href="https://zulip-archive.rust-lang.org/stream/146212-t-compiler/const-eval/topic/const_trait_impl&#x27;s.20syntax.html#249708920">(Aug 17 2021 at 12:10)</a>:</h4>
<p>since assoc consts have no where clauses, "const when used in const context" couldnt be used in assoc consts, I think</p>



<a name="249708921"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/146212-t-compiler/const-eval/topic/const_trait_impl%27s%20syntax/near/249708921" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> RalfJ <a href="https://zulip-archive.rust-lang.org/stream/146212-t-compiler/const-eval/topic/const_trait_impl&#x27;s.20syntax.html#249708921">(Aug 17 2021 at 12:10)</a>:</h4>
<p>which, uh, wtf^^</p>



<a name="249709047"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/146212-t-compiler/const-eval/topic/const_trait_impl%27s%20syntax/near/249709047" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> RalfJ <a href="https://zulip-archive.rust-lang.org/stream/146212-t-compiler/const-eval/topic/const_trait_impl&#x27;s.20syntax.html#249709047">(Aug 17 2021 at 12:12)</a>:</h4>
<blockquote>
<p>and only allowing ?const Trait bounds (or other syntax) only on const fn and impl const Trait to mean "if used in const context"</p>
</blockquote>
<p>so given the above I am not sure what allowing it on <code>impl const Trait</code> would lead mean exactly</p>



<a name="249712127"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/146212-t-compiler/const-eval/topic/const_trait_impl%27s%20syntax/near/249712127" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> oli <a href="https://zulip-archive.rust-lang.org/stream/146212-t-compiler/const-eval/topic/const_trait_impl&#x27;s.20syntax.html#249712127">(Aug 17 2021 at 12:41)</a>:</h4>
<p>there is no fundamental difference between "const if in const" bounds on <code>const fn</code> and on <code>impl const Trait</code>. So</p>
<div class="codehilite" data-code-language="Rust"><pre><span></span><code><span class="k">impl</span><span class="o">&lt;</span><span class="n">T</span>: <span class="nc">Boo</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">constifinconst</span><span class="w"> </span><span class="n">Trait</span><span class="o">&gt;</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="n">OtherTrait</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">SomeStruct</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="k">fn</span> <span class="nf">foo</span><span class="p">()</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="n">T</span>::<span class="n">some_method</span><span class="p">()</span><span class="w"> </span><span class="p">}</span><span class="w">  </span><span class="c1">// illegal,</span>
<span class="w">    </span><span class="k">fn</span> <span class="nf">bar</span><span class="p">()</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="o">&lt;</span><span class="n">T</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">Trait</span><span class="o">&gt;</span>::<span class="n">some_method</span><span class="p">()</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="c1">// legal</span>
<span class="w">    </span><span class="k">fn</span> <span class="nf">boo</span><span class="p">()</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="o">&lt;</span><span class="n">T</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">Boo</span><span class="o">&gt;</span>::<span class="n">some_method</span><span class="p">()</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="c1">// illegal</span>
<span class="p">}</span><span class="w"></span>
</code></pre></div>



<a name="249712483"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/146212-t-compiler/const-eval/topic/const_trait_impl%27s%20syntax/near/249712483" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> oli <a href="https://zulip-archive.rust-lang.org/stream/146212-t-compiler/const-eval/topic/const_trait_impl&#x27;s.20syntax.html#249712483">(Aug 17 2021 at 12:44)</a>:</h4>
<p>from the outside, so when calling <code>&lt;SomeStruct&lt;T&gt; as OtherTrait&gt;::something()</code>, you now need to supply a <code>T</code> with a const <code>Trait</code> impl if you are calling that function from within a const context, and can use any <code>T: Trait</code> otherwise</p>



<a name="249712511"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/146212-t-compiler/const-eval/topic/const_trait_impl%27s%20syntax/near/249712511" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> oli <a href="https://zulip-archive.rust-lang.org/stream/146212-t-compiler/const-eval/topic/const_trait_impl&#x27;s.20syntax.html#249712511">(Aug 17 2021 at 12:44)</a>:</h4>
<p>this behaviour is already implemented today with the implicit syntax</p>



<a name="249712515"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/146212-t-compiler/const-eval/topic/const_trait_impl%27s%20syntax/near/249712515" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> RalfJ <a href="https://zulip-archive.rust-lang.org/stream/146212-t-compiler/const-eval/topic/const_trait_impl&#x27;s.20syntax.html#249712515">(Aug 17 2021 at 12:44)</a>:</h4>
<blockquote>
<p>there is no fundamental difference between "const if in const" bounds on const fn and on impl const Trait</p>
</blockquote>
<p>there is, see all the discussion we just had^^</p>



<a name="249712604"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/146212-t-compiler/const-eval/topic/const_trait_impl%27s%20syntax/near/249712604" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> oli <a href="https://zulip-archive.rust-lang.org/stream/146212-t-compiler/const-eval/topic/const_trait_impl&#x27;s.20syntax.html#249712604">(Aug 17 2021 at 12:45)</a>:</h4>
<p>no, that was about <code>const fn</code> vs <code>fn</code> in impl blocks</p>



<a name="249712629"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/146212-t-compiler/const-eval/topic/const_trait_impl%27s%20syntax/near/249712629" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> RalfJ <a href="https://zulip-archive.rust-lang.org/stream/146212-t-compiler/const-eval/topic/const_trait_impl&#x27;s.20syntax.html#249712629">(Aug 17 2021 at 12:45)</a>:</h4>
<p>right so just add an assoc const to the above</p>



<a name="249712651"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/146212-t-compiler/const-eval/topic/const_trait_impl%27s%20syntax/near/249712651" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> oli <a href="https://zulip-archive.rust-lang.org/stream/146212-t-compiler/const-eval/topic/const_trait_impl&#x27;s.20syntax.html#249712651">(Aug 17 2021 at 12:45)</a>:</h4>
<p>that's <code>foo</code></p>



<a name="249712654"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/146212-t-compiler/const-eval/topic/const_trait_impl%27s%20syntax/near/249712654" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> oli <a href="https://zulip-archive.rust-lang.org/stream/146212-t-compiler/const-eval/topic/const_trait_impl&#x27;s.20syntax.html#249712654">(Aug 17 2021 at 12:45)</a>:</h4>
<p>same thing</p>



<a name="249712663"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/146212-t-compiler/const-eval/topic/const_trait_impl%27s%20syntax/near/249712663" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> oli <a href="https://zulip-archive.rust-lang.org/stream/146212-t-compiler/const-eval/topic/const_trait_impl&#x27;s.20syntax.html#249712663">(Aug 17 2021 at 12:45)</a>:</h4>
<p>can't use it</p>



<a name="249712751"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/146212-t-compiler/const-eval/topic/const_trait_impl%27s%20syntax/near/249712751" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> RalfJ <a href="https://zulip-archive.rust-lang.org/stream/146212-t-compiler/const-eval/topic/const_trait_impl&#x27;s.20syntax.html#249712751">(Aug 17 2021 at 12:46)</a>:</h4>
<p>that doesnt seem to make much sense though</p>



<a name="249712803"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/146212-t-compiler/const-eval/topic/const_trait_impl%27s%20syntax/near/249712803" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> oli <a href="https://zulip-archive.rust-lang.org/stream/146212-t-compiler/const-eval/topic/const_trait_impl&#x27;s.20syntax.html#249712803">(Aug 17 2021 at 12:46)</a>:</h4>
<p>it makes as much sense as not being able to do <code>let x: T = ..</code> for <code>T: ?Sized</code></p>



<a name="249712813"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/146212-t-compiler/const-eval/topic/const_trait_impl%27s%20syntax/near/249712813" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> oli <a href="https://zulip-archive.rust-lang.org/stream/146212-t-compiler/const-eval/topic/const_trait_impl&#x27;s.20syntax.html#249712813">(Aug 17 2021 at 12:47)</a>:</h4>
<p>you don't know the constness</p>



<a name="249712824"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/146212-t-compiler/const-eval/topic/const_trait_impl%27s%20syntax/near/249712824" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> oli <a href="https://zulip-archive.rust-lang.org/stream/146212-t-compiler/const-eval/topic/const_trait_impl&#x27;s.20syntax.html#249712824">(Aug 17 2021 at 12:47)</a>:</h4>
<p>thus you can't rely on it</p>



<a name="249712851"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/146212-t-compiler/const-eval/topic/const_trait_impl%27s%20syntax/near/249712851" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> RalfJ <a href="https://zulip-archive.rust-lang.org/stream/146212-t-compiler/const-eval/topic/const_trait_impl&#x27;s.20syntax.html#249712851">(Aug 17 2021 at 12:47)</a>:</h4>
<p><span class="user-mention silent" data-user-id="124288">oli</span> <a href="#narrow/stream/146212-t-compiler.2Fconst-eval/topic/const_trait_impl's.20syntax/near/249712803">said</a>:</p>
<blockquote>
<p>it makes as much sense as not being able to do <code>let x: T = ..</code> for <code>T: ?Sized</code></p>
</blockquote>
<p>uh that comparison makes even less sense to me :P</p>



<a name="249712873"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/146212-t-compiler/const-eval/topic/const_trait_impl%27s%20syntax/near/249712873" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> RalfJ <a href="https://zulip-archive.rust-lang.org/stream/146212-t-compiler/const-eval/topic/const_trait_impl&#x27;s.20syntax.html#249712873">(Aug 17 2021 at 12:47)</a>:</h4>
<p><span class="user-mention silent" data-user-id="124288">oli</span> <a href="#narrow/stream/146212-t-compiler.2Fconst-eval/topic/const_trait_impl's.20syntax/near/249712824">said</a>:</p>
<blockquote>
<p>thus you can't rely on it</p>
</blockquote>
<p>Im not. it's literally in a <code>const</code> block.^^</p>



<a name="249712894"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/146212-t-compiler/const-eval/topic/const_trait_impl%27s%20syntax/near/249712894" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> oli <a href="https://zulip-archive.rust-lang.org/stream/146212-t-compiler/const-eval/topic/const_trait_impl&#x27;s.20syntax.html#249712894">(Aug 17 2021 at 12:47)</a>:</h4>
<p>yea, and that is an error</p>



<a name="249712908"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/146212-t-compiler/const-eval/topic/const_trait_impl%27s%20syntax/near/249712908" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> oli <a href="https://zulip-archive.rust-lang.org/stream/146212-t-compiler/const-eval/topic/const_trait_impl&#x27;s.20syntax.html#249712908">(Aug 17 2021 at 12:47)</a>:</h4>
<p>I wrote "illegal"</p>



<a name="249712929"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/146212-t-compiler/const-eval/topic/const_trait_impl%27s%20syntax/near/249712929" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> RalfJ <a href="https://zulip-archive.rust-lang.org/stream/146212-t-compiler/const-eval/topic/const_trait_impl&#x27;s.20syntax.html#249712929">(Aug 17 2021 at 12:47)</a>:</h4>
<p>yea and that makes no sense, is what I said ;)</p>



<a name="249712994"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/146212-t-compiler/const-eval/topic/const_trait_impl%27s%20syntax/near/249712994" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> RalfJ <a href="https://zulip-archive.rust-lang.org/stream/146212-t-compiler/const-eval/topic/const_trait_impl&#x27;s.20syntax.html#249712994">(Aug 17 2021 at 12:48)</a>:</h4>
<p>or rather, seems to make little sense</p>



<a name="249712995"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/146212-t-compiler/const-eval/topic/const_trait_impl%27s%20syntax/near/249712995" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> oli <a href="https://zulip-archive.rust-lang.org/stream/146212-t-compiler/const-eval/topic/const_trait_impl&#x27;s.20syntax.html#249712995">(Aug 17 2021 at 12:48)</a>:</h4>
<p>then we need an effect system afaict</p>



<a name="249713000"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/146212-t-compiler/const-eval/topic/const_trait_impl%27s%20syntax/near/249713000" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> oli <a href="https://zulip-archive.rust-lang.org/stream/146212-t-compiler/const-eval/topic/const_trait_impl&#x27;s.20syntax.html#249713000">(Aug 17 2021 at 12:48)</a>:</h4>
<p>idk</p>



<a name="249713014"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/146212-t-compiler/const-eval/topic/const_trait_impl%27s%20syntax/near/249713014" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> oli <a href="https://zulip-archive.rust-lang.org/stream/146212-t-compiler/const-eval/topic/const_trait_impl&#x27;s.20syntax.html#249713014">(Aug 17 2021 at 12:48)</a>:</h4>
<p>what do you feel like is the problem here?</p>



<a name="249713202"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/146212-t-compiler/const-eval/topic/const_trait_impl%27s%20syntax/near/249713202" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> RalfJ <a href="https://zulip-archive.rust-lang.org/stream/146212-t-compiler/const-eval/topic/const_trait_impl&#x27;s.20syntax.html#249713202">(Aug 17 2021 at 12:50)</a>:</h4>
<p>what is and isnt allowed seems extremely surprising</p>



<a name="249713258"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/146212-t-compiler/const-eval/topic/const_trait_impl%27s%20syntax/near/249713258" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> RalfJ <a href="https://zulip-archive.rust-lang.org/stream/146212-t-compiler/const-eval/topic/const_trait_impl&#x27;s.20syntax.html#249713258">(Aug 17 2021 at 12:51)</a>:</h4>
<p><code>impl const Trait</code> sounds like basically all functions need to be <code>const fn</code>, but then the rules should be the same for <code>foo</code> and <code>bar</code></p>



<a name="249713279"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/146212-t-compiler/const-eval/topic/const_trait_impl%27s%20syntax/near/249713279" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> RalfJ <a href="https://zulip-archive.rust-lang.org/stream/146212-t-compiler/const-eval/topic/const_trait_impl&#x27;s.20syntax.html#249713279">(Aug 17 2021 at 12:51)</a>:</h4>
<p>but this is not <code>impl const Trait</code>, this is <code>impl const? Trait</code></p>



<a name="249713489"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/146212-t-compiler/const-eval/topic/const_trait_impl%27s%20syntax/near/249713489" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> RalfJ <a href="https://zulip-archive.rust-lang.org/stream/146212-t-compiler/const-eval/topic/const_trait_impl&#x27;s.20syntax.html#249713489">(Aug 17 2021 at 12:52)</a>:</h4>
<p>this is</p>
<div class="codehilite" data-code-language="Rust"><pre><span></span><code><span class="k">impl</span><span class="o">&lt;</span><span class="n">C</span>: <span class="nc">Constness</span><span class="p">,</span><span class="w"> </span><span class="n">T</span>: <span class="nc">constif</span><span class="p">(</span><span class="n">C</span><span class="p">)</span><span class="w"> </span><span class="n">Trait</span><span class="o">&gt;</span><span class="w"> </span><span class="n">constif</span><span class="p">(</span><span class="n">C</span><span class="p">)</span><span class="w"> </span><span class="n">OtherTrait</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">Type</span><span class="w"></span>
</code></pre></div>
<p>which is not at all what I expect from the <code>impl const OtherTrait</code> syntax</p>



<a name="249718259"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/146212-t-compiler/const-eval/topic/const_trait_impl%27s%20syntax/near/249718259" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> oli <a href="https://zulip-archive.rust-lang.org/stream/146212-t-compiler/const-eval/topic/const_trait_impl&#x27;s.20syntax.html#249718259">(Aug 17 2021 at 13:28)</a>:</h4>
<p>no</p>



<a name="249718266"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/146212-t-compiler/const-eval/topic/const_trait_impl%27s%20syntax/near/249718266" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> oli <a href="https://zulip-archive.rust-lang.org/stream/146212-t-compiler/const-eval/topic/const_trait_impl&#x27;s.20syntax.html#249718266">(Aug 17 2021 at 13:28)</a>:</h4>
<p>that's not what it is</p>



<a name="249718354"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/146212-t-compiler/const-eval/topic/const_trait_impl%27s%20syntax/near/249718354" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> oli <a href="https://zulip-archive.rust-lang.org/stream/146212-t-compiler/const-eval/topic/const_trait_impl&#x27;s.20syntax.html#249718354">(Aug 17 2021 at 13:29)</a>:</h4>
<p><del><code>impl&lt;C: Constness, T: constif(C) Trait&gt; const OtherTrait for Type</code>. But</del> since <code>T: constif(C) Trait</code>, you cannot use it where <code>T: const Trait</code> is required, only where <code>T: constif(X) Trait</code> is required</p>



<a name="249718366"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/146212-t-compiler/const-eval/topic/const_trait_impl%27s%20syntax/near/249718366" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> oli <a href="https://zulip-archive.rust-lang.org/stream/146212-t-compiler/const-eval/topic/const_trait_impl&#x27;s.20syntax.html#249718366">(Aug 17 2021 at 13:29)</a>:</h4>
<p>and any const item will require <code>const Trait</code></p>



<a name="249718617"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/146212-t-compiler/const-eval/topic/const_trait_impl%27s%20syntax/near/249718617" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> RalfJ <a href="https://zulip-archive.rust-lang.org/stream/146212-t-compiler/const-eval/topic/const_trait_impl&#x27;s.20syntax.html#249718617">(Aug 17 2021 at 13:31)</a>:</h4>
<blockquote>
<p><code>impl&lt;C: Constness, T: constif(C) Trait&gt; const OtherTrait for Type</code></p>
</blockquote>
<p>I cant make sense of that -- these <code>C: Constness</code> parameters only make sense when they are used more than once</p>



<a name="249718648"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/146212-t-compiler/const-eval/topic/const_trait_impl%27s%20syntax/near/249718648" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> oli <a href="https://zulip-archive.rust-lang.org/stream/146212-t-compiler/const-eval/topic/const_trait_impl&#x27;s.20syntax.html#249718648">(Aug 17 2021 at 13:31)</a>:</h4>
<p>oh</p>



<a name="249718649"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/146212-t-compiler/const-eval/topic/const_trait_impl%27s%20syntax/near/249718649" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> RalfJ <a href="https://zulip-archive.rust-lang.org/stream/146212-t-compiler/const-eval/topic/const_trait_impl&#x27;s.20syntax.html#249718649">(Aug 17 2021 at 13:31)</a>:</h4>
<p>they are all about tying together the constness of at least 2 things</p>



<a name="249718655"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/146212-t-compiler/const-eval/topic/const_trait_impl%27s%20syntax/near/249718655" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> oli <a href="https://zulip-archive.rust-lang.org/stream/146212-t-compiler/const-eval/topic/const_trait_impl&#x27;s.20syntax.html#249718655">(Aug 17 2021 at 13:31)</a>:</h4>
<p>yea you're right</p>



<a name="249718658"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/146212-t-compiler/const-eval/topic/const_trait_impl%27s%20syntax/near/249718658" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> oli <a href="https://zulip-archive.rust-lang.org/stream/146212-t-compiler/const-eval/topic/const_trait_impl&#x27;s.20syntax.html#249718658">(Aug 17 2021 at 13:32)</a>:</h4>
<p>sorry</p>



<a name="249718720"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/146212-t-compiler/const-eval/topic/const_trait_impl%27s%20syntax/near/249718720" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> oli <a href="https://zulip-archive.rust-lang.org/stream/146212-t-compiler/const-eval/topic/const_trait_impl&#x27;s.20syntax.html#249718720">(Aug 17 2021 at 13:32)</a>:</h4>
<p>but that doesn't change the internal behaviour</p>



<a name="249718786"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/146212-t-compiler/const-eval/topic/const_trait_impl%27s%20syntax/near/249718786" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> RalfJ <a href="https://zulip-archive.rust-lang.org/stream/146212-t-compiler/const-eval/topic/const_trait_impl&#x27;s.20syntax.html#249718786">(Aug 17 2021 at 13:32)</a>:</h4>
<p>so is my interpretation above correct, that this is <code>impl&lt;C: Constness, T: constif(C) Trait&gt; constif(C) OtherTrait for Type</code>?</p>



<a name="249718799"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/146212-t-compiler/const-eval/topic/const_trait_impl%27s%20syntax/near/249718799" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> oli <a href="https://zulip-archive.rust-lang.org/stream/146212-t-compiler/const-eval/topic/const_trait_impl&#x27;s.20syntax.html#249718799">(Aug 17 2021 at 13:32)</a>:</h4>
<p>yes</p>



<a name="249718826"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/146212-t-compiler/const-eval/topic/const_trait_impl%27s%20syntax/near/249718826" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> RalfJ <a href="https://zulip-archive.rust-lang.org/stream/146212-t-compiler/const-eval/topic/const_trait_impl&#x27;s.20syntax.html#249718826">(Aug 17 2021 at 13:33)</a>:</h4>
<p>right, so I was completely lead down the wrong path by the syntax then</p>



<a name="249718833"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/146212-t-compiler/const-eval/topic/const_trait_impl%27s%20syntax/near/249718833" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> oli <a href="https://zulip-archive.rust-lang.org/stream/146212-t-compiler/const-eval/topic/const_trait_impl&#x27;s.20syntax.html#249718833">(Aug 17 2021 at 13:33)</a>:</h4>
<p>this is how the RFC specified it, too</p>



<a name="249718867"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/146212-t-compiler/const-eval/topic/const_trait_impl%27s%20syntax/near/249718867" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> oli <a href="https://zulip-archive.rust-lang.org/stream/146212-t-compiler/const-eval/topic/const_trait_impl&#x27;s.20syntax.html#249718867">(Aug 17 2021 at 13:33)</a>:</h4>
<p>and the RFC had this written in the pseudo effect syntax similar to what you wrote</p>



<a name="249718922"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/146212-t-compiler/const-eval/topic/const_trait_impl%27s%20syntax/near/249718922" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> oli <a href="https://zulip-archive.rust-lang.org/stream/146212-t-compiler/const-eval/topic/const_trait_impl&#x27;s.20syntax.html#249718922">(Aug 17 2021 at 13:33)</a>:</h4>
<p>otherwise we couldn't make anything generic in libstd use const</p>



<a name="249718935"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/146212-t-compiler/const-eval/topic/const_trait_impl%27s%20syntax/near/249718935" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> oli <a href="https://zulip-archive.rust-lang.org/stream/146212-t-compiler/const-eval/topic/const_trait_impl&#x27;s.20syntax.html#249718935">(Aug 17 2021 at 13:33)</a>:</h4>
<p>as that would be a breaking change</p>



<a name="249719021"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/146212-t-compiler/const-eval/topic/const_trait_impl%27s%20syntax/near/249719021" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> oli <a href="https://zulip-archive.rust-lang.org/stream/146212-t-compiler/const-eval/topic/const_trait_impl&#x27;s.20syntax.html#249719021">(Aug 17 2021 at 13:34)</a>:</h4>
<p>and it would create a const ecosystem in parallel to the not-const ecosystem</p>



<a name="249719045"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/146212-t-compiler/const-eval/topic/const_trait_impl%27s%20syntax/near/249719045" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> oli <a href="https://zulip-archive.rust-lang.org/stream/146212-t-compiler/const-eval/topic/const_trait_impl&#x27;s.20syntax.html#249719045">(Aug 17 2021 at 13:34)</a>:</h4>
<p>which is exactly what we wanted to avoid</p>



<a name="249719068"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/146212-t-compiler/const-eval/topic/const_trait_impl%27s%20syntax/near/249719068" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> RalfJ <a href="https://zulip-archive.rust-lang.org/stream/146212-t-compiler/const-eval/topic/const_trait_impl&#x27;s.20syntax.html#249719068">(Aug 17 2021 at 13:34)</a>:</h4>
<p>yeah... but after the discussion we just had about <code>const Trait</code> bounds, I totally did not expect <code>const Trait</code> imples to also be non-const impls</p>



<a name="249719082"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/146212-t-compiler/const-eval/topic/const_trait_impl%27s%20syntax/near/249719082" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> oli <a href="https://zulip-archive.rust-lang.org/stream/146212-t-compiler/const-eval/topic/const_trait_impl&#x27;s.20syntax.html#249719082">(Aug 17 2021 at 13:34)</a>:</h4>
<p>ah</p>



<a name="249719091"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/146212-t-compiler/const-eval/topic/const_trait_impl%27s%20syntax/near/249719091" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> oli <a href="https://zulip-archive.rust-lang.org/stream/146212-t-compiler/const-eval/topic/const_trait_impl&#x27;s.20syntax.html#249719091">(Aug 17 2021 at 13:34)</a>:</h4>
<p>well.. everything is in flux xD</p>



<a name="249719096"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/146212-t-compiler/const-eval/topic/const_trait_impl%27s%20syntax/near/249719096" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> RalfJ <a href="https://zulip-archive.rust-lang.org/stream/146212-t-compiler/const-eval/topic/const_trait_impl&#x27;s.20syntax.html#249719096">(Aug 17 2021 at 13:34)</a>:</h4>
<p>the <em>concept</em> makes sense, but the syntax tripped me</p>



<a name="249719100"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/146212-t-compiler/const-eval/topic/const_trait_impl%27s%20syntax/near/249719100" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> oli <a href="https://zulip-archive.rust-lang.org/stream/146212-t-compiler/const-eval/topic/const_trait_impl&#x27;s.20syntax.html#249719100">(Aug 17 2021 at 13:34)</a>:</h4>
<p>maybe we should do <code>impl ?const Trait</code>?</p>



<a name="249719130"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/146212-t-compiler/const-eval/topic/const_trait_impl%27s%20syntax/near/249719130" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> RalfJ <a href="https://zulip-archive.rust-lang.org/stream/146212-t-compiler/const-eval/topic/const_trait_impl&#x27;s.20syntax.html#249719130">(Aug 17 2021 at 13:35)</a>:</h4>
<p>adding more <code>?</code> everywhere is sure going to help avoid everyone being confused :P</p>



<a name="249719135"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/146212-t-compiler/const-eval/topic/const_trait_impl%27s%20syntax/near/249719135" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> oli <a href="https://zulip-archive.rust-lang.org/stream/146212-t-compiler/const-eval/topic/const_trait_impl&#x27;s.20syntax.html#249719135">(Aug 17 2021 at 13:35)</a>:</h4>
<p>well</p>



<a name="249719144"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/146212-t-compiler/const-eval/topic/const_trait_impl%27s%20syntax/near/249719144" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> oli <a href="https://zulip-archive.rust-lang.org/stream/146212-t-compiler/const-eval/topic/const_trait_impl&#x27;s.20syntax.html#249719144">(Aug 17 2021 at 13:35)</a>:</h4>
<p>come up with a better syntax XD</p>



<a name="249719145"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/146212-t-compiler/const-eval/topic/const_trait_impl%27s%20syntax/near/249719145" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> RalfJ <a href="https://zulip-archive.rust-lang.org/stream/146212-t-compiler/const-eval/topic/const_trait_impl&#x27;s.20syntax.html#249719145">(Aug 17 2021 at 13:35)</a>:</h4>
<p>but yeah that's why I said "this is <code>impl const? Trait</code>" above</p>



<a name="249719173"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/146212-t-compiler/const-eval/topic/const_trait_impl%27s%20syntax/near/249719173" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> oli <a href="https://zulip-archive.rust-lang.org/stream/146212-t-compiler/const-eval/topic/const_trait_impl&#x27;s.20syntax.html#249719173">(Aug 17 2021 at 13:35)</a>:</h4>
<p>your placement of the question mark operator does not help things <span aria-label="stuck out tongue" class="emoji emoji-1f61b" role="img" title="stuck out tongue">:stuck_out_tongue:</span></p>



<a name="249719185"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/146212-t-compiler/const-eval/topic/const_trait_impl%27s%20syntax/near/249719185" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> RalfJ <a href="https://zulip-archive.rust-lang.org/stream/146212-t-compiler/const-eval/topic/const_trait_impl&#x27;s.20syntax.html#249719185">(Aug 17 2021 at 13:35)</a>:</h4>
<p>no it makes all the difference :P</p>



<a name="249719192"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/146212-t-compiler/const-eval/topic/const_trait_impl%27s%20syntax/near/249719192" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> oli <a href="https://zulip-archive.rust-lang.org/stream/146212-t-compiler/const-eval/topic/const_trait_impl&#x27;s.20syntax.html#249719192">(Aug 17 2021 at 13:35)</a>:</h4>
<p>oh</p>



<a name="249719196"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/146212-t-compiler/const-eval/topic/const_trait_impl%27s%20syntax/near/249719196" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> oli <a href="https://zulip-archive.rust-lang.org/stream/146212-t-compiler/const-eval/topic/const_trait_impl&#x27;s.20syntax.html#249719196">(Aug 17 2021 at 13:35)</a>:</h4>
<p>like regex?</p>



<a name="249719210"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/146212-t-compiler/const-eval/topic/const_trait_impl%27s%20syntax/near/249719210" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> RalfJ <a href="https://zulip-archive.rust-lang.org/stream/146212-t-compiler/const-eval/topic/const_trait_impl&#x27;s.20syntax.html#249719210">(Aug 17 2021 at 13:36)</a>:</h4>
<p>we can have a compromise: <code>impl ?const? Trait</code></p>



<a name="249719245"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/146212-t-compiler/const-eval/topic/const_trait_impl%27s%20syntax/near/249719245" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> oli <a href="https://zulip-archive.rust-lang.org/stream/146212-t-compiler/const-eval/topic/const_trait_impl&#x27;s.20syntax.html#249719245">(Aug 17 2021 at 13:36)</a>:</h4>
<p>rofl</p>



<a name="249719284"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/146212-t-compiler/const-eval/topic/const_trait_impl%27s%20syntax/near/249719284" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> oli <a href="https://zulip-archive.rust-lang.org/stream/146212-t-compiler/const-eval/topic/const_trait_impl&#x27;s.20syntax.html#249719284">(Aug 17 2021 at 13:36)</a>:</h4>
<p><span class="user-mention silent" data-user-id="124288">oli</span> <a href="#narrow/stream/146212-t-compiler.2Fconst-eval/topic/const_trait_impl's.20syntax/near/249719245">said</a>:</p>
<blockquote>
<p>rofl</p>
</blockquote>
<p>I almost fell of my chair</p>



<a name="249719302"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/146212-t-compiler/const-eval/topic/const_trait_impl%27s%20syntax/near/249719302" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> RalfJ <a href="https://zulip-archive.rust-lang.org/stream/146212-t-compiler/const-eval/topic/const_trait_impl&#x27;s.20syntax.html#249719302">(Aug 17 2021 at 13:36)</a>:</h4>
<p>:-)</p>



<a name="249719369"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/146212-t-compiler/const-eval/topic/const_trait_impl%27s%20syntax/near/249719369" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> oli <a href="https://zulip-archive.rust-lang.org/stream/146212-t-compiler/const-eval/topic/const_trait_impl&#x27;s.20syntax.html#249719369">(Aug 17 2021 at 13:36)</a>:</h4>
<p>whatever. I don't care if we introduce a <code>inferconst</code> keyword or do some other stuff</p>



<a name="249719468"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/146212-t-compiler/const-eval/topic/const_trait_impl%27s%20syntax/near/249719468" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> oli <a href="https://zulip-archive.rust-lang.org/stream/146212-t-compiler/const-eval/topic/const_trait_impl&#x27;s.20syntax.html#249719468">(Aug 17 2021 at 13:37)</a>:</h4>
<p>but I have come over to your side of just allowing all trait bounds in const fn and make them unusable to call and add new syntax that actually makes them callable</p>



<a name="249719568"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/146212-t-compiler/const-eval/topic/const_trait_impl%27s%20syntax/near/249719568" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> oli <a href="https://zulip-archive.rust-lang.org/stream/146212-t-compiler/const-eval/topic/const_trait_impl&#x27;s.20syntax.html#249719568">(Aug 17 2021 at 13:38)</a>:</h4>
<p>which solves all inconsistencies between const items already being allowed to use traits and fn pointers</p>



<a name="249719788"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/146212-t-compiler/const-eval/topic/const_trait_impl%27s%20syntax/near/249719788" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> RalfJ <a href="https://zulip-archive.rust-lang.org/stream/146212-t-compiler/const-eval/topic/const_trait_impl&#x27;s.20syntax.html#249719788">(Aug 17 2021 at 13:40)</a>:</h4>
<p><span class="user-mention silent" data-user-id="124288">oli</span> <a href="#narrow/stream/146212-t-compiler.2Fconst-eval/topic/const_trait_impl's.20syntax/near/249719468">said</a>:</p>
<blockquote>
<p>but I have come over to your side of just allowing all trait bounds in const fn and make them unusable to call and add new syntax that actually makes them callable</p>
</blockquote>
<p>"them" = the bounds, as in the const fn cannot call trait fn even though (non-const) bounds are in scope?<br>
(alternative interpretation: them = the const fn)</p>



<a name="249720474"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/146212-t-compiler/const-eval/topic/const_trait_impl%27s%20syntax/near/249720474" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> oli <a href="https://zulip-archive.rust-lang.org/stream/146212-t-compiler/const-eval/topic/const_trait_impl&#x27;s.20syntax.html#249720474">(Aug 17 2021 at 13:44)</a>:</h4>
<p>zes, the bounds</p>



<a name="249723707"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/146212-t-compiler/const-eval/topic/const_trait_impl%27s%20syntax/near/249723707" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lokathor <a href="https://zulip-archive.rust-lang.org/stream/146212-t-compiler/const-eval/topic/const_trait_impl&#x27;s.20syntax.html#249723707">(Aug 17 2021 at 14:07)</a>:</h4>
<p>wait <code>impl const Trait</code> can be satisfied by a non-const trait impl some of the time? Did I skim that right?</p>



<a name="249724163"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/146212-t-compiler/const-eval/topic/const_trait_impl%27s%20syntax/near/249724163" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> RalfJ <a href="https://zulip-archive.rust-lang.org/stream/146212-t-compiler/const-eval/topic/const_trait_impl&#x27;s.20syntax.html#249724163">(Aug 17 2021 at 14:10)</a>:</h4>
<p><code>impl const Trait</code> is an impl block, what does it even mean for an impl block to be "satisifed"? <em>bounds</em> can be satisified, but impls...?</p>



<a name="249725282"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/146212-t-compiler/const-eval/topic/const_trait_impl%27s%20syntax/near/249725282" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> fee1-dead <a href="https://zulip-archive.rust-lang.org/stream/146212-t-compiler/const-eval/topic/const_trait_impl&#x27;s.20syntax.html#249725282">(Aug 17 2021 at 14:17)</a>:</h4>
<p><span class="user-mention silent" data-user-id="124288">oli</span> <a href="#narrow/stream/146212-t-compiler.2Fconst-eval/topic/const_trait_impl's.20syntax/near/249705605">said</a>:</p>
<blockquote>
<p>which is fine if we never need such a feature, but we should at least consider if we want to throw away the obvious syntax for that forever</p>
</blockquote>
<p>Maybe we can introduce new syntax for that feature: <code>const!</code> which means "must be const". Or instead of using <code>?const</code> to signify const-if-const, we use <code>~const</code> or something else. I don't like the implicitness of the current syntax. It is fine to separate "always const" functions from "const if some generic parameters have const impls for some traits" functions.</p>



<a name="249731539"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/146212-t-compiler/const-eval/topic/const_trait_impl%27s%20syntax/near/249731539" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Josh Triplett <a href="https://zulip-archive.rust-lang.org/stream/146212-t-compiler/const-eval/topic/const_trait_impl&#x27;s.20syntax.html#249731539">(Aug 17 2021 at 15:00)</a>:</h4>
<p><code>!</code> in Rust is either "not" or "macro"; we don't have any precedent for using it to mean "I mean it" or similar emphasis.</p>



<a name="249731608"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/146212-t-compiler/const-eval/topic/const_trait_impl%27s%20syntax/near/249731608" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> simulacrum <a href="https://zulip-archive.rust-lang.org/stream/146212-t-compiler/const-eval/topic/const_trait_impl&#x27;s.20syntax.html#249731608">(Aug 17 2021 at 15:01)</a>:</h4>
<p>(or never type)</p>



<a name="249731645"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/146212-t-compiler/const-eval/topic/const_trait_impl%27s%20syntax/near/249731645" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Christian Poveda <a href="https://zulip-archive.rust-lang.org/stream/146212-t-compiler/const-eval/topic/const_trait_impl&#x27;s.20syntax.html#249731645">(Aug 17 2021 at 15:01)</a>:</h4>
<p>I'd rather use <code>?const</code> and <code>const</code> to be consistent with <code>Sized</code>.</p>



<a name="249732203"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/146212-t-compiler/const-eval/topic/const_trait_impl%27s%20syntax/near/249732203" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lokathor <a href="https://zulip-archive.rust-lang.org/stream/146212-t-compiler/const-eval/topic/const_trait_impl&#x27;s.20syntax.html#249732203">(Aug 17 2021 at 15:05)</a>:</h4>
<p>Sorry Ralf, I was thinking in arg position for a function.</p>



<a name="249732330"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/146212-t-compiler/const-eval/topic/const_trait_impl%27s%20syntax/near/249732330" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lokathor <a href="https://zulip-archive.rust-lang.org/stream/146212-t-compiler/const-eval/topic/const_trait_impl&#x27;s.20syntax.html#249732330">(Aug 17 2021 at 15:06)</a>:</h4>
<p>like impl vs dyn, not like the block</p>



<a name="249737517"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/146212-t-compiler/const-eval/topic/const_trait_impl%27s%20syntax/near/249737517" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> oli <a href="https://zulip-archive.rust-lang.org/stream/146212-t-compiler/const-eval/topic/const_trait_impl&#x27;s.20syntax.html#249737517">(Aug 17 2021 at 15:44)</a>:</h4>
<p>I like <code>~const</code>, "somewhat const" <span aria-label="grinning" class="emoji emoji-1f600" role="img" title="grinning">:grinning:</span></p>



<a name="249742343"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/146212-t-compiler/const-eval/topic/const_trait_impl%27s%20syntax/near/249742343" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> RalfJ <a href="https://zulip-archive.rust-lang.org/stream/146212-t-compiler/const-eval/topic/const_trait_impl&#x27;s.20syntax.html#249742343">(Aug 17 2021 at 16:18)</a>:</h4>
<p><span class="user-mention silent" data-user-id="224471">Lokathor</span> <a href="#narrow/stream/146212-t-compiler.2Fconst-eval/topic/const_trait_impl's.20syntax/near/249732203">said</a>:</p>
<blockquote>
<p>Sorry Ralf, I was thinking in arg position for a function.</p>
</blockquote>
<p>oh I see. I havent though about <code>impl const Trait</code> types, but I'd hope they are consistent with <code>dyn const Trait</code> :D</p>



<a name="249743873"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/146212-t-compiler/const-eval/topic/const_trait_impl%27s%20syntax/near/249743873" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> fee1-dead <a href="https://zulip-archive.rust-lang.org/stream/146212-t-compiler/const-eval/topic/const_trait_impl&#x27;s.20syntax.html#249743873">(Aug 17 2021 at 16:30)</a>:</h4>
<p><span class="user-mention silent" data-user-id="132916">Christian Poveda</span> <a href="#narrow/stream/146212-t-compiler.2Fconst-eval/topic/const_trait_impl's.20syntax/near/249731645">said</a>:</p>
<blockquote>
<p>I'd rather use <code>?const</code> and <code>const</code> to be consistent with <code>Sized</code>.</p>
</blockquote>
<p>If those are consistent with <code>Sized</code>, there is no way to signify that "if this type has a const impl for a trait, then this function is const, otherwise this function cannot be called in a const context" other than leaving any modifiers out.</p>
<p>IMO, the syntax could be: <code>T: Foo</code> <em>always</em> means a non-const bound, <code>T: ~const Foo</code> would mean "const-if-const" which will only be allowed for bounds on const items, and <code>T: const Foo</code> would mean <code>T</code> must implement <code>const Foo</code>, <em>always</em> (which should be in separate RFC from const_trait_impl).</p>



<a name="249744094"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/146212-t-compiler/const-eval/topic/const_trait_impl%27s%20syntax/near/249744094" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> RalfJ <a href="https://zulip-archive.rust-lang.org/stream/146212-t-compiler/const-eval/topic/const_trait_impl&#x27;s.20syntax.html#249744094">(Aug 17 2021 at 16:32)</a>:</h4>
<p>yeah the analogy with <code>Sized</code> doesn't really hold up</p>



<a name="249744131"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/146212-t-compiler/const-eval/topic/const_trait_impl%27s%20syntax/near/249744131" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> RalfJ <a href="https://zulip-archive.rust-lang.org/stream/146212-t-compiler/const-eval/topic/const_trait_impl&#x27;s.20syntax.html#249744131">(Aug 17 2021 at 16:32)</a>:</h4>
<p>the point of <code>?const</code> is to <em>tie together the constness of a bound and of the impl</em></p>



<a name="249744164"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/146212-t-compiler/const-eval/topic/const_trait_impl%27s%20syntax/near/249744164" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> RalfJ <a href="https://zulip-archive.rust-lang.org/stream/146212-t-compiler/const-eval/topic/const_trait_impl&#x27;s.20syntax.html#249744164">(Aug 17 2021 at 16:32)</a>:</h4>
<p>as is made explicit by</p>
<div class="codehilite" data-code-language="Rust"><pre><span></span><code><span class="k">impl</span><span class="o">&lt;</span><span class="n">C</span>: <span class="nc">Constness</span><span class="p">,</span><span class="w"> </span><span class="n">T</span>: <span class="nc">constif</span><span class="p">(</span><span class="n">C</span><span class="p">)</span><span class="w"> </span><span class="n">Trait</span><span class="o">&gt;</span><span class="w"> </span><span class="n">constif</span><span class="p">(</span><span class="n">C</span><span class="p">)</span><span class="w"> </span><span class="n">OtherTrait</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">Type</span><span class="w"></span>
</code></pre></div>



<a name="249744861"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/146212-t-compiler/const-eval/topic/const_trait_impl%27s%20syntax/near/249744861" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> fee1-dead <a href="https://zulip-archive.rust-lang.org/stream/146212-t-compiler/const-eval/topic/const_trait_impl&#x27;s.20syntax.html#249744861">(Aug 17 2021 at 16:37)</a>:</h4>
<p><span class="user-mention silent" data-user-id="120791">RalfJ</span> <a href="#narrow/stream/146212-t-compiler.2Fconst-eval/topic/const_trait_impl's.20syntax/near/249744131">said</a>:</p>
<blockquote>
<p>to <em>tie together the constness of a bound and of the impl</em></p>
</blockquote>
<p>and we can just use something like <code>~const</code>instead of <code>?const</code> to avoid the inconsistency with the meaning of <code>?Sized</code>, <em>problem solved</em></p>



<a name="249745024"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/146212-t-compiler/const-eval/topic/const_trait_impl%27s%20syntax/near/249745024" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> RalfJ <a href="https://zulip-archive.rust-lang.org/stream/146212-t-compiler/const-eval/topic/const_trait_impl&#x27;s.20syntax.html#249745024">(Aug 17 2021 at 16:39)</a>:</h4>
<p>except for the "uh, more sigilis" effect</p>



<a name="249745052"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/146212-t-compiler/const-eval/topic/const_trait_impl%27s%20syntax/near/249745052" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> RalfJ <a href="https://zulip-archive.rust-lang.org/stream/146212-t-compiler/const-eval/topic/const_trait_impl&#x27;s.20syntax.html#249745052">(Aug 17 2021 at 16:39)</a>:</h4>
<p>there's no easy answers in syntax, ever, and you dont "just" do anything^^</p>



<a name="249745320"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/146212-t-compiler/const-eval/topic/const_trait_impl%27s%20syntax/near/249745320" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> fee1-dead <a href="https://zulip-archive.rust-lang.org/stream/146212-t-compiler/const-eval/topic/const_trait_impl&#x27;s.20syntax.html#249745320">(Aug 17 2021 at 16:41)</a>:</h4>
<p>It's definitely better than having a full effect system, and also better than the syntax from the current proposal IMO.</p>



<a name="249745728"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/146212-t-compiler/const-eval/topic/const_trait_impl%27s%20syntax/near/249745728" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> oli <a href="https://zulip-archive.rust-lang.org/stream/146212-t-compiler/const-eval/topic/const_trait_impl&#x27;s.20syntax.html#249745728">(Aug 17 2021 at 16:44)</a>:</h4>
<p>we can always do something non-sigilly. <code>T: const in const Trait</code> <span aria-label="rofl" class="emoji emoji-1f923" role="img" title="rofl">:rofl:</span></p>



<a name="249745816"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/146212-t-compiler/const-eval/topic/const_trait_impl%27s%20syntax/near/249745816" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> oli <a href="https://zulip-archive.rust-lang.org/stream/146212-t-compiler/const-eval/topic/const_trait_impl&#x27;s.20syntax.html#249745816">(Aug 17 2021 at 16:45)</a>:</h4>
<p><span class="user-mention silent" data-user-id="124288">oli</span> <a href="#narrow/stream/146212-t-compiler.2Fconst-eval/topic/const_trait_impl's.20syntax/near/249745728">said</a>:</p>
<blockquote>
<p>we can always do something non-sigilly. <code>T: const in const Trait</code> <span aria-label="rofl" class="emoji emoji-1f923" role="img" title="rofl">:rofl:</span></p>
</blockquote>
<p>for real tho: if anyone comes up with a single word, we can likely do a thing where <code>T: your_word Trait</code> works, because that already doesn't compile today</p>



<a name="249746625"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/146212-t-compiler/const-eval/topic/const_trait_impl%27s%20syntax/near/249746625" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> fee1-dead <a href="https://zulip-archive.rust-lang.org/stream/146212-t-compiler/const-eval/topic/const_trait_impl&#x27;s.20syntax.html#249746625">(Aug 17 2021 at 16:51)</a>:</h4>
<p>Can we all agree that the rules of </p>
<ul>
<li><code>T: Trait</code> is a non-const bound</li>
<li><code>T: (insert modifier here) Trait</code> means const-if-const</li>
<li>and <code>T: const Trait</code>is a const bound</li>
</ul>
<p>is good and we need to find out what goes in "insert modifier here" as a next step for the RFC?</p>



<a name="249748279"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/146212-t-compiler/const-eval/topic/const_trait_impl%27s%20syntax/near/249748279" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> fee1-dead <a href="https://zulip-archive.rust-lang.org/stream/146212-t-compiler/const-eval/topic/const_trait_impl&#x27;s.20syntax.html#249748279">(Aug 17 2021 at 17:04)</a>:</h4>
<p>Maybe trying to reach consensus here isn't a great idea... I will draft a post/pre-rfc to post on internals to discuss this more.</p>



<a name="249748502"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/146212-t-compiler/const-eval/topic/const_trait_impl%27s%20syntax/near/249748502" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> RalfJ <a href="https://zulip-archive.rust-lang.org/stream/146212-t-compiler/const-eval/topic/const_trait_impl&#x27;s.20syntax.html#249748502">(Aug 17 2021 at 17:05)</a>:</h4>
<p>separating semantics consensus from syntax consensus is probably a good idea though :)</p>



<a name="249752351"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/146212-t-compiler/const-eval/topic/const_trait_impl%27s%20syntax/near/249752351" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> oli <a href="https://zulip-archive.rust-lang.org/stream/146212-t-compiler/const-eval/topic/const_trait_impl&#x27;s.20syntax.html#249752351">(Aug 17 2021 at 17:36)</a>:</h4>
<p><span class="user-mention silent" data-user-id="361356">fee1-dead</span> <a href="#narrow/stream/146212-t-compiler.2Fconst-eval/topic/const_trait_impl's.20syntax/near/249746625">said</a>:</p>
<blockquote>
<p>Can we all agree that the rules of </p>
<ul>
<li><code>T: Trait</code> is a non-const bound</li>
<li><code>T: (insert modifier here) Trait</code> means const-if-const</li>
<li>and <code>T: const Trait</code>is a const bound</li>
</ul>
</blockquote>
<p>This is how I see it, too</p>



<a name="249753790"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/146212-t-compiler/const-eval/topic/const_trait_impl%27s%20syntax/near/249753790" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> RalfJ <a href="https://zulip-archive.rust-lang.org/stream/146212-t-compiler/const-eval/topic/const_trait_impl&#x27;s.20syntax.html#249753790">(Aug 17 2021 at 17:49)</a>:</h4>
<blockquote>
<p>T: (insert modifier here) Trait means const-if-const</p>
</blockquote>
<p>this is well-defined in <code>impl const Trait</code> blocks via the desugaring above; for it to be meaningful elsewhere we should give similar desugarings</p>



<a name="249753907"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/146212-t-compiler/const-eval/topic/const_trait_impl%27s%20syntax/near/249753907" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> RalfJ <a href="https://zulip-archive.rust-lang.org/stream/146212-t-compiler/const-eval/topic/const_trait_impl&#x27;s.20syntax.html#249753907">(Aug 17 2021 at 17:50)</a>:</h4>
<p>but if we say we only accept such bounds in <code>impl const Trait</code> blocks, then -- agreed :)</p>



<a name="249753947"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/146212-t-compiler/const-eval/topic/const_trait_impl%27s%20syntax/near/249753947" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> RalfJ <a href="https://zulip-archive.rust-lang.org/stream/146212-t-compiler/const-eval/topic/const_trait_impl&#x27;s.20syntax.html#249753947">(Aug 17 2021 at 17:50)</a>:</h4>
<p>(and I mean in the top-level bounds for that block, not nested in <code>where</code> clauses inside the block)</p>



<a name="249757589"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/146212-t-compiler/const-eval/topic/const_trait_impl%27s%20syntax/near/249757589" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> fee1-dead <a href="https://zulip-archive.rust-lang.org/stream/146212-t-compiler/const-eval/topic/const_trait_impl&#x27;s.20syntax.html#249757589">(Aug 17 2021 at 18:18)</a>:</h4>
<p>I would expect the const-if-const bound on a <code>const fn</code> to work in the same way as a <code>const impl</code> described above.</p>



<a name="249758468"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/146212-t-compiler/const-eval/topic/const_trait_impl%27s%20syntax/near/249758468" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> RalfJ <a href="https://zulip-archive.rust-lang.org/stream/146212-t-compiler/const-eval/topic/const_trait_impl&#x27;s.20syntax.html#249758468">(Aug 17 2021 at 18:25)</a>:</h4>
<p>I think I can see that for inherent <code>const fn</code></p>



<a name="249758498"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/146212-t-compiler/const-eval/topic/const_trait_impl%27s%20syntax/near/249758498" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> RalfJ <a href="https://zulip-archive.rust-lang.org/stream/146212-t-compiler/const-eval/topic/const_trait_impl&#x27;s.20syntax.html#249758498">(Aug 17 2021 at 18:25)</a>:</h4>
<p>but if we ever have <code>const fn</code> in a <code>trait</code> I cant entirely make sense of this any more^^</p>



<a name="249758504"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/146212-t-compiler/const-eval/topic/const_trait_impl%27s%20syntax/near/249758504" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> oli <a href="https://zulip-archive.rust-lang.org/stream/146212-t-compiler/const-eval/topic/const_trait_impl&#x27;s.20syntax.html#249758504">(Aug 17 2021 at 18:25)</a>:</h4>
<p>and free const fn</p>



<a name="249758529"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/146212-t-compiler/const-eval/topic/const_trait_impl%27s%20syntax/near/249758529" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> RalfJ <a href="https://zulip-archive.rust-lang.org/stream/146212-t-compiler/const-eval/topic/const_trait_impl&#x27;s.20syntax.html#249758529">(Aug 17 2021 at 18:25)</a>:</h4>
<p>yes, I meant "non-trait"</p>



<a name="249758554"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/146212-t-compiler/const-eval/topic/const_trait_impl%27s%20syntax/near/249758554" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> RalfJ <a href="https://zulip-archive.rust-lang.org/stream/146212-t-compiler/const-eval/topic/const_trait_impl&#x27;s.20syntax.html#249758554">(Aug 17 2021 at 18:26)</a>:</h4>
<p>which I guess for now is all of them</p>



<a name="249758606"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/146212-t-compiler/const-eval/topic/const_trait_impl%27s%20syntax/near/249758606" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> RalfJ <a href="https://zulip-archive.rust-lang.org/stream/146212-t-compiler/const-eval/topic/const_trait_impl&#x27;s.20syntax.html#249758606">(Aug 17 2021 at 18:26)</a>:</h4>
<p>but still, this might be worth keeping in mind</p>



<a name="249758638"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/146212-t-compiler/const-eval/topic/const_trait_impl%27s%20syntax/near/249758638" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> oli <a href="https://zulip-archive.rust-lang.org/stream/146212-t-compiler/const-eval/topic/const_trait_impl&#x27;s.20syntax.html#249758638">(Aug 17 2021 at 18:26)</a>:</h4>
<p>yea</p>



<a name="249758724"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/146212-t-compiler/const-eval/topic/const_trait_impl%27s%20syntax/near/249758724" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> RalfJ <a href="https://zulip-archive.rust-lang.org/stream/146212-t-compiler/const-eval/topic/const_trait_impl&#x27;s.20syntax.html#249758724">(Aug 17 2021 at 18:27)</a>:</h4>
<p><span class="user-mention silent" data-user-id="120791">RalfJ</span> <a href="#narrow/stream/146212-t-compiler.2Fconst-eval/topic/const_trait_impl's.20syntax/near/249758468">said</a>:</p>
<blockquote>
<p>I think I can see that for inherent <code>const fn</code></p>
</blockquote>
<p>to be concrete, it'd be something like</p>
<div class="codehilite" data-code-language="Rust"><pre><span></span><code><span class="k">for</span><span class="o">&lt;</span><span class="n">C</span>: <span class="nc">Constness</span><span class="o">&gt;</span><span class="w"> </span><span class="n">constif</span><span class="p">(</span><span class="n">C</span><span class="p">)</span><span class="w"> </span><span class="k">fn</span> <span class="nf">foo</span><span class="o">&lt;</span><span class="n">T</span>: <span class="nc">cosntif</span><span class="p">(</span><span class="n">C</span><span class="p">)</span><span class="w"> </span><span class="n">Trait</span><span class="o">&gt;</span><span class="p">(</span><span class="n">x</span>: <span class="nc">T</span><span class="p">)</span><span class="w"></span>
</code></pre></div>



<a name="249758794"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/146212-t-compiler/const-eval/topic/const_trait_impl%27s%20syntax/near/249758794" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> RalfJ <a href="https://zulip-archive.rust-lang.org/stream/146212-t-compiler/const-eval/topic/const_trait_impl&#x27;s.20syntax.html#249758794">(Aug 17 2021 at 18:27)</a>:</h4>
<p>this I remember seeing spelled out in the RFC :D</p>



<a name="249758817"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/146212-t-compiler/const-eval/topic/const_trait_impl%27s%20syntax/near/249758817" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> RalfJ <a href="https://zulip-archive.rust-lang.org/stream/146212-t-compiler/const-eval/topic/const_trait_impl&#x27;s.20syntax.html#249758817">(Aug 17 2021 at 18:27)</a>:</h4>
<p>for the <code>impl</code> I dont think I saw it before, or maybe I forgot</p>



<a name="249872039"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/146212-t-compiler/const-eval/topic/const_trait_impl%27s%20syntax/near/249872039" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> fee1-dead <a href="https://zulip-archive.rust-lang.org/stream/146212-t-compiler/const-eval/topic/const_trait_impl&#x27;s.20syntax.html#249872039">(Aug 18 2021 at 16:03)</a>:</h4>
<p>FYI: I posted a draft/pre-rfc to <a href="https://internals.rust-lang.org/t/pre-rfc-revamped-const-trait-impl-aka-rfc-2632/15192">internals</a>.</p>



<a name="249876752"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/146212-t-compiler/const-eval/topic/const_trait_impl%27s%20syntax/near/249876752" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> oli <a href="https://zulip-archive.rust-lang.org/stream/146212-t-compiler/const-eval/topic/const_trait_impl&#x27;s.20syntax.html#249876752">(Aug 18 2021 at 16:39)</a>:</h4>
<p>fwiw: we got enough leeway as wg-const-eval to change the unstable feature's syntax in the ways you propose</p>



<a name="249876773"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/146212-t-compiler/const-eval/topic/const_trait_impl%27s%20syntax/near/249876773" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> oli <a href="https://zulip-archive.rust-lang.org/stream/146212-t-compiler/const-eval/topic/const_trait_impl&#x27;s.20syntax.html#249876773">(Aug 18 2021 at 16:39)</a>:</h4>
<p>without reiterating with T-lang</p>



<a name="249879882"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/146212-t-compiler/const-eval/topic/const_trait_impl%27s%20syntax/near/249879882" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> fee1-dead <a href="https://zulip-archive.rust-lang.org/stream/146212-t-compiler/const-eval/topic/const_trait_impl&#x27;s.20syntax.html#249879882">(Aug 18 2021 at 17:01)</a>:</h4>
<p>It will cause breakages. do we need to follow some sort of deprecation path (for <code>?const</code>) before we completely change the syntax?</p>



<a name="249884784"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/146212-t-compiler/const-eval/topic/const_trait_impl%27s%20syntax/near/249884784" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> oli <a href="https://zulip-archive.rust-lang.org/stream/146212-t-compiler/const-eval/topic/const_trait_impl&#x27;s.20syntax.html#249884784">(Aug 18 2021 at 17:35)</a>:</h4>
<p>nope, unstable feature, people need to adjust themselves</p>



<a name="250901080"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/146212-t-compiler/const-eval/topic/const_trait_impl%27s%20syntax/near/250901080" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Bot+ <a href="https://zulip-archive.rust-lang.org/stream/146212-t-compiler/const-eval/topic/const_trait_impl&#x27;s.20syntax.html#250901080">(Aug 27 2021 at 08:42)</a>:</h4>
<p>Tilde char  '~' is very annoying to type on some variants of ISO keyboard. I would love it if Rust never used ~.</p>
<p>Would <code>T = const X</code> work instead of <code>T: ~const X</code>?</p>
<div class="codehilite" data-code-language="Rust"><pre><span></span><code><span class="k">const</span><span class="w"> </span><span class="k">fn</span> <span class="nf">foo</span><span class="o">&lt;</span><span class="n">T</span><span class="o">=</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="n">X</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="k">dyn</span><span class="w"> </span><span class="n">Y</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">Z</span><span class="o">&gt;</span><span class="p">(</span><span class="n">input</span>: <span class="nc">T</span><span class="p">)</span><span class="w"> </span>-&gt; <span class="nc">T</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="n">input</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>
</code></pre></div>
<p>looks much nicer in my opinion. This syntax would match with const default values and be more obvious to people who are used to  <code>param="value";</code> pattern.</p>



<a name="250904610"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/146212-t-compiler/const-eval/topic/const_trait_impl%27s%20syntax/near/250904610" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Giacomo Stevanato <a href="https://zulip-archive.rust-lang.org/stream/146212-t-compiler/const-eval/topic/const_trait_impl&#x27;s.20syntax.html#250904610">(Aug 27 2021 at 09:18)</a>:</h4>
<p>Wouldn't that imply some kind of default parameter?</p>



<a name="250904670"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/146212-t-compiler/const-eval/topic/const_trait_impl%27s%20syntax/near/250904670" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Giacomo Stevanato <a href="https://zulip-archive.rust-lang.org/stream/146212-t-compiler/const-eval/topic/const_trait_impl&#x27;s.20syntax.html#250904670">(Aug 27 2021 at 09:19)</a>:</h4>
<p>I agree that <code>~</code> should be avoided though</p>



<a name="250904867"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/146212-t-compiler/const-eval/topic/const_trait_impl%27s%20syntax/near/250904867" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Bot+ <a href="https://zulip-archive.rust-lang.org/stream/146212-t-compiler/const-eval/topic/const_trait_impl&#x27;s.20syntax.html#250904867">(Aug 27 2021 at 09:21)</a>:</h4>
<p>I would like to think of types as yet another primitive.</p>
<div class="codehilite" data-code-language="Rust"><pre><span></span><code><span class="k">fn</span> <span class="nf">foo</span><span class="o">&lt;</span><span class="n">T</span><span class="o">=</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="n">X</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="k">dyn</span><span class="w"> </span><span class="n">Y</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">Z</span><span class="o">&gt;</span><span class="p">(</span><span class="n">input</span>: <span class="nc">T</span><span class="p">)</span><span class="w"> </span>-&gt; <span class="nc">T</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="n">input</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>
</code></pre></div>
<p>Would desugar to</p>
<div class="codehilite" data-code-language="Rust"><pre><span></span><code><span class="k">fn</span> <span class="nf">foo</span><span class="o">&lt;</span><span class="k">const</span><span class="w"> </span><span class="n">T</span>: <span class="nc">Type</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span><span class="k">const</span><span class="w"> </span><span class="n">X</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="k">dyn</span><span class="w"> </span><span class="n">Y</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">Z</span><span class="p">}</span><span class="o">&gt;</span><span class="p">(</span><span class="n">input</span>: <span class="nc">T</span><span class="p">)</span><span class="w"> </span>-&gt; <span class="nc">T</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="n">input</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>
</code></pre></div>



<a name="250916969"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/146212-t-compiler/const-eval/topic/const_trait_impl%27s%20syntax/near/250916969" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> oli <a href="https://zulip-archive.rust-lang.org/stream/146212-t-compiler/const-eval/topic/const_trait_impl&#x27;s.20syntax.html#250916969">(Aug 27 2021 at 11:23)</a>:</h4>
<p>I don't understand why you would want to change the bound syntax. what is the difference between <code>=</code> and <code>:</code> bounds?</p>



<a name="250917054"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/146212-t-compiler/const-eval/topic/const_trait_impl%27s%20syntax/near/250917054" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> oli <a href="https://zulip-archive.rust-lang.org/stream/146212-t-compiler/const-eval/topic/const_trait_impl&#x27;s.20syntax.html#250917054">(Aug 27 2021 at 11:24)</a>:</h4>
<p>we want to change the constness of a trait bound, not change something about the entirety of how bounds work</p>



<a name="250917080"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/146212-t-compiler/const-eval/topic/const_trait_impl%27s%20syntax/near/250917080" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> oli <a href="https://zulip-archive.rust-lang.org/stream/146212-t-compiler/const-eval/topic/const_trait_impl&#x27;s.20syntax.html#250917080">(Aug 27 2021 at 11:24)</a>:</h4>
<p>I'd be fine with other syntaxes, but it must fit the existing system</p>



<a name="250917137"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/146212-t-compiler/const-eval/topic/const_trait_impl%27s%20syntax/near/250917137" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> oli <a href="https://zulip-archive.rust-lang.org/stream/146212-t-compiler/const-eval/topic/const_trait_impl&#x27;s.20syntax.html#250917137">(Aug 27 2021 at 11:24)</a>:</h4>
<p><code>?const</code> was nice in the previous system, because it was indeed an opt out</p>



<a name="250917264"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/146212-t-compiler/const-eval/topic/const_trait_impl%27s%20syntax/near/250917264" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> oli <a href="https://zulip-archive.rust-lang.org/stream/146212-t-compiler/const-eval/topic/const_trait_impl&#x27;s.20syntax.html#250917264">(Aug 27 2021 at 11:26)</a>:</h4>
<p>just using plain <code>const</code> suggests that the generic parameter <em>must</em> have a const impl for that bound</p>



<a name="250917295"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/146212-t-compiler/const-eval/topic/const_trait_impl%27s%20syntax/near/250917295" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> oli <a href="https://zulip-archive.rust-lang.org/stream/146212-t-compiler/const-eval/topic/const_trait_impl&#x27;s.20syntax.html#250917295">(Aug 27 2021 at 11:26)</a>:</h4>
<p>so we need some third option</p>



<a name="250917354"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/146212-t-compiler/const-eval/topic/const_trait_impl%27s%20syntax/near/250917354" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> oli <a href="https://zulip-archive.rust-lang.org/stream/146212-t-compiler/const-eval/topic/const_trait_impl&#x27;s.20syntax.html#250917354">(Aug 27 2021 at 11:26)</a>:</h4>
<p>we could go with an obvious placeholder syntax like <code>T: const if const Trait</code> to make it clear that it's not a syntax that has had its proper bikeshed</p>



<a name="250917389"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/146212-t-compiler/const-eval/topic/const_trait_impl%27s%20syntax/near/250917389" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> oli <a href="https://zulip-archive.rust-lang.org/stream/146212-t-compiler/const-eval/topic/const_trait_impl&#x27;s.20syntax.html#250917389">(Aug 27 2021 at 11:27)</a>:</h4>
<p>or we go with an attribute (though attributes aren't yet allowed in the middle of bounds)</p>



<a name="250917444"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/146212-t-compiler/const-eval/topic/const_trait_impl%27s%20syntax/near/250917444" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> oli <a href="https://zulip-archive.rust-lang.org/stream/146212-t-compiler/const-eval/topic/const_trait_impl&#x27;s.20syntax.html#250917444">(Aug 27 2021 at 11:28)</a>:</h4>
<div class="codehilite"><pre><span></span><code>error: expected one of `!`, `(`, `,`, `=`, `&gt;`, `?`, `for`, lifetime, or path, found `#`
 --&gt; src/lib.rs:1:11
  |
1 | fn foo&lt;T: #[allow(foo)] Eq&gt;(){}
  |           ^ expected one of 9 possible tokens
</code></pre></div>



<a name="250917597"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/146212-t-compiler/const-eval/topic/const_trait_impl%27s%20syntax/near/250917597" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> oli <a href="https://zulip-archive.rust-lang.org/stream/146212-t-compiler/const-eval/topic/const_trait_impl&#x27;s.20syntax.html#250917597">(Aug 27 2021 at 11:29)</a>:</h4>
<p>just had an idea: <code>T: Trait&lt;const, 'a, U, V&gt;</code> <span aria-label="upside down" class="emoji emoji-1f643" role="img" title="upside down">:upside_down:</span></p>



<a name="250919854"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/146212-t-compiler/const-eval/topic/const_trait_impl%27s%20syntax/near/250919854" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Bot+ <a href="https://zulip-archive.rust-lang.org/stream/146212-t-compiler/const-eval/topic/const_trait_impl&#x27;s.20syntax.html#250919854">(Aug 27 2021 at 11:51)</a>:</h4>
<p>Use ':' for types, '=' for traits.</p>
<p>Assuming</p>
<div class="codehilite" data-code-language="Rust"><pre><span></span><code><span class="k">trait</span><span class="w"> </span><span class="n">NewTrait</span>: <span class="nb">Clone</span> <span class="o">+</span><span class="w"> </span><span class="nb">Default</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">MyTraitA</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">MyTraitB</span><span class="w"> </span><span class="p">{};</span><span class="w"></span>

<span class="k">const</span><span class="w"> </span><span class="n">NewTrait</span>: <span class="nb">Vec</span><span class="o">&lt;</span><span class="k">trait</span><span class="o">&gt;</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">Clone</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nb">Default</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">MyTraitA</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">MyTraitB</span><span class="p">;</span><span class="w"></span>
</code></pre></div>
<p>We get something like this:</p>
<div class="codehilite" data-code-language="Rust"><pre><span></span><code><span class="c1">// Before</span>
<span class="k">fn</span> <span class="nf">foo</span><span class="o">&lt;</span><span class="n">T</span>: <span class="kt">u8</span><span class="o">&gt;</span><span class="p">(</span><span class="n">input</span>: <span class="nc">T</span><span class="p">)</span><span class="w"> </span>-&gt; <span class="nc">T</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="n">input</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>
<span class="k">fn</span> <span class="nf">foo</span><span class="o">&lt;</span><span class="n">T</span><span class="o">=</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="n">X</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="k">dyn</span><span class="w"> </span><span class="n">Y</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">Z</span><span class="o">&gt;</span><span class="p">(</span><span class="n">input</span>: <span class="nc">T</span><span class="p">)</span><span class="w"> </span>-&gt; <span class="nc">T</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="n">input</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>
<span class="c1">// After</span>
<span class="k">enum</span> <span class="nc">Type</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="n">Plain</span><span class="p">(</span><span class="k">type</span><span class="p">),</span><span class="w"></span>
<span class="w">    </span><span class="n">TraitCollection</span><span class="p">(</span><span class="nb">Vec</span><span class="o">&lt;</span><span class="k">trait</span><span class="o">&gt;</span><span class="p">),</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>
<span class="k">fn</span> <span class="nf">foo</span><span class="o">&lt;</span><span class="k">const</span><span class="w"> </span><span class="n">T</span>: <span class="nc">Type</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Type</span>::<span class="n">Plain</span><span class="p">(</span><span class="kt">u8</span><span class="p">)</span><span class="o">&gt;</span><span class="p">(</span><span class="n">input</span>: <span class="nc">T</span><span class="p">)</span><span class="w"> </span>-&gt; <span class="nc">T</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="n">input</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="k">fn</span> <span class="nf">foo</span><span class="o">&lt;</span><span class="k">const</span><span class="w"> </span><span class="n">T</span>: <span class="nc">Type</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Type</span>::<span class="n">TraitCollection</span><span class="p">(</span><span class="fm">vec!</span><span class="p">[</span><span class="k">const</span><span class="w"> </span><span class="n">X</span><span class="p">,</span><span class="w"> </span><span class="k">dyn</span><span class="w"> </span><span class="n">Y</span><span class="p">,</span><span class="w"> </span><span class="n">Z</span><span class="p">]</span><span class="o">&gt;</span><span class="p">(</span><span class="n">input</span>: <span class="nc">T</span><span class="p">)</span><span class="w"> </span>-&gt; <span class="nc">T</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="n">input</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>
</code></pre></div>
<p>Compiler would need to perform type inference on what comes after <code>T=</code> to check if it is value, type or trait.</p>
<p><code>fn test&lt;T=8u32&gt;(x: T) -&gt; T {x}  =&gt; Err("Expected Type or Trait(s). Did you mean to use 'const T:u32=8u32'?")</code><br>
<code>fn test&lt;const T: u32=MyTrait&gt;() -&gt; u32{T} =&gt; Err("Expected a 'u32' value, 'MyTrait' is a trait")</code></p>



<a name="250920143"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/146212-t-compiler/const-eval/topic/const_trait_impl%27s%20syntax/near/250920143" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Bot+ <a href="https://zulip-archive.rust-lang.org/stream/146212-t-compiler/const-eval/topic/const_trait_impl&#x27;s.20syntax.html#250920143">(Aug 27 2021 at 11:54)</a>:</h4>
<p>My main issue with tilde is accessibility.</p>
<p>Dead Keys ('´', '`', '~', '^', '¨') are used to combine a diacritic with a letter. In my opinion they are the second hardest characters to type on Western keyboards, only behind directly typing the char code.</p>
<p>For example it is faster to type "a xor b" than "a ^ b"</p>
<p>So at least use #const, ?const, %const, !const, @const, ...</p>



<a name="250920186"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/146212-t-compiler/const-eval/topic/const_trait_impl%27s%20syntax/near/250920186" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> oli <a href="https://zulip-archive.rust-lang.org/stream/146212-t-compiler/const-eval/topic/const_trait_impl&#x27;s.20syntax.html#250920186">(Aug 27 2021 at 11:54)</a>:</h4>
<p>uhm</p>



<a name="250920226"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/146212-t-compiler/const-eval/topic/const_trait_impl%27s%20syntax/near/250920226" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> oli <a href="https://zulip-archive.rust-lang.org/stream/146212-t-compiler/const-eval/topic/const_trait_impl&#x27;s.20syntax.html#250920226">(Aug 27 2021 at 11:55)</a>:</h4>
<p>I'm still not sure what you are suggestinggb</p>



<a name="250920233"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/146212-t-compiler/const-eval/topic/const_trait_impl%27s%20syntax/near/250920233" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> oli <a href="https://zulip-archive.rust-lang.org/stream/146212-t-compiler/const-eval/topic/const_trait_impl&#x27;s.20syntax.html#250920233">(Aug 27 2021 at 11:55)</a>:</h4>
<p>this is not about const generics</p>



<a name="250920324"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/146212-t-compiler/const-eval/topic/const_trait_impl%27s%20syntax/near/250920324" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> oli <a href="https://zulip-archive.rust-lang.org/stream/146212-t-compiler/const-eval/topic/const_trait_impl&#x27;s.20syntax.html#250920324">(Aug 27 2021 at 11:56)</a>:</h4>
<p>Your proposal seems orthogonal to what we are trying to do here</p>



<a name="250920334"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/146212-t-compiler/const-eval/topic/const_trait_impl%27s%20syntax/near/250920334" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> oli <a href="https://zulip-archive.rust-lang.org/stream/146212-t-compiler/const-eval/topic/const_trait_impl&#x27;s.20syntax.html#250920334">(Aug 27 2021 at 11:56)</a>:</h4>
<p>like a more general syntax</p>



<a name="250920363"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/146212-t-compiler/const-eval/topic/const_trait_impl%27s%20syntax/near/250920363" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> oli <a href="https://zulip-archive.rust-lang.org/stream/146212-t-compiler/const-eval/topic/const_trait_impl&#x27;s.20syntax.html#250920363">(Aug 27 2021 at 11:56)</a>:</h4>
<p>we need a shorthand/sugar syntax, too, no matter what more general syntax we have</p>



<a name="250920395"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/146212-t-compiler/const-eval/topic/const_trait_impl%27s%20syntax/near/250920395" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> oli <a href="https://zulip-archive.rust-lang.org/stream/146212-t-compiler/const-eval/topic/const_trait_impl&#x27;s.20syntax.html#250920395">(Aug 27 2021 at 11:56)</a>:</h4>
<p>I don't want to mix const-if-const bounds with something else that is contentious</p>



<a name="250920668"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/146212-t-compiler/const-eval/topic/const_trait_impl%27s%20syntax/near/250920668" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Bot+ <a href="https://zulip-archive.rust-lang.org/stream/146212-t-compiler/const-eval/topic/const_trait_impl&#x27;s.20syntax.html#250920668">(Aug 27 2021 at 11:59)</a>:</h4>
<p>My proposal's shortest variant would be  <code>fn foo&lt;T= MyTrait&gt;()</code> for general case, and fn foo&lt;T= const MyTrait&gt;() when trait is const_trait.</p>



<a name="250925049"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/146212-t-compiler/const-eval/topic/const_trait_impl%27s%20syntax/near/250925049" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> oli <a href="https://zulip-archive.rust-lang.org/stream/146212-t-compiler/const-eval/topic/const_trait_impl&#x27;s.20syntax.html#250925049">(Aug 27 2021 at 12:41)</a>:</h4>
<p>but how is <code>T= MyTrait</code> different from <code>T: MyTrait</code>?</p>



<a name="250925070"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/146212-t-compiler/const-eval/topic/const_trait_impl%27s%20syntax/near/250925070" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> oli <a href="https://zulip-archive.rust-lang.org/stream/146212-t-compiler/const-eval/topic/const_trait_impl&#x27;s.20syntax.html#250925070">(Aug 27 2021 at 12:41)</a>:</h4>
<p>we want a <code>const</code> bound that is only const if we are in a const context</p>



<a name="250926370"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/146212-t-compiler/const-eval/topic/const_trait_impl%27s%20syntax/near/250926370" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Bot+ <a href="https://zulip-archive.rust-lang.org/stream/146212-t-compiler/const-eval/topic/const_trait_impl&#x27;s.20syntax.html#250926370">(Aug 27 2021 at 12:52)</a>:</h4>
<p><code>T= dyn MyTrait</code>?</p>



<a name="250938880"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/146212-t-compiler/const-eval/topic/const_trait_impl%27s%20syntax/near/250938880" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> oli <a href="https://zulip-archive.rust-lang.org/stream/146212-t-compiler/const-eval/topic/const_trait_impl&#x27;s.20syntax.html#250938880">(Aug 27 2021 at 14:23)</a>:</h4>
<p>I don't understand what that means</p>



<a name="250980215"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/146212-t-compiler/const-eval/topic/const_trait_impl%27s%20syntax/near/250980215" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Giacomo Stevanato <a href="https://zulip-archive.rust-lang.org/stream/146212-t-compiler/const-eval/topic/const_trait_impl&#x27;s.20syntax.html#250980215">(Aug 27 2021 at 19:08)</a>:</h4>
<p>My problem with <code>T = MyTrait</code> is that it's weird and counterintuitive to use it to restrict generic parameters. I would expect it to mean "if <code>T</code> is not specified or can't be inferred then use type <code>MyTrait</code>". Same for const generics, so in <code>const T: Type = Type::TraitCollection(vec![const X, dyn Y, Z]</code> I would expect <code>Type::TraitCollection(vec![const X, dyn Y, Z]</code>to be the defaul value of that const generic.</p>



<a name="250981677"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/146212-t-compiler/const-eval/topic/const_trait_impl%27s%20syntax/near/250981677" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> oli <a href="https://zulip-archive.rust-lang.org/stream/146212-t-compiler/const-eval/topic/const_trait_impl&#x27;s.20syntax.html#250981677">(Aug 27 2021 at 19:18)</a>:</h4>
<p>I am still confused, what does any of this have to do with const bounds? It looks like there are still const bounds (<code>const X</code>) in your example, and I don't see how they behave as "const if in const" and not just as "must be const"</p>



<a name="251010521"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/146212-t-compiler/const-eval/topic/const_trait_impl%27s%20syntax/near/251010521" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jacob Lifshay <a href="https://zulip-archive.rust-lang.org/stream/146212-t-compiler/const-eval/topic/const_trait_impl&#x27;s.20syntax.html#251010521">(Aug 27 2021 at 23:42)</a>:</h4>
<p>I suggested using <code>const&lt;&gt;</code> or <code>const()</code> instead of <code>~const</code>: <a href="https://internals.rust-lang.org/t/pre-rfc-revamped-const-trait-impl-aka-rfc-2632/15192/16?u=programmerjake">https://internals.rust-lang.org/t/pre-rfc-revamped-const-trait-impl-aka-rfc-2632/15192/16?u=programmerjake</a></p>



<a name="251061696"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/146212-t-compiler/const-eval/topic/const_trait_impl%27s%20syntax/near/251061696" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> oli <a href="https://zulip-archive.rust-lang.org/stream/146212-t-compiler/const-eval/topic/const_trait_impl&#x27;s.20syntax.html#251061696">(Aug 28 2021 at 15:02)</a>:</h4>
<p>so... empty bounds mean "infer from context"?</p>



<a name="251061849"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/146212-t-compiler/const-eval/topic/const_trait_impl%27s%20syntax/near/251061849" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lokathor <a href="https://zulip-archive.rust-lang.org/stream/146212-t-compiler/const-eval/topic/const_trait_impl&#x27;s.20syntax.html#251061849">(Aug 28 2021 at 15:05)</a>:</h4>
<p>"const in const" seems like the good default, and then the only other situation you'd really need is to have is "always const even if I'm not".</p>



<a name="251061929"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/146212-t-compiler/const-eval/topic/const_trait_impl%27s%20syntax/near/251061929" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lokathor <a href="https://zulip-archive.rust-lang.org/stream/146212-t-compiler/const-eval/topic/const_trait_impl&#x27;s.20syntax.html#251061929">(Aug 28 2021 at 15:06)</a>:</h4>
<p>but I'm not sure if that suggests syntax</p>



<a name="252756211"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/146212-t-compiler/const-eval/topic/const_trait_impl%27s%20syntax/near/252756211" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Yoshua Wuyts [he/they] <a href="https://zulip-archive.rust-lang.org/stream/146212-t-compiler/const-eval/topic/const_trait_impl&#x27;s.20syntax.html#252756211">(Sep 10 2021 at 09:18)</a>:</h4>
<p>How do folks pronounce <code>~const</code> when reading it? Is it: "maybe const"?</p>



<a name="252766788"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/146212-t-compiler/const-eval/topic/const_trait_impl%27s%20syntax/near/252766788" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> oli <a href="https://zulip-archive.rust-lang.org/stream/146212-t-compiler/const-eval/topic/const_trait_impl&#x27;s.20syntax.html#252766788">(Sep 10 2021 at 10:48)</a>:</h4>
<p>"cifc"? XD</p>



<a name="252767093"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/146212-t-compiler/const-eval/topic/const_trait_impl%27s%20syntax/near/252767093" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> oli <a href="https://zulip-archive.rust-lang.org/stream/146212-t-compiler/const-eval/topic/const_trait_impl&#x27;s.20syntax.html#252767093">(Sep 10 2021 at 10:50)</a>:</h4>
<p>I think we can just pronounce it as "const" without any modifier, as "it becomes clear from context" what kind of constness is meant</p>



<a name="252767115"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/146212-t-compiler/const-eval/topic/const_trait_impl%27s%20syntax/near/252767115" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> oli <a href="https://zulip-archive.rust-lang.org/stream/146212-t-compiler/const-eval/topic/const_trait_impl&#x27;s.20syntax.html#252767115">(Sep 10 2021 at 10:50)</a>:</h4>
<p>it's like a pronoun, only makes sense if you said the name before</p>



<a name="252786466"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/146212-t-compiler/const-eval/topic/const_trait_impl%27s%20syntax/near/252786466" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wesley Wiser <a href="https://zulip-archive.rust-lang.org/stream/146212-t-compiler/const-eval/topic/const_trait_impl&#x27;s.20syntax.html#252786466">(Sep 10 2021 at 13:27)</a>:</h4>
<p>Just put some inflection at the end: const <em>?</em> <em>?</em> <em>?</em> <span aria-label="thinking" class="emoji emoji-1f914" role="img" title="thinking">:thinking:</span></p>



<a name="252829279"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/146212-t-compiler/const-eval/topic/const_trait_impl%27s%20syntax/near/252829279" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> XAMPPRocky <a href="https://zulip-archive.rust-lang.org/stream/146212-t-compiler/const-eval/topic/const_trait_impl&#x27;s.20syntax.html#252829279">(Sep 10 2021 at 18:29)</a>:</h4>
<p>FWIW I would say “Tilde const”.</p>



<a name="252846874"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/146212-t-compiler/const-eval/topic/const_trait_impl%27s%20syntax/near/252846874" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Gary Guo <a href="https://zulip-archive.rust-lang.org/stream/146212-t-compiler/const-eval/topic/const_trait_impl&#x27;s.20syntax.html#252846874">(Sep 10 2021 at 20:37)</a>:</h4>
<p><del>box const</del></p>



<a name="252854075"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/146212-t-compiler/const-eval/topic/const_trait_impl%27s%20syntax/near/252854075" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Josh Triplett <a href="https://zulip-archive.rust-lang.org/stream/146212-t-compiler/const-eval/topic/const_trait_impl&#x27;s.20syntax.html#252854075">(Sep 10 2021 at 21:35)</a>:</h4>
<p>When was the <code>~const</code> syntax first proposed? I remember lots of conversations about the concept of "const if thing is const", and similar mechanisms for traits for that matter. But I don't remember seeing the concrete syntax proposal.</p>



<a name="252854250"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/146212-t-compiler/const-eval/topic/const_trait_impl%27s%20syntax/near/252854250" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Josh Triplett <a href="https://zulip-archive.rust-lang.org/stream/146212-t-compiler/const-eval/topic/const_trait_impl&#x27;s.20syntax.html#252854250">(Sep 10 2021 at 21:37)</a>:</h4>
<p>I remember being surprised the first time I saw <code>~const</code>.</p>



<a name="252881916"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/146212-t-compiler/const-eval/topic/const_trait_impl%27s%20syntax/near/252881916" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Gary Guo <a href="https://zulip-archive.rust-lang.org/stream/146212-t-compiler/const-eval/topic/const_trait_impl&#x27;s.20syntax.html#252881916">(Sep 11 2021 at 04:44)</a>:</h4>
<p><span class="user-mention silent" data-user-id="239881">Josh Triplett</span> <a href="#narrow/stream/146212-t-compiler.2Fconst-eval/topic/const_trait_impl's.20syntax/near/252854075">said</a>:</p>
<blockquote>
<p>When was the <code>~const</code> syntax first proposed? I remember lots of conversations about the concept of "const if thing is const", and similar mechanisms for traits for that matter. But I don't remember seeing the concrete syntax proposal.</p>
</blockquote>
<p>It's proposed in this thread <span aria-label="grinning" class="emoji emoji-1f600" role="img" title="grinning">:grinning:</span> If you scroll up you'll see the proposal and the pre-RFC link.</p>



<a name="252903474"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/146212-t-compiler/const-eval/topic/const_trait_impl%27s%20syntax/near/252903474" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> oli <a href="https://zulip-archive.rust-lang.org/stream/146212-t-compiler/const-eval/topic/const_trait_impl&#x27;s.20syntax.html#252903474">(Sep 11 2021 at 11:39)</a>:</h4>
<p>It's just a placeholder (and proposed) syntax as <code>?const</code> definitely sent the wrong message and we wanted to get this merged.</p>



<a name="252903530"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/146212-t-compiler/const-eval/topic/const_trait_impl%27s%20syntax/near/252903530" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> oli <a href="https://zulip-archive.rust-lang.org/stream/146212-t-compiler/const-eval/topic/const_trait_impl&#x27;s.20syntax.html#252903530">(Sep 11 2021 at 11:40)</a>:</h4>
<p>this will need lang team sign off before anything remotely going towards stabilization happens here</p>



<a name="252903538"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/146212-t-compiler/const-eval/topic/const_trait_impl%27s%20syntax/near/252903538" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> oli <a href="https://zulip-archive.rust-lang.org/stream/146212-t-compiler/const-eval/topic/const_trait_impl&#x27;s.20syntax.html#252903538">(Sep 11 2021 at 11:40)</a>:</h4>
<p>we would have gone with an attribute, but can't have attributes on trait bounds XD</p>



<hr><p>Last updated: Apr 12 2022 at 20:01 UTC</p>
</html>