<html>
<head><meta charset="utf-8"><title>#70889 raw ptrs CTFE · t-compiler/const-eval · Zulip Chat Archive</title></head>
<h2>Stream: <a href="https://zulip-archive.rust-lang.org/stream/146212-t-compiler/const-eval/index.html">t-compiler/const-eval</a></h2>
<h3>Topic: <a href="https://zulip-archive.rust-lang.org/stream/146212-t-compiler/const-eval/topic/.2370889.20raw.20ptrs.20CTFE.html">#70889 raw ptrs CTFE</a></h3>

<hr>

<base href="https://rust-lang.zulipchat.com">

<head><link href="https://zulip-archive.rust-lang.org/style.css" rel="stylesheet"></head>

<a name="277128429"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/146212-t-compiler/const-eval/topic/%2370889%20raw%20ptrs%20CTFE/near/277128429" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> lcnr <a href="https://zulip-archive.rust-lang.org/stream/146212-t-compiler/const-eval/topic/.2370889.20raw.20ptrs.20CTFE.html#277128429">(Mar 30 2022 at 11:25)</a>:</h4>
<p>in <a href="https://github.com/rust-lang/rust/issues/70899">#70899</a> <span class="user-mention" data-user-id="120791">@RalfJ</span> <a href="https://github.com/rust-lang/rust/issues/70889#issuecomment-611074561">said</a></p>
<blockquote>
<p>Also, why is sharing unobservable, assuming CTFE allows raw ptr comparisons eventually?</p>
</blockquote>



<a name="277128579"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/146212-t-compiler/const-eval/topic/%2370889%20raw%20ptrs%20CTFE/near/277128579" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> lcnr <a href="https://zulip-archive.rust-lang.org/stream/146212-t-compiler/const-eval/topic/.2370889.20raw.20ptrs.20CTFE.html#277128579">(Mar 30 2022 at 11:26)</a>:</h4>
<p>to my knowledge we don't intend to ever allow CTFE to make raw ptr comparisions</p>



<a name="277128584"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/146212-t-compiler/const-eval/topic/%2370889%20raw%20ptrs%20CTFE/near/277128584" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> lcnr <a href="https://zulip-archive.rust-lang.org/stream/146212-t-compiler/const-eval/topic/.2370889.20raw.20ptrs.20CTFE.html#277128584">(Mar 30 2022 at 11:26)</a>:</h4>
<p>is that correct?</p>



<a name="277128704"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/146212-t-compiler/const-eval/topic/%2370889%20raw%20ptrs%20CTFE/near/277128704" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> lcnr <a href="https://zulip-archive.rust-lang.org/stream/146212-t-compiler/const-eval/topic/.2370889.20raw.20ptrs.20CTFE.html#277128704">(Mar 30 2022 at 11:27)</a>:</h4>
<p>comparing references during CTFE  - which I assume would be possible if we can compare raw pointers -  will prevent const generics from ever using them in const parameter types</p>



<a name="277128801"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/146212-t-compiler/const-eval/topic/%2370889%20raw%20ptrs%20CTFE/near/277128801" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> lcnr <a href="https://zulip-archive.rust-lang.org/stream/146212-t-compiler/const-eval/topic/.2370889.20raw.20ptrs.20CTFE.html#277128801">(Mar 30 2022 at 11:28)</a>:</h4>
<p>from <a href="https://github.com/rust-lang/project-const-generics/issues/29">https://github.com/rust-lang/project-const-generics/issues/29</a></p>
<blockquote>
<p>Structural equality describes what is necessary for two constants to be considered equal.<br>
The lower bound is that we at least consider constants equal to itself, while we must not consider two constants to be equal if their differences can be observed in any way during CTFE. Types for which this cannot be guaranteed must not be used as const parameter types.</p>
</blockquote>
<p>which is my current perspective on structural equality when it comes to const generics.</p>



<a name="277128992"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/146212-t-compiler/const-eval/topic/%2370889%20raw%20ptrs%20CTFE/near/277128992" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> oli <a href="https://zulip-archive.rust-lang.org/stream/146212-t-compiler/const-eval/topic/.2370889.20raw.20ptrs.20CTFE.html#277128992">(Mar 30 2022 at 11:30)</a>:</h4>
<p>The issue number this thread references is wrong</p>



<a name="277129046"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/146212-t-compiler/const-eval/topic/%2370889%20raw%20ptrs%20CTFE/near/277129046" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> lcnr <a href="https://zulip-archive.rust-lang.org/stream/146212-t-compiler/const-eval/topic/.2370889.20raw.20ptrs.20CTFE.html#277129046">(Mar 30 2022 at 11:30)</a>:</h4>
<p><a href="/user_uploads/4715/Le--WnCDpGW4K2sykkNx0Q62/Screenshot-from-2022-03-30-13-30-48.png">Screenshot-from-2022-03-30-13-30-48.png</a> no</p>
<div class="message_inline_image"><a href="/user_uploads/4715/Le--WnCDpGW4K2sykkNx0Q62/Screenshot-from-2022-03-30-13-30-48.png" title="Screenshot-from-2022-03-30-13-30-48.png"><img src="/user_uploads/4715/Le--WnCDpGW4K2sykkNx0Q62/Screenshot-from-2022-03-30-13-30-48.png"></a></div>



<a name="277129069"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/146212-t-compiler/const-eval/topic/%2370889%20raw%20ptrs%20CTFE/near/277129069" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> lcnr <a href="https://zulip-archive.rust-lang.org/stream/146212-t-compiler/const-eval/topic/.2370889.20raw.20ptrs.20CTFE.html#277129069">(Mar 30 2022 at 11:31)</a>:</h4>
<p>ah</p>



<a name="277129108"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/146212-t-compiler/const-eval/topic/%2370889%20raw%20ptrs%20CTFE/near/277129108" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> lcnr <a href="https://zulip-archive.rust-lang.org/stream/146212-t-compiler/const-eval/topic/.2370889.20raw.20ptrs.20CTFE.html#277129108">(Mar 30 2022 at 11:31)</a>:</h4>
<p>reading is hard :(</p>



<a name="277129186"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/146212-t-compiler/const-eval/topic/%2370889%20raw%20ptrs%20CTFE/near/277129186" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> lcnr <a href="https://zulip-archive.rust-lang.org/stream/146212-t-compiler/const-eval/topic/.2370889.20raw.20ptrs.20CTFE.html#277129186">(Mar 30 2022 at 11:32)</a>:</h4>
<p>though that there were both a pr and an issue with the same id</p>



<a name="277129198"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/146212-t-compiler/const-eval/topic/%2370889%20raw%20ptrs%20CTFE/near/277129198" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> lcnr <a href="https://zulip-archive.rust-lang.org/stream/146212-t-compiler/const-eval/topic/.2370889.20raw.20ptrs.20CTFE.html#277129198">(Mar 30 2022 at 11:32)</a>:</h4>
<p>which was really surprising (and luckily not the case) ^^</p>



<a name="277131179"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/146212-t-compiler/const-eval/topic/%2370889%20raw%20ptrs%20CTFE/near/277131179" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> oli <a href="https://zulip-archive.rust-lang.org/stream/146212-t-compiler/const-eval/topic/.2370889.20raw.20ptrs.20CTFE.html#277131179">(Mar 30 2022 at 11:51)</a>:</h4>
<p>why would CTFE allowing raw pointer comparisons affect const generics?</p>



<a name="277131261"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/146212-t-compiler/const-eval/topic/%2370889%20raw%20ptrs%20CTFE/near/277131261" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> lcnr <a href="https://zulip-archive.rust-lang.org/stream/146212-t-compiler/const-eval/topic/.2370889.20raw.20ptrs.20CTFE.html#277131261">(Mar 30 2022 at 11:52)</a>:</h4>
<p>if you have <code>&amp;str</code> as a const parameter type</p>



<a name="277131313"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/146212-t-compiler/const-eval/topic/%2370889%20raw%20ptrs%20CTFE/near/277131313" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> lcnr <a href="https://zulip-archive.rust-lang.org/stream/146212-t-compiler/const-eval/topic/.2370889.20raw.20ptrs.20CTFE.html#277131313">(Mar 30 2022 at 11:52)</a>:</h4>
<p>and ctfe can compare the pointer address for values of type <code>&amp;str</code></p>



<a name="277131332"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/146212-t-compiler/const-eval/topic/%2370889%20raw%20ptrs%20CTFE/near/277131332" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> lcnr <a href="https://zulip-archive.rust-lang.org/stream/146212-t-compiler/const-eval/topic/.2370889.20raw.20ptrs.20CTFE.html#277131332">(Mar 30 2022 at 11:52)</a>:</h4>
<p>then we can go:</p>



<a name="277131399"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/146212-t-compiler/const-eval/topic/%2370889%20raw%20ptrs%20CTFE/near/277131399" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> lcnr <a href="https://zulip-archive.rust-lang.org/stream/146212-t-compiler/const-eval/topic/.2370889.20raw.20ptrs.20CTFE.html#277131399">(Mar 30 2022 at 11:53)</a>:</h4>
<div class="codehilite" data-code-language="Rust"><pre><span></span><code><span class="k">impl</span><span class="o">&lt;</span><span class="k">const</span><span class="w"> </span><span class="n">STR</span>: <span class="kp">&amp;</span><span class="o">'</span><span class="nb">static</span> <span class="kt">str</span><span class="o">&gt;</span><span class="w"> </span><span class="n">MyType</span><span class="o">&lt;</span><span class="n">STR</span><span class="o">&gt;</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="k">const</span><span class="w"> </span><span class="n">WOW</span>: <span class="kt">usize</span> <span class="o">=</span><span class="w"> </span><span class="n">STR</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="o">*</span><span class="k">const</span><span class="w"> </span><span class="kt">str</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="kt">usize</span><span class="p">;</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>
</code></pre></div>



<a name="277131583"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/146212-t-compiler/const-eval/topic/%2370889%20raw%20ptrs%20CTFE/near/277131583" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> lcnr <a href="https://zulip-archive.rust-lang.org/stream/146212-t-compiler/const-eval/topic/.2370889.20raw.20ptrs.20CTFE.html#277131583">(Mar 30 2022 at 11:54)</a>:</h4>
<p><span class="user-mention silent" data-user-id="216206">lcnr</span> <a href="#narrow/stream/146212-t-compiler.2Fconst-eval/topic/.2370889.20raw.20ptrs.20CTFE/near/277131399">said</a>:</p>
<blockquote>
<p><div class="codehilite" data-code-language="Rust"><pre><span></span><code><span class="k">impl</span><span class="o">&lt;</span><span class="k">const</span><span class="w"> </span><span class="n">STR</span>: <span class="kp">&amp;</span><span class="o">'</span><span class="nb">static</span> <span class="kt">str</span><span class="o">&gt;</span><span class="w"> </span><span class="n">MyType</span><span class="o">&lt;</span><span class="n">STR</span><span class="o">&gt;</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="k">const</span><span class="w"> </span><span class="n">WOW</span>: <span class="kt">usize</span> <span class="o">=</span><span class="w"> </span><span class="n">STR</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="o">*</span><span class="k">const</span><span class="w"> </span><span class="kt">str</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="kt">usize</span><span class="p">;</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>
</code></pre></div><br>
</p>
</blockquote>
<p>if <code>WOW</code> flows back into the type system this is wrong if you consider 2 <code>MyType</code> equal even though their <code>STR</code> has a different address</p>



<a name="277131858"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/146212-t-compiler/const-eval/topic/%2370889%20raw%20ptrs%20CTFE/near/277131858" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> lcnr <a href="https://zulip-archive.rust-lang.org/stream/146212-t-compiler/const-eval/topic/.2370889.20raw.20ptrs.20CTFE.html#277131858">(Mar 30 2022 at 11:57)</a>:</h4>
<p>or stuff like</p>
<div class="codehilite" data-code-language="Rust"><pre><span></span><code><span class="k">impl</span><span class="o">&lt;</span><span class="k">const</span><span class="w"> </span><span class="n">VALUE</span>: <span class="p">(</span><span class="o">&amp;</span><span class="kt">u32</span><span class="p">,</span><span class="w"> </span><span class="o">&amp;</span><span class="kt">u32</span><span class="p">)</span><span class="o">&gt;</span><span class="w"> </span><span class="n">Ty</span><span class="o">&lt;</span><span class="n">VALUE</span><span class="o">&gt;</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="k">const</span><span class="w"> </span><span class="n">ASSOC</span>: <span class="kt">bool</span> <span class="o">=</span><span class="w"> </span><span class="n">std</span>::<span class="n">ptr</span>::<span class="n">eq</span><span class="p">(</span><span class="n">VALUE</span><span class="p">.</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="n">VALUE</span><span class="p">.</span><span class="mi">1</span><span class="p">);</span><span class="w"></span>
</code></pre></div>



<a name="277132002"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/146212-t-compiler/const-eval/topic/%2370889%20raw%20ptrs%20CTFE/near/277132002" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> lcnr <a href="https://zulip-archive.rust-lang.org/stream/146212-t-compiler/const-eval/topic/.2370889.20raw.20ptrs.20CTFE.html#277132002">(Mar 30 2022 at 11:58)</a>:</h4>
<p>I guess that it's fine as long as all points where the type system could observe constants we convert them to valtrees and when going back to ctfe we make each reference a new unique allocation</p>



<a name="277132013"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/146212-t-compiler/const-eval/topic/%2370889%20raw%20ptrs%20CTFE/near/277132013" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> lcnr <a href="https://zulip-archive.rust-lang.org/stream/146212-t-compiler/const-eval/topic/.2370889.20raw.20ptrs.20CTFE.html#277132013">(Mar 30 2022 at 11:58)</a>:</h4>
<p>but ideally i would want to avoid that</p>



<a name="277137209"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/146212-t-compiler/const-eval/topic/%2370889%20raw%20ptrs%20CTFE/near/277137209" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> oli <a href="https://zulip-archive.rust-lang.org/stream/146212-t-compiler/const-eval/topic/.2370889.20raw.20ptrs.20CTFE.html#277137209">(Mar 30 2022 at 12:38)</a>:</h4>
<p>side note: conversion to usize will never be possible, but your argument still applies for <code>*const str</code></p>



<a name="277137281"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/146212-t-compiler/const-eval/topic/%2370889%20raw%20ptrs%20CTFE/near/277137281" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> oli <a href="https://zulip-archive.rust-lang.org/stream/146212-t-compiler/const-eval/topic/.2370889.20raw.20ptrs.20CTFE.html#277137281">(Mar 30 2022 at 12:38)</a>:</h4>
<p>We have <code>guaranteed_eq</code> and <code>guaranteed_ne</code> which are the only ways that you can compare pointers in CTFE, and these are very limited by nature</p>



<a name="277137325"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/146212-t-compiler/const-eval/topic/%2370889%20raw%20ptrs%20CTFE/near/277137325" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> oli <a href="https://zulip-archive.rust-lang.org/stream/146212-t-compiler/const-eval/topic/.2370889.20raw.20ptrs.20CTFE.html#277137325">(Mar 30 2022 at 12:39)</a>:</h4>
<p>basically they are the same trickery we have for <code>align_to</code>: we could choose a default, and your logic must still be correct</p>



<a name="277137363"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/146212-t-compiler/const-eval/topic/%2370889%20raw%20ptrs%20CTFE/near/277137363" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> oli <a href="https://zulip-archive.rust-lang.org/stream/146212-t-compiler/const-eval/topic/.2370889.20raw.20ptrs.20CTFE.html#277137363">(Mar 30 2022 at 12:39)</a>:</h4>
<p>technically both <code>guaranteed_*</code> could return <code>false</code> in CTFE without looking at the pointers</p>



<a name="277137468"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/146212-t-compiler/const-eval/topic/%2370889%20raw%20ptrs%20CTFE/near/277137468" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> oli <a href="https://zulip-archive.rust-lang.org/stream/146212-t-compiler/const-eval/topic/.2370889.20raw.20ptrs.20CTFE.html#277137468">(Mar 30 2022 at 12:40)</a>:</h4>
<p>any more precise ways of comparisons are... broken/impossible I believe</p>



<a name="277316782"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/146212-t-compiler/const-eval/topic/%2370889%20raw%20ptrs%20CTFE/near/277316782" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> RalfJ <a href="https://zulip-archive.rust-lang.org/stream/146212-t-compiler/const-eval/topic/.2370889.20raw.20ptrs.20CTFE.html#277316782">(Mar 31 2022 at 17:48)</a>:</h4>
<p><span class="user-mention silent" data-user-id="216206">lcnr</span> <a href="#narrow/stream/146212-t-compiler.2Fconst-eval/topic/.2370889.20raw.20ptrs.20CTFE/near/277128579">said</a>:</p>
<blockquote>
<p>to my knowledge we don't intend to ever allow CTFE to make raw ptr comparisions</p>
</blockquote>
<p>we already have <code>ptr_guaranteed_{eq,ne}</code> so we already (unstably) allow some of this<br>
EDIT: Ah oli wrote this. :D</p>



<a name="277317107"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/146212-t-compiler/const-eval/topic/%2370889%20raw%20ptrs%20CTFE/near/277317107" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> RalfJ <a href="https://zulip-archive.rust-lang.org/stream/146212-t-compiler/const-eval/topic/.2370889.20raw.20ptrs.20CTFE.html#277317107">(Mar 31 2022 at 17:50)</a>:</h4>
<p>also note that CTFE can 'tell the difference' between <code>transmute(0u32): (u16, u8)</code> and <code>(0u16, 0u8)</code>, at least in the sense of having code that is UB for one of them but fine for the other. (this came up in some prior discussion.)</p>



<a name="277376233"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/146212-t-compiler/const-eval/topic/%2370889%20raw%20ptrs%20CTFE/near/277376233" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> lcnr <a href="https://zulip-archive.rust-lang.org/stream/146212-t-compiler/const-eval/topic/.2370889.20raw.20ptrs.20CTFE.html#277376233">(Apr 01 2022 at 06:42)</a>:</h4>
<p><span class="user-mention silent" data-user-id="120791">RalfJ</span> <a href="#narrow/stream/146212-t-compiler.2Fconst-eval/topic/.2370889.20raw.20ptrs.20CTFE/near/277317107">said</a>:</p>
<blockquote>
<p>also note that CTFE can 'tell the difference' between <code>transmute(0u32): (u16, u8)</code> and <code>(0u16, 0u8)</code>, at least in the sense of having code that is UB for one of them but fine for the other. (this came up in some prior discussion.)</p>
</blockquote>
<p>jup, also in <a href="https://github.com/rust-lang/project-const-generics/issues/20">project-const-generics#20</a></p>



<a name="277376249"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/146212-t-compiler/const-eval/topic/%2370889%20raw%20ptrs%20CTFE/near/277376249" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> lcnr <a href="https://zulip-archive.rust-lang.org/stream/146212-t-compiler/const-eval/topic/.2370889.20raw.20ptrs.20CTFE.html#277376249">(Apr 01 2022 at 06:43)</a>:</h4>
<p>though for that we can actually sensibly stop people from doing unsound things by erasing these padding bytes in the valtrees</p>



<hr><p>Last updated: Apr 12 2022 at 20:01 UTC</p>
</html>