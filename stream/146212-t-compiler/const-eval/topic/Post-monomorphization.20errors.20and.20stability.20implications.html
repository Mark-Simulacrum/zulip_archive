<html>
<head><meta charset="utf-8"><title>Post-monomorphization errors and stability implications · t-compiler/const-eval · Zulip Chat Archive</title></head>
<h2>Stream: <a href="https://zulip-archive.rust-lang.org/stream/146212-t-compiler/const-eval/index.html">t-compiler/const-eval</a></h2>
<h3>Topic: <a href="https://zulip-archive.rust-lang.org/stream/146212-t-compiler/const-eval/topic/Post-monomorphization.20errors.20and.20stability.20implications.html">Post-monomorphization errors and stability implications</a></h3>

<hr>

<base href="https://rust-lang.zulipchat.com">

<head><link href="https://zulip-archive.rust-lang.org/style.css" rel="stylesheet"></head>

<a name="276329040"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/146212-t-compiler/const-eval/topic/Post-monomorphization%20errors%20and%20stability%20implications/near/276329040" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Olivier FAURE <a href="https://zulip-archive.rust-lang.org/stream/146212-t-compiler/const-eval/topic/Post-monomorphization.20errors.20and.20stability.20implications.html#276329040">(Mar 23 2022 at 13:01)</a>:</h4>
<p>How much thought has been put in how const generics would add post-monomorphization errors, and impact what is / isn't a semver-breaking change?</p>



<a name="276329061"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/146212-t-compiler/const-eval/topic/Post-monomorphization%20errors%20and%20stability%20implications/near/276329061" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Boxy [she/her] <a href="https://zulip-archive.rust-lang.org/stream/146212-t-compiler/const-eval/topic/Post-monomorphization.20errors.20and.20stability.20implications.html#276329061">(Mar 23 2022 at 13:01)</a>:</h4>
<p>it wont add post mono errors</p>



<a name="276329216"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/146212-t-compiler/const-eval/topic/Post-monomorphization%20errors%20and%20stability%20implications/near/276329216" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> lcnr <a href="https://zulip-archive.rust-lang.org/stream/146212-t-compiler/const-eval/topic/Post-monomorphization.20errors.20and.20stability.20implications.html#276329216">(Mar 23 2022 at 13:02)</a>:</h4>
<blockquote>
<p>How much thought has been put in how const generics would add post-monomorphization errors,</p>
</blockquote>
<p>a bunch</p>



<a name="276329225"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/146212-t-compiler/const-eval/topic/Post-monomorphization%20errors%20and%20stability%20implications/near/276329225" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Olivier FAURE <a href="https://zulip-archive.rust-lang.org/stream/146212-t-compiler/const-eval/topic/Post-monomorphization.20errors.20and.20stability.20implications.html#276329225">(Mar 23 2022 at 13:02)</a>:</h4>
<p>Eg <a href="https://rust-lang.github.io/project-const-generics/design/opaque-and-transparent-assoc-consts.html#additional-stability-requirements">the design document says</a>:</p>
<blockquote>
<p>Without transparent associated constant, this can't break anything. If ASSOC is treated transparently, this change is now theoretically breaking. </p>
</blockquote>
<p>But the ramifications of this don't seem to be really explored</p>



<a name="276329301"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/146212-t-compiler/const-eval/topic/Post-monomorphization%20errors%20and%20stability%20implications/near/276329301" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> lcnr <a href="https://zulip-archive.rust-lang.org/stream/146212-t-compiler/const-eval/topic/Post-monomorphization.20errors.20and.20stability.20implications.html#276329301">(Mar 23 2022 at 13:03)</a>:</h4>
<p>our current impl requires the user to always have propagate bounds that constants evaluate successfully</p>



<a name="276329335"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/146212-t-compiler/const-eval/topic/Post-monomorphization%20errors%20and%20stability%20implications/near/276329335" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> lcnr <a href="https://zulip-archive.rust-lang.org/stream/146212-t-compiler/const-eval/topic/Post-monomorphization.20errors.20and.20stability.20implications.html#276329335">(Mar 23 2022 at 13:03)</a>:</h4>
<p>thereby preventing CTFE errors during monomorphization</p>



<a name="276329543"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/146212-t-compiler/const-eval/topic/Post-monomorphization%20errors%20and%20stability%20implications/near/276329543" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> lcnr <a href="https://zulip-archive.rust-lang.org/stream/146212-t-compiler/const-eval/topic/Post-monomorphization.20errors.20and.20stability.20implications.html#276329543">(Mar 23 2022 at 13:05)</a>:</h4>
<p>that doesn't make everyone happy. Or well, people dislike it by varying amounts with some believing allowing errors during monomorphization are preferable</p>



<a name="276329925"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/146212-t-compiler/const-eval/topic/Post-monomorphization%20errors%20and%20stability%20implications/near/276329925" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> lcnr <a href="https://zulip-archive.rust-lang.org/stream/146212-t-compiler/const-eval/topic/Post-monomorphization.20errors.20and.20stability.20implications.html#276329925">(Mar 23 2022 at 13:08)</a>:</h4>
<p><span class="user-mention silent" data-user-id="263609">Olivier FAURE</span> <a href="#narrow/stream/146212-t-compiler.2Fconst-eval/topic/Post-monomorphization.20errors.20and.20stability.20implications/near/276329225">said</a>:</p>
<blockquote>
<p>Eg <a href="https://rust-lang.github.io/project-const-generics/design/opaque-and-transparent-assoc-consts.html#additional-stability-requirements">the design document says</a>:</p>
<blockquote>
<p>Without transparent associated constant, this can't break anything. If ASSOC is treated transparently, this change is now theoretically breaking. </p>
</blockquote>
<p>But the ramifications of this don't seem to be really explored</p>
</blockquote>
<p>I don't understand what you mean here? This is unrelated to evaluation failures</p>



<a name="276329926"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/146212-t-compiler/const-eval/topic/Post-monomorphization%20errors%20and%20stability%20implications/near/276329926" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Olivier FAURE <a href="https://zulip-archive.rust-lang.org/stream/146212-t-compiler/const-eval/topic/Post-monomorphization.20errors.20and.20stability.20implications.html#276329926">(Mar 23 2022 at 13:08)</a>:</h4>
<p>Right, maybe I'm conflating two things.</p>



<a name="276329983"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/146212-t-compiler/const-eval/topic/Post-monomorphization%20errors%20and%20stability%20implications/near/276329983" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> lcnr <a href="https://zulip-archive.rust-lang.org/stream/146212-t-compiler/const-eval/topic/Post-monomorphization.20errors.20and.20stability.20implications.html#276329983">(Mar 23 2022 at 13:08)</a>:</h4>
<p>the relevant section of the design doc is <a href="https://rust-lang.github.io/project-const-generics/design/index.html#-const-evaluatable-bounds">https://rust-lang.github.io/project-const-generics/design/index.html#-const-evaluatable-bounds</a></p>



<a name="276330003"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/146212-t-compiler/const-eval/topic/Post-monomorphization%20errors%20and%20stability%20implications/near/276330003" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> lcnr <a href="https://zulip-archive.rust-lang.org/stream/146212-t-compiler/const-eval/topic/Post-monomorphization.20errors.20and.20stability.20implications.html#276330003">(Mar 23 2022 at 13:09)</a>:</h4>
<p>which, as you can see, is currently still mostly empty</p>



<a name="276330236"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/146212-t-compiler/const-eval/topic/Post-monomorphization%20errors%20and%20stability%20implications/near/276330236" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Olivier FAURE <a href="https://zulip-archive.rust-lang.org/stream/146212-t-compiler/const-eval/topic/Post-monomorphization.20errors.20and.20stability.20implications.html#276330236">(Mar 23 2022 at 13:11)</a>:</h4>
<p>The more general question I was asking is "How much do const generics expose internal code as part of your interface's contract?"</p>



<a name="276330254"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/146212-t-compiler/const-eval/topic/Post-monomorphization%20errors%20and%20stability%20implications/near/276330254" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> lcnr <a href="https://zulip-archive.rust-lang.org/stream/146212-t-compiler/const-eval/topic/Post-monomorphization.20errors.20and.20stability.20implications.html#276330254">(Mar 23 2022 at 13:11)</a>:</h4>
<p>that's still undecided</p>



<a name="276330364"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/146212-t-compiler/const-eval/topic/Post-monomorphization%20errors%20and%20stability%20implications/near/276330364" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Olivier FAURE <a href="https://zulip-archive.rust-lang.org/stream/146212-t-compiler/const-eval/topic/Post-monomorphization.20errors.20and.20stability.20implications.html#276330364">(Mar 23 2022 at 13:12)</a>:</h4>
<p>Right</p>



<a name="276330375"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/146212-t-compiler/const-eval/topic/Post-monomorphization%20errors%20and%20stability%20implications/near/276330375" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> lcnr <a href="https://zulip-archive.rust-lang.org/stream/146212-t-compiler/const-eval/topic/Post-monomorphization.20errors.20and.20stability.20implications.html#276330375">(Mar 23 2022 at 13:12)</a>:</h4>
<p><a href="https://rust-lang.github.io/project-const-generics/design/eval-errors-during-selection.html">https://rust-lang.github.io/project-const-generics/design/eval-errors-during-selection.html</a> talks about adding stability guarantees to panics</p>



<a name="276330389"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/146212-t-compiler/const-eval/topic/Post-monomorphization%20errors%20and%20stability%20implications/near/276330389" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> lcnr <a href="https://zulip-archive.rust-lang.org/stream/146212-t-compiler/const-eval/topic/Post-monomorphization.20errors.20and.20stability.20implications.html#276330389">(Mar 23 2022 at 13:12)</a>:</h4>
<p><a href="https://rust-lang.github.io/project-const-generics/design/opaque-and-transparent-assoc-consts.html">https://rust-lang.github.io/project-const-generics/design/opaque-and-transparent-assoc-consts.html</a> about leaking implementation details of associated constants</p>



<a name="276330484"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/146212-t-compiler/const-eval/topic/Post-monomorphization%20errors%20and%20stability%20implications/near/276330484" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> lcnr <a href="https://zulip-archive.rust-lang.org/stream/146212-t-compiler/const-eval/topic/Post-monomorphization.20errors.20and.20stability.20implications.html#276330484">(Mar 23 2022 at 13:13)</a>:</h4>
<p><a href="https://rust-lang.github.io/project-const-generics/design/valid-const-parameter-types.html">https://rust-lang.github.io/project-const-generics/design/valid-const-parameter-types.html</a> "talks" (once it is written) about addnig stability guarantees about type definitions (e.g. private fields, this is similar to the current behavior of auto traits)</p>



<a name="276330559"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/146212-t-compiler/const-eval/topic/Post-monomorphization%20errors%20and%20stability%20implications/near/276330559" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Olivier FAURE <a href="https://zulip-archive.rust-lang.org/stream/146212-t-compiler/const-eval/topic/Post-monomorphization.20errors.20and.20stability.20implications.html#276330559">(Mar 23 2022 at 13:14)</a>:</h4>
<p>Okay, you know what, I bungled my original question. Post-mono errors aren't really what I'm asking about. I'm going to start over in a new thread.</p>



<hr><p>Last updated: Apr 12 2022 at 20:01 UTC</p>
</html>