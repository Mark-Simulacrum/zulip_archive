<html>
<head><meta charset="utf-8"><title>miri/pr/487 · t-compiler/const-eval · Zulip Chat Archive</title></head>
<h2>Stream: <a href="https://rust-lang.github.io/zulip_archive/stream/146212-t-compiler/const-eval/index.html">t-compiler/const-eval</a></h2>
<h3>Topic: <a href="https://rust-lang.github.io/zulip_archive/stream/146212-t-compiler/const-eval/topic/miri.2Fpr.2F487.html">miri/pr/487</a></h3>

<hr>

<base href="https://rust-lang.zulipchat.com">

<head><link href="https://rust-lang.github.io/zulip_archive/style.css" rel="stylesheet"></head>

<a name="136249023"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/146212-t-compiler/const-eval/topic/miri/pr/487/near/136249023" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> RalfJ <a href="https://rust-lang.github.io/zulip_archive/stream/146212-t-compiler/const-eval/topic/miri.2Fpr.2F487.html#136249023">(Oct 22 2018 at 06:47)</a>:</h4>
<p>woah GitHub seems really broken currently. I tried to close and reopen the PR but even that did not help.</p>



<a name="136249159"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/146212-t-compiler/const-eval/topic/miri/pr/487/near/136249159" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> RalfJ <a href="https://rust-lang.github.io/zulip_archive/stream/146212-t-compiler/const-eval/topic/miri.2Fpr.2F487.html#136249159">(Oct 22 2018 at 06:50)</a>:</h4>
<p>and it still shows the PR as open though I closed it twice. wtf.</p>



<a name="136249197"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/146212-t-compiler/const-eval/topic/miri/pr/487/near/136249197" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> RalfJ <a href="https://rust-lang.github.io/zulip_archive/stream/146212-t-compiler/const-eval/topic/miri.2Fpr.2F487.html#136249197">(Oct 22 2018 at 06:51)</a>:</h4>
<p>it still says the PR is not mergeable even though it is a fast-forward from master?!?</p>



<a name="136249241"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/146212-t-compiler/const-eval/topic/miri/pr/487/near/136249241" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> RalfJ <a href="https://rust-lang.github.io/zulip_archive/stream/146212-t-compiler/const-eval/topic/miri.2Fpr.2F487.html#136249241">(Oct 22 2018 at 06:52)</a>:</h4>
<p>oh I guess this explains it: <a href="https://status.github.com/messages" target="_blank" title="https://status.github.com/messages">https://status.github.com/messages</a></p>



<a name="136253708"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/146212-t-compiler/const-eval/topic/miri/pr/487/near/136253708" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> bjorn3 <a href="https://rust-lang.github.io/zulip_archive/stream/146212-t-compiler/const-eval/topic/miri.2Fpr.2F487.html#136253708">(Oct 22 2018 at 08:44)</a>:</h4>
<p>Could you please make mod stacked_borrows public, so that I can use it in priroda?</p>



<a name="136253806"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/146212-t-compiler/const-eval/topic/miri/pr/487/near/136253806" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> bjorn3 <a href="https://rust-lang.github.io/zulip_archive/stream/146212-t-compiler/const-eval/topic/miri.2Fpr.2F487.html#136253806">(Oct 22 2018 at 08:46)</a>:</h4>
<p>Can't leave a review comment due to that github problem :)</p>



<a name="136255865"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/146212-t-compiler/const-eval/topic/miri/pr/487/near/136255865" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> RalfJ <a href="https://rust-lang.github.io/zulip_archive/stream/146212-t-compiler/const-eval/topic/miri.2Fpr.2F487.html#136255865">(Oct 22 2018 at 09:33)</a>:</h4>
<p>@bjorn3 what do you want to do with it? this is <em>heavily</em> WIP</p>



<a name="136255883"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/146212-t-compiler/const-eval/topic/miri/pr/487/near/136255883" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> RalfJ <a href="https://rust-lang.github.io/zulip_archive/stream/146212-t-compiler/const-eval/topic/miri.2Fpr.2F487.html#136255883">(Oct 22 2018 at 09:33)</a>:</h4>
<p>(weird, the user bjorn3 is gone now?)</p>



<a name="136256059"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/146212-t-compiler/const-eval/topic/miri/pr/487/near/136256059" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> RalfJ <a href="https://rust-lang.github.io/zulip_archive/stream/146212-t-compiler/const-eval/topic/miri.2Fpr.2F487.html#136256059">(Oct 22 2018 at 09:36)</a>:</h4>
<p>anyway <span class="user-mention" data-user-id="124288">@Oli</span> would be nice if you could have a look at <a href="https://github.com/solson/miri/pull/487" target="_blank" title="https://github.com/solson/miri/pull/487">https://github.com/solson/miri/pull/487</a> so we can merge later when github is unborked. latest commit in there should be 0b22a1c .</p>



<a name="136258670"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/146212-t-compiler/const-eval/topic/miri/pr/487/near/136258670" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> oli <a href="https://rust-lang.github.io/zulip_archive/stream/146212-t-compiler/const-eval/topic/miri.2Fpr.2F487.html#136258670">(Oct 22 2018 at 10:36)</a>:</h4>
<p>Github is so broken I can't even comment</p>



<a name="136258679"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/146212-t-compiler/const-eval/topic/miri/pr/487/near/136258679" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> oli <a href="https://rust-lang.github.io/zulip_archive/stream/146212-t-compiler/const-eval/topic/miri.2Fpr.2F487.html#136258679">(Oct 22 2018 at 10:36)</a>:</h4>
<p>I'll try again later</p>



<a name="136258930"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/146212-t-compiler/const-eval/topic/miri/pr/487/near/136258930" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> RalfJ <a href="https://rust-lang.github.io/zulip_archive/stream/146212-t-compiler/const-eval/topic/miri.2Fpr.2F487.html#136258930">(Oct 22 2018 at 10:43)</a>:</h4>
<p>you can comment here ;)</p>



<a name="136259079"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/146212-t-compiler/const-eval/topic/miri/pr/487/near/136259079" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> oli <a href="https://rust-lang.github.io/zulip_archive/stream/146212-t-compiler/const-eval/topic/miri.2Fpr.2F487.html#136259079">(Oct 22 2018 at 10:46)</a>:</h4>
<p>What happens to immutable borrows in <a href="https://github.com/solson/miri/pull/487/files#diff-157b112a931b10b368e0e33da32c4a52R271" target="_blank" title="https://github.com/solson/miri/pull/487/files#diff-157b112a931b10b368e0e33da32c4a52R271">https://github.com/solson/miri/pull/487/files#diff-157b112a931b10b368e0e33da32c4a52R271</a></p>



<a name="136259091"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/146212-t-compiler/const-eval/topic/miri/pr/487/near/136259091" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> oli <a href="https://rust-lang.github.io/zulip_archive/stream/146212-t-compiler/const-eval/topic/miri.2Fpr.2F487.html#136259091">(Oct 22 2018 at 10:47)</a>:</h4>
<p>I neither know what should be happening nor why it results in a raw mut borrow without interior mut</p>



<a name="136259145"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/146212-t-compiler/const-eval/topic/miri/pr/487/near/136259145" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> RalfJ <a href="https://rust-lang.github.io/zulip_archive/stream/146212-t-compiler/const-eval/topic/miri.2Fpr.2F487.html#136259145">(Oct 22 2018 at 10:48)</a>:</h4>
<p>the problem is cases like <code>&amp;(i32, Cell&lt;i32&gt;)</code></p>



<a name="136259150"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/146212-t-compiler/const-eval/topic/miri/pr/487/near/136259150" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> RalfJ <a href="https://rust-lang.github.io/zulip_archive/stream/146212-t-compiler/const-eval/topic/miri.2Fpr.2F487.html#136259150">(Oct 22 2018 at 10:48)</a>:</h4>
<p>then we want the memory covered by the first field to be treated with <code>Frz</code>, but the 2nd field should have <code>Raw</code></p>



<a name="136259174"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/146212-t-compiler/const-eval/topic/miri/pr/487/near/136259174" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> oli <a href="https://rust-lang.github.io/zulip_archive/stream/146212-t-compiler/const-eval/topic/miri.2Fpr.2F487.html#136259174">(Oct 22 2018 at 10:49)</a>:</h4>
<p>So the entire thing becomes raw until we go further in?</p>



<a name="136259176"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/146212-t-compiler/const-eval/topic/miri/pr/487/near/136259176" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> RalfJ <a href="https://rust-lang.github.io/zulip_archive/stream/146212-t-compiler/const-eval/topic/miri.2Fpr.2F487.html#136259176">(Oct 22 2018 at 10:49)</a>:</h4>
<p>though I just realized I didnt even think this through, the ref only has one tag</p>



<a name="136259183"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/146212-t-compiler/const-eval/topic/miri/pr/487/near/136259183" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> RalfJ <a href="https://rust-lang.github.io/zulip_archive/stream/146212-t-compiler/const-eval/topic/miri.2Fpr.2F487.html#136259183">(Oct 22 2018 at 10:49)</a>:</h4>
<p>I assume the ref would have <code>Frz</code> but that would be ignored for the <code>Cell</code> part</p>



<a name="136259184"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/146212-t-compiler/const-eval/topic/miri/pr/487/near/136259184" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> RalfJ <a href="https://rust-lang.github.io/zulip_archive/stream/146212-t-compiler/const-eval/topic/miri.2Fpr.2F487.html#136259184">(Oct 22 2018 at 10:49)</a>:</h4>
<p>or so</p>



<a name="136259190"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/146212-t-compiler/const-eval/topic/miri/pr/487/near/136259190" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> RalfJ <a href="https://rust-lang.github.io/zulip_archive/stream/146212-t-compiler/const-eval/topic/miri.2Fpr.2F487.html#136259190">(Oct 22 2018 at 10:49)</a>:</h4>
<p>I should likely rename <code>Frz</code> to <code>Shr</code> then</p>



<a name="136259192"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/146212-t-compiler/const-eval/topic/miri/pr/487/near/136259192" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> RalfJ <a href="https://rust-lang.github.io/zulip_archive/stream/146212-t-compiler/const-eval/topic/miri.2Fpr.2F487.html#136259192">(Oct 22 2018 at 10:49)</a>:</h4>
<p>well, figuring out what exactly to do is future work :)</p>



<a name="136259193"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/146212-t-compiler/const-eval/topic/miri/pr/487/near/136259193" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> oli <a href="https://rust-lang.github.io/zulip_archive/stream/146212-t-compiler/const-eval/topic/miri.2Fpr.2F487.html#136259193">(Oct 22 2018 at 10:49)</a>:</h4>
<p>Warrants a comment at least</p>



<a name="136259245"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/146212-t-compiler/const-eval/topic/miri/pr/487/near/136259245" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> RalfJ <a href="https://rust-lang.github.io/zulip_archive/stream/146212-t-compiler/const-eval/topic/miri.2Fpr.2F487.html#136259245">(Oct 22 2018 at 10:50)</a>:</h4>
<p>and the comment is meant to indicate that there is work to be done. you want me to extend it?</p>



<a name="136259254"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/146212-t-compiler/const-eval/topic/miri/pr/487/near/136259254" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> oli <a href="https://rust-lang.github.io/zulip_archive/stream/146212-t-compiler/const-eval/topic/miri.2Fpr.2F487.html#136259254">(Oct 22 2018 at 10:51)</a>:</h4>
<p>Well move it onto the arm at least</p>



<a name="136259265"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/146212-t-compiler/const-eval/topic/miri/pr/487/near/136259265" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> oli <a href="https://rust-lang.github.io/zulip_archive/stream/146212-t-compiler/const-eval/topic/miri.2Fpr.2F487.html#136259265">(Oct 22 2018 at 10:51)</a>:</h4>
<p>I didn't figure out it only belonged to the second arm</p>



<a name="136259313"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/146212-t-compiler/const-eval/topic/miri/pr/487/near/136259313" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> RalfJ <a href="https://rust-lang.github.io/zulip_archive/stream/146212-t-compiler/const-eval/topic/miri.2Fpr.2F487.html#136259313">(Oct 22 2018 at 10:52)</a>:</h4>
<p><a href="https://github.com/solson/miri/commit/1a7fb7ec3ce5be7205fc1b3fb40642792985d501" target="_blank" title="https://github.com/solson/miri/commit/1a7fb7ec3ce5be7205fc1b3fb40642792985d501">https://github.com/solson/miri/commit/1a7fb7ec3ce5be7205fc1b3fb40642792985d501</a></p>



<a name="136259823"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/146212-t-compiler/const-eval/topic/miri/pr/487/near/136259823" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> oli <a href="https://rust-lang.github.io/zulip_archive/stream/146212-t-compiler/const-eval/topic/miri.2Fpr.2F487.html#136259823">(Oct 22 2018 at 11:04)</a>:</h4>
<p>Otherwise I think I understood all functions but I don't think I have a full grokking of the overall design yet</p>



<a name="136259882"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/146212-t-compiler/const-eval/topic/miri/pr/487/near/136259882" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> oli <a href="https://rust-lang.github.io/zulip_archive/stream/146212-t-compiler/const-eval/topic/miri.2Fpr.2F487.html#136259882">(Oct 22 2018 at 11:05)</a>:</h4>
<p>So r=me and I'll figure out things as they come</p>



<a name="136265627"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/146212-t-compiler/const-eval/topic/miri/pr/487/near/136265627" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> RalfJ <a href="https://rust-lang.github.io/zulip_archive/stream/146212-t-compiler/const-eval/topic/miri.2Fpr.2F487.html#136265627">(Oct 22 2018 at 13:04)</a>:</h4>
<p>GH seems still broken? it doesnt trigger CI</p>



<a name="136265741"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/146212-t-compiler/const-eval/topic/miri/pr/487/near/136265741" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> oli <a href="https://rust-lang.github.io/zulip_archive/stream/146212-t-compiler/const-eval/topic/miri.2Fpr.2F487.html#136265741">(Oct 22 2018 at 13:07)</a>:</h4>
<p>yea, it's on and off all the time</p>



<a name="136265817"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/146212-t-compiler/const-eval/topic/miri/pr/487/near/136265817" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> RalfJ <a href="https://rust-lang.github.io/zulip_archive/stream/146212-t-compiler/const-eval/topic/miri.2Fpr.2F487.html#136265817">(Oct 22 2018 at 13:08)</a>:</h4>
<p>urg</p>



<hr><p>Last updated: Aug 07 2021 at 22:04 UTC</p>
</html>