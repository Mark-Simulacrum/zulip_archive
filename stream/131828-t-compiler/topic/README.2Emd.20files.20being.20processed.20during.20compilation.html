<html>
<head><meta charset="utf-8"><title>README.md files being processed during compilation · t-compiler · Zulip Chat Archive</title></head>
<h2>Stream: <a href="https://zulip-archive.rust-lang.org/stream/131828-t-compiler/index.html">t-compiler</a></h2>
<h3>Topic: <a href="https://zulip-archive.rust-lang.org/stream/131828-t-compiler/topic/README.2Emd.20files.20being.20processed.20during.20compilation.html">README.md files being processed during compilation</a></h3>

<hr>

<base href="https://rust-lang.zulipchat.com">

<head><link href="https://zulip-archive.rust-lang.org/style.css" rel="stylesheet"></head>

<a name="273166778"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/README.md%20files%20being%20processed%20during%20compilation/near/273166778" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nnethercote <a href="https://zulip-archive.rust-lang.org/stream/131828-t-compiler/topic/README.2Emd.20files.20being.20processed.20during.20compilation.html#273166778">(Feb 24 2022 at 23:52)</a>:</h4>
<p>While working on <a href="https://github.com/rust-lang/rust/pull/94316">https://github.com/rust-lang/rust/pull/94316</a>, which improved parsing of string literals, I printed out some of the strings being processed by <code>unescape_str_or_byte_str</code>, and saw something unexpected: the contents of <code>README.md</code> files from the crate.</p>



<a name="273166858"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/README.md%20files%20being%20processed%20during%20compilation/near/273166858" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nnethercote <a href="https://zulip-archive.rust-lang.org/stream/131828-t-compiler/topic/README.2Emd.20files.20being.20processed.20during.20compilation.html#273166858">(Feb 24 2022 at 23:53)</a>:</h4>
<p>E.g. <a href="https://github.com/RustCrypto/formats/blob/019454fda0b824534b43e3952ff36c887c21e1a4/pkcs8/README.md">this README.md</a> while compiling the <code>pkcs8</code> crate.</p>



<a name="273166926"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/README.md%20files%20being%20processed%20during%20compilation/near/273166926" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nnethercote <a href="https://zulip-archive.rust-lang.org/stream/131828-t-compiler/topic/README.2Emd.20files.20being.20processed.20during.20compilation.html#273166926">(Feb 24 2022 at 23:54)</a>:</h4>
<p>It's scanned not just once, but 73 times(!)</p>



<a name="273166939"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/README.md%20files%20being%20processed%20during%20compilation/near/273166939" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nnethercote <a href="https://zulip-archive.rust-lang.org/stream/131828-t-compiler/topic/README.2Emd.20files.20being.20processed.20during.20compilation.html#273166939">(Feb 24 2022 at 23:54)</a>:</h4>
<p>I've seen this on a couple of other crates, too.</p>



<a name="273166968"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/README.md%20files%20being%20processed%20during%20compilation/near/273166968" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nnethercote <a href="https://zulip-archive.rust-lang.org/stream/131828-t-compiler/topic/README.2Emd.20files.20being.20processed.20during.20compilation.html#273166968">(Feb 24 2022 at 23:55)</a>:</h4>
<p>Such as <code>der-0.6.0-pre.0</code> and <code>bitvec-1.0.0</code>.</p>



<a name="273167075"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/README.md%20files%20being%20processed%20during%20compilation/near/273167075" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nnethercote <a href="https://zulip-archive.rust-lang.org/stream/131828-t-compiler/topic/README.2Emd.20files.20being.20processed.20during.20compilation.html#273167075">(Feb 24 2022 at 23:56)</a>:</h4>
<p>This is on <code>cargo check</code> builds.</p>
<p>A Callgrind profile suggests this is happening within<code>&lt;rustc_lint::builtin::MissingDoc as rustc_lint::passes::LateLintPass&gt;::enter_lint_attrs</code>?</p>



<a name="273167103"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/README.md%20files%20being%20processed%20during%20compilation/near/273167103" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nnethercote <a href="https://zulip-archive.rust-lang.org/stream/131828-t-compiler/topic/README.2Emd.20files.20being.20processed.20during.20compilation.html#273167103">(Feb 24 2022 at 23:56)</a>:</h4>
<p>I admit, this has bamboozled me</p>



<a name="273167165"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/README.md%20files%20being%20processed%20during%20compilation/near/273167165" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nnethercote <a href="https://zulip-archive.rust-lang.org/stream/131828-t-compiler/topic/README.2Emd.20files.20being.20processed.20during.20compilation.html#273167165">(Feb 24 2022 at 23:57)</a>:</h4>
<div class="codehilite"><pre><span></span><code>    /// The `missing_docs` lint detects missing documentation for public items.
</code></pre></div>



<a name="273167216"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/README.md%20files%20being%20processed%20during%20compilation/near/273167216" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nnethercote <a href="https://zulip-archive.rust-lang.org/stream/131828-t-compiler/topic/README.2Emd.20files.20being.20processed.20during.20compilation.html#273167216">(Feb 24 2022 at 23:58)</a>:</h4>
<p>Apparently it looks in README.md files as part of this?!</p>



<a name="273167260"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/README.md%20files%20being%20processed%20during%20compilation/near/273167260" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> bjorn3 <a href="https://zulip-archive.rust-lang.org/stream/131828-t-compiler/topic/README.2Emd.20files.20being.20processed.20during.20compilation.html#273167260">(Feb 24 2022 at 23:58)</a>:</h4>
<p><a href="https://github.com/RustCrypto/formats/blob/019454fda0b824534b43e3952ff36c887c21e1a4/pkcs8/src/lib.rs#L3">https://github.com/RustCrypto/formats/blob/019454fda0b824534b43e3952ff36c887c21e1a4/pkcs8/src/lib.rs#L3</a></p>



<a name="273167288"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/README.md%20files%20being%20processed%20during%20compilation/near/273167288" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> bjorn3 <a href="https://zulip-archive.rust-lang.org/stream/131828-t-compiler/topic/README.2Emd.20files.20being.20processed.20during.20compilation.html#273167288">(Feb 24 2022 at 23:59)</a>:</h4>
<p>The readme is explicitly included as crate level documentation.</p>



<a name="273167417"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/README.md%20files%20being%20processed%20during%20compilation/near/273167417" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nnethercote <a href="https://zulip-archive.rust-lang.org/stream/131828-t-compiler/topic/README.2Emd.20files.20being.20processed.20during.20compilation.html#273167417">(Feb 25 2022 at 00:00)</a>:</h4>
<p>Ah, yes! thank you</p>



<a name="273167576"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/README.md%20files%20being%20processed%20during%20compilation/near/273167576" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nnethercote <a href="https://zulip-archive.rust-lang.org/stream/131828-t-compiler/topic/README.2Emd.20files.20being.20processed.20during.20compilation.html#273167576">(Feb 25 2022 at 00:01)</a>:</h4>
<p>Still surprising it's processed so many times</p>



<a name="273168327"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/README.md%20files%20being%20processed%20during%20compilation/near/273168327" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Josh Triplett <a href="https://zulip-archive.rust-lang.org/stream/131828-t-compiler/topic/README.2Emd.20files.20being.20processed.20during.20compilation.html#273168327">(Feb 25 2022 at 00:10)</a>:</h4>
<p>Yeah, that does seem surprising. I'd be interested if we could reduce the number of parsings.</p>



<a name="273169816"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/README.md%20files%20being%20processed%20during%20compilation/near/273169816" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> lqd <a href="https://zulip-archive.rust-lang.org/stream/131828-t-compiler/topic/README.2Emd.20files.20being.20processed.20during.20compilation.html#273169816">(Feb 25 2022 at 00:31)</a>:</h4>
<p>(the same thing is done for <a href="https://github.com/bitvecto-rs/bitvec/blob/a7a82c67206d6e3ced67294883f6d1baaae7d74c/src/lib.rs#L1">bitvec</a> and <a href="https://github.com/RustCrypto/formats/blob/9d902f034f074d83ea8615ed1eeed785abef4e6b/der/src/lib.rs#L3">der</a>)</p>



<a name="273184304"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/README.md%20files%20being%20processed%20during%20compilation/near/273184304" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jake Goulding <a href="https://zulip-archive.rust-lang.org/stream/131828-t-compiler/topic/README.2Emd.20files.20being.20processed.20during.20compilation.html#273184304">(Feb 25 2022 at 03:13)</a>:</h4>
<p>And any crate <a href="https://crates.io/crates/doc-comment/reverse_dependencies">depending on</a> (200+) <a href="https://docs.rs/doc-comment/latest/doc_comment/">doc-comment</a> is likely to do the same.</p>



<hr><p>Last updated: Apr 12 2022 at 20:01 UTC</p>
</html>