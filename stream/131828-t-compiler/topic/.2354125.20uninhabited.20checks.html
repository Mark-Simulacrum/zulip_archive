<html>
<head><meta charset="utf-8"><title>#54125 uninhabited checks · t-compiler · Zulip Chat Archive</title></head>
<h2>Stream: <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/index.html">t-compiler</a></h2>
<h3>Topic: <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/.2354125.20uninhabited.20checks.html">#54125 uninhabited checks</a></h3>

<hr>

<base href="https://rust-lang.zulipchat.com">

<head><link href="https://rust-lang.github.io/zulip_archive/style.css" rel="stylesheet"></head>

<a name="136353045"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/%2354125%20uninhabited%20checks/near/136353045" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/.2354125.20uninhabited.20checks.html#136353045">(Oct 23 2018 at 17:39)</a>:</h4>
<p><span class="user-mention" data-user-id="121053">@varkor</span> I'm confused by <a href="https://github.com/rust-lang/rust/pull/54125#issuecomment-431964803" target="_blank" title="https://github.com/rust-lang/rust/pull/54125#issuecomment-431964803">this comment of yours</a>:</p>
<blockquote>
<p>Maybe. There was only a single case in the stdlib in the end, and such a case in other code should be straightforwardly refactored.</p>
</blockquote>
<p>In particular, I didn't see any edits to libstd?</p>



<a name="136357061"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/%2354125%20uninhabited%20checks/near/136357061" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> varkor <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/.2354125.20uninhabited.20checks.html#136357061">(Oct 23 2018 at 18:31)</a>:</h4>
<p><span class="user-mention" data-user-id="116009">@nikomatsakis</span>: that confused me when you pointed it out, too.</p>



<a name="136357068"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/%2354125%20uninhabited%20checks/near/136357068" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> varkor <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/.2354125.20uninhabited.20checks.html#136357068">(Oct 23 2018 at 18:31)</a>:</h4>
<p>because I don't remember reverting the change to libstd</p>



<a name="136357133"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/%2354125%20uninhabited%20checks/near/136357133" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> varkor <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/.2354125.20uninhabited.20checks.html#136357133">(Oct 23 2018 at 18:32)</a>:</h4>
<p>I think what must have happened is that it got lost when I was rebasing and I didn't notice because the tests continued to pass</p>



<a name="136357182"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/%2354125%20uninhabited%20checks/near/136357182" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/.2354125.20uninhabited.20checks.html#136357182">(Oct 23 2018 at 18:32)</a>:</h4>
<p>ok</p>



<a name="136357192"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/%2354125%20uninhabited%20checks/near/136357192" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/.2354125.20uninhabited.20checks.html#136357192">(Oct 23 2018 at 18:32)</a>:</h4>
<p>I guess we don't test that configuration in travis</p>



<a name="136357200"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/%2354125%20uninhabited%20checks/near/136357200" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> varkor <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/.2354125.20uninhabited.20checks.html#136357200">(Oct 23 2018 at 18:33)</a>:</h4>
<p>my suspicion is that the warning takes desugaring into account and that maybe <a href="https://github.com/rust-lang/rust/pull/54787" target="_blank" title="https://github.com/rust-lang/rust/pull/54787">https://github.com/rust-lang/rust/pull/54787</a> fixed it unintionally</p>



<a name="136357228"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/%2354125%20uninhabited%20checks/near/136357228" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> varkor <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/.2354125.20uninhabited.20checks.html#136357228">(Oct 23 2018 at 18:33)</a>:</h4>
<p>well, the tests were failing before for the wasm target</p>



<a name="136357233"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/%2354125%20uninhabited%20checks/near/136357233" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/.2354125.20uninhabited.20checks.html#136357233">(Oct 23 2018 at 18:33)</a>:</h4>
<p>oh, could .. be ..</p>



<a name="136357246"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/%2354125%20uninhabited%20checks/near/136357246" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> varkor <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/.2354125.20uninhabited.20checks.html#136357246">(Oct 23 2018 at 18:33)</a>:</h4>
<p>it's just a guess though; I'm not really sure</p>



<a name="136357251"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/%2354125%20uninhabited%20checks/near/136357251" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/.2354125.20uninhabited.20checks.html#136357251">(Oct 23 2018 at 18:33)</a>:</h4>
<p>ok, do you want to investigate?</p>



<a name="136357302"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/%2354125%20uninhabited%20checks/near/136357302" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/.2354125.20uninhabited.20checks.html#136357302">(Oct 23 2018 at 18:34)</a>:</h4>
<p>or are you satisfied with PR as is</p>



<a name="136357543"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/%2354125%20uninhabited%20checks/near/136357543" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> varkor <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/.2354125.20uninhabited.20checks.html#136357543">(Oct 23 2018 at 18:37)</a>:</h4>
<p>in terms of the externally-visible result, I'm happy either way — I think a warning is acceptable for cases like <code>TcpStream</code>, but if it's no longer going to warn in a desugared context, that also seems reasonable</p>
<p>but if you feel that we should work out exactly why this behaviour changed, I can investigate it</p>



<a name="136359178"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/%2354125%20uninhabited%20checks/near/136359178" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/.2354125.20uninhabited.20checks.html#136359178">(Oct 23 2018 at 19:00)</a>:</h4>
<p>I'm satisfied either way I think</p>



<a name="136365425"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/%2354125%20uninhabited%20checks/near/136365425" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> varkor <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/.2354125.20uninhabited.20checks.html#136365425">(Oct 23 2018 at 20:35)</a>:</h4>
<p>okay, let's just go with it; I feel like it's been in statis long enough <span class="emoji emoji-1f604" title="big smile">:big_smile:</span></p>



<a name="136365431"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/%2354125%20uninhabited%20checks/near/136365431" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> varkor <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/.2354125.20uninhabited.20checks.html#136365431">(Oct 23 2018 at 20:36)</a>:</h4>
<p>(that's one enthusiastic emoji)</p>



<a name="136421146"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/%2354125%20uninhabited%20checks/near/136421146" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> varkor <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/.2354125.20uninhabited.20checks.html#136421146">(Oct 24 2018 at 16:35)</a>:</h4>
<p><a href="https://github.com/rust-lang/rust/pull/54125#issuecomment-432732169" target="_blank" title="https://github.com/rust-lang/rust/pull/54125#issuecomment-432732169">https://github.com/rust-lang/rust/pull/54125#issuecomment-432732169</a></p>



<a name="136421155"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/%2354125%20uninhabited%20checks/near/136421155" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> varkor <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/.2354125.20uninhabited.20checks.html#136421155">(Oct 24 2018 at 16:35)</a>:</h4>
<p>are you happy with the <code>#[allow(unused_variables)]</code> for <code>TcpStream</code>?</p>



<a name="136428111"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/%2354125%20uninhabited%20checks/near/136428111" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/.2354125.20uninhabited.20checks.html#136428111">(Oct 24 2018 at 18:38)</a>:</h4>
<p>I am satisfied; I would be happi<em>er</em> if it included a comment</p>



<a name="136428122"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/%2354125%20uninhabited%20checks/near/136428122" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/.2354125.20uninhabited.20checks.html#136428122">(Oct 24 2018 at 18:38)</a>:</h4>
<p>(Maybe happier <em>still</em> if we could make it conditional on the configuration)</p>



<a name="136428134"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/%2354125%20uninhabited%20checks/near/136428134" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/.2354125.20uninhabited.20checks.html#136428134">(Oct 24 2018 at 18:38)</a>:</h4>
<p>personally though this seems like a case where a comment is "just fine"</p>



<a name="136428165"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/%2354125%20uninhabited%20checks/near/136428165" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/.2354125.20uninhabited.20checks.html#136428165">(Oct 24 2018 at 18:39)</a>:</h4>
<p>e.g., "In some configurations, e.g., WASM, <code>TcpStream</code> is not supported and hence this is dead code; suppress the resulting warning, since in other platforms, the code is not dead."</p>



<a name="151261538"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/%2354125%20uninhabited%20checks/near/151261538" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> DPC <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/.2354125.20uninhabited.20checks.html#151261538">(Dec 10 2018 at 09:54)</a>:</h4>
<p><span class="user-mention" data-user-id="116009">@nikomatsakis</span> <span class="user-mention" data-user-id="121053">@varkor</span> what's the status of this PR? can you update it on the PR? thanks (from triage)</p>



<hr><p>Last updated: Aug 07 2021 at 22:04 UTC</p>
</html>