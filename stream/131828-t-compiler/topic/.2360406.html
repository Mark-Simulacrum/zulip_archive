<html>
<head><meta charset="utf-8"><title>#60406 · t-compiler · Zulip Chat Archive</title></head>
<h2>Stream: <a href="https://zulip-archive.rust-lang.org/stream/131828-t-compiler/index.html">t-compiler</a></h2>
<h3>Topic: <a href="https://zulip-archive.rust-lang.org/stream/131828-t-compiler/topic/.2360406.html">#60406</a></h3>

<hr>

<base href="https://rust-lang.zulipchat.com">

<head><link href="https://zulip-archive.rust-lang.org/style.css" rel="stylesheet"></head>

<a name="164630072"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/%2360406/near/164630072" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Caio <a href="https://zulip-archive.rust-lang.org/stream/131828-t-compiler/topic/.2360406.html#164630072">(May 01 2019 at 15:05)</a>:</h4>
<p>Can someone guide me on issue <a href="https://github.com/rust-lang/rust/issues/60406" target="_blank" title="https://github.com/rust-lang/rust/issues/60406">#60406</a>?</p>



<a name="164630625"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/%2360406/near/164630625" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/131828-t-compiler/topic/.2360406.html#164630625">(May 01 2019 at 15:13)</a>:</h4>
<blockquote>
<p>Tracking issue for RFC 2565, "Attributes in formal function parameter position" <a href="https://github.com/rust-lang/rust/issues/60406" target="_blank" title="https://github.com/rust-lang/rust/issues/60406">#60406</a></p>
</blockquote>



<a name="164630629"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/%2360406/near/164630629" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/131828-t-compiler/topic/.2360406.html#164630629">(May 01 2019 at 15:13)</a>:</h4>
<p>For context :)</p>



<a name="164630652"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/%2360406/near/164630652" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/131828-t-compiler/topic/.2360406.html#164630652">(May 01 2019 at 15:13)</a>:</h4>
<p>I feel like <span class="user-mention" data-user-id="116083">@pnkfelix</span> added support for this? Oh, no, it was <em>type</em> parameters that they added support for</p>



<a name="164630657"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/%2360406/near/164630657" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/131828-t-compiler/topic/.2360406.html#164630657">(May 01 2019 at 15:13)</a>:</h4>
<p>Still, that PR might serve as a good "guidepost"</p>



<a name="164719980"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/%2360406/near/164719980" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Caio <a href="https://zulip-archive.rust-lang.org/stream/131828-t-compiler/topic/.2360406.html#164719980">(May 02 2019 at 15:55)</a>:</h4>
<p>Unfortunately, I was unable to find on GitHub this specific PR from <span class="user-mention" data-user-id="116083">@pnkfelix</span>. Still looking though</p>



<a name="164720963"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/%2360406/near/164720963" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> centril <a href="https://zulip-archive.rust-lang.org/stream/131828-t-compiler/topic/.2360406.html#164720963">(May 02 2019 at 16:07)</a>:</h4>
<p><span class="user-mention" data-user-id="211466">@Caio</span> <a href="https://github.com/rust-lang/rust/pull/34764" target="_blank" title="https://github.com/rust-lang/rust/pull/34764">https://github.com/rust-lang/rust/pull/34764</a></p>



<a name="164720973"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/%2360406/near/164720973" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> centril <a href="https://zulip-archive.rust-lang.org/stream/131828-t-compiler/topic/.2360406.html#164720973">(May 02 2019 at 16:07)</a>:</h4>
<p>also cc <span class="user-mention" data-user-id="123856">@Vadim Petrochenkov</span></p>



<a name="164759735"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/%2360406/near/164759735" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Caio <a href="https://zulip-archive.rust-lang.org/stream/131828-t-compiler/topic/.2360406.html#164759735">(May 03 2019 at 01:21)</a>:</h4>
<p><span class="user-mention" data-user-id="126931">@centril</span> Thanks!</p>



<a name="165181963"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/%2360406/near/165181963" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Caio <a href="https://zulip-archive.rust-lang.org/stream/131828-t-compiler/topic/.2360406.html#165181963">(May 08 2019 at 17:17)</a>:</h4>
<p>libsyntax/parse/parser.rs -&gt; The parsing of a function parameter passes through  <code>parse_pat_with_range_pat</code> and then <code>lit_token</code>, which tells if a token is illegal or not. In my case,  <code>expected argument name, found '#'</code> for something like <code>foo(#[bar] u8)</code></p>



<a name="165182424"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/%2360406/near/165182424" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Caio <a href="https://zulip-archive.rust-lang.org/stream/131828-t-compiler/topic/.2360406.html#165182424">(May 08 2019 at 17:23)</a>:</h4>
<p>Should another literal by added in token::Lit to handle this new feature?</p>



<a name="165186777"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/%2360406/near/165186777" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Caio <a href="https://zulip-archive.rust-lang.org/stream/131828-t-compiler/topic/.2360406.html#165186777">(May 08 2019 at 18:13)</a>:</h4>
<p>Actually, NVM. I was in the wrong trail</p>



<a name="165199568"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/%2360406/near/165199568" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Caio <a href="https://zulip-archive.rust-lang.org/stream/131828-t-compiler/topic/.2360406.html#165199568">(May 08 2019 at 20:47)</a>:</h4>
<p>Are the tokens normalized in <a href="http://parser.rs" target="_blank" title="http://parser.rs">parser.rs</a>?</p>



<a name="165199719"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/%2360406/near/165199719" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Caio <a href="https://zulip-archive.rust-lang.org/stream/131828-t-compiler/topic/.2360406.html#165199719">(May 08 2019 at 20:49)</a>:</h4>
<p>Like, the user provided <code>foo(     #[bar]             field     :     u8)</code> and the additional whitespaces are already stripped in <code>parser.rs</code></p>



<a name="165200293"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/%2360406/near/165200293" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Caio <a href="https://zulip-archive.rust-lang.org/stream/131828-t-compiler/topic/.2360406.html#165200293">(May 08 2019 at 20:57)</a>:</h4>
<p>Also, now that <code>ast::Arg</code> has <code>Attributes</code>, how should I expose it to the user through the  <code>proc_macro</code> crate?</p>



<a name="165478183"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/%2360406/near/165478183" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Caio <a href="https://zulip-archive.rust-lang.org/stream/131828-t-compiler/topic/.2360406.html#165478183">(May 12 2019 at 19:40)</a>:</h4>
<p>I don't want to be a boring person but these questions came out of despair</p>



<a name="165478185"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/%2360406/near/165478185" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Caio <a href="https://zulip-archive.rust-lang.org/stream/131828-t-compiler/topic/.2360406.html#165478185">(May 12 2019 at 19:40)</a>:</h4>
<p>I know you guys are too busy and I'm sorry for bothering</p>



<a name="165478305"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/%2360406/near/165478305" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Caio <a href="https://zulip-archive.rust-lang.org/stream/131828-t-compiler/topic/.2360406.html#165478305">(May 12 2019 at 19:44)</a>:</h4>
<p>The only thing left to complete this feature is macro resolution, which I couldn't fully understand after hours of struggle</p>



<a name="165478323"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/%2360406/near/165478323" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Caio <a href="https://zulip-archive.rust-lang.org/stream/131828-t-compiler/topic/.2360406.html#165478323">(May 12 2019 at 19:45)</a>:</h4>
<p>Any tips about it would be very welcoming</p>



<a name="165478328"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/%2360406/near/165478328" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Caio <a href="https://zulip-archive.rust-lang.org/stream/131828-t-compiler/topic/.2360406.html#165478328">(May 12 2019 at 19:45)</a>:</h4>
<p>PR is in <a href="https://github.com/rust-lang/rust/pull/60669" target="_blank" title="https://github.com/rust-lang/rust/pull/60669">https://github.com/rust-lang/rust/pull/60669</a></p>



<a name="165478524"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/%2360406/near/165478524" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> centril <a href="https://zulip-archive.rust-lang.org/stream/131828-t-compiler/topic/.2360406.html#165478524">(May 12 2019 at 19:51)</a>:</h4>
<p>cc <span class="user-mention" data-user-id="123856">@Vadim Petrochenkov</span> ^--- since you are reviewing the PR</p>



<a name="165478718"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/%2360406/near/165478718" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Vadim Petrochenkov <a href="https://zulip-archive.rust-lang.org/stream/131828-t-compiler/topic/.2360406.html#165478718">(May 12 2019 at 19:56)</a>:</h4>
<p>Sorry for the delay, I'll get to this PR during the week.</p>



<a name="165478749"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/%2360406/near/165478749" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Vadim Petrochenkov <a href="https://zulip-archive.rust-lang.org/stream/131828-t-compiler/topic/.2360406.html#165478749">(May 12 2019 at 19:57)</a>:</h4>
<p>Macros are not supposed to be resolved in that position (not until some infrastructural pre-requisite work is done at least).</p>



<a name="165478820"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/%2360406/near/165478820" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Vadim Petrochenkov <a href="https://zulip-archive.rust-lang.org/stream/131828-t-compiler/topic/.2360406.html#165478820">(May 12 2019 at 19:59)</a>:</h4>
<p>Look what happens with attributes on e.g. generic parameters <code>fn f&lt;#[attr] T&gt;</code>, they are not resolved, they are kind of whitelisted through a hack in <code>feature_gate.rs</code>.</p>



<a name="165478831"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/%2360406/near/165478831" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Vadim Petrochenkov <a href="https://zulip-archive.rust-lang.org/stream/131828-t-compiler/topic/.2360406.html#165478831">(May 12 2019 at 19:59)</a>:</h4>
<p>(Which doesn't require any extra work for fn param attributes specifically.)</p>



<a name="165478938"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/%2360406/near/165478938" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Vadim Petrochenkov <a href="https://zulip-archive.rust-lang.org/stream/131828-t-compiler/topic/.2360406.html#165478938">(May 12 2019 at 20:01)</a>:</h4>
<p><code>cfg</code> support will need to be implemented though, so I'd recommend to look at that (<code>libsyntax/config.rs</code>, by analogy with attributes in other positions).</p>



<a name="165479058"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/%2360406/near/165479058" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Vadim Petrochenkov <a href="https://zulip-archive.rust-lang.org/stream/131828-t-compiler/topic/.2360406.html#165479058">(May 12 2019 at 20:04)</a>:</h4>
<blockquote>
<p>not until some infrastructural pre-requisite work is done at least</p>
</blockquote>
<p>That's why I always had a feeling that it's not the best time to implement support for attributes in more locations right now.</p>



<a name="165479081"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/%2360406/near/165479081" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Vadim Petrochenkov <a href="https://zulip-archive.rust-lang.org/stream/131828-t-compiler/topic/.2360406.html#165479081">(May 12 2019 at 20:05)</a>:</h4>
<p>I hoped for that the RFC staying unimplemented for some time, but well...</p>



<a name="165479135"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/%2360406/near/165479135" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Vadim Petrochenkov <a href="https://zulip-archive.rust-lang.org/stream/131828-t-compiler/topic/.2360406.html#165479135">(May 12 2019 at 20:06)</a>:</h4>
<p>(The pre-requisite work is in my queue, it's a part of the macro modularization work, I've just consistently happened to be busy in February-April.)</p>



<a name="165485608"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/%2360406/near/165485608" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Caio <a href="https://zulip-archive.rust-lang.org/stream/131828-t-compiler/topic/.2360406.html#165485608">(May 12 2019 at 23:02)</a>:</h4>
<p>Thank you <span class="user-mention" data-user-id="123856">@Vadim Petrochenkov</span> , this shed some light on the matter</p>



<a name="165759952"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/%2360406/near/165759952" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Caio <a href="https://zulip-archive.rust-lang.org/stream/131828-t-compiler/topic/.2360406.html#165759952">(May 15 2019 at 22:16)</a>:</h4>
<p>The closest I could get in the lexer is the following:</p>
<div class="codehilite"><pre><span></span>&#39;(&#39; =&gt; {
    self.bump();
    if self.ch_is(&#39;#&#39;) &amp;&amp; self.nextch_is(&#39;[&#39;) &amp;&amp; ident_start(self.nextnextch()) {
        loop {
            let raw_start = self.pos;
            self.bump();
            while ident_continue(self.ch) { self.bump(); }
            let span = self.mk_sp(raw_start, self.pos);
            self.sess.param_attr_spans.borrow_mut().push(span);
            self.bump();
            if !self.ch_is(&#39;#&#39;)
                || !self.nextch_is(&#39;[&#39;)
                || !ident_start(self.nextnextch())
            {
                break;
            }
        }
        Ok(token::CloseDelim(token::Bracket))
    }
    else {
        Ok(token::OpenDelim(token::Paren))
    }
}
</pre></div>



<a name="165760107"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/%2360406/near/165760107" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Caio <a href="https://zulip-archive.rust-lang.org/stream/131828-t-compiler/topic/.2360406.html#165760107">(May 15 2019 at 22:18)</a>:</h4>
<p>Unfortunately, this won't work because of tuple structs: <code>struct Foo(#[attr] i32)</code></p>



<a name="165795173"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/%2360406/near/165795173" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Vadim Petrochenkov <a href="https://zulip-archive.rust-lang.org/stream/131828-t-compiler/topic/.2360406.html#165795173">(May 16 2019 at 09:56)</a>:</h4>
<p><span class="user-mention" data-user-id="211466">@Caio</span> , are you trying to collect spans for feature gating? (<a href="https://github.com/rust-lang/rust/pull/60669#discussion_r283902442" target="_blank" title="https://github.com/rust-lang/rust/pull/60669#discussion_r283902442">https://github.com/rust-lang/rust/pull/60669#discussion_r283902442</a>)</p>
<p>In that case you need the parser, not lexer, the spans can be collected on every call to <code>fn parse_arg_attributes</code>.</p>



<a name="165819810"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/%2360406/near/165819810" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Caio <a href="https://zulip-archive.rust-lang.org/stream/131828-t-compiler/topic/.2360406.html#165819810">(May 16 2019 at 15:19)</a>:</h4>
<p><span class="user-mention" data-user-id="123856">@Vadim Petrochenkov</span> Sorry, it was a misunderstanding of mine (lexer instead of parser).</p>



<a name="165819816"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/%2360406/near/165819816" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Caio <a href="https://zulip-archive.rust-lang.org/stream/131828-t-compiler/topic/.2360406.html#165819816">(May 16 2019 at 15:19)</a>:</h4>
<p>Thanks!</p>



<a name="165891784"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/%2360406/near/165891784" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Caio <a href="https://zulip-archive.rust-lang.org/stream/131828-t-compiler/topic/.2360406.html#165891784">(May 17 2019 at 11:30)</a>:</h4>
<p>What would be the best thing to add into the <code>Annotable</code> enum?<br>
According to the RFC, people expect <code>pat: type</code>, so I think it should be <code>Arg((P&lt;ast::Pat&gt;, P&lt;ast::Ty&gt;))</code></p>



<a name="165891910"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/%2360406/near/165891910" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Caio <a href="https://zulip-archive.rust-lang.org/stream/131828-t-compiler/topic/.2360406.html#165891910">(May 17 2019 at 11:33)</a>:</h4>
<p>Or, instead, should a new member be added into <code>InvocationKind</code>?</p>
<div class="codehilite"><pre><span></span>pub enum InvocationKind {
    Bang { ... },
    Attr { ... },
    ArgAttr { ... },
    Derive { ... },
}
</pre></div>



<a name="165895244"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/%2360406/near/165895244" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Vadim Petrochenkov <a href="https://zulip-archive.rust-lang.org/stream/131828-t-compiler/topic/.2360406.html#165895244">(May 17 2019 at 12:17)</a>:</h4>
<p><span class="user-mention" data-user-id="211466">@Caio</span> <br>
Why do you need to touch <code>Annotatable</code>?</p>



<a name="165895248"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/%2360406/near/165895248" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Vadim Petrochenkov <a href="https://zulip-archive.rust-lang.org/stream/131828-t-compiler/topic/.2360406.html#165895248">(May 17 2019 at 12:17)</a>:</h4>
<p>Or <code>InvocationKind</code>.</p>



<a name="165895266"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/%2360406/near/165895266" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Vadim Petrochenkov <a href="https://zulip-archive.rust-lang.org/stream/131828-t-compiler/topic/.2360406.html#165895266">(May 17 2019 at 12:17)</a>:</h4>
<p>That's the macro support which is out of scope now.</p>



<a name="165895479"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/%2360406/near/165895479" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Vadim Petrochenkov <a href="https://zulip-archive.rust-lang.org/stream/131828-t-compiler/topic/.2360406.html#165895479">(May 17 2019 at 12:21)</a>:</h4>
<p>Use any other non-macro attribute position as an example (e.g. attributes on <code>match</code> arms), they are implemented without ever working with <code>Annotatable</code>, or <code>AstFragment</code>, or all that macro machinery.</p>



<a name="165895585"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/%2360406/near/165895585" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Caio <a href="https://zulip-archive.rust-lang.org/stream/131828-t-compiler/topic/.2360406.html#165895585">(May 17 2019 at 12:22)</a>:</h4>
<p>Actually, I don't know why exactly :P<br>
Just wanted to expand attributes inside arguments</p>



<a name="165895613"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/%2360406/near/165895613" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Caio <a href="https://zulip-archive.rust-lang.org/stream/131828-t-compiler/topic/.2360406.html#165895613">(May 17 2019 at 12:22)</a>:</h4>
<blockquote>
<p>(e.g. attributes on match arms)</p>
</blockquote>
<p>Thanks! I will look into the PR</p>



<a name="166000407"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/%2360406/near/166000407" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Caio <a href="https://zulip-archive.rust-lang.org/stream/131828-t-compiler/topic/.2360406.html#166000407">(May 19 2019 at 01:53)</a>:</h4>
<p><span class="user-mention" data-user-id="123856">@Vadim Petrochenkov</span> The user needs a way to declare a custom macro for parameters<br>
Since <code>proc_macro_attribute</code> isn't allowed, I guess a new attribute like <code>proc_macro_arg_attribute</code> would be required for proc-macro crates<br>
That's right?</p>



<a name="166014822"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/%2360406/near/166014822" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Vadim Petrochenkov <a href="https://zulip-archive.rust-lang.org/stream/131828-t-compiler/topic/.2360406.html#166014822">(May 19 2019 at 09:18)</a>:</h4>
<blockquote>
<p>The user needs a way to declare a custom macro for parameters</p>
</blockquote>
<p>The RFC says this is not supported.<br>
If it's supported in the future, then it will be done directly with <code>proc_macro_attribute</code>, without introducing a new <code>proc_macro_*</code> attribute.</p>



<a name="166016910"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/%2360406/near/166016910" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Caio <a href="https://zulip-archive.rust-lang.org/stream/131828-t-compiler/topic/.2360406.html#166016910">(May 19 2019 at 10:22)</a>:</h4>
<p><span class="user-mention" data-user-id="123856">@Vadim Petrochenkov</span>  Thanks!</p>



<a name="166035969"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/%2360406/near/166035969" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Caio <a href="https://zulip-archive.rust-lang.org/stream/131828-t-compiler/topic/.2360406.html#166035969">(May 19 2019 at 19:09)</a>:</h4>
<p><span class="user-mention" data-user-id="123856">@Vadim Petrochenkov</span> This Pr (<a href="https://github.com/rust-lang/rust/pull/12812" target="_blank" title="https://github.com/rust-lang/rust/pull/12812">https://github.com/rust-lang/rust/pull/12812</a>) that enables attrs on match is from 2014 (pre 1.0) and didn't help much</p>



<a name="166036079"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/%2360406/near/166036079" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Caio <a href="https://zulip-archive.rust-lang.org/stream/131828-t-compiler/topic/.2360406.html#166036079">(May 19 2019 at 19:11)</a>:</h4>
<p>I also tried to see get some clues from <code>fold.rs</code> to no avail</p>



<a name="166036198"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/%2360406/near/166036198" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Caio <a href="https://zulip-archive.rust-lang.org/stream/131828-t-compiler/topic/.2360406.html#166036198">(May 19 2019 at 19:14)</a>:</h4>
<p>I tried and I am tying really hard to expand macros but still I have no idea where to start</p>



<a name="166036216"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/%2360406/near/166036216" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Caio <a href="https://zulip-archive.rust-lang.org/stream/131828-t-compiler/topic/.2360406.html#166036216">(May 19 2019 at 19:15)</a>:</h4>
<p>Can you indicate some file or anything that can help me?</p>



<a name="166069202"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/%2360406/near/166069202" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Vadim Petrochenkov <a href="https://zulip-archive.rust-lang.org/stream/131828-t-compiler/topic/.2360406.html#166069202">(May 20 2019 at 09:15)</a>:</h4>
<blockquote>
<p>This Pr (<a href="https://github.com/rust-lang/rust/pull/12812" target="_blank" title="https://github.com/rust-lang/rust/pull/12812">https://github.com/rust-lang/rust/pull/12812</a>) that enables attrs on match is from 2014 (pre 1.0) and didn't help much</p>
</blockquote>
<p>Even if it's old it still contains all the relevant pieces of code actually (I rather meant looking at the current state of match arm attributes than that PR from 2014).<br>
Your PR already implements everything except for the <code>libsyntax/config.rs</code> part.<br>
As I previously said, expanding macros is out of scope for this PR, no need to think about it right now.<br>
<code>#[cfg]</code> expansion is a separate mechanism from macros, if that clarifies the matter.</p>



<a name="166081164"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/%2360406/near/166081164" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Caio <a href="https://zulip-archive.rust-lang.org/stream/131828-t-compiler/topic/.2360406.html#166081164">(May 20 2019 at 12:38)</a>:</h4>
<p><span class="user-mention" data-user-id="123856">@Vadim Petrochenkov</span> Finally got it. I wasn't calling the <code>expand.rs</code> bits, only the <code>config.rs</code> stuff</p>



<a name="166347814"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/%2360406/near/166347814" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Caio <a href="https://zulip-archive.rust-lang.org/stream/131828-t-compiler/topic/.2360406.html#166347814">(May 23 2019 at 10:11)</a>:</h4>
<p><span class="user-mention" data-user-id="126931">@centril</span>  <span class="user-mention" data-user-id="123856">@Vadim Petrochenkov</span> I managed to finish the last (hopefully) issues</p>



<a name="166348089"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/%2360406/near/166348089" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Vadim Petrochenkov <a href="https://zulip-archive.rust-lang.org/stream/131828-t-compiler/topic/.2360406.html#166348089">(May 23 2019 at 10:16)</a>:</h4>
<p>I started reviewing yesterday, but run out of time, unfortunately.<br>
I'll try to do it today.</p>



<a name="166350097"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/%2360406/near/166350097" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Caio <a href="https://zulip-archive.rust-lang.org/stream/131828-t-compiler/topic/.2360406.html#166350097">(May 23 2019 at 10:56)</a>:</h4>
<p>Thanks! Take your time</p>



<a name="166477044"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/%2360406/near/166477044" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Caio <a href="https://zulip-archive.rust-lang.org/stream/131828-t-compiler/topic/.2360406.html#166477044">(May 24 2019 at 18:18)</a>:</h4>
<p><span class="user-mention" data-user-id="123856">@Vadim Petrochenkov</span>  I think <code>unused_variables</code> needs implementation, maybe in <code>liveness.rs</code>?</p>



<a name="166477097"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/%2360406/near/166477097" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Caio <a href="https://zulip-archive.rust-lang.org/stream/131828-t-compiler/topic/.2360406.html#166477097">(May 24 2019 at 18:19)</a>:</h4>
<p>If so, could you describe some brief steps to implement it?</p>



<a name="166477673"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/%2360406/near/166477673" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Vadim Petrochenkov <a href="https://zulip-archive.rust-lang.org/stream/131828-t-compiler/topic/.2360406.html#166477673">(May 24 2019 at 18:25)</a>:</h4>
<p>Guess 1: All UI tests disable <code>unused</code> warnings by default to avoid noise.<br>
Make sure that they are enabled for the test you are working on.</p>



<a name="166478026"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/%2360406/near/166478026" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Vadim Petrochenkov <a href="https://zulip-archive.rust-lang.org/stream/131828-t-compiler/topic/.2360406.html#166478026">(May 24 2019 at 18:28)</a>:</h4>
<p>Guess 2: Function parameters do not have "lint scopes", those scopes are used to demark regions of code on which <code>allow</code>/<code>warn</code>/etc attributes work.<br>
In this case you'll need to do something very similar to what this recent commit does - <a href="https://github.com/rust-lang/rust/pull/60174/commits/e784595c280da04c98e76a5ce9d603b58f6a88e2" target="_blank" title="https://github.com/rust-lang/rust/pull/60174/commits/e784595c280da04c98e76a5ce9d603b58f6a88e2">https://github.com/rust-lang/rust/pull/60174/commits/e784595c280da04c98e76a5ce9d603b58f6a88e2</a></p>



<a name="166478301"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/%2360406/near/166478301" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Vadim Petrochenkov <a href="https://zulip-archive.rust-lang.org/stream/131828-t-compiler/topic/.2360406.html#166478301">(May 24 2019 at 18:31)</a>:</h4>
<p>I.e. the expected changes are in <code>librustc/lint/mod.rs</code>.<br>
<code>unused_variables</code> logic by itself should work correctly, the issue is with enabling/disabling diagnostic output from it (which is what allow/warn and friends do).</p>



<a name="166486746"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/%2360406/near/166486746" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> yodal <a href="https://zulip-archive.rust-lang.org/stream/131828-t-compiler/topic/.2360406.html#166486746">(May 24 2019 at 20:18)</a>:</h4>
<p>If you wanted to test guess 1 you could run the compiler directly rather than through the test framework</p>



<a name="166500718"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/%2360406/near/166500718" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Caio <a href="https://zulip-archive.rust-lang.org/stream/131828-t-compiler/topic/.2360406.html#166500718">(May 25 2019 at 00:17)</a>:</h4>
<p><span class="user-mention" data-user-id="123856">@Vadim Petrochenkov</span> Sorry for the delay, I had to leave my PC</p>



<a name="166500779"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/%2360406/near/166500779" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Caio <a href="https://zulip-archive.rust-lang.org/stream/131828-t-compiler/topic/.2360406.html#166500779">(May 25 2019 at 00:19)</a>:</h4>
<p>I think it is probably going to be Guess 2. Nevertheless, all these information are very important. Thank you</p>



<a name="166500856"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/%2360406/near/166500856" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Caio <a href="https://zulip-archive.rust-lang.org/stream/131828-t-compiler/topic/.2360406.html#166500856">(May 25 2019 at 00:21)</a>:</h4>
<p><span class="user-mention" data-user-id="218608">@yodal</span>  Thank you for the suggestion. By the way, you made a terrific job on const generics</p>



<a name="166500944"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/%2360406/near/166500944" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> yodal <a href="https://zulip-archive.rust-lang.org/stream/131828-t-compiler/topic/.2360406.html#166500944">(May 25 2019 at 00:23)</a>:</h4>
<p>Thank you, though I insist @varkor gets most of the credit as he did most of the hard work</p>



<a name="167248081"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/%2360406/near/167248081" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Caio <a href="https://zulip-archive.rust-lang.org/stream/131828-t-compiler/topic/.2360406.html#167248081">(Jun 04 2019 at 01:31)</a>:</h4>
<p>I am stuck with the same problem for 2 whole days. Very sad :/</p>



<a name="167248244"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/%2360406/near/167248244" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Caio <a href="https://zulip-archive.rust-lang.org/stream/131828-t-compiler/topic/.2360406.html#167248244">(Jun 04 2019 at 01:34)</a>:</h4>
<p><code>fn foo(#[cfg_attr(included_flag, cfg(not_included_flag)]  a: i32)</code> successfully removes the parameter but <code>fn foo(#[cfg_attr(not_included_flag, cfg(included_flag)]  a: i32)</code> does not</p>



<a name="167248270"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/%2360406/near/167248270" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Caio <a href="https://zulip-archive.rust-lang.org/stream/131828-t-compiler/topic/.2360406.html#167248270">(Jun 04 2019 at 01:35)</a>:</h4>
<p>I tried so many different files, compiled and tested things over and over to no avail</p>



<a name="167286919"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/%2360406/near/167286919" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Vadim Petrochenkov <a href="https://zulip-archive.rust-lang.org/stream/131828-t-compiler/topic/.2360406.html#167286919">(Jun 04 2019 at 12:27)</a>:</h4>
<p>Isn't that expected behavior?</p>



<a name="167287037"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/%2360406/near/167287037" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Vadim Petrochenkov <a href="https://zulip-archive.rust-lang.org/stream/131828-t-compiler/topic/.2360406.html#167287037">(Jun 04 2019 at 12:29)</a>:</h4>
<p>If we are expanding step-by-step:<br>
- <code>fn foo(#[cfg_attr(included_flag, cfg(not_included_flag)]  a: i32)</code> -&gt; <code>fn foo(#[cfg(not_included_flag)]  a: i32)</code> -&gt; <code>fn foo()</code><br>
- <code>fn foo(#[cfg_attr(not_included_flag, cfg(included_flag)]  a: i32)</code> -&gt; <code>fn foo(a: i32)</code></p>



<a name="167287166"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/%2360406/near/167287166" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Vadim Petrochenkov <a href="https://zulip-archive.rust-lang.org/stream/131828-t-compiler/topic/.2360406.html#167287166">(Jun 04 2019 at 12:31)</a>:</h4>
<p><code>fn foo(#[cfg_attr(included_flag, anything)]  a: i32)</code> -&gt; <code>fn foo(#[anything]  a: i32)</code><br>
<code>fn foo(#[cfg_attr(not_included_flag, anything)]  a: i32)</code> -&gt; <code>fn foo(a: i32)</code></p>



<a name="167408111"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/%2360406/near/167408111" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Caio <a href="https://zulip-archive.rust-lang.org/stream/131828-t-compiler/topic/.2360406.html#167408111">(Jun 05 2019 at 16:53)</a>:</h4>
<p>HAHAHAHAHAHAHAHAHAHAHAHA</p>



<a name="167408149"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/%2360406/near/167408149" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Caio <a href="https://zulip-archive.rust-lang.org/stream/131828-t-compiler/topic/.2360406.html#167408149">(Jun 05 2019 at 16:53)</a>:</h4>
<p>This is even sadder</p>



<a name="167408180"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/%2360406/near/167408180" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Caio <a href="https://zulip-archive.rust-lang.org/stream/131828-t-compiler/topic/.2360406.html#167408180">(Jun 05 2019 at 16:53)</a>:</h4>
<p><span aria-label="cry" class="emoji emoji-1f622" role="img" title="cry">:cry:</span></p>



<a name="167408322"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/%2360406/near/167408322" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Caio <a href="https://zulip-archive.rust-lang.org/stream/131828-t-compiler/topic/.2360406.html#167408322">(Jun 05 2019 at 16:55)</a>:</h4>
<p>Thanks <span class="user-mention" data-user-id="123856">@Vadim Petrochenkov</span></p>



<a name="167408875"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/%2360406/near/167408875" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Vadim Petrochenkov <a href="https://zulip-archive.rust-lang.org/stream/131828-t-compiler/topic/.2360406.html#167408875">(Jun 05 2019 at 17:00)</a>:</h4>
<p><span aria-label="slight smile" class="emoji emoji-1f642" role="img" title="slight smile">:slight_smile:</span></p>



<a name="168163520"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/%2360406/near/168163520" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Caio <a href="https://zulip-archive.rust-lang.org/stream/131828-t-compiler/topic/.2360406.html#168163520">(Jun 14 2019 at 19:16)</a>:</h4>
<p>I did everything <span class="user-mention" data-user-id="124288">@oli</span> said in <a href="https://github.com/rust-lang/rust/issues/61238" target="_blank" title="https://github.com/rust-lang/rust/issues/61238">#61238</a> but things didn't work out as expected. I guess <code>liveness.rs</code> needs some kind of modification because <a href="https://github.com/rust-lang/rust/blob/fc550d4295a654f9e7c621d957d81fbf1426c70b/src/librustc/middle/liveness.rs#L413" target="_blank" title="https://github.com/rust-lang/rust/blob/fc550d4295a654f9e7c621d957d81fbf1426c70b/src/librustc/middle/liveness.rs#L413">this line</a> is what triggers the linting messages.</p>



<a name="168163640"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/%2360406/near/168163640" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> oli <a href="https://zulip-archive.rust-lang.org/stream/131828-t-compiler/topic/.2360406.html#168163640">(Jun 14 2019 at 19:18)</a>:</h4>
<p><span class="user-mention" data-user-id="211466">@Caio</span> can you open a PR with your code so I can have a look?</p>



<a name="168163651"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/%2360406/near/168163651" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> oli <a href="https://zulip-archive.rust-lang.org/stream/131828-t-compiler/topic/.2360406.html#168163651">(Jun 14 2019 at 19:18)</a>:</h4>
<p>oh, now I understand</p>



<a name="168163663"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/%2360406/near/168163663" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> oli <a href="https://zulip-archive.rust-lang.org/stream/131828-t-compiler/topic/.2360406.html#168163663">(Jun 14 2019 at 19:19)</a>:</h4>
<p>yea, liveness would need a change then</p>



<a name="168163664"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/%2360406/near/168163664" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> oli <a href="https://zulip-archive.rust-lang.org/stream/131828-t-compiler/topic/.2360406.html#168163664">(Jun 14 2019 at 19:19)</a>:</h4>
<p>hmm</p>



<a name="168163797"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/%2360406/near/168163797" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> oli <a href="https://zulip-archive.rust-lang.org/stream/131828-t-compiler/topic/.2360406.html#168163797">(Jun 14 2019 at 19:20)</a>:</h4>
<p>weird, it's using the correct <code>HirId</code>s in <a href="https://github.com/rust-lang/rust/blob/fc550d4295a654f9e7c621d957d81fbf1426c70b/src/librustc/middle/liveness.rs#L1580" target="_blank" title="https://github.com/rust-lang/rust/blob/fc550d4295a654f9e7c621d957d81fbf1426c70b/src/librustc/middle/liveness.rs#L1580">https://github.com/rust-lang/rust/blob/fc550d4295a654f9e7c621d957d81fbf1426c70b/src/librustc/middle/liveness.rs#L1580</a></p>



<a name="168163929"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/%2360406/near/168163929" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Caio <a href="https://zulip-archive.rust-lang.org/stream/131828-t-compiler/topic/.2360406.html#168163929">(Jun 14 2019 at 19:22)</a>:</h4>
<p><span class="user-mention" data-user-id="124288">@oli</span>  I tried to figure out myself but couldn't find the root cause. Any clues are very welcome</p>



<a name="168164072"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/%2360406/near/168164072" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Caio <a href="https://zulip-archive.rust-lang.org/stream/131828-t-compiler/topic/.2360406.html#168164072">(Jun 14 2019 at 19:24)</a>:</h4>
<p>Sure, I will open a PR  in next few hours.</p>



<a name="168340061"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/%2360406/near/168340061" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Caio <a href="https://zulip-archive.rust-lang.org/stream/131828-t-compiler/topic/.2360406.html#168340061">(Jun 17 2019 at 19:27)</a>:</h4>
<p><code>ast::visit</code> and <code>hir::intravisit</code> have not been greatly modified because the arguments are already visited in <code>visit_fn_decl</code> and <code>visit_body</code>, respectively</p>



<a name="168340141"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/%2360406/near/168340141" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Caio <a href="https://zulip-archive.rust-lang.org/stream/131828-t-compiler/topic/.2360406.html#168340141">(Jun 17 2019 at 19:28)</a>:</h4>
<p>For all closures, bare function,  function pointers, blocks and impl blocks</p>



<a name="168340170"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/%2360406/near/168340170" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Caio <a href="https://zulip-archive.rust-lang.org/stream/131828-t-compiler/topic/.2360406.html#168340170">(Jun 17 2019 at 19:29)</a>:</h4>
<p>Am I in the right track?</p>



<a name="168340229"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/%2360406/near/168340229" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Caio <a href="https://zulip-archive.rust-lang.org/stream/131828-t-compiler/topic/.2360406.html#168340229">(Jun 17 2019 at 19:30)</a>:</h4>
<p><span class="user-mention" data-user-id="124288">@oli</span> <span class="user-mention" data-user-id="123856">@Vadim Petrochenkov</span> <a href="https://github.com/rust-lang/rust/issues/61856" target="_blank" title="https://github.com/rust-lang/rust/issues/61856">#61856</a></p>



<a name="168387787"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/%2360406/near/168387787" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> oli <a href="https://zulip-archive.rust-lang.org/stream/131828-t-compiler/topic/.2360406.html#168387787">(Jun 18 2019 at 10:30)</a>:</h4>
<p><span class="user-mention" data-user-id="211466">@Caio</span> I believe you also need to teach <a href="https://github.com/rust-lang/rust/blob/fff08cb04389497d254fb40948674cbbee402908/src/librustc/lint/mod.rs#L809" target="_blank" title="https://github.com/rust-lang/rust/blob/fff08cb04389497d254fb40948674cbbee402908/src/librustc/lint/mod.rs#L809">https://github.com/rust-lang/rust/blob/fff08cb04389497d254fb40948674cbbee402908/src/librustc/lint/mod.rs#L809</a> about the new attributes</p>



<a name="168387812"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/%2360406/near/168387812" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> oli <a href="https://zulip-archive.rust-lang.org/stream/131828-t-compiler/topic/.2360406.html#168387812">(Jun 18 2019 at 10:31)</a>:</h4>
<p>the <code>unused_variable</code> lint is not a regular lint</p>



<a name="168387824"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/%2360406/near/168387824" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> oli <a href="https://zulip-archive.rust-lang.org/stream/131828-t-compiler/topic/.2360406.html#168387824">(Jun 18 2019 at 10:31)</a>:</h4>
<p>also your early-lint-pass changes do not do the attribute dance, only the late-lint-pass changes do</p>



<a name="168501326"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/%2360406/near/168501326" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Caio <a href="https://zulip-archive.rust-lang.org/stream/131828-t-compiler/topic/.2360406.html#168501326">(Jun 19 2019 at 12:27)</a>:</h4>
<p>I will take <code>Closure</code> for example</p>



<a name="168501465"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/%2360406/near/168501465" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Caio <a href="https://zulip-archive.rust-lang.org/stream/131828-t-compiler/topic/.2360406.html#168501465">(Jun 19 2019 at 12:29)</a>:</h4>
<p><code>LintLevelMapBuilder</code> implements <code>visit_expr</code> from <code>Visitor</code> that calls <code>hir_visit::walk_expr</code> with <code>with_lint_attrs</code></p>



<a name="168501586"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/%2360406/near/168501586" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Caio <a href="https://zulip-archive.rust-lang.org/stream/131828-t-compiler/topic/.2360406.html#168501586">(Jun 19 2019 at 12:31)</a>:</h4>
<p>Inside <code>walk_expr</code>, the <code>ExprKind::Closure</code> part calls <code>visit_fn</code> that calls <code>walk_fn</code></p>



<a name="168501692"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/%2360406/near/168501692" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Caio <a href="https://zulip-archive.rust-lang.org/stream/131828-t-compiler/topic/.2360406.html#168501692">(Jun 19 2019 at 12:33)</a>:</h4>
<p><code>walk_fn</code> ultimately calls <code>walk_body</code> which visits all arguments and its attributes</p>



<a name="168501967"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/%2360406/near/168501967" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Caio <a href="https://zulip-archive.rust-lang.org/stream/131828-t-compiler/topic/.2360406.html#168501967">(Jun 19 2019 at 12:36)</a>:</h4>
<p><code>visti_arg</code> method of  <code>LintLevelMapBuilder</code> is also properly "overridden" and should be probably being called for each <code>visit_arg</code> invocation of <code>intravisit::Visitor</code></p>



<a name="168502150"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/%2360406/near/168502150" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Caio <a href="https://zulip-archive.rust-lang.org/stream/131828-t-compiler/topic/.2360406.html#168502150">(Jun 19 2019 at 12:39)</a>:</h4>
<p><span class="user-mention" data-user-id="124288">@oli</span>  Do you mean that I should re-implement this logic inside <code>LintLevelMapBuilder</code>?</p>



<a name="168502319"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/%2360406/near/168502319" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> oli <a href="https://zulip-archive.rust-lang.org/stream/131828-t-compiler/topic/.2360406.html#168502319">(Jun 19 2019 at 12:41)</a>:</h4>
<p><span class="user-mention" data-user-id="211466">@Caio</span> no, that logic is all good, what I believe is missing is a <code>visit_arg</code> override that wraps the <code>walk_arg</code> call in a <code>with_lint_attrs</code> call</p>



<a name="168502384"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/%2360406/near/168502384" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> oli <a href="https://zulip-archive.rust-lang.org/stream/131828-t-compiler/topic/.2360406.html#168502384">(Jun 19 2019 at 12:42)</a>:</h4>
<p>the <code>with_lint_attrs</code> always needs to happen on the specific item like you did in <a href="https://github.com/rust-lang/rust/pull/61856/files#diff-837439bcaa26732bb48bcbb0c60716ccR815" target="_blank" title="https://github.com/rust-lang/rust/pull/61856/files#diff-837439bcaa26732bb48bcbb0c60716ccR815">https://github.com/rust-lang/rust/pull/61856/files#diff-837439bcaa26732bb48bcbb0c60716ccR815</a></p>



<a name="168502396"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/%2360406/near/168502396" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> oli <a href="https://zulip-archive.rust-lang.org/stream/131828-t-compiler/topic/.2360406.html#168502396">(Jun 19 2019 at 12:42)</a>:</h4>
<p>it's not the point that <code>with_lint_attrs</code> is <em>ever</em> called, but that it is called on each node that can have lint attributes</p>



<a name="168502414"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/%2360406/near/168502414" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> oli <a href="https://zulip-archive.rust-lang.org/stream/131828-t-compiler/topic/.2360406.html#168502414">(Jun 19 2019 at 12:42)</a>:</h4>
<p>and since we now can have lint attributes on <code>Arg</code>, we need to implement <code>visit_arg</code> to honor these lint attributes</p>



<a name="168503320"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/%2360406/near/168503320" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Caio <a href="https://zulip-archive.rust-lang.org/stream/131828-t-compiler/topic/.2360406.html#168503320">(Jun 19 2019 at 12:55)</a>:</h4>
<p>Oddly enough, the <code>unsued_variables</code> warnings are still appearing even after  a <code>wint_lint_attrs</code> wrapper for both <code>early</code> and <code>late</code> lint pass</p>



<a name="168503343"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/%2360406/near/168503343" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Caio <a href="https://zulip-archive.rust-lang.org/stream/131828-t-compiler/topic/.2360406.html#168503343">(Jun 19 2019 at 12:55)</a>:</h4>
<p>The current implementation is roughly based on <code>visit_arm</code>, which doesn't use the <code>with_lint_attrs</code>call in some key parts</p>



<a name="168503478"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/%2360406/near/168503478" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> oli <a href="https://zulip-archive.rust-lang.org/stream/131828-t-compiler/topic/.2360406.html#168503478">(Jun 19 2019 at 12:57)</a>:</h4>
<p><code>unused_variables</code> does not use early or late lint passes</p>



<a name="168503507"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/%2360406/near/168503507" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> oli <a href="https://zulip-archive.rust-lang.org/stream/131828-t-compiler/topic/.2360406.html#168503507">(Jun 19 2019 at 12:57)</a>:</h4>
<p>it uses the <code>LintLevelMapBuilder</code></p>



<a name="168503523"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/%2360406/near/168503523" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> oli <a href="https://zulip-archive.rust-lang.org/stream/131828-t-compiler/topic/.2360406.html#168503523">(Jun 19 2019 at 12:57)</a>:</h4>
<p>it's a hardwired lint</p>



<a name="168503547"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/%2360406/near/168503547" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> oli <a href="https://zulip-archive.rust-lang.org/stream/131828-t-compiler/topic/.2360406.html#168503547">(Jun 19 2019 at 12:58)</a>:</h4>
<p>they have their own visiting logic</p>



<a name="168503588"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/%2360406/near/168503588" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> oli <a href="https://zulip-archive.rust-lang.org/stream/131828-t-compiler/topic/.2360406.html#168503588">(Jun 19 2019 at 12:58)</a>:</h4>
<p>and then use the <code>LintLevelMapBuilder</code> transitively via <code>span_lint</code></p>



<a name="168503620"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/%2360406/near/168503620" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Caio <a href="https://zulip-archive.rust-lang.org/stream/131828-t-compiler/topic/.2360406.html#168503620">(Jun 19 2019 at 12:58)</a>:</h4>
<p><span class="user-mention" data-user-id="124288">@oli</span>  I see</p>



<a name="168503875"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/%2360406/near/168503875" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Caio <a href="https://zulip-archive.rust-lang.org/stream/131828-t-compiler/topic/.2360406.html#168503875">(Jun 19 2019 at 13:01)</a>:</h4>
<p>Your feedback is very important. Thank you for helping me</p>



<a name="168503990"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/%2360406/near/168503990" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Caio <a href="https://zulip-archive.rust-lang.org/stream/131828-t-compiler/topic/.2360406.html#168503990">(Jun 19 2019 at 13:02)</a>:</h4>
<p>In the meanwhile, I'll keep trying to fix the lint</p>



<a name="168595488"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/%2360406/near/168595488" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Caio <a href="https://zulip-archive.rust-lang.org/stream/131828-t-compiler/topic/.2360406.html#168595488">(Jun 20 2019 at 13:35)</a>:</h4>
<p>I managed to make it work</p>



<a name="168595503"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/%2360406/near/168595503" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Caio <a href="https://zulip-archive.rust-lang.org/stream/131828-t-compiler/topic/.2360406.html#168595503">(Jun 20 2019 at 13:35)</a>:</h4>
<p>Turns out, the Hir part wasn't implemented</p>



<a name="168595667"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/%2360406/near/168595667" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Caio <a href="https://zulip-archive.rust-lang.org/stream/131828-t-compiler/topic/.2360406.html#168595667">(Jun 20 2019 at 13:36)</a>:</h4>
<p>I will be away for a while but a new commit might appear in the next days</p>



<a name="168595676"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/%2360406/near/168595676" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Caio <a href="https://zulip-archive.rust-lang.org/stream/131828-t-compiler/topic/.2360406.html#168595676">(Jun 20 2019 at 13:37)</a>:</h4>
<p>Thank you guys</p>



<a name="168860054"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/%2360406/near/168860054" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Caio <a href="https://zulip-archive.rust-lang.org/stream/131828-t-compiler/topic/.2360406.html#168860054">(Jun 24 2019 at 15:32)</a>:</h4>
<p>Unfortunately, only <code>unused_variables</code> works</p>



<a name="168860169"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/%2360406/near/168860169" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Caio <a href="https://zulip-archive.rust-lang.org/stream/131828-t-compiler/topic/.2360406.html#168860169">(Jun 24 2019 at 15:34)</a>:</h4>
<p>A proper scope probably needs to be added like in <a href="https://github.com/rust-lang/rust/pull/60174/commits/f506aea1fac0977c7215b4240f4d99b45bf7ae97" target="_blank" title="https://github.com/rust-lang/rust/pull/60174/commits/f506aea1fac0977c7215b4240f4d99b45bf7ae97">https://github.com/rust-lang/rust/pull/60174/commits/f506aea1fac0977c7215b4240f4d99b45bf7ae97</a></p>



<a name="168860276"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/%2360406/near/168860276" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Caio <a href="https://zulip-archive.rust-lang.org/stream/131828-t-compiler/topic/.2360406.html#168860276">(Jun 24 2019 at 15:35)</a>:</h4>
<p>I tried to do so but nothing seemed to work</p>



<a name="168860350"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/%2360406/near/168860350" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Caio <a href="https://zulip-archive.rust-lang.org/stream/131828-t-compiler/topic/.2360406.html#168860350">(Jun 24 2019 at 15:36)</a>:</h4>
<p>What is <code>hair</code>?</p>



<a name="168868888"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/%2360406/near/168868888" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Caio <a href="https://zulip-archive.rust-lang.org/stream/131828-t-compiler/topic/.2360406.html#168868888">(Jun 24 2019 at 17:38)</a>:</h4>
<p><a href="https://github.com/rust-lang/rust/pull/61856/commits/76da8558416416c0f6e216d342fa87d8de6ee6d9" target="_blank" title="https://github.com/rust-lang/rust/pull/61856/commits/76da8558416416c0f6e216d342fa87d8de6ee6d9">https://github.com/rust-lang/rust/pull/61856/commits/76da8558416416c0f6e216d342fa87d8de6ee6d9</a></p>



<a name="168883515"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/%2360406/near/168883515" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> oli <a href="https://zulip-archive.rust-lang.org/stream/131828-t-compiler/topic/.2360406.html#168883515">(Jun 24 2019 at 20:43)</a>:</h4>
<p>HAIR is an intermediate datastructure for converting HIR to MIR</p>



<a name="168883635"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/%2360406/near/168883635" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> oli <a href="https://zulip-archive.rust-lang.org/stream/131828-t-compiler/topic/.2360406.html#168883635">(Jun 24 2019 at 20:44)</a>:</h4>
<p>I'm not sure what you mean by proper scopes</p>



<a name="168891786"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/%2360406/near/168891786" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Caio <a href="https://zulip-archive.rust-lang.org/stream/131828-t-compiler/topic/.2360406.html#168891786">(Jun 24 2019 at 22:49)</a>:</h4>
<blockquote>
<p>HAIR is an intermediate datastructure for converting HIR to MIR</p>
</blockquote>
<p>Thanks!</p>



<a name="168891801"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/%2360406/near/168891801" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Caio <a href="https://zulip-archive.rust-lang.org/stream/131828-t-compiler/topic/.2360406.html#168891801">(Jun 24 2019 at 22:49)</a>:</h4>
<blockquote>
<p>I'm not sure what you mean by proper scopes</p>
</blockquote>
<p>Honestly, me neither :/</p>



<a name="168892024"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/%2360406/near/168892024" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Caio <a href="https://zulip-archive.rust-lang.org/stream/131828-t-compiler/topic/.2360406.html#168892024">(Jun 24 2019 at 22:53)</a>:</h4>
<p>By seeing the related commit, it looks like that something is missing to make <code>unused_mut</code> and other types of lints to actually work. This might be related to some kind of lint scope</p>



<a name="168892554"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/%2360406/near/168892554" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Caio <a href="https://zulip-archive.rust-lang.org/stream/131828-t-compiler/topic/.2360406.html#168892554">(Jun 24 2019 at 23:01)</a>:</h4>
<p>At first, I thought that such scope was the pattern span being inserted and collected <a href="https://github.com/rust-lang/rust/pull/61856/files#diff-5c91206f29170d97620d0f4bce664722" target="_blank" title="https://github.com/rust-lang/rust/pull/61856/files#diff-5c91206f29170d97620d0f4bce664722">here</a></p>



<a name="168918340"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/%2360406/near/168918340" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> oli <a href="https://zulip-archive.rust-lang.org/stream/131828-t-compiler/topic/.2360406.html#168918340">(Jun 25 2019 at 08:19)</a>:</h4>
<p>I would start by looking where <code>unused_mut</code> is emitted. If it's being emitted by giving it a <code>HirId</code> just like <code>unused_variables</code>, then it should have worked automatically. If it is a <code>LateContext</code>, then it's related to the <code>intravisit::Visitor</code> impl used for calling the <code>LateContext::check_*</code> functions. If it's something else entirely (like a custom <code>intravisit::Visitor</code>, then that visitor probably needs an override of <code>visit_arg</code> just like the others.</p>



<a name="168970492"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/%2360406/near/168970492" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Caio <a href="https://zulip-archive.rust-lang.org/stream/131828-t-compiler/topic/.2360406.html#168970492">(Jun 25 2019 at 19:45)</a>:</h4>
<p><span class="user-mention" data-user-id="124288">@oli</span> Thanks</p>



<a name="168970529"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/%2360406/near/168970529" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Caio <a href="https://zulip-archive.rust-lang.org/stream/131828-t-compiler/topic/.2360406.html#168970529">(Jun 25 2019 at 19:46)</a>:</h4>
<p>I think I am getting the idea</p>



<a name="168970650"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/%2360406/near/168970650" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Caio <a href="https://zulip-archive.rust-lang.org/stream/131828-t-compiler/topic/.2360406.html#168970650">(Jun 25 2019 at 19:47)</a>:</h4>
<p>In order to make <code>unused_mut</code> work, the argument <code>local</code> must be inserted into <code>used_mut</code> as stated in <a href="https://github.com/rust-lang/rust/blob/04a3dd8a872633ca1e4c217d11f741cc35cb19a5/src/librustc_mir/borrow_check/mod.rs#L321" target="_blank" title="https://github.com/rust-lang/rust/blob/04a3dd8a872633ca1e4c217d11f741cc35cb19a5/src/librustc_mir/borrow_check/mod.rs#L321">https://github.com/rust-lang/rust/blob/04a3dd8a872633ca1e4c217d11f741cc35cb19a5/src/librustc_mir/borrow_check/mod.rs#L321</a></p>



<a name="168970795"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/%2360406/near/168970795" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Caio <a href="https://zulip-archive.rust-lang.org/stream/131828-t-compiler/topic/.2360406.html#168970795">(Jun 25 2019 at 19:49)</a>:</h4>
<p>To do so, the <code>DataflowResultsConsumer</code> implementation for <code>MirBorrowckCtxt</code> must be modified</p>



<a name="168970936"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/%2360406/near/168970936" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Caio <a href="https://zulip-archive.rust-lang.org/stream/131828-t-compiler/topic/.2360406.html#168970936">(Jun 25 2019 at 19:50)</a>:</h4>
<p>Because  <code>used_mut</code> is initially populated on the <code>analyze_results</code> call -&gt; <a href="https://github.com/rust-lang/rust/blob/04a3dd8a872633ca1e4c217d11f741cc35cb19a5/src/librustc_mir/borrow_check/mod.rs#L276" target="_blank" title="https://github.com/rust-lang/rust/blob/04a3dd8a872633ca1e4c217d11f741cc35cb19a5/src/librustc_mir/borrow_check/mod.rs#L276">https://github.com/rust-lang/rust/blob/04a3dd8a872633ca1e4c217d11f741cc35cb19a5/src/librustc_mir/borrow_check/mod.rs#L276</a></p>



<a name="168971141"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/%2360406/near/168971141" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Caio <a href="https://zulip-archive.rust-lang.org/stream/131828-t-compiler/topic/.2360406.html#168971141">(Jun 25 2019 at 19:53)</a>:</h4>
<p>Probably <a href="https://github.com/rust-lang/rust/blob/04a3dd8a872633ca1e4c217d11f741cc35cb19a5/src/librustc_mir/borrow_check/mod.rs#L1795" target="_blank" title="https://github.com/rust-lang/rust/blob/04a3dd8a872633ca1e4c217d11f741cc35cb19a5/src/librustc_mir/borrow_check/mod.rs#L1795">here</a> or <a href="https://github.com/rust-lang/rust/blob/04a3dd8a872633ca1e4c217d11f741cc35cb19a5/src/librustc_mir/borrow_check/mod.rs#L2060" target="_blank" title="https://github.com/rust-lang/rust/blob/04a3dd8a872633ca1e4c217d11f741cc35cb19a5/src/librustc_mir/borrow_check/mod.rs#L2060">here</a></p>



<a name="168971252"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/%2360406/near/168971252" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Caio <a href="https://zulip-archive.rust-lang.org/stream/131828-t-compiler/topic/.2360406.html#168971252">(Jun 25 2019 at 19:54)</a>:</h4>
<p>How should the <code>DataflowResultsConsumer</code> be modified to collect the arguments locals into <code>used_mut</code>?</p>



<a name="168971734"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/%2360406/near/168971734" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Caio <a href="https://zulip-archive.rust-lang.org/stream/131828-t-compiler/topic/.2360406.html#168971734">(Jun 25 2019 at 19:59)</a>:</h4>
<p>Sorry, I might be asking for too much but any clue will be very welcome as this whole MIR stuff is pretty new to me</p>



<a name="169006757"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/%2360406/near/169006757" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> oli <a href="https://zulip-archive.rust-lang.org/stream/131828-t-compiler/topic/.2360406.html#169006757">(Jun 26 2019 at 07:38)</a>:</h4>
<p>hmm... i would not abort this early, I think instead we should look into why <a href="https://github.com/rust-lang/rust/blob/04a3dd8a872633ca1e4c217d11f741cc35cb19a5/src/librustc_mir/borrow_check/mod.rs#L347" target="_blank" title="https://github.com/rust-lang/rust/blob/04a3dd8a872633ca1e4c217d11f741cc35cb19a5/src/librustc_mir/borrow_check/mod.rs#L347">https://github.com/rust-lang/rust/blob/04a3dd8a872633ca1e4c217d11f741cc35cb19a5/src/librustc_mir/borrow_check/mod.rs#L347</a> does not hold the appropriate information about the arguments</p>



<a name="169006774"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/%2360406/near/169006774" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> oli <a href="https://zulip-archive.rust-lang.org/stream/131828-t-compiler/topic/.2360406.html#169006774">(Jun 26 2019 at 07:38)</a>:</h4>
<p>it calls <code>struct_span_lint_hir</code>, which I believe internally checks whether the hir node has the lint attributes</p>



<a name="169006780"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/%2360406/near/169006780" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> oli <a href="https://zulip-archive.rust-lang.org/stream/131828-t-compiler/topic/.2360406.html#169006780">(Jun 26 2019 at 07:38)</a>:</h4>
<p>you may have to follow a few function calls within <code>struct_span_lint_hir</code> to find that spot</p>



<a name="169019193"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/%2360406/near/169019193" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Caio <a href="https://zulip-archive.rust-lang.org/stream/131828-t-compiler/topic/.2360406.html#169019193">(Jun 26 2019 at 11:16)</a>:</h4>
<p><span class="user-mention" data-user-id="124288">@oli</span> Thank you for the tips. I will continue investing the issue</p>



<a name="169020380"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/%2360406/near/169020380" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> oli <a href="https://zulip-archive.rust-lang.org/stream/131828-t-compiler/topic/.2360406.html#169020380">(Jun 26 2019 at 11:35)</a>:</h4>
<p>cc <span class="user-mention" data-user-id="119031">@Esteban Küber</span> do you have time for the next two weeks to take over assisting here? I won't be available starting saturday</p>



<a name="169052687"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/%2360406/near/169052687" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Esteban Küber <a href="https://zulip-archive.rust-lang.org/stream/131828-t-compiler/topic/.2360406.html#169052687">(Jun 26 2019 at 17:38)</a>:</h4>
<p>I'll be available next week but not the following. Feel free to ping me with questions, I might be able to help given the context I'm seeing.</p>



<a name="171071486"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/%2360406/near/171071486" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Caio <a href="https://zulip-archive.rust-lang.org/stream/131828-t-compiler/topic/.2360406.html#171071486">(Jul 17 2019 at 12:04)</a>:</h4>
<p>Thank you guys for all the help. I wouldn't make it all by myself</p>



<a name="171071491"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/%2360406/near/171071491" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Caio <a href="https://zulip-archive.rust-lang.org/stream/131828-t-compiler/topic/.2360406.html#171071491">(Jul 17 2019 at 12:04)</a>:</h4>
<p>Soon (I guess), the linting PR will the merged and the feature completed</p>



<a name="171071639"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/%2360406/near/171071639" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Caio <a href="https://zulip-archive.rust-lang.org/stream/131828-t-compiler/topic/.2360406.html#171071639">(Jul 17 2019 at 12:06)</a>:</h4>
<p>Can we talk about support for <code>proc_macro_attribute</code>? Does it need another RFC? Is it possible to send a PR implementing it in the next weeks?</p>



<a name="171071695"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/%2360406/near/171071695" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Caio <a href="https://zulip-archive.rust-lang.org/stream/131828-t-compiler/topic/.2360406.html#171071695">(Jul 17 2019 at 12:07)</a>:</h4>
<p><span class="user-mention" data-user-id="123856">@Vadim Petrochenkov</span>Once you told me that you were going to refactor some parsing code. Did you finish it?</p>



<a name="171087914"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/%2360406/near/171087914" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Vadim Petrochenkov <a href="https://zulip-archive.rust-lang.org/stream/131828-t-compiler/topic/.2360406.html#171087914">(Jul 17 2019 at 15:19)</a>:</h4>
<p><span class="user-mention" data-user-id="211466">@Caio</span> <br>
Not parsing, but expansion.<br>
I've been simplifying / cleaning up the expansion infra over the last couple of months with the bottleneck partially being on reviewing.<br>
Here's a list of the relevant PRs:</p>



<a name="171088404"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/%2360406/near/171088404" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Vadim Petrochenkov <a href="https://zulip-archive.rust-lang.org/stream/131828-t-compiler/topic/.2360406.html#171088404">(Jul 17 2019 at 15:23)</a>:</h4>
<p><a href="https://github.com/rust-lang/rust/pull/60750" target="_blank" title="https://github.com/rust-lang/rust/pull/60750">https://github.com/rust-lang/rust/pull/60750</a><br>
<a href="https://github.com/rust-lang/rust/pull/61024" target="_blank" title="https://github.com/rust-lang/rust/pull/61024">https://github.com/rust-lang/rust/pull/61024</a><br>
<a href="https://github.com/rust-lang/rust/pull/61547" target="_blank" title="https://github.com/rust-lang/rust/pull/61547">https://github.com/rust-lang/rust/pull/61547</a><br>
<a href="https://github.com/rust-lang/rust/pull/61606" target="_blank" title="https://github.com/rust-lang/rust/pull/61606">https://github.com/rust-lang/rust/pull/61606</a><br>
<a href="https://github.com/rust-lang/rust/pull/61898" target="_blank" title="https://github.com/rust-lang/rust/pull/61898">https://github.com/rust-lang/rust/pull/61898</a><br>
<a href="https://github.com/rust-lang/rust/pull/62042" target="_blank" title="https://github.com/rust-lang/rust/pull/62042">https://github.com/rust-lang/rust/pull/62042</a><br>
<a href="https://github.com/rust-lang/rust/pull/62243" target="_blank" title="https://github.com/rust-lang/rust/pull/62243">https://github.com/rust-lang/rust/pull/62243</a><br>
<a href="https://github.com/rust-lang/rust/pull/62258" target="_blank" title="https://github.com/rust-lang/rust/pull/62258">https://github.com/rust-lang/rust/pull/62258</a><br>
<a href="https://github.com/rust-lang/rust/pull/62476" target="_blank" title="https://github.com/rust-lang/rust/pull/62476">https://github.com/rust-lang/rust/pull/62476</a><br>
<a href="https://github.com/rust-lang/rust/pull/62684" target="_blank" title="https://github.com/rust-lang/rust/pull/62684">https://github.com/rust-lang/rust/pull/62684</a><br>
<a href="https://github.com/rust-lang/rust/pull/62735" target="_blank" title="https://github.com/rust-lang/rust/pull/62735">https://github.com/rust-lang/rust/pull/62735</a><br>
<a href="https://github.com/rust-lang/rust/pull/62086" target="_blank" title="https://github.com/rust-lang/rust/pull/62086">https://github.com/rust-lang/rust/pull/62086</a><br>
<a href="https://github.com/rust-lang/rust/issues/61733" target="_blank" title="https://github.com/rust-lang/rust/issues/61733">https://github.com/rust-lang/rust/issues/61733</a></p>



<a name="171088688"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/%2360406/near/171088688" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Vadim Petrochenkov <a href="https://zulip-archive.rust-lang.org/stream/131828-t-compiler/topic/.2360406.html#171088688">(Jul 17 2019 at 15:27)</a>:</h4>
<p>The next steps are<br>
- merging <code>Annotatable</code> and perhaps <code>Nonterminal</code> into <code>AstFragment</code><br>
- Introducing more AST fragment kinds for currently non macro expanded positions and rewriting <code>InvocationCollector</code> and macro expander interfaces using those unified AST fragments, simultaneously addressing <a href="https://github.com/rust-lang/rust/issues/61733" target="_blank" title="https://github.com/rust-lang/rust/issues/61733">#61733</a></p>



<a name="171088785"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/%2360406/near/171088785" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Vadim Petrochenkov <a href="https://zulip-archive.rust-lang.org/stream/131828-t-compiler/topic/.2360406.html#171088785">(Jul 17 2019 at 15:28)</a>:</h4>
<p>After those infrastructural changes making the function parameter position macro-expanded will be trivial.</p>



<a name="171088940"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/%2360406/near/171088940" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Vadim Petrochenkov <a href="https://zulip-archive.rust-lang.org/stream/131828-t-compiler/topic/.2360406.html#171088940">(Jul 17 2019 at 15:30)</a>:</h4>
<hr>
<p>At that point the question will be whether it's enough motivation to make that position macro-expanded, from language point of view.<br>
I don't know.</p>



<a name="171089652"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/%2360406/near/171089652" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Vadim Petrochenkov <a href="https://zulip-archive.rust-lang.org/stream/131828-t-compiler/topic/.2360406.html#171089652">(Jul 17 2019 at 15:38)</a>:</h4>
<p>(This may seem disappointing if you are aiming to put your hands on implementing a specific feature, but my goal in this process is rather longer term maintainability with features being implemented kind of naturally/automatically as  side effects.)</p>



<a name="171091515"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/%2360406/near/171091515" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Caio <a href="https://zulip-archive.rust-lang.org/stream/131828-t-compiler/topic/.2360406.html#171091515">(Jul 17 2019 at 16:01)</a>:</h4>
<p>Wow! There is a lot of stuff going on. Thanks for writing it out</p>



<a name="171091561"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/%2360406/near/171091561" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Caio <a href="https://zulip-archive.rust-lang.org/stream/131828-t-compiler/topic/.2360406.html#171091561">(Jul 17 2019 at 16:02)</a>:</h4>
<p>If there is something that I can help out to make user attributes possible in this whole process, please let me know</p>



<a name="171092172"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/%2360406/near/171092172" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Vadim Petrochenkov <a href="https://zulip-archive.rust-lang.org/stream/131828-t-compiler/topic/.2360406.html#171092172">(Jul 17 2019 at 16:09)</a>:</h4>
<p>I'll check my todo list for some more or less isolated tasks in this area.</p>



<a name="171388602"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/%2360406/near/171388602" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Vadim Petrochenkov <a href="https://zulip-archive.rust-lang.org/stream/131828-t-compiler/topic/.2360406.html#171388602">(Jul 21 2019 at 21:31)</a>:</h4>
<p><span class="user-mention" data-user-id="211466">@Caio</span> <br>
Here's how macro attributes are supported for a new attribute position (namely, generic parameter position)<br>
<a href="https://github.com/petrochenkov/rust/tree/resall" target="_blank" title="https://github.com/petrochenkov/rust/tree/resall">https://github.com/petrochenkov/rust/tree/resall</a></p>



<a name="171388668"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/%2360406/near/171388668" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Vadim Petrochenkov <a href="https://zulip-archive.rust-lang.org/stream/131828-t-compiler/topic/.2360406.html#171388668">(Jul 21 2019 at 21:32)</a>:</h4>
<p>Currently unsupported positions are <code>ast::{Variant_, GenericParam, Arm, Arg, FieldPat, Field, StructField}</code>.<br>
All of those are "list" contexts like generic parameters, so implementations should be identical to the linked one, basically.</p>



<a name="171388736"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/%2360406/near/171388736" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Vadim Petrochenkov <a href="https://zulip-archive.rust-lang.org/stream/131828-t-compiler/topic/.2360406.html#171388736">(Jul 21 2019 at 21:34)</a>:</h4>
<hr>
<p>If you have time in the next 1-2 weeks and is able to implement any of those (perhaps all?), I'll wait and switch to some other work.</p>



<a name="171388798"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/%2360406/near/171388798" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Vadim Petrochenkov <a href="https://zulip-archive.rust-lang.org/stream/131828-t-compiler/topic/.2360406.html#171388798">(Jul 21 2019 at 21:37)</a>:</h4>
<p>(<code>param.ident.as_str() == "placeholder"</code> is a temporary solution and should probably be replaced with boolean flags <code>is_placeholder</code> in AST structures, which is as simple, but not as dirty.)</p>



<a name="171388972"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/%2360406/near/171388972" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Vadim Petrochenkov <a href="https://zulip-archive.rust-lang.org/stream/131828-t-compiler/topic/.2360406.html#171388972">(Jul 21 2019 at 21:42)</a>:</h4>
<p><code>Arm</code>, <code>FieldPat</code> and <code>Field</code> also lack <code>NodeId</code>s which are necessary for the attribute resolution to work, so they'll have to be added.</p>



<a name="171392589"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/%2360406/near/171392589" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Caio <a href="https://zulip-archive.rust-lang.org/stream/131828-t-compiler/topic/.2360406.html#171392589">(Jul 21 2019 at 23:34)</a>:</h4>
<p>Thanks <span class="user-mention" data-user-id="123856">@Vadim Petrochenkov</span></p>



<a name="171392600"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/%2360406/near/171392600" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Caio <a href="https://zulip-archive.rust-lang.org/stream/131828-t-compiler/topic/.2360406.html#171392600">(Jul 21 2019 at 23:35)</a>:</h4>
<p>Looks like the intention is to generalize the use of macro attributes, which is awesome</p>



<a name="171392694"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/%2360406/near/171392694" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Caio <a href="https://zulip-archive.rust-lang.org/stream/131828-t-compiler/topic/.2360406.html#171392694">(Jul 21 2019 at 23:38)</a>:</h4>
<p>I will probably be able to complete all necessary work in a week. It doesn't seem too difficult, I am a bit familiar with this area and your commit will help a lot</p>



<a name="171392943"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/%2360406/near/171392943" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Vadim Petrochenkov <a href="https://zulip-archive.rust-lang.org/stream/131828-t-compiler/topic/.2360406.html#171392943">(Jul 21 2019 at 23:47)</a>:</h4>
<blockquote>
<p>Looks like the intention is to generalize the use of macro attributes, which is awesome</p>
</blockquote>
<p>Yes, generalize to macro attributes, but still emit a non-fatal error if it's actually a macro to avoid changing the observable language.<br>
Name resolution support is tightly coupled to the macro support, so if you support the former, the latter needs to be supported as well.</p>



<a name="171898375"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/%2360406/near/171898375" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Caio <a href="https://zulip-archive.rust-lang.org/stream/131828-t-compiler/topic/.2360406.html#171898375">(Jul 28 2019 at 18:07)</a>:</h4>
<p>This explain the reason of all the <code>panic</code>s across the commit like <code>Annotatable::Foo( .. ) =&gt; panic!( .. )</code></p>



<a name="171898491"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/%2360406/near/171898491" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Caio <a href="https://zulip-archive.rust-lang.org/stream/131828-t-compiler/topic/.2360406.html#171898491">(Jul 28 2019 at 18:11)</a>:</h4>
<p>I couldn't finish all tasks because I had to redirect my time to the lint on args PR but everything will probably be ready in the next days</p>



<a name="172469681"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/%2360406/near/172469681" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Caio <a href="https://zulip-archive.rust-lang.org/stream/131828-t-compiler/topic/.2360406.html#172469681">(Aug 05 2019 at 00:12)</a>:</h4>
<p><a href="https://github.com/c410-f3r/rust/tree/attrs" target="_blank" title="https://github.com/c410-f3r/rust/tree/attrs">https://github.com/c410-f3r/rust/tree/attrs</a></p>



<a name="172469683"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/%2360406/near/172469683" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Caio <a href="https://zulip-archive.rust-lang.org/stream/131828-t-compiler/topic/.2360406.html#172469683">(Aug 05 2019 at 00:12)</a>:</h4>
<p>Still not ready not I am getting closer</p>



<a name="172487145"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/%2360406/near/172487145" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Vadim Petrochenkov <a href="https://zulip-archive.rust-lang.org/stream/131828-t-compiler/topic/.2360406.html#172487145">(Aug 05 2019 at 08:23)</a>:</h4>
<p>Nice, thanks for the update.</p>



<a name="172493974"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/%2360406/near/172493974" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Caio <a href="https://zulip-archive.rust-lang.org/stream/131828-t-compiler/topic/.2360406.html#172493974">(Aug 05 2019 at 10:32)</a>:</h4>
<p>One question, the <code>span</code> fn of <code>Annotatable</code> expects a <code>span</code> of its elements. So, we probably need to use <code>Variant</code> instead of <code>Variant_</code> for the whole modification</p>



<a name="172502630"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/%2360406/near/172502630" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Vadim Petrochenkov <a href="https://zulip-archive.rust-lang.org/stream/131828-t-compiler/topic/.2360406.html#172502630">(Aug 05 2019 at 13:06)</a>:</h4>
<p>It would be better to merge <code>Variant</code> and <code>Variant_</code>.</p>



<a name="172502765"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/%2360406/near/172502765" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Vadim Petrochenkov <a href="https://zulip-archive.rust-lang.org/stream/131828-t-compiler/topic/.2360406.html#172502765">(Aug 05 2019 at 13:08)</a>:</h4>
<p>In general, if you see <code>Spanned&lt;T&gt;</code> where <code>T</code> is not an <code>enum</code> that's a good candidate for refactoring.</p>



<a name="172505637"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/%2360406/near/172505637" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Caio <a href="https://zulip-archive.rust-lang.org/stream/131828-t-compiler/topic/.2360406.html#172505637">(Aug 05 2019 at 13:49)</a>:</h4>
<p>Great! It will make things easier</p>



<a name="172637498"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/%2360406/near/172637498" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Caio <a href="https://zulip-archive.rust-lang.org/stream/131828-t-compiler/topic/.2360406.html#172637498">(Aug 06 2019 at 23:23)</a>:</h4>
<p>in <code>expand.rs</code>,  the <code>ast_fragments!</code> macro expects a single elements in a <code>fn visit_*</code> declaration (<code>visitor.$visit_ast_elt(ast_elt);</code>)</p>



<a name="172637599"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/%2360406/near/172637599" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Caio <a href="https://zulip-archive.rust-lang.org/stream/131828-t-compiler/topic/.2360406.html#172637599">(Aug 06 2019 at 23:25)</a>:</h4>
<p>but <code>visit_variant</code> has a <code>&amp;mut self, v: &amp;'ast Variant, g: &amp;'ast Generics, item_id: NodeId</code> signature that conflicts with <code>ast_fragments!</code></p>



<a name="172637738"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/%2360406/near/172637738" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Caio <a href="https://zulip-archive.rust-lang.org/stream/131828-t-compiler/topic/.2360406.html#172637738">(Aug 06 2019 at 23:28)</a>:</h4>
<p>The additional parameters are mainly used by the <code>visit_variant_data</code> function</p>



<a name="172637823"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/%2360406/near/172637823" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Caio <a href="https://zulip-archive.rust-lang.org/stream/131828-t-compiler/topic/.2360406.html#172637823">(Aug 06 2019 at 23:30)</a>:</h4>
<p>I do not know what is the best way to solve this problem. Maybe create another visitor function?</p>



<a name="172640467"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/%2360406/near/172640467" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Vadim Petrochenkov <a href="https://zulip-archive.rust-lang.org/stream/131828-t-compiler/topic/.2360406.html#172640467">(Aug 07 2019 at 00:24)</a>:</h4>
<p>If it doesn't fit into the macro it can be written explicitly, like <code>AstFragment::OptExpr</code>.</p>



<a name="172640637"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/%2360406/near/172640637" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Vadim Petrochenkov <a href="https://zulip-archive.rust-lang.org/stream/131828-t-compiler/topic/.2360406.html#172640637">(Aug 07 2019 at 00:28)</a>:</h4>
<p>There's also a good chance that the extra arguments are never used by AST visitors in practice and can be removed.</p>



<a name="173706931"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/%2360406/near/173706931" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Vadim Petrochenkov <a href="https://zulip-archive.rust-lang.org/stream/131828-t-compiler/topic/.2360406.html#173706931">(Aug 21 2019 at 00:00)</a>:</h4>
<p><span class="user-mention" data-user-id="211466">@Caio</span> <br>
Any news?</p>



<a name="173707038"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/%2360406/near/173707038" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Vadim Petrochenkov <a href="https://zulip-archive.rust-lang.org/stream/131828-t-compiler/topic/.2360406.html#173707038">(Aug 21 2019 at 00:01)</a>:</h4>
<p>FYI, if the status changes you can use @rustbot to change github labels, e.g. to <code>S-waiting-on-review</code>, even without having write rights in the repo.<br>
<a href="https://github.com/rust-lang/triagebot/wiki/Labeling" target="_blank" title="https://github.com/rust-lang/triagebot/wiki/Labeling">https://github.com/rust-lang/triagebot/wiki/Labeling</a></p>



<a name="173780881"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/%2360406/near/173780881" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Caio <a href="https://zulip-archive.rust-lang.org/stream/131828-t-compiler/topic/.2360406.html#173780881">(Aug 21 2019 at 10:19)</a>:</h4>
<p><span class="user-mention" data-user-id="123856">@Vadim Petrochenkov</span>  I am sorry. I had some personal troubles and I will try to finish the PR today</p>



<a name="173800308"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/%2360406/near/173800308" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Vadim Petrochenkov <a href="https://zulip-archive.rust-lang.org/stream/131828-t-compiler/topic/.2360406.html#173800308">(Aug 21 2019 at 14:43)</a>:</h4>
<p>No problem.</p>



<a name="173814492"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/%2360406/near/173814492" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Caio <a href="https://zulip-archive.rust-lang.org/stream/131828-t-compiler/topic/.2360406.html#173814492">(Aug 21 2019 at 17:21)</a>:</h4>
<p>I don't know exactly why some tests are currently panicking. Another day may be needed for investigation</p>



<a name="173814502"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/%2360406/near/173814502" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Caio <a href="https://zulip-archive.rust-lang.org/stream/131828-t-compiler/topic/.2360406.html#173814502">(Aug 21 2019 at 17:21)</a>:</h4>
<p>(deleted)</p>



<a name="173814614"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/%2360406/near/173814614" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Caio <a href="https://zulip-archive.rust-lang.org/stream/131828-t-compiler/topic/.2360406.html#173814614">(Aug 21 2019 at 17:22)</a>:</h4>
<p>This work started as a way to speed up macro stuff but, unfortunately, it is now a bottleneck :/</p>



<a name="173821253"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/%2360406/near/173821253" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Vadim Petrochenkov <a href="https://zulip-archive.rust-lang.org/stream/131828-t-compiler/topic/.2360406.html#173821253">(Aug 21 2019 at 18:43)</a>:</h4>
<p>I actually did a bunch of macro-related stuff in parallel (and I still have some to do), so it's ok.</p>



<a name="175185243"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/%2360406/near/175185243" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Caio <a href="https://zulip-archive.rust-lang.org/stream/131828-t-compiler/topic/.2360406.html#175185243">(Sep 08 2019 at 13:46)</a>:</h4>
<p>Any thoughts about <a href="https://github.com/rust-lang/rust/issues/64282" target="_blank" title="https://github.com/rust-lang/rust/issues/64282">#64282</a>?<br>
I can investigate the problem but I not very familiar with pprint</p>



<a name="175187794"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/%2360406/near/175187794" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> centril <a href="https://zulip-archive.rust-lang.org/stream/131828-t-compiler/topic/.2360406.html#175187794">(Sep 08 2019 at 15:03)</a>:</h4>
<p>I'll try to investigate it</p>



<a name="175191591"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/%2360406/near/175191591" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Caio <a href="https://zulip-archive.rust-lang.org/stream/131828-t-compiler/topic/.2360406.html#175191591">(Sep 08 2019 at 17:00)</a>:</h4>
<p><span class="user-mention" data-user-id="126931">@centril</span> Should this issue and <a href="https://github.com/rust-lang/rust/issues/64031" target="_blank" title="https://github.com/rust-lang/rust/issues/64031">#64031</a> be part of the stabilization report?</p>



<a name="175199391"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/%2360406/near/175199391" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> centril <a href="https://zulip-archive.rust-lang.org/stream/131828-t-compiler/topic/.2360406.html#175199391">(Sep 08 2019 at 21:00)</a>:</h4>
<p><span class="user-mention" data-user-id="211466">@Caio</span> we should probably fix the issue first before that :P</p>



<a name="175200348"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/%2360406/near/175200348" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Caio <a href="https://zulip-archive.rust-lang.org/stream/131828-t-compiler/topic/.2360406.html#175200348">(Sep 08 2019 at 21:25)</a>:</h4>
<p>Sure. Just wanted to confirm the possible need for modification</p>



<hr><p>Last updated: Apr 12 2022 at 20:01 UTC</p>
</html>