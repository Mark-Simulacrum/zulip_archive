<html>
<head><meta charset="utf-8"><title>#48575 potential reversion / guard under `-Z` flag · t-compiler · Zulip Chat Archive</title></head>
<h2>Stream: <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/index.html">t-compiler</a></h2>
<h3>Topic: <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/.2348575.20potential.20reversion.20.2F.20guard.20under.20.60-Z.60.20flag.html">#48575 potential reversion / guard under `-Z` flag</a></h3>

<hr>

<base href="https://rust-lang.zulipchat.com">

<head><link href="https://rust-lang.github.io/zulip_archive/style.css" rel="stylesheet"></head>

<a name="150995125"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/%2348575%20potential%20reversion%20/%20guard%20under%20%60-Z%60%20flag/near/150995125" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> oli <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/.2348575.20potential.20reversion.20.2F.20guard.20under.20.60-Z.60.20flag.html#150995125">(Dec 06 2018 at 10:01)</a>:</h4>
<p>I'm going to partially revert the PR that removed the thread and add that thread removal under a <code>-Z</code> flag</p>



<a name="150995142"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/%2348575%20potential%20reversion%20/%20guard%20under%20%60-Z%60%20flag/near/150995142" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pnkfelix <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/.2348575.20potential.20reversion.20.2F.20guard.20under.20.60-Z.60.20flag.html#150995142">(Dec 06 2018 at 10:01)</a>:</h4>
<p>.... are you doing that with an intent to backport that change...?</p>



<a name="150995244"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/%2348575%20potential%20reversion%20/%20guard%20under%20%60-Z%60%20flag/near/150995244" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> oli <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/.2348575.20potential.20reversion.20.2F.20guard.20under.20.60-Z.60.20flag.html#150995244">(Dec 06 2018 at 10:03)</a>:</h4>
<p>not really, we already have this stack overflow in the edition, so it's a stable -&gt; stable regression</p>



<a name="150995253"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/%2348575%20potential%20reversion%20/%20guard%20under%20%60-Z%60%20flag/near/150995253" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> oli <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/.2348575.20potential.20reversion.20.2F.20guard.20under.20.60-Z.60.20flag.html#150995253">(Dec 06 2018 at 10:03)</a>:</h4>
<p>it's likely nontrivial to backport, too</p>



<a name="150995330"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/%2348575%20potential%20reversion%20/%20guard%20under%20%60-Z%60%20flag/near/150995330" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pnkfelix <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/.2348575.20potential.20reversion.20.2F.20guard.20under.20.60-Z.60.20flag.html#150995330">(Dec 06 2018 at 10:04)</a>:</h4>
<p>just checking</p>



<a name="150995363"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/%2348575%20potential%20reversion%20/%20guard%20under%20%60-Z%60%20flag/near/150995363" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pnkfelix <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/.2348575.20potential.20reversion.20.2F.20guard.20under.20.60-Z.60.20flag.html#150995363">(Dec 06 2018 at 10:05)</a>:</h4>
<p>I don't object to the revert of the thread handling, but the justification is not quite clear if we don't backport, no?</p>



<a name="150995376"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/%2348575%20potential%20reversion%20/%20guard%20under%20%60-Z%60%20flag/near/150995376" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Pietro Albini <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/.2348575.20potential.20reversion.20.2F.20guard.20under.20.60-Z.60.20flag.html#150995376">(Dec 06 2018 at 10:05)</a>:</h4>
<p>backporting to 1.31 is out of the question, but on 1.32 why not if the patch is not too big</p>



<a name="150995377"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/%2348575%20potential%20reversion%20/%20guard%20under%20%60-Z%60%20flag/near/150995377" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pnkfelix <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/.2348575.20potential.20reversion.20.2F.20guard.20under.20.60-Z.60.20flag.html#150995377">(Dec 06 2018 at 10:05)</a>:</h4>
<p>(given that we are planning to separately try to address stack-usage via stacker  as well? right?)</p>



<a name="150995775"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/%2348575%20potential%20reversion%20/%20guard%20under%20%60-Z%60%20flag/near/150995775" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> oli <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/.2348575.20potential.20reversion.20.2F.20guard.20under.20.60-Z.60.20flag.html#150995775">(Dec 06 2018 at 10:13)</a>:</h4>
<p>Do we need threads for anything but the stack size? My current reading of the code seems to suggest that we only need it for stack size. So yea, reverting seems like the wrong action. Instead we should remove all the code for running a main rustc thread</p>



<a name="150998684"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/%2348575%20potential%20reversion%20/%20guard%20under%20%60-Z%60%20flag/near/150998684" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nagisa <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/.2348575.20potential.20reversion.20.2F.20guard.20under.20.60-Z.60.20flag.html#150998684">(Dec 06 2018 at 11:09)</a>:</h4>
<p>FWIW that main-thread related change also broke illumos</p>



<a name="150998689"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/%2348575%20potential%20reversion%20/%20guard%20under%20%60-Z%60%20flag/near/150998689" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nagisa <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/.2348575.20potential.20reversion.20.2F.20guard.20under.20.60-Z.60.20flag.html#150998689">(Dec 06 2018 at 11:09)</a>:</h4>
<p>(I believe it did, anyway)</p>



<a name="150998701"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/%2348575%20potential%20reversion%20/%20guard%20under%20%60-Z%60%20flag/near/150998701" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nagisa <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/.2348575.20potential.20reversion.20.2F.20guard.20under.20.60-Z.60.20flag.html#150998701">(Dec 06 2018 at 11:09)</a>:</h4>
<p>and I’ve been wanting to revert this for a long time already, if only to see if it would fix illumos</p>



<a name="150998777"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/%2348575%20potential%20reversion%20/%20guard%20under%20%60-Z%60%20flag/near/150998777" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nagisa <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/.2348575.20potential.20reversion.20.2F.20guard.20under.20.60-Z.60.20flag.html#150998777">(Dec 06 2018 at 11:10)</a>:</h4>
<p>I see no benefits whatsoever in us trying to use the main thread in anyway at all</p>



<a name="150998974"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/%2348575%20potential%20reversion%20/%20guard%20under%20%60-Z%60%20flag/near/150998974" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pnkfelix <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/.2348575.20potential.20reversion.20.2F.20guard.20under.20.60-Z.60.20flag.html#150998974">(Dec 06 2018 at 11:15)</a>:</h4>
<p>hold on, you two are saying "remove all code for running a main rustc thread" -- you want to do that, even to the degree of not providing a <code>-Z</code> flag to get the behavior desired by ishitatsuyuki on PR <a href="https://github.com/rust-lang/rust/issues/48575" target="_blank" title="https://github.com/rust-lang/rust/issues/48575">#48575</a> ?</p>



<a name="150998981"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/%2348575%20potential%20reversion%20/%20guard%20under%20%60-Z%60%20flag/near/150998981" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pnkfelix <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/.2348575.20potential.20reversion.20.2F.20guard.20under.20.60-Z.60.20flag.html#150998981">(Dec 06 2018 at 11:15)</a>:</h4>
<p>because I thought running on the main thread was the primary goal of that PR.</p>



<a name="150999039"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/%2348575%20potential%20reversion%20/%20guard%20under%20%60-Z%60%20flag/near/150999039" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pnkfelix <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/.2348575.20potential.20reversion.20.2F.20guard.20under.20.60-Z.60.20flag.html#150999039">(Dec 06 2018 at 11:16)</a>:</h4>
<p>(in order to ease the debugger UX for someone who does not want to deal with multithreaded execution)</p>



<a name="150999050"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/%2348575%20potential%20reversion%20/%20guard%20under%20%60-Z%60%20flag/near/150999050" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nagisa <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/.2348575.20potential.20reversion.20.2F.20guard.20under.20.60-Z.60.20flag.html#150999050">(Dec 06 2018 at 11:17)</a>:</h4>
<p>I dont mind the flag Ishi wants.</p>



<a name="150999061"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/%2348575%20potential%20reversion%20/%20guard%20under%20%60-Z%60%20flag/near/150999061" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nagisa <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/.2348575.20potential.20reversion.20.2F.20guard.20under.20.60-Z.60.20flag.html#150999061">(Dec 06 2018 at 11:17)</a>:</h4>
<p>but I don’t think it achieves waht you’re describing either</p>



<a name="150999099"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/%2348575%20potential%20reversion%20/%20guard%20under%20%60-Z%60%20flag/near/150999099" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pnkfelix <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/.2348575.20potential.20reversion.20.2F.20guard.20under.20.60-Z.60.20flag.html#150999099">(Dec 06 2018 at 11:18)</a>:</h4>
<p>okay, so the "remove all code" should be interpreted as "dont make it the default behavior" ?</p>



<a name="150999112"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/%2348575%20potential%20reversion%20/%20guard%20under%20%60-Z%60%20flag/near/150999112" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nagisa <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/.2348575.20potential.20reversion.20.2F.20guard.20under.20.60-Z.60.20flag.html#150999112">(Dec 06 2018 at 11:18)</a>:</h4>
<p>I did say "revert”, though that is pretty much “remove all code”…</p>



<a name="150999113"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/%2348575%20potential%20reversion%20/%20guard%20under%20%60-Z%60%20flag/near/150999113" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pnkfelix <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/.2348575.20potential.20reversion.20.2F.20guard.20under.20.60-Z.60.20flag.html#150999113">(Dec 06 2018 at 11:18)</a>:</h4>
<p>actually, lets move this to a targetted topic</p>



<a name="150999139"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/%2348575%20potential%20reversion%20/%20guard%20under%20%60-Z%60%20flag/near/150999139" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pnkfelix <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/.2348575.20potential.20reversion.20.2F.20guard.20under.20.60-Z.60.20flag.html#150999139">(Dec 06 2018 at 11:20)</a>:</h4>
<p>okay</p>



<a name="150999226"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/%2348575%20potential%20reversion%20/%20guard%20under%20%60-Z%60%20flag/near/150999226" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pnkfelix <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/.2348575.20potential.20reversion.20.2F.20guard.20under.20.60-Z.60.20flag.html#150999226">(Dec 06 2018 at 11:21)</a>:</h4>
<p>yeah so I guess the word "revert" can mean "revert the state of the code itself" (white-box) but it can also just mean "revert the default observable behavior" (black-box)</p>



<a name="150999578"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/%2348575%20potential%20reversion%20/%20guard%20under%20%60-Z%60%20flag/near/150999578" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> oli <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/.2348575.20potential.20reversion.20.2F.20guard.20under.20.60-Z.60.20flag.html#150999578">(Dec 06 2018 at 11:29)</a>:</h4>
<p>Why would illumos fail due to the lack of a thread?</p>



<a name="150999630"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/%2348575%20potential%20reversion%20/%20guard%20under%20%60-Z%60%20flag/near/150999630" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> oli <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/.2348575.20potential.20reversion.20.2F.20guard.20under.20.60-Z.60.20flag.html#150999630">(Dec 06 2018 at 11:30)</a>:</h4>
<p>That's my initial question, do we need threads at all?</p>



<a name="150999662"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/%2348575%20potential%20reversion%20/%20guard%20under%20%60-Z%60%20flag/near/150999662" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> oli <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/.2348575.20potential.20reversion.20.2F.20guard.20under.20.60-Z.60.20flag.html#150999662">(Dec 06 2018 at 11:31)</a>:</h4>
<p>if not, once we have stacker, we can remove the leftover threading code for platforms that still need threads. The tread removal PR only removes threads on a few specific platforms and only if <code>RUST_MIN_STACK</code> is not specified</p>



<a name="150999673"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/%2348575%20potential%20reversion%20/%20guard%20under%20%60-Z%60%20flag/near/150999673" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pnkfelix <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/.2348575.20potential.20reversion.20.2F.20guard.20under.20.60-Z.60.20flag.html#150999673">(Dec 06 2018 at 11:31)</a>:</h4>
<p>ah maybe I misunderstood your point from the start here</p>



<a name="150999718"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/%2348575%20potential%20reversion%20/%20guard%20under%20%60-Z%60%20flag/near/150999718" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pnkfelix <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/.2348575.20potential.20reversion.20.2F.20guard.20under.20.60-Z.60.20flag.html#150999718">(Dec 06 2018 at 11:32)</a>:</h4>
<p>so you are suggesting that we keep the behavior that ishitatsuyuki desires, and just rely on stacker and thus not have to worry about RUST_MIN_STACK ?</p>



<a name="150999729"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/%2348575%20potential%20reversion%20/%20guard%20under%20%60-Z%60%20flag/near/150999729" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pnkfelix <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/.2348575.20potential.20reversion.20.2F.20guard.20under.20.60-Z.60.20flag.html#150999729">(Dec 06 2018 at 11:32)</a>:</h4>
<p>I think this comment from eddyb was one motivation for going back to spawning a separate thread: <a href="https://github.com/rust-lang/rust/pull/48575#issuecomment-380635967" target="_blank" title="https://github.com/rust-lang/rust/pull/48575#issuecomment-380635967">https://github.com/rust-lang/rust/pull/48575#issuecomment-380635967</a></p>



<a name="150999753"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/%2348575%20potential%20reversion%20/%20guard%20under%20%60-Z%60%20flag/near/150999753" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pnkfelix <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/.2348575.20potential.20reversion.20.2F.20guard.20under.20.60-Z.60.20flag.html#150999753">(Dec 06 2018 at 11:33)</a>:</h4>
<p>but I assume you've already read all the comments there, so ... have you posted counter-arguments somewhere?</p>



<a name="150999754"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/%2348575%20potential%20reversion%20/%20guard%20under%20%60-Z%60%20flag/near/150999754" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> oli <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/.2348575.20potential.20reversion.20.2F.20guard.20under.20.60-Z.60.20flag.html#150999754">(Dec 06 2018 at 11:33)</a>:</h4>
<p>Oh oops, I forgot about that</p>



<a name="150999757"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/%2348575%20potential%20reversion%20/%20guard%20under%20%60-Z%60%20flag/near/150999757" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pnkfelix <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/.2348575.20potential.20reversion.20.2F.20guard.20under.20.60-Z.60.20flag.html#150999757">(Dec 06 2018 at 11:33)</a>:</h4>
<p>ah there's my answer</p>



<a name="150999774"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/%2348575%20potential%20reversion%20/%20guard%20under%20%60-Z%60%20flag/near/150999774" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> oli <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/.2348575.20potential.20reversion.20.2F.20guard.20under.20.60-Z.60.20flag.html#150999774">(Dec 06 2018 at 11:33)</a>:</h4>
<p>I did read that, and then forgot about it over the last two days</p>



<a name="150999815"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/%2348575%20potential%20reversion%20/%20guard%20under%20%60-Z%60%20flag/near/150999815" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> oli <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/.2348575.20potential.20reversion.20.2F.20guard.20under.20.60-Z.60.20flag.html#150999815">(Dec 06 2018 at 11:34)</a>:</h4>
<p>So I guess we're back to reverting</p>



<a name="150999820"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/%2348575%20potential%20reversion%20/%20guard%20under%20%60-Z%60%20flag/near/150999820" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pnkfelix <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/.2348575.20potential.20reversion.20.2F.20guard.20under.20.60-Z.60.20flag.html#150999820">(Dec 06 2018 at 11:34)</a>:</h4>
<p>right. but its still not a critical task. just something to try to do when one has time/inclination</p>



<a name="150999823"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/%2348575%20potential%20reversion%20/%20guard%20under%20%60-Z%60%20flag/near/150999823" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> oli <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/.2348575.20potential.20reversion.20.2F.20guard.20under.20.60-Z.60.20flag.html#150999823">(Dec 06 2018 at 11:34)</a>:</h4>
<p>jup</p>



<a name="151101993"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/%2348575%20potential%20reversion%20/%20guard%20under%20%60-Z%60%20flag/near/151101993" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/.2348575.20potential.20reversion.20.2F.20guard.20under.20.60-Z.60.20flag.html#151101993">(Dec 07 2018 at 10:30)</a>:</h4>
<blockquote>
<p>And yeah, I prefer Ctrl+C plus bt to investigate performance issues, so it's a little more convenient if it's kept as a flag</p>
</blockquote>
<p><span class="user-mention" data-user-id="117366">@Tatsuyuki Ishi</span> do you want to prep a PR for that? I lean against but if the PR is small and simple it also doesn't seem to do much <em>harm</em></p>



<a name="151101999"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/%2348575%20potential%20reversion%20/%20guard%20under%20%60-Z%60%20flag/near/151101999" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/.2348575.20potential.20reversion.20.2F.20guard.20under.20.60-Z.60.20flag.html#151101999">(Dec 07 2018 at 10:30)</a>:</h4>
<p>might be easier to have the discussion if we had a PR to examine</p>



<a name="151111734"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/%2348575%20potential%20reversion%20/%20guard%20under%20%60-Z%60%20flag/near/151111734" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tatsuyuki Ishi <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/.2348575.20potential.20reversion.20.2F.20guard.20under.20.60-Z.60.20flag.html#151111734">(Dec 07 2018 at 13:37)</a>:</h4>
<p>I don't have time for the following two weeks but I will have some after. The PR should be small against a non-reverted revision (otherwise it's adding the code back again so not trivial).<br>
What I'm feeling is that stack probe stuffs are too hard to mess with and even the current implementation cannon be called right for every platform. Do you have any other points against keeping this under the flag? It seems the convenience isn't that much when there are more trade offs.</p>



<a name="151111980"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/%2348575%20potential%20reversion%20/%20guard%20under%20%60-Z%60%20flag/near/151111980" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pnkfelix <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/.2348575.20potential.20reversion.20.2F.20guard.20under.20.60-Z.60.20flag.html#151111980">(Dec 07 2018 at 13:41)</a>:</h4>
<p>(for reference, here is <a href="#narrow/stream/131828-t-compiler/subject/.2354818.20weekly.20meeting.202018-12-06/near/151048971" title="#narrow/stream/131828-t-compiler/subject/.2354818.20weekly.20meeting.202018-12-06/near/151048971">context</a> of niko's quote.)</p>



<hr><p>Last updated: Aug 07 2021 at 22:04 UTC</p>
</html>