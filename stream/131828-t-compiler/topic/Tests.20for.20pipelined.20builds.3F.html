<html>
<head><meta charset="utf-8"><title>Tests for pipelined builds? · t-compiler · Zulip Chat Archive</title></head>
<h2>Stream: <a href="https://zulip-archive.rust-lang.org/stream/131828-t-compiler/index.html">t-compiler</a></h2>
<h3>Topic: <a href="https://zulip-archive.rust-lang.org/stream/131828-t-compiler/topic/Tests.20for.20pipelined.20builds.3F.html">Tests for pipelined builds?</a></h3>

<hr>

<base href="https://rust-lang.zulipchat.com">

<head><link href="https://zulip-archive.rust-lang.org/style.css" rel="stylesheet"></head>

<a name="240652948"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/Tests%20for%20pipelined%20builds%3F/near/240652948" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jeremy Fitzhardinge <a href="https://zulip-archive.rust-lang.org/stream/131828-t-compiler/topic/Tests.20for.20pipelined.20builds.3F.html#240652948">(May 28 2021 at 19:53)</a>:</h4>
<p>Are there tests for pipelined builds - ie, building an rmeta with rmeta for dependencies, and separately an rlib? <code>test/ui/rmeta</code> covers this to an extent, but it doesn't seem to check that the rmetas are viable as input for generating rlibs.</p>



<a name="240653101"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/Tests%20for%20pipelined%20builds%3F/near/240653101" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jeremy Fitzhardinge <a href="https://zulip-archive.rust-lang.org/stream/131828-t-compiler/topic/Tests.20for.20pipelined.20builds.3F.html#240653101">(May 28 2021 at 19:55)</a>:</h4>
<p>Context: I'm implementing a <code>-Zmetadata-link</code> which makes <code>--emit metadata</code> generate equivalent rmetas to <code>--emit metadata,link</code> so that I can do pipelined builds with separate invocations of rustc, and I want to add some tests for it.</p>



<a name="240656118"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/Tests%20for%20pipelined%20builds%3F/near/240656118" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jeremy Fitzhardinge <a href="https://zulip-archive.rust-lang.org/stream/131828-t-compiler/topic/Tests.20for.20pipelined.20builds.3F.html#240656118">(May 28 2021 at 20:21)</a>:</h4>
<p>PR <a href="https://github.com/rust-lang/rust/pull/85793">https://github.com/rust-lang/rust/pull/85793</a></p>



<a name="240663019"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/Tests%20for%20pipelined%20builds%3F/near/240663019" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Eric Huss <a href="https://zulip-archive.rust-lang.org/stream/131828-t-compiler/topic/Tests.20for.20pipelined.20builds.3F.html#240663019">(May 28 2021 at 21:34)</a>:</h4>
<p>I'm not aware of pipeline tests in the rust tree.  <code>test/ui/rmeta</code> is the closest I know of, and that is pretty limited.  rmeta support was added for RLS, and it doesn't look like tests were added at the time.</p>
<p>Cargo's testsuite exercises pipelining fairly heavily, though there are some race conditions that are not tested as well as I would like.</p>



<a name="240670677"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/Tests%20for%20pipelined%20builds%3F/near/240670677" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jeremy Fitzhardinge <a href="https://zulip-archive.rust-lang.org/stream/131828-t-compiler/topic/Tests.20for.20pipelined.20builds.3F.html#240670677">(May 28 2021 at 23:18)</a>:</h4>
<p>OK, thanks for the confirmation. I'll look at adding some new tests to my PR.</p>



<hr><p>Last updated: Apr 12 2022 at 20:01 UTC</p>
</html>