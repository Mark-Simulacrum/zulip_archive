<html>
<head><meta charset="utf-8"><title>recent changes to stage0/stage1 builds · t-compiler · Zulip Chat Archive</title></head>
<h2>Stream: <a href="https://zulip-archive.rust-lang.org/stream/131828-t-compiler/index.html">t-compiler</a></h2>
<h3>Topic: <a href="https://zulip-archive.rust-lang.org/stream/131828-t-compiler/topic/recent.20changes.20to.20stage0.2Fstage1.20builds.html">recent changes to stage0/stage1 builds</a></h3>

<hr>

<base href="https://rust-lang.zulipchat.com">

<head><link href="https://zulip-archive.rust-lang.org/style.css" rel="stylesheet"></head>

<a name="210877296"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/recent%20changes%20to%20stage0/stage1%20builds/near/210877296" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> davidtwco <a href="https://zulip-archive.rust-lang.org/stream/131828-t-compiler/topic/recent.20changes.20to.20stage0.2Fstage1.20builds.html#210877296">(Sep 22 2020 at 14:26)</a>:</h4>
<p>I'm confused - after pulling master today, <code>./x.py build compiler/rustc --stage 1</code> will build rustc twice. I expect it to download beta (stage 0) and then compile stage 1, but it claims to "build stage 0 compiler artifacts" and then "build stage 1 compiler artifacts" - why is that first build now necessary?</p>



<a name="210877483"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/recent%20changes%20to%20stage0/stage1%20builds/near/210877483" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> davidtwco <a href="https://zulip-archive.rust-lang.org/stream/131828-t-compiler/topic/recent.20changes.20to.20stage0.2Fstage1.20builds.html#210877483">(Sep 22 2020 at 14:27)</a>:</h4>
<p>Doing <code>./x.py build compiler/rustc --stage 0</code> does a build, but I can't see where it's actually putting the compiler.</p>



<a name="210877564"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/recent%20changes%20to%20stage0/stage1%20builds/near/210877564" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> davidtwco <a href="https://zulip-archive.rust-lang.org/stream/131828-t-compiler/topic/recent.20changes.20to.20stage0.2Fstage1.20builds.html#210877564">(Sep 22 2020 at 14:28)</a>:</h4>
<p>tl;dr what command do I now run to build rustc once? and will I need to adjust my rustup toolchains?</p>



<a name="210877608"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/recent%20changes%20to%20stage0/stage1%20builds/near/210877608" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jonas Schievink  [he/him] <a href="https://zulip-archive.rust-lang.org/stream/131828-t-compiler/topic/recent.20changes.20to.20stage0.2Fstage1.20builds.html#210877608">(Sep 22 2020 at 14:28)</a>:</h4>
<p><code>./x.py build library/std --stage=1</code></p>



<a name="210877741"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/recent%20changes%20to%20stage0/stage1%20builds/near/210877741" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> davidtwco <a href="https://zulip-archive.rust-lang.org/stream/131828-t-compiler/topic/recent.20changes.20to.20stage0.2Fstage1.20builds.html#210877741">(Sep 22 2020 at 14:29)</a>:</h4>
<p>thanks!</p>



<a name="210877851"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/recent%20changes%20to%20stage0/stage1%20builds/near/210877851" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> davidtwco <a href="https://zulip-archive.rust-lang.org/stream/131828-t-compiler/topic/recent.20changes.20to.20stage0.2Fstage1.20builds.html#210877851">(Sep 22 2020 at 14:29)</a>:</h4>
<p>That makes sense - I remember having to run <code>x.py build src/libstd</code> in the past before less-recent-but-still-recent changes.</p>



<a name="210882131"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/recent%20changes%20to%20stage0/stage1%20builds/near/210882131" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Nelson <a href="https://zulip-archive.rust-lang.org/stream/131828-t-compiler/topic/recent.20changes.20to.20stage0.2Fstage1.20builds.html#210882131">(Sep 22 2020 at 14:58)</a>:</h4>
<p><span class="user-mention silent" data-user-id="116107">davidtwco</span> <a href="#narrow/stream/131828-t-compiler/topic/recent.20changes.20to.20stage0.2Fstage1.20builds/near/210877483">said</a>:</p>
<blockquote>
<p>Doing <code>./x.py build compiler/rustc --stage 0</code> does a build, but I can't see where it's actually putting the compiler.</p>
</blockquote>
<p><a href="https://github.com/rust-lang/rust/issues/73519">https://github.com/rust-lang/rust/issues/73519</a></p>



<a name="210882211"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/recent%20changes%20to%20stage0/stage1%20builds/near/210882211" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Nelson <a href="https://zulip-archive.rust-lang.org/stream/131828-t-compiler/topic/recent.20changes.20to.20stage0.2Fstage1.20builds.html#210882211">(Sep 22 2020 at 14:58)</a>:</h4>
<p><span class="user-mention silent" data-user-id="116107">davidtwco</span> <a href="#narrow/stream/131828-t-compiler/topic/recent.20changes.20to.20stage0.2Fstage1.20builds/near/210877296">said</a>:</p>
<blockquote>
<p>I'm confused - after pulling master today, <code>./x.py build compiler/rustc --stage 1</code> will build rustc twice. I expect it to download beta (stage 0) and then compile stage 1, but it claims to "build stage 0 compiler artifacts" and then "build stage 1 compiler artifacts" - why is that first build now necessary?</p>
</blockquote>
<p>hasn't it always behaved that way?</p>



<a name="210882305"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/recent%20changes%20to%20stage0/stage1%20builds/near/210882305" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Nelson <a href="https://zulip-archive.rust-lang.org/stream/131828-t-compiler/topic/recent.20changes.20to.20stage0.2Fstage1.20builds.html#210882305">(Sep 22 2020 at 14:58)</a>:</h4>
<p>see also <a href="https://github.com/rust-lang/rustc-dev-guide/pull/857/">https://github.com/rust-lang/rustc-dev-guide/pull/857/</a>, I'd be interested in opinions from compiler members that aren't actively involved in bootstrapping</p>



<a name="210882751"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/recent%20changes%20to%20stage0/stage1%20builds/near/210882751" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Nelson <a href="https://zulip-archive.rust-lang.org/stream/131828-t-compiler/topic/recent.20changes.20to.20stage0.2Fstage1.20builds.html#210882751">(Sep 22 2020 at 15:01)</a>:</h4>
<p>I guess my blog post was less than helpful ... It said "no longer builds rustc" when it should have said "no longer builds rustc twice"</p>



<a name="210888527"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/recent%20changes%20to%20stage0/stage1%20builds/near/210888527" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> simulacrum <a href="https://zulip-archive.rust-lang.org/stream/131828-t-compiler/topic/recent.20changes.20to.20stage0.2Fstage1.20builds.html#210888527">(Sep 22 2020 at 15:36)</a>:</h4>
<p>yeah I'm pretty sure this has always been the case</p>



<a name="210896947"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/recent%20changes%20to%20stage0/stage1%20builds/near/210896947" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> davidtwco <a href="https://zulip-archive.rust-lang.org/stream/131828-t-compiler/topic/recent.20changes.20to.20stage0.2Fstage1.20builds.html#210896947">(Sep 22 2020 at 16:35)</a>:</h4>
<p>hmm, I definitely remember that being the case but I'm fairly sure that I've been using <code>./x.py build compiler/rustc --stage 1</code> at least since the defaults changed, I think, and it's worked totally fine.</p>



<a name="210902577"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/recent%20changes%20to%20stage0/stage1%20builds/near/210902577" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> simulacrum <a href="https://zulip-archive.rust-lang.org/stream/131828-t-compiler/topic/recent.20changes.20to.20stage0.2Fstage1.20builds.html#210902577">(Sep 22 2020 at 17:17)</a>:</h4>
<p>Odd. Not sure what could've caused that to build less.</p>



<hr><p>Last updated: Apr 12 2022 at 20:01 UTC</p>
</html>