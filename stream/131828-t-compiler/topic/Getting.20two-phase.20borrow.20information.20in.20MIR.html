<html>
<head><meta charset="utf-8"><title>Getting two-phase borrow information in MIR · t-compiler · Zulip Chat Archive</title></head>
<h2>Stream: <a href="https://zulip-archive.rust-lang.org/stream/131828-t-compiler/index.html">t-compiler</a></h2>
<h3>Topic: <a href="https://zulip-archive.rust-lang.org/stream/131828-t-compiler/topic/Getting.20two-phase.20borrow.20information.20in.20MIR.html">Getting two-phase borrow information in MIR</a></h3>

<hr>

<base href="https://rust-lang.zulipchat.com">

<head><link href="https://zulip-archive.rust-lang.org/style.css" rel="stylesheet"></head>

<a name="258034336"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/Getting%20two-phase%20borrow%20information%20in%20MIR/near/258034336" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Xavier Denis <a href="https://zulip-archive.rust-lang.org/stream/131828-t-compiler/topic/Getting.20two-phase.20borrow.20information.20in.20MIR.html#258034336">(Oct 18 2021 at 14:08)</a>:</h4>
<p>Would there be any particular issue with opening apis to get information about two-phase borrows in built MIR?</p>
<p>An actual proposal would require an MCP of course but does that seem like something that might raise issues?<br>
I was specifically thinking of opening access to <code>GatherBorrows</code> because I need to know the activation points of two phase borrows but if that information was somehow recorded another way I would be happy to implement it</p>



<a name="258041301"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/Getting%20two-phase%20borrow%20information%20in%20MIR/near/258041301" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Timothy Maloney <a href="https://zulip-archive.rust-lang.org/stream/131828-t-compiler/topic/Getting.20two-phase.20borrow.20information.20in.20MIR.html#258041301">(Oct 18 2021 at 14:53)</a>:</h4>
<p>You may be able to record the necessary information using the self profilers verbose_generic_activity() method. (I am not sure how feasible this is)</p>



<a name="258045321"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/Getting%20two-phase%20borrow%20information%20in%20MIR/near/258045321" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Xavier Denis <a href="https://zulip-archive.rust-lang.org/stream/131828-t-compiler/topic/Getting.20two-phase.20borrow.20information.20in.20MIR.html#258045321">(Oct 18 2021 at 15:17)</a>:</h4>
<p>that wouldn't give me access to the information though? I need it to do further work on MIR</p>



<a name="258052177"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/Getting%20two-phase%20borrow%20information%20in%20MIR/near/258052177" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Timothy Maloney <a href="https://zulip-archive.rust-lang.org/stream/131828-t-compiler/topic/Getting.20two-phase.20borrow.20information.20in.20MIR.html#258052177">(Oct 18 2021 at 15:58)</a>:</h4>
<p>I must misunderstand your issue <span aria-label="sweat smile" class="emoji emoji-1f605" role="img" title="sweat smile">:sweat_smile:</span></p>



<a name="258053206"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/Getting%20two-phase%20borrow%20information%20in%20MIR/near/258053206" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Xavier Denis <a href="https://zulip-archive.rust-lang.org/stream/131828-t-compiler/topic/Getting.20two-phase.20borrow.20information.20in.20MIR.html#258053206">(Oct 18 2021 at 16:05)</a>:</h4>
<p>I need to obtain the “activation locations” of two phase borrows from an external driver</p>



<a name="258053249"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/Getting%20two-phase%20borrow%20information%20in%20MIR/near/258053249" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Xavier Denis <a href="https://zulip-archive.rust-lang.org/stream/131828-t-compiler/topic/Getting.20two-phase.20borrow.20information.20in.20MIR.html#258053249">(Oct 18 2021 at 16:05)</a>:</h4>
<p>These are currently calculated by rustc but all the apis are marked as private</p>



<a name="258053376"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/Getting%20two-phase%20borrow%20information%20in%20MIR/near/258053376" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Xavier Denis <a href="https://zulip-archive.rust-lang.org/stream/131828-t-compiler/topic/Getting.20two-phase.20borrow.20information.20in.20MIR.html#258053376">(Oct 18 2021 at 16:06)</a>:</h4>
<p>I’m wondering if there are any obvious objections to opening up those apis so external tools can query that information</p>



<hr><p>Last updated: Apr 12 2022 at 20:01 UTC</p>
</html>