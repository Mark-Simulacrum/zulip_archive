<html>
<head><meta charset="utf-8"><title>Quantifying the effect of mutable-noalias · t-compiler · Zulip Chat Archive</title></head>
<h2>Stream: <a href="https://zulip-archive.rust-lang.org/stream/131828-t-compiler/index.html">t-compiler</a></h2>
<h3>Topic: <a href="https://zulip-archive.rust-lang.org/stream/131828-t-compiler/topic/Quantifying.20the.20effect.20of.20mutable-noalias.html">Quantifying the effect of mutable-noalias</a></h3>

<hr>

<base href="https://rust-lang.zulipchat.com">

<head><link href="https://zulip-archive.rust-lang.org/style.css" rel="stylesheet"></head>

<a name="278632087"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/Quantifying%20the%20effect%20of%20mutable-noalias/near/278632087" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Ben Kimock (Saethlin) <a href="https://zulip-archive.rust-lang.org/stream/131828-t-compiler/topic/Quantifying.20the.20effect.20of.20mutable-noalias.html#278632087">(Apr 11 2022 at 23:56)</a>:</h4>
<p>Was there ever an effort made to quantify the impact of <code>mutable-noalias</code> on code outside of the compiler? I know that of course the compiler's huge benchmark suite was run every time it was toggled, but that's not necessarily representative, so I'm wondering if anyone ran a bunch of community crate benchmark suites to back up changing the default for compilation of community crates.</p>



<a name="278633998"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/Quantifying%20the%20effect%20of%20mutable-noalias/near/278633998" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> scottmcm <a href="https://zulip-archive.rust-lang.org/stream/131828-t-compiler/topic/Quantifying.20the.20effect.20of.20mutable-noalias.html#278633998">(Apr 12 2022 at 00:23)</a>:</h4>
<p>We don't currently have a runtime performance benchmark set for anything but the compiler.</p>
<p>(Which is definitely unfortunate, because as a result we have no way to make "that's slower to compile but makes programs faster" tradeoffs, and thus such things get marked as perf regressions.)</p>



<a name="278635469"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/Quantifying%20the%20effect%20of%20mutable-noalias/near/278635469" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Ben Kimock (Saethlin) <a href="https://zulip-archive.rust-lang.org/stream/131828-t-compiler/topic/Quantifying.20the.20effect.20of.20mutable-noalias.html#278635469">(Apr 12 2022 at 00:50)</a>:</h4>
<p>Yeah I tried a handful of crates I know and the effect is so massive and chaotic that I don't really know what to do with it <span aria-label="joy" class="emoji emoji-1f602" role="img" title="joy">:joy:</span> <br>
I have improvements as high as 54% (that I believe are legitimate aliasing optimizations) and regressions as high as 138% (which confuse me).</p>



<a name="278635594"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/Quantifying%20the%20effect%20of%20mutable-noalias/near/278635594" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Ben Kimock (Saethlin) <a href="https://zulip-archive.rust-lang.org/stream/131828-t-compiler/topic/Quantifying.20the.20effect.20of.20mutable-noalias.html#278635594">(Apr 12 2022 at 00:52)</a>:</h4>
<p>Though these are microbenchmarks (as in, small enough that every instruction worth a darn gets inlined into the benchmark loop), not real programs. I'm very interested if anyone has a Real Program which has its performance/throughput well-characterized.</p>



<a name="278637399"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/Quantifying%20the%20effect%20of%20mutable-noalias/near/278637399" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> scottmcm <a href="https://zulip-archive.rust-lang.org/stream/131828-t-compiler/topic/Quantifying.20the.20effect.20of.20mutable-noalias.html#278637399">(Apr 12 2022 at 01:23)</a>:</h4>
<p>You might even check the size of the binaries (since that's really easy compared to comparing perf) since here's a fun demo that mutable-noalias can actually make the code <em>shorter</em>: <a href="https://rust.godbolt.org/z/zaj43brnj">https://rust.godbolt.org/z/zaj43brnj</a>  (inspired by <a href="https://github.com/rust-lang/rust/issues/90821">#90821</a>)</p>



<hr><p>Last updated: Apr 12 2022 at 20:01 UTC</p>
</html>