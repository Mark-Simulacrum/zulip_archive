<html>
<head><meta charset="utf-8"><title>#60431 failed to get layout; field is proj `&lt;A as T&gt;::U` · t-compiler · Zulip Chat Archive</title></head>
<h2>Stream: <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/index.html">t-compiler</a></h2>
<h3>Topic: <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/.2360431.20failed.20to.20get.20layout.3B.20field.20is.20proj.20.60.3CA.20as.20T.3E.3A.3AU.60.html">#60431 failed to get layout; field is proj `&lt;A as T&gt;::U`</a></h3>

<hr>

<base href="https://rust-lang.zulipchat.com">

<head><link href="https://rust-lang.github.io/zulip_archive/style.css" rel="stylesheet"></head>

<a name="170609566"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/%2360431%20failed%20to%20get%20layout%3B%20field%20is%20proj%20%60%3CA%20as%20T%3E%3A%3AU%60/near/170609566" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pnkfelix <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/.2360431.20failed.20to.20get.20layout.3B.20field.20is.20proj.20.60.3CA.20as.20T.3E.3A.3AU.60.html#170609566">(Jul 11 2019 at 07:38)</a>:</h4>
<p>Hey <span class="user-mention" data-user-id="119009">@eddyb</span> , there's this bug where layout code ICE's because, I think, there's an unresolved variable in last field of an ADT (which is unsized),   we are trying to get layout of <code>&amp;ADT</code>.</p>



<a name="170609598"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/%2360431%20failed%20to%20get%20layout%3B%20field%20is%20proj%20%60%3CA%20as%20T%3E%3A%3AU%60/near/170609598" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pnkfelix <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/.2360431.20failed.20to.20get.20layout.3B.20field.20is.20proj.20.60.3CA.20as.20T.3E.3A.3AU.60.html#170609598">(Jul 11 2019 at 07:39)</a>:</h4>
<p>The <code>LayoutCx&lt;'tcx&gt;</code> does not have access to an <code>InferCtxt&lt;'a, 'tcx&gt;</code>, so I cannot call <code>resolve_vars_if_possible</code> to attempt to address this in a lazy fashon</p>



<a name="170609682"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/%2360431%20failed%20to%20get%20layout%3B%20field%20is%20proj%20%60%3CA%20as%20T%3E%3A%3AU%60/near/170609682" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pnkfelix <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/.2360431.20failed.20to.20get.20layout.3B.20field.20is.20proj.20.60.3CA.20as.20T.3E.3A.3AU.60.html#170609682">(Jul 11 2019 at 07:41)</a>:</h4>
<p>My question to you, <span class="user-mention" data-user-id="119009">@eddyb</span> , is whether it is meant to be an invariant that all types that are fed to the layout code should always have all variables resolved (at least when we are doing layout from say <code>rustc_codegen_llvm</code>)? and if that is meant to be an invariant, is it one we might consider asserting up front in the code?</p>



<a name="170609761"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/%2360431%20failed%20to%20get%20layout%3B%20field%20is%20proj%20%60%3CA%20as%20T%3E%3A%3AU%60/near/170609761" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> eddyb <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/.2360431.20failed.20to.20get.20layout.3B.20field.20is.20proj.20.60.3CA.20as.20T.3E.3A.3AU.60.html#170609761">(Jul 11 2019 at 07:42)</a>:</h4>
<p><span class="user-mention" data-user-id="116083">@pnkfelix</span> we don't have a good place to put it, but it's never correct for a query to have inference variables in its input</p>



<a name="170609765"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/%2360431%20failed%20to%20get%20layout%3B%20field%20is%20proj%20%60%3CA%20as%20T%3E%3A%3AU%60/near/170609765" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> eddyb <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/.2360431.20failed.20to.20get.20layout.3B.20field.20is.20proj.20.60.3CA.20as.20T.3E.3A.3AU.60.html#170609765">(Jul 11 2019 at 07:42)</a>:</h4>
<p>this used to be prevented through lifetimes alone, FWIW</p>



<a name="170609790"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/%2360431%20failed%20to%20get%20layout%3B%20field%20is%20proj%20%60%3CA%20as%20T%3E%3A%3AU%60/near/170609790" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> eddyb <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/.2360431.20failed.20to.20get.20layout.3B.20field.20is.20proj.20.60.3CA.20as.20T.3E.3A.3AU.60.html#170609790">(Jul 11 2019 at 07:43)</a>:</h4>
<p>but now that we removed the <code>'gcx</code>/<code>'tcx</code> distinction, the query system has no automated protection against getting random inference variables into queries</p>



<a name="170609907"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/%2360431%20failed%20to%20get%20layout%3B%20field%20is%20proj%20%60%3CA%20as%20T%3E%3A%3AU%60/near/170609907" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> eddyb <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/.2360431.20failed.20to.20get.20layout.3B.20field.20is.20proj.20.60.3CA.20as.20T.3E.3A.3AU.60.html#170609907">(Jul 11 2019 at 07:45)</a>:</h4>
<p><span class="user-mention" data-user-id="116083">@pnkfelix</span> if you're querying for layout from something that uses an inference context, you need to use canonicalization (which idk if anyone other than <span class="user-mention" data-user-id="116009">@nikomatsakis</span> understands... we also need to add that to the <code>const_eval</code> query so we call it from unification during inference)</p>



<a name="170609910"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/%2360431%20failed%20to%20get%20layout%3B%20field%20is%20proj%20%60%3CA%20as%20T%3E%3A%3AU%60/near/170609910" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pnkfelix <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/.2360431.20failed.20to.20get.20layout.3B.20field.20is.20proj.20.60.3CA.20as.20T.3E.3A.3AU.60.html#170609910">(Jul 11 2019 at 07:45)</a>:</h4>
<p>well I personally don't mind trying to enforce such a rule via a dynamic check</p>



<a name="170609927"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/%2360431%20failed%20to%20get%20layout%3B%20field%20is%20proj%20%60%3CA%20as%20T%3E%3A%3AU%60/near/170609927" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pnkfelix <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/.2360431.20failed.20to.20get.20layout.3B.20field.20is.20proj.20.60.3CA.20as.20T.3E.3A.3AU.60.html#170609927">(Jul 11 2019 at 07:45)</a>:</h4>
<p>is "canonicalization" meant to mean something different from "normalization" there?</p>



<a name="170609943"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/%2360431%20failed%20to%20get%20layout%3B%20field%20is%20proj%20%60%3CA%20as%20T%3E%3A%3AU%60/near/170609943" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> eddyb <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/.2360431.20failed.20to.20get.20layout.3B.20field.20is.20proj.20.60.3CA.20as.20T.3E.3A.3AU.60.html#170609943">(Jul 11 2019 at 07:46)</a>:</h4>
<p>the other thing you could do is <code>resolve_vars_if_possible</code> + avoiding calling <code>layout_of</code> unless there are no infer vars in the resolved type</p>



<a name="170609990"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/%2360431%20failed%20to%20get%20layout%3B%20field%20is%20proj%20%60%3CA%20as%20T%3E%3A%3AU%60/near/170609990" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> eddyb <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/.2360431.20failed.20to.20get.20layout.3B.20field.20is.20proj.20.60.3CA.20as.20T.3E.3A.3AU.60.html#170609990">(Jul 11 2019 at 07:46)</a>:</h4>
<p><span class="user-mention" data-user-id="116083">@pnkfelix</span> yes, it's the replacement of inference variables with... effectively parameters</p>



<a name="170609992"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/%2360431%20failed%20to%20get%20layout%3B%20field%20is%20proj%20%60%3CA%20as%20T%3E%3A%3AU%60/near/170609992" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pnkfelix <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/.2360431.20failed.20to.20get.20layout.3B.20field.20is.20proj.20.60.3CA.20as.20T.3E.3A.3AU.60.html#170609992">(Jul 11 2019 at 07:46)</a>:</h4>
<p>??</p>



<a name="170610020"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/%2360431%20failed%20to%20get%20layout%3B%20field%20is%20proj%20%60%3CA%20as%20T%3E%3A%3AU%60/near/170610020" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pnkfelix <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/.2360431.20failed.20to.20get.20layout.3B.20field.20is.20proj.20.60.3CA.20as.20T.3E.3A.3AU.60.html#170610020">(Jul 11 2019 at 07:47)</a>:</h4>
<p>(My "??" was in response to the idea of avoiding calling <code>layout_of</code>  ...)</p>



<a name="170610027"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/%2360431%20failed%20to%20get%20layout%3B%20field%20is%20proj%20%60%3CA%20as%20T%3E%3A%3AU%60/near/170610027" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> eddyb <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/.2360431.20failed.20to.20get.20layout.3B.20field.20is.20proj.20.60.3CA.20as.20T.3E.3A.3AU.60.html#170610027">(Jul 11 2019 at 07:47)</a>:</h4>
<p>well, yeah, you can just assume it returned an error if you have inference variables</p>



<a name="170610035"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/%2360431%20failed%20to%20get%20layout%3B%20field%20is%20proj%20%60%3CA%20as%20T%3E%3A%3AU%60/near/170610035" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pnkfelix <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/.2360431.20failed.20to.20get.20layout.3B.20field.20is.20proj.20.60.3CA.20as.20T.3E.3A.3AU.60.html#170610035">(Jul 11 2019 at 07:47)</a>:</h4>
<p>It sounds to me like I need to trace further back in the control flow to see where someone is missing a call to <code>resolve_vars_if_possible</code></p>



<a name="170610048"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/%2360431%20failed%20to%20get%20layout%3B%20field%20is%20proj%20%60%3CA%20as%20T%3E%3A%3AU%60/near/170610048" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> eddyb <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/.2360431.20failed.20to.20get.20layout.3B.20field.20is.20proj.20.60.3CA.20as.20T.3E.3A.3AU.60.html#170610048">(Jul 11 2019 at 07:47)</a>:</h4>
<p>whatever is calling <code>layout_of</code> probably shouldn't. I can't for the life of me imagine where this might happen</p>



<a name="170610098"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/%2360431%20failed%20to%20get%20layout%3B%20field%20is%20proj%20%60%3CA%20as%20T%3E%3A%3AU%60/near/170610098" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pnkfelix <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/.2360431.20failed.20to.20get.20layout.3B.20field.20is.20proj.20.60.3CA.20as.20T.3E.3A.3AU.60.html#170610098">(Jul 11 2019 at 07:48)</a>:</h4>
<p>The linked issue from this topic shows an example</p>



<a name="170610101"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/%2360431%20failed%20to%20get%20layout%3B%20field%20is%20proj%20%60%3CA%20as%20T%3E%3A%3AU%60/near/170610101" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> eddyb <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/.2360431.20failed.20to.20get.20layout.3B.20field.20is.20proj.20.60.3CA.20as.20T.3E.3A.3AU.60.html#170610101">(Jul 11 2019 at 07:48)</a>:</h4>
<p>you should just make sure you have <code>debuginfo-level = 1</code> in <code>config.toml</code> and just get a backtrace</p>



<a name="170610107"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/%2360431%20failed%20to%20get%20layout%3B%20field%20is%20proj%20%60%3CA%20as%20T%3E%3A%3AU%60/near/170610107" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> eddyb <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/.2360431.20failed.20to.20get.20layout.3B.20field.20is.20proj.20.60.3CA.20as.20T.3E.3A.3AU.60.html#170610107">(Jul 11 2019 at 07:48)</a>:</h4>
<p>I guess I can do it if it's a simple repro</p>



<a name="170610110"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/%2360431%20failed%20to%20get%20layout%3B%20field%20is%20proj%20%60%3CA%20as%20T%3E%3A%3AU%60/near/170610110" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pnkfelix <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/.2360431.20failed.20to.20get.20layout.3B.20field.20is.20proj.20.60.3CA.20as.20T.3E.3A.3AU.60.html#170610110">(Jul 11 2019 at 07:48)</a>:</h4>
<p>I can show you a back trace if you want to see one;</p>



<a name="170610117"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/%2360431%20failed%20to%20get%20layout%3B%20field%20is%20proj%20%60%3CA%20as%20T%3E%3A%3AU%60/near/170610117" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pnkfelix <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/.2360431.20failed.20to.20get.20layout.3B.20field.20is.20proj.20.60.3CA.20as.20T.3E.3A.3AU.60.html#170610117">(Jul 11 2019 at 07:48)</a>:</h4>
<p>I wasn't sure if you were on a mobile device and weren't able to look at a backtrace easily</p>



<a name="170610122"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/%2360431%20failed%20to%20get%20layout%3B%20field%20is%20proj%20%60%3CA%20as%20T%3E%3A%3AU%60/near/170610122" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> eddyb <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/.2360431.20failed.20to.20get.20layout.3B.20field.20is.20proj.20.60.3CA.20as.20T.3E.3A.3AU.60.html#170610122">(Jul 11 2019 at 07:48)</a>:</h4>
<p>canonicalization is what used to be called "freshening" (I just remembered) - the difference is "canonicalization" is much more principled and it allows queries to reify their effects on inference, so that they're cached - basically it lets you go between two inference contexts and preserve everything</p>



<a name="170610134"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/%2360431%20failed%20to%20get%20layout%3B%20field%20is%20proj%20%60%3CA%20as%20T%3E%3A%3AU%60/near/170610134" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pnkfelix <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/.2360431.20failed.20to.20get.20layout.3B.20field.20is.20proj.20.60.3CA.20as.20T.3E.3A.3AU.60.html#170610134">(Jul 11 2019 at 07:48)</a>:</h4>
<p>oh okay</p>



<a name="170610143"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/%2360431%20failed%20to%20get%20layout%3B%20field%20is%20proj%20%60%3CA%20as%20T%3E%3A%3AU%60/near/170610143" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> eddyb <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/.2360431.20failed.20to.20get.20layout.3B.20field.20is.20proj.20.60.3CA.20as.20T.3E.3A.3AU.60.html#170610143">(Jul 11 2019 at 07:49)</a>:</h4>
<p>at the office now. I tend to not touch Zulip on my phone because the app drains the battery like crazy</p>



<a name="170610248"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/%2360431%20failed%20to%20get%20layout%3B%20field%20is%20proj%20%60%3CA%20as%20T%3E%3A%3AU%60/near/170610248" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> eddyb <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/.2360431.20failed.20to.20get.20layout.3B.20field.20is.20proj.20.60.3CA.20as.20T.3E.3A.3AU.60.html#170610248">(Jul 11 2019 at 07:50)</a>:</h4>
<p>there, hopefully that's a half-decent explanation :P</p>



<a name="170610431"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/%2360431%20failed%20to%20get%20layout%3B%20field%20is%20proj%20%60%3CA%20as%20T%3E%3A%3AU%60/near/170610431" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> eddyb <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/.2360431.20failed.20to.20get.20layout.3B.20field.20is.20proj.20.60.3CA.20as.20T.3E.3A.3AU.60.html#170610431">(Jul 11 2019 at 07:53)</a>:</h4>
<p><span class="user-mention" data-user-id="116083">@pnkfelix</span> there's nothing about inference variables in the issue though?</p>



<a name="170610435"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/%2360431%20failed%20to%20get%20layout%3B%20field%20is%20proj%20%60%3CA%20as%20T%3E%3A%3AU%60/near/170610435" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pnkfelix <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/.2360431.20failed.20to.20get.20layout.3B.20field.20is.20proj.20.60.3CA.20as.20T.3E.3A.3AU.60.html#170610435">(Jul 11 2019 at 07:53)</a>:</h4>
<p><a href="https://gist.github.com/pnkfelix/ee7813784d3002db14ba2ad59418b30a" target="_blank" title="https://gist.github.com/pnkfelix/ee7813784d3002db14ba2ad59418b30a">https://gist.github.com/pnkfelix/ee7813784d3002db14ba2ad59418b30a</a></p>



<a name="170610447"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/%2360431%20failed%20to%20get%20layout%3B%20field%20is%20proj%20%60%3CA%20as%20T%3E%3A%3AU%60/near/170610447" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pnkfelix <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/.2360431.20failed.20to.20get.20layout.3B.20field.20is.20proj.20.60.3CA.20as.20T.3E.3A.3AU.60.html#170610447">(Jul 11 2019 at 07:53)</a>:</h4>
<p>the inference variables arise, I believe, due to the projection?</p>



<a name="170610462"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/%2360431%20failed%20to%20get%20layout%3B%20field%20is%20proj%20%60%3CA%20as%20T%3E%3A%3AU%60/near/170610462" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> eddyb <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/.2360431.20failed.20to.20get.20layout.3B.20field.20is.20proj.20.60.3CA.20as.20T.3E.3A.3AU.60.html#170610462">(Jul 11 2019 at 07:53)</a>:</h4>
<p>it's a proper layout error that <code>rustc_codegen_llvm</code> turns into an ICE</p>



<a name="170610516"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/%2360431%20failed%20to%20get%20layout%3B%20field%20is%20proj%20%60%3CA%20as%20T%3E%3A%3AU%60/near/170610516" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pnkfelix <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/.2360431.20failed.20to.20get.20layout.3B.20field.20is.20proj.20.60.3CA.20as.20T.3E.3A.3AU.60.html#170610516">(Jul 11 2019 at 07:54)</a>:</h4>
<p>You're saying layout is <em>supposed</em> to error here?</p>



<a name="170610525"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/%2360431%20failed%20to%20get%20layout%3B%20field%20is%20proj%20%60%3CA%20as%20T%3E%3A%3AU%60/near/170610525" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> eddyb <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/.2360431.20failed.20to.20get.20layout.3B.20field.20is.20proj.20.60.3CA.20as.20T.3E.3A.3AU.60.html#170610525">(Jul 11 2019 at 07:54)</a>:</h4>
<p>'sec</p>



<a name="170610527"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/%2360431%20failed%20to%20get%20layout%3B%20field%20is%20proj%20%60%3CA%20as%20T%3E%3A%3AU%60/near/170610527" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pnkfelix <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/.2360431.20failed.20to.20get.20layout.3B.20field.20is.20proj.20.60.3CA.20as.20T.3E.3A.3AU.60.html#170610527">(Jul 11 2019 at 07:54)</a>:</h4>
<p>I was assuming it was legal to have a DST there</p>



<a name="170610569"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/%2360431%20failed%20to%20get%20layout%3B%20field%20is%20proj%20%60%3CA%20as%20T%3E%3A%3AU%60/near/170610569" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> eddyb <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/.2360431.20failed.20to.20get.20layout.3B.20field.20is.20proj.20.60.3CA.20as.20T.3E.3A.3AU.60.html#170610569">(Jul 11 2019 at 07:55)</a>:</h4>
<p>I thought you were talking about <a href="https://github.com/rust-lang/rust/blob/master/src/librustc/ty/layout.rs#L1198" target="_blank" title="https://github.com/rust-lang/rust/blob/master/src/librustc/ty/layout.rs#L1198">https://github.com/rust-lang/rust/blob/master/src/librustc/ty/layout.rs#L1198</a></p>



<a name="170610592"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/%2360431%20failed%20to%20get%20layout%3B%20field%20is%20proj%20%60%3CA%20as%20T%3E%3A%3AU%60/near/170610592" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> eddyb <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/.2360431.20failed.20to.20get.20layout.3B.20field.20is.20proj.20.60.3CA.20as.20T.3E.3A.3AU.60.html#170610592">(Jul 11 2019 at 07:55)</a>:</h4>
<p>whereas what happens is <a href="https://github.com/rust-lang/rust/blob/master/src/librustc/ty/layout.rs#L1188" target="_blank" title="https://github.com/rust-lang/rust/blob/master/src/librustc/ty/layout.rs#L1188">https://github.com/rust-lang/rust/blob/master/src/librustc/ty/layout.rs#L1188</a></p>



<a name="170610647"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/%2360431%20failed%20to%20get%20layout%3B%20field%20is%20proj%20%60%3CA%20as%20T%3E%3A%3AU%60/near/170610647" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pnkfelix <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/.2360431.20failed.20to.20get.20layout.3B.20field.20is.20proj.20.60.3CA.20as.20T.3E.3A.3AU.60.html#170610647">(Jul 11 2019 at 07:56)</a>:</h4>
<p>yes that looks right</p>



<a name="170610652"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/%2360431%20failed%20to%20get%20layout%3B%20field%20is%20proj%20%60%3CA%20as%20T%3E%3A%3AU%60/near/170610652" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pnkfelix <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/.2360431.20failed.20to.20get.20layout.3B.20field.20is.20proj.20.60.3CA.20as.20T.3E.3A.3AU.60.html#170610652">(Jul 11 2019 at 07:56)</a>:</h4>
<p>in terms of what is currently happening</p>



<a name="170610660"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/%2360431%20failed%20to%20get%20layout%3B%20field%20is%20proj%20%60%3CA%20as%20T%3E%3A%3AU%60/near/170610660" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> eddyb <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/.2360431.20failed.20to.20get.20layout.3B.20field.20is.20proj.20.60.3CA.20as.20T.3E.3A.3AU.60.html#170610660">(Jul 11 2019 at 07:56)</a>:</h4>
<p>normalization fails but I don't think this is a layout-specific bug, layout just happens to be the first thing it hits</p>



<a name="170610673"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/%2360431%20failed%20to%20get%20layout%3B%20field%20is%20proj%20%60%3CA%20as%20T%3E%3A%3AU%60/near/170610673" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pnkfelix <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/.2360431.20failed.20to.20get.20layout.3B.20field.20is.20proj.20.60.3CA.20as.20T.3E.3A.3AU.60.html#170610673">(Jul 11 2019 at 07:56)</a>:</h4>
<p>or wait</p>



<a name="170610676"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/%2360431%20failed%20to%20get%20layout%3B%20field%20is%20proj%20%60%3CA%20as%20T%3E%3A%3AU%60/near/170610676" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pnkfelix <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/.2360431.20failed.20to.20get.20layout.3B.20field.20is.20proj.20.60.3CA.20as.20T.3E.3A.3AU.60.html#170610676">(Jul 11 2019 at 07:56)</a>:</h4>
<p>let me check atgain</p>



<a name="170610693"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/%2360431%20failed%20to%20get%20layout%3B%20field%20is%20proj%20%60%3CA%20as%20T%3E%3A%3AU%60/near/170610693" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pnkfelix <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/.2360431.20failed.20to.20get.20layout.3B.20field.20is.20proj.20.60.3CA.20as.20T.3E.3A.3AU.60.html#170610693">(Jul 11 2019 at 07:57)</a>:</h4>
<p>I see</p>



<a name="170610704"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/%2360431%20failed%20to%20get%20layout%3B%20field%20is%20proj%20%60%3CA%20as%20T%3E%3A%3AU%60/near/170610704" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> eddyb <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/.2360431.20failed.20to.20get.20layout.3B.20field.20is.20proj.20.60.3CA.20as.20T.3E.3A.3AU.60.html#170610704">(Jul 11 2019 at 07:57)</a>:</h4>
<p>why on earth would normalization fail though :|</p>



<a name="170610705"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/%2360431%20failed%20to%20get%20layout%3B%20field%20is%20proj%20%60%3CA%20as%20T%3E%3A%3AU%60/near/170610705" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pnkfelix <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/.2360431.20failed.20to.20get.20layout.3B.20field.20is.20proj.20.60.3CA.20as.20T.3E.3A.3AU.60.html#170610705">(Jul 11 2019 at 07:57)</a>:</h4>
<p>I misinterpreted what was happening, hmm.</p>



<a name="170610711"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/%2360431%20failed%20to%20get%20layout%3B%20field%20is%20proj%20%60%3CA%20as%20T%3E%3A%3AU%60/near/170610711" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> eddyb <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/.2360431.20failed.20to.20get.20layout.3B.20field.20is.20proj.20.60.3CA.20as.20T.3E.3A.3AU.60.html#170610711">(Jul 11 2019 at 07:57)</a>:</h4>
<p>this looks quite trivial</p>



<a name="170610792"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/%2360431%20failed%20to%20get%20layout%3B%20field%20is%20proj%20%60%3CA%20as%20T%3E%3A%3AU%60/near/170610792" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> eddyb <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/.2360431.20failed.20to.20get.20layout.3B.20field.20is.20proj.20.60.3CA.20as.20T.3E.3A.3AU.60.html#170610792">(Jul 11 2019 at 07:58)</a>:</h4>
<p>oh nvm I'm wrong about where it's emitted from</p>



<a name="170610803"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/%2360431%20failed%20to%20get%20layout%3B%20field%20is%20proj%20%60%3CA%20as%20T%3E%3A%3AU%60/near/170610803" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> eddyb <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/.2360431.20failed.20to.20get.20layout.3B.20field.20is.20proj.20.60.3CA.20as.20T.3E.3A.3AU.60.html#170610803">(Jul 11 2019 at 07:59)</a>:</h4>
<p>this is messed up <a href="https://github.com/rust-lang/rust/blob/master/src/librustc/ty/layout.rs#L541-L546" target="_blank" title="https://github.com/rust-lang/rust/blob/master/src/librustc/ty/layout.rs#L541-L546">https://github.com/rust-lang/rust/blob/master/src/librustc/ty/layout.rs#L541-L546</a></p>



<a name="170610817"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/%2360431%20failed%20to%20get%20layout%3B%20field%20is%20proj%20%60%3CA%20as%20T%3E%3A%3AU%60/near/170610817" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> eddyb <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/.2360431.20failed.20to.20get.20layout.3B.20field.20is.20proj.20.60.3CA.20as.20T.3E.3A.3AU.60.html#170610817">(Jul 11 2019 at 07:59)</a>:</h4>
<p>it needs to actually normalize and call <code>struct_tail</code> in a loop</p>



<a name="170610832"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/%2360431%20failed%20to%20get%20layout%3B%20field%20is%20proj%20%60%3CA%20as%20T%3E%3A%3AU%60/near/170610832" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> eddyb <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/.2360431.20failed.20to.20get.20layout.3B.20field.20is.20proj.20.60.3CA.20as.20T.3E.3A.3AU.60.html#170610832">(Jul 11 2019 at 07:59)</a>:</h4>
<p>might be a good idea to change <code>struct_tail</code> to take a <code>param_env</code> and normalize itself or something</p>



<a name="170611008"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/%2360431%20failed%20to%20get%20layout%3B%20field%20is%20proj%20%60%3CA%20as%20T%3E%3A%3AU%60/near/170611008" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> eddyb <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/.2360431.20failed.20to.20get.20layout.3B.20field.20is.20proj.20.60.3CA.20as.20T.3E.3A.3AU.60.html#170611008">(Jul 11 2019 at 08:01)</a>:</h4>
<p><code>struct_lockstep_tails</code> probably has the same problem...</p>



<a name="170611126"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/%2360431%20failed%20to%20get%20layout%3B%20field%20is%20proj%20%60%3CA%20as%20T%3E%3A%3AU%60/near/170611126" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pnkfelix <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/.2360431.20failed.20to.20get.20layout.3B.20field.20is.20proj.20.60.3CA.20as.20T.3E.3A.3AU.60.html#170611126">(Jul 11 2019 at 08:03)</a>:</h4>
<p>Okay I will look into that</p>



<a name="170611155"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/%2360431%20failed%20to%20get%20layout%3B%20field%20is%20proj%20%60%3CA%20as%20T%3E%3A%3AU%60/near/170611155" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> eddyb <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/.2360431.20failed.20to.20get.20layout.3B.20field.20is.20proj.20.60.3CA.20as.20T.3E.3A.3AU.60.html#170611155">(Jul 11 2019 at 08:03)</a>:</h4>
<p><span class="user-mention" data-user-id="116083">@pnkfelix</span> hmm I think I know why this is a rare bug: it won't trigger if a pointee is <code>Sized</code> (<em>after</em> deep normalization), which <code>Ty::is_sized</code> checks</p>



<a name="170611213"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/%2360431%20failed%20to%20get%20layout%3B%20field%20is%20proj%20%60%3CA%20as%20T%3E%3A%3AU%60/near/170611213" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> eddyb <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/.2360431.20failed.20to.20get.20layout.3B.20field.20is.20proj.20.60.3CA.20as.20T.3E.3A.3AU.60.html#170611213">(Jul 11 2019 at 08:04)</a>:</h4>
<p>it's the "tails" functionality that's problematic</p>



<a name="170611243"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/%2360431%20failed%20to%20get%20layout%3B%20field%20is%20proj%20%60%3CA%20as%20T%3E%3A%3AU%60/near/170611243" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> eddyb <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/.2360431.20failed.20to.20get.20layout.3B.20field.20is.20proj.20.60.3CA.20as.20T.3E.3A.3AU.60.html#170611243">(Jul 11 2019 at 08:04)</a>:</h4>
<p>might be a good idea to move it to <code>LayoutCx</code> or something</p>



<a name="170611456"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/%2360431%20failed%20to%20get%20layout%3B%20field%20is%20proj%20%60%3CA%20as%20T%3E%3A%3AU%60/near/170611456" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> eddyb <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/.2360431.20failed.20to.20get.20layout.3B.20field.20is.20proj.20.60.3CA.20as.20T.3E.3A.3AU.60.html#170611456">(Jul 11 2019 at 08:07)</a>:</h4>
<p>typeck only uses it 2 times, and the use in <code>wfcheck</code> should be layout-driven anyway</p>



<a name="170611558"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/%2360431%20failed%20to%20get%20layout%3B%20field%20is%20proj%20%60%3CA%20as%20T%3E%3A%3AU%60/near/170611558" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pnkfelix <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/.2360431.20failed.20to.20get.20layout.3B.20field.20is.20proj.20.60.3CA.20as.20T.3E.3A.3AU.60.html#170611558">(Jul 11 2019 at 08:08)</a>:</h4>
<p>move <code>fn struct_lockstep_tails</code> to <code>LayoutCx</code>, you mean, right?</p>



<a name="170611584"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/%2360431%20failed%20to%20get%20layout%3B%20field%20is%20proj%20%60%3CA%20as%20T%3E%3A%3AU%60/near/170611584" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pnkfelix <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/.2360431.20failed.20to.20get.20layout.3B.20field.20is.20proj.20.60.3CA.20as.20T.3E.3A.3AU.60.html#170611584">(Jul 11 2019 at 08:09)</a>:</h4>
<p>oh I guess <code>fn struct_tail</code> too</p>



<a name="170611701"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/%2360431%20failed%20to%20get%20layout%3B%20field%20is%20proj%20%60%3CA%20as%20T%3E%3A%3AU%60/near/170611701" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> eddyb <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/.2360431.20failed.20to.20get.20layout.3B.20field.20is.20proj.20.60.3CA.20as.20T.3E.3A.3AU.60.html#170611701">(Jul 11 2019 at 08:10)</a>:</h4>
<p>yeah, both of them</p>



<a name="170611823"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/%2360431%20failed%20to%20get%20layout%3B%20field%20is%20proj%20%60%3CA%20as%20T%3E%3A%3AU%60/near/170611823" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> eddyb <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/.2360431.20failed.20to.20get.20layout.3B.20field.20is.20proj.20.60.3CA.20as.20T.3E.3A.3AU.60.html#170611823">(Jul 11 2019 at 08:12)</a>:</h4>
<p>it's one of those things where it needs normalization after substituting generic args into a field type</p>



<a name="170611832"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/%2360431%20failed%20to%20get%20layout%3B%20field%20is%20proj%20%60%3CA%20as%20T%3E%3A%3AU%60/near/170611832" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> eddyb <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/.2360431.20failed.20to.20get.20layout.3B.20field.20is.20proj.20.60.3CA.20as.20T.3E.3A.3AU.60.html#170611832">(Jul 11 2019 at 08:12)</a>:</h4>
<p>and what kind of normalization is to be done depends on the user of the resulting type...</p>



<a name="170611837"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/%2360431%20failed%20to%20get%20layout%3B%20field%20is%20proj%20%60%3CA%20as%20T%3E%3A%3AU%60/near/170611837" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pnkfelix <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/.2360431.20failed.20to.20get.20layout.3B.20field.20is.20proj.20.60.3CA.20as.20T.3E.3A.3AU.60.html#170611837">(Jul 11 2019 at 08:12)</a>:</h4>
<p>and the loop can probably be written to just keep going until <code>struct_tail(pointee) == pointee</code>, right?</p>



<a name="170611851"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/%2360431%20failed%20to%20get%20layout%3B%20field%20is%20proj%20%60%3CA%20as%20T%3E%3A%3AU%60/near/170611851" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pnkfelix <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/.2360431.20failed.20to.20get.20layout.3B.20field.20is.20proj.20.60.3CA.20as.20T.3E.3A.3AU.60.html#170611851">(Jul 11 2019 at 08:13)</a>:</h4>
<p>No need to try to be cleverer than that?</p>



<a name="170611871"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/%2360431%20failed%20to%20get%20layout%3B%20field%20is%20proj%20%60%3CA%20as%20T%3E%3A%3AU%60/near/170611871" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> eddyb <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/.2360431.20failed.20to.20get.20layout.3B.20field.20is.20proj.20.60.3CA.20as.20T.3E.3A.3AU.60.html#170611871">(Jul 11 2019 at 08:13)</a>:</h4>
<p>if you make <code>struct_tail</code> do the normalization itself, you don't need loops in callers</p>



<a name="170611882"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/%2360431%20failed%20to%20get%20layout%3B%20field%20is%20proj%20%60%3CA%20as%20T%3E%3A%3AU%60/near/170611882" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pnkfelix <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/.2360431.20failed.20to.20get.20layout.3B.20field.20is.20proj.20.60.3CA.20as.20T.3E.3A.3AU.60.html#170611882">(Jul 11 2019 at 08:13)</a>:</h4>
<p>right, I'm just checking about what the condition inside <code>struct_tail</code> would be</p>



<a name="170611883"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/%2360431%20failed%20to%20get%20layout%3B%20field%20is%20proj%20%60%3CA%20as%20T%3E%3A%3AU%60/near/170611883" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> eddyb <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/.2360431.20failed.20to.20get.20layout.3B.20field.20is.20proj.20.60.3CA.20as.20T.3E.3A.3AU.60.html#170611883">(Jul 11 2019 at 08:13)</a>:</h4>
<p>not having loops in several places is pretty much the only reason <code>struct_tail</code> exists</p>



<a name="170611936"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/%2360431%20failed%20to%20get%20layout%3B%20field%20is%20proj%20%60%3CA%20as%20T%3E%3A%3AU%60/near/170611936" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pnkfelix <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/.2360431.20failed.20to.20get.20layout.3B.20field.20is.20proj.20.60.3CA.20as.20T.3E.3A.3AU.60.html#170611936">(Jul 11 2019 at 08:14)</a>:</h4>
<p>I guess I shuod look at the actual code for <code>fn struct_tail</code> before trying to guess what the condition would look like</p>



<a name="170612098"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/%2360431%20failed%20to%20get%20layout%3B%20field%20is%20proj%20%60%3CA%20as%20T%3E%3A%3AU%60/near/170612098" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> eddyb <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/.2360431.20failed.20to.20get.20layout.3B.20field.20is.20proj.20.60.3CA.20as.20T.3E.3A.3AU.60.html#170612098">(Jul 11 2019 at 08:17)</a>:</h4>
<p>sorry, github was being slow</p>



<a name="170612104"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/%2360431%20failed%20to%20get%20layout%3B%20field%20is%20proj%20%60%3CA%20as%20T%3E%3A%3AU%60/near/170612104" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> eddyb <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/.2360431.20failed.20to.20get.20layout.3B.20field.20is.20proj.20.60.3CA.20as.20T.3E.3A.3AU.60.html#170612104">(Jul 11 2019 at 08:17)</a>:</h4>
<p>you'd pretty much want this <a href="https://github.com/rust-lang/rust/blob/master/src/librustc/ty/layout.rs#L1185-L1191" target="_blank" title="https://github.com/rust-lang/rust/blob/master/src/librustc/ty/layout.rs#L1185-L1191">https://github.com/rust-lang/rust/blob/master/src/librustc/ty/layout.rs#L1185-L1191</a></p>



<a name="170612245"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/%2360431%20failed%20to%20get%20layout%3B%20field%20is%20proj%20%60%3CA%20as%20T%3E%3A%3AU%60/near/170612245" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> eddyb <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/.2360431.20failed.20to.20get.20layout.3B.20field.20is.20proj.20.60.3CA.20as.20T.3E.3A.3AU.60.html#170612245">(Jul 11 2019 at 08:20)</a>:</h4>
<p>since you're in a loop, returning the error is replaced with returning  the type as-is and the success case is keeping the loop going</p>



<a name="170612272"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/%2360431%20failed%20to%20get%20layout%3B%20field%20is%20proj%20%60%3CA%20as%20T%3E%3A%3AU%60/near/170612272" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pnkfelix <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/.2360431.20failed.20to.20get.20layout.3B.20field.20is.20proj.20.60.3CA.20as.20T.3E.3A.3AU.60.html#170612272">(Jul 11 2019 at 08:20)</a>:</h4>
<p>okay. I'll look into that then</p>



<a name="170612296"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/%2360431%20failed%20to%20get%20layout%3B%20field%20is%20proj%20%60%3CA%20as%20T%3E%3A%3AU%60/near/170612296" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pnkfelix <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/.2360431.20failed.20to.20get.20layout.3B.20field.20is.20proj.20.60.3CA.20as.20T.3E.3A.3AU.60.html#170612296">(Jul 11 2019 at 08:20)</a>:</h4>
<p>Not sure how much time I want to spend trying to figure out the test cases to exercise the various calls to <code>struct_tail</code></p>



<a name="170612300"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/%2360431%20failed%20to%20get%20layout%3B%20field%20is%20proj%20%60%3CA%20as%20T%3E%3A%3AU%60/near/170612300" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pnkfelix <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/.2360431.20failed.20to.20get.20layout.3B.20field.20is.20proj.20.60.3CA.20as.20T.3E.3A.3AU.60.html#170612300">(Jul 11 2019 at 08:20)</a>:</h4>
<p>but maybe it will become obvious</p>



<a name="170612347"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/%2360431%20failed%20to%20get%20layout%3B%20field%20is%20proj%20%60%3CA%20as%20T%3E%3A%3AU%60/near/170612347" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> eddyb <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/.2360431.20failed.20to.20get.20layout.3B.20field.20is.20proj.20.60.3CA.20as.20T.3E.3A.3AU.60.html#170612347">(Jul 11 2019 at 08:21)</a>:</h4>
<p>pretty much layout and unsizing casts</p>



<a name="170612454"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/%2360431%20failed%20to%20get%20layout%3B%20field%20is%20proj%20%60%3CA%20as%20T%3E%3A%3AU%60/near/170612454" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> eddyb <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/.2360431.20failed.20to.20get.20layout.3B.20field.20is.20proj.20.60.3CA.20as.20T.3E.3A.3AU.60.html#170612454">(Jul 11 2019 at 08:23)</a>:</h4>
<p>you might even get away with <code>&lt;Foo as Trait&gt;::Bar</code> in a field type, with no parameters involved, if there's no early normalization happening there (but for good measure you should probably use parameters to block normalization from happening before the last moment)</p>



<a name="170612797"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/%2360431%20failed%20to%20get%20layout%3B%20field%20is%20proj%20%60%3CA%20as%20T%3E%3A%3AU%60/near/170612797" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pnkfelix <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/.2360431.20failed.20to.20get.20layout.3B.20field.20is.20proj.20.60.3CA.20as.20T.3E.3A.3AU.60.html#170612797">(Jul 11 2019 at 08:28)</a>:</h4>
<p>Should the loop now also be incrementing some recursion counter, at least in the projection/opaque case?</p>



<a name="170612815"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/%2360431%20failed%20to%20get%20layout%3B%20field%20is%20proj%20%60%3CA%20as%20T%3E%3A%3AU%60/near/170612815" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pnkfelix <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/.2360431.20failed.20to.20get.20layout.3B.20field.20is.20proj.20.60.3CA.20as.20T.3E.3A.3AU.60.html#170612815">(Jul 11 2019 at 08:28)</a>:</h4>
<p>/me thinks</p>



<a name="170612847"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/%2360431%20failed%20to%20get%20layout%3B%20field%20is%20proj%20%60%3CA%20as%20T%3E%3A%3AU%60/near/170612847" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> eddyb <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/.2360431.20failed.20to.20get.20layout.3B.20field.20is.20proj.20.60.3CA.20as.20T.3E.3A.3AU.60.html#170612847">(Jul 11 2019 at 08:29)</a>:</h4>
<p>it's not recursing though, unless you think someone could make an infinite loop</p>



<a name="170612856"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/%2360431%20failed%20to%20get%20layout%3B%20field%20is%20proj%20%60%3CA%20as%20T%3E%3A%3AU%60/near/170612856" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pnkfelix <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/.2360431.20failed.20to.20get.20layout.3B.20field.20is.20proj.20.60.3CA.20as.20T.3E.3A.3AU.60.html#170612856">(Jul 11 2019 at 08:29)</a>:</h4>
<p>that's what I was worried about, something ike</p>



<a name="170612912"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/%2360431%20failed%20to%20get%20layout%3B%20field%20is%20proj%20%60%3CA%20as%20T%3E%3A%3AU%60/near/170612912" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> eddyb <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/.2360431.20failed.20to.20get.20layout.3B.20field.20is.20proj.20.60.3CA.20as.20T.3E.3A.3AU.60.html#170612912">(Jul 11 2019 at 08:30)</a>:</h4>
<p>I'd suggest trying it and seeing if there are other parts of the compiler catching it</p>



<a name="170612923"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/%2360431%20failed%20to%20get%20layout%3B%20field%20is%20proj%20%60%3CA%20as%20T%3E%3A%3AU%60/near/170612923" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> eddyb <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/.2360431.20failed.20to.20get.20layout.3B.20field.20is.20proj.20.60.3CA.20as.20T.3E.3A.3AU.60.html#170612923">(Jul 11 2019 at 08:30)</a>:</h4>
<p>worst case we can make it a query in which case cycles would be detected automatically</p>



<a name="170612927"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/%2360431%20failed%20to%20get%20layout%3B%20field%20is%20proj%20%60%3CA%20as%20T%3E%3A%3AU%60/near/170612927" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pnkfelix <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/.2360431.20failed.20to.20get.20layout.3B.20field.20is.20proj.20.60.3CA.20as.20T.3E.3A.3AU.60.html#170612927">(Jul 11 2019 at 08:30)</a>:</h4>
<p><code>struct Inf { last: Foo::Assoc, }</code> where <code>impl Trait for Foo { Assoc = Inf; }</code>, or some such garbage</p>



<a name="170612952"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/%2360431%20failed%20to%20get%20layout%3B%20field%20is%20proj%20%60%3CA%20as%20T%3E%3A%3AU%60/near/170612952" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> eddyb <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/.2360431.20failed.20to.20get.20layout.3B.20field.20is.20proj.20.60.3CA.20as.20T.3E.3A.3AU.60.html#170612952">(Jul 11 2019 at 08:31)</a>:</h4>
<p>you'd need a type parameter, pretty sure that's just banned as-is</p>



<a name="170612966"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/%2360431%20failed%20to%20get%20layout%3B%20field%20is%20proj%20%60%3CA%20as%20T%3E%3A%3AU%60/near/170612966" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pnkfelix <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/.2360431.20failed.20to.20get.20layout.3B.20field.20is.20proj.20.60.3CA.20as.20T.3E.3A.3AU.60.html#170612966">(Jul 11 2019 at 08:31)</a>:</h4>
<p>okay, we'll see.</p>



<a name="170613323"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/%2360431%20failed%20to%20get%20layout%3B%20field%20is%20proj%20%60%3CA%20as%20T%3E%3A%3AU%60/near/170613323" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pnkfelix <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/.2360431.20failed.20to.20get.20layout.3B.20field.20is.20proj.20.60.3CA.20as.20T.3E.3A.3AU.60.html#170613323">(Jul 11 2019 at 08:36)</a>:</h4>
<p>I guess the answer is that it (the example I'm worried about) ICE's elsewhere: <a href="https://play.rust-lang.org/?version=stable&amp;mode=debug&amp;edition=2018&amp;gist=f0829f8745f6af3f9283fb13bfc4164d" target="_blank" title="https://play.rust-lang.org/?version=stable&amp;mode=debug&amp;edition=2018&amp;gist=f0829f8745f6af3f9283fb13bfc4164d">https://play.rust-lang.org/?version=stable&amp;mode=debug&amp;edition=2018&amp;gist=f0829f8745f6af3f9283fb13bfc4164d</a></p>



<a name="170613521"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/%2360431%20failed%20to%20get%20layout%3B%20field%20is%20proj%20%60%3CA%20as%20T%3E%3A%3AU%60/near/170613521" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pnkfelix <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/.2360431.20failed.20to.20get.20layout.3B.20field.20is.20proj.20.60.3CA.20as.20T.3E.3A.3AU.60.html#170613521">(Jul 11 2019 at 08:39)</a>:</h4>
<p>Other examples give me more confidence, though; We do detect the cycle nicely here: <a href="https://play.rust-lang.org/?version=nightly&amp;mode=debug&amp;edition=2018&amp;gist=2ccb4c4d56ef21595a5d5c52223ba3ac" target="_blank" title="https://play.rust-lang.org/?version=nightly&amp;mode=debug&amp;edition=2018&amp;gist=2ccb4c4d56ef21595a5d5c52223ba3ac">https://play.rust-lang.org/?version=nightly&amp;mode=debug&amp;edition=2018&amp;gist=2ccb4c4d56ef21595a5d5c52223ba3ac</a></p>



<a name="170613600"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/%2360431%20failed%20to%20get%20layout%3B%20field%20is%20proj%20%60%3CA%20as%20T%3E%3A%3AU%60/near/170613600" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> eddyb <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/.2360431.20failed.20to.20get.20layout.3B.20field.20is.20proj.20.60.3CA.20as.20T.3E.3A.3AU.60.html#170613600">(Jul 11 2019 at 08:40)</a>:</h4>
<p>lol, some <code>const_eval</code> ICEs are way off</p>



<a name="170613608"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/%2360431%20failed%20to%20get%20layout%3B%20field%20is%20proj%20%60%3CA%20as%20T%3E%3A%3AU%60/near/170613608" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> eddyb <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/.2360431.20failed.20to.20get.20layout.3B.20field.20is.20proj.20.60.3CA.20as.20T.3E.3A.3AU.60.html#170613608">(Jul 11 2019 at 08:40)</a>:</h4>
<p>probably because they assume too much</p>



<a name="170613649"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/%2360431%20failed%20to%20get%20layout%3B%20field%20is%20proj%20%60%3CA%20as%20T%3E%3A%3AU%60/near/170613649" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> eddyb <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/.2360431.20failed.20to.20get.20layout.3B.20field.20is.20proj.20.60.3CA.20as.20T.3E.3A.3AU.60.html#170613649">(Jul 11 2019 at 08:41)</a>:</h4>
<p><span class="user-mention" data-user-id="116083">@pnkfelix</span> <code>dbg!</code> doesn't borrow the value like <code>println!</code> does <a href="https://play.rust-lang.org/?version=stable&amp;mode=debug&amp;edition=2018&amp;gist=96f0c2536d87b5e9a5b85c9f5b66a5b5" target="_blank" title="https://play.rust-lang.org/?version=stable&amp;mode=debug&amp;edition=2018&amp;gist=96f0c2536d87b5e9a5b85c9f5b66a5b5">https://play.rust-lang.org/?version=stable&amp;mode=debug&amp;edition=2018&amp;gist=96f0c2536d87b5e9a5b85c9f5b66a5b5</a></p>



<a name="170613662"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/%2360431%20failed%20to%20get%20layout%3B%20field%20is%20proj%20%60%3CA%20as%20T%3E%3A%3AU%60/near/170613662" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pnkfelix <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/.2360431.20failed.20to.20get.20layout.3B.20field.20is.20proj.20.60.3CA.20as.20T.3E.3A.3AU.60.html#170613662">(Jul 11 2019 at 08:41)</a>:</h4>
<p>ah nice</p>



<a name="170613718"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/%2360431%20failed%20to%20get%20layout%3B%20field%20is%20proj%20%60%3CA%20as%20T%3E%3A%3AU%60/near/170613718" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> eddyb <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/.2360431.20failed.20to.20get.20layout.3B.20field.20is.20proj.20.60.3CA.20as.20T.3E.3A.3AU.60.html#170613718">(Jul 11 2019 at 08:42)</a>:</h4>
<p>what these cycle errors from layout tell me is that <code>struct_tail</code> needs to be a query like <code>raw_layout</code> :(</p>



<a name="170613754"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/%2360431%20failed%20to%20get%20layout%3B%20field%20is%20proj%20%60%3CA%20as%20T%3E%3A%3AU%60/near/170613754" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> eddyb <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/.2360431.20failed.20to.20get.20layout.3B.20field.20is.20proj.20.60.3CA.20as.20T.3E.3A.3AU.60.html#170613754">(Jul 11 2019 at 08:43)</a>:</h4>
<p>at least then it's gonna be cached :P</p>



<a name="170616773"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/%2360431%20failed%20to%20get%20layout%3B%20field%20is%20proj%20%60%3CA%20as%20T%3E%3A%3AU%60/near/170616773" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pnkfelix <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/.2360431.20failed.20to.20get.20layout.3B.20field.20is.20proj.20.60.3CA.20as.20T.3E.3A.3AU.60.html#170616773">(Jul 11 2019 at 09:30)</a>:</h4>
<p>Sigh: trying to normalize projections for all current calls to <code>struct_tail</code> and <code>struct_lockstep_tails</code> causes compiler to ICE on three ui tests.</p>



<a name="170617568"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/%2360431%20failed%20to%20get%20layout%3B%20field%20is%20proj%20%60%3CA%20as%20T%3E%3A%3AU%60/near/170617568" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pnkfelix <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/.2360431.20failed.20to.20get.20layout.3B.20field.20is.20proj.20.60.3CA.20as.20T.3E.3A.3AU.60.html#170617568">(Jul 11 2019 at 09:40)</a>:</h4>
<p>ah, I need to be careful about whether I call <code>normalize_erasing_regions</code>, which is only for use after type-check. Hmm.</p>



<a name="170617716"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/%2360431%20failed%20to%20get%20layout%3B%20field%20is%20proj%20%60%3CA%20as%20T%3E%3A%3AU%60/near/170617716" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pnkfelix <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/.2360431.20failed.20to.20get.20layout.3B.20field.20is.20proj.20.60.3CA.20as.20T.3E.3A.3AU.60.html#170617716">(Jul 11 2019 at 09:43)</a>:</h4>
<p>Hmm; The comment above <a href="https://github.com/rust-lang/rust/blob/69070058cd2fdb57ebbbbef94892cfb5688ce27f/src/librustc/traits/query/normalize.rs#L31" target="_blank" title="https://github.com/rust-lang/rust/blob/69070058cd2fdb57ebbbbef94892cfb5688ce27f/src/librustc/traits/query/normalize.rs#L31">fn normalize</a> implies that even though it returns <code>Result</code>, you really aren't supposed to use it if you don't expect <code>Ok</code> ?</p>



<a name="170617747"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/%2360431%20failed%20to%20get%20layout%3B%20field%20is%20proj%20%60%3CA%20as%20T%3E%3A%3AU%60/near/170617747" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> eddyb <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/.2360431.20failed.20to.20get.20layout.3B.20field.20is.20proj.20.60.3CA.20as.20T.3E.3A.3AU.60.html#170617747">(Jul 11 2019 at 09:43)</a>:</h4>
<p>ugh :/</p>



<a name="170617817"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/%2360431%20failed%20to%20get%20layout%3B%20field%20is%20proj%20%60%3CA%20as%20T%3E%3A%3AU%60/near/170617817" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pnkfelix <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/.2360431.20failed.20to.20get.20layout.3B.20field.20is.20proj.20.60.3CA.20as.20T.3E.3A.3AU.60.html#170617817">(Jul 11 2019 at 09:44)</a>:</h4>
<p>I wonder if that comment is out-of-date...</p>



<a name="170617824"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/%2360431%20failed%20to%20get%20layout%3B%20field%20is%20proj%20%60%3CA%20as%20T%3E%3A%3AU%60/near/170617824" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> eddyb <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/.2360431.20failed.20to.20get.20layout.3B.20field.20is.20proj.20.60.3CA.20as.20T.3E.3A.3AU.60.html#170617824">(Jul 11 2019 at 09:44)</a>:</h4>
<p><span class="user-mention" data-user-id="116083">@pnkfelix</span> the <code>wfcheck</code> case should be fine to use the layout region-erasing thing, since it doesn't use the resulting type, just checks if it's <code>extern type</code></p>



<a name="170617853"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/%2360431%20failed%20to%20get%20layout%3B%20field%20is%20proj%20%60%3CA%20as%20T%3E%3A%3AU%60/near/170617853" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> eddyb <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/.2360431.20failed.20to.20get.20layout.3B.20field.20is.20proj.20.60.3CA.20as.20T.3E.3A.3AU.60.html#170617853">(Jul 11 2019 at 09:44)</a>:</h4>
<p>and the <code>librustc_typeck/check/mod.rs</code> use of <code>struct_tail</code> should probably just inline the non-normalizing loop</p>



<a name="170617874"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/%2360431%20failed%20to%20get%20layout%3B%20field%20is%20proj%20%60%3CA%20as%20T%3E%3A%3AU%60/near/170617874" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> eddyb <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/.2360431.20failed.20to.20get.20layout.3B.20field.20is.20proj.20.60.3CA.20as.20T.3E.3A.3AU.60.html#170617874">(Jul 11 2019 at 09:45)</a>:</h4>
<p><em>or</em> use the normalization facilities it has itself</p>



<a name="170617881"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/%2360431%20failed%20to%20get%20layout%3B%20field%20is%20proj%20%60%3CA%20as%20T%3E%3A%3AU%60/near/170617881" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> eddyb <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/.2360431.20failed.20to.20get.20layout.3B.20field.20is.20proj.20.60.3CA.20as.20T.3E.3A.3AU.60.html#170617881">(Jul 11 2019 at 09:45)</a>:</h4>
<p>(but not call the layout <code>struct_tail</code>)</p>



<a name="170617898"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/%2360431%20failed%20to%20get%20layout%3B%20field%20is%20proj%20%60%3CA%20as%20T%3E%3A%3AU%60/near/170617898" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pnkfelix <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/.2360431.20failed.20to.20get.20layout.3B.20field.20is.20proj.20.60.3CA.20as.20T.3E.3A.3AU.60.html#170617898">(Jul 11 2019 at 09:45)</a>:</h4>
<p>I'm currently seeing an ICE from this use of struct_tail in <a href="https://github.com/rust-lang/rust/blob/69070058cd2fdb57ebbbbef94892cfb5688ce27f/src/librustc_typeck/check/mod.rs#L318" target="_blank" title="https://github.com/rust-lang/rust/blob/69070058cd2fdb57ebbbbef94892cfb5688ce27f/src/librustc_typeck/check/mod.rs#L318">fn rvalue_hint</a></p>



<a name="170617913"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/%2360431%20failed%20to%20get%20layout%3B%20field%20is%20proj%20%60%3CA%20as%20T%3E%3A%3AU%60/near/170617913" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pnkfelix <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/.2360431.20failed.20to.20get.20layout.3B.20field.20is.20proj.20.60.3CA.20as.20T.3E.3A.3AU.60.html#170617913">(Jul 11 2019 at 09:45)</a>:</h4>
<p>ah okay you just addressed that</p>



<a name="170618018"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/%2360431%20failed%20to%20get%20layout%3B%20field%20is%20proj%20%60%3CA%20as%20T%3E%3A%3AU%60/near/170618018" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pnkfelix <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/.2360431.20failed.20to.20get.20layout.3B.20field.20is.20proj.20.60.3CA.20as.20T.3E.3A.3AU.60.html#170618018">(Jul 11 2019 at 09:47)</a>:</h4>
<p>I was considering making the <code>struct_tail</code> method take a parameter indicting whether to normalize or not (or even have it be parameterized over <em>how</em> normalization should be done...)</p>



<a name="170618055"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/%2360431%20failed%20to%20get%20layout%3B%20field%20is%20proj%20%60%3CA%20as%20T%3E%3A%3AU%60/near/170618055" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> eddyb <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/.2360431.20failed.20to.20get.20layout.3B.20field.20is.20proj.20.60.3CA.20as.20T.3E.3A.3AU.60.html#170618055">(Jul 11 2019 at 09:47)</a>:</h4>
<p>not sure it's worth it</p>



<a name="170618083"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/%2360431%20failed%20to%20get%20layout%3B%20field%20is%20proj%20%60%3CA%20as%20T%3E%3A%3AU%60/near/170618083" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> eddyb <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/.2360431.20failed.20to.20get.20layout.3B.20field.20is.20proj.20.60.3CA.20as.20T.3E.3A.3AU.60.html#170618083">(Jul 11 2019 at 09:47)</a>:</h4>
<p>unless you take a closure and typeck can do whatever it wants, even resolve inference vars</p>



<a name="170618156"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/%2360431%20failed%20to%20get%20layout%3B%20field%20is%20proj%20%60%3CA%20as%20T%3E%3A%3AU%60/near/170618156" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> eddyb <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/.2360431.20failed.20to.20get.20layout.3B.20field.20is.20proj.20.60.3CA.20as.20T.3E.3A.3AU.60.html#170618156">(Jul 11 2019 at 09:48)</a>:</h4>
<p>(but it'd be tedium for all the other call sites)</p>



<a name="170618173"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/%2360431%20failed%20to%20get%20layout%3B%20field%20is%20proj%20%60%3CA%20as%20T%3E%3A%3AU%60/near/170618173" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pnkfelix <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/.2360431.20failed.20to.20get.20layout.3B.20field.20is.20proj.20.60.3CA.20as.20T.3E.3A.3AU.60.html#170618173">(Jul 11 2019 at 09:49)</a>:</h4>
<p>well there could be two methods</p>



<a name="170618181"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/%2360431%20failed%20to%20get%20layout%3B%20field%20is%20proj%20%60%3CA%20as%20T%3E%3A%3AU%60/near/170618181" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pnkfelix <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/.2360431.20failed.20to.20get.20layout.3B.20field.20is.20proj.20.60.3CA.20as.20T.3E.3A.3AU.60.html#170618181">(Jul 11 2019 at 09:49)</a>:</h4>
<p>that call a common helper</p>



<a name="170618195"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/%2360431%20failed%20to%20get%20layout%3B%20field%20is%20proj%20%60%3CA%20as%20T%3E%3A%3AU%60/near/170618195" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> eddyb <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/.2360431.20failed.20to.20get.20layout.3B.20field.20is.20proj.20.60.3CA.20as.20T.3E.3A.3AU.60.html#170618195">(Jul 11 2019 at 09:49)</a>:</h4>
<p><span class="user-mention" data-user-id="116083">@pnkfelix</span> hmm what about <code>struct_tails_with_normalize</code> for the  generic version and <code>struct_tails_erasing_lifetimes</code> for the one that almost everything should use?</p>



<a name="170618202"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/%2360431%20failed%20to%20get%20layout%3B%20field%20is%20proj%20%60%3CA%20as%20T%3E%3A%3AU%60/near/170618202" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pnkfelix <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/.2360431.20failed.20to.20get.20layout.3B.20field.20is.20proj.20.60.3CA.20as.20T.3E.3A.3AU.60.html#170618202">(Jul 11 2019 at 09:49)</a>:</h4>
<p>yeah maybe</p>



<a name="170618275"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/%2360431%20failed%20to%20get%20layout%3B%20field%20is%20proj%20%60%3CA%20as%20T%3E%3A%3AU%60/near/170618275" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> eddyb <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/.2360431.20failed.20to.20get.20layout.3B.20field.20is.20proj.20.60.3CA.20as.20T.3E.3A.3AU.60.html#170618275">(Jul 11 2019 at 09:50)</a>:</h4>
<p>(<code>impl Fn(Ty&lt;'tcx&gt;) -&gt; Ty&lt;'tcx&gt;</code> should be enough I'm guessing)</p>



<a name="170708118"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/%2360431%20failed%20to%20get%20layout%3B%20field%20is%20proj%20%60%3CA%20as%20T%3E%3A%3AU%60/near/170708118" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> eddyb <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/.2360431.20failed.20to.20get.20layout.3B.20field.20is.20proj.20.60.3CA.20as.20T.3E.3A.3AU.60.html#170708118">(Jul 12 2019 at 09:35)</a>:</h4>
<p><span class="user-mention" data-user-id="116083">@pnkfelix</span> not trying to waste of your time, I think we can get away without rephrasing <a href="https://github.com/rust-lang/rust/pull/62585#discussion_r302905131" target="_blank" title="https://github.com/rust-lang/rust/pull/62585#discussion_r302905131">https://github.com/rust-lang/rust/pull/62585#discussion_r302905131</a></p>



<a name="170708123"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/%2360431%20failed%20to%20get%20layout%3B%20field%20is%20proj%20%60%3CA%20as%20T%3E%3A%3AU%60/near/170708123" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> eddyb <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/.2360431.20failed.20to.20get.20layout.3B.20field.20is.20proj.20.60.3CA.20as.20T.3E.3A.3AU.60.html#170708123">(Jul 12 2019 at 09:35)</a>:</h4>
<p>just changing "checking" to "inference"</p>



<a name="170708133"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/%2360431%20failed%20to%20get%20layout%3B%20field%20is%20proj%20%60%3CA%20as%20T%3E%3A%3AU%60/near/170708133" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pnkfelix <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/.2360431.20failed.20to.20get.20layout.3B.20field.20is.20proj.20.60.3CA.20as.20T.3E.3A.3AU.60.html#170708133">(Jul 12 2019 at 09:35)</a>:</h4>
<p>heh I just finished making a change there</p>



<a name="170708177"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/%2360431%20failed%20to%20get%20layout%3B%20field%20is%20proj%20%60%3CA%20as%20T%3E%3A%3AU%60/near/170708177" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> eddyb <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/.2360431.20failed.20to.20get.20layout.3B.20field.20is.20proj.20.60.3CA.20as.20T.3E.3A.3AU.60.html#170708177">(Jul 12 2019 at 09:36)</a>:</h4>
<p>push and I'll look</p>



<a name="170708178"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/%2360431%20failed%20to%20get%20layout%3B%20field%20is%20proj%20%60%3CA%20as%20T%3E%3A%3AU%60/near/170708178" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pnkfelix <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/.2360431.20failed.20to.20get.20layout.3B.20field.20is.20proj.20.60.3CA.20as.20T.3E.3A.3AU.60.html#170708178">(Jul 12 2019 at 09:36)</a>:</h4>
<p>I actually went with "for example, during codegen"</p>



<a name="170708180"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/%2360431%20failed%20to%20get%20layout%3B%20field%20is%20proj%20%60%3CA%20as%20T%3E%3A%3AU%60/near/170708180" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pnkfelix <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/.2360431.20failed.20to.20get.20layout.3B.20field.20is.20proj.20.60.3CA.20as.20T.3E.3A.3AU.60.html#170708180">(Jul 12 2019 at 09:36)</a>:</h4>
<p>i'll show you</p>



<a name="170708203"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/%2360431%20failed%20to%20get%20layout%3B%20field%20is%20proj%20%60%3CA%20as%20T%3E%3A%3AU%60/near/170708203" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> eddyb <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/.2360431.20failed.20to.20get.20layout.3B.20field.20is.20proj.20.60.3CA.20as.20T.3E.3A.3AU.60.html#170708203">(Jul 12 2019 at 09:36)</a>:</h4>
<p>(I don't like to name codegen in particular because it's <em>just part of the majority</em>)</p>



<a name="170708220"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/%2360431%20failed%20to%20get%20layout%3B%20field%20is%20proj%20%60%3CA%20as%20T%3E%3A%3AU%60/near/170708220" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pnkfelix <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/.2360431.20failed.20to.20get.20layout.3B.20field.20is.20proj.20.60.3CA.20as.20T.3E.3A.3AU.60.html#170708220">(Jul 12 2019 at 09:37)</a>:</h4>
<p>it seemed like the vast majority of usage. :)</p>



<a name="170708237"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/%2360431%20failed%20to%20get%20layout%3B%20field%20is%20proj%20%60%3CA%20as%20T%3E%3A%3AU%60/near/170708237" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> eddyb <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/.2360431.20failed.20to.20get.20layout.3B.20field.20is.20proj.20.60.3CA.20as.20T.3E.3A.3AU.60.html#170708237">(Jul 12 2019 at 09:37)</a>:</h4>
<p>miri and lints also use layout</p>



<a name="170708292"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/%2360431%20failed%20to%20get%20layout%3B%20field%20is%20proj%20%60%3CA%20as%20T%3E%3A%3AU%60/near/170708292" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> eddyb <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/.2360431.20failed.20to.20get.20layout.3B.20field.20is.20proj.20.60.3CA.20as.20T.3E.3A.3AU.60.html#170708292">(Jul 12 2019 at 09:38)</a>:</h4>
<p><span class="user-mention" data-user-id="116083">@pnkfelix</span> ah whatever it's fine</p>



<a name="170708302"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/%2360431%20failed%20to%20get%20layout%3B%20field%20is%20proj%20%60%3CA%20as%20T%3E%3A%3AU%60/near/170708302" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pnkfelix <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/.2360431.20failed.20to.20get.20layout.3B.20field.20is.20proj.20.60.3CA.20as.20T.3E.3A.3AU.60.html#170708302">(Jul 12 2019 at 09:38)</a>:</h4>
<p>miri == interpreter  ... arguably just another kind of codegen. :)</p>



<a name="170708305"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/%2360431%20failed%20to%20get%20layout%3B%20field%20is%20proj%20%60%3CA%20as%20T%3E%3A%3AU%60/near/170708305" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> eddyb <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/.2360431.20failed.20to.20get.20layout.3B.20field.20is.20proj.20.60.3CA.20as.20T.3E.3A.3AU.60.html#170708305">(Jul 12 2019 at 09:38)</a>:</h4>
<p>this sort of thing is searcheable for anyway</p>



<a name="170708307"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/%2360431%20failed%20to%20get%20layout%3B%20field%20is%20proj%20%60%3CA%20as%20T%3E%3A%3AU%60/near/170708307" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pnkfelix <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/.2360431.20failed.20to.20get.20layout.3B.20field.20is.20proj.20.60.3CA.20as.20T.3E.3A.3AU.60.html#170708307">(Jul 12 2019 at 09:38)</a>:</h4>
<p>anyway I was trying to take care not to saay that it was <em>only</em> usable in codegen</p>



<a name="170708324"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/%2360431%20failed%20to%20get%20layout%3B%20field%20is%20proj%20%60%3CA%20as%20T%3E%3A%3AU%60/near/170708324" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> eddyb <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/.2360431.20failed.20to.20get.20layout.3B.20field.20is.20proj.20.60.3CA.20as.20T.3E.3A.3AU.60.html#170708324">(Jul 12 2019 at 09:38)</a>:</h4>
<p>yeah it makes sense</p>



<a name="170708341"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/%2360431%20failed%20to%20get%20layout%3B%20field%20is%20proj%20%60%3CA%20as%20T%3E%3A%3AU%60/near/170708341" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> eddyb <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/.2360431.20failed.20to.20get.20layout.3B.20field.20is.20proj.20.60.3CA.20as.20T.3E.3A.3AU.60.html#170708341">(Jul 12 2019 at 09:39)</a>:</h4>
<p>(particularly that codegen doesn't care about lifetimes, that's specific enough that I don't mind)</p>



<a name="170708350"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/%2360431%20failed%20to%20get%20layout%3B%20field%20is%20proj%20%60%3CA%20as%20T%3E%3A%3AU%60/near/170708350" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> eddyb <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/.2360431.20failed.20to.20get.20layout.3B.20field.20is.20proj.20.60.3CA.20as.20T.3E.3A.3AU.60.html#170708350">(Jul 12 2019 at 09:39)</a>:</h4>
<p>remove the <code>}</code> indent fix and r=me</p>



<a name="170708375"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/%2360431%20failed%20to%20get%20layout%3B%20field%20is%20proj%20%60%3CA%20as%20T%3E%3A%3AU%60/near/170708375" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> eddyb <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/.2360431.20failed.20to.20get.20layout.3B.20field.20is.20proj.20.60.3CA.20as.20T.3E.3A.3AU.60.html#170708375">(Jul 12 2019 at 09:39)</a>:</h4>
<p>and enjoy your time off :P</p>



<a name="170708426"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/%2360431%20failed%20to%20get%20layout%3B%20field%20is%20proj%20%60%3CA%20as%20T%3E%3A%3AU%60/near/170708426" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pnkfelix <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/.2360431.20failed.20to.20get.20layout.3B.20field.20is.20proj.20.60.3CA.20as.20T.3E.3A.3AU.60.html#170708426">(Jul 12 2019 at 09:40)</a>:</h4>
<p>yeah I wanted to double check about that indent fix</p>



<a name="170708431"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/%2360431%20failed%20to%20get%20layout%3B%20field%20is%20proj%20%60%3CA%20as%20T%3E%3A%3AU%60/near/170708431" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pnkfelix <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/.2360431.20failed.20to.20get.20layout.3B.20field.20is.20proj.20.60.3CA.20as.20T.3E.3A.3AU.60.html#170708431">(Jul 12 2019 at 09:40)</a>:</h4>
<p>I want to see what rustfmt does there</p>



<a name="170708434"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/%2360431%20failed%20to%20get%20layout%3B%20field%20is%20proj%20%60%3CA%20as%20T%3E%3A%3AU%60/near/170708434" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pnkfelix <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/.2360431.20failed.20to.20get.20layout.3B.20field.20is.20proj.20.60.3CA.20as.20T.3E.3A.3AU.60.html#170708434">(Jul 12 2019 at 09:40)</a>:</h4>
<p>its something with the match guard up above it</p>



<a name="170708439"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/%2360431%20failed%20to%20get%20layout%3B%20field%20is%20proj%20%60%3CA%20as%20T%3E%3A%3AU%60/near/170708439" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> eddyb <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/.2360431.20failed.20to.20get.20layout.3B.20field.20is.20proj.20.60.3CA.20as.20T.3E.3A.3AU.60.html#170708439">(Jul 12 2019 at 09:40)</a>:</h4>
<p>are using "only reformat those lines"?</p>



<a name="170708453"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/%2360431%20failed%20to%20get%20layout%3B%20field%20is%20proj%20%60%3CA%20as%20T%3E%3A%3AU%60/near/170708453" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pnkfelix <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/.2360431.20failed.20to.20get.20layout.3B.20field.20is.20proj.20.60.3CA.20as.20T.3E.3A.3AU.60.html#170708453">(Jul 12 2019 at 09:40)</a>:</h4>
<p>oh I see, yeah that's what happened</p>



<a name="170708454"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/%2360431%20failed%20to%20get%20layout%3B%20field%20is%20proj%20%60%3CA%20as%20T%3E%3A%3AU%60/near/170708454" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pnkfelix <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/.2360431.20failed.20to.20get.20layout.3B.20field.20is.20proj.20.60.3CA.20as.20T.3E.3A.3AU.60.html#170708454">(Jul 12 2019 at 09:41)</a>:</h4>
<p>ugh</p>



<a name="170708465"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/%2360431%20failed%20to%20get%20layout%3B%20field%20is%20proj%20%60%3CA%20as%20T%3E%3A%3AU%60/near/170708465" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> eddyb <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/.2360431.20failed.20to.20get.20layout.3B.20field.20is.20proj.20.60.3CA.20as.20T.3E.3A.3AU.60.html#170708465">(Jul 12 2019 at 09:41)</a>:</h4>
<p>because I picked up a script from someone else that does it off of git diffs and ran into this sort of nonsense all over the place</p>



<a name="170708468"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/%2360431%20failed%20to%20get%20layout%3B%20field%20is%20proj%20%60%3CA%20as%20T%3E%3A%3AU%60/near/170708468" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pnkfelix <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/.2360431.20failed.20to.20get.20layout.3B.20field.20is.20proj.20.60.3CA.20as.20T.3E.3A.3AU.60.html#170708468">(Jul 12 2019 at 09:41)</a>:</h4>
<p>I dont want to cause that much rightward drift, let me see</p>



<a name="170708473"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/%2360431%20failed%20to%20get%20layout%3B%20field%20is%20proj%20%60%3CA%20as%20T%3E%3A%3AU%60/near/170708473" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> eddyb <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/.2360431.20failed.20to.20get.20layout.3B.20field.20is.20proj.20.60.3CA.20as.20T.3E.3A.3AU.60.html#170708473">(Jul 12 2019 at 09:41)</a>:</h4>
<p>so I had to manually look at every single change</p>



<a name="170708537"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/%2360431%20failed%20to%20get%20layout%3B%20field%20is%20proj%20%60%3CA%20as%20T%3E%3A%3AU%60/near/170708537" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pnkfelix <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/.2360431.20failed.20to.20get.20layout.3B.20field.20is.20proj.20.60.3CA.20as.20T.3E.3A.3AU.60.html#170708537">(Jul 12 2019 at 09:42)</a>:</h4>
<p>hmm okay I didn't even touch the match guard, did I</p>



<a name="170708540"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/%2360431%20failed%20to%20get%20layout%3B%20field%20is%20proj%20%60%3CA%20as%20T%3E%3A%3AU%60/near/170708540" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pnkfelix <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/.2360431.20failed.20to.20get.20layout.3B.20field.20is.20proj.20.60.3CA.20as.20T.3E.3A.3AU.60.html#170708540">(Jul 12 2019 at 09:42)</a>:</h4>
<p>so I really should put it back the way it was before. Will do.</p>



<a name="170711826"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/%2360431%20failed%20to%20get%20layout%3B%20field%20is%20proj%20%60%3CA%20as%20T%3E%3A%3AU%60/near/170711826" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/.2360431.20failed.20to.20get.20layout.3B.20field.20is.20proj.20.60.3CA.20as.20T.3E.3A.3AU.60.html#170711826">(Jul 12 2019 at 10:40)</a>:</h4>
<p><span class="user-mention" data-user-id="116083">@pnkfelix</span> (just checking in, it seems like canonicalization is not relevant here?)</p>



<a name="170711839"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/%2360431%20failed%20to%20get%20layout%3B%20field%20is%20proj%20%60%3CA%20as%20T%3E%3A%3AU%60/near/170711839" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pnkfelix <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/.2360431.20failed.20to.20get.20layout.3B.20field.20is.20proj.20.60.3CA.20as.20T.3E.3A.3AU.60.html#170711839">(Jul 12 2019 at 10:41)</a>:</h4>
<p>it wasn't, no</p>



<a name="170711849"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/%2360431%20failed%20to%20get%20layout%3B%20field%20is%20proj%20%60%3CA%20as%20T%3E%3A%3AU%60/near/170711849" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pnkfelix <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/.2360431.20failed.20to.20get.20layout.3B.20field.20is.20proj.20.60.3CA.20as.20T.3E.3A.3AU.60.html#170711849">(Jul 12 2019 at 10:41)</a>:</h4>
<p>I completely misdiagnosed the bug when I was first looking at it</p>



<hr><p>Last updated: Aug 07 2021 at 22:04 UTC</p>
</html>