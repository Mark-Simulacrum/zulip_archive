<html>
<head><meta charset="utf-8"><title>refactoring footguns · t-compiler · Zulip Chat Archive</title></head>
<h2>Stream: <a href="https://zulip-archive.rust-lang.org/stream/131828-t-compiler/index.html">t-compiler</a></h2>
<h3>Topic: <a href="https://zulip-archive.rust-lang.org/stream/131828-t-compiler/topic/refactoring.20footguns.html">refactoring footguns</a></h3>

<hr>

<base href="https://rust-lang.zulipchat.com">

<head><link href="https://zulip-archive.rust-lang.org/style.css" rel="stylesheet"></head>

<a name="250688079"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/refactoring%20footguns/near/250688079" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Ku <a href="https://zulip-archive.rust-lang.org/stream/131828-t-compiler/topic/refactoring.20footguns.html#250688079">(Aug 25 2021 at 21:51)</a>:</h4>
<p>When navigating around the codebase I see a lot of strange idiosyncrasies that can be refactored out (using a struct to namespace functions for instance, or poorly ordered/unscoped functions).<br>
Is it simply not having enough manpower, or is there some form of api stability that I don't know about (what should I watch out for when refactoring)?</p>



<a name="250688484"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/refactoring%20footguns/near/250688484" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nagisa <a href="https://zulip-archive.rust-lang.org/stream/131828-t-compiler/topic/refactoring.20footguns.html#250688484">(Aug 25 2021 at 21:55)</a>:</h4>
<p>compiler internals are largely heavily unstable. Only the language itself (i.e. syntax, behaviour, etc.) and the standard library API are subject to the stability guarantees.</p>



<a name="250688616"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/refactoring%20footguns/near/250688616" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nagisa <a href="https://zulip-archive.rust-lang.org/stream/131828-t-compiler/topic/refactoring.20footguns.html#250688616">(Aug 25 2021 at 21:57)</a>:</h4>
<p><code>rustc</code> is one of, if not the oldest Rust codebases on this planet. It having a fair amount of cruft is probably a fairly natural consequence of that.</p>



<a name="250688716"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/refactoring%20footguns/near/250688716" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> The 8472 <a href="https://zulip-archive.rust-lang.org/stream/131828-t-compiler/topic/refactoring.20footguns.html#250688716">(Aug 25 2021 at 21:58)</a>:</h4>
<p>I think people just don't care much for ordering of internal things. For external documentation rustdoc already sorts the index alphabetically and when developing things most tools provide jump to source.<br>
And the downside of refactoring is that it makes git history harder to trace.</p>



<a name="250695362"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/refactoring%20footguns/near/250695362" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Nelson <a href="https://zulip-archive.rust-lang.org/stream/131828-t-compiler/topic/refactoring.20footguns.html#250695362">(Aug 25 2021 at 23:05)</a>:</h4>
<p>Some of the things you mentioned I wouldn't do on <em>any</em> project, it's silly to reorder functions after they're written</p>



<a name="250695764"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/refactoring%20footguns/near/250695764" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Nelson <a href="https://zulip-archive.rust-lang.org/stream/131828-t-compiler/topic/refactoring.20footguns.html#250695764">(Aug 25 2021 at 23:09)</a>:</h4>
<p>I would say refactoring is a good idea if</p>
<ul>
<li>you think it makes code easier to understand (not just look nicer)</li>
<li>simplifies code, or removes code without making the remaining code much more complicated</li>
<li>makes it significant easier to change or add to the code in the future. I would say "significant" is "it would be a hassle to change the code as-is"</li>
<li>greatly decreases the amount of indentation in a block</li>
</ul>
<p>I don't think you should ever refactor just because you like the new code better (changing iterators to loops or vice versa, renaming variables, etc). I also think the barrier gets higher if the code isn't modified as often.</p>



<a name="250702041"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/refactoring%20footguns/near/250702041" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Ku <a href="https://zulip-archive.rust-lang.org/stream/131828-t-compiler/topic/refactoring.20footguns.html#250702041">(Aug 26 2021 at 00:21)</a>:</h4>
<p>Alright, thanks for the advice ^-^</p>



<a name="250712604"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/refactoring%20footguns/near/250712604" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lokathor <a href="https://zulip-archive.rust-lang.org/stream/131828-t-compiler/topic/refactoring.20footguns.html#250712604">(Aug 26 2021 at 03:01)</a>:</h4>
<p>you could potentially refactor for speed benefits</p>



<a name="250713936"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/refactoring%20footguns/near/250713936" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Nelson <a href="https://zulip-archive.rust-lang.org/stream/131828-t-compiler/topic/refactoring.20footguns.html#250713936">(Aug 26 2021 at 03:22)</a>:</h4>
<p>sure, those too</p>



<hr><p>Last updated: Apr 12 2022 at 20:01 UTC</p>
</html>