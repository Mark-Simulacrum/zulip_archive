<html>
<head><meta charset="utf-8"><title>bootstrap rustc using cg_clif · t-compiler · Zulip Chat Archive</title></head>
<h2>Stream: <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/index.html">t-compiler</a></h2>
<h3>Topic: <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/bootstrap.20rustc.20using.20cg_clif.html">bootstrap rustc using cg_clif</a></h3>

<hr>

<base href="https://rust-lang.zulipchat.com">

<head><link href="https://rust-lang.github.io/zulip_archive/style.css" rel="stylesheet"></head>

<a name="202294172"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/bootstrap%20rustc%20using%20cg_clif/near/202294172" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> bjorn3 <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/bootstrap.20rustc.20using.20cg_clif.html#202294172">(Jun 29 2020 at 10:47)</a>:</h4>
<p>I tried bootstrapping rustc using cg_clif. I was able to compile rustc using cg_clif. It is now at crate 173/207 of a full bootstrap (compiling rustc using that cg_clif compiled rustc) <span aria-label="tada" class="emoji emoji-1f389" role="img" title="tada">:tada:</span> <span aria-label="balloon" class="emoji emoji-1f388" role="img" title="balloon">:balloon:</span> <span aria-label="tada" class="emoji emoji-1f389" role="img" title="tada">:tada:</span></p>



<a name="202294450"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/bootstrap%20rustc%20using%20cg_clif/near/202294450" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> bjorn3 <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/bootstrap.20rustc.20using.20cg_clif.html#202294450">(Jun 29 2020 at 10:51)</a>:</h4>
<p>It took 30min to compile a compiler using stage0 rustc. It took 4m40s to compile a compiler using stage1 rustc. And it has now been busy compiling a compiler using stage2 rustc for at least 40min.</p>



<a name="202295544"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/bootstrap%20rustc%20using%20cg_clif/near/202295544" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> bjorn3 <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/bootstrap.20rustc.20using.20cg_clif.html#202295544">(Jun 29 2020 at 11:05)</a>:</h4>
<p>186/207: rustc_middle</p>



<a name="202300292"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/bootstrap%20rustc%20using%20cg_clif/near/202300292" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> oli <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/bootstrap.20rustc.20using.20cg_clif.html#202300292">(Jun 29 2020 at 12:08)</a>:</h4>
<p>so... stage0 rustc is still the same thing as on master, but the 4m40s thing is with cg_clif, and the currently running thing is using the compiler built with cg_clif to build itself again?</p>



<a name="202300919"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/bootstrap%20rustc%20using%20cg_clif/near/202300919" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> bjorn3 <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/bootstrap.20rustc.20using.20cg_clif.html#202300919">(Jun 29 2020 at 12:15)</a>:</h4>
<p>yes. by the way it is now at 204/207: rustc_mir</p>



<a name="202301320"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/bootstrap%20rustc%20using%20cg_clif/near/202301320" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> oli <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/bootstrap.20rustc.20using.20cg_clif.html#202301320">(Jun 29 2020 at 12:20)</a>:</h4>
<p>go go go</p>



<a name="202301648"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/bootstrap%20rustc%20using%20cg_clif/near/202301648" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> bjorn3 <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/bootstrap.20rustc.20using.20cg_clif.html#202301648">(Jun 29 2020 at 12:24)</a>:</h4>
<p>205/207: rustc_driver</p>



<a name="202301717"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/bootstrap%20rustc%20using%20cg_clif/near/202301717" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> bjorn3 <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/bootstrap.20rustc.20using.20cg_clif.html#202301717">(Jun 29 2020 at 12:24)</a>:</h4>
<p>it can almost go compile cg_clif itself using cg_clif rustc again</p>



<a name="202301855"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/bootstrap%20rustc%20using%20cg_clif/near/202301855" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> bjorn3 <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/bootstrap.20rustc.20using.20cg_clif.html#202301855">(Jun 29 2020 at 12:26)</a>:</h4>
<p>and after that I can use my laptop again. (firefox+vscode+compiling rustc =&gt; excessive swapping)</p>



<a name="202302173"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/bootstrap%20rustc%20using%20cg_clif/near/202302173" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> bjorn3 <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/bootstrap.20rustc.20using.20cg_clif.html#202302173">(Jun 29 2020 at 12:29)</a>:</h4>
<p>now compiling cg_clif</p>



<a name="202305002"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/bootstrap%20rustc%20using%20cg_clif/near/202305002" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> bjorn3 <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/bootstrap.20rustc.20using.20cg_clif.html#202305002">(Jun 29 2020 at 12:58)</a>:</h4>
<p>Build completed successfully in 2:57:19</p>



<a name="202305050"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/bootstrap%20rustc%20using%20cg_clif/near/202305050" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> bjorn3 <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/bootstrap.20rustc.20using.20cg_clif.html#202305050">(Jun 29 2020 at 12:59)</a>:</h4>
<p>That is starting at the compilation of libcore using cg_clif</p>



<a name="202305085"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/bootstrap%20rustc%20using%20cg_clif/near/202305085" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> oli <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/bootstrap.20rustc.20using.20cg_clif.html#202305085">(Jun 29 2020 at 12:59)</a>:</h4>
<p>which now should take the same amount of time that it took for stage 2, right?</p>



<a name="202305176"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/bootstrap%20rustc%20using%20cg_clif/near/202305176" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> bjorn3 <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/bootstrap.20rustc.20using.20cg_clif.html#202305176">(Jun 29 2020 at 13:00)</a>:</h4>
<p>What do you mean?</p>



<a name="202305317"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/bootstrap%20rustc%20using%20cg_clif/near/202305317" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> oli <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/bootstrap.20rustc.20using.20cg_clif.html#202305317">(Jun 29 2020 at 13:01)</a>:</h4>
<p>the stage2 compiler's libcore was build with a stage1 compiler using cg_clif, so building a libcore with the stage2 compiler that was just built should be absolutely the same... but while writing this I realized you meant that's the time elapsed since starting the compilation of libcore with <code>cg_clif</code></p>



<a name="202305393"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/bootstrap%20rustc%20using%20cg_clif/near/202305393" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> bjorn3 <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/bootstrap.20rustc.20using.20cg_clif.html#202305393">(Jun 29 2020 at 13:02)</a>:</h4>
<p>ah ok</p>



<a name="202305897"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/bootstrap%20rustc%20using%20cg_clif/near/202305897" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jake Goulding <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/bootstrap.20rustc.20using.20cg_clif.html#202305897">(Jun 29 2020 at 13:06)</a>:</h4>
<p>Now time for stages 3, 4, 5,  <span aria-label="wink" class="emoji emoji-1f609" role="img" title="wink">:wink:</span></p>



<a name="202306002"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/bootstrap%20rustc%20using%20cg_clif/near/202306002" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> bjorn3 <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/bootstrap.20rustc.20using.20cg_clif.html#202306002">(Jun 29 2020 at 13:07)</a>:</h4>
<p>Those should be identical. I am not going to try another 3 hour compilation though :)</p>



<a name="202306020"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/bootstrap%20rustc%20using%20cg_clif/near/202306020" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> bjorn3 <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/bootstrap.20rustc.20using.20cg_clif.html#202306020">(Jun 29 2020 at 13:07)</a>:</h4>
<p>Reproduction instructions: <a href="https://github.com/bjorn3/rustc_codegen_cranelift/issues/743#issuecomment-651108168">https://github.com/bjorn3/rustc_codegen_cranelift/issues/743#issuecomment-651108168</a></p>



<a name="202378511"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/bootstrap%20rustc%20using%20cg_clif/near/202378511" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> mark-i-m <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/bootstrap.20rustc.20using.20cg_clif.html#202378511">(Jun 29 2020 at 23:07)</a>:</h4>
<p>This is awesome!</p>



<a name="202378568"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/bootstrap%20rustc%20using%20cg_clif/near/202378568" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> mark-i-m <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/bootstrap.20rustc.20using.20cg_clif.html#202378568">(Jun 29 2020 at 23:08)</a>:</h4>
<p>I'm trying to understand why stage 1 was so much faster than stage 2?</p>



<a name="202394129"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/bootstrap%20rustc%20using%20cg_clif/near/202394129" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Josh Triplett <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/bootstrap.20rustc.20using.20cg_clif.html#202394129">(Jun 30 2020 at 04:16)</a>:</h4>
<p><span class="user-mention" data-user-id="133247">@bjorn3</span> What were the specs on the system you used for that build?</p>



<a name="202400854"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/bootstrap%20rustc%20using%20cg_clif/near/202400854" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> bjorn3 <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/bootstrap.20rustc.20using.20cg_clif.html#202400854">(Jun 30 2020 at 06:51)</a>:</h4>
<p><span class="user-mention silent" data-user-id="198054">mark-i-m</span> <a href="#narrow/stream/131828-t-compiler/topic/bootstrap.20rustc.20using.20cg_clif/near/202378568">said</a>:</p>
<blockquote>
<p>I'm trying to understand why stage 1 was so much faster than stage 2?</p>
</blockquote>
<p>The bootstrap conpiler compiled an optimized compiler with cg_clif support using LLVM. This took 30m. This compiler with cg_clif support compiles a conpiler which is effectively less optimized than an LLVM debug build. This took 4m40s. This unoptimized comiler then took 3h to compile libstd+compiler.</p>



<a name="202400953"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/bootstrap%20rustc%20using%20cg_clif/near/202400953" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> bjorn3 <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/bootstrap.20rustc.20using.20cg_clif.html#202400953">(Jun 30 2020 at 06:52)</a>:</h4>
<p><span class="user-mention silent" data-user-id="239881">Josh Triplett</span> <a href="#narrow/stream/131828-t-compiler/topic/bootstrap.20rustc.20using.20cg_clif/near/202394129">said</a>:</p>
<blockquote>
<p><span class="user-mention silent" data-user-id="133247">bjorn3</span> What were the specs on the system you used for that build?</p>
</blockquote>
<p>I ran the bootstrap on a laptop with a Intel(R) Core(TM) i3-7130U CPU @ 2.70GHz and an ssd.</p>



<a name="202420046"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/bootstrap%20rustc%20using%20cg_clif/near/202420046" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> mati865 <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/bootstrap.20rustc.20using.20cg_clif.html#202420046">(Jun 30 2020 at 10:58)</a>:</h4>
<p><span class="user-mention silent" data-user-id="133247">bjorn3</span> <a href="#narrow/stream/131828-t-compiler/topic/bootstrap.20rustc.20using.20cg_clif/near/202400953">said</a>:</p>
<blockquote>
<p>I ran the bootstrap on a laptop with a Intel(R) Core(TM) i3-7130U CPU @ 2.70GHz and an ssd.</p>
</blockquote>
<p>Ouch, I'll try it on something a bit more reasonable when I get time to do it <span aria-label="wink" class="emoji emoji-1f609" role="img" title="wink">:wink:</span></p>



<a name="202421149"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/bootstrap%20rustc%20using%20cg_clif/near/202421149" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> bjorn3 <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/bootstrap.20rustc.20using.20cg_clif.html#202421149">(Jun 30 2020 at 11:11)</a>:</h4>
<blockquote>
<p>Edit has_cpuid in corearch to always return false.</p>
</blockquote>
<p>FYI that is this function: <a href="https://github.com/rust-lang/stdarch/blob/b17efd88af158b14b32ff394efb57c1b90179bf5/crates/core_arch/src/x86/cpuid.rs#L92">https://github.com/rust-lang/stdarch/blob/b17efd88af158b14b32ff394efb57c1b90179bf5/crates/core_arch/src/x86/cpuid.rs#L92</a> Also you need to clone cg_clif to <code>&lt;rust checkout&gt;/../cg_clif</code>. Bootstrap has been tested on Linux, but should also work fine on macOS. Windows is not yet supported by cg_clif at all.</p>



<a name="202577295"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/bootstrap%20rustc%20using%20cg_clif/near/202577295" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> mark-i-m <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/bootstrap.20rustc.20using.20cg_clif.html#202577295">(Jul 01 2020 at 14:45)</a>:</h4>
<p><span class="user-mention silent" data-user-id="133247">bjorn3</span> <a href="#narrow/stream/131828-t-compiler/topic/bootstrap.20rustc.20using.20cg_clif/near/202400854">said</a>:</p>
<blockquote>
<p><span class="user-mention silent" data-user-id="198054">mark-i-m</span> <a href="#narrow/stream/131828-t-compiler/topic/bootstrap.20rustc.20using.20cg_clif/near/202378568">said</a>:</p>
<blockquote>
<p>I'm trying to understand why stage 1 was so much faster than stage 2?</p>
</blockquote>
<p>The bootstrap conpiler compiled an optimized compiler with cg_clif support using LLVM. This took 30m. This compiler with cg_clif support compiles a conpiler which is effectively less optimized than an LLVM debug build. This took 4m40s. This unoptimized comiler then took 3h to compile libstd+compiler.</p>
</blockquote>
<p>Oh, that's awesome! It means that for debug builds cg_clif could provide major compile-time improvements <span aria-label="rocket" class="emoji emoji-1f680" role="img" title="rocket">:rocket:</span></p>



<a name="202577523"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/bootstrap%20rustc%20using%20cg_clif/near/202577523" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> bjorn3 <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/bootstrap.20rustc.20using.20cg_clif.html#202577523">(Jul 01 2020 at 14:47)</a>:</h4>
<p>cg_clif built rustc is somewhat slower than even a rustc build in debug mode with LLVM. Rustc is normally build in release mode because debug mode is way too slow.</p>



<a name="202591966"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/bootstrap%20rustc%20using%20cg_clif/near/202591966" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Josh Triplett <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/bootstrap.20rustc.20using.20cg_clif.html#202591966">(Jul 01 2020 at 16:36)</a>:</h4>
<p>If you have a step-by-step recipe to do the stage 1 build (without building LLVM from source), I would be happy to test that on a 96-CPU system and see how fast it builds.</p>



<a name="202592039"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/bootstrap%20rustc%20using%20cg_clif/near/202592039" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Josh Triplett <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/bootstrap.20rustc.20using.20cg_clif.html#202592039">(Jul 01 2020 at 16:37)</a>:</h4>
<p>That same system can build Rust stage 1 from scratch, including LLVM, in 5 minutes.</p>



<a name="202592188"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/bootstrap%20rustc%20using%20cg_clif/near/202592188" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Josh Triplett <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/bootstrap.20rustc.20using.20cg_clif.html#202592188">(Jul 01 2020 at 16:38)</a>:</h4>
<p>I would also be interested to know how long it takes to run the test suite on the cg_clif-based compiler</p>



<a name="202592798"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/bootstrap%20rustc%20using%20cg_clif/near/202592798" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> bjorn3 <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/bootstrap.20rustc.20using.20cg_clif.html#202592798">(Jul 01 2020 at 16:43)</a>:</h4>
<p><span class="user-mention" data-user-id="239881">@Josh Triplett</span> <a href="https://github.com/bjorn3/rustc_codegen_cranelift/issues/743#issuecomment-651108168">https://github.com/bjorn3/rustc_codegen_cranelift/issues/743#issuecomment-651108168</a></p>
<p>Combined with</p>
<p><span class="user-mention silent" data-user-id="133247">bjorn3</span> <a href="#narrow/stream/131828-t-compiler/topic/bootstrap.20rustc.20using.20cg_clif/near/202421149">said</a>:</p>
<blockquote>
<blockquote>
<p>Edit has_cpuid in corearch to always return false.</p>
</blockquote>
<p>FYI that is this function: <a href="https://github.com/rust-lang/stdarch/blob/b17efd88af158b14b32ff394efb57c1b90179bf5/crates/core_arch/src/x86/cpuid.rs#L92">https://github.com/rust-lang/stdarch/blob/b17efd88af158b14b32ff394efb57c1b90179bf5/crates/core_arch/src/x86/cpuid.rs#L92</a> Also you need to clone cg_clif to <code>&lt;rust checkout&gt;/../cg_clif</code>. Bootstrap has been tested on Linux, but should also work fine on macOS. Windows is not yet supported by cg_clif at all.</p>
</blockquote>
<p>should be everything you need to know to reproduce this. The instructions completely disable the LLVM backend, so it won't build LLVM. cg_clif will likely benefit less from the high core count, as it doesn't do codegen in parallel. (/me is still waiting on parallel rustc)</p>



<a name="202593024"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/bootstrap%20rustc%20using%20cg_clif/near/202593024" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> bjorn3 <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/bootstrap.20rustc.20using.20cg_clif.html#202593024">(Jul 01 2020 at 16:45)</a>:</h4>
<p>cg_clif should pass a fair amount of the run-pass tests: <a href="https://github.com/bjorn3/rustc_codegen_cranelift/issues/381">https://github.com/bjorn3/rustc_codegen_cranelift/issues/381</a> See <a href="https://github.com/bjorn3/rustc_codegen_cranelift/blob/6b1e90c01330676251e40fe916657f8e74029034/test.sh#L97-L147">https://github.com/bjorn3/rustc_codegen_cranelift/blob/6b1e90c01330676251e40fe916657f8e74029034/test.sh#L97-L147</a> for all things that are expected to not pass.</p>



<a name="202669653"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/bootstrap%20rustc%20using%20cg_clif/near/202669653" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> mati865 <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/bootstrap.20rustc.20using.20cg_clif.html#202669653">(Jul 02 2020 at 10:06)</a>:</h4>
<p><span class="user-mention" data-user-id="133247">@bjorn3</span> it failed for me with <a href="https://hastebin.com/movapotori">https://hastebin.com/movapotori</a><br>
cg_clif is on <code>wip_proc_macro_fixes</code> branch:</p>
<div class="codehilite"><pre><span></span><code>$ git --no-pager branch -v
  master               a299d0e Don&#39;t panic on unevaluatable promoted constants
* wip_proc_macro_fixes 8051242 Fix SwitchInt on 128bit integers
</code></pre></div>



<a name="202669845"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/bootstrap%20rustc%20using%20cg_clif/near/202669845" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> bjorn3 <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/bootstrap.20rustc.20using.20cg_clif.html#202669845">(Jul 02 2020 at 10:09)</a>:</h4>
<p>Did you checkout <a href="https://github.com/rust-lang/rust/commit/430ab52a3cf9c941783e7996cb6dd00206e9152a">430ab52a3cf9c941783e7996cb6dd00206e9152a</a> of my wasmtime fork for the correct Cranelift version?</p>



<a name="202669901"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/bootstrap%20rustc%20using%20cg_clif/near/202669901" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> bjorn3 <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/bootstrap.20rustc.20using.20cg_clif.html#202669901">(Jul 02 2020 at 10:10)</a>:</h4>
<p><code>ArgumentPurpose::StructArgument</code> is not yet supported by upstream, but it is necessary for abi compatibility between cg_clif and cg_llvm compiled libproc_macro.</p>



<a name="202669961"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/bootstrap%20rustc%20using%20cg_clif/near/202669961" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> bjorn3 <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/bootstrap.20rustc.20using.20cg_clif.html#202669961">(Jul 02 2020 at 10:10)</a>:</h4>
<p><span class="user-mention" data-user-id="119581">@mati865</span> ^</p>



<a name="202670291"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/bootstrap%20rustc%20using%20cg_clif/near/202670291" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> mati865 <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/bootstrap.20rustc.20using.20cg_clif.html#202670291">(Jul 02 2020 at 10:14)</a>:</h4>
<p><span class="user-mention" data-user-id="133247">@bjorn3</span> </p>
<div class="codehilite"><pre><span></span><code>$ git --no-pager branch -v
* 128bit_switch ed0495c75 Fix Switch for 128bit integers
  master        39ba281bc Update some documentation on `Memory` (#1360)
$ git checkout 430ab52a3cf9c941783e7996cb6dd00206e9152a
fatal: reference is not a tree: 430ab52a3cf9c941783e7996cb6dd00206e9152a
$ git remote -v
origin  https://github.com/bjorn3/wasmtime (fetch)
origin  https://github.com/bjorn3/wasmtime (push)
</code></pre></div>



<a name="202670368"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/bootstrap%20rustc%20using%20cg_clif/near/202670368" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> bjorn3 <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/bootstrap.20rustc.20using.20cg_clif.html#202670368">(Jul 02 2020 at 10:15)</a>:</h4>
<p>Forgot I squashed the PR. The new commit is <a href="https://github.com/rust-lang/rust/commit/8fbde92c387635908955a5a8140a8901861cdade">8fbde92c387635908955a5a8140a8901861cdade</a>.</p>



<a name="202670434"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/bootstrap%20rustc%20using%20cg_clif/near/202670434" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> bjorn3 <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/bootstrap.20rustc.20using.20cg_clif.html#202670434">(Jul 02 2020 at 10:16)</a>:</h4>
<p>You also need to merge <a href="https://github.com/rust-lang/rust/commit/ed0495c75440a1b593685491da157d79250afa02">ed0495c75440a1b593685491da157d79250afa02</a> into it.</p>



<a name="202670554"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/bootstrap%20rustc%20using%20cg_clif/near/202670554" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> bjorn3 <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/bootstrap.20rustc.20using.20cg_clif.html#202670554">(Jul 02 2020 at 10:18)</a>:</h4>
<p><span class="user-mention" data-user-id="119581">@mati865</span> ^</p>



<a name="202670643"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/bootstrap%20rustc%20using%20cg_clif/near/202670643" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> mati865 <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/bootstrap.20rustc.20using.20cg_clif.html#202670643">(Jul 02 2020 at 10:19)</a>:</h4>
<p>I see, I was waiting for cranelift to build. Seems to work now.<br>
FYI I'm on 128bit_switch branch and cherry-picked <a href="https://github.com/rust-lang/rust/commit/8fbde92c387635908955a5a8140a8901861cdade">8fbde92c387635908955a5a8140a8901861cdade</a></p>



<a name="202681487"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/bootstrap%20rustc%20using%20cg_clif/near/202681487" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> mati865 <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/bootstrap.20rustc.20using.20cg_clif.html#202681487">(Jul 02 2020 at 12:37)</a>:</h4>
<p>2700X Arch Linux:</p>
<blockquote>
<p>Build completed successfully in 1:17:37</p>
</blockquote>
<p>Full log (with step timings) is available here: <a href="https://hastebin.com/ogoqojofes">https://hastebin.com/ogoqojofes</a></p>



<a name="202702854"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/bootstrap%20rustc%20using%20cg_clif/near/202702854" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> bjorn3 <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/bootstrap.20rustc.20using.20cg_clif.html#202702854">(Jul 02 2020 at 15:21)</a>:</h4>
<p>Nice! The output is what I expected, just a lot faster :)</p>



<a name="202704708"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/bootstrap%20rustc%20using%20cg_clif/near/202704708" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> mark-i-m <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/bootstrap.20rustc.20using.20cg_clif.html#202704708">(Jul 02 2020 at 15:35)</a>:</h4>
<p>What are the next steps here? Should we expect this in rustc any time soon?</p>



<a name="202705298"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/bootstrap%20rustc%20using%20cg_clif/near/202705298" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wesley Wiser <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/bootstrap.20rustc.20using.20cg_clif.html#202705298">(Jul 02 2020 at 15:38)</a>:</h4>
<p>Is the next step getting <a href="https://github.com/rust-lang/compiler-team/issues/270">https://github.com/rust-lang/compiler-team/issues/270</a> approved?</p>



<a name="202708269"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/bootstrap%20rustc%20using%20cg_clif/near/202708269" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> bjorn3 <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/bootstrap.20rustc.20using.20cg_clif.html#202708269">(Jul 02 2020 at 16:00)</a>:</h4>
<p>The MCP is pretty much blocked on <a href="https://github.com/rust-lang/compiler-team/issues/270#issuecomment-646289245">https://github.com/rust-lang/compiler-team/issues/270#issuecomment-646289245</a>. (<code>git subtree</code> depends on a git patch to work fine on a repo as big as <code>rust-lang/rust</code>)</p>
<p>The actual rustc bootstrap depends on <a href="https://github.com/bytecodealliance/wasmtime/issues/1559">bytecodealliance/wasmtime#1559</a> (support the SystemV abi way of passing structs as arguments, moderately sized PR) and <a href="https://github.com/bytecodealliance/wasmtime/issues/1939">bytecodealliance/wasmtime#1939</a> (fix matching on 128bit integers, small PR) on the Cranelift side.<br>
It also depends on a libstd patch of <a href="https://github.com/rust-lang/rust/compare/master...bjorn3:cg_clif_subtree#diff-c126590bd9baecba4097bcdb3c839b5bL17-R21"><code>fast_thread_local::register_dtor</code></a>, because it is doing something with weak linkage that I couldn't figure out how to make it work with cg_clif. Maybe if I look at it again I can find the issue.<br>
On the rustc_codegen_cranelift side it depends on a <a href="https://github.com/bjorn3/rustc_codegen_cranelift/compare/wip_proc_macro_fixes#diff-f3d6fdbd69d415b035b88f0dbb908c7eR114-R156">hack</a> to outside of <code>main</code> initialize the global mutex used to emulate atomics, so that proc macros can be loaded by a cg_llvm compiled rustc.</p>



<a name="202708283"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/bootstrap%20rustc%20using%20cg_clif/near/202708283" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> bjorn3 <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/bootstrap.20rustc.20using.20cg_clif.html#202708283">(Jul 02 2020 at 16:00)</a>:</h4>
<p><span class="user-mention" data-user-id="125250">@Wesley Wiser</span> ^</p>



<a name="202723130"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/bootstrap%20rustc%20using%20cg_clif/near/202723130" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wesley Wiser <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/bootstrap.20rustc.20using.20cg_clif.html#202723130">(Jul 02 2020 at 17:57)</a>:</h4>
<p>Thanks <span class="user-mention" data-user-id="133247">@bjorn3</span>! I'm really excited to see this move forward so I'll watch those PRs. <span aria-label="slight smile" class="emoji emoji-1f642" role="img" title="slight smile">:slight_smile:</span></p>



<a name="202730516"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/bootstrap%20rustc%20using%20cg_clif/near/202730516" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Josh Triplett <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/bootstrap.20rustc.20using.20cg_clif.html#202730516">(Jul 02 2020 at 18:55)</a>:</h4>
<p><span class="user-mention" data-user-id="133247">@bjorn3</span> What's the current status of atomics?</p>



<a name="202730623"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/bootstrap%20rustc%20using%20cg_clif/near/202730623" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> bjorn3 <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/bootstrap.20rustc.20using.20cg_clif.html#202730623">(Jul 02 2020 at 18:56)</a>:</h4>
<p>I am emulating them using <code>pthread_mutex_lock</code>. Getting real atomics is blocked on Cranelift.</p>



<a name="202730649"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/bootstrap%20rustc%20using%20cg_clif/near/202730649" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Josh Triplett <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/bootstrap.20rustc.20using.20cg_clif.html#202730649">(Jul 02 2020 at 18:56)</a>:</h4>
<p>That's what I meant; I wondered about the status of atomics in Cranelift.</p>



<a name="202730657"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/bootstrap%20rustc%20using%20cg_clif/near/202730657" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> bjorn3 <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/bootstrap.20rustc.20using.20cg_clif.html#202730657">(Jul 02 2020 at 18:56)</a>:</h4>
<p><a href="https://github.com/bytecodealliance/wasmtime/issues/1059">https://github.com/bytecodealliance/wasmtime/issues/1059</a></p>



<a name="202730941"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/bootstrap%20rustc%20using%20cg_clif/near/202730941" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> bjorn3 <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/bootstrap.20rustc.20using.20cg_clif.html#202730941">(Jul 02 2020 at 18:59)</a>:</h4>
<p>Also bnjbvr posted the following just today in the context of AArch64 support in Cranelift:</p>
<p><a href="https://bytecodealliance.zulipchat.com/#narrow/stream/206238-general/topic/Build.20wasmtime.20for.20Android/near/202705996">https://bytecodealliance.zulipchat.com/#narrow/stream/206238-general/topic/Build.20wasmtime.20for.20Android/near/202705996</a></p>
<blockquote>
<p>[...] SIMD and atomics have started relatively recently, in comparison.</p>
</blockquote>



<a name="202730975"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/bootstrap%20rustc%20using%20cg_clif/near/202730975" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Josh Triplett <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/bootstrap.20rustc.20using.20cg_clif.html#202730975">(Jul 02 2020 at 18:59)</a>:</h4>
<p><span aria-label="+1" class="emoji emoji-1f44d" role="img" title="+1">:+1:</span></p>



<a name="202731456"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/bootstrap%20rustc%20using%20cg_clif/near/202731456" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> bjorn3 <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/bootstrap.20rustc.20using.20cg_clif.html#202731456">(Jul 02 2020 at 19:02)</a>:</h4>
<p>This came as a complete surprise to me. I seem to be missing discussions about Cranelift,as the bytecodealliance meetings don't seem to get any minutes published. <span class="user-mention" data-user-id="116015">@Alex Crichton</span>?</p>



<a name="202731592"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/bootstrap%20rustc%20using%20cg_clif/near/202731592" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Alex Crichton <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/bootstrap.20rustc.20using.20cg_clif.html#202731592">(Jul 02 2020 at 19:03)</a>:</h4>
<p>Sorry I also don't attend cranelift meetings</p>



<a name="202731651"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/bootstrap%20rustc%20using%20cg_clif/near/202731651" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> bjorn3 <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/bootstrap.20rustc.20using.20cg_clif.html#202731651">(Jul 02 2020 at 19:04)</a>:</h4>
<p>Ok</p>



<a name="202731903"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/bootstrap%20rustc%20using%20cg_clif/near/202731903" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Josh Triplett <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/bootstrap.20rustc.20using.20cg_clif.html#202731903">(Jul 02 2020 at 19:06)</a>:</h4>
<p>I've only been to a couple of cranelift meetings; they're at a particularly bad time for me.</p>



<a name="204197098"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/bootstrap%20rustc%20using%20cg_clif/near/204197098" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> bjorn3 <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/bootstrap.20rustc.20using.20cg_clif.html#204197098">(Jul 17 2020 at 11:56)</a>:</h4>
<p><a href="https://github.com/bytecodealliance/wasmtime/pull/1559">https://github.com/bytecodealliance/wasmtime/pull/1559</a> has been merged, so it is no longer necessary to patch cg_clif to bootstrap rustc. Only rustc needs to be patched to integrate with cg_clif. <a href="https://github.com/bjorn3/rustc_codegen_cranelift/issues/743#issuecomment-660046919">https://github.com/bjorn3/rustc_codegen_cranelift/issues/743#issuecomment-660046919</a></p>



<hr><p>Last updated: Aug 07 2021 at 22:04 UTC</p>
</html>