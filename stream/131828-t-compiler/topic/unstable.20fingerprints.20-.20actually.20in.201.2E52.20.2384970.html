<html>
<head><meta charset="utf-8"><title>unstable fingerprints - actually in 1.52 #84970 · t-compiler · Zulip Chat Archive</title></head>
<h2>Stream: <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/index.html">t-compiler</a></h2>
<h3>Topic: <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/unstable.20fingerprints.20-.20actually.20in.201.2E52.20.2384970.html">unstable fingerprints - actually in 1.52 #84970</a></h3>

<hr>

<base href="https://rust-lang.zulipchat.com">

<head><link href="https://rust-lang.github.io/zulip_archive/style.css" rel="stylesheet"></head>

<a name="237894977"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/unstable%20fingerprints%20-%20actually%20in%201.52%20%2384970/near/237894977" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jonas Schievink  [he/him] <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/unstable.20fingerprints.20-.20actually.20in.201.2E52.20.2384970.html#237894977">(May 07 2021 at 21:48)</a>:</h4>
<p><span class="user-mention silent" data-user-id="125294">Aaron Hill</span> <a href="#narrow/stream/131828-t-compiler/topic/unstable.20fingerprints.20-.20actually.20in.201.2E52/near/237894908">said</a>:</p>
<blockquote>
<p>We only need to actually recompute <code>predicate_of</code> if we need its value</p>
</blockquote>
<p>aah, okay</p>



<a name="237895037"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/unstable%20fingerprints%20-%20actually%20in%201.52%20%2384970/near/237895037" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Aaron Hill <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/unstable.20fingerprints.20-.20actually.20in.201.2E52.20.2384970.html#237895037">(May 07 2021 at 21:48)</a>:</h4>
<p>so, we might only detect the invalid hash after we're relied on the <code>predicates_of</code> result being unchanged</p>



<a name="237895047"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/unstable%20fingerprints%20-%20actually%20in%201.52%20%2384970/near/237895047" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Aaron Hill <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/unstable.20fingerprints.20-.20actually.20in.201.2E52.20.2384970.html#237895047">(May 07 2021 at 21:48)</a>:</h4>
<p>if we emit an error, that's not a problem</p>



<a name="237895054"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/unstable%20fingerprints%20-%20actually%20in%201.52%20%2384970/near/237895054" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Aaron Hill <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/unstable.20fingerprints.20-.20actually.20in.201.2E52.20.2384970.html#237895054">(May 07 2021 at 21:48)</a>:</h4>
<p>but it is if we try to recover</p>



<a name="237895075"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/unstable%20fingerprints%20-%20actually%20in%201.52%20%2384970/near/237895075" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pnkfelix <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/unstable.20fingerprints.20-.20actually.20in.201.2E52.20.2384970.html#237895075">(May 07 2021 at 21:49)</a>:</h4>
<p>recovery sounds pretty hard here</p>



<a name="237895084"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/unstable%20fingerprints%20-%20actually%20in%201.52%20%2384970/near/237895084" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pnkfelix <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/unstable.20fingerprints.20-.20actually.20in.201.2E52.20.2384970.html#237895084">(May 07 2021 at 21:49)</a>:</h4>
<p>and risky</p>



<a name="237895426"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/unstable%20fingerprints%20-%20actually%20in%201.52%20%2384970/near/237895426" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> cjgillot <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/unstable.20fingerprints.20-.20actually.20in.201.2E52.20.2384970.html#237895426">(May 07 2021 at 21:52)</a>:</h4>
<p>We <em>may</em> be able to recover if it is the first time the query is accessed: if the dep_node does not exist yet when we attempt to compute it.</p>



<a name="237895509"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/unstable%20fingerprints%20-%20actually%20in%201.52%20%2384970/near/237895509" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Aaron Hill <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/unstable.20fingerprints.20-.20actually.20in.201.2E52.20.2384970.html#237895509">(May 07 2021 at 21:53)</a>:</h4>
<p>I think it would be a better idea to try to get the underlying issues fixed, since It would probably be a bad idea to backport something of this complexity</p>



<a name="237895536"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/unstable%20fingerprints%20-%20actually%20in%201.52%20%2384970/near/237895536" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Aaron Hill <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/unstable.20fingerprints.20-.20actually.20in.201.2E52.20.2384970.html#237895536">(May 07 2021 at 21:53)</a>:</h4>
<p>I've made progress on narrowing down the <code>syn</code> crash in <a href="https://github.com/Aaron1011/syn-crash">https://github.com/Aaron1011/syn-crash</a></p>



<a name="237895547"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/unstable%20fingerprints%20-%20actually%20in%201.52%20%2384970/near/237895547" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Aaron Hill <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/unstable.20fingerprints.20-.20actually.20in.201.2E52.20.2384970.html#237895547">(May 07 2021 at 21:53)</a>:</h4>
<p>which AFAIK is the largest remaining issue with no fix</p>



<a name="237895626"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/unstable%20fingerprints%20-%20actually%20in%201.52%20%2384970/near/237895626" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Aaron Hill <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/unstable.20fingerprints.20-.20actually.20in.201.2E52.20.2384970.html#237895626">(May 07 2021 at 21:54)</a>:</h4>
<p>unfortunately, it appears to require multiple crates, and auto traits</p>



<a name="237895646"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/unstable%20fingerprints%20-%20actually%20in%201.52%20%2384970/near/237895646" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Aaron Hill <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/unstable.20fingerprints.20-.20actually.20in.201.2E52.20.2384970.html#237895646">(May 07 2021 at 21:54)</a>:</h4>
<p>so it's very sensitive to where things are defined (even if they're not used)</p>



<a name="237895670"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/unstable%20fingerprints%20-%20actually%20in%201.52%20%2384970/near/237895670" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Aaron Hill <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/unstable.20fingerprints.20-.20actually.20in.201.2E52.20.2384970.html#237895670">(May 07 2021 at 21:54)</a>:</h4>
<p>I'm trying to whittle it down in the point where I can build a standalone reproducer</p>



<a name="237895699"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/unstable%20fingerprints%20-%20actually%20in%201.52%20%2384970/near/237895699" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Aaron Hill <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/unstable.20fingerprints.20-.20actually.20in.201.2E52.20.2384970.html#237895699">(May 07 2021 at 21:54)</a>:</h4>
<p>and see if there's a better way to solve this other than my conductive cycle change</p>



<a name="237913448"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/unstable%20fingerprints%20-%20actually%20in%201.52%20%2384970/near/237913448" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Aaron Hill <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/unstable.20fingerprints.20-.20actually.20in.201.2E52.20.2384970.html#237913448">(May 08 2021 at 01:30)</a>:</h4>
<p>Ok, I've finally made a single-file reproduction: <a href="https://github.com/rust-lang/rust/issues/83538#issuecomment-834933534">https://github.com/rust-lang/rust/issues/83538#issuecomment-834933534</a></p>



<a name="237913466"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/unstable%20fingerprints%20-%20actually%20in%201.52%20%2384970/near/237913466" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Aaron Hill <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/unstable.20fingerprints.20-.20actually.20in.201.2E52.20.2384970.html#237913466">(May 08 2021 at 01:30)</a>:</h4>
<p>it could probably be reduced even further, but simple things like removing an unused type of method break it</p>



<a name="237913482"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/unstable%20fingerprints%20-%20actually%20in%201.52%20%2384970/near/237913482" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Aaron Hill <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/unstable.20fingerprints.20-.20actually.20in.201.2E52.20.2384970.html#237913482">(May 08 2021 at 01:30)</a>:</h4>
<p>this should be good enough to get a clean debug log</p>



<a name="237913659"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/unstable%20fingerprints%20-%20actually%20in%201.52%20%2384970/near/237913659" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> simulacrum <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/unstable.20fingerprints.20-.20actually.20in.201.2E52.20.2384970.html#237913659">(May 08 2021 at 01:33)</a>:</h4>
<p>hm, let me run it through some of the reducers I have on hand, should be easy for a single file</p>



<a name="237913776"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/unstable%20fingerprints%20-%20actually%20in%201.52%20%2384970/near/237913776" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Aaron Hill <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/unstable.20fingerprints.20-.20actually.20in.201.2E52.20.2384970.html#237913776">(May 08 2021 at 01:35)</a>:</h4>
<p>it's an incremental test, so that might be quite difficult</p>



<a name="237913797"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/unstable%20fingerprints%20-%20actually%20in%201.52%20%2384970/near/237913797" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> simulacrum <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/unstable.20fingerprints.20-.20actually.20in.201.2E52.20.2384970.html#237913797">(May 08 2021 at 01:35)</a>:</h4>
<p>well, they don't care if your reproducer is a script, I just need to alter it to work on a variable input</p>



<a name="237913806"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/unstable%20fingerprints%20-%20actually%20in%201.52%20%2384970/near/237913806" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Aaron Hill <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/unstable.20fingerprints.20-.20actually.20in.201.2E52.20.2384970.html#237913806">(May 08 2021 at 01:35)</a>:</h4>
<p>ah, I see</p>



<a name="237913811"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/unstable%20fingerprints%20-%20actually%20in%201.52%20%2384970/near/237913811" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Aaron Hill <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/unstable.20fingerprints.20-.20actually.20in.201.2E52.20.2384970.html#237913811">(May 08 2021 at 01:35)</a>:</h4>
<p>only tricky thing will be the line number</p>



<a name="237913815"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/unstable%20fingerprints%20-%20actually%20in%201.52%20%2384970/near/237913815" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> simulacrum <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/unstable.20fingerprints.20-.20actually.20in.201.2E52.20.2384970.html#237913815">(May 08 2021 at 01:35)</a>:</h4>
<p>i.e., the interstingness test needs to run on the modified input</p>



<a name="237913861"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/unstable%20fingerprints%20-%20actually%20in%201.52%20%2384970/near/237913861" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> simulacrum <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/unstable.20fingerprints.20-.20actually.20in.201.2E52.20.2384970.html#237913861">(May 08 2021 at 01:36)</a>:</h4>
<p>I think I can just feed a grep into it</p>



<a name="237913863"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/unstable%20fingerprints%20-%20actually%20in%201.52%20%2384970/near/237913863" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Aaron Hill <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/unstable.20fingerprints.20-.20actually.20in.201.2E52.20.2384970.html#237913863">(May 08 2021 at 01:36)</a>:</h4>
<p>The <code>run.sh</code> inserts a newline into the (copied) file at a specific line</p>



<a name="237913881"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/unstable%20fingerprints%20-%20actually%20in%201.52%20%2384970/near/237913881" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Aaron Hill <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/unstable.20fingerprints.20-.20actually.20in.201.2E52.20.2384970.html#237913881">(May 08 2021 at 01:36)</a>:</h4>
<p>and it's sensitive to that line (inserting it much earlier doesn't work)</p>



<a name="237913899"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/unstable%20fingerprints%20-%20actually%20in%201.52%20%2384970/near/237913899" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> simulacrum <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/unstable.20fingerprints.20-.20actually.20in.201.2E52.20.2384970.html#237913899">(May 08 2021 at 01:36)</a>:</h4>
<p>yeah, I plan to grep for the enum as you say</p>



<a name="237913900"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/unstable%20fingerprints%20-%20actually%20in%201.52%20%2384970/near/237913900" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> simulacrum <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/unstable.20fingerprints.20-.20actually.20in.201.2E52.20.2384970.html#237913900">(May 08 2021 at 01:36)</a>:</h4>
<p>hopefully that works OK</p>



<a name="237913904"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/unstable%20fingerprints%20-%20actually%20in%201.52%20%2384970/near/237913904" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Aaron Hill <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/unstable.20fingerprints.20-.20actually.20in.201.2E52.20.2384970.html#237913904">(May 08 2021 at 01:36)</a>:</h4>
<p>That should be fine</p>



<a name="237913919"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/unstable%20fingerprints%20-%20actually%20in%201.52%20%2384970/near/237913919" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Aaron Hill <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/unstable.20fingerprints.20-.20actually.20in.201.2E52.20.2384970.html#237913919">(May 08 2021 at 01:37)</a>:</h4>
<p>the important part is that the spans of things at the top of the file don't get invalidated</p>



<a name="237913920"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/unstable%20fingerprints%20-%20actually%20in%201.52%20%2384970/near/237913920" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Aaron Hill <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/unstable.20fingerprints.20-.20actually.20in.201.2E52.20.2384970.html#237913920">(May 08 2021 at 01:37)</a>:</h4>
<p>AFAICT</p>



<a name="237913992"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/unstable%20fingerprints%20-%20actually%20in%201.52%20%2384970/near/237913992" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> simulacrum <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/unstable.20fingerprints.20-.20actually.20in.201.2E52.20.2384970.html#237913992">(May 08 2021 at 01:38)</a>:</h4>
<p>hm ok</p>



<a name="237914015"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/unstable%20fingerprints%20-%20actually%20in%201.52%20%2384970/near/237914015" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Aaron Hill <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/unstable.20fingerprints.20-.20actually.20in.201.2E52.20.2384970.html#237914015">(May 08 2021 at 01:39)</a>:</h4>
<p>this issue is really irritating to reduce because of the dependence on conductive cycles</p>



<a name="237914019"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/unstable%20fingerprints%20-%20actually%20in%201.52%20%2384970/near/237914019" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Aaron Hill <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/unstable.20fingerprints.20-.20actually.20in.201.2E52.20.2384970.html#237914019">(May 08 2021 at 01:39)</a>:</h4>
<p>there are a lot of things that looks unused, but I couldn't manage to remove them</p>



<a name="237915149"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/unstable%20fingerprints%20-%20actually%20in%201.52%20%2384970/near/237915149" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> simulacrum <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/unstable.20fingerprints.20-.20actually.20in.201.2E52.20.2384970.html#237915149">(May 08 2021 at 01:58)</a>:</h4>
<div class="codehilite"><pre><span></span><code>struct a {
  b : Vec&lt;a&gt;
} pub struct c {
  d : Vec&lt;a&gt;
} struct e&lt;f&gt;{g : Vec&lt;f&gt;} impl&lt;f&gt; e&lt;f&gt; {
  fn h(self, i : f) {}
} fn l()-&gt;Ty {
  panic !()
}
enum Ty { j(k, m, n) } struct k { o : Vec&lt;Ty&gt; } struct m {
  bounds : a
} struct n {
  p : Box&lt;Ty&gt;
} pub fn q() {
  let r = e{g : Vec::new ()};
  r.h(l())
}
pub fn s(t : &amp;mut c) {}
</code></pre></div>



<a name="237915151"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/unstable%20fingerprints%20-%20actually%20in%201.52%20%2384970/near/237915151" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> simulacrum <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/unstable.20fingerprints.20-.20actually.20in.201.2E52.20.2384970.html#237915151">(May 08 2021 at 01:58)</a>:</h4>
<p>is this even better?</p>



<a name="237915161"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/unstable%20fingerprints%20-%20actually%20in%201.52%20%2384970/near/237915161" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> simulacrum <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/unstable.20fingerprints.20-.20actually.20in.201.2E52.20.2384970.html#237915161">(May 08 2021 at 01:59)</a>:</h4>
<p>(still inserting a blank line before enum Ty)</p>



<a name="237915241"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/unstable%20fingerprints%20-%20actually%20in%201.52%20%2384970/near/237915241" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> simulacrum <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/unstable.20fingerprints.20-.20actually.20in.201.2E52.20.2384970.html#237915241">(May 08 2021 at 02:00)</a>:</h4>
<p>still making progress though</p>



<a name="237915445"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/unstable%20fingerprints%20-%20actually%20in%201.52%20%2384970/near/237915445" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> simulacrum <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/unstable.20fingerprints.20-.20actually.20in.201.2E52.20.2384970.html#237915445">(May 08 2021 at 02:03)</a>:</h4>
<p>editing it in place</p>



<a name="237915635"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/unstable%20fingerprints%20-%20actually%20in%201.52%20%2384970/near/237915635" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> simulacrum <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/unstable.20fingerprints.20-.20actually.20in.201.2E52.20.2384970.html#237915635">(May 08 2021 at 02:06)</a>:</h4>
<p>alright creduce done, <span class="user-mention" data-user-id="125294">@Aaron Hill</span></p>



<a name="237915639"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/unstable%20fingerprints%20-%20actually%20in%201.52%20%2384970/near/237915639" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> simulacrum <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/unstable.20fingerprints.20-.20actually.20in.201.2E52.20.2384970.html#237915639">(May 08 2021 at 02:07)</a>:</h4>
<p>not sure that's helpful but it is a bit smaller</p>



<a name="237915649"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/unstable%20fingerprints%20-%20actually%20in%201.52%20%2384970/near/237915649" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Aaron Hill <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/unstable.20fingerprints.20-.20actually.20in.201.2E52.20.2384970.html#237915649">(May 08 2021 at 02:07)</a>:</h4>
<p>Were any types/methods removed?</p>



<a name="237915651"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/unstable%20fingerprints%20-%20actually%20in%201.52%20%2384970/near/237915651" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> simulacrum <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/unstable.20fingerprints.20-.20actually.20in.201.2E52.20.2384970.html#237915651">(May 08 2021 at 02:07)</a>:</h4>
<p>hmm</p>



<a name="237915677"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/unstable%20fingerprints%20-%20actually%20in%201.52%20%2384970/near/237915677" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> simulacrum <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/unstable.20fingerprints.20-.20actually.20in.201.2E52.20.2384970.html#237915677">(May 08 2021 at 02:08)</a>:</h4>
<p>yes</p>



<a name="237915707"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/unstable%20fingerprints%20-%20actually%20in%201.52%20%2384970/near/237915707" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Aaron Hill <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/unstable.20fingerprints.20-.20actually.20in.201.2E52.20.2384970.html#237915707">(May 08 2021 at 02:08)</a>:</h4>
<p>oh, and a trait was removed</p>



<a name="237915708"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/unstable%20fingerprints%20-%20actually%20in%201.52%20%2384970/near/237915708" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Aaron Hill <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/unstable.20fingerprints.20-.20actually.20in.201.2E52.20.2384970.html#237915708">(May 08 2021 at 02:08)</a>:</h4>
<p>nice</p>



<a name="237915743"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/unstable%20fingerprints%20-%20actually%20in%201.52%20%2384970/near/237915743" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> simulacrum <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/unstable.20fingerprints.20-.20actually.20in.201.2E52.20.2384970.html#237915743">(May 08 2021 at 02:08)</a>:</h4>
<p>I'll see if some manual shuffling can let it make more progress</p>



<a name="237915771"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/unstable%20fingerprints%20-%20actually%20in%201.52%20%2384970/near/237915771" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Aaron Hill <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/unstable.20fingerprints.20-.20actually.20in.201.2E52.20.2384970.html#237915771">(May 08 2021 at 02:09)</a>:</h4>
<p><span class="user-mention" data-user-id="116122">@simulacrum</span> I can't reproduce it with that minimization</p>



<a name="237915772"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/unstable%20fingerprints%20-%20actually%20in%201.52%20%2384970/near/237915772" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Aaron Hill <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/unstable.20fingerprints.20-.20actually.20in.201.2E52.20.2384970.html#237915772">(May 08 2021 at 02:09)</a>:</h4>
<p>where are you inserting the newline?</p>



<a name="237915778"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/unstable%20fingerprints%20-%20actually%20in%201.52%20%2384970/near/237915778" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> simulacrum <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/unstable.20fingerprints.20-.20actually.20in.201.2E52.20.2384970.html#237915778">(May 08 2021 at 02:09)</a>:</h4>
<p>right before enum Ty</p>



<a name="237915787"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/unstable%20fingerprints%20-%20actually%20in%201.52%20%2384970/near/237915787" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> simulacrum <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/unstable.20fingerprints.20-.20actually.20in.201.2E52.20.2384970.html#237915787">(May 08 2021 at 02:09)</a>:</h4>
<div class="codehilite"><pre><span></span><code>rm -rf my_incr
cp lib.rs temp_lib.rs
LINE=$(rg --line-number &#39;enum Ty&#39; temp_lib.rs | sed &#39;s@:.*@@&#39;)
rustc --crate-type lib -C opt-level=3 temp_lib.rs -C incremental=my_incr
LINE=$((LINE-1))
md5sum temp_lib.rs
sed -i &quot;$LINE i\\\\&quot; temp_lib.rs
md5sum temp_lib.rs
rustc --crate-type lib -C opt-level=3 temp_lib.rs -C incremental=my_incr
[ $? -eq 101 ]
</code></pre></div>



<a name="237915885"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/unstable%20fingerprints%20-%20actually%20in%201.52%20%2384970/near/237915885" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> simulacrum <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/unstable.20fingerprints.20-.20actually.20in.201.2E52.20.2384970.html#237915885">(May 08 2021 at 02:10)</a>:</h4>
<p>I can definitely reproduce I think, unless I got something wrong, with that script</p>



<a name="237915890"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/unstable%20fingerprints%20-%20actually%20in%201.52%20%2384970/near/237915890" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> simulacrum <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/unstable.20fingerprints.20-.20actually.20in.201.2E52.20.2384970.html#237915890">(May 08 2021 at 02:10)</a>:</h4>
<p><span class="user-mention" data-user-id="125294">@Aaron Hill</span> ^</p>



<a name="237915902"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/unstable%20fingerprints%20-%20actually%20in%201.52%20%2384970/near/237915902" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Aaron Hill <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/unstable.20fingerprints.20-.20actually.20in.201.2E52.20.2384970.html#237915902">(May 08 2021 at 02:10)</a>:</h4>
<p>huh - that's reproducing for me on nightly, but not on my local rustc</p>



<a name="237915913"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/unstable%20fingerprints%20-%20actually%20in%201.52%20%2384970/near/237915913" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> simulacrum <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/unstable.20fingerprints.20-.20actually.20in.201.2E52.20.2384970.html#237915913">(May 08 2021 at 02:10)</a>:</h4>
<p>oh</p>



<a name="237915914"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/unstable%20fingerprints%20-%20actually%20in%201.52%20%2384970/near/237915914" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Aaron Hill <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/unstable.20fingerprints.20-.20actually.20in.201.2E52.20.2384970.html#237915914">(May 08 2021 at 02:11)</a>:</h4>
<p>previously, it was reproducing on both</p>



<a name="237915915"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/unstable%20fingerprints%20-%20actually%20in%201.52%20%2384970/near/237915915" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> simulacrum <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/unstable.20fingerprints.20-.20actually.20in.201.2E52.20.2384970.html#237915915">(May 08 2021 at 02:11)</a>:</h4>
<p>I am using nightly</p>



<a name="237915921"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/unstable%20fingerprints%20-%20actually%20in%201.52%20%2384970/near/237915921" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> simulacrum <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/unstable.20fingerprints.20-.20actually.20in.201.2E52.20.2384970.html#237915921">(May 08 2021 at 02:11)</a>:</h4>
<p>I can try with master</p>



<a name="237915927"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/unstable%20fingerprints%20-%20actually%20in%201.52%20%2384970/near/237915927" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> simulacrum <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/unstable.20fingerprints.20-.20actually.20in.201.2E52.20.2384970.html#237915927">(May 08 2021 at 02:11)</a>:</h4>
<p>is master the thing?</p>



<a name="237915931"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/unstable%20fingerprints%20-%20actually%20in%201.52%20%2384970/near/237915931" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Aaron Hill <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/unstable.20fingerprints.20-.20actually.20in.201.2E52.20.2384970.html#237915931">(May 08 2021 at 02:11)</a>:</h4>
<p>hold on - let me retest</p>



<a name="237915941"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/unstable%20fingerprints%20-%20actually%20in%201.52%20%2384970/near/237915941" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Aaron Hill <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/unstable.20fingerprints.20-.20actually.20in.201.2E52.20.2384970.html#237915941">(May 08 2021 at 02:11)</a>:</h4>
<p>my rustc might have had a modification that affected it</p>



<a name="237915954"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/unstable%20fingerprints%20-%20actually%20in%201.52%20%2384970/near/237915954" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> simulacrum <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/unstable.20fingerprints.20-.20actually.20in.201.2E52.20.2384970.html#237915954">(May 08 2021 at 02:12)</a>:</h4>
<p>master build is pretty cheap (maybe 5 minutes) so I'll kick that off for now</p>



<a name="237916012"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/unstable%20fingerprints%20-%20actually%20in%201.52%20%2384970/near/237916012" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Aaron Hill <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/unstable.20fingerprints.20-.20actually.20in.201.2E52.20.2384970.html#237916012">(May 08 2021 at 02:12)</a>:</h4>
<p>ok, I can reproduce it on the latest nightly</p>



<a name="237916013"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/unstable%20fingerprints%20-%20actually%20in%201.52%20%2384970/near/237916013" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Aaron Hill <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/unstable.20fingerprints.20-.20actually.20in.201.2E52.20.2384970.html#237916013">(May 08 2021 at 02:12)</a>:</h4>
<p>I think it was just an issue with my local rustc</p>



<a name="237916017"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/unstable%20fingerprints%20-%20actually%20in%201.52%20%2384970/near/237916017" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Aaron Hill <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/unstable.20fingerprints.20-.20actually.20in.201.2E52.20.2384970.html#237916017">(May 08 2021 at 02:12)</a>:</h4>
<p>I was unconditionally printing some stuff out</p>



<a name="237916023"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/unstable%20fingerprints%20-%20actually%20in%201.52%20%2384970/near/237916023" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Aaron Hill <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/unstable.20fingerprints.20-.20actually.20in.201.2E52.20.2384970.html#237916023">(May 08 2021 at 02:12)</a>:</h4>
<p>which I think caused some queries to executed differently</p>



<a name="237916027"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/unstable%20fingerprints%20-%20actually%20in%201.52%20%2384970/near/237916027" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Aaron Hill <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/unstable.20fingerprints.20-.20actually.20in.201.2E52.20.2384970.html#237916027">(May 08 2021 at 02:12)</a>:</h4>
<p>since the <code>Debug</code> impl for <code>Ty</code> is really complicated</p>



<a name="237916356"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/unstable%20fingerprints%20-%20actually%20in%201.52%20%2384970/near/237916356" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> simulacrum <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/unstable.20fingerprints.20-.20actually.20in.201.2E52.20.2384970.html#237916356">(May 08 2021 at 02:19)</a>:</h4>
<p>making a bit more progress</p>



<a name="237916359"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/unstable%20fingerprints%20-%20actually%20in%201.52%20%2384970/near/237916359" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> simulacrum <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/unstable.20fingerprints.20-.20actually.20in.201.2E52.20.2384970.html#237916359">(May 08 2021 at 02:19)</a>:</h4>
<div class="codehilite"><pre><span></span><code>struct a {
  b : Vec&lt; a &gt;
} pub struct c {
  d : Vec&lt; a &gt;
} struct e&lt; f &gt; {
  g : Vec&lt; f &gt;
} enum Ty { j(k, m, n) } struct k {
  o : Vec&lt; Ty &gt;
} struct m {
  bounds : a
} struct n {
  p : Box&lt; Ty &gt;
} pub fn q() {
  e::&lt; Ty &gt;{g : Vec::new ()};
}
pub fn s(t : &amp;mut c) {}
</code></pre></div>



<a name="237916993"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/unstable%20fingerprints%20-%20actually%20in%201.52%20%2384970/near/237916993" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> simulacrum <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/unstable.20fingerprints.20-.20actually.20in.201.2E52.20.2384970.html#237916993">(May 08 2021 at 02:30)</a>:</h4>
<p>posted on the issue with latest, and I'm off</p>



<a name="237917430"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/unstable%20fingerprints%20-%20actually%20in%201.52%20%2384970/near/237917430" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Aaron Hill <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/unstable.20fingerprints.20-.20actually.20in.201.2E52.20.2384970.html#237917430">(May 08 2021 at 02:38)</a>:</h4>
<p>Thanks for your help!</p>



<a name="237917582"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/unstable%20fingerprints%20-%20actually%20in%201.52%20%2384970/near/237917582" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Aaron Hill <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/unstable.20fingerprints.20-.20actually.20in.201.2E52.20.2384970.html#237917582">(May 08 2021 at 02:41)</a>:</h4>
<p>Also, someone just encountered the <code>optimized_mir</code> issue without bootstrapping rustc: <a href="https://github.com/rust-lang/rust/issues/85064">https://github.com/rust-lang/rust/issues/85064</a></p>



<a name="237918466"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/unstable%20fingerprints%20-%20actually%20in%201.52%20%2384970/near/237918466" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> est31 <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/unstable.20fingerprints.20-.20actually.20in.201.2E52.20.2384970.html#237918466">(May 08 2021 at 02:57)</a>:</h4>
<p>could someone add <a href="https://github.com/rust-lang/rust/issues/83126">https://github.com/rust-lang/rust/issues/83126</a> to the list in <a href="https://github.com/rust-lang/rust/issues/84970#issuecomment-833180651">https://github.com/rust-lang/rust/issues/84970#issuecomment-833180651</a> ? It still needs a test.</p>



<a name="237919197"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/unstable%20fingerprints%20-%20actually%20in%201.52%20%2384970/near/237919197" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pnkfelix <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/unstable.20fingerprints.20-.20actually.20in.201.2E52.20.2384970.html#237919197">(May 08 2021 at 03:08)</a>:</h4>
<p><span class="user-mention silent" data-user-id="116122">simulacrum</span> <a href="#narrow/stream/131828-t-compiler/topic/unstable.20fingerprints.20-.20actually.20in.201.2E52/near/237884879">said</a>:</p>
<blockquote>
<p>I was rightfully told that that merging this tonight may look like we're hiding it, as it's a friday afternoon</p>
</blockquote>
<p>Can I push back on this assertion? I think its more important that we put this info in the hands of our users, rather than worry about optics.</p>



<a name="237919239"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/unstable%20fingerprints%20-%20actually%20in%201.52%20%2384970/near/237919239" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pnkfelix <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/unstable.20fingerprints.20-.20actually.20in.201.2E52.20.2384970.html#237919239">(May 08 2021 at 03:08)</a>:</h4>
<p>I guess <span class="user-mention" data-user-id="116122">@simulacrum</span> has gone to sleep. but I think I’d still rather see the post up during the weekend rather than wait until Monday.</p>



<a name="237919255"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/unstable%20fingerprints%20-%20actually%20in%201.52%20%2384970/near/237919255" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pnkfelix <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/unstable.20fingerprints.20-.20actually.20in.201.2E52.20.2384970.html#237919255">(May 08 2021 at 03:09)</a>:</h4>
<p>(I don’t know. Maybe the pinned issue is sufficient.)</p>



<a name="237919429"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/unstable%20fingerprints%20-%20actually%20in%201.52%20%2384970/near/237919429" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> simulacrum <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/unstable.20fingerprints.20-.20actually.20in.201.2E52.20.2384970.html#237919429">(May 08 2021 at 03:12)</a>:</h4>
<p>Yeah I'm not sure either</p>



<a name="237919434"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/unstable%20fingerprints%20-%20actually%20in%201.52%20%2384970/near/237919434" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> simulacrum <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/unstable.20fingerprints.20-.20actually.20in.201.2E52.20.2384970.html#237919434">(May 08 2021 at 03:12)</a>:</h4>
<p>I could go either way</p>



<a name="237919468"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/unstable%20fingerprints%20-%20actually%20in%201.52%20%2384970/near/237919468" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> simulacrum <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/unstable.20fingerprints.20-.20actually.20in.201.2E52.20.2384970.html#237919468">(May 08 2021 at 03:13)</a>:</h4>
<p>I think given the point release it'll not look like we're hiding it, so probably makes sense to issue it soon - not sure if Monday or tomorrow morning makes a huge difference</p>



<a name="237919535"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/unstable%20fingerprints%20-%20actually%20in%201.52%20%2384970/near/237919535" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> simulacrum <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/unstable.20fingerprints.20-.20actually.20in.201.2E52.20.2384970.html#237919535">(May 08 2021 at 03:14)</a>:</h4>
<p>But I do also sort of want to think some more on the recommendation we're giving</p>



<a name="237919556"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/unstable%20fingerprints%20-%20actually%20in%201.52%20%2384970/near/237919556" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pnkfelix <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/unstable.20fingerprints.20-.20actually.20in.201.2E52.20.2384970.html#237919556">(May 08 2021 at 03:14)</a>:</h4>
<p>Okay. I’m willing to wait if it means we end up being more certain about the recommendation we offer</p>



<a name="237919574"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/unstable%20fingerprints%20-%20actually%20in%201.52%20%2384970/near/237919574" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pnkfelix <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/unstable.20fingerprints.20-.20actually.20in.201.2E52.20.2384970.html#237919574">(May 08 2021 at 03:15)</a>:</h4>
<p>okay gotta hit sack now</p>



<a name="237962398"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/unstable%20fingerprints%20-%20actually%20in%201.52%20%2384970/near/237962398" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wesley Wiser <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/unstable.20fingerprints.20-.20actually.20in.201.2E52.20.2384970.html#237962398">(May 08 2021 at 15:08)</a>:</h4>
<p>I think we should strongly consider <span class="user-mention" data-user-id="116122">@simulacrum</span>'s suggestion to disable incremental compilation by default. The impression I have is that it is really easy to trigger this ICE so I think it's better to mitigate this to prevent the ICE than ask users to cargo clean frequently.</p>



<a name="237962412"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/unstable%20fingerprints%20-%20actually%20in%201.52%20%2384970/near/237962412" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wesley Wiser <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/unstable.20fingerprints.20-.20actually.20in.201.2E52.20.2384970.html#237962412">(May 08 2021 at 15:08)</a>:</h4>
<p>But perhaps I'm overestimating how frequently this occurs.</p>



<a name="237962450"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/unstable%20fingerprints%20-%20actually%20in%201.52%20%2384970/near/237962450" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> simulacrum <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/unstable.20fingerprints.20-.20actually.20in.201.2E52.20.2384970.html#237962450">(May 08 2021 at 15:09)</a>:</h4>
<p>We <em>have</em> received quite a few issues filed - and are still receiving, to some extent</p>



<a name="237962521"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/unstable%20fingerprints%20-%20actually%20in%201.52%20%2384970/near/237962521" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> simulacrum <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/unstable.20fingerprints.20-.20actually.20in.201.2E52.20.2384970.html#237962521">(May 08 2021 at 15:10)</a>:</h4>
<p>But it is hard to say. It's also true that I would not be surprised if come Monday, lots of folks update, if they don't want to update their toolchain on a friday/thursday (which would make sense to me)</p>



<a name="237962732"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/unstable%20fingerprints%20-%20actually%20in%201.52%20%2384970/near/237962732" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> simulacrum <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/unstable.20fingerprints.20-.20actually.20in.201.2E52.20.2384970.html#237962732">(May 08 2021 at 15:13)</a>:</h4>
<p>I guess we can adjust the blog post to ask for feedback on this matter, but people who don't hit bugs probably won't respond.</p>



<a name="237962824"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/unstable%20fingerprints%20-%20actually%20in%201.52%20%2384970/near/237962824" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> simulacrum <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/unstable.20fingerprints.20-.20actually.20in.201.2E52.20.2384970.html#237962824">(May 08 2021 at 15:15)</a>:</h4>
<p>It's also true, I think, that we've not even enabled full verification - verifying on-disk results is something that had too large a performance impact (see <a href="https://github.com/rust-lang/rust/pull/84227">https://github.com/rust-lang/rust/pull/84227</a>)</p>



<a name="237962864"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/unstable%20fingerprints%20-%20actually%20in%201.52%20%2384970/near/237962864" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> simulacrum <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/unstable.20fingerprints.20-.20actually.20in.201.2E52.20.2384970.html#237962864">(May 08 2021 at 15:15)</a>:</h4>
<p>This somewhat implies to me that we're going to discover 'yet more' bugs after fixing these, once/if we enable that.</p>



<a name="237962888"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/unstable%20fingerprints%20-%20actually%20in%201.52%20%2384970/near/237962888" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> simulacrum <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/unstable.20fingerprints.20-.20actually.20in.201.2E52.20.2384970.html#237962888">(May 08 2021 at 15:15)</a>:</h4>
<p>I do think it's going to be a hard sell to users to take that 2x performance hit :/</p>



<a name="237963263"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/unstable%20fingerprints%20-%20actually%20in%201.52%20%2384970/near/237963263" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Nelson <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/unstable.20fingerprints.20-.20actually.20in.201.2E52.20.2384970.html#237963263">(May 08 2021 at 15:21)</a>:</h4>
<p>Could we put verifying the disk hash behind a -Z flag and enable it for tests or something like that? Or only on some nightlies?</p>



<a name="237963332"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/unstable%20fingerprints%20-%20actually%20in%201.52%20%2384970/near/237963332" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> simulacrum <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/unstable.20fingerprints.20-.20actually.20in.201.2E52.20.2384970.html#237963332">(May 08 2021 at 15:22)</a>:</h4>
<p>We don't really have many incremental tests; I am not inclined to limit it to some channel - I think eventually we're going to want to enable it, at least for some time, and possibly forever. It's not actually that bad - only 5-10% iirc</p>



<a name="237964821"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/unstable%20fingerprints%20-%20actually%20in%201.52%20%2384970/near/237964821" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wesley Wiser <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/unstable.20fingerprints.20-.20actually.20in.201.2E52.20.2384970.html#237964821">(May 08 2021 at 15:43)</a>:</h4>
<p>That makes sense to me. Part of my reasoning here is that I think the performance regression from disabling incremental compilation is a less serious issue than hitting ICEs during regular development.</p>



<a name="237964950"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/unstable%20fingerprints%20-%20actually%20in%201.52%20%2384970/near/237964950" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> simulacrum <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/unstable.20fingerprints.20-.20actually.20in.201.2E52.20.2384970.html#237964950">(May 08 2021 at 15:45)</a>:</h4>
<p>Yeah. I think it really depends on the person, but it does seem reasonable to me. Ultimately I guess someone will need to make a decision -- sooner the better, I think, given we're aiming to publish a blog post on Monday (or sooner, but I think Monday is good). I think if we can put our decision there that would be to our benefit.</p>



<a name="237970380"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/unstable%20fingerprints%20-%20actually%20in%201.52%20%2384970/near/237970380" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Aaron Hill <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/unstable.20fingerprints.20-.20actually.20in.201.2E52.20.2384970.html#237970380">(May 08 2021 at 17:03)</a>:</h4>
<p>Note that I haven't tried to optimize the hash verification at all</p>



<a name="237970384"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/unstable%20fingerprints%20-%20actually%20in%201.52%20%2384970/near/237970384" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Aaron Hill <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/unstable.20fingerprints.20-.20actually.20in.201.2E52.20.2384970.html#237970384">(May 08 2021 at 17:04)</a>:</h4>
<p>so it's possible that there's some room for improvement on that slowdown</p>



<a name="237970443"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/unstable%20fingerprints%20-%20actually%20in%201.52%20%2384970/near/237970443" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Aaron Hill <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/unstable.20fingerprints.20-.20actually.20in.201.2E52.20.2384970.html#237970443">(May 08 2021 at 17:04)</a>:</h4>
<p><span class="user-mention silent" data-user-id="232545">Joshua Nelson</span> <a href="#narrow/stream/131828-t-compiler/topic/unstable.20fingerprints.20-.20actually.20in.201.2E52/near/237963263">said</a>:</p>
<blockquote>
<p>Could we put verifying the disk hash behind a -Z flag and enable it for tests or something like that? Or only on some nightlies?</p>
</blockquote>
<p>That's actually our current behavior</p>



<a name="237970470"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/unstable%20fingerprints%20-%20actually%20in%201.52%20%2384970/near/237970470" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Aaron Hill <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/unstable.20fingerprints.20-.20actually.20in.201.2E52.20.2384970.html#237970470">(May 08 2021 at 17:05)</a>:</h4>
<p><a href="https://github.com/rust-lang/rust/blob/ff34b919075f35a1787659e9c448a34b06bab8de/src/tools/compiletest/src/runtest.rs#L1965">https://github.com/rust-lang/rust/blob/ff34b919075f35a1787659e9c448a34b06bab8de/src/tools/compiletest/src/runtest.rs#L1965</a></p>



<a name="237972042"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/unstable%20fingerprints%20-%20actually%20in%201.52%20%2384970/near/237972042" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> simulacrum <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/unstable.20fingerprints.20-.20actually.20in.201.2E52.20.2384970.html#237972042">(May 08 2021 at 17:30)</a>:</h4>
<p>I had a new idea just now: after the first ICE, we write some value to the incremental cache to disable incremental. That way, developers will hit at most one ICE per project, roughly, and so it's much less annoying, but we still give users the performance they want if incremental isn't broken in their particular case. (cargo clean or a toolchain upgrade will wipe away the incremental cache, if they want to force it on, and perhaps we can add an env variable override)</p>



<a name="237976537"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/unstable%20fingerprints%20-%20actually%20in%201.52%20%2384970/near/237976537" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Carol (Nichols || Goulding) <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/unstable.20fingerprints.20-.20actually.20in.201.2E52.20.2384970.html#237976537">(May 08 2021 at 18:47)</a>:</h4>
<p>hey yinz, thank you for all your work on this &lt;3 and thank you for the blog post, i think it's going to be really important.</p>



<a name="237976719"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/unstable%20fingerprints%20-%20actually%20in%201.52%20%2384970/near/237976719" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Carol (Nichols || Goulding) <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/unstable.20fingerprints.20-.20actually.20in.201.2E52.20.2384970.html#237976719">(May 08 2021 at 18:50)</a>:</h4>
<p>please keep in mind that this is likely to have more visibility than your average compiler bug, that rust users with less experience are going to hit this and might need more help than fellow compiler devs (ex: <a href="https://github.com/rust-lang/rust/issues/85080">https://github.com/rust-lang/rust/issues/85080</a>), and that people who don't use rust are going to hear about this when the blog post gets posted to hacker news (maybe publish it like europe's monday morning, then do a social media push around 9am ET and 9am PT?)</p>



<a name="237976769"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/unstable%20fingerprints%20-%20actually%20in%201.52%20%2384970/near/237976769" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Carol (Nichols || Goulding) <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/unstable.20fingerprints.20-.20actually.20in.201.2E52.20.2384970.html#237976769">(May 08 2021 at 18:51)</a>:</h4>
<p>being out in front of information on this, looking proactive, etc will help imo</p>



<a name="237976946"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/unstable%20fingerprints%20-%20actually%20in%201.52%20%2384970/near/237976946" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> simulacrum <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/unstable.20fingerprints.20-.20actually.20in.201.2E52.20.2384970.html#237976946">(May 08 2021 at 18:54)</a>:</h4>
<p>So given the number of users - all users who upgrade? - who we expect to hit this, one option we <em>do</em> have, in principle, is to land a soft-disable (e.g., requiring a new env variable on-switch) into rustc for incremental as a whole, and try to get that out the door by monday morning. In theory, we have enough time. I don't know whether that makes sense, but it is something to consider I think, rather than waiting until - for example - Thursday next week.</p>



<a name="237977045"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/unstable%20fingerprints%20-%20actually%20in%201.52%20%2384970/near/237977045" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> simulacrum <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/unstable.20fingerprints.20-.20actually.20in.201.2E52.20.2384970.html#237977045">(May 08 2021 at 18:56)</a>:</h4>
<p>I think I'll try to get us artifacts for that, I think, so that the door is left open (we can of course not use them).</p>



<a name="237996519"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/unstable%20fingerprints%20-%20actually%20in%201.52%20%2384970/near/237996519" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> simulacrum <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/unstable.20fingerprints.20-.20actually.20in.201.2E52.20.2384970.html#237996519">(May 09 2021 at 00:51)</a>:</h4>
<p>Posted <a href="https://github.com/rust-lang/rust/pull/85097">https://github.com/rust-lang/rust/pull/85097</a> - I plan to r+ it soon, going to let PR CI run for a bit though. Not sure if it's what we'll go with but it'll give us some artifacts to use if we choose to.</p>
<p>I also am going to update Felix's blog post to be a release blog post, though with the majority of the text left in, slightly adjusted in the light of the recommended path being to upgrade to 1.52.1.</p>
<p><span class="user-mention" data-user-id="125294">@Aaron Hill</span> can you say if there are any fixes you feel comfortable backporting directly to stable at this time? My hunch is no, in which case we wouldn't backport, but if we have a few that should be harmless to backport (e.g., worst case they don't help, but cannot hurt), then it may be worth alleviating some of the pain users will feel who force-enable incremental.</p>



<a name="237997399"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/unstable%20fingerprints%20-%20actually%20in%201.52%20%2384970/near/237997399" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Aaron Hill <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/unstable.20fingerprints.20-.20actually.20in.201.2E52.20.2384970.html#237997399">(May 09 2021 at 01:07)</a>:</h4>
<p>From the issues I've seen, the most common issue is <code>predicates_of</code></p>



<a name="237997461"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/unstable%20fingerprints%20-%20actually%20in%201.52%20%2384970/near/237997461" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Aaron Hill <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/unstable.20fingerprints.20-.20actually.20in.201.2E52.20.2384970.html#237997461">(May 09 2021 at 01:08)</a>:</h4>
<p>which I <em>think</em> was fixed by <a href="https://github.com/rust-lang/rust/pull/84233">https://github.com/rust-lang/rust/pull/84233</a></p>



<a name="237997502"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/unstable%20fingerprints%20-%20actually%20in%201.52%20%2384970/near/237997502" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Aaron Hill <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/unstable.20fingerprints.20-.20actually.20in.201.2E52.20.2384970.html#237997502">(May 09 2021 at 01:08)</a>:</h4>
<p>I didn't write or review that PR, and I'd be pretty hesitant to backport it</p>



<a name="237997610"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/unstable%20fingerprints%20-%20actually%20in%201.52%20%2384970/near/237997610" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> simulacrum <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/unstable.20fingerprints.20-.20actually.20in.201.2E52.20.2384970.html#237997610">(May 09 2021 at 01:10)</a>:</h4>
<p>Hm, ok</p>



<a name="238024324"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/unstable%20fingerprints%20-%20actually%20in%201.52%20%2384970/near/238024324" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nagisa <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/unstable.20fingerprints.20-.20actually.20in.201.2E52.20.2384970.html#238024324">(May 09 2021 at 09:59)</a>:</h4>
<p>Here's an example of an issue that you can see due to incremental issues (this is on nightly): <code>cargo build</code> just works, <code>cargo check</code> fails with an error that shouldn't exist, and <code>cargo clean &amp;&amp; cargo check</code> made it go away. Was reported this by another person. What the issue looks like:</p>
<p><a href="/user_uploads/4715/cbkvKNeHFtJU70ZeVHJ6mlmu/image.png">image.png</a></p>
<div class="message_inline_image"><a href="/user_uploads/4715/cbkvKNeHFtJU70ZeVHJ6mlmu/image.png" title="image.png"><img src="/user_uploads/4715/cbkvKNeHFtJU70ZeVHJ6mlmu/image.png"></a></div>



<a name="238030403"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/unstable%20fingerprints%20-%20actually%20in%201.52%20%2384970/near/238030403" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> simulacrum <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/unstable.20fingerprints.20-.20actually.20in.201.2E52.20.2384970.html#238030403">(May 09 2021 at 11:45)</a>:</h4>
<p>Hm that seems a bit different in the sense that the bugs we're dealing with right now I think should all trigger assertions, that looks more like perhaps cargo's cache was broken?</p>



<a name="238031531"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/unstable%20fingerprints%20-%20actually%20in%201.52%20%2384970/near/238031531" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nagisa <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/unstable.20fingerprints.20-.20actually.20in.201.2E52.20.2384970.html#238031531">(May 09 2021 at 12:06)</a>:</h4>
<p>This does look incremental related to me. Ultimately my point was that not all such bugs appear to manifest as assertions (yet?)</p>



<a name="238031897"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/unstable%20fingerprints%20-%20actually%20in%201.52%20%2384970/near/238031897" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> simulacrum <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/unstable.20fingerprints.20-.20actually.20in.201.2E52.20.2384970.html#238031897">(May 09 2021 at 12:12)</a>:</h4>
<p>Cargo build there didn't even invoke the compiler, but cargo check did (unless that's cached output?). So incremental in rustc didn't differ between check and debug builds - or at least, we don't know that it did?</p>



<a name="238031919"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/unstable%20fingerprints%20-%20actually%20in%201.52%20%2384970/near/238031919" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> simulacrum <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/unstable.20fingerprints.20-.20actually.20in.201.2E52.20.2384970.html#238031919">(May 09 2021 at 12:13)</a>:</h4>
<p>We do have missing assertions on disk loaded data, though I think we should probably land them onto nightly</p>



<a name="238050381"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/unstable%20fingerprints%20-%20actually%20in%201.52%20%2384970/near/238050381" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Eric Huss <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/unstable.20fingerprints.20-.20actually.20in.201.2E52.20.2384970.html#238050381">(May 09 2021 at 17:52)</a>:</h4>
<p>I had a user report a similar issue (build works, but check does not, with <code>--all-targets</code>) here: <a href="https://github.com/rust-lang/cargo/issues/9349">https://github.com/rust-lang/cargo/issues/9349</a>.  I think it is a cargo issue, but it is very subtle and hard to debug via a github issue.  And, ugh, it's been two weeks since I last looked at it. <span aria-label="sad" class="emoji emoji-2639" role="img" title="sad">:sad:</span>  <span class="user-mention" data-user-id="123586">@nagisa</span>, if there is any way to get a repro of that, it would be very helpful.</p>



<a name="238050402"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/unstable%20fingerprints%20-%20actually%20in%201.52%20%2384970/near/238050402" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nagisa <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/unstable.20fingerprints.20-.20actually.20in.201.2E52.20.2384970.html#238050402">(May 09 2021 at 17:53)</a>:</h4>
<p>I can ask, but the comms channel I have is also just text.</p>



<a name="238068618"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/unstable%20fingerprints%20-%20actually%20in%201.52%20%2384970/near/238068618" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> simulacrum <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/unstable.20fingerprints.20-.20actually.20in.201.2E52.20.2384970.html#238068618">(May 09 2021 at 23:08)</a>:</h4>
<p>Hey all - just an update: I plan to ping tomorrow morning, but unless something comes up, I expect we will merge the blog post and ship a release approximately at <time datetime="2021-05-10T14:45:00Z">2021-05-10T10:45:00-04:00</time>. This means we will disable incr. comp by default for all stable users, though with an option to opt back in.</p>



<a name="238128901"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/unstable%20fingerprints%20-%20actually%20in%201.52%20%2384970/near/238128901" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> mw <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/unstable.20fingerprints.20-.20actually.20in.201.2E52.20.2384970.html#238128901">(May 10 2021 at 12:06)</a>:</h4>
<p>Regarding the ideas on recovering from the invalid state once it has been detected: I don't think that is feasible in a safe way, unfortunately. Parts of the compilation process would have to be re-run and it would be almost impossible to know which parts. And that still leaves room for cases where we simply cannot re-run the computation because it is not part of the query system.</p>



<a name="238130238"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/unstable%20fingerprints%20-%20actually%20in%201.52%20%2384970/near/238130238" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> simulacrum <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/unstable.20fingerprints.20-.20actually.20in.201.2E52.20.2384970.html#238130238">(May 10 2021 at 12:16)</a>:</h4>
<p>Yeah I think the "easier" recovery is to emit a message that tells cargo to rerun rustc silently or something, but it's not ideal either</p>



<a name="238131157"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/unstable%20fingerprints%20-%20actually%20in%201.52%20%2384970/near/238131157" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> cjgillot <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/unstable.20fingerprints.20-.20actually.20in.201.2E52.20.2384970.html#238131157">(May 10 2021 at 12:24)</a>:</h4>
<p>Even if recovery was possible (and I believe it is in a limited number of cases), I think such recovery would be an horrible idea because it would only make the query system even more complex just to hide bugs. I agree with <span class="user-mention silent" data-user-id="116122">simulacrum</span> that a warning is our best course of action.</p>



<a name="238135091"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/unstable%20fingerprints%20-%20actually%20in%201.52%20%2384970/near/238135091" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> bjorn3 <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/unstable.20fingerprints.20-.20actually.20in.201.2E52.20.2384970.html#238135091">(May 10 2021 at 12:52)</a>:</h4>
<p>The incremental system could forcefully delete the cache when an unstable fingerprint is found. That way re-running the build will magically fix the issue.</p>



<a name="238139060"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/unstable%20fingerprints%20-%20actually%20in%201.52%20%2384970/near/238139060" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> simulacrum <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/unstable.20fingerprints.20-.20actually.20in.201.2E52.20.2384970.html#238139060">(May 10 2021 at 13:11)</a>:</h4>
<p><span class="user-mention" data-user-id="116083">@pnkfelix</span> <span class="user-mention" data-user-id="125250">@Wesley Wiser</span> "last" chance to stop the train (well, actually in an hour, but ...) if we don't want to ship the PR I submitted over the weekend to stable.</p>
<ul>
<li>PR: <a href="https://github.com/rust-lang/rust/pull/85097">https://github.com/rust-lang/rust/pull/85097</a></li>
<li>Announcement blog post: <a href="https://github.com/rust-lang/blog.rust-lang.org/pull/836">https://github.com/rust-lang/blog.rust-lang.org/pull/836</a></li>
</ul>



<a name="238139730"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/unstable%20fingerprints%20-%20actually%20in%201.52%20%2384970/near/238139730" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pnkfelix <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/unstable.20fingerprints.20-.20actually.20in.201.2E52.20.2384970.html#238139730">(May 10 2021 at 13:16)</a>:</h4>
<p>Thanks <span class="user-mention" data-user-id="116122">@simulacrum</span> . I was skeptical about adding a whole new environment variable when I saw the discussion going on over the weekend, but I think my problems there are more about how hard it might be for some users to properly adjust their environment settings (and know that they are correctly adjusted). In terms of the trade-offs here, though, it seems like a reasonable course of action, especially since it should not be the status quo for terribly long, I hope.</p>



<a name="238140760"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/unstable%20fingerprints%20-%20actually%20in%201.52%20%2384970/near/238140760" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/unstable.20fingerprints.20-.20actually.20in.201.2E52.20.2384970.html#238140760">(May 10 2021 at 13:22)</a>:</h4>
<p>What's the current status, <span class="user-mention" data-user-id="116083">@pnkfelix</span> / <span class="user-mention" data-user-id="125250">@Wesley Wiser</span> ?</p>



<a name="238140766"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/unstable%20fingerprints%20-%20actually%20in%201.52%20%2384970/near/238140766" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pnkfelix <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/unstable.20fingerprints.20-.20actually.20in.201.2E52.20.2384970.html#238140766">(May 10 2021 at 13:22)</a>:</h4>
<p><span class="user-mention" data-user-id="116122">@simulacrum</span> what is the plan re incremental on beta (and nightly, I guess)?</p>



<a name="238140813"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/unstable%20fingerprints%20-%20actually%20in%201.52%20%2384970/near/238140813" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pnkfelix <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/unstable.20fingerprints.20-.20actually.20in.201.2E52.20.2384970.html#238140813">(May 10 2021 at 13:23)</a>:</h4>
<p><span class="user-mention" data-user-id="116009">@nikomatsakis</span> current status is that a blog post and a 1.52.1 point release are expected very soon.</p>



<a name="238140819"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/unstable%20fingerprints%20-%20actually%20in%201.52%20%2384970/near/238140819" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/unstable.20fingerprints.20-.20actually.20in.201.2E52.20.2384970.html#238140819">(May 10 2021 at 13:23)</a>:</h4>
<p>I'm wondering in particular if there are traits-related problems that I could be investigating this morning-- e.g., I've spent some time looking into the syn-crash problem that <span class="user-mention" data-user-id="125294">@Aaron Hill</span> mentioned, and i'm familiar with the super-predicates query.</p>



<a name="238140829"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/unstable%20fingerprints%20-%20actually%20in%201.52%20%2384970/near/238140829" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> simulacrum <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/unstable.20fingerprints.20-.20actually.20in.201.2E52.20.2384970.html#238140829">(May 10 2021 at 13:23)</a>:</h4>
<p>I updated the post with that recently, but my expectation is 'roughly do nothing'</p>



<a name="238140845"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/unstable%20fingerprints%20-%20actually%20in%201.52%20%2384970/near/238140845" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/unstable.20fingerprints.20-.20actually.20in.201.2E52.20.2384970.html#238140845">(May 10 2021 at 13:23)</a>:</h4>
<p>that's ok, I'm more worried about whether I can help to fix the underlying problems</p>



<a name="238140847"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/unstable%20fingerprints%20-%20actually%20in%201.52%20%2384970/near/238140847" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pnkfelix <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/unstable.20fingerprints.20-.20actually.20in.201.2E52.20.2384970.html#238140847">(May 10 2021 at 13:23)</a>:</h4>
<p>"very soon" as in: today, perhaps in an hour, it sounds like?</p>



<a name="238140897"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/unstable%20fingerprints%20-%20actually%20in%201.52%20%2384970/near/238140897" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pnkfelix <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/unstable.20fingerprints.20-.20actually.20in.201.2E52.20.2384970.html#238140897">(May 10 2021 at 13:24)</a>:</h4>
<p><span class="user-mention" data-user-id="116009">@nikomatsakis</span> ah you want to know status with respect to the set of bugs?</p>



<a name="238140950"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/unstable%20fingerprints%20-%20actually%20in%201.52%20%2384970/near/238140950" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> simulacrum <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/unstable.20fingerprints.20-.20actually.20in.201.2E52.20.2384970.html#238140950">(May 10 2021 at 13:24)</a>:</h4>
<p>yes, roughly kicking off release in ~20 minutes, and it should deploy alongside blog post in ~1.2 hours</p>



<a name="238140988"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/unstable%20fingerprints%20-%20actually%20in%201.52%20%2384970/near/238140988" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pnkfelix <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/unstable.20fingerprints.20-.20actually.20in.201.2E52.20.2384970.html#238140988">(May 10 2021 at 13:24)</a>:</h4>
<p>let me finish reading the blog post and PR before I attempt to answer that Q, <span class="user-mention" data-user-id="116009">@nikomatsakis</span> (Maybe someone else will do it in the meantime)</p>



<a name="238141000"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/unstable%20fingerprints%20-%20actually%20in%201.52%20%2384970/near/238141000" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> simulacrum <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/unstable.20fingerprints.20-.20actually.20in.201.2E52.20.2384970.html#238141000">(May 10 2021 at 13:24)</a>:</h4>
<p>I think <a href="https://github.com/rust-lang/rust/issues/84970#issuecomment-833180651">https://github.com/rust-lang/rust/issues/84970#issuecomment-833180651</a> is the list of current tracked bugs</p>



<a name="238141023"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/unstable%20fingerprints%20-%20actually%20in%201.52%20%2384970/near/238141023" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> simulacrum <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/unstable.20fingerprints.20-.20actually.20in.201.2E52.20.2384970.html#238141023">(May 10 2021 at 13:24)</a>:</h4>
<p>(well, there may be more. that's a partial list)</p>



<a name="238141060"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/unstable%20fingerprints%20-%20actually%20in%201.52%20%2384970/near/238141060" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> simulacrum <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/unstable.20fingerprints.20-.20actually.20in.201.2E52.20.2384970.html#238141060">(May 10 2021 at 13:25)</a>:</h4>
<p>I believe <span class="user-mention" data-user-id="125294">@Aaron Hill</span> wants to merge in the syn-crash fix that was proposed a while back - let me find the PR for you <span class="user-mention" data-user-id="116009">@nikomatsakis</span></p>



<a name="238141126"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/unstable%20fingerprints%20-%20actually%20in%201.52%20%2384970/near/238141126" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wesley Wiser <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/unstable.20fingerprints.20-.20actually.20in.201.2E52.20.2384970.html#238141126">(May 10 2021 at 13:25)</a>:</h4>
<p>I believe the deduplicated known set of issues is <a href="https://github.com/rust-lang/rust/issues/84970#issuecomment-833180651">https://github.com/rust-lang/rust/issues/84970#issuecomment-833180651</a></p>



<a name="238141304"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/unstable%20fingerprints%20-%20actually%20in%201.52%20%2384970/near/238141304" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> simulacrum <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/unstable.20fingerprints.20-.20actually.20in.201.2E52.20.2384970.html#238141304">(May 10 2021 at 13:26)</a>:</h4>
<p><span class="user-mention" data-user-id="116009">@nikomatsakis</span> <a href="https://github.com/rust-lang/rust/issues/83538#issuecomment-835505371">https://github.com/rust-lang/rust/issues/83538#issuecomment-835505371</a></p>



<a name="238141319"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/unstable%20fingerprints%20-%20actually%20in%201.52%20%2384970/near/238141319" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> simulacrum <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/unstable.20fingerprints.20-.20actually.20in.201.2E52.20.2384970.html#238141319">(May 10 2021 at 13:26)</a>:</h4>
<p>that's the latest on the syn bug, likely could use your attention</p>



<a name="238141574"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/unstable%20fingerprints%20-%20actually%20in%201.52%20%2384970/near/238141574" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pnkfelix <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/unstable.20fingerprints.20-.20actually.20in.201.2E52.20.2384970.html#238141574">(May 10 2021 at 13:28)</a>:</h4>
<p>one interesting aspect of this whole affair: I don't know how much we can infer from the number of bugs reports we got against stable, but it seems pretty fair to infer that we don't have very many people on the beta branch.</p>



<a name="238141621"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/unstable%20fingerprints%20-%20actually%20in%201.52%20%2384970/near/238141621" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> simulacrum <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/unstable.20fingerprints.20-.20actually.20in.201.2E52.20.2384970.html#238141621">(May 10 2021 at 13:29)</a>:</h4>
<p>it definitely I think is true that we don't have many people using it <em>locally</em>, which is really what you need for incremental</p>



<a name="238141662"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/unstable%20fingerprints%20-%20actually%20in%201.52%20%2384970/near/238141662" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pnkfelix <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/unstable.20fingerprints.20-.20actually.20in.201.2E52.20.2384970.html#238141662">(May 10 2021 at 13:29)</a>:</h4>
<p>right</p>



<a name="238141665"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/unstable%20fingerprints%20-%20actually%20in%201.52%20%2384970/near/238141665" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> simulacrum <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/unstable.20fingerprints.20-.20actually.20in.201.2E52.20.2384970.html#238141665">(May 10 2021 at 13:29)</a>:</h4>
<p>(as opposed to in CI)</p>



<a name="238141700"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/unstable%20fingerprints%20-%20actually%20in%201.52%20%2384970/near/238141700" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pnkfelix <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/unstable.20fingerprints.20-.20actually.20in.201.2E52.20.2384970.html#238141700">(May 10 2021 at 13:29)</a>:</h4>
<p>do CI's tend to never use incremental?</p>



<a name="238141771"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/unstable%20fingerprints%20-%20actually%20in%201.52%20%2384970/near/238141771" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/unstable.20fingerprints.20-.20actually.20in.201.2E52.20.2384970.html#238141771">(May 10 2021 at 13:30)</a>:</h4>
<p><span class="user-mention silent" data-user-id="116122">simulacrum</span> <a href="#narrow/stream/131828-t-compiler/topic/unstable.20fingerprints.20-.20actually.20in.201.2E52/near/238141304">said</a>:</p>
<blockquote>
<p><span class="user-mention silent" data-user-id="116009">nikomatsakis</span> <a href="https://github.com/rust-lang/rust/issues/83538#issuecomment-835505371">https://github.com/rust-lang/rust/issues/83538#issuecomment-835505371</a></p>
</blockquote>
<p>yes, I don't like that fix :)</p>



<a name="238141775"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/unstable%20fingerprints%20-%20actually%20in%201.52%20%2384970/near/238141775" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> simulacrum <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/unstable.20fingerprints.20-.20actually.20in.201.2E52.20.2384970.html#238141775">(May 10 2021 at 13:30)</a>:</h4>
<p>well, not cached, I think</p>



<a name="238141794"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/unstable%20fingerprints%20-%20actually%20in%201.52%20%2384970/near/238141794" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/unstable.20fingerprints.20-.20actually.20in.201.2E52.20.2384970.html#238141794">(May 10 2021 at 13:30)</a>:</h4>
<p>at least, I don't think I do</p>



<a name="238141840"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/unstable%20fingerprints%20-%20actually%20in%201.52%20%2384970/near/238141840" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> simulacrum <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/unstable.20fingerprints.20-.20actually.20in.201.2E52.20.2384970.html#238141840">(May 10 2021 at 13:30)</a>:</h4>
<p>let's kickoff a thread perhaps for that specific fix?</p>



<a name="238141842"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/unstable%20fingerprints%20-%20actually%20in%201.52%20%2384970/near/238141842" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/unstable.20fingerprints.20-.20actually.20in.201.2E52.20.2384970.html#238141842">(May 10 2021 at 13:30)</a>:</h4>
<p>I'll dig into it more</p>



<a name="238141857"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/unstable%20fingerprints%20-%20actually%20in%201.52%20%2384970/near/238141857" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wesley Wiser <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/unstable.20fingerprints.20-.20actually.20in.201.2E52.20.2384970.html#238141857">(May 10 2021 at 13:30)</a>:</h4>
<p>"Best practice" for many CI systems is to start from a clean state.</p>



<a name="238141861"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/unstable%20fingerprints%20-%20actually%20in%201.52%20%2384970/near/238141861" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/unstable.20fingerprints.20-.20actually.20in.201.2E52.20.2384970.html#238141861">(May 10 2021 at 13:30)</a>:</h4>
<p>there's already a thread in <a class="stream" data-stream-id="144729" href="/#narrow/stream/144729-wg-traits">#wg-traits</a></p>



<a name="238141863"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/unstable%20fingerprints%20-%20actually%20in%201.52%20%2384970/near/238141863" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> simulacrum <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/unstable.20fingerprints.20-.20actually.20in.201.2E52.20.2384970.html#238141863">(May 10 2021 at 13:30)</a>:</h4>
<p>(if you want to discuss it)</p>



<a name="238142233"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/unstable%20fingerprints%20-%20actually%20in%201.52%20%2384970/near/238142233" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pnkfelix <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/unstable.20fingerprints.20-.20actually.20in.201.2E52.20.2384970.html#238142233">(May 10 2021 at 13:33)</a>:</h4>
<p><span class="user-mention silent" data-user-id="125250">Wesley Wiser</span> <a href="#narrow/stream/131828-t-compiler/topic/unstable.20fingerprints.20-.20actually.20in.201.2E52/near/238141857">said</a>:</p>
<blockquote>
<p>"Best practice" for many CI systems is to start from a clean state.</p>
</blockquote>
<p>Yeah, I guess I just was musing about whether one might supply separate CI for both a clean slate and incremental build in some contexts, if only to try to make the CI replicate the "typical developer experience"</p>



<a name="238143089"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/unstable%20fingerprints%20-%20actually%20in%201.52%20%2384970/near/238143089" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pnkfelix <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/unstable.20fingerprints.20-.20actually.20in.201.2E52.20.2384970.html#238143089">(May 10 2021 at 13:38)</a>:</h4>
<p><span class="user-mention" data-user-id="116122">@simulacrum</span> Am I correct in my inference that the PR adding <code>RUSTC_FORCE_INCREMENTAL</code> does not have any tests that when it is absent, incremental is disabled?</p>



<a name="238143174"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/unstable%20fingerprints%20-%20actually%20in%201.52%20%2384970/near/238143174" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> simulacrum <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/unstable.20fingerprints.20-.20actually.20in.201.2E52.20.2384970.html#238143174">(May 10 2021 at 13:38)</a>:</h4>
<p>That's correct. I didn't have a chance to do so, however, I know it works because CI repeatedly failed (on incremental tests) before I set it in the right places.</p>



<a name="238143182"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/unstable%20fingerprints%20-%20actually%20in%201.52%20%2384970/near/238143182" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pnkfelix <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/unstable.20fingerprints.20-.20actually.20in.201.2E52.20.2384970.html#238143182">(May 10 2021 at 13:38)</a>:</h4>
<p>(if this only lives in the 1.52.1+ release series, that is fine. If we end up having the env var in 1.53, we should add tests.)</p>



<a name="238143290"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/unstable%20fingerprints%20-%20actually%20in%201.52%20%2384970/near/238143290" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> simulacrum <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/unstable.20fingerprints.20-.20actually.20in.201.2E52.20.2384970.html#238143290">(May 10 2021 at 13:39)</a>:</h4>
<p>It's my goal to prepare a similar but more complete patch for 1.53 and nightly, with a 'if false' or something, so we can easily enable it as needed in the future without messing with tests and such.</p>



<a name="238143308"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/unstable%20fingerprints%20-%20actually%20in%201.52%20%2384970/near/238143308" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> simulacrum <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/unstable.20fingerprints.20-.20actually.20in.201.2E52.20.2384970.html#238143308">(May 10 2021 at 13:39)</a>:</h4>
<p>(just did not have time over the weekend)</p>



<a name="238143398"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/unstable%20fingerprints%20-%20actually%20in%201.52%20%2384970/near/238143398" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pnkfelix <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/unstable.20fingerprints.20-.20actually.20in.201.2E52.20.2384970.html#238143398">(May 10 2021 at 13:40)</a>:</h4>
<p>okay</p>



<a name="238143599"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/unstable%20fingerprints%20-%20actually%20in%201.52%20%2384970/near/238143599" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pnkfelix <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/unstable.20fingerprints.20-.20actually.20in.201.2E52.20.2384970.html#238143599">(May 10 2021 at 13:41)</a>:</h4>
<p><span class="user-mention silent" data-user-id="116122">simulacrum</span> <a href="#narrow/stream/131828-t-compiler/topic/unstable.20fingerprints.20-.20actually.20in.201.2E52/near/238139060">said</a>:</p>
<blockquote>
<p><span class="user-mention silent" data-user-id="116083">pnkfelix</span> <span class="user-mention silent" data-user-id="125250">Wesley Wiser</span> "last" chance to stop the train (well, actually in an hour, but ...) if we don't want to ship the PR I submitted over the weekend to stable.</p>
<ul>
<li>PR: <a href="https://github.com/rust-lang/rust/pull/85097">https://github.com/rust-lang/rust/pull/85097</a></li>
<li>Announcement blog post: <a href="https://github.com/rust-lang/blog.rust-lang.org/pull/836">https://github.com/rust-lang/blog.rust-lang.org/pull/836</a></li>
</ul>
</blockquote>
<p>finished, looks great apart from previously-posted-nits on blog post. Thanks for putting in so much time on this over the weekend <span class="user-mention" data-user-id="116122">@simulacrum</span></p>



<a name="238144397"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/unstable%20fingerprints%20-%20actually%20in%201.52%20%2384970/near/238144397" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wesley Wiser <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/unstable.20fingerprints.20-.20actually.20in.201.2E52.20.2384970.html#238144397">(May 10 2021 at 13:46)</a>:</h4>
<p>+1 from me. Thanks so much <span class="user-mention" data-user-id="116122">@simulacrum</span>!</p>



<a name="238144467"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/unstable%20fingerprints%20-%20actually%20in%201.52%20%2384970/near/238144467" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wesley Wiser <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/unstable.20fingerprints.20-.20actually.20in.201.2E52.20.2384970.html#238144467">(May 10 2021 at 13:47)</a>:</h4>
<p>I'm going to work on deduplicating the open issues.</p>



<a name="238155833"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/unstable%20fingerprints%20-%20actually%20in%201.52%20%2384970/near/238155833" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> simulacrum <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/unstable.20fingerprints.20-.20actually.20in.201.2E52.20.2384970.html#238155833">(May 10 2021 at 14:55)</a>:</h4>
<p><a href="https://blog.rust-lang.org/2021/05/10/Rust-1.52.1.html">https://blog.rust-lang.org/2021/05/10/Rust-1.52.1.html</a></p>



<a name="238155866"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/unstable%20fingerprints%20-%20actually%20in%201.52%20%2384970/near/238155866" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> simulacrum <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/unstable.20fingerprints.20-.20actually.20in.201.2E52.20.2384970.html#238155866">(May 10 2021 at 14:55)</a>:</h4>
<p><span class="user-mention" data-user-id="125250">@Wesley Wiser</span> might make sense to link to the blog post especially now that it's live in the new-user triage reports especially</p>



<a name="238155954"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/unstable%20fingerprints%20-%20actually%20in%201.52%20%2384970/near/238155954" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wesley Wiser <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/unstable.20fingerprints.20-.20actually.20in.201.2E52.20.2384970.html#238155954">(May 10 2021 at 14:56)</a>:</h4>
<p><span class="user-mention" data-user-id="116122">@simulacrum</span> Will do <span aria-label="thumbs up" class="emoji emoji-1f44d" role="img" title="thumbs up">:thumbs_up:</span></p>



<a name="238166068"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/unstable%20fingerprints%20-%20actually%20in%201.52%20%2384970/near/238166068" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Josh Triplett <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/unstable.20fingerprints.20-.20actually.20in.201.2E52.20.2384970.html#238166068">(May 10 2021 at 15:56)</a>:</h4>
<blockquote>
<p>Essentially, for some crates, certain sequences of edit-compile cycles will cause rustc to hit the "unstable fingerprints" ICE. I showed one example at the start of this blog post.</p>
</blockquote>
<p>The blog post gives examples of the ICE, but as far as I can tell, no examples of the edit-compile cycles that will trigger the ICE. When I read the above text I went back to the start of the blog post to see if I had missed an example.</p>



<a name="238166446"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/unstable%20fingerprints%20-%20actually%20in%201.52%20%2384970/near/238166446" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> simulacrum <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/unstable.20fingerprints.20-.20actually.20in.201.2E52.20.2384970.html#238166446">(May 10 2021 at 15:58)</a>:</h4>
<p>Hm, it may have gotten removed in the editing process; I'm not sure we should feature such an example. They can be pretty opaque - e.g., <a href="https://github.com/rust-lang/rust/issues/83538#issuecomment-834980979">https://github.com/rust-lang/rust/issues/83538#issuecomment-834980979</a> is a pretty minimal program that fires the assert by adding a blank line (no need for actual code changes)</p>



<a name="238166480"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/unstable%20fingerprints%20-%20actually%20in%201.52%20%2384970/near/238166480" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> simulacrum <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/unstable.20fingerprints.20-.20actually.20in.201.2E52.20.2384970.html#238166480">(May 10 2021 at 15:58)</a>:</h4>
<p>Happy to accept a PR dropping that sentence from the post.</p>



<a name="238166552"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/unstable%20fingerprints%20-%20actually%20in%201.52%20%2384970/near/238166552" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Josh Triplett <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/unstable.20fingerprints.20-.20actually.20in.201.2E52.20.2384970.html#238166552">(May 10 2021 at 15:58)</a>:</h4>
<p>I don't think the example needs to be inline in the post, but it would be nice to link to a simple example like that one.</p>



<a name="238166687"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/unstable%20fingerprints%20-%20actually%20in%201.52%20%2384970/near/238166687" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Josh Triplett <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/unstable.20fingerprints.20-.20actually.20in.201.2E52.20.2384970.html#238166687">(May 10 2021 at 15:59)</a>:</h4>
<p>(There's a link much later in the blog post to a large example involving rust-analyzer, but a simple example like that would be even better.)</p>



<a name="238166822"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/unstable%20fingerprints%20-%20actually%20in%201.52%20%2384970/near/238166822" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Josh Triplett <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/unstable.20fingerprints.20-.20actually.20in.201.2E52.20.2384970.html#238166822">(May 10 2021 at 16:00)</a>:</h4>
<p>If there is an example that simple that involves actual miscompilation rather than just the assertion failure, that would be even better.</p>



<a name="238166851"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/unstable%20fingerprints%20-%20actually%20in%201.52%20%2384970/near/238166851" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> simulacrum <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/unstable.20fingerprints.20-.20actually.20in.201.2E52.20.2384970.html#238166851">(May 10 2021 at 16:00)</a>:</h4>
<p>Sure. The rust-analyzer example is the only well-known miscompilation</p>



<a name="238166923"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/unstable%20fingerprints%20-%20actually%20in%201.52%20%2384970/near/238166923" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> simulacrum <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/unstable.20fingerprints.20-.20actually.20in.201.2E52.20.2384970.html#238166923">(May 10 2021 at 16:01)</a>:</h4>
<p>I don't think we have very minimal examples</p>



<a name="238166978"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/unstable%20fingerprints%20-%20actually%20in%201.52%20%2384970/near/238166978" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Josh Triplett <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/unstable.20fingerprints.20-.20actually.20in.201.2E52.20.2384970.html#238166978">(May 10 2021 at 16:01)</a>:</h4>
<p>Ah, got it. So there are minimal examples of the assertion failure, but not of the miscompilation?</p>



<a name="238167048"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/unstable%20fingerprints%20-%20actually%20in%201.52%20%2384970/near/238167048" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> simulacrum <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/unstable.20fingerprints.20-.20actually.20in.201.2E52.20.2384970.html#238167048">(May 10 2021 at 16:01)</a>:</h4>
<p>I think that's true</p>



<a name="238167119"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/unstable%20fingerprints%20-%20actually%20in%201.52%20%2384970/near/238167119" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wesley Wiser <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/unstable.20fingerprints.20-.20actually.20in.201.2E52.20.2384970.html#238167119">(May 10 2021 at 16:02)</a>:</h4>
<p>I've finished closing the duplicates I was sure about. There are some still in the issue list that are probably duplicates but I wasn't sure so I left them open. </p>
<p>I think it might be useful to have a comment summarizing the list of known issues. Does it make sense to leave that in <a href="https://github.com/rust-lang/rust/issues/84970">#84970</a> or should I put it somewhere else?</p>



<a name="238167201"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/unstable%20fingerprints%20-%20actually%20in%201.52%20%2384970/near/238167201" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> simulacrum <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/unstable.20fingerprints.20-.20actually.20in.201.2E52.20.2384970.html#238167201">(May 10 2021 at 16:02)</a>:</h4>
<p>I think <a href="https://github.com/rust-lang/rust/issues/84970">#84970</a> is a good place.</p>



<a name="238167584"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/unstable%20fingerprints%20-%20actually%20in%201.52%20%2384970/near/238167584" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jonas Schievink  [he/him] <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/unstable.20fingerprints.20-.20actually.20in.201.2E52.20.2384970.html#238167584">(May 10 2021 at 16:04)</a>:</h4>
<p><span class="user-mention silent" data-user-id="239881">Josh Triplett</span> <a href="#narrow/stream/131828-t-compiler/topic/unstable.20fingerprints.20-.20actually.20in.201.2E52/near/238166978">said</a>:</p>
<blockquote>
<p>Ah, got it. So there are minimal examples of the assertion failure, but not of the miscompilation?</p>
</blockquote>
<p>The miscompilation was reduced to this test: <a href="https://github.com/Aaron1011/rust/blob/18f89790dacad42d11f7fbd5d9cb09ce5dd8ff2f/src/test/incremental/issue-82920-predicate-order-miscompile.rs">https://github.com/Aaron1011/rust/blob/18f89790dacad42d11f7fbd5d9cb09ce5dd8ff2f/src/test/incremental/issue-82920-predicate-order-miscompile.rs</a></p>



<a name="238167667"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/unstable%20fingerprints%20-%20actually%20in%201.52%20%2384970/near/238167667" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> simulacrum <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/unstable.20fingerprints.20-.20actually.20in.201.2E52.20.2384970.html#238167667">(May 10 2021 at 16:05)</a>:</h4>
<p><span class="user-mention" data-user-id="239881">@Josh Triplett</span> ^</p>



<a name="238167702"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/unstable%20fingerprints%20-%20actually%20in%201.52%20%2384970/near/238167702" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> simulacrum <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/unstable.20fingerprints.20-.20actually.20in.201.2E52.20.2384970.html#238167702">(May 10 2021 at 16:05)</a>:</h4>
<p>I'd be happy to take a PR to the blog post, either integrating that or otherwise adjusting that.</p>



<a name="238170761"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/unstable%20fingerprints%20-%20actually%20in%201.52%20%2384970/near/238170761" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wesley Wiser <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/unstable.20fingerprints.20-.20actually.20in.201.2E52.20.2384970.html#238170761">(May 10 2021 at 16:23)</a>:</h4>
<p>Left a comment summarizing the current state of the queue: <a href="https://github.com/rust-lang/rust/issues/84970#issuecomment-836916981">https://github.com/rust-lang/rust/issues/84970#issuecomment-836916981</a></p>



<a name="238171476"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/unstable%20fingerprints%20-%20actually%20in%201.52%20%2384970/near/238171476" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> lqd <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/unstable.20fingerprints.20-.20actually.20in.201.2E52.20.2384970.html#238171476">(May 10 2021 at 16:28)</a>:</h4>
<p><span class="user-mention" data-user-id="125250">@Wesley Wiser</span>  <code>item_children</code> should already be fixed by <a href="https://github.com/rust-lang/rust/issues/83901">#83901</a></p>



<a name="238172004"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/unstable%20fingerprints%20-%20actually%20in%201.52%20%2384970/near/238172004" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wesley Wiser <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/unstable.20fingerprints.20-.20actually.20in.201.2E52.20.2384970.html#238172004">(May 10 2021 at 16:32)</a>:</h4>
<p><span class="user-mention" data-user-id="116113">@lqd</span> Thanks!</p>



<a name="238172106"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/unstable%20fingerprints%20-%20actually%20in%201.52%20%2384970/near/238172106" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> lqd <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/unstable.20fingerprints.20-.20actually.20in.201.2E52.20.2384970.html#238172106">(May 10 2021 at 16:32)</a>:</h4>
<p>and I believe at least some of the last <code>evaluate_obligation</code> item by <a href="https://github.com/rust-lang/rust/issues/83220">#83220</a> (but may be <a href="https://github.com/rust-lang/rust/issues/83538">#83538</a> in disguise)</p>



<a name="238172355"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/unstable%20fingerprints%20-%20actually%20in%201.52%20%2384970/near/238172355" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wesley Wiser <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/unstable.20fingerprints.20-.20actually.20in.201.2E52.20.2384970.html#238172355">(May 10 2021 at 16:34)</a>:</h4>
<p>I was not sure if the <code>evaluate_obligation</code> issues were all the same root cause or if they represented distinct issues so I mostly left them alone.</p>



<a name="238210932"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/unstable%20fingerprints%20-%20actually%20in%201.52%20%2384970/near/238210932" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Carol (Nichols || Goulding) <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/unstable.20fingerprints.20-.20actually.20in.201.2E52.20.2384970.html#238210932">(May 10 2021 at 20:58)</a>:</h4>
<p>If one datapoint is worth anything, I have been running 1.53.0-beta.2 with incremental all day and i have not encountered any ICEs <span aria-label="+1" class="emoji emoji-1f44d" role="img" title="+1">:+1:</span><span aria-label="+1" class="emoji emoji-1f44d" role="img" title="+1">:+1:</span><span aria-label="+1" class="emoji emoji-1f44d" role="img" title="+1">:+1:</span><span aria-label="+1" class="emoji emoji-1f44d" role="img" title="+1">:+1:</span><span aria-label="+1" class="emoji emoji-1f44d" role="img" title="+1">:+1:</span></p>



<a name="238211388"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/unstable%20fingerprints%20-%20actually%20in%201.52%20%2384970/near/238211388" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> simulacrum <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/unstable.20fingerprints.20-.20actually.20in.201.2E52.20.2384970.html#238211388">(May 10 2021 at 21:01)</a>:</h4>
<p><span class="user-mention" data-user-id="257516">@Carol (Nichols || Goulding)</span> just to check, 1.52.0 <em>did</em> lead to a large amount of ICEs for you?</p>



<a name="238211447"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/unstable%20fingerprints%20-%20actually%20in%201.52%20%2384970/near/238211447" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> simulacrum <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/unstable.20fingerprints.20-.20actually.20in.201.2E52.20.2384970.html#238211447">(May 10 2021 at 21:02)</a>:</h4>
<p>if so, that sounds promising for 1.53.0 having incremental no longer disabled by default</p>



<a name="238212118"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/unstable%20fingerprints%20-%20actually%20in%201.52%20%2384970/near/238212118" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Carol (Nichols || Goulding) <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/unstable.20fingerprints.20-.20actually.20in.201.2E52.20.2384970.html#238212118">(May 10 2021 at 21:06)</a>:</h4>
<p><span class="user-mention" data-user-id="116122">@simulacrum</span> yes it did</p>



<a name="238300971"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/unstable%20fingerprints%20-%20actually%20in%201.52%20%2384970/near/238300971" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> simulacrum <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/unstable.20fingerprints.20-.20actually.20in.201.2E52.20.2384970.html#238300971">(May 11 2021 at 12:51)</a>:</h4>
<p>I think it may be worth considering asking on users or internals for folks to test beta 1.53 and if their experience is also relatively ICE-free, consider a backport of <a href="https://github.com/rust-lang/rust/pull/84233">https://github.com/rust-lang/rust/pull/84233</a> as a 1.52.2 release which re-enables incremental. Ideally we'd couple that with a "poisoning" that would mean it only gets disabled if we see the assert at least once, so users have the option to report a bug but otherwise have a minimal disruption. I think the alternative is to wait until 1.53, but that's a pretty long way off - a more immediate but partial fix might be warranted.</p>



<a name="238348903"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/unstable%20fingerprints%20-%20actually%20in%201.52%20%2384970/near/238348903" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> cuviper <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/unstable.20fingerprints.20-.20actually.20in.201.2E52.20.2384970.html#238348903">(May 11 2021 at 17:13)</a>:</h4>
<p>I feel really wary of flip-flopping on this -- waiting for 1.53 would be more prudent</p>



<a name="238349143"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/unstable%20fingerprints%20-%20actually%20in%201.52%20%2384970/near/238349143" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> simulacrum <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/unstable.20fingerprints.20-.20actually.20in.201.2E52.20.2384970.html#238349143">(May 11 2021 at 17:15)</a>:</h4>
<p>Yeah, I think I'd need to see very strong confidence, but I think I see it less as flip-flopping and more of "we wanted to roll out a known good fix quickly, and with more time and energy have been able to identify a few key fixes"</p>



<a name="238349387"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/unstable%20fingerprints%20-%20actually%20in%201.52%20%2384970/near/238349387" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> cuviper <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/unstable.20fingerprints.20-.20actually.20in.201.2E52.20.2384970.html#238349387">(May 11 2021 at 17:17)</a>:</h4>
<p>but then, how much "more time and energy" is sufficient that still beats the next release train?</p>



<a name="238349984"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/unstable%20fingerprints%20-%20actually%20in%201.52%20%2384970/near/238349984" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> simulacrum <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/unstable.20fingerprints.20-.20actually.20in.201.2E52.20.2384970.html#238349984">(May 11 2021 at 17:21)</a>:</h4>
<p>Not sure.</p>



<a name="238357443"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/unstable%20fingerprints%20-%20actually%20in%201.52%20%2384970/near/238357443" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pnkfelix <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/unstable.20fingerprints.20-.20actually.20in.201.2E52.20.2384970.html#238357443">(May 11 2021 at 18:10)</a>:</h4>
<p>My understanding is that we'll beat next release train no matter what. As in, I really don’t want to have 1.53 ship without incremental compilation support back to where it was in 1.51, and according to evidence so far, the 1.53 beta is looking a lot better than 1.52.0 did.</p>



<a name="238357575"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/unstable%20fingerprints%20-%20actually%20in%201.52%20%2384970/near/238357575" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pnkfelix <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/unstable.20fingerprints.20-.20actually.20in.201.2E52.20.2384970.html#238357575">(May 11 2021 at 18:11)</a>:</h4>
<p>the only question is whether we’ll identify a collection of stuff that we believe is worth stable-backports to yield that same quality of developer experience, and whether that will happen soon enough, right?</p>



<a name="238357782"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/unstable%20fingerprints%20-%20actually%20in%201.52%20%2384970/near/238357782" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> simulacrum <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/unstable.20fingerprints.20-.20actually.20in.201.2E52.20.2384970.html#238357782">(May 11 2021 at 18:12)</a>:</h4>
<p>Stable, or beta, backports, yes</p>



<a name="239488256"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/unstable%20fingerprints%20-%20actually%20in%201.52%20%2384970/near/239488256" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pnkfelix <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/unstable.20fingerprints.20-.20actually.20in.201.2E52.20.2384970.html#239488256">(May 19 2021 at 20:08)</a>:</h4>
<p>Hey <span class="user-mention" data-user-id="116122">@simulacrum</span> , do you think the blog post with a status update on the fingerprint-related bugs and advocating for beta-usage should be on blog.rlo, or on inside-rust?</p>



<a name="239488290"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/unstable%20fingerprints%20-%20actually%20in%201.52%20%2384970/near/239488290" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> simulacrum <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/unstable.20fingerprints.20-.20actually.20in.201.2E52.20.2384970.html#239488290">(May 19 2021 at 20:08)</a>:</h4>
<p>blog.rlo, as it targets the end-user audience</p>



<a name="239502899"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/unstable%20fingerprints%20-%20actually%20in%201.52%20%2384970/near/239502899" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pnkfelix <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/unstable.20fingerprints.20-.20actually.20in.201.2E52.20.2384970.html#239502899">(May 19 2021 at 22:09)</a>:</h4>
<p>draft blog post: <a href="https://github.com/rust-lang/blog.rust-lang.org/pull/846">https://github.com/rust-lang/blog.rust-lang.org/pull/846</a></p>



<a name="239508728"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/unstable%20fingerprints%20-%20actually%20in%201.52%20%2384970/near/239508728" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Yerkebulan Tulibergenov <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/unstable.20fingerprints.20-.20actually.20in.201.2E52.20.2384970.html#239508728">(May 19 2021 at 23:07)</a>:</h4>
<p>Completely unrelated: I loved the jokes in the post :)</p>



<a name="239658573"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/unstable%20fingerprints%20-%20actually%20in%201.52%20%2384970/near/239658573" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pnkfelix <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/unstable.20fingerprints.20-.20actually.20in.201.2E52.20.2384970.html#239658573">(May 20 2021 at 21:01)</a>:</h4>
<p>hey <span class="user-mention" data-user-id="116122">@simulacrum</span> , <a href="https://github.com/rust-lang/rust/issues/83311">#83311</a> isn’t actually a fingerprint issue, right?</p>



<a name="239658637"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/unstable%20fingerprints%20-%20actually%20in%201.52%20%2384970/near/239658637" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pnkfelix <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/unstable.20fingerprints.20-.20actually.20in.201.2E52.20.2384970.html#239658637">(May 20 2021 at 21:02)</a>:</h4>
<p>oh wait, of course it is</p>



<a name="239658667"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/unstable%20fingerprints%20-%20actually%20in%201.52%20%2384970/near/239658667" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pnkfelix <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/unstable.20fingerprints.20-.20actually.20in.201.2E52.20.2384970.html#239658667">(May 20 2021 at 21:02)</a>:</h4>
<p>but the gist you linked recently ...</p>



<a name="239658673"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/unstable%20fingerprints%20-%20actually%20in%201.52%20%2384970/near/239658673" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> simulacrum <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/unstable.20fingerprints.20-.20actually.20in.201.2E52.20.2384970.html#239658673">(May 20 2021 at 21:02)</a>:</h4>
<p>well...</p>



<a name="239658691"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/unstable%20fingerprints%20-%20actually%20in%201.52%20%2384970/near/239658691" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> simulacrum <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/unstable.20fingerprints.20-.20actually.20in.201.2E52.20.2384970.html#239658691">(May 20 2021 at 21:02)</a>:</h4>
<p>it might've evolved since the initial report</p>



<a name="239658699"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/unstable%20fingerprints%20-%20actually%20in%201.52%20%2384970/near/239658699" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> simulacrum <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/unstable.20fingerprints.20-.20actually.20in.201.2E52.20.2384970.html#239658699">(May 20 2021 at 21:02)</a>:</h4>
<p>it's certainly an incremental issue</p>



<a name="239658752"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/unstable%20fingerprints%20-%20actually%20in%201.52%20%2384970/near/239658752" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pnkfelix <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/unstable.20fingerprints.20-.20actually.20in.201.2E52.20.2384970.html#239658752">(May 20 2021 at 21:03)</a>:</h4>
<p>right. I guess I want to try to be clear about problems that are injected by the newly promoted fingerprint-error</p>



<a name="239658755"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/unstable%20fingerprints%20-%20actually%20in%201.52%20%2384970/near/239658755" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> simulacrum <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/unstable.20fingerprints.20-.20actually.20in.201.2E52.20.2384970.html#239658755">(May 20 2021 at 21:03)</a>:</h4>
<blockquote>
<p>thread '&lt;unnamed&gt;' panicked at 'Error reading cached dep-graph: "invalid enum variant tag while decoding <code>DepKind</code>, expected 0..249"', compiler/rustc_incremental/src/persist/load.rs:186:22</p>
</blockquote>
<p>this doesn't look fingerprint-y</p>



<a name="239658785"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/unstable%20fingerprints%20-%20actually%20in%201.52%20%2384970/near/239658785" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pnkfelix <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/unstable.20fingerprints.20-.20actually.20in.201.2E52.20.2384970.html#239658785">(May 20 2021 at 21:03)</a>:</h4>
<p>exacrly</p>



<a name="239658807"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/unstable%20fingerprints%20-%20actually%20in%201.52%20%2384970/near/239658807" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> simulacrum <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/unstable.20fingerprints.20-.20actually.20in.201.2E52.20.2384970.html#239658807">(May 20 2021 at 21:03)</a>:</h4>
<p>I'm pretty sure this is preexisting</p>



<a name="239658846"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/unstable%20fingerprints%20-%20actually%20in%201.52%20%2384970/near/239658846" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pnkfelix <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/unstable.20fingerprints.20-.20actually.20in.201.2E52.20.2384970.html#239658846">(May 20 2021 at 21:03)</a>:</h4>
<p>right. so I want pre-existing ones to be treated separately</p>



<a name="239658870"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/unstable%20fingerprints%20-%20actually%20in%201.52%20%2384970/near/239658870" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> simulacrum <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/unstable.20fingerprints.20-.20actually.20in.201.2E52.20.2384970.html#239658870">(May 20 2021 at 21:03)</a>:</h4>
<p>we likely aren't able to reliably distinguish different versions of fingerprint/depgraphs when the rustc hash isn't changing (due to being not tracked by rustbuild)</p>



<a name="239764087"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/unstable%20fingerprints%20-%20actually%20in%201.52%20%2384970/near/239764087" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pnkfelix <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/unstable.20fingerprints.20-.20actually.20in.201.2E52.20.2384970.html#239764087">(May 21 2021 at 14:57)</a>:</h4>
<p>when does the rustc hash change? The phrase “rustc hash” to me implies it would be different for every build (probabilistically)?</p>



<a name="239764148"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/unstable%20fingerprints%20-%20actually%20in%201.52%20%2384970/near/239764148" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> simulacrum <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/unstable.20fingerprints.20-.20actually.20in.201.2E52.20.2384970.html#239764148">(May 21 2021 at 14:58)</a>:</h4>
<p>oh, no, I mean the git hash</p>



<a name="239764252"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/unstable%20fingerprints%20-%20actually%20in%201.52%20%2384970/near/239764252" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pnkfelix <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/unstable.20fingerprints.20-.20actually.20in.201.2E52.20.2384970.html#239764252">(May 21 2021 at 14:58)</a>:</h4>
<p>Ah. So local changes are made, people rebuild, but we’re using the same git commit as the basis for the git hash</p>



<a name="239764280"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/unstable%20fingerprints%20-%20actually%20in%201.52%20%2384970/near/239764280" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> simulacrum <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/unstable.20fingerprints.20-.20actually.20in.201.2E52.20.2384970.html#239764280">(May 21 2021 at 14:58)</a>:</h4>
<p>basically rustc --version is usually not going to change, and I think the incremental state is at least partially dependent on that changing in order to be cleared out properly</p>



<a name="239764281"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/unstable%20fingerprints%20-%20actually%20in%201.52%20%2384970/near/239764281" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pnkfelix <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/unstable.20fingerprints.20-.20actually.20in.201.2E52.20.2384970.html#239764281">(May 21 2021 at 14:58)</a>:</h4>
<p>yeah okay that <em>does</em> sound problematic. Hmm.</p>



<a name="239764334"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/unstable%20fingerprints%20-%20actually%20in%201.52%20%2384970/near/239764334" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> simulacrum <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/unstable.20fingerprints.20-.20actually.20in.201.2E52.20.2384970.html#239764334">(May 21 2021 at 14:59)</a>:</h4>
<p>since the git hash isn't even passed unless you explicitly configure x.py to do so (ignore-git = true by default, IIRC)</p>



<a name="239764381"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/unstable%20fingerprints%20-%20actually%20in%201.52%20%2384970/near/239764381" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pnkfelix <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/unstable.20fingerprints.20-.20actually.20in.201.2E52.20.2384970.html#239764381">(May 21 2021 at 14:59)</a>:</h4>
<p>would it be a non-starter to include some further suffix on the version output that reflects a hash of the build-time diff between the local source code and the git commit state?</p>



<a name="239764566"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/unstable%20fingerprints%20-%20actually%20in%201.52%20%2384970/near/239764566" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pnkfelix <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/unstable.20fingerprints.20-.20actually.20in.201.2E52.20.2384970.html#239764566">(May 21 2021 at 15:00)</a>:</h4>
<p><span class="user-mention silent" data-user-id="116122">simulacrum</span> <a href="#narrow/stream/131828-t-compiler/topic/unstable.20fingerprints.20-.20actually.20in.201.2E52.20.2384970/near/239764334">said</a>:</p>
<blockquote>
<p>since the git hash isn't even passed unless you explicitly configure x.py to do so (ignore-git = true by default, IIRC)</p>
</blockquote>
<p>do you know the motivation for not passing that by default?</p>



<a name="239764642"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/unstable%20fingerprints%20-%20actually%20in%201.52%20%2384970/near/239764642" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pnkfelix <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/unstable.20fingerprints.20-.20actually.20in.201.2E52.20.2384970.html#239764642">(May 21 2021 at 15:00)</a>:</h4>
<p>i guess someone could be building from a source tarball</p>



<a name="239764720"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/unstable%20fingerprints%20-%20actually%20in%201.52%20%2384970/near/239764720" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pnkfelix <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/unstable.20fingerprints.20-.20actually.20in.201.2E52.20.2384970.html#239764720">(May 21 2021 at 15:01)</a>:</h4>
<p>(but surely we could detect the presence of a <code>.git/</code> directory, and make an inference…)</p>



<a name="239764871"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/unstable%20fingerprints%20-%20actually%20in%201.52%20%2384970/near/239764871" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> simulacrum <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/unstable.20fingerprints.20-.20actually.20in.201.2E52.20.2384970.html#239764871">(May 21 2021 at 15:02)</a>:</h4>
<p><span class="user-mention" data-user-id="116083">@pnkfelix</span> oh, we can do it for sure, but for many folks they don't want just committing to require a rebuild</p>



<a name="239764895"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/unstable%20fingerprints%20-%20actually%20in%201.52%20%2384970/near/239764895" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> simulacrum <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/unstable.20fingerprints.20-.20actually.20in.201.2E52.20.2384970.html#239764895">(May 21 2021 at 15:02)</a>:</h4>
<p>the hash is used pretty early on today, iirc in rustc-session crate?</p>



<a name="239765153"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/unstable%20fingerprints%20-%20actually%20in%201.52%20%2384970/near/239765153" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pnkfelix <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/unstable.20fingerprints.20-.20actually.20in.201.2E52.20.2384970.html#239765153">(May 21 2021 at 15:03)</a>:</h4>
<p><span class="user-mention silent" data-user-id="116122">simulacrum</span> <a href="#narrow/stream/131828-t-compiler/topic/unstable.20fingerprints.20-.20actually.20in.201.2E52.20.2384970/near/239764871">said</a>:</p>
<blockquote>
<p><span class="user-mention silent" data-user-id="116083">pnkfelix</span> oh, we can do it for sure, but for many folks they don't want just committing to require a rebuild</p>
</blockquote>
<p>I don’t understand, why would the change here cause <code>git commit</code> to require a rebuild?</p>



<a name="239765213"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/unstable%20fingerprints%20-%20actually%20in%201.52%20%2384970/near/239765213" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pnkfelix <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/unstable.20fingerprints.20-.20actually.20in.201.2E52.20.2384970.html#239765213">(May 21 2021 at 15:04)</a>:</h4>
<p>I feel like I’m missing something in my mental model</p>



<a name="239765271"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/unstable%20fingerprints%20-%20actually%20in%201.52%20%2384970/near/239765271" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> simulacrum <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/unstable.20fingerprints.20-.20actually.20in.201.2E52.20.2384970.html#239765271">(May 21 2021 at 15:04)</a>:</h4>
<p>because git commit changes the git hash</p>



<a name="239765313"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/unstable%20fingerprints%20-%20actually%20in%201.52%20%2384970/near/239765313" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> simulacrum <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/unstable.20fingerprints.20-.20actually.20in.201.2E52.20.2384970.html#239765313">(May 21 2021 at 15:04)</a>:</h4>
<p>and we have it stored in the binary, as env!("RUSTC_COMMIT_HASH") or whatever</p>



<a name="239765366"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/unstable%20fingerprints%20-%20actually%20in%201.52%20%2384970/near/239765366" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pnkfelix <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/unstable.20fingerprints.20-.20actually.20in.201.2E52.20.2384970.html#239765366">(May 21 2021 at 15:05)</a>:</h4>
<p>but, why is someone forced to rebuild?</p>



<a name="239765407"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/unstable%20fingerprints%20-%20actually%20in%201.52%20%2384970/near/239765407" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> simulacrum <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/unstable.20fingerprints.20-.20actually.20in.201.2E52.20.2384970.html#239765407">(May 21 2021 at 15:05)</a>:</h4>
<p>because Cargo will say "that env variable changed, I need to rebuild"</p>



<a name="239765432"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/unstable%20fingerprints%20-%20actually%20in%201.52%20%2384970/near/239765432" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> simulacrum <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/unstable.20fingerprints.20-.20actually.20in.201.2E52.20.2384970.html#239765432">(May 21 2021 at 15:05)</a>:</h4>
<p>same as for any other state that we track</p>



<a name="239765471"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/unstable%20fingerprints%20-%20actually%20in%201.52%20%2384970/near/239765471" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> simulacrum <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/unstable.20fingerprints.20-.20actually.20in.201.2E52.20.2384970.html#239765471">(May 21 2021 at 15:05)</a>:</h4>
<p>in any case, this hash is insufficient, just makes it less likely to be a problem</p>



<a name="239765475"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/unstable%20fingerprints%20-%20actually%20in%201.52%20%2384970/near/239765475" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pnkfelix <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/unstable.20fingerprints.20-.20actually.20in.201.2E52.20.2384970.html#239765475">(May 21 2021 at 15:05)</a>:</h4>
<p>oh you’re talking about rebuilding <em>another crate</em> (or crate graph)</p>



<a name="239765494"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/unstable%20fingerprints%20-%20actually%20in%201.52%20%2384970/near/239765494" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> simulacrum <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/unstable.20fingerprints.20-.20actually.20in.201.2E52.20.2384970.html#239765494">(May 21 2021 at 15:05)</a>:</h4>
<p>because you can change things without committing</p>



<a name="239765514"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/unstable%20fingerprints%20-%20actually%20in%201.52%20%2384970/near/239765514" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pnkfelix <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/unstable.20fingerprints.20-.20actually.20in.201.2E52.20.2384970.html#239765514">(May 21 2021 at 15:06)</a>:</h4>
<p>I thought you were talking about rebuilding rustc itself</p>



<a name="239765556"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/unstable%20fingerprints%20-%20actually%20in%201.52%20%2384970/near/239765556" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> simulacrum <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/unstable.20fingerprints.20-.20actually.20in.201.2E52.20.2384970.html#239765556">(May 21 2021 at 15:06)</a>:</h4>
<p>I am, yes</p>



<a name="239765592"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/unstable%20fingerprints%20-%20actually%20in%201.52%20%2384970/near/239765592" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> simulacrum <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/unstable.20fingerprints.20-.20actually.20in.201.2E52.20.2384970.html#239765592">(May 21 2021 at 15:06)</a>:</h4>
<p>like, x.py build &amp;&amp; git commit &amp;&amp; x.py build -- today the second one is a no-op</p>



<a name="239765619"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/unstable%20fingerprints%20-%20actually%20in%201.52%20%2384970/near/239765619" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> simulacrum <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/unstable.20fingerprints.20-.20actually.20in.201.2E52.20.2384970.html#239765619">(May 21 2021 at 15:06)</a>:</h4>
<p>but if we switched ignore-git to false, it wouldn't be</p>



<a name="239765678"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/unstable%20fingerprints%20-%20actually%20in%201.52%20%2384970/near/239765678" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pnkfelix <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/unstable.20fingerprints.20-.20actually.20in.201.2E52.20.2384970.html#239765678">(May 21 2021 at 15:06)</a>:</h4>
<p>okay. So you’re saying when someone <em>requests</em> a rebuild, they expect it to be a no-op in this case</p>



<a name="239765696"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/unstable%20fingerprints%20-%20actually%20in%201.52%20%2384970/near/239765696" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> simulacrum <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/unstable.20fingerprints.20-.20actually.20in.201.2E52.20.2384970.html#239765696">(May 21 2021 at 15:07)</a>:</h4>
<p>and for some workflows (e.g., mine) -- I use git to push to a remote server where the build actually happens, so I'd rebuild <em>every</em> time.</p>



<a name="239765739"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/unstable%20fingerprints%20-%20actually%20in%201.52%20%2384970/near/239765739" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pnkfelix <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/unstable.20fingerprints.20-.20actually.20in.201.2E52.20.2384970.html#239765739">(May 21 2021 at 15:07)</a>:</h4>
<p>when in any case, what I really want is a hash of the source code state</p>



<a name="239765756"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/unstable%20fingerprints%20-%20actually%20in%201.52%20%2384970/near/239765756" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pnkfelix <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/unstable.20fingerprints.20-.20actually.20in.201.2E52.20.2384970.html#239765756">(May 21 2021 at 15:07)</a>:</h4>
<p>which the git commit is an approximation of</p>



<a name="239765935"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/unstable%20fingerprints%20-%20actually%20in%201.52%20%2384970/near/239765935" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> simulacrum <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/unstable.20fingerprints.20-.20actually.20in.201.2E52.20.2384970.html#239765935">(May 21 2021 at 15:08)</a>:</h4>
<p>right</p>



<a name="239765943"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/unstable%20fingerprints%20-%20actually%20in%201.52%20%2384970/near/239765943" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pnkfelix <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/unstable.20fingerprints.20-.20actually.20in.201.2E52.20.2384970.html#239765943">(May 21 2021 at 15:08)</a>:</h4>
<p>I wonder if there’s a different hash we could extract from git that more closely models the source code state on its own, independent of commit log state</p>



<a name="239765993"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/unstable%20fingerprints%20-%20actually%20in%201.52%20%2384970/near/239765993" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> simulacrum <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/unstable.20fingerprints.20-.20actually.20in.201.2E52.20.2384970.html#239765993">(May 21 2021 at 15:09)</a>:</h4>
<p>well, you sort of can, but at that point there's a question of whether it's the right thing <em>anyway</em></p>



<a name="239766013"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/unstable%20fingerprints%20-%20actually%20in%201.52%20%2384970/near/239766013" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> simulacrum <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/unstable.20fingerprints.20-.20actually.20in.201.2E52.20.2384970.html#239766013">(May 21 2021 at 15:09)</a>:</h4>
<p>it's still too pessimistic for almost all developers</p>



<a name="239766036"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/unstable%20fingerprints%20-%20actually%20in%201.52%20%2384970/near/239766036" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> simulacrum <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/unstable.20fingerprints.20-.20actually.20in.201.2E52.20.2384970.html#239766036">(May 21 2021 at 15:09)</a>:</h4>
<p>you sort of want "incremental version"</p>



<a name="239766043"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/unstable%20fingerprints%20-%20actually%20in%201.52%20%2384970/near/239766043" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> simulacrum <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/unstable.20fingerprints.20-.20actually.20in.201.2E52.20.2384970.html#239766043">(May 21 2021 at 15:09)</a>:</h4>
<p>which is ~impossible, I suspect</p>



<a name="239766190"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/unstable%20fingerprints%20-%20actually%20in%201.52%20%2384970/near/239766190" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pnkfelix <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/unstable.20fingerprints.20-.20actually.20in.201.2E52.20.2384970.html#239766190">(May 21 2021 at 15:10)</a>:</h4>
<p>unless we attempted to explicitly make that part of the <code>rustc —version —verbose</code> output</p>



<a name="239766215"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/unstable%20fingerprints%20-%20actually%20in%201.52%20%2384970/near/239766215" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pnkfelix <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/unstable.20fingerprints.20-.20actually.20in.201.2E52.20.2384970.html#239766215">(May 21 2021 at 15:10)</a>:</h4>
<p>but then that would be yet another thing to maintain</p>



<a name="239766220"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/unstable%20fingerprints%20-%20actually%20in%201.52%20%2384970/near/239766220" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pnkfelix <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/unstable.20fingerprints.20-.20actually.20in.201.2E52.20.2384970.html#239766220">(May 21 2021 at 15:10)</a>:</h4>
<p>and get wrong</p>



<a name="239766308"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/unstable%20fingerprints%20-%20actually%20in%201.52%20%2384970/near/239766308" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> simulacrum <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/unstable.20fingerprints.20-.20actually.20in.201.2E52.20.2384970.html#239766308">(May 21 2021 at 15:11)</a>:</h4>
<p>I'm not sure how fine-grained the versioning is-- like, can the order of queries in a function changing cause problems when deserializing? The type of a query?</p>



<a name="239766316"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/unstable%20fingerprints%20-%20actually%20in%201.52%20%2384970/near/239766316" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pnkfelix <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/unstable.20fingerprints.20-.20actually.20in.201.2E52.20.2384970.html#239766316">(May 21 2021 at 15:11)</a>:</h4>
<p>but at the same time, how <em>else</em> are we going to deal with the problem of a changing <code>rustc</code> source base?</p>



<a name="239766349"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/unstable%20fingerprints%20-%20actually%20in%201.52%20%2384970/near/239766349" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> simulacrum <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/unstable.20fingerprints.20-.20actually.20in.201.2E52.20.2384970.html#239766349">(May 21 2021 at 15:11)</a>:</h4>
<p>Maybe e.g. hashing the query defs in rustc-middle is OK</p>



<a name="239766351"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/unstable%20fingerprints%20-%20actually%20in%201.52%20%2384970/near/239766351" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pnkfelix <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/unstable.20fingerprints.20-.20actually.20in.201.2E52.20.2384970.html#239766351">(May 21 2021 at 15:11)</a>:</h4>
<p>you say “source code state” is too pessimistic</p>



<a name="239766363"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/unstable%20fingerprints%20-%20actually%20in%201.52%20%2384970/near/239766363" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pnkfelix <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/unstable.20fingerprints.20-.20actually.20in.201.2E52.20.2384970.html#239766363">(May 21 2021 at 15:11)</a>:</h4>
<p>but I’m not sure I agree with that</p>



<a name="239766442"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/unstable%20fingerprints%20-%20actually%20in%201.52%20%2384970/near/239766442" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> simulacrum <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/unstable.20fingerprints.20-.20actually.20in.201.2E52.20.2384970.html#239766442">(May 21 2021 at 15:12)</a>:</h4>
<p>Yeah, I mean, maybe it isn't that bad</p>



<a name="239766463"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/unstable%20fingerprints%20-%20actually%20in%201.52%20%2384970/near/239766463" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pnkfelix <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/unstable.20fingerprints.20-.20actually.20in.201.2E52.20.2384970.html#239766463">(May 21 2021 at 15:12)</a>:</h4>
<p>like, most developers, if they are aware of this problem at all, are going to use that as their mental model, right?</p>



<a name="239766500"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/unstable%20fingerprints%20-%20actually%20in%201.52%20%2384970/near/239766500" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> simulacrum <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/unstable.20fingerprints.20-.20actually.20in.201.2E52.20.2384970.html#239766500">(May 21 2021 at 15:12)</a>:</h4>
<p>hm... yes? probably?</p>



<a name="239766553"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/unstable%20fingerprints%20-%20actually%20in%201.52%20%2384970/near/239766553" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> simulacrum <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/unstable.20fingerprints.20-.20actually.20in.201.2E52.20.2384970.html#239766553">(May 21 2021 at 15:12)</a>:</h4>
<p>one could argue that it's not really necessary for rustc to deal with this in the wild, as we do embed a source code hash (i.e. git hash) there</p>



<a name="239766593"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/unstable%20fingerprints%20-%20actually%20in%201.52%20%2384970/near/239766593" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> simulacrum <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/unstable.20fingerprints.20-.20actually.20in.201.2E52.20.2384970.html#239766593">(May 21 2021 at 15:13)</a>:</h4>
<p>and in rust-lang/rust, we should just get compiletest/rustbuild to clear out state appropriately on compiler rebuilds</p>



<a name="239766609"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/unstable%20fingerprints%20-%20actually%20in%201.52%20%2384970/near/239766609" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> simulacrum <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/unstable.20fingerprints.20-.20actually.20in.201.2E52.20.2384970.html#239766609">(May 21 2021 at 15:13)</a>:</h4>
<p>we already use the rustc binary timestamp, that's really 'enough'</p>



<a name="239766613"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/unstable%20fingerprints%20-%20actually%20in%201.52%20%2384970/near/239766613" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pnkfelix <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/unstable.20fingerprints.20-.20actually.20in.201.2E52.20.2384970.html#239766613">(May 21 2021 at 15:13)</a>:</h4>
<p>“in the wild” as in, well, what?</p>



<a name="239766647"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/unstable%20fingerprints%20-%20actually%20in%201.52%20%2384970/near/239766647" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pnkfelix <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/unstable.20fingerprints.20-.20actually.20in.201.2E52.20.2384970.html#239766647">(May 21 2021 at 15:13)</a>:</h4>
<p>someone using <code>rustup</code> to make a custom toolchain?</p>



<a name="239766659"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/unstable%20fingerprints%20-%20actually%20in%201.52%20%2384970/near/239766659" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pnkfelix <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/unstable.20fingerprints.20-.20actually.20in.201.2E52.20.2384970.html#239766659">(May 21 2021 at 15:13)</a>:</h4>
<p>that points to their local build?</p>



<a name="239766696"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/unstable%20fingerprints%20-%20actually%20in%201.52%20%2384970/near/239766696" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pnkfelix <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/unstable.20fingerprints.20-.20actually.20in.201.2E52.20.2384970.html#239766696">(May 21 2021 at 15:14)</a>:</h4>
<p>that’s the pathological case I can imagine</p>



<a name="239766791"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/unstable%20fingerprints%20-%20actually%20in%201.52%20%2384970/near/239766791" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pnkfelix <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/unstable.20fingerprints.20-.20actually.20in.201.2E52.20.2384970.html#239766791">(May 21 2021 at 15:14)</a>:</h4>
<p>i.e. someone using a local <code>rustc</code> checkout, actively changing it, and <em>also</em> using it to build some entirely separate crate</p>



<a name="239766821"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/unstable%20fingerprints%20-%20actually%20in%201.52%20%2384970/near/239766821" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pnkfelix <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/unstable.20fingerprints.20-.20actually.20in.201.2E52.20.2384970.html#239766821">(May 21 2021 at 15:14)</a>:</h4>
<p>but you’re saying we use a timestamp on the <code>rustc</code> binary, and that should handle that latter case?</p>



<a name="239766837"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/unstable%20fingerprints%20-%20actually%20in%201.52%20%2384970/near/239766837" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pnkfelix <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/unstable.20fingerprints.20-.20actually.20in.201.2E52.20.2384970.html#239766837">(May 21 2021 at 15:15)</a>:</h4>
<p>but then I’m back to wondering how we hit this at all</p>



<a name="239766947"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/unstable%20fingerprints%20-%20actually%20in%201.52%20%2384970/near/239766947" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pnkfelix <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/unstable.20fingerprints.20-.20actually.20in.201.2E52.20.2384970.html#239766947">(May 21 2021 at 15:15)</a>:</h4>
<p><span class="user-mention silent" data-user-id="116122">simulacrum</span> <a href="#narrow/stream/131828-t-compiler/topic/unstable.20fingerprints.20-.20actually.20in.201.2E52.20.2384970/near/239766609">said</a>:</p>
<blockquote>
<p>we already use the rustc binary timestamp, that's really 'enough'</p>
</blockquote>
<p>maybe I need clarity on who “we” is in that sentence</p>



<a name="239766948"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/unstable%20fingerprints%20-%20actually%20in%201.52%20%2384970/near/239766948" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> simulacrum <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/unstable.20fingerprints.20-.20actually.20in.201.2E52.20.2384970.html#239766948">(May 21 2021 at 15:15)</a>:</h4>
<p>I'm saying that we hit this because we're not clearing out a bit of state</p>



<a name="239766991"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/unstable%20fingerprints%20-%20actually%20in%201.52%20%2384970/near/239766991" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> simulacrum <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/unstable.20fingerprints.20-.20actually.20in.201.2E52.20.2384970.html#239766991">(May 21 2021 at 15:15)</a>:</h4>
<p>it's not any different to the used-to-be-common "found old version of libcore" errors</p>



<a name="239767110"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/unstable%20fingerprints%20-%20actually%20in%201.52%20%2384970/near/239767110" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pnkfelix <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/unstable.20fingerprints.20-.20actually.20in.201.2E52.20.2384970.html#239767110">(May 21 2021 at 15:16)</a>:</h4>
<p>let me attempt to reestablish context</p>



<a name="239767156"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/unstable%20fingerprints%20-%20actually%20in%201.52%20%2384970/near/239767156" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pnkfelix <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/unstable.20fingerprints.20-.20actually.20in.201.2E52.20.2384970.html#239767156">(May 21 2021 at 15:16)</a>:</h4>
<p>we are talking about the ICE’s you noted here, right? : <a href="https://gist.github.com/Mark-Simulacrum/00eb855785b8cd9d8a696eb9b8fc1317">https://gist.github.com/Mark-Simulacrum/00eb855785b8cd9d8a696eb9b8fc1317</a></p>



<a name="239767225"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/unstable%20fingerprints%20-%20actually%20in%201.52%20%2384970/near/239767225" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> simulacrum <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/unstable.20fingerprints.20-.20actually.20in.201.2E52.20.2384970.html#239767225">(May 21 2021 at 15:17)</a>:</h4>
<p>yes</p>



<a name="239767235"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/unstable%20fingerprints%20-%20actually%20in%201.52%20%2384970/near/239767235" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pnkfelix <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/unstable.20fingerprints.20-.20actually.20in.201.2E52.20.2384970.html#239767235">(May 21 2021 at 15:17)</a>:</h4>
<p>and saying that we can focus solely on the (pretty narrow) scenario of our own internal build + test infrastructure</p>



<a name="239767245"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/unstable%20fingerprints%20-%20actually%20in%201.52%20%2384970/near/239767245" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> simulacrum <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/unstable.20fingerprints.20-.20actually.20in.201.2E52.20.2384970.html#239767245">(May 21 2021 at 15:17)</a>:</h4>
<p>in this case, we're not deleting the tmp directory</p>



<a name="239767258"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/unstable%20fingerprints%20-%20actually%20in%201.52%20%2384970/near/239767258" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> simulacrum <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/unstable.20fingerprints.20-.20actually.20in.201.2E52.20.2384970.html#239767258">(May 21 2021 at 15:17)</a>:</h4>
<p>we should be</p>



<a name="239767260"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/unstable%20fingerprints%20-%20actually%20in%201.52%20%2384970/near/239767260" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pnkfelix <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/unstable.20fingerprints.20-.20actually.20in.201.2E52.20.2384970.html#239767260">(May 21 2021 at 15:17)</a>:</h4>
<p>and that you do not think the problems here generalize to other users</p>



<a name="239767272"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/unstable%20fingerprints%20-%20actually%20in%201.52%20%2384970/near/239767272" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pnkfelix <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/unstable.20fingerprints.20-.20actually.20in.201.2E52.20.2384970.html#239767272">(May 21 2021 at 15:17)</a>:</h4>
<p>outside of <code>x.py test</code> callers</p>



<a name="239767482"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/unstable%20fingerprints%20-%20actually%20in%201.52%20%2384970/near/239767482" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> simulacrum <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/unstable.20fingerprints.20-.20actually.20in.201.2E52.20.2384970.html#239767482">(May 21 2021 at 15:18)</a>:</h4>
<p>I think so, yes, I guess if someone is doing +stage1 they might encounter this, as you said. but it's pretty unusual to do that -- and I think cargo properly clears things out, as it sees through the rustup shim to the actual rustc binary I believe</p>



<a name="239767486"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/unstable%20fingerprints%20-%20actually%20in%201.52%20%2384970/near/239767486" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> simulacrum <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/unstable.20fingerprints.20-.20actually.20in.201.2E52.20.2384970.html#239767486">(May 21 2021 at 15:19)</a>:</h4>
<p>(not sure on that)</p>



<a name="239767527"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/unstable%20fingerprints%20-%20actually%20in%201.52%20%2384970/near/239767527" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> simulacrum <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/unstable.20fingerprints.20-.20actually.20in.201.2E52.20.2384970.html#239767527">(May 21 2021 at 15:19)</a>:</h4>
<p>maybe it doesn't actually, but regardless, there are mitigation strategies basically is all I'm saying</p>



<a name="239767766"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/unstable%20fingerprints%20-%20actually%20in%201.52%20%2384970/near/239767766" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pnkfelix <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/unstable.20fingerprints.20-.20actually.20in.201.2E52.20.2384970.html#239767766">(May 21 2021 at 15:21)</a>:</h4>
<p>I want to write a summary comment on <a href="https://github.com/rust-lang/rust/issues/83311">#83311</a></p>



<a name="239767826"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/unstable%20fingerprints%20-%20actually%20in%201.52%20%2384970/near/239767826" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pnkfelix <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/unstable.20fingerprints.20-.20actually.20in.201.2E52.20.2384970.html#239767826">(May 21 2021 at 15:21)</a>:</h4>
<p>Does this look right:</p>
<blockquote>
<p>this may be very specific to local <code>rustc</code> development, where you are actually changing the <code>rustc</code> binary, but our incremental compilation infrastructure isn't necessarily designed to handle that case with complete fidelity.</p>
</blockquote>



<a name="239767959"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/unstable%20fingerprints%20-%20actually%20in%201.52%20%2384970/near/239767959" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pnkfelix <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/unstable.20fingerprints.20-.20actually.20in.201.2E52.20.2384970.html#239767959">(May 21 2021 at 15:22)</a>:</h4>
<p>I’m basically trying to figure out how much of this is “we need to make changes to rustc itself” vs “we won’t change rustc to handle all aspects of this scenario. Instead we will change our test infrastructure."</p>



<a name="239768129"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/unstable%20fingerprints%20-%20actually%20in%201.52%20%2384970/near/239768129" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pnkfelix <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/unstable.20fingerprints.20-.20actually.20in.201.2E52.20.2384970.html#239768129">(May 21 2021 at 15:23)</a>:</h4>
<p>I’ll just say that explicitly (that there are still questions about what is best to do in response here.)</p>



<a name="239768179"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/unstable%20fingerprints%20-%20actually%20in%201.52%20%2384970/near/239768179" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> simulacrum <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/unstable.20fingerprints.20-.20actually.20in.201.2E52.20.2384970.html#239768179">(May 21 2021 at 15:24)</a>:</h4>
<p>Yeah</p>



<a name="239768239"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/unstable%20fingerprints%20-%20actually%20in%201.52%20%2384970/near/239768239" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> simulacrum <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/unstable.20fingerprints.20-.20actually.20in.201.2E52.20.2384970.html#239768239">(May 21 2021 at 15:24)</a>:</h4>
<p>er, well, it'd be a change to rustbuild</p>



<a name="239768249"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/unstable%20fingerprints%20-%20actually%20in%201.52%20%2384970/near/239768249" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> simulacrum <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/unstable.20fingerprints.20-.20actually.20in.201.2E52.20.2384970.html#239768249">(May 21 2021 at 15:24)</a>:</h4>
<p>probably like ~3 lines</p>



<a name="239768654"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/unstable%20fingerprints%20-%20actually%20in%201.52%20%2384970/near/239768654" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pnkfelix <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/unstable.20fingerprints.20-.20actually.20in.201.2E52.20.2384970.html#239768654">(May 21 2021 at 15:26)</a>:</h4>
<p>anyway I think we can remove <a href="https://github.com/rust-lang/rust/issues/83311">#83311</a> from the <a href="https://github.com/rust-lang/rust/issues/84970">#84970</a> metabug, right?</p>



<a name="239768779"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/unstable%20fingerprints%20-%20actually%20in%201.52%20%2384970/near/239768779" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> simulacrum <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/unstable.20fingerprints.20-.20actually.20in.201.2E52.20.2384970.html#239768779">(May 21 2021 at 15:27)</a>:</h4>
<p>I think so, yes, it seems largely unrelated</p>



<a name="239768790"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/unstable%20fingerprints%20-%20actually%20in%201.52%20%2384970/near/239768790" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pnkfelix <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/unstable.20fingerprints.20-.20actually.20in.201.2E52.20.2384970.html#239768790">(May 21 2021 at 15:27)</a>:</h4>
<p>done</p>



<a name="239768793"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/unstable%20fingerprints%20-%20actually%20in%201.52%20%2384970/near/239768793" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> simulacrum <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/unstable.20fingerprints.20-.20actually.20in.201.2E52.20.2384970.html#239768793">(May 21 2021 at 15:27)</a>:</h4>
<p>(in the latest state anyway)</p>



<a name="239768810"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/unstable%20fingerprints%20-%20actually%20in%201.52%20%2384970/near/239768810" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pnkfelix <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/unstable.20fingerprints.20-.20actually.20in.201.2E52.20.2384970.html#239768810">(May 21 2021 at 15:27)</a>:</h4>
<p>right</p>



<a name="239768924"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/unstable%20fingerprints%20-%20actually%20in%201.52%20%2384970/near/239768924" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pnkfelix <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/unstable.20fingerprints.20-.20actually.20in.201.2E52.20.2384970.html#239768924">(May 21 2021 at 15:28)</a>:</h4>
<p>and I don’t think there’s any recent PR’s for it.</p>



<a name="239768967"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/unstable%20fingerprints%20-%20actually%20in%201.52%20%2384970/near/239768967" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pnkfelix <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/unstable.20fingerprints.20-.20actually.20in.201.2E52.20.2384970.html#239768967">(May 21 2021 at 15:28)</a>:</h4>
<p>(I’m trying to get a grip on what we might still backport, either to beta or even to stable.)</p>



<a name="239792012"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/unstable%20fingerprints%20-%20actually%20in%201.52%20%2384970/near/239792012" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pnkfelix <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/unstable.20fingerprints.20-.20actually.20in.201.2E52.20.2384970.html#239792012">(May 21 2021 at 18:16)</a>:</h4>
<p><span class="user-mention silent" data-user-id="116083">pnkfelix</span> <a href="#narrow/stream/131828-t-compiler/topic/unstable.20fingerprints.20-.20actually.20in.201.2E52.20.2384970/near/239765943">said</a>:</p>
<blockquote>
<p>I wonder if there’s a different hash we could extract from git that more closely models the source code state on its own, independent of commit log state</p>
</blockquote>
<p>In fact, isn’t the thing I’m asking for here “just” the <code>tree</code>? Which seems to be something we can trivially get, either from <code>git cat-file -p master | grep ^tree</code>, or via <code>git rev-parse master:$ROOT | | grep ^^</code> ?</p>



<a name="239792111"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/unstable%20fingerprints%20-%20actually%20in%201.52%20%2384970/near/239792111" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pnkfelix <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/unstable.20fingerprints.20-.20actually.20in.201.2E52.20.2384970.html#239792111">(May 21 2021 at 18:17)</a>:</h4>
<p>/me muses on whether there’s any value in having <code>rustc —version —verbose</code> report <em>both</em> the git commit ID as well as the tree ID...</p>



<a name="239806092"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/unstable%20fingerprints%20-%20actually%20in%201.52%20%2384970/near/239806092" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Nelson <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/unstable.20fingerprints.20-.20actually.20in.201.2E52.20.2384970.html#239806092">(May 21 2021 at 20:05)</a>:</h4>
<p><span class="user-mention" data-user-id="116083">@pnkfelix</span> personally I think a much easier and simpler fix is to just disable incremental in rustbuild for builds with the stage 1 compiler</p>



<a name="239806160"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/unstable%20fingerprints%20-%20actually%20in%201.52%20%2384970/near/239806160" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Nelson <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/unstable.20fingerprints.20-.20actually.20in.201.2E52.20.2384970.html#239806160">(May 21 2021 at 20:05)</a>:</h4>
<p>Then people can still set incremental = true for stage 0 builds without it being unsound</p>



<a name="239807553"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/unstable%20fingerprints%20-%20actually%20in%201.52%20%2384970/near/239807553" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> simulacrum <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/unstable.20fingerprints.20-.20actually.20in.201.2E52.20.2384970.html#239807553">(May 21 2021 at 20:17)</a>:</h4>
<p>That's already true</p>



<a name="239807584"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/unstable%20fingerprints%20-%20actually%20in%201.52%20%2384970/near/239807584" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> simulacrum <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/unstable.20fingerprints.20-.20actually.20in.201.2E52.20.2384970.html#239807584">(May 21 2021 at 20:17)</a>:</h4>
<p>The tests ICE'ing are passing -Cincremental (e.g., incremental tests, ui tests, etc)</p>



<a name="239808416"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/unstable%20fingerprints%20-%20actually%20in%201.52%20%2384970/near/239808416" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Nelson <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/unstable.20fingerprints.20-.20actually.20in.201.2E52.20.2384970.html#239808416">(May 21 2021 at 20:25)</a>:</h4>
<p>Why would tests reuse the same cache between invocations?</p>



<a name="239812161"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/unstable%20fingerprints%20-%20actually%20in%201.52%20%2384970/near/239812161" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> simulacrum <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/unstable.20fingerprints.20-.20actually.20in.201.2E52.20.2384970.html#239812161">(May 21 2021 at 20:58)</a>:</h4>
<p>They write to a shared directory (tmp) which isn't cleared, it's not necessary</p>



<a name="239823681"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/unstable%20fingerprints%20-%20actually%20in%201.52%20%2384970/near/239823681" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Nelson <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/unstable.20fingerprints.20-.20actually.20in.201.2E52.20.2384970.html#239823681">(May 21 2021 at 23:03)</a>:</h4>
<p>Ah hmm, maybe it would be easier to use temporary directories for each test instead of making the compiler smarter</p>



<a name="239823898"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/unstable%20fingerprints%20-%20actually%20in%201.52%20%2384970/near/239823898" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> simulacrum <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/unstable.20fingerprints.20-.20actually.20in.201.2E52.20.2384970.html#239823898">(May 21 2021 at 23:06)</a>:</h4>
<p>No changes to the compiler have been proposed, we just need to fix rustbuild or compiletest to appropriately clear out the tmp directory in build</p>



<a name="239828148"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/unstable%20fingerprints%20-%20actually%20in%201.52%20%2384970/near/239828148" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pnkfelix <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/unstable.20fingerprints.20-.20actually.20in.201.2E52.20.2384970.html#239828148">(May 22 2021 at 00:06)</a>:</h4>
<p>(well, I <em>did</em> propose adding more info to the compiler’s <code>—version —verbose</code> output. That was more of a general “would this be a reasonable proxy for versioning the incremental metadata?”)</p>



<a name="239828779"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/unstable%20fingerprints%20-%20actually%20in%201.52%20%2384970/near/239828779" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> simulacrum <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/unstable.20fingerprints.20-.20actually.20in.201.2E52.20.2384970.html#239828779">(May 22 2021 at 00:16)</a>:</h4>
<p>hm, yeah, I don't think it's the fix needed here (though may not be a bad idea, orthogonally)</p>



<a name="240079440"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/unstable%20fingerprints%20-%20actually%20in%201.52%20%2384970/near/240079440" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pnkfelix <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/unstable.20fingerprints.20-.20actually.20in.201.2E52.20.2384970.html#240079440">(May 24 2021 at 16:59)</a>:</h4>
<p>I want to have a follow-up dialogue about the current status, namely the set of PR’s that got into 1.54 but have not yet been approved (or even necessarily nominated) for a 1.53 backport</p>



<a name="240079580"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/unstable%20fingerprints%20-%20actually%20in%201.52%20%2384970/near/240079580" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pnkfelix <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/unstable.20fingerprints.20-.20actually.20in.201.2E52.20.2384970.html#240079580">(May 24 2021 at 17:00)</a>:</h4>
<p>I’m debating about whether this is the best topic for this, or if I should create a fresh one. For now I think continuing here makes sense.</p>



<a name="240079948"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/unstable%20fingerprints%20-%20actually%20in%201.52%20%2384970/near/240079948" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pnkfelix <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/unstable.20fingerprints.20-.20actually.20in.201.2E52.20.2384970.html#240079948">(May 24 2021 at 17:02)</a>:</h4>
<p>In the Thursday T-compiler meeting, <a href="https://zulip-archive.rust-lang.org/238009tcompilermeetings/21853weekly2021052054818.html#239599378">the discussion of beta-nominated PR 85186</a> was the main place where we started discussing the matter, from a big picture standpoint</p>



<a name="240080615"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/unstable%20fingerprints%20-%20actually%20in%201.52%20%2384970/near/240080615" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pnkfelix <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/unstable.20fingerprints.20-.20actually.20in.201.2E52.20.2384970.html#240080615">(May 24 2021 at 17:07)</a>:</h4>
<p>since that meeting, I added a new column to the summary table on description of <a href="https://github.com/rust-lang/rust/issues/84970">#84970</a>, showing the minimal Rust version each PR has gotten to. As of that time, there are three PR’s that are in 1.54 but are not yet beta-approved (and in some cases, not yet nominated) for 1.53: PR <a href="https://github.com/rust-lang/rust/issues/85211">#85211</a>, PR <a href="https://github.com/rust-lang/rust/issues/83901">#83901</a>, and PR <a href="https://github.com/rust-lang/rust/issues/85186">#85186</a> .</p>



<a name="240081031"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/unstable%20fingerprints%20-%20actually%20in%201.52%20%2384970/near/240081031" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pnkfelix <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/unstable.20fingerprints.20-.20actually.20in.201.2E52.20.2384970.html#240081031">(May 24 2021 at 17:10)</a>:</h4>
<p>At this point, I see us as having three realistic options:</p>
<ol>
<li>Do literally nothing. This will mean incr-comp gets turned back on in the 1.53 beta release, but it also means the bugs fixed by the PR’s above will hit users of that release.</li>
<li>Backport some or all of the three PR’s listed, in order to ensure that that fingerprint problems don’t plague the beta, </li>
<li>Disable incr-comp on 1.53.0, the same way it was disabled on 1.52.1, (so that users have to opt-in to using it via the environment variable).</li>
</ol>
<p>Options 2 and 3 are not exclusive. We could do both 2 and 3. But I don’t think there’s a great argument for that.</p>



<a name="240086045"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/unstable%20fingerprints%20-%20actually%20in%201.52%20%2384970/near/240086045" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pnkfelix <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/unstable.20fingerprints.20-.20actually.20in.201.2E52.20.2384970.html#240086045">(May 24 2021 at 17:49)</a>:</h4>
<p>cc <span class="user-group-mention" data-user-group-id="492">@T-compiler</span></p>



<a name="240089958"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/unstable%20fingerprints%20-%20actually%20in%201.52%20%2384970/near/240089958" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/unstable.20fingerprints.20-.20actually.20in.201.2E52.20.2384970.html#240089958">(May 24 2021 at 18:18)</a>:</h4>
<p>Hmm</p>



<a name="240090036"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/unstable%20fingerprints%20-%20actually%20in%201.52%20%2384970/near/240090036" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/unstable.20fingerprints.20-.20actually.20in.201.2E52.20.2384970.html#240090036">(May 24 2021 at 18:18)</a>:</h4>
<p>Do we have any sense for how often these various bugs hit users in the wild?</p>



<a name="240090072"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/unstable%20fingerprints%20-%20actually%20in%201.52%20%2384970/near/240090072" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/unstable.20fingerprints.20-.20actually.20in.201.2E52.20.2384970.html#240090072">(May 24 2021 at 18:18)</a>:</h4>
<p>Also, at this point, we are not talking about potential <em>soundness issues</em>, right, "just" ICEs?</p>



<a name="240090992"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/unstable%20fingerprints%20-%20actually%20in%201.52%20%2384970/near/240090992" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pnkfelix <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/unstable.20fingerprints.20-.20actually.20in.201.2E52.20.2384970.html#240090992">(May 24 2021 at 18:25)</a>:</h4>
<p>yes, at this point I believe we are only talking about ICE's</p>



<a name="240091365"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/unstable%20fingerprints%20-%20actually%20in%201.52%20%2384970/near/240091365" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pnkfelix <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/unstable.20fingerprints.20-.20actually.20in.201.2E52.20.2384970.html#240091365">(May 24 2021 at 18:28)</a>:</h4>
<p>(there is a related question, one of whether to actually publish the <a href="https://github.com/rust-lang/blog.rust-lang.org/pull/846">blog post encouraging people</a> to try out the 1.53-beta ahead of its release. I personally am inclined to consider publishing it only if we also do at least <em>some</em> of the backports associated with 2. (That’s not a bidirectional implication; I’m just saying that if we did backports, only then would I advocate for publishing the post.)</p>



<a name="240096449"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/unstable%20fingerprints%20-%20actually%20in%201.52%20%2384970/near/240096449" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pnkfelix <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/unstable.20fingerprints.20-.20actually.20in.201.2E52.20.2384970.html#240096449">(May 24 2021 at 19:03)</a>:</h4>
<p><span class="user-mention silent" data-user-id="116009">nikomatsakis</span> <a href="#narrow/stream/131828-t-compiler/topic/unstable.20fingerprints.20-.20actually.20in.201.2E52.20.2384970/near/240090036">said</a>:</p>
<blockquote>
<p>Do we have any sense for how often these various bugs hit users in the wild?</p>
</blockquote>
<p>We do not. That is our biggest problem right now, I think.</p>



<a name="240104516"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/unstable%20fingerprints%20-%20actually%20in%201.52%20%2384970/near/240104516" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Nelson <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/unstable.20fingerprints.20-.20actually.20in.201.2E52.20.2384970.html#240104516">(May 24 2021 at 20:05)</a>:</h4>
<p><span class="user-mention silent" data-user-id="116083">pnkfelix</span> <a href="#narrow/stream/131828-t-compiler/topic/unstable.20fingerprints.20-.20actually.20in.201.2E52.20.2384970/near/240096449">said</a>:</p>
<blockquote>
<p><span class="user-mention silent" data-user-id="116009">nikomatsakis</span> <a href="#narrow/stream/131828-t-compiler/topic/unstable.20fingerprints.20-.20actually.20in.201.2E52.20.2384970/near/240090036">said</a>:</p>
<blockquote>
<p>Do we have any sense for how often these various bugs hit users in the wild?</p>
</blockquote>
<p>We do not. That is our biggest problem right now, I think.</p>
</blockquote>
<p>that seems like something the blog post would help with</p>



<a name="240106055"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/unstable%20fingerprints%20-%20actually%20in%201.52%20%2384970/near/240106055" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pnkfelix <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/unstable.20fingerprints.20-.20actually.20in.201.2E52.20.2384970.html#240106055">(May 24 2021 at 20:17)</a>:</h4>
<p>We certainly could rephrase the blog post to not exuberantly state that we’ve addressed all the known bugs in the beta, which was my expectation at the time I wrote it.</p>



<a name="240106473"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/unstable%20fingerprints%20-%20actually%20in%201.52%20%2384970/near/240106473" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pnkfelix <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/unstable.20fingerprints.20-.20actually.20in.201.2E52.20.2384970.html#240106473">(May 24 2021 at 20:21)</a>:</h4>
<p>but then, what: recommend people try the beta, and if they still hit fingerprint issues, then try the nightly? I’m not really happy with that message either.</p>



<a name="240106591"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/unstable%20fingerprints%20-%20actually%20in%201.52%20%2384970/near/240106591" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Nelson <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/unstable.20fingerprints.20-.20actually.20in.201.2E52.20.2384970.html#240106591">(May 24 2021 at 20:22)</a>:</h4>
<p>more like: "try the beta; if it doesn't work, let us know what bug you hit so we know that fix is important to backport"</p>



<a name="240195078"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/unstable%20fingerprints%20-%20actually%20in%201.52%20%2384970/near/240195078" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wesley Wiser <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/unstable.20fingerprints.20-.20actually.20in.201.2E52.20.2384970.html#240195078">(May 25 2021 at 14:23)</a>:</h4>
<p>My feeling is that the set of changes we need to backport to 1.53 is quite large and should ride the train to stable instead of being backported. As for 1.53, I think we should disable incremental in the same way as 1.52. The release notes can also mention that 1.54 will ship with incremental re-enabled.</p>



<a name="240195404"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/unstable%20fingerprints%20-%20actually%20in%201.52%20%2384970/near/240195404" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pnkfelix <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/unstable.20fingerprints.20-.20actually.20in.201.2E52.20.2384970.html#240195404">(May 25 2021 at 14:25)</a>:</h4>
<p>have we gotten any bug reports against the beta for fingerprint issues?</p>



<a name="240195627"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/unstable%20fingerprints%20-%20actually%20in%201.52%20%2384970/near/240195627" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pnkfelix <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/unstable.20fingerprints.20-.20actually.20in.201.2E52.20.2384970.html#240195627">(May 25 2021 at 14:26)</a>:</h4>
<p>we haven’t actively advertised for people to try the beta, of course. But the reality might be that these bugs are rare enough that disabling incremental on 1.53 is not warranted</p>



<a name="240196301"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/unstable%20fingerprints%20-%20actually%20in%201.52%20%2384970/near/240196301" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pnkfelix <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/unstable.20fingerprints.20-.20actually.20in.201.2E52.20.2384970.html#240196301">(May 25 2021 at 14:31)</a>:</h4>
<p>So okay: Based on the feedback here, I’m thinking a reasonable approach is 1. let the incr-comp fixes ride the trains, 2. make a blog post asking people to try the beta and give us feedback (but also be honest in it, and say that some fixes are riding the trains). I personally would like to add a step: 3. Based on feedback from the beta usage, let that feedback drive whether to disable incr-comp by default in 1.53.</p>



<a name="240196484"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/unstable%20fingerprints%20-%20actually%20in%201.52%20%2384970/near/240196484" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pnkfelix <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/unstable.20fingerprints.20-.20actually.20in.201.2E52.20.2384970.html#240196484">(May 25 2021 at 14:33)</a>:</h4>
<p>but for that step 3 to work in practice, we might need a channel for <em>positive</em> feedback as well as negative. I.e. easy ways for developers to say “I am using the beta a non-release+non-benchmarking profile, and I have not yet had any fingerprint issues."</p>



<a name="240197123"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/unstable%20fingerprints%20-%20actually%20in%201.52%20%2384970/near/240197123" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wesley Wiser <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/unstable.20fingerprints.20-.20actually.20in.201.2E52.20.2384970.html#240197123">(May 25 2021 at 14:37)</a>:</h4>
<p>Strongly agree with that last point. If we hear nothing, we have no way of knowing if everything worked correctly or no one is trying beta.</p>



<a name="240197183"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/unstable%20fingerprints%20-%20actually%20in%201.52%20%2384970/near/240197183" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pnkfelix <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/unstable.20fingerprints.20-.20actually.20in.201.2E52.20.2384970.html#240197183">(May 25 2021 at 14:37)</a>:</h4>
<p>luckily, a blog post can include a link to such a feedback channel</p>



<a name="240211226"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/unstable%20fingerprints%20-%20actually%20in%201.52%20%2384970/near/240211226" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pnkfelix <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/unstable.20fingerprints.20-.20actually.20in.201.2E52.20.2384970.html#240211226">(May 25 2021 at 16:06)</a>:</h4>
<p>What form should the feedback channel take? Github votes? Tweets?</p>



<a name="240214048"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/unstable%20fingerprints%20-%20actually%20in%201.52%20%2384970/near/240214048" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> simulacrum <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/unstable.20fingerprints.20-.20actually.20in.201.2E52.20.2384970.html#240214048">(May 25 2021 at 16:27)</a>:</h4>
<p>GitHub would be my preference</p>



<a name="240214063"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/unstable%20fingerprints%20-%20actually%20in%201.52%20%2384970/near/240214063" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> simulacrum <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/unstable.20fingerprints.20-.20actually.20in.201.2E52.20.2384970.html#240214063">(May 25 2021 at 16:27)</a>:</h4>
<p>Or an internals thread</p>



<a name="240233705"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/unstable%20fingerprints%20-%20actually%20in%201.52%20%2384970/near/240233705" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pnkfelix <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/unstable.20fingerprints.20-.20actually.20in.201.2E52.20.2384970.html#240233705">(May 25 2021 at 18:55)</a>:</h4>
<p><span class="user-mention silent" data-user-id="116083">pnkfelix</span> <a href="#narrow/stream/131828-t-compiler/topic/unstable.20fingerprints.20-.20actually.20in.201.2E52.20.2384970/near/240196301">said</a>:</p>
<blockquote>
<p>So okay: Based on the feedback here, I’m thinking a reasonable approach is 1. let the incr-comp fixes ride the trains, 2. make a blog post asking people to try the beta and give us feedback (but also be honest in it, and say that some fixes are riding the trains). I personally would like to add a step: 3. Based on feedback from the beta usage, let that feedback drive whether to disable incr-comp by default in 1.53.</p>
</blockquote>
<p>After some further reflection and discussion with others, I’m now inclined to port the change that we made 1.52.1 up to the beta channel, and then write a blog post advertising that people try out the beta <em>with</em> the <code>RUSTC_FORCE_INCREMENTAL=1</code> flag, and give us feedback accordingly.</p>



<a name="240233796"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/unstable%20fingerprints%20-%20actually%20in%201.52%20%2384970/near/240233796" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pnkfelix <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/unstable.20fingerprints.20-.20actually.20in.201.2E52.20.2384970.html#240233796">(May 25 2021 at 18:56)</a>:</h4>
<p>that way, we engage with our users, but also make it clear that we are asking them to opt in to helping us test out these changes and prioritize whether to backport other fixes.</p>



<a name="240233844"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/unstable%20fingerprints%20-%20actually%20in%201.52%20%2384970/near/240233844" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> simulacrum <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/unstable.20fingerprints.20-.20actually.20in.201.2E52.20.2384970.html#240233844">(May 25 2021 at 18:56)</a>:</h4>
<p>I think I'd trust experience reports a lot more without the opt-in backported</p>



<a name="240233869"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/unstable%20fingerprints%20-%20actually%20in%201.52%20%2384970/near/240233869" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pnkfelix <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/unstable.20fingerprints.20-.20actually.20in.201.2E52.20.2384970.html#240233869">(May 25 2021 at 18:56)</a>:</h4>
<p>why is that?</p>



<a name="240233885"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/unstable%20fingerprints%20-%20actually%20in%201.52%20%2384970/near/240233885" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> simulacrum <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/unstable.20fingerprints.20-.20actually.20in.201.2E52.20.2384970.html#240233885">(May 25 2021 at 18:57)</a>:</h4>
<p>because I don't trust users to not get the opt-in wrong</p>



<a name="240233904"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/unstable%20fingerprints%20-%20actually%20in%201.52%20%2384970/near/240233904" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> simulacrum <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/unstable.20fingerprints.20-.20actually.20in.201.2E52.20.2384970.html#240233904">(May 25 2021 at 18:57)</a>:</h4>
<p>it's "hard" to tell if you did that (intentionally so)</p>



<a name="240233943"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/unstable%20fingerprints%20-%20actually%20in%201.52%20%2384970/near/240233943" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pnkfelix <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/unstable.20fingerprints.20-.20actually.20in.201.2E52.20.2384970.html#240233943">(May 25 2021 at 18:57)</a>:</h4>
<p>Ah, you are worried about getting too much <em>positive</em> feedback (saying “no bugs found here”), right?</p>



<a name="240233950"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/unstable%20fingerprints%20-%20actually%20in%201.52%20%2384970/near/240233950" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> simulacrum <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/unstable.20fingerprints.20-.20actually.20in.201.2E52.20.2384970.html#240233950">(May 25 2021 at 18:57)</a>:</h4>
<p>right, yes</p>



<a name="240233987"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/unstable%20fingerprints%20-%20actually%20in%201.52%20%2384970/near/240233987" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> simulacrum <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/unstable.20fingerprints.20-.20actually.20in.201.2E52.20.2384970.html#240233987">(May 25 2021 at 18:58)</a>:</h4>
<p>I'd rather beta be as close to what we'd deploy in the "may cause bugs" sense</p>



<a name="240234046"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/unstable%20fingerprints%20-%20actually%20in%201.52%20%2384970/near/240234046" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> simulacrum <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/unstable.20fingerprints.20-.20actually.20in.201.2E52.20.2384970.html#240234046">(May 25 2021 at 18:58)</a>:</h4>
<p>since enabling the opt-in is the "more reliable" option in some sense, as it basically disables incremental</p>



<a name="240234054"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/unstable%20fingerprints%20-%20actually%20in%201.52%20%2384970/near/240234054" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> simulacrum <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/unstable.20fingerprints.20-.20actually.20in.201.2E52.20.2384970.html#240234054">(May 25 2021 at 18:58)</a>:</h4>
<p>it's never <em>bad</em> for correctness, just performance</p>



<a name="240234085"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/unstable%20fingerprints%20-%20actually%20in%201.52%20%2384970/near/240234085" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pnkfelix <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/unstable.20fingerprints.20-.20actually.20in.201.2E52.20.2384970.html#240234085">(May 25 2021 at 18:58)</a>:</h4>
<p>So, an unstated change in my thinking above is that I would just abandon shipping 1.53 with incr-comp turned back on by default</p>



<a name="240234115"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/unstable%20fingerprints%20-%20actually%20in%201.52%20%2384970/near/240234115" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pnkfelix <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/unstable.20fingerprints.20-.20actually.20in.201.2E52.20.2384970.html#240234115">(May 25 2021 at 18:59)</a>:</h4>
<p>i.e. we don’t need the positive feedback channel  anymore</p>



<a name="240234134"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/unstable%20fingerprints%20-%20actually%20in%201.52%20%2384970/near/240234134" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> simulacrum <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/unstable.20fingerprints.20-.20actually.20in.201.2E52.20.2384970.html#240234134">(May 25 2021 at 18:59)</a>:</h4>
<p>hm</p>



<a name="240234165"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/unstable%20fingerprints%20-%20actually%20in%201.52%20%2384970/near/240234165" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> simulacrum <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/unstable.20fingerprints.20-.20actually.20in.201.2E52.20.2384970.html#240234165">(May 25 2021 at 18:59)</a>:</h4>
<p>it's not clear to me why we'd do that, at this point, personally, given the data we have so far</p>



<a name="240234197"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/unstable%20fingerprints%20-%20actually%20in%201.52%20%2384970/near/240234197" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pnkfelix <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/unstable.20fingerprints.20-.20actually.20in.201.2E52.20.2384970.html#240234197">(May 25 2021 at 18:59)</a>:</h4>
<p>I suppose <span class="user-mention" data-user-id="116122">@simulacrum</span> ’s point still implies that we might incorrectly prioritize what to back port.</p>



<a name="240234198"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/unstable%20fingerprints%20-%20actually%20in%201.52%20%2384970/near/240234198" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> simulacrum <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/unstable.20fingerprints.20-.20actually.20in.201.2E52.20.2384970.html#240234198">(May 25 2021 at 18:59)</a>:</h4>
<p>it's not like incremental or the compiler never ICEs</p>



<a name="240234205"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/unstable%20fingerprints%20-%20actually%20in%201.52%20%2384970/near/240234205" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pnkfelix <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/unstable.20fingerprints.20-.20actually.20in.201.2E52.20.2384970.html#240234205">(May 25 2021 at 18:59)</a>:</h4>
<p>So, an unstated change in my thinking above is that I would just abandon shipping 1.53 with incr-comp turned back on by default</p>



<a name="240234346"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/unstable%20fingerprints%20-%20actually%20in%201.52%20%2384970/near/240234346" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pnkfelix <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/unstable.20fingerprints.20-.20actually.20in.201.2E52.20.2384970.html#240234346">(May 25 2021 at 19:00)</a>:</h4>
<p>we should be striving for it to never ICE</p>



<a name="240234387"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/unstable%20fingerprints%20-%20actually%20in%201.52%20%2384970/near/240234387" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pnkfelix <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/unstable.20fingerprints.20-.20actually.20in.201.2E52.20.2384970.html#240234387">(May 25 2021 at 19:01)</a>:</h4>
<p>the realities of developer resources have meant we couldn’t enforce it</p>



<a name="240234555"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/unstable%20fingerprints%20-%20actually%20in%201.52%20%2384970/near/240234555" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pnkfelix <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/unstable.20fingerprints.20-.20actually.20in.201.2E52.20.2384970.html#240234555">(May 25 2021 at 19:02)</a>:</h4>
<p><span class="user-mention silent" data-user-id="116122">simulacrum</span> <a href="#narrow/stream/131828-t-compiler/topic/unstable.20fingerprints.20-.20actually.20in.201.2E52.20.2384970/near/240234165">said</a>:</p>
<blockquote>
<p>it's not clear to me why we'd do that, at this point, personally, given the data we have so far</p>
</blockquote>
<p>by “data” here, you mean the anecdotal reports that the beta today works great, right?</p>



<a name="240234589"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/unstable%20fingerprints%20-%20actually%20in%201.52%20%2384970/near/240234589" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> simulacrum <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/unstable.20fingerprints.20-.20actually.20in.201.2E52.20.2384970.html#240234589">(May 25 2021 at 19:02)</a>:</h4>
<p>well, I mean, I guess what I'm saying is: we're not looking at a difference between a compiler with no bugs and some bugs. We're looking at the difference between some bugs and some more bugs. And since "some bugs" has always been the case, realistically, I don't see what we gain by disabling incremental for another cycle <em>presuming</em> we don't expect that beta is actually going to cause users to -- in the common case -- hit these ICEs on every build, like we were hearing in 1.52</p>



<a name="240234605"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/unstable%20fingerprints%20-%20actually%20in%201.52%20%2384970/near/240234605" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> simulacrum <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/unstable.20fingerprints.20-.20actually.20in.201.2E52.20.2384970.html#240234605">(May 25 2021 at 19:02)</a>:</h4>
<p><span class="user-mention silent" data-user-id="116083">pnkfelix</span> <a href="#narrow/stream/131828-t-compiler/topic/unstable.20fingerprints.20-.20actually.20in.201.2E52.20.2384970/near/240234555">said</a>:</p>
<blockquote>
<p><span class="user-mention silent" data-user-id="116122">simulacrum</span> <a href="#narrow/stream/131828-t-compiler/topic/unstable.20fingerprints.20-.20actually.20in.201.2E52.20.2384970/near/240234165">said</a>:</p>
<blockquote>
<p>it's not clear to me why we'd do that, at this point, personally, given the data we have so far</p>
</blockquote>
<p>by “data” here, you mean the anecdotal reports that the beta today works great, right?</p>
</blockquote>
<p>yes</p>



<a name="240234920"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/unstable%20fingerprints%20-%20actually%20in%201.52%20%2384970/near/240234920" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pnkfelix <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/unstable.20fingerprints.20-.20actually.20in.201.2E52.20.2384970.html#240234920">(May 25 2021 at 19:05)</a>:</h4>
<p><span class="user-mention silent" data-user-id="116122">simulacrum</span> <a href="#narrow/stream/131828-t-compiler/topic/unstable.20fingerprints.20-.20actually.20in.201.2E52.20.2384970/near/240233885">said</a>:</p>
<blockquote>
<p>because I don't trust users to not get the opt-in wrong</p>
</blockquote>
<p>I hadn’t considered this point in my conclusion above. I’ll have to reflect further on it.</p>



<a name="240235141"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/unstable%20fingerprints%20-%20actually%20in%201.52%20%2384970/near/240235141" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pnkfelix <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/unstable.20fingerprints.20-.20actually.20in.201.2E52.20.2384970.html#240235141">(May 25 2021 at 19:07)</a>:</h4>
<p>the more I think about the things I would like to say in a blog post, the more I worry that certain aspects of it (e.g. bemoaning the lack of support for telemetry in <code>rustc</code>) do not belong on blog.rlo; it would be more suitable for <a href="http://blog.pnkfx.org">blog.pnkfx.org</a></p>



<a name="240235206"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/unstable%20fingerprints%20-%20actually%20in%201.52%20%2384970/near/240235206" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pnkfelix <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/unstable.20fingerprints.20-.20actually.20in.201.2E52.20.2384970.html#240235206">(May 25 2021 at 19:07)</a>:</h4>
<p>so I need to get my thoughts properly oriented with a voice that is suitable for blog.rlo</p>



<a name="240235332"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/unstable%20fingerprints%20-%20actually%20in%201.52%20%2384970/near/240235332" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> simulacrum <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/unstable.20fingerprints.20-.20actually.20in.201.2E52.20.2384970.html#240235332">(May 25 2021 at 19:08)</a>:</h4>
<p>I guess to put it concretely: if we are precluding publishing 1.53 with incremental on, I don't know that a <em>separate</em> blog post is necessary. We can make a note in the main blog that this is the case and about the switch to re-enable it (RUSTC_FORCE_INCREMENTAL).</p>



<a name="240235464"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/unstable%20fingerprints%20-%20actually%20in%201.52%20%2384970/near/240235464" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pnkfelix <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/unstable.20fingerprints.20-.20actually.20in.201.2E52.20.2384970.html#240235464">(May 25 2021 at 19:09)</a>:</h4>
<p>the main reason I was still thinking of making a blog post advocating for people to try the beta <em>with</em> <code>RUSTC_FORCE_INCREMENTAL</code> was to get feedback about whether we need to increase the priority of certain 1.54 -&gt; 1.53 backports.</p>



<a name="240235497"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/unstable%20fingerprints%20-%20actually%20in%201.52%20%2384970/near/240235497" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> simulacrum <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/unstable.20fingerprints.20-.20actually.20in.201.2E52.20.2384970.html#240235497">(May 25 2021 at 19:10)</a>:</h4>
<p>But if we're not, then the blog post seems like it should be:</p>
<ul>
<li>quick summary, with link to 1.52.1 blog post for more details</li>
<li>ask to run rustup update beta &amp;&amp; rustup default beta (or so), and report any bugs encountered in development, with an emphasis on incremental ICEs</li>
</ul>
<p>Nothing further.</p>



<a name="240235617"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/unstable%20fingerprints%20-%20actually%20in%201.52%20%2384970/near/240235617" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> simulacrum <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/unstable.20fingerprints.20-.20actually.20in.201.2E52.20.2384970.html#240235617">(May 25 2021 at 19:11)</a>:</h4>
<p>I have no opposition to that, but I think it would be pretty odd for us to (continue/add more) backports to 1.53, which all carry some risk, if we're not enabling by default, given that initial data suggests the <em>original</em> beta was already pretty solid</p>



<a name="240340823"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/unstable%20fingerprints%20-%20actually%20in%201.52%20%2384970/near/240340823" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pnkfelix <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/unstable.20fingerprints.20-.20actually.20in.201.2E52.20.2384970.html#240340823">(May 26 2021 at 15:15)</a>:</h4>
<p>Rather that go all the way to a blog post, I’m trying a light weight poll to start with: <a href="https://twitter.com/pnkfelix/status/1397571643405475840">https://twitter.com/pnkfelix/status/1397571643405475840</a> ; retweets very much encouraged</p>
<div class="inline-preview-twitter"><div class="twitter-tweet"><a href="https://twitter.com/pnkfelix/status/1397571643405475840"><img class="twitter-avatar" src="https://uploads.zulipusercontent.net/d481cd182b8f1b51780eee2728ea0a624dbecbcd/68747470733a2f2f7062732e7477696d672e636f6d2f70726f66696c655f696d616765732f3337383830303030303334393736343032352f62396537363762326535656263363331383738323633623732613832313631655f6e6f726d616c2e706e67"></a><p>Quick poll for developers who normally would be using an up-to-date Rust stable: Are you currently:</p><span>- Felix S K II (@pnkfelix)</span></div></div>



<a name="240344808"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/unstable%20fingerprints%20-%20actually%20in%201.52%20%2384970/near/240344808" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pnkfelix <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/unstable.20fingerprints.20-.20actually.20in.201.2E52.20.2384970.html#240344808">(May 26 2021 at 15:38)</a>:</h4>
<p><span class="user-mention" data-user-id="116122">@simulacrum</span> ’s point about people getting the <code>RUSTC_FORCE_INCREMENTAL=1</code> env var wrong is making me think that it would likewise be wrong to port that change to the beta channel. Or at least, people might currently be opting to use the beta rather than deal with that env var, and those people might prefer to <em>keep doing so</em> when 1.53 is released: That is, they may well prefer to continue with 1.54-beta rather than figure out how to do <code>RUSTC_FORCE_INCREMENTAL</code> with 1.53 stable.</p>



<a name="240353279"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/unstable%20fingerprints%20-%20actually%20in%201.52%20%2384970/near/240353279" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pnkfelix <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/unstable.20fingerprints.20-.20actually.20in.201.2E52.20.2384970.html#240353279">(May 26 2021 at 16:35)</a>:</h4>
<p>(and, to be clear: My concern is that we would be doing disservice to those developers if we add the <code>RUSTC_FORCE_INCREMENAL</code> env var to the 1.53-beta channel.)</p>



<a name="240381635"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/unstable%20fingerprints%20-%20actually%20in%201.52%20%2384970/near/240381635" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Carol (Nichols || Goulding) <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/unstable.20fingerprints.20-.20actually.20in.201.2E52.20.2384970.html#240381635">(May 26 2021 at 19:54)</a>:</h4>
<p>soooo if i just hit <a href="https://github.com/rust-lang/rust/issues/83538">#83538</a> (<code>evaluate_obligation</code> <code>EvaluatedToOk</code>) in 1.53.0-beta.3 (the table in <a href="https://github.com/rust-lang/rust/issues/84970">#84970</a> says the fix for that is in 1.54), where would you like that noted?</p>



<a name="240381822"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/unstable%20fingerprints%20-%20actually%20in%201.52%20%2384970/near/240381822" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Carol (Nichols || Goulding) <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/unstable.20fingerprints.20-.20actually.20in.201.2E52.20.2384970.html#240381822">(May 26 2021 at 19:55)</a>:</h4>
<p>this <em>is</em> the first incr comp ICE i've hit since switching to the 1.53 betas whenever i said that i'd been using beta in here like a week or two ago, so it's <em>much</em> improved on beta</p>



<a name="240382221"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/unstable%20fingerprints%20-%20actually%20in%201.52%20%2384970/near/240382221" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> simulacrum <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/unstable.20fingerprints.20-.20actually.20in.201.2E52.20.2384970.html#240382221">(May 26 2021 at 19:58)</a>:</h4>
<p>I think leaving a comment  on <a href="https://github.com/rust-lang/rust/issues/84970">#84970</a> is good</p>



<a name="240477902"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/unstable%20fingerprints%20-%20actually%20in%201.52%20%2384970/near/240477902" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Aaron Hill <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/unstable.20fingerprints.20-.20actually.20in.201.2E52.20.2384970.html#240477902">(May 27 2021 at 14:41)</a>:</h4>
<p>There's still at least one open <code>evaluate_obligation</code> issue that I'm aware of</p>



<a name="240477981"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/unstable%20fingerprints%20-%20actually%20in%201.52%20%2384970/near/240477981" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Aaron Hill <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/unstable.20fingerprints.20-.20actually.20in.201.2E52.20.2384970.html#240477981">(May 27 2021 at 14:41)</a>:</h4>
<p>One of my recent fixes didn't actually fix the crash a user was getting (though it did slightly improve performance)</p>



<a name="240478065"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/unstable%20fingerprints%20-%20actually%20in%201.52%20%2384970/near/240478065" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Aaron Hill <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/unstable.20fingerprints.20-.20actually.20in.201.2E52.20.2384970.html#240478065">(May 27 2021 at 14:42)</a>:</h4>
<p>I'm working on fixing it, but it might take me a little while</p>



<a name="240535398"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/unstable%20fingerprints%20-%20actually%20in%201.52%20%2384970/near/240535398" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pnkfelix <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/unstable.20fingerprints.20-.20actually.20in.201.2E52.20.2384970.html#240535398">(May 27 2021 at 21:37)</a>:</h4>
<p>for people who were not in today’s compiler team meeting: We’ll be discussing this issue in tomorrow’s steering meeting, and we are gathering thoughts ahead of time in <a href="https://hackmd.io/vXRZ4RiNRKWVlDChmsCriA">hackmd: What to do re: incr-comp and 1.53 release</a>. Feel free to jot down a new Argument/Narrative at end if you think your Point Of View is not represented by any that are currently there.</p>



<a name="240597416"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/unstable%20fingerprints%20-%20actually%20in%201.52%20%2384970/near/240597416" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> mw <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/unstable.20fingerprints.20-.20actually.20in.201.2E52.20.2384970.html#240597416">(May 28 2021 at 12:35)</a>:</h4>
<p>I just posted <a href="https://github.com/rust-lang/rust/issues/85783">https://github.com/rust-lang/rust/issues/85783</a> which argues that the fingerprint stability checks enabled so far don't cover all the potentially dangerous cases. I think this is relevant to the discussion because it means that there might be even more "unstable fingerprint ICEs" out there waiting to be discovered (even if they are actually harmless).</p>



<a name="240597595"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/unstable%20fingerprints%20-%20actually%20in%201.52%20%2384970/near/240597595" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> mw <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/unstable.20fingerprints.20-.20actually.20in.201.2E52.20.2384970.html#240597595">(May 28 2021 at 12:36)</a>:</h4>
<p><span aria-label="point up" class="emoji emoji-1f446" role="img" title="point up">:point_up:</span> <span class="user-group-mention" data-user-group-id="3282">@wg-incr-comp</span></p>



<a name="240597665"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/unstable%20fingerprints%20-%20actually%20in%201.52%20%2384970/near/240597665" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> mw <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/unstable.20fingerprints.20-.20actually.20in.201.2E52.20.2384970.html#240597665">(May 28 2021 at 12:37)</a>:</h4>
<p><span aria-label="point up" class="emoji emoji-1f446" role="img" title="point up">:point_up:</span> <span class="user-group-mention" data-user-group-id="897">@T-compiler/meeting</span></p>



<a name="240598411"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/unstable%20fingerprints%20-%20actually%20in%201.52%20%2384970/near/240598411" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> simulacrum <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/unstable.20fingerprints.20-.20actually.20in.201.2E52.20.2384970.html#240598411">(May 28 2021 at 12:44)</a>:</h4>
<p>It's already known that this is a problem, just it's a 5-10% performance hit to enable this validation iirc</p>



<a name="240598421"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/unstable%20fingerprints%20-%20actually%20in%201.52%20%2384970/near/240598421" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> simulacrum <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/unstable.20fingerprints.20-.20actually.20in.201.2E52.20.2384970.html#240598421">(May 28 2021 at 12:44)</a>:</h4>
<p>There's a PR floating around</p>



<a name="240598537"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/unstable%20fingerprints%20-%20actually%20in%201.52%20%2384970/near/240598537" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> simulacrum <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/unstable.20fingerprints.20-.20actually.20in.201.2E52.20.2384970.html#240598537">(May 28 2021 at 12:45)</a>:</h4>
<p>Well, theoretical problem that is</p>



<a name="240601929"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/unstable%20fingerprints%20-%20actually%20in%201.52%20%2384970/near/240601929" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> mw <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/unstable.20fingerprints.20-.20actually.20in.201.2E52.20.2384970.html#240601929">(May 28 2021 at 13:14)</a>:</h4>
<p>Well, I know that we did not check all cases but so far I assumed that the unchecked cases are harmless.</p>



<a name="240603066"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/unstable%20fingerprints%20-%20actually%20in%201.52%20%2384970/near/240603066" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pnkfelix <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/unstable.20fingerprints.20-.20actually.20in.201.2E52.20.2384970.html#240603066">(May 28 2021 at 13:24)</a>:</h4>
<p>Is there a <code>-Z</code> flag available for the extra validation yet?</p>



<a name="240603125"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/unstable%20fingerprints%20-%20actually%20in%201.52%20%2384970/near/240603125" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> mw <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/unstable.20fingerprints.20-.20actually.20in.201.2E52.20.2384970.html#240603125">(May 28 2021 at 13:25)</a>:</h4>
<p>Yes, it's the regular <code>-Zverify-ich</code> flag</p>



<a name="240603482"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/unstable%20fingerprints%20-%20actually%20in%201.52%20%2384970/near/240603482" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> mw <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/unstable.20fingerprints.20-.20actually.20in.201.2E52.20.2384970.html#240603482">(May 28 2021 at 13:27)</a>:</h4>
<p><a href="https://github.com/rust-lang/rust/pull/83007">https://github.com/rust-lang/rust/pull/83007</a> has timings for both cases</p>



<a name="240605424"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/unstable%20fingerprints%20-%20actually%20in%201.52%20%2384970/near/240605424" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> mw <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/unstable.20fingerprints.20-.20actually.20in.201.2E52.20.2384970.html#240605424">(May 28 2021 at 13:43)</a>:</h4>
<p>I created <a href="https://github.com/rust-lang/rust/pull/85784">https://github.com/rust-lang/rust/pull/85784</a> to get up-to-date numbers</p>



<hr><p>Last updated: Aug 07 2021 at 22:04 UTC</p>
</html>