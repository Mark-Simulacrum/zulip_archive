<html>
<head><meta charset="utf-8"><title>channel bug: &quot;Instruction does not dominate all uses&quot; #72470 · t-compiler · Zulip Chat Archive</title></head>
<h2>Stream: <a href="https://zulip-archive.rust-lang.org/stream/131828-t-compiler/index.html">t-compiler</a></h2>
<h3>Topic: <a href="https://zulip-archive.rust-lang.org/stream/131828-t-compiler/topic/channel.20bug.3A.20.22Instruction.20does.20not.20dominate.20all.20uses.22.20.2372470.html">channel bug: &quot;Instruction does not dominate all uses&quot; #72470</a></h3>

<hr>

<base href="https://rust-lang.zulipchat.com">

<head><link href="https://zulip-archive.rust-lang.org/style.css" rel="stylesheet"></head>

<a name="205911503"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/channel%20bug%3A%20%22Instruction%20does%20not%20dominate%20all%20uses%22%20%2372470/near/205911503" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pnkfelix <a href="https://zulip-archive.rust-lang.org/stream/131828-t-compiler/topic/channel.20bug.3A.20.22Instruction.20does.20not.20dominate.20all.20uses.22.20.2372470.html#205911503">(Aug 04 2020 at 14:14)</a>:</h4>
<p>hey <span class="user-mention" data-user-id="211727">@Jonas Schievink</span> , I was trying to understand one of your comments on <a href="https://github.com/rust-lang/rust/issues/72470">#72470</a></p>



<a name="205911519"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/channel%20bug%3A%20%22Instruction%20does%20not%20dominate%20all%20uses%22%20%2372470/near/205911519" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pnkfelix <a href="https://zulip-archive.rust-lang.org/stream/131828-t-compiler/topic/channel.20bug.3A.20.22Instruction.20does.20not.20dominate.20all.20uses.22.20.2372470.html#205911519">(Aug 04 2020 at 14:14)</a>:</h4>
<p>when you noted that cross-compiling was painful</p>



<a name="205911564"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/channel%20bug%3A%20%22Instruction%20does%20not%20dominate%20all%20uses%22%20%2372470/near/205911564" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pnkfelix <a href="https://zulip-archive.rust-lang.org/stream/131828-t-compiler/topic/channel.20bug.3A.20.22Instruction.20does.20not.20dominate.20all.20uses.22.20.2372470.html#205911564">(Aug 04 2020 at 14:14)</a>:</h4>
<p>did you actually manage to replicate the variant of the bug that <strong>I posted</strong> via cross-compilation atop Linux??</p>



<a name="205911598"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/channel%20bug%3A%20%22Instruction%20does%20not%20dominate%20all%20uses%22%20%2372470/near/205911598" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jonas Schievink  [he/him] <a href="https://zulip-archive.rust-lang.org/stream/131828-t-compiler/topic/channel.20bug.3A.20.22Instruction.20does.20not.20dominate.20all.20uses.22.20.2372470.html#205911598">(Aug 04 2020 at 14:15)</a>:</h4>
<p>Yeah :)</p>



<a name="205911601"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/channel%20bug%3A%20%22Instruction%20does%20not%20dominate%20all%20uses%22%20%2372470/near/205911601" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pnkfelix <a href="https://zulip-archive.rust-lang.org/stream/131828-t-compiler/topic/channel.20bug.3A.20.22Instruction.20does.20not.20dominate.20all.20uses.22.20.2372470.html#205911601">(Aug 04 2020 at 14:15)</a>:</h4>
<p>if so, I'd love to know how to do it; I'd much prefer to debug this there</p>



<a name="205911648"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/channel%20bug%3A%20%22Instruction%20does%20not%20dominate%20all%20uses%22%20%2372470/near/205911648" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jonas Schievink  [he/him] <a href="https://zulip-archive.rust-lang.org/stream/131828-t-compiler/topic/channel.20bug.3A.20.22Instruction.20does.20not.20dominate.20all.20uses.22.20.2372470.html#205911648">(Aug 04 2020 at 14:15)</a>:</h4>
<p>Since it's an LLVM error no MSVC linker is needed to reproduce it</p>



<a name="205911658"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/channel%20bug%3A%20%22Instruction%20does%20not%20dominate%20all%20uses%22%20%2372470/near/205911658" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pnkfelix <a href="https://zulip-archive.rust-lang.org/stream/131828-t-compiler/topic/channel.20bug.3A.20.22Instruction.20does.20not.20dominate.20all.20uses.22.20.2372470.html#205911658">(Aug 04 2020 at 14:15)</a>:</h4>
<p>I'm already not great at debugging LLVM itself, but adding Windows tooling to the mix really makes it tough</p>



<a name="205911676"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/channel%20bug%3A%20%22Instruction%20does%20not%20dominate%20all%20uses%22%20%2372470/near/205911676" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jonas Schievink  [he/him] <a href="https://zulip-archive.rust-lang.org/stream/131828-t-compiler/topic/channel.20bug.3A.20.22Instruction.20does.20not.20dominate.20all.20uses.22.20.2372470.html#205911676">(Aug 04 2020 at 14:15)</a>:</h4>
<p>I just installed the Windows libstd component</p>



<a name="205911710"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/channel%20bug%3A%20%22Instruction%20does%20not%20dominate%20all%20uses%22%20%2372470/near/205911710" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pnkfelix <a href="https://zulip-archive.rust-lang.org/stream/131828-t-compiler/topic/channel.20bug.3A.20.22Instruction.20does.20not.20dominate.20all.20uses.22.20.2372470.html#205911710">(Aug 04 2020 at 14:16)</a>:</h4>
<p>explain to me like I'm five</p>



<a name="205911774"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/channel%20bug%3A%20%22Instruction%20does%20not%20dominate%20all%20uses%22%20%2372470/near/205911774" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jonas Schievink  [he/him] <a href="https://zulip-archive.rust-lang.org/stream/131828-t-compiler/topic/channel.20bug.3A.20.22Instruction.20does.20not.20dominate.20all.20uses.22.20.2372470.html#205911774">(Aug 04 2020 at 14:16)</a>:</h4>
<p>or target, rather</p>
<p><code>rustup target add x86_64-pc-windows-msvc</code></p>



<a name="205911797"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/channel%20bug%3A%20%22Instruction%20does%20not%20dominate%20all%20uses%22%20%2372470/near/205911797" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pnkfelix <a href="https://zulip-archive.rust-lang.org/stream/131828-t-compiler/topic/channel.20bug.3A.20.22Instruction.20does.20not.20dominate.20all.20uses.22.20.2372470.html#205911797">(Aug 04 2020 at 14:16)</a>:</h4>
<p>/me goes to try this</p>



<a name="205911819"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/channel%20bug%3A%20%22Instruction%20does%20not%20dominate%20all%20uses%22%20%2372470/near/205911819" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jonas Schievink  [he/him] <a href="https://zulip-archive.rust-lang.org/stream/131828-t-compiler/topic/channel.20bug.3A.20.22Instruction.20does.20not.20dominate.20all.20uses.22.20.2372470.html#205911819">(Aug 04 2020 at 14:16)</a>:</h4>
<p>And then <code>cargo build --release --target x86_64-pc-windows-msvc</code> should be enough to repro</p>



<a name="205911922"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/channel%20bug%3A%20%22Instruction%20does%20not%20dominate%20all%20uses%22%20%2372470/near/205911922" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pnkfelix <a href="https://zulip-archive.rust-lang.org/stream/131828-t-compiler/topic/channel.20bug.3A.20.22Instruction.20does.20not.20dominate.20all.20uses.22.20.2372470.html#205911922">(Aug 04 2020 at 14:17)</a>:</h4>
<p>also, thank you for your effort further reducing it</p>



<a name="205912078"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/channel%20bug%3A%20%22Instruction%20does%20not%20dominate%20all%20uses%22%20%2372470/near/205912078" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pnkfelix <a href="https://zulip-archive.rust-lang.org/stream/131828-t-compiler/topic/channel.20bug.3A.20.22Instruction.20does.20not.20dominate.20all.20uses.22.20.2372470.html#205912078">(Aug 04 2020 at 14:18)</a>:</h4>
<p>awesome, thanks!</p>



<a name="205912119"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/channel%20bug%3A%20%22Instruction%20does%20not%20dominate%20all%20uses%22%20%2372470/near/205912119" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jonas Schievink  [he/him] <a href="https://zulip-archive.rust-lang.org/stream/131828-t-compiler/topic/channel.20bug.3A.20.22Instruction.20does.20not.20dominate.20all.20uses.22.20.2372470.html#205912119">(Aug 04 2020 at 14:18)</a>:</h4>
<p>sure thing :)</p>



<a name="205918069"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/channel%20bug%3A%20%22Instruction%20does%20not%20dominate%20all%20uses%22%20%2372470/near/205918069" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pnkfelix <a href="https://zulip-archive.rust-lang.org/stream/131828-t-compiler/topic/channel.20bug.3A.20.22Instruction.20does.20not.20dominate.20all.20uses.22.20.2372470.html#205918069">(Aug 04 2020 at 15:02)</a>:</h4>
<p>(a very interesting digression followed the above; its in <a class="stream-topic" data-stream-id="131828" href="/#narrow/stream/131828-t-compiler/topic/bootstrap.20on.20linux.20w.2F.20support.20for.20cross-compiling.20to.20windows">#t-compiler &gt; bootstrap on linux w/ support for cross-compiling to windows</a> )</p>



<a name="205919513"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/channel%20bug%3A%20%22Instruction%20does%20not%20dominate%20all%20uses%22%20%2372470/near/205919513" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> mati865 <a href="https://zulip-archive.rust-lang.org/stream/131828-t-compiler/topic/channel.20bug.3A.20.22Instruction.20does.20not.20dominate.20all.20uses.22.20.2372470.html#205919513">(Aug 04 2020 at 15:14)</a>:</h4>
<p>It should probably specify windows-msvc, windows-gnu cross-compilation works fine ;)</p>



<hr><p>Last updated: Apr 12 2022 at 20:01 UTC</p>
</html>