<html>
<head><meta charset="utf-8"><title>`llvm-nm` not found · t-compiler · Zulip Chat Archive</title></head>
<h2>Stream: <a href="https://zulip-archive.rust-lang.org/stream/131828-t-compiler/index.html">t-compiler</a></h2>
<h3>Topic: <a href="https://zulip-archive.rust-lang.org/stream/131828-t-compiler/topic/.60llvm-nm.60.20not.20found.html">`llvm-nm` not found</a></h3>

<hr>

<base href="https://rust-lang.zulipchat.com">

<head><link href="https://zulip-archive.rust-lang.org/style.css" rel="stylesheet"></head>

<a name="272595626"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/%60llvm-nm%60%20not%20found/near/272595626" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Hameer Abbasi <a href="https://zulip-archive.rust-lang.org/stream/131828-t-compiler/topic/.60llvm-nm.60.20not.20found.html#272595626">(Feb 20 2022 at 14:27)</a>:</h4>
<p>Hello, I just cloned the compiler and run the test-suite. Commit: <code>g6d7aa4763fe</code>, it seems that with <code>download-ci-llvm = true</code> in <code>config.toml</code>, I get the following failures with <code>./x.py test</code>:</p>
<div class="codehilite"><pre><span></span><code>---- [run-make] run-make-fulldeps/static-nobundle stdout ----

error: make failed
status: exit status: 2
command: &quot;make&quot;
stdout:
------------------------------------------
cc -ffunction-sections -fdata-sections -fPIC -m64 -arch x86_64 -stdlib=libc++ -c -o /Users/hameerabbasi/Quansight/rust/build/x86_64-apple-darwin/test/run-make-fulldeps/static-nobundle/static-nobundle/libaaa.o aaa.c
ar crus /Users/hameerabbasi/Quansight/rust/build/x86_64-apple-darwin/test/run-make-fulldeps/static-nobundle/static-nobundle/libaaa.a /Users/hameerabbasi/Quansight/rust/build/x86_64-apple-darwin/test/run-make-fulldeps/static-nobundle/static-nobundle/libaaa.o
DYLD_LIBRARY_PATH=&quot;/Users/hameerabbasi/Quansight/rust/build/x86_64-apple-darwin/test/run-make-fulldeps/static-nobundle/static-nobundle:/Users/hameerabbasi/Quansight/rust/build/x86_64-apple-darwin/stage1/lib:&quot; &#39;/Users/hameerabbasi/Quansight/rust/build/x86_64-apple-darwin/stage1/bin/rustc&#39; --out-dir /Users/hameerabbasi/Quansight/rust/build/x86_64-apple-darwin/test/run-make-fulldeps/static-nobundle/static-nobundle -L /Users/hameerabbasi/Quansight/rust/build/x86_64-apple-darwin/test/run-make-fulldeps/static-nobundle/static-nobundle  bbb.rs --crate-type=rlib
# Check that bbb does NOT contain the definition of `native_func`
# We&#39;re using the llvm-nm instead of the system nm to ensure it
# is compatible with the LLVM bitcode generated by rustc.
&quot;/Users/hameerabbasi/Quansight/rust/build/x86_64-apple-darwin/ci-llvm/bin/llvm-nm&quot; /Users/hameerabbasi/Quansight/rust/build/x86_64-apple-darwin/test/run-make-fulldeps/static-nobundle/static-nobundle/libbbb.rlib | &quot;/Users/hameerabbasi/Quansight/rust/src/etc/cat-and-grep.sh&quot; -ve &quot;T _*native_func&quot;
[[[ begin stdout ]]]

[[[ end stdout ]]]
&quot;/Users/hameerabbasi/Quansight/rust/build/x86_64-apple-darwin/ci-llvm/bin/llvm-nm&quot; /Users/hameerabbasi/Quansight/rust/build/x86_64-apple-darwin/test/run-make-fulldeps/static-nobundle/static-nobundle/libbbb.rlib | &quot;/Users/hameerabbasi/Quansight/rust/src/etc/cat-and-grep.sh&quot; -e &quot;U _*native_func&quot;
[[[ begin stdout ]]]

[[[ end stdout ]]]
Error: cannot match: U _*native_func
rm /Users/hameerabbasi/Quansight/rust/build/x86_64-apple-darwin/test/run-make-fulldeps/static-nobundle/static-nobundle/libaaa.o

------------------------------------------
stderr:
------------------------------------------
warning: library kind `static-nobundle` has been superseded by specifying modifier `-bundle` with library kind `static`
 --&gt; bbb.rs:4:22
  |
4 | #[link(name = &quot;aaa&quot;, kind = &quot;static-nobundle&quot;)]
  |                      ^^^^^^^^^^^^^^^^^^^^^^^^

warning: 1 warning emitted

/bin/dash: 1: /Users/hameerabbasi/Quansight/rust/build/x86_64-apple-darwin/ci-llvm/bin/llvm-nm: not found
/bin/dash: 1: /Users/hameerabbasi/Quansight/rust/build/x86_64-apple-darwin/ci-llvm/bin/llvm-nm: not found
make: *** [all] Error 1

------------------------------------------



failures:
    [run-make] run-make-fulldeps/static-nobundle

test result: FAILED. 0 passed; 1 failed; 228 ignored; 0 measured; 0 filtered out; finished in 0.13s
</code></pre></div>



<a name="272596549"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/%60llvm-nm%60%20not%20found/near/272596549" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> bjorn3 <a href="https://zulip-archive.rust-lang.org/stream/131828-t-compiler/topic/.60llvm-nm.60.20not.20found.html#272596549">(Feb 20 2022 at 14:47)</a>:</h4>
<p>Likely caused by <a href="https://github.com/rust-lang/rust/issues/94023">#94023</a>.</p>



<a name="272597677"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/%60llvm-nm%60%20not%20found/near/272597677" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> simulacrum <a href="https://zulip-archive.rust-lang.org/stream/131828-t-compiler/topic/.60llvm-nm.60.20not.20found.html#272597677">(Feb 20 2022 at 15:07)</a>:</h4>
<p>Hm, probably we need to bump the stamp to download a new copy with llvm-nm included</p>



<a name="272802823"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/%60llvm-nm%60%20not%20found/near/272802823" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Krasimir Georgiev <a href="https://zulip-archive.rust-lang.org/stream/131828-t-compiler/topic/.60llvm-nm.60.20not.20found.html#272802823">(Feb 22 2022 at 13:35)</a>:</h4>
<p>Where's this stamp?</p>



<a name="272803344"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/%60llvm-nm%60%20not%20found/near/272803344" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> bjorn3 <a href="https://zulip-archive.rust-lang.org/stream/131828-t-compiler/topic/.60llvm-nm.60.20not.20found.html#272803344">(Feb 22 2022 at 13:39)</a>:</h4>
<p><a href="https://github.com/rust-lang/rust/blob/master/src/bootstrap/download-ci-llvm-stamp">https://github.com/rust-lang/rust/blob/master/src/bootstrap/download-ci-llvm-stamp</a></p>



<a name="272804237"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/%60llvm-nm%60%20not%20found/near/272804237" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Krasimir Georgiev <a href="https://zulip-archive.rust-lang.org/stream/131828-t-compiler/topic/.60llvm-nm.60.20not.20found.html#272804237">(Feb 22 2022 at 13:46)</a>:</h4>
<p>thank you! <a href="https://github.com/rust-lang/rust/pull/94259">https://github.com/rust-lang/rust/pull/94259</a></p>



<hr><p>Last updated: Apr 12 2022 at 20:01 UTC</p>
</html>