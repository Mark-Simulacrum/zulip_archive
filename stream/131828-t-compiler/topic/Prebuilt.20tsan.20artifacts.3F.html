<html>
<head><meta charset="utf-8"><title>Prebuilt tsan artifacts? · t-compiler · Zulip Chat Archive</title></head>
<h2>Stream: <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/index.html">t-compiler</a></h2>
<h3>Topic: <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/Prebuilt.20tsan.20artifacts.3F.html">Prebuilt tsan artifacts?</a></h3>

<hr>

<base href="https://rust-lang.zulipchat.com">

<head><link href="https://rust-lang.github.io/zulip_archive/style.css" rel="stylesheet"></head>

<a name="214966702"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/Prebuilt%20tsan%20artifacts%3F/near/214966702" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Gankra <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/Prebuilt.20tsan.20artifacts.3F.html#214966702">(Oct 29 2020 at 13:35)</a>:</h4>
<p>(Not sure if right place to discuss this) I'm currently looking into having the rust stdlib properly instrumented for TSan in Firefox's CI. It appears that the current blessed way to do this is with <code>cargo -Zbuild-std</code>, but that doesn't appear to play well with --build-plan (and therefore sccache). AFAICT the only reason to use this is to rebuild std with <code>-Zsanitizer=thread</code>. I get that providing artifacts for every target would be a huge combinatoric explosion, but TSan is already only supported on linux. Would it be unreasonable to provide prebuilt tsan artifacts  for the standard linux64 server/desktop target?</p>



<a name="214966838"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/Prebuilt%20tsan%20artifacts%3F/near/214966838" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> bjorn3 <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/Prebuilt.20tsan.20artifacts.3F.html#214966838">(Oct 29 2020 at 13:37)</a>:</h4>
<p>I thought sccache didn't use <code>--build-plan</code>, but instead <code>RUSTC_WRAPPER</code>.</p>



<a name="214966865"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/Prebuilt%20tsan%20artifacts%3F/near/214966865" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Gankra <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/Prebuilt.20tsan.20artifacts.3F.html#214966865">(Oct 29 2020 at 13:37)</a>:</h4>
<p>I might be mistaken, just started looking into it this morning</p>



<a name="214967013"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/Prebuilt%20tsan%20artifacts%3F/near/214967013" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Gankra <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/Prebuilt.20tsan.20artifacts.3F.html#214967013">(Oct 29 2020 at 13:38)</a>:</h4>
<p>(possibly this is a firefox build quirk and not an sccache one)</p>



<a name="214967260"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/Prebuilt%20tsan%20artifacts%3F/near/214967260" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Gankra <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/Prebuilt.20tsan.20artifacts.3F.html#214967260">(Oct 29 2020 at 13:41)</a>:</h4>
<p>Hmm, ok our build-system isn't using build-plan explicitly. Maybe it's something else that's tripping me up. Still, needing to rebuild std a bunch in CI isn't ideal.</p>



<a name="214967392"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/Prebuilt%20tsan%20artifacts%3F/near/214967392" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Nelson <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/Prebuilt.20tsan.20artifacts.3F.html#214967392">(Oct 29 2020 at 13:42)</a>:</h4>
<p>I would be surprised if firefox is using -Z build-std, it's still experimental AFAIK and fairly recent</p>



<a name="214967476"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/Prebuilt%20tsan%20artifacts%3F/near/214967476" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Gankra <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/Prebuilt.20tsan.20artifacts.3F.html#214967476">(Oct 29 2020 at 13:43)</a>:</h4>
<p>I am explicitly looking into using it for our TSan CI -- right now we have to supress all of libstd because Arc/Mutex and friends aren't instrumented</p>



<a name="214967521"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/Prebuilt%20tsan%20artifacts%3F/near/214967521" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Gankra <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/Prebuilt.20tsan.20artifacts.3F.html#214967521">(Oct 29 2020 at 13:43)</a>:</h4>
<p><a href="https://bugzilla.mozilla.org/show_bug.cgi?id=1671691">https://bugzilla.mozilla.org/show_bug.cgi?id=1671691</a></p>



<a name="214967649"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/Prebuilt%20tsan%20artifacts%3F/near/214967649" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Gankra <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/Prebuilt.20tsan.20artifacts.3F.html#214967649">(Oct 29 2020 at 13:44)</a>:</h4>
<p><a href="https://searchfox.org/mozilla-central/rev/a147181ece866c1ecd176ac49f112785f960aac0/mozglue/build/TsanOptions.cpp#176-190">https://searchfox.org/mozilla-central/rev/a147181ece866c1ecd176ac49f112785f960aac0/mozglue/build/TsanOptions.cpp#176-190</a></p>



<a name="214997208"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/Prebuilt%20tsan%20artifacts%3F/near/214997208" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Gankra <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/Prebuilt.20tsan.20artifacts.3F.html#214997208">(Oct 29 2020 at 17:03)</a>:</h4>
<p>status update: ok just some Make weirdness after all. Now I get to try to figure out how to resolve std dependency issues inside of a vendored environment (yaaay)</p>



<a name="214997311"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/Prebuilt%20tsan%20artifacts%3F/near/214997311" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Gankra <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/Prebuilt.20tsan.20artifacts.3F.html#214997311">(Oct 29 2020 at 17:04)</a>:</h4>
<p>(prebuilt artifacts would still be ........ useful for not dealing with this :)</p>



<a name="214997369"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/Prebuilt%20tsan%20artifacts%3F/near/214997369" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Nelson <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/Prebuilt.20tsan.20artifacts.3F.html#214997369">(Oct 29 2020 at 17:04)</a>:</h4>
<p>this might be a good addition to <code>rust-dev</code> <a href="https://github.com/rust-lang/rust/pull/76332">https://github.com/rust-lang/rust/pull/76332</a></p>



<a name="214997381"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/Prebuilt%20tsan%20artifacts%3F/near/214997381" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Nelson <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/Prebuilt.20tsan.20artifacts.3F.html#214997381">(Oct 29 2020 at 17:04)</a>:</h4>
<p>cc <span class="user-mention" data-user-id="116122">@simulacrum</span></p>



<a name="214997536"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/Prebuilt%20tsan%20artifacts%3F/near/214997536" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> simulacrum <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/Prebuilt.20tsan.20artifacts.3F.html#214997536">(Oct 29 2020 at 17:06)</a>:</h4>
<p>Definitely not, I think, but I would be happy to ship prebuilt sanitized stds for tier 1 targets at least, I think they can likely slot right into existing builders</p>



<a name="214997609"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/Prebuilt%20tsan%20artifacts%3F/near/214997609" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> simulacrum <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/Prebuilt.20tsan.20artifacts.3F.html#214997609">(Oct 29 2020 at 17:06)</a>:</h4>
<p>rust-dev is an internal component, no one outside rustbuild should use it</p>



<a name="214997755"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/Prebuilt%20tsan%20artifacts%3F/near/214997755" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Gankra <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/Prebuilt.20tsan.20artifacts.3F.html#214997755">(Oct 29 2020 at 17:07)</a>:</h4>
<p><span class="user-mention" data-user-id="116122">@simulacrum</span> anyway I can help with that?</p>



<a name="214997867"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/Prebuilt%20tsan%20artifacts%3F/near/214997867" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> simulacrum <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/Prebuilt.20tsan.20artifacts.3F.html#214997867">(Oct 29 2020 at 17:08)</a>:</h4>
<p>Hm so first I should check - we don't need rustc to be built sanitized, right? Just a std?</p>



<a name="214997973"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/Prebuilt%20tsan%20artifacts%3F/near/214997973" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Gankra <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/Prebuilt.20tsan.20artifacts.3F.html#214997973">(Oct 29 2020 at 17:09)</a>:</h4>
<p>I believe so, yes</p>



<a name="214998011"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/Prebuilt%20tsan%20artifacts%3F/near/214998011" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> simulacrum <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/Prebuilt.20tsan.20artifacts.3F.html#214998011">(Oct 29 2020 at 17:09)</a>:</h4>
<p>And IIRC we already ship the sanitizers in some way?</p>



<a name="214998028"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/Prebuilt%20tsan%20artifacts%3F/near/214998028" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> simulacrum <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/Prebuilt.20tsan.20artifacts.3F.html#214998028">(Oct 29 2020 at 17:09)</a>:</h4>
<p>I recall some logic around that</p>



<a name="214998092"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/Prebuilt%20tsan%20artifacts%3F/near/214998092" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Gankra <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/Prebuilt.20tsan.20artifacts.3F.html#214998092">(Oct 29 2020 at 17:10)</a>:</h4>
<p>yeah you can run -Zsanitizer = thread|address etc</p>



<a name="214998162"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/Prebuilt%20tsan%20artifacts%3F/near/214998162" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> simulacrum <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/Prebuilt.20tsan.20artifacts.3F.html#214998162">(Oct 29 2020 at 17:10)</a>:</h4>
<p>Do we need N stds then for each sanitizer?</p>



<a name="214998218"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/Prebuilt%20tsan%20artifacts%3F/near/214998218" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Gankra <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/Prebuilt.20tsan.20artifacts.3F.html#214998218">(Oct 29 2020 at 17:11)</a>:</h4>
<p>I seem to recall asan is "fine" with an uninstrumented build, only tsan has issues</p>



<a name="214998253"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/Prebuilt%20tsan%20artifacts%3F/near/214998253" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> simulacrum <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/Prebuilt.20tsan.20artifacts.3F.html#214998253">(Oct 29 2020 at 17:11)</a>:</h4>
<p>but presumably you'd not catch everything with a non-asan std?</p>



<a name="214998288"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/Prebuilt%20tsan%20artifacts%3F/near/214998288" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> tm <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/Prebuilt.20tsan.20artifacts.3F.html#214998288">(Oct 29 2020 at 17:11)</a>:</h4>
<p>It would be necessary for msan and tsan, and useful but not required for asan.</p>



<a name="214998326"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/Prebuilt%20tsan%20artifacts%3F/near/214998326" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> simulacrum <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/Prebuilt.20tsan.20artifacts.3F.html#214998326">(Oct 29 2020 at 17:11)</a>:</h4>
<p>ok, so I think it should be fine to provide asan, msan, and tsan stds</p>



<a name="214998359"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/Prebuilt%20tsan%20artifacts%3F/near/214998359" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> simulacrum <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/Prebuilt.20tsan.20artifacts.3F.html#214998359">(Oct 29 2020 at 17:12)</a>:</h4>
<p>building std is really quite fast</p>



<a name="214998457"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/Prebuilt%20tsan%20artifacts%3F/near/214998457" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> simulacrum <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/Prebuilt.20tsan.20artifacts.3F.html#214998457">(Oct 29 2020 at 17:12)</a>:</h4>
<p>let me think of the best way to integrate that into rustbuild</p>



<a name="214998515"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/Prebuilt%20tsan%20artifacts%3F/near/214998515" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Gankra <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/Prebuilt.20tsan.20artifacts.3F.html#214998515">(Oct 29 2020 at 17:13)</a>:</h4>
<p>awesome! if you need any help, feel free to ping me. this is pretty valuable to firefox</p>



<a name="214998555"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/Prebuilt%20tsan%20artifacts%3F/near/214998555" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> simulacrum <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/Prebuilt.20tsan.20artifacts.3F.html#214998555">(Oct 29 2020 at 17:13)</a>:</h4>
<p>I guess firefox is using RUSTC_BOOTSTRAP or w/e to pass -Z flags?</p>



<a name="214998579"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/Prebuilt%20tsan%20artifacts%3F/near/214998579" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> simulacrum <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/Prebuilt.20tsan.20artifacts.3F.html#214998579">(Oct 29 2020 at 17:13)</a>:</h4>
<p>or how do you all manage this?</p>



<a name="214998628"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/Prebuilt%20tsan%20artifacts%3F/near/214998628" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> simulacrum <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/Prebuilt.20tsan.20artifacts.3F.html#214998628">(Oct 29 2020 at 17:13)</a>:</h4>
<p>I'm a bit concerned about sort of "stabilizing" these additional component(s)</p>



<a name="214998774"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/Prebuilt%20tsan%20artifacts%3F/near/214998774" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> simulacrum <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/Prebuilt.20tsan.20artifacts.3F.html#214998774">(Oct 29 2020 at 17:14)</a>:</h4>
<p>especially since in the future I expect we would not ship them ourselves, once -Zbuild-std is a thing</p>



<a name="214998785"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/Prebuilt%20tsan%20artifacts%3F/near/214998785" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Gankra <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/Prebuilt.20tsan.20artifacts.3F.html#214998785">(Oct 29 2020 at 17:15)</a>:</h4>
<p><span class="user-mention" data-user-id="116122">@simulacrum</span> tsan/asan is a CI thing so we just run nightly</p>



<a name="214999083"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/Prebuilt%20tsan%20artifacts%3F/near/214999083" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Gankra <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/Prebuilt.20tsan.20artifacts.3F.html#214999083">(Oct 29 2020 at 17:16)</a>:</h4>
<p>having them prebuilt is valuable even if -Zbuild-std is reliable, because CI probably can't cache whatever cargo is doing, and that's a lot of extra cycles rebuilding</p>



<a name="214999179"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/Prebuilt%20tsan%20artifacts%3F/near/214999179" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> simulacrum <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/Prebuilt.20tsan.20artifacts.3F.html#214999179">(Oct 29 2020 at 17:17)</a>:</h4>
<p>sure, just becomes a matter of tradeoffs to some extent -- we can't build all possible configurations. it's possible sanitizers should be part of the set of provided ones, but not 100% clear right now to me :)</p>



<a name="214999188"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/Prebuilt%20tsan%20artifacts%3F/near/214999188" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> simulacrum <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/Prebuilt.20tsan.20artifacts.3F.html#214999188">(Oct 29 2020 at 17:17)</a>:</h4>
<p>seems likely, even</p>



<a name="214999217"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/Prebuilt%20tsan%20artifacts%3F/near/214999217" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Gankra <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/Prebuilt.20tsan.20artifacts.3F.html#214999217">(Oct 29 2020 at 17:17)</a>:</h4>
<p>right, well tsan seems easier because it literally only works on linux</p>



<a name="214999244"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/Prebuilt%20tsan%20artifacts%3F/near/214999244" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Gankra <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/Prebuilt.20tsan.20artifacts.3F.html#214999244">(Oct 29 2020 at 17:17)</a>:</h4>
<p>no slippery slope :)</p>



<a name="214999409"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/Prebuilt%20tsan%20artifacts%3F/near/214999409" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> tm <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/Prebuilt.20tsan.20artifacts.3F.html#214999409">(Oct 29 2020 at 17:18)</a>:</h4>
<p>TSAN works on Darwin and FreeBSD, possibly on other OSes, but not currently in rustc</p>



<a name="214999505"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/Prebuilt%20tsan%20artifacts%3F/near/214999505" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Gankra <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/Prebuilt.20tsan.20artifacts.3F.html#214999505">(Oct 29 2020 at 17:19)</a>:</h4>
<p>oh I didn't realize that was a rustc limitation</p>



<a name="214999551"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/Prebuilt%20tsan%20artifacts%3F/near/214999551" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> simulacrum <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/Prebuilt.20tsan.20artifacts.3F.html#214999551">(Oct 29 2020 at 17:19)</a>:</h4>
<p>I think it might not even be a limitation so much as iirc whoever added rustc support didn't have anything but linux to test on</p>



<a name="214999568"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/Prebuilt%20tsan%20artifacts%3F/near/214999568" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Gankra <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/Prebuilt.20tsan.20artifacts.3F.html#214999568">(Oct 29 2020 at 17:19)</a>:</h4>
<p>i guess it makes sense that a clang thing would work on macos (modulo the fact that Google probably does most clang stuff these days)</p>



<a name="214999570"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/Prebuilt%20tsan%20artifacts%3F/near/214999570" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> simulacrum <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/Prebuilt.20tsan.20artifacts.3F.html#214999570">(Oct 29 2020 at 17:20)</a>:</h4>
<p>so it's just hardcoded</p>



<a name="215000235"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/Prebuilt%20tsan%20artifacts%3F/near/215000235" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Gankra <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/Prebuilt.20tsan.20artifacts.3F.html#215000235">(Oct 29 2020 at 17:24)</a>:</h4>
<p><span class="user-mention" data-user-id="116122">@simulacrum</span> so just for planning my week, should I be assuming this is a thing that you'll probably do, or should I keep slapping our CI to try to get build-std-with-vendor working?</p>



<a name="215000271"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/Prebuilt%20tsan%20artifacts%3F/near/215000271" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Gankra <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/Prebuilt.20tsan.20artifacts.3F.html#215000271">(Oct 29 2020 at 17:24)</a>:</h4>
<p>(need me to file a bug for it?)</p>



<a name="215000556"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/Prebuilt%20tsan%20artifacts%3F/near/215000556" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> simulacrum <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/Prebuilt.20tsan.20artifacts.3F.html#215000556">(Oct 29 2020 at 17:26)</a>:</h4>
<p>hm, so I think it should be relatively easy to get a basic version at least going</p>



<a name="215000657"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/Prebuilt%20tsan%20artifacts%3F/near/215000657" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> simulacrum <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/Prebuilt.20tsan.20artifacts.3F.html#215000657">(Oct 29 2020 at 17:27)</a>:</h4>
<p>I think a bug with the listing of what sanitizers and what platforms would be quite useful (even if it's "just linux"), maybe an "almost required" + "helpful but not in immediate demand" set :)</p>



<a name="215000833"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/Prebuilt%20tsan%20artifacts%3F/near/215000833" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> simulacrum <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/Prebuilt.20tsan.20artifacts.3F.html#215000833">(Oct 29 2020 at 17:28)</a>:</h4>
<p>It'll likely be early next week that the patch gets reviewed at best though FWIW, perhaps longer</p>



<a name="215000852"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/Prebuilt%20tsan%20artifacts%3F/near/215000852" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Gankra <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/Prebuilt.20tsan.20artifacts.3F.html#215000852">(Oct 29 2020 at 17:28)</a>:</h4>
<p>ok, cool, will do</p>



<a name="215002637"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/Prebuilt%20tsan%20artifacts%3F/near/215002637" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> tm <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/Prebuilt.20tsan.20artifacts.3F.html#215002637">(Oct 29 2020 at 17:41)</a>:</h4>
<p>The tricky part is probably the fact that uninstrumented std is still necessary for build-scripts and proc-macros (presuming you don't want to instrument rustc itself).</p>



<a name="215003264"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/Prebuilt%20tsan%20artifacts%3F/near/215003264" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Gankra <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/Prebuilt.20tsan.20artifacts.3F.html#215003264">(Oct 29 2020 at 17:46)</a>:</h4>
<p>filed <a href="https://github.com/rust-lang/rust/issues/78533">https://github.com/rust-lang/rust/issues/78533</a></p>



<a name="215003314"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/Prebuilt%20tsan%20artifacts%3F/near/215003314" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Gankra <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/Prebuilt.20tsan.20artifacts.3F.html#215003314">(Oct 29 2020 at 17:47)</a>:</h4>
<p><span class="user-mention silent" data-user-id="352985">tm</span> <a href="#narrow/stream/131828-t-compiler/topic/Prebuilt.20tsan.20artifacts.3F/near/215002637">said</a>:</p>
<blockquote>
<p>The tricky part is probably the fact that uninstrumented std is still necessary for build-scripts and proc-macros (presuming you don't want to instrument rustc itself).</p>
</blockquote>
<p>would it cause ABI issues, or just be slow?</p>



<a name="215003831"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/Prebuilt%20tsan%20artifacts%3F/near/215003831" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> simulacrum <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/Prebuilt.20tsan.20artifacts.3F.html#215003831">(Oct 29 2020 at 17:50)</a>:</h4>
<p>Build scripts it definitely shouldn't be necessary for?</p>



<a name="215003867"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/Prebuilt%20tsan%20artifacts%3F/near/215003867" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> simulacrum <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/Prebuilt.20tsan.20artifacts.3F.html#215003867">(Oct 29 2020 at 17:50)</a>:</h4>
<p>proc macros also have a stable C ABI interface to rustc afaik</p>



<a name="215003917"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/Prebuilt%20tsan%20artifacts%3F/near/215003917" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> tm <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/Prebuilt.20tsan.20artifacts.3F.html#215003917">(Oct 29 2020 at 17:50)</a>:</h4>
<p>instrumented proc-macro + uninstrumented rustc wouldn't work (there is no TSAN runtime in either).</p>



<a name="215003987"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/Prebuilt%20tsan%20artifacts%3F/near/215003987" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> simulacrum <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/Prebuilt.20tsan.20artifacts.3F.html#215003987">(Oct 29 2020 at 17:51)</a>:</h4>
<p>when you say "wouldn't work" what do you mean by that? Wouldn't run tsan or wouldn't run at all?</p>



<a name="215004020"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/Prebuilt%20tsan%20artifacts%3F/near/215004020" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> simulacrum <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/Prebuilt.20tsan.20artifacts.3F.html#215004020">(Oct 29 2020 at 17:51)</a>:</h4>
<p>I suspect firefox probably doesn't care about proc macros getting tsan'd</p>



<a name="215004281"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/Prebuilt%20tsan%20artifacts%3F/near/215004281" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> simulacrum <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/Prebuilt.20tsan.20artifacts.3F.html#215004281">(Oct 29 2020 at 17:53)</a>:</h4>
<p>(is that right <span class="user-mention" data-user-id="137587">@Gankra</span>?)</p>



<a name="215004613"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/Prebuilt%20tsan%20artifacts%3F/near/215004613" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> tm <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/Prebuilt.20tsan.20artifacts.3F.html#215004613">(Oct 29 2020 at 17:55)</a>:</h4>
<p>Generally proc-macros should be uninstrumented, hence the need for two different versions of the standard library.</p>



<a name="215004810"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/Prebuilt%20tsan%20artifacts%3F/near/215004810" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Nelson <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/Prebuilt.20tsan.20artifacts.3F.html#215004810">(Oct 29 2020 at 17:56)</a>:</h4>
<p>Don't proc macros link to the library <em>rustc</em> is linked to? As opposed to the one it built</p>



<a name="215004815"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/Prebuilt%20tsan%20artifacts%3F/near/215004815" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> simulacrum <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/Prebuilt.20tsan.20artifacts.3F.html#215004815">(Oct 29 2020 at 17:56)</a>:</h4>
<p>If my intuition about how mixing non-instrumented and instrumented code is correct (i.e., you either get no results or partial results, but no errors) then there's no problem?</p>



<a name="215004883"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/Prebuilt%20tsan%20artifacts%3F/near/215004883" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> simulacrum <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/Prebuilt.20tsan.20artifacts.3F.html#215004883">(Oct 29 2020 at 17:57)</a>:</h4>
<p><span class="user-mention" data-user-id="232545">@Joshua Nelson</span> pretty sure that's not the case; std is statically linked into rustc I would expect.</p>



<a name="215004919"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/Prebuilt%20tsan%20artifacts%3F/near/215004919" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> simulacrum <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/Prebuilt.20tsan.20artifacts.3F.html#215004919">(Oct 29 2020 at 17:57)</a>:</h4>
<p>and I don't think we do anything special link-wise for proc macros</p>



<a name="215005391"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/Prebuilt%20tsan%20artifacts%3F/near/215005391" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> tm <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/Prebuilt.20tsan.20artifacts.3F.html#215005391">(Oct 29 2020 at 18:01)</a>:</h4>
<p>"wouldn't work" they will fail to load (unresolved symbols referencing TSAN runtime)</p>



<a name="215005743"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/Prebuilt%20tsan%20artifacts%3F/near/215005743" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> bjorn3 <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/Prebuilt.20tsan.20artifacts.3F.html#215005743">(Oct 29 2020 at 18:04)</a>:</h4>
<p><span class="user-mention silent" data-user-id="232545">Joshua Nelson</span> <a href="#narrow/stream/131828-t-compiler/topic/Prebuilt.20tsan.20artifacts.3F/near/215004810">said</a>:</p>
<blockquote>
<p>Don't proc macros link to the library <em>rustc</em> is linked to? As opposed to the one it built</p>
</blockquote>
<p>No, rustc can only link a proc macro to the version of libproc_macro that it built itself due to the rust abi not being stable. Instead libproc_macro uses the C ABI internally so that two versions of it built from the same source can be used. One for the compiler and one for the proc macro.</p>



<a name="215005782"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/Prebuilt%20tsan%20artifacts%3F/near/215005782" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> bjorn3 <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/Prebuilt.20tsan.20artifacts.3F.html#215005782">(Oct 29 2020 at 18:04)</a>:</h4>
<p>This has been the case since rustc started using proc macros.</p>



<a name="215006831"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/Prebuilt%20tsan%20artifacts%3F/near/215006831" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> simulacrum <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/Prebuilt.20tsan.20artifacts.3F.html#215006831">(Oct 29 2020 at 18:13)</a>:</h4>
<p><span class="user-mention" data-user-id="137587">@Gankra</span> presuming <span class="user-mention" data-user-id="352985">@tm</span> is correct then you're going to need to do same hackery to get different stds for build deps and target deps; the easiest is likely a wrapper for rustc invocations that specifies different --sysroot args depending on presence of --target, which will always be set for non-build-deps by cargo with --target passed to cargo</p>



<a name="215007683"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/Prebuilt%20tsan%20artifacts%3F/near/215007683" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Gankra <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/Prebuilt.20tsan.20artifacts.3F.html#215007683">(Oct 29 2020 at 18:19)</a>:</h4>
<p>hmm ok I'll need to think about that</p>



<a name="215007820"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/Prebuilt%20tsan%20artifacts%3F/near/215007820" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> simulacrum <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/Prebuilt.20tsan.20artifacts.3F.html#215007820">(Oct 29 2020 at 18:20)</a>:</h4>
<p>I think -Zbuild-std might not encounter this problem actually because it already links the newly built std only to target deps, but I might be wrong about that</p>



<a name="215007849"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/Prebuilt%20tsan%20artifacts%3F/near/215007849" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> simulacrum <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/Prebuilt.20tsan.20artifacts.3F.html#215007849">(Oct 29 2020 at 18:20)</a>:</h4>
<p>the script should be ~10-20 lines though fwiw</p>



<a name="215007958"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/Prebuilt%20tsan%20artifacts%3F/near/215007958" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Gankra <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/Prebuilt.20tsan.20artifacts.3F.html#215007958">(Oct 29 2020 at 18:21)</a>:</h4>
<p>Sounds reasonable</p>



<a name="215008516"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/Prebuilt%20tsan%20artifacts%3F/near/215008516" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> tm <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/Prebuilt.20tsan.20artifacts.3F.html#215008516">(Oct 29 2020 at 18:25)</a>:</h4>
<p>The beauty of RUSTFLAGS=-Zsanitizer + -Zbuild-std + --target is that it does exactly the right thing from the perspective of sanitizer use-case.</p>



<a name="215008969"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/Prebuilt%20tsan%20artifacts%3F/near/215008969" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Gankra <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/Prebuilt.20tsan.20artifacts.3F.html#215008969">(Oct 29 2020 at 18:29)</a>:</h4>
<p>yep</p>



<a name="215020529"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/Prebuilt%20tsan%20artifacts%3F/near/215020529" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> simulacrum <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/Prebuilt.20tsan.20artifacts.3F.html#215020529">(Oct 29 2020 at 20:04)</a>:</h4>
<p><span class="user-mention" data-user-id="137587">@Gankra</span> yeah so looking at the impl it's going to be more painful than I expected, lots of pieces need to change and I'm not liking the approaches I come up with :/</p>



<a name="215020831"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/Prebuilt%20tsan%20artifacts%3F/near/215020831" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> simulacrum <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/Prebuilt.20tsan.20artifacts.3F.html#215020831">(Oct 29 2020 at 20:07)</a>:</h4>
<p>and given the build/target dep incompatibility and need for a custom script, which means it wouldn't be seamless anyway it seems like, I'm leaning towards saying that build-std is the right approach after all</p>



<a name="215021475"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/Prebuilt%20tsan%20artifacts%3F/near/215021475" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Gankra <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/Prebuilt.20tsan.20artifacts.3F.html#215021475">(Oct 29 2020 at 20:13)</a>:</h4>
<p>hmm, ok</p>



<a name="215021646"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/Prebuilt%20tsan%20artifacts%3F/near/215021646" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> simulacrum <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/Prebuilt.20tsan.20artifacts.3F.html#215021646">(Oct 29 2020 at 20:15)</a>:</h4>
<p><span class="user-mention" data-user-id="137587">@Gankra</span> it sounded like build-std was mostly a compile-time issue, right? I am rather surprised by that to be honest, because std is (at least on Rust CI) a small fraction of build times</p>



<a name="215021685"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/Prebuilt%20tsan%20artifacts%3F/near/215021685" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> simulacrum <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/Prebuilt.20tsan.20artifacts.3F.html#215021685">(Oct 29 2020 at 20:16)</a>:</h4>
<p>I'm not going to close the issue because most of the refactoring necessary to make it easier is I think good anyway, but it's going to require quite a bit of work</p>



<a name="215022049"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/Prebuilt%20tsan%20artifacts%3F/near/215022049" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Gankra <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/Prebuilt.20tsan.20artifacts.3F.html#215022049">(Oct 29 2020 at 20:18)</a>:</h4>
<p><span class="user-mention" data-user-id="116122">@simulacrum</span> well a little bit times a lot of builds adds up. I'm mostly still stuck at "oh no dependency management". For whatever reason <code>backtrace</code> isn't available. Perhaps the rust-src artifact we download isn't what rustup uses? <a href="https://searchfox.org/mozilla-central/source/taskcluster/scripts/misc/repack_rust.py#371">https://searchfox.org/mozilla-central/source/taskcluster/scripts/misc/repack_rust.py#371</a></p>



<a name="215022083"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/Prebuilt%20tsan%20artifacts%3F/near/215022083" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Gankra <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/Prebuilt.20tsan.20artifacts.3F.html#215022083">(Oct 29 2020 at 20:19)</a>:</h4>
<p>(or does rust-src not include deps?)</p>



<a name="215022091"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/Prebuilt%20tsan%20artifacts%3F/near/215022091" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> simulacrum <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/Prebuilt.20tsan.20artifacts.3F.html#215022091">(Oct 29 2020 at 20:19)</a>:</h4>
<p>hmm</p>



<a name="215022103"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/Prebuilt%20tsan%20artifacts%3F/near/215022103" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> simulacrum <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/Prebuilt.20tsan.20artifacts.3F.html#215022103">(Oct 29 2020 at 20:19)</a>:</h4>
<p>are you on recent nightlies?</p>



<a name="215022117"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/Prebuilt%20tsan%20artifacts%3F/near/215022117" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> simulacrum <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/Prebuilt.20tsan.20artifacts.3F.html#215022117">(Oct 29 2020 at 20:19)</a>:</h4>
<p>we had a bit were it was broken</p>



<a name="215022318"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/Prebuilt%20tsan%20artifacts%3F/near/215022318" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> simulacrum <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/Prebuilt.20tsan.20artifacts.3F.html#215022318">(Oct 29 2020 at 20:20)</a>:</h4>
<p><span class="user-mention" data-user-id="137587">@Gankra</span> I am happy to help with getting build-std to work</p>



<a name="215022350"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/Prebuilt%20tsan%20artifacts%3F/near/215022350" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> simulacrum <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/Prebuilt.20tsan.20artifacts.3F.html#215022350">(Oct 29 2020 at 20:21)</a>:</h4>
<p>there's two rust-src ish artifacts</p>



<a name="215022357"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/Prebuilt%20tsan%20artifacts%3F/near/215022357" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> simulacrum <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/Prebuilt.20tsan.20artifacts.3F.html#215022357">(Oct 29 2020 at 20:21)</a>:</h4>
<p>let me check which one you're using</p>



<a name="215022494"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/Prebuilt%20tsan%20artifacts%3F/near/215022494" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Gankra <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/Prebuilt.20tsan.20artifacts.3F.html#215022494">(Oct 29 2020 at 20:22)</a>:</h4>
<p><a href="https://searchfox.org/mozilla-central/source/taskcluster/ci/toolchain/rust.yml#49">https://searchfox.org/mozilla-central/source/taskcluster/ci/toolchain/rust.yml#49</a> 2020-03-18</p>



<a name="215022619"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/Prebuilt%20tsan%20artifacts%3F/near/215022619" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> simulacrum <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/Prebuilt.20tsan.20artifacts.3F.html#215022619">(Oct 29 2020 at 20:23)</a>:</h4>
<p>hm, that feels like it might be in the unlucky range</p>



<a name="215022677"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/Prebuilt%20tsan%20artifacts%3F/near/215022677" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Gankra <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/Prebuilt.20tsan.20artifacts.3F.html#215022677">(Oct 29 2020 at 20:23)</a>:</h4>
<p>I'll ask if we're stuck on that one for a reason (been having issues with new llvm)</p>



<a name="215022735"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/Prebuilt%20tsan%20artifacts%3F/near/215022735" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> simulacrum <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/Prebuilt.20tsan.20artifacts.3F.html#215022735">(Oct 29 2020 at 20:24)</a>:</h4>
<p>you can likely bump by like 5 days and be fine to be clear</p>



<a name="215022770"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/Prebuilt%20tsan%20artifacts%3F/near/215022770" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> simulacrum <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/Prebuilt.20tsan.20artifacts.3F.html#215022770">(Oct 29 2020 at 20:24)</a>:</h4>
<p>let me confirm it's what I think it is though</p>



<a name="215022860"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/Prebuilt%20tsan%20artifacts%3F/near/215022860" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Gankra <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/Prebuilt.20tsan.20artifacts.3F.html#215022860">(Oct 29 2020 at 20:25)</a>:</h4>
<p><a href="https://firefoxci.taskcluster-artifacts.net/dleojbwaRryGAkVoUYZIZg/0/public/logs/live_backing.log">https://firefoxci.taskcluster-artifacts.net/dleojbwaRryGAkVoUYZIZg/0/public/logs/live_backing.log</a></p>



<a name="215022871"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/Prebuilt%20tsan%20artifacts%3F/near/215022871" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Gankra <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/Prebuilt.20tsan.20artifacts.3F.html#215022871">(Oct 29 2020 at 20:25)</a>:</h4>
<p>^ failing build</p>



<a name="215022901"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/Prebuilt%20tsan%20artifacts%3F/near/215022901" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Gankra <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/Prebuilt.20tsan.20artifacts.3F.html#215022901">(Oct 29 2020 at 20:25)</a>:</h4>
<p>error: no matching package named <code>backtrace</code> found</p>



<a name="215023428"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/Prebuilt%20tsan%20artifacts%3F/near/215023428" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> simulacrum <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/Prebuilt.20tsan.20artifacts.3F.html#215023428">(Oct 29 2020 at 20:30)</a>:</h4>
<p>hm so the gimli stuff seems to have landed in july, which is way later</p>



<a name="215023471"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/Prebuilt%20tsan%20artifacts%3F/near/215023471" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> simulacrum <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/Prebuilt.20tsan.20artifacts.3F.html#215023471">(Oct 29 2020 at 20:30)</a>:</h4>
<p>thinking back I don't honestly recall any bugs with backtrace in march/april</p>



<a name="215023485"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/Prebuilt%20tsan%20artifacts%3F/near/215023485" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> simulacrum <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/Prebuilt.20tsan.20artifacts.3F.html#215023485">(Oct 29 2020 at 20:30)</a>:</h4>
<p>maybe it was broken though!</p>



<a name="215023538"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/Prebuilt%20tsan%20artifacts%3F/near/215023538" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Gankra <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/Prebuilt.20tsan.20artifacts.3F.html#215023538">(Oct 29 2020 at 20:31)</a>:</h4>
<p>does a rust-src artifact include all the deps vendored up?</p>



<a name="215023563"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/Prebuilt%20tsan%20artifacts%3F/near/215023563" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> simulacrum <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/Prebuilt.20tsan.20artifacts.3F.html#215023563">(Oct 29 2020 at 20:31)</a>:</h4>
<p>hm I don't think so</p>



<a name="215023586"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/Prebuilt%20tsan%20artifacts%3F/near/215023586" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> simulacrum <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/Prebuilt.20tsan.20artifacts.3F.html#215023586">(Oct 29 2020 at 20:31)</a>:</h4>
<p>otherwise we'd not see a crates.io-index dep</p>



<a name="215023645"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/Prebuilt%20tsan%20artifacts%3F/near/215023645" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Gankra <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/Prebuilt.20tsan.20artifacts.3F.html#215023645">(Oct 29 2020 at 20:32)</a>:</h4>
<p>well that'll cause a problem, because <a href="http://crates.io">crates.io</a> is shadowed by our vendor</p>



<a name="215023686"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/Prebuilt%20tsan%20artifacts%3F/near/215023686" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> simulacrum <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/Prebuilt.20tsan.20artifacts.3F.html#215023686">(Oct 29 2020 at 20:32)</a>:</h4>
<p>but like this is not unique for backtrace?</p>



<a name="215023707"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/Prebuilt%20tsan%20artifacts%3F/near/215023707" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Gankra <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/Prebuilt.20tsan.20artifacts.3F.html#215023707">(Oct 29 2020 at 20:32)</a>:</h4>
<p>probably just the first one it couldn't find</p>



<a name="215023737"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/Prebuilt%20tsan%20artifacts%3F/near/215023737" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> simulacrum <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/Prebuilt.20tsan.20artifacts.3F.html#215023737">(Oct 29 2020 at 20:33)</a>:</h4>
<p>hm so do you vendor hashbrown yourself?</p>



<a name="215023768"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/Prebuilt%20tsan%20artifacts%3F/near/215023768" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> simulacrum <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/Prebuilt.20tsan.20artifacts.3F.html#215023768">(Oct 29 2020 at 20:33)</a>:</h4>
<p>or I guess that would've broken too</p>



<a name="215023807"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/Prebuilt%20tsan%20artifacts%3F/near/215023807" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> simulacrum <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/Prebuilt.20tsan.20artifacts.3F.html#215023807">(Oct 29 2020 at 20:33)</a>:</h4>
<p>there is a vendored tarball, but it's not a rustup component I believe</p>



<a name="215023827"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/Prebuilt%20tsan%20artifacts%3F/near/215023827" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Gankra <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/Prebuilt.20tsan.20artifacts.3F.html#215023827">(Oct 29 2020 at 20:33)</a>:</h4>
<p>yes we vendor hashbrown</p>



<a name="215023946"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/Prebuilt%20tsan%20artifacts%3F/near/215023946" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> simulacrum <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/Prebuilt.20tsan.20artifacts.3F.html#215023946">(Oct 29 2020 at 20:34)</a>:</h4>
<p>I mean like, rewriting the std cargo.toml to point at the vendored hashbrown?</p>



<a name="215023972"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/Prebuilt%20tsan%20artifacts%3F/near/215023972" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> simulacrum <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/Prebuilt.20tsan.20artifacts.3F.html#215023972">(Oct 29 2020 at 20:34)</a>:</h4>
<p>(or patch equivalent)</p>



<a name="215023978"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/Prebuilt%20tsan%20artifacts%3F/near/215023978" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Gankra <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/Prebuilt.20tsan.20artifacts.3F.html#215023978">(Oct 29 2020 at 20:34)</a>:</h4>
<p><a href="https://searchfox.org/mozilla-central/source/third_party/rust">https://searchfox.org/mozilla-central/source/third_party/rust</a></p>



<a name="215024011"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/Prebuilt%20tsan%20artifacts%3F/near/215024011" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Gankra <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/Prebuilt.20tsan.20artifacts.3F.html#215024011">(Oct 29 2020 at 20:35)</a>:</h4>
<p>uh, not sure what you mean?</p>



<a name="215024026"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/Prebuilt%20tsan%20artifacts%3F/near/215024026" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> simulacrum <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/Prebuilt.20tsan.20artifacts.3F.html#215024026">(Oct 29 2020 at 20:35)</a>:</h4>
<p>maybe I misunderstand how your vendoring works</p>



<a name="215024038"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/Prebuilt%20tsan%20artifacts%3F/near/215024038" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> simulacrum <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/Prebuilt.20tsan.20artifacts.3F.html#215024038">(Oct 29 2020 at 20:35)</a>:</h4>
<p>but the Cargo.lock in the rust-src component points at <a href="http://crates.io">crates.io</a></p>



<a name="215024056"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/Prebuilt%20tsan%20artifacts%3F/near/215024056" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> simulacrum <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/Prebuilt.20tsan.20artifacts.3F.html#215024056">(Oct 29 2020 at 20:35)</a>:</h4>
<p>not a path dep to vendored sources</p>



<a name="215024130"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/Prebuilt%20tsan%20artifacts%3F/near/215024130" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Gankra <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/Prebuilt.20tsan.20artifacts.3F.html#215024130">(Oct 29 2020 at 20:36)</a>:</h4>
<p>I thought when you use cargo vendor <a href="http://crates.io">crates.io</a> "resolves" to your vendor directory</p>



<a name="215024144"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/Prebuilt%20tsan%20artifacts%3F/near/215024144" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> simulacrum <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/Prebuilt.20tsan.20artifacts.3F.html#215024144">(Oct 29 2020 at 20:36)</a>:</h4>
<p>right, via patches or something like that</p>



<a name="215024161"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/Prebuilt%20tsan%20artifacts%3F/near/215024161" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Gankra <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/Prebuilt.20tsan.20artifacts.3F.html#215024161">(Oct 29 2020 at 20:36)</a>:</h4>
<p>something like that, yeah</p>



<a name="215024164"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/Prebuilt%20tsan%20artifacts%3F/near/215024164" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> cuviper <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/Prebuilt.20tsan.20artifacts.3F.html#215024164">(Oct 29 2020 at 20:36)</a>:</h4>
<p>via <code>.cargo/config</code> source replacement</p>



<a name="215024190"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/Prebuilt%20tsan%20artifacts%3F/near/215024190" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> simulacrum <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/Prebuilt.20tsan.20artifacts.3F.html#215024190">(Oct 29 2020 at 20:36)</a>:</h4>
<p>so <em>maybe</em> the fix here is simple: vendor backtrace</p>



<a name="215024203"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/Prebuilt%20tsan%20artifacts%3F/near/215024203" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> simulacrum <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/Prebuilt.20tsan.20artifacts.3F.html#215024203">(Oct 29 2020 at 20:36)</a>:</h4>
<p>it doesn't appear to be in the list you linked</p>



<a name="215024237"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/Prebuilt%20tsan%20artifacts%3F/near/215024237" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> simulacrum <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/Prebuilt.20tsan.20artifacts.3F.html#215024237">(Oct 29 2020 at 20:37)</a>:</h4>
<p>(which is honestly surprising, it feels like it sneaks in quite quickly in my depgraphs)</p>



<a name="215024254"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/Prebuilt%20tsan%20artifacts%3F/near/215024254" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Gankra <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/Prebuilt.20tsan.20artifacts.3F.html#215024254">(Oct 29 2020 at 20:37)</a>:</h4>
<p>Yeah I'm just wondering if there's a way to make the "stdlib" vendors easy to update</p>



<a name="215024284"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/Prebuilt%20tsan%20artifacts%3F/near/215024284" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Gankra <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/Prebuilt.20tsan.20artifacts.3F.html#215024284">(Oct 29 2020 at 20:37)</a>:</h4>
<p>like a fake std crate we "build"</p>



<a name="215024287"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/Prebuilt%20tsan%20artifacts%3F/near/215024287" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> simulacrum <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/Prebuilt.20tsan.20artifacts.3F.html#215024287">(Oct 29 2020 at 20:37)</a>:</h4>
<p>we do have a vendored component of the whole compiler (including compiler deps and such) but I suspect you probably don't want that</p>



<a name="215024366"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/Prebuilt%20tsan%20artifacts%3F/near/215024366" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> simulacrum <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/Prebuilt.20tsan.20artifacts.3F.html#215024366">(Oct 29 2020 at 20:38)</a>:</h4>
<p>though you could use that to build a sanitized std, I guess</p>



<a name="215024393"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/Prebuilt%20tsan%20artifacts%3F/near/215024393" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> simulacrum <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/Prebuilt.20tsan.20artifacts.3F.html#215024393">(Oct 29 2020 at 20:38)</a>:</h4>
<p>(overriding rustc to point at yours and then installing the stage 0 std into your sysroot or something, but seems quite complicated)</p>



<a name="215024448"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/Prebuilt%20tsan%20artifacts%3F/near/215024448" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Gankra <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/Prebuilt.20tsan.20artifacts.3F.html#215024448">(Oct 29 2020 at 20:39)</a>:</h4>
<p>I was moreso thinking just copy-pasting the Cargo.toml for std, but I suppose that won't do transitive stuff like core and alloc</p>



<a name="215024450"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/Prebuilt%20tsan%20artifacts%3F/near/215024450" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Nelson <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/Prebuilt.20tsan.20artifacts.3F.html#215024450">(Oct 29 2020 at 20:39)</a>:</h4>
<p>cc <a href="https://github.com/rust-lang/rust/pull/76533#issuecomment-708563503">https://github.com/rust-lang/rust/pull/76533#issuecomment-708563503</a></p>



<a name="215024488"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/Prebuilt%20tsan%20artifacts%3F/near/215024488" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> simulacrum <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/Prebuilt.20tsan.20artifacts.3F.html#215024488">(Oct 29 2020 at 20:39)</a>:</h4>
<p>The separate workspace wouldn't help much unless we shipped a separate std-src-vendored or something</p>



<a name="215024564"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/Prebuilt%20tsan%20artifacts%3F/near/215024564" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> bjorn3 <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/Prebuilt.20tsan.20artifacts.3F.html#215024564">(Oct 29 2020 at 20:40)</a>:</h4>
<p>It makes it much easier to only vendor the stdlib dependencies.</p>



<a name="215024676"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/Prebuilt%20tsan%20artifacts%3F/near/215024676" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> simulacrum <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/Prebuilt.20tsan.20artifacts.3F.html#215024676">(Oct 29 2020 at 20:41)</a>:</h4>
<p>Sure</p>



<a name="215025209"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/Prebuilt%20tsan%20artifacts%3F/near/215025209" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Gankra <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/Prebuilt.20tsan.20artifacts.3F.html#215025209">(Oct 29 2020 at 20:45)</a>:</h4>
<p><span class="user-mention" data-user-id="116122">@simulacrum</span> where's the vendored component for rustc?</p>



<a name="215025260"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/Prebuilt%20tsan%20artifacts%3F/near/215025260" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> simulacrum <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/Prebuilt.20tsan.20artifacts.3F.html#215025260">(Oct 29 2020 at 20:45)</a>:</h4>
<p>let me get you the url pattern</p>



<a name="215025349"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/Prebuilt%20tsan%20artifacts%3F/near/215025349" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Gankra <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/Prebuilt.20tsan.20artifacts.3F.html#215025349">(Oct 29 2020 at 20:46)</a>:</h4>
<p>thx</p>



<a name="215025440"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/Prebuilt%20tsan%20artifacts%3F/near/215025440" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> simulacrum <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/Prebuilt.20tsan.20artifacts.3F.html#215025440">(Oct 29 2020 at 20:47)</a>:</h4>
<p><a href="https://static.rust-lang.org/dist/2020-03-25/rustc-nightly-src.tar.xz">https://static.rust-lang.org/dist/2020-03-25/rustc-nightly-src.tar.xz</a></p>



<a name="215025448"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/Prebuilt%20tsan%20artifacts%3F/near/215025448" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> simulacrum <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/Prebuilt.20tsan.20artifacts.3F.html#215025448">(Oct 29 2020 at 20:47)</a>:</h4>
<p>note that it is <em>not</em> a rustup component</p>



<a name="215025468"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/Prebuilt%20tsan%20artifacts%3F/near/215025468" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> simulacrum <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/Prebuilt.20tsan.20artifacts.3F.html#215025468">(Oct 29 2020 at 20:47)</a>:</h4>
<p><span class="user-mention" data-user-id="137587">@Gankra</span> and it contains e.g. llvm and such too</p>



<a name="215026681"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/Prebuilt%20tsan%20artifacts%3F/near/215026681" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Gankra <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/Prebuilt.20tsan.20artifacts.3F.html#215026681">(Oct 29 2020 at 20:56)</a>:</h4>
<p>I think I need to sleep on this / wait for feedback from coworkers on how we'd like to address this conundrum</p>



<a name="215026706"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/Prebuilt%20tsan%20artifacts%3F/near/215026706" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Gankra <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/Prebuilt.20tsan.20artifacts.3F.html#215026706">(Oct 29 2020 at 20:57)</a>:</h4>
<p>(prebuilt std looking attractive to me again :p)</p>



<a name="215026721"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/Prebuilt%20tsan%20artifacts%3F/near/215026721" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Gankra <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/Prebuilt.20tsan.20artifacts.3F.html#215026721">(Oct 29 2020 at 20:57)</a>:</h4>
<p>But thanks a ton for all your help!!</p>



<a name="215032546"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/Prebuilt%20tsan%20artifacts%3F/near/215032546" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> simulacrum <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/Prebuilt.20tsan.20artifacts.3F.html#215032546">(Oct 29 2020 at 21:44)</a>:</h4>
<p>yeah let me know -- I think it is an important use case, and there are more strategies for implementation that I think could be viable</p>



<a name="215093300"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/Prebuilt%20tsan%20artifacts%3F/near/215093300" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Gankra <a href="https://rust-lang.github.io/zulip_archive/stream/131828-t-compiler/topic/Prebuilt.20tsan.20artifacts.3F.html#215093300">(Oct 30 2020 at 13:23)</a>:</h4>
<p>Now pursuing a solution in cargo vendor: <a href="#narrow/stream/246057-t-cargo/topic/cargo.20vendor.20-Zbuild-std">https://rust-lang.zulipchat.com/#narrow/stream/246057-t-cargo/topic/cargo.20vendor.20-Zbuild-std</a></p>



<hr><p>Last updated: Aug 07 2021 at 22:04 UTC</p>
</html>