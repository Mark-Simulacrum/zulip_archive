<html>
<head><meta charset="utf-8"><title>Merge Stability in rustc_attr and rustdoc · t-compiler · Zulip Chat Archive</title></head>
<h2>Stream: <a href="https://zulip-archive.rust-lang.org/stream/131828-t-compiler/index.html">t-compiler</a></h2>
<h3>Topic: <a href="https://zulip-archive.rust-lang.org/stream/131828-t-compiler/topic/Merge.20Stability.20in.20rustc_attr.20and.20rustdoc.html">Merge Stability in rustc_attr and rustdoc</a></h3>

<hr>

<base href="https://rust-lang.zulipchat.com">

<head><link href="https://zulip-archive.rust-lang.org/style.css" rel="stylesheet"></head>

<a name="203921719"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/Merge%20Stability%20in%20rustc_attr%20and%20rustdoc/near/203921719" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> lzutao <a href="https://zulip-archive.rust-lang.org/stream/131828-t-compiler/topic/Merge.20Stability.20in.20rustc_attr.20and.20rustdoc.html#203921719">(Jul 15 2020 at 06:56)</a>:</h4>
<p>Can we merge <a href="https://doc.rust-lang.org/nightly/nightly-rustc/rustdoc/clean/types/struct.Stability.html">https://doc.rust-lang.org/nightly/nightly-rustc/rustdoc/clean/types/struct.Stability.html</a> and <a href="https://doc.rust-lang.org/nightly/nightly-rustc/rustc_attr/struct.Stability.html">https://doc.rust-lang.org/nightly/nightly-rustc/rustc_attr/struct.Stability.html</a> together?<br>
cc <span class="user-mention" data-user-id="210316">@GuillaumeGomez</span> <span class="user-mention" data-user-id="119009">@eddyb</span></p>



<a name="203921737"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/Merge%20Stability%20in%20rustc_attr%20and%20rustdoc/near/203921737" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> lzutao <a href="https://zulip-archive.rust-lang.org/stream/131828-t-compiler/topic/Merge.20Stability.20in.20rustc_attr.20and.20rustdoc.html#203921737">(Jul 15 2020 at 06:57)</a>:</h4>
<p>also <a href="https://doc.rust-lang.org/nightly/nightly-rustc/rustc_middle/middle/stability/enum.StabilityLevel.html">https://doc.rust-lang.org/nightly/nightly-rustc/rustc_middle/middle/stability/enum.StabilityLevel.html</a> and <a href="https://doc.rust-lang.org/nightly/nightly-rustc/rustc_attr/enum.StabilityLevel.html">https://doc.rust-lang.org/nightly/nightly-rustc/rustc_attr/enum.StabilityLevel.html</a></p>



<a name="203922492"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/Merge%20Stability%20in%20rustc_attr%20and%20rustdoc/near/203922492" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> lzutao <a href="https://zulip-archive.rust-lang.org/stream/131828-t-compiler/topic/Merge.20Stability.20in.20rustc_attr.20and.20rustdoc.html#203922492">(Jul 15 2020 at 07:12)</a>:</h4>
<p>cc <span class="user-mention" data-user-id="123856">@Vadim Petrochenkov</span> as in <a href="https://github.com/rust-lang/rust/issues/29014">#29014</a> he did quite a lot of refactoring. Maybe he is familiar with these stuffs.</p>



<a name="203925592"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/Merge%20Stability%20in%20rustc_attr%20and%20rustdoc/near/203925592" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> eddyb <a href="https://zulip-archive.rust-lang.org/stream/131828-t-compiler/topic/Merge.20Stability.20in.20rustc_attr.20and.20rustdoc.html#203925592">(Jul 15 2020 at 07:54)</a>:</h4>
<p>the latter two probably, but <code>rustdoc::clean</code> tends to try and have a "desugared copy" of constructs in the rest of the compiler</p>



<a name="203932171"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/Merge%20Stability%20in%20rustc_attr%20and%20rustdoc/near/203932171" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> lzutao <a href="https://zulip-archive.rust-lang.org/stream/131828-t-compiler/topic/Merge.20Stability.20in.20rustc_attr.20and.20rustdoc.html#203932171">(Jul 15 2020 at 09:17)</a>:</h4>
<p>I don't know for sure. But I don't find the rustdoc version is easier to use.<br>
Also <a href="https://doc.rust-lang.org/nightly/nightly-rustc/rustdoc/clean/types/struct.Deprecation.html">https://doc.rust-lang.org/nightly/nightly-rustc/rustdoc/clean/types/struct.Deprecation.html</a> and <a href="https://doc.rust-lang.org/nightly/nightly-rustc/rustc_attr/struct.RustcDeprecation.html">https://doc.rust-lang.org/nightly/nightly-rustc/rustc_attr/struct.RustcDeprecation.html</a></p>



<a name="203932193"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/Merge%20Stability%20in%20rustc_attr%20and%20rustdoc/near/203932193" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> eddyb <a href="https://zulip-archive.rust-lang.org/stream/131828-t-compiler/topic/Merge.20Stability.20in.20rustc_attr.20and.20rustdoc.html#203932193">(Jul 15 2020 at 09:17)</a>:</h4>
<p>I mean, a lot of the rustdoc stuff isn't necessarily <em>good</em>, but the duplication isn't accidental, it's on purpose</p>



<a name="203932247"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/Merge%20Stability%20in%20rustc_attr%20and%20rustdoc/near/203932247" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> eddyb <a href="https://zulip-archive.rust-lang.org/stream/131828-t-compiler/topic/Merge.20Stability.20in.20rustc_attr.20and.20rustdoc.html#203932247">(Jul 15 2020 at 09:18)</a>:</h4>
<p>it's possible more than half of rustdoc is just unnecessary conversions etc.</p>



<a name="203932837"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/Merge%20Stability%20in%20rustc_attr%20and%20rustdoc/near/203932837" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> lzutao <a href="https://zulip-archive.rust-lang.org/stream/131828-t-compiler/topic/Merge.20Stability.20in.20rustc_attr.20and.20rustdoc.html#203932837">(Jul 15 2020 at 09:26)</a>:</h4>
<p>I agree. But the purpose is never documented or lost. Also the code is refactored /move from file to file.<br>
That's why I pinged Petrochenkov and rustdoc devs to discuss.</p>



<a name="203951693"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/Merge%20Stability%20in%20rustc_attr%20and%20rustdoc/near/203951693" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Nelson <a href="https://zulip-archive.rust-lang.org/stream/131828-t-compiler/topic/Merge.20Stability.20in.20rustc_attr.20and.20rustdoc.html#203951693">(Jul 15 2020 at 13:00)</a>:</h4>
<p>Personally I've been under the impression that <span class="user-mention" data-user-id="210316">@GuillaumeGomez</span> wants to significantly simplify <code>clean</code>. But it's not clear what it does currently so it's hard to make changes. If you can refactor them without breaking things I'm sure it would be very welcome.</p>



<a name="203952063"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/Merge%20Stability%20in%20rustc_attr%20and%20rustdoc/near/203952063" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> eddyb <a href="https://zulip-archive.rust-lang.org/stream/131828-t-compiler/topic/Merge.20Stability.20in.20rustc_attr.20and.20rustdoc.html#203952063">(Jul 15 2020 at 13:03)</a>:</h4>
<blockquote>
<p>But it's not clear what it does currently</p>
</blockquote>
<p>its "cleans" stuff. it's based on the idea that rustc's internals are a mess and they need "cleaning"</p>



<a name="203952079"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/Merge%20Stability%20in%20rustc_attr%20and%20rustdoc/near/203952079" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> eddyb <a href="https://zulip-archive.rust-lang.org/stream/131828-t-compiler/topic/Merge.20Stability.20in.20rustc_attr.20and.20rustdoc.html#203952079">(Jul 15 2020 at 13:03)</a>:</h4>
<p>but this view has probably been outdated for like 4-5 years now</p>



<a name="203952121"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/Merge%20Stability%20in%20rustc_attr%20and%20rustdoc/near/203952121" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> eddyb <a href="https://zulip-archive.rust-lang.org/stream/131828-t-compiler/topic/Merge.20Stability.20in.20rustc_attr.20and.20rustdoc.html#203952121">(Jul 15 2020 at 13:04)</a>:</h4>
<p>so you can treat it as a partially-unnecessary "lowering"/"extraction" step</p>



<a name="203955166"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/Merge%20Stability%20in%20rustc_attr%20and%20rustdoc/near/203955166" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> lzutao <a href="https://zulip-archive.rust-lang.org/stream/131828-t-compiler/topic/Merge.20Stability.20in.20rustc_attr.20and.20rustdoc.html#203955166">(Jul 15 2020 at 13:31)</a>:</h4>
<p><span class="user-mention silent" data-user-id="209117">lzutao</span> <a href="#narrow/stream/131828-t-compiler/topic/Merge.20Stability.20in.20rustc_attr.20and.20rustdoc/near/203932171">said</a>:</p>
<blockquote>
<p>Also <a href="https://doc.rust-lang.org/nightly/nightly-rustc/rustdoc/clean/types/struct.Deprecation.html">https://doc.rust-lang.org/nightly/nightly-rustc/rustdoc/clean/types/struct.Deprecation.html</a> and <a href="https://doc.rust-lang.org/nightly/nightly-rustc/rustc_attr/struct.RustcDeprecation.html">https://doc.rust-lang.org/nightly/nightly-rustc/rustc_attr/struct.RustcDeprecation.html</a></p>
</blockquote>
<p>Should be <a href="https://doc.rust-lang.org/nightly/nightly-rustc/rustc_attr/struct.Deprecation.html">https://doc.rust-lang.org/nightly/nightly-rustc/rustc_attr/struct.Deprecation.html</a></p>



<hr><p>Last updated: Apr 12 2022 at 20:01 UTC</p>
</html>