<html>
<head><meta charset="utf-8"><title>Q: bootstrap Linux w/ cross-compile to Apple M1 support? · t-compiler · Zulip Chat Archive</title></head>
<h2>Stream: <a href="https://zulip-archive.rust-lang.org/stream/131828-t-compiler/index.html">t-compiler</a></h2>
<h3>Topic: <a href="https://zulip-archive.rust-lang.org/stream/131828-t-compiler/topic/Q.3A.20bootstrap.20Linux.20w.2F.20cross-compile.20to.20Apple.20M1.20support.3F.html">Q: bootstrap Linux w/ cross-compile to Apple M1 support?</a></h3>

<hr>

<base href="https://rust-lang.zulipchat.com">

<head><link href="https://zulip-archive.rust-lang.org/style.css" rel="stylesheet"></head>

<a name="265844304"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/Q%3A%20bootstrap%20Linux%20w/%20cross-compile%20to%20Apple%20M1%20support%3F/near/265844304" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pnkfelix <a href="https://zulip-archive.rust-lang.org/stream/131828-t-compiler/topic/Q.3A.20bootstrap.20Linux.20w.2F.20cross-compile.20to.20Apple.20M1.20support.3F.html#265844304">(Dec 22 2021 at 19:43)</a>:</h4>
<p>as part of investigating <a href="https://github.com/rust-lang/rust/issues/91671">#91671</a>, I want to bootstrap Rust on  Linux x86_64 host (x86_64-unknown-linux-gnu, I think) with support for targeting Apple M1 (aarch64-apple-darwin).</p>



<a name="265844504"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/Q%3A%20bootstrap%20Linux%20w/%20cross-compile%20to%20Apple%20M1%20support%3F/near/265844504" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pnkfelix <a href="https://zulip-archive.rust-lang.org/stream/131828-t-compiler/topic/Q.3A.20bootstrap.20Linux.20w.2F.20cross-compile.20to.20Apple.20M1.20support.3F.html#265844504">(Dec 22 2021 at 19:45)</a>:</h4>
<p>Before I got to the point of bootstrapping my own <code>rustc</code> for this, I was able to figure out what incantations to give to <code>rustup</code> to be able to cross-compile to  aarch64-apple-darwin, at least to sufficient degree that I could observe the LLVM problem I'm debugging.</p>



<a name="265844587"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/Q%3A%20bootstrap%20Linux%20w/%20cross-compile%20to%20Apple%20M1%20support%3F/near/265844587" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pnkfelix <a href="https://zulip-archive.rust-lang.org/stream/131828-t-compiler/topic/Q.3A.20bootstrap.20Linux.20w.2F.20cross-compile.20to.20Apple.20M1.20support.3F.html#265844587">(Dec 22 2021 at 19:46)</a>:</h4>
<p>but when it comes to actually <em>building</em> a local <code>rustc</code> with the necessary bits built in, I hit a snag</p>



<a name="265844610"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/Q%3A%20bootstrap%20Linux%20w/%20cross-compile%20to%20Apple%20M1%20support%3F/near/265844610" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Josh Triplett <a href="https://zulip-archive.rust-lang.org/stream/131828-t-compiler/topic/Q.3A.20bootstrap.20Linux.20w.2F.20cross-compile.20to.20Apple.20M1.20support.3F.html#265844610">(Dec 22 2021 at 19:46)</a>:</h4>
<p>I was under the impression that in general it was <em>hard</em> to cross-compile for macOS, primarily because of needing macOS libraries around.</p>



<a name="265844679"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/Q%3A%20bootstrap%20Linux%20w/%20cross-compile%20to%20Apple%20M1%20support%3F/near/265844679" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pnkfelix <a href="https://zulip-archive.rust-lang.org/stream/131828-t-compiler/topic/Q.3A.20bootstrap.20Linux.20w.2F.20cross-compile.20to.20Apple.20M1.20support.3F.html#265844679">(Dec 22 2021 at 19:47)</a>:</h4>
<p>I guess I <del>should</del> could first simplify things by targeting aarch64-linux instead of apple-darwin</p>



<a name="265844797"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/Q%3A%20bootstrap%20Linux%20w/%20cross-compile%20to%20Apple%20M1%20support%3F/near/265844797" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pnkfelix <a href="https://zulip-archive.rust-lang.org/stream/131828-t-compiler/topic/Q.3A.20bootstrap.20Linux.20w.2F.20cross-compile.20to.20Apple.20M1.20support.3F.html#265844797">(Dec 22 2021 at 19:48)</a>:</h4>
<p>(I wasn't doing that, because I was using an Apple M1 to investigate the problem locally, and so it made the most sense to me to focus on cross-compiling to that platform, <em>if</em> it is feasible to do that bootstrap. And since the nightly compiler we distribute supports it, I figured I could do it too....)</p>



<a name="265844872"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/Q%3A%20bootstrap%20Linux%20w/%20cross-compile%20to%20Apple%20M1%20support%3F/near/265844872" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pnkfelix <a href="https://zulip-archive.rust-lang.org/stream/131828-t-compiler/topic/Q.3A.20bootstrap.20Linux.20w.2F.20cross-compile.20to.20Apple.20M1.20support.3F.html#265844872">(Dec 22 2021 at 19:49)</a>:</h4>
<p><span class="user-mention silent" data-user-id="239881">Josh Triplett</span> <a href="#narrow/stream/131828-t-compiler/topic/Q.3A.20bootstrap.20Linux.20w.2F.20cross-compile.20to.20Apple.20M1.20support.3F/near/265844610">said</a>:</p>
<blockquote>
<p>I was under the impression that in general it was <em>hard</em> to cross-compile for macOS, primarily because of needing macOS libraries around.</p>
</blockquote>
<p>Do our CI systems deal with this by having the Mac OS libraries accessible to their docker images?</p>



<a name="265844927"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/Q%3A%20bootstrap%20Linux%20w/%20cross-compile%20to%20Apple%20M1%20support%3F/near/265844927" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pnkfelix <a href="https://zulip-archive.rust-lang.org/stream/131828-t-compiler/topic/Q.3A.20bootstrap.20Linux.20w.2F.20cross-compile.20to.20Apple.20M1.20support.3F.html#265844927">(Dec 22 2021 at 19:49)</a>:</h4>
<p>In any case, the specific snag I am hitting is this error: </p>
<div class="codehilite"><pre><span></span><code>  running: &quot;cc&quot; &quot;-O0&quot; &quot;-ffunction-sections&quot; &quot;-fdata-sections&quot; &quot;-fPIC&quot; &quot;-g&quot; &quot;-fno-omit-frame-pointer&quot; &quot;-arch&quot; &quot;arm64&quot; &quot;-ffunction-sections&quot; &quot;-fdata-sections&quot; &quot;-fPIC&quot; \
&quot;-arch&quot; &quot;arm64&quot; &quot;-stdlib=libc++&quot; &quot;-I&quot; &quot;/media/pnkfelix/Rust/issue_91671/rust-91671/src/llvm-project/compiler-rt/lib/builtins&quot; &quot;-fno-builtin&quot; &quot;-fvisibility=hidden&quot; &quot;-\
ffreestanding&quot; &quot;-DVISIBILITY_HIDDEN&quot; &quot;-o&quot; &quot;/media/pnkfelix/Rust/issue_91671/rust-91671/objdir-dbg/build/x86_64-unknown-linux-gnu/stage1-std/aarch64-apple-darwin/debu\
g/build/compiler_builtins-ff733c215b8d9a3e/out/lse_cas1_relax.o&quot; &quot;-c&quot; &quot;/media/pnkfelix/Rust/issue_91671/rust-91671/objdir-dbg/build/x86_64-unknown-linux-gnu/stage1-s\
td/aarch64-apple-darwin/debug/build/compiler_builtins-ff733c215b8d9a3e/out/lse_cas1_relax.S&quot;
  cargo:warning=cc: error: unrecognized command-line option ‘-arch’
  cargo:warning=cc: error: unrecognized command-line option ‘-arch’
  cargo:warning=cc: error: unrecognized command-line option ‘-stdlib=libc++’
  exit status: 1
</code></pre></div>



<a name="265845025"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/Q%3A%20bootstrap%20Linux%20w/%20cross-compile%20to%20Apple%20M1%20support%3F/near/265845025" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pnkfelix <a href="https://zulip-archive.rust-lang.org/stream/131828-t-compiler/topic/Q.3A.20bootstrap.20Linux.20w.2F.20cross-compile.20to.20Apple.20M1.20support.3F.html#265845025">(Dec 22 2021 at 19:50)</a>:</h4>
<p>I.e. it seems like I'm clearly invoking a compiler with flags that it doesn't expect. so I am then inferring that I need to feed in the path to a different compiler for cross-compilation purposes?</p>



<a name="265845090"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/Q%3A%20bootstrap%20Linux%20w/%20cross-compile%20to%20Apple%20M1%20support%3F/near/265845090" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Hans Kratz <a href="https://zulip-archive.rust-lang.org/stream/131828-t-compiler/topic/Q.3A.20bootstrap.20Linux.20w.2F.20cross-compile.20to.20Apple.20M1.20support.3F.html#265845090">(Dec 22 2021 at 19:51)</a>:</h4>
<p>The CI compiles everything for Apple on Apple hardware AFAIK.</p>



<a name="265845234"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/Q%3A%20bootstrap%20Linux%20w/%20cross-compile%20to%20Apple%20M1%20support%3F/near/265845234" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Josh Triplett <a href="https://zulip-archive.rust-lang.org/stream/131828-t-compiler/topic/Q.3A.20bootstrap.20Linux.20w.2F.20cross-compile.20to.20Apple.20M1.20support.3F.html#265845234">(Dec 22 2021 at 19:53)</a>:</h4>
<p>I think if we could reliably cross-compile we <em>would</em>. At the moment, I think bors is rate-limited by macOS hardware.</p>



<a name="265845244"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/Q%3A%20bootstrap%20Linux%20w/%20cross-compile%20to%20Apple%20M1%20support%3F/near/265845244" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pnkfelix <a href="https://zulip-archive.rust-lang.org/stream/131828-t-compiler/topic/Q.3A.20bootstrap.20Linux.20w.2F.20cross-compile.20to.20Apple.20M1.20support.3F.html#265845244">(Dec 22 2021 at 19:53)</a>:</h4>
<p>Wait, the Linux x86_64 rustc that has support for Apple M1 output is built on an Apple M1 ?</p>



<a name="265845410"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/Q%3A%20bootstrap%20Linux%20w/%20cross-compile%20to%20Apple%20M1%20support%3F/near/265845410" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Josh Triplett <a href="https://zulip-archive.rust-lang.org/stream/131828-t-compiler/topic/Q.3A.20bootstrap.20Linux.20w.2F.20cross-compile.20to.20Apple.20M1.20support.3F.html#265845410">(Dec 22 2021 at 19:55)</a>:</h4>
<p>We have a Linux rustc with support for Apple M1 output?</p>



<a name="265845412"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/Q%3A%20bootstrap%20Linux%20w/%20cross-compile%20to%20Apple%20M1%20support%3F/near/265845412" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pnkfelix <a href="https://zulip-archive.rust-lang.org/stream/131828-t-compiler/topic/Q.3A.20bootstrap.20Linux.20w.2F.20cross-compile.20to.20Apple.20M1.20support.3F.html#265845412">(Dec 22 2021 at 19:55)</a>:</h4>
<p>In any case, I don't <em>need</em> to target Apple M1 to reproduce this bug. I.e. I just trivially reproduced the seg fault again when targeting <code>arch64-unknown-linux-gnu</code></p>



<a name="265845427"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/Q%3A%20bootstrap%20Linux%20w/%20cross-compile%20to%20Apple%20M1%20support%3F/near/265845427" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pnkfelix <a href="https://zulip-archive.rust-lang.org/stream/131828-t-compiler/topic/Q.3A.20bootstrap.20Linux.20w.2F.20cross-compile.20to.20Apple.20M1.20support.3F.html#265845427">(Dec 22 2021 at 19:55)</a>:</h4>
<p><span class="user-mention silent" data-user-id="239881">Josh Triplett</span> <a href="#narrow/stream/131828-t-compiler/topic/Q.3A.20bootstrap.20Linux.20w.2F.20cross-compile.20to.20Apple.20M1.20support.3F/near/265845410">said</a>:</p>
<blockquote>
<p>We have a Linux rustc with support for Apple M1 output?</p>
</blockquote>
<p>At the very least, it lets you choose that as a target.</p>



<a name="265845436"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/Q%3A%20bootstrap%20Linux%20w/%20cross-compile%20to%20Apple%20M1%20support%3F/near/265845436" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Josh Triplett <a href="https://zulip-archive.rust-lang.org/stream/131828-t-compiler/topic/Q.3A.20bootstrap.20Linux.20w.2F.20cross-compile.20to.20Apple.20M1.20support.3F.html#265845436">(Dec 22 2021 at 19:55)</a>:</h4>
<p>I hadn't had the impression that it was generally feasible to <code>rustup target add</code> a macOS target on a non-macOS system.</p>



<a name="265845455"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/Q%3A%20bootstrap%20Linux%20w/%20cross-compile%20to%20Apple%20M1%20support%3F/near/265845455" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Josh Triplett <a href="https://zulip-archive.rust-lang.org/stream/131828-t-compiler/topic/Q.3A.20bootstrap.20Linux.20w.2F.20cross-compile.20to.20Apple.20M1.20support.3F.html#265845455">(Dec 22 2021 at 19:55)</a>:</h4>
<p>(without massive hackery and dubiously legal copying of native libraries)</p>



<a name="265845527"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/Q%3A%20bootstrap%20Linux%20w/%20cross-compile%20to%20Apple%20M1%20support%3F/near/265845527" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Hans Kratz <a href="https://zulip-archive.rust-lang.org/stream/131828-t-compiler/topic/Q.3A.20bootstrap.20Linux.20w.2F.20cross-compile.20to.20Apple.20M1.20support.3F.html#265845527">(Dec 22 2021 at 19:56)</a>:</h4>
<p>Indeed. There is <a href="https://github.com/tpoechtrager/osxcross">https://github.com/tpoechtrager/osxcross</a> but that is quite experimental.</p>



<a name="265845547"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/Q%3A%20bootstrap%20Linux%20w/%20cross-compile%20to%20Apple%20M1%20support%3F/near/265845547" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pnkfelix <a href="https://zulip-archive.rust-lang.org/stream/131828-t-compiler/topic/Q.3A.20bootstrap.20Linux.20w.2F.20cross-compile.20to.20Apple.20M1.20support.3F.html#265845547">(Dec 22 2021 at 19:56)</a>:</h4>
<p><a href="https://github.com/pnkfelix/issue-91671-a64-doctestfail/blob/main/repro.sh">https://github.com/pnkfelix/issue-91671-a64-doctestfail/blob/main/repro.sh</a></p>



<a name="265845607"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/Q%3A%20bootstrap%20Linux%20w/%20cross-compile%20to%20Apple%20M1%20support%3F/near/265845607" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pnkfelix <a href="https://zulip-archive.rust-lang.org/stream/131828-t-compiler/topic/Q.3A.20bootstrap.20Linux.20w.2F.20cross-compile.20to.20Apple.20M1.20support.3F.html#265845607">(Dec 22 2021 at 19:57)</a>:</h4>
<p>Note that its entirely possible that <em>if</em> a binary were generated here, that it doesn't actually work. My goal here wasn't to actually produce M1 output; it was to reproduce a segfault within LLVM that seems correlated to Aarch64 target<strong>s</strong></p>



<a name="265845709"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/Q%3A%20bootstrap%20Linux%20w/%20cross-compile%20to%20Apple%20M1%20support%3F/near/265845709" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pnkfelix <a href="https://zulip-archive.rust-lang.org/stream/131828-t-compiler/topic/Q.3A.20bootstrap.20Linux.20w.2F.20cross-compile.20to.20Apple.20M1.20support.3F.html#265845709">(Dec 22 2021 at 19:58)</a>:</h4>
<p>but I was indeed able to do <code>rustup target add aarch64-apple-darwin</code></p>



<a name="265845749"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/Q%3A%20bootstrap%20Linux%20w/%20cross-compile%20to%20Apple%20M1%20support%3F/near/265845749" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Hans Kratz <a href="https://zulip-archive.rust-lang.org/stream/131828-t-compiler/topic/Q.3A.20bootstrap.20Linux.20w.2F.20cross-compile.20to.20Apple.20M1.20support.3F.html#265845749">(Dec 22 2021 at 19:59)</a>:</h4>
<p>If it is reproducible with <code>arch64-unknown-linux-gnu</code> the additional flaming hoops one would need to jump through to get macos cross compilation working are probably not worth it.</p>



<a name="265845754"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/Q%3A%20bootstrap%20Linux%20w/%20cross-compile%20to%20Apple%20M1%20support%3F/near/265845754" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pnkfelix <a href="https://zulip-archive.rust-lang.org/stream/131828-t-compiler/topic/Q.3A.20bootstrap.20Linux.20w.2F.20cross-compile.20to.20Apple.20M1.20support.3F.html#265845754">(Dec 22 2021 at 19:59)</a>:</h4>
<p>(sorry, mistyped before from when I locally edited script to target <code>aarch64-unknown-linux-gnu</code> instead)</p>



<a name="265845794"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/Q%3A%20bootstrap%20Linux%20w/%20cross-compile%20to%20Apple%20M1%20support%3F/near/265845794" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pnkfelix <a href="https://zulip-archive.rust-lang.org/stream/131828-t-compiler/topic/Q.3A.20bootstrap.20Linux.20w.2F.20cross-compile.20to.20Apple.20M1.20support.3F.html#265845794">(Dec 22 2021 at 19:59)</a>:</h4>
<p>yeah okay. I'm still fascinated that its so hard to recreate the environment our CI must be using...</p>



<a name="265845953"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/Q%3A%20bootstrap%20Linux%20w/%20cross-compile%20to%20Apple%20M1%20support%3F/near/265845953" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pnkfelix <a href="https://zulip-archive.rust-lang.org/stream/131828-t-compiler/topic/Q.3A.20bootstrap.20Linux.20w.2F.20cross-compile.20to.20Apple.20M1.20support.3F.html#265845953">(Dec 22 2021 at 20:00)</a>:</h4>
<p>but I'll go investigate whether things go more smoothly when bootstrapping to target aarch64-unknown-linux-gnu instead of aarch64-apple-darwin.</p>



<a name="265846326"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/Q%3A%20bootstrap%20Linux%20w/%20cross-compile%20to%20Apple%20M1%20support%3F/near/265846326" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pnkfelix <a href="https://zulip-archive.rust-lang.org/stream/131828-t-compiler/topic/Q.3A.20bootstrap.20Linux.20w.2F.20cross-compile.20to.20Apple.20M1.20support.3F.html#265846326">(Dec 22 2021 at 20:02)</a>:</h4>
<p>(if nothing else, that at least fails with an error that I find far more immediately actionable: <code>couldn't find required command: "aarch64-linux-gnu-gcc"</code>)</p>



<a name="265848330"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/Q%3A%20bootstrap%20Linux%20w/%20cross-compile%20to%20Apple%20M1%20support%3F/near/265848330" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pnkfelix <a href="https://zulip-archive.rust-lang.org/stream/131828-t-compiler/topic/Q.3A.20bootstrap.20Linux.20w.2F.20cross-compile.20to.20Apple.20M1.20support.3F.html#265848330">(Dec 22 2021 at 20:21)</a>:</h4>
<p>(okay, targeting <code>aarch64-linux-gnu-gcc</code> went more smoothly, as expected)</p>



<a name="265864750"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/131828-t-compiler/topic/Q%3A%20bootstrap%20Linux%20w/%20cross-compile%20to%20Apple%20M1%20support%3F/near/265864750" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Eric Huss <a href="https://zulip-archive.rust-lang.org/stream/131828-t-compiler/topic/Q.3A.20bootstrap.20Linux.20w.2F.20cross-compile.20to.20Apple.20M1.20support.3F.html#265864750">(Dec 22 2021 at 23:09)</a>:</h4>
<p><span class="user-mention silent" data-user-id="116083">pnkfelix</span> <a href="#narrow/stream/131828-t-compiler/topic/Q.3A.20bootstrap.20Linux.20w.2F.20cross-compile.20to.20Apple.20M1.20support.3F/near/265845709">said</a>:</p>
<blockquote>
<p>but I was indeed able to do <code>rustup target add aarch64-apple-darwin</code></p>
</blockquote>
<p>That <code>rust-std</code> target was built on a macOS machine.  CI doesn't build all std targets on every host.  Each std target distribution is generally built once in one of the myriad of CI jobs and uploaded to a common bucket.  When you run <code>rustup target add ...</code>, that is agnostic to your host.  You can install any target, but they may not all work (unless you employ some heroics).</p>



<hr><p>Last updated: Apr 12 2022 at 20:01 UTC</p>
</html>