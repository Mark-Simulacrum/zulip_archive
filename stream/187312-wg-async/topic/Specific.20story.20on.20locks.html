<html>
<head><meta charset="utf-8"><title>Specific story on locks · wg-async · Zulip Chat Archive</title></head>
<h2>Stream: <a href="https://zulip-archive.rust-lang.org/stream/187312-wg-async/index.html">wg-async</a></h2>
<h3>Topic: <a href="https://zulip-archive.rust-lang.org/stream/187312-wg-async/topic/Specific.20story.20on.20locks.html">Specific story on locks</a></h3>

<hr>

<base href="https://rust-lang.zulipchat.com">

<head><link href="https://zulip-archive.rust-lang.org/style.css" rel="stylesheet"></head>

<a name="232464043"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/187312-wg-async/topic/Specific%20story%20on%20locks/near/232464043" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> rylev <a href="https://zulip-archive.rust-lang.org/stream/187312-wg-async/topic/Specific.20story.20on.20locks.html#232464043">(Mar 30 2021 at 17:22)</a>:</h4>
<p>We have a few issues on the intersection of sync and async worlds, but a specific occasion of these two worlds colliding that comes up often and early is the use of <code>std::sync::Mutex</code>. Locks are fairly common in async code, but using a blocking lock is usually not what you want. Would it make sense to create a story about this?</p>



<a name="232466137"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/187312-wg-async/topic/Specific%20story%20on%20locks/near/232466137" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lucio Franco <a href="https://zulip-archive.rust-lang.org/stream/187312-wg-async/topic/Specific.20story.20on.20locks.html#232466137">(Mar 30 2021 at 17:36)</a>:</h4>
<p>I think it makes sense to dive into this. I actually think that using blocking locks (correctly) is much better than async ones for example and explaining this would be good.</p>



<a name="232467855"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/187312-wg-async/topic/Specific%20story%20on%20locks/near/232467855" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> rylev <a href="https://zulip-archive.rust-lang.org/stream/187312-wg-async/topic/Specific.20story.20on.20locks.html#232467855">(Mar 30 2021 at 17:48)</a>:</h4>
<p><span class="user-mention" data-user-id="207781">@Lucio Franco</span> This is interesting. I'd love to learn more (separate from the vision doc). I think "common wisdom" is to avoid all potentially blocking API calls in async code. Perhaps the story can be about Barbara following this "common wisdom" and then being told by her friend Lucio that she might actually benefit from using sync locks.</p>



<a name="232469406"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/187312-wg-async/topic/Specific%20story%20on%20locks/near/232469406" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Alice Ryhl <a href="https://zulip-archive.rust-lang.org/stream/187312-wg-async/topic/Specific.20story.20on.20locks.html#232469406">(Mar 30 2021 at 17:58)</a>:</h4>
<p>I mention this at the end of <a href="https://ryhl.io/blog/async-what-is-blocking/">my blog post on blocking</a>, where I explain it with "if you block for a short time, is it really blocking?"</p>



<a name="232766056"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/187312-wg-async/topic/Specific%20story%20on%20locks/near/232766056" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/187312-wg-async/topic/Specific.20story.20on.20locks.html#232766056">(Apr 01 2021 at 14:31)</a>:</h4>
<p><span class="user-mention" data-user-id="207781">@Lucio Franco</span> and <span class="user-mention" data-user-id="218683">@Alice Ryhl</span> -- maybe one of you would be interested to write up a status quo story here?</p>



<a name="232766064"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/187312-wg-async/topic/Specific%20story%20on%20locks/near/232766064" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/187312-wg-async/topic/Specific.20story.20on.20locks.html#232766064">(Apr 01 2021 at 14:31)</a>:</h4>
<p>I'd like to know more about the experiences</p>



<a name="232769174"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/187312-wg-async/topic/Specific%20story%20on%20locks/near/232769174" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Alice Ryhl <a href="https://zulip-archive.rust-lang.org/stream/187312-wg-async/topic/Specific.20story.20on.20locks.html#232769174">(Apr 01 2021 at 14:48)</a>:</h4>
<p>I have already said I wanted to write something on it, but I failed to find the energy ..</p>



<a name="232769351"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/187312-wg-async/topic/Specific%20story%20on%20locks/near/232769351" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> rylev <a href="https://zulip-archive.rust-lang.org/stream/187312-wg-async/topic/Specific.20story.20on.20locks.html#232769351">(Apr 01 2021 at 14:49)</a>:</h4>
<p><span class="user-mention silent" data-user-id="218683">Alice Ryhl</span> <a href="#narrow/stream/187312-wg-async-foundations/topic/Specific.20story.20on.20locks/near/232769174">said</a>:</p>
<blockquote>
<p>I have already said I wanted to write something on it, but I failed to find the energy ..</p>
</blockquote>
<p><span class="user-mention" data-user-id="218683">@Alice Ryhl</span> let me know if you want to pair on it. I've found the async doc sessions we're doing to be great for getting the energy since it turns into a conversation as opposed to a solo writing session.</p>



<a name="232769467"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/187312-wg-async/topic/Specific%20story%20on%20locks/near/232769467" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Alice Ryhl <a href="https://zulip-archive.rust-lang.org/stream/187312-wg-async/topic/Specific.20story.20on.20locks.html#232769467">(Apr 01 2021 at 14:50)</a>:</h4>
<p>Ah, that would probably be a good idea.</p>



<a name="232771194"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/187312-wg-async/topic/Specific%20story%20on%20locks/near/232771194" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Andrew Chin (eminence) <a href="https://zulip-archive.rust-lang.org/stream/187312-wg-async/topic/Specific.20story.20on.20locks.html#232771194">(Apr 01 2021 at 15:00)</a>:</h4>
<p>(can confirm, the writing sessions are full of good energy)</p>



<a name="233514466"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/187312-wg-async/topic/Specific%20story%20on%20locks/near/233514466" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lucio Franco <a href="https://zulip-archive.rust-lang.org/stream/187312-wg-async/topic/Specific.20story.20on.20locks.html#233514466">(Apr 07 2021 at 15:50)</a>:</h4>
<p>Sorry I was OOTO last week but <span class="user-mention" data-user-id="224872">@rylev</span> <span class="user-mention" data-user-id="218683">@Alice Ryhl</span> I'd be very open to doing a 3 way pairing on this, as long as I find some time on my cal I can give an hour or so.</p>



<a name="233518151"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/187312-wg-async/topic/Specific%20story%20on%20locks/near/233518151" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Alice Ryhl <a href="https://zulip-archive.rust-lang.org/stream/187312-wg-async/topic/Specific.20story.20on.20locks.html#233518151">(Apr 07 2021 at 16:12)</a>:</h4>
<p>Would you two have time in the start of next week? I'm in the GMT+2 timezone.<br>
<span class="user-mention" data-user-id="224872">@rylev</span> <span class="user-mention" data-user-id="207781">@Lucio Franco</span></p>



<a name="233518464"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/187312-wg-async/topic/Specific%20story%20on%20locks/near/233518464" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> rylev <a href="https://zulip-archive.rust-lang.org/stream/187312-wg-async/topic/Specific.20story.20on.20locks.html#233518464">(Apr 07 2021 at 16:14)</a>:</h4>
<p>Same here. I believe Lucio is GMT-4. I can do Monday at 16:00 GMT (which is 18:00 CEST and 12:00 EDT)</p>



<a name="233518493"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/187312-wg-async/topic/Specific%20story%20on%20locks/near/233518493" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lucio Franco <a href="https://zulip-archive.rust-lang.org/stream/187312-wg-async/topic/Specific.20story.20on.20locks.html#233518493">(Apr 07 2021 at 16:15)</a>:</h4>
<p>Works for me!</p>



<a name="233518516"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/187312-wg-async/topic/Specific%20story%20on%20locks/near/233518516" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lucio Franco <a href="https://zulip-archive.rust-lang.org/stream/187312-wg-async/topic/Specific.20story.20on.20locks.html#233518516">(Apr 07 2021 at 16:15)</a>:</h4>
<p>And yup on that wonderful EDT</p>



<a name="233518704"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/187312-wg-async/topic/Specific%20story%20on%20locks/near/233518704" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> rylev <a href="https://zulip-archive.rust-lang.org/stream/187312-wg-async/topic/Specific.20story.20on.20locks.html#233518704">(Apr 07 2021 at 16:16)</a>:</h4>
<p><span class="user-mention silent" data-user-id="207781">Lucio Franco</span> <a href="#narrow/stream/187312-wg-async-foundations/topic/Specific.20story.20on.20locks/near/233518516">said</a>:</p>
<blockquote>
<p>And yup on that wonderful EDT</p>
</blockquote>
<p>My mom who recently moved from CDT to EDT disagrees that EDT is so wonderful <span aria-label="blush" class="emoji emoji-1f60a" role="img" title="blush">:blush:</span>. Makes watching long movies on TV harder since they end so late hehe</p>



<a name="233518778"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/187312-wg-async/topic/Specific%20story%20on%20locks/near/233518778" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lucio Franco <a href="https://zulip-archive.rust-lang.org/stream/187312-wg-async/topic/Specific.20story.20on.20locks.html#233518778">(Apr 07 2021 at 16:16)</a>:</h4>
<p>haha I meant that comment as totally sarcastic :D I miss MDT a lot sometimes</p>



<a name="233519033"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/187312-wg-async/topic/Specific%20story%20on%20locks/near/233519033" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> rylev <a href="https://zulip-archive.rust-lang.org/stream/187312-wg-async/topic/Specific.20story.20on.20locks.html#233519033">(Apr 07 2021 at 16:18)</a>:</h4>
<p><span class="user-mention" data-user-id="218683">@Alice Ryhl</span> does 18:00 CEST work for you?</p>



<a name="233519074"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/187312-wg-async/topic/Specific%20story%20on%20locks/near/233519074" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Alice Ryhl <a href="https://zulip-archive.rust-lang.org/stream/187312-wg-async/topic/Specific.20story.20on.20locks.html#233519074">(Apr 07 2021 at 16:18)</a>:</h4>
<p>Monday 18:00 CEST is good</p>



<a name="233519215"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/187312-wg-async/topic/Specific%20story%20on%20locks/near/233519215" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> rylev <a href="https://zulip-archive.rust-lang.org/stream/187312-wg-async/topic/Specific.20story.20on.20locks.html#233519215">(Apr 07 2021 at 16:19)</a>:</h4>
<p>Do we want to do Zoom?</p>



<a name="233519254"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/187312-wg-async/topic/Specific%20story%20on%20locks/near/233519254" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Alice Ryhl <a href="https://zulip-archive.rust-lang.org/stream/187312-wg-async/topic/Specific.20story.20on.20locks.html#233519254">(Apr 07 2021 at 16:19)</a>:</h4>
<p>Zoom is fine with me</p>



<a name="233519368"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/187312-wg-async/topic/Specific%20story%20on%20locks/near/233519368" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lucio Franco <a href="https://zulip-archive.rust-lang.org/stream/187312-wg-async/topic/Specific.20story.20on.20locks.html#233519368">(Apr 07 2021 at 16:20)</a>:</h4>
<p>Sure works for me, is it possible to generate a link before?</p>



<a name="233519446"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/187312-wg-async/topic/Specific%20story%20on%20locks/near/233519446" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Alice Ryhl <a href="https://zulip-archive.rust-lang.org/stream/187312-wg-async/topic/Specific.20story.20on.20locks.html#233519446">(Apr 07 2021 at 16:20)</a>:</h4>
<p>Yes, I can make one now</p>



<a name="233519791"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/187312-wg-async/topic/Specific%20story%20on%20locks/near/233519791" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Alice Ryhl <a href="https://zulip-archive.rust-lang.org/stream/187312-wg-async/topic/Specific.20story.20on.20locks.html#233519791">(Apr 07 2021 at 16:22)</a>:</h4>
<div class="codehilite"><pre><span></span><code>Alice Ryhl is inviting you to a scheduled Zoom meeting.

Topic: Async story on locks
Time: Apr 12, 2021 04:00 PM Universal Time UTC

Join Zoom Meeting
https://dtudk.zoom.us/j/65752370094?pwd=TnpOSkJzbTFRQVR4Y1dBYjZHT3Z5Zz09

Meeting ID: 657 5237 0094
Passcode: 575085
One tap mobile
+4532701206,,65752370094#,,,,*575085# Denmark
+4532713157,,65752370094#,,,,*575085# Denmark

Dial by your location
        +45 32 70 12 06 Denmark
        +45 32 71 31 57 Denmark
        +45 32 72 80 10 Denmark
        +45 32 72 80 11 Denmark
        +45 47 37 25 75 Denmark
        +45 89 88 37 88 Denmark
Meeting ID: 657 5237 0094
Passcode: 575085
Find your local number: https://dtudk.zoom.us/u/cxLFi94D5

Join by SIP
65752370094@109.105.112.236
65752370094@109.105.112.235

Join by H.323
109.105.112.236
109.105.112.235
Meeting ID: 657 5237 0094
Passcode: 575085

Join by Skype for Business
https://dtudk.zoom.us/skype/65752370094
</code></pre></div>



<a name="233519861"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/187312-wg-async/topic/Specific%20story%20on%20locks/near/233519861" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lucio Franco <a href="https://zulip-archive.rust-lang.org/stream/187312-wg-async/topic/Specific.20story.20on.20locks.html#233519861">(Apr 07 2021 at 16:23)</a>:</h4>
<p>the heck, <a href="http://zoom.us/skype">zoom.us/skype</a> lol</p>



<a name="233520178"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/187312-wg-async/topic/Specific%20story%20on%20locks/near/233520178" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Andrew Chin (eminence) <a href="https://zulip-archive.rust-lang.org/stream/187312-wg-async/topic/Specific.20story.20on.20locks.html#233520178">(Apr 07 2021 at 16:25)</a>:</h4>
<p>i think zulip has special syntax for rendering times in everyones local timezone.  i'm using your conversation as an excuse to try to figure it out :)  does this work:  <time datetime="2021-04-12T16:00:00Z">2021-04-12T18:00:00+02:00</time></p>



<a name="233520236"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/187312-wg-async/topic/Specific%20story%20on%20locks/near/233520236" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Alice Ryhl <a href="https://zulip-archive.rust-lang.org/stream/187312-wg-async/topic/Specific.20story.20on.20locks.html#233520236">(Apr 07 2021 at 16:25)</a>:</h4>
<p>Fancy. Seems to work.</p>



<a name="233520837"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/187312-wg-async/topic/Specific%20story%20on%20locks/near/233520837" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Andrew Chin (eminence) <a href="https://zulip-archive.rust-lang.org/stream/187312-wg-async/topic/Specific.20story.20on.20locks.html#233520837">(Apr 07 2021 at 16:29)</a>:</h4>
<p>(if you start typing <code>&lt;time:</code> you should get a pop-up dialog that will give you datetime-picker)</p>



<a name="234310995"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/187312-wg-async/topic/Specific%20story%20on%20locks/near/234310995" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> rylev <a href="https://zulip-archive.rust-lang.org/stream/187312-wg-async/topic/Specific.20story.20on.20locks.html#234310995">(Apr 13 2021 at 11:54)</a>:</h4>
<p><span class="user-mention" data-user-id="218683">@Alice Ryhl</span> how are you feeling about turning our notes into a status quo story?</p>



<a name="234320666"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/187312-wg-async/topic/Specific%20story%20on%20locks/near/234320666" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Alice Ryhl <a href="https://zulip-archive.rust-lang.org/stream/187312-wg-async/topic/Specific.20story.20on.20locks.html#234320666">(Apr 13 2021 at 13:04)</a>:</h4>
<p>I don't think I'm going to be able to find the energy today</p>



<a name="234343052"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/187312-wg-async/topic/Specific%20story%20on%20locks/near/234343052" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> rylev <a href="https://zulip-archive.rust-lang.org/stream/187312-wg-async/topic/Specific.20story.20on.20locks.html#234343052">(Apr 13 2021 at 15:05)</a>:</h4>
<p>No worries. I will try to get it done at some point this week <span aria-label="blush" class="emoji emoji-1f60a" role="img" title="blush">:blush:</span></p>



<a name="234368983"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/187312-wg-async/topic/Specific%20story%20on%20locks/near/234368983" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> rylev <a href="https://zulip-archive.rust-lang.org/stream/187312-wg-async/topic/Specific.20story.20on.20locks.html#234368983">(Apr 13 2021 at 17:33)</a>:</h4>
<p>I wrote the story up: <a href="https://github.com/rust-lang/wg-async-foundations/pull/148">https://github.com/rust-lang/wg-async-foundations/pull/148</a></p>



<hr><p>Last updated: Apr 12 2022 at 20:01 UTC</p>
</html>