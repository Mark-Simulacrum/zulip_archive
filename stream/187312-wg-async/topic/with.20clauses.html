<html>
<head><meta charset="utf-8"><title>with clauses · wg-async · Zulip Chat Archive</title></head>
<h2>Stream: <a href="https://zulip-archive.rust-lang.org/stream/187312-wg-async/index.html">wg-async</a></h2>
<h3>Topic: <a href="https://zulip-archive.rust-lang.org/stream/187312-wg-async/topic/with.20clauses.html">with clauses</a></h3>

<hr>

<base href="https://rust-lang.zulipchat.com">

<head><link href="https://zulip-archive.rust-lang.org/style.css" rel="stylesheet"></head>

<a name="265719026"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/187312-wg-async/topic/with%20clauses/near/265719026" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> tmandry <a href="https://zulip-archive.rust-lang.org/stream/187312-wg-async/topic/with.20clauses.html#265719026">(Dec 21 2021 at 18:29)</a>:</h4>
<p>I wrote a blog post on <a href="https://tmandry.gitlab.io/blog/posts/2021-12-21-context-capabilities/">contexts and capabilities</a>, also known as with clauses</p>



<a name="265724295"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/187312-wg-async/topic/with%20clauses/near/265724295" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Nick Cameron <a href="https://zulip-archive.rust-lang.org/stream/187312-wg-async/topic/with.20clauses.html#265724295">(Dec 21 2021 at 19:20)</a>:</h4>
<p>Why do you need the capability keyword rather than using a with clause there?</p>



<a name="265724552"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/187312-wg-async/topic/with%20clauses/near/265724552" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Nick Cameron <a href="https://zulip-archive.rust-lang.org/stream/187312-wg-async/topic/with.20clauses.html#265724552">(Dec 21 2021 at 19:23)</a>:</h4>
<p>(As a high level comment on the whole with clause idea, I think solving the ‘passing around context’ problem is very desirable, but I also feel like adding with clauses is spending like three years of rust’s complexity budget in one go)</p>



<a name="265724618"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/187312-wg-async/topic/with%20clauses/near/265724618" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Nick Cameron <a href="https://zulip-archive.rust-lang.org/stream/187312-wg-async/topic/with.20clauses.html#265724618">(Dec 21 2021 at 19:23)</a>:</h4>
<p>The question is specifically about the example, by the way (on mobile so I can’t grab a helpful quote)</p>



<a name="265730902"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/187312-wg-async/topic/with%20clauses/near/265730902" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> tmandry <a href="https://zulip-archive.rust-lang.org/stream/187312-wg-async/topic/with.20clauses.html#265730902">(Dec 21 2021 at 20:30)</a>:</h4>
<p><code>capability</code> defines a new name that can be used in <code>with</code> clauses</p>



<a name="265730960"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/187312-wg-async/topic/with%20clauses/near/265730960" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> tmandry <a href="https://zulip-archive.rust-lang.org/stream/187312-wg-async/topic/with.20clauses.html#265730960">(Dec 21 2021 at 20:30)</a>:</h4>
<p>i.e. <code>capability</code> is an item</p>



<a name="265731041"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/187312-wg-async/topic/with%20clauses/near/265731041" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> tmandry <a href="https://zulip-archive.rust-lang.org/stream/187312-wg-async/topic/with.20clauses.html#265731041">(Dec 21 2021 at 20:31)</a>:</h4>
<p>also yes, the complexity cost is something to consider :)</p>



<a name="265736557"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/187312-wg-async/topic/with%20clauses/near/265736557" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Nick Cameron <a href="https://zulip-archive.rust-lang.org/stream/187312-wg-async/topic/with.20clauses.html#265736557">(Dec 21 2021 at 21:31)</a>:</h4>
<p>Why can’t you just use ‘x: T’, why the extra keyword?</p>



<a name="265745842"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/187312-wg-async/topic/with%20clauses/near/265745842" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> tmandry <a href="https://zulip-archive.rust-lang.org/stream/187312-wg-async/topic/with.20clauses.html#265745842">(Dec 21 2021 at 23:10)</a>:</h4>
<p>I'm not sure what you mean.</p>



<a name="265925626"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/187312-wg-async/topic/with%20clauses/near/265925626" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Nick Cameron <a href="https://zulip-archive.rust-lang.org/stream/187312-wg-async/topic/with.20clauses.html#265925626">(Dec 23 2021 at 15:18)</a>:</h4>
<p>OK, so I've had a chance to read again and I'm not on mobile.</p>



<a name="265925836"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/187312-wg-async/topic/with%20clauses/near/265925836" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Nick Cameron <a href="https://zulip-archive.rust-lang.org/stream/187312-wg-async/topic/with.20clauses.html#265925836">(Dec 23 2021 at 15:21)</a>:</h4>
<p>I mean why do we need the <code>capability</code> declaration at all? In the example,  I could imagine deserialize declared with <code> with a: &amp;'a arena::BasicArena</code> and called inside <code>with a = &amp;arena::BasicArena::new() { ... }</code> (obviously in real life, one would use a more descriptive name than <code>a</code>). But I don't see why the name of the 'with variable' has to be declared in the <code>arena</code> module?</p>



<a name="265925990"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/187312-wg-async/topic/with%20clauses/near/265925990" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Nick Cameron <a href="https://zulip-archive.rust-lang.org/stream/187312-wg-async/topic/with.20clauses.html#265925990">(Dec 23 2021 at 15:23)</a>:</h4>
<p>Also, the fact that the <code>capability</code> is declared with a variable name on the left of the <code>=</code> and a type on the right is confusing to me.</p>



<a name="265926212"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/187312-wg-async/topic/with%20clauses/near/265926212" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Nick Cameron <a href="https://zulip-archive.rust-lang.org/stream/187312-wg-async/topic/with.20clauses.html#265926212">(Dec 23 2021 at 15:26)</a>:</h4>
<p>And another question, if we extend the example, we have the <code>with</code> clause on deserialize and the <code>with</code> block in main, but rather than main calling deserialize directly, main calls foo which calls deserialize, does foo require a <code>with</code> clause? Or does the compiler infer an implicit <code>with</code> clause that must be satisfied by all callers of foo?</p>



<a name="265929016"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/187312-wg-async/topic/with%20clauses/near/265929016" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Nick Cameron <a href="https://zulip-archive.rust-lang.org/stream/187312-wg-async/topic/with.20clauses.html#265929016">(Dec 23 2021 at 15:59)</a>:</h4>
<p>and if you are going to require the <code>capability</code> declaration, it seems like you shouldn't need the type (only the path) in a with clause?</p>



<a name="265929478"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/187312-wg-async/topic/with%20clauses/near/265929478" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Nick Cameron <a href="https://zulip-archive.rust-lang.org/stream/187312-wg-async/topic/with.20clauses.html#265929478">(Dec 23 2021 at 16:03)</a>:</h4>
<p>(also, I'm not a fan of the keyword capability - where does it come from? To me a capability means something like a permission (or the combination of a reference + permissions) as in capability-based security or (in PL) read/write capabilities in systems like fractional permissions)</p>



<a name="265929654"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/187312-wg-async/topic/with%20clauses/near/265929654" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> tmandry <a href="https://zulip-archive.rust-lang.org/stream/187312-wg-async/topic/with.20clauses.html#265929654">(Dec 23 2021 at 16:05)</a>:</h4>
<p><span class="user-mention silent" data-user-id="256841">Nick Cameron</span> <a href="#narrow/stream/187312-wg-async-foundations/topic/with.20clauses/near/265925836">said</a>:</p>
<blockquote>
<p>I mean why do we need the <code>capability</code> declaration at all? In the example,  I could imagine deserialize declared with <code> with a: &amp;'a arena::BasicArena</code> and called inside <code>with a = &amp;arena::BasicArena::new() { ... }</code> (obviously in real life, one would use a more descriptive name than <code>a</code>). But I don't see why the name of the 'with variable' has to be declared in the <code>arena</code> module?</p>
</blockquote>
<p>this prevents conflicts that would arise from different code using the same name to mean different things</p>



<a name="265929713"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/187312-wg-async/topic/with%20clauses/near/265929713" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> tmandry <a href="https://zulip-archive.rust-lang.org/stream/187312-wg-async/topic/with.20clauses.html#265929713">(Dec 23 2021 at 16:06)</a>:</h4>
<p>it doesn't have to be declared in <code>arena</code>, it could be declared anywhere, but that example is meant to drive the point home that it's a standalone item</p>



<a name="265929839"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/187312-wg-async/topic/with%20clauses/near/265929839" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> tmandry <a href="https://zulip-archive.rust-lang.org/stream/187312-wg-async/topic/with.20clauses.html#265929839">(Dec 23 2021 at 16:08)</a>:</h4>
<p><span class="user-mention silent" data-user-id="256841">Nick Cameron</span> <a href="#narrow/stream/187312-wg-async-foundations/topic/with.20clauses/near/265925990">said</a>:</p>
<blockquote>
<p>Also, the fact that the <code>capability</code> is declared with a variable name on the left of the <code>=</code> and a type on the right is confusing to me.</p>
</blockquote>
<p>fair enough, I'm anticipating it will be more common to use trait bounds rather than types, but we could use <code>:</code> to specify the type and a <code>where</code> clause for trait bounds</p>



<a name="265929949"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/187312-wg-async/topic/with%20clauses/near/265929949" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> tmandry <a href="https://zulip-archive.rust-lang.org/stream/187312-wg-async/topic/with.20clauses.html#265929949">(Dec 23 2021 at 16:10)</a>:</h4>
<p><span class="user-mention silent" data-user-id="256841">Nick Cameron</span> <a href="#narrow/stream/187312-wg-async-foundations/topic/with.20clauses/near/265926212">said</a>:</p>
<blockquote>
<p>And another question, if we extend the example, we have the <code>with</code> clause on deserialize and the <code>with</code> block in main, but rather than main calling deserialize directly, main calls foo which calls deserialize, does foo require a <code>with</code> clause? Or does the compiler infer an implicit <code>with</code> clause that must be satisfied by all callers of foo?</p>
</blockquote>
<p>foo would require a <code>with</code> clause, unless it's "implied" by some generic bound of foo</p>



<a name="265930038"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/187312-wg-async/topic/with%20clauses/near/265930038" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> tmandry <a href="https://zulip-archive.rust-lang.org/stream/187312-wg-async/topic/with.20clauses.html#265930038">(Dec 23 2021 at 16:11)</a>:</h4>
<p><span class="user-mention silent" data-user-id="256841">Nick Cameron</span> <a href="#narrow/stream/187312-wg-async-foundations/topic/with.20clauses/near/265929016">said</a>:</p>
<blockquote>
<p>and if you are going to require the <code>capability</code> declaration, it seems like you shouldn't need the type (only the path) in a with clause?</p>
</blockquote>
<p>yes, you could leave off the type and rely on the type or bounds on the declaration</p>



<a name="265930194"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/187312-wg-async/topic/with%20clauses/near/265930194" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Nick Cameron <a href="https://zulip-archive.rust-lang.org/stream/187312-wg-async/topic/with.20clauses.html#265930194">(Dec 23 2021 at 16:13)</a>:</h4>
<blockquote>
<p>fair enough, I'm anticipating it will be more common to use trait bounds rather than types, but we could use : to specify the type and a where clause for trait bounds</p>
</blockquote>
<p>or <code>impl Bound</code>?</p>



<a name="265930262"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/187312-wg-async/topic/with%20clauses/near/265930262" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> tmandry <a href="https://zulip-archive.rust-lang.org/stream/187312-wg-async/topic/with.20clauses.html#265930262">(Dec 23 2021 at 16:14)</a>:</h4>
<p>yeah, I had that originally, but thought</p>
<div class="codehilite"><pre><span></span><code>capability foo: impl Allocator;
</code></pre></div>
<p>on an item looked weird</p>



<a name="265930283"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/187312-wg-async/topic/with%20clauses/near/265930283" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Nick Cameron <a href="https://zulip-archive.rust-lang.org/stream/187312-wg-async/topic/with.20clauses.html#265930283">(Dec 23 2021 at 16:14)</a>:</h4>
<p>It seems to me that there is no point in having with clauses on functions? They can always be replaced by function arguments, it's with clauses on impls which are doing something useful?</p>



<a name="265930349"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/187312-wg-async/topic/with%20clauses/near/265930349" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> tmandry <a href="https://zulip-archive.rust-lang.org/stream/187312-wg-async/topic/with.20clauses.html#265930349">(Dec 23 2021 at 16:15)</a>:</h4>
<p>for functions they could be replaced by arguments, yes</p>



<a name="265930434"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/187312-wg-async/topic/with%20clauses/near/265930434" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Nick Cameron <a href="https://zulip-archive.rust-lang.org/stream/187312-wg-async/topic/with.20clauses.html#265930434">(Dec 23 2021 at 16:16)</a>:</h4>
<p>For the scoped bounds section, could you give an example with non-'static lifetime? I don't really understand what the notation in the example means and 'static is often kinda special</p>



<a name="265930441"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/187312-wg-async/topic/with%20clauses/near/265930441" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> tmandry <a href="https://zulip-archive.rust-lang.org/stream/187312-wg-async/topic/with.20clauses.html#265930441">(Dec 23 2021 at 16:16)</a>:</h4>
<p><span class="user-mention silent" data-user-id="256841">Nick Cameron</span> <a href="#narrow/stream/187312-wg-async-foundations/topic/with.20clauses/near/265929478">said</a>:</p>
<blockquote>
<p>(also, I'm not a fan of the keyword capability - where does it come from? To me a capability means something like a permission (or the combination of a reference + permissions) as in capability-based security or (in PL) read/write capabilities in systems like fractional permissions)</p>
</blockquote>
<p>I think the concepts are related, see the "function coloring" section of <a href="https://jam1.re/blog/thoughts-on-contexts-and-capabilities-in-rust">this blog post</a> to see how. that said, I was thinking maybe it should be called <code>context</code> and am beginning to favor that more</p>



<a name="265930957"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/187312-wg-async/topic/with%20clauses/near/265930957" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Nick Cameron <a href="https://zulip-archive.rust-lang.org/stream/187312-wg-async/topic/with.20clauses.html#265930957">(Dec 23 2021 at 16:22)</a>:</h4>
<blockquote>
<p>it doesn't have to be declared in arena, it could be declared anywhere, but that example is meant to drive the point home that it's a standalone item</p>
</blockquote>
<p>I think the fact that it can be declared anywhere is part of the weirdness of it for me</p>



<a name="265931073"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/187312-wg-async/topic/with%20clauses/near/265931073" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> tmandry <a href="https://zulip-archive.rust-lang.org/stream/187312-wg-async/topic/with.20clauses.html#265931073">(Dec 23 2021 at 16:24)</a>:</h4>
<p><span class="user-mention silent" data-user-id="256841">Nick Cameron</span> <a href="#narrow/stream/187312-wg-async-foundations/topic/with.20clauses/near/265930434">said</a>:</p>
<blockquote>
<p>For the scoped bounds section, could you give an example with non-'static lifetime? I don't really understand what the notation in the example means and 'static is often kinda special</p>
</blockquote>
<p>So if instead of spawning a thread we returned a closure, we would want the closure to only be valid when the <code>where</code> clause is valid. Something like</p>
<div class="codehilite" data-code-language="Rust"><pre><span></span><code><span class="k">fn</span> <span class="nf">make_deserialize_and_print_fn</span><span class="o">&lt;'</span><span class="na">a</span><span class="p">,</span><span class="w"> </span><span class="n">T</span><span class="o">&gt;</span><span class="p">()</span><span class="w"></span>
<span class="k">where</span><span class="w"> </span><span class="n">with</span><span class="p">(</span><span class="o">'</span><span class="na">a</span><span class="p">)</span><span class="w"> </span><span class="n">T</span>: <span class="nc">Deserialize</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">Debug</span><span class="w"></span>
-&gt; <span class="nc">impl</span><span class="w"> </span><span class="nb">Fn</span><span class="p">()</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="o">'</span><span class="na">a</span><span class="w"></span>
<span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="o">||</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">        </span><span class="kd">let</span><span class="w"> </span><span class="n">object</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">T</span>::<span class="n">deserialize</span><span class="p">()</span><span class="o">?</span><span class="p">;</span><span class="w"></span>
<span class="w">        </span><span class="fm">println!</span><span class="p">(</span><span class="s">"Successfully deserialized an object: {:?}"</span><span class="p">,</span><span class="w"> </span><span class="n">object</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="p">}</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>
</code></pre></div>



<a name="265931082"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/187312-wg-async/topic/with%20clauses/near/265931082" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Nick Cameron <a href="https://zulip-archive.rust-lang.org/stream/187312-wg-async/topic/with.20clauses.html#265931082">(Dec 23 2021 at 16:24)</a>:</h4>
<p><span class="user-mention silent" data-user-id="116883">tmandry</span> <a href="#narrow/stream/187312-wg-async-foundations/topic/with.20clauses/near/265930262">said</a>:</p>
<blockquote>
<p>yeah, I had that originally, but thought</p>
<div class="codehilite"><pre><span></span><code>capability foo: impl Allocator;
</code></pre></div>
<p>on an item looked weird</p>
</blockquote>
<p>I want to be able to write <code>impl Bound</code> as a hint to to the compiler in <code>let</code> clauses and type ascription, etc., so in then it might not look so weird with capability/context decls too</p>



<a name="265931151"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/187312-wg-async/topic/with%20clauses/near/265931151" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> tmandry <a href="https://zulip-archive.rust-lang.org/stream/187312-wg-async/topic/with.20clauses.html#265931151">(Dec 23 2021 at 16:25)</a>:</h4>
<p>..originally I was using <code>in</code> instead of <code>with</code> for this specifically, i.e.</p>
<div class="codehilite" data-code-language="Rust"><pre><span></span><code><span class="k">where</span><span class="w"> </span><span class="k">in</span><span class="p">(</span><span class="o">'</span><span class="na">a</span><span class="p">)</span><span class="w"> </span><span class="n">T</span>: <span class="nc">Deserialize</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">Debug</span><span class="w"></span>
</code></pre></div>



<a name="265931247"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/187312-wg-async/topic/with%20clauses/near/265931247" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> tmandry <a href="https://zulip-archive.rust-lang.org/stream/187312-wg-async/topic/with.20clauses.html#265931247">(Dec 23 2021 at 16:26)</a>:</h4>
<p>what's happening here is the closure is actually capturing the context it needs to run</p>



<a name="265931288"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/187312-wg-async/topic/with%20clauses/near/265931288" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> tmandry <a href="https://zulip-archive.rust-lang.org/stream/187312-wg-async/topic/with.20clauses.html#265931288">(Dec 23 2021 at 16:26)</a>:</h4>
<p>the reason I switched to <code>where with()</code> is because I realized that I would need more than just lifetime bounds, e.g. <code>Send</code>, and <code>in</code> doesn't really work for that</p>



<a name="265931639"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/187312-wg-async/topic/with%20clauses/near/265931639" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Nick Cameron <a href="https://zulip-archive.rust-lang.org/stream/187312-wg-async/topic/with.20clauses.html#265931639">(Dec 23 2021 at 16:30)</a>:</h4>
<p>will need to noodle on the scoped bounds a bit later, need to do some parenting soon. Thanks for the example and explanations</p>



<hr><p>Last updated: Apr 12 2022 at 20:01 UTC</p>
</html>