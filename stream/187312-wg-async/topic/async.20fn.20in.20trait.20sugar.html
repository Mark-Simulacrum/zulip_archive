<html>
<head><meta charset="utf-8"><title>async fn in trait sugar · wg-async · Zulip Chat Archive</title></head>
<h2>Stream: <a href="https://zulip-archive.rust-lang.org/stream/187312-wg-async/index.html">wg-async</a></h2>
<h3>Topic: <a href="https://zulip-archive.rust-lang.org/stream/187312-wg-async/topic/async.20fn.20in.20trait.20sugar.html">async fn in trait sugar</a></h3>

<hr>

<base href="https://rust-lang.zulipchat.com">

<head><link href="https://zulip-archive.rust-lang.org/style.css" rel="stylesheet"></head>

<a name="269653174"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/187312-wg-async/topic/async%20fn%20in%20trait%20sugar/near/269653174" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> eholk <a href="https://zulip-archive.rust-lang.org/stream/187312-wg-async/topic/async.20fn.20in.20trait.20sugar.html#269653174">(Jan 27 2022 at 22:56)</a>:</h4>
<p>Quick question about the plans for async fn in traits: Is <code>async fn foo(...) -&gt; T</code> in a trait purely sugar for <code>fn foo(...) -&gt; Future&lt;Output = T&gt;</code>? In other words, can I do the following:</p>
<div class="codehilite" data-code-language="Rust"><pre><span></span><code><span class="k">trait</span><span class="w"> </span><span class="n">Foo</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="k">async</span><span class="w"> </span><span class="k">fn</span> <span class="nf">foo</span><span class="p">(</span><span class="o">&amp;</span><span class="bp">self</span><span class="p">)</span><span class="w"> </span>-&gt; <span class="nc">T</span><span class="p">;</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>
<span class="k">struct</span> <span class="nc">Bar</span><span class="p">;</span><span class="w"></span>
<span class="k">impl</span><span class="w"> </span><span class="n">Foo</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">Bar</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="k">fn</span> <span class="nf">foo</span><span class="p">(</span><span class="o">&amp;</span><span class="bp">self</span><span class="p">)</span><span class="w"> </span>-&gt; <span class="nc">Future</span><span class="o">&lt;</span><span class="n">Output</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">T</span><span class="o">&gt;</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="o">..</span><span class="p">.</span><span class="w"> </span><span class="p">}</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>
</code></pre></div>
<p>and vice-versa?</p>



<a name="269656119"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/187312-wg-async/topic/async%20fn%20in%20trait%20sugar/near/269656119" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Ibraheem Ahmed <a href="https://zulip-archive.rust-lang.org/stream/187312-wg-async/topic/async.20fn.20in.20trait.20sugar.html#269656119">(Jan 27 2022 at 23:21)</a>:</h4>
<p>I think the RFC said to disallow manual desugaring</p>



<a name="269656129"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/187312-wg-async/topic/async%20fn%20in%20trait%20sugar/near/269656129" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Ibraheem Ahmed <a href="https://zulip-archive.rust-lang.org/stream/187312-wg-async/topic/async.20fn.20in.20trait.20sugar.html#269656129">(Jan 27 2022 at 23:21)</a>:</h4>
<p>For now at least</p>



<a name="269796751"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/187312-wg-async/topic/async%20fn%20in%20trait%20sugar/near/269796751" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> tmandry <a href="https://zulip-archive.rust-lang.org/stream/187312-wg-async/topic/async.20fn.20in.20trait.20sugar.html#269796751">(Jan 28 2022 at 20:19)</a>:</h4>
<p>See <a href="https://rust-lang.github.io/rfcs/3185-static-async-fn-in-trait.html#allowing-sugared-and-desugared-forms">this section</a> for more; tldr is that we want to support it but need RPITIT first so we can define the feature in terms of that</p>



<a name="270069644"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/187312-wg-async/topic/async%20fn%20in%20trait%20sugar/near/270069644" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Santiago Pastorino <a href="https://zulip-archive.rust-lang.org/stream/187312-wg-async/topic/async.20fn.20in.20trait.20sugar.html#270069644">(Jan 31 2022 at 17:24)</a>:</h4>
<p>btw, I'm slowly working in all this but there are some things to do, hope to be able to have the correct RPIT refactor soon that will enable RPITIT that then will enable doing async fns in traits :)</p>



<a name="270804745"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/187312-wg-async/topic/async%20fn%20in%20trait%20sugar/near/270804745" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> HTGAzureX1212. <a href="https://zulip-archive.rust-lang.org/stream/187312-wg-async/topic/async.20fn.20in.20trait.20sugar.html#270804745">(Feb 05 2022 at 04:49)</a>:</h4>
<p>Hello everyone, what is the current progress on <code>#![feature(async_fn_in_traits)]</code>? Just asking because I am interested in joining the work towards implementation and stabilization.</p>



<a name="271008702"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/187312-wg-async/topic/async%20fn%20in%20trait%20sugar/near/271008702" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/187312-wg-async/topic/async.20fn.20in.20trait.20sugar.html#271008702">(Feb 07 2022 at 17:00)</a>:</h4>
<p>Hi <span class="user-mention" data-user-id="347254">@HTGAzureX1212.</span> -- currently, <span class="user-mention" data-user-id="124288">@oli</span> has been working on refactoring how we implement impl Trait, and <span class="user-mention" data-user-id="116266">@Santiago Pastorino</span> has been working on refactoring how we implement "impl trait in traits" specifically</p>



<a name="271008719"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/187312-wg-async/topic/async%20fn%20in%20trait%20sugar/near/271008719" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/187312-wg-async/topic/async.20fn.20in.20trait.20sugar.html#271008719">(Feb 07 2022 at 17:00)</a>:</h4>
<p>those two core refactors probably need to land before we do much else</p>



<a name="271080418"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/187312-wg-async/topic/async%20fn%20in%20trait%20sugar/near/271080418" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> HTGAzureX1212. <a href="https://zulip-archive.rust-lang.org/stream/187312-wg-async/topic/async.20fn.20in.20trait.20sugar.html#271080418">(Feb 08 2022 at 04:38)</a>:</h4>
<p><span class="user-mention" data-user-id="116009">@nikomatsakis</span> Thank you for your thorough introduction over the work that has been going on! I will look through these, thanks.</p>



<hr><p>Last updated: Apr 12 2022 at 20:01 UTC</p>
</html>