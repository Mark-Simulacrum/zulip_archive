<html>
<head><meta charset="utf-8"><title>executor vs scheduler · wg-async · Zulip Chat Archive</title></head>
<h2>Stream: <a href="https://zulip-archive.rust-lang.org/stream/187312-wg-async/index.html">wg-async</a></h2>
<h3>Topic: <a href="https://zulip-archive.rust-lang.org/stream/187312-wg-async/topic/executor.20vs.20scheduler.html">executor vs scheduler</a></h3>

<hr>

<base href="https://rust-lang.zulipchat.com">

<head><link href="https://zulip-archive.rust-lang.org/style.css" rel="stylesheet"></head>

<a name="261158896"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/187312-wg-async/topic/executor%20vs%20scheduler/near/261158896" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Nick Cameron <a href="https://zulip-archive.rust-lang.org/stream/187312-wg-async/topic/executor.20vs.20scheduler.html#261158896">(Nov 11 2021 at 17:00)</a>:</h4>
<p>There seems to be some ambiguity about these terms. Sometimes they are used interchangeably, or even explicitly conflated as in the Tokio tutorial glossary, but sometimes they are used to mean subtly different things.</p>



<a name="261159003"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/187312-wg-async/topic/executor%20vs%20scheduler/near/261159003" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Nick Cameron <a href="https://zulip-archive.rust-lang.org/stream/187312-wg-async/topic/executor.20vs.20scheduler.html#261159003">(Nov 11 2021 at 17:01)</a>:</h4>
<p>Does anyone have a precise definition of the two concepts and/or an opinion that they mean the same things or different things?</p>



<a name="261159166"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/187312-wg-async/topic/executor%20vs%20scheduler/near/261159166" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Nick Cameron <a href="https://zulip-archive.rust-lang.org/stream/187312-wg-async/topic/executor.20vs.20scheduler.html#261159166">(Nov 11 2021 at 17:02)</a>:</h4>
<p>And in the specific case of the futures crate, it has been described as having an executor but not a scheduler (I can't find the quote now though, I hope I didn't imagine it). Is that correct? What does it mean exactly?</p>



<a name="261159224"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/187312-wg-async/topic/executor%20vs%20scheduler/near/261159224" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Nick Cameron <a href="https://zulip-archive.rust-lang.org/stream/187312-wg-async/topic/executor.20vs.20scheduler.html#261159224">(Nov 11 2021 at 17:03)</a>:</h4>
<p>Would folk consider the futures crate as a runtime in the same way as Tokio, or is it missing something?</p>



<a name="261172204"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/187312-wg-async/topic/executor%20vs%20scheduler/near/261172204" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> tmandry <a href="https://zulip-archive.rust-lang.org/stream/187312-wg-async/topic/executor.20vs.20scheduler.html#261172204">(Nov 11 2021 at 18:59)</a>:</h4>
<p>I generally consider these to be the same thing, and draw a distinction between the reactor (OS integration, leaf futures) and the executor (polls futures)</p>



<a name="261172262"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/187312-wg-async/topic/executor%20vs%20scheduler/near/261172262" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> tmandry <a href="https://zulip-archive.rust-lang.org/stream/187312-wg-async/topic/executor.20vs.20scheduler.html#261172262">(Nov 11 2021 at 18:59)</a>:</h4>
<p>if there were enough logic to call something a scheduler, I would consider it a component of the executor</p>



<a name="261173293"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/187312-wg-async/topic/executor%20vs%20scheduler/near/261173293" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Esteban Küber <a href="https://zulip-archive.rust-lang.org/stream/187312-wg-async/topic/executor.20vs.20scheduler.html#261173293">(Nov 11 2021 at 19:09)</a>:</h4>
<p>Can an generalized abstraction layer exist between the reactor and the executor? That's an <code>alloc</code>-style config knob that I hadn't thought of.</p>



<a name="261176107"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/187312-wg-async/topic/executor%20vs%20scheduler/near/261176107" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Nick Cameron <a href="https://zulip-archive.rust-lang.org/stream/187312-wg-async/topic/executor.20vs.20scheduler.html#261176107">(Nov 11 2021 at 19:35)</a>:</h4>
<p>Huh, I have always assumed reactor and executor were synonymous</p>



<a name="261176228"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/187312-wg-async/topic/executor%20vs%20scheduler/near/261176228" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Nick Cameron <a href="https://zulip-archive.rust-lang.org/stream/187312-wg-async/topic/executor.20vs.20scheduler.html#261176228">(Nov 11 2021 at 19:37)</a>:</h4>
<p><span class="user-mention" data-user-id="116883">@tmandry</span> so, how would you describe the futures crate’s executor and would you distinguish that from Tokio or async std in a categorical way?</p>



<a name="261181914"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/187312-wg-async/topic/executor%20vs%20scheduler/near/261181914" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Alice Ryhl <a href="https://zulip-archive.rust-lang.org/stream/187312-wg-async/topic/executor.20vs.20scheduler.html#261181914">(Nov 11 2021 at 20:36)</a>:</h4>
<p>I generally use them interchangeably</p>



<a name="261185737"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/187312-wg-async/topic/executor%20vs%20scheduler/near/261185737" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Kestrer <a href="https://zulip-archive.rust-lang.org/stream/187312-wg-async/topic/executor.20vs.20scheduler.html#261185737">(Nov 11 2021 at 21:20)</a>:</h4>
<p>I would consider the executor and scheduler to be the same, but reactor to be different.<br>
Executor: Runs futures in the background<br>
Reactor: Dispatches events from one source (e.g. epoll) to many leaf futures<br>
A nice conceptual model is that the reactor exists as just another future running on the executor. When epoll wakes, that future will be scheduled to run and once it does it will wake up any other futures that need to be woken. Additionally, the executor itself can just be another future running atop <code>block_on</code>, <code>async-executor</code>-style. By this definition, <code>hyper::client::conn::Connection</code> (<a href="https://docs.rs/hyper/0.14/hyper/client/conn/struct.Connection.html">https://docs.rs/hyper/0.14/hyper/client/conn/struct.Connection.html</a>) is also a reactor and I think that's a good thing.</p>



<a name="262454168"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/187312-wg-async/topic/executor%20vs%20scheduler/near/262454168" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Yoshua Wuyts [he/they] <a href="https://zulip-archive.rust-lang.org/stream/187312-wg-async/topic/executor.20vs.20scheduler.html#262454168">(Nov 23 2021 at 13:22)</a>:</h4>
<p>Components in the <code>smol-rs</code> ecosystem highlight this distinction:</p>
<ul>
<li><a href="https://docs.rs/async-io/1.6.0/async_io/"><code>async-io</code></a> is an example of a reactor</li>
<li><a href="https://docs.rs/async-task/4.0.3/async_task/"><code>async-task</code></a> is an example of an executor/scheduler</li>
</ul>
<p>Runtimes aimed at end-users can re-package these components to create something more usable off the shelf (ex: <code>async-std</code>, <code>smol</code>). But at the component level distinguishing between reactor and executor is useful, in particular as it allows for experimenting with one part of the runtime, while not touching the other. For example <a href="https://docs.rs/ringbahn/0.0.0-experimental.3/ringbahn/"><code>ringbahn</code></a> exposes an API similar to <code>async-io</code>, but was designed exclusively for  Linux' <code>io_uring</code>.</p>



<a name="262456999"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/187312-wg-async/topic/executor%20vs%20scheduler/near/262456999" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Yoshua Wuyts [he/they] <a href="https://zulip-archive.rust-lang.org/stream/187312-wg-async/topic/executor.20vs.20scheduler.html#262456999">(Nov 23 2021 at 13:44)</a>:</h4>
<p>That said though, in my experience most users of async Rust do not care / will not want to have to care about the distinction between reactor and executor. A runtime is often just a mandatory step to make HTTP and pals work, with questions like: "What components does the runtime consist of" being too much detail.</p>
<p>But if we're coming at this from a perspective of: "What interfaces should Rust expose to support first-class async abstractions", then I think we will likely want to be cognisant of this distinction.</p>



<a name="262492099"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/187312-wg-async/topic/executor%20vs%20scheduler/near/262492099" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Taylor Cramer <a href="https://zulip-archive.rust-lang.org/stream/187312-wg-async/topic/executor.20vs.20scheduler.html#262492099">(Nov 23 2021 at 18:03)</a>:</h4>
<p>FWIW I also use "executor" to mean "the thing that polls futures", while "reactor" is "the thing that drives futures / wakes them up in response to OS events." In some systems it's advantageous for performance reasons to have these be the same thing.</p>



<a name="263787340"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/187312-wg-async/topic/executor%20vs%20scheduler/near/263787340" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Dan Johnson <a href="https://zulip-archive.rust-lang.org/stream/187312-wg-async/topic/executor.20vs.20scheduler.html#263787340">(Dec 05 2021 at 20:29)</a>:</h4>
<p><span class="user-mention silent" data-user-id="256841">Nick Cameron</span> <a href="#narrow/stream/187312-wg-async-foundations/topic/executor.20vs.20scheduler/near/261159166">said</a>:</p>
<blockquote>
<p>And in the specific case of the futures crate, it has been described as having an executor but not a scheduler (I can't find the quote now though, I hope I didn't imagine it). Is that correct? What does it mean exactly?</p>
</blockquote>
<p>I think this is true for <code>futures::executor::block_on</code> (that is, it's an executor but not a scheduler), because it only executes one task, so it doesn't have to do any "scheduling" (picking which task to poll next). However, <code>futures::executor::LocalPool</code> and <code>futures::executor::ThreadPool</code>are executors which do have to schedule multiple tasks and therefore are also schedulers. So I think it's not correct to say "the futures crate has an executor but not a scheduler".</p>
<p>At least, if you subscribe my definitions of executor and scheduler.</p>



<a name="264686458"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/187312-wg-async/topic/executor%20vs%20scheduler/near/264686458" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jonathan de Jong <a href="https://zulip-archive.rust-lang.org/stream/187312-wg-async/topic/executor.20vs.20scheduler.html#264686458">(Dec 13 2021 at 10:27)</a>:</h4>
<p>I want to share a reddit comment that lead me here; <a href="https://www.reddit.com/r/rust/comments/rb8fgt/portable_and_interoperable_async_rust/hnvb7sp/?context=1">https://www.reddit.com/r/rust/comments/rb8fgt/portable_and_interoperable_async_rust/hnvb7sp/?context=1</a></p>
<p>To me, the "executor" is more like a scheduler of tasks, while a "reactor" is a resource that registers and watches IO events, these two can work in tandem, but i think it'd help if they were seperated</p>
<p>like i said on twitter: i think it would be interesting if libraries can "choose their own reactor", at which the executor would then have to manage tasks and reactors together. if this can be done transiently, you start to have the real "mix and match" feel that y'all are trying to achieve here</p>



<a name="264686842"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/187312-wg-async/topic/executor%20vs%20scheduler/near/264686842" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jonathan de Jong <a href="https://zulip-archive.rust-lang.org/stream/187312-wg-async/topic/executor.20vs.20scheduler.html#264686842">(Dec 13 2021 at 10:31)</a>:</h4>
<p>Furthermore, it would be interesting to explore if there can be a "std reactor" that libraries can default to then, so that executors arent handling 10-odd exotic reactors at a same time, but that 99% of the libraries (could) use std for all of their purposes, but one uses that one io_uring-based reactor library to achieve extra speed</p>



<a name="264688098"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/187312-wg-async/topic/executor%20vs%20scheduler/near/264688098" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jonathan de Jong <a href="https://zulip-archive.rust-lang.org/stream/187312-wg-async/topic/executor.20vs.20scheduler.html#264688098">(Dec 13 2021 at 10:43)</a>:</h4>
<p>Possibly, reactors could themselves depend on timer-based reactors, to continually check a resource and then "poke" the executor, so then reactors could be async-task based.</p>
<p>Or, reactors would need a full thread to themselves to do their work, and then the executor would allocate them that thread.</p>
<p>There could also be opportunities for "enhanced integrations", i.e. if tokio would like to capture all the IO the std_reactor would do, and instead re-route it to its <code>mio</code>-based own reactor.</p>
<p>There's a lot of food for thought here, but i personally think this could be a healthy separation, and it would allow reactor-based (io_uring, etc.) development and executor (low-overhead, industry, resillient, generic, etc.) development to happen concurrently without getting in eachother's way</p>



<a name="264722741"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/187312-wg-async/topic/executor%20vs%20scheduler/near/264722741" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Vadim Petrochenkov <a href="https://zulip-archive.rust-lang.org/stream/187312-wg-async/topic/executor.20vs.20scheduler.html#264722741">(Dec 13 2021 at 15:30)</a>:</h4>
<p>I don't know what exactly is discussed here, but the thread name suggests these two papers from C++ standardization may be relevant:</p>
<ul>
<li>"Disentangling schedulers and executors" - <a href="http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2020/p2235r0.html">http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2020/p2235r0.html</a></li>
<li>"Scheduler vs Executor" - <a href="http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2020/p2250r0.pdf">http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2020/p2250r0.pdf</a></li>
</ul>
<p>Context: development of concepts (traits) for the C++ executor library.<br>
Not sure how that story ended, I didn't have time to read the C++ committee mailings from 2021.</p>



<hr><p>Last updated: Apr 12 2022 at 20:01 UTC</p>
</html>