<html>
<head><meta charset="utf-8"><title>crater run · edition 2021 · Zulip Chat Archive</title></head>
<h2>Stream: <a href="https://zulip-archive.rust-lang.org/stream/268952-edition-2021/index.html">edition 2021</a></h2>
<h3>Topic: <a href="https://zulip-archive.rust-lang.org/stream/268952-edition-2021/topic/crater.20run.html">crater run</a></h3>

<hr>

<base href="https://rust-lang.zulipchat.com">

<head><link href="https://zulip-archive.rust-lang.org/style.css" rel="stylesheet"></head>

<a name="246084831"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/268952-edition%202021/topic/crater%20run/near/246084831" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Eric Huss <a href="https://zulip-archive.rust-lang.org/stream/268952-edition-2021/topic/crater.20run.html#246084831">(Jul 15 2021 at 12:11)</a>:</h4>
<p>I'm uncertain, my understanding is that crater is only designed to compare two toolchains.  It seems like for testing the edition, it needs to run different commands against "start" vs " end".   I'm not sure if crater has the ability to do that.  Just running <code>cargo fix</code> with two different toolchains isn't going to provide any information.  Does crater have the ability to do that?</p>



<a name="246085525"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/268952-edition%202021/topic/crater%20run/near/246085525" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Eric Huss <a href="https://zulip-archive.rust-lang.org/stream/268952-edition-2021/topic/crater.20run.html#246085525">(Jul 15 2021 at 12:19)</a>:</h4>
<p>In the past, to do this, what I have done is create a custom Cargo that runs the commands I want.  That is, one could run crater in "check" mode, and have a custom cargo that when it runs <code>cargo check</code>, it actually runs something else (like <code>cargo fix --edition</code>, modify edition, <code>cargo check</code>).  That way, the "start" runs a normal check (to get a baseline), and then the "end" can do all the magic.</p>



<a name="246103398"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/268952-edition%202021/topic/crater%20run/near/246103398" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/268952-edition-2021/topic/crater.20run.html#246103398">(Jul 15 2021 at 14:37)</a>:</h4>
<p><span class="user-mention" data-user-id="120518">@Eric Huss</span> that makes a lot of sense</p>



<a name="246103591"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/268952-edition%202021/topic/crater%20run/near/246103591" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/268952-edition-2021/topic/crater.20run.html#246103591">(Jul 15 2021 at 14:38)</a>:</h4>
<p>Is cargo built from rust-lang/rust?</p>



<a name="246103601"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/268952-edition%202021/topic/crater%20run/near/246103601" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/268952-edition-2021/topic/crater.20run.html#246103601">(Jul 15 2021 at 14:38)</a>:</h4>
<p>(when we do a crater run)</p>



<a name="246103614"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/268952-edition%202021/topic/crater%20run/near/246103614" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/268952-edition-2021/topic/crater.20run.html#246103614">(Jul 15 2021 at 14:38)</a>:</h4>
<p>i.e., can you make a single PR that encapsulates the change to cargo?</p>



<a name="246103626"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/268952-edition%202021/topic/crater%20run/near/246103626" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/268952-edition-2021/topic/crater.20run.html#246103626">(Jul 15 2021 at 14:38)</a>:</h4>
<p>(cc <span class="user-mention" data-user-id="121055">@Pietro Albini</span>)</p>



<a name="246103674"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/268952-edition%202021/topic/crater%20run/near/246103674" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Eric Huss <a href="https://zulip-archive.rust-lang.org/stream/268952-edition-2021/topic/crater.20run.html#246103674">(Jul 15 2021 at 14:39)</a>:</h4>
<p>Yes.</p>



<a name="246103723"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/268952-edition%202021/topic/crater%20run/near/246103723" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Eric Huss <a href="https://zulip-archive.rust-lang.org/stream/268952-edition-2021/topic/crater.20run.html#246103723">(Jul 15 2021 at 14:39)</a>:</h4>
<p>I can probably put something together.  It shouldn't be too hard.</p>



<a name="246103733"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/268952-edition%202021/topic/crater%20run/near/246103733" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Eric Huss <a href="https://zulip-archive.rust-lang.org/stream/268952-edition-2021/topic/crater.20run.html#246103733">(Jul 15 2021 at 14:39)</a>:</h4>
<p>Much easier than changing crater.</p>



<a name="246103768"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/268952-edition%202021/topic/crater%20run/near/246103768" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/268952-edition-2021/topic/crater.20run.html#246103768">(Jul 15 2021 at 14:39)</a>:</h4>
<p>Yes, we should do that</p>



<a name="246103784"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/268952-edition%202021/topic/crater%20run/near/246103784" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/268952-edition-2021/topic/crater.20run.html#246103784">(Jul 15 2021 at 14:39)</a>:</h4>
<p>It seems like the <em>ideal</em> would be to land a patch in cargo</p>



<a name="246103861"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/268952-edition%202021/topic/crater%20run/near/246103861" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/268952-edition-2021/topic/crater.20run.html#246103861">(Jul 15 2021 at 14:40)</a>:</h4>
<p>such that this experiment is easy to repeat in the future</p>



<a name="246103889"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/268952-edition%202021/topic/crater%20run/near/246103889" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/268952-edition-2021/topic/crater.20run.html#246103889">(Jul 15 2021 at 14:40)</a>:</h4>
<p>but maybe we get it working first, and then try to do that?</p>



<a name="246103979"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/268952-edition%202021/topic/crater%20run/near/246103979" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/268952-edition-2021/topic/crater.20run.html#246103979">(Jul 15 2021 at 14:41)</a>:</h4>
<p>(I'm imagining e.g. landing most of the patch, such that it's a 1-line diff to re-enable later or something...)</p>



<a name="246105763"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/268952-edition%202021/topic/crater%20run/near/246105763" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Pietro Albini <a href="https://zulip-archive.rust-lang.org/stream/268952-edition-2021/topic/crater.20run.html#246105763">(Jul 15 2021 at 14:54)</a>:</h4>
<p><span class="user-mention silent" data-user-id="116009">nikomatsakis</span> <a href="#narrow/stream/268952-edition-2021/topic/crater.20run/near/246103591">said</a>:</p>
<blockquote>
<p>Is cargo built from rust-lang/rust?</p>
</blockquote>
<p>it should, if it doesn't it's really easy to fix that</p>



<a name="246221853"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/268952-edition%202021/topic/crater%20run/near/246221853" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Eric Huss <a href="https://zulip-archive.rust-lang.org/stream/268952-edition-2021/topic/crater.20run.html#246221853">(Jul 16 2021 at 13:24)</a>:</h4>
<p>I have a custom cargo ready to go.  When do we want to do the crater run?</p>



<a name="246222254"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/268952-edition%202021/topic/crater%20run/near/246222254" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> rylev <a href="https://zulip-archive.rust-lang.org/stream/268952-edition-2021/topic/crater.20run.html#246222254">(Jul 16 2021 at 13:27)</a>:</h4>
<p>I was hoping we could land a fix for <a href="https://github.com/rust-lang/rust/issues/86940">https://github.com/rust-lang/rust/issues/86940</a>. It's been claimed, but we're unsure when it will be fixed.</p>



<a name="246248179"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/268952-edition%202021/topic/crater%20run/near/246248179" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/268952-edition-2021/topic/crater.20run.html#246248179">(Jul 16 2021 at 16:44)</a>:</h4>
<p>That's awesome</p>



<a name="246268786"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/268952-edition%202021/topic/crater%20run/near/246268786" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Eric Huss <a href="https://zulip-archive.rust-lang.org/stream/268952-edition-2021/topic/crater.20run.html#246268786">(Jul 16 2021 at 19:36)</a>:</h4>
<p>Hm, looks like there will be an issue with crater. It mounts the filesystem as read-only, but <code>cargo fix</code> needs to be able to modify the sources.  <span class="user-mention" data-user-id="121055">@Pietro Albini</span> Is there a feasible workaround?  Would it be horrible to have my custom script copy the workdir to <code>/tmp</code> or something like that?</p>



<a name="246269665"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/268952-edition%202021/topic/crater%20run/near/246269665" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Pietro Albini <a href="https://zulip-archive.rust-lang.org/stream/268952-edition-2021/topic/crater.20run.html#246269665">(Jul 16 2021 at 19:44)</a>:</h4>
<p>ugh changing that could be tricky</p>



<a name="246269728"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/268952-edition%202021/topic/crater%20run/near/246269728" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Pietro Albini <a href="https://zulip-archive.rust-lang.org/stream/268952-edition-2021/topic/crater.20run.html#246269728">(Jul 16 2021 at 19:45)</a>:</h4>
<p>and double ugh you need to run <code>cargo fix</code> inside the sandbox don't you</p>



<a name="246269802"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/268952-edition%202021/topic/crater%20run/near/246269802" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Eric Huss <a href="https://zulip-archive.rust-lang.org/stream/268952-edition-2021/topic/crater.20run.html#246269802">(Jul 16 2021 at 19:46)</a>:</h4>
<p>Yea.</p>



<a name="246269922"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/268952-edition%202021/topic/crater%20run/near/246269922" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Eric Huss <a href="https://zulip-archive.rust-lang.org/stream/268952-edition-2021/topic/crater.20run.html#246269922">(Jul 16 2021 at 19:47)</a>:</h4>
<p>Hey, maybe you can answer a quick question re crater.  Every time I run it, it downloads stable and rebuilds rustup-toolchain-install-master, which for me takes a few minutes.  Is there a way to avoid that?</p>



<a name="246270059"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/268952-edition%202021/topic/crater%20run/near/246270059" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Pietro Albini <a href="https://zulip-archive.rust-lang.org/stream/268952-edition-2021/topic/crater.20run.html#246270059">(Jul 16 2021 at 19:48)</a>:</h4>
<p>it... shouldn't?</p>



<a name="246270073"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/268952-edition%202021/topic/crater%20run/near/246270073" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Pietro Albini <a href="https://zulip-archive.rust-lang.org/stream/268952-edition-2021/topic/crater.20run.html#246270073">(Jul 16 2021 at 19:48)</a>:</h4>
<p>are you deleting the workspace?</p>



<a name="246270126"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/268952-edition%202021/topic/crater%20run/near/246270126" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Eric Huss <a href="https://zulip-archive.rust-lang.org/stream/268952-edition-2021/topic/crater.20run.html#246270126">(Jul 16 2021 at 19:49)</a>:</h4>
<p>I run <code>delete-all-results</code> and then <code>run-graph</code>, and it downloads again.</p>



<a name="246270149"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/268952-edition%202021/topic/crater%20run/near/246270149" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Eric Huss <a href="https://zulip-archive.rust-lang.org/stream/268952-edition-2021/topic/crater.20run.html#246270149">(Jul 16 2021 at 19:49)</a>:</h4>
<p>No worries, I can try to investigate a little.  I'm still struggling just to understand how things work. <span aria-label="grinning" class="emoji emoji-1f600" role="img" title="grinning">:grinning:</span></p>



<a name="246270776"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/268952-edition%202021/topic/crater%20run/near/246270776" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Pietro Albini <a href="https://zulip-archive.rust-lang.org/stream/268952-edition-2021/topic/crater.20run.html#246270776">(Jul 16 2021 at 19:55)</a>:</h4>
<p>it... shouldn't do that?</p>



<a name="246270795"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/268952-edition%202021/topic/crater%20run/near/246270795" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Pietro Albini <a href="https://zulip-archive.rust-lang.org/stream/268952-edition-2021/topic/crater.20run.html#246270795">(Jul 16 2021 at 19:55)</a>:</h4>
<p>can you paste the full logs somewhere?</p>



<a name="246281511"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/268952-edition%202021/topic/crater%20run/near/246281511" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Eric Huss <a href="https://zulip-archive.rust-lang.org/stream/268952-edition-2021/topic/crater.20run.html#246281511">(Jul 16 2021 at 21:18)</a>:</h4>
<p>OK, I got my hacked <code>cargo fix</code> working with crater, so it should be ready to go whenever we're ready.  I tested with a demo crate containing <a href="https://github.com/rust-lang/rust/issues/86940">#86940</a> and it properly reported a regression.</p>
<p>Here is what the hack looks like: <a href="https://github.com/ehuss/cargo/commit/e32d9d54c8dfbe0c890cb88c327e22d05399313c">https://github.com/ehuss/cargo/commit/e32d9d54c8dfbe0c890cb88c327e22d05399313c</a></p>
<p>I also did a short run against a few real crates, and things seemed to work as expected. It did find one regression. <code>non-fmt-panics</code> is a <code>MaybeIncorrect</code> suggestion, so it fails to migrate (found while migrating <code>structopt</code>). Is that a known issue? I can't find any related to that.</p>



<a name="246283708"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/268952-edition%202021/topic/crater%20run/near/246283708" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Eric Huss <a href="https://zulip-archive.rust-lang.org/stream/268952-edition-2021/topic/crater.20run.html#246283708">(Jul 16 2021 at 21:39)</a>:</h4>
<p>Oh, another question. My hack ignores 2015 packages. That can make the report look a little odd (if a 2015 fails during the first round, it will succeed in the second, appearing to be "fixed"). I'm thinking we can just ignore those in the report, does that sound reasonable?</p>



<a name="246308037"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/268952-edition%202021/topic/crater%20run/near/246308037" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/268952-edition-2021/topic/crater.20run.html#246308037">(Jul 17 2021 at 06:18)</a>:</h4>
<p><span class="user-mention" data-user-id="120518">@Eric Huss</span> that sounds great! I agree we can ignore those.</p>



<a name="246449097"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/268952-edition%202021/topic/crater%20run/near/246449097" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mara <a href="https://zulip-archive.rust-lang.org/stream/268952-edition-2021/topic/crater.20run.html#246449097">(Jul 19 2021 at 12:40)</a>:</h4>
<p><span class="user-mention silent" data-user-id="120518">Eric Huss</span> <a href="#narrow/stream/268952-edition-2021/topic/crater.20run/near/246281511">said</a>:</p>
<blockquote>
<p>I also did a short run against a few real crates, and things seemed to work as expected. It did find one regression. <code>non-fmt-panics</code> is a <code>MaybeIncorrect</code> suggestion, so it fails to migrate (found while migrating <code>structopt</code>). Is that a known issue? I can't find any related to that.</p>
</blockquote>
<p>It should produce both a MaybeIncorrect and a MachineApplicable suggestion as alternatives. <code>cargo fix --edition</code> should just pick the latter. Did that not happen?</p>



<a name="246449676"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/268952-edition%202021/topic/crater%20run/near/246449676" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mara <a href="https://zulip-archive.rust-lang.org/stream/268952-edition-2021/topic/crater.20run.html#246449676">(Jul 19 2021 at 12:46)</a>:</h4>
<p>ah, it happened in the panic!() insider assert!(). yeah. that one doesn't have a MachineApplicable suggestion. the only always correct suggestion would be <code>if !... { std::panic::panic_any(...); }</code> which isn't great. :/</p>



<a name="246450855"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/268952-edition%202021/topic/crater%20run/near/246450855" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/268952-edition-2021/topic/crater.20run.html#246450855">(Jul 19 2021 at 12:58)</a>:</h4>
<p><span class="user-mention silent" data-user-id="120518">Eric Huss</span> <a href="#narrow/stream/268952-edition-2021/topic/crater.20run/near/246283708">said</a>:</p>
<blockquote>
<p>Oh, another question. My hack ignores 2015 packages. That can make the report look a little odd (if a 2015 fails during the first round, it will succeed in the second, appearing to be "fixed"). I'm thinking we can just ignore those in the report, does that sound reasonable?</p>
</blockquote>
<p>I did have a question about this, why do 2015 crates fail in the first round-- oh, because we ignore them <em>entirely</em>? Can we just fallback to the "normal" behavior for 2015 crates instead, so that they show up as having the same result?</p>



<a name="246464571"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/268952-edition%202021/topic/crater%20run/near/246464571" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Eric Huss <a href="https://zulip-archive.rust-lang.org/stream/268952-edition-2021/topic/crater.20run.html#246464571">(Jul 19 2021 at 14:49)</a>:</h4>
<p>Short answer: I didn't want to waste the cycles running <code>cargo check</code> just to align the results.</p>
<p>The issue is if a 2015 crate fails <code>cargo check</code> with the first toolchain (for unrelated reasons), the second toolchain doesn't know that.  It could run <code>cargo check</code> again, just so the results line up, but I figured that would be a waste of cycles, so it just exits immediately with "success".   There should be a relatively small set of packages that are 2015, and fail to compile <em>at all</em>.  Also, I seem to recall that crater eventually removes packages that never build, is that true?</p>
<p>It could also migrate from 2015 &gt; 2021, but I figure the 2018 migration bugs would just cause too much noise.</p>



<a name="246465143"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/268952-edition%202021/topic/crater%20run/near/246465143" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Eric Huss <a href="https://zulip-archive.rust-lang.org/stream/268952-edition-2021/topic/crater.20run.html#246465143">(Jul 19 2021 at 14:53)</a>:</h4>
<p><span class="user-mention silent" data-user-id="310399">Mara</span> <a href="#narrow/stream/268952-edition-2021/topic/crater.20run/near/246449676">said</a>:</p>
<blockquote>
<p>ah, it happened in the panic!() insider assert!(). yeah. that one doesn't have a MachineApplicable suggestion. the only always correct suggestion would be <code>if !... { std::panic::panic_any(...); }</code> which isn't great. <span aria-label="confused" class="emoji emoji-1f615" role="img" title="confused">:confused:</span></p>
</blockquote>
<p>Should I file an issue for this?</p>



<a name="246616114"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/268952-edition%202021/topic/crater%20run/near/246616114" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Eric Huss <a href="https://zulip-archive.rust-lang.org/stream/268952-edition-2021/topic/crater.20run.html#246616114">(Jul 20 2021 at 16:33)</a>:</h4>
<p>I went ahead and filed <a href="https://github.com/rust-lang/rust/issues/87313">https://github.com/rust-lang/rust/issues/87313</a> to track the <code>assert!</code> problem.  I don't know if there are any practical options here.  Since <code>non_fmt_panics</code> has been warning for a while, I would assume most projects will have already cleaned it up, so perhaps automatic migration is not very important.</p>



<a name="247207403"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/268952-edition%202021/topic/crater%20run/near/247207403" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Eric Huss <a href="https://zulip-archive.rust-lang.org/stream/268952-edition-2021/topic/crater.20run.html#247207403">(Jul 26 2021 at 14:13)</a>:</h4>
<p>Do ya'll have any thoughts on when you want to start the crater run?</p>



<a name="247214888"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/268952-edition%202021/topic/crater%20run/near/247214888" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/268952-edition-2021/topic/crater.20run.html#247214888">(Jul 26 2021 at 15:03)</a>:</h4>
<p>Good question. My thought is that it makes sense to let the public testing period run for a week or so?</p>



<a name="247214902"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/268952-edition%202021/topic/crater%20run/near/247214902" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/268952-edition-2021/topic/crater.20run.html#247214902">(Jul 26 2021 at 15:03)</a>:</h4>
<p>I'd like to at minimum patch up the known bugs</p>



<a name="247930808"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/268952-edition%202021/topic/crater%20run/near/247930808" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> rylev <a href="https://zulip-archive.rust-lang.org/stream/268952-edition-2021/topic/crater.20run.html#247930808">(Aug 02 2021 at 15:09)</a>:</h4>
<p><span class="user-mention" data-user-id="120518">@Eric Huss</span> We've reached the week or so threshold and <span class="user-mention" data-user-id="310399">@Mara</span> and I looked at the bugs and none seemed to be crater blocking. How do we kick off the crater run?</p>



<a name="247930901"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/268952-edition%202021/topic/crater%20run/near/247930901" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Eric Huss <a href="https://zulip-archive.rust-lang.org/stream/268952-edition-2021/topic/crater.20run.html#247930901">(Aug 02 2021 at 15:10)</a>:</h4>
<p>I'll rebuild my PR.  I don't have permission to run crater.  I'll either get myself added, or find someone who does.</p>



<a name="247930934"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/268952-edition%202021/topic/crater%20run/near/247930934" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Eric Huss <a href="https://zulip-archive.rust-lang.org/stream/268952-edition-2021/topic/crater.20run.html#247930934">(Aug 02 2021 at 15:10)</a>:</h4>
<p>I want to run a small test (like top 1000) just to make sure it is working correctly.</p>



<a name="247930937"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/268952-edition%202021/topic/crater%20run/near/247930937" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mara <a href="https://zulip-archive.rust-lang.org/stream/268952-edition-2021/topic/crater.20run.html#247930937">(Aug 02 2021 at 15:10)</a>:</h4>
<p>i have. just link me the PR</p>



<a name="247930946"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/268952-edition%202021/topic/crater%20run/near/247930946" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Eric Huss <a href="https://zulip-archive.rust-lang.org/stream/268952-edition-2021/topic/crater.20run.html#247930946">(Aug 02 2021 at 15:10)</a>:</h4>
<p><span aria-label="+1" class="emoji emoji-1f44d" role="img" title="+1">:+1:</span></p>



<a name="247955217"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/268952-edition%202021/topic/crater%20run/near/247955217" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Eric Huss <a href="https://zulip-archive.rust-lang.org/stream/268952-edition-2021/topic/crater.20run.html#247955217">(Aug 02 2021 at 18:50)</a>:</h4>
<p><span class="user-mention" data-user-id="310399">@Mara</span>, the PR is <a href="https://github.com/rust-lang/rust/pull/87190">https://github.com/rust-lang/rust/pull/87190</a>.  I think the command I want is <code>@craterbot check crates=top-1000</code></p>



<a name="247955236"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/268952-edition%202021/topic/crater%20run/near/247955236" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mara <a href="https://zulip-archive.rust-lang.org/stream/268952-edition-2021/topic/crater.20run.html#247955236">(Aug 02 2021 at 18:50)</a>:</h4>
<p>just <code>check</code>?</p>



<a name="247955301"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/268952-edition%202021/topic/crater%20run/near/247955301" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Eric Huss <a href="https://zulip-archive.rust-lang.org/stream/268952-edition-2021/topic/crater.20run.html#247955301">(Aug 02 2021 at 18:51)</a>:</h4>
<p>Yea, it has an custom <code>cargo</code> that will run <code>cargo fix</code>, and then <code>cargo check</code> afterwards.  I don't think doing a full test is necessary, do you?</p>



<a name="247955580"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/268952-edition%202021/topic/crater%20run/near/247955580" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mara <a href="https://zulip-archive.rust-lang.org/stream/268952-edition-2021/topic/crater.20run.html#247955580">(Aug 02 2021 at 18:53)</a>:</h4>
<p>yeah good question. i don't think we'd cause many run-time changes. but maybe the closure capture thing or panics might cause some run-time behaviour to change? but we'd have to be lucky for it to actually be tested by some crate.</p>



<a name="247955948"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/268952-edition%202021/topic/crater%20run/near/247955948" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Eric Huss <a href="https://zulip-archive.rust-lang.org/stream/268952-edition-2021/topic/crater.20run.html#247955948">(Aug 02 2021 at 18:57)</a>:</h4>
<p>Yea, that's definitely possible.  My understanding is that a <code>test</code> run takes quite a lot longer than a <code>check</code> run, is that correct?  I think it would be valuable to do some quick check runs first to see how things go, and then we can consider doing a <code>test</code> run later if desired.</p>



<a name="247956034"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/268952-edition%202021/topic/crater%20run/near/247956034" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mara <a href="https://zulip-archive.rust-lang.org/stream/268952-edition-2021/topic/crater.20run.html#247956034">(Aug 02 2021 at 18:57)</a>:</h4>
<p>yeah, let's go for check for the top-1000 and then think a bit more meanwhile about if we want a test run</p>



<a name="247956106"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/268952-edition%202021/topic/crater%20run/near/247956106" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mara <a href="https://zulip-archive.rust-lang.org/stream/268952-edition-2021/topic/crater.20run.html#247956106">(Aug 02 2021 at 18:58)</a>:</h4>
<p>thanks!</p>



<a name="248821088"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/268952-edition%202021/topic/crater%20run/near/248821088" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Karim Agha <a href="https://zulip-archive.rust-lang.org/stream/268952-edition-2021/topic/crater.20run.html#248821088">(Aug 09 2021 at 09:06)</a>:</h4>
<p>Hello there! What are the chances of fn_traits getting into this edition or even making it into stable rust anytime soon? I kind of miss overloading the operator() from C++.</p>



<a name="248830348"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/268952-edition%202021/topic/crater%20run/near/248830348" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Frank Steffahn <a href="https://zulip-archive.rust-lang.org/stream/268952-edition-2021/topic/crater.20run.html#248830348">(Aug 09 2021 at 11:00)</a>:</h4>
<p><span class="user-mention" data-user-id="390741">@Karim Agha</span> <br>
<code>fn_traits</code> is not a feature that needs an edition, so “getting into this edition” is not something that makes too much sense; the rest of the question is off-topic in this topic and stream, feel free to ask elsewhere.</p>



<a name="248928060"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/268952-edition%202021/topic/crater%20run/near/248928060" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Eric Huss <a href="https://zulip-archive.rust-lang.org/stream/268952-edition-2021/topic/crater.20run.html#248928060">(Aug 10 2021 at 00:52)</a>:</h4>
<p><span class="user-mention" data-user-id="310399">@Mara</span> I accidentally pushed a stale branch. Can you re-run the same top-1000 crater command?</p>



<a name="248957117"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/268952-edition%202021/topic/crater%20run/near/248957117" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mara <a href="https://zulip-archive.rust-lang.org/stream/268952-edition-2021/topic/crater.20run.html#248957117">(Aug 10 2021 at 09:25)</a>:</h4>
<p>the currently running job says <code>Estimated end:  3 months</code> <span aria-label="thinking" class="emoji emoji-1f914" role="img" title="thinking">:thinking:</span></p>



<a name="248987048"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/268952-edition%202021/topic/crater%20run/near/248987048" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> simulacrum <a href="https://zulip-archive.rust-lang.org/stream/268952-edition-2021/topic/crater.20run.html#248987048">(Aug 10 2021 at 14:30)</a>:</h4>
<p>crater's estimates are bad if the run gets interrupted, should go down rapidly though</p>



<a name="249218180"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/268952-edition%202021/topic/crater%20run/near/249218180" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mara <a href="https://zulip-archive.rust-lang.org/stream/268952-edition-2021/topic/crater.20run.html#249218180">(Aug 12 2021 at 10:31)</a>:</h4>
<p><span class="user-mention" data-user-id="116122">@simulacrum</span> any idea what happened here? <a href="https://github.com/rust-lang/rust/pull/87190#issuecomment-897147568">https://github.com/rust-lang/rust/pull/87190#issuecomment-897147568</a></p>



<a name="249248854"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/268952-edition%202021/topic/crater%20run/near/249248854" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Eric Huss <a href="https://zulip-archive.rust-lang.org/stream/268952-edition-2021/topic/crater.20run.html#249248854">(Aug 12 2021 at 15:19)</a>:</h4>
<p>I'm going through some of the errors in detail.  <span class="user-mention" data-user-id="310399">@Mara</span> I think there were a few other issues in the <code>regressed: dependencies </code> section.  I don't know how crater determines if the error is in a dependency, but I think it is confused.  I'll be working through it off and on today.  I'll post what I've found so far.</p>



<a name="249249093"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/268952-edition%202021/topic/crater%20run/near/249249093" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mara <a href="https://zulip-archive.rust-lang.org/stream/268952-edition-2021/topic/crater.20run.html#249249093">(Aug 12 2021 at 15:20)</a>:</h4>
<p>oh i didn't even look at the 'faulty deps' ones. trusting crater too much ^^'. yeah those look like root problems as well.</p>



<a name="249249178"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/268952-edition%202021/topic/crater%20run/near/249249178" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mara <a href="https://zulip-archive.rust-lang.org/stream/268952-edition-2021/topic/crater.20run.html#249249178">(Aug 12 2021 at 15:21)</a>:</h4>
<p>thanks!</p>



<a name="249250608"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/268952-edition%202021/topic/crater%20run/near/249250608" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Pietro Albini <a href="https://zulip-archive.rust-lang.org/stream/268952-edition-2021/topic/crater.20run.html#249250608">(Aug 12 2021 at 15:31)</a>:</h4>
<p><span class="user-mention" data-user-id="310399">@Mara</span> crater sets <code>--message-format=json</code> and checks which crate caused the error: if the error is not in the crate being tested it's marked as a faulty dependency</p>



<a name="249250654"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/268952-edition%202021/topic/crater%20run/near/249250654" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Pietro Albini <a href="https://zulip-archive.rust-lang.org/stream/268952-edition-2021/topic/crater.20run.html#249250654">(Aug 12 2021 at 15:31)</a>:</h4>
<p>(crater uses the json format to also categorize root regressions)</p>



<a name="249250700"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/268952-edition%202021/topic/crater%20run/near/249250700" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Pietro Albini <a href="https://zulip-archive.rust-lang.org/stream/268952-edition-2021/topic/crater.20run.html#249250700">(Aug 12 2021 at 15:31)</a>:</h4>
<p>oooooh</p>



<a name="249250815"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/268952-edition%202021/topic/crater%20run/near/249250815" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Pietro Albini <a href="https://zulip-archive.rust-lang.org/stream/268952-edition-2021/topic/crater.20run.html#249250815">(Aug 12 2021 at 15:32)</a>:</h4>
<p>I think the cargo patch is messing with the detection</p>



<a name="249251098"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/268952-edition%202021/topic/crater%20run/near/249251098" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Pietro Albini <a href="https://zulip-archive.rust-lang.org/stream/268952-edition-2021/topic/crater.20run.html#249251098">(Aug 12 2021 at 15:34)</a>:</h4>
<p><span class="user-mention" data-user-id="120518">@Eric Huss</span> crater uses <a href="https://github.com/rust-lang/crater/blob/24754820fdf522b723e8f679c981ab25a13fa748/src/runner/test.rs#L67-L78">https://github.com/rust-lang/crater/blob/24754820fdf522b723e8f679c981ab25a13fa748/src/runner/test.rs#L67-L78</a> to determine which package ids are considered "local crates" -- is it possible that your cargo patch is messing with that?</p>



<a name="249251396"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/268952-edition%202021/topic/crater%20run/near/249251396" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Eric Huss <a href="https://zulip-archive.rust-lang.org/stream/268952-edition-2021/topic/crater.20run.html#249251396">(Aug 12 2021 at 15:37)</a>:</h4>
<p>Yea, probably because it is copying the package to <code>/tmp</code>, and that changes the PackageId.</p>



<a name="249251729"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/268952-edition%202021/topic/crater%20run/near/249251729" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mara <a href="https://zulip-archive.rust-lang.org/stream/268952-edition-2021/topic/crater.20run.html#249251729">(Aug 12 2021 at 15:40)</a>:</h4>
<p>ah, good to know</p>



<a name="249294581"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/268952-edition%202021/topic/crater%20run/near/249294581" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Eric Huss <a href="https://zulip-archive.rust-lang.org/stream/268952-edition-2021/topic/crater.20run.html#249294581">(Aug 12 2021 at 21:17)</a>:</h4>
<p>Lemme know if and when you want to proceed with a larger crater run.  The cargo hack seems to be working OK.  You can fire it off now, or wait for some more fixes to land.  I'm concerned about doing a full run will show hundreds or thousands of regressions.  Reviewing all of those will be a pretty big time investment.</p>



<a name="249305268"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/268952-edition%202021/topic/crater%20run/near/249305268" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mara <a href="https://zulip-archive.rust-lang.org/stream/268952-edition-2021/topic/crater.20run.html#249305268">(Aug 12 2021 at 23:19)</a>:</h4>
<p>if we wait a few days we can do the run with the current problems fixed, hopefully  ^^</p>



<a name="249329564"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/268952-edition%202021/topic/crater%20run/near/249329564" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Pietro Albini <a href="https://zulip-archive.rust-lang.org/stream/268952-edition-2021/topic/crater.20run.html#249329564">(Aug 13 2021 at 07:03)</a>:</h4>
<p><span class="user-mention" data-user-id="120518">@Eric Huss</span> if we can somehow fix the pkgid detection crater should be more useful in categorizing the actual regressions</p>



<a name="249359622"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/268952-edition%202021/topic/crater%20run/near/249359622" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Eric Huss <a href="https://zulip-archive.rust-lang.org/stream/268952-edition-2021/topic/crater.20run.html#249359622">(Aug 13 2021 at 13:24)</a>:</h4>
<p>I don't think it is necessary (or easy to fix).  This is a one-off situation, so I don't think we should put much energy into it.  All regressions should only be in root packages (since this is an unusual use of crater), so I think we can safely just combine the "regressed dependencies" and "regressed root results" lists.</p>



<a name="249658577"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/268952-edition%202021/topic/crater%20run/near/249658577" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Eric Huss <a href="https://zulip-archive.rust-lang.org/stream/268952-edition-2021/topic/crater.20run.html#249658577">(Aug 16 2021 at 22:51)</a>:</h4>
<p><span class="user-mention" data-user-id="310399">@Mara</span> Are you looking through the remaining errors?  If not, I can probably scan through them now.</p>



<a name="249658720"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/268952-edition%202021/topic/crater%20run/near/249658720" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mara <a href="https://zulip-archive.rust-lang.org/stream/268952-edition-2021/topic/crater.20run.html#249658720">(Aug 16 2021 at 22:52)</a>:</h4>
<p>yes! i'm going through 'regressed: dependencies - file%3A%2F%2F%2Ftmp%2Ffixit (38)' now</p>



<a name="249658771"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/268952-edition%202021/topic/crater%20run/near/249658771" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mara <a href="https://zulip-archive.rust-lang.org/stream/268952-edition-2021/topic/crater.20run.html#249658771">(Aug 16 2021 at 22:53)</a>:</h4>
<p>that's where all the relevant ones seem to be. but haven't checked the other sections in detail</p>



<a name="249661221"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/268952-edition%202021/topic/crater%20run/near/249661221" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mara <a href="https://zulip-archive.rust-lang.org/stream/268952-edition-2021/topic/crater.20run.html#249661221">(Aug 16 2021 at 23:25)</a>:</h4>
<p><a href="https://github.com/rust-lang/rust/pull/87190#issuecomment-899881870">https://github.com/rust-lang/rust/pull/87190#issuecomment-899881870</a></p>



<a name="249661231"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/268952-edition%202021/topic/crater%20run/near/249661231" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mara <a href="https://zulip-archive.rust-lang.org/stream/268952-edition-2021/topic/crater.20run.html#249661231">(Aug 16 2021 at 23:25)</a>:</h4>
<p>bed time <span aria-label="zzz" class="emoji emoji-1f4a4" role="img" title="zzz">:zzz:</span></p>



<a name="249661239"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/268952-edition%202021/topic/crater%20run/near/249661239" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mara <a href="https://zulip-archive.rust-lang.org/stream/268952-edition-2021/topic/crater.20run.html#249661239">(Aug 16 2021 at 23:25)</a>:</h4>
<p>(feel free to edit the comment to add details/issue numbers/etc.)</p>



<a name="249661260"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/268952-edition%202021/topic/crater%20run/near/249661260" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Eric Huss <a href="https://zulip-archive.rust-lang.org/stream/268952-edition-2021/topic/crater.20run.html#249661260">(Aug 16 2021 at 23:26)</a>:</h4>
<p>Thanks Mara!  I'll try to investigate some this evening.</p>



<a name="249733172"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/268952-edition%202021/topic/crater%20run/near/249733172" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Eric Huss <a href="https://zulip-archive.rust-lang.org/stream/268952-edition-2021/topic/crater.20run.html#249733172">(Aug 17 2021 at 15:12)</a>:</h4>
<p>Posted <a href="https://github.com/rust-lang/cargo/pull/9799">https://github.com/rust-lang/cargo/pull/9799</a> to help diagnose the errors we can't reproduce.</p>



<a name="249793088"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/268952-edition%202021/topic/crater%20run/near/249793088" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Eric Huss <a href="https://zulip-archive.rust-lang.org/stream/268952-edition-2021/topic/crater.20run.html#249793088">(Aug 17 2021 at 23:50)</a>:</h4>
<p>Posted <a href="https://github.com/rust-lang/cargo/pull/9803">https://github.com/rust-lang/cargo/pull/9803</a> to help improve the report about feature resolver differences, as one of the packages (<code>easy-jsonrpc-mw</code>) had a somewhat confusing error message.</p>



<a name="250516583"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/268952-edition%202021/topic/crater%20run/near/250516583" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Eric Huss <a href="https://zulip-archive.rust-lang.org/stream/268952-edition-2021/topic/crater.20run.html#250516583">(Aug 24 2021 at 17:11)</a>:</h4>
<p><span class="user-mention" data-user-id="310399">@Mara</span> Do you want to coordinate triaging the crater results?  I expect there will be at least a few hundred failures, so it may take some time to categorize and investigate them.</p>



<a name="250552723"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/268952-edition%202021/topic/crater%20run/near/250552723" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mara <a href="https://zulip-archive.rust-lang.org/stream/268952-edition-2021/topic/crater.20run.html#250552723">(Aug 24 2021 at 21:37)</a>:</h4>
<p><span class="user-mention" data-user-id="120518">@Eric Huss</span> yes, but i probably won't have time until saturday</p>



<a name="250594175"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/268952-edition%202021/topic/crater%20run/near/250594175" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mara <a href="https://zulip-archive.rust-lang.org/stream/268952-edition-2021/topic/crater.20run.html#250594175">(Aug 25 2021 at 08:51)</a>:</h4>
<p>started here: <a href="https://github.com/rust-lang/rust/pull/87190#issuecomment-905250803">https://github.com/rust-lang/rust/pull/87190#issuecomment-905250803</a></p>



<a name="250631487"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/268952-edition%202021/topic/crater%20run/near/250631487" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Eric Huss <a href="https://zulip-archive.rust-lang.org/stream/268952-edition-2021/topic/crater.20run.html#250631487">(Aug 25 2021 at 14:54)</a>:</h4>
<p>Thanks <span class="user-mention" data-user-id="310399">@Mara</span> !  I'll be looking over these off and on over the next few days.</p>



<a name="250634108"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/268952-edition%202021/topic/crater%20run/near/250634108" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mara <a href="https://zulip-archive.rust-lang.org/stream/268952-edition-2021/topic/crater.20run.html#250634108">(Aug 25 2021 at 15:14)</a>:</h4>
<p><span class="user-mention" data-user-id="120518">@Eric Huss</span> would it make sense for <code>cargo fix --edition</code> to not apply any non-edition lints? cap them to allow while still forcing the edition lints to warn or something.</p>



<a name="250634477"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/268952-edition%202021/topic/crater%20run/near/250634477" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Eric Huss <a href="https://zulip-archive.rust-lang.org/stream/268952-edition-2021/topic/crater.20run.html#250634477">(Aug 25 2021 at 15:18)</a>:</h4>
<p>Hm.  So there is a long history with that (<a href="https://github.com/rust-lang/cargo/issues/5738">https://github.com/rust-lang/cargo/issues/5738</a>).  Historically it has been a difficult thing to fix since it needed changes in rustc.  I'm not sure, maybe <code>--force-warn</code> makes it easier now?  I'd be concerned that some suggestions might be required, but offhand I can't think of any.</p>



<a name="250635410"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/268952-edition%202021/topic/crater%20run/near/250635410" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mara <a href="https://zulip-archive.rust-lang.org/stream/268952-edition-2021/topic/crater.20run.html#250635410">(Aug 25 2021 at 15:25)</a>:</h4>
<p>looks like most of that issue is basically 'we need --force-warn'</p>



<a name="250635431"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/268952-edition%202021/topic/crater%20run/near/250635431" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mara <a href="https://zulip-archive.rust-lang.org/stream/268952-edition-2021/topic/crater.20run.html#250635431">(Aug 25 2021 at 15:25)</a>:</h4>
<p>(it overrides --cap-lints, i hope? maybe not)</p>



<a name="251204874"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/268952-edition%202021/topic/crater%20run/near/251204874" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> rylev <a href="https://zulip-archive.rust-lang.org/stream/268952-edition-2021/topic/crater.20run.html#251204874">(Aug 30 2021 at 09:35)</a>:</h4>
<p>It does (though I'm still catching up to see how things have changed with it since I've been away)</p>



<a name="251227041"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/268952-edition%202021/topic/crater%20run/near/251227041" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Eric Huss <a href="https://zulip-archive.rust-lang.org/stream/268952-edition-2021/topic/crater.20run.html#251227041">(Aug 30 2021 at 13:15)</a>:</h4>
<p>I'm going to stop looking at the rest of the crater results.  I think <a href="https://hackmd.io/xltX-gYFRpO-2OHDAW9Sag?both">https://hackmd.io/xltX-gYFRpO-2OHDAW9Sag?both</a> covers all the known errors.  The rest (about two thirds) are going to be due to:</p>
<ul>
<li>New feature resolver</li>
<li><code>dyn</code> and <code>...</code> in macros or generated code</li>
<li>Non-edition fixes (<a href="https://github.com/rust-lang/cargo/issues/5738">cargo#5738</a>) which has a PR up to fix at <a href="https://github.com/rust-lang/cargo/pull/9846">cargo#9846</a></li>
<li>One of the other listed errors</li>
</ul>



<a name="251227397"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/268952-edition%202021/topic/crater%20run/near/251227397" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mara <a href="https://zulip-archive.rust-lang.org/stream/268952-edition-2021/topic/crater.20run.html#251227397">(Aug 30 2021 at 13:17)</a>:</h4>
<p>nice! you went to a lot of them. thanks! good to see that they're mostly known issues or non-issues :D</p>



<a name="251401938"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/268952-edition%202021/topic/crater%20run/near/251401938" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> rylev <a href="https://zulip-archive.rust-lang.org/stream/268952-edition-2021/topic/crater.20run.html#251401938">(Aug 31 2021 at 15:13)</a>:</h4>
<p>I'm having a hard time seeing what's causing this error here: <a href="https://crater-reports.s3.amazonaws.com/pr-87190-3/try%23a7a572ce3edd6d476191fbfe92c9c1986e009b34/gh/44smkn.ironmonkey/log.txt">https://crater-reports.s3.amazonaws.com/pr-87190-3/try%23a7a572ce3edd6d476191fbfe92c9c1986e009b34/gh/44smkn.ironmonkey/log.txt</a></p>



<a name="251402095"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/268952-edition%202021/topic/crater%20run/near/251402095" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> rylev <a href="https://zulip-archive.rust-lang.org/stream/268952-edition-2021/topic/crater.20run.html#251402095">(Aug 31 2021 at 15:14)</a>:</h4>
<p>It seems that the method is not found except for on a trait that is not in scope. What could cause this error?</p>



<a name="251402513"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/268952-edition%202021/topic/crater%20run/near/251402513" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Eric Huss <a href="https://zulip-archive.rust-lang.org/stream/268952-edition-2021/topic/crater.20run.html#251402513">(Aug 31 2021 at 15:17)</a>:</h4>
<p><span class="user-mention" data-user-id="224872">@rylev</span> Almost all of the name resolution errors are because of <code>cfg(test)</code> differences.  If someone has:</p>
<div class="codehilite" data-code-language="Rust"><pre><span></span><code><span class="k">use</span><span class="w"> </span><span class="n">thing</span><span class="p">;</span><span class="w"></span>

<span class="cp">#[test]</span><span class="w"></span>
<span class="k">fn</span> <span class="nf">foo</span><span class="p">()</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="n">thing</span><span class="p">();</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>
</code></pre></div>
<p>Then when checking that code as a non-test, it will remove <code>use thing;</code>, but then when building it as a unittest, it will fail since the <code>use</code> is now missing.</p>



<a name="251402642"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/268952-edition%202021/topic/crater%20run/near/251402642" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Eric Huss <a href="https://zulip-archive.rust-lang.org/stream/268952-edition-2021/topic/crater.20run.html#251402642">(Aug 31 2021 at 15:18)</a>:</h4>
<p><a href="https://github.com/rust-lang/cargo/pull/9846">https://github.com/rust-lang/cargo/pull/9846</a> will fix this so that <code>--edition</code> will not remove stuff like that.</p>



<a name="251402684"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/268952-edition%202021/topic/crater%20run/near/251402684" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> rylev <a href="https://zulip-archive.rust-lang.org/stream/268952-edition-2021/topic/crater.20run.html#251402684">(Aug 31 2021 at 15:18)</a>:</h4>
<p>Ah ok, that seems hard to tell apart from a legitimate error in resolution...</p>



<a name="251402794"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/268952-edition%202021/topic/crater%20run/near/251402794" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> rylev <a href="https://zulip-archive.rust-lang.org/stream/268952-edition-2021/topic/crater.20run.html#251402794">(Aug 31 2021 at 15:19)</a>:</h4>
<p><span class="user-mention" data-user-id="120518">@Eric Huss</span> when you said yesterday that you were confident the remaining issues fell into known categories, did you mean that you don't think it's worth it for anyone to go through the remaining untriaged logs?</p>



<a name="251402927"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/268952-edition%202021/topic/crater%20run/near/251402927" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Eric Huss <a href="https://zulip-archive.rust-lang.org/stream/268952-edition-2021/topic/crater.20run.html#251402927">(Aug 31 2021 at 15:20)</a>:</h4>
<p>Yea, I don't think there is going to be much more useful information.</p>



<a name="251403096"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/268952-edition%202021/topic/crater%20run/near/251403096" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Eric Huss <a href="https://zulip-archive.rust-lang.org/stream/268952-edition-2021/topic/crater.20run.html#251403096">(Aug 31 2021 at 15:21)</a>:</h4>
<p>I had categorized all the failures by the error codes, and the rest are going to be duplicates of what has already been reported.  Feel free to skim through, but I don't think there will be much more useful stuff in there.</p>



<a name="251414046"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/268952-edition%202021/topic/crater%20run/near/251414046" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Eric Huss <a href="https://zulip-archive.rust-lang.org/stream/268952-edition-2021/topic/crater.20run.html#251414046">(Aug 31 2021 at 16:25)</a>:</h4>
<p>Oh, I forgot, I still had a small list of errors to look at.  If someone wants to help, take a look at these:</p>
<ul>
<li><a href="https://tiny.cc/oaaiuz/reg/linestring-0.6.3/log.txt">https://tiny.cc/oaaiuz/reg/linestring-0.6.3/log.txt</a></li>
<li><a href="https://tiny.cc/oaaiuz/reg/completion-0.2.1/log.txt">https://tiny.cc/oaaiuz/reg/completion-0.2.1/log.txt</a></li>
<li><a href="https://tiny.cc/oaaiuz/reg/ark-poly-commit-0.3.0/log.txt">https://tiny.cc/oaaiuz/reg/ark-poly-commit-0.3.0/log.txt</a></li>
<li><a href="https://tiny.cc/oaaiuz/reg/snarkvm-polycommit-0.7.9/log.txt">https://tiny.cc/oaaiuz/reg/snarkvm-polycommit-0.7.9/log.txt</a></li>
<li><a href="https://tiny.cc/oaaiuz/reg/rio_xml-0.6.1/log.txt">https://tiny.cc/oaaiuz/reg/rio_xml-0.6.1/log.txt</a></li>
<li><a href="https://tiny.cc/oaaiuz/reg/asn1-rs-0.2.0/log.txt">https://tiny.cc/oaaiuz/reg/asn1-rs-0.2.0/log.txt</a></li>
<li><a href="https://tiny.cc/oaaiuz/reg/fstrings-rust-proc-macro-1.0.0/log.txt">https://tiny.cc/oaaiuz/reg/fstrings-rust-proc-macro-1.0.0/log.txt</a></li>
<li><a href="https://tiny.cc/oaaiuz/gh/FeanorTheElf.Parser/log.txt">https://tiny.cc/oaaiuz/gh/FeanorTheElf.Parser/log.txt</a></li>
<li><a href="https://tiny.cc/oaaiuz/gh/T-parrish.rust_study_materials/log.txt">https://tiny.cc/oaaiuz/gh/T-parrish.rust_study_materials/log.txt</a></li>
</ul>
<p>I'm not sure if those are already covered by the existing issues, the errors are a little cryptic, so you'll probably need to check out the source and look it over.</p>



<hr><p>Last updated: Apr 12 2022 at 20:01 UTC</p>
</html>