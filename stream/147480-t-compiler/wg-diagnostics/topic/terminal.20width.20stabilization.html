<html>
<head><meta charset="utf-8"><title>terminal width stabilization · t-compiler/wg-diagnostics · Zulip Chat Archive</title></head>
<h2>Stream: <a href="https://zulip-archive.rust-lang.org/stream/147480-t-compiler/wg-diagnostics/index.html">t-compiler/wg-diagnostics</a></h2>
<h3>Topic: <a href="https://zulip-archive.rust-lang.org/stream/147480-t-compiler/wg-diagnostics/topic/terminal.20width.20stabilization.html">terminal width stabilization</a></h3>

<hr>

<base href="https://rust-lang.zulipchat.com">

<head><link href="https://zulip-archive.rust-lang.org/style.css" rel="stylesheet"></head>

<a name="277576963"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/147480-t-compiler/wg-diagnostics/topic/terminal%20width%20stabilization/near/277576963" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> davidtwco <a href="https://zulip-archive.rust-lang.org/stream/147480-t-compiler/wg-diagnostics/topic/terminal.20width.20stabilization.html#277576963">(Apr 03 2022 at 05:26)</a>:</h4>
<p>Do people think it would be reasonable to stabilize <code>-Z terminal-width</code>? It only a small thing. It's not had any changes in a while, although <a href="https://github.com/rust-lang/rust/issues/95432">#95432</a> was recently filed. I have a <a href="https://github.com/davidtwco/rust/tree/terminal-width-stabilization">branch making the stabilization</a> and can open a PR if we think it's worth doing.</p>



<a name="277582246"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/147480-t-compiler/wg-diagnostics/topic/terminal%20width%20stabilization/near/277582246" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> oli <a href="https://zulip-archive.rust-lang.org/stream/147480-t-compiler/wg-diagnostics/topic/terminal.20width.20stabilization.html#277582246">(Apr 03 2022 at 06:18)</a>:</h4>
<p>I can't find any prior discussion on it beyond the impl PRs linked in the tracking issue: <a href="https://github.com/rust-lang/rust/issues/84673">https://github.com/rust-lang/rust/issues/84673</a></p>



<a name="277582331"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/147480-t-compiler/wg-diagnostics/topic/terminal%20width%20stabilization/near/277582331" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> oli <a href="https://zulip-archive.rust-lang.org/stream/147480-t-compiler/wg-diagnostics/topic/terminal.20width.20stabilization.html#277582331">(Apr 03 2022 at 06:19)</a>:</h4>
<p>I think we should at least try to figure out whether the information can be deduced from env vars like we do with terminal colors</p>



<a name="277582504"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/147480-t-compiler/wg-diagnostics/topic/terminal%20width%20stabilization/near/277582504" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> oli <a href="https://zulip-archive.rust-lang.org/stream/147480-t-compiler/wg-diagnostics/topic/terminal.20width.20stabilization.html#277582504">(Apr 03 2022 at 06:21)</a>:</h4>
<p>We'll still need a flag to explicitly turn it off and on like colors. That flag should be as similar to the color flags as possible I think just to be consistent</p>



<a name="277586205"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/147480-t-compiler/wg-diagnostics/topic/terminal%20width%20stabilization/near/277586205" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> davidtwco <a href="https://zulip-archive.rust-lang.org/stream/147480-t-compiler/wg-diagnostics/topic/terminal.20width.20stabilization.html#277586205">(Apr 03 2022 at 06:56)</a>:</h4>
<p><span class="user-mention silent" data-user-id="124288">oli</span> <a href="#narrow/stream/147480-t-compiler.2Fwg-diagnostics/topic/terminal.20width.20stabilization/near/277582331">said</a>:</p>
<blockquote>
<p>I think we should at least try to figure out whether the information can be deduced from env vars like we do with terminal colors</p>
</blockquote>
<p>There are no environment variables for this, as far as I can gather, some shells will make fake <code>COLUMNS</code>/<code>LINES</code> variables but don't expose them to things that are running (because the shell wouldn't be able to update the environment variables during the process were the terminal to be resized). rustc already does terminal width detection, this flag is primarily for use by users who want to arbitrarily limit the terminal width more, or - more frequently - for build tools which invoke rustc and therefore prevent rustc from detecting the terminal width itself.</p>



<a name="277586325"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/147480-t-compiler/wg-diagnostics/topic/terminal%20width%20stabilization/near/277586325" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> davidtwco <a href="https://zulip-archive.rust-lang.org/stream/147480-t-compiler/wg-diagnostics/topic/terminal.20width.20stabilization.html#277586325">(Apr 03 2022 at 06:57)</a>:</h4>
<p><span class="user-mention silent" data-user-id="124288">oli</span> <a href="#narrow/stream/147480-t-compiler.2Fwg-diagnostics/topic/terminal.20width.20stabilization/near/277582504">said</a>:</p>
<blockquote>
<p>We'll still need a flag to explicitly turn it off and on like colors. That flag should be as similar to the color flags as possible I think just to be consistent</p>
</blockquote>
<p>The flag is off by default, if you don't pass it a value then rustc will attempt to autodetect the terminal width or provide a sane default if it can't. If you provide the flag then you're providing a terminal width for rustc to use.</p>



<a name="277589305"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/147480-t-compiler/wg-diagnostics/topic/terminal%20width%20stabilization/near/277589305" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> oli <a href="https://zulip-archive.rust-lang.org/stream/147480-t-compiler/wg-diagnostics/topic/terminal.20width.20stabilization.html#277589305">(Apr 03 2022 at 07:24)</a>:</h4>
<p>OK, makes sense</p>



<a name="277589337"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/147480-t-compiler/wg-diagnostics/topic/terminal%20width%20stabilization/near/277589337" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> oli <a href="https://zulip-archive.rust-lang.org/stream/147480-t-compiler/wg-diagnostics/topic/terminal.20width.20stabilization.html#277589337">(Apr 03 2022 at 07:24)</a>:</h4>
<p>In that case, with this info in a stabilization PR, I think nothing speaks against it</p>



<a name="277668755"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/147480-t-compiler/wg-diagnostics/topic/terminal%20width%20stabilization/near/277668755" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Esteban Küber <a href="https://zulip-archive.rust-lang.org/stream/147480-t-compiler/wg-diagnostics/topic/terminal.20width.20stabilization.html#277668755">(Apr 04 2022 at 00:03)</a>:</h4>
<p>The main reason for it is so that cargo could pass that info through to rustc, because in that case the detection doesn't work</p>



<a name="277684724"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/147480-t-compiler/wg-diagnostics/topic/terminal%20width%20stabilization/near/277684724" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> davidtwco <a href="https://zulip-archive.rust-lang.org/stream/147480-t-compiler/wg-diagnostics/topic/terminal.20width.20stabilization.html#277684724">(Apr 04 2022 at 05:49)</a>:</h4>
<p><span class="user-mention silent" data-user-id="124288">oli</span> <a href="#narrow/stream/147480-t-compiler.2Fwg-diagnostics/topic/terminal.20width.20stabilization/near/277589337">said</a>:</p>
<blockquote>
<p>In that case, with this info in a stabilization PR, I think nothing speaks against it</p>
</blockquote>
<p>It's been a while since I've stabilized anything, but I think I did it right (?): <a href="https://github.com/rust-lang/rust/issues/84673#issuecomment-1087141656">https://github.com/rust-lang/rust/issues/84673#issuecomment-1087141656</a></p>



<hr><p>Last updated: Apr 12 2022 at 20:01 UTC</p>
</html>