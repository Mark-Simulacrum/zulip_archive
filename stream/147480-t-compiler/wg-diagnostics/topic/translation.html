<html>
<head><meta charset="utf-8"><title>translation · t-compiler/wg-diagnostics · Zulip Chat Archive</title></head>
<h2>Stream: <a href="https://zulip-archive.rust-lang.org/stream/147480-t-compiler/wg-diagnostics/index.html">t-compiler/wg-diagnostics</a></h2>
<h3>Topic: <a href="https://zulip-archive.rust-lang.org/stream/147480-t-compiler/wg-diagnostics/topic/translation.html">translation</a></h3>

<hr>

<base href="https://rust-lang.zulipchat.com">

<head><link href="https://zulip-archive.rust-lang.org/style.css" rel="stylesheet"></head>

<a name="187042515"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/147480-t-compiler/wg-diagnostics/topic/translation/near/187042515" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Manish Goregaokar <a href="https://zulip-archive.rust-lang.org/stream/147480-t-compiler/wg-diagnostics/topic/translation.html#187042515">(Jan 30 2020 at 23:24)</a>:</h4>
<p><span class="user-mention" data-user-id="116122">@simulacrum</span> <span class="user-mention" data-user-id="126931">@centril</span> there is definitely a plan for internationalization :)</p>



<a name="187042568"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/147480-t-compiler/wg-diagnostics/topic/translation/near/187042568" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> simulacrum <a href="https://zulip-archive.rust-lang.org/stream/147480-t-compiler/wg-diagnostics/topic/translation.html#187042568">(Jan 30 2020 at 23:25)</a>:</h4>
<p>is that plan concrete implementation wise though? My impression is that we have broad strokes (e.g., maybe even what platform to use) but not the details.</p>



<a name="187042639"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/147480-t-compiler/wg-diagnostics/topic/translation/near/187042639" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Manish Goregaokar <a href="https://zulip-archive.rust-lang.org/stream/147480-t-compiler/wg-diagnostics/topic/translation.html#187042639">(Jan 30 2020 at 23:26)</a>:</h4>
<p>Once we have diagnostics structs as listed in the issue then it should be easy ish to add i18n based on various json files or something that key off of the text error code or something</p>



<a name="187042675"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/147480-t-compiler/wg-diagnostics/topic/translation/near/187042675" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Manish Goregaokar <a href="https://zulip-archive.rust-lang.org/stream/147480-t-compiler/wg-diagnostics/topic/translation.html#187042675">(Jan 30 2020 at 23:26)</a>:</h4>
<p>This assumes there's a human-understandable "error code" like <code>object-safety-generics</code> that we can key off of but if we decide against codes then we can still use this internally</p>



<a name="187042687"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/147480-t-compiler/wg-diagnostics/topic/translation/near/187042687" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> simulacrum <a href="https://zulip-archive.rust-lang.org/stream/147480-t-compiler/wg-diagnostics/topic/translation.html#187042687">(Jan 30 2020 at 23:27)</a>:</h4>
<p>(split off into new topic)</p>



<a name="187042703"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/147480-t-compiler/wg-diagnostics/topic/translation/near/187042703" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Manish Goregaokar <a href="https://zulip-archive.rust-lang.org/stream/147480-t-compiler/wg-diagnostics/topic/translation.html#187042703">(Jan 30 2020 at 23:27)</a>:</h4>
<p><span class="user-mention" data-user-id="116122">@simulacrum</span> there are some open questions but in this case I think it's _mostly_ clear implementation wise what we can do</p>



<a name="187042712"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/147480-t-compiler/wg-diagnostics/topic/translation/near/187042712" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Manish Goregaokar <a href="https://zulip-archive.rust-lang.org/stream/147480-t-compiler/wg-diagnostics/topic/translation.html#187042712">(Jan 30 2020 at 23:27)</a>:</h4>
<p>We don't even necessarily need to pull in Fluent</p>



<a name="187042769"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/147480-t-compiler/wg-diagnostics/topic/translation/near/187042769" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> simulacrum <a href="https://zulip-archive.rust-lang.org/stream/147480-t-compiler/wg-diagnostics/topic/translation.html#187042769">(Jan 30 2020 at 23:28)</a>:</h4>
<p><span class="user-mention" data-user-id="132040">@Manish Goregaokar</span> hm, okay</p>



<a name="187042775"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/147480-t-compiler/wg-diagnostics/topic/translation/near/187042775" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> simulacrum <a href="https://zulip-archive.rust-lang.org/stream/147480-t-compiler/wg-diagnostics/topic/translation.html#187042775">(Jan 30 2020 at 23:28)</a>:</h4>
<p>that's farther than I thought we were</p>



<a name="187042797"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/147480-t-compiler/wg-diagnostics/topic/translation/near/187042797" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Manish Goregaokar <a href="https://zulip-archive.rust-lang.org/stream/147480-t-compiler/wg-diagnostics/topic/translation.html#187042797">(Jan 30 2020 at 23:29)</a>:</h4>
<p>Error i18n is blocked on y'all implementing the diagnostics derive</p>



<a name="187042829"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/147480-t-compiler/wg-diagnostics/topic/translation/near/187042829" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Manish Goregaokar <a href="https://zulip-archive.rust-lang.org/stream/147480-t-compiler/wg-diagnostics/topic/translation.html#187042829">(Jan 30 2020 at 23:29)</a>:</h4>
<p>error index i18n isn't blocked on anything someone just needs to do it, also it would make sense to hold off until after we figure out error codes</p>



<a name="187042842"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/147480-t-compiler/wg-diagnostics/topic/translation/near/187042842" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Manish Goregaokar <a href="https://zulip-archive.rust-lang.org/stream/147480-t-compiler/wg-diagnostics/topic/translation.html#187042842">(Jan 30 2020 at 23:30)</a>:</h4>
<p><span class="user-mention" data-user-id="116122">@simulacrum</span> note that this is only a plan, no implementation</p>



<a name="187042910"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/147480-t-compiler/wg-diagnostics/topic/translation/near/187042910" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Manish Goregaokar <a href="https://zulip-archive.rust-lang.org/stream/147480-t-compiler/wg-diagnostics/topic/translation.html#187042910">(Jan 30 2020 at 23:30)</a>:</h4>
<p>But please loop me in on PRs implementing the diagnostics derive so I can ensure it's compatible with this</p>



<a name="187042924"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/147480-t-compiler/wg-diagnostics/topic/translation/near/187042924" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Manish Goregaokar <a href="https://zulip-archive.rust-lang.org/stream/147480-t-compiler/wg-diagnostics/topic/translation.html#187042924">(Jan 30 2020 at 23:30)</a>:</h4>
<p>I was going to do it myself but I keep not having time lol</p>



<a name="187042984"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/147480-t-compiler/wg-diagnostics/topic/translation/near/187042984" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> simulacrum <a href="https://zulip-archive.rust-lang.org/stream/147480-t-compiler/wg-diagnostics/topic/translation.html#187042984">(Jan 30 2020 at 23:31)</a>:</h4>
<p>yeah, this also all sounds mostly compatible</p>



<a name="187043067"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/147480-t-compiler/wg-diagnostics/topic/translation/near/187043067" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> simulacrum <a href="https://zulip-archive.rust-lang.org/stream/147480-t-compiler/wg-diagnostics/topic/translation.html#187043067">(Jan 30 2020 at 23:32)</a>:</h4>
<p>I continue to be skeptical about the "many files on disk", but of course the final artifacts can bundle things up if needed</p>



<a name="187043107"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/147480-t-compiler/wg-diagnostics/topic/translation/near/187043107" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> centril <a href="https://zulip-archive.rust-lang.org/stream/147480-t-compiler/wg-diagnostics/topic/translation.html#187043107">(Jan 30 2020 at 23:33)</a>:</h4>
<p><span class="user-mention" data-user-id="132040">@Manish Goregaokar</span> did you have thoughts re. translation of error descriptions though? (i.e. the <code>.md</code> files we have today)</p>



<a name="187043126"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/147480-t-compiler/wg-diagnostics/topic/translation/near/187043126" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> centril <a href="https://zulip-archive.rust-lang.org/stream/147480-t-compiler/wg-diagnostics/topic/translation.html#187043126">(Jan 30 2020 at 23:33)</a>:</h4>
<p>these: <a href="https://github.com/rust-lang/rust/tree/master/src/librustc_error_codes/error_codes" target="_blank" title="https://github.com/rust-lang/rust/tree/master/src/librustc_error_codes/error_codes">https://github.com/rust-lang/rust/tree/master/src/librustc_error_codes/error_codes</a></p>



<a name="187043283"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/147480-t-compiler/wg-diagnostics/topic/translation/near/187043283" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Manish Goregaokar <a href="https://zulip-archive.rust-lang.org/stream/147480-t-compiler/wg-diagnostics/topic/translation.html#187043283">(Jan 30 2020 at 23:35)</a>:</h4>
<p>As long as there's something to key off of this is quite easy.</p>



<a name="187043328"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/147480-t-compiler/wg-diagnostics/topic/translation/near/187043328" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Manish Goregaokar <a href="https://zulip-archive.rust-lang.org/stream/147480-t-compiler/wg-diagnostics/topic/translation.html#187043328">(Jan 30 2020 at 23:36)</a>:</h4>
<p>Again, some open questions.</p>



<a name="187043354"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/147480-t-compiler/wg-diagnostics/topic/translation/near/187043354" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> centril <a href="https://zulip-archive.rust-lang.org/stream/147480-t-compiler/wg-diagnostics/topic/translation.html#187043354">(Jan 30 2020 at 23:36)</a>:</h4>
<p>it's basically just a string code that is linked up via a rustc_driver hashmap to descriptions</p>



<a name="187043359"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/147480-t-compiler/wg-diagnostics/topic/translation/near/187043359" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> centril <a href="https://zulip-archive.rust-lang.org/stream/147480-t-compiler/wg-diagnostics/topic/translation.html#187043359">(Jan 30 2020 at 23:36)</a>:</h4>
<p>it's very isolated</p>



<a name="187043394"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/147480-t-compiler/wg-diagnostics/topic/translation/near/187043394" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> centril <a href="https://zulip-archive.rust-lang.org/stream/147480-t-compiler/wg-diagnostics/topic/translation.html#187043394">(Jan 30 2020 at 23:37)</a>:</h4>
<p>but I was wondering re. the linking aspect; e.g. how do we store the translations and how does rustc load them?</p>



<a name="187043478"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/147480-t-compiler/wg-diagnostics/topic/translation/near/187043478" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> centril <a href="https://zulip-archive.rust-lang.org/stream/147480-t-compiler/wg-diagnostics/topic/translation.html#187043478">(Jan 30 2020 at 23:38)</a>:</h4>
<p><a href="https://doc.rust-lang.org/nightly/nightly-rustc/rustc_errors/registry/struct.Registry.html" target="_blank" title="https://doc.rust-lang.org/nightly/nightly-rustc/rustc_errors/registry/struct.Registry.html">https://doc.rust-lang.org/nightly/nightly-rustc/rustc_errors/registry/struct.Registry.html</a></p>



<a name="187043600"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/147480-t-compiler/wg-diagnostics/topic/translation/near/187043600" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Manish Goregaokar <a href="https://zulip-archive.rust-lang.org/stream/147480-t-compiler/wg-diagnostics/topic/translation.html#187043600">(Jan 30 2020 at 23:40)</a>:</h4>
<p><span class="user-mention" data-user-id="126931">@centril</span> rustup component, basically json files or something. which specific format depends on what works with Pontoon and what can support the detail we need. I think for error codes the json format is fine.</p>



<a name="187043615"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/147480-t-compiler/wg-diagnostics/topic/translation/near/187043615" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Manish Goregaokar <a href="https://zulip-archive.rust-lang.org/stream/147480-t-compiler/wg-diagnostics/topic/translation.html#187043615">(Jan 30 2020 at 23:41)</a>:</h4>
<p>Could also bake it in, but at least to start with a rustup component makes sense to me</p>



<a name="187043624"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/147480-t-compiler/wg-diagnostics/topic/translation/near/187043624" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Manish Goregaokar <a href="https://zulip-archive.rust-lang.org/stream/147480-t-compiler/wg-diagnostics/topic/translation.html#187043624">(Jan 30 2020 at 23:41)</a>:</h4>
<p>For diagnostics we may need to use a format a bit more powerful than json</p>



<a name="187043627"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/147480-t-compiler/wg-diagnostics/topic/translation/near/187043627" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Manish Goregaokar <a href="https://zulip-archive.rust-lang.org/stream/147480-t-compiler/wg-diagnostics/topic/translation.html#187043627">(Jan 30 2020 at 23:41)</a>:</h4>
<p>Maybe.</p>



<a name="187043635"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/147480-t-compiler/wg-diagnostics/topic/translation/near/187043635" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Manish Goregaokar <a href="https://zulip-archive.rust-lang.org/stream/147480-t-compiler/wg-diagnostics/topic/translation.html#187043635">(Jan 30 2020 at 23:41)</a>:</h4>
<p>Either way these files are never hand generated</p>



<a name="187043644"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/147480-t-compiler/wg-diagnostics/topic/translation/near/187043644" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Manish Goregaokar <a href="https://zulip-archive.rust-lang.org/stream/147480-t-compiler/wg-diagnostics/topic/translation.html#187043644">(Jan 30 2020 at 23:41)</a>:</h4>
<p>Er, handwritten</p>



<a name="187043687"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/147480-t-compiler/wg-diagnostics/topic/translation/near/187043687" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Manish Goregaokar <a href="https://zulip-archive.rust-lang.org/stream/147480-t-compiler/wg-diagnostics/topic/translation.html#187043687">(Jan 30 2020 at 23:42)</a>:</h4>
<p>Or read by humans.</p>



<a name="187043702"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/147480-t-compiler/wg-diagnostics/topic/translation/near/187043702" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> centril <a href="https://zulip-archive.rust-lang.org/stream/147480-t-compiler/wg-diagnostics/topic/translation.html#187043702">(Jan 30 2020 at 23:42)</a>:</h4>
<p>Error descriptions are basically just a long string, so it requires nothing technically complicated beyond that I think</p>



<a name="187043704"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/147480-t-compiler/wg-diagnostics/topic/translation/near/187043704" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> simulacrum <a href="https://zulip-archive.rust-lang.org/stream/147480-t-compiler/wg-diagnostics/topic/translation.html#187043704">(Jan 30 2020 at 23:42)</a>:</h4>
<p>I continue to think the linking aspect is not too interesting :)</p>



<a name="187043710"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/147480-t-compiler/wg-diagnostics/topic/translation/near/187043710" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> simulacrum <a href="https://zulip-archive.rust-lang.org/stream/147480-t-compiler/wg-diagnostics/topic/translation.html#187043710">(Jan 30 2020 at 23:42)</a>:</h4>
<p>like, we can definitely do it</p>



<a name="187043726"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/147480-t-compiler/wg-diagnostics/topic/translation/near/187043726" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> simulacrum <a href="https://zulip-archive.rust-lang.org/stream/147480-t-compiler/wg-diagnostics/topic/translation.html#187043726">(Jan 30 2020 at 23:42)</a>:</h4>
<p>I personally favor the existing solution as being just fine</p>



<a name="187043736"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/147480-t-compiler/wg-diagnostics/topic/translation/near/187043736" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> centril <a href="https://zulip-archive.rust-lang.org/stream/147480-t-compiler/wg-diagnostics/topic/translation.html#187043736">(Jan 30 2020 at 23:42)</a>:</h4>
<p>I agree in the sense that it's not complicated</p>



<a name="187043759"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/147480-t-compiler/wg-diagnostics/topic/translation/near/187043759" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> centril <a href="https://zulip-archive.rust-lang.org/stream/147480-t-compiler/wg-diagnostics/topic/translation.html#187043759">(Jan 30 2020 at 23:43)</a>:</h4>
<p><span class="user-mention" data-user-id="132040">@Manish Goregaokar</span>  I suspect the error descriptions are the most readily translatable asset we have</p>



<a name="187043764"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/147480-t-compiler/wg-diagnostics/topic/translation/near/187043764" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> centril <a href="https://zulip-archive.rust-lang.org/stream/147480-t-compiler/wg-diagnostics/topic/translation.html#187043764">(Jan 30 2020 at 23:43)</a>:</h4>
<p>since it's so simple</p>



<a name="187043783"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/147480-t-compiler/wg-diagnostics/topic/translation/near/187043783" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Manish Goregaokar <a href="https://zulip-archive.rust-lang.org/stream/147480-t-compiler/wg-diagnostics/topic/translation.html#187043783">(Jan 30 2020 at 23:43)</a>:</h4>
<p>Yes those are the easiest</p>



<a name="187043786"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/147480-t-compiler/wg-diagnostics/topic/translation/near/187043786" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> centril <a href="https://zulip-archive.rust-lang.org/stream/147480-t-compiler/wg-diagnostics/topic/translation.html#187043786">(Jan 30 2020 at 23:43)</a>:</h4>
<p>basically you need to swap out a string for another string</p>



<a name="187043790"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/147480-t-compiler/wg-diagnostics/topic/translation/near/187043790" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Manish Goregaokar <a href="https://zulip-archive.rust-lang.org/stream/147480-t-compiler/wg-diagnostics/topic/translation.html#187043790">(Jan 30 2020 at 23:43)</a>:</h4>
<p>I actually started doing them at one point lol and then left it</p>



<a name="187043832"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/147480-t-compiler/wg-diagnostics/topic/translation/near/187043832" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Manish Goregaokar <a href="https://zulip-archive.rust-lang.org/stream/147480-t-compiler/wg-diagnostics/topic/translation.html#187043832">(Jan 30 2020 at 23:44)</a>:</h4>
<p>It's not hard tbh</p>



<a name="187043848"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/147480-t-compiler/wg-diagnostics/topic/translation/near/187043848" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Manish Goregaokar <a href="https://zulip-archive.rust-lang.org/stream/147480-t-compiler/wg-diagnostics/topic/translation.html#187043848">(Jan 30 2020 at 23:44)</a>:</h4>
<p>Like if you want me to jot down a full plan in an issue I can</p>



<a name="187043850"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/147480-t-compiler/wg-diagnostics/topic/translation/near/187043850" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> centril <a href="https://zulip-archive.rust-lang.org/stream/147480-t-compiler/wg-diagnostics/topic/translation.html#187043850">(Jan 30 2020 at 23:44)</a>:</h4>
<p>yea; if we setup some infra I bet people will come and do it</p>



<a name="187043863"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/147480-t-compiler/wg-diagnostics/topic/translation/near/187043863" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Manish Goregaokar <a href="https://zulip-archive.rust-lang.org/stream/147480-t-compiler/wg-diagnostics/topic/translation.html#187043863">(Jan 30 2020 at 23:44)</a>:</h4>
<p>there's a bunch of initial work that needs to be done</p>



<a name="187043885"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/147480-t-compiler/wg-diagnostics/topic/translation/near/187043885" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> centril <a href="https://zulip-archive.rust-lang.org/stream/147480-t-compiler/wg-diagnostics/topic/translation.html#187043885">(Jan 30 2020 at 23:45)</a>:</h4>
<p><span class="user-mention" data-user-id="132040">@Manish Goregaokar</span> in rustup?</p>



<a name="187043903"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/147480-t-compiler/wg-diagnostics/topic/translation/near/187043903" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Manish Goregaokar <a href="https://zulip-archive.rust-lang.org/stream/147480-t-compiler/wg-diagnostics/topic/translation.html#187043903">(Jan 30 2020 at 23:45)</a>:</h4>
<p>Okay one question: presumably y'all still want to write these as MD files yes? So we should be generating the English json files via some step which Pontoon can then consume</p>



<a name="187043912"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/147480-t-compiler/wg-diagnostics/topic/translation/near/187043912" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Manish Goregaokar <a href="https://zulip-archive.rust-lang.org/stream/147480-t-compiler/wg-diagnostics/topic/translation.html#187043912">(Jan 30 2020 at 23:45)</a>:</h4>
<p><span class="user-mention" data-user-id="126931">@centril</span> also in rustc so it knows how to load these etc</p>



<a name="187043991"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/147480-t-compiler/wg-diagnostics/topic/translation/near/187043991" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Manish Goregaokar <a href="https://zulip-archive.rust-lang.org/stream/147480-t-compiler/wg-diagnostics/topic/translation.html#187043991">(Jan 30 2020 at 23:46)</a>:</h4>
<p>For all of this there are two options: forcing rustc users to write things in the json/whatever format, or using what we use today and having an autogenrtation step</p>



<a name="187043992"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/147480-t-compiler/wg-diagnostics/topic/translation/near/187043992" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> centril <a href="https://zulip-archive.rust-lang.org/stream/147480-t-compiler/wg-diagnostics/topic/translation.html#187043992">(Jan 30 2020 at 23:46)</a>:</h4>
<p>MD files is a pretty new (but nice!) thing -- they used to be hard-coded strings in the <code>errors.rs</code> files</p>



<a name="187043996"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/147480-t-compiler/wg-diagnostics/topic/translation/near/187043996" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Manish Goregaokar <a href="https://zulip-archive.rust-lang.org/stream/147480-t-compiler/wg-diagnostics/topic/translation.html#187043996">(Jan 30 2020 at 23:46)</a>:</h4>
<p>Both work, it's up to y'all</p>



<a name="187044003"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/147480-t-compiler/wg-diagnostics/topic/translation/near/187044003" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Manish Goregaokar <a href="https://zulip-archive.rust-lang.org/stream/147480-t-compiler/wg-diagnostics/topic/translation.html#187044003">(Jan 30 2020 at 23:46)</a>:</h4>
<p>I know! I wrote half of them :)</p>



<a name="187044010"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/147480-t-compiler/wg-diagnostics/topic/translation/near/187044010" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> centril <a href="https://zulip-archive.rust-lang.org/stream/147480-t-compiler/wg-diagnostics/topic/translation.html#187044010">(Jan 30 2020 at 23:46)</a>:</h4>
<p>:D</p>



<a name="187044025"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/147480-t-compiler/wg-diagnostics/topic/translation/near/187044025" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> centril <a href="https://zulip-archive.rust-lang.org/stream/147480-t-compiler/wg-diagnostics/topic/translation.html#187044025">(Jan 30 2020 at 23:47)</a>:</h4>
<blockquote>
<p>also in rustc so it knows how to load these etc</p>
</blockquote>
<p><span class="user-mention" data-user-id="132040">@Manish Goregaokar</span>  could we start with a dumb <code>-Z</code> flag perhaps?</p>



<a name="187044046"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/147480-t-compiler/wg-diagnostics/topic/translation/near/187044046" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> centril <a href="https://zulip-archive.rust-lang.org/stream/147480-t-compiler/wg-diagnostics/topic/translation.html#187044046">(Jan 30 2020 at 23:47)</a>:</h4>
<p>and no rustup support initially</p>



<a name="187044049"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/147480-t-compiler/wg-diagnostics/topic/translation/near/187044049" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Manish Goregaokar <a href="https://zulip-archive.rust-lang.org/stream/147480-t-compiler/wg-diagnostics/topic/translation.html#187044049">(Jan 30 2020 at 23:47)</a>:</h4>
<p>Yes</p>



<a name="187044072"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/147480-t-compiler/wg-diagnostics/topic/translation/near/187044072" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Manish Goregaokar <a href="https://zulip-archive.rust-lang.org/stream/147480-t-compiler/wg-diagnostics/topic/translation.html#187044072">(Jan 30 2020 at 23:47)</a>:</h4>
<p>If y'all want I can file a bunch of concrete issues</p>



<a name="187044114"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/147480-t-compiler/wg-diagnostics/topic/translation/near/187044114" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Manish Goregaokar <a href="https://zulip-archive.rust-lang.org/stream/147480-t-compiler/wg-diagnostics/topic/translation.html#187044114">(Jan 30 2020 at 23:48)</a>:</h4>
<p>And a meta issue and a plan or whatever</p>



<a name="187044120"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/147480-t-compiler/wg-diagnostics/topic/translation/near/187044120" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> centril <a href="https://zulip-archive.rust-lang.org/stream/147480-t-compiler/wg-diagnostics/topic/translation.html#187044120">(Jan 30 2020 at 23:48)</a>:</h4>
<p>sounds helpful <span aria-label="heart" class="emoji emoji-2764" role="img" title="heart">:heart:</span></p>



<a name="187044127"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/147480-t-compiler/wg-diagnostics/topic/translation/near/187044127" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Manish Goregaokar <a href="https://zulip-archive.rust-lang.org/stream/147480-t-compiler/wg-diagnostics/topic/translation.html#187044127">(Jan 30 2020 at 23:48)</a>:</h4>
<p>Don't have bandwidth to do this myself but I can watch and help</p>



<a name="187044135"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/147480-t-compiler/wg-diagnostics/topic/translation/near/187044135" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Manish Goregaokar <a href="https://zulip-archive.rust-lang.org/stream/147480-t-compiler/wg-diagnostics/topic/translation.html#187044135">(Jan 30 2020 at 23:48)</a>:</h4>
<p>I was mostly waiting for diagnostics derive to happen first</p>



<a name="187044199"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/147480-t-compiler/wg-diagnostics/topic/translation/near/187044199" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Manish Goregaokar <a href="https://zulip-archive.rust-lang.org/stream/147480-t-compiler/wg-diagnostics/topic/translation.html#187044199">(Jan 30 2020 at 23:49)</a>:</h4>
<p>For short diagnostics we may not be able to have a sensible generation step and diagnostics writers may need to write text for the diagnostic in a file fwiw</p>



<a name="187044275"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/147480-t-compiler/wg-diagnostics/topic/translation/near/187044275" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Manish Goregaokar <a href="https://zulip-archive.rust-lang.org/stream/147480-t-compiler/wg-diagnostics/topic/translation.html#187044275">(Jan 30 2020 at 23:50)</a>:</h4>
<p>But maybe not</p>



<a name="187044295"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/147480-t-compiler/wg-diagnostics/topic/translation/near/187044295" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> centril <a href="https://zulip-archive.rust-lang.org/stream/147480-t-compiler/wg-diagnostics/topic/translation.html#187044295">(Jan 30 2020 at 23:51)</a>:</h4>
<p>maybe we can hard-code the English strings in the struct to make the diagnostics dev UX less "jumpy"</p>



<a name="187044300"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/147480-t-compiler/wg-diagnostics/topic/translation/near/187044300" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> centril <a href="https://zulip-archive.rust-lang.org/stream/147480-t-compiler/wg-diagnostics/topic/translation.html#187044300">(Jan 30 2020 at 23:51)</a>:</h4>
<p>also to facilitate the move</p>



<a name="187044396"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/147480-t-compiler/wg-diagnostics/topic/translation/near/187044396" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Manish Goregaokar <a href="https://zulip-archive.rust-lang.org/stream/147480-t-compiler/wg-diagnostics/topic/translation.html#187044396">(Jan 30 2020 at 23:52)</a>:</h4>
<p><span class="user-mention" data-user-id="126931">@centril</span> we can hardcode provided there's a way to extract it in a structured format, which is trickier for structs</p>



<a name="187044411"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/147480-t-compiler/wg-diagnostics/topic/translation/near/187044411" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Manish Goregaokar <a href="https://zulip-archive.rust-lang.org/stream/147480-t-compiler/wg-diagnostics/topic/translation.html#187044411">(Jan 30 2020 at 23:52)</a>:</h4>
<p>That said it's possible to just use a basic parse script for this. Annoying</p>



<a name="276138582"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/147480-t-compiler/wg-diagnostics/topic/translation/near/276138582" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> davidtwco <a href="https://zulip-archive.rust-lang.org/stream/147480-t-compiler/wg-diagnostics/topic/translation.html#276138582">(Mar 22 2022 at 03:00)</a>:</h4>
<p><span class="user-mention" data-user-id="119031">@Esteban Küber</span> <span class="user-mention" data-user-id="124288">@oli</span> <span class="user-mention" data-user-id="132040">@Manish Goregaokar</span> I'm interested in implementing diagnostic translation and pushing forward with any prerequisite work that needs to be done for that (e.g. more development on the diagnostics derive, or getting it used more widely, etc.). </p>
<p>I've read as much of the previous discussion about this as I've been able to find here on Zulip and on internals and using Fluent as <span class="user-mention silent" data-user-id="132040">Manish Goregaokar</span>  has suggested seems like the right approach and I'd be happy to work on it - myself or in collaboration with <span class="user-mention silent" data-user-id="132040">Manish Goregaokar</span> (if you're still interested in doing implementation and have the bandwidth).</p>
<p>I'm pretty sure our current status is that we have no translation and we've got a diagnostics-derive that's used in one or two diagnostics, but I haven't really kept up with whether we're still looking to go down a diagnostics-derive route (not seen much recent discussion about longer-term plans for diagnostic infrastructure).</p>



<a name="276138630"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/147480-t-compiler/wg-diagnostics/topic/translation/near/276138630" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Manish Goregaokar <a href="https://zulip-archive.rust-lang.org/stream/147480-t-compiler/wg-diagnostics/topic/translation.html#276138630">(Mar 22 2022 at 03:01)</a>:</h4>
<p>I don't have time to work on this but I can provide guidance</p>



<a name="276138652"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/147480-t-compiler/wg-diagnostics/topic/translation/near/276138652" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Manish Goregaokar <a href="https://zulip-archive.rust-lang.org/stream/147480-t-compiler/wg-diagnostics/topic/translation.html#276138652">(Mar 22 2022 at 03:01)</a>:</h4>
<p>I think yes, the plan is that everything switches to the diagnostics derive, which is then augmented to allow its strings to be Fluent strings</p>



<a name="276138672"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/147480-t-compiler/wg-diagnostics/topic/translation/near/276138672" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Esteban Küber <a href="https://zulip-archive.rust-lang.org/stream/147480-t-compiler/wg-diagnostics/topic/translation.html#276138672">(Mar 22 2022 at 03:02)</a>:</h4>
<p>I would love to see this done but am super time constrained at this time. I can help with reviews, of course.</p>



<a name="276138737"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/147480-t-compiler/wg-diagnostics/topic/translation/near/276138737" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Esteban Küber <a href="https://zulip-archive.rust-lang.org/stream/147480-t-compiler/wg-diagnostics/topic/translation.html#276138737">(Mar 22 2022 at 03:03)</a>:</h4>
<p>Would it be necessary to have the derives in place? Or just harder until then?</p>



<a name="276139457"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/147480-t-compiler/wg-diagnostics/topic/translation/near/276139457" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> davidtwco <a href="https://zulip-archive.rust-lang.org/stream/147480-t-compiler/wg-diagnostics/topic/translation.html#276139457">(Mar 22 2022 at 03:19)</a>:</h4>
<p><span class="user-mention silent" data-user-id="119031">Esteban Küber</span> <a href="#narrow/stream/147480-t-compiler.2Fwg-diagnostics/topic/translation/near/276138737">said</a>:</p>
<blockquote>
<p>Would it be necessary to have the derives in place? Or just harder until then?</p>
</blockquote>
<p>Based on my what little I've read about Fluent and how we'd want to structure our diagnostic messages to work with it: I think it could be possible to stick with something like the current diagnostic API and replace the current message strings with corresponding identifiers (e.g. "lifetime doesn't live long enough" -&gt; <code>diag::lifetime_does_not_live_long_enough</code>). Each of these would map to Fluent identifiers.</p>
<p>I think the primary difficulty would just be providing a way to give the additional information that would normally be string interpolation - type names, names for language concepts ("this function/struct/enum is..") or whether something is plural, etc. I can think of some ways to do this so I don't think it would be a problem. Some diagnostics are going to be easier than others depending on how incrementally we build up a error message but that was always going to be a issue.</p>
<p>I think the derive makes parts of that a little easier just because the struct fields are basically bundling all that additional information together by default. But I wouldn't be surprised if the derive could be <em>more</em> work because it's a lot more refactoring of where we emit diagnostics and the structure of that code, but I don't mind doing it if it's what we want for diagnostics longer-term anyway (i.e. there are other additional benefits we could derive from it (pun intended)).</p>



<a name="276143622"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/147480-t-compiler/wg-diagnostics/topic/translation/near/276143622" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Esteban Küber <a href="https://zulip-archive.rust-lang.org/stream/147480-t-compiler/wg-diagnostics/topic/translation.html#276143622">(Mar 22 2022 at 04:53)</a>:</h4>
<p>One thing that will be more painful is that we will have to expand the code for every pluralization combination, being way more explicit than we are now.</p>



<a name="276145321"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/147480-t-compiler/wg-diagnostics/topic/translation/near/276145321" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> davidtwco <a href="https://zulip-archive.rust-lang.org/stream/147480-t-compiler/wg-diagnostics/topic/translation.html#276145321">(Mar 22 2022 at 05:30)</a>:</h4>
<p>I'm not sure what you mean by expand the code - I expect that pluralization would look something like computing a <code>numberOfElements</code> variable (or whatever makes sense in the context) and that being provided as one of the "variables" to the diagnostic, so that some Fluent like that below would work?</p>
<div class="codehilite" data-code-language="fluent"><pre><span></span><code>enum-variant-suggestion-note =
    there is an enum variant {$suggestionVariant}{$otherVariantCount -&gt;
        [one] and one other
       *[other] and {$otherVariantCount} others
    }
</code></pre></div>
<p>I think we'd do less handling of plurals in the compiler than we do now, I think we'd more often just be providing a count or something like that to Fluent and it would do that part?</p>



<a name="276146416"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/147480-t-compiler/wg-diagnostics/topic/translation/near/276146416" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> oli <a href="https://zulip-archive.rust-lang.org/stream/147480-t-compiler/wg-diagnostics/topic/translation.html#276146416">(Mar 22 2022 at 05:55)</a>:</h4>
<p>I think we should indeed focus on the derives. Expanding the usage of those derives only after we have translation set up.</p>



<a name="276146637"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/147480-t-compiler/wg-diagnostics/topic/translation/near/276146637" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> oli <a href="https://zulip-archive.rust-lang.org/stream/147480-t-compiler/wg-diagnostics/topic/translation.html#276146637">(Mar 22 2022 at 06:00)</a>:</h4>
<p>We can punt on json formats and rustc interface discussions by just letting you do whatever you feel works and a -Z flag as suggested earlier in the thread</p>



<a name="276146720"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/147480-t-compiler/wg-diagnostics/topic/translation/near/276146720" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> oli <a href="https://zulip-archive.rust-lang.org/stream/147480-t-compiler/wg-diagnostics/topic/translation.html#276146720">(Mar 22 2022 at 06:00)</a>:</h4>
<p>If you can make use of existing data formats that some tools are capable of processing, that would be helpful tho</p>



<a name="276146788"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/147480-t-compiler/wg-diagnostics/topic/translation/near/276146788" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> oli <a href="https://zulip-archive.rust-lang.org/stream/147480-t-compiler/wg-diagnostics/topic/translation.html#276146788">(Mar 22 2022 at 06:02)</a>:</h4>
<p>Also maybe step 0 would be to write a -Z flag that dumps all diagnostic structs' information in a way that existing tools can use</p>



<a name="276147152"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/147480-t-compiler/wg-diagnostics/topic/translation/near/276147152" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> davidtwco <a href="https://zulip-archive.rust-lang.org/stream/147480-t-compiler/wg-diagnostics/topic/translation.html#276147152">(Mar 22 2022 at 06:09)</a>:</h4>
<p>Alright, I'll do some experimentation on implementing translation as part of the derive machinery and see what that ends up looking like and we can discuss from there.</p>



<a name="276211353"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/147480-t-compiler/wg-diagnostics/topic/translation/near/276211353" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Manish Goregaokar <a href="https://zulip-archive.rust-lang.org/stream/147480-t-compiler/wg-diagnostics/topic/translation.html#276211353">(Mar 22 2022 at 15:59)</a>:</h4>
<p><span class="user-mention" data-user-id="119031">@Esteban Küber</span> i think the derives give us the structure we need anyway</p>



<a name="276211392"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/147480-t-compiler/wg-diagnostics/topic/translation/near/276211392" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Manish Goregaokar <a href="https://zulip-archive.rust-lang.org/stream/147480-t-compiler/wg-diagnostics/topic/translation.html#276211392">(Mar 22 2022 at 15:59)</a>:</h4>
<p>like, the work of splitting it into strings with inputs is needed there anyway</p>



<a name="276217062"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/147480-t-compiler/wg-diagnostics/topic/translation/near/276217062" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Esteban Küber <a href="https://zulip-archive.rust-lang.org/stream/147480-t-compiler/wg-diagnostics/topic/translation.html#276217062">(Mar 22 2022 at 16:34)</a>:</h4>
<p>Fair</p>



<a name="276718206"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/147480-t-compiler/wg-diagnostics/topic/translation/near/276718206" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> davidtwco <a href="https://zulip-archive.rust-lang.org/stream/147480-t-compiler/wg-diagnostics/topic/translation.html#276718206">(Mar 26 2022 at 10:21)</a>:</h4>
<p><strong>Progress update:</strong> </p>
<p>In my local changes: all of the diagnostic APIs can now take a identifier for a Fluent message instead of just a error message, and if they do so, then that will go through Fluent translation (mapping it to the actual string from the Fluent resource). I always load the English Fluent resource and that acts as a fallback if the user doesn't provide a preferred locale. That means that we can have partially complete translations and we'll fallback on English when we are missing a message. I haven't provided a mechanism for the user to provide a preferred locale and for the compiler to load that yet, so it just always uses the fallback right now (i.e. the same output as we currently have). </p>
<p>I have to modify the normal diagnostic API in order to change the diagnostic derive because it just generates calls to the normal API, so it has to be able to understand translatable diagnostics in some way. I've added a concept of "args" to a diagnostic, which will be how we'll provide the variables to Fluent that would normally be interpolated. I intend for the fields of the struct to just all be provided as arguments by default, which should make the diagnostic derive quite ergonomic.</p>
<p>So, this is roughly what we'd have right now:</p>
<div class="codehilite" data-code-language="Rust"><pre><span></span><code><span class="cp">#[derive(SessionDiagnostic)]</span><span class="w"></span>
<span class="cp">#[error = </span><span class="s">"E0062"</span><span class="cp">]</span><span class="w"></span>
<span class="k">struct</span> <span class="nc">FieldMultiplySpecifiedInInitializer</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="cp">#[message = </span><span class="s">"field `{ident}` specified more than once"</span><span class="cp">]</span><span class="w"></span>
<span class="w">    </span><span class="cp">#[label = </span><span class="s">"used more than once"</span><span class="cp">]</span><span class="w"></span>
<span class="w">    </span><span class="k">pub</span><span class="w"> </span><span class="n">span</span>: <span class="nc">Span</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="cp">#[label = </span><span class="s">"first use of `{ident}`"</span><span class="cp">]</span><span class="w"></span>
<span class="w">    </span><span class="k">pub</span><span class="w"> </span><span class="n">prev_span</span>: <span class="nc">Span</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="k">pub</span><span class="w"> </span><span class="n">ident</span>: <span class="nc">Ident</span><span class="p">,</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>
</code></pre></div>
<p>which translates to..</p>
<div class="codehilite" data-code-language="Rust"><pre><span></span><code><span class="kd">let</span><span class="w"> </span><span class="n">ident</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">..</span><span class="p">;</span><span class="w"></span>
<span class="n">struct_span_err</span><span class="o">!</span><span class="p">(</span><span class="n">sess</span><span class="p">,</span><span class="w"> </span><span class="n">span</span><span class="p">,</span><span class="w"> </span><span class="n">E0062</span><span class="p">,</span><span class="w"> </span><span class="s">"field `{ident}` specified more than once"</span><span class="p">)</span><span class="w"></span>
<span class="w">    </span><span class="p">.</span><span class="n">span_label</span><span class="p">(</span><span class="n">span</span><span class="p">,</span><span class="w"> </span><span class="s">"used more than once"</span><span class="p">)</span><span class="w"></span>
<span class="w">    </span><span class="p">.</span><span class="n">span_label</span><span class="p">(</span><span class="n">prev_span</span><span class="p">,</span><span class="w"> </span><span class="s">"first use of `{ident}`"</span><span class="p">)</span><span class="w"></span>
</code></pre></div>
<p>And what we'd end up with is:</p>
<div class="codehilite" data-code-language="Rust"><pre><span></span><code><span class="cp">#[derive(SessionDiagnostic)]</span><span class="w"></span>
<span class="cp">#[error = </span><span class="s">"E0062"</span><span class="cp">]</span><span class="w"></span>
<span class="cp">#[slug = </span><span class="s">"typeck-field-multiply-specified-in-initializer"</span><span class="cp">]</span><span class="w"></span>
<span class="k">struct</span> <span class="nc">FieldMultiplySpecifiedInInitializer</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="cp">#[message]</span><span class="w"></span>
<span class="w">    </span><span class="cp">#[label]</span><span class="w"></span>
<span class="w">    </span><span class="k">pub</span><span class="w"> </span><span class="n">span</span>: <span class="nc">Span</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="cp">#[label = </span><span class="s">"previous-use-label"</span><span class="cp">]</span><span class="w"></span>
<span class="w">    </span><span class="k">pub</span><span class="w"> </span><span class="n">prev_span</span>: <span class="nc">Span</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="k">pub</span><span class="w"> </span><span class="n">ident</span>: <span class="nc">Ident</span><span class="p">,</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>
</code></pre></div>
<p>which translates to..</p>
<div class="codehilite" data-code-language="Rust"><pre><span></span><code><span class="kd">let</span><span class="w"> </span><span class="n">ident</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">..</span><span class="p">;</span><span class="w"></span>
<span class="n">struct_span_err</span><span class="o">!</span><span class="p">(</span><span class="n">sess</span><span class="p">,</span><span class="w"> </span><span class="n">span</span><span class="p">,</span><span class="w"> </span><span class="n">E0062</span><span class="p">,</span><span class="w"> </span><span class="n">DiagnosticMessage</span>::<span class="n">fluent</span><span class="p">(</span><span class="s">"typeck-field-multiply-specified-in-initializer"</span><span class="p">))</span><span class="w"></span>
<span class="w">    </span><span class="p">.</span><span class="n">span_label</span><span class="p">(</span><span class="n">span</span><span class="p">,</span><span class="w"> </span><span class="n">DiagnosticMessage</span>::<span class="n">fluent_attr</span><span class="p">(</span><span class="s">"typeck-field-multiply-specified-in-initializer"</span><span class="p">,</span><span class="w"> </span><span class="s">"label"</span><span class="p">))</span><span class="w"></span>
<span class="w">    </span><span class="p">.</span><span class="n">span_label</span><span class="p">(</span><span class="n">prev_span</span><span class="p">,</span><span class="w"> </span><span class="n">DiagnosticMessage</span>::<span class="n">fluent_attr</span><span class="p">(</span><span class="s">"typeck-field-multiply-specified-in-initializer"</span><span class="p">,</span><span class="w"> </span><span class="s">"previous-use-label"</span><span class="p">))</span><span class="w"></span>
<span class="w">    </span><span class="p">.</span><span class="n">arg</span><span class="p">(</span><span class="s">"ident"</span><span class="p">,</span><span class="w"> </span><span class="n">ident</span><span class="p">)</span><span class="w"></span>
</code></pre></div>
<p>with the following Fluent (args like <code>ident</code> are scoped to the individual diagnostic, they don't leak to others):</p>
<div class="codehilite" data-code-language="fluent"><pre><span></span><code>typeck-field-multiply-specified-in-initializer = {$ident} specified more than once
    .label = used more than once
    .previous-use-label = first use of {$ident}
</code></pre></div>
<p>(note, help, suggestion, etc will all be attributes on the primary Fluent message, by default with <code>.note</code>, <code>.help</code>, <code>.suggestion</code> names, but the attribute can give it another name if there are multiple of one kind of subdiagnostic)</p>
<p>This should be sufficient to enable all of the flexibility that translations require and we should be able to simplify some of the APIs that the macro generates once we have only translated diagnostics (<code>DiagnosticMessage</code> is necessary to support both the don't-translate-me and translate-me strings).  We could also add <code>#[no_arg]</code> attributes if we didn't want a field provided to Fluent. If we like it, then I'd probably make this the only way that the diagnostic derive works - you can only implement translatable diagnostics when using the derive.</p>
<p>We've got a lot of errors that don't have codes, I think that's less desirable when there are translations because you want to be able to search for an error in a language-independent way, and the current codes are a bit of a pain to add, so I've been planning to go about this in a way that would make the slugs potential successors to error codes in future if we wanted that.</p>
<p>I haven't actually made changes to the diagnostic derive yet, but that's what I'll work on next. Then I'll add a way to load a Fluent file via <code>-Z</code> flag that I'll use for some tests. That's probably sufficient for landing an initial patch, because then we can start parallelizing the switching to diagnostic derive everywhere if there aren't objections to it. We'll probably end up having some small rework as we learn more about how we need to provide the variables to Fluent for translations to work, but I suspect that's inevitable, shouldn't be anything too major. </p>
<p>After all that, I'll start thinking about how we want to ship/load translations so that I can implement that part, and then we can think about setting up infrastructure for doing translations and updating them before releases, etc (in collaboration with the relevant teams, etc - that's a while away anyway).  We'll also need to work out how this affects downstream projects like rustfmt, clippy and rustdoc who use the diagnostic infrastructure of rustc in some places.</p>
<p>If there are other changes to diagnostics (like changes to error codes) that we want to do, then this might be a good opportunity to do them if we're going to try switch to the derive.</p>
<p>I haven't done anything with standard data formats or dumping the diagnostic struct informations because I don't think it's necessary for this, but that's something we can still do in future.</p>



<a name="276719418"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/147480-t-compiler/wg-diagnostics/topic/translation/near/276719418" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> oli <a href="https://zulip-archive.rust-lang.org/stream/147480-t-compiler/wg-diagnostics/topic/translation.html#276719418">(Mar 26 2022 at 10:51)</a>:</h4>
<p>There are a lot of errors without error codes. There was some previous discussion on replacing error codes with stringly names like your slugs. Maybe for fluent we should just ignore error codes entirely and instead document the slug together with the error code?</p>



<a name="276719467"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/147480-t-compiler/wg-diagnostics/topic/translation/near/276719467" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> oli <a href="https://zulip-archive.rust-lang.org/stream/147480-t-compiler/wg-diagnostics/topic/translation.html#276719467">(Mar 26 2022 at 10:52)</a>:</h4>
<p>On the derive part, you could generate the slug from the struct name, as it seems like those will be very redundant in a lot of cases</p>



<a name="276719650"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/147480-t-compiler/wg-diagnostics/topic/translation/near/276719650" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> oli <a href="https://zulip-archive.rust-lang.org/stream/147480-t-compiler/wg-diagnostics/topic/translation.html#276719650">(Mar 26 2022 at 10:57)</a>:</h4>
<p>There are a lot of diagnostics API calls, can we do your changes in a way that allow incremental introduction? Or did you make it generic to just keep accepting the previous calls?</p>



<a name="276722679"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/147480-t-compiler/wg-diagnostics/topic/translation/near/276722679" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> davidtwco <a href="https://zulip-archive.rust-lang.org/stream/147480-t-compiler/wg-diagnostics/topic/translation.html#276722679">(Mar 26 2022 at 12:03)</a>:</h4>
<p>I was aware of the previous discussion about error slugs, I think that makes sense as an approach, so could do a switch to slugs at the same time as doing translation if we wanted and we could also generate the slugs from the type names (though we probably want a prefix like <code>typeck</code> or <code>borrowck</code>). </p>
<p>I accept all previous calls right now, nothing has changed for existing diagnostics. We could add translation to them one-by-one right now by rewriting them like in the example above or by changing them to the diagnostic derive (once I’ve made the necessary changes to the derive). My expectation has been that we’ll do it incrementally using the derive.</p>



<a name="276722772"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/147480-t-compiler/wg-diagnostics/topic/translation/near/276722772" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> davidtwco <a href="https://zulip-archive.rust-lang.org/stream/147480-t-compiler/wg-diagnostics/topic/translation.html#276722772">(Mar 26 2022 at 12:05)</a>:</h4>
<p>I haven’t tried to make the API ergonomic for Fluent diagnostics because a) that’s harder to do while keeping all existing diagnostic calls working and b) I assumed we’d be generating them from the derive primarily anyway.</p>



<a name="276799325"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/147480-t-compiler/wg-diagnostics/topic/translation/near/276799325" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Manish Goregaokar <a href="https://zulip-archive.rust-lang.org/stream/147480-t-compiler/wg-diagnostics/topic/translation.html#276799325">(Mar 27 2022 at 17:49)</a>:</h4>
<p><span class="user-mention" data-user-id="116107">@davidtwco</span> amazing! Do you think it is good to require people to name their attrs manually or do you think we can get away with <code>typeck-field-multiply-blah.span.message, .span.label, .prev_span.label</code> (etc). I prefer what you have now (explicit names are good, they represent a stability contract with the fluent files). but worth calling out</p>
<p>and yeah, as <span class="user-mention" data-user-id="124288">@oli</span> said i think we want to eventually have stringy slug names; and I agree with his suggestion: ignore the codes; use stringy slug names, as if we were working in the awesome new world of stringy codes. At _some point_ we do a pass over the stringy codes and make sure they have good names, and cut over to them (with some JS in the error index that performs redirects).</p>



<a name="276799337"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/147480-t-compiler/wg-diagnostics/topic/translation/near/276799337" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Manish Goregaokar <a href="https://zulip-archive.rust-lang.org/stream/147480-t-compiler/wg-diagnostics/topic/translation.html#276799337">(Mar 27 2022 at 17:49)</a>:</h4>
<p><span class="user-mention" data-user-id="116107">@davidtwco</span> As far as ergonomics are concerned I think it's okay to declare that Fluent diagnostics _must_ use the derive, and we can see what edge cases pop up.</p>



<a name="276799453"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/147480-t-compiler/wg-diagnostics/topic/translation/near/276799453" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Manish Goregaokar <a href="https://zulip-archive.rust-lang.org/stream/147480-t-compiler/wg-diagnostics/topic/translation.html#276799453">(Mar 27 2022 at 17:52)</a>:</h4>
<p>Oh, also, as far as the actual mechanism of translation/etc, I suggest we have a separate repo that is linked to <a href="http://pontoon.rust-lang.org">pontoon.rust-lang.org</a>, and that repo contains the translated stuff, which rust-lang/rust subtrees, and we perform periodic syncs. Pontoon likes to make commits directly so it may not be great to work off of rust-lang/rust, though I suppose we could have it commit to a branch.</p>
<p>From the technical side all we need to make this work is having English .ftl files in a folder somewhere.</p>
<p>We'd have to build more robust translation teams though. The website teams are smallish and harder to contact, I suspect we may need to make a separate zulip for translators so we can have language channels and a way to contact them when there's new stuff to be translated</p>



<a name="276799557"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/147480-t-compiler/wg-diagnostics/topic/translation/near/276799557" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Manish Goregaokar <a href="https://zulip-archive.rust-lang.org/stream/147480-t-compiler/wg-diagnostics/topic/translation.html#276799557">(Mar 27 2022 at 17:54)</a>:</h4>
<p>We'll likely have to resurrect the l10n team under community to manage translators</p>



<a name="276799581"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/147480-t-compiler/wg-diagnostics/topic/translation/near/276799581" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Manish Goregaokar <a href="https://zulip-archive.rust-lang.org/stream/147480-t-compiler/wg-diagnostics/topic/translation.html#276799581">(Mar 27 2022 at 17:55)</a>:</h4>
<p>For _distribution_ folks will have to figure stuff out. We probably can just ship all the FTL files bundled into source if we want.</p>



<a name="276818606"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/147480-t-compiler/wg-diagnostics/topic/translation/near/276818606" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> davidtwco <a href="https://zulip-archive.rust-lang.org/stream/147480-t-compiler/wg-diagnostics/topic/translation.html#276818606">(Mar 28 2022 at 01:36)</a>:</h4>
<p><span class="user-mention silent" data-user-id="132040">Manish Goregaokar</span> <a href="#narrow/stream/147480-t-compiler.2Fwg-diagnostics/topic/translation/near/276799325">said</a>:</p>
<blockquote>
<p><span class="user-mention silent" data-user-id="116107">davidtwco</span> amazing! Do you think it is good to require people to name their attrs manually or do you think we can get away with <code>typeck-field-multiply-blah.span.message, .span.label, .prev_span.label</code> (etc). I prefer what you have now (explicit names are good, they represent a stability contract with the fluent files). but worth calling out</p>
</blockquote>
<p>I like having default Fluent attributes (<code>.label</code>, <code>.note</code>, <code>.help</code>, <code>.suggestion</code>) that map to derive attributes (<code>#[label]</code>, <code>#[note]</code>, <code>#[help]</code>, <code>#[suggestion]</code>) with the ability to provide a different attribute name when multiple subdiagnostics of the same kind are required. We could implement it so that it looks for Fluent attributes of the form <code>{diagnostic-slug}.{span-field-name}.{subdiag-kind}</code> automatically, but it would be a little bit more work and at least right now, having not written any translatable diagnostics with the derive, I think I like having the explicitness a little more.</p>



<a name="276884272"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/147480-t-compiler/wg-diagnostics/topic/translation/near/276884272" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Manish Goregaokar <a href="https://zulip-archive.rust-lang.org/stream/147480-t-compiler/wg-diagnostics/topic/translation.html#276884272">(Mar 28 2022 at 14:49)</a>:</h4>
<p><span class="user-mention" data-user-id="116107">@davidtwco</span> sounds good.</p>



<a name="277271882"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/147480-t-compiler/wg-diagnostics/topic/translation/near/277271882" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> davidtwco <a href="https://zulip-archive.rust-lang.org/stream/147480-t-compiler/wg-diagnostics/topic/translation.html#277271882">(Mar 31 2022 at 12:22)</a>:</h4>
<p><a href="https://github.com/rust-lang/rust/pull/95512">https://github.com/rust-lang/rust/pull/95512</a> is a draft pull request with the translation infrastructure</p>



<a name="277271896"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/147480-t-compiler/wg-diagnostics/topic/translation/near/277271896" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> davidtwco <a href="https://zulip-archive.rust-lang.org/stream/147480-t-compiler/wg-diagnostics/topic/translation.html#277271896">(Mar 31 2022 at 12:22)</a>:</h4>
<p>It needs a rebase but it's late and I'm tired so I'll do that tomorrow.</p>



<a name="277553497"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/147480-t-compiler/wg-diagnostics/topic/translation/near/277553497" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Esteban Küber <a href="https://zulip-archive.rust-lang.org/stream/147480-t-compiler/wg-diagnostics/topic/translation.html#277553497">(Apr 02 2022 at 21:46)</a>:</h4>
<p>@davidtwco i need to get back to it but by my preliminary pass lgtm</p>



<a name="277684918"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/147480-t-compiler/wg-diagnostics/topic/translation/near/277684918" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> davidtwco <a href="https://zulip-archive.rust-lang.org/stream/147480-t-compiler/wg-diagnostics/topic/translation.html#277684918">(Apr 04 2022 at 05:52)</a>:</h4>
<p>Opened a dev guide PR to update the page it had on <code>SessionDiagnostic</code>: <a href="https://github.com/rust-lang/rustc-dev-guide/pull/1333">https://github.com/rust-lang/rustc-dev-guide/pull/1333</a></p>



<a name="277684937"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/147480-t-compiler/wg-diagnostics/topic/translation/near/277684937" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> davidtwco <a href="https://zulip-archive.rust-lang.org/stream/147480-t-compiler/wg-diagnostics/topic/translation.html#277684937">(Apr 04 2022 at 05:53)</a>:</h4>
<p>I've not written too much about the best practices on what sorts of information should be in fields so that the diagnostic can actually be translated because I don't have much experience with that first-hand yet, so would appreciate comments along those lines.</p>



<a name="277969681"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/147480-t-compiler/wg-diagnostics/topic/translation/near/277969681" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> davidtwco <a href="https://zulip-archive.rust-lang.org/stream/147480-t-compiler/wg-diagnostics/topic/translation.html#277969681">(Apr 06 2022 at 02:55)</a>:</h4>
<p><a href="https://github.com/rust-lang/rust/issues/95512">#95512</a> has landed, <a href="https://github.com/rust-lang/dev-guide/issues/1333">dev-guide#1333</a> has been updated now following that, going to make a pull request addressing some comments that <span class="user-mention silent" data-user-id="133247">bjorn3</span> made just as the PR was being merged and then I'll probably port some more diagnostics to <code>SessionDiagnostic</code> and see what pain points that runs into.</p>



<hr><p>Last updated: Apr 12 2022 at 20:01 UTC</p>
</html>