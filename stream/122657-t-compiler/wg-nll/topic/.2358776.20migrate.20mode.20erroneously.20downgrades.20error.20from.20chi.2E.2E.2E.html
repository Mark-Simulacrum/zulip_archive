<html>
<head><meta charset="utf-8"><title>#58776 migrate mode erroneously downgrades error from chi... · t-compiler/wg-nll · Zulip Chat Archive</title></head>
<h2>Stream: <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/index.html">t-compiler/wg-nll</a></h2>
<h3>Topic: <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2358776.20migrate.20mode.20erroneously.20downgrades.20error.20from.20chi.2E.2E.2E.html">#58776 migrate mode erroneously downgrades error from chi...</a></h3>

<hr>

<base href="https://rust-lang.zulipchat.com">

<head><link href="https://zulip-archive.rust-lang.org/style.css" rel="stylesheet"></head>

<a name="159507491"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2358776%20migrate%20mode%20erroneously%20downgrades%20error%20from%20chi.../near/159507491" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> lqd <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2358776.20migrate.20mode.20erroneously.20downgrades.20error.20from.20chi.2E.2E.2E.html#159507491">(Feb 27 2019 at 13:00)</a>:</h4>
<p><span class="user-mention" data-user-id="116118">@Matthew Jasper</span> <span class="user-mention" data-user-id="116083">@pnkfelix</span> does <a href="https://play.rust-lang.org/?version=nightly&amp;mode=debug&amp;edition=2018&amp;gist=d6666a9cd8c03eabad45aa37ea4dc4e6" target="_blank" title="https://play.rust-lang.org/?version=nightly&amp;mode=debug&amp;edition=2018&amp;gist=d6666a9cd8c03eabad45aa37ea4dc4e6">this</a> remind you of an existing issue we might have or is this new ? <span class="user-mention" data-user-id="120791">@RalfJ</span> brought it up in <a href="https://github.com/rust-lang/rfcs/pull/2647#issuecomment-467819792" target="_blank" title="https://github.com/rust-lang/rfcs/pull/2647#issuecomment-467819792">another context</a> and the gist is: this UB doesn't build with AST borrowck, nor with NLLs, <em>but</em> migrate mode downgrades the errors to warnings here</p>



<a name="159507823"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2358776%20migrate%20mode%20erroneously%20downgrades%20error%20from%20chi.../near/159507823" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> lqd <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2358776.20migrate.20mode.20erroneously.20downgrades.20error.20from.20chi.2E.2E.2E.html#159507823">(Feb 27 2019 at 13:02)</a>:</h4>
<p>(use the "Build" action thingy on the playground, if it runs, there's likely going to be invalid utf-8 printed, hiding the warnings, because of output like "Execution operation failed: Output was not valid UTF-8: invalid utf-8 sequence of 1 bytes from index 17")</p>



<a name="159507938"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2358776%20migrate%20mode%20erroneously%20downgrades%20error%20from%20chi.../near/159507938" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> centril <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2358776.20migrate.20mode.20erroneously.20downgrades.20error.20from.20chi.2E.2E.2E.html#159507938">(Feb 27 2019 at 13:03)</a>:</h4>
<p>(you have to try a few times before you get output)</p>



<a name="159507981"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2358776%20migrate%20mode%20erroneously%20downgrades%20error%20from%20chi.../near/159507981" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> lqd <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2358776.20migrate.20mode.20erroneously.20downgrades.20error.20from.20chi.2E.2E.2E.html#159507981">(Feb 27 2019 at 13:03)</a>:</h4>
<p>yeah that's why I mentioned to just build and not run</p>



<a name="159508226"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2358776%20migrate%20mode%20erroneously%20downgrades%20error%20from%20chi.../near/159508226" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> lqd <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2358776.20migrate.20mode.20erroneously.20downgrades.20error.20from.20chi.2E.2E.2E.html#159508226">(Feb 27 2019 at 13:05)</a>:</h4>
<p>(and not segfault the playground or anything :)</p>



<a name="159508318"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2358776%20migrate%20mode%20erroneously%20downgrades%20error%20from%20chi.../near/159508318" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> lqd <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2358776.20migrate.20mode.20erroneously.20downgrades.20error.20from.20chi.2E.2E.2E.html#159508318">(Feb 27 2019 at 13:06)</a>:</h4>
<p>poor shep probably being pinged in the middle of the night about crashes ;)</p>



<a name="159508331"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2358776%20migrate%20mode%20erroneously%20downgrades%20error%20from%20chi.../near/159508331" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Matthew Jasper <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2358776.20migrate.20mode.20erroneously.20downgrades.20error.20from.20chi.2E.2E.2E.html#159508331">(Feb 27 2019 at 13:06)</a>:</h4>
<p>We've had a similar issue in the past, but the fix for it didn't address this case, presumably because we lacked an example.</p>



<a name="159508429"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2358776%20migrate%20mode%20erroneously%20downgrades%20error%20from%20chi.../near/159508429" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> lqd <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2358776.20migrate.20mode.20erroneously.20downgrades.20error.20from.20chi.2E.2E.2E.html#159508429">(Feb 27 2019 at 13:07)</a>:</h4>
<p>definitely feels familiar ya</p>



<a name="159508444"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2358776%20migrate%20mode%20erroneously%20downgrades%20error%20from%20chi.../near/159508444" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Matthew Jasper <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2358776.20migrate.20mode.20erroneously.20downgrades.20error.20from.20chi.2E.2E.2E.html#159508444">(Feb 27 2019 at 13:07)</a>:</h4>
<p>That case was NLL reports an error on the closure and AST reports it on the parent. Here we have it the other way around.</p>



<a name="159508601"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2358776%20migrate%20mode%20erroneously%20downgrades%20error%20from%20chi.../near/159508601" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Matthew Jasper <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2358776.20migrate.20mode.20erroneously.20downgrades.20error.20from.20chi.2E.2E.2E.html#159508601">(Feb 27 2019 at 13:08)</a>:</h4>
<p>You can see the current fix at borrow_check/mod.rs:347</p>



<a name="159508705"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2358776%20migrate%20mode%20erroneously%20downgrades%20error%20from%20chi.../near/159508705" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> lqd <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2358776.20migrate.20mode.20erroneously.20downgrades.20error.20from.20chi.2E.2E.2E.html#159508705">(Feb 27 2019 at 13:09)</a>:</h4>
<p>ah yes</p>



<a name="159508801"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2358776%20migrate%20mode%20erroneously%20downgrades%20error%20from%20chi.../near/159508801" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> lqd <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2358776.20migrate.20mode.20erroneously.20downgrades.20error.20from.20chi.2E.2E.2E.html#159508801">(Feb 27 2019 at 13:10)</a>:</h4>
<p>the old issue being <a href="https://github.com/rust-lang/rust/issues/55492" target="_blank" title="https://github.com/rust-lang/rust/issues/55492">#55492</a></p>



<a name="159509216"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2358776%20migrate%20mode%20erroneously%20downgrades%20error%20from%20chi.../near/159509216" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> lqd <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2358776.20migrate.20mode.20erroneously.20downgrades.20error.20from.20chi.2E.2E.2E.html#159509216">(Feb 27 2019 at 13:13)</a>:</h4>
<p>so I'm guessing we might not have an issue for this yet, maybe Felix knows more. I'll poke at it during lunchbreak, and create the issue if we don't hav one; could be interesting to nominate it for tonight's meeting</p>



<a name="159509930"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2358776%20migrate%20mode%20erroneously%20downgrades%20error%20from%20chi.../near/159509930" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pnkfelix <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2358776.20migrate.20mode.20erroneously.20downgrades.20error.20from.20chi.2E.2E.2E.html#159509930">(Feb 27 2019 at 13:19)</a>:</h4>
<p>I don't think we have any issue filed about this</p>



<a name="159509942"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2358776%20migrate%20mode%20erroneously%20downgrades%20error%20from%20chi.../near/159509942" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pnkfelix <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2358776.20migrate.20mode.20erroneously.20downgrades.20error.20from.20chi.2E.2E.2E.html#159509942">(Feb 27 2019 at 13:19)</a>:</h4>
<p>and it definitely looks worth attacking</p>



<a name="159509952"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2358776%20migrate%20mode%20erroneously%20downgrades%20error%20from%20chi.../near/159509952" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pnkfelix <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2358776.20migrate.20mode.20erroneously.20downgrades.20error.20from.20chi.2E.2E.2E.html#159509952">(Feb 27 2019 at 13:20)</a>:</h4>
<p>well</p>



<a name="159510001"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2358776%20migrate%20mode%20erroneously%20downgrades%20error%20from%20chi.../near/159510001" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pnkfelix <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2358776.20migrate.20mode.20erroneously.20downgrades.20error.20from.20chi.2E.2E.2E.html#159510001">(Feb 27 2019 at 13:20)</a>:</h4>
<p>maybe I'm overstating the priority.</p>



<a name="159510264"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2358776%20migrate%20mode%20erroneously%20downgrades%20error%20from%20chi.../near/159510264" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pnkfelix <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2358776.20migrate.20mode.20erroneously.20downgrades.20error.20from.20chi.2E.2E.2E.html#159510264">(Feb 27 2019 at 13:22)</a>:</h4>
<p>okay and I see that this came from an issue <span class="user-mention" data-user-id="120791">@RalfJ</span> filed, <a href="https://github.com/rust-lang/rust/issues/58776" target="_blank" title="https://github.com/rust-lang/rust/issues/58776">#58776</a></p>



<a name="159510378"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2358776%20migrate%20mode%20erroneously%20downgrades%20error%20from%20chi.../near/159510378" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> lqd <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2358776.20migrate.20mode.20erroneously.20downgrades.20error.20from.20chi.2E.2E.2E.html#159510378">(Feb 27 2019 at 13:23)</a>:</h4>
<p>ah I didn't see ralf had filed it in the meantime</p>



<a name="159510447"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2358776%20migrate%20mode%20erroneously%20downgrades%20error%20from%20chi.../near/159510447" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> lqd <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2358776.20migrate.20mode.20erroneously.20downgrades.20error.20from.20chi.2E.2E.2E.html#159510447">(Feb 27 2019 at 13:23)</a>:</h4>
<p>I started looking at it earlier, sorry for the noise</p>



<a name="159510790"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2358776%20migrate%20mode%20erroneously%20downgrades%20error%20from%20chi.../near/159510790" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pnkfelix <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2358776.20migrate.20mode.20erroneously.20downgrades.20error.20from.20chi.2E.2E.2E.html#159510790">(Feb 27 2019 at 13:26)</a>:</h4>
<p>not noise at all. its good to be aware of this. (We would have discussed it tonight since <span class="user-mention" data-user-id="116118">@Matthew Jasper</span> nominated it, but still)</p>



<a name="159511071"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2358776%20migrate%20mode%20erroneously%20downgrades%20error%20from%20chi.../near/159511071" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Matthew Jasper <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2358776.20migrate.20mode.20erroneously.20downgrades.20error.20from.20chi.2E.2E.2E.html#159511071">(Feb 27 2019 at 13:28)</a>:</h4>
<p>It was nominated by jonas-schievink ( I don't know if they're here).</p>



<a name="159511717"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2358776%20migrate%20mode%20erroneously%20downgrades%20error%20from%20chi.../near/159511717" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pnkfelix <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2358776.20migrate.20mode.20erroneously.20downgrades.20error.20from.20chi.2E.2E.2E.html#159511717">(Feb 27 2019 at 13:32)</a>:</h4>
<p>oh my mistake. but in any case, it implies we should discuss it tonight. <span aria-label="smile" class="emoji emoji-263a" role="img" title="smile">:smile:</span></p>



<a name="159517736"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2358776%20migrate%20mode%20erroneously%20downgrades%20error%20from%20chi.../near/159517736" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> RalfJ <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2358776.20migrate.20mode.20erroneously.20downgrades.20error.20from.20chi.2E.2E.2E.html#159517736">(Feb 27 2019 at 14:16)</a>:</h4>
<blockquote>
<p>this UB doesn't build with AST borrowck, nor with NLLs, but migrate mode downgrades the errors to warnings here</p>
</blockquote>
<p>Hm, when I try <code>feature(nll)</code> playground times out...</p>



<a name="159517870"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2358776%20migrate%20mode%20erroneously%20downgrades%20error%20from%20chi.../near/159517870" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> RalfJ <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2358776.20migrate.20mode.20erroneously.20downgrades.20error.20from.20chi.2E.2E.2E.html#159517870">(Feb 27 2019 at 14:17)</a>:</h4>
<p>ah no it was just slow, never mind</p>



<hr><p>Last updated: Apr 12 2022 at 20:01 UTC</p>
</html>