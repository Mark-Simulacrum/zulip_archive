<html>
<head><meta charset="utf-8"><title>issue-51348-ICE · t-compiler/wg-nll · Zulip Chat Archive</title></head>
<h2>Stream: <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/index.html">t-compiler/wg-nll</a></h2>
<h3>Topic: <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/issue-51348-ICE.html">issue-51348-ICE</a></h3>

<hr>

<base href="https://rust-lang.zulipchat.com">

<head><link href="https://zulip-archive.rust-lang.org/style.css" rel="stylesheet"></head>

<a name="128726562"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/issue-51348-ICE/near/128726562" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/issue-51348-ICE.html#128726562">(Jun 27 2018 at 17:05)</a>:</h4>
<p>So <span class="user-mention" data-user-id="120054">@Jon Gjengset</span> I can certainly reproduce #51348...</p>



<a name="128732648"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/issue-51348-ICE/near/128732648" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jon Gjengset <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/issue-51348-ICE.html#128732648">(Jun 27 2018 at 19:08)</a>:</h4>
<p>I implemented a workaround for the issue, but now I hit another ICE: <a href="https://github.com/rust-lang/rust/issues/51649" target="_blank" title="https://github.com/rust-lang/rust/issues/51649">https://github.com/rust-lang/rust/issues/51649</a></p>



<a name="128732826"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/issue-51348-ICE/near/128732826" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/issue-51348-ICE.html#128732826">(Jun 27 2018 at 19:12)</a>:</h4>
<p>heh, ok, that's another known ICE yes</p>



<a name="128732829"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/issue-51348-ICE/near/128732829" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> lqd <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/issue-51348-ICE.html#128732829">(Jun 27 2018 at 19:12)</a>:</h4>
<p>(I think this is the one hitting bootstrap — and maybe futures but haven't been able to look into that one yet)</p>



<a name="128732880"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/issue-51348-ICE/near/128732880" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/issue-51348-ICE.html#128732880">(Jun 27 2018 at 19:14)</a>:</h4>
<p>yeah</p>



<a name="128732907"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/issue-51348-ICE/near/128732907" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/issue-51348-ICE.html#128732907">(Jun 27 2018 at 19:14)</a>:</h4>
<p>I know the problem</p>



<a name="128732911"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/issue-51348-ICE/near/128732911" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/issue-51348-ICE.html#128732911">(Jun 27 2018 at 19:14)</a>:</h4>
<p>I can work on a fix</p>



<a name="128732917"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/issue-51348-ICE/near/128732917" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/issue-51348-ICE.html#128732917">(Jun 27 2018 at 19:14)</a>:</h4>
<p>as soon as I satisfy <span class="user-mention" data-user-id="119009">@Eduard-Mihai Burtescu</span>'s many nitpicks :)</p>



<a name="128732924"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/issue-51348-ICE/near/128732924" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/issue-51348-ICE.html#128732924">(Jun 27 2018 at 19:14)</a>:</h4>
<p>kind of have to land the existing PR to fix that one</p>



<a name="128733239"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/issue-51348-ICE/near/128733239" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jon Gjengset <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/issue-51348-ICE.html#128733239">(Jun 27 2018 at 19:22)</a>:</h4>
<p>It looks like that other ICE is even more nefarious. I can reproduce even with a trivial <code>Deref</code> impl: <a href="https://github.com/rust-lang/rust/issues/51649#issuecomment-400799282" target="_blank" title="https://github.com/rust-lang/rust/issues/51649#issuecomment-400799282">https://github.com/rust-lang/rust/issues/51649#issuecomment-400799282</a></p>



<a name="128765328"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/issue-51348-ICE/near/128765328" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/issue-51348-ICE.html#128765328">(Jun 28 2018 at 10:33)</a>:</h4>
<p>ok so the main PR landed</p>



<a name="128765329"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/issue-51348-ICE/near/128765329" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/issue-51348-ICE.html#128765329">(Jun 28 2018 at 10:33)</a>:</h4>
<p>I will try to fix the "other ICE"</p>



<a name="128765331"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/issue-51348-ICE/near/128765331" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/issue-51348-ICE.html#128765331">(Jun 28 2018 at 10:33)</a>:</h4>
<p>but I guess I'm in the wrong thread now =)</p>



<a name="128769842"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/issue-51348-ICE/near/128769842" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/issue-51348-ICE.html#128769842">(Jun 28 2018 at 12:38)</a>:</h4>
<p><span class="user-mention" data-user-id="120054">@Jon Gjengset</span> hmm I cannot reproduce your ICE now... but I fear something is still going wrong, just not ICEing anymore</p>



<a name="128769845"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/issue-51348-ICE/near/128769845" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/issue-51348-ICE.html#128769845">(Jun 28 2018 at 12:38)</a>:</h4>
<p>(it does ICE with nightly)</p>



<a name="128775580"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/issue-51348-ICE/near/128775580" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jon Gjengset <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/issue-51348-ICE.html#128775580">(Jun 28 2018 at 14:44)</a>:</h4>
<p>This is the one that fixes 51348? Great! :D Though now with my workaround it doesn't terribly matter. Only the "other" ICE does.</p>



<a name="128775599"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/issue-51348-ICE/near/128775599" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/issue-51348-ICE.html#128775599">(Jun 28 2018 at 14:45)</a>:</h4>
<p>I forget which ICE is which :)</p>



<a name="128775601"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/issue-51348-ICE/near/128775601" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jon Gjengset <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/issue-51348-ICE.html#128775601">(Jun 28 2018 at 14:45)</a>:</h4>
<p>As for not reproducing on master, I can try today's nightly and see if my full use-case triggers it</p>



<a name="128775609"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/issue-51348-ICE/near/128775609" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jon Gjengset <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/issue-51348-ICE.html#128775609">(Jun 28 2018 at 14:45)</a>:</h4>
<p>51348 is the multi-match with guard</p>



<a name="128775612"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/issue-51348-ICE/near/128775612" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/issue-51348-ICE.html#128775612">(Jun 28 2018 at 14:45)</a>:</h4>
<p>ah, I see, no I was talking about #51649</p>



<hr><p>Last updated: Apr 12 2022 at 20:01 UTC</p>
</html>