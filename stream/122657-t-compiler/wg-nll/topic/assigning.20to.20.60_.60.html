<html>
<head><meta charset="utf-8"><title>assigning to `_` · t-compiler/wg-nll · Zulip Chat Archive</title></head>
<h2>Stream: <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/index.html">t-compiler/wg-nll</a></h2>
<h3>Topic: <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/assigning.20to.20.60_.60.html">assigning to `_`</a></h3>

<hr>

<base href="https://rust-lang.zulipchat.com">

<head><link href="https://zulip-archive.rust-lang.org/style.css" rel="stylesheet"></head>

<a name="271406609"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/assigning%20to%20%60_%60/near/271406609" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> lcnr <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/assigning.20to.20.60_.60.html#271406609">(Feb 10 2022 at 09:38)</a>:</h4>
<p>hey <span aria-label="wave" class="emoji emoji-1f44b" role="img" title="wave">:wave:</span> i am currently stuck while trying to figure out what's going on here:</p>



<a name="271406622"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/assigning%20to%20%60_%60/near/271406622" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> lcnr <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/assigning.20to.20.60_.60.html#271406622">(Feb 10 2022 at 09:39)</a>:</h4>
<p>so, i have 3 functions:</p>



<a name="271406632"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/assigning%20to%20%60_%60/near/271406632" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> lcnr <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/assigning.20to.20.60_.60.html#271406632">(Feb 10 2022 at 09:39)</a>:</h4>
<div class="codehilite" data-code-language="Rust"><pre><span></span><code><span class="k">fn</span> <span class="nf">uwu</span><span class="o">&lt;'</span><span class="na">b</span><span class="o">&gt;</span><span class="p">(</span><span class="n">func</span>: <span class="nc">for</span><span class="o">&lt;'</span><span class="na">a</span><span class="o">&gt;</span><span class="w"> </span><span class="k">fn</span><span class="p">(</span><span class="o">&amp;'</span><span class="na">a</span><span class="w"> </span><span class="p">()))</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="kd">let</span><span class="w"> </span><span class="n">_</span>: <span class="nc">fn</span><span class="p">(</span><span class="o">&amp;'</span><span class="na">b</span><span class="w"> </span><span class="p">())</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">func</span><span class="p">;</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>
</code></pre></div>



<a name="271406649"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/assigning%20to%20%60_%60/near/271406649" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> lcnr <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/assigning.20to.20.60_.60.html#271406649">(Feb 10 2022 at 09:39)</a>:</h4>
<div class="codehilite" data-code-language="Rust"><pre><span></span><code><span class="k">fn</span> <span class="nf">uwu</span><span class="o">&lt;'</span><span class="na">b</span><span class="o">&gt;</span><span class="p">(</span><span class="n">func</span>: <span class="nc">for</span><span class="o">&lt;'</span><span class="na">a</span><span class="o">&gt;</span><span class="w"> </span><span class="k">fn</span><span class="p">(</span><span class="o">&amp;'</span><span class="na">a</span><span class="w"> </span><span class="p">()))</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="kd">let</span><span class="w"> </span><span class="n">_x</span>: <span class="nc">fn</span><span class="p">(</span><span class="o">&amp;'</span><span class="na">b</span><span class="w"> </span><span class="p">())</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">func</span><span class="p">;</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>
</code></pre></div>



<a name="271406724"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/assigning%20to%20%60_%60/near/271406724" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> lcnr <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/assigning.20to.20.60_.60.html#271406724">(Feb 10 2022 at 09:40)</a>:</h4>
<div class="codehilite" data-code-language="Rust"><pre><span></span><code><span class="k">fn</span> <span class="nf">uwu</span><span class="o">&lt;'</span><span class="w"> </span><span class="n">b</span><span class="o">&gt;</span><span class="p">(</span><span class="n">func</span>: <span class="kp">&amp;</span><span class="o">'</span><span class="nb">static</span> <span class="p">())</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="kd">let</span><span class="w"> </span><span class="n">_</span>: <span class="kp">&amp;</span><span class="o">'</span><span class="na">b</span> <span class="p">()</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">func</span><span class="p">;</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>
</code></pre></div>



<a name="271406817"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/assigning%20to%20%60_%60/near/271406817" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> lcnr <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/assigning.20to.20.60_.60.html#271406817">(Feb 10 2022 at 09:40)</a>:</h4>
<p>the, first, with the <code>let _: fn(&amp;'b ()) = func;</code>assignment causes the following error:</p>
<div class="codehilite"><pre><span></span><code>error[E0308]: mismatched types
 --&gt; src/lib.rs:2:12
  |
2 |     let _: fn(&amp;&#39;b ()) = func;
  |            ^^^^^^^^^^ one type is more general than the other
  |
  = note: expected fn pointer `fn(&amp;&#39;b ())`
             found fn pointer `for&lt;&#39;a&gt; fn(&amp;&#39;a ())`
</code></pre></div>



<a name="271406901"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/assigning%20to%20%60_%60/near/271406901" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> lcnr <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/assigning.20to.20.60_.60.html#271406901">(Feb 10 2022 at 09:41)</a>:</h4>
<p>the the other 2 compile</p>



<a name="271407128"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/assigning%20to%20%60_%60/near/271407128" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> lcnr <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/assigning.20to.20.60_.60.html#271407128">(Feb 10 2022 at 09:43)</a>:</h4>
<p>i would expect <code>fn(&amp;'b ()) &lt;: for&lt;'a&gt; fn(&amp;'a ())</code> to hold</p>



<a name="271407299"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/assigning%20to%20%60_%60/near/271407299" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> lcnr <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/assigning.20to.20.60_.60.html#271407299">(Feb 10 2022 at 09:45)</a>:</h4>
<p>this is the mir during nll:</p>
<div class="codehilite" data-code-language="Rust"><pre><span></span><code><span class="c1">// MIR for `uwu` 0 nll</span>

<span class="o">|</span><span class="w"> </span><span class="n">Free</span><span class="w"> </span><span class="n">Region</span><span class="w"> </span><span class="n">Mapping</span><span class="w"></span>
<span class="o">|</span><span class="w"> </span><span class="o">'</span><span class="nb">_</span>#<span class="mi">0</span><span class="n">r</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="n">Global</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="p">[</span><span class="o">'</span><span class="nb">_</span>#<span class="mi">0</span><span class="n">r</span><span class="p">,</span><span class="w"> </span><span class="o">'</span><span class="nb">_</span>#<span class="mi">2</span><span class="n">r</span><span class="p">,</span><span class="w"> </span><span class="o">'</span><span class="nb">_</span>#<span class="mi">1</span><span class="n">r</span><span class="p">]</span><span class="w"></span>
<span class="o">|</span><span class="w"> </span><span class="o">'</span><span class="nb">_</span>#<span class="mi">1</span><span class="n">r</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="n">Local</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="p">[</span><span class="o">'</span><span class="nb">_</span>#<span class="mi">2</span><span class="n">r</span><span class="p">,</span><span class="w"> </span><span class="o">'</span><span class="nb">_</span>#<span class="mi">1</span><span class="n">r</span><span class="p">]</span><span class="w"></span>
<span class="o">|</span><span class="w"> </span><span class="o">'</span><span class="nb">_</span>#<span class="mi">2</span><span class="n">r</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="n">Local</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="p">[</span><span class="o">'</span><span class="nb">_</span>#<span class="mi">2</span><span class="n">r</span><span class="p">]</span><span class="w"></span>
<span class="o">|</span><span class="w"></span>
<span class="o">|</span><span class="w"> </span><span class="n">Inferred</span><span class="w"> </span><span class="n">Region</span><span class="w"> </span><span class="n">Values</span><span class="w"></span>
<span class="o">|</span><span class="w"> </span><span class="o">'</span><span class="nb">_</span>#<span class="mi">0</span><span class="n">r</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="n">U0</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="p">{</span><span class="n">bb0</span><span class="p">[</span><span class="mi">0</span><span class="o">..=</span><span class="mi">2</span><span class="p">],</span><span class="w"> </span><span class="o">'</span><span class="nb">_</span>#<span class="mi">0</span><span class="n">r</span><span class="p">,</span><span class="w"> </span><span class="o">'</span><span class="nb">_</span>#<span class="mi">1</span><span class="n">r</span><span class="p">,</span><span class="w"> </span><span class="o">'</span><span class="nb">_</span>#<span class="mi">2</span><span class="n">r</span><span class="p">}</span><span class="w"></span>
<span class="o">|</span><span class="w"> </span><span class="o">'</span><span class="nb">_</span>#<span class="mi">1</span><span class="n">r</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="n">U0</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="p">{</span><span class="n">bb0</span><span class="p">[</span><span class="mi">0</span><span class="o">..=</span><span class="mi">2</span><span class="p">],</span><span class="w"> </span><span class="o">'</span><span class="nb">_</span>#<span class="mi">1</span><span class="n">r</span><span class="p">}</span><span class="w"></span>
<span class="o">|</span><span class="w"> </span><span class="o">'</span><span class="nb">_</span>#<span class="mi">2</span><span class="n">r</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="n">U0</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="p">{</span><span class="n">bb0</span><span class="p">[</span><span class="mi">0</span><span class="o">..=</span><span class="mi">2</span><span class="p">],</span><span class="w"> </span><span class="o">'</span><span class="nb">_</span>#<span class="mi">2</span><span class="n">r</span><span class="p">}</span><span class="w"></span>
<span class="o">|</span><span class="w"> </span><span class="o">'</span><span class="nb">_</span>#<span class="mi">3</span><span class="n">r</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="n">U0</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="p">{}</span><span class="w"></span>
<span class="o">|</span><span class="w"> </span><span class="o">'</span><span class="nb">_</span>#<span class="mi">4</span><span class="n">r</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="n">U0</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="p">{</span><span class="n">bb0</span><span class="p">[</span><span class="mi">0</span><span class="o">..=</span><span class="mi">2</span><span class="p">],</span><span class="w"> </span><span class="o">'</span><span class="nb">_</span>#<span class="mi">1</span><span class="n">r</span><span class="p">}</span><span class="w"></span>
<span class="o">|</span><span class="w"> </span><span class="o">'</span><span class="nb">_</span>#<span class="mi">5</span><span class="n">r</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="n">U0</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="p">{</span><span class="n">bb0</span><span class="p">[</span><span class="mi">0</span><span class="o">..=</span><span class="mi">2</span><span class="p">],</span><span class="w"> </span><span class="o">'</span><span class="nb">_</span>#<span class="mi">0</span><span class="n">r</span><span class="p">,</span><span class="w"> </span><span class="o">'</span><span class="nb">_</span>#<span class="mi">1</span><span class="n">r</span><span class="p">}</span><span class="w"></span>
<span class="o">|</span><span class="w"> </span><span class="o">'</span><span class="nb">_</span>#<span class="mi">6</span><span class="n">r</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="n">U1</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="p">{}</span><span class="w"></span>
<span class="o">|</span><span class="w"></span>
<span class="o">|</span><span class="w"> </span><span class="n">Inference</span><span class="w"> </span><span class="n">Constraints</span><span class="w"></span>
<span class="o">|</span><span class="w"> </span><span class="o">'</span><span class="nb">_</span>#<span class="mi">0</span><span class="n">r</span><span class="w"> </span><span class="n">live</span><span class="w"> </span><span class="n">at</span><span class="w"> </span><span class="p">{</span><span class="n">bb0</span><span class="p">[</span><span class="mi">0</span><span class="o">..=</span><span class="mi">2</span><span class="p">]}</span><span class="w"></span>
<span class="o">|</span><span class="w"> </span><span class="o">'</span><span class="nb">_</span>#<span class="mi">1</span><span class="n">r</span><span class="w"> </span><span class="n">live</span><span class="w"> </span><span class="n">at</span><span class="w"> </span><span class="p">{</span><span class="n">bb0</span><span class="p">[</span><span class="mi">0</span><span class="o">..=</span><span class="mi">2</span><span class="p">]}</span><span class="w"></span>
<span class="o">|</span><span class="w"> </span><span class="o">'</span><span class="nb">_</span>#<span class="mi">2</span><span class="n">r</span><span class="w"> </span><span class="n">live</span><span class="w"> </span><span class="n">at</span><span class="w"> </span><span class="p">{</span><span class="n">bb0</span><span class="p">[</span><span class="mi">0</span><span class="o">..=</span><span class="mi">2</span><span class="p">]}</span><span class="w"></span>
<span class="o">|</span><span class="w"> </span><span class="o">'</span><span class="nb">_</span>#<span class="mi">1</span><span class="n">r</span>: <span class="o">'</span><span class="nb">_</span>#<span class="mi">4</span><span class="n">r</span><span class="w"> </span><span class="n">due</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">BoringNoLocation</span><span class="w"> </span><span class="n">at</span><span class="w"> </span><span class="n">All</span><span class="p">(</span><span class="n">src</span><span class="o">/</span><span class="n">lib</span><span class="p">.</span><span class="n">rs</span>:<span class="mi">2</span>:<span class="mi">12</span>: <span class="mi">2</span>:<span class="mi">22</span><span class="p">)</span><span class="w"></span>
<span class="o">|</span><span class="w"> </span><span class="o">'</span><span class="nb">_</span>#<span class="mi">1</span><span class="n">r</span>: <span class="o">'</span><span class="nb">_</span>#<span class="mi">6</span><span class="n">r</span><span class="w"> </span><span class="n">due</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">BoringNoLocation</span><span class="w"> </span><span class="n">at</span><span class="w"> </span><span class="n">All</span><span class="p">(</span><span class="n">src</span><span class="o">/</span><span class="n">lib</span><span class="p">.</span><span class="n">rs</span>:<span class="mi">2</span>:<span class="mi">12</span>: <span class="mi">2</span>:<span class="mi">22</span><span class="p">)</span><span class="w"></span>
<span class="o">|</span><span class="w"> </span><span class="o">'</span><span class="nb">_</span>#<span class="mi">4</span><span class="n">r</span>: <span class="o">'</span><span class="nb">_</span>#<span class="mi">1</span><span class="n">r</span><span class="w"> </span><span class="n">due</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">BoringNoLocation</span><span class="w"> </span><span class="n">at</span><span class="w"> </span><span class="n">All</span><span class="p">(</span><span class="n">src</span><span class="o">/</span><span class="n">lib</span><span class="p">.</span><span class="n">rs</span>:<span class="mi">2</span>:<span class="mi">12</span>: <span class="mi">2</span>:<span class="mi">22</span><span class="p">)</span><span class="w"></span>
<span class="o">|</span><span class="w"> </span><span class="o">'</span><span class="nb">_</span>#<span class="mi">5</span><span class="n">r</span>: <span class="o">'</span><span class="nb">_</span>#<span class="mi">1</span><span class="n">r</span><span class="w"> </span><span class="n">due</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">BoringNoLocation</span><span class="w"> </span><span class="n">at</span><span class="w"> </span><span class="n">All</span><span class="p">(</span><span class="n">src</span><span class="o">/</span><span class="n">lib</span><span class="p">.</span><span class="n">rs</span>:<span class="mi">2</span>:<span class="mi">12</span>: <span class="mi">2</span>:<span class="mi">22</span><span class="p">)</span><span class="w"></span>
<span class="o">|</span><span class="w"></span>
<span class="o">|</span><span class="w"> </span><span class="n">User</span><span class="w"> </span><span class="n">Type</span><span class="w"> </span><span class="n">Annotations</span><span class="w"></span>
<span class="o">|</span><span class="w"> </span><span class="mi">0</span>: <span class="nc">Canonical</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="n">max_universe</span>: <span class="nc">U0</span><span class="p">,</span><span class="w"> </span><span class="n">variables</span>: <span class="p">[],</span><span class="w"> </span><span class="n">value</span>: <span class="nc">Ty</span><span class="p">(</span><span class="k">fn</span><span class="p">(</span><span class="o">&amp;'</span><span class="na">b</span><span class="w"> </span><span class="p">()))</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="n">at</span><span class="w"> </span><span class="n">src</span><span class="o">/</span><span class="n">lib</span><span class="p">.</span><span class="n">rs</span>:<span class="mi">2</span>:<span class="mi">12</span>: <span class="mi">2</span>:<span class="mi">22</span><span class="w"></span>
<span class="o">|</span><span class="w"> </span><span class="mi">1</span>: <span class="nc">Canonical</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="n">max_universe</span>: <span class="nc">U0</span><span class="p">,</span><span class="w"> </span><span class="n">variables</span>: <span class="p">[],</span><span class="w"> </span><span class="n">value</span>: <span class="nc">Ty</span><span class="p">(</span><span class="k">fn</span><span class="p">(</span><span class="o">&amp;'</span><span class="na">b</span><span class="w"> </span><span class="p">()))</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="n">at</span><span class="w"> </span><span class="n">src</span><span class="o">/</span><span class="n">lib</span><span class="p">.</span><span class="n">rs</span>:<span class="mi">2</span>:<span class="mi">12</span>: <span class="mi">2</span>:<span class="mi">22</span><span class="w"></span>
<span class="o">|</span><span class="w"></span>
<span class="k">fn</span> <span class="nf">uwu</span><span class="p">(</span><span class="n">_1</span>: <span class="nc">for</span><span class="o">&lt;'</span><span class="na">a</span><span class="o">&gt;</span><span class="w"> </span><span class="k">fn</span><span class="p">(</span><span class="o">&amp;'</span><span class="na">a</span><span class="w"> </span><span class="p">()))</span><span class="w"> </span>-&gt; <span class="p">()</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="n">debug</span><span class="w"> </span><span class="n">func</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="n">_1</span><span class="p">;</span><span class="w">                    </span><span class="c1">// in scope 0 at src/lib.rs:1:12: 1:16</span>
<span class="w">    </span><span class="kd">let</span><span class="w"> </span><span class="k">mut</span><span class="w"> </span><span class="n">_0</span>: <span class="p">();</span><span class="w">                      </span><span class="c1">// return place in scope 0 at src/lib.rs:1:38: 1:38</span>
<span class="w">    </span><span class="n">scope</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="p">}</span><span class="w"></span>

<span class="w">    </span><span class="n">bb0</span>: <span class="p">{</span><span class="w"></span>
<span class="w">        </span><span class="n">AscribeUserType</span><span class="p">(</span><span class="n">_1</span><span class="p">,</span><span class="w"> </span><span class="o">+</span><span class="p">,</span><span class="w"> </span><span class="n">UserTypeProjection</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="n">base</span>: <span class="nc">UserType</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="w"> </span><span class="n">projs</span>: <span class="p">[]</span><span class="w"> </span><span class="p">});</span><span class="w"> </span><span class="c1">// scope 0 at src/lib.rs:2:12: 2:22</span>
<span class="w">        </span><span class="n">_0</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="p">();</span><span class="w">                   </span><span class="c1">// scope 0 at src/lib.rs:1:38: 3:2</span>
<span class="w">        </span><span class="k">return</span><span class="p">;</span><span class="w">                          </span><span class="c1">// scope 0 at src/lib.rs:3:2: 3:2</span>
<span class="w">    </span><span class="p">}</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>
</code></pre></div>



<a name="271407602"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/assigning%20to%20%60_%60/near/271407602" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> lcnr <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/assigning.20to.20.60_.60.html#271407602">(Feb 10 2022 at 09:48)</a>:</h4>
<p>for the second fn with <code>_x</code> the nll output is</p>
<div class="codehilite" data-code-language="Rust"><pre><span></span><code><span class="c1">// MIR for `uwu` 0 nll</span>

<span class="o">|</span><span class="w"> </span><span class="n">Free</span><span class="w"> </span><span class="n">Region</span><span class="w"> </span><span class="n">Mapping</span><span class="w"></span>
<span class="o">|</span><span class="w"> </span><span class="o">'</span><span class="nb">_</span>#<span class="mi">0</span><span class="n">r</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="n">Global</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="p">[</span><span class="o">'</span><span class="nb">_</span>#<span class="mi">0</span><span class="n">r</span><span class="p">,</span><span class="w"> </span><span class="o">'</span><span class="nb">_</span>#<span class="mi">2</span><span class="n">r</span><span class="p">,</span><span class="w"> </span><span class="o">'</span><span class="nb">_</span>#<span class="mi">1</span><span class="n">r</span><span class="p">]</span><span class="w"></span>
<span class="o">|</span><span class="w"> </span><span class="o">'</span><span class="nb">_</span>#<span class="mi">1</span><span class="n">r</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="n">Local</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="p">[</span><span class="o">'</span><span class="nb">_</span>#<span class="mi">2</span><span class="n">r</span><span class="p">,</span><span class="w"> </span><span class="o">'</span><span class="nb">_</span>#<span class="mi">1</span><span class="n">r</span><span class="p">]</span><span class="w"></span>
<span class="o">|</span><span class="w"> </span><span class="o">'</span><span class="nb">_</span>#<span class="mi">2</span><span class="n">r</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="n">Local</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="p">[</span><span class="o">'</span><span class="nb">_</span>#<span class="mi">2</span><span class="n">r</span><span class="p">]</span><span class="w"></span>
<span class="o">|</span><span class="w"></span>
<span class="o">|</span><span class="w"> </span><span class="n">Inferred</span><span class="w"> </span><span class="n">Region</span><span class="w"> </span><span class="n">Values</span><span class="w"></span>
<span class="o">|</span><span class="w"> </span><span class="o">'</span><span class="nb">_</span>#<span class="mi">0</span><span class="n">r</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="n">U0</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="p">{</span><span class="n">bb0</span><span class="p">[</span><span class="mi">0</span><span class="o">..=</span><span class="mi">6</span><span class="p">],</span><span class="w"> </span><span class="o">'</span><span class="nb">_</span>#<span class="mi">0</span><span class="n">r</span><span class="p">,</span><span class="w"> </span><span class="o">'</span><span class="nb">_</span>#<span class="mi">1</span><span class="n">r</span><span class="p">,</span><span class="w"> </span><span class="o">'</span><span class="nb">_</span>#<span class="mi">2</span><span class="n">r</span><span class="p">}</span><span class="w"></span>
<span class="o">|</span><span class="w"> </span><span class="o">'</span><span class="nb">_</span>#<span class="mi">1</span><span class="n">r</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="n">U0</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="p">{</span><span class="n">bb0</span><span class="p">[</span><span class="mi">0</span><span class="o">..=</span><span class="mi">6</span><span class="p">],</span><span class="w"> </span><span class="o">'</span><span class="nb">_</span>#<span class="mi">1</span><span class="n">r</span><span class="p">}</span><span class="w"></span>
<span class="o">|</span><span class="w"> </span><span class="o">'</span><span class="nb">_</span>#<span class="mi">2</span><span class="n">r</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="n">U0</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="p">{</span><span class="n">bb0</span><span class="p">[</span><span class="mi">0</span><span class="o">..=</span><span class="mi">6</span><span class="p">],</span><span class="w"> </span><span class="o">'</span><span class="nb">_</span>#<span class="mi">2</span><span class="n">r</span><span class="p">}</span><span class="w"></span>
<span class="o">|</span><span class="w"> </span><span class="o">'</span><span class="nb">_</span>#<span class="mi">3</span><span class="n">r</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="n">U0</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="p">{}</span><span class="w"></span>
<span class="o">|</span><span class="w"> </span><span class="o">'</span><span class="nb">_</span>#<span class="mi">4</span><span class="n">r</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="n">U0</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="p">{</span><span class="n">bb0</span><span class="p">[</span><span class="mi">0</span><span class="o">..=</span><span class="mi">6</span><span class="p">],</span><span class="w"> </span><span class="o">'</span><span class="nb">_</span>#<span class="mi">1</span><span class="n">r</span><span class="p">}</span><span class="w"></span>
<span class="o">|</span><span class="w"> </span><span class="o">'</span><span class="nb">_</span>#<span class="mi">5</span><span class="n">r</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="n">U0</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="p">{</span><span class="n">bb0</span><span class="p">[</span><span class="mi">0</span><span class="o">..=</span><span class="mi">6</span><span class="p">],</span><span class="w"> </span><span class="o">'</span><span class="nb">_</span>#<span class="mi">1</span><span class="n">r</span><span class="p">}</span><span class="w"></span>
<span class="o">|</span><span class="w"> </span><span class="o">'</span><span class="nb">_</span>#<span class="mi">6</span><span class="n">r</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="n">U0</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="p">{</span><span class="n">bb0</span><span class="p">[</span><span class="mi">0</span><span class="o">..=</span><span class="mi">6</span><span class="p">],</span><span class="w"> </span><span class="o">'</span><span class="nb">_</span>#<span class="mi">1</span><span class="n">r</span><span class="p">}</span><span class="w"></span>
<span class="o">|</span><span class="w"> </span><span class="o">'</span><span class="nb">_</span>#<span class="mi">7</span><span class="n">r</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="n">U0</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="p">{}</span><span class="w"></span>
<span class="o">|</span><span class="w"></span>
<span class="o">|</span><span class="w"> </span><span class="n">Inference</span><span class="w"> </span><span class="n">Constraints</span><span class="w"></span>
<span class="o">|</span><span class="w"> </span><span class="o">'</span><span class="nb">_</span>#<span class="mi">0</span><span class="n">r</span><span class="w"> </span><span class="n">live</span><span class="w"> </span><span class="n">at</span><span class="w"> </span><span class="p">{</span><span class="n">bb0</span><span class="p">[</span><span class="mi">0</span><span class="o">..=</span><span class="mi">6</span><span class="p">]}</span><span class="w"></span>
<span class="o">|</span><span class="w"> </span><span class="o">'</span><span class="nb">_</span>#<span class="mi">1</span><span class="n">r</span><span class="w"> </span><span class="n">live</span><span class="w"> </span><span class="n">at</span><span class="w"> </span><span class="p">{</span><span class="n">bb0</span><span class="p">[</span><span class="mi">0</span><span class="o">..=</span><span class="mi">6</span><span class="p">]}</span><span class="w"></span>
<span class="o">|</span><span class="w"> </span><span class="o">'</span><span class="nb">_</span>#<span class="mi">2</span><span class="n">r</span><span class="w"> </span><span class="n">live</span><span class="w"> </span><span class="n">at</span><span class="w"> </span><span class="p">{</span><span class="n">bb0</span><span class="p">[</span><span class="mi">0</span><span class="o">..=</span><span class="mi">6</span><span class="p">]}</span><span class="w"></span>
<span class="o">|</span><span class="w"> </span><span class="o">'</span><span class="nb">_</span>#<span class="mi">1</span><span class="n">r</span>: <span class="o">'</span><span class="nb">_</span>#<span class="mi">5</span><span class="n">r</span><span class="w"> </span><span class="n">due</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">BoringNoLocation</span><span class="w"> </span><span class="n">at</span><span class="w"> </span><span class="n">All</span><span class="p">(</span><span class="n">src</span><span class="o">/</span><span class="n">lib</span><span class="p">.</span><span class="n">rs</span>:<span class="mi">2</span>:<span class="mi">13</span>: <span class="mi">2</span>:<span class="mi">23</span><span class="p">)</span><span class="w"></span>
<span class="o">|</span><span class="w"> </span><span class="o">'</span><span class="nb">_</span>#<span class="mi">1</span><span class="n">r</span>: <span class="o">'</span><span class="nb">_</span>#<span class="mi">6</span><span class="n">r</span><span class="w"> </span><span class="n">due</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">BoringNoLocation</span><span class="w"> </span><span class="n">at</span><span class="w"> </span><span class="n">All</span><span class="p">(</span><span class="n">src</span><span class="o">/</span><span class="n">lib</span><span class="p">.</span><span class="n">rs</span>:<span class="mi">2</span>:<span class="mi">13</span>: <span class="mi">2</span>:<span class="mi">23</span><span class="p">)</span><span class="w"></span>
<span class="o">|</span><span class="w"> </span><span class="o">'</span><span class="nb">_</span>#<span class="mi">4</span><span class="n">r</span>: <span class="o">'</span><span class="nb">_</span>#<span class="mi">5</span><span class="n">r</span><span class="w"> </span><span class="n">due</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">TypeAnnotation</span><span class="w"> </span><span class="n">at</span><span class="w"> </span><span class="n">All</span><span class="p">(</span><span class="n">src</span><span class="o">/</span><span class="n">lib</span><span class="p">.</span><span class="n">rs</span>:<span class="mi">2</span>:<span class="mi">13</span>: <span class="mi">2</span>:<span class="mi">23</span><span class="p">)</span><span class="w"></span>
<span class="o">|</span><span class="w"> </span><span class="o">'</span><span class="nb">_</span>#<span class="mi">4</span><span class="n">r</span>: <span class="o">'</span><span class="nb">_</span>#<span class="mi">6</span><span class="n">r</span><span class="w"> </span><span class="n">due</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">TypeAnnotation</span><span class="w"> </span><span class="n">at</span><span class="w"> </span><span class="n">All</span><span class="p">(</span><span class="n">src</span><span class="o">/</span><span class="n">lib</span><span class="p">.</span><span class="n">rs</span>:<span class="mi">2</span>:<span class="mi">13</span>: <span class="mi">2</span>:<span class="mi">23</span><span class="p">)</span><span class="w"></span>
<span class="o">|</span><span class="w"> </span><span class="o">'</span><span class="nb">_</span>#<span class="mi">4</span><span class="n">r</span>: <span class="o">'</span><span class="nb">_</span>#<span class="mi">7</span><span class="n">r</span><span class="w"> </span><span class="n">due</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">Assignment</span><span class="w"> </span><span class="n">at</span><span class="w"> </span><span class="n">Single</span><span class="p">(</span><span class="n">bb0</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span><span class="w"></span>
<span class="o">|</span><span class="w"> </span><span class="o">'</span><span class="nb">_</span>#<span class="mi">5</span><span class="n">r</span>: <span class="o">'</span><span class="nb">_</span>#<span class="mi">1</span><span class="n">r</span><span class="w"> </span><span class="n">due</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">BoringNoLocation</span><span class="w"> </span><span class="n">at</span><span class="w"> </span><span class="n">All</span><span class="p">(</span><span class="n">src</span><span class="o">/</span><span class="n">lib</span><span class="p">.</span><span class="n">rs</span>:<span class="mi">2</span>:<span class="mi">13</span>: <span class="mi">2</span>:<span class="mi">23</span><span class="p">)</span><span class="w"></span>
<span class="o">|</span><span class="w"> </span><span class="o">'</span><span class="nb">_</span>#<span class="mi">5</span><span class="n">r</span>: <span class="o">'</span><span class="nb">_</span>#<span class="mi">4</span><span class="n">r</span><span class="w"> </span><span class="n">due</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">TypeAnnotation</span><span class="w"> </span><span class="n">at</span><span class="w"> </span><span class="n">All</span><span class="p">(</span><span class="n">src</span><span class="o">/</span><span class="n">lib</span><span class="p">.</span><span class="n">rs</span>:<span class="mi">2</span>:<span class="mi">13</span>: <span class="mi">2</span>:<span class="mi">23</span><span class="p">)</span><span class="w"></span>
<span class="o">|</span><span class="w"> </span><span class="o">'</span><span class="nb">_</span>#<span class="mi">6</span><span class="n">r</span>: <span class="o">'</span><span class="nb">_</span>#<span class="mi">1</span><span class="n">r</span><span class="w"> </span><span class="n">due</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">BoringNoLocation</span><span class="w"> </span><span class="n">at</span><span class="w"> </span><span class="n">All</span><span class="p">(</span><span class="n">src</span><span class="o">/</span><span class="n">lib</span><span class="p">.</span><span class="n">rs</span>:<span class="mi">2</span>:<span class="mi">13</span>: <span class="mi">2</span>:<span class="mi">23</span><span class="p">)</span><span class="w"></span>
<span class="o">|</span><span class="w"> </span><span class="o">'</span><span class="nb">_</span>#<span class="mi">6</span><span class="n">r</span>: <span class="o">'</span><span class="nb">_</span>#<span class="mi">4</span><span class="n">r</span><span class="w"> </span><span class="n">due</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">TypeAnnotation</span><span class="w"> </span><span class="n">at</span><span class="w"> </span><span class="n">All</span><span class="p">(</span><span class="n">src</span><span class="o">/</span><span class="n">lib</span><span class="p">.</span><span class="n">rs</span>:<span class="mi">2</span>:<span class="mi">13</span>: <span class="mi">2</span>:<span class="mi">23</span><span class="p">)</span><span class="w"></span>
<span class="o">|</span><span class="w"></span>
<span class="o">|</span><span class="w"> </span><span class="n">User</span><span class="w"> </span><span class="n">Type</span><span class="w"> </span><span class="n">Annotations</span><span class="w"></span>
<span class="o">|</span><span class="w"> </span><span class="mi">0</span>: <span class="nc">Canonical</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="n">max_universe</span>: <span class="nc">U0</span><span class="p">,</span><span class="w"> </span><span class="n">variables</span>: <span class="p">[],</span><span class="w"> </span><span class="n">value</span>: <span class="nc">Ty</span><span class="p">(</span><span class="k">fn</span><span class="p">(</span><span class="o">&amp;'</span><span class="na">b</span><span class="w"> </span><span class="p">()))</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="n">at</span><span class="w"> </span><span class="n">src</span><span class="o">/</span><span class="n">lib</span><span class="p">.</span><span class="n">rs</span>:<span class="mi">2</span>:<span class="mi">13</span>: <span class="mi">2</span>:<span class="mi">23</span><span class="w"></span>
<span class="o">|</span><span class="w"> </span><span class="mi">1</span>: <span class="nc">Canonical</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="n">max_universe</span>: <span class="nc">U0</span><span class="p">,</span><span class="w"> </span><span class="n">variables</span>: <span class="p">[],</span><span class="w"> </span><span class="n">value</span>: <span class="nc">Ty</span><span class="p">(</span><span class="k">fn</span><span class="p">(</span><span class="o">&amp;'</span><span class="na">b</span><span class="w"> </span><span class="p">()))</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="n">at</span><span class="w"> </span><span class="n">src</span><span class="o">/</span><span class="n">lib</span><span class="p">.</span><span class="n">rs</span>:<span class="mi">2</span>:<span class="mi">13</span>: <span class="mi">2</span>:<span class="mi">23</span><span class="w"></span>
<span class="o">|</span><span class="w"></span>
<span class="k">fn</span> <span class="nf">uwu</span><span class="p">(</span><span class="n">_1</span>: <span class="nc">for</span><span class="o">&lt;'</span><span class="na">a</span><span class="o">&gt;</span><span class="w"> </span><span class="k">fn</span><span class="p">(</span><span class="o">&amp;'</span><span class="na">a</span><span class="w"> </span><span class="p">()))</span><span class="w"> </span>-&gt; <span class="p">()</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="n">debug</span><span class="w"> </span><span class="n">func</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="n">_1</span><span class="p">;</span><span class="w">                    </span><span class="c1">// in scope 0 at src/lib.rs:1:12: 1:16</span>
<span class="w">    </span><span class="kd">let</span><span class="w"> </span><span class="k">mut</span><span class="w"> </span><span class="n">_0</span>: <span class="p">();</span><span class="w">                      </span><span class="c1">// return place in scope 0 at src/lib.rs:1:38: 1:38</span>
<span class="w">    </span><span class="kd">let</span><span class="w"> </span><span class="n">_2</span>: <span class="nc">fn</span><span class="p">(</span><span class="o">&amp;</span><span class="p">())</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">UserTypeProjection</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="n">base</span>: <span class="nc">UserType</span><span class="p">(</span><span class="mi">0</span><span class="p">),</span><span class="w"> </span><span class="n">projs</span>: <span class="p">[]</span><span class="w"> </span><span class="p">};</span><span class="w"> </span><span class="c1">// in scope 0 at src/lib.rs:2:9: 2:11</span>
<span class="w">    </span><span class="n">scope</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">        </span><span class="n">debug</span><span class="w"> </span><span class="n">_x</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="n">_2</span><span class="p">;</span><span class="w">                  </span><span class="c1">// in scope 1 at src/lib.rs:2:9: 2:11</span>
<span class="w">    </span><span class="p">}</span><span class="w"></span>

<span class="w">    </span><span class="n">bb0</span>: <span class="p">{</span><span class="w"></span>
<span class="w">        </span><span class="n">StorageLive</span><span class="p">(</span><span class="n">_2</span><span class="p">);</span><span class="w">                 </span><span class="c1">// scope 0 at src/lib.rs:2:9: 2:11</span>
<span class="w">        </span><span class="n">_2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">_1</span><span class="p">;</span><span class="w">                         </span><span class="c1">// scope 0 at src/lib.rs:2:26: 2:30</span>
<span class="w">        </span><span class="n">FakeRead</span><span class="p">(</span><span class="n">ForLet</span><span class="p">(</span><span class="nb">None</span><span class="p">),</span><span class="w"> </span><span class="n">_2</span><span class="p">);</span><span class="w">      </span><span class="c1">// scope 0 at src/lib.rs:2:9: 2:11</span>
<span class="w">        </span><span class="n">AscribeUserType</span><span class="p">(</span><span class="n">_2</span><span class="p">,</span><span class="w"> </span><span class="n">o</span><span class="p">,</span><span class="w"> </span><span class="n">UserTypeProjection</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="n">base</span>: <span class="nc">UserType</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="w"> </span><span class="n">projs</span>: <span class="p">[]</span><span class="w"> </span><span class="p">});</span><span class="w"> </span><span class="c1">// scope 0 at src/lib.rs:2:13: 2:23</span>
<span class="w">        </span><span class="n">_0</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="p">();</span><span class="w">                   </span><span class="c1">// scope 0 at src/lib.rs:1:38: 3:2</span>
<span class="w">        </span><span class="n">StorageDead</span><span class="p">(</span><span class="n">_2</span><span class="p">);</span><span class="w">                 </span><span class="c1">// scope 0 at src/lib.rs:3:1: 3:2</span>
<span class="w">        </span><span class="k">return</span><span class="p">;</span><span class="w">                          </span><span class="c1">// scope 0 at src/lib.rs:3:2: 3:2</span>
<span class="w">    </span><span class="p">}</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>
</code></pre></div>



<a name="271408033"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/assigning%20to%20%60_%60/near/271408033" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> lcnr <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/assigning.20to.20.60_.60.html#271408033">(Feb 10 2022 at 09:53)</a>:</h4>
<p>does someone have an idea what goes wrong here/how to debug this?</p>



<a name="271409079"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/assigning%20to%20%60_%60/near/271409079" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> lcnr <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/assigning.20to.20.60_.60.html#271409079">(Feb 10 2022 at 10:03)</a>:</h4>
<p><span class="user-mention" data-user-id="116009">@nikomatsakis</span> <span class="user-mention" data-user-id="116083">@pnkfelix</span> do you have an idea here? or whether this behavior is actually intended?</p>



<a name="271409926"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/assigning%20to%20%60_%60/near/271409926" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> oli <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/assigning.20to.20.60_.60.html#271409926">(Feb 10 2022 at 10:09)</a>:</h4>
<p>AscribeUserType checks for equality of types, not sub. Since the second example has an assignment in between, and assignments use subtyping, it works out.</p>



<a name="271410121"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/assigning%20to%20%60_%60/near/271410121" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> oli <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/assigning.20to.20.60_.60.html#271410121">(Feb 10 2022 at 10:11)</a>:</h4>
<p>Is this error coming from typeck or borrowck?</p>



<a name="271411366"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/assigning%20to%20%60_%60/near/271411366" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> lcnr <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/assigning.20to.20.60_.60.html#271411366">(Feb 10 2022 at 10:23)</a>:</h4>
<p>but like: <code>AscribeUserType(_1, +, UserTypeProjection { base: UserType(1), projs: [] })</code></p>
<p>uses covariance because of the <code>+</code>, doesn't it?</p>



<a name="271411412"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/assigning%20to%20%60_%60/near/271411412" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> lcnr <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/assigning.20to.20.60_.60.html#271411412">(Feb 10 2022 at 10:23)</a>:</h4>
<p><a href="https://doc.rust-lang.org/nightly/nightly-rustc/rustc_middle/mir/enum.StatementKind.html#variant.AscribeUserType">https://doc.rust-lang.org/nightly/nightly-rustc/rustc_middle/mir/enum.StatementKind.html#variant.AscribeUserType</a></p>



<a name="271411625"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/assigning%20to%20%60_%60/near/271411625" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> lcnr <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/assigning.20to.20.60_.60.html#271411625">(Feb 10 2022 at 10:25)</a>:</h4>
<p>the error happens in <code>mir_borrowck</code> in <code>mbcx.report_region_errors</code></p>



<a name="271412631"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/assigning%20to%20%60_%60/near/271412631" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> oli <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/assigning.20to.20.60_.60.html#271412631">(Feb 10 2022 at 10:34)</a>:</h4>
<p>Oh. I was looking at the second example which uses invariant and assumed it would be the same</p>



<a name="271415127"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/assigning%20to%20%60_%60/near/271415127" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> lcnr <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/assigning.20to.20.60_.60.html#271415127">(Feb 10 2022 at 10:57)</a>:</h4>
<p>figured it out, seems to be a bug</p>



<a name="271415196"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/assigning%20to%20%60_%60/near/271415196" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> lcnr <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/assigning.20to.20.60_.60.html#271415196">(Feb 10 2022 at 10:58)</a>:</h4>
<p><a href="https://doc.rust-lang.org/nightly/nightly-rustc/rustc_middle/mir/struct.Body.html#structfield.user_type_annotations">https://doc.rust-lang.org/nightly/nightly-rustc/rustc_middle/mir/struct.Body.html#structfield.user_type_annotations</a> are always checked using <code>eq_types</code></p>



<a name="271415214"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/assigning%20to%20%60_%60/near/271415214" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> lcnr <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/assigning.20to.20.60_.60.html#271415214">(Feb 10 2022 at 10:58)</a>:</h4>
<p>while also containing user type annotations which are covariant</p>



<a name="271415265"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/assigning%20to%20%60_%60/near/271415265" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> lcnr <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/assigning.20to.20.60_.60.html#271415265">(Feb 10 2022 at 10:59)</a>:</h4>
<p>still figuring out how exactly this works, cause afaict this should cause the following to not compile</p>
<div class="codehilite" data-code-language="Rust"><pre><span></span><code><span class="k">fn</span> <span class="nf">uwu</span><span class="o">&lt;'</span><span class="na">b</span><span class="o">&gt;</span><span class="p">(</span><span class="n">func</span>: <span class="p">(</span><span class="o">&amp;'</span><span class="nb">static</span><span class="w"> </span><span class="p">(),))</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="kd">let</span><span class="w"> </span><span class="n">_</span>: <span class="p">(</span><span class="o">&amp;'</span><span class="na">b</span><span class="w"> </span><span class="p">(),)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">func</span><span class="p">;</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>
</code></pre></div>



<a name="271415278"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/assigning%20to%20%60_%60/near/271415278" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> lcnr <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/assigning.20to.20.60_.60.html#271415278">(Feb 10 2022 at 10:59)</a>:</h4>
<p>but it does</p>



<a name="271415961"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/assigning%20to%20%60_%60/near/271415961" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> oli <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/assigning.20to.20.60_.60.html#271415961">(Feb 10 2022 at 11:05)</a>:</h4>
<p>Do we even need those when we have them in the MIR? Which ones are not in the MIR but are in the map?</p>



<a name="271415962"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/assigning%20to%20%60_%60/near/271415962" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> oli <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/assigning.20to.20.60_.60.html#271415962">(Feb 10 2022 at 11:05)</a>:</h4>
<p>Maybe we're only generating them on things with HKL?</p>



<a name="271416292"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/assigning%20to%20%60_%60/near/271416292" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> lcnr <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/assigning.20to.20.60_.60.html#271416292">(Feb 10 2022 at 11:08)</a>:</h4>
<p>no, we generate them for everything</p>



<a name="271416296"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/assigning%20to%20%60_%60/near/271416296" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> lcnr <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/assigning.20to.20.60_.60.html#271416296">(Feb 10 2022 at 11:08)</a>:</h4>
<p>but erase lifetimes or something</p>



<a name="271416321"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/assigning%20to%20%60_%60/near/271416321" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> lcnr <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/assigning.20to.20.60_.60.html#271416321">(Feb 10 2022 at 11:09)</a>:</h4>
<p>or replace them with fresh ones, so only hrlt mismatches cause errors</p>



<a name="271416339"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/assigning%20to%20%60_%60/near/271416339" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> lcnr <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/assigning.20to.20.60_.60.html#271416339">(Feb 10 2022 at 11:09)</a>:</h4>
<p>going to work on a fix</p>



<a name="271425242"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/assigning%20to%20%60_%60/near/271425242" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> lcnr <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/assigning.20to.20.60_.60.html#271425242">(Feb 10 2022 at 12:42)</a>:</h4>
<p>fix in <a href="https://github.com/rust-lang/rust/issues/93856">#93856</a></p>



<a name="271426422"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/assigning%20to%20%60_%60/near/271426422" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> oli <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/assigning.20to.20.60_.60.html#271426422">(Feb 10 2022 at 12:55)</a>:</h4>
<p>You forgot the trailing newlines XD I do that all the time, too. I found a vscode flag for it some time ago, but must've lost my config</p>



<hr><p>Last updated: Apr 12 2022 at 20:01 UTC</p>
</html>