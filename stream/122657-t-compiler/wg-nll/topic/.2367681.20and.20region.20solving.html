<html>
<head><meta charset="utf-8"><title>#67681 and region solving · t-compiler/wg-nll · Zulip Chat Archive</title></head>
<h2>Stream: <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/index.html">t-compiler/wg-nll</a></h2>
<h3>Topic: <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2367681.20and.20region.20solving.html">#67681 and region solving</a></h3>

<hr>

<base href="https://rust-lang.zulipchat.com">

<head><link href="https://zulip-archive.rust-lang.org/style.css" rel="stylesheet"></head>

<a name="184937690"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2367681%20and%20region%20solving/near/184937690" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Matthew Jasper <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2367681.20and.20region.20solving.html#184937690">(Jan 06 2020 at 19:29)</a>:</h4>
<p><span class="user-mention" data-user-id="116009">@nikomatsakis</span> can we schedule a time to discuss <a href="https://github.com/rust-lang/rust/issues/67681" target="_blank" title="https://github.com/rust-lang/rust/issues/67681">#67681</a> and further plans in that direction? I'm available from about this time (19:30 UTC) onwards on weekdays.</p>



<a name="185036134"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2367681%20and%20region%20solving/near/185036134" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Matthew Jasper <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2367681.20and.20region.20solving.html#185036134">(Jan 07 2020 at 17:58)</a>:</h4>
<p>ping <span class="user-mention" data-user-id="116009">@nikomatsakis</span> ^</p>



<a name="185621340"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2367681%20and%20region%20solving/near/185621340" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2367681.20and.20region.20solving.html#185621340">(Jan 14 2020 at 17:59)</a>:</h4>
<p>ugh I missed this, sorry <span class="user-mention" data-user-id="116118">@Matthew Jasper</span></p>



<a name="185621342"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2367681%20and%20region%20solving/near/185621342" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2367681.20and.20region.20solving.html#185621342">(Jan 14 2020 at 17:59)</a>:</h4>
<p>yes, let's do that</p>



<a name="185621384"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2367681%20and%20region%20solving/near/185621384" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2367681.20and.20region.20solving.html#185621384">(Jan 14 2020 at 18:00)</a>:</h4>
<p>are you still available with those times?</p>



<a name="185627742"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2367681%20and%20region%20solving/near/185627742" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Matthew Jasper <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2367681.20and.20region.20solving.html#185627742">(Jan 14 2020 at 19:00)</a>:</h4>
<p>Yes</p>



<a name="185735273"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2367681%20and%20region%20solving/near/185735273" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Matthew Jasper <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2367681.20and.20region.20solving.html#185735273">(Jan 15 2020 at 19:36)</a>:</h4>
<p><span class="user-mention" data-user-id="116009">@nikomatsakis</span> <span aria-label="wave" class="emoji emoji-1f44b" role="img" title="wave">:wave:</span></p>



<a name="185735490"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2367681%20and%20region%20solving/near/185735490" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2367681.20and.20region.20solving.html#185735490">(Jan 15 2020 at 19:38)</a>:</h4>
<p>Hi:)</p>



<a name="185735505"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2367681%20and%20region%20solving/near/185735505" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2367681.20and.20region.20solving.html#185735505">(Jan 15 2020 at 19:38)</a>:</h4>
<p>Gimme one or two minutes</p>



<a name="185735944"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2367681%20and%20region%20solving/near/185735944" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2367681.20and.20region.20solving.html#185735944">(Jan 15 2020 at 19:43)</a>:</h4>
<p>ok ok</p>



<a name="185735955"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2367681%20and%20region%20solving/near/185735955" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2367681.20and.20region.20solving.html#185735955">(Jan 15 2020 at 19:43)</a>:</h4>
<p>So yeah <span class="user-mention" data-user-id="116118">@Matthew Jasper</span> not sure if we had a precise agenda</p>



<a name="185735970"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2367681%20and%20region%20solving/near/185735970" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2367681.20and.20region.20solving.html#185735970">(Jan 15 2020 at 19:43)</a>:</h4>
<p>I guess the bigger question is "how to remove lexical checker"</p>



<a name="185735982"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2367681%20and%20region%20solving/near/185735982" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2367681.20and.20region.20solving.html#185735982">(Jan 15 2020 at 19:43)</a>:</h4>
<p>well I'm not sure if that's the right framing, so maybe we should start with that question</p>



<a name="185735995"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2367681%20and%20region%20solving/near/185735995" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2367681.20and.20region.20solving.html#185735995">(Jan 15 2020 at 19:43)</a>:</h4>
<p>is the goal to <em>remove lexical checker</em> or to <em>move typeck to not compute regions</em></p>



<a name="185736078"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2367681%20and%20region%20solving/near/185736078" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Matthew Jasper <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2367681.20and.20region.20solving.html#185736078">(Jan 15 2020 at 19:44)</a>:</h4>
<p>Well, I have a list of things that move towards <em>move typeck to not compute regions</em></p>



<a name="185736133"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2367681%20and%20region%20solving/near/185736133" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Matthew Jasper <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2367681.20and.20region.20solving.html#185736133">(Jan 15 2020 at 19:45)</a>:</h4>
<p>I'm not sure if getting the NLL solver to handle region solving in, say item wf checking would be that beneficial.</p>



<a name="185736272"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2367681%20and%20region%20solving/near/185736272" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2367681.20and.20region.20solving.html#185736272">(Jan 15 2020 at 19:46)</a>:</h4>
<p>Yes</p>



<a name="185736288"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2367681%20and%20region%20solving/near/185736288" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2367681.20and.20region.20solving.html#185736288">(Jan 15 2020 at 19:46)</a>:</h4>
<p>Well, yes and no</p>



<a name="185736312"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2367681%20and%20region%20solving/near/185736312" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2367681.20and.20region.20solving.html#185736312">(Jan 15 2020 at 19:46)</a>:</h4>
<p>I mean the advantage would obviously be that we have only one region checker, whereas now we have 2</p>



<a name="185736330"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2367681%20and%20region%20solving/near/185736330" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2367681.20and.20region.20solving.html#185736330">(Jan 15 2020 at 19:46)</a>:</h4>
<p>but I think I"ve basically come around to thinking "that is a waste of time"</p>



<a name="185736342"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2367681%20and%20region%20solving/near/185736342" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2367681.20and.20region.20solving.html#185736342">(Jan 15 2020 at 19:46)</a>:</h4>
<p>that is, we should focus more on liberating typeck</p>



<a name="185736355"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2367681%20and%20region%20solving/near/185736355" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2367681.20and.20region.20solving.html#185736355">(Jan 15 2020 at 19:47)</a>:</h4>
<p>and things like "item wf checking" can wait</p>



<a name="185736362"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2367681%20and%20region%20solving/near/185736362" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Matthew Jasper <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2367681.20and.20region.20solving.html#185736362">(Jan 15 2020 at 19:47)</a>:</h4>
<p>It's much lower priority at least.</p>



<a name="185736370"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2367681%20and%20region%20solving/near/185736370" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2367681.20and.20region.20solving.html#185736370">(Jan 15 2020 at 19:47)</a>:</h4>
<p>so what is your list?</p>



<a name="185736511"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2367681%20and%20region%20solving/near/185736511" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2367681.20and.20region.20solving.html#185736511">(Jan 15 2020 at 19:48)</a>:</h4>
<p>(also, I'm trying to remember what the PR you had was...)</p>



<a name="185736558"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2367681%20and%20region%20solving/near/185736558" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2367681.20and.20region.20solving.html#185736558">(Jan 15 2020 at 19:49)</a>:</h4>
<p>also, I rebased the "no leak check" branch btw</p>



<a name="185736563"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2367681%20and%20region%20solving/near/185736563" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2367681.20and.20region.20solving.html#185736563">(Jan 15 2020 at 19:49)</a>:</h4>
<p>we could talk a bit about that too :)</p>



<a name="185736575"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2367681%20and%20region%20solving/near/185736575" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2367681.20and.20region.20solving.html#185736575">(Jan 15 2020 at 19:49)</a>:</h4>
<p>I haven't yet tried to keep the leak check and issue warnings, I was going to tinker with that, prob not <em>too hard</em> to do</p>



<a name="185736630"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2367681%20and%20region%20solving/near/185736630" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Matthew Jasper <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2367681.20and.20region.20solving.html#185736630">(Jan 15 2020 at 19:50)</a>:</h4>
<ul>
<li>Erase regions after region solving (this isn't really the long term goal, but I think that it's helpful in the short term).</li>
<li>Don't infer regions (i.e. don't run <code>lexical_region_reolve</code>) when checking function/const/static bodies, gated on <code>-Zborrowck=mir</code></li>
<li>Don't visit expressions in regionck. This essentially disables the leak check because <code>ReEmpty</code> is special, so requires some work to ensure that we don't regress error messages (i.e. your PR).</li>
<li>Ensure that <code>MIR</code> doesn't contain unerased free regions (except for borrowck's copy) (this is mostly cleaning up)</li>
</ul>



<a name="185736721"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2367681%20and%20region%20solving/near/185736721" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Matthew Jasper <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2367681.20and.20region.20solving.html#185736721">(Jan 15 2020 at 19:51)</a>:</h4>
<p>If we keep the leak check and emit warnings, does selection also need the leak check to avoid ambiguity errors?</p>



<a name="185736747"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2367681%20and%20region%20solving/near/185736747" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2367681.20and.20region.20solving.html#185736747">(Jan 15 2020 at 19:51)</a>:</h4>
<p>Yes, I think it does</p>



<a name="185736755"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2367681%20and%20region%20solving/near/185736755" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2367681.20and.20region.20solving.html#185736755">(Jan 15 2020 at 19:51)</a>:</h4>
<p>Which is why I think if we issue warnings</p>



<a name="185736766"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2367681%20and%20region%20solving/near/185736766" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2367681.20and.20region.20solving.html#185736766">(Jan 15 2020 at 19:51)</a>:</h4>
<p>We probably want to keep leak check .. all the time?</p>



<a name="185736785"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2367681%20and%20region%20solving/near/185736785" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2367681.20and.20region.20solving.html#185736785">(Jan 15 2020 at 19:51)</a>:</h4>
<p>it just feels like things will be too inconsistent otherwise</p>



<a name="185736791"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2367681%20and%20region%20solving/near/185736791" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2367681.20and.20region.20solving.html#185736791">(Jan 15 2020 at 19:51)</a>:</h4>
<p>ok so</p>



<a name="185736795"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2367681%20and%20region%20solving/near/185736795" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2367681.20and.20region.20solving.html#185736795">(Jan 15 2020 at 19:51)</a>:</h4>
<p>looking at the list</p>



<a name="185736836"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2367681%20and%20region%20solving/near/185736836" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2367681.20and.20region.20solving.html#185736836">(Jan 15 2020 at 19:52)</a>:</h4>
<p>I guess the idea of the first step is</p>



<a name="185736846"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2367681%20and%20region%20solving/near/185736846" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2367681.20and.20region.20solving.html#185736846">(Jan 15 2020 at 19:52)</a>:</h4>
<p>start by erasing all the regions coming out from typeck--</p>



<a name="185736852"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2367681%20and%20region%20solving/near/185736852" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Matthew Jasper <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2367681.20and.20region.20solving.html#185736852">(Jan 15 2020 at 19:52)</a>:</h4>
<p>That list gets us about half way. I guess that the long term goal is to not even create <code>ReVar</code>s?</p>



<a name="185736888"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2367681%20and%20region%20solving/near/185736888" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2367681.20and.20region.20solving.html#185736888">(Jan 15 2020 at 19:52)</a>:</h4>
<p>thus proving the current "hypothesis" that NLL doesn't depend at all on the regionck from typeck</p>



<a name="185736974"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2367681%20and%20region%20solving/near/185736974" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2367681.20and.20region.20solving.html#185736974">(Jan 15 2020 at 19:53)</a>:</h4>
<blockquote>
<ul>
<li>Don't visit expressions in regionck. This essentially disables the leak check because <code>ReEmpty</code> is special, so requires some work to ensure that we don't regress error messages (i.e. your PR).</li>
</ul>
</blockquote>
<p>this is interesting</p>



<a name="185737167"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2367681%20and%20region%20solving/near/185737167" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2367681.20and.20region.20solving.html#185737167">(Jan 15 2020 at 19:53)</a>:</h4>
<p>if I'm reading your list correctly, at no point do we stop running <code>lexical_region_resolve</code> on regular functions...? oh, I see, that was the second bullet</p>



<a name="185737214"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2367681%20and%20region%20solving/near/185737214" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2367681.20and.20region.20solving.html#185737214">(Jan 15 2020 at 19:54)</a>:</h4>
<p>I misunderstood it at first</p>



<a name="185737422"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2367681%20and%20region%20solving/near/185737422" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Matthew Jasper <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2367681.20and.20region.20solving.html#185737422">(Jan 15 2020 at 19:56)</a>:</h4>
<blockquote>
<p>(also, I'm trying to remember what the PR you had was...)</p>
</blockquote>
<p>It moves opaque type region inference to borrow checking.</p>



<a name="185737447"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2367681%20and%20region%20solving/near/185737447" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2367681.20and.20region.20solving.html#185737447">(Jan 15 2020 at 19:56)</a>:</h4>
<p>ah right right</p>



<a name="185737454"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2367681%20and%20region%20solving/near/185737454" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2367681.20and.20region.20solving.html#185737454">(Jan 15 2020 at 19:56)</a>:</h4>
<p>so as far as visiting expressions in regionck</p>



<a name="185737475"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2367681%20and%20region%20solving/near/185737475" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2367681.20and.20region.20solving.html#185737475">(Jan 15 2020 at 19:57)</a>:</h4>
<p>I think maybe some aspects of WF checking were triggered by that?</p>



<a name="185737487"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2367681%20and%20region%20solving/near/185737487" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2367681.20and.20region.20solving.html#185737487">(Jan 15 2020 at 19:57)</a>:</h4>
<p>trying to remember, there is something "special" about a type outliving the empty region</p>



<a name="185737509"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2367681%20and%20region%20solving/near/185737509" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2367681.20and.20region.20solving.html#185737509">(Jan 15 2020 at 19:57)</a>:</h4>
<p>re: my PR, I was hoping that we land it with the leak-check on "life support"</p>



<a name="185737527"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2367681%20and%20region%20solving/near/185737527" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2367681.20and.20region.20solving.html#185737527">(Jan 15 2020 at 19:57)</a>:</h4>
<p>and then at next release maybe rip it out, hopefully that gives a bit of transition? I'd hope it's short</p>



<a name="185737537"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2367681%20and%20region%20solving/near/185737537" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2367681.20and.20region.20solving.html#185737537">(Jan 15 2020 at 19:57)</a>:</h4>
<p>I still feel a bit uncomfortable, like how best to explain what we are doing and "why"</p>



<a name="185737589"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2367681%20and%20region%20solving/near/185737589" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2367681.20and.20region.20solving.html#185737589">(Jan 15 2020 at 19:58)</a>:</h4>
<p>but I also like that this gives some time to write the code in NLL checker that I didn't get to</p>



<a name="185737638"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2367681%20and%20region%20solving/near/185737638" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2367681.20and.20region.20solving.html#185737638">(Jan 15 2020 at 19:58)</a>:</h4>
<blockquote>
<p>I still feel a bit uncomfortable, like how best to explain what we are doing and "why"</p>
</blockquote>
<p>I think it probably suffices to say: </p>
<p>We are pursuing a model of region checking that is maximally conservative in some sense, and fixing lots of existing bugs in the current code.</p>



<a name="185737714"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2367681%20and%20region%20solving/near/185737714" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2367681.20and.20region.20solving.html#185737714">(Jan 15 2020 at 19:59)</a>:</h4>
<p>the maximally conservative part refers to this balance of "how much checking takes place eagerly, and hence effects subtyping" and "how much takes place in region checking" -- or just kind of -- where do region constraints get evaluated</p>



<a name="185737866"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2367681%20and%20region%20solving/near/185737866" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2367681.20and.20region.20solving.html#185737866">(Jan 15 2020 at 20:00)</a>:</h4>
<p>I feel I can write up an explanation around this, maybe make a tracking issue, though I think ideally I would want to have an RFC  (though it would be the sort of RFC that nobody reads but <span class="user-mention silent" data-user-id="126804">Ariel Ben-Yehuda</span>, no doubt =)</p>



<a name="185737899"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2367681%20and%20region%20solving/near/185737899" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2367681.20and.20region.20solving.html#185737899">(Jan 15 2020 at 20:01)</a>:</h4>
<p>but I think an RFC would be better for when we sort of know the "full answer", and/or part of describing chalk/polonius</p>



<a name="185737921"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2367681%20and%20region%20solving/near/185737921" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2367681.20and.20region.20solving.html#185737921">(Jan 15 2020 at 20:01)</a>:</h4>
<p>anyway I think your plan for moving regions makes sense</p>



<a name="185737929"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2367681%20and%20region%20solving/near/185737929" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2367681.20and.20region.20solving.html#185737929">(Jan 15 2020 at 20:01)</a>:</h4>
<p>do we have a tracking issue for this?</p>



<a name="185738015"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2367681%20and%20region%20solving/near/185738015" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Matthew Jasper <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2367681.20and.20region.20solving.html#185738015">(Jan 15 2020 at 20:02)</a>:</h4>
<p>No. I was going to create one after this and I had a bit more clarity on the goal.</p>



<a name="185738057"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2367681%20and%20region%20solving/near/185738057" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2367681.20and.20region.20solving.html#185738057">(Jan 15 2020 at 20:02)</a>:</h4>
<p>I'm pondering the part about</p>



<a name="185738066"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2367681%20and%20region%20solving/near/185738066" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2367681.20and.20region.20solving.html#185738066">(Jan 15 2020 at 20:02)</a>:</h4>
<p>well first off</p>



<a name="185738075"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2367681%20and%20region%20solving/near/185738075" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2367681.20and.20region.20solving.html#185738075">(Jan 15 2020 at 20:02)</a>:</h4>
<blockquote>
<p>That list gets us about half way. I guess that the long term goal is to not even create <code>ReVar</code>s?</p>
</blockquote>
<p>to come back to this</p>



<a name="185738086"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2367681%20and%20region%20solving/near/185738086" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2367681.20and.20region.20solving.html#185738086">(Jan 15 2020 at 20:02)</a>:</h4>
<p>yeah I mean in my <em>ideal</em> world</p>



<a name="185738102"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2367681%20and%20region%20solving/near/185738102" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2367681.20and.20region.20solving.html#185738102">(Jan 15 2020 at 20:02)</a>:</h4>
<p>we'd be erasing regions as we bring things "into scope" of the type checker</p>



<a name="185738119"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2367681%20and%20region%20solving/near/185738119" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2367681.20and.20region.20solving.html#185738119">(Jan 15 2020 at 20:03)</a>:</h4>
<p>this would also improve caching, presumably, between functions</p>



<a name="185738243"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2367681%20and%20region%20solving/near/185738243" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Matthew Jasper <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2367681.20and.20region.20solving.html#185738243">(Jan 15 2020 at 20:04)</a>:</h4>
<p>Indeed. And maybe reduce the number of types we're interning.</p>



<a name="185738263"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2367681%20and%20region%20solving/near/185738263" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2367681.20and.20region.20solving.html#185738263">(Jan 15 2020 at 20:04)</a>:</h4>
<p>right</p>



<a name="185738274"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2367681%20and%20region%20solving/near/185738274" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2367681.20and.20region.20solving.html#185738274">(Jan 15 2020 at 20:04)</a>:</h4>
<p>so I guess that is my goal :)</p>



<a name="185738315"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2367681%20and%20region%20solving/near/185738315" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2367681.20and.20region.20solving.html#185738315">(Jan 15 2020 at 20:04)</a>:</h4>
<p>I'm still pondering the part about:</p>
<p>keep running regionck without running the region solver</p>



<a name="185738335"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2367681%20and%20region%20solving/near/185738335" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2367681.20and.20region.20solving.html#185738335">(Jan 15 2020 at 20:05)</a>:</h4>
<p>are there checks that it does that we would have to do elsewhere?</p>



<a name="185738346"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2367681%20and%20region%20solving/near/185738346" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2367681.20and.20region.20solving.html#185738346">(Jan 15 2020 at 20:05)</a>:</h4>
<p>is it just a matter of bad error messages or something?</p>



<a name="185738354"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2367681%20and%20region%20solving/near/185738354" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2367681.20and.20region.20solving.html#185738354">(Jan 15 2020 at 20:05)</a>:</h4>
<p>I remember being not very happy about the hacks around "outlives 'empty"</p>



<a name="185738369"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2367681%20and%20region%20solving/near/185738369" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2367681.20and.20region.20solving.html#185738369">(Jan 15 2020 at 20:05)</a>:</h4>
<p>and in particular the checks that say "is this 'empty? if so, return" that we use to avoid ICEs</p>



<a name="185738373"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2367681%20and%20region%20solving/near/185738373" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2367681.20and.20region.20solving.html#185738373">(Jan 15 2020 at 20:05)</a>:</h4>
<p>but I sort of forget if I had a different sol'n in mind</p>



<a name="185738445"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2367681%20and%20region%20solving/near/185738445" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Matthew Jasper <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2367681.20and.20region.20solving.html#185738445">(Jan 15 2020 at 20:06)</a>:</h4>
<p>It can also cause <code>dropck_outlives</code> to run which hides the hang that <a href="https://github.com/rust-lang/rust/pull/67731" target="_blank" title="https://github.com/rust-lang/rust/pull/67731">https://github.com/rust-lang/rust/pull/67731</a> fixes.</p>



<a name="185738518"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2367681%20and%20region%20solving/near/185738518" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2367681.20and.20region.20solving.html#185738518">(Jan 15 2020 at 20:07)</a>:</h4>
<p>but NLL subsumes that check, right?</p>



<a name="185738607"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2367681%20and%20region%20solving/near/185738607" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Matthew Jasper <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2367681.20and.20region.20solving.html#185738607">(Jan 15 2020 at 20:08)</a>:</h4>
<p>I think NLL skips it for types with no free lifetimes (in fact, no free lifetimes that don't contain a universal region atm)</p>



<a name="185738670"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2367681%20and%20region%20solving/near/185738670" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2367681.20and.20region.20solving.html#185738670">(Jan 15 2020 at 20:09)</a>:</h4>
<p>is that a problem?</p>



<a name="185738684"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2367681%20and%20region%20solving/near/185738684" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Matthew Jasper <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2367681.20and.20region.20solving.html#185738684">(Jan 15 2020 at 20:09)</a>:</h4>
<p>Not with that PR.</p>



<a name="185738734"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2367681%20and%20region%20solving/near/185738734" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2367681.20and.20region.20solving.html#185738734">(Jan 15 2020 at 20:09)</a>:</h4>
<p>ok =)</p>



<a name="185738965"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2367681%20and%20region%20solving/near/185738965" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2367681.20and.20region.20solving.html#185738965">(Jan 15 2020 at 20:12)</a>:</h4>
<p>well, ok, then I'll get to work on those modifications to leak check PR ;)</p>



<a name="185738966"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2367681%20and%20region%20solving/near/185738966" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2367681.20and.20region.20solving.html#185738966">(Jan 15 2020 at 20:12)</a>:</h4>
<p>and you create tracking issue :)</p>



<a name="185738975"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2367681%20and%20region%20solving/near/185738975" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2367681.20and.20region.20solving.html#185738975">(Jan 15 2020 at 20:12)</a>:</h4>
<p>we'll figure out the next steps after that</p>



<a name="185739035"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2367681%20and%20region%20solving/near/185739035" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Matthew Jasper <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2367681.20and.20region.20solving.html#185739035">(Jan 15 2020 at 20:13)</a>:</h4>
<p><span aria-label="+1" class="emoji emoji-1f44d" role="img" title="+1">:+1:</span></p>



<a name="185739145"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2367681%20and%20region%20solving/near/185739145" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Matthew Jasper <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2367681.20and.20region.20solving.html#185739145">(Jan 15 2020 at 20:14)</a>:</h4>
<p>This issue title is something like "Don't infer regions in type checking"?</p>



<a name="185739171"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2367681%20and%20region%20solving/near/185739171" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2367681.20and.20region.20solving.html#185739171">(Jan 15 2020 at 20:14)</a>:</h4>
<p>Did you see <a href="https://github.com/rust-lang/rust/pull/67911" target="_blank" title="https://github.com/rust-lang/rust/pull/67911">https://github.com/rust-lang/rust/pull/67911</a> ?</p>



<a name="185739176"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2367681%20and%20region%20solving/near/185739176" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2367681.20and.20region.20solving.html#185739176">(Jan 15 2020 at 20:14)</a>:</h4>
<p>you are assigned to it, I guess</p>



<a name="185739189"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2367681%20and%20region%20solving/near/185739189" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2367681.20and.20region.20solving.html#185739189">(Jan 15 2020 at 20:15)</a>:</h4>
<p>are my concerns correct, that this approach won't work?</p>



<a name="185739201"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2367681%20and%20region%20solving/near/185739201" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2367681.20and.20region.20solving.html#185739201">(Jan 15 2020 at 20:15)</a>:</h4>
<p>or am I missing something :)</p>



<a name="185739258"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2367681%20and%20region%20solving/near/185739258" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Matthew Jasper <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2367681.20and.20region.20solving.html#185739258">(Jan 15 2020 at 20:15)</a>:</h4>
<p>I agree that this doesn't currently work. I haven't had time to think about how best to go about fixing it.</p>



<a name="185739419"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2367681%20and%20region%20solving/near/185739419" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2367681.20and.20region.20solving.html#185739419">(Jan 15 2020 at 20:17)</a>:</h4>
<p>OK, me neither</p>



<a name="185740314"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2367681%20and%20region%20solving/near/185740314" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Matthew Jasper <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2367681.20and.20region.20solving.html#185740314">(Jan 15 2020 at 20:25)</a>:</h4>
<p>Opened <a href="https://github.com/rust-lang/rust/issues/68261" target="_blank" title="https://github.com/rust-lang/rust/issues/68261">#68261</a></p>



<hr><p>Last updated: Apr 12 2022 at 20:01 UTC</p>
</html>