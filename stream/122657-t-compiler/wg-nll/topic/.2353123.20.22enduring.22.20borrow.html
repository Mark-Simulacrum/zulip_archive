<html>
<head><meta charset="utf-8"><title>#53123 &quot;enduring&quot; borrow · t-compiler/wg-nll · Zulip Chat Archive</title></head>
<h2>Stream: <a href="https://rust-lang.github.io/zulip_archive/stream/122657-t-compiler/wg-nll/index.html">t-compiler/wg-nll</a></h2>
<h3>Topic: <a href="https://rust-lang.github.io/zulip_archive/stream/122657-t-compiler/wg-nll/topic/.2353123.20.22enduring.22.20borrow.html">#53123 &quot;enduring&quot; borrow</a></h3>

<hr>

<base href="https://rust-lang.zulipchat.com">

<head><link href="https://rust-lang.github.io/zulip_archive/style.css" rel="stylesheet"></head>

<a name="131122205"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2353123%20%22enduring%22%20borrow/near/131122205" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://rust-lang.github.io/zulip_archive/stream/122657-t-compiler/wg-nll/topic/.2353123.20.22enduring.22.20borrow.html#131122205">(Aug 08 2018 at 17:41)</a>:</h4>
<p>I'm creating a topic thread for <a href="https://github.com/rust-lang/rust/issues/53123" target="_blank" title="https://github.com/rust-lang/rust/issues/53123">#53123</a>. <span class="user-mention" data-user-id="117350">@Sunjay Varma</span> may take a look.</p>



<a name="131122266"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2353123%20%22enduring%22%20borrow/near/131122266" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://rust-lang.github.io/zulip_archive/stream/122657-t-compiler/wg-nll/topic/.2353123.20.22enduring.22.20borrow.html#131122266">(Aug 08 2018 at 17:42)</a>:</h4>
<p>I can assign the issue to you <span class="user-mention" data-user-id="117350">@Sunjay Varma</span>, if you want to "commit" (at least for now..)</p>



<a name="131122389"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2353123%20%22enduring%22%20borrow/near/131122389" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sunjay Varma <a href="https://rust-lang.github.io/zulip_archive/stream/122657-t-compiler/wg-nll/topic/.2353123.20.22enduring.22.20borrow.html#131122389">(Aug 08 2018 at 17:45)</a>:</h4>
<p>Hello! Hopefully I am using Zulip right</p>



<a name="131124367"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2353123%20%22enduring%22%20borrow/near/131124367" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sunjay Varma <a href="https://rust-lang.github.io/zulip_archive/stream/122657-t-compiler/wg-nll/topic/.2353123.20.22enduring.22.20borrow.html#131124367">(Aug 08 2018 at 18:16)</a>:</h4>
<p><span class="user-mention" data-user-id="116009">@nikomatsakis</span> Ok. So do you want to play around with <code>candidate_should_be_dropped_in_favor_of</code> or look at the alternate solution?</p>



<a name="131124405"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2353123%20%22enduring%22%20borrow/near/131124405" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://rust-lang.github.io/zulip_archive/stream/122657-t-compiler/wg-nll/topic/.2353123.20.22enduring.22.20borrow.html#131124405">(Aug 08 2018 at 18:17)</a>:</h4>
<p>I think I would prefer to start by playing around with <code>candidate_should_be_dropped_in_favor_of</code></p>



<a name="131124407"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2353123%20%22enduring%22%20borrow/near/131124407" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://rust-lang.github.io/zulip_archive/stream/122657-t-compiler/wg-nll/topic/.2353123.20.22enduring.22.20borrow.html#131124407">(Aug 08 2018 at 18:17)</a>:</h4>
<p>the NLL hack is sort of a "fallback"</p>



<a name="131124646"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2353123%20%22enduring%22%20borrow/near/131124646" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sunjay Varma <a href="https://rust-lang.github.io/zulip_archive/stream/122657-t-compiler/wg-nll/topic/.2353123.20.22enduring.22.20borrow.html#131124646">(Aug 08 2018 at 18:22)</a>:</h4>
<p>It's my first time in the borrowing/lifetimes code. Can you give me a bit of an overview? It would be helpful to understand <code>candidate_should_be_dropped_in_favor_of</code></p>



<a name="131124655"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2353123%20%22enduring%22%20borrow/near/131124655" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://rust-lang.github.io/zulip_archive/stream/122657-t-compiler/wg-nll/topic/.2353123.20.22enduring.22.20borrow.html#131124655">(Aug 08 2018 at 18:22)</a>:</h4>
<p>well that code is really not concerned with borrowing or lietimes</p>



<a name="131124660"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2353123%20%22enduring%22%20borrow/near/131124660" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://rust-lang.github.io/zulip_archive/stream/122657-t-compiler/wg-nll/topic/.2353123.20.22enduring.22.20borrow.html#131124660">(Aug 08 2018 at 18:22)</a>:</h4>
<p>it is in the trait solver</p>



<a name="131124668"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2353123%20%22enduring%22%20borrow/near/131124668" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://rust-lang.github.io/zulip_archive/stream/122657-t-compiler/wg-nll/topic/.2353123.20.22enduring.22.20borrow.html#131124668">(Aug 08 2018 at 18:22)</a>:</h4>
<p>Ye Olde Crappy Trait solver, that is</p>



<a name="131124672"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2353123%20%22enduring%22%20borrow/near/131124672" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://rust-lang.github.io/zulip_archive/stream/122657-t-compiler/wg-nll/topic/.2353123.20.22enduring.22.20borrow.html#131124672">(Aug 08 2018 at 18:22)</a>:</h4>
<p>rather than the New And Shiny Chalk ;)</p>



<a name="131124676"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2353123%20%22enduring%22%20borrow/near/131124676" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://rust-lang.github.io/zulip_archive/stream/122657-t-compiler/wg-nll/topic/.2353123.20.22enduring.22.20borrow.html#131124676">(Aug 08 2018 at 18:22)</a>:</h4>
<p>there is actually a write-up of how it works in the rustc guide I think</p>



<a name="131124681"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2353123%20%22enduring%22%20borrow/near/131124681" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://rust-lang.github.io/zulip_archive/stream/122657-t-compiler/wg-nll/topic/.2353123.20.22enduring.22.20borrow.html#131124681">(Aug 08 2018 at 18:22)</a>:</h4>
<p>I wonder how up to date it is</p>



<a name="131124708"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2353123%20%22enduring%22%20borrow/near/131124708" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://rust-lang.github.io/zulip_archive/stream/122657-t-compiler/wg-nll/topic/.2353123.20.22enduring.22.20borrow.html#131124708">(Aug 08 2018 at 18:23)</a>:</h4>
<p>the write-up is in the <a href="https://rust-lang-nursery.github.io/rustc-guide/traits/resolution.html" target="_blank" title="https://rust-lang-nursery.github.io/rustc-guide/traits/resolution.html">Trait Solving (Old Style)</a> chapter</p>



<a name="131124721"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2353123%20%22enduring%22%20borrow/near/131124721" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://rust-lang.github.io/zulip_archive/stream/122657-t-compiler/wg-nll/topic/.2353123.20.22enduring.22.20borrow.html#131124721">(Aug 08 2018 at 18:23)</a>:</h4>
<p>in particular, the <a href="https://rust-lang-nursery.github.io/rustc-guide/traits/resolution.html#winnowing-resolving-ambiguities" target="_blank" title="https://rust-lang-nursery.github.io/rustc-guide/traits/resolution.html#winnowing-resolving-ambiguities">section on winnowing</a></p>



<a name="131124775"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2353123%20%22enduring%22%20borrow/near/131124775" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sunjay Varma <a href="https://rust-lang.github.io/zulip_archive/stream/122657-t-compiler/wg-nll/topic/.2353123.20.22enduring.22.20borrow.html#131124775">(Aug 08 2018 at 18:24)</a>:</h4>
<p>/me reading</p>



<a name="131124912"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2353123%20%22enduring%22%20borrow/near/131124912" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sunjay Varma <a href="https://rust-lang.github.io/zulip_archive/stream/122657-t-compiler/wg-nll/topic/.2353123.20.22enduring.22.20borrow.html#131124912">(Aug 08 2018 at 18:26)</a>:</h4>
<blockquote>
<p>During type checking, we do not store the results of trait selection. We simply wish to verify that trait selection will succeed. Then later, at trans time, when we have all concrete types available, we can repeat the trait selection to choose an actual implementation, which will then be generated in the output binary.</p>
</blockquote>



<a name="131124924"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2353123%20%22enduring%22%20borrow/near/131124924" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sunjay Varma <a href="https://rust-lang.github.io/zulip_archive/stream/122657-t-compiler/wg-nll/topic/.2353123.20.22enduring.22.20borrow.html#131124924">(Aug 08 2018 at 18:26)</a>:</h4>
<p>Is there a downside to storing the selected trait?</p>



<a name="131124928"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2353123%20%22enduring%22%20borrow/near/131124928" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sunjay Varma <a href="https://rust-lang.github.io/zulip_archive/stream/122657-t-compiler/wg-nll/topic/.2353123.20.22enduring.22.20borrow.html#131124928">(Aug 08 2018 at 18:26)</a>:</h4>
<p>Why search for it twice?</p>



<a name="131124934"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2353123%20%22enduring%22%20borrow/near/131124934" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sunjay Varma <a href="https://rust-lang.github.io/zulip_archive/stream/122657-t-compiler/wg-nll/topic/.2353123.20.22enduring.22.20borrow.html#131124934">(Aug 08 2018 at 18:26)</a>:</h4>
<p>Are there some impls that can only be known at trans time?</p>



<a name="131124935"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2353123%20%22enduring%22%20borrow/near/131124935" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://rust-lang.github.io/zulip_archive/stream/122657-t-compiler/wg-nll/topic/.2353123.20.22enduring.22.20borrow.html#131124935">(Aug 08 2018 at 18:26)</a>:</h4>
<p>complexity, for one thing</p>



<a name="131124937"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2353123%20%22enduring%22%20borrow/near/131124937" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://rust-lang.github.io/zulip_archive/stream/122657-t-compiler/wg-nll/topic/.2353123.20.22enduring.22.20borrow.html#131124937">(Aug 08 2018 at 18:26)</a>:</h4>
<p>but also it doesn't play so well with specialization</p>



<a name="131124947"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2353123%20%22enduring%22%20borrow/near/131124947" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sunjay Varma <a href="https://rust-lang.github.io/zulip_archive/stream/122657-t-compiler/wg-nll/topic/.2353123.20.22enduring.22.20borrow.html#131124947">(Aug 08 2018 at 18:27)</a>:</h4>
<p>Ah okay makes sense</p>



<a name="131124948"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2353123%20%22enduring%22%20borrow/near/131124948" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sunjay Varma <a href="https://rust-lang.github.io/zulip_archive/stream/122657-t-compiler/wg-nll/topic/.2353123.20.22enduring.22.20borrow.html#131124948">(Aug 08 2018 at 18:27)</a>:</h4>
<p>Thanks</p>



<a name="131124958"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2353123%20%22enduring%22%20borrow/near/131124958" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://rust-lang.github.io/zulip_archive/stream/122657-t-compiler/wg-nll/topic/.2353123.20.22enduring.22.20borrow.html#131124958">(Aug 08 2018 at 18:27)</a>:</h4>
<p>in particular if we are checking a generic fn, we may find a generic impl, but once we know the concrete types, we can find a more narrow one</p>



<a name="131154919"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2353123%20%22enduring%22%20borrow/near/131154919" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sunjay Varma <a href="https://rust-lang.github.io/zulip_archive/stream/122657-t-compiler/wg-nll/topic/.2353123.20.22enduring.22.20borrow.html#131154919">(Aug 09 2018 at 07:02)</a>:</h4>
<p><span class="user-mention" data-user-id="116009">@nikomatsakis</span> Ok so I created a PR which adds the test case from the issue as a new run-pass test. As expected, the test currently fails. <a href="https://github.com/rust-lang/rust/pull/53212" target="_blank" title="https://github.com/rust-lang/rust/pull/53212">https://github.com/rust-lang/rust/pull/53212</a></p>



<a name="131154942"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2353123%20%22enduring%22%20borrow/near/131154942" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sunjay Varma <a href="https://rust-lang.github.io/zulip_archive/stream/122657-t-compiler/wg-nll/topic/.2353123.20.22enduring.22.20borrow.html#131154942">(Aug 09 2018 at 07:04)</a>:</h4>
<p>I printed out the arguments to <code>candidate_should_be_dropped_in_favor_of</code> and got the following:</p>
<div class="codehilite"><pre><span></span><span class="n">victim</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">EvaluatedCandidate</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="n">candidate</span>: <span class="nc">BuiltinCandidate</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">        </span><span class="n">has_nested</span>: <span class="nc">false</span><span class="w"></span>
<span class="w">    </span><span class="p">},</span><span class="w"></span>
<span class="w">    </span><span class="n">evaluation</span>: <span class="nc">EvaluatedToOk</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>
<span class="n">other</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">EvaluatedCandidate</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="n">candidate</span>: <span class="nc">ParamCandidate</span><span class="p">(</span><span class="w"></span>
<span class="w">        </span><span class="n">Binder</span><span class="p">(</span><span class="w"></span>
<span class="w">            </span><span class="o">&lt;&amp;</span><span class="na">&#39;a</span><span class="w"> </span><span class="k">mut</span><span class="w"> </span><span class="n">T</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">std</span>::<span class="n">marker</span>::<span class="nb">Sized</span><span class="o">&gt;</span><span class="w"></span>
<span class="w">        </span><span class="p">)</span><span class="w"></span>
<span class="w">    </span><span class="p">),</span><span class="w"></span>
<span class="w">    </span><span class="n">evaluation</span>: <span class="nc">EvaluatedToOk</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>
<span class="p">...</span><span class="w"></span>
<span class="n">victim</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">EvaluatedCandidate</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="n">candidate</span>: <span class="nc">BuiltinCandidate</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">        </span><span class="n">has_nested</span>: <span class="nc">false</span><span class="w"></span>
<span class="w">    </span><span class="p">},</span><span class="w"></span>
<span class="w">    </span><span class="n">evaluation</span>: <span class="nc">EvaluatedToOk</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>
<span class="n">other</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">EvaluatedCandidate</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="n">candidate</span>: <span class="nc">ParamCandidate</span><span class="p">(</span><span class="w"></span>
<span class="w">        </span><span class="n">Binder</span><span class="p">(</span><span class="w"></span>
<span class="w">            </span><span class="o">&lt;&amp;</span><span class="k">mut</span><span class="w"> </span><span class="n">T</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">std</span>::<span class="n">marker</span>::<span class="nb">Sized</span><span class="o">&gt;</span><span class="w"></span>
<span class="w">        </span><span class="p">)</span><span class="w"></span>
<span class="w">    </span><span class="p">),</span><span class="w"></span>
<span class="w">    </span><span class="n">evaluation</span>: <span class="nc">EvaluatedToOk</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>
</pre></div>



<a name="131154994"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2353123%20%22enduring%22%20borrow/near/131154994" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sunjay Varma <a href="https://rust-lang.github.io/zulip_archive/stream/122657-t-compiler/wg-nll/topic/.2353123.20.22enduring.22.20borrow.html#131154994">(Aug 09 2018 at 07:04)</a>:</h4>
<p>Tried out a few things here and there, but I'm not quite sure I completely understand the fix you're suggesting in the issue.</p>



<a name="131155014"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2353123%20%22enduring%22%20borrow/near/131155014" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sunjay Varma <a href="https://rust-lang.github.io/zulip_archive/stream/122657-t-compiler/wg-nll/topic/.2353123.20.22enduring.22.20borrow.html#131155014">(Aug 09 2018 at 07:05)</a>:</h4>
<p>It is taking me ridiculously long to make any progress because rustc takes a <strong>ridiculous</strong> amount of time to recompile every time I make even a tiny change (like adding logging)</p>



<a name="131155056"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2353123%20%22enduring%22%20borrow/near/131155056" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sunjay Varma <a href="https://rust-lang.github.io/zulip_archive/stream/122657-t-compiler/wg-nll/topic/.2353123.20.22enduring.22.20borrow.html#131155056">(Aug 09 2018 at 07:06)</a>:</h4>
<div class="codehilite"><pre><span></span>./x.py build -i --stage 1 --keep-stage 0 &amp;&amp; RUST_LOG=rustc::traits ./build/x86_64-unknown-linux-gnu/stage1/bin/rustc src/test/run-pass/nll/issue-53123-raw-pointer-cast.rs
</pre></div>



<a name="131155065"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2353123%20%22enduring%22%20borrow/near/131155065" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sunjay Varma <a href="https://rust-lang.github.io/zulip_archive/stream/122657-t-compiler/wg-nll/topic/.2353123.20.22enduring.22.20borrow.html#131155065">(Aug 09 2018 at 07:06)</a>:</h4>
<p>This is the entire command I'm running. Let me know if you have any tips :)</p>



<a name="131161974"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2353123%20%22enduring%22%20borrow/near/131161974" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://rust-lang.github.io/zulip_archive/stream/122657-t-compiler/wg-nll/topic/.2353123.20.22enduring.22.20borrow.html#131161974">(Aug 09 2018 at 10:00)</a>:</h4>
<p>hmm the command I usually do is this:</p>
<div class="codehilite"><pre><span></span><span class="p">.</span><span class="o">/</span><span class="n">x</span><span class="p">.</span><span class="n">py</span><span class="w"> </span><span class="n">build</span><span class="w"> </span><span class="o">-</span><span class="n">i</span><span class="w"> </span><span class="o">--</span><span class="n">stage</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="o">--</span><span class="n">keep</span><span class="o">-</span><span class="n">stage</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="n">std</span><span class="o">/</span><span class="n">libstd</span><span class="w"></span>
</pre></div>


<p>and I find that adding logging or other small deltas are usually not that slow</p>



<a name="131161989"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2353123%20%22enduring%22%20borrow/near/131161989" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://rust-lang.github.io/zulip_archive/stream/122657-t-compiler/wg-nll/topic/.2353123.20.22enduring.22.20borrow.html#131161989">(Aug 09 2018 at 10:01)</a>:</h4>
<p>the change I was proposing to fix the issue would be to modify the <code>candidate_should_be_dropped_in_favor_of</code> so that it prefers a <code>BuiltinCandidate</code> -- specifically, a <code>BuiltinCandidate</code> with <code>has_nested: false</code> -- to any other</p>



<a name="131161992"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2353123%20%22enduring%22%20borrow/near/131161992" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://rust-lang.github.io/zulip_archive/stream/122657-t-compiler/wg-nll/topic/.2353123.20.22enduring.22.20borrow.html#131161992">(Aug 09 2018 at 10:01)</a>:</h4>
<p>the <code>has_nested: false</code> means that there are no <em>further</em> obligations</p>



<a name="131162036"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2353123%20%22enduring%22%20borrow/near/131162036" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://rust-lang.github.io/zulip_archive/stream/122657-t-compiler/wg-nll/topic/.2353123.20.22enduring.22.20borrow.html#131162036">(Aug 09 2018 at 10:02)</a>:</h4>
<p>I think all of our built-in candidates  are very general</p>



<a name="131162039"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2353123%20%22enduring%22%20borrow/near/131162039" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://rust-lang.github.io/zulip_archive/stream/122657-t-compiler/wg-nll/topic/.2353123.20.22enduring.22.20borrow.html#131162039">(Aug 09 2018 at 10:02)</a>:</h4>
<p>so this would be the most accepting thing we can do</p>



<a name="131162921"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2353123%20%22enduring%22%20borrow/near/131162921" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://rust-lang.github.io/zulip_archive/stream/122657-t-compiler/wg-nll/topic/.2353123.20.22enduring.22.20borrow.html#131162921">(Aug 09 2018 at 10:23)</a>:</h4>
<p>another pattern that I use a lot <span class="user-mention" data-user-id="117350">@Sunjay Varma</span> is to do <code>./x.py check</code> all the time until I am ready to test</p>



<a name="131162923"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2353123%20%22enduring%22%20borrow/near/131162923" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://rust-lang.github.io/zulip_archive/stream/122657-t-compiler/wg-nll/topic/.2353123.20.22enduring.22.20borrow.html#131162923">(Aug 09 2018 at 10:23)</a>:</h4>
<p>I guess that won't help here</p>



<a name="131193501"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2353123%20%22enduring%22%20borrow/near/131193501" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sunjay Varma <a href="https://rust-lang.github.io/zulip_archive/stream/122657-t-compiler/wg-nll/topic/.2353123.20.22enduring.22.20borrow.html#131193501">(Aug 09 2018 at 19:42)</a>:</h4>
<p>If I pass <code>src/libstd</code> to the build command, won't it only build the standard library? I need it to build the trait solver</p>



<a name="131193530"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2353123%20%22enduring%22%20borrow/near/131193530" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sunjay Varma <a href="https://rust-lang.github.io/zulip_archive/stream/122657-t-compiler/wg-nll/topic/.2353123.20.22enduring.22.20borrow.html#131193530">(Aug 09 2018 at 19:43)</a>:</h4>
<p>Also, if you <code>--keep-stage 1</code>, won't it not build stage 1 at all?</p>



<a name="131193586"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2353123%20%22enduring%22%20borrow/near/131193586" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> simulacrum <a href="https://rust-lang.github.io/zulip_archive/stream/122657-t-compiler/wg-nll/topic/.2353123.20.22enduring.22.20borrow.html#131193586">(Aug 09 2018 at 19:44)</a>:</h4>
<p>Right, that command will rebuild the stage 0 compiler but skip rebuilding stage 1 std</p>



<a name="131193588"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2353123%20%22enduring%22%20borrow/near/131193588" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> simulacrum <a href="https://rust-lang.github.io/zulip_archive/stream/122657-t-compiler/wg-nll/topic/.2353123.20.22enduring.22.20borrow.html#131193588">(Aug 09 2018 at 19:44)</a>:</h4>
<p>which gives you a mostly fully functioning compiler</p>



<a name="131193594"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2353123%20%22enduring%22%20borrow/near/131193594" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sunjay Varma <a href="https://rust-lang.github.io/zulip_archive/stream/122657-t-compiler/wg-nll/topic/.2353123.20.22enduring.22.20borrow.html#131193594">(Aug 09 2018 at 19:44)</a>:</h4>
<p>I guess the docs here are a bit misleading then: <a href="https://rust-lang-nursery.github.io/rustc-guide/how-to-build-and-run.html#running-xpy-and-building-a-stage1-compiler" target="_blank" title="https://rust-lang-nursery.github.io/rustc-guide/how-to-build-and-run.html#running-xpy-and-building-a-stage1-compiler">https://rust-lang-nursery.github.io/rustc-guide/how-to-build-and-run.html#running-xpy-and-building-a-stage1-compiler</a></p>



<a name="131193597"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2353123%20%22enduring%22%20borrow/near/131193597" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sunjay Varma <a href="https://rust-lang.github.io/zulip_archive/stream/122657-t-compiler/wg-nll/topic/.2353123.20.22enduring.22.20borrow.html#131193597">(Aug 09 2018 at 19:44)</a>:</h4>
<p>Stage 0 is built from my local checkout?</p>



<a name="131193601"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2353123%20%22enduring%22%20borrow/near/131193601" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sunjay Varma <a href="https://rust-lang.github.io/zulip_archive/stream/122657-t-compiler/wg-nll/topic/.2353123.20.22enduring.22.20borrow.html#131193601">(Aug 09 2018 at 19:44)</a>:</h4>
<p>From those docs:</p>
<blockquote>
<p>Stage 0: the stage0 compiler can be your existing (perhaps older version of) Rust compiler, the current beta compiler or you may download the binary from the internet.</p>
</blockquote>



<a name="131193766"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2353123%20%22enduring%22%20borrow/near/131193766" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> simulacrum <a href="https://rust-lang.github.io/zulip_archive/stream/122657-t-compiler/wg-nll/topic/.2353123.20.22enduring.22.20borrow.html#131193766">(Aug 09 2018 at 19:48)</a>:</h4>
<p>Yes stage 0 compiler artifacts (stage1/bin/rustc)</p>



<a name="131193795"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2353123%20%22enduring%22%20borrow/near/131193795" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sunjay Varma <a href="https://rust-lang.github.io/zulip_archive/stream/122657-t-compiler/wg-nll/topic/.2353123.20.22enduring.22.20borrow.html#131193795">(Aug 09 2018 at 19:49)</a>:</h4>
<p>Ohhh. The result of stage 0 is stage 1. That makes sense actually. Thanks!</p>



<a name="131193873"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2353123%20%22enduring%22%20borrow/near/131193873" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sunjay Varma <a href="https://rust-lang.github.io/zulip_archive/stream/122657-t-compiler/wg-nll/topic/.2353123.20.22enduring.22.20borrow.html#131193873">(Aug 09 2018 at 19:50)</a>:</h4>
<p>So is the command I want to use <code>./x.py build -i --stage 1 --keep-stage 0 src/librustc</code>?</p>



<a name="131193880"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2353123%20%22enduring%22%20borrow/near/131193880" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sunjay Varma <a href="https://rust-lang.github.io/zulip_archive/stream/122657-t-compiler/wg-nll/topic/.2353123.20.22enduring.22.20borrow.html#131193880">(Aug 09 2018 at 19:50)</a>:</h4>
<p>I tried <code>--keep-stage 1</code> but I got some warnings and panics</p>



<a name="131193885"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2353123%20%22enduring%22%20borrow/near/131193885" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sunjay Varma <a href="https://rust-lang.github.io/zulip_archive/stream/122657-t-compiler/wg-nll/topic/.2353123.20.22enduring.22.20borrow.html#131193885">(Aug 09 2018 at 19:50)</a>:</h4>
<div class="codehilite"><pre><span></span>Updating only changed submodules
Submodules updated in 0.04 seconds
    Finished dev [unoptimized] target(s) in 0.19s
Building stage0 std artifacts (x86_64-unknown-linux-gnu -&gt; x86_64-unknown-linux-gnu)
    Finished release [optimized] target(s) in 0.21s
Copying stage0 std from stage0 (x86_64-unknown-linux-gnu -&gt; x86_64-unknown-linux-gnu / x86_64-unknown-linux-gnu)
Building stage0 test artifacts (x86_64-unknown-linux-gnu -&gt; x86_64-unknown-linux-gnu)
    Finished release [optimized] target(s) in 0.18s
Copying stage0 test from stage0 (x86_64-unknown-linux-gnu -&gt; x86_64-unknown-linux-gnu / x86_64-unknown-linux-gnu)
Building stage0 compiler artifacts (x86_64-unknown-linux-gnu -&gt; x86_64-unknown-linux-gnu)
    Finished release [optimized] target(s) in 0.23s
Copying stage0 rustc from stage0 (x86_64-unknown-linux-gnu -&gt; x86_64-unknown-linux-gnu / x86_64-unknown-linux-gnu)
Building stage0 codegen artifacts (x86_64-unknown-linux-gnu -&gt; x86_64-unknown-linux-gnu, llvm)
    Finished release [optimized] target(s) in 0.19s
Assembling stage1 compiler (x86_64-unknown-linux-gnu)
Warning: Using a potentially old libstd. This may not behave well.
Copying stage1 std from stage1 (x86_64-unknown-linux-gnu -&gt; x86_64-unknown-linux-gnu / x86_64-unknown-linux-gnu)
thread &#39;main&#39; panicked at &#39;File::open(stamp) failed with No such file or directory (os error 2)&#39;, bootstrap/lib.rs:1109:12
note: Run with `RUST_BACKTRACE=1` for a backtrace.
failed to run: /home/sunjay/Documents/projects/rust/build/bootstrap/debug/bootstrap build -i --stage 1 --keep-stage 1 src/librustc
</pre></div>



<a name="131194220"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2353123%20%22enduring%22%20borrow/near/131194220" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> simulacrum <a href="https://rust-lang.github.io/zulip_archive/stream/122657-t-compiler/wg-nll/topic/.2353123.20.22enduring.22.20borrow.html#131194220">(Aug 09 2018 at 19:58)</a>:</h4>
<p>Yeah so you need to build once without it</p>



<a name="131194225"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2353123%20%22enduring%22%20borrow/near/131194225" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> simulacrum <a href="https://rust-lang.github.io/zulip_archive/stream/122657-t-compiler/wg-nll/topic/.2353123.20.22enduring.22.20borrow.html#131194225">(Aug 09 2018 at 19:58)</a>:</h4>
<p>Then add it</p>



<a name="131194874"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2353123%20%22enduring%22%20borrow/near/131194874" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://rust-lang.github.io/zulip_archive/stream/122657-t-compiler/wg-nll/topic/.2353123.20.22enduring.22.20borrow.html#131194874">(Aug 09 2018 at 20:13)</a>:</h4>
<p><span class="user-mention" data-user-id="117350">@Sunjay Varma</span> I usually use <code>--keep-stage 1</code> personally -- if I get problems, I take it away for one cycle :)</p>



<a name="131194877"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2353123%20%22enduring%22%20borrow/near/131194877" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://rust-lang.github.io/zulip_archive/stream/122657-t-compiler/wg-nll/topic/.2353123.20.22enduring.22.20borrow.html#131194877">(Aug 09 2018 at 20:13)</a>:</h4>
<p>but I don't really know what <code>--keep-stage 0</code> does :)</p>



<a name="131194952"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2353123%20%22enduring%22%20borrow/near/131194952" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sunjay Varma <a href="https://rust-lang.github.io/zulip_archive/stream/122657-t-compiler/wg-nll/topic/.2353123.20.22enduring.22.20borrow.html#131194952">(Aug 09 2018 at 20:15)</a>:</h4>
<p>Currently building stage 1. I'll try it with <code>--keep-stage 1</code> after that :)</p>



<a name="131194953"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2353123%20%22enduring%22%20borrow/near/131194953" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sunjay Varma <a href="https://rust-lang.github.io/zulip_archive/stream/122657-t-compiler/wg-nll/topic/.2353123.20.22enduring.22.20borrow.html#131194953">(Aug 09 2018 at 20:15)</a>:</h4>
<p>Thanks for both of your help!</p>



<a name="131195260"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2353123%20%22enduring%22%20borrow/near/131195260" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sunjay Varma <a href="https://rust-lang.github.io/zulip_archive/stream/122657-t-compiler/wg-nll/topic/.2353123.20.22enduring.22.20borrow.html#131195260">(Aug 09 2018 at 20:23)</a>:</h4>
<p><code>./x.py build -i --stage 1 --keep-stage 1 src/librustc</code> compiles fast!</p>



<a name="131195313"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2353123%20%22enduring%22%20borrow/near/131195313" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://rust-lang.github.io/zulip_archive/stream/122657-t-compiler/wg-nll/topic/.2353123.20.22enduring.22.20borrow.html#131195313">(Aug 09 2018 at 20:23)</a>:</h4>
<p>yes, yes it does.</p>



<a name="131195447"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2353123%20%22enduring%22%20borrow/near/131195447" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> simulacrum <a href="https://rust-lang.github.io/zulip_archive/stream/122657-t-compiler/wg-nll/topic/.2353123.20.22enduring.22.20borrow.html#131195447">(Aug 09 2018 at 20:26)</a>:</h4>
<p>Though you probably want src/libstd as skipping librustc/compiling it is useless</p>



<a name="131195475"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2353123%20%22enduring%22%20borrow/near/131195475" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sunjay Varma <a href="https://rust-lang.github.io/zulip_archive/stream/122657-t-compiler/wg-nll/topic/.2353123.20.22enduring.22.20borrow.html#131195475">(Aug 09 2018 at 20:27)</a>:</h4>
<p><a href="/user_uploads/4715/a4FHprs819k1T4YsRfHmZM6U/pasted_image.png" target="_blank" title="pasted_image.png">pasted image</a></p>
<div class="message_inline_image"><a href="/user_uploads/4715/a4FHprs819k1T4YsRfHmZM6U/pasted_image.png" target="_blank" title="pasted image"><img src="/user_uploads/4715/a4FHprs819k1T4YsRfHmZM6U/pasted_image.png"></a></div>



<a name="131195483"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2353123%20%22enduring%22%20borrow/near/131195483" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sunjay Varma <a href="https://rust-lang.github.io/zulip_archive/stream/122657-t-compiler/wg-nll/topic/.2353123.20.22enduring.22.20borrow.html#131195483">(Aug 09 2018 at 20:27)</a>:</h4>
<p>Isn't the path what you are asking it to compile?</p>



<a name="131195485"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2353123%20%22enduring%22%20borrow/near/131195485" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sunjay Varma <a href="https://rust-lang.github.io/zulip_archive/stream/122657-t-compiler/wg-nll/topic/.2353123.20.22enduring.22.20borrow.html#131195485">(Aug 09 2018 at 20:27)</a>:</h4>
<p>It won't skip librustc</p>



<a name="131195543"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2353123%20%22enduring%22%20borrow/near/131195543" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> simulacrum <a href="https://rust-lang.github.io/zulip_archive/stream/122657-t-compiler/wg-nll/topic/.2353123.20.22enduring.22.20borrow.html#131195543">(Aug 09 2018 at 20:28)</a>:</h4>
<p>src/libstd is what you'd want</p>



<a name="131195658"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2353123%20%22enduring%22%20borrow/near/131195658" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sunjay Varma <a href="https://rust-lang.github.io/zulip_archive/stream/122657-t-compiler/wg-nll/topic/.2353123.20.22enduring.22.20borrow.html#131195658">(Aug 09 2018 at 20:31)</a>:</h4>
<p>Sorry, I'm trying to understand what you're recommending. The file I'm editing is <code>src/librustc/traits/select.rs</code>. Why pass <code>src/libstd</code> instead of <code>src/librustc</code>?</p>



<a name="131195789"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2353123%20%22enduring%22%20borrow/near/131195789" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://rust-lang.github.io/zulip_archive/stream/122657-t-compiler/wg-nll/topic/.2353123.20.22enduring.22.20borrow.html#131195789">(Aug 09 2018 at 20:34)</a>:</h4>
<p><span class="user-mention" data-user-id="117350">@Sunjay Varma</span> the point is that there is a sequence of things to build:</p>
<ul>
<li>(stage 0) libstd</li>
<li>(stage 0) rustc</li>
<li>(stage 1) libstd</li>
<li>(stage 1) rustc</li>
</ul>



<a name="131195799"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2353123%20%22enduring%22%20borrow/near/131195799" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://rust-lang.github.io/zulip_archive/stream/122657-t-compiler/wg-nll/topic/.2353123.20.22enduring.22.20borrow.html#131195799">(Aug 09 2018 at 20:34)</a>:</h4>
<p>so when you say <code>--stage 1 src/libstd</code>, you build everything up to there-- which includes rustc built by the stage0 compiler</p>



<a name="131195927"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2353123%20%22enduring%22%20borrow/near/131195927" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sunjay Varma <a href="https://rust-lang.github.io/zulip_archive/stream/122657-t-compiler/wg-nll/topic/.2353123.20.22enduring.22.20borrow.html#131195927">(Aug 09 2018 at 20:37)</a>:</h4>
<p>Oh! That makes sense! I wish that was explained in the rustc-guide (if it is, we should move it to the section about building rustc)</p>



<a name="131195928"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2353123%20%22enduring%22%20borrow/near/131195928" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sunjay Varma <a href="https://rust-lang.github.io/zulip_archive/stream/122657-t-compiler/wg-nll/topic/.2353123.20.22enduring.22.20borrow.html#131195928">(Aug 09 2018 at 20:37)</a>:</h4>
<p>Thanks!</p>



<a name="131195936"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2353123%20%22enduring%22%20borrow/near/131195936" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://rust-lang.github.io/zulip_archive/stream/122657-t-compiler/wg-nll/topic/.2353123.20.22enduring.22.20borrow.html#131195936">(Aug 09 2018 at 20:37)</a>:</h4>
<p>I thought it was :)</p>



<a name="131195937"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2353123%20%22enduring%22%20borrow/near/131195937" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://rust-lang.github.io/zulip_archive/stream/122657-t-compiler/wg-nll/topic/.2353123.20.22enduring.22.20borrow.html#131195937">(Aug 09 2018 at 20:37)</a>:</h4>
<p>but maybe not very well</p>



<a name="131195978"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2353123%20%22enduring%22%20borrow/near/131195978" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://rust-lang.github.io/zulip_archive/stream/122657-t-compiler/wg-nll/topic/.2353123.20.22enduring.22.20borrow.html#131195978">(Aug 09 2018 at 20:38)</a>:</h4>
<p>that is, in the section you pointed at</p>



<a name="131195999"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2353123%20%22enduring%22%20borrow/near/131195999" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://rust-lang.github.io/zulip_archive/stream/122657-t-compiler/wg-nll/topic/.2353123.20.22enduring.22.20borrow.html#131195999">(Aug 09 2018 at 20:38)</a>:</h4>
<p>it says:</p>
<blockquote>
<p>What this command will do is the following:</p>
<ul>
<li>Using the beta compiler (also called stage 0), it will build the standard library and rustc from the src directory. The resulting compiler is called the "stage 1" compiler.<ul>
<li>During this build, the -i (or --incremental) switch enables incremental compilation, so that if you later rebuild after editing things in src, you can save a bit of time.</li>
</ul>
</li>
<li>Using this stage 1 compiler, it will build the standard library. (this is what the src/libstd) means.</li>
</ul>
</blockquote>



<a name="131196008"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2353123%20%22enduring%22%20borrow/near/131196008" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://rust-lang.github.io/zulip_archive/stream/122657-t-compiler/wg-nll/topic/.2353123.20.22enduring.22.20borrow.html#131196008">(Aug 09 2018 at 20:39)</a>:</h4>
<p>but clearly could be clearer</p>



<a name="131196014"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2353123%20%22enduring%22%20borrow/near/131196014" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://rust-lang.github.io/zulip_archive/stream/122657-t-compiler/wg-nll/topic/.2353123.20.22enduring.22.20borrow.html#131196014">(Aug 09 2018 at 20:39)</a>:</h4>
<p>also that section prob needs updating for <code>--keep-stage 1</code>...</p>



<a name="131197411"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2353123%20%22enduring%22%20borrow/near/131197411" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sunjay Varma <a href="https://rust-lang.github.io/zulip_archive/stream/122657-t-compiler/wg-nll/topic/.2353123.20.22enduring.22.20borrow.html#131197411">(Aug 09 2018 at 21:10)</a>:</h4>
<p><span class="user-mention" data-user-id="116009">@nikomatsakis</span> The PR is updated: <a href="https://github.com/rust-lang/rust/pull/53212" target="_blank" title="https://github.com/rust-lang/rust/pull/53212">https://github.com/rust-lang/rust/pull/53212</a></p>



<a name="131197440"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2353123%20%22enduring%22%20borrow/near/131197440" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sunjay Varma <a href="https://rust-lang.github.io/zulip_archive/stream/122657-t-compiler/wg-nll/topic/.2353123.20.22enduring.22.20borrow.html#131197440">(Aug 09 2018 at 21:10)</a>:</h4>
<p>See my comment in the PR for some information about what I did</p>



<a name="131197447"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2353123%20%22enduring%22%20borrow/near/131197447" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sunjay Varma <a href="https://rust-lang.github.io/zulip_archive/stream/122657-t-compiler/wg-nll/topic/.2353123.20.22enduring.22.20borrow.html#131197447">(Aug 09 2018 at 21:10)</a>:</h4>
<p>I basically implemented exactly what you said and made it so that <code>BuiltInCandidate { has_nested: false }</code> is preferred in <strong>all</strong> cases</p>



<a name="131200512"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2353123%20%22enduring%22%20borrow/near/131200512" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://rust-lang.github.io/zulip_archive/stream/122657-t-compiler/wg-nll/topic/.2353123.20.22enduring.22.20borrow.html#131200512">(Aug 09 2018 at 22:21)</a>:</h4>
<p>looks about right</p>



<a name="131200557"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2353123%20%22enduring%22%20borrow/near/131200557" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://rust-lang.github.io/zulip_archive/stream/122657-t-compiler/wg-nll/topic/.2353123.20.22enduring.22.20borrow.html#131200557">(Aug 09 2018 at 22:22)</a>:</h4>
<p>although that fn is always kind of mind-bending</p>



<a name="131200559"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2353123%20%22enduring%22%20borrow/near/131200559" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://rust-lang.github.io/zulip_archive/stream/122657-t-compiler/wg-nll/topic/.2353123.20.22enduring.22.20borrow.html#131200559">(Aug 09 2018 at 22:22)</a>:</h4>
<p>/me can't wait for chalk</p>



<a name="131201762"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2353123%20%22enduring%22%20borrow/near/131201762" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sunjay Varma <a href="https://rust-lang.github.io/zulip_archive/stream/122657-t-compiler/wg-nll/topic/.2353123.20.22enduring.22.20borrow.html#131201762">(Aug 09 2018 at 22:53)</a>:</h4>
<p>I <span class="emoji emoji-2764" title="heart">:heart:</span> chalk</p>



<a name="131201820"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2353123%20%22enduring%22%20borrow/near/131201820" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sunjay Varma <a href="https://rust-lang.github.io/zulip_archive/stream/122657-t-compiler/wg-nll/topic/.2353123.20.22enduring.22.20borrow.html#131201820">(Aug 09 2018 at 22:54)</a>:</h4>
<p><span class="user-mention" data-user-id="116009">@nikomatsakis</span> Tests have passed in the PR. Anything else to be done or shall we merge it?</p>



<a name="131201899"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2353123%20%22enduring%22%20borrow/near/131201899" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://rust-lang.github.io/zulip_archive/stream/122657-t-compiler/wg-nll/topic/.2353123.20.22enduring.22.20borrow.html#131201899">(Aug 09 2018 at 22:57)</a>:</h4>
<p>no, that's probably fine</p>



<a name="131201982"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2353123%20%22enduring%22%20borrow/near/131201982" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sunjay Varma <a href="https://rust-lang.github.io/zulip_archive/stream/122657-t-compiler/wg-nll/topic/.2353123.20.22enduring.22.20borrow.html#131201982">(Aug 09 2018 at 22:59)</a>:</h4>
<p>Ok. Then I guess it's good to go: <a href="https://github.com/rust-lang/rust/pull/53212" target="_blank" title="https://github.com/rust-lang/rust/pull/53212">https://github.com/rust-lang/rust/pull/53212</a></p>



<a name="131201988"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2353123%20%22enduring%22%20borrow/near/131201988" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sunjay Varma <a href="https://rust-lang.github.io/zulip_archive/stream/122657-t-compiler/wg-nll/topic/.2353123.20.22enduring.22.20borrow.html#131201988">(Aug 09 2018 at 22:59)</a>:</h4>
<p><span class="emoji emoji-263a" title="smile">:smile:</span></p>



<hr><p>Last updated: Aug 07 2021 at 22:04 UTC</p>
</html>