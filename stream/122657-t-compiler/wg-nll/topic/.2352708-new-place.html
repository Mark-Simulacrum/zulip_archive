<html>
<head><meta charset="utf-8"><title>#52708-new-place · t-compiler/wg-nll · Zulip Chat Archive</title></head>
<h2>Stream: <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/index.html">t-compiler/wg-nll</a></h2>
<h3>Topic: <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html">#52708-new-place</a></h3>

<hr>

<base href="https://rust-lang.zulipchat.com">

<head><link href="https://zulip-archive.rust-lang.org/style.css" rel="stylesheet"></head>

<a name="130579199"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/130579199" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> csmoe <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#130579199">(Jul 30 2018 at 13:35)</a>:</h4>
<p><span class="user-mention" data-user-id="116009">@nikomatsakis</span> <br>
as you suggested in <a href="https://github.com/rust-lang/rust/issues/52708#issue-344543133" target="_blank" title="https://github.com/rust-lang/rust/issues/52708#issue-344543133">https://github.com/rust-lang/rust/issues/52708#issue-344543133</a> , since the real def of <code>ProjectionElem</code> is <code>ProjectionElem&lt;'tcx, V, T&gt;</code>, so repr of <code>Place</code> will be:</p>
<div class="codehilite"><pre><span></span><span class="k">struct</span> <span class="nc">Place</span><span class="o">&lt;</span><span class="na">&#39;tcx</span><span class="p">,</span><span class="w"> </span><span class="n">V</span><span class="p">,</span><span class="w"> </span><span class="n">T</span><span class="o">&gt;</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="n">base</span>: <span class="nc">PlaceBase</span><span class="o">&lt;</span><span class="na">&#39;tcx</span><span class="o">&gt;</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">elem</span>: <span class="kp">&amp;</span><span class="na">&#39;tcx</span><span class="w"> </span><span class="o">&amp;</span><span class="n">Slice</span><span class="o">&lt;</span><span class="n">ProjectionElem</span><span class="o">&lt;</span><span class="na">&#39;tcx</span><span class="p">,</span><span class="w"> </span><span class="n">V</span><span class="p">,</span><span class="w"> </span><span class="n">T</span><span class="o">&gt;&gt;</span><span class="p">,</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>
</pre></div>


<p>but <code>Place&lt;'tcx, V, T&gt;</code> is a bit untidy when the other objects wrap it like:</p>
<div class="codehilite"><pre><span></span><span class="k">enum</span> <span class="nc">Abc</span><span class="o">&lt;</span><span class="na">&#39;tcx</span><span class="p">,</span><span class="w"> </span><span class="n">V</span><span class="p">,</span><span class="w"> </span><span class="n">T</span><span class="o">&gt;</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="n">Foo</span><span class="p">(</span><span class="n">Place</span><span class="o">&lt;</span><span class="na">&#39;tcx</span><span class="p">,</span><span class="w"> </span><span class="n">V</span><span class="p">,</span><span class="w"> </span><span class="n">T</span><span class="o">&gt;</span><span class="p">)</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>
</pre></div>


<p>the new-intro'd <code>V, T</code> type parameter will break tons of code, I think it's unnecessary(wrong?).</p>
<p>(maybe lucky?) I find </p>
<div class="codehilite"><pre><span></span><span class="sd">/// Alias for projections as they appear in places, where the base is a place</span>
<span class="sd">/// and the index is a local.</span>
<span class="k">pub</span><span class="w"> </span><span class="k">type</span> <span class="nc">PlaceElem</span><span class="o">&lt;</span><span class="na">&#39;tcx</span><span class="o">&gt;</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ProjectionElem</span><span class="o">&lt;</span><span class="na">&#39;tcx</span><span class="p">,</span><span class="w"> </span><span class="n">Local</span><span class="p">,</span><span class="w"> </span><span class="n">Ty</span><span class="o">&lt;</span><span class="na">&#39;tcx</span><span class="o">&gt;&gt;</span><span class="p">;</span><span class="w"></span>
</pre></div>


<p>already lives there, so</p>
<div class="codehilite"><pre><span></span><span class="k">struct</span> <span class="nc">Place</span><span class="o">&lt;</span><span class="na">&#39;tcx</span><span class="o">&gt;</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="p">...</span><span class="w"></span>
<span class="w">    </span><span class="n">elem</span>: <span class="kp">&amp;</span><span class="na">&#39;tcx</span><span class="w"> </span><span class="n">Slice</span><span class="o">&lt;</span><span class="n">PlaceElem</span><span class="o">&lt;</span><span class="na">&#39;tcx</span><span class="o">&gt;&gt;</span><span class="p">,</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>
</pre></div>


<p>can hidden <code>V, T</code>.  can <code>PlaceElem</code> be intro'd here?</p>



<a name="130583484"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/130583484" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#130583484">(Jul 30 2018 at 14:42)</a>:</h4>
<p>why does <code>Place</code> need the V/T parameters?</p>



<a name="130583487"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/130583487" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#130583487">(Jul 30 2018 at 14:42)</a>:</h4>
<p>in any case, I think a type alias is ok</p>



<a name="130611891"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/130611891" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> csmoe <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#130611891">(Jul 31 2018 at 00:07)</a>:</h4>
<p><code>V, T</code> come from <code>ProjectionElem&lt;'tcx, V, T&gt;</code></p>



<a name="130621077"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/130621077" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#130621077">(Jul 31 2018 at 04:33)</a>:</h4>
<p>right, but in the existing <code>Place</code> struct they are defined to e <code>Place</code> and <code>Ty</code> respectively, right?</p>



<a name="130621120"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/130621120" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#130621120">(Jul 31 2018 at 04:34)</a>:</h4>
<p>are you saying that some places which used to use <code>ProjectionElem</code> with other values of <code>V</code> and <code>T</code> now want to use <code>Place</code>?</p>



<a name="130621129"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/130621129" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#130621129">(Jul 31 2018 at 04:35)</a>:</h4>
<p>in other words, the existing <code>Place</code> uses this alias:</p>
<div class="codehilite"><pre><span></span><span class="k">pub</span><span class="w"> </span><span class="k">type</span> <span class="nc">PlaceProjection</span><span class="o">&lt;</span><span class="na">&#39;tcx</span><span class="o">&gt;</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Projection</span><span class="o">&lt;</span><span class="na">&#39;tcx</span><span class="p">,</span><span class="w"> </span><span class="n">Place</span><span class="o">&lt;</span><span class="na">&#39;tcx</span><span class="o">&gt;</span><span class="p">,</span><span class="w"> </span><span class="n">Local</span><span class="p">,</span><span class="w"> </span><span class="n">Ty</span><span class="o">&lt;</span><span class="na">&#39;tcx</span><span class="o">&gt;&gt;</span><span class="p">;</span><span class="w"></span>
</pre></div>


<p>(as I think you already observed)</p>



<a name="130982524"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/130982524" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#130982524">(Aug 06 2018 at 14:39)</a>:</h4>
<p><span class="user-mention" data-user-id="116773">@csmoe</span> what ever happened here? (My apologies if there is an open PR, I haven't swept those yet)</p>



<a name="130982668"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/130982668" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> csmoe <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#130982668">(Aug 06 2018 at 14:41)</a>:</h4>
<p><span class="user-mention" data-user-id="116009">@nikomatsakis</span> I'm working on this right now, I asked help from eddyb in niko-missing time.</p>



<a name="131046202"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/131046202" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> csmoe <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#131046202">(Aug 07 2018 at 14:03)</a>:</h4>
<p><span class="user-mention" data-user-id="116009">@nikomatsakis</span> thanks, your instructions will be addressed soon</p>



<a name="131046375"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/131046375" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> csmoe <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#131046375">(Aug 07 2018 at 14:05)</a>:</h4>
<blockquote>
<p>I wonder if we should make a <code>split_projection</code>method that returns <code>Option&lt;(Place&lt;'tcx&gt;, &amp;PlaceProjection&lt;'tcx&gt;)&gt;</code></p>
</blockquote>
<p><code>Option&lt;(Place&lt;'tcx&gt;, &amp;PlaceProjection&lt;'tcx&gt;)&gt;</code> should be <code>Option&lt;(Place, Slice&lt;PlaceProjection&gt;)&gt;</code>?</p>



<a name="131046823"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/131046823" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#131046823">(Aug 07 2018 at 14:12)</a>:</h4>
<p>no</p>



<a name="131046835"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/131046835" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#131046835">(Aug 07 2018 at 14:13)</a>:</h4>
<p>I meant that given e.g. <code>(B, [P1, P2])</code> it might return <code>((B, [P1]), &amp;P2)</code></p>



<a name="131046841"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/131046841" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#131046841">(Aug 07 2018 at 14:13)</a>:</h4>
<p>i.e., it "peels off" the last projection</p>



<a name="131046843"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/131046843" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#131046843">(Aug 07 2018 at 14:13)</a>:</h4>
<p>and returns it to you, along with the "base" place</p>



<a name="131046848"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/131046848" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#131046848">(Aug 07 2018 at 14:13)</a>:</h4>
<p>i.e., the place without that projection</p>



<a name="131046853"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/131046853" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#131046853">(Aug 07 2018 at 14:13)</a>:</h4>
<p>I suspect this is something we commonly want to do</p>



<a name="131046922"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/131046922" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> csmoe <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#131046922">(Aug 07 2018 at 14:15)</a>:</h4>
<p>ooh, get it</p>



<a name="131162279"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/131162279" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> csmoe <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#131162279">(Aug 09 2018 at 10:09)</a>:</h4>
<p><span class="user-mention" data-user-id="116009">@nikomatsakis</span> may I ask a bit stupid question(unrelated to this topic)? for single <code>let x = 3</code>, does <code>x</code> has a region(lifetime) in NLL? I get used to thinki that <code>region</code> only involves  in borrow like <code>let x = &amp;3</code>.</p>



<a name="131162395"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/131162395" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#131162395">(Aug 09 2018 at 10:11)</a>:</h4>
<p><code>x</code> does not have a region</p>



<a name="131162441"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/131162441" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#131162441">(Aug 09 2018 at 10:12)</a>:</h4>
<p>you are correct that lifetimes are only for borrows</p>



<a name="131236537"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/131236537" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> csmoe <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#131236537">(Aug 10 2018 at 13:16)</a>:</h4>
<p>PR <a href="https://github.com/rust-lang/rust/pull/53247" target="_blank" title="https://github.com/rust-lang/rust/pull/53247">https://github.com/rust-lang/rust/pull/53247</a><br>
<span class="user-mention" data-user-id="116009">@nikomatsakis</span> some lifetime conflicts  caused by introduced <code>TyCtxt</code>for interning will be addressed soon . and the <code>place_conflict</code>https://github.com/rust-lang/rust/blob/fefe81605d6111faa8dbb3635ab2c51d59de740a/src/librustc_mir/borrow_check/places_conflict.rs#L32-L37 is simply translated, maybe I need to rewrite it with slice disjoint detection?</p>



<a name="131236560"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/131236560" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#131236560">(Aug 10 2018 at 13:17)</a>:</h4>
<p>oh, nice :)</p>



<a name="131236562"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/131236562" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#131236562">(Aug 10 2018 at 13:17)</a>:</h4>
<p>I'll take a look I guess</p>



<a name="131236567"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/131236567" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#131236567">(Aug 10 2018 at 13:17)</a>:</h4>
<p><code>places_conflict</code> ought to be something we can implement much more simply...</p>



<a name="131236670"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/131236670" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> csmoe <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#131236670">(Aug 10 2018 at 13:19)</a>:</h4>
<p>btw, it's the first time I make such a big modification sine learning programming, could you give me some tips about the conflict detection since I'm a algorithm newbie?</p>



<a name="131236735"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/131236735" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#131236735">(Aug 10 2018 at 13:21)</a>:</h4>
<p>like, how it works in general?</p>



<a name="131236751"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/131236751" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#131236751">(Aug 10 2018 at 13:21)</a>:</h4>
<p>the idea is that we start with the base of the path and go forward, iirc</p>



<a name="131236756"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/131236756" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#131236756">(Aug 10 2018 at 13:21)</a>:</h4>
<p>so e.g. if you have <code>a.b.c</code> and <code>a.b.d.e</code></p>



<a name="131236764"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/131236764" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#131236764">(Aug 10 2018 at 13:21)</a>:</h4>
<p>and we want to see if a borrow of <code>a.b.c</code> affects a write to <code>a.b.d.e</code></p>



<a name="131236806"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/131236806" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#131236806">(Aug 10 2018 at 13:22)</a>:</h4>
<p>we start with the local -- <code>a</code> in each case -- and we see that <em>so far</em> they appear to be overlapping paths</p>



<a name="131236809"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/131236809" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#131236809">(Aug 10 2018 at 13:22)</a>:</h4>
<p>then we go to the next step: <code>a.b</code> in both cases</p>



<a name="131236810"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/131236810" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#131236810">(Aug 10 2018 at 13:22)</a>:</h4>
<p>still overlapping</p>



<a name="131236811"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/131236811" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#131236811">(Aug 10 2018 at 13:22)</a>:</h4>
<p>finally we get to <code>a.b.c</code> vs <code>a.b.d</code></p>



<a name="131236814"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/131236814" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#131236814">(Aug 10 2018 at 13:22)</a>:</h4>
<p>and there we see they are disjoint</p>



<a name="131236825"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/131236825" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#131236825">(Aug 10 2018 at 13:22)</a>:</h4>
<p>(sometimes, though, the same field name may still be overlapping -- e.g., in a <code>union</code>)</p>



<a name="131236830"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/131236830" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#131236830">(Aug 10 2018 at 13:22)</a>:</h4>
<p>er, sorry, different field names</p>



<a name="131236841"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/131236841" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#131236841">(Aug 10 2018 at 13:22)</a>:</h4>
<p>e.g., if <code>c</code> and <code>d</code> are declared in the same  union</p>



<a name="131236842"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/131236842" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> csmoe <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#131236842">(Aug 10 2018 at 13:22)</a>:</h4>
<p>the lifetime conflict isn't solved now, so the <code>./x.py check</code> cannot pass, but it's just complains lifetime conflicts, I have clean up all the other errors</p>



<a name="131236849"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/131236849" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#131236849">(Aug 10 2018 at 13:23)</a>:</h4>
<p>ok</p>



<a name="131236855"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/131236855" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#131236855">(Aug 10 2018 at 13:23)</a>:</h4>
<p>if you want</p>



<a name="131236858"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/131236858" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#131236858">(Aug 10 2018 at 13:23)</a>:</h4>
<p>I can pull the branch and take a look</p>



<a name="131236868"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/131236868" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#131236868">(Aug 10 2018 at 13:23)</a>:</h4>
<p>sometimes these are obvious when you've been hacking on the compiler daily for years ;)</p>



<a name="131237067"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/131237067" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> csmoe <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#131237067">(Aug 10 2018 at 13:26)</a>:</h4>
<p>thanks, I will try to address conflict-detection.<br>
yep, I wanna your pulling.</p>



<a name="131237161"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/131237161" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#131237161">(Aug 10 2018 at 13:29)</a>:</h4>
<p>ok, will do</p>



<a name="132253626"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/132253626" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#132253626">(Aug 16 2018 at 17:26)</a>:</h4>
<p><span class="user-mention" data-user-id="116773">@csmoe</span> ping — I haven't had any time to look at your PR, but I would likely be able to do so next week</p>



<a name="132253637"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/132253637" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#132253637">(Aug 16 2018 at 17:26)</a>:</h4>
<p>have you had any time to look at it any more?</p>



<a name="132268289"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/132268289" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> csmoe <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#132268289">(Aug 16 2018 at 22:09)</a>:</h4>
<p><span class="user-mention" data-user-id="116009">@nikomatsakis</span> I'm working on this daily, rewriting the old-recursive place check stuffs to iter as eddyb reviewed(it's a bit slow since I am not proficient in algorithms and the place check, but I made some progress). If I am stuck or it's done, i'll ping you/eddyb</p>



<a name="132535042"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/132535042" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#132535042">(Aug 21 2018 at 18:55)</a>:</h4>
<p>ok, well, RustConf is over and I'm more available, so let me know if you want me to take another look</p>



<a name="132555436"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/132555436" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> csmoe <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#132555436">(Aug 22 2018 at 03:07)</a>:</h4>
<p><span class="user-mention" data-user-id="116009">@nikomatsakis</span> updating: <code>./py check</code> succeeded locally, taking care of <code>./x.py test --stage 1</code></p>



<a name="132563264"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/132563264" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> csmoe <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#132563264">(Aug 22 2018 at 07:16)</a>:</h4>
<p><span class="user-mention" data-user-id="116009">@nikomatsakis</span> <code>./x.py test</code> emitted abort panic <code>stack overflow</code> when compiling core :<br>
<a href="/user_uploads/4715/lbzNRTA5oRRz-b7BPTWdenIO/pasted_image.png" target="_blank" title="pasted_image.png">pasted image</a> <br>
If you have time, may I have your review? here is my latest code <a href="https://github.com/rust-lang/rust/pull/53247/files" target="_blank" title="https://github.com/rust-lang/rust/pull/53247/files">https://github.com/rust-lang/rust/pull/53247/files</a><br>
anyway, I'm self-reviewing to find the bug.</p>
<div class="message_inline_image"><a href="/user_uploads/4715/lbzNRTA5oRRz-b7BPTWdenIO/pasted_image.png" target="_blank" title="pasted image"><img src="/user_uploads/4715/lbzNRTA5oRRz-b7BPTWdenIO/pasted_image.png"></a></div>



<a name="132574020"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/132574020" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Matthew Jasper <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#132574020">(Aug 22 2018 at 12:01)</a>:</h4>
<p><span class="user-mention" data-user-id="116773">@csmoe</span> you could try compiling a minimal <code>#![no_core]</code>library to see if you can minimise the problem.</p>



<a name="132574085"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/132574085" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> csmoe <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#132574085">(Aug 22 2018 at 12:02)</a>:</h4>
<p><span class="user-mention" data-user-id="116118">@Matthew Jasper</span> thanks</p>



<a name="132591584"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/132591584" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#132591584">(Aug 22 2018 at 17:41)</a>:</h4>
<p><span class="user-mention" data-user-id="116773">@csmoe</span> ok, doing a local build now</p>



<a name="132712287"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/132712287" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#132712287">(Aug 24 2018 at 18:42)</a>:</h4>
<p><span class="user-mention" data-user-id="116773">@csmoe</span> so I fixed one problem -- but there are more. <a href="https://github.com/rust-lang/rust/pull/53247#issuecomment-415846128" target="_blank" title="https://github.com/rust-lang/rust/pull/53247#issuecomment-415846128">See my comments here</a> -- let me know if that makes any sense.</p>



<a name="132717989"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/132717989" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> csmoe <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#132717989">(Aug 24 2018 at 20:31)</a>:</h4>
<p><span class="user-mention" data-user-id="116009">@nikomatsakis</span> thank you, I'll fix the rest and recheck the other potential bug with the new place workflow.<br>
btw, would you mind sharing  your stack overflow debugging approach generally?(or maybe this bug is just discovered by reviewing)</p>



<a name="132717999"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/132717999" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#132717999">(Aug 24 2018 at 20:31)</a>:</h4>
<p>in this case, I did this:</p>



<a name="132718001"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/132718001" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#132718001">(Aug 24 2018 at 20:31)</a>:</h4>
<p>first, <code>./x.py build ... -vv</code></p>



<a name="132718004"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/132718004" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#132718004">(Aug 24 2018 at 20:31)</a>:</h4>
<p>this will cause it to print out the command it was using</p>



<a name="132718065"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/132718065" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#132718065">(Aug 24 2018 at 20:32)</a>:</h4>
<p>something like this:</p>
<div class="codehilite"><pre><span></span>rustc command: &quot;LD_LIBRARY_PATH&quot;=&quot;/home/nmatsakis/versioned/rust-3/build/x86_64-unknown-linux-gnu/stage1/lib:/home/nmatsakis/versioned/rust-3/build/x86_64-unknown-linux-gnu/stage1-std/release/deps:/home/\
nmatsakis/versioned/rust-3/build/x86_64-unknown-linux-gnu/stage0/lib&quot; &quot;/home/nmatsakis/versioned/rust-3/build/x86_64-unknown-linux-gnu/stage1/bin/rustc&quot; &quot;--crate-name&quot; &quot;core&quot; &quot;libcore/lib.rs&quot; &quot;--crate-ty\
pe&quot; &quot;lib&quot; &quot;--emit=dep-info,link&quot; &quot;-C&quot; &quot;opt-level=2&quot; &quot;-C&quot; &quot;metadata=b33d847693b19528-rustc&quot; &quot;-C&quot; &quot;extra-filename=-b33d847693b19528&quot; &quot;--out-dir&quot; &quot;/home/nmatsakis/versioned/rust-3/build/x86_64-unknown-linux\
-gnu/stage1-std/x86_64-unknown-linux-gnu/release/deps&quot; &quot;--target&quot; &quot;x86_64-unknown-linux-gnu&quot; &quot;-C&quot; &quot;incremental=/home/nmatsakis/versioned/rust-3/build/x86_64-unknown-linux-gnu/stage1-std/x86_64-unknown-li\
nux-gnu/release/incremental&quot; &quot;-L&quot; &quot;dependency=/home/nmatsakis/versioned/rust-3/build/x86_64-unknown-linux-gnu/stage1-std/x86_64-unknown-linux-gnu/release/deps&quot; &quot;-L&quot; &quot;dependency=/home/nmatsakis/versioned/\
rust-3/build/x86_64-unknown-linux-gnu/stage1-std/release/deps&quot; &quot;--cfg&quot; &quot;stage1&quot; &quot;--sysroot&quot; &quot;/home/nmatsakis/versioned/rust-3/build/x86_64-unknown-linux-gnu/stage1&quot; &quot;-Cprefer-dynamic&quot; &quot;-Cdebuginfo=1&quot; &quot;-C\
&quot; &quot;debug-assertions=y&quot; &quot;-C&quot; &quot;codegen-units=28&quot; &quot;-C&quot; &quot;link-args=-Wl,-rpath,$ORIGIN/../lib&quot; &quot;-Z&quot; &quot;force-unstable-if-unmarked&quot; &quot;-Dwarnings&quot; &quot;-Dbare_trait_objects&quot;
</pre></div>



<a name="132718077"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/132718077" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#132718077">(Aug 24 2018 at 20:32)</a>:</h4>
<p>kind of a pain to parse visually :)</p>



<a name="132718085"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/132718085" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#132718085">(Aug 24 2018 at 20:32)</a>:</h4>
<p>in any case, then you find the place in there where the rustc executable is</p>



<a name="132718089"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/132718089" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#132718089">(Aug 24 2018 at 20:32)</a>:</h4>
<p>and you put <code>gdb --args </code> in front of it (if using linux)</p>



<a name="132718093"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/132718093" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#132718093">(Aug 24 2018 at 20:32)</a>:</h4>
<p>type <code>r</code></p>



<a name="132718102"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/132718102" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#132718102">(Aug 24 2018 at 20:32)</a>:</h4>
<p>when it crashes, you can run the <code>up</code> command various times to see the points in the cycle</p>



<a name="132718109"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/132718109" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#132718109">(Aug 24 2018 at 20:33)</a>:</h4>
<p>you can also press <code>bt</code> but for overflow there tend to be a ton of frames :)</p>



<a name="132718183"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/132718183" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> csmoe <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#132718183">(Aug 24 2018 at 20:34)</a>:</h4>
<p>really helps, thank you :)</p>



<a name="132718337"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/132718337" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#132718337">(Aug 24 2018 at 20:37)</a>:</h4>
<p>if you want me to help with the next cycle you encounter, I can do so =)</p>



<a name="132718442"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/132718442" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> csmoe <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#132718442">(Aug 24 2018 at 20:39)</a>:</h4>
<p>I'll try to resolve it, if stuck, will ping you here. really thanks :)</p>



<a name="132876203"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/132876203" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#132876203">(Aug 27 2018 at 19:39)</a>:</h4>
<p><span class="user-mention" data-user-id="116773">@csmoe</span> how goes it?</p>



<a name="132920846"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/132920846" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> csmoe <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#132920846">(Aug 28 2018 at 14:29)</a>:</h4>
<p>stack overflow cleared, trying to fix the <code>broken MIr</code> err</p>



<a name="132921185"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/132921185" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#132921185">(Aug 28 2018 at 14:35)</a>:</h4>
<p>ok, I can try a local build and see what I see</p>



<a name="132921638"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/132921638" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#132921638">(Aug 28 2018 at 14:42)</a>:</h4>
<p>well I can definitely reproduce the broken MIR =)</p>



<a name="133024028"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/133024028" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#133024028">(Aug 29 2018 at 21:47)</a>:</h4>
<p><span class="user-mention" data-user-id="116773">@csmoe</span> I've been looking at your PR some</p>



<a name="133024073"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/133024073" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#133024073">(Aug 29 2018 at 21:48)</a>:</h4>
<p>I am a bit worried about perf implications of some aspects of it (in particular, the modifications to MIR builder may be problematic since they seem to do a lot of interning)</p>



<a name="133024078"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/133024078" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#133024078">(Aug 29 2018 at 21:48)</a>:</h4>
<p>but I guess let's get it working first :)</p>



<a name="133051928"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/133051928" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> csmoe <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#133051928">(Aug 30 2018 at 10:44)</a>:</h4>
<p>(interning stuff like <code>Place.field(tcx, ...)</code>)?</p>
<p>my self-review almost done, but still cannot capture the logic bug</p>



<a name="133055757"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/133055757" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#133055757">(Aug 30 2018 at 12:10)</a>:</h4>
<p>Re: efficiency, my thought is that we may want to rework the MIR builder so it doesn't return a fully-formed <code>Place</code>  but rather a kind of "place builder" that (using a <code>Vec</code>) that we can intern once we are done.</p>



<a name="133055762"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/133055762" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#133055762">(Aug 30 2018 at 12:10)</a>:</h4>
<p>but let's find the logic bug first I think</p>



<a name="133055840"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/133055840" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#133055840">(Aug 30 2018 at 12:12)</a>:</h4>
<p>I'm doing a bit of investigating on the side</p>



<a name="133056163"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/133056163" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#133056163">(Aug 30 2018 at 12:19)</a>:</h4>
<p>this is where things go wrong:</p>
<div class="codehilite"><pre><span></span>DEBUG 2018-08-30T12:15:51Z: rustc_mir::borrow_check::nll::type_check: sanitize_place: Place { base: _1, elems: [Deref, Index(_17)] }
DEBUG 2018-08-30T12:15:51Z: rustc_mir::borrow_check::nll::type_check: prove_predicates(predicate=Binder(TraitPredicate(&lt;&amp;mut [u8] as marker::Copy&gt;)), locations=Interesting(bb16[0]))
DEBUG 2018-08-30T12:15:51Z: rustc_mir::borrow_check::nll::type_check: prove_predicate(predicate=Binder(TraitPredicate(&lt;&amp;mut [u8] as marker::Copy&gt;)), location=Interesting(bb16[0]))
</pre></div>



<a name="133056177"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/133056177" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#133056177">(Aug 30 2018 at 12:19)</a>:</h4>
<p>if you look at the MIR, you will see that <code>_1</code> has type <code>&amp;mut [u8]</code></p>



<a name="133056180"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/133056180" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#133056180">(Aug 30 2018 at 12:19)</a>:</h4>
<p>the MIR in question is:</p>



<a name="133056185"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/133056185" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#133056185">(Aug 30 2018 at 12:19)</a>:</h4>
<div class="codehilite"><pre><span></span>CheckedAdd(Place { base: _1, elems: [Deref, Index(_17)] }, const 1u8)
</pre></div>



<a name="133056193"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/133056193" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#133056193">(Aug 30 2018 at 12:19)</a>:</h4>
<p>in particular, <code>Place { base: _1, elems: [Deref, Index(_17)] }</code> should not have the type <code>&amp;mut [u8]</code> but rather <code>[u8]</code></p>



<a name="133056253"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/133056253" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#133056253">(Aug 30 2018 at 12:20)</a>:</h4>
<p>ah, I think the bug is in the changes to <code>sanitize_place</code></p>



<a name="133056258"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/133056258" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#133056258">(Aug 30 2018 at 12:21)</a>:</h4>
<p>it seems to just ignore the projections altogether now</p>



<a name="133056269"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/133056269" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#133056269">(Aug 30 2018 at 12:21)</a>:</h4>
<p>hmm not quite</p>



<a name="133056277"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/133056277" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#133056277">(Aug 30 2018 at 12:21)</a>:</h4>
<p>ps I see a lot of code like this:</p>
<div class="codehilite"><pre><span></span><span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="o">!</span><span class="n">place</span><span class="p">.</span><span class="n">has_no_projection</span><span class="p">()</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">            </span><span class="k">for</span><span class="w"> </span><span class="n">elem</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="n">place</span><span class="p">.</span><span class="n">elems</span><span class="p">.</span><span class="n">iter</span><span class="p">(){</span><span class="w"> </span><span class="cm">/* side effect */</span><span class="w"> </span><span class="p">}</span><span class="w"></span>
<span class="w">        </span><span class="p">}</span><span class="w"></span>
</pre></div>



<a name="133056282"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/133056282" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#133056282">(Aug 30 2018 at 12:21)</a>:</h4>
<p>afaict it would be simpler to just do:</p>
<div class="codehilite"><pre><span></span><span class="w">            </span><span class="k">for</span><span class="w"> </span><span class="n">elem</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="n">place</span><span class="p">.</span><span class="n">elems</span><span class="p">.</span><span class="n">iter</span><span class="p">(){</span><span class="w"></span>
</pre></div>



<a name="133056323"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/133056323" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#133056323">(Aug 30 2018 at 12:22)</a>:</h4>
<p>since, if the vector is empty, that has no effect</p>



<a name="133056366"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/133056366" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#133056366">(Aug 30 2018 at 12:23)</a>:</h4>
<p>anyway, I'm trying <a href="https://gist.github.com/nikomatsakis/150aae73abcdd09fbed63af253454479" target="_blank" title="https://gist.github.com/nikomatsakis/150aae73abcdd09fbed63af253454479">this diff</a> and we'll see what effect it has</p>



<a name="133060256"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/133060256" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#133060256">(Aug 30 2018 at 13:34)</a>:</h4>
<p><span class="user-mention" data-user-id="116773">@csmoe</span> ok I pushed a commit that seems to solve a lot of problems. I'll leave a few tips on the <em>next</em> problem in the PR I think</p>



<a name="133060276"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/133060276" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> csmoe <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#133060276">(Aug 30 2018 at 13:35)</a>:</h4>
<p><span class="user-mention" data-user-id="116009">@nikomatsakis</span> thanks, your tips will be addressed soon</p>



<a name="133060284"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/133060284" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#133060284">(Aug 30 2018 at 13:35)</a>:</h4>
<p>did you ever add a <code>split</code> function to <code>Place</code> as I suggested?</p>



<a name="133060287"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/133060287" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#133060287">(Aug 30 2018 at 13:35)</a>:</h4>
<p>I don't see one, so maybe not</p>



<a name="133060296"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/133060296" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#133060296">(Aug 30 2018 at 13:35)</a>:</h4>
<p>I think it is what we need for the next problem :)</p>



<a name="133060392"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/133060392" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> csmoe <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#133060392">(Aug 30 2018 at 13:37)</a>:</h4>
<p>I have added it, early named <code>split_projection</code>, now <code>elem_base</code>? let me have a look.</p>



<a name="133060527"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/133060527" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#133060527">(Aug 30 2018 at 13:39)</a>:</h4>
<p>I have to look at the details of how you defined <code>Place</code>.</p>



<a name="133060535"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/133060535" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> csmoe <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#133060535">(Aug 30 2018 at 13:40)</a>:</h4>
<p>oops, I removed <code>split_projection</code> in my latest commits, since eddyb said it is not needed  from irc</p>



<a name="133060576"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/133060576" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#133060576">(Aug 30 2018 at 13:40)</a>:</h4>
<p>I see</p>



<a name="133060577"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/133060577" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#133060577">(Aug 30 2018 at 13:40)</a>:</h4>
<p>I disagree :)</p>



<a name="133060588"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/133060588" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#133060588">(Aug 30 2018 at 13:40)</a>:</h4>
<p>but maybe</p>



<a name="133060590"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/133060590" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#133060590">(Aug 30 2018 at 13:40)</a>:</h4>
<p>in many cases it is not</p>



<a name="133060594"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/133060594" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#133060594">(Aug 30 2018 at 13:40)</a>:</h4>
<p>in this particular case, maybe</p>



<a name="133060599"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/133060599" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#133060599">(Aug 30 2018 at 13:40)</a>:</h4>
<p>let me leave my comment anyway</p>



<a name="133060617"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/133060617" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> csmoe <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#133060617">(Aug 30 2018 at 13:40)</a>:</h4>
<p>okay</p>



<a name="133060621"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/133060621" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#133060621">(Aug 30 2018 at 13:41)</a>:</h4>
<p>I think ti'd be useful to be able to treat a <code>Place</code> as a tree <em>or</em> a slice</p>



<a name="133060630"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/133060630" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#133060630">(Aug 30 2018 at 13:41)</a>:</h4>
<p>which seems like it <em>should</em> be possible if we set things up right</p>



<a name="133060649"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/133060649" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#133060649">(Aug 30 2018 at 13:41)</a>:</h4>
<p>comment: <a href="https://github.com/rust-lang/rust/pull/53247/files#r214034747" target="_blank" title="https://github.com/rust-lang/rust/pull/53247/files#r214034747">https://github.com/rust-lang/rust/pull/53247/files#r214034747</a></p>



<a name="133061540"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/133061540" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> csmoe <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#133061540">(Aug 30 2018 at 13:54)</a>:</h4>
<p><span class="user-mention" data-user-id="116009">@nikomatsakis</span> btw, If you have extra time, could you take a look at the <code>place_conflict</code> diffs <a href="https://github.com/rust-lang/rust/pull/53247/files#diff-97da28e7b634e3c63bd18a6dc618d962" target="_blank" title="https://github.com/rust-lang/rust/pull/53247/files#diff-97da28e7b634e3c63bd18a6dc618d962">https://github.com/rust-lang/rust/pull/53247/files#diff-97da28e7b634e3c63bd18a6dc618d962</a> ?(maybe you have already reviewed that).</p>



<a name="133061681"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/133061681" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> csmoe <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#133061681">(Aug 30 2018 at 13:57)</a>:</h4>
<p>my new conflict checking workflow: <br>
1. checking base<br>
2. if base EqOrDisjoint, then process to elems<br>
3. if base Disjoint, return true immediately</p>



<a name="133061754"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/133061754" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> csmoe <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#133061754">(Aug 30 2018 at 13:58)</a>:</h4>
<p>I wanna your review since I feel a bit mess when rewrite that</p>



<a name="133062394"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/133062394" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#133062394">(Aug 30 2018 at 14:09)</a>:</h4>
<p>ok, will review</p>



<a name="133429161"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/133429161" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> csmoe <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#133429161">(Sep 06 2018 at 08:37)</a>:</h4>
<p>update: stuck by <code>const_err </code><br>
<a href="/user_uploads/4715/izQKh0-HVRDXx9C5pXr72llR/pasted_image.png" target="_blank" title="pasted_image.png">pasted image</a></p>
<div class="message_inline_image"><a href="/user_uploads/4715/izQKh0-HVRDXx9C5pXr72llR/pasted_image.png" target="_blank" title="pasted image"><img src="/user_uploads/4715/izQKh0-HVRDXx9C5pXr72llR/pasted_image.png"></a></div>



<a name="133432275"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/133432275" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#133432275">(Sep 06 2018 at 09:50)</a>:</h4>
<p><span class="user-mention" data-user-id="116773">@csmoe</span> I've been meaning to come back to this branch. I'm mildly worried that we should see if we can find a way to take another, less disruptive stab at this refactoring... do you have new commits I should pull, in any case?</p>



<a name="133432313"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/133432313" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> csmoe <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#133432313">(Sep 06 2018 at 09:51)</a>:</h4>
<p><span class="user-mention" data-user-id="116009">@nikomatsakis</span> yes, latest commits had been pushed</p>



<a name="133432633"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/133432633" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> csmoe <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#133432633">(Sep 06 2018 at 09:58)</a>:</h4>
<p><span class="user-mention" data-user-id="116009">@nikomatsakis</span> </p>
<blockquote>
<p>I'm mildly worried that we should see if we can find a way to take another</p>
</blockquote>
<p>yep, I think so, the master has merged several <code>Place</code>  related PRs and my commits are very hybrid.<br>
(really regretted that i hadn't followed the  <code>change-check-pass-change</code> commit workflow your told me in the <code>DebrjinIndex</code> PR)</p>



<a name="133432651"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/133432651" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#133432651">(Sep 06 2018 at 09:59)</a>:</h4>
<p>I have to think about what those gradual steps <em>are</em> perhaps</p>



<a name="133432660"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/133432660" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#133432660">(Sep 06 2018 at 09:59)</a>:</h4>
<p>one thing I could imagine: not changing anything about the actual <code>Place</code> <em>structure</em>, just adding methods that convert a Place into the new format, and then converting the algorithms one by one</p>



<a name="133432717"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/133432717" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#133432717">(Sep 06 2018 at 10:00)</a>:</h4>
<p>the truth is, these sorts of refactorings are hard to pull off :)</p>



<a name="133432723"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/133432723" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#133432723">(Sep 06 2018 at 10:00)</a>:</h4>
<p>I don't see any new commits btw...? the last I see is 552a935f26, is that right?</p>



<a name="133432732"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/133432732" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#133432732">(Sep 06 2018 at 10:00)</a>:</h4>
<p>In any case, I got to go, bbl</p>



<a name="133432818"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/133432818" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> csmoe <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#133432818">(Sep 06 2018 at 10:02)</a>:</h4>
<p>btw, as eddyb mentioned in IRC, he wanna refactor <code>Deref</code>out of  <code>Place</code></p>



<a name="133432823"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/133432823" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> csmoe <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#133432823">(Sep 06 2018 at 10:02)</a>:</h4>
<p>yes 552a935</p>



<a name="133433871"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/133433871" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#133433871">(Sep 06 2018 at 10:28)</a>:</h4>
<blockquote>
<p>btw, as eddyb mentioned in IRC, he wanna refactor <code>Deref</code>out of  <code>Place</code></p>
</blockquote>
<p>yes, I know. That's.. a much bigger job.</p>



<a name="133755798"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/133755798" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#133755798">(Sep 11 2018 at 19:49)</a>:</h4>
<p><span class="user-mention" data-user-id="116773">@csmoe</span> you around btw? we should maybe reserve a time to dig into this together and decide what next steps are</p>



<a name="133795123"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/133795123" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> csmoe <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#133795123">(Sep 12 2018 at 12:22)</a>:</h4>
<p><span class="user-mention" data-user-id="116009">@nikomatsakis</span> i'll be here about 1 day later. will ping you then</p>



<a name="133882435"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/133882435" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> csmoe <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#133882435">(Sep 13 2018 at 13:01)</a>:</h4>
<p><span class="user-mention" data-user-id="116009">@nikomatsakis</span> ping, I'm back</p>



<a name="133882856"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/133882856" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#133882856">(Sep 13 2018 at 13:07)</a>:</h4>
<p>hey <span class="user-mention" data-user-id="116773">@csmoe</span> — I'll be back in a few minutes :)</p>



<a name="133884963"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/133884963" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#133884963">(Sep 13 2018 at 13:39)</a>:</h4>
<p>ok, back now <span class="user-mention" data-user-id="116773">@csmoe</span>, let's talk briefly...</p>



<a name="133885022"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/133885022" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#133885022">(Sep 13 2018 at 13:40)</a>:</h4>
<p>so I think we both agree that the existing PR is sort of doing too much in one bite, right?</p>



<a name="133885053"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/133885053" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#133885053">(Sep 13 2018 at 13:40)</a>:</h4>
<p>still, it's quite useful as it contains some version of all the things we're going to have to do (well, most)</p>



<a name="133885077"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/133885077" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#133885077">(Sep 13 2018 at 13:41)</a>:</h4>
<p>so we can kind of skim over it and see what the steps are and if there is a way to order them so that we can test them more piece-by-piece</p>



<a name="133885158"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/133885158" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#133885158">(Sep 13 2018 at 13:42)</a>:</h4>
<p>there is one thing that I think we <em>are</em> missing still, which is that I think we may want to modify MIR construction so that we don't intern every little "in between place", but rather accumulate a full place and then intern the end result</p>



<a name="133885238"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/133885238" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#133885238">(Sep 13 2018 at 13:43)</a>:</h4>
<blockquote>
<p>so we can kind of skim over it and see what the steps are and if there is a way to order them so that we can test them more piece-by-piece</p>
</blockquote>
<p>oh, and I think it's useful for another reason: I strongly suspect we'll be kind of copying over these hunks as we go</p>



<a name="133885371"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/133885371" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#133885371">(Sep 13 2018 at 13:45)</a>:</h4>
<p>so what are the pieces?</p>
<ul>
<li>rewriting some algorithms to operate using iteration and not recursion</li>
<li>separating out a <code>PlaceBuilder</code> for use during MIR construction </li>
<li>changing the actual representation itself and adding whatever interning code etc is required</li>
</ul>



<a name="133885375"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/133885375" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#133885375">(Sep 13 2018 at 13:45)</a>:</h4>
<p>I think that's it?</p>



<a name="133885442"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/133885442" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#133885442">(Sep 13 2018 at 13:46)</a>:</h4>
<p>I think where I would start is by creating an alternative place, let's call it <code>PlaceSlice&lt;'tcx&gt;</code> or <code>Place2</code> or something; this defines the new representation</p>



<a name="133885446"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/133885446" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#133885446">(Sep 13 2018 at 13:46)</a>:</h4>
<p>then I would have a way to convert from the existing <code>Place</code> into that form</p>



<a name="133885459"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/133885459" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> csmoe <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#133885459">(Sep 13 2018 at 13:46)</a>:</h4>
<p>impl From&lt;Place&gt; for NewPlace like?</p>



<a name="133885461"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/133885461" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#133885461">(Sep 13 2018 at 13:46)</a>:</h4>
<p>then I would go through and find the algorithms you had to rewrite — starting with the ones (like <code>places_conflict</code>) that work better using iteration</p>



<a name="133885477"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/133885477" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#133885477">(Sep 13 2018 at 13:47)</a>:</h4>
<blockquote>
<p>impl From&lt;Place&gt; for NewPlace like?</p>
</blockquote>
<p>well, I was thinking more like <code>place.as_new_place(tcx)</code></p>



<a name="133885487"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/133885487" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#133885487">(Sep 13 2018 at 13:47)</a>:</h4>
<p>or <code>tcx.as_new_place(place)</code></p>



<a name="133885493"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/133885493" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#133885493">(Sep 13 2018 at 13:47)</a>:</h4>
<p>the reason being you will want the tcx to do interning</p>



<a name="133885502"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/133885502" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#133885502">(Sep 13 2018 at 13:47)</a>:</h4>
<p>this basically lets us add the "new repr + intern" code without breaking anything yet :)</p>



<a name="133885518"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/133885518" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#133885518">(Sep 13 2018 at 13:47)</a>:</h4>
<p>then we can go to each algorithm, 1 by 1, and have them convert from "old place" to "new place"</p>



<a name="133885522"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/133885522" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#133885522">(Sep 13 2018 at 13:47)</a>:</h4>
<p>(it's slow, but so what)</p>



<a name="133885569"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/133885569" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#133885569">(Sep 13 2018 at 13:48)</a>:</h4>
<p>once you've converted an algorithm, you can then run tests, everything should still work</p>



<a name="133885585"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/133885585" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#133885585">(Sep 13 2018 at 13:48)</a>:</h4>
<p>eventually we should be able to remove all uses of the original place</p>



<a name="133885617"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/133885617" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#133885617">(Sep 13 2018 at 13:49)</a>:</h4>
<p>I would probably do this by making the details of the struct private or something, running <code>x.py check</code>, find a place that breaks. Make it public again, but change that place. Then repeat.</p>



<a name="133885627"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/133885627" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#133885627">(Sep 13 2018 at 13:49)</a>:</h4>
<p>at that point we'll have a slow compiler but a working on that basically uses the new places only</p>



<a name="133885628"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/133885628" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> csmoe <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#133885628">(Sep 13 2018 at 13:49)</a>:</h4>
<p>okay, get it.<br>
 I'll start working on that with <code>change-test-change</code> flow tomorrow(midnight now in utc+8)</p>



<a name="133885640"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/133885640" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#133885640">(Sep 13 2018 at 13:49)</a>:</h4>
<p>finally then we can figure out the MIR construction piece and just make the new places from the start</p>



<a name="133885663"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/133885663" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#133885663">(Sep 13 2018 at 13:49)</a>:</h4>
<p>ok, let me know how it goes</p>



<a name="133885720"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/133885720" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> csmoe <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#133885720">(Sep 13 2018 at 13:50)</a>:</h4>
<p>thank you :)</p>



<a name="133885751"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/133885751" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#133885751">(Sep 13 2018 at 13:50)</a>:</h4>
<p>also, once you've got the first commit (the one that just adds a new kind of place but doesn't really use it yet), ping me so I can take a look :)</p>



<a name="133885769"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/133885769" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> csmoe <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#133885769">(Sep 13 2018 at 13:51)</a>:</h4>
<p>okay.</p>



<a name="133885773"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/133885773" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#133885773">(Sep 13 2018 at 13:51)</a>:</h4>
<p>cool!</p>



<a name="133885785"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/133885785" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#133885785">(Sep 13 2018 at 13:51)</a>:</h4>
<p>PS I will just share with you one concern. I like 99.5% sure that — once we're done — this will be a better way to represent places. but there is the chance we'll decide otherwise. ;)</p>



<a name="133885792"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/133885792" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#133885792">(Sep 13 2018 at 13:51)</a>:</h4>
<p>(I am particularly confident having seen your PR, a lot of the algorithms and code felt more natural)</p>



<a name="133885816"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/133885816" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#133885816">(Sep 13 2018 at 13:52)</a>:</h4>
<p>(and I think we can trivially recover the "recursive" style of Place as well, so we've lost nothing)</p>



<a name="133885855"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/133885855" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#133885855">(Sep 13 2018 at 13:52)</a>:</h4>
<p>anyway, that's always the risk with refactorings I guess though</p>



<a name="133886109"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/133886109" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> csmoe <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#133886109">(Sep 13 2018 at 13:56)</a>:</h4>
<p>a bit sorry that I can't give you some more constructive reply as a newbie, but I'll try my best to land your instructions, at least.</p>



<a name="133886265"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/133886265" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#133886265">(Sep 13 2018 at 13:59)</a>:</h4>
<p>I'm mostly just prep'ing you :)</p>



<a name="133886277"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/133886277" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#133886277">(Sep 13 2018 at 13:59)</a>:</h4>
<p>that is, warning you</p>



<a name="133886279"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/133886279" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#133886279">(Sep 13 2018 at 13:59)</a>:</h4>
<p>but I figure, either way, you got a tour of the codebase</p>



<a name="133886281"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/133886281" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#133886281">(Sep 13 2018 at 13:59)</a>:</h4>
<p>:P</p>



<a name="133886332"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/133886332" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#133886332">(Sep 13 2018 at 14:00)</a>:</h4>
<p>as I said, i'm pretty sure we want to go in this direction</p>



<a name="133886373"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/133886373" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> csmoe <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#133886373">(Sep 13 2018 at 14:01)</a>:</h4>
<p>yep :)</p>



<a name="133937126"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/133937126" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> csmoe <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#133937126">(Sep 14 2018 at 07:40)</a>:</h4>
<p><span class="user-mention" data-user-id="116009">@nikomatsakis</span> <br>
update: introduce new place definition<br>
<a href="https://github.com/csmoe/rust/commit/fde10d88700968e35af4cac0ab9ad2c724dc9635" target="_blank" title="https://github.com/csmoe/rust/commit/fde10d88700968e35af4cac0ab9ad2c724dc9635">https://github.com/csmoe/rust/commit/fde10d88700968e35af4cac0ab9ad2c724dc9635</a></p>



<a name="133957044"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/133957044" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#133957044">(Sep 14 2018 at 14:40)</a>:</h4>
<p><span class="user-mention" data-user-id="116773">@csmoe</span> looking good =) we probably want to write the code to convert from <code>Place</code> to <code>NeoPlace</code> I guess :)</p>



<a name="134001100"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/134001100" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> csmoe <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#134001100">(Sep 15 2018 at 07:36)</a>:</h4>
<p><span class="user-mention" data-user-id="116009">@nikomatsakis</span> <br>
update: implement .as_new_place for TyCtxt<br>
<a href="https://github.com/csmoe/rust/commit/ea0d974ce01abc8f2c09b8f9516f9e8fc109b1e9" target="_blank" title="https://github.com/csmoe/rust/commit/ea0d974ce01abc8f2c09b8f9516f9e8fc109b1e9">https://github.com/csmoe/rust/commit/ea0d974ce01abc8f2c09b8f9516f9e8fc109b1e9</a></p>



<a name="134006069"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/134006069" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#134006069">(Sep 15 2018 at 10:16)</a>:</h4>
<p><span class="user-mention" data-user-id="116773">@csmoe</span> I noticed one bug, left <a href="https://github.com/csmoe/rust/commit/ea0d974ce01abc8f2c09b8f9516f9e8fc109b1e9#r30516559" target="_blank" title="https://github.com/csmoe/rust/commit/ea0d974ce01abc8f2c09b8f9516f9e8fc109b1e9#r30516559">a comment</a></p>



<a name="134007212"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/134007212" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> csmoe <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#134007212">(Sep 15 2018 at 10:42)</a>:</h4>
<p><span class="user-mention" data-user-id="116009">@nikomatsakis</span> okay fixed, then I'll "copy" the methods of old_place to <code>NeoPlace</code>.</p>



<a name="134185487"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/134185487" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#134185487">(Sep 18 2018 at 18:57)</a>:</h4>
<p><span class="user-mention" data-user-id="116773">@csmoe</span> is the comment on <a href="https://github.com/rust-lang/rust/pull/53247" target="_blank" title="https://github.com/rust-lang/rust/pull/53247">https://github.com/rust-lang/rust/pull/53247</a> just antiquated?</p>



<a name="134228451"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/134228451" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> csmoe <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#134228451">(Sep 19 2018 at 12:19)</a>:</h4>
<p><span class="user-mention" data-user-id="116009">@nikomatsakis</span> yes</p>



<a name="134514523"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/134514523" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> csmoe <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#134514523">(Sep 24 2018 at 09:06)</a>:</h4>
<p><span class="user-mention" data-user-id="116009">@nikomatsakis</span> <br>
for some data structures wrap <code>Place</code> inside them, like <code>T(Place)</code>, should I replace inner <code>Place</code> with <code>NeoPlace</code> or just leave the def unchanged and convert it to <code>NeoPlace</code> later in every method acted on it?</p>
<div class="codehilite"><pre><span></span><span class="w">   </span><span class="k">fn</span> <span class="nf">foo</span><span class="p">()</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="kd">let</span><span class="w"> </span><span class="n">T</span><span class="p">(</span><span class="n">place</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">t</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">            </span><span class="n">tcx</span><span class="p">.</span><span class="n">as_new_place</span><span class="p">(</span><span class="n">place</span><span class="p">);</span><span class="w"></span>
<span class="w">            </span><span class="p">...</span><span class="w"></span>
<span class="w">         </span><span class="p">}</span><span class="w"></span>
<span class="w">    </span><span class="p">}</span><span class="w"></span>
</pre></div>


<p>EDIT: i'd take the later approach since early changes on def is kind of breaking change, it's hard to maintain.</p>



<a name="134535057"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/134535057" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#134535057">(Sep 24 2018 at 15:55)</a>:</h4>
<p><span class="user-mention" data-user-id="116773">@csmoe</span> sounds wise... how goes?</p>



<a name="134535154"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/134535154" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> csmoe <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#134535154">(Sep 24 2018 at 15:56)</a>:</h4>
<p>goes well locally</p>



<a name="134648612"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/134648612" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> csmoe <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#134648612">(Sep 26 2018 at 06:13)</a>:</h4>
<p><span class="user-mention" data-user-id="116009">@nikomatsakis</span> for the inelegant <code>.has_no_projection()</code> checking you said when we wanna match with  place without projection, how about add a helper as:</p>
<div class="codehilite"><pre><span></span><span class="k">impl</span><span class="w"> </span><span class="n">NeoPlace</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">   </span><span class="c1">// Base.[]</span>
<span class="w">  </span><span class="c1">//       ^^ no projection</span>
<span class="w">   </span><span class="k">fn</span> <span class="nf">bare_place</span><span class="p">(</span><span class="o">&amp;</span><span class="bp">self</span><span class="p">)</span><span class="w"> </span>-&gt; <span class="nb">Option</span><span class="o">&lt;</span><span class="n">PlaceBase</span><span class="o">&gt;</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="bp">self</span><span class="p">.</span><span class="n">elems</span><span class="p">.</span><span class="n">is_empty</span><span class="p">()</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">             </span><span class="nb">Some</span><span class="p">(</span><span class="bp">self</span><span class="p">.</span><span class="n">base</span><span class="p">)</span><span class="w"></span>
<span class="w">        </span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">             </span><span class="nb">None</span><span class="w"></span>
<span class="w">        </span><span class="p">}</span><span class="w"></span>
<span class="w">   </span><span class="p">}</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>
</pre></div>


<p>then the old matching <br>
<code>if let Some(Place::Local(...)) = old_place</code><br>
 =&gt;<br>
<code>if let Some(PlaceBase::Local) = neo_place.bare_place()</code></p>



<a name="134663566"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/134663566" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> csmoe <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#134663566">(Sep 26 2018 at 10:41)</a>:</h4>
<p>ok, CI said yes about this, I'll move forward, if you have any suggestions, i'll be back to fixup</p>



<a name="134686514"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/134686514" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#134686514">(Sep 26 2018 at 16:16)</a>:</h4>
<blockquote>
<p>how about add a helper as:</p>
</blockquote>
<p><span class="user-mention" data-user-id="116773">@csmoe</span> sounds reasonable :)</p>



<a name="134846730"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/134846730" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#134846730">(Sep 28 2018 at 19:37)</a>:</h4>
<p><span class="user-mention" data-user-id="116773">@csmoe</span> <a href="https://github.com/rust-lang/rust/pull/54426#pullrequestreview-159997132" target="_blank" title="https://github.com/rust-lang/rust/pull/54426#pullrequestreview-159997132">left a comment on the PR</a></p>



<a name="134881580"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/134881580" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> csmoe <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#134881580">(Sep 29 2018 at 12:45)</a>:</h4>
<p><span class="user-mention" data-user-id="116009">@nikomatsakis</span> an unrelated question:<br>
why this snippet failed as <code>Eq</code> seems already implemented for <code>fn</code>?  cc <a href="https://doc.rust-lang.org/std/cmp/trait.Eq.html#implementors" target="_blank" title="https://doc.rust-lang.org/std/cmp/trait.Eq.html#implementors">https://doc.rust-lang.org/std/cmp/trait.Eq.html#implementors</a></p>
<div class="codehilite"><pre><span></span><span class="k">fn</span> <span class="nf">foo</span><span class="p">(</span><span class="n">i</span>: <span class="kt">i32</span><span class="p">)</span><span class="w"> </span>-&gt; <span class="kt">i32</span> <span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="mi">1</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>
<span class="k">fn</span> <span class="nf">bar</span><span class="p">(</span><span class="n">i</span>: <span class="kt">i32</span><span class="p">)</span><span class="w"> </span>-&gt; <span class="kt">i32</span> <span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="mi">1</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="k">fn</span> <span class="nf">main</span><span class="p">()</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="kd">let</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">foo</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="kd">let</span><span class="w"> </span><span class="n">y</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bar</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">y</span><span class="w"> </span><span class="p">{}</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>
</pre></div>


<div class="codehilite"><pre><span></span><span class="n">error</span><span class="p">[</span><span class="n">E0369</span><span class="p">]</span>: <span class="nc">binary</span><span class="w"> </span><span class="n">operation</span><span class="w"> </span><span class="err">`</span><span class="o">==</span><span class="err">`</span><span class="w"> </span><span class="n">cannot</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">applied</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="k">type</span> <span class="err">`</span><span class="k">fn</span><span class="p">(</span><span class="kt">i32</span><span class="p">)</span><span class="w"> </span>-&gt; <span class="kt">i32</span> <span class="p">{</span><span class="n">foo</span><span class="p">}</span><span class="err">`</span><span class="w"></span>
<span class="w">  </span><span class="o">-</span>-&gt; <span class="nc">src</span><span class="o">/</span><span class="n">main</span><span class="p">.</span><span class="n">rs</span>:<span class="mi">12</span>:<span class="mi">8</span><span class="w"></span>
<span class="w">   </span><span class="o">|</span><span class="w"></span>
<span class="mi">12</span><span class="w"> </span><span class="o">|</span><span class="w">     </span><span class="k">if</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">y</span><span class="w"> </span><span class="p">{}</span><span class="w"></span>
<span class="w">   </span><span class="o">|</span><span class="w">        </span><span class="o">^^^^^^</span><span class="w"></span>
<span class="w">   </span><span class="o">|</span><span class="w"></span>
<span class="w">   </span><span class="o">=</span><span class="w"> </span><span class="n">note</span>: <span class="nc">an</span><span class="w"> </span><span class="n">implementation</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="err">`</span><span class="n">std</span>::<span class="n">cmp</span>::<span class="nb">PartialEq</span><span class="err">`</span><span class="w"> </span><span class="n">might</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">missing</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="err">`</span><span class="k">fn</span><span class="p">(</span><span class="kt">i32</span><span class="p">)</span><span class="w"> </span>-&gt; <span class="kt">i32</span> <span class="p">{</span><span class="n">foo</span><span class="p">}</span><span class="err">`</span><span class="w"></span>
</pre></div>


<p><a href="https://play.rust-lang.org/?gist=5b2ba6a3308e2ff369e67348c8645023&amp;version=nightly&amp;mode=debug&amp;edition=2018" target="_blank" title="https://play.rust-lang.org/?gist=5b2ba6a3308e2ff369e67348c8645023&amp;version=nightly&amp;mode=debug&amp;edition=2018">https://play.rust-lang.org/?gist=5b2ba6a3308e2ff369e67348c8645023&amp;version=nightly&amp;mode=debug&amp;edition=2018</a></p>



<a name="134884220"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/134884220" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Gabriel Majeri <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#134884220">(Sep 29 2018 at 14:12)</a>:</h4>
<p>Hmm, this seems dubious. AFAIK Rust does not guarantee that different functions won't have the same address. So maybe this is intended, to avoid bugs?</p>



<a name="134888396"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/134888396" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> memoryruins <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#134888396">(Sep 29 2018 at 16:41)</a>:</h4>
<p>it compiles if we annotate x and y (and correctly panics on the assert_eq) <a href="https://play.rust-lang.org/?gist=466217d00a9cb33e9f5156046c85603a&amp;version=nightly&amp;mode=debug&amp;edition=2018" target="_blank" title="https://play.rust-lang.org/?gist=466217d00a9cb33e9f5156046c85603a&amp;version=nightly&amp;mode=debug&amp;edition=2018">https://play.rust-lang.org/?gist=466217d00a9cb33e9f5156046c85603a&amp;version=nightly&amp;mode=debug&amp;edition=2018</a></p>



<a name="134890241"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/134890241" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> memoryruins <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#134890241">(Sep 29 2018 at 17:38)</a>:</h4>
<p>compiling on release causes them to have the same address, but the assert will still panic</p>



<a name="134907230"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/134907230" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> memoryruins <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#134907230">(Sep 30 2018 at 03:52)</a>:</h4>
<p>wait, adding a println doesnt make the assert panic though? <span class="emoji emoji-1f914" title="thinking">:thinking:</span> <a href="https://play.rust-lang.org/?gist=ba8b4da114bac52f4e94eaaa0d8f1e98&amp;version=nightly&amp;mode=release&amp;edition=2018" target="_blank" title="https://play.rust-lang.org/?gist=ba8b4da114bac52f4e94eaaa0d8f1e98&amp;version=nightly&amp;mode=release&amp;edition=2018">https://play.rust-lang.org/?gist=ba8b4da114bac52f4e94eaaa0d8f1e98&amp;version=nightly&amp;mode=release&amp;edition=2018</a></p>



<a name="134907863"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/134907863" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> memoryruins <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#134907863">(Sep 30 2018 at 04:13)</a>:</h4>
<p>an issue was opened after tossing into another chat <a href="https://github.com/rust-lang/rust/issues/54685" target="_blank" title="https://github.com/rust-lang/rust/issues/54685">https://github.com/rust-lang/rust/issues/54685</a></p>



<a name="134909213"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/134909213" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> csmoe <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#134909213">(Sep 30 2018 at 05:05)</a>:</h4>
<p><span class="user-mention" data-user-id="131022">@Gabriel Majeri</span> <span class="user-mention" data-user-id="125246">@memoryruins</span>  thanks, it makes no sense to compare two pointers(raw address), as ishitatsuyuki <a href="https://github.com/rust-lang/rust/issues/54685#issuecomment-425694676" target="_blank" title="https://github.com/rust-lang/rust/issues/54685#issuecomment-425694676">said</a>:</p>
<blockquote>
<p>We run mergefunc pass on release builds. Anyway, can you explain why this is a problem? Rust does not make any guarantee on pointer values.</p>
</blockquote>
<p>I messed up the <code>fn</code> type and function pointer in the comparison</p>



<a name="134981704"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/134981704" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> memoryruins <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#134981704">(Oct 01 2018 at 16:41)</a>:</h4>
<p><span class="user-mention" data-user-id="116773">@csmoe</span> fn pointers implement <code>PartialEq</code> so it's understandable to expect some consistency. the conversation on the thread has led to proposing a patch of llvm (it affects constant globals too)</p>



<a name="134981798"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/134981798" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> csmoe <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#134981798">(Oct 01 2018 at 16:43)</a>:</h4>
<p>that's great:)</p>



<a name="134985350"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/134985350" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#134985350">(Oct 01 2018 at 17:49)</a>:</h4>
<p><span class="user-mention" data-user-id="116773">@csmoe</span> the problem in your original example is that the values are not actually of <code>fn</code> type, but perhaps that was clarified for you already?</p>



<a name="135026588"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/135026588" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> csmoe <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#135026588">(Oct 02 2018 at 10:25)</a>:</h4>
<p>yes</p>



<a name="135213661"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/135213661" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#135213661">(Oct 04 2018 at 20:15)</a>:</h4>
<p><span class="user-mention" data-user-id="116773">@csmoe</span> how's it going?</p>



<a name="135350240"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/135350240" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> csmoe <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#135350240">(Oct 07 2018 at 12:03)</a>:</h4>
<p>sorry for postponing,  I have been preparing for an exam recently. will ping for review with commits.</p>



<a name="135912381"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/135912381" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> csmoe <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#135912381">(Oct 16 2018 at 16:45)</a>:</h4>
<p><span class="user-mention" data-user-id="116009">@nikomatsakis</span> saw your comment there, I'm trapped in a China M.S. entrance exam(Dec. 22), so I cannot allocate enough time to the complicated parts but cleaning up small stuffs about neo_place when taking a break from the books.<br>
I feel good with current incremental refactoring so far and beg your patience, this issue can be fixed within 1 week once I'm freed from the exam.<br>
but if you wanna the place be replaced as soon as possible, splitting is fine.</p>



<a name="135912783"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/135912783" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#135912783">(Oct 16 2018 at 16:51)</a>:</h4>
<p>nah it's fine, I was just worried you were not having time and I didn't want to see the PR flounder after you've put so much good work into it</p>



<a name="135912791"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/135912791" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#135912791">(Oct 16 2018 at 16:51)</a>:</h4>
<p>I don't think it's <em>urgent</em> per se</p>



<a name="135912856"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/135912856" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> csmoe <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#135912856">(Oct 16 2018 at 16:52)</a>:</h4>
<p>thank you :)</p>



<a name="135921987"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/135921987" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pnkfelix <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#135921987">(Oct 16 2018 at 19:03)</a>:</h4>
<p>(Probably better to wait until after October 25th to land the refactoring, IMO ... to avoid losing time rebasing last minute PRs for the edition ....)</p>



<a name="135922604"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/135922604" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#135922604">(Oct 16 2018 at 19:13)</a>:</h4>
<p>it won't be ready by then anyway :)</p>



<a name="135933661"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/135933661" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Santiago Pastorino <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#135933661">(Oct 16 2018 at 22:14)</a>:</h4>
<p><span class="user-mention" data-user-id="116773">@csmoe</span> <span class="user-mention" data-user-id="116009">@nikomatsakis</span> I'm interested in getting involved in this part of the code, if <span class="user-mention" data-user-id="116773">@csmoe</span> is ok I can take a look and start to figure out what's going on and then if <span class="user-mention" data-user-id="116773">@csmoe</span> wants I can try to help them, pair or something like that</p>



<a name="135948624"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/135948624" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> csmoe <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#135948624">(Oct 17 2018 at 04:21)</a>:</h4>
<p><span class="user-mention" data-user-id="116266">@Santiago Pastorino</span> thank you<br>
so let me take a summary here:<br>
1. niko mentored me to refactor <code>Place</code> <a href="https://github.com/rust-lang/rust/pull/54426" target="_blank" title="https://github.com/rust-lang/rust/pull/54426">Take 2: step-by-step</a> instead of replacing all its appearances <a href="https://github.com/rust-lang/rust/pull/53247" target="_blank" title="https://github.com/rust-lang/rust/pull/53247">Take 1: at once</a>(this approach is really hard to maintain)<br>
2. the <code>Place</code> itself and needed methods were already refactored for <code>NeoPlace</code>(it will be rename to <code>Place</code> finally), as you can check them in <code>mir/mod.rs</code> <code>mir/tcx.rs</code>, so you can pull my branch(I rebased it onto the latest master just now) and continue the following work.<br>
3. the tasks left are just rewriting the original recursive operations on <code>Place</code> into iterative, as diff showed in the img <a href="user_uploads/4715/Cez2b9_CykGYej_4qOliTceT/pasted_image.png" target="_blank" title="user_uploads/4715/Cez2b9_CykGYej_4qOliTceT/pasted_image.png">pasted image</a><br>
- btw, a common workflow is:<br>
  recur_logic(old_place)<br>
  =&gt; let neo_place = tcx.as_new_place(old_place)<br>
  =&gt; recur_logic_to_iter(neo_place)<br>
4. when all the recursive stuffs are cleared, just delete old <code>Place</code> and rename <code>NeoPlace</code> to <code>Place</code>, finally clean up all the conversions by <code>as_new_place</code>,.</p>
<div class="message_inline_image"><a href="user_uploads/4715/Cez2b9_CykGYej_4qOliTceT/pasted_image.png" target="_blank" title="pasted image"><img src="user_uploads/4715/Cez2b9_CykGYej_4qOliTceT/pasted_image.png"></a></div>



<a name="135951473"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/135951473" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> csmoe <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#135951473">(Oct 17 2018 at 05:41)</a>:</h4>
<p>for anyone interested in this,  the remaining tasks are not hard based on my experience in take1, the most complicated parts are <a href="https://github.com/rust-lang/rust/blob/master/src/librustc_mir/borrow_check/places_conflict.rs" target="_blank" title="https://github.com/rust-lang/rust/blob/master/src/librustc_mir/borrow_check/places_conflict.rs">places_conflict</a> and <a href="https://github.com/rust-lang/rust/pull/54426#discussion_r221360415" target="_blank" title="https://github.com/rust-lang/rust/pull/54426#discussion_r221360415">describe_place</a>, but they're kind of easy with the existing comments/niko's reviews.</p>



<a name="135972101"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/135972101" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#135972101">(Oct 17 2018 at 13:20)</a>:</h4>
<p>I think it's a great idea to collaborate here</p>



<a name="135972114"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/135972114" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#135972114">(Oct 17 2018 at 13:21)</a>:</h4>
<p>there are a large-ish number of small changes to make, after all</p>



<a name="135993421"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/135993421" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Santiago Pastorino <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#135993421">(Oct 17 2018 at 18:58)</a>:</h4>
<p><span class="emoji emoji-1f44d" title="+1">:+1:</span></p>



<a name="135993426"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/135993426" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Santiago Pastorino <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#135993426">(Oct 17 2018 at 18:58)</a>:</h4>
<p>thanks for the info <span class="user-mention" data-user-id="116773">@csmoe</span></p>



<a name="136171287"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/136171287" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> csmoe <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#136171287">(Oct 20 2018 at 14:37)</a>:</h4>
<p><span class="user-mention" data-user-id="116009">@nikomatsakis</span> I wanna your help in this <a href="https://github.com/rust-lang/rust/pull/54426/commits/c246e70b57934ff7a4e6e236d1a4e41446f57a36" target="_blank" title="https://github.com/rust-lang/rust/pull/54426/commits/c246e70b57934ff7a4e6e236d1a4e41446f57a36">diff</a><br>
I've tried 4 times as the CI complained, but still failed at codegen <a href="https://github.com/rust-lang/rust/pull/54426#issuecomment-431584844" target="_blank" title="https://github.com/rust-lang/rust/pull/54426#issuecomment-431584844">testcases</a></p>



<a name="136275582"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/136275582" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#136275582">(Oct 22 2018 at 15:43)</a>:</h4>
<p><span class="user-mention" data-user-id="116773">@csmoe</span> ok</p>



<a name="136353543"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/136353543" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#136353543">(Oct 23 2018 at 17:47)</a>:</h4>
<p>looking now</p>



<a name="136354035"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/136354035" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#136354035">(Oct 23 2018 at 17:54)</a>:</h4>
<p>left a comment with a possible source of the problem</p>



<a name="136433148"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/136433148" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#136433148">(Oct 24 2018 at 20:06)</a>:</h4>
<p>left a new comment <span class="user-mention" data-user-id="116773">@csmoe</span></p>



<a name="136468018"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/136468018" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> csmoe <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#136468018">(Oct 25 2018 at 10:21)</a>:</h4>
<p><span class="user-mention" data-user-id="116009">@nikomatsakis</span> it still breaks.</p>



<a name="136468076"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/136468076" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> csmoe <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#136468076">(Oct 25 2018 at 10:22)</a>:</h4>
<p>the logic for scalar is wrong as the codegen/scalar-pair-bool.rs failed?</p>



<a name="136473981"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/136473981" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#136473981">(Oct 25 2018 at 12:32)</a>:</h4>
<p><span class="user-mention" data-user-id="116773">@csmoe</span> did you push your latest?</p>



<a name="136474987"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/136474987" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> csmoe <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#136474987">(Oct 25 2018 at 12:55)</a>:</h4>
<p><span class="user-mention" data-user-id="116009">@nikomatsakis</span> yes, it's latest</p>



<a name="147904998"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/147904998" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> csmoe <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#147904998">(Nov 18 2018 at 05:34)</a>:</h4>
<p><span class="user-mention" data-user-id="116009">@nikomatsakis</span> just inform you, I'm back on this. but still cannot figure out what's wrong with codegen_llvm, so I'm gonna revert the diffs in <code>src/codegen_llvm</code> and move the refactoring direction to the other parts.</p>



<a name="147957459"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/147957459" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> csmoe <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#147957459">(Nov 19 2018 at 10:33)</a>:</h4>
<p>update: rewrite places_confilct <a href="https://github.com/rust-lang/rust/pull/54426/commits/3258cc057c710fb91b8057545610120ceb9329ae" target="_blank" title="https://github.com/rust-lang/rust/pull/54426/commits/3258cc057c710fb91b8057545610120ceb9329ae">done</a></p>



<a name="147981070"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/147981070" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#147981070">(Nov 19 2018 at 17:32)</a>:</h4>
<p><span class="user-mention" data-user-id="116773">@csmoe</span> ok -- as some point you and <span class="user-mention" data-user-id="116266">@Santiago Pastorino</span> were talking about collaborating</p>



<a name="147981071"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/147981071" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#147981071">(Nov 19 2018 at 17:32)</a>:</h4>
<p>I'm presuming that's not happened, but maybe it'd be useful?</p>



<a name="147981075"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/147981075" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#147981075">(Nov 19 2018 at 17:32)</a>:</h4>
<p>sorry i've not had time to help out with debugging</p>



<a name="147981077"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/147981077" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#147981077">(Nov 19 2018 at 17:32)</a>:</h4>
<p>but that could change</p>



<a name="147981084"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/147981084" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#147981084">(Nov 19 2018 at 17:32)</a>:</h4>
<p>on wed is the code deadline for Rust 2018</p>



<a name="147981093"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/147981093" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#147981093">(Nov 19 2018 at 17:32)</a>:</h4>
<p>I could prob spare a few hours after that</p>



<a name="147981546"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/147981546" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Santiago Pastorino <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#147981546">(Nov 19 2018 at 17:41)</a>:</h4>
<p>yes</p>



<a name="147981549"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/147981549" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Santiago Pastorino <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#147981549">(Nov 19 2018 at 17:41)</a>:</h4>
<p>I can collaborate</p>



<a name="147981562"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/147981562" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Santiago Pastorino <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#147981562">(Nov 19 2018 at 17:41)</a>:</h4>
<p>after I finish my assigned task I guess I can start helping</p>



<a name="150926516"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/150926516" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> csmoe <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#150926516">(Dec 05 2018 at 13:16)</a>:</h4>
<p><span class="user-mention" data-user-id="116009">@nikomatsakis</span> <br>
does <a href="https://doc.rust-lang.org/nightly/nightly-rustc/rustc/mir/struct.UpvarDecl.html#structfield.by_ref" target="_blank" title="https://doc.rust-lang.org/nightly/nightly-rustc/rustc/mir/struct.UpvarDecl.html#structfield.by_ref">upvardecl.by_ref</a> mean?:</p>
<div class="codehilite"><pre><span></span><span class="kd">let</span><span class="w"> </span><span class="n">closure</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">|</span><span class="n">_</span><span class="o">|</span><span class="w"> </span><span class="p">{...};</span><span class="w"></span>
<span class="kd">let</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span><span class="w"></span>
<span class="n">closure</span><span class="p">(</span><span class="o">&amp;</span><span class="mi">1</span><span class="p">);</span><span class="w"></span>
<span class="w">        </span><span class="o">^--</span><span class="n">by_ref</span><span class="o">?</span><span class="w"></span>
</pre></div>



<a name="150926531"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/150926531" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#150926531">(Dec 05 2018 at 13:17)</a>:</h4>
<p>nope :) that is not an upvar</p>



<a name="150926545"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/150926545" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#150926545">(Dec 05 2018 at 13:17)</a>:</h4>
<p>a by-ref upvar might be <code>foo</code> in</p>
<div class="codehilite"><pre><span></span><span class="kd">let</span><span class="w"> </span><span class="n">foo</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span><span class="w"></span>
<span class="kd">let</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="n">println</span><span class="p">(</span><span class="s">&quot;{}&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">foo</span><span class="p">);</span><span class="w"></span>
<span class="n">x</span><span class="p">();</span><span class="w"></span>
</pre></div>



<a name="150926639"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/150926639" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> csmoe <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#150926639">(Dec 05 2018 at 13:18)</a>:</h4>
<p>thanks, gocha <span class="emoji emoji-1f642" title="slight smile">:slight_smile:</span></p>



<a name="150959062"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/150959062" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> blitzerr <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#150959062">(Dec 05 2018 at 20:41)</a>:</h4>
<p>Upvar is a variable declared before the closure definition. Hence, the name up-var, so you stand at the closure definition and look up, to find your up var <span class="emoji emoji-1f600" title="grinning">:grinning:</span></p>



<a name="151007713"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/151007713" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#151007713">(Dec 06 2018 at 13:57)</a>:</h4>
<p><span class="user-mention" data-user-id="116773">@csmoe</span> sorry been unresponsive this week -- how is the PR going? I'll try to check in and do some reviews this morning</p>



<a name="151007742"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/151007742" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> csmoe <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#151007742">(Dec 06 2018 at 13:57)</a>:</h4>
<p><span class="user-mention" data-user-id="116009">@nikomatsakis</span> I have been working on this these days these days</p>



<a name="151007795"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/151007795" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#151007795">(Dec 06 2018 at 13:58)</a>:</h4>
<p>great!</p>



<a name="151007808"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/151007808" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#151007808">(Dec 06 2018 at 13:58)</a>:</h4>
<p>I remember <span class="user-mention" data-user-id="116266">@Santiago Pastorino</span> was maybe going to poke at it too? Not sure if you ever found any way to divide work</p>



<a name="151007840"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/151007840" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> csmoe <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#151007840">(Dec 06 2018 at 13:58)</a>:</h4>
<p>new place_conflict was impl'd</p>



<a name="151008003"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/151008003" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> csmoe <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#151008003">(Dec 06 2018 at 14:00)</a>:</h4>
<p>but still stuck by describe_neo_place, it's a bit complicated. I am trying to impl the tree structure you mentioned</p>



<a name="151008085"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/151008085" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> csmoe <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#151008085">(Dec 06 2018 at 14:01)</a>:</h4>
<p>so maybe the <code>describe_place</code> can be divided into sub-task</p>



<a name="151008636"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/151008636" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> csmoe <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#151008636">(Dec 06 2018 at 14:09)</a>:</h4>
<div class="codehilite"><pre><span></span><span class="n">base</span><span class="p">.[</span><span class="n">a</span><span class="p">,</span><span class="w"> </span><span class="n">Deref</span><span class="p">,</span><span class="w"> </span><span class="n">b</span><span class="p">,</span><span class="w"> </span><span class="n">c</span><span class="p">]</span><span class="w"></span>
<span class="o">=&gt;</span><span class="w"></span>
<span class="w">   </span><span class="n">Deref</span><span class="w"></span>
<span class="w">    </span><span class="o">/</span><span class="w"> </span><span class="err">\</span><span class="w"></span>
<span class="w">   </span><span class="o">/</span><span class="w">   </span><span class="err">\</span><span class="w"></span>
<span class="w">  </span><span class="n">a</span><span class="w">     </span><span class="n">b</span><span class="w"></span>
<span class="w">         </span><span class="err">\</span><span class="w"></span>
<span class="w">          </span><span class="err">\</span><span class="w"></span>
<span class="w">           </span><span class="n">c</span><span class="w"></span>
</pre></div>


<p><span class="user-mention" data-user-id="116009">@nikomatsakis</span> is this tree you expected?</p>



<a name="151010532"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/151010532" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#151010532">(Dec 06 2018 at 14:35)</a>:</h4>
<p>I'm not sure <span class="user-mention" data-user-id="116773">@csmoe</span> what this notation means :)</p>



<a name="151010545"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/151010545" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#151010545">(Dec 06 2018 at 14:35)</a>:</h4>
<p>what is "base" here?</p>



<a name="151010607"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/151010607" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> csmoe <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#151010607">(Dec 06 2018 at 14:36)</a>:</h4>
<p><code>PlaceBase::Local</code> etc</p>



<a name="151010642"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/151010642" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> csmoe <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#151010642">(Dec 06 2018 at 14:36)</a>:</h4>
<p><a href="https://github.com/rust-lang/rust/pull/54426#discussion_r220255568" target="_blank" title="https://github.com/rust-lang/rust/pull/54426#discussion_r220255568">https://github.com/rust-lang/rust/pull/54426#discussion_r220255568</a><br>
here is your review comment.</p>



<a name="151010759"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/151010759" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> csmoe <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#151010759">(Dec 06 2018 at 14:38)</a>:</h4>
<p>same like comment for describe_place <a href="https://github.com/rust-lang/rust/pull/54426#discussion_r221360415" target="_blank" title="https://github.com/rust-lang/rust/pull/54426#discussion_r221360415">https://github.com/rust-lang/rust/pull/54426#discussion_r221360415</a></p>



<a name="151011215"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/151011215" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#151011215">(Dec 06 2018 at 14:44)</a>:</h4>
<p>so assuming <code>base</code> is (e.g.) a local variable like <code>x</code>, I expect <code>base.[a, Deref, b, c]</code> to mean:</p>
<div class="codehilite"><pre><span></span>base
|
field: a
|
deref
|
b
|
c
</pre></div>



<a name="151011282"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/151011282" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#151011282">(Dec 06 2018 at 14:45)</a>:</h4>
<p>or put in rust struct notation:</p>
<div class="codehilite"><pre><span></span>PlaceProjection {
  field: c,
  base: PlaceProjection {
    field: b,
    base: PlaceProjection {
      deref,
      base: PlaceProjection {
        field: a,
        base: PlaceBase {
            local: x
        }
      }
    }
  }
}
</pre></div>



<a name="151011298"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/151011298" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#151011298">(Dec 06 2018 at 14:45)</a>:</h4>
<p><span class="user-mention" data-user-id="116773">@csmoe</span> <span class="emoji emoji-1f446" title="point up">:point_up:</span></p>



<a name="151011667"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/151011667" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> csmoe <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#151011667">(Dec 06 2018 at 14:50)</a>:</h4>
<p>thanks, get the direction.</p>



<a name="151012246"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/151012246" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Santiago Pastorino <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#151012246">(Dec 06 2018 at 15:00)</a>:</h4>
<p>hey, yeah, we could see a way in which I can help</p>



<a name="151012272"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/151012272" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Santiago Pastorino <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#151012272">(Dec 06 2018 at 15:01)</a>:</h4>
<p>I guess, I'd need to catch up with what <span class="user-mention" data-user-id="116773">@csmoe</span> is already doing</p>



<a name="151012279"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/151012279" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Santiago Pastorino <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#151012279">(Dec 06 2018 at 15:01)</a>:</h4>
<p><span class="user-mention" data-user-id="116009">@nikomatsakis</span> any ideas for that?</p>



<a name="151012498"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/151012498" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> csmoe <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#151012498">(Dec 06 2018 at 15:04)</a>:</h4>
<p><span class="user-mention" data-user-id="116266">@Santiago Pastorino</span> I'll update the status tomorrow(it's local midnight)</p>



<a name="151013398"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/151013398" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Santiago Pastorino <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#151013398">(Dec 06 2018 at 15:14)</a>:</h4>
<p><span class="emoji emoji-1f44d" title="+1">:+1:</span></p>



<a name="152172375"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/152172375" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> csmoe <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#152172375">(Dec 19 2018 at 10:19)</a>:</h4>
<div class="codehilite"><pre><span></span><span class="k">pub</span><span class="w"> </span><span class="k">fn</span> <span class="nf">capture_assign_part</span><span class="p">(</span><span class="n">x</span>: <span class="p">(</span><span class="kt">i32</span><span class="p">,))</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">        </span><span class="o">||</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="n">x</span><span class="p">.</span><span class="mi">0</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span><span class="w"> </span><span class="p">};</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>
</pre></div>


<p><span class="user-mention" data-user-id="116107">@davidtwco</span> is <code>x.0</code> a upvar_field_projection? <a href="https://github.com/rust-lang/rust/blob/e7b4bc35e99ee3c5b2b42a1b8b3f9cd6eca1f0b2/src/librustc/mir/tcx.rs#L186" target="_blank" title="https://github.com/rust-lang/rust/blob/e7b4bc35e99ee3c5b2b42a1b8b3f9cd6eca1f0b2/src/librustc/mir/tcx.rs#L186">is_upvar_field_projection</a></p>



<a name="152172465"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/152172465" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> csmoe <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#152172465">(Dec 19 2018 at 10:20)</a>:</h4>
<div class="codehilite"><pre><span></span>NeoPlace { base: _1, elems: [Deref, Field(field[0], &amp;mut (i32,)), Deref, Field(field[0], i32)] }
</pre></div>


<p>this is <code>x.0</code> written in on-working new_place.</p>



<a name="152172682"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/152172682" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> csmoe <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#152172682">(Dec 19 2018 at 10:24)</a>:</h4>
<p>CI was happy with my new <a href="https://github.com/rust-lang/rust/pull/54426/files#diff-b3de64d5546855bc714650abe562b142" target="_blank" title="https://github.com/rust-lang/rust/pull/54426/files#diff-b3de64d5546855bc714650abe562b142">is_upvar_field_projection</a>, but while checking <code>x.0</code>, it failed.</p>



<a name="152173007"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/152173007" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> davidtwco <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#152173007">(Dec 19 2018 at 10:31)</a>:</h4>
<p>I think so..</p>



<a name="152173162"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/152173162" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> csmoe <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#152173162">(Dec 19 2018 at 10:35)</a>:</h4>
<p>okay, I'd recheck my refactoring of is_upvar_field_projection.</p>



<a name="152175602"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/152175602" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> csmoe <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#152175602">(Dec 19 2018 at 11:24)</a>:</h4>
<p><span class="user-mention" data-user-id="116107">@davidtwco</span>  here is your <code>is_upvar_field_projection</code></p>
<div class="codehilite"><pre><span></span><span class="k">pub</span><span class="w"> </span><span class="k">fn</span> <span class="nf">is_upvar_field_projection</span><span class="o">&lt;</span><span class="na">&#39;cx</span><span class="p">,</span><span class="w"> </span><span class="na">&#39;gcx</span><span class="o">&gt;</span><span class="p">(</span><span class="w"></span>
<span class="w">    </span><span class="o">&amp;</span><span class="bp">self</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">mir</span>: <span class="kp">&amp;</span><span class="na">&#39;cx</span><span class="w"> </span><span class="n">Mir</span><span class="o">&lt;</span><span class="na">&#39;tcx</span><span class="o">&gt;</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">tcx</span>: <span class="kp">&amp;</span><span class="nc">TyCtxt</span><span class="o">&lt;</span><span class="na">&#39;cx</span><span class="p">,</span><span class="w"> </span><span class="na">&#39;gcx</span><span class="p">,</span><span class="w"> </span><span class="na">&#39;tcx</span><span class="o">&gt;</span><span class="w"></span>
<span class="p">)</span><span class="w"> </span>-&gt; <span class="nb">Option</span><span class="o">&lt;</span><span class="n">Field</span><span class="o">&gt;</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="c1">// 1st</span>
<span class="w">    </span><span class="kd">let</span><span class="w"> </span><span class="p">(</span><span class="n">place</span><span class="p">,</span><span class="w"> </span><span class="n">by_ref</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="kd">let</span><span class="w"> </span><span class="n">Place</span>::<span class="n">Projection</span><span class="p">(</span><span class="k">ref</span><span class="w"> </span><span class="n">proj</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="bp">self</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="kd">let</span><span class="w"> </span><span class="n">ProjectionElem</span>::<span class="n">Deref</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">proj</span><span class="p">.</span><span class="n">elem</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">            </span><span class="p">(</span><span class="o">&amp;</span><span class="n">proj</span><span class="p">.</span><span class="n">base</span><span class="p">,</span><span class="w"> </span><span class="kc">true</span><span class="p">)</span><span class="w"></span>
<span class="w">        </span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">            </span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="w"> </span><span class="kc">false</span><span class="p">)</span><span class="w"></span>
<span class="w">        </span><span class="p">}</span><span class="w"></span>
<span class="w">    </span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">        </span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="w"> </span><span class="kc">false</span><span class="p">)</span><span class="w"></span>
<span class="w">    </span><span class="p">};</span><span class="w"></span>

<span class="w">    </span><span class="c1">// 2nd</span>
<span class="w">    </span><span class="k">match</span><span class="w"> </span><span class="n">place</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">        </span><span class="n">Place</span>::<span class="n">Projection</span><span class="p">(</span><span class="k">ref</span><span class="w"> </span><span class="n">proj</span><span class="p">)</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="k">match</span><span class="w"> </span><span class="n">proj</span><span class="p">.</span><span class="n">elem</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">            </span><span class="n">ProjectionElem</span>::<span class="n">Field</span><span class="p">(</span><span class="n">field</span><span class="p">,</span><span class="w"> </span><span class="n">_ty</span><span class="p">)</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">                </span><span class="kd">let</span><span class="w"> </span><span class="n">base_ty</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">proj</span><span class="p">.</span><span class="n">base</span><span class="p">.</span><span class="n">ty</span><span class="p">(</span><span class="n">mir</span><span class="p">,</span><span class="w"> </span><span class="o">*</span><span class="n">tcx</span><span class="p">).</span><span class="n">to_ty</span><span class="p">(</span><span class="o">*</span><span class="n">tcx</span><span class="p">);</span><span class="w"></span>

<span class="w">                </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">base_ty</span><span class="p">.</span><span class="n">is_closure</span><span class="p">()</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="n">base_ty</span><span class="p">.</span><span class="n">is_generator</span><span class="p">())</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"></span>
<span class="w">                    </span><span class="p">(</span><span class="o">!</span><span class="n">by_ref</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="n">mir</span><span class="p">.</span><span class="n">upvar_decls</span><span class="p">[</span><span class="n">field</span><span class="p">.</span><span class="n">index</span><span class="p">()].</span><span class="n">by_ref</span><span class="p">)</span><span class="w"></span>
<span class="w">                </span><span class="p">{</span><span class="w"></span>
<span class="w">                    </span><span class="nb">Some</span><span class="p">(</span><span class="n">field</span><span class="p">)</span><span class="w"></span>
<span class="w">                </span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">                    </span><span class="nb">None</span><span class="w"></span>
<span class="w">                </span><span class="p">}</span><span class="w"></span>
<span class="w">            </span><span class="p">},</span><span class="w"></span>
<span class="w">            </span><span class="n">_</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="nb">None</span><span class="p">,</span><span class="w"></span>
<span class="w">        </span><span class="p">}</span><span class="w"></span>
<span class="w">        </span><span class="n">_</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="nb">None</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="p">}</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>
</pre></div>


<p>given <code>x.0</code>written as the old recursive <code>Place</code>:</p>
<div class="codehilite"><pre><span></span>Place {
    elem: Field2,
    base: Place {
        elem: Deref,  // ERROR: base_ty is_not_closure
        base: Place {
            elem: Field1,
            base: Place {
                elem: deref,
                base: Place {
                    base: Local(1)
                }
            }
        }
    }
}
</pre></div>


<p>while following your checking-flow,  <code>x.0</code> cannot be <code>upvar_field_projection</code>.</p>



<a name="152175725"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/152175725" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> davidtwco <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#152175725">(Dec 19 2018 at 11:27)</a>:</h4>
<p>I was probably wrong then, it's been a while since I messed with <code>is_upvar_field_projection</code>.</p>



<a name="152177519"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/152177519" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> csmoe <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#152177519">(Dec 19 2018 at 12:10)</a>:</h4>
<p><span class="user-mention" data-user-id="116009">@nikomatsakis</span>  could you give me some tips about validating a place<code>is_upvar_field_projection</code> with &gt;=2 <code>field</code> projection?</p>



<a name="152177526"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/152177526" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> csmoe <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#152177526">(Dec 19 2018 at 12:10)</a>:</h4>
<p>this current version seems only works for place with only ONE <code>field</code></p>



<a name="152177586"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/152177586" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> csmoe <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#152177586">(Dec 19 2018 at 12:12)</a>:</h4>
<p>as above, the base_ty of <code>field2</code> is by-passed by <code>field1</code>, <code>field1_ty</code> shadows the inner most ty_of_<code>Local</code>(closure ty info lives here)</p>



<a name="152209242"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/152209242" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#152209242">(Dec 19 2018 at 20:09)</a>:</h4>
<p><span class="user-mention" data-user-id="116773">@csmoe</span> hmm</p>



<a name="152209246"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/152209246" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#152209246">(Dec 19 2018 at 20:09)</a>:</h4>
<p>are you saying you have a version that works but only for one field?</p>



<a name="152209257"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/152209257" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#152209257">(Dec 19 2018 at 20:09)</a>:</h4>
<p>I should refresh my build of your branch I guess</p>



<a name="152263177"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/152263177" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> csmoe <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#152263177">(Dec 20 2018 at 15:23)</a>:</h4>
<p><span class="user-mention" data-user-id="116009">@nikomatsakis</span> I have translated the original method with neo_place and replace all its usages with new one,  CI was happy with the new one.<br>
but while trying to check <code>base.deref.field1.deref.field2</code>, it failed.<br>
so I suspect that there is something wrong with the original checking logic if we declare <code>x.0</code> is <code>upvar_field_projection</code>.</p>
<div class="codehilite"><pre><span></span><span class="k">fn</span> <span class="nf">is_upvar_field_projection</span><span class="p">()</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="kd">let</span><span class="w"> </span><span class="p">(</span><span class="n">place</span><span class="p">,</span><span class="w"> </span><span class="n">by_ref</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="kd">let</span><span class="w"> </span><span class="n">Place</span>::<span class="n">Projection</span><span class="p">(</span><span class="k">ref</span><span class="w"> </span><span class="n">proj</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="bp">self</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">           </span><span class="k">if</span><span class="w"> </span><span class="kd">let</span><span class="w"> </span><span class="n">ProjectionElem</span>::<span class="n">Deref</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">proj</span><span class="p">.</span><span class="n">elem</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">            </span><span class="p">(</span><span class="o">&amp;</span><span class="n">proj</span><span class="p">.</span><span class="n">base</span><span class="p">,</span><span class="w"> </span><span class="kc">true</span><span class="p">)</span><span class="w"></span>
<span class="w">       </span><span class="p">}</span><span class="w"></span>
<span class="w">    </span><span class="p">}</span><span class="w"></span>
<span class="w">    </span><span class="n">Place</span>::<span class="n">Projection</span><span class="p">(</span><span class="k">ref</span><span class="w"> </span><span class="n">proj</span><span class="p">)</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="k">match</span><span class="w"> </span><span class="n">proj</span><span class="p">.</span><span class="n">elem</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">            </span><span class="n">ProjectionElem</span>::<span class="n">Field</span><span class="p">(</span><span class="n">field</span><span class="p">,</span><span class="w"> </span><span class="n">_ty</span><span class="p">)</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">                </span><span class="kd">let</span><span class="w"> </span><span class="n">base_ty</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">proj</span><span class="p">.</span><span class="n">base</span><span class="p">.</span><span class="n">ty</span><span class="p">(</span><span class="n">mir</span><span class="p">,</span><span class="w"> </span><span class="o">*</span><span class="n">tcx</span><span class="p">).</span><span class="n">to_ty</span><span class="p">(</span><span class="o">*</span><span class="n">tcx</span><span class="p">);</span><span class="w"></span>
<span class="w">   </span><span class="p">}</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>
</pre></div>


<p>this flow works with <code>Base.deref. field1.deref</code>: unwarps <code>deref</code> and <code>field1</code>;  base = <code>Base.deref</code>; base_ty = base.ty(...); the base_ty derive from <code>Base</code> holds the <code>is_closure_generator</code> info.</p>
<p>for  <code>Base.deref.field1.deref.field2</code>: after unwrapping <code>field2</code> and <code>deref</code>, base = <code>base.deref.field1</code>,  base_ty = base.ty(..); but this case the base_ty from <code>field1</code> lost the <code>is_closure_generator</code> info. so  <code>is_upvar_field_projection</code> checking failed.</p>



<a name="152263784"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/152263784" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> csmoe <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#152263784">(Dec 20 2018 at 15:31)</a>:</h4>
<p>anyway, the tldr above can be ignored. since CI was happy with <code>is_upvar_field_projection</code> and I found some trick to avoid <code>is_upvar_field_projection</code>  checking with <code>x.0</code>.</p>



<a name="152266183"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/152266183" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#152266183">(Dec 20 2018 at 16:06)</a>:</h4>
<p><span class="user-mention" data-user-id="116773">@csmoe</span> what is current status of this branch anyway? I'm sorry this turned into such a monster project :) should I be starting up doing reviews again?</p>



<a name="152266761"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/152266761" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> csmoe <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#152266761">(Dec 20 2018 at 16:13)</a>:</h4>
<p><span class="user-mention" data-user-id="116009">@nikomatsakis</span> describe-place is finally done, but I'm sorry that I didn't follow the structure you suggested since that was kind new recursion while implementing it. my solution is a bit tricky. may i have your review on the latest 4 describe-place commits?</p>



<a name="152266924"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/152266924" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> csmoe <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#152266924">(Dec 20 2018 at 16:15)</a>:</h4>
<p>and especially for the diffs in ui stderr, I made some changes on them.</p>



<a name="152267184"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/152267184" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> csmoe <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#152267184">(Dec 20 2018 at 16:18)</a>:</h4>
<p>as for the status, I think the hardest time will be gone if you are happy with redescribe-place. the remaining work is easy.</p>



<a name="154205009"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/154205009" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#154205009">(Jan 02 2019 at 22:09)</a>:</h4>
<p><span class="user-mention" data-user-id="116773">@csmoe</span> sorry for not doing those reviews yet, will try to do so asap</p>



<a name="154205011"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/154205011" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#154205011">(Jan 02 2019 at 22:09)</a>:</h4>
<p>holidays intervened</p>



<a name="154205018"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/154205018" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#154205018">(Jan 02 2019 at 22:09)</a>:</h4>
<p><span class="user-mention" data-user-id="116266">@Santiago Pastorino</span> and I were just discussing if collaboration would be helpful</p>



<a name="154205076"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/154205076" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Santiago Pastorino <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#154205076">(Jan 02 2019 at 22:10)</a>:</h4>
<p>sorry that I've promised to do so in the past and didn't have time</p>



<a name="154205078"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/154205078" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Santiago Pastorino <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#154205078">(Jan 02 2019 at 22:10)</a>:</h4>
<p>can be around now</p>



<a name="154205082"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/154205082" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Santiago Pastorino <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#154205082">(Jan 02 2019 at 22:10)</a>:</h4>
<p>need to catch up</p>



<a name="154205277"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/154205277" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> csmoe <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#154205277">(Jan 02 2019 at 22:15)</a>:</h4>
<p><span class="user-mention" data-user-id="116009">@nikomatsakis</span> if possible, would you mind taking a look at the stderr diffs(made by redescribe-place) first?</p>



<a name="154205360"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/154205360" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> csmoe <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#154205360">(Jan 02 2019 at 22:17)</a>:</h4>
<p>I changed some deref descriptions like:<br>
assignment to <code>*foo.bar</code> =&gt; assignment to <code>foo.bar</code></p>



<a name="154205372"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/154205372" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#154205372">(Jan 02 2019 at 22:17)</a>:</h4>
<p>ok</p>



<a name="154260936"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/154260936" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#154260936">(Jan 03 2019 at 19:30)</a>:</h4>
<p><span class="user-mention" data-user-id="116773">@csmoe</span> which commit is that in particular?</p>



<a name="154260940"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/154260940" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#154260940">(Jan 03 2019 at 19:30)</a>:</h4>
<p>I am looking now</p>



<a name="154261311"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/154261311" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#154261311">(Jan 03 2019 at 19:36)</a>:</h4>
<p>oh I guess " re-describe place "</p>



<a name="154262144"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/154262144" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#154262144">(Jan 03 2019 at 19:51)</a>:</h4>
<p>left some comments</p>



<a name="154395698"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/154395698" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> csmoe <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#154395698">(Jan 04 2019 at 08:04)</a>:</h4>
<p><span class="user-mention" data-user-id="116009">@nikomatsakis</span> amended some changes, reduced the stderr diffs to just 3 <code>ref foo</code><a href="https://github.com/rust-lang/rust/pull/54426#discussion_r245231108" target="_blank" title="https://github.com/rust-lang/rust/pull/54426#discussion_r245231108">cases</a>.</p>



<a name="154395915"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/154395915" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> csmoe <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#154395915">(Jan 04 2019 at 08:10)</a>:</h4>
<p><a href="#narrow/stream/122657-wg-nll/subject/.2352708-new-place/near/151011215" title="#narrow/stream/122657-wg-nll/subject/.2352708-new-place/near/151011215">https://rust-lang.zulipchat.com/#narrow/stream/122657-wg-nll/subject/.2352708-new-place/near/151011215</a><br>
here is your suggestions to me, while tried to implement that, I felt like introducing another recursive datastructure.</p>



<a name="154395973"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/154395973" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> csmoe <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#154395973">(Jan 04 2019 at 08:12)</a>:</h4>
<p>(really sorry for "betray"ing)</p>



<a name="154396988"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/154396988" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> csmoe <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#154396988">(Jan 04 2019 at 08:41)</a>:</h4>
<p>the key for describing <code>Deref</code> is detecting <code>autoderef</code>, which controls whether <code>*</code> should be print.</p>



<a name="154397144"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/154397144" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> csmoe <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#154397144">(Jan 04 2019 at 08:44)</a>:</h4>
<p>my approach is for each <code>Deref</code>elem, it is <code>autoderef</code> if the future contains autoderef_elem: </p>
<div class="codehilite"><pre><span></span><span class="kd">let</span><span class="w"> </span><span class="n">autoderef_elem</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">|&amp;</span><span class="n">e</span><span class="o">|</span><span class="w"> </span><span class="k">match</span><span class="w"> </span><span class="n">e</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="n">ProjectionElem</span>::<span class="n">Field</span><span class="p">(..)</span><span class="w"></span>
<span class="w">    </span><span class="o">|</span><span class="w"> </span><span class="n">ProjectionElem</span>::<span class="n">Subslice</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="p">..</span><span class="w"> </span><span class="p">}</span><span class="w"></span>
<span class="w">    </span><span class="o">|</span><span class="w"> </span><span class="n">ProjectionElem</span>::<span class="n">ConstantIndex</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="p">..</span><span class="w"> </span><span class="p">}</span><span class="w"></span>
<span class="w">    </span><span class="o">|</span><span class="w"> </span><span class="n">ProjectionElem</span>::<span class="n">Index</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="p">..</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">_</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="kc">false</span><span class="p">,</span><span class="w"></span>
<span class="p">};</span><span class="w"></span>

<span class="kd">let</span><span class="w"> </span><span class="n">autoderef</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">place</span><span class="p">.</span><span class="n">elems</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">..].</span><span class="n">iter</span><span class="p">().</span><span class="n">any</span><span class="p">(</span><span class="n">autoderef_elem</span><span class="p">);</span><span class="w"></span>
</pre></div>



<a name="154397332"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/154397332" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> csmoe <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#154397332">(Jan 04 2019 at 08:49)</a>:</h4>
<p>for example: <code>base.[Deref1, Field, Deref2]</code>:<br>
1. base: place = <code>base</code>;<br>
2. deref1: its next elem is <code>Field</code>, and <code>autoderf = true</code>, thus no <code>*</code>, place = <code>base</code><br>
3. field: place = <code>base.field</code><br>
4. deref2: autoderef = <code>false</code>,  then <code>*</code> should be there, place = <code>*base.field</code></p>



<a name="154397467"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/154397467" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> csmoe <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#154397467">(Jan 04 2019 at 08:53)</a>:</h4>
<p><a href="https://github.com/rust-lang/rust/pull/54426/commits/372e25a7f4ae363bc3a5b853b53de9387f676d8c#r245229701" target="_blank" title="https://github.com/rust-lang/rust/pull/54426/commits/372e25a7f4ae363bc3a5b853b53de9387f676d8c#r245229701">trick</a> explanation:</p>



<a name="154397618"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/154397618" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> csmoe <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#154397618">(Jan 04 2019 at 08:58)</a>:</h4>
<div class="codehilite"><pre><span></span><span class="kd">let</span><span class="w"> </span><span class="n">no_local_name</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="bp">self</span><span class="p">.</span><span class="n">mir</span><span class="p">.</span><span class="n">local_decls</span><span class="p">.</span><span class="n">is_empty</span><span class="p">()</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="kc">true</span><span class="w"></span>
<span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="bp">self</span><span class="p">.</span><span class="n">mir</span><span class="p">.</span><span class="n">local_decls</span><span class="p">.</span><span class="n">len</span><span class="p">()</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">        </span><span class="bp">self</span><span class="p">.</span><span class="n">mir</span><span class="p">.</span><span class="n">local_decls</span><span class="p">[</span><span class="n">Local</span>::<span class="n">new</span><span class="p">(</span><span class="mi">1</span><span class="p">)].</span><span class="n">name</span><span class="p">.</span><span class="n">is_none</span><span class="p">()</span><span class="w"></span>
<span class="w">    </span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">        </span><span class="kc">false</span><span class="w"></span>
<span class="w">    </span><span class="p">}</span><span class="w"></span>
<span class="p">};</span><span class="w"></span>
<span class="k">if</span><span class="w"> </span><span class="n">PlaceBase</span>::<span class="n">Local</span><span class="p">(</span><span class="n">Local</span>::<span class="n">new</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">place</span><span class="p">.</span><span class="n">base</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">no_local_name</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">     </span><span class="c1">// see [check-explanation] below.</span>
<span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="k">match</span><span class="w"> </span><span class="n">place</span><span class="p">.</span><span class="n">base</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">       </span><span class="n">Local</span><span class="p">(</span><span class="n">local</span><span class="p">)</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="n">local_str</span><span class="p">(</span><span class="n">local</span><span class="p">)</span><span class="o">?</span><span class="w"> </span><span class="c1">// Blame</span>
<span class="w">   </span><span class="p">}</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>
</pre></div>


<p>to be honest, this snippet is ugly. </p>
<p>[check-explanation]<br>
all those check is for avoiding unindented panic  when we cannot get the name from <code>local_str()?</code><br>
as you can see, I describe place <strong>from base to elems</strong>. when <code>local_str()?</code> panic, <br>
<code>describe_place</code> will return <code>None</code> directly, but it should not in some cases. <br>
in the original recursive flow, place is described <strong>from outer elems to base</strong>, although it cannot get a name from base, it still got a name from elem like <code>Field</code>.<br>
 so my check will skip <code>Local</code> base in those cases and just forward to elems description.</p>



<a name="154429204"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/154429204" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#154429204">(Jan 04 2019 at 19:04)</a>:</h4>
<p>hmm <span class="user-mention" data-user-id="116773">@csmoe</span>, I'll take another look. Would you object if I do a bit of experimentation and maybe push something?</p>



<a name="154430702"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/154430702" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> csmoe <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#154430702">(Jan 04 2019 at 19:27)</a>:</h4>
<p><span class="user-mention" data-user-id="116009">@nikomatsakis</span> yes, whatever.</p>



<a name="154431057"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/154431057" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> csmoe <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#154431057">(Jan 04 2019 at 19:33)</a>:</h4>
<p>btw, all the commits before the latest rec_lookup rewriting works fine(include re-describing).</p>



<a name="154864529"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/154864529" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#154864529">(Jan 10 2019 at 19:26)</a>:</h4>
<p><span class="user-mention" data-user-id="116773">@csmoe</span> would you want to try and schedule a time to chat synchronously about this? Maybe with <span class="user-mention" data-user-id="116266">@Santiago Pastorino</span>? could be a video call or else maybe chat on zulip</p>



<a name="154864548"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/154864548" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#154864548">(Jan 10 2019 at 19:27)</a>:</h4>
<p>it's been really hard for me to carve out time to follow up and I'm sorry, which is partly why I'm thinking scheduling time might help :)</p>



<a name="154864882"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/154864882" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Santiago Pastorino <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#154864882">(Jan 10 2019 at 19:31)</a>:</h4>
<p><span class="emoji emoji-1f44d" title="+1">:+1:</span></p>



<a name="154864934"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/154864934" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Santiago Pastorino <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#154864934">(Jan 10 2019 at 19:32)</a>:</h4>
<p>it would be great so I can catch up</p>



<a name="154903245"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/154903245" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> csmoe <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#154903245">(Jan 11 2019 at 08:58)</a>:</h4>
<p><span class="user-mention" data-user-id="116266">@Santiago Pastorino</span> it's 17:00pm now in my local time, I'll be available in next 5 hours. if you are here, just ping me.</p>



<a name="154903253"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/154903253" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> csmoe <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#154903253">(Jan 11 2019 at 08:58)</a>:</h4>
<p>we'll chat here.</p>



<a name="154915709"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/154915709" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Santiago Pastorino <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#154915709">(Jan 11 2019 at 13:09)</a>:</h4>
<p><span class="user-mention" data-user-id="116773">@csmoe</span> hey, I’m not around, will be in 2hs but let’s coordinate a day and time</p>



<a name="154916280"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/154916280" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> csmoe <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#154916280">(Jan 11 2019 at 13:20)</a>:</h4>
<p><span class="user-mention" data-user-id="116266">@Santiago Pastorino</span> okay, I see, I'll be available again 9 hours later, it'll be 19:20pm at your timezone.</p>



<a name="154918052"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/154918052" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Santiago Pastorino <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#154918052">(Jan 11 2019 at 13:53)</a>:</h4>
<p>during january I’m around between 12pm and 4pm GMT-3</p>



<a name="154918057"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/154918057" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Santiago Pastorino <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#154918057">(Jan 11 2019 at 13:53)</a>:</h4>
<p><span class="emoji emoji-1f61e" title="disappointed">:disappointed:</span></p>



<a name="154919292"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/154919292" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> csmoe <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#154919292">(Jan 11 2019 at 14:12)</a>:</h4>
<p><span class="user-mention" data-user-id="116266">@Santiago Pastorino</span> so how about writing down what you wanna know here? I'll try my best to clearfy. if really needed, I'll align your 4 hours.</p>



<a name="154919766"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/154919766" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Santiago Pastorino <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#154919766">(Jan 11 2019 at 14:19)</a>:</h4>
<p><span class="user-mention" data-user-id="116773">@csmoe</span> just in case, right now I'm available but the idea was to make a call or chat with <span class="user-mention" data-user-id="116009">@nikomatsakis</span></p>



<a name="154919772"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/154919772" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Santiago Pastorino <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#154919772">(Jan 11 2019 at 14:19)</a>:</h4>
<p><span class="user-mention" data-user-id="116009">@nikomatsakis</span> should we coordinate?</p>



<a name="154919870"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/154919870" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Santiago Pastorino <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#154919870">(Jan 11 2019 at 14:20)</a>:</h4>
<p>sorry about my tight schedule during january but I'm on vacations with my family and doing some work on hours when the sun exposure would be bad :)</p>



<a name="154944022"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/154944022" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#154944022">(Jan 11 2019 at 20:19)</a>:</h4>
<p>ok, I was thinking more like "some time next week" vs right now</p>



<a name="154944033"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/154944033" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#154944033">(Jan 11 2019 at 20:19)</a>:</h4>
<p>in the limit, we could do a doodle</p>



<a name="154944034"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/154944034" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Santiago Pastorino <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#154944034">(Jan 11 2019 at 20:19)</a>:</h4>
<p><span class="emoji emoji-1f44d" title="+1">:+1:</span></p>



<a name="154944035"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/154944035" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#154944035">(Jan 11 2019 at 20:19)</a>:</h4>
<p>maybe we should just do that</p>



<a name="154944040"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/154944040" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Santiago Pastorino <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#154944040">(Jan 11 2019 at 20:20)</a>:</h4>
<p>yes</p>



<a name="154944092"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/154944092" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Santiago Pastorino <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#154944092">(Jan 11 2019 at 20:20)</a>:</h4>
<p>I can build it if you want</p>



<a name="154944376"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/154944376" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#154944376">(Jan 11 2019 at 20:25)</a>:</h4>
<p><span class="user-mention" data-user-id="116266">@Santiago Pastorino</span> I'd appreciate it =)</p>



<a name="154944404"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/154944404" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Santiago Pastorino <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#154944404">(Jan 11 2019 at 20:25)</a>:</h4>
<p><span class="emoji emoji-1f44d" title="+1">:+1:</span></p>



<a name="154944973"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/154944973" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Santiago Pastorino <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#154944973">(Jan 11 2019 at 20:33)</a>:</h4>
<p><a href="https://doodle.com/poll/7mwdnxdpbtrv8f9n" target="_blank" title="https://doodle.com/poll/7mwdnxdpbtrv8f9n">https://doodle.com/poll/7mwdnxdpbtrv8f9n</a></p>



<a name="154945026"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/154945026" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Santiago Pastorino <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#154945026">(Jan 11 2019 at 20:34)</a>:</h4>
<p><span class="user-mention" data-user-id="116773">@csmoe</span> <span class="user-mention" data-user-id="116009">@nikomatsakis</span> <span class="emoji emoji-1f446" title="point up">:point_up:</span></p>



<a name="154949236"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/154949236" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#154949236">(Jan 11 2019 at 21:38)</a>:</h4>
<p>I filled it out</p>



<a name="155091425"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/155091425" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Santiago Pastorino <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#155091425">(Jan 14 2019 at 15:24)</a>:</h4>
<p><span class="user-mention" data-user-id="116773">@csmoe</span> remember to complete the doodle so we can see when to meet <a href="https://doodle.com/poll/7mwdnxdpbtrv8f9n" target="_blank" title="https://doodle.com/poll/7mwdnxdpbtrv8f9n">https://doodle.com/poll/7mwdnxdpbtrv8f9n</a></p>



<a name="155091957"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/155091957" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Santiago Pastorino <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#155091957">(Jan 14 2019 at 15:32)</a>:</h4>
<p><span class="user-mention" data-user-id="116009">@nikomatsakis</span> <span class="user-mention" data-user-id="116773">@csmoe</span> there are 2 possibilities, today 1pm GMT-3, which is in half an hour or wednesday 1pm GMT-3</p>



<a name="155091973"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/155091973" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Santiago Pastorino <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#155091973">(Jan 14 2019 at 15:32)</a>:</h4>
<p>I'm fine with both, but unsure if doing a meeting in 30 minutes is a wise thing to do :P</p>



<a name="155092077"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/155092077" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Santiago Pastorino <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#155092077">(Jan 14 2019 at 15:34)</a>:</h4>
<p>let me know what do you think</p>



<a name="155092390"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/155092390" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> csmoe <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#155092390">(Jan 14 2019 at 15:39)</a>:</h4>
<p><span class="user-mention" data-user-id="116266">@Santiago Pastorino</span> I'm fine with both <span class="emoji emoji-1f642" title="slight smile">:slight_smile:</span></p>



<a name="155092569"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/155092569" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> csmoe <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#155092569">(Jan 14 2019 at 15:42)</a>:</h4>
<p>no matter how long the meeting will take, I'll be there.<br>
a bit sorry for the time mismatching in the past days.</p>



<a name="155092600"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/155092600" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Santiago Pastorino <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#155092600">(Jan 14 2019 at 15:42)</a>:</h4>
<p>no worries</p>



<a name="155092616"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/155092616" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Santiago Pastorino <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#155092616">(Jan 14 2019 at 15:43)</a>:</h4>
<p>it's probably too late to let <span class="user-mention" data-user-id="116009">@nikomatsakis</span> know about the meeting for today</p>



<a name="155092626"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/155092626" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Santiago Pastorino <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#155092626">(Jan 14 2019 at 15:43)</a>:</h4>
<p>I'd aim for wednesday 1pm GMT-3</p>



<a name="155092635"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/155092635" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Santiago Pastorino <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#155092635">(Jan 14 2019 at 15:43)</a>:</h4>
<p>but let's wait for <span class="user-mention" data-user-id="116009">@nikomatsakis</span></p>



<a name="155094711"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/155094711" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Santiago Pastorino <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#155094711">(Jan 14 2019 at 16:13)</a>:</h4>
<p>ok, definitely wednesday 1pm GMT-3</p>



<a name="155094738"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/155094738" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Santiago Pastorino <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#155094738">(Jan 14 2019 at 16:13)</a>:</h4>
<p><span class="user-mention" data-user-id="116773">@csmoe</span> <span class="user-mention" data-user-id="116009">@nikomatsakis</span> <span class="emoji emoji-1f446" title="point up">:point_up:</span></p>



<a name="155094819"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/155094819" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> csmoe <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#155094819">(Jan 14 2019 at 16:14)</a>:</h4>
<p><span class="user-mention" data-user-id="116266">@Santiago Pastorino</span> <span class="emoji emoji-23f3" title="time ticking">:time_ticking:</span></p>



<a name="155094869"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/155094869" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Santiago Pastorino <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#155094869">(Jan 14 2019 at 16:15)</a>:</h4>
<p><span class="user-mention" data-user-id="116773">@csmoe</span> I can send a calendar invite if you want</p>



<a name="155094946"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/155094946" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> csmoe <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#155094946">(Jan 14 2019 at 16:16)</a>:</h4>
<p><span class="user-mention" data-user-id="116266">@Santiago Pastorino</span> yes, I need your ping.</p>



<a name="155094976"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/155094976" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Santiago Pastorino <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#155094976">(Jan 14 2019 at 16:16)</a>:</h4>
<p>give me your email address if you want that :)</p>



<a name="155094987"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/155094987" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> csmoe <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#155094987">(Jan 14 2019 at 16:16)</a>:</h4>
<p><a href="mailto:csmoe@msn.com" title="mailto:csmoe@msn.com">csmoe@msn.com</a></p>



<a name="155095026"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/155095026" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Santiago Pastorino <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#155095026">(Jan 14 2019 at 16:17)</a>:</h4>
<p>done <span class="user-mention" data-user-id="116009">@nikomatsakis</span> <span class="user-mention" data-user-id="116773">@csmoe</span> both invited to the calendar event</p>



<a name="155095092"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/155095092" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> csmoe <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#155095092">(Jan 14 2019 at 16:18)</a>:</h4>
<p><span class="emoji emoji-1f4c5" title="calendar">:calendar:</span></p>



<a name="155179327"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/155179327" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Santiago Pastorino <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#155179327">(Jan 15 2019 at 15:44)</a>:</h4>
<p><span class="user-mention" data-user-id="116773">@csmoe</span> just in case, the meeting is confirmed for tomorrow (wednesday) 1pm GMT-3</p>



<a name="155179335"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/155179335" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Santiago Pastorino <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#155179335">(Jan 15 2019 at 15:44)</a>:</h4>
<p>Niko just confirmed that he is able</p>



<a name="155179559"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/155179559" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> csmoe <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#155179559">(Jan 15 2019 at 15:47)</a>:</h4>
<p><span class="user-mention" data-user-id="116266">@Santiago Pastorino</span>  gotcha</p>



<a name="155181331"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/155181331" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#155181331">(Jan 15 2019 at 16:06)</a>:</h4>
<p>just to be clear, the meeting event is updated?</p>



<a name="155181351"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/155181351" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#155181351">(Jan 15 2019 at 16:06)</a>:</h4>
<p>but yeah that time works for me</p>



<a name="155181375"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/155181375" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Santiago Pastorino <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#155181375">(Jan 15 2019 at 16:07)</a>:</h4>
<p>no, it's not updated just wednesday 1pm GMT-3</p>



<a name="155181448"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/155181448" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#155181448">(Jan 15 2019 at 16:07)</a>:</h4>
<p>wait, it's not updated?</p>



<a name="155181506"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/155181506" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#155181506">(Jan 15 2019 at 16:08)</a>:</h4>
<p>can we update it? :)</p>



<a name="155181508"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/155181508" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#155181508">(Jan 15 2019 at 16:08)</a>:</h4>
<p>/me does some time zone arithmetic</p>



<a name="155181543"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/155181543" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#155181543">(Jan 15 2019 at 16:08)</a>:</h4>
<p>my calendar shows 11 UTC-5, which -- I think -- is the same as 13 UTC-5 :P</p>



<a name="155181566"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/155181566" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#155181566">(Jan 15 2019 at 16:09)</a>:</h4>
<p>but maybe I'm doing my math wrong or something</p>



<a name="155190758"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/155190758" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jake Goulding <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#155190758">(Jan 15 2019 at 18:13)</a>:</h4>
<blockquote>
<p>my calendar shows 11 UTC-5, which -- I think -- is the same as 13 UTC-5 :P</p>
</blockquote>
<p>This is that new math I keep hearing about. <code>(11, -5) =?= (13, -5)</code></p>



<a name="155191170"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/155191170" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Santiago Pastorino <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#155191170">(Jan 15 2019 at 18:18)</a>:</h4>
<p>11 UTC-5 = 13 UTC-3 (UTC-3 is my time zone)</p>



<a name="155191220"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/155191220" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Santiago Pastorino <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#155191220">(Jan 15 2019 at 18:19)</a>:</h4>
<p>11+5=13+3 :)</p>



<a name="155192351"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/155192351" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jake Goulding <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#155192351">(Jan 15 2019 at 18:33)</a>:</h4>
<p>sure, but those aren't the numbers that were typed</p>



<a name="155192363"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/155192363" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jake Goulding <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#155192363">(Jan 15 2019 at 18:33)</a>:</h4>
<p><a href="/user_uploads/4715/HicRX7wUecvYe7VQcvj1EWeS/pasted_image.png" target="_blank" title="pasted_image.png">pasted image</a></p>
<div class="message_inline_image"><a href="/user_uploads/4715/HicRX7wUecvYe7VQcvj1EWeS/pasted_image.png" target="_blank" title="pasted image"><img src="/user_uploads/4715/HicRX7wUecvYe7VQcvj1EWeS/pasted_image.png"></a></div>



<a name="155196677"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/155196677" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#155196677">(Jan 15 2019 at 19:25)</a>:</h4>
<blockquote>
<p>This is that new math I keep hearing about. <code>(11, -5) =?= (13, -5)</code></p>
</blockquote>
<p>die</p>



<a name="155196694"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/155196694" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#155196694">(Jan 15 2019 at 19:25)</a>:</h4>
<p>you know what I meant :P</p>



<a name="155264405"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/155264405" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Santiago Pastorino <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#155264405">(Jan 16 2019 at 15:59)</a>:</h4>
<p>ping <span class="user-mention" data-user-id="116773">@csmoe</span> <span class="user-mention" data-user-id="116009">@nikomatsakis</span> meeting in 2 mins :)</p>



<a name="155264421"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/155264421" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> csmoe <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#155264421">(Jan 16 2019 at 15:59)</a>:</h4>
<p>pong:)</p>



<a name="155264509"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/155264509" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Santiago Pastorino <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#155264509">(Jan 16 2019 at 16:00)</a>:</h4>
<p><span class="user-mention" data-user-id="116009">@nikomatsakis</span> are we having the meeting here or a video call?</p>



<a name="155264653"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/155264653" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> csmoe <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#155264653">(Jan 16 2019 at 16:02)</a>:</h4>
<p><span class="user-mention" data-user-id="116266">@Santiago Pastorino</span> I'd like to chat here, it's midnight here, my little brother sleeping aside, sorry</p>



<a name="155264854"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/155264854" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Santiago Pastorino <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#155264854">(Jan 16 2019 at 16:06)</a>:</h4>
<p><span class="emoji emoji-1f44d" title="+1">:+1:</span>, let's wait for <span class="user-mention" data-user-id="116009">@nikomatsakis</span> then</p>



<a name="155264912"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/155264912" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Santiago Pastorino <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#155264912">(Jan 16 2019 at 16:06)</a>:</h4>
<p>meanwhile, can you explain more or less what the task was about and what have you done?</p>



<a name="155264920"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/155264920" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Santiago Pastorino <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#155264920">(Jan 16 2019 at 16:06)</a>:</h4>
<p>so meanwhile Niko is coming I can more or less catch up</p>



<a name="155265072"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/155265072" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> csmoe <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#155265072">(Jan 16 2019 at 16:08)</a>:</h4>
<p>okay</p>



<a name="155265235"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/155265235" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> csmoe <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#155265235">(Jan 16 2019 at 16:10)</a>:</h4>
<p>this PR is intended to change the representation of <code>Place</code> from recursive into iteration as the issue wrote <a href="https://github.com/rust-lang/rust/issues/52708" target="_blank" title="https://github.com/rust-lang/rust/issues/52708">https://github.com/rust-lang/rust/issues/52708</a></p>



<a name="155265381"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/155265381" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> csmoe <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#155265381">(Jan 16 2019 at 16:12)</a>:</h4>
<p>niko mentored me to make it in an "incremental" way as:<br>
 1. introduce a temp place named <code>NeoPlace</code></p>



<a name="155265452"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/155265452" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> csmoe <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#155265452">(Jan 16 2019 at 16:13)</a>:</h4>
<p>2. then "mirror" all the methods associated to <code>Place</code> for <code>NeoPlace</code>(impl NeoPlace { ... })</p>



<a name="155265471"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/155265471" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> csmoe <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#155265471">(Jan 16 2019 at 16:14)</a>:</h4>
<p>(this part was done)</p>



<a name="155265526"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/155265526" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Santiago Pastorino <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#155265526">(Jan 16 2019 at 16:14)</a>:</h4>
<p><span class="emoji emoji-1f44d" title="+1">:+1:</span></p>



<a name="155265542"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/155265542" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Santiago Pastorino <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#155265542">(Jan 16 2019 at 16:14)</a>:</h4>
<p>first thing I wonder is what comprehends a <code>Place</code> thing</p>



<a name="155265555"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/155265555" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Santiago Pastorino <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#155265555">(Jan 16 2019 at 16:14)</a>:</h4>
<p>from the docs it says</p>



<a name="155265559"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/155265559" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Santiago Pastorino <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#155265559">(Jan 16 2019 at 16:14)</a>:</h4>
<div class="codehilite"><pre><span></span> /// A path to a value; something that can be evaluated without
/// changing or disturbing program state.
</pre></div>



<a name="155265596"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/155265596" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Santiago Pastorino <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#155265596">(Jan 16 2019 at 16:15)</a>:</h4>
<p>I wonder specifically about <code>changing or disturbing program state</code></p>



<a name="155265617"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/155265617" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Santiago Pastorino <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#155265617">(Jan 16 2019 at 16:15)</a>:</h4>
<p>what's an example of a path that disturbs the program state?</p>



<a name="155265625"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/155265625" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Santiago Pastorino <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#155265625">(Jan 16 2019 at 16:15)</a>:</h4>
<p>I guess assigning a thing is not considered a <code>Place</code>?</p>



<a name="155265682"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/155265682" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Santiago Pastorino <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#155265682">(Jan 16 2019 at 16:16)</a>:</h4>
<p>I want to be 100% clear of what a <code>Place</code> is because I'm not 100% sure</p>



<a name="155265685"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/155265685" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> csmoe <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#155265685">(Jan 16 2019 at 16:16)</a>:</h4>
<div class="codehilite"><pre><span></span><span class="k">struct</span> <span class="nc">Foo</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="n">a</span>: <span class="kt">i32</span><span class="p">,</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>
<span class="kd">let</span><span class="w"> </span><span class="n">foo</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Foo</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="n">a</span>: <span class="mi">1</span><span class="p">};</span><span class="w"></span>
<span class="n">foo</span><span class="p">.</span><span class="n">a</span><span class="w"> </span><span class="c1">// place</span>
</pre></div>



<a name="155265713"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/155265713" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> csmoe <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#155265713">(Jan 16 2019 at 16:16)</a>:</h4>
<p>and things like <code>array[2]</code></p>



<a name="155265721"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/155265721" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Santiago Pastorino <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#155265721">(Jan 16 2019 at 16:16)</a>:</h4>
<p>yeah</p>



<a name="155265722"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/155265722" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Santiago Pastorino <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#155265722">(Jan 16 2019 at 16:17)</a>:</h4>
<p>I mean</p>



<a name="155265724"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/155265724" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Santiago Pastorino <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#155265724">(Jan 16 2019 at 16:17)</a>:</h4>
<p>from</p>



<a name="155265733"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/155265733" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Santiago Pastorino <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#155265733">(Jan 16 2019 at 16:17)</a>:</h4>
<div class="codehilite"><pre><span></span><span class="w"> </span><span class="k">pub</span><span class="w"> </span><span class="k">enum</span> <span class="nc">Place</span><span class="o">&lt;</span><span class="na">&#39;tcx</span><span class="o">&gt;</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">     </span><span class="sd">/// local variable</span>
<span class="w">     </span><span class="n">Local</span><span class="p">(</span><span class="n">Local</span><span class="p">),</span><span class="w"></span>

<span class="w">     </span><span class="sd">/// static or static mut variable</span>
<span class="w">     </span><span class="n">Static</span><span class="p">(</span><span class="nb">Box</span><span class="o">&lt;</span><span class="n">Static</span><span class="o">&lt;</span><span class="na">&#39;tcx</span><span class="o">&gt;&gt;</span><span class="p">),</span><span class="w"></span>

<span class="w">     </span><span class="sd">/// Constant code promoted to an injected static</span>
<span class="w">     </span><span class="n">Promoted</span><span class="p">(</span><span class="nb">Box</span><span class="o">&lt;</span><span class="p">(</span><span class="n">Promoted</span><span class="p">,</span><span class="w"> </span><span class="n">Ty</span><span class="o">&lt;</span><span class="na">&#39;tcx</span><span class="o">&gt;</span><span class="p">)</span><span class="o">&gt;</span><span class="p">),</span><span class="w"></span>

<span class="w">     </span><span class="sd">/// projection out of a place (access a field, deref a pointer, etc)</span>
<span class="w">     </span><span class="n">Projection</span><span class="p">(</span><span class="nb">Box</span><span class="o">&lt;</span><span class="n">PlaceProjection</span><span class="o">&lt;</span><span class="na">&#39;tcx</span><span class="o">&gt;&gt;</span><span class="p">),</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>
</pre></div>



<a name="155265738"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/155265738" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Santiago Pastorino <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#155265738">(Jan 16 2019 at 16:17)</a>:</h4>
<p>there are a lot of things that are clearly a <code>Place</code></p>



<a name="155265747"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/155265747" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> csmoe <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#155265747">(Jan 16 2019 at 16:17)</a>:</h4>
<blockquote>
<p>I wonder specifically about changing or disturbing program state</p>
</blockquote>
<p>I'm not sure about what this means, left to <span class="user-mention" data-user-id="116009">@nikomatsakis</span></p>



<a name="155265759"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/155265759" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Santiago Pastorino <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#155265759">(Jan 16 2019 at 16:17)</a>:</h4>
<p>I wonder where is exactly the line</p>



<a name="155265761"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/155265761" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#155265761">(Jan 16 2019 at 16:17)</a>:</h4>
<p>argh argh</p>



<a name="155265765"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/155265765" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Santiago Pastorino <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#155265765">(Jan 16 2019 at 16:17)</a>:</h4>
<p>of things that seems like a <code>Place</code> but are not :)</p>



<a name="155265768"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/155265768" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#155265768">(Jan 16 2019 at 16:18)</a>:</h4>
<p>I was in another meeting and it ran over</p>



<a name="155265776"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/155265776" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Santiago Pastorino <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#155265776">(Jan 16 2019 at 16:18)</a>:</h4>
<p>hey <span class="user-mention" data-user-id="116009">@nikomatsakis</span> !!!</p>



<a name="155265789"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/155265789" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#155265789">(Jan 16 2019 at 16:18)</a>:</h4>
<p>let me read the backlog</p>



<a name="155265814"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/155265814" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Santiago Pastorino <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#155265814">(Jan 16 2019 at 16:18)</a>:</h4>
<p>no worries</p>



<a name="155265834"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/155265834" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Santiago Pastorino <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#155265834">(Jan 16 2019 at 16:18)</a>:</h4>
<p>I was just asking silly questions ;)</p>



<a name="155265871"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/155265871" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#155265871">(Jan 16 2019 at 16:19)</a>:</h4>
<p>ok</p>



<a name="155265875"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/155265875" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Santiago Pastorino <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#155265875">(Jan 16 2019 at 16:19)</a>:</h4>
<p>from the code I get that</p>



<a name="155265879"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/155265879" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#155265879">(Jan 16 2019 at 16:19)</a>:</h4>
<p>regarding your question about "disturbing program state"</p>



<a name="155265880"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/155265880" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Santiago Pastorino <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#155265880">(Jan 16 2019 at 16:19)</a>:</h4>
<div class="codehilite"><pre><span></span><span class="kd">let</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span><span class="w"></span>
</pre></div>



<a name="155265882"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/155265882" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#155265882">(Jan 16 2019 at 16:19)</a>:</h4>
<p>I thnk the way to think of it is:</p>



<a name="155265894"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/155265894" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#155265894">(Jan 16 2019 at 16:19)</a>:</h4>
<p>"places" are <em>expressions</em></p>



<a name="155265896"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/155265896" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Santiago Pastorino <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#155265896">(Jan 16 2019 at 16:19)</a>:</h4>
<p>ok go ahead better :)</p>



<a name="155265897"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/155265897" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#155265897">(Jan 16 2019 at 16:19)</a>:</h4>
<p>but not <em>all expressions</em></p>



<a name="155265918"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/155265918" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#155265918">(Jan 16 2019 at 16:19)</a>:</h4>
<p>so e.g. <code>*x</code> in rust surface syntax might or might not be a place, depending on whether <code>*</code> is overloaded</p>



<a name="155265926"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/155265926" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#155265926">(Jan 16 2019 at 16:19)</a>:</h4>
<p><code>foo()</code> is not a place expression</p>



<a name="155265943"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/155265943" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Santiago Pastorino <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#155265943">(Jan 16 2019 at 16:20)</a>:</h4>
<p>yep</p>



<a name="155265987"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/155265987" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#155265987">(Jan 16 2019 at 16:20)</a>:</h4>
<p>another way to think about it is:</p>



<a name="155266005"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/155266005" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#155266005">(Jan 16 2019 at 16:20)</a>:</h4>
<p>place expressions can be evaluated to a location in memory</p>



<a name="155266013"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/155266013" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Santiago Pastorino <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#155266013">(Jan 16 2019 at 16:20)</a>:</h4>
<p>it's an expression that leads to an area in the memory I guess?</p>



<a name="155266014"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/155266014" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#155266014">(Jan 16 2019 at 16:20)</a>:</h4>
<p>something with an address</p>



<a name="155266027"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/155266027" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Santiago Pastorino <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#155266027">(Jan 16 2019 at 16:20)</a>:</h4>
<p>exactly :)</p>



<a name="155266028"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/155266028" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Santiago Pastorino <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#155266028">(Jan 16 2019 at 16:20)</a>:</h4>
<p>so</p>



<a name="155266034"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/155266034" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#155266034">(Jan 16 2019 at 16:20)</a>:</h4>
<p>right, but <code>foo().f</code> in some sense leads to memory, but is not a <em>place</em></p>



<a name="155266036"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/155266036" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Santiago Pastorino <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#155266036">(Jan 16 2019 at 16:20)</a>:</h4>
<p>a.b.c = "hi"</p>



<a name="155266062"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/155266062" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#155266062">(Jan 16 2019 at 16:20)</a>:</h4>
<p>(As an aside, I actually have come to prefer the term <em>path</em>)</p>



<a name="155266063"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/155266063" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Santiago Pastorino <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#155266063">(Jan 16 2019 at 16:20)</a>:</h4>
<p>this is a place or not?</p>



<a name="155266088"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/155266088" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#155266088">(Jan 16 2019 at 16:21)</a>:</h4>
<p>and to use <code>place</code> to refer to the memory location at runtime (which a path refers to)</p>



<a name="155266089"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/155266089" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#155266089">(Jan 16 2019 at 16:21)</a>:</h4>
<p>bu aynway</p>



<a name="155266093"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/155266093" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Santiago Pastorino <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#155266093">(Jan 16 2019 at 16:21)</a>:</h4>
<blockquote>
<p>right, but <code>foo().f</code> in some sense leads to memory, but is not a <em>place</em></p>
</blockquote>
<p>hmm I'd have said that it was a <code>Place</code></p>



<a name="155266095"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/155266095" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Santiago Pastorino <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#155266095">(Jan 16 2019 at 16:21)</a>:</h4>
<p>why not ?</p>



<a name="155266107"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/155266107" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#155266107">(Jan 16 2019 at 16:21)</a>:</h4>
<p>because to figure out where <code>f</code> is, you have to call <code>foo()</code></p>



<a name="155266110"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/155266110" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#155266110">(Jan 16 2019 at 16:21)</a>:</h4>
<p>in MIR terms, it is not a place</p>



<a name="155266115"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/155266115" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Santiago Pastorino <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#155266115">(Jan 16 2019 at 16:21)</a>:</h4>
<p>I see</p>



<a name="155266120"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/155266120" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Santiago Pastorino <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#155266120">(Jan 16 2019 at 16:21)</a>:</h4>
<blockquote>
<p>and to use <code>place</code> to refer to the memory location at runtime (which a path refers to)</p>
</blockquote>
<p>what's the difference you're seeing between a path and a place?</p>



<a name="155266126"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/155266126" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#155266126">(Jan 16 2019 at 16:22)</a>:</h4>
<p>if you have e.g. <code>&amp;foo().f</code>, we will compile that down to:</p>
<div class="codehilite"><pre><span></span>tmp0 = foo();
&amp;tmp0.f
</pre></div>



<a name="155266174"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/155266174" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#155266174">(Jan 16 2019 at 16:22)</a>:</h4>
<p>here, <code>tmp0.f</code> is a place</p>



<a name="155266180"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/155266180" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Santiago Pastorino <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#155266180">(Jan 16 2019 at 16:22)</a>:</h4>
<p>yes</p>



<a name="155266182"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/155266182" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Santiago Pastorino <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#155266182">(Jan 16 2019 at 16:22)</a>:</h4>
<p>makes sense</p>



<a name="155266199"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/155266199" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#155266199">(Jan 16 2019 at 16:22)</a>:</h4>
<blockquote>
<p>what's the difference you're seeing between a path and a place?</p>
</blockquote>
<p>I mean the term <code>Place</code> as it is used today, in the MIR anyway, is the same as what I was calling <code>Path</code></p>



<a name="155266205"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/155266205" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#155266205">(Jan 16 2019 at 16:22)</a>:</h4>
<p>anyway ignore the <code>Path</code> thing perhaps, separate question</p>



<a name="155266214"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/155266214" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#155266214">(Jan 16 2019 at 16:22)</a>:</h4>
<p>so the refactoring is, as <span class="user-mention" data-user-id="116773">@csmoe</span> said, just about changing the representation of <code>mir::Place</code></p>



<a name="155266217"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/155266217" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Santiago Pastorino <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#155266217">(Jan 16 2019 at 16:22)</a>:</h4>
<p>ok</p>



<a name="155266220"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/155266220" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Santiago Pastorino <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#155266220">(Jan 16 2019 at 16:22)</a>:</h4>
<p>last thing</p>



<a name="155266224"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/155266224" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Santiago Pastorino <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#155266224">(Jan 16 2019 at 16:22)</a>:</h4>
<div class="codehilite"><pre><span></span> /// A path to a value; something that can be evaluated without
/// changing or disturbing program state.
</pre></div>



<a name="155266227"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/155266227" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Santiago Pastorino <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#155266227">(Jan 16 2019 at 16:22)</a>:</h4>
<p>what's the meaning of that?</p>



<a name="155266242"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/155266242" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#155266242">(Jan 16 2019 at 16:23)</a>:</h4>
<p>isn't that what we were just talking about? :)</p>



<a name="155266246"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/155266246" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Santiago Pastorino <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#155266246">(Jan 16 2019 at 16:23)</a>:</h4>
<p>I mean, what's the changing and disturbing program state part?</p>



<a name="155266260"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/155266260" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#155266260">(Jan 16 2019 at 16:23)</a>:</h4>
<p><em>evaluating</em> a place means finding the location in memory it refers to</p>



<a name="155266264"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/155266264" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#155266264">(Jan 16 2019 at 16:23)</a>:</h4>
<p>the reason that <code>foo().f</code> is not a <em>place</em> in this sense,</p>



<a name="155266270"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/155266270" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#155266270">(Jan 16 2019 at 16:23)</a>:</h4>
<p>is that evaluating it would require invoking <code>foo()</code>,</p>



<a name="155266273"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/155266273" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#155266273">(Jan 16 2019 at 16:23)</a>:</h4>
<p>which might mutate stuff</p>



<a name="155266275"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/155266275" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#155266275">(Jan 16 2019 at 16:23)</a>:</h4>
<p>and "change or disturb program state"</p>



<a name="155266326"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/155266326" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Santiago Pastorino <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#155266326">(Jan 16 2019 at 16:24)</a>:</h4>
<p>I see :)</p>



<a name="155266330"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/155266330" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#155266330">(Jan 16 2019 at 16:24)</a>:</h4>
<p>(in contrast, evaluating <code>a.b.c.</code> has no side-effects)</p>



<a name="155266333"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/155266333" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Santiago Pastorino <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#155266333">(Jan 16 2019 at 16:24)</a>:</h4>
<p>makes a lot of sense and now it's 100% clear what a Place is to me :)</p>



<a name="155266355"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/155266355" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#155266355">(Jan 16 2019 at 16:24)</a>:</h4>
<p>OK so the goal was to change from the <em>recursive</em> representation that we use today</p>



<a name="155266360"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/155266360" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Santiago Pastorino <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#155266360">(Jan 16 2019 at 16:24)</a>:</h4>
<p>I've read the issue and got what you want to do</p>



<a name="155266361"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/155266361" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#155266361">(Jan 16 2019 at 16:24)</a>:</h4>
<p>to a "flat" one</p>



<a name="155266362"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/155266362" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Santiago Pastorino <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#155266362">(Jan 16 2019 at 16:24)</a>:</h4>
<p>yeah :)</p>



<a name="155266364"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/155266364" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#155266364">(Jan 16 2019 at 16:24)</a>:</h4>
<p>ok</p>



<a name="155266387"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/155266387" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Santiago Pastorino <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#155266387">(Jan 16 2019 at 16:25)</a>:</h4>
<p>what I'm not sure is what's the current state of that</p>



<a name="155266388"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/155266388" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#155266388">(Jan 16 2019 at 16:25)</a>:</h4>
<p>this does however require rewriting the algorithms that use the representation today</p>



<a name="155266398"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/155266398" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Santiago Pastorino <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#155266398">(Jan 16 2019 at 16:25)</a>:</h4>
<p>and if you have any tip on how can I help</p>



<a name="155266410"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/155266410" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#155266410">(Jan 16 2019 at 16:25)</a>:</h4>
<p>well, that is where <span class="user-mention" data-user-id="116773">@csmoe</span> comes in, I am also a bit unclear on the current status</p>



<a name="155266439"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/155266439" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#155266439">(Jan 16 2019 at 16:25)</a>:</h4>
<p>I'd also like us to discuss the plan to land this PR, which has been open a long time and is definitely a "merge conflict magnet"</p>



<a name="155266443"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/155266443" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Santiago Pastorino <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#155266443">(Jan 16 2019 at 16:25)</a>:</h4>
<blockquote>
<p>this does however require rewriting the algorithms that use the representation today</p>
</blockquote>
<p>yep, basically change the representations and see compilation and tests errors :')</p>



<a name="155266536"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/155266536" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#155266536">(Jan 16 2019 at 16:26)</a>:</h4>
<p>maybe best to start with this question: <span class="user-mention" data-user-id="116773">@csmoe</span> can you update us on sort of "where things are" -- how many bits of code do you think you have left to convert? are there particular bits of code that are still causing you trouble? etc</p>



<a name="155266571"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/155266571" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Santiago Pastorino <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#155266571">(Jan 16 2019 at 16:27)</a>:</h4>
<p>and I'd also like to know how can I help you <span class="user-mention" data-user-id="116773">@csmoe</span> :)</p>



<a name="155266572"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/155266572" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> csmoe <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#155266572">(Jan 16 2019 at 16:27)</a>:</h4>
<p>I have "mirror"ed the methods of <code>Place</code>, and rewrote the places_conflict detecting successfully. <br>
so the next task is: describe the place in error reporting</p>



<a name="155266577"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/155266577" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Santiago Pastorino <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#155266577">(Jan 16 2019 at 16:27)</a>:</h4>
<p>if you want me to help thinking</p>



<a name="155266582"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/155266582" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Santiago Pastorino <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#155266582">(Jan 16 2019 at 16:27)</a>:</h4>
<p>if you want me to help coding :)</p>



<a name="155266591"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/155266591" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Santiago Pastorino <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#155266591">(Jan 16 2019 at 16:27)</a>:</h4>
<p>etc :)</p>



<a name="155266601"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/155266601" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#155266601">(Jan 16 2019 at 16:27)</a>:</h4>
<blockquote>
<p>I have "mirror"ed the methods of <code>Place</code>, and rewrote the places_conflict detecting successfully. <br>
so the next task is: describe the place in error reporting</p>
</blockquote>
<p>what do you mean by "mirror"?</p>



<a name="155266655"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/155266655" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> csmoe <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#155266655">(Jan 16 2019 at 16:28)</a>:</h4>
<p>old_place.xxx() =&gt; neo_palce.xxx()</p>



<a name="155266676"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/155266676" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> csmoe <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#155266676">(Jan 16 2019 at 16:28)</a>:</h4>
<p>I mean. <span class="emoji emoji-2b06" title="up">:up:</span></p>



<a name="155266686"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/155266686" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Santiago Pastorino <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#155266686">(Jan 16 2019 at 16:28)</a>:</h4>
<p>I was also wondering about the old_place + neo_place approach</p>



<a name="155266710"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/155266710" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Santiago Pastorino <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#155266710">(Jan 16 2019 at 16:28)</a>:</h4>
<p>why not just changing the thing</p>



<a name="155266720"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/155266720" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Santiago Pastorino <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#155266720">(Jan 16 2019 at 16:28)</a>:</h4>
<p><span class="user-mention" data-user-id="116009">@nikomatsakis</span>  I guess you had reasons that I don't see :)</p>



<a name="155266727"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/155266727" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> csmoe <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#155266727">(Jan 16 2019 at 16:29)</a>:</h4>
<blockquote>
<p>why not just changing the thing</p>
</blockquote>



<a name="155266736"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/155266736" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#155266736">(Jan 16 2019 at 16:29)</a>:</h4>
<p>because changing everything at once is untenable</p>



<a name="155266747"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/155266747" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#155266747">(Jan 16 2019 at 16:29)</a>:</h4>
<p>you want to be able to change one piece of code without changing all the pieces of code</p>



<a name="155266774"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/155266774" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Santiago Pastorino <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#155266774">(Jan 16 2019 at 16:29)</a>:</h4>
<p>yeah, makes sense</p>



<a name="155266785"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/155266785" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Santiago Pastorino <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#155266785">(Jan 16 2019 at 16:29)</a>:</h4>
<p>at the end can just replace things and done</p>



<a name="155266796"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/155266796" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#155266796">(Jan 16 2019 at 16:29)</a>:</h4>
<p>however, I'm not sure the neo-place approach itself was best. Or at least I was thinking of a different tactic.</p>



<a name="155266835"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/155266835" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#155266835">(Jan 16 2019 at 16:30)</a>:</h4>
<p>I would really like it if we can get something that we can land</p>



<a name="155266858"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/155266858" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#155266858">(Jan 16 2019 at 16:30)</a>:</h4>
<p>and have a "to do" list of other code to convert</p>



<a name="155266864"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/155266864" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Santiago Pastorino <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#155266864">(Jan 16 2019 at 16:30)</a>:</h4>
<p>and meanwhile having tiny parts which you can compile, test, etc</p>



<a name="155266875"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/155266875" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#155266875">(Jan 16 2019 at 16:30)</a>:</h4>
<p>but not have to do everything in one PR</p>



<a name="155266901"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/155266901" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#155266901">(Jan 16 2019 at 16:30)</a>:</h4>
<p>on the other hand, if <span class="user-mention" data-user-id="116773">@csmoe</span> is already close enough, maybe it's not worth it, that's part of what I'm trying to judge</p>



<a name="155266925"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/155266925" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#155266925">(Jan 16 2019 at 16:30)</a>:</h4>
<p>One question: <span class="user-mention" data-user-id="116773">@csmoe</span>, at times we have discussed my idea to add some methods that you operate on the new "flat places" in a "tree-like way"</p>



<a name="155266944"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/155266944" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#155266944">(Jan 16 2019 at 16:31)</a>:</h4>
<p>( I can try to make that more concrete for <span class="user-mention" data-user-id="116266">@Santiago Pastorino</span> perhaps )</p>



<a name="155266972"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/155266972" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#155266972">(Jan 16 2019 at 16:31)</a>:</h4>
<p>so basically the new representation would be:</p>
<div class="codehilite"><pre><span></span><span class="k">struct</span> <span class="nc">Place</span><span class="o">&lt;</span><span class="na">&#39;tcx</span><span class="o">&gt;</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">  </span><span class="n">base</span>: <span class="nc">PlaceBase</span><span class="p">,</span><span class="w"></span>
<span class="w">  </span><span class="n">projections</span>: <span class="kp">&amp;</span><span class="na">&#39;tcx</span><span class="w"> </span><span class="p">[</span><span class="n">PlaceProjection</span><span class="o">&lt;</span><span class="na">&#39;tcx</span><span class="o">&gt;</span><span class="p">],</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>
</pre></div>



<a name="155266994"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/155266994" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> csmoe <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#155266994">(Jan 16 2019 at 16:32)</a>:</h4>
<p><span class="user-mention" data-user-id="116009">@nikomatsakis</span> describe_place is the last biggest refactoring part.</p>



<a name="155267055"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/155267055" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> csmoe <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#155267055">(Jan 16 2019 at 16:32)</a>:</h4>
<p>just go ahead <span class="emoji emoji-1f642" title="slight smile">:slight_smile:</span></p>



<a name="155267072"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/155267072" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#155267072">(Jan 16 2019 at 16:32)</a>:</h4>
<p>and I was saying that you could imagine a method <code>as_tree</code> that returned a <code>PlaceTree</code>:</p>
<div class="codehilite"><pre><span></span><span class="k">enum</span> <span class="nc">PlaceTree</span><span class="o">&lt;</span><span class="na">&#39;me</span><span class="p">,</span><span class="w"> </span><span class="na">&#39;tcx</span><span class="o">&gt;</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="n">Base</span><span class="p">(</span><span class="o">&amp;</span><span class="na">&#39;me</span><span class="w"> </span><span class="n">PlaceBase</span><span class="p">),</span><span class="w"></span>
<span class="w">    </span><span class="n">Proj</span><span class="p">(</span><span class="n">Place</span><span class="o">&lt;</span><span class="na">&#39;tcx</span><span class="o">&gt;</span><span class="p">,</span><span class="w"> </span><span class="o">&amp;</span><span class="na">&#39;tcx</span><span class="w"> </span><span class="n">Projection</span><span class="p">),</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>
</pre></div>


<p>This structure is basically the same as today's <code>Place</code></p>



<a name="155267076"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/155267076" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#155267076">(Jan 16 2019 at 16:32)</a>:</h4>
<p><code>as_tree</code> might look like:</p>



<a name="155267239"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/155267239" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#155267239">(Jan 16 2019 at 16:34)</a>:</h4>
<div class="codehilite"><pre><span></span><span class="k">impl</span><span class="o">&lt;</span><span class="na">&#39;tcx</span><span class="o">&gt;</span><span class="w"> </span><span class="n">Place</span><span class="o">&lt;</span><span class="na">&#39;tcx</span><span class="o">&gt;</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">  </span><span class="k">pub</span><span class="w"> </span><span class="k">fn</span> <span class="nf">as_tree</span><span class="o">&lt;</span><span class="na">&#39;me</span><span class="o">&gt;</span><span class="p">(</span><span class="o">&amp;</span><span class="na">&#39;me</span><span class="w"> </span><span class="bp">self</span><span class="p">)</span><span class="w"> </span>-&gt; <span class="nc">PlaceTree</span><span class="o">&lt;</span><span class="na">&#39;me</span><span class="p">,</span><span class="w"> </span><span class="na">&#39;tcx</span><span class="o">&gt;</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="k">match</span><span class="w"> </span><span class="bp">self</span><span class="p">.</span><span class="n">projections</span><span class="p">.</span><span class="n">split_last</span><span class="p">()</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">       </span><span class="nb">None</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="n">PlaceTree</span>::<span class="n">Base</span><span class="p">(</span><span class="o">&amp;</span><span class="bp">self</span><span class="p">.</span><span class="n">base</span><span class="p">),</span><span class="w"></span>
<span class="w">       </span><span class="nb">Some</span><span class="p">((</span><span class="n">last</span><span class="p">,</span><span class="w"> </span><span class="n">rest</span><span class="p">))</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="n">PlaceTree</span>::<span class="n">Proj</span><span class="p">(</span><span class="n">Place</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="p">...},</span><span class="w"> </span><span class="n">last</span><span class="p">),</span><span class="w"></span>
<span class="w">  </span><span class="p">}</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>
</pre></div>



<a name="155267268"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/155267268" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#155267268">(Jan 16 2019 at 16:34)</a>:</h4>
<p>so basically if you had a place like <code>a.b.c</code>, which is now represented as <code>(a, [b, c])</code>, then <code>as_tree</code> would change that to <code>PlaceTree::Proj((a, [b]), c)</code></p>



<a name="155267269"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/155267269" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#155267269">(Jan 16 2019 at 16:35)</a>:</h4>
<p>the reason for this is:</p>



<a name="155267281"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/155267281" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Santiago Pastorino <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#155267281">(Jan 16 2019 at 16:35)</a>:</h4>
<p>yep <code>impl PlaceTree</code> :)</p>



<a name="155267287"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/155267287" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#155267287">(Jan 16 2019 at 16:35)</a>:</h4>
<p>you can then convert old in a very mechanical way</p>



<a name="155267314"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/155267314" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#155267314">(Jan 16 2019 at 16:35)</a>:</h4>
<p>i.e., where it used to descend down a <code>mir::Place</code>, it now just converts to a tree at each step</p>



<a name="155267341"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/155267341" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Santiago Pastorino <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#155267341">(Jan 16 2019 at 16:35)</a>:</h4>
<blockquote>
<p>yep <code>impl PlaceTree</code> :)</p>
</blockquote>
<p>ahh I what you meant</p>



<a name="155267386"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/155267386" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Santiago Pastorino <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#155267386">(Jan 16 2019 at 16:36)</a>:</h4>
<p>so Place is the new Place, PlaceTree is the old one</p>



<a name="155267402"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/155267402" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#155267402">(Jan 16 2019 at 16:36)</a>:</h4>
<p>I imagine we could land a PR that (a) introduced the PlaceTree abstraction but leaves Place the same (in this case, PlaceTree is basically the same as place), then (b) change how places are build to build new-style places, but the analyses still work, then (c) convert the analyses one by one to not use <code>as_tree</code> where appropriate</p>



<a name="155267406"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/155267406" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Santiago Pastorino <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#155267406">(Jan 16 2019 at 16:36)</a>:</h4>
<p>and basically all over the code we call as_tree in places where we haven't converted the algorithms to use the new data type</p>



<a name="155267408"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/155267408" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#155267408">(Jan 16 2019 at 16:36)</a>:</h4>
<p>right</p>



<a name="155267417"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/155267417" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#155267417">(Jan 16 2019 at 16:36)</a>:</h4>
<p>part of the context here is that many analyses are easier with the new place</p>



<a name="155267420"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/155267420" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#155267420">(Jan 16 2019 at 16:36)</a>:</h4>
<p>than the old place</p>



<a name="155267431"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/155267431" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#155267431">(Jan 16 2019 at 16:36)</a>:</h4>
<p>but .. not necessarily <strong>all</strong></p>



<a name="155267438"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/155267438" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#155267438">(Jan 16 2019 at 16:36)</a>:</h4>
<p>e.g., describe-place might not fit this description</p>



<a name="155267481"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/155267481" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#155267481">(Jan 16 2019 at 16:37)</a>:</h4>
<p>anyway, <span class="user-mention" data-user-id="116773">@csmoe</span>, what do you think? I kind of think this approach <strong>would've</strong> been better in some sense, but maybe it's too late now? or still worth it?</p>



<a name="155267500"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/155267500" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#155267500">(Jan 16 2019 at 16:37)</a>:</h4>
<p>(I imagine even if we did this, we can keep your existing branch and refer to it as we convert analyses, also)</p>



<a name="155267574"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/155267574" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#155267574">(Jan 16 2019 at 16:38)</a>:</h4>
<blockquote>
<p>and basically all over the code we call as_tree in places where we haven't converted the algorithms to use the new data type</p>
</blockquote>
<p>well, as I said, in some cases, I think that the code might be nicer with <code>as_tree</code> anyway -- like, it's not bad to view places as a "tree"</p>



<a name="155267575"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/155267575" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> csmoe <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#155267575">(Jan 16 2019 at 16:38)</a>:</h4>
<p><span class="user-mention" data-user-id="116009">@nikomatsakis</span> I think <code>as_tree</code> should be a helper for describing_place.</p>



<a name="155267606"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/155267606" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> csmoe <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#155267606">(Jan 16 2019 at 16:38)</a>:</h4>
<p>based on my previous experience, the other parts works well with the new place</p>



<a name="155267631"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/155267631" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#155267631">(Jan 16 2019 at 16:38)</a>:</h4>
<p>so one concernI have is:</p>



<a name="155267648"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/155267648" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#155267648">(Jan 16 2019 at 16:39)</a>:</h4>
<p>with the PR as it is, I don't think we can land it until we convert place construction</p>



<a name="155267657"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/155267657" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#155267657">(Jan 16 2019 at 16:39)</a>:</h4>
<p>because converting to a "neo-place" is expensive</p>



<a name="155267660"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/155267660" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> csmoe <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#155267660">(Jan 16 2019 at 16:39)</a>:</h4>
<p>exactly</p>



<a name="155267674"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/155267674" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#155267674">(Jan 16 2019 at 16:39)</a>:</h4>
<p>I <em>think</em> this alternate path I described could be landed as we go</p>



<a name="155267687"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/155267687" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#155267687">(Jan 16 2019 at 16:39)</a>:</h4>
<p>and then we could port over the code from your branch once we have place construction in place</p>



<a name="155267705"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/155267705" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#155267705">(Jan 16 2019 at 16:39)</a>:</h4>
<p>or we can keep rebasing your branch, and just get it done</p>



<a name="155267770"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/155267770" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#155267770">(Jan 16 2019 at 16:40)</a>:</h4>
<p>I feel like either is ok, but if past experience is any guide, it's better to go with the incremental approach :)</p>



<a name="155267778"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/155267778" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Santiago Pastorino <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#155267778">(Jan 16 2019 at 16:40)</a>:</h4>
<blockquote>
<p>with the PR as it is, I don't think we can land it until we convert place construction</p>
</blockquote>
<p>I guess I can help shaping the PR</p>



<a name="155267784"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/155267784" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Santiago Pastorino <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#155267784">(Jan 16 2019 at 16:40)</a>:</h4>
<p>if that's desirable</p>



<a name="155267807"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/155267807" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Santiago Pastorino <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#155267807">(Jan 16 2019 at 16:40)</a>:</h4>
<p>like picking and tidying commits from @csmoe and adapting to this idea</p>



<a name="155267817"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/155267817" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#155267817">(Jan 16 2019 at 16:40)</a>:</h4>
<blockquote>
<p>I feel like either is ok, but if past experience is any guide, it's better to go with the incremental approach :)</p>
</blockquote>
<p>by this I mean: it's always more work left than you think :)</p>



<a name="155267860"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/155267860" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> csmoe <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#155267860">(Jan 16 2019 at 16:41)</a>:</h4>
<p>I kept rebasing my branch these days, there has no conflict now.</p>



<a name="155267927"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/155267927" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> csmoe <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#155267927">(Jan 16 2019 at 16:42)</a>:</h4>
<p>so I prefer to follow my PR, if we clean up describe_place, it can be landed very soon.</p>



<a name="155267933"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/155267933" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#155267933">(Jan 16 2019 at 16:42)</a>:</h4>
<p>ok</p>



<a name="155267935"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/155267935" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#155267935">(Jan 16 2019 at 16:42)</a>:</h4>
<p>that seems reasonable too :)</p>



<a name="155267942"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/155267942" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Santiago Pastorino <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#155267942">(Jan 16 2019 at 16:42)</a>:</h4>
<p><span class="emoji emoji-1f44d" title="+1">:+1:</span></p>



<a name="155267945"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/155267945" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#155267945">(Jan 16 2019 at 16:42)</a>:</h4>
<p>do you think that <span class="user-mention" data-user-id="116266">@Santiago Pastorino</span> can help in any way?</p>



<a name="155267961"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/155267961" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Santiago Pastorino <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#155267961">(Jan 16 2019 at 16:42)</a>:</h4>
<p>exactly what I was going to ask :)</p>



<a name="155268004"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/155268004" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Santiago Pastorino <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#155268004">(Jan 16 2019 at 16:43)</a>:</h4>
<p>if I've helped by asking questions and having this meeting I'm perfectly fine :)</p>



<a name="155268006"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/155268006" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> csmoe <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#155268006">(Jan 16 2019 at 16:43)</a>:</h4>
<p>so <span class="user-mention" data-user-id="116266">@Santiago Pastorino</span>, I wanna your help for <code>as_tree</code> and describe_place</p>



<a name="155268013"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/155268013" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Santiago Pastorino <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#155268013">(Jan 16 2019 at 16:43)</a>:</h4>
<p>ok</p>



<a name="155268087"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/155268087" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Santiago Pastorino <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#155268087">(Jan 16 2019 at 16:44)</a>:</h4>
<p><span class="user-mention" data-user-id="116773">@csmoe</span> do you want me to try to give you some tips and guide if I can? or just coding something and ammending to your commits?</p>



<a name="155268126"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/155268126" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#155268126">(Jan 16 2019 at 16:44)</a>:</h4>
<p>(I guess the other question is whether <em>I</em> can help at any place =)</p>



<a name="155268146"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/155268146" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Santiago Pastorino <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#155268146">(Jan 16 2019 at 16:45)</a>:</h4>
<p>:D</p>



<a name="155268171"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/155268171" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Santiago Pastorino <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#155268171">(Jan 16 2019 at 16:45)</a>:</h4>
<p>last question I have to be 100% sure what I need to do</p>



<a name="155268180"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/155268180" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Santiago Pastorino <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#155268180">(Jan 16 2019 at 16:45)</a>:</h4>
<p>I can pull <span class="user-mention" data-user-id="116773">@csmoe</span> PR</p>



<a name="155268181"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/155268181" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#155268181">(Jan 16 2019 at 16:45)</a>:</h4>
<p>I don't have much coding time, so it'd be more like "dear god Niko why have you not reviewed commit X yet"</p>



<a name="155268189"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/155268189" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#155268189">(Jan 16 2019 at 16:45)</a>:</h4>
<p>an alternative would be</p>



<a name="155268247"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/155268247" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#155268247">(Jan 16 2019 at 16:46)</a>:</h4>
<p>that I could do a pairing session with <span class="user-mention" data-user-id="116266">@Santiago Pastorino</span> to kind of get them off int he right direction</p>



<a name="155268256"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/155268256" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Santiago Pastorino <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#155268256">(Jan 16 2019 at 16:46)</a>:</h4>
<p>and on top of that convert to use the <code>Place</code> and <code>PlaceTree</code> idea and provide <code>as_tree</code> fn</p>



<a name="155268267"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/155268267" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Santiago Pastorino <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#155268267">(Jan 16 2019 at 16:46)</a>:</h4>
<p>and then go and see the describe thing?</p>



<a name="155268273"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/155268273" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#155268273">(Jan 16 2019 at 16:46)</a>:</h4>
<p>is there some amount of work on your branch, <span class="user-mention" data-user-id="116773">@csmoe</span>, that we would want to revert? i.e., existing edits to <code>describe_place</code>?</p>



<a name="155268286"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/155268286" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> csmoe <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#155268286">(Jan 16 2019 at 16:46)</a>:</h4>
<p><span class="user-mention" data-user-id="116266">@Santiago Pastorino</span> i prefer former. so if possible, may I have your mentorship?</p>



<a name="155268306"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/155268306" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Santiago Pastorino <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#155268306">(Jan 16 2019 at 16:46)</a>:</h4>
<blockquote>
<p>that I could do a pairing session with <span class="user-mention" data-user-id="116266">@Santiago Pastorino</span> to kind of get them off int he right direction</p>
</blockquote>
<p>that would be nice</p>



<a name="155268322"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/155268322" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> csmoe <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#155268322">(Jan 16 2019 at 16:46)</a>:</h4>
<p><span class="user-mention" data-user-id="116009">@nikomatsakis</span> the last one commit</p>



<a name="155268341"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/155268341" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Santiago Pastorino <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#155268341">(Jan 16 2019 at 16:47)</a>:</h4>
<blockquote>
<p><span class="user-mention" data-user-id="116266">@Santiago Pastorino</span> i prefer former. so if possible, may I have your mentorship?</p>
</blockquote>
<p>I don't have a solid experience on the compiler to mentor</p>



<a name="155268344"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/155268344" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Santiago Pastorino <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#155268344">(Jan 16 2019 at 16:47)</a>:</h4>
<p>but I can try to think and help you of course</p>



<a name="155268347"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/155268347" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> csmoe <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#155268347">(Jan 16 2019 at 16:47)</a>:</h4>
<p>ci was happy with everything before re-describe-place</p>



<a name="155268352"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/155268352" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Santiago Pastorino <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#155268352">(Jan 16 2019 at 16:47)</a>:</h4>
<p>would be great if I can guide you :)</p>



<a name="155268364"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/155268364" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> csmoe <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#155268364">(Jan 16 2019 at 16:47)</a>:</h4>
<p><span class="user-mention" data-user-id="116266">@Santiago Pastorino</span> thank you <span class="emoji emoji-2764" title="heart">:heart:</span></p>



<a name="155268373"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/155268373" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#155268373">(Jan 16 2019 at 16:47)</a>:</h4>
<p>ok, let's do this</p>



<a name="155268378"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/155268378" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Santiago Pastorino <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#155268378">(Jan 16 2019 at 16:48)</a>:</h4>
<p>mentoring seems like a too strong word for my compiler knowledge <span class="emoji emoji-1f60a" title="blush">:blush:</span></p>



<a name="155268448"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/155268448" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#155268448">(Jan 16 2019 at 16:48)</a>:</h4>
<p><span class="user-mention" data-user-id="116266">@Santiago Pastorino</span> you and I will schedule a slot to pair up -- <span class="user-mention" data-user-id="116773">@csmoe</span> if you can come, great, but I'll record it too and put it on youtube -- and we'll try to get started</p>



<a name="155268451"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/155268451" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#155268451">(Jan 16 2019 at 16:48)</a>:</h4>
<p>maybe we can find a time today?</p>



<a name="155268459"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/155268459" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#155268459">(Jan 16 2019 at 16:48)</a>:</h4>
<p>it would have to be soon I realize</p>



<a name="155268462"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/155268462" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#155268462">(Jan 16 2019 at 16:48)</a>:</h4>
<p>since I am a bit busy this afternoon</p>



<a name="155268465"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/155268465" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Santiago Pastorino <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#155268465">(Jan 16 2019 at 16:48)</a>:</h4>
<p>yes</p>



<a name="155268471"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/155268471" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Santiago Pastorino <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#155268471">(Jan 16 2019 at 16:48)</a>:</h4>
<p>I'm busy too</p>



<a name="155268484"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/155268484" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Santiago Pastorino <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#155268484">(Jan 16 2019 at 16:49)</a>:</h4>
<p>right now is 1.47pm</p>



<a name="155268489"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/155268489" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Santiago Pastorino <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#155268489">(Jan 16 2019 at 16:49)</a>:</h4>
<p>maybe now</p>



<a name="155268496"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/155268496" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> csmoe <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#155268496">(Jan 16 2019 at 16:49)</a>:</h4>
<p><span class="user-mention" data-user-id="116266">@Santiago Pastorino</span> I am glad to have your seniors, you bring me to the programming world.</p>



<a name="155268499"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/155268499" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Santiago Pastorino <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#155268499">(Jan 16 2019 at 16:49)</a>:</h4>
<p>I have a meeting at 3pm</p>



<a name="155268513"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/155268513" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> csmoe <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#155268513">(Jan 16 2019 at 16:49)</a>:</h4>
<p>it's midnight here. 00:49</p>



<a name="155268522"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/155268522" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Santiago Pastorino <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#155268522">(Jan 16 2019 at 16:49)</a>:</h4>
<p>and didn't have lunch yet</p>



<a name="155268533"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/155268533" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Santiago Pastorino <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#155268533">(Jan 16 2019 at 16:49)</a>:</h4>
<p><span class="user-mention" data-user-id="116009">@nikomatsakis</span> if you can now would be great</p>



<a name="155268636"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/155268636" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#155268636">(Jan 16 2019 at 16:50)</a>:</h4>
<p>yeah now is ok</p>



<a name="155268645"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/155268645" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> csmoe <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#155268645">(Jan 16 2019 at 16:50)</a>:</h4>
<blockquote>
<p>if you can come, great, but I'll record it too and put it on youtube -- and we'll try to get started</p>
</blockquote>



<a name="155268650"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/155268650" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> csmoe <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#155268650">(Jan 16 2019 at 16:50)</a>:</h4>
<p>I will be there. <span class="emoji emoji-1f642" title="slight smile">:slight_smile:</span></p>



<a name="155268774"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/155268774" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#155268774">(Jan 16 2019 at 16:52)</a>:</h4>
<p>give me five minutes</p>



<a name="155268780"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/155268780" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#155268780">(Jan 16 2019 at 16:52)</a>:</h4>
<p><a href="https://appear.in/i-heart-rust" target="_blank" title="https://appear.in/i-heart-rust">https://appear.in/i-heart-rust</a></p>



<a name="155268823"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/155268823" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Santiago Pastorino <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#155268823">(Jan 16 2019 at 16:53)</a>:</h4>
<p>yeah will be here in 2 mins</p>



<a name="155269346"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/155269346" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#155269346">(Jan 16 2019 at 17:00)</a>:</h4>
<p>ssh <a href="mailto:etEC8yzGxp83SAlxPd9H9SOm7@ny2.tmate.io" title="mailto:etEC8yzGxp83SAlxPd9H9SOm7@ny2.tmate.io">etEC8yzGxp83SAlxPd9H9SOm7@ny2.tmate.io</a></p>



<a name="155269556"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/155269556" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#155269556">(Jan 16 2019 at 17:03)</a>:</h4>
<p>whomever just ssh'd in, can you grow your screen? :)</p>



<a name="155270348"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/155270348" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#155270348">(Jan 16 2019 at 17:13)</a>:</h4>
<p><span class="user-mention" data-user-id="116773">@csmoe</span> are you connected to the ssh? if so, can you make your terminal window bigger and/or font smaller? :)</p>



<a name="155270737"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/155270737" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Santiago Pastorino <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#155270737">(Jan 16 2019 at 17:19)</a>:</h4>
<p>hi?</p>



<a name="155270747"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/155270747" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#155270747">(Jan 16 2019 at 17:19)</a>:</h4>
<p><span class="user-mention" data-user-id="116266">@Santiago Pastorino</span> lost you :)</p>



<a name="155271580"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/155271580" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> csmoe <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#155271580">(Jan 16 2019 at 17:31)</a>:</h4>
<p><span class="user-mention" data-user-id="116009">@nikomatsakis</span> my ssh window frozen, is it safe to exit and reconnect?</p>



<a name="155271727"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/155271727" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#155271727">(Jan 16 2019 at 17:32)</a>:</h4>
<p><span class="user-mention" data-user-id="116773">@csmoe</span> yes</p>



<a name="155272244"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/155272244" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> csmoe <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#155272244">(Jan 16 2019 at 17:39)</a>:</h4>
<p><span class="user-mention" data-user-id="116009">@nikomatsakis</span> we have as_place_base in librustc/mir/tcx.rs</p>



<a name="155272321"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/155272321" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#155272321">(Jan 16 2019 at 17:40)</a>:</h4>
<p><span class="user-mention" data-user-id="116773">@csmoe</span> ah ok =)</p>



<a name="155272632"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/155272632" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#155272632">(Jan 16 2019 at 17:45)</a>:</h4>
<p>OK that work is at <a href="https://github.com/nikomatsakis/rust/tree/place2b" target="_blank" title="https://github.com/nikomatsakis/rust/tree/place2b">https://github.com/nikomatsakis/rust/tree/place2b</a></p>



<a name="155272746"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/155272746" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#155272746">(Jan 16 2019 at 17:46)</a>:</h4>
<p>I think the next steps are:</p>
<ul>
<li>Get it to compile =)</li>
<li>Convert any remaining users of <code>Place</code> to use <code>NeoPlace</code><br>
    - we could use the <code>tree</code> version to do that mechanically</li>
<li>Convert place construction to build a <code>NeoPlace</code> directly</li>
</ul>
<p>One nit about the tree stuff was that, because <code>PlaceBase</code> is not <code>Copy</code>, it might require some cloning here and there to use the tree view, which is a bit less efficient. For <code>describe_place</code>, that doesn't matter, but it might be a problem elsewhere. I think I would prefer to fix this by making <code>PlaceBase</code> be <code>Copy</code> -- basically removing the <code>Box</code> and replacing with interned <code>&amp;'tcx</code> pointers.</p>



<a name="155272752"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/155272752" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#155272752">(Jan 16 2019 at 17:46)</a>:</h4>
<p><span class="user-mention" data-user-id="116773">@csmoe</span> that sound about right? <span class="emoji emoji-1f446" title="point up">:point_up:</span></p>



<a name="155272763"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/155272763" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> csmoe <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#155272763">(Jan 16 2019 at 17:46)</a>:</h4>
<p>yep</p>



<a name="155272764"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/155272764" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#155272764">(Jan 16 2019 at 17:46)</a>:</h4>
<p>I also recorded that session</p>



<a name="155272771"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/155272771" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#155272771">(Jan 16 2019 at 17:46)</a>:</h4>
<p>I can post to YouTube</p>



<a name="155272775"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/155272775" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#155272775">(Jan 16 2019 at 17:46)</a>:</h4>
<p>if desired</p>



<a name="155272787"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/155272787" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#155272787">(Jan 16 2019 at 17:47)</a>:</h4>
<p>including my daughter's interruption ;)</p>



<a name="155272818"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/155272818" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> csmoe <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#155272818">(Jan 16 2019 at 17:47)</a>:</h4>
<p>yes, youtube</p>



<a name="155272824"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/155272824" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> csmoe <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#155272824">(Jan 16 2019 at 17:47)</a>:</h4>
<p>haha <span class="emoji emoji-1f642" title="slight smile">:slight_smile:</span></p>



<a name="155274941"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/155274941" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Santiago Pastorino <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#155274941">(Jan 16 2019 at 18:16)</a>:</h4>
<p>don't worry for me :)</p>



<a name="155274968"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/155274968" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Santiago Pastorino <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#155274968">(Jan 16 2019 at 18:17)</a>:</h4>
<p>maybe <span class="user-mention" data-user-id="116773">@csmoe</span> want to watch, unsure if you were able to follow everything</p>



<a name="155274970"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/155274970" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Santiago Pastorino <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#155274970">(Jan 16 2019 at 18:17)</a>:</h4>
<p>I lost connection twice :P</p>



<a name="155274994"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/155274994" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Santiago Pastorino <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#155274994">(Jan 16 2019 at 18:17)</a>:</h4>
<p><span class="user-mention" data-user-id="116009">@nikomatsakis</span> <span class="user-mention" data-user-id="116773">@csmoe</span> I won't be able to continue with this today</p>



<a name="155274997"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/155274997" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Santiago Pastorino <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#155274997">(Jan 16 2019 at 18:17)</a>:</h4>
<p>probably tomorrow</p>



<a name="155275052"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/155275052" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Santiago Pastorino <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#155275052">(Jan 16 2019 at 18:18)</a>:</h4>
<p>have a Rust Latam meeting now :)</p>



<a name="156392215"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/156392215" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#156392215">(Jan 18 2019 at 19:13)</a>:</h4>
<p>how goes y'all?</p>



<a name="156392652"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/156392652" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Santiago Pastorino <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#156392652">(Jan 18 2019 at 19:19)</a>:</h4>
<p>hey Niko</p>



<a name="156392704"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/156392704" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Santiago Pastorino <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#156392704">(Jan 18 2019 at 19:20)</a>:</h4>
<p>promised doing something today, couldn't yet</p>



<a name="156392705"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/156392705" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Santiago Pastorino <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#156392705">(Jan 18 2019 at 19:20)</a>:</h4>
<p>gonna spend some time now</p>



<a name="156392707"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/156392707" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Santiago Pastorino <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#156392707">(Jan 18 2019 at 19:20)</a>:</h4>
<p>I have the thing compiling</p>



<a name="156392727"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/156392727" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Santiago Pastorino <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#156392727">(Jan 18 2019 at 19:20)</a>:</h4>
<p>looking for Place usages</p>



<a name="156392794"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/156392794" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Santiago Pastorino <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#156392794">(Jan 18 2019 at 19:21)</a>:</h4>
<p>basically I'm going to remove Place, make the thing compile and then I guess we can rename NeoPlace to Place</p>



<a name="156392796"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/156392796" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Santiago Pastorino <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#156392796">(Jan 18 2019 at 19:21)</a>:</h4>
<p>right?</p>



<a name="156529396"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/156529396" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> csmoe <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#156529396">(Jan 21 2019 at 11:19)</a>:</h4>
<p>update: re-describe-place done</p>



<a name="156533432"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/156533432" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Santiago Pastorino <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#156533432">(Jan 21 2019 at 12:36)</a>:</h4>
<p><span class="user-mention" data-user-id="116773">@csmoe</span> have you pushed the code somewhere?</p>



<a name="156533437"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/156533437" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Santiago Pastorino <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#156533437">(Jan 21 2019 at 12:36)</a>:</h4>
<p>I've done a couple of things too</p>



<a name="156533707"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/156533707" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> csmoe <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#156533707">(Jan 21 2019 at 12:41)</a>:</h4>
<p><span class="user-mention" data-user-id="116266">@Santiago Pastorino</span> the last two commits, I merged niko's work into the PR. and made some modifications.</p>



<a name="156533722"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/156533722" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> csmoe <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#156533722">(Jan 21 2019 at 12:41)</a>:</h4>
<p><a href="https://github.com/rust-lang/rust/pull/54426/commits/cba36331ef061a30bfaf8a3d30118ef10a06d4d2" target="_blank" title="https://github.com/rust-lang/rust/pull/54426/commits/cba36331ef061a30bfaf8a3d30118ef10a06d4d2">https://github.com/rust-lang/rust/pull/54426/commits/cba36331ef061a30bfaf8a3d30118ef10a06d4d2</a></p>



<a name="156540226"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/156540226" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Santiago Pastorino <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#156540226">(Jan 21 2019 at 14:38)</a>:</h4>
<p><span class="user-mention" data-user-id="116773">@csmoe</span> you around?</p>



<a name="156540283"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/156540283" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Santiago Pastorino <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#156540283">(Jan 21 2019 at 14:38)</a>:</h4>
<p>so ... should I just get what's here <a href="https://github.com/rust-lang/rust/pull/54426/" target="_blank" title="https://github.com/rust-lang/rust/pull/54426/">https://github.com/rust-lang/rust/pull/54426/</a> ?</p>



<a name="156540289"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/156540289" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Santiago Pastorino <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#156540289">(Jan 21 2019 at 14:38)</a>:</h4>
<p>and continue from there?</p>



<a name="156540292"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/156540292" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Santiago Pastorino <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#156540292">(Jan 21 2019 at 14:38)</a>:</h4>
<p>that branch is the same as Niko's branch or did you changed something else?</p>



<a name="156540313"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/156540313" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Santiago Pastorino <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#156540313">(Jan 21 2019 at 14:39)</a>:</h4>
<p>maybe could be good idea if you can give me commit access so we can keep stuff in sync</p>



<a name="156540459"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/156540459" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> csmoe <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#156540459">(Jan 21 2019 at 14:41)</a>:</h4>
<p>okay, but how can i give the access to you?</p>



<a name="156540505"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/156540505" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Santiago Pastorino <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#156540505">(Jan 21 2019 at 14:42)</a>:</h4>
<p>you need to give me push access to csmoe/rust</p>



<a name="156540516"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/156540516" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Santiago Pastorino <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#156540516">(Jan 21 2019 at 14:42)</a>:</h4>
<blockquote>
<p>that branch is the same as Niko's branch or did you changed something else?</p>
</blockquote>
<p><span class="emoji emoji-1f446" title="point up">:point_up:</span></p>



<a name="156540536"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/156540536" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Santiago Pastorino <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#156540536">(Jan 21 2019 at 14:43)</a>:</h4>
<p>because last commits I'm seeing there are the ones from Niko</p>



<a name="156540547"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/156540547" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Santiago Pastorino <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#156540547">(Jan 21 2019 at 14:43)</a>:</h4>
<p>do you want to pair with me for a while at some point?</p>



<a name="156540612"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/156540612" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> csmoe <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#156540612">(Jan 21 2019 at 14:44)</a>:</h4>
<p>yep. same as niko's</p>



<a name="156540655"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/156540655" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Santiago Pastorino <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#156540655">(Jan 21 2019 at 14:45)</a>:</h4>
<p>ahh ok ok</p>



<a name="156540826"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/156540826" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> csmoe <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#156540826">(Jan 21 2019 at 14:48)</a>:</h4>
<p><a href="https://github.com/csmoe/rust/invitations" target="_blank" title="https://github.com/csmoe/rust/invitations">https://github.com/csmoe/rust/invitations</a></p>



<a name="156540853"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/156540853" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Santiago Pastorino <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#156540853">(Jan 21 2019 at 14:49)</a>:</h4>
<p><span class="emoji emoji-1f44d" title="+1">:+1:</span></p>



<a name="156540922"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/156540922" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> csmoe <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#156540922">(Jan 21 2019 at 14:50)</a>:</h4>
<p>invited you as csmoe/rust collaborator, does this guarantee you access?</p>



<a name="156540986"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/156540986" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Santiago Pastorino <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#156540986">(Jan 21 2019 at 14:51)</a>:</h4>
<p>yes</p>



<a name="156546446"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/156546446" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Santiago Pastorino <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#156546446">(Jan 21 2019 at 16:21)</a>:</h4>
<p><span class="user-mention" data-user-id="116009">@nikomatsakis</span> I'm going over this thing</p>



<a name="156546473"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/156546473" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Santiago Pastorino <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#156546473">(Jan 21 2019 at 16:22)</a>:</h4>
<blockquote>
<p>I think the next steps are:</p>
<ul>
<li>Get it to compile =)</li>
<li>Convert any remaining users of <code>Place</code> to use <code>NeoPlace</code><br>
    - we could use the <code>tree</code> version to do that mechanically</li>
<li>Convert place construction to build a <code>NeoPlace</code> directly</li>
</ul>
<p>One nit about the tree stuff was that, because <code>PlaceBase</code> is not <code>Copy</code>, it might require some cloning here and there to use the tree view, which is a bit less efficient. For <code>describe_place</code>, that doesn't matter, but it might be a problem elsewhere. I think I would prefer to fix this by making <code>PlaceBase</code> be <code>Copy</code> -- basically removing the <code>Box</code> and replacing with interned <code>&amp;'tcx</code> pointers.</p>
</blockquote>
<p>from this suggestion ...</p>



<a name="156546515"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/156546515" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Santiago Pastorino <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#156546515">(Jan 21 2019 at 16:22)</a>:</h4>
<p>convert remaining uses of <code>Place</code> to <code>NeoPlace</code> there are some that are complicated, like hash_stable</p>



<a name="156546521"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/156546521" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Santiago Pastorino <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#156546521">(Jan 21 2019 at 16:22)</a>:</h4>
<p>or things like that that touches a lot of things</p>



<a name="156546544"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/156546544" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Santiago Pastorino <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#156546544">(Jan 21 2019 at 16:23)</a>:</h4>
<p>but anyway, I may follow my own strategy</p>



<a name="156546548"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/156546548" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Santiago Pastorino <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#156546548">(Jan 21 2019 at 16:23)</a>:</h4>
<p>the thing is ... do we want to get rid of old <code>Place</code> at the end?</p>



<a name="156546591"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/156546591" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Santiago Pastorino <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#156546591">(Jan 21 2019 at 16:24)</a>:</h4>
<p>and convert everything to <code>NeoPlace</code> and <code>NeoPlaceTree</code>?</p>



<a name="156546701"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/156546701" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Santiago Pastorino <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#156546701">(Jan 21 2019 at 16:26)</a>:</h4>
<p>I'm working on this thing but I'm after removing old <code>Place</code></p>



<a name="156548098"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/156548098" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Santiago Pastorino <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#156548098">(Jan 21 2019 at 16:51)</a>:</h4>
<p>I'm trying different approaches but unsure what's the best, maybe I just need now to convert place into neoplace everywhere</p>



<a name="156548100"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/156548100" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Santiago Pastorino <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#156548100">(Jan 21 2019 at 16:51)</a>:</h4>
<p>for instance</p>



<a name="156548104"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/156548104" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Santiago Pastorino <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#156548104">(Jan 21 2019 at 16:51)</a>:</h4>
<div class="codehilite"><pre><span></span>diff --git a/src/librustc/mir/tcx.rs b/src/librustc/mir/tcx.rs
index 408fb076442..5af92ed8f28 100644
--- a/src/librustc/mir/tcx.rs
+++ b/src/librustc/mir/tcx.rs
@@ -157,20 +157,6 @@ EnumTypeFoldableImpl! {
 }

 impl&lt;&#39;tcx&gt; Place&lt;&#39;tcx&gt; {
-    pub fn ty&lt;&#39;a, &#39;gcx, D&gt;(&amp;self, local_decls: &amp;D, tcx: TyCtxt&lt;&#39;a, &#39;gcx, &#39;tcx&gt;) -&gt; PlaceTy&lt;&#39;tcx&gt;
-        where D: HasLocalDecls&lt;&#39;tcx&gt;
-    {
-        match *self {
-            Place::Local(index) =&gt;
-                PlaceTy::Ty { ty: local_decls.local_decls()[index].ty },
-            Place::Promoted(ref data) =&gt; PlaceTy::Ty { ty: data.1 },
-            Place::Static(ref data) =&gt;
-                PlaceTy::Ty { ty: data.ty },
-            Place::Projection(ref proj) =&gt;
-                proj.base.ty(local_decls, tcx).projection_ty(tcx, &amp;proj.elem),
-        }
-    }
-
     // If this is a field projection, and the field is being projected from a closure type,
     // then returns the index of the field being projected. Note that this closure will always
     // be `self` in the current MIR, because that is the only time we directly access the fields
@@ -377,7 +363,9 @@ impl&lt;&#39;tcx&gt; Rvalue&lt;&#39;tcx&gt; {
                 tcx.mk_array(operand.ty(local_decls, tcx), count)
             }
             Rvalue::Ref(reg, bk, ref place) =&gt; {
-                let place_ty = place.ty(local_decls, tcx).to_ty(tcx);
+                let neo_place = tcx.as_new_place(place);
+                let place_ty = neo_place.ty(local_decls, tcx).to_ty(tcx);
+
                 tcx.mk_ref(reg,
                     ty::TypeAndMut {
                         ty: place_ty,
@@ -403,7 +391,8 @@ impl&lt;&#39;tcx&gt; Rvalue&lt;&#39;tcx&gt; {
                 operand.ty(local_decls, tcx)
             }
             Rvalue::Discriminant(ref place) =&gt; {
-                let ty = place.ty(local_decls, tcx).to_ty(tcx);
+                let neo_place = tcx.as_new_place(place);
+                let ty = neo_place.ty(local_decls, tcx).to_ty(tcx);
                 if let ty::Adt(adt_def, _) = ty.sty {
                     adt_def.repr.discr_type().to_ty(tcx)
                 } else {
@@ -452,7 +441,10 @@ impl&lt;&#39;tcx&gt; Operand&lt;&#39;tcx&gt; {
     {
         match self {
             &amp;Operand::Copy(ref l) |
-            &amp;Operand::Move(ref l) =&gt; l.ty(local_decls, tcx).to_ty(tcx),
+            &amp;Operand::Move(ref l) =&gt; {
+                let neo_place = tcx.as_new_place(l);
+                neo_place.ty(local_decls, tcx).to_ty(tcx)
+            }
             &amp;Operand::Constant(ref c) =&gt; c.ty,
         }
     }
</pre></div>



<a name="156548161"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/156548161" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Santiago Pastorino <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#156548161">(Jan 21 2019 at 16:52)</a>:</h4>
<p>and after that are 53 errors because I need to apply ty over neoplace</p>



<a name="156548171"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/156548171" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Santiago Pastorino <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#156548171">(Jan 21 2019 at 16:52)</a>:</h4>
<p>and convert place into neoplace</p>



<a name="156548180"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/156548180" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Santiago Pastorino <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#156548180">(Jan 21 2019 at 16:52)</a>:</h4>
<p>but then when I convert to create neoplace I'd need to change the stuff again</p>



<a name="156548202"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/156548202" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Santiago Pastorino <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#156548202">(Jan 21 2019 at 16:53)</a>:</h4>
<p>I guess it's better to just create neoplace instead of place</p>



<a name="156548208"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/156548208" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Santiago Pastorino <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#156548208">(Jan 21 2019 at 16:53)</a>:</h4>
<p>looking for where in code that happens ...</p>



<a name="156549354"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/156549354" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Santiago Pastorino <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#156549354">(Jan 21 2019 at 17:14)</a>:</h4>
<p><span class="user-mention" data-user-id="116009">@nikomatsakis</span> I'm not sure what did you exactly mean by <code>Convert place construction to build a NeoPlace directly</code></p>



<a name="156549381"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/156549381" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Santiago Pastorino <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#156549381">(Jan 21 2019 at 17:15)</a>:</h4>
<p>if you meant that in the entire code and that basically means replacing the whole place thing with neoplace or if you were talking about some specific cases</p>



<a name="156617979"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/156617979" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#156617979">(Jan 22 2019 at 16:30)</a>:</h4>
<p>ok <span class="user-mention" data-user-id="116266">@Santiago Pastorino</span> so what I mean is</p>



<a name="156617985"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/156617985" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#156617985">(Jan 22 2019 at 16:30)</a>:</h4>
<p>there is various bits of code in MIR construction that build up a "place"</p>



<a name="156618172"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/156618172" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#156618172">(Jan 22 2019 at 16:33)</a>:</h4>
<p>usually converting from a HAIR expression</p>



<a name="156620325"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/156620325" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#156620325">(Jan 22 2019 at 17:00)</a>:</h4>
<p>the code tends to work in a 'recursive' way right now:</p>
<p>so e.g. to translate <code>a.b.c</code> ,we might translate <code>a</code> to a Place, and then wrap that in another place to build <code>a.b</code> etc</p>



<a name="156620339"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/156620339" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#156620339">(Jan 22 2019 at 17:00)</a>:</h4>
<p>however, for building a neo-place, that approach would lead to terrible performance</p>



<a name="156620345"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/156620345" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#156620345">(Jan 22 2019 at 17:00)</a>:</h4>
<p>what we need is some sort of <code>PlaceBuilder</code></p>



<a name="156620361"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/156620361" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#156620361">(Jan 22 2019 at 17:01)</a>:</h4>
<p>that replaces the <code>&amp;[Projection]</code> array with a <code>Vec&lt;Projection&gt;</code></p>



<a name="156620393"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/156620393" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Santiago Pastorino <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#156620393">(Jan 22 2019 at 17:02)</a>:</h4>
<p>not sure about what case are you talking about</p>



<a name="156620446"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/156620446" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Santiago Pastorino <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#156620446">(Jan 22 2019 at 17:02)</a>:</h4>
<p>my approach was just to remove <code>Place</code> entirely</p>



<a name="156627227"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/156627227" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#156627227">(Jan 22 2019 at 18:30)</a>:</h4>
<p><span class="user-mention" data-user-id="116266">@Santiago Pastorino</span> I'm talking about <a href="https://github.com/rust-lang/rust/blob/ad30e9a6814b5d29dfbdcd85ecde48afcc94389b/src/librustc_mir/build/expr/as_place.rs#L14-L21" target="_blank" title="https://github.com/rust-lang/rust/blob/ad30e9a6814b5d29dfbdcd85ecde48afcc94389b/src/librustc_mir/build/expr/as_place.rs#L14-L21">this method</a>, basically</p>



<a name="156629663"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/156629663" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Santiago Pastorino <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#156629663">(Jan 22 2019 at 19:01)</a>:</h4>
<p>ok, what I don't see is what process are you suggesting to follow</p>



<a name="156629676"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/156629676" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Santiago Pastorino <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#156629676">(Jan 22 2019 at 19:01)</a>:</h4>
<p>I was more or less trying to remove Place and make the thing compile</p>



<a name="156629681"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/156629681" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Santiago Pastorino <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#156629681">(Jan 22 2019 at 19:01)</a>:</h4>
<p>regardless of performance</p>



<a name="156629698"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/156629698" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Santiago Pastorino <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#156629698">(Jan 22 2019 at 19:02)</a>:</h4>
<p>then as a second step I can transform things to make them better I guess</p>



<a name="156629758"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/156629758" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Santiago Pastorino <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#156629758">(Jan 22 2019 at 19:02)</a>:</h4>
<p>or are you suggesting this for some reason that I don't see</p>



<a name="156636500"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/156636500" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#156636500">(Jan 22 2019 at 20:27)</a>:</h4>
<blockquote>
<p>I was more or less trying to remove Place and make the thing compile</p>
</blockquote>
<p>this seems ok, modulo one thing</p>



<a name="156636508"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/156636508" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#156636508">(Jan 22 2019 at 20:27)</a>:</h4>
<p>I would definitely to keep each "major refactoring" within a single commit</p>



<a name="156636516"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/156636516" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#156636516">(Jan 22 2019 at 20:27)</a>:</h4>
<p>i.e., to refactor one bit of code at a time so that you can test it in isolation</p>



<a name="156636574"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/156636574" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#156636574">(Jan 22 2019 at 20:28)</a>:</h4>
<p>I guess that for the <code>librustc_mir</code>, I personally wouldn't refactor it first to build <code>Place</code> slowly and then <code>PlaceBuilder</code> but rather just direct to <code>PlaceBuilder</code>, but I also have no objection to doing it in 2 steps</p>



<a name="156636583"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/156636583" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#156636583">(Jan 22 2019 at 20:28)</a>:</h4>
<p>maybe it's just because I see more clearly where I think it should go and it seems like a similar-ish amount of work</p>



<a name="156636587"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/156636587" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Santiago Pastorino <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#156636587">(Jan 22 2019 at 20:28)</a>:</h4>
<blockquote>
<p>I would definitely to keep each "major refactoring" within a single commit</p>
</blockquote>
<p>the problem is that I'm not sure that's always possible</p>



<a name="156636602"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/156636602" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#156636602">(Jan 22 2019 at 20:28)</a>:</h4>
<p>maybe not, we should be trying to find ways to make it possible though :)</p>



<a name="156636605"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/156636605" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#156636605">(Jan 22 2019 at 20:28)</a>:</h4>
<p>up till now we've been doing by interconverting between the two at "boundaries"</p>



<a name="156636617"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/156636617" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Santiago Pastorino <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#156636617">(Jan 22 2019 at 20:29)</a>:</h4>
<p>cases like implementing the mentioned traits could be isolated</p>



<a name="156636620"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/156636620" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#156636620">(Jan 22 2019 at 20:29)</a>:</h4>
<p>which seems "ok" -- it's slow obviously, but presuably the final commit will be to remove all of that</p>



<a name="156636638"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/156636638" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Santiago Pastorino <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#156636638">(Jan 22 2019 at 20:29)</a>:</h4>
<p>yes, agree on that</p>



<a name="156636641"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/156636641" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#156636641">(Jan 22 2019 at 20:29)</a>:</h4>
<p>I think if we don't manage to confine the rewrite to narrow pieces of code, though, the PR will never land =) (I still sort of worry that may be true)</p>



<a name="156636642"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/156636642" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Santiago Pastorino <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#156636642">(Jan 22 2019 at 20:29)</a>:</h4>
<p>but for instance ...</p>



<a name="156636767"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/156636767" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Santiago Pastorino <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#156636767">(Jan 22 2019 at 20:30)</a>:</h4>
<p>it's not always easy to convert from <code>Place</code> to <code>NeoPlace</code></p>



<a name="156636789"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/156636789" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Santiago Pastorino <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#156636789">(Jan 22 2019 at 20:31)</a>:</h4>
<p>because we need a context which we don't always have</p>



<a name="156636808"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/156636808" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Santiago Pastorino <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#156636808">(Jan 22 2019 at 20:31)</a>:</h4>
<p>as_new_place is in <code>TyCtxt</code></p>



<a name="156636831"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/156636831" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Santiago Pastorino <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#156636831">(Jan 22 2019 at 20:31)</a>:</h4>
<p>and there are places where I do not have the context</p>



<a name="156636964"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/156636964" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#156636964">(Jan 22 2019 at 20:33)</a>:</h4>
<p>ok</p>



<a name="156637012"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/156637012" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#156637012">(Jan 22 2019 at 20:33)</a>:</h4>
<p>apart from MIR <em>construction</em>, how many places are left that consume raw places and not neo-places, roughly? do we have an idea of that?</p>



<a name="156637067"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/156637067" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#156637067">(Jan 22 2019 at 20:34)</a>:</h4>
<p>and, what's an example of a such a place where you encountered trouble?</p>



<a name="156637111"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/156637111" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Santiago Pastorino <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#156637111">(Jan 22 2019 at 20:34)</a>:</h4>
<p>I don't think there's that much left other than MIR construction</p>



<a name="156637183"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/156637183" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Santiago Pastorino <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#156637183">(Jan 22 2019 at 20:35)</a>:</h4>
<p>let me check a bit again</p>



<a name="156637290"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/156637290" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Santiago Pastorino <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#156637290">(Jan 22 2019 at 20:37)</a>:</h4>
<p><span class="user-mention" data-user-id="116009">@nikomatsakis</span> for instance <a href="https://github.com/rust-lang/rust/blob/master/src/librustc/ich/impls_mir.rs#L201" target="_blank" title="https://github.com/rust-lang/rust/blob/master/src/librustc/ich/impls_mir.rs#L201">https://github.com/rust-lang/rust/blob/master/src/librustc/ich/impls_mir.rs#L201</a></p>



<a name="156637296"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/156637296" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Santiago Pastorino <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#156637296">(Jan 22 2019 at 20:37)</a>:</h4>
<p>and a lot of stuff that's there</p>



<a name="156637403"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/156637403" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Santiago Pastorino <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#156637403">(Jan 22 2019 at 20:39)</a>:</h4>
<p>I mean, in order to implement <code>hash_stable</code> for some types you need <code>Place</code> implementing that thing</p>



<a name="156637416"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/156637416" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Santiago Pastorino <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#156637416">(Jan 22 2019 at 20:39)</a>:</h4>
<p>so if you want to convert that to <code>NeoPlace</code> you need to convert a lot of things</p>



<a name="156637423"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/156637423" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Santiago Pastorino <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#156637423">(Jan 22 2019 at 20:39)</a>:</h4>
<p>same for mir construction</p>



<a name="156637434"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/156637434" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Santiago Pastorino <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#156637434">(Jan 22 2019 at 20:39)</a>:</h4>
<p>anyway, I guess I can continue working on this and maybe tomorrow we can sync</p>



<a name="156637441"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/156637441" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Santiago Pastorino <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#156637441">(Jan 22 2019 at 20:39)</a>:</h4>
<p>let me figure out some more things</p>



<a name="156637522"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/156637522" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Santiago Pastorino <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#156637522">(Jan 22 2019 at 20:40)</a>:</h4>
<p><span class="user-mention" data-user-id="116009">@nikomatsakis</span> the doubt I have now is how to implement <code>is_prefix_of</code> for <code>NeoPlace</code></p>



<a name="156637546"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/156637546" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Santiago Pastorino <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#156637546">(Jan 22 2019 at 20:40)</a>:</h4>
<p>given that <code>PlaceBase</code> and <code>PlaceElem</code> are different types</p>



<a name="156637602"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/156637602" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Santiago Pastorino <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#156637602">(Jan 22 2019 at 20:41)</a>:</h4>
<p>I can't just try to see if self's <code>&amp;[PlaceElem]</code> includes other's <code>&amp;[PlaceElem]</code> because we would be missing the base</p>



<a name="156637674"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/156637674" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Santiago Pastorino <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#156637674">(Jan 22 2019 at 20:42)</a>:</h4>
<p>basically unsure how to compare <code>PlaceBase</code> to <code>PlaceElem</code></p>



<a name="156638063"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/156638063" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#156638063">(Jan 22 2019 at 20:47)</a>:</h4>
<blockquote>
<p>and a lot of stuff that's there</p>
</blockquote>
<p>well, yeah, I would not modify the hashing impls</p>



<a name="156638133"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/156638133" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Santiago Pastorino <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#156638133">(Jan 22 2019 at 20:48)</a>:</h4>
<p>yeah, agreed :)</p>



<a name="156638148"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/156638148" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#156638148">(Jan 22 2019 at 20:48)</a>:</h4>
<p>as for <code>is_prefix_of</code></p>



<a name="156638190"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/156638190" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#156638190">(Jan 22 2019 at 20:49)</a>:</h4>
<p>if you have two neo-places...</p>



<a name="156638200"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/156638200" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#156638200">(Jan 22 2019 at 20:49)</a>:</h4>
<p>I guess that <code>is_prefix_of</code> would iterate in "lock-step" down self/other</p>



<a name="156638204"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/156638204" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#156638204">(Jan 22 2019 at 20:49)</a>:</h4>
<p>so first the base of both must be equal</p>



<a name="156638212"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/156638212" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#156638212">(Jan 22 2019 at 20:49)</a>:</h4>
<p>then each elem in self must be equal to an elem in other</p>



<a name="156638216"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/156638216" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#156638216">(Jan 22 2019 at 20:49)</a>:</h4>
<p>plus other must have longer length</p>



<a name="156638217"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/156638217" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#156638217">(Jan 22 2019 at 20:49)</a>:</h4>
<p>so something like</p>



<a name="156638308"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/156638308" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Santiago Pastorino <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#156638308">(Jan 22 2019 at 20:50)</a>:</h4>
<p>we are missing the base in the projection now, that's why I can't compare things</p>



<a name="156638309"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/156638309" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Santiago Pastorino <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#156638309">(Jan 22 2019 at 20:50)</a>:</h4>
<p>I guess I'm missing something ... :)</p>



<a name="156638322"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/156638322" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#156638322">(Jan 22 2019 at 20:50)</a>:</h4>
<div class="codehilite"><pre><span></span><span class="k">fn</span> <span class="nf">is_prefix_of</span><span class="p">(</span><span class="o">&amp;</span><span class="bp">self</span><span class="p">,</span><span class="w"> </span><span class="n">other</span>: <span class="kp">&amp;</span><span class="nc">NeoPlace</span><span class="o">&lt;</span><span class="na">&#39;tcx</span><span class="o">&gt;</span><span class="p">)</span><span class="w"> </span>-&gt; <span class="kt">bool</span> <span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="bp">self</span><span class="p">.</span><span class="n">len</span><span class="p">()</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="n">other</span><span class="p">.</span><span class="n">len</span><span class="p">()</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="kc">false</span><span class="p">;</span><span class="w"> </span><span class="p">}</span><span class="w"></span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="bp">self</span><span class="p">.</span><span class="n">base</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="n">other</span><span class="p">.</span><span class="n">base</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="kc">false</span><span class="p">;</span><span class="w"> </span><span class="p">}</span><span class="w"></span>
<span class="w">    </span><span class="bp">self</span><span class="p">.</span><span class="n">elems</span><span class="p">.</span><span class="n">iter</span><span class="p">().</span><span class="n">zip</span><span class="p">(</span><span class="n">other</span><span class="p">.</span><span class="n">elems</span><span class="p">).</span><span class="n">all</span><span class="p">(</span><span class="o">|</span><span class="p">(</span><span class="n">self_elem</span><span class="p">,</span><span class="w"> </span><span class="n">other_elem</span><span class="p">)</span><span class="o">|</span><span class="w"> </span><span class="n">self_elem</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">other_elem</span><span class="p">)</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>
</pre></div>



<a name="156638351"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/156638351" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#156638351">(Jan 22 2019 at 20:51)</a>:</h4>
<p>or </p>
<div class="codehilite"><pre><span></span><span class="k">fn</span> <span class="nf">is_prefix_of</span><span class="p">(</span><span class="o">&amp;</span><span class="bp">self</span><span class="p">,</span><span class="w"> </span><span class="n">other</span>: <span class="kp">&amp;</span><span class="nc">NeoPlace</span><span class="o">&lt;</span><span class="na">&#39;tcx</span><span class="o">&gt;</span><span class="p">)</span><span class="w"> </span>-&gt; <span class="kt">bool</span> <span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="bp">self</span><span class="p">.</span><span class="n">len</span><span class="p">()</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="n">other</span><span class="p">.</span><span class="n">len</span><span class="p">()</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"></span>
<span class="w">    </span><span class="bp">self</span><span class="p">.</span><span class="n">base</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">other</span><span class="p">.</span><span class="n">base</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"></span>
<span class="w">    </span><span class="bp">self</span><span class="p">.</span><span class="n">elems</span><span class="p">.</span><span class="n">iter</span><span class="p">().</span><span class="n">zip</span><span class="p">(</span><span class="n">other</span><span class="p">.</span><span class="n">elems</span><span class="p">).</span><span class="n">all</span><span class="p">(</span><span class="o">|</span><span class="p">(</span><span class="n">self_elem</span><span class="p">,</span><span class="w"> </span><span class="n">other_elem</span><span class="p">)</span><span class="o">|</span><span class="w"> </span><span class="n">self_elem</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">other_elem</span><span class="p">)</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>
</pre></div>



<a name="156638367"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/156638367" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#156638367">(Jan 22 2019 at 20:51)</a>:</h4>
<p>you'd have to modify the trait though, maybe to something like this</p>
<div class="codehilite"><pre><span></span><span class="k">pub</span><span class="w"> </span><span class="k">trait</span><span class="w"> </span><span class="n">IsPrefixOf</span><span class="o">&lt;</span><span class="na">&#39;tcx</span><span class="o">&gt;</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="k">fn</span> <span class="nf">is_prefix_of</span><span class="p">(</span><span class="o">&amp;</span><span class="bp">self</span><span class="p">,</span><span class="w"> </span><span class="n">other</span>: <span class="kp">&amp;</span><span class="nc">Self</span><span class="p">)</span><span class="w"> </span>-&gt; <span class="kt">bool</span><span class="p">;</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>
</pre></div>



<a name="156638388"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/156638388" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#156638388">(Jan 22 2019 at 20:52)</a>:</h4>
<p>the idea is that e.g. <code>a.b</code> is a prefix of <code>a.b.c</code>, right?</p>



<a name="156638442"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/156638442" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Santiago Pastorino <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#156638442">(Jan 22 2019 at 20:52)</a>:</h4>
<p>if that's the implementation I was misunderstanding what was is_prefix_of exactly</p>



<a name="156638478"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/156638478" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#156638478">(Jan 22 2019 at 20:52)</a>:</h4>
<p>I believe that is the idea</p>



<a name="156638502"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/156638502" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Santiago Pastorino <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#156638502">(Jan 22 2019 at 20:53)</a>:</h4>
<p>ahh ya</p>



<a name="156638504"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/156638504" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Santiago Pastorino <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#156638504">(Jan 22 2019 at 20:53)</a>:</h4>
<p>yes</p>



<a name="156638506"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/156638506" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Santiago Pastorino <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#156638506">(Jan 22 2019 at 20:53)</a>:</h4>
<p>so yes</p>



<a name="156638510"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/156638510" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Santiago Pastorino <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#156638510">(Jan 22 2019 at 20:53)</a>:</h4>
<p>I was confused</p>



<a name="156638532"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/156638532" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Santiago Pastorino <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#156638532">(Jan 22 2019 at 20:53)</a>:</h4>
<p>the thing I was trying to implement is way more complicated :)</p>



<a name="156638533"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/156638533" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#156638533">(Jan 22 2019 at 20:53)</a>:</h4>
<p>it's actually a good example for the kind of 'inversion' you have to do</p>



<a name="156638539"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/156638539" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#156638539">(Jan 22 2019 at 20:53)</a>:</h4>
<p>to the existing logic</p>



<a name="156638554"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/156638554" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#156638554">(Jan 22 2019 at 20:53)</a>:</h4>
<p>i.e., the existing code compares from the "end" backwards sort of, but this new code compares <em>forward</em></p>



<a name="156692619"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/156692619" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Santiago Pastorino <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#156692619">(Jan 23 2019 at 14:28)</a>:</h4>
<p><span class="user-mention" data-user-id="116009">@nikomatsakis</span> I've pushed a couple of commits</p>



<a name="156692653"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/156692653" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Santiago Pastorino <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#156692653">(Jan 23 2019 at 14:29)</a>:</h4>
<p>in a while I'm going to check out what happens if I remove <code>Place</code> definition, in order to see if some other usage shows up and share with you to see what strategy may be better to follow</p>



<a name="156705745"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/156705745" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#156705745">(Jan 23 2019 at 17:06)</a>:</h4>
<p><span class="user-mention" data-user-id="116266">@Santiago Pastorino</span> ok. I'll try to be available to answer questions</p>



<a name="156705755"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/156705755" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#156705755">(Jan 23 2019 at 17:07)</a>:</h4>
<p>we could maybe do a brief video chat if we hit some thorny parts</p>



<a name="156705779"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/156705779" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Santiago Pastorino <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#156705779">(Jan 23 2019 at 17:07)</a>:</h4>
<p>that would be great</p>



<a name="156705800"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/156705800" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Santiago Pastorino <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#156705800">(Jan 23 2019 at 17:07)</a>:</h4>
<p>first I've pushed some stuff to the PR, csmoe gave me access</p>



<a name="156705914"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/156705914" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Santiago Pastorino <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#156705914">(Jan 23 2019 at 17:08)</a>:</h4>
<p>then I've removed the old <code>Place</code> and have some errors</p>



<a name="156705952"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/156705952" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#156705952">(Jan 23 2019 at 17:09)</a>:</h4>
<p>I expect quite a few :)</p>



<a name="156706091"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/156706091" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Santiago Pastorino <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#156706091">(Jan 23 2019 at 17:10)</a>:</h4>
<p>yes, I was surprised because I was expecting more</p>



<a name="156706105"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/156706105" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Santiago Pastorino <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#156706105">(Jan 23 2019 at 17:10)</a>:</h4>
<p><code>error: aborting due to 83 previous errors</code></p>



<a name="156706127"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/156706127" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Santiago Pastorino <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#156706127">(Jan 23 2019 at 17:10)</a>:</h4>
<p>let me make a gist with them</p>



<a name="156706159"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/156706159" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Santiago Pastorino <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#156706159">(Jan 23 2019 at 17:11)</a>:</h4>
<p><a href="https://gist.github.com/spastorino/31239f650e52047e9f436c97fa377ebd" target="_blank" title="https://gist.github.com/spastorino/31239f650e52047e9f436c97fa377ebd">https://gist.github.com/spastorino/31239f650e52047e9f436c97fa377ebd</a></p>



<a name="156706203"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/156706203" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Santiago Pastorino <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#156706203">(Jan 23 2019 at 17:11)</a>:</h4>
<p>for instance</p>



<a name="156706209"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/156706209" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Santiago Pastorino <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#156706209">(Jan 23 2019 at 17:12)</a>:</h4>
<p>the ones coming from <code>src/librustc/ich/impls_mir.rs</code> are related to hash stable</p>



<a name="156706292"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/156706292" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#156706292">(Jan 23 2019 at 17:12)</a>:</h4>
<p>k</p>



<a name="156706298"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/156706298" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#156706298">(Jan 23 2019 at 17:12)</a>:</h4>
<p>I have to run out for a bit</p>



<a name="156706329"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/156706329" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Santiago Pastorino <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#156706329">(Jan 23 2019 at 17:12)</a>:</h4>
<p>no worries</p>



<a name="156706333"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/156706333" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Santiago Pastorino <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#156706333">(Jan 23 2019 at 17:13)</a>:</h4>
<p>I will keep this going</p>



<a name="156706342"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/156706342" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Santiago Pastorino <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#156706342">(Jan 23 2019 at 17:13)</a>:</h4>
<p>there's for instance</p>



<a name="156706346"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/156706346" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Santiago Pastorino <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#156706346">(Jan 23 2019 at 17:13)</a>:</h4>
<div class="codehilite"><pre><span></span>impl&lt;&#39;tcx&gt; Place&lt;&#39;tcx&gt; {
    pub fn ty&lt;&#39;a, &#39;gcx, D&gt;(&amp;self, local_decls: &amp;D, tcx: TyCtxt&lt;&#39;a, &#39;gcx, &#39;tcx&gt;) -&gt; PlaceTy&lt;&#39;tcx&gt;
</pre></div>



<a name="156706366"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/156706366" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Santiago Pastorino <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#156706366">(Jan 23 2019 at 17:13)</a>:</h4>
<p>I guess I can just remove that and change to use <code>NeoPlace</code> one and keep that idea going</p>



<a name="156711059"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/156711059" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Matthew Jasper <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#156711059">(Jan 23 2019 at 18:13)</a>:</h4>
<blockquote>
<p>yes, I was surprised because I was expecting more</p>
</blockquote>
<p>That's only the errors in librustc, there will also be errors in librustc_mir and librustc_codegen_ssa once librustc compiles.</p>



<a name="156711127"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/156711127" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Matthew Jasper <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#156711127">(Jan 23 2019 at 18:14)</a>:</h4>
<blockquote>
<p>I guess I can just remove that and change to use <code>NeoPlace</code> one and keep that idea going</p>
</blockquote>
<p>Yes</p>



<a name="156715040"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/156715040" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Santiago Pastorino <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#156715040">(Jan 23 2019 at 19:04)</a>:</h4>
<p>yes, right</p>



<a name="156768754"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/156768754" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> csmoe <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#156768754">(Jan 24 2019 at 12:33)</a>:</h4>
<p>you can check the my previous work as kind of "diff map" <a href="https://github.com/rust-lang/rust/pull/53247/files" target="_blank" title="https://github.com/rust-lang/rust/pull/53247/files">https://github.com/rust-lang/rust/pull/53247/files</a><br>
I replaced the <code>Place</code> with new <code>Place</code> in the whole codebase at once in that PR, and <code>x.py check</code> passed but <code>x.py test</code> failed. that was hard to maintain, so niko suggested current neo_place approach.</p>



<a name="156859727"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/156859727" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Santiago Pastorino <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#156859727">(Jan 25 2019 at 15:23)</a>:</h4>
<p><span class="user-mention" data-user-id="116009">@nikomatsakis</span> just rebased because there were merging conflicts, you can check some of my latest commits in the branch to see if everything is going as you more or less expected</p>



<a name="156863248"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/156863248" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> csmoe <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#156863248">(Jan 25 2019 at 16:14)</a>:</h4>
<p><span class="user-mention" data-user-id="116266">@Santiago Pastorino</span> oops, I had rebased hours ago and made some commits, your force push bypassed the building.(anyway, never mind, I'd recommit later)</p>



<a name="156863885"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/156863885" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Santiago Pastorino <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#156863885">(Jan 25 2019 at 16:22)</a>:</h4>
<p><span class="user-mention" data-user-id="116773">@csmoe</span> it must have been almost simultaneosly</p>



<a name="156863890"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/156863890" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Santiago Pastorino <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#156863890">(Jan 25 2019 at 16:22)</a>:</h4>
<p>because I checked</p>



<a name="156863898"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/156863898" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Santiago Pastorino <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#156863898">(Jan 25 2019 at 16:22)</a>:</h4>
<p>anyway, great that you have your part</p>



<a name="156863924"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/156863924" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Santiago Pastorino <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#156863924">(Jan 25 2019 at 16:23)</a>:</h4>
<p>do you want to pair at some point or something?</p>



<a name="156863933"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/156863933" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Santiago Pastorino <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#156863933">(Jan 25 2019 at 16:23)</a>:</h4>
<p>what are you exactly working on?</p>



<a name="156865902"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/156865902" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> csmoe <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#156865902">(Jan 25 2019 at 16:52)</a>:</h4>
<p>the commits cleaned up all the place in rustc_mir/borrow_check</p>



<a name="156866050"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/156866050" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Santiago Pastorino <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#156866050">(Jan 25 2019 at 16:54)</a>:</h4>
<p>can you rebase now those now and push to <code>place2</code>?</p>



<a name="156866071"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/156866071" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Santiago Pastorino <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#156866071">(Jan 25 2019 at 16:55)</a>:</h4>
<p>or push to a different branch? or even do a push -f with your stuff and I will fix stuff</p>



<a name="156866128"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/156866128" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Santiago Pastorino <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#156866128">(Jan 25 2019 at 16:55)</a>:</h4>
<p><span class="user-mention" data-user-id="116773">@csmoe</span> because I guess we are more or less doing the same stuff :)</p>



<a name="156867504"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/156867504" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> csmoe <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#156867504">(Jan 25 2019 at 17:15)</a>:</h4>
<p><span class="user-mention" data-user-id="116266">@Santiago Pastorino</span> sorry, cannot play with my machine right now, you can just move forward, I'll make the commit track your path.</p>



<a name="156867850"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/156867850" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Santiago Pastorino <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#156867850">(Jan 25 2019 at 17:20)</a>:</h4>
<p>ok :)</p>



<a name="156875854"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/156875854" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#156875854">(Jan 25 2019 at 19:07)</a>:</h4>
<p><span class="user-mention" data-user-id="116773">@csmoe</span> I was tlaking to <span class="user-mention" data-user-id="116266">@Santiago Pastorino</span> about doing a quick meeting sometime next week. If we arrange it, we can either record or perhaps you'll be able to attend</p>



<a name="156876024"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/156876024" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Santiago Pastorino <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#156876024">(Jan 25 2019 at 19:09)</a>:</h4>
<p><span class="user-mention" data-user-id="116773">@csmoe</span> yeah, I've also mentioned that I'd be ok to pair if you want or doing a coding session where you can connect and we can chat or whatever works for you</p>



<a name="156890951"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/156890951" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> csmoe <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#156890951">(Jan 25 2019 at 22:33)</a>:</h4>
<p><span class="user-mention" data-user-id="116009">@nikomatsakis</span> okay, I'll be there.<br>
btw, I wanna express my sincere gratitude to you. I just received an offer as a junior Rust developer. I don't know if you still remember, your <a href="https://twitter.com/nikomatsakis/status/966737996434366464" target="_blank" title="https://twitter.com/nikomatsakis/status/966737996434366464">tweet</a> and the comments in my first pull request gave me a lot of encouragement and confidence. You are my gateway to the Rust and open source world. Thank you</p>
<div class="inline-preview-twitter"><div class="twitter-tweet"><a href="https://twitter.com/nikomatsakis/status/966737996434366464" target="_blank"><img class="twitter-avatar" src="https://pbs.twimg.com/profile_images/1577044478/Me-2011_normal.jpeg"></a><p>I love these kinds of improvements to diagnotics: <a href="https://t.co/uN5yaAN6rQ" target="_blank" title="https://t.co/uN5yaAN6rQ">https://github.com/rust-lang/rust/pull/48198</a> Go csmoe, go!</p><span>- Niko Matsakis (@nikomatsakis)</span></div></div>



<a name="156891613"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/156891613" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Santiago Pastorino <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#156891613">(Jan 25 2019 at 22:43)</a>:</h4>
<p><span aria-label="clap" class="emoji emoji-1f44f" role="img" title="clap">:clap:</span><span aria-label="clap" class="emoji emoji-1f44f" role="img" title="clap">:clap:</span><span aria-label="clap" class="emoji emoji-1f44f" role="img" title="clap">:clap:</span><span aria-label="clap" class="emoji emoji-1f44f" role="img" title="clap">:clap:</span><span aria-label="clap" class="emoji emoji-1f44f" role="img" title="clap">:clap:</span></p>



<a name="156891626"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/156891626" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Santiago Pastorino <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#156891626">(Jan 25 2019 at 22:44)</a>:</h4>
<p><span class="user-mention" data-user-id="116773">@csmoe</span> this is amazing, congrats</p>



<a name="156891792"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/156891792" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> csmoe <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#156891792">(Jan 25 2019 at 22:46)</a>:</h4>
<p><span class="user-mention" data-user-id="116266">@Santiago Pastorino</span> thanks <span aria-label="slight smile" class="emoji emoji-1f642" role="img" title="slight smile">:slight_smile:</span></p>



<a name="156894747"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/156894747" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> lqd <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#156894747">(Jan 25 2019 at 23:37)</a>:</h4>
<p><span class="user-mention" data-user-id="116773">@csmoe</span> oooh awesome, congratulations !</p>



<a name="157053043"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/157053043" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#157053043">(Jan 28 2019 at 19:59)</a>:</h4>
<p><span class="user-mention" data-user-id="116773">@csmoe</span> oh, awesome! congratulations!</p>



<a name="157058264"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/157058264" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Santiago Pastorino <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#157058264">(Jan 28 2019 at 21:16)</a>:</h4>
<p><span class="user-mention" data-user-id="116009">@nikomatsakis</span> you around?</p>



<a name="157058273"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/157058273" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Santiago Pastorino <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#157058273">(Jan 28 2019 at 21:16)</a>:</h4>
<p>unsure if you saw my commits to the PR</p>



<a name="157058277"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/157058277" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#157058277">(Jan 28 2019 at 21:16)</a>:</h4>
<p>I did not see them</p>



<a name="157058289"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/157058289" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Santiago Pastorino <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#157058289">(Jan 28 2019 at 21:17)</a>:</h4>
<p>but I'm now in the point where I need to start changing the visitor and hash_stable</p>



<a name="157058326"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/157058326" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Santiago Pastorino <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#157058326">(Jan 28 2019 at 21:17)</a>:</h4>
<p>the thing is if you start changing things randomly in that area you end changing all the stuff at once</p>



<a name="157058416"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/157058416" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Santiago Pastorino <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#157058416">(Jan 28 2019 at 21:18)</a>:</h4>
<p>I guess I can check if there's some leaf, some place where <code>Place</code> can be replaced with <code>NeoPlace</code> but the rest of the data structures can keep working with <code>Place</code></p>



<a name="157058427"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/157058427" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Santiago Pastorino <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#157058427">(Jan 28 2019 at 21:18)</a>:</h4>
<p>so maybe I'd even need some convertions</p>



<a name="157058457"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/157058457" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Santiago Pastorino <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#157058457">(Jan 28 2019 at 21:19)</a>:</h4>
<p>my guess is that first of all I can move from <code>Place</code> to use <code>NeoPlaceTree</code></p>



<a name="157058478"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/157058478" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Santiago Pastorino <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#157058478">(Jan 28 2019 at 21:19)</a>:</h4>
<p>and in some parts from <code>NeoPlaceTree</code> to use <code>NeoPlace</code> directly</p>



<a name="157058574"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/157058574" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Santiago Pastorino <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#157058574">(Jan 28 2019 at 21:20)</a>:</h4>
<p>and then if someone needs that <code>NeoPlace</code> but accepts a <code>Place</code> which would now be a <code>NeoPlaceTree</code> I can convert between <code>NeoPlace</code> to <code>NeoPlaceTree</code> using the <code>as_tree</code> function</p>



<a name="157058604"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/157058604" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Santiago Pastorino <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#157058604">(Jan 28 2019 at 21:21)</a>:</h4>
<p><span class="user-mention" data-user-id="116009">@nikomatsakis</span> unsure if you understood what I've tried to say because I know that my english was a bit entangled</p>



<a name="157058617"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/157058617" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#157058617">(Jan 28 2019 at 21:21)</a>:</h4>
<p>=)</p>



<a name="157058621"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/157058621" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Santiago Pastorino <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#157058621">(Jan 28 2019 at 21:21)</a>:</h4>
<p>hehe</p>



<a name="157058626"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/157058626" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Santiago Pastorino <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#157058626">(Jan 28 2019 at 21:21)</a>:</h4>
<p>so</p>



<a name="157058629"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/157058629" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Santiago Pastorino <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#157058629">(Jan 28 2019 at 21:22)</a>:</h4>
<p>there's a graph of type dependencies</p>



<a name="157058681"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/157058681" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#157058681">(Jan 28 2019 at 21:22)</a>:</h4>
<p>I confess i'm a bit lost though I think I <em>sort</em> of get the idea :P</p>



<a name="157058690"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/157058690" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Santiago Pastorino <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#157058690">(Jan 28 2019 at 21:22)</a>:</h4>
<p>some needs <code>Place</code></p>



<a name="157058695"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/157058695" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Santiago Pastorino <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#157058695">(Jan 28 2019 at 21:22)</a>:</h4>
<p>and stuff like that</p>



<a name="157058729"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/157058729" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Santiago Pastorino <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#157058729">(Jan 28 2019 at 21:22)</a>:</h4>
<p>my idea is first of all I guess we can remove <code>Place</code> and make that be a <code>NeoPlaceTree</code> which should be a direct thing to do</p>



<a name="157058751"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/157058751" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Santiago Pastorino <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#157058751">(Jan 28 2019 at 21:23)</a>:</h4>
<p>then, slowly replace <code>NeoPlaceTree</code> with <code>NeoPlace</code> in some areas where it's easier, let's say in a leaf of that graph (in a place where nothing else depends on that type)</p>



<a name="157058833"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/157058833" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Santiago Pastorino <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#157058833">(Jan 28 2019 at 21:24)</a>:</h4>
<p>there's a possibility that some other type use that type I've just converted</p>



<a name="157058852"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/157058852" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Santiago Pastorino <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#157058852">(Jan 28 2019 at 21:24)</a>:</h4>
<p>then it will be expecting a <code>NeoPlaceTree</code> but I have a <code>NeoPlace</code></p>



<a name="157058866"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/157058866" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Santiago Pastorino <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#157058866">(Jan 28 2019 at 21:24)</a>:</h4>
<p>then I can keep this idea going by just ... first using <code>as_tree</code></p>



<a name="157058873"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/157058873" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#157058873">(Jan 28 2019 at 21:24)</a>:</h4>
<p>I see</p>



<a name="157058874"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/157058874" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Santiago Pastorino <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#157058874">(Jan 28 2019 at 21:24)</a>:</h4>
<p>and then just making the thing using <code>NeoPlace</code></p>



<a name="157058876"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/157058876" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#157058876">(Jan 28 2019 at 21:24)</a>:</h4>
<p>interesting</p>



<a name="157058885"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/157058885" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Santiago Pastorino <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#157058885">(Jan 28 2019 at 21:24)</a>:</h4>
<p>I guess that idea may work</p>



<a name="157058894"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/157058894" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#157058894">(Jan 28 2019 at 21:24)</a>:</h4>
<p>I'm trying to decide if convering to a <code>NeoPlaceTree</code> is a side-step or worthwhile</p>



<a name="157058907"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/157058907" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#157058907">(Jan 28 2019 at 21:25)</a>:</h4>
<p>i.e., in a way they are equivalent</p>



<a name="157058928"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/157058928" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#157058928">(Jan 28 2019 at 21:25)</a>:</h4>
<p>but I guess yu're right that at least we're down to "two types" somehow :)</p>



<a name="157058943"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/157058943" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Santiago Pastorino <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#157058943">(Jan 28 2019 at 21:25)</a>:</h4>
<p>well, maybe <code>NeoPlaceTree</code> should just be <code>Place</code> :)</p>



<a name="157058944"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/157058944" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#157058944">(Jan 28 2019 at 21:25)</a>:</h4>
<p>and because convering from <code>NeoPlace</code> to <code>NeoPlaceTree</code> sort of exists</p>



<a name="157058954"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/157058954" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#157058954">(Jan 28 2019 at 21:25)</a>:</h4>
<p>yeah, that's something I was debating :)</p>



<a name="157058995"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/157058995" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#157058995">(Jan 28 2019 at 21:26)</a>:</h4>
<p>I mean, we could certainly write the code to conver from <code>NeoPlace</code> to <code>Place</code></p>



<a name="157058998"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/157058998" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Santiago Pastorino <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#157058998">(Jan 28 2019 at 21:26)</a>:</h4>
<p>we can remove <code>NeoPlaceTree</code> and make the function return <code>Place</code></p>



<a name="157059003"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/157059003" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#157059003">(Jan 28 2019 at 21:26)</a>:</h4>
<p>merge neo-place-tree and place, somehow</p>



<a name="157059004"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/157059004" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Santiago Pastorino <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#157059004">(Jan 28 2019 at 21:26)</a>:</h4>
<p>yeah</p>



<a name="157059009"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/157059009" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#157059009">(Jan 28 2019 at 21:26)</a>:</h4>
<p>and then try to switch the code that creates places</p>



<a name="157059010"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/157059010" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#157059010">(Jan 28 2019 at 21:26)</a>:</h4>
<p>to create neo-places</p>



<a name="157059013"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/157059013" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Santiago Pastorino <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#157059013">(Jan 28 2019 at 21:26)</a>:</h4>
<p>isn't exactly the same type with a different name?</p>



<a name="157059017"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/157059017" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#157059017">(Jan 28 2019 at 21:26)</a>:</h4>
<p>and convert back to place at each consumer point</p>



<a name="157059024"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/157059024" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#157059024">(Jan 28 2019 at 21:26)</a>:</h4>
<p>I think it's more-or-less the same type, yes</p>



<a name="157059029"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/157059029" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#157059029">(Jan 28 2019 at 21:26)</a>:</h4>
<p>there may be some minor difference</p>



<a name="157059030"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/157059030" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Santiago Pastorino <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#157059030">(Jan 28 2019 at 21:26)</a>:</h4>
<p>ok</p>



<a name="157059035"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/157059035" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#157059035">(Jan 28 2019 at 21:26)</a>:</h4>
<p>I forget exactly how <code>Place</code> is formulated</p>



<a name="157059043"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/157059043" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Santiago Pastorino <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#157059043">(Jan 28 2019 at 21:26)</a>:</h4>
<p>going to try something like that out</p>



<a name="157059051"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/157059051" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Santiago Pastorino <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#157059051">(Jan 28 2019 at 21:27)</a>:</h4>
<p>when you can check the PR</p>



<a name="157059066"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/157059066" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Santiago Pastorino <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#157059066">(Jan 28 2019 at 21:27)</a>:</h4>
<p>it's probably a very quick thing to do because most of the commits are self explanatory</p>



<a name="157059075"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/157059075" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Santiago Pastorino <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#157059075">(Jan 28 2019 at 21:27)</a>:</h4>
<p>and very mechanical code</p>



<a name="157059097"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/157059097" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Santiago Pastorino <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#157059097">(Jan 28 2019 at 21:27)</a>:</h4>
<p>would be a good way to validate if what I did is more or less what you were expecting</p>



<a name="157059212"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/157059212" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#157059212">(Jan 28 2019 at 21:29)</a>:</h4>
<p>ok</p>



<a name="157116092"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/157116092" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#157116092">(Jan 29 2019 at 16:18)</a>:</h4>
<p><span class="user-mention" data-user-id="116266">@Santiago Pastorino</span> <a href="https://zoom.us/j/432921624" target="_blank" title="https://zoom.us/j/432921624">https://zoom.us/j/432921624</a></p>



<a name="157120275"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/157120275" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#157120275">(Jan 29 2019 at 17:13)</a>:</h4>
<p>So <span class="user-mention" data-user-id="116773">@csmoe</span>, <span class="user-mention" data-user-id="116266">@Santiago Pastorino</span> and I were chatting a bit</p>



<a name="157120288"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/157120288" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#157120288">(Jan 29 2019 at 17:13)</a>:</h4>
<p>I think in the end we decided a few things</p>



<a name="157120304"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/157120304" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#157120304">(Jan 29 2019 at 17:13)</a>:</h4>
<p>as an immediate way forward, we can create a function that builds a <code>Place</code> from a <code>NeoPlace</code></p>



<a name="157120309"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/157120309" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#157120309">(Jan 29 2019 at 17:13)</a>:</h4>
<p>we can then convert the MIR IR to store <code>NeoPlace</code></p>



<a name="157120323"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/157120323" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#157120323">(Jan 29 2019 at 17:13)</a>:</h4>
<p>we do NOT modify the builder OR the (remaining) analyses at this time</p>



<a name="157120372"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/157120372" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#157120372">(Jan 29 2019 at 17:14)</a>:</h4>
<p>instead, we take the Place that the builder makes now and convert it to neo-place</p>



<a name="157120375"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/157120375" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#157120375">(Jan 29 2019 at 17:14)</a>:</h4>
<p>then convert back at the consumer</p>



<a name="157120384"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/157120384" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#157120384">(Jan 29 2019 at 17:14)</a>:</h4>
<p>this is kind of a "no-op"</p>



<a name="157120396"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/157120396" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#157120396">(Jan 29 2019 at 17:14)</a>:</h4>
<p>but once it is done, we can convert the builder and analyses independently</p>



<a name="157120399"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/157120399" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#157120399">(Jan 29 2019 at 17:14)</a>:</h4>
<p>and everything should keep working</p>



<a name="157120408"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/157120408" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#157120408">(Jan 29 2019 at 17:14)</a>:</h4>
<p>however, I did want to raise a concern :)</p>



<a name="157120416"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/157120416" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#157120416">(Jan 29 2019 at 17:14)</a>:</h4>
<p>notably, I expect us to talk over changes to MIR at the all hands</p>



<a name="157120421"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/157120421" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#157120421">(Jan 29 2019 at 17:14)</a>:</h4>
<p>I think this change will be a part of it</p>



<a name="157120425"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/157120425" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#157120425">(Jan 29 2019 at 17:14)</a>:</h4>
<p>but it may be that the branch winds up kind of outdated</p>



<a name="157120454"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/157120454" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#157120454">(Jan 29 2019 at 17:15)</a>:</h4>
<p>we'll see, but I wanted to raise the possibility that the branch will never land :'(</p>



<a name="157120476"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/157120476" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#157120476">(Jan 29 2019 at 17:15)</a>:</h4>
<p>(though my take is sort of "that happens" -- a lot of experimental branches like this never land, but instead become the foundation for a new approach)</p>



<a name="157124203"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/157124203" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Santiago Pastorino <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#157124203">(Jan 29 2019 at 18:02)</a>:</h4>
<p>as I said on zoom, this is fine for me and a learning experience anyway</p>



<a name="157124234"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/157124234" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Santiago Pastorino <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#157124234">(Jan 29 2019 at 18:03)</a>:</h4>
<p>and also the way to go, if the task is kind of exploratory the result may be worse than the actual code or as you said it could even be that we realize of a better approach</p>



<a name="157162491"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/157162491" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> csmoe <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#157162491">(Jan 30 2019 at 04:47)</a>:</h4>
<p><span class="user-mention" data-user-id="116009">@nikomatsakis</span> <span class="user-mention" data-user-id="116266">@Santiago Pastorino</span>  gotcha</p>



<a name="157185451"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/157185451" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Santiago Pastorino <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#157185451">(Jan 30 2019 at 13:08)</a>:</h4>
<p>I'm replacing <code>Place</code> with <code>NeoPlace</code> in some parts of the code</p>



<a name="157185460"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/157185460" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Santiago Pastorino <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#157185460">(Jan 30 2019 at 13:08)</a>:</h4>
<p>in particular, <code>Place</code> derives <code>RustcEncodable</code></p>



<a name="157185465"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/157185465" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Santiago Pastorino <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#157185465">(Jan 30 2019 at 13:08)</a>:</h4>
<p>I need to make <code>NeoPlace</code> derive it too</p>



<a name="157185469"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/157185469" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pnkfelix <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#157185469">(Jan 30 2019 at 13:08)</a>:</h4>
<p>or at least implement it</p>



<a name="157185476"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/157185476" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Santiago Pastorino <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#157185476">(Jan 30 2019 at 13:08)</a>:</h4>
<p>yep</p>



<a name="157185493"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/157185493" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pnkfelix <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#157185493">(Jan 30 2019 at 13:09)</a>:</h4>
<p>can you just implement it by hand and have it work by converting into a <code>Place</code> and then calling the encode method on that?</p>



<a name="157185500"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/157185500" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Santiago Pastorino <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#157185500">(Jan 30 2019 at 13:09)</a>:</h4>
<p>the problem is that <code>NeoPlace</code>'s <code>elem</code> field is <code>&amp;'tcx [PlaceElem&lt;'tcx&gt;]</code></p>



<a name="157185503"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/157185503" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pnkfelix <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#157185503">(Jan 30 2019 at 13:09)</a>:</h4>
<p>oh</p>



<a name="157185511"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/157185511" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pnkfelix <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#157185511">(Jan 30 2019 at 13:09)</a>:</h4>
<p>well</p>



<a name="157185515"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/157185515" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Santiago Pastorino <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#157185515">(Jan 30 2019 at 13:09)</a>:</h4>
<p>so I'd need ...</p>



<a name="157185517"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/157185517" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Santiago Pastorino <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#157185517">(Jan 30 2019 at 13:09)</a>:</h4>
<p><code>impl&lt;'tcx&gt; serialize::UseSpecializedDecodable for &amp;'tcx [PlaceElem&lt;'tcx&gt;] {</code></p>



<a name="157185518"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/157185518" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pnkfelix <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#157185518">(Jan 30 2019 at 13:09)</a>:</h4>
<p>/me goes to double-check API of Encodeable</p>



<a name="157185521"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/157185521" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Santiago Pastorino <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#157185521">(Jan 30 2019 at 13:09)</a>:</h4>
<p>the question is ...</p>



<a name="157185526"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/157185526" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Santiago Pastorino <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#157185526">(Jan 30 2019 at 13:09)</a>:</h4>
<p>exactly</p>



<a name="157185579"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/157185579" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Santiago Pastorino <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#157185579">(Jan 30 2019 at 13:10)</a>:</h4>
<p>where do I find some information about all that</p>



<a name="157185585"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/157185585" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Santiago Pastorino <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#157185585">(Jan 30 2019 at 13:10)</a>:</h4>
<p>trying to search for Encodable right now</p>



<a name="157185591"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/157185591" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pnkfelix <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#157185591">(Jan 30 2019 at 13:10)</a>:</h4>
<p><a href="https://docs.rs/rustc-serialize/0.3.24/rustc_serialize/trait.Encodable.html" target="_blank" title="https://docs.rs/rustc-serialize/0.3.24/rustc_serialize/trait.Encodable.html">https://docs.rs/rustc-serialize/0.3.24/rustc_serialize/trait.Encodable.html</a> right?</p>



<a name="157185596"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/157185596" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Santiago Pastorino <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#157185596">(Jan 30 2019 at 13:10)</a>:</h4>
<p>but related to <code>UseSpecializedDecodable</code> doesn't seem to be that much info</p>



<a name="157185634"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/157185634" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Santiago Pastorino <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#157185634">(Jan 30 2019 at 13:11)</a>:</h4>
<blockquote>
<p><a href="https://docs.rs/rustc-serialize/0.3.24/rustc_serialize/trait.Encodable.html" target="_blank" title="https://docs.rs/rustc-serialize/0.3.24/rustc_serialize/trait.Encodable.html">https://docs.rs/rustc-serialize/0.3.24/rustc_serialize/trait.Encodable.html</a> right?</p>
</blockquote>
<p>well I see that, but what about <code>UseSpecializedDecodable</code></p>



<a name="157185635"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/157185635" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pnkfelix <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#157185635">(Jan 30 2019 at 13:11)</a>:</h4>
<p>I might be looking at the wrong thing anyway</p>



<a name="157185652"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/157185652" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Santiago Pastorino <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#157185652">(Jan 30 2019 at 13:11)</a>:</h4>
<p>and why I see a lot of things implementing that with empty bodies</p>



<a name="157185733"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/157185733" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pnkfelix <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#157185733">(Jan 30 2019 at 13:13)</a>:</h4>
<p>do they have attributes? its possible proc-macros are injecting the actual code</p>



<a name="157185747"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/157185747" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pnkfelix <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#157185747">(Jan 30 2019 at 13:13)</a>:</h4>
<p>/me switches to looking at actual code</p>



<a name="157185812"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/157185812" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Santiago Pastorino <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#157185812">(Jan 30 2019 at 13:14)</a>:</h4>
<div class="codehilite"><pre><span></span>src/librustc/hir/def_id.rs
98:impl serialize::UseSpecializedDecodable for CrateNum {}
190:impl serialize::UseSpecializedDecodable for DefIndex {}
258:impl serialize::UseSpecializedDecodable for DefId {}
292:impl serialize::UseSpecializedDecodable for LocalDefId {}
</pre></div>



<a name="157185861"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/157185861" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pnkfelix <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#157185861">(Jan 30 2019 at 13:15)</a>:</h4>
<p>okay so the relevant code for the API's here is in <code>src/libserialize/</code></p>



<a name="157185864"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/157185864" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Santiago Pastorino <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#157185864">(Jan 30 2019 at 13:15)</a>:</h4>
<p>I guess I can do something like ...</p>



<a name="157186090"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/157186090" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Santiago Pastorino <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#157186090">(Jan 30 2019 at 13:19)</a>:</h4>
<div class="codehilite"><pre><span></span><span class="k">impl</span><span class="w"> </span><span class="n">serialize</span>::<span class="n">UseSpecializedDecodable</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">HirId</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="k">fn</span> <span class="nf">default_decode</span><span class="o">&lt;</span><span class="n">D</span>: <span class="nc">Decoder</span><span class="o">&gt;</span><span class="p">(</span><span class="n">d</span>: <span class="kp">&amp;</span><span class="nc">mut</span><span class="w"> </span><span class="n">D</span><span class="p">)</span><span class="w"> </span>-&gt; <span class="nb">Result</span><span class="o">&lt;</span><span class="n">HirId</span><span class="p">,</span><span class="w"> </span><span class="n">D</span>::<span class="n">Error</span><span class="o">&gt;</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">        </span><span class="kd">let</span><span class="w"> </span><span class="n">owner</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">DefIndex</span>::<span class="n">decode</span><span class="p">(</span><span class="n">d</span><span class="p">)</span><span class="o">?</span><span class="p">;</span><span class="w"></span>
<span class="w">        </span><span class="kd">let</span><span class="w"> </span><span class="n">local_id</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ItemLocalId</span>::<span class="n">decode</span><span class="p">(</span><span class="n">d</span><span class="p">)</span><span class="o">?</span><span class="p">;</span><span class="w"></span>

<span class="w">        </span><span class="nb">Ok</span><span class="p">(</span><span class="n">HirId</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">            </span><span class="n">owner</span><span class="p">,</span><span class="w"></span>
<span class="w">            </span><span class="n">local_id</span><span class="w"></span>
<span class="w">        </span><span class="p">})</span><span class="w"></span>
<span class="w">    </span><span class="p">}</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>
</pre></div>



<a name="157186092"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/157186092" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Santiago Pastorino <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#157186092">(Jan 30 2019 at 13:19)</a>:</h4>
<p>but for my types</p>



<a name="157186094"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/157186094" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pnkfelix <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#157186094">(Jan 30 2019 at 13:19)</a>:</h4>
<p>By the way, what happens if you just try to make <code>NeoPlace</code> derive <code>RustcEncodeable</code> and <code>RustcDecodable</code> ?</p>



<a name="157186138"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/157186138" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Santiago Pastorino <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#157186138">(Jan 30 2019 at 13:20)</a>:</h4>
<div class="codehilite"><pre><span></span>error[E0277]: the trait bound `&amp;[mir::ProjectionElem&lt;&#39;_, mir::Local, &amp;ty::TyS&lt;&#39;_&gt;&gt;]: serialize::UseSpecializedDecodable` is not satisfied
    --&gt; src/librustc/mir/mod.rs:1910:61
     |
1910 | #[derive(Clone, Debug, PartialEq, Eq, Hash, RustcEncodable, RustcDecodable)]
     |                                                             ^^^^^^^^^^^^^^ the trait `serialize::UseSpecializedDecodable` is not implemented for `&amp;[mir::ProjectionElem&lt;&#39;
_, mir::Local, &amp;ty::TyS&lt;&#39;_&gt;&gt;]`
     |
     = note: required because of the requirements on the impl of `serialize::Decodable` for `&amp;[mir::ProjectionElem&lt;&#39;_, mir::Local, &amp;ty::TyS&lt;&#39;_&gt;&gt;]`
     = note: required by `serialize::Decodable::decode`
</pre></div>



<a name="157186174"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/157186174" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Santiago Pastorino <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#157186174">(Jan 30 2019 at 13:20)</a>:</h4>
<p>sorry</p>



<a name="157186180"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/157186180" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Santiago Pastorino <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#157186180">(Jan 30 2019 at 13:20)</a>:</h4>
<p>not that error</p>



<a name="157186204"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/157186204" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Santiago Pastorino <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#157186204">(Jan 30 2019 at 13:20)</a>:</h4>
<p>that error :)</p>



<a name="157186215"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/157186215" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pnkfelix <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#157186215">(Jan 30 2019 at 13:21)</a>:</h4>
<p>hmm</p>



<a name="157186275"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/157186275" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pnkfelix <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#157186275">(Jan 30 2019 at 13:22)</a>:</h4>
<p>I suppose if I read sufficient backlog, I'd learn why <code>NeoPlace</code> carries a slice rather than a <code>Vec</code> ?</p>



<a name="157186463"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/157186463" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Santiago Pastorino <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#157186463">(Jan 30 2019 at 13:24)</a>:</h4>
<p>:)</p>



<a name="157186479"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/157186479" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Santiago Pastorino <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#157186479">(Jan 30 2019 at 13:25)</a>:</h4>
<p>good question</p>



<a name="157186494"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/157186494" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Santiago Pastorino <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#157186494">(Jan 30 2019 at 13:25)</a>:</h4>
<p>Niko and csmoe did that</p>



<a name="157186585"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/157186585" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pnkfelix <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#157186585">(Jan 30 2019 at 13:27)</a>:</h4>
<p>(even so, i'd be tempted, based on this problem, to use a cow-slice, i.e. <code>Cow&lt;'tcx, [PlaceElem&lt;'tcx&gt;]&gt;</code>... but I also am now curious how other code is handling decoding of non-slice references. Must be interning or something.)</p>



<a name="157186674"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/157186674" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pnkfelix <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#157186674">(Jan 30 2019 at 13:29)</a>:</h4>
<p>ah okay I'm starting to understand</p>



<a name="157186708"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/157186708" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pnkfelix <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#157186708">(Jan 30 2019 at 13:29)</a>:</h4>
<p>the whole <code>UseSpecialized*</code> stuff is precisely to hook into specialized decoders for reference types</p>



<a name="157186807"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/157186807" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pnkfelix <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#157186807">(Jan 30 2019 at 13:31)</a>:</h4>
<p>start reading from this line: <a href="https://github.com/rust-lang/rust/blob/master/src/libserialize/serialize.rs#L846" target="_blank" title="https://github.com/rust-lang/rust/blob/master/src/libserialize/serialize.rs#L846">https://github.com/rust-lang/rust/blob/master/src/libserialize/serialize.rs#L846</a></p>



<a name="157186870"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/157186870" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pnkfelix <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#157186870">(Jan 30 2019 at 13:32)</a>:</h4>
<p>the empty impls you are seeing are markers  allowing this impl to trigger: <a href="https://github.com/rust-lang/rust/blob/master/src/libserialize/serialize.rs#L898" target="_blank" title="https://github.com/rust-lang/rust/blob/master/src/libserialize/serialize.rs#L898">https://github.com/rust-lang/rust/blob/master/src/libserialize/serialize.rs#L898</a></p>



<a name="157186914"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/157186914" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Santiago Pastorino <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#157186914">(Jan 30 2019 at 13:33)</a>:</h4>
<p>ok</p>



<a name="157186929"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/157186929" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Santiago Pastorino <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#157186929">(Jan 30 2019 at 13:33)</a>:</h4>
<p>will be back in a bit</p>



<a name="157186936"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/157186936" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Santiago Pastorino <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#157186936">(Jan 30 2019 at 13:34)</a>:</h4>
<p>thanks for the info</p>



<a name="157187086"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/157187086" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pnkfelix <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#157187086">(Jan 30 2019 at 13:35)</a>:</h4>
<p>which then allow the specialized decoders to trigger, like this one: <a href="https://github.com/rust-lang/rust/blob/master/src/librustc/ty/codec.rs#L369" target="_blank" title="https://github.com/rust-lang/rust/blob/master/src/librustc/ty/codec.rs#L369">https://github.com/rust-lang/rust/blob/master/src/librustc/ty/codec.rs#L369</a> (with actual code here <a href="https://github.com/rust-lang/rust/blob/master/src/librustc/ty/codec.rs#L216" target="_blank" title="https://github.com/rust-lang/rust/blob/master/src/librustc/ty/codec.rs#L216">https://github.com/rust-lang/rust/blob/master/src/librustc/ty/codec.rs#L216</a> )</p>



<a name="157190716"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/157190716" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Santiago Pastorino <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#157190716">(Jan 30 2019 at 14:31)</a>:</h4>
<p>back</p>



<a name="157190721"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/157190721" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Santiago Pastorino <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#157190721">(Jan 30 2019 at 14:32)</a>:</h4>
<p>I'm getting this</p>



<a name="157190761"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/157190761" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Santiago Pastorino <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#157190761">(Jan 30 2019 at 14:32)</a>:</h4>
<div class="codehilite"><pre><span></span>error[E0117]: only traits defined in the current crate can be implemented for arbitrary types
    --&gt; src/librustc/mir/mod.rs:3531:1
     |
3531 | impl&lt;&#39;tcx&gt; serialize::UseSpecializedDecodable for &amp;&#39;tcx [PlaceElem&lt;&#39;tcx&gt;] {}
     | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ impl doesn&#39;t use types inside crate
     |
     = note: the impl does not reference any types defined in this crate
     = note: define and implement a trait or new type instead
</pre></div>



<a name="157190778"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/157190778" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Santiago Pastorino <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#157190778">(Jan 30 2019 at 14:32)</a>:</h4>
<p>unsure why because I'm doing so in the place where <code>PlaceElem</code> is defined there</p>



<a name="157192221"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/157192221" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Santiago Pastorino <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#157192221">(Jan 30 2019 at 14:51)</a>:</h4>
<p>and also this ...</p>



<a name="157192241"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/157192241" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Santiago Pastorino <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#157192241">(Jan 30 2019 at 14:51)</a>:</h4>
<div class="codehilite"><pre><span></span>impl&lt;&#39;tcx&gt; serialize::UseSpecializedEncodable for &amp;&#39;tcx [PlaceElem&lt;&#39;tcx&gt;] {}
impl&lt;&#39;tcx&gt; serialize::UseSpecializedDecodable for &amp;&#39;tcx [PlaceElem&lt;&#39;tcx&gt;] {}
</pre></div>



<a name="157192250"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/157192250" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Santiago Pastorino <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#157192250">(Jan 30 2019 at 14:51)</a>:</h4>
<p>exist in the same file</p>



<a name="157194667"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/157194667" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Santiago Pastorino <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#157194667">(Jan 30 2019 at 15:20)</a>:</h4>
<p>the problem is with the slice, I guess, because <code>PlaceElem</code> is defined in the crate but <code>&amp;[PlaceElem]</code> is not</p>



<a name="157194680"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/157194680" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Santiago Pastorino <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#157194680">(Jan 30 2019 at 15:20)</a>:</h4>
<p>unsure how to fix this exactly</p>



<a name="157194691"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/157194691" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Santiago Pastorino <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#157194691">(Jan 30 2019 at 15:21)</a>:</h4>
<p><span class="user-mention" data-user-id="116083">@pnkfelix</span> ^^^</p>



<a name="157194712"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/157194712" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pnkfelix <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#157194712">(Jan 30 2019 at 15:21)</a>:</h4>
<p>Personally I think your best bet is to not attempt to use a slice at all here</p>



<a name="157194720"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/157194720" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Santiago Pastorino <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#157194720">(Jan 30 2019 at 15:21)</a>:</h4>
<p>I guess I can wrap the type</p>



<a name="157194733"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/157194733" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Santiago Pastorino <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#157194733">(Jan 30 2019 at 15:21)</a>:</h4>
<p>ok</p>



<a name="157194781"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/157194781" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pnkfelix <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#157194781">(Jan 30 2019 at 15:22)</a>:</h4>
<p>Okay well that's another short-term option</p>



<a name="157194782"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/157194782" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Santiago Pastorino <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#157194782">(Jan 30 2019 at 15:22)</a>:</h4>
<p>I guess I can change to <code>Vec</code> and move forward</p>



<a name="157194799"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/157194799" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Santiago Pastorino <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#157194799">(Jan 30 2019 at 15:22)</a>:</h4>
<p>hmm yeah</p>



<a name="157194846"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/157194846" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pnkfelix <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#157194846">(Jan 30 2019 at 15:23)</a>:</h4>
<p>You can either commit to <code>Vec</code>, or if you're nervous about that, you could use <code>Cow&lt;'tcx, [PlaceElem]&gt;</code>. From what I skimmed earlier, it seemed like <code>Cow&lt;[T]&gt;</code> would be supported in serialization contexts where you might have wanted to use <code>&amp;[T]</code>.</p>



<a name="157194896"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/157194896" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pnkfelix <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#157194896">(Jan 30 2019 at 15:24)</a>:</h4>
<p>(But if you're already going to go through the effort of changing the type, you probably can just go with <code>Vec</code> and just check with <span class="user-mention" data-user-id="116773">@csmoe</span> and/or <span class="user-mention" data-user-id="116009">@nikomatsakis</span> later to find out whether they had a strong motivation for using a slice here.</p>



<a name="157195267"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/157195267" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> csmoe <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#157195267">(Jan 30 2019 at 15:28)</a>:</h4>
<blockquote>
<p>I guess I can change to <code>Vec</code> and move forward</p>
</blockquote>
<p><span class="user-mention" data-user-id="116266">@Santiago Pastorino</span> consider <code>List</code></p>



<a name="157195715"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/157195715" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> csmoe <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#157195715">(Jan 30 2019 at 15:34)</a>:</h4>
<p>my original implementation of elems copied the approach from existential code base as <a href="https://github.com/rust-lang/rust/blob/43b4c4a36b6c189bf0718a9d77ff1164c3fa7cac/src/librustc/ty/context.rs#L126" target="_blank" title="https://github.com/rust-lang/rust/blob/43b4c4a36b6c189bf0718a9d77ff1164c3fa7cac/src/librustc/ty/context.rs#L126">https://github.com/rust-lang/rust/blob/43b4c4a36b6c189bf0718a9d77ff1164c3fa7cac/src/librustc/ty/context.rs#L126</a></p>



<a name="157195783"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/157195783" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pnkfelix <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#157195783">(Jan 30 2019 at 15:35)</a>:</h4>
<p>but we don't currently use that elsewhere in <em>MIR</em> ...</p>



<a name="157195837"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/157195837" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> csmoe <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#157195837">(Jan 30 2019 at 15:36)</a>:</h4>
<p>but <span class="user-mention" data-user-id="116009">@nikomatsakis</span> changed to <code>&amp;[...]</code> days ago <a href="https://github.com/rust-lang/rust/pull/54426/commits/6eb57e9fc4fcd132450ed8e3603b96ef0fcc4aff" target="_blank" title="https://github.com/rust-lang/rust/pull/54426/commits/6eb57e9fc4fcd132450ed8e3603b96ef0fcc4aff">https://github.com/rust-lang/rust/pull/54426/commits/6eb57e9fc4fcd132450ed8e3603b96ef0fcc4aff</a></p>



<a name="157195889"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/157195889" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pnkfelix <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#157195889">(Jan 30 2019 at 15:37)</a>:</h4>
<p>hmm. Okay then. That serves as a hint that <span class="user-mention" data-user-id="116009">@nikomatsakis</span> in fact <em>did</em> intend to <code>impl&lt;'tcx&gt; serialize::UseSpecializedDecodable for &amp;'tcx List&lt;PlaceElem&lt;'tcx&gt;&gt;</code></p>



<a name="157195897"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/157195897" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pnkfelix <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#157195897">(Jan 30 2019 at 15:37)</a>:</h4>
<p>It looks like a rats nest to me, but whatever.</p>



<a name="157195933"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/157195933" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pnkfelix <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#157195933">(Jan 30 2019 at 15:38)</a>:</h4>
<p>( if we expect lots of sharing between <code>Places</code> then a slice makes sense. I just haven't seen what the MIR tree structures look like yet.)</p>



<a name="157196010"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/157196010" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pnkfelix <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#157196010">(Jan 30 2019 at 15:38)</a>:</h4>
<blockquote>
<p>hmm. Okay then. That serves as a hint that <span class="user-mention silent" data-user-id="116009">@nikomatsakis</span> in fact <em>did</em> intend to <code>impl&lt;'tcx&gt; serialize::UseSpecializedDecodable for &amp;'tcx List&lt;PlaceElem&lt;'tcx&gt;&gt;</code></p>
</blockquote>
<p>oh, no, that's me misreading the code/commit</p>



<a name="157201785"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/157201785" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Santiago Pastorino <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#157201785">(Jan 30 2019 at 16:53)</a>:</h4>
<p>actually the wrapper doesn't make any sense :)</p>



<a name="157201804"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/157201804" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Santiago Pastorino <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#157201804">(Jan 30 2019 at 16:53)</a>:</h4>
<p>NeoPlace can work already as a wrapper</p>



<a name="157201818"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/157201818" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Santiago Pastorino <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#157201818">(Jan 30 2019 at 16:53)</a>:</h4>
<p>the thing is that I guess I need to just implement the decode API on <code>NeoPlace</code></p>



<a name="157217536"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/157217536" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#157217536">(Jan 30 2019 at 20:08)</a>:</h4>
<blockquote>
<p>I suppose if I read sufficient backlog, I'd learn why <code>NeoPlace</code> carries a slice rather than a <code>Vec</code> ?</p>
</blockquote>
<p>we want a slice -- the decoder can do the interning</p>



<a name="157217549"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/157217549" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#157217549">(Jan 30 2019 at 20:08)</a>:</h4>
<p>the reason we want a slice is so that we can make subslices :)</p>



<a name="157217563"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/157217563" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#157217563">(Jan 30 2019 at 20:08)</a>:</h4>
<p>we used to, however, use the <code>List</code> type, which kind of handled this for us, but that was a bit too restrictive</p>



<a name="157217588"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/157217588" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#157217588">(Jan 30 2019 at 20:09)</a>:</h4>
<p>I have to refresh my memory how this works</p>



<a name="157217661"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/157217661" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Santiago Pastorino <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#157217661">(Jan 30 2019 at 20:09)</a>:</h4>
<p>hmm :)</p>



<a name="157217664"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/157217664" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Santiago Pastorino <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#157217664">(Jan 30 2019 at 20:10)</a>:</h4>
<p>ok</p>



<a name="157217757"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/157217757" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Santiago Pastorino <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#157217757">(Jan 30 2019 at 20:10)</a>:</h4>
<p>I'm not sure how the serializer API works</p>



<a name="157217767"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/157217767" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Santiago Pastorino <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#157217767">(Jan 30 2019 at 20:11)</a>:</h4>
<p>searching ...</p>



<a name="157218014"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/157218014" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#157218014">(Jan 30 2019 at 20:14)</a>:</h4>
<p>ok ok</p>



<a name="157218017"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/157218017" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#157218017">(Jan 30 2019 at 20:14)</a>:</h4>
<p>I remember now</p>



<a name="157218036"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/157218036" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#157218036">(Jan 30 2019 at 20:14)</a>:</h4>
<p>so <span class="user-mention" data-user-id="116266">@Santiago Pastorino</span> this is a bit of a kludge</p>



<a name="157218052"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/157218052" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#157218052">(Jan 30 2019 at 20:14)</a>:</h4>
<p>(it's also one of the places that rustc is relying on an unsoundness in Rust)</p>



<a name="157218059"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/157218059" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#157218059">(Jan 30 2019 at 20:14)</a>:</h4>
<p>(but never mind that now)</p>



<a name="157218076"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/157218076" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#157218076">(Jan 30 2019 at 20:14)</a>:</h4>
<p>I'm pondering whether to leave some of these notes in a form that could become a rustc-guide chapter</p>



<a name="157218108"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/157218108" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Santiago Pastorino <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#157218108">(Jan 30 2019 at 20:15)</a>:</h4>
<p>:)</p>



<a name="157218129"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/157218129" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Santiago Pastorino <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#157218129">(Jan 30 2019 at 20:15)</a>:</h4>
<p>so I'm also a bit confused about libserialize and friends</p>



<a name="157218132"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/157218132" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#157218132">(Jan 30 2019 at 20:15)</a>:</h4>
<p>So, we have this <code>Deserialize</code> trait</p>



<a name="157218191"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/157218191" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#157218191">(Jan 30 2019 at 20:16)</a>:</h4>
<p>er, sorr</p>



<a name="157218193"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/157218193" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#157218193">(Jan 30 2019 at 20:16)</a>:</h4>
<p><code>Decodable</code></p>



<a name="157218240"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/157218240" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Santiago Pastorino <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#157218240">(Jan 30 2019 at 20:16)</a>:</h4>
<p>my guess is that I need to implement <code>Decodable</code> for <code>NeoPlace</code></p>



<a name="157218249"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/157218249" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#157218249">(Jan 30 2019 at 20:16)</a>:</h4>
<p>trying to decide just where to start</p>



<a name="157218252"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/157218252" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#157218252">(Jan 30 2019 at 20:16)</a>:</h4>
<p>no, that's not true</p>



<a name="157218255"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/157218255" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#157218255">(Jan 30 2019 at 20:16)</a>:</h4>
<p>I mean, you do, but not directly</p>



<a name="157218256"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/157218256" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Santiago Pastorino <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#157218256">(Jan 30 2019 at 20:16)</a>:</h4>
<p>but confused, the errors lead me .... ok</p>



<a name="157218273"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/157218273" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#157218273">(Jan 30 2019 at 20:17)</a>:</h4>
<p>so the problem is this: </p>
<p>In order to deseriable a <code>NeoPlace</code>, you need access to a <code>tcx</code></p>



<a name="157218285"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/157218285" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Santiago Pastorino <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#157218285">(Jan 30 2019 at 20:17)</a>:</h4>
<p>yep to intern</p>



<a name="157218291"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/157218291" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#157218291">(Jan 30 2019 at 20:17)</a>:</h4>
<p>you can get that, in theory, be invoking a method from on the "decoder" that is given to you</p>



<a name="157218307"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/157218307" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Santiago Pastorino <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#157218307">(Jan 30 2019 at 20:17)</a>:</h4>
<p>and also, elems is &amp;[]</p>



<a name="157218363"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/157218363" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#157218363">(Jan 30 2019 at 20:18)</a>:</h4>
<p>because — in practice — this Decoder will be some type that implements <code>TyDecoder</code>:</p>
<div class="codehilite"><pre><span></span><span class="c1">// src/librustc/ty/codec.rs</span>
<span class="k">pub</span><span class="w"> </span><span class="k">trait</span><span class="w"> </span><span class="n">TyDecoder</span><span class="o">&lt;</span><span class="na">&#39;a</span><span class="p">,</span><span class="w"> </span><span class="na">&#39;tcx</span>: <span class="na">&#39;a</span><span class="o">&gt;</span>: <span class="nc">Decoder</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="k">fn</span> <span class="nf">tcx</span><span class="p">(</span><span class="o">&amp;</span><span class="bp">self</span><span class="p">)</span><span class="w"> </span>-&gt; <span class="nc">TyCtxt</span><span class="o">&lt;</span><span class="na">&#39;a</span><span class="p">,</span><span class="w"> </span><span class="na">&#39;tcx</span><span class="p">,</span><span class="w"> </span><span class="na">&#39;tcx</span><span class="o">&gt;</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="p">...</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>
</pre></div>



<a name="157218381"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/157218381" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Santiago Pastorino <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#157218381">(Jan 30 2019 at 20:18)</a>:</h4>
<p>so I can't implement <code>impl&lt;'tcx&gt; serialize::UseSpecializedDecodable for &amp;'tcx &amp;[PlaceElem&lt;'tcx&gt;] {}</code></p>



<a name="157218400"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/157218400" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Santiago Pastorino <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#157218400">(Jan 30 2019 at 20:19)</a>:</h4>
<blockquote>
<p>because — in practice — this Decoder will be some type that implements <code>TyDecoder</code>:</p>
<div class="codehilite"><pre><span></span><span class="c1">// src/librustc/ty/codec.rs</span>
<span class="k">pub</span><span class="w"> </span><span class="k">trait</span><span class="w"> </span><span class="n">TyDecoder</span><span class="o">&lt;</span><span class="na">&#39;a</span><span class="p">,</span><span class="w"> </span><span class="na">&#39;tcx</span>: <span class="na">&#39;a</span><span class="o">&gt;</span>: <span class="nc">Decoder</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="k">fn</span> <span class="nf">tcx</span><span class="p">(</span><span class="o">&amp;</span><span class="bp">self</span><span class="p">)</span><span class="w"> </span>-&gt; <span class="nc">TyCtxt</span><span class="o">&lt;</span><span class="na">&#39;a</span><span class="p">,</span><span class="w"> </span><span class="na">&#39;tcx</span><span class="p">,</span><span class="w"> </span><span class="na">&#39;tcx</span><span class="o">&gt;</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="p">...</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>
</pre></div>


</blockquote>
<p>ok got it</p>



<a name="157218545"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/157218545" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Santiago Pastorino <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#157218545">(Jan 30 2019 at 20:20)</a>:</h4>
<blockquote>
<p>so I can't implement <code>impl&lt;'tcx&gt; serialize::UseSpecializedDecodable for &amp;'tcx &amp;[PlaceElem&lt;'tcx&gt;] {}</code></p>
</blockquote>
<p>this <span aria-label="point up" class="emoji emoji-1f446" role="img" title="point up">:point_up:</span> is one of the main issues I have :)</p>



<a name="157218681"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/157218681" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#157218681">(Jan 30 2019 at 20:22)</a>:</h4>
<p>So</p>



<a name="157218687"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/157218687" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#157218687">(Jan 30 2019 at 20:22)</a>:</h4>
<p>(sorry, got called away for a sec)</p>



<a name="157218698"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/157218698" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#157218698">(Jan 30 2019 at 20:22)</a>:</h4>
<p>one problem is, the <code>Decodable</code> trait  doesn't let you specialize on the type of decoder you have</p>



<a name="157218700"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/157218700" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#157218700">(Jan 30 2019 at 20:22)</a>:</h4>
<p>it is defined</p>



<a name="157218715"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/157218715" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#157218715">(Jan 30 2019 at 20:22)</a>:</h4>
<div class="codehilite"><pre><span></span><span class="k">trait</span><span class="w"> </span><span class="n">Decodable</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="k">fn</span> <span class="nf">decode</span><span class="o">&lt;</span><span class="n">D</span>: <span class="nc">Decoder</span><span class="o">&gt;</span><span class="p">(..)</span><span class="w"> </span><span class="c1">// &lt;-- so you have to implement for all `D`</span>
<span class="p">}</span><span class="w"></span>
</pre></div>



<a name="157218731"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/157218731" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#157218731">(Jan 30 2019 at 20:23)</a>:</h4>
<p>this is the <code>UseSpecializedDecodable</code> trait exists</p>



<a name="157218743"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/157218743" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#157218743">(Jan 30 2019 at 20:23)</a>:</h4>
<p>there is an impl:</p>
<div class="codehilite"><pre><span></span><span class="k">impl</span><span class="o">&lt;</span><span class="n">T</span>: <span class="nc">UseSpecializedDecodable</span><span class="o">&gt;</span><span class="w"> </span><span class="n">Decodable</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">T</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="k">default</span> <span class="k">fn</span><span class="w"> </span><span class="n">decode</span><span class="o">&lt;</span><span class="n">D</span>: <span class="nc">Decoder</span><span class="o">&gt;</span><span class="p">(</span><span class="n">d</span>: <span class="kp">&amp;</span><span class="nc">mut</span><span class="w"> </span><span class="n">D</span><span class="p">)</span><span class="w"> </span>-&gt; <span class="nb">Result</span><span class="o">&lt;</span><span class="n">T</span><span class="p">,</span><span class="w"> </span><span class="n">D</span>::<span class="n">Error</span><span class="o">&gt;</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">        </span><span class="n">D</span>::<span class="n">specialized_decode</span><span class="p">(</span><span class="n">d</span><span class="p">)</span><span class="w"></span>
<span class="w">    </span><span class="p">}</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>
</pre></div>



<a name="157218760"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/157218760" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#157218760">(Jan 30 2019 at 20:23)</a>:</h4>
<p>so the idea is, if you implement <code>UseSpecializedDecodable</code>, you will be directed to <code>specialized_decode</code>, which is setup in such a way that you <em>can</em> specialize</p>



<a name="157218776"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/157218776" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#157218776">(Jan 30 2019 at 20:24)</a>:</h4>
<p>there is also a blanket impl here for all <code>T</code>:</p>
<div class="codehilite"><pre><span></span><span class="k">impl</span><span class="o">&lt;</span><span class="na">&#39;a</span><span class="p">,</span><span class="w"> </span><span class="n">T</span>: <span class="o">?</span><span class="nb">Sized</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">Encodable</span><span class="o">&gt;</span><span class="w"> </span><span class="n">UseSpecializedEncodable</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="o">&amp;</span><span class="na">&#39;a</span><span class="w"> </span><span class="n">T</span><span class="w"> </span><span class="p">{}</span><span class="w"></span>
</pre></div>



<a name="157218851"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/157218851" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#157218851">(Jan 30 2019 at 20:24)</a>:</h4>
<p>anyway, I guess, hmm, you won't be able to implement for the slice, you are correct, owing to the orphan rules</p>



<a name="157218863"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/157218863" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Santiago Pastorino <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#157218863">(Jan 30 2019 at 20:24)</a>:</h4>
<p>yeah, but still I'm not sure how to implement it for <code>&amp;[PlaceElem]</code></p>



<a name="157218889"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/157218889" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#157218889">(Jan 30 2019 at 20:25)</a>:</h4>
<p>well, to start, you wouldn't want to</p>



<a name="157218892"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/157218892" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Santiago Pastorino <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#157218892">(Jan 30 2019 at 20:25)</a>:</h4>
<p>I mean, how to avoid the compiler error I've shared above</p>



<a name="157218894"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/157218894" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#157218894">(Jan 30 2019 at 20:25)</a>:</h4>
<p>though you might want to implement for <code>[PlaceElem]</code></p>



<a name="157218912"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/157218912" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#157218912">(Jan 30 2019 at 20:25)</a>:</h4>
<p>it seems like we might need a newtype wrapper, or else to define that elsewhere</p>



<a name="157218918"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/157218918" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#157218918">(Jan 30 2019 at 20:25)</a>:</h4>
<p>alternatively, we implement for <code>NeoPlace</code> by hand</p>



<a name="157218921"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/157218921" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#157218921">(Jan 30 2019 at 20:25)</a>:</h4>
<p>and side-step the problem</p>



<a name="157218922"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/157218922" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#157218922">(Jan 30 2019 at 20:25)</a>:</h4>
<p>which is perhaps easier</p>



<a name="157218989"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/157218989" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Santiago Pastorino <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#157218989">(Jan 30 2019 at 20:26)</a>:</h4>
<p>yeah that was what I was referring to when I mentioned that I needed to implement the thing for <code>NeoPlace</code></p>



<a name="157218992"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/157218992" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Santiago Pastorino <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#157218992">(Jan 30 2019 at 20:26)</a>:</h4>
<p>which already acts as a wrapper</p>



<a name="157219015"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/157219015" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Santiago Pastorino <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#157219015">(Jan 30 2019 at 20:26)</a>:</h4>
<p>the other question is ... how does rustc_encodable and rustc_decodable play in this combo?</p>



<a name="157219042"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/157219042" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Santiago Pastorino <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#157219042">(Jan 30 2019 at 20:27)</a>:</h4>
<p>I guess if I implement this trait for <code>NeoPlace</code> I should not derive?</p>



<a name="157219069"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/157219069" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Santiago Pastorino <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#157219069">(Jan 30 2019 at 20:27)</a>:</h4>
<p>I'm not sure deriving that what's the trait that wins a implementation for NeoPlace automatically</p>



<a name="157219073"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/157219073" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#157219073">(Jan 30 2019 at 20:27)</a>:</h4>
<p>I think what you would want to do</p>



<a name="157219078"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/157219078" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#157219078">(Jan 30 2019 at 20:27)</a>:</h4>
<p>is to add an impl into the <code>implement_ty_decoder</code> macro definition</p>



<a name="157219081"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/157219081" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#157219081">(Jan 30 2019 at 20:27)</a>:</h4>
<p>in <code>ty/codec.rs</code></p>



<a name="157219128"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/157219128" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#157219128">(Jan 30 2019 at 20:28)</a>:</h4>
<p>e.g., in there, you will see impls like this:</p>
<div class="codehilite"><pre><span></span><span class="w">            </span><span class="k">impl</span><span class="o">&lt;</span><span class="cp">$($typaram</span><span class="p">),</span><span class="o">*&gt;</span><span class="w"> </span><span class="n">SpecializedDecoder</span><span class="o">&lt;&amp;</span><span class="na">&#39;tcx</span><span class="w"> </span><span class="n">ty</span>::<span class="n">AdtDef</span><span class="o">&gt;</span><span class="w"></span>
<span class="w">            </span><span class="k">for</span><span class="w"> </span><span class="cp">$DecoderName</span><span class="o">&lt;</span><span class="cp">$($typaram</span><span class="p">),</span><span class="o">*&gt;</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">                </span><span class="k">fn</span> <span class="nf">specialized_decode</span><span class="p">(</span><span class="o">&amp;</span><span class="k">mut</span><span class="w"> </span><span class="bp">self</span><span class="p">)</span><span class="w"> </span>-&gt; <span class="nb">Result</span><span class="o">&lt;&amp;</span><span class="na">&#39;tcx</span><span class="w"> </span><span class="n">ty</span>::<span class="n">AdtDef</span><span class="p">,</span><span class="w"> </span><span class="n">Self</span>::<span class="n">Error</span><span class="o">&gt;</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">                    </span><span class="n">decode_adt_def</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span><span class="w"></span>
<span class="w">                </span><span class="p">}</span><span class="w"></span>
<span class="w">            </span><span class="p">}</span><span class="w"></span>
</pre></div>



<a name="157219133"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/157219133" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#157219133">(Jan 30 2019 at 20:28)</a>:</h4>
<p>and you could in theory add a</p>



<a name="157219146"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/157219146" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#157219146">(Jan 30 2019 at 20:28)</a>:</h4>
<div class="codehilite"><pre><span></span><span class="w">            </span><span class="k">impl</span><span class="o">&lt;</span><span class="cp">$($typaram</span><span class="p">),</span><span class="o">*&gt;</span><span class="w"> </span><span class="n">SpecializedDecoder</span><span class="o">&lt;</span><span class="n">NeoPlace</span><span class="o">&lt;</span><span class="na">&#39;tcx</span><span class="o">&gt;&gt;</span><span class="w"></span>
<span class="w">            </span><span class="k">for</span><span class="w"> </span><span class="cp">$DecoderName</span><span class="o">&lt;</span><span class="cp">$($typaram</span><span class="p">),</span><span class="o">*&gt;</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">                </span><span class="k">fn</span> <span class="nf">specialized_decode</span><span class="p">(</span><span class="o">&amp;</span><span class="k">mut</span><span class="w"> </span><span class="bp">self</span><span class="p">)</span><span class="w"> </span>-&gt; <span class="nb">Result</span><span class="o">&lt;</span><span class="n">NeoPlace</span><span class="o">&lt;</span><span class="na">&#39;tcx</span><span class="o">&gt;</span><span class="p">,</span><span class="w"> </span><span class="n">Self</span>::<span class="n">Error</span><span class="o">&gt;</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">                    </span><span class="p">...</span><span class="w"></span>
<span class="w">                </span><span class="p">}</span><span class="w"></span>
<span class="w">            </span><span class="p">}</span><span class="w"></span>
</pre></div>



<a name="157219306"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/157219306" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#157219306">(Jan 30 2019 at 20:31)</a>:</h4>
<p>anyway, i'm debating about this</p>



<a name="157219322"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/157219322" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#157219322">(Jan 30 2019 at 20:31)</a>:</h4>
<p>the reason we used the slice was to easily support <code>NeoPlaceTree</code></p>



<a name="157219326"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/157219326" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#157219326">(Jan 30 2019 at 20:31)</a>:</h4>
<p>which...still seems useful to me</p>



<a name="157219328"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/157219328" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#157219328">(Jan 30 2019 at 20:31)</a>:</h4>
<p>so I guess it's worth doing this</p>



<a name="157219347"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/157219347" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#157219347">(Jan 30 2019 at 20:31)</a>:</h4>
<p>(as opposed to using <code>&amp;'tcx List&lt;ProjectionElem&lt;'tcx&gt;&gt;</code>, which I think is what <span class="user-mention" data-user-id="116773">@csmoe</span> initially had.</p>



<a name="157219362"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/157219362" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Santiago Pastorino <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#157219362">(Jan 30 2019 at 20:31)</a>:</h4>
<p>yeah</p>



<a name="157219365"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/157219365" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#157219365">(Jan 30 2019 at 20:31)</a>:</h4>
<p>If we used that type, a lot of the plumbing is written for us, but we lose the ability to do subslicing</p>



<a name="157219417"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/157219417" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Santiago Pastorino <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#157219417">(Jan 30 2019 at 20:32)</a>:</h4>
<p>yeah</p>



<a name="157219444"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/157219444" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Santiago Pastorino <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#157219444">(Jan 30 2019 at 20:32)</a>:</h4>
<p>couldn't we delay doing this?</p>



<a name="157219491"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/157219491" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Santiago Pastorino <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#157219491">(Jan 30 2019 at 20:33)</a>:</h4>
<p>I mean, maybe just going with <code>List</code> and after revisiting all the Place &lt;-&gt; NeoPlace we can come back</p>



<a name="157219500"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/157219500" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Santiago Pastorino <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#157219500">(Jan 30 2019 at 20:33)</a>:</h4>
<p>or is there something that won't work?</p>



<a name="157219530"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/157219530" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Santiago Pastorino <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#157219530">(Jan 30 2019 at 20:33)</a>:</h4>
<p>mentioning this because it may be faster to experiment with the real migration to NeoPlace</p>



<a name="157219538"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/157219538" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Santiago Pastorino <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#157219538">(Jan 30 2019 at 20:33)</a>:</h4>
<p>and then we can just change the List type to be a Slice</p>



<a name="157220431"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/157220431" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pnkfelix <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#157220431">(Jan 30 2019 at 20:46)</a>:</h4>
<p>/me thinks <code>Cow</code> would be another way to delay doing this</p>



<a name="157221688"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/157221688" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#157221688">(Jan 30 2019 at 21:02)</a>:</h4>
<p>I hate cow :P</p>



<a name="157221694"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/157221694" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#157221694">(Jan 30 2019 at 21:02)</a>:</h4>
<p>but you're not wrong</p>



<a name="157221714"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/157221714" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#157221714">(Jan 30 2019 at 21:02)</a>:</h4>
<p>I mean another way would be to make a newtype like </p>
<div class="codehilite"><pre><span></span><span class="k">struct</span> <span class="nc">ProjectionList</span><span class="o">&lt;</span><span class="na">&#39;tcx</span><span class="o">&gt;</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="n">slice</span>: <span class="kp">&amp;</span><span class="na">&#39;tcx</span><span class="w"> </span><span class="p">[</span><span class="n">ProjectionElem</span><span class="o">&lt;</span><span class="na">&#39;tcx</span><span class="o">&gt;</span><span class="p">]</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>
</pre></div>



<a name="157221725"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/157221725" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#157221725">(Jan 30 2019 at 21:02)</a>:</h4>
<p>I think it'd not be too hard</p>



<a name="157222048"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/157222048" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Santiago Pastorino <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#157222048">(Jan 30 2019 at 21:07)</a>:</h4>
<p>yeah I've already done that</p>



<a name="157222091"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/157222091" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Santiago Pastorino <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#157222091">(Jan 30 2019 at 21:07)</a>:</h4>
<p>but I mean, why is better to make a wrapper around <code>&amp;'tcx [ProjectionElem&lt;'tcx&gt;]</code> rather than just using <code>NeoPlace</code>?</p>



<a name="157222178"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/157222178" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pnkfelix <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#157222178">(Jan 30 2019 at 21:08)</a>:</h4>
<p>The fact that anyone hates Cow represents a design bug somewhere</p>



<a name="157222209"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/157222209" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pnkfelix <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#157222209">(Jan 30 2019 at 21:08)</a>:</h4>
<p>(Not that you’re wrong to hate Cow)</p>



<a name="157222217"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/157222217" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#157222217">(Jan 30 2019 at 21:09)</a>:</h4>
<blockquote>
<p>The fact that anyone hates Cow represents a design bug somewhere</p>
</blockquote>
<p>in the language :P</p>



<a name="157222233"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/157222233" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#157222233">(Jan 30 2019 at 21:09)</a>:</h4>
<p>I don't even know what I mean by that</p>



<a name="157222244"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/157222244" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pnkfelix <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#157222244">(Jan 30 2019 at 21:09)</a>:</h4>
<p>((But it should be an easier thing to put in API’s))</p>



<a name="157222251"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/157222251" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#157222251">(Jan 30 2019 at 21:09)</a>:</h4>
<blockquote>
<p>but I mean, why is better to make a wrapper around <code>&amp;'tcx [ProjectionElem&lt;'tcx&gt;]</code> rather than just using <code>NeoPlace</code>?</p>
</blockquote>
<p>no particular reason I suppose, just more narrow</p>



<a name="157222263"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/157222263" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#157222263">(Jan 30 2019 at 21:09)</a>:</h4>
<p>but yeah it's not easier</p>



<a name="157222266"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/157222266" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#157222266">(Jan 30 2019 at 21:09)</a>:</h4>
<p>mosly I think this code is not actually that <em>hard</em></p>



<a name="157222285"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/157222285" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#157222285">(Jan 30 2019 at 21:09)</a>:</h4>
<p>otoh if <code>NeoPlaceTree</code> is only used rarely</p>



<a name="157222289"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/157222289" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#157222289">(Jan 30 2019 at 21:09)</a>:</h4>
<p>maybe it's fine for it to be inefficient</p>



<a name="157222293"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/157222293" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#157222293">(Jan 30 2019 at 21:10)</a>:</h4>
<p>seems like a shame tho</p>



<a name="157222346"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/157222346" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#157222346">(Jan 30 2019 at 21:10)</a>:</h4>
<p><span class="user-mention" data-user-id="116266">@Santiago Pastorino</span> is this stuff all on <span class="user-mention" data-user-id="116773">@csmoe</span> 's branch? i.e., can I take a look at it?</p>



<a name="157222371"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/157222371" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Santiago Pastorino <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#157222371">(Jan 30 2019 at 21:10)</a>:</h4>
<p>everything is in there</p>



<a name="157222377"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/157222377" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Santiago Pastorino <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#157222377">(Jan 30 2019 at 21:10)</a>:</h4>
<p>but there's code wip on my machine</p>



<a name="157222390"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/157222390" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Santiago Pastorino <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#157222390">(Jan 30 2019 at 21:10)</a>:</h4>
<p>unsure what do you want to look at</p>



<a name="157222413"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/157222413" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Santiago Pastorino <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#157222413">(Jan 30 2019 at 21:11)</a>:</h4>
<p>I can open tmate and allow you in if you want :)</p>



<a name="157223743"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/157223743" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#157223743">(Jan 30 2019 at 21:26)</a>:</h4>
<p><span class="user-mention" data-user-id="116266">@Santiago Pastorino</span> we could try that :)</p>



<a name="157223822"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/157223822" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Santiago Pastorino <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#157223822">(Jan 30 2019 at 21:27)</a>:</h4>
<p>:)</p>



<a name="157226554"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/157226554" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#157226554">(Jan 30 2019 at 21:57)</a>:</h4>
<p><span class="user-mention" data-user-id="116266">@Santiago Pastorino</span> I <a href="https://github.com/rust-lang/rust/pull/54426/commits/cf4da24aa9dc93c99d175b9e7a3456b3cec5a166" target="_blank" title="https://github.com/rust-lang/rust/pull/54426/commits/cf4da24aa9dc93c99d175b9e7a3456b3cec5a166">pushed a commit</a> that implements <code>RustcDecodable</code> for <code>NeoPlace&lt;'tcx&gt;</code></p>



<a name="157226721"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/157226721" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#157226721">(Jan 30 2019 at 21:59)</a>:</h4>
<p>at least, <code>x.py check</code> builds</p>



<a name="157238810"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/157238810" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Santiago Pastorino <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#157238810">(Jan 31 2019 at 01:26)</a>:</h4>
<p>will check tomorrow</p>



<a name="157274587"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/157274587" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#157274587">(Jan 31 2019 at 14:20)</a>:</h4>
<p><span class="user-mention" data-user-id="116266">@Santiago Pastorino</span> get a chance to look?</p>



<a name="157274601"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/157274601" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Santiago Pastorino <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#157274601">(Jan 31 2019 at 14:21)</a>:</h4>
<p><span class="user-mention" data-user-id="116009">@nikomatsakis</span> hey, almost back</p>



<a name="157274605"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/157274605" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Santiago Pastorino <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#157274605">(Jan 31 2019 at 14:21)</a>:</h4>
<p>catching up with Rust Latam stuff :)</p>



<a name="157274610"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/157274610" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Santiago Pastorino <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#157274610">(Jan 31 2019 at 14:21)</a>:</h4>
<p>yesterday I took a look at it</p>



<a name="157274611"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/157274611" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Santiago Pastorino <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#157274611">(Jan 31 2019 at 14:21)</a>:</h4>
<p>actually, let me go over it quickly</p>



<a name="157274622"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/157274622" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Santiago Pastorino <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#157274622">(Jan 31 2019 at 14:21)</a>:</h4>
<p>you don't derive RustcDecodable</p>



<a name="157274668"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/157274668" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Santiago Pastorino <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#157274668">(Jan 31 2019 at 14:22)</a>:</h4>
<p>I guess that interferes with what you're doing, right?</p>



<a name="157274682"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/157274682" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Santiago Pastorino <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#157274682">(Jan 31 2019 at 14:22)</a>:</h4>
<p>I'm not sure what deriving RustcDecodable make the type implement</p>



<a name="157274766"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/157274766" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Santiago Pastorino <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#157274766">(Jan 31 2019 at 14:23)</a>:</h4>
<p>ok, read it</p>



<a name="157274778"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/157274778" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Santiago Pastorino <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#157274778">(Jan 31 2019 at 14:23)</a>:</h4>
<p>there some things that seem magic to me :P</p>



<a name="157276987"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/157276987" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Santiago Pastorino <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#157276987">(Jan 31 2019 at 14:54)</a>:</h4>
<p><span class="user-mention" data-user-id="116009">@nikomatsakis</span> back to this, yeah the thing makes sense</p>



<a name="157277015"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/157277015" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Santiago Pastorino <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#157277015">(Jan 31 2019 at 14:54)</a>:</h4>
<p>so <code>UseSpecializedDecoder</code> is a marker trait and the decoder API checks for that in order to use a <code>SpecializedDecoder</code> I guess</p>



<a name="157277037"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/157277037" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Santiago Pastorino <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#157277037">(Jan 31 2019 at 14:55)</a>:</h4>
<p>which in this case is the one you defined using macros</p>



<a name="157277164"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/157277164" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Santiago Pastorino <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#157277164">(Jan 31 2019 at 14:57)</a>:</h4>
<p>the only thing I don't understand is what is exactly <a href="https://github.com/rust-lang/rust/pull/54426/commits/cf4da24aa9dc93c99d175b9e7a3456b3cec5a166#diff-ba672cead097ccdd2da4d223f02f4735R428" target="_blank" title="https://github.com/rust-lang/rust/pull/54426/commits/cf4da24aa9dc93c99d175b9e7a3456b3cec5a166#diff-ba672cead097ccdd2da4d223f02f4735R428">https://github.com/rust-lang/rust/pull/54426/commits/cf4da24aa9dc93c99d175b9e7a3456b3cec5a166#diff-ba672cead097ccdd2da4d223f02f4735R428</a> which is the entity that knows how to decode a PlaceBase and stuff like that and used all over the place like in <a href="https://github.com/rust-lang/rust/pull/54426/commits/cf4da24aa9dc93c99d175b9e7a3456b3cec5a166#diff-ba672cead097ccdd2da4d223f02f4735R274" target="_blank" title="https://github.com/rust-lang/rust/pull/54426/commits/cf4da24aa9dc93c99d175b9e7a3456b3cec5a166#diff-ba672cead097ccdd2da4d223f02f4735R274">https://github.com/rust-lang/rust/pull/54426/commits/cf4da24aa9dc93c99d175b9e7a3456b3cec5a166#diff-ba672cead097ccdd2da4d223f02f4735R274</a></p>



<a name="157277185"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/157277185" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Santiago Pastorino <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#157277185">(Jan 31 2019 at 14:57)</a>:</h4>
<p>but I guess that's generic code, it's just decoding a struct :)</p>



<a name="157294834"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/157294834" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#157294834">(Jan 31 2019 at 18:49)</a>:</h4>
<p>decoding a <code>PlaceBase</code> comes from the <code>derive</code> on <code>PlaceBase</code></p>



<a name="157295582"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/157295582" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Santiago Pastorino <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#157295582">(Jan 31 2019 at 18:58)</a>:</h4>
<p>ahh right</p>



<a name="157295597"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/157295597" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Santiago Pastorino <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#157295597">(Jan 31 2019 at 18:59)</a>:</h4>
<p>what does the decoder do then exactly?</p>



<a name="157295614"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/157295614" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Santiago Pastorino <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#157295614">(Jan 31 2019 at 18:59)</a>:</h4>
<p>or what role it plays?</p>



<a name="157295673"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/157295673" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Santiago Pastorino <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#157295673">(Jan 31 2019 at 19:00)</a>:</h4>
<p>sorry, I'm not asking correctly :)</p>



<a name="157295748"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/157295748" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#157295748">(Jan 31 2019 at 19:00)</a>:</h4>
<blockquote>
<p>what does the decoder do then exactly?</p>
</blockquote>
<p>e.g., in this line?</p>
<div class="codehilite"><pre><span></span><span class="kd">let</span><span class="w"> </span><span class="n">base</span>: <span class="nc">mir</span>::<span class="n">PlaceBase</span><span class="o">&lt;</span><span class="na">&#39;tcx</span><span class="o">&gt;</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Decodable</span>::<span class="n">decode</span><span class="p">(</span><span class="n">decoder</span><span class="p">)</span><span class="o">?</span><span class="p">;</span><span class="w"></span>
</pre></div>



<a name="157295760"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/157295760" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Santiago Pastorino <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#157295760">(Jan 31 2019 at 19:00)</a>:</h4>
<p>yeah, everywhere</p>



<a name="157295768"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/157295768" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Santiago Pastorino <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#157295768">(Jan 31 2019 at 19:00)</a>:</h4>
<p>what's the type?</p>



<a name="157295771"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/157295771" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#157295771">(Jan 31 2019 at 19:00)</a>:</h4>
<p>the <em>decoder</em> basically gives the context needed</p>



<a name="157295773"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/157295773" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Santiago Pastorino <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#157295773">(Jan 31 2019 at 19:00)</a>:</h4>
<p>how does it know how to decode?</p>



<a name="157295774"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/157295774" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Santiago Pastorino <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#157295774">(Jan 31 2019 at 19:00)</a>:</h4>
<p>etc</p>



<a name="157295781"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/157295781" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#157295781">(Jan 31 2019 at 19:01)</a>:</h4>
<p>it's type is <code>impl TyDecode</code></p>



<a name="157295797"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/157295797" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#157295797">(Jan 31 2019 at 19:01)</a>:</h4>
<p>that is, some type that implements the <code>TyDecoder</code> trait</p>



<a name="157295802"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/157295802" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#157295802">(Jan 31 2019 at 19:01)</a>:</h4>
<p>which extends the <code>Decoder</code> trait</p>



<a name="157295814"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/157295814" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Santiago Pastorino <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#157295814">(Jan 31 2019 at 19:01)</a>:</h4>
<p>ok</p>



<a name="157295818"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/157295818" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#157295818">(Jan 31 2019 at 19:01)</a>:</h4>
<p>the most basic methods it offers are like <code>decode_usize</code></p>



<a name="157295823"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/157295823" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#157295823">(Jan 31 2019 at 19:01)</a>:</h4>
<p>basically think of it like this:</p>



<a name="157295828"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/157295828" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#157295828">(Jan 31 2019 at 19:01)</a>:</h4>
<p>there is some stream of data being decoded</p>



<a name="157295836"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/157295836" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#157295836">(Jan 31 2019 at 19:01)</a>:</h4>
<p>the <code>decoder</code> knows about that stream</p>



<a name="157295838"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/157295838" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Santiago Pastorino <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#157295838">(Jan 31 2019 at 19:01)</a>:</h4>
<p>yeah basically you need to do what derive RustcDecodable does but you need to unroll the slice</p>



<a name="157295842"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/157295842" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#157295842">(Jan 31 2019 at 19:01)</a>:</h4>
<p>you can tell it to e.g. read the next <code>usize</code> from the stream</p>



<a name="157295856"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/157295856" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#157295856">(Jan 31 2019 at 19:01)</a>:</h4>
<p>and other simple, built-in operations</p>



<a name="157295901"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/157295901" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#157295901">(Jan 31 2019 at 19:02)</a>:</h4>
<p>but then the <code>Decodable</code> trait composes those methods to build bigger types</p>



<a name="157295919"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/157295919" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Santiago Pastorino <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#157295919">(Jan 31 2019 at 19:02)</a>:</h4>
<p>yeah</p>



<a name="157295924"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/157295924" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Santiago Pastorino <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#157295924">(Jan 31 2019 at 19:02)</a>:</h4>
<p>makes a lot of sense</p>



<a name="157295932"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/157295932" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#157295932">(Jan 31 2019 at 19:02)</a>:</h4>
<p>so e.g. the <code>Decodable</code> for <code>(u32, u32)</code> would be like "read two u32s and I will build a tuple"</p>



<a name="157295939"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/157295939" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Santiago Pastorino <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#157295939">(Jan 31 2019 at 19:02)</a>:</h4>
<p>yes</p>



<a name="157295945"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/157295945" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#157295945">(Jan 31 2019 at 19:02)</a>:</h4>
<p>except that really it's built generically, so the <code>Decodable</code> for <code>(A, B)</code> says "read an A and a B"</p>



<a name="157295960"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/157295960" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#157295960">(Jan 31 2019 at 19:02)</a>:</h4>
<p>and the <code>Decodable</code> trait for <code>u32</code>, in turn, says "read a u32"</p>



<a name="157295963"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/157295963" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Santiago Pastorino <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#157295963">(Jan 31 2019 at 19:02)</a>:</h4>
<p>yeah, exactly in the way I was thinking about it :)</p>



<a name="157295982"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/157295982" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#157295982">(Jan 31 2019 at 19:02)</a>:</h4>
<p>the whole <code>UseSpecializedDecoder</code> thing</p>



<a name="157295994"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/157295994" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Santiago Pastorino <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#157295994">(Jan 31 2019 at 19:03)</a>:</h4>
<p>it's just that there are things that seem to appear from nowhere</p>



<a name="157296005"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/157296005" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#157296005">(Jan 31 2019 at 19:03)</a>:</h4>
<p>just lets us take advantage of the fact that we have a <code>TyDecoder</code>, which has a <code>tcx</code></p>



<a name="157296027"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/157296027" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Santiago Pastorino <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#157296027">(Jan 31 2019 at 19:03)</a>:</h4>
<p>yeah, maybe that part is the part I see the less</p>



<a name="157296030"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/157296030" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Santiago Pastorino <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#157296030">(Jan 31 2019 at 19:03)</a>:</h4>
<p>where that comes from</p>



<a name="157296031"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/157296031" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#157296031">(Jan 31 2019 at 19:03)</a>:</h4>
<p>in a sense it is saying "here is a <code>Decodable</code> that requires not just any Decoder but a TyDecoder" -- there is also a "base implementation" that works for any decoder</p>



<a name="157296035"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/157296035" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Santiago Pastorino <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#157296035">(Jan 31 2019 at 19:03)</a>:</h4>
<p>I guess the macro does something?</p>



<a name="157296038"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/157296038" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#157296038">(Jan 31 2019 at 19:03)</a>:</h4>
<p>but that base implementation just panics</p>



<a name="157296043"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/157296043" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#157296043">(Jan 31 2019 at 19:03)</a>:</h4>
<p>the macro is generating the impl, yeah</p>



<a name="157296055"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/157296055" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#157296055">(Jan 31 2019 at 19:03)</a>:</h4>
<p>I forget why the macro is needed</p>



<a name="157296063"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/157296063" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#157296063">(Jan 31 2019 at 19:03)</a>:</h4>
<p>probably coherence</p>



<a name="157296072"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/157296072" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Santiago Pastorino <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#157296072">(Jan 31 2019 at 19:04)</a>:</h4>
<p>ok</p>



<a name="157296113"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/157296113" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Santiago Pastorino <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#157296113">(Jan 31 2019 at 19:04)</a>:</h4>
<p><span aria-label="+1" class="emoji emoji-1f44d" role="img" title="+1">:+1:</span></p>



<a name="157296120"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/157296120" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#157296120">(Jan 31 2019 at 19:04)</a>:</h4>
<p>basically we can't define a rule for "any type T that implements TyDecoder"</p>



<a name="157296130"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/157296130" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#157296130">(Jan 31 2019 at 19:04)</a>:</h4>
<p>because we're in the wrong crate</p>



<a name="157296138"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/157296138" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#157296138">(Jan 31 2019 at 19:04)</a>:</h4>
<p>so instead we define mulitple impls, one for each type that is a TyDecoder</p>



<a name="157296153"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/157296153" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#157296153">(Jan 31 2019 at 19:04)</a>:</h4>
<p>and use the macro to avoid code duplication</p>



<a name="157297250"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/157297250" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Santiago Pastorino <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#157297250">(Jan 31 2019 at 19:16)</a>:</h4>
<p><span aria-label="+1" class="emoji emoji-1f44d" role="img" title="+1">:+1:</span></p>



<a name="157411550"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/157411550" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Santiago Pastorino <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#157411550">(Feb 02 2019 at 07:05)</a>:</h4>
<p><span class="user-mention" data-user-id="116009">@nikomatsakis</span> during non sleep time of MVD -&gt; MAD I've added a commit to the PR</p>



<a name="157411551"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/157411551" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Santiago Pastorino <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#157411551">(Feb 02 2019 at 07:05)</a>:</h4>
<p><a href="https://github.com/rust-lang/rust/pull/54426/commits/fe2fedbd469b3c0a8a1b4543cee21b8ff05c4264" target="_blank" title="https://github.com/rust-lang/rust/pull/54426/commits/fe2fedbd469b3c0a8a1b4543cee21b8ff05c4264">https://github.com/rust-lang/rust/pull/54426/commits/fe2fedbd469b3c0a8a1b4543cee21b8ff05c4264</a></p>



<a name="157411552"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/157411552" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Santiago Pastorino <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#157411552">(Feb 02 2019 at 07:05)</a>:</h4>
<p>it was failing on my machine</p>



<a name="157411593"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/157411593" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Santiago Pastorino <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#157411593">(Feb 02 2019 at 07:06)</a>:</h4>
<p>still unsure why, if you can take a look please do :)</p>



<a name="157411595"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/157411595" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Santiago Pastorino <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#157411595">(Feb 02 2019 at 07:06)</a>:</h4>
<p>it's an ICE</p>



<a name="157411766"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/157411766" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Santiago Pastorino <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#157411766">(Feb 02 2019 at 07:13)</a>:</h4>
<p>here is the error <a href="https://gist.github.com/spastorino/fe996acdc5091d8298432485bb5d36dc" target="_blank" title="https://gist.github.com/spastorino/fe996acdc5091d8298432485bb5d36dc">https://gist.github.com/spastorino/fe996acdc5091d8298432485bb5d36dc</a></p>



<a name="157413201"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/157413201" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> csmoe <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#157413201">(Feb 02 2019 at 08:01)</a>:</h4>
<p><span class="user-mention" data-user-id="116266">@Santiago Pastorino</span> I noticed that you created local place with <code>NeoPlace { base: Local(local), elems: &amp;[]}</code> repeatedly, you can check out the methods <code>impl NeoPlace {}</code> in the PR at src/librustc/mir/mod.rs(line 2119-2211)</p>



<a name="157414876"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/157414876" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Matthew Jasper <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#157414876">(Feb 02 2019 at 08:54)</a>:</h4>
<p><span class="user-mention" data-user-id="116266">@Santiago Pastorino</span> The issue is that <code>MutVisitor::visit_assign</code> needs to write the new place back to the Assign, if it's been modified.</p>



<a name="157418919"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/157418919" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Santiago Pastorino <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#157418919">(Feb 02 2019 at 11:02)</a>:</h4>
<blockquote>
<p><span class="user-mention silent" data-user-id="116266">@Santiago Pastorino</span> The issue is that <code>MutVisitor::visit_assign</code> needs to write the new place back to the Assign, if it's been modified.</p>
</blockquote>
<p>you're right, anyway this is basically code to be removed</p>



<a name="157418921"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/157418921" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Santiago Pastorino <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#157418921">(Feb 02 2019 at 11:02)</a>:</h4>
<p>but wanna change</p>



<a name="157419071"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/157419071" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Santiago Pastorino <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#157419071">(Feb 02 2019 at 11:07)</a>:</h4>
<blockquote>
<p><span class="user-mention silent" data-user-id="116266">@Santiago Pastorino</span> The issue is that <code>MutVisitor::visit_assign</code> needs to write the new place back to the Assign, if it's been modified.</p>
</blockquote>
<p>hmm, the problem is Assign takes a NeoPlace and visit_assign a Place</p>



<a name="157419074"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/157419074" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Santiago Pastorino <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#157419074">(Feb 02 2019 at 11:07)</a>:</h4>
<p>do you mean that I need both things to be the same thing?</p>



<a name="157419075"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/157419075" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Santiago Pastorino <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#157419075">(Feb 02 2019 at 11:07)</a>:</h4>
<p><span class="user-mention" data-user-id="116118">@Matthew Jasper</span> why exactly?</p>



<a name="157420115"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/157420115" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Matthew Jasper <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#157420115">(Feb 02 2019 at 11:39)</a>:</h4>
<blockquote>
<p>do you mean that I need both things to be the same thing?</p>
</blockquote>
<p>I mean that you need to convert the modified place back to a NeoPlace and use it in the Assign.</p>



<a name="157434256"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/157434256" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Santiago Pastorino <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#157434256">(Feb 02 2019 at 18:56)</a>:</h4>
<p>pushed some fixes, still ICEing</p>



<a name="157434257"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/157434257" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Santiago Pastorino <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#157434257">(Feb 02 2019 at 18:56)</a>:</h4>
<p>need to take a closer look</p>



<a name="157703467"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/157703467" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pnkfelix <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#157703467">(Feb 06 2019 at 16:32)</a>:</h4>
<p><span class="user-mention" data-user-id="116266">@Santiago Pastorino</span> FYI this is a good thing to read regarding <code>'tcx</code>: <a href="https://rust-lang.github.io/rustc-guide/ty.html?highlight=TyCtxt#the-tcx-and-how-it-uses-lifetimes" target="_blank" title="https://rust-lang.github.io/rustc-guide/ty.html?highlight=TyCtxt#the-tcx-and-how-it-uses-lifetimes">https://rust-lang.github.io/rustc-guide/ty.html?highlight=TyCtxt#the-tcx-and-how-it-uses-lifetimes</a></p>



<a name="158029050"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/158029050" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pnkfelix <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#158029050">(Feb 11 2019 at 13:13)</a>:</h4>
<p>Hi again <span class="user-mention" data-user-id="116266">@Santiago Pastorino</span> ; it was too bad you were not able to stay until Friday. The changes you and <span class="user-mention" data-user-id="116773">@csmoe</span>  have been making to <code>Place</code> came up during the MIR 2.0 talks</p>



<a name="158030216"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/158030216" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pnkfelix <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#158030216">(Feb 11 2019 at 13:31)</a>:</h4>
<p>you can see discussion at <a href="https://paper.dropbox.com/doc/Topic-MIR-2.0-and-MIR-Optimizations--AXXCs_fiKzui0tii_ZOXNEJFAg-BwHR7kOhxDwL6vuAUoSTQ" target="_blank" title="https://paper.dropbox.com/doc/Topic-MIR-2.0-and-MIR-Optimizations--AXXCs_fiKzui0tii_ZOXNEJFAg-BwHR7kOhxDwL6vuAUoSTQ">this paper doc</a></p>



<a name="158030230"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/158030230" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pnkfelix <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#158030230">(Feb 11 2019 at 13:31)</a>:</h4>
<p><span class="user-mention" data-user-id="125250">@Wesley Wiser</span> noted that we may want to change our strategy, if possible, to first abstract the API (while leaving the implementation unchanged)</p>



<a name="158033700"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/158033700" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> csmoe <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#158033700">(Feb 11 2019 at 14:28)</a>:</h4>
<p><span class="user-mention" data-user-id="116083">@pnkfelix</span> so is there anything I can help then?</p>



<a name="158033885"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/158033885" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pnkfelix <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#158033885">(Feb 11 2019 at 14:31)</a>:</h4>
<p>I'm not sure. <span class="user-mention" data-user-id="119009">@eddyb</span> seemed very concerned that any attempt to land <code>NeoPlace</code> was going to be very ugly (and/or inefficient) and repeatedly argued that it would be cleaner to just switch over the representation all at once, without trying to convert between the two representations on the fly. In terms of code-cleanliness in short term and  ease-of-reviewing, I don't currently agree. But I don't have much of an argument about the inefficiency claim.</p>



<a name="158033965"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/158033965" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pnkfelix <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#158033965">(Feb 11 2019 at 14:32)</a>:</h4>
<p>The proposal to change the API (namely by putting iterator methods in place that work on either the recursive rep or the array-of-projs rep) was made by <span class="user-mention" data-user-id="125250">@Wesley Wiser</span> . I am currently experimenting in a local branch to evaluate whether this would be a realistic avenue.</p>



<a name="158034010"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/158034010" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pnkfelix <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#158034010">(Feb 11 2019 at 14:33)</a>:</h4>
<p>I guess if you (<span class="user-mention" data-user-id="116773">@csmoe</span> ) felt like playing around with that idea, then that would be great. But I also understand that you haven't had much time to work on this task, right?</p>



<a name="158034088"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/158034088" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pnkfelix <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#158034088">(Feb 11 2019 at 14:34)</a>:</h4>
<p>(I had also proposed to <span class="user-mention" data-user-id="119009">@eddyb</span> that we try to set up a video-conf meeting with <span class="user-mention" data-user-id="116266">@Santiago Pastorino</span> and anyone else interested in this issue. I could attempt to include you, <span class="user-mention" data-user-id="116773">@csmoe</span> , in that discussion, if it actually happens. But it might not; nothing has been planned yet.)</p>



<a name="158034122"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/158034122" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Santiago Pastorino <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#158034122">(Feb 11 2019 at 14:34)</a>:</h4>
<p>I'm very interested in continuing with this also given that we have been putting some work on it</p>



<a name="158034138"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/158034138" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Santiago Pastorino <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#158034138">(Feb 11 2019 at 14:35)</a>:</h4>
<p>I've also asked <span class="user-mention" data-user-id="124288">@oli</span> about this because that's what <span class="user-mention" data-user-id="116009">@nikomatsakis</span> suggested me to do</p>



<a name="158034214"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/158034214" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pnkfelix <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#158034214">(Feb 11 2019 at 14:36)</a>:</h4>
<p><span class="user-mention" data-user-id="116266">@Santiago Pastorino</span> , do you just mean you spoke with <span class="user-mention" data-user-id="124288">@oli</span> about this last week? Or did you make plans to continue talking to <span class="user-mention" data-user-id="124288">@oli</span> in the near future about this topic?</p>



<a name="158034229"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/158034229" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> csmoe <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#158034229">(Feb 11 2019 at 14:36)</a>:</h4>
<p><span class="user-mention" data-user-id="116083">@pnkfelix</span> okay, get it.<br>
I am just back from the Chinese New Year, having plenty of time to spend.  and I'm interested in the conf.</p>



<a name="158034256"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/158034256" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pnkfelix <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#158034256">(Feb 11 2019 at 14:36)</a>:</h4>
<p>Ah great thanks for correcting me about that, <span class="user-mention" data-user-id="116773">@csmoe</span></p>



<a name="158035436"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/158035436" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Santiago Pastorino <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#158035436">(Feb 11 2019 at 14:53)</a>:</h4>
<blockquote>
<p><span class="user-mention silent" data-user-id="116266">@Santiago Pastorino</span> , do you just mean you spoke with <span class="user-mention silent" data-user-id="124288">@oli</span> about this last week? Or did you make plans to continue talking to <span class="user-mention silent" data-user-id="124288">@oli</span> in the near future about this topic?</p>
</blockquote>
<p>I've just talked to <span class="user-mention" data-user-id="124288">@oli</span> after the meeting to know how this is going to continue</p>



<a name="158042160"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/158042160" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> oli <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#158042160">(Feb 11 2019 at 16:14)</a>:</h4>
<p>can we pull this topic into <a class="stream" data-stream-id="131828" href="/#narrow/stream/131828-t-compiler">#t-compiler</a> ? While nll is a user that needs it, it's not nll specific</p>



<a name="158042807"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/158042807" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> davidtwco <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#158042807">(Feb 11 2019 at 16:22)</a>:</h4>
<p>it's not possible to move topics between streams, you'd just need to start a new topic.</p>



<a name="158062020"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2352708-new-place/near/158062020" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Santiago Pastorino <a href="https://zulip-archive.rust-lang.org/stream/122657-t-compiler/wg-nll/topic/.2352708-new-place.html#158062020">(Feb 11 2019 at 20:26)</a>:</h4>
<p>have closed the PR we have been working on, after we figure our exactly what to do we can start working on a new one :)</p>



<hr><p>Last updated: Apr 12 2022 at 20:01 UTC</p>
</html>