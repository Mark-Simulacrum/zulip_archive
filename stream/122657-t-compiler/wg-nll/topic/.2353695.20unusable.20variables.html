<html>
<head><meta charset="utf-8"><title>#53695 unusable variables · t-compiler/wg-nll · Zulip Chat Archive</title></head>
<h2>Stream: <a href="https://rust-lang.github.io/zulip_archive/stream/122657-t-compiler/wg-nll/index.html">t-compiler/wg-nll</a></h2>
<h3>Topic: <a href="https://rust-lang.github.io/zulip_archive/stream/122657-t-compiler/wg-nll/topic/.2353695.20unusable.20variables.html">#53695 unusable variables</a></h3>

<hr>

<base href="https://rust-lang.zulipchat.com">

<head><link href="https://rust-lang.github.io/zulip_archive/style.css" rel="stylesheet"></head>

<a name="133798056"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2353695%20unusable%20variables/near/133798056" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> lqd <a href="https://rust-lang.github.io/zulip_archive/stream/122657-t-compiler/wg-nll/topic/.2353695.20unusable.20variables.html#133798056">(Sep 12 2018 at 13:21)</a>:</h4>
<p><span class="user-mention" data-user-id="116083">@pnkfelix</span> is <a href="https://github.com/lqd/rust/commit/30592b35b1c35429418b7965c2eabc5b2ae904aa" target="_blank" title="https://github.com/lqd/rust/commit/30592b35b1c35429418b7965c2eabc5b2ae904aa">this</a> what you had in mind for the <a href="https://github.com/rust-lang/rust/issues/53695" target="_blank" title="https://github.com/rust-lang/rust/issues/53695">#53695</a> experiment ? if so, out of the 6693 NLL ui tests my build ran, 7 failed (as it impacts the diagnostics showing where the borrow is used later).</p>



<a name="133798127"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2353695%20unusable%20variables/near/133798127" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pnkfelix <a href="https://rust-lang.github.io/zulip_archive/stream/122657-t-compiler/wg-nll/topic/.2353695.20unusable.20variables.html#133798127">(Sep 12 2018 at 13:22)</a>:</h4>
<p>yes that looks right</p>



<a name="133798140"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2353695%20unusable%20variables/near/133798140" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pnkfelix <a href="https://rust-lang.github.io/zulip_archive/stream/122657-t-compiler/wg-nll/topic/.2353695.20unusable.20variables.html#133798140">(Sep 12 2018 at 13:22)</a>:</h4>
<p>Is there an easy way for you to share the changes to the diagnostics? Maybe <code>--bless</code> and then diff?</p>



<a name="133798171"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2353695%20unusable%20variables/near/133798171" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pnkfelix <a href="https://rust-lang.github.io/zulip_archive/stream/122657-t-compiler/wg-nll/topic/.2353695.20unusable.20variables.html#133798171">(Sep 12 2018 at 13:23)</a>:</h4>
<p>of course the thing we are probably more concerned about is run-pass failures</p>



<a name="133798173"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2353695%20unusable%20variables/near/133798173" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> lqd <a href="https://rust-lang.github.io/zulip_archive/stream/122657-t-compiler/wg-nll/topic/.2353695.20unusable.20variables.html#133798173">(Sep 12 2018 at 13:23)</a>:</h4>
<p>yeah I'll gather this now</p>



<a name="133798176"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2353695%20unusable%20variables/near/133798176" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> davidtwco <a href="https://rust-lang.github.io/zulip_archive/stream/122657-t-compiler/wg-nll/topic/.2353695.20unusable.20variables.html#133798176">(Sep 12 2018 at 13:23)</a>:</h4>
<p>I got the impression that you'd expect more diagnostics because this would cause things that previously wouldn't error until used to error straight away.</p>



<a name="133798177"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2353695%20unusable%20variables/near/133798177" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pnkfelix <a href="https://rust-lang.github.io/zulip_archive/stream/122657-t-compiler/wg-nll/topic/.2353695.20unusable.20variables.html#133798177">(Sep 12 2018 at 13:23)</a>:</h4>
<p>i.e. places where the injected read causes a previous working test to start failling</p>



<a name="133798222"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2353695%20unusable%20variables/near/133798222" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> lqd <a href="https://rust-lang.github.io/zulip_archive/stream/122657-t-compiler/wg-nll/topic/.2353695.20unusable.20variables.html#133798222">(Sep 12 2018 at 13:24)</a>:</h4>
<p>I can run the run-pass tests without having to go through the UI tests first I assume ?</p>



<a name="133798230"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2353695%20unusable%20variables/near/133798230" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pnkfelix <a href="https://rust-lang.github.io/zulip_archive/stream/122657-t-compiler/wg-nll/topic/.2353695.20unusable.20variables.html#133798230">(Sep 12 2018 at 13:24)</a>:</h4>
<p>If you want to do a run that focuses just on run-pass, I think you do <code>--mode=run-pass</code> to compiletest</p>



<a name="133798251"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2353695%20unusable%20variables/near/133798251" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> davidtwco <a href="https://rust-lang.github.io/zulip_archive/stream/122657-t-compiler/wg-nll/topic/.2353695.20unusable.20variables.html#133798251">(Sep 12 2018 at 13:24)</a>:</h4>
<p>I'd normally do <code>x.py test src/test/run-pass</code> or with the migrated run-pass tests <code>x.py test src/test/ui --test-args run-pass</code>.</p>



<a name="133798264"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2353695%20unusable%20variables/near/133798264" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pnkfelix <a href="https://rust-lang.github.io/zulip_archive/stream/122657-t-compiler/wg-nll/topic/.2353695.20unusable.20variables.html#133798264">(Sep 12 2018 at 13:25)</a>:</h4>
<p>(I'm actually poking at that code now as part of <a href="https://github.com/rust-lang/rust/issues/54047" target="_blank" title="https://github.com/rust-lang/rust/issues/54047">#54047</a></p>



<a name="133798277"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2353695%20unusable%20variables/near/133798277" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> lqd <a href="https://rust-lang.github.io/zulip_archive/stream/122657-t-compiler/wg-nll/topic/.2353695.20unusable.20variables.html#133798277">(Sep 12 2018 at 13:25)</a>:</h4>
<p>ok thank you both, I'll gather more data and report back</p>



<a name="133798291"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2353695%20unusable%20variables/near/133798291" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pnkfelix <a href="https://rust-lang.github.io/zulip_archive/stream/122657-t-compiler/wg-nll/topic/.2353695.20unusable.20variables.html#133798291">(Sep 12 2018 at 13:25)</a>:</h4>
<p><span class="user-mention" data-user-id="116113">@lqd</span> the suggestion from <span class="user-mention" data-user-id="116107">@davidtwco</span> is probably good too.</p>



<a name="133798356"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2353695%20unusable%20variables/near/133798356" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pnkfelix <a href="https://rust-lang.github.io/zulip_archive/stream/122657-t-compiler/wg-nll/topic/.2353695.20unusable.20variables.html#133798356">(Sep 12 2018 at 13:26)</a>:</h4>
<p>if one just did <code>x.py test run-pass</code>, would that check every path that matches <code>.*run-pass.*</code> ?</p>



<a name="133798374"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2353695%20unusable%20variables/near/133798374" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> lqd <a href="https://rust-lang.github.io/zulip_archive/stream/122657-t-compiler/wg-nll/topic/.2353695.20unusable.20variables.html#133798374">(Sep 12 2018 at 13:27)</a>:</h4>
<p>yeah I'll try David's suggestion!</p>



<a name="133798486"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2353695%20unusable%20variables/near/133798486" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> davidtwco <a href="https://rust-lang.github.io/zulip_archive/stream/122657-t-compiler/wg-nll/topic/.2353695.20unusable.20variables.html#133798486">(Sep 12 2018 at 13:28)</a>:</h4>
<p>If I'm not mistaken, it wouldn't. I think that it matches against <a href="https://github.com/rust-lang/rust/blob/master/src/bootstrap/test.rs#L751-L756" target="_blank" title="https://github.com/rust-lang/rust/blob/master/src/bootstrap/test.rs#L751-L756">these paths</a> to find the right step registered in bootstrap.</p>



<a name="133798621"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2353695%20unusable%20variables/near/133798621" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> lqd <a href="https://rust-lang.github.io/zulip_archive/stream/122657-t-compiler/wg-nll/topic/.2353695.20unusable.20variables.html#133798621">(Sep 12 2018 at 13:31)</a>:</h4>
<p><a href="https://gist.github.com/lqd/2d9b8d72de483de8d0a877f08d113f4d" target="_blank" title="https://gist.github.com/lqd/2d9b8d72de483de8d0a877f08d113f4d">ui-tests.diff</a></p>



<a name="133798643"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2353695%20unusable%20variables/near/133798643" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> lqd <a href="https://rust-lang.github.io/zulip_archive/stream/122657-t-compiler/wg-nll/topic/.2353695.20unusable.20variables.html#133798643">(Sep 12 2018 at 13:31)</a>:</h4>
<p>then half of the mir-opt tests failed, and I'll try the run-pass now</p>



<a name="133798720"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2353695%20unusable%20variables/near/133798720" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> davidtwco <a href="https://rust-lang.github.io/zulip_archive/stream/122657-t-compiler/wg-nll/topic/.2353695.20unusable.20variables.html#133798720">(Sep 12 2018 at 13:32)</a>:</h4>
<p>IIRC mir-opt just compares the MIR to make sure it generates what is expected - so adding a new statement would make me expect those to fail.</p>



<a name="133798726"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2353695%20unusable%20variables/near/133798726" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> lqd <a href="https://rust-lang.github.io/zulip_archive/stream/122657-t-compiler/wg-nll/topic/.2353695.20unusable.20variables.html#133798726">(Sep 12 2018 at 13:32)</a>:</h4>
<p>yeah same</p>



<a name="133798773"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2353695%20unusable%20variables/near/133798773" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> lqd <a href="https://rust-lang.github.io/zulip_archive/stream/122657-t-compiler/wg-nll/topic/.2353695.20unusable.20variables.html#133798773">(Sep 12 2018 at 13:33)</a>:</h4>
<p>would it be easier if we saw these on Travis ? that is, if I make a PR, would the builds stop at the ui tests failures or could we see the whole picture of the fallout ?</p>



<a name="133798789"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2353695%20unusable%20variables/near/133798789" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> davidtwco <a href="https://rust-lang.github.io/zulip_archive/stream/122657-t-compiler/wg-nll/topic/.2353695.20unusable.20variables.html#133798789">(Sep 12 2018 at 13:33)</a>:</h4>
<p>It stops after one suite fails.</p>



<a name="133798805"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2353695%20unusable%20variables/near/133798805" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> lqd <a href="https://rust-lang.github.io/zulip_archive/stream/122657-t-compiler/wg-nll/topic/.2353695.20unusable.20variables.html#133798805">(Sep 12 2018 at 13:33)</a>:</h4>
<p>alright :)</p>



<a name="133798816"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2353695%20unusable%20variables/near/133798816" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> davidtwco <a href="https://rust-lang.github.io/zulip_archive/stream/122657-t-compiler/wg-nll/topic/.2353695.20unusable.20variables.html#133798816">(Sep 12 2018 at 13:34)</a>:</h4>
<p>You can run <code>x.py test --no-fail-fast</code> locally and it'll just go through all of the suites.</p>



<a name="133798923"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2353695%20unusable%20variables/near/133798923" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> lqd <a href="https://rust-lang.github.io/zulip_archive/stream/122657-t-compiler/wg-nll/topic/.2353695.20unusable.20variables.html#133798923">(Sep 12 2018 at 13:35)</a>:</h4>
<p><span class="user-mention" data-user-id="116107">@davidtwco</span> how do you clear the cache so tests are not ignored when reran btw ?</p>



<a name="133798939"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2353695%20unusable%20variables/near/133798939" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> lqd <a href="https://rust-lang.github.io/zulip_archive/stream/122657-t-compiler/wg-nll/topic/.2353695.20unusable.20variables.html#133798939">(Sep 12 2018 at 13:35)</a>:</h4>
<p>(I want to check the previous --bless didn't impact the run-pass)</p>



<a name="133798985"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2353695%20unusable%20variables/near/133798985" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> davidtwco <a href="https://rust-lang.github.io/zulip_archive/stream/122657-t-compiler/wg-nll/topic/.2353695.20unusable.20variables.html#133798985">(Sep 12 2018 at 13:36)</a>:</h4>
<p><code>rm -r build/x86_64-unknown-linux-gnu/test</code> (replace that with a similar path for whatever target you're testing against)</p>



<a name="133798996"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2353695%20unusable%20variables/near/133798996" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> davidtwco <a href="https://rust-lang.github.io/zulip_archive/stream/122657-t-compiler/wg-nll/topic/.2353695.20unusable.20variables.html#133798996">(Sep 12 2018 at 13:36)</a>:</h4>
<p>It's something like that.</p>



<a name="133799008"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2353695%20unusable%20variables/near/133799008" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pnkfelix <a href="https://rust-lang.github.io/zulip_archive/stream/122657-t-compiler/wg-nll/topic/.2353695.20unusable.20variables.html#133799008">(Sep 12 2018 at 13:36)</a>:</h4>
<p>I think its <code>build/$TARGET-$HOSTOS/test/</code></p>



<a name="133799044"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2353695%20unusable%20variables/near/133799044" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> davidtwco <a href="https://rust-lang.github.io/zulip_archive/stream/122657-t-compiler/wg-nll/topic/.2353695.20unusable.20variables.html#133799044">(Sep 12 2018 at 13:37)</a>:</h4>
<p>I wrote it once and have CTRL+R'd since.</p>



<a name="133799176"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2353695%20unusable%20variables/near/133799176" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> lqd <a href="https://rust-lang.github.io/zulip_archive/stream/122657-t-compiler/wg-nll/topic/.2353695.20unusable.20variables.html#133799176">(Sep 12 2018 at 13:39)</a>:</h4>
<p>(sorry if this question doesn't make sense) do we need to do something so that the run-pass is ran in nll mode ?</p>



<a name="133799256"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2353695%20unusable%20variables/near/133799256" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> lqd <a href="https://rust-lang.github.io/zulip_archive/stream/122657-t-compiler/wg-nll/topic/.2353695.20unusable.20variables.html#133799256">(Sep 12 2018 at 13:40)</a>:</h4>
<p>(if it doesn't make sense and NLL tests are in there as well: there are no failures)</p>



<a name="133799273"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2353695%20unusable%20variables/near/133799273" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> davidtwco <a href="https://rust-lang.github.io/zulip_archive/stream/122657-t-compiler/wg-nll/topic/.2353695.20unusable.20variables.html#133799273">(Sep 12 2018 at 13:40)</a>:</h4>
<p>UI runs once with the default compare-mode and then again with the NLL compare-mode.</p>



<a name="133799292"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2353695%20unusable%20variables/near/133799292" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> lqd <a href="https://rust-lang.github.io/zulip_archive/stream/122657-t-compiler/wg-nll/topic/.2353695.20unusable.20variables.html#133799292">(Sep 12 2018 at 13:40)</a>:</h4>
<p>yeah but the run-pass doesn't, right ?</p>



<a name="133799320"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2353695%20unusable%20variables/near/133799320" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> davidtwco <a href="https://rust-lang.github.io/zulip_archive/stream/122657-t-compiler/wg-nll/topic/.2353695.20unusable.20variables.html#133799320">(Sep 12 2018 at 13:41)</a>:</h4>
<p>There are some tests that have <code>#![features(nll)]</code> and run on NLL regardless. But then on the compare-mode NLL run, every test is compiled (and run) with that.</p>



<a name="133799328"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2353695%20unusable%20variables/near/133799328" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> davidtwco <a href="https://rust-lang.github.io/zulip_archive/stream/122657-t-compiler/wg-nll/topic/.2353695.20unusable.20variables.html#133799328">(Sep 12 2018 at 13:41)</a>:</h4>
<p>Oh, those in the <code>run-pass</code> suite. No.</p>



<a name="133799345"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2353695%20unusable%20variables/near/133799345" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> davidtwco <a href="https://rust-lang.github.io/zulip_archive/stream/122657-t-compiler/wg-nll/topic/.2353695.20unusable.20variables.html#133799345">(Sep 12 2018 at 13:41)</a>:</h4>
<p>Only those in the <code>run-pass</code> suite that are specifically annotated with NLL will run with NLL.</p>



<a name="133799364"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2353695%20unusable%20variables/near/133799364" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> lqd <a href="https://rust-lang.github.io/zulip_archive/stream/122657-t-compiler/wg-nll/topic/.2353695.20unusable.20variables.html#133799364">(Sep 12 2018 at 13:41)</a>:</h4>
<p>right</p>



<a name="133799468"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2353695%20unusable%20variables/near/133799468" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> lqd <a href="https://rust-lang.github.io/zulip_archive/stream/122657-t-compiler/wg-nll/topic/.2353695.20unusable.20variables.html#133799468">(Sep 12 2018 at 13:43)</a>:</h4>
<p>then however many NLL tests there are in the run-pass suite are seemingly unaffected <span class="user-mention" data-user-id="116083">@pnkfelix</span></p>



<a name="133799541"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2353695%20unusable%20variables/near/133799541" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pnkfelix <a href="https://rust-lang.github.io/zulip_archive/stream/122657-t-compiler/wg-nll/topic/.2353695.20unusable.20variables.html#133799541">(Sep 12 2018 at 13:44)</a>:</h4>
<blockquote>
<p>yeah but the run-pass doesn't, right ?</p>
</blockquote>
<p>this is why  I filed and have been attempting to fix <a href="https://github.com/rust-lang/rust/issues/53764" target="_blank" title="https://github.com/rust-lang/rust/issues/53764">#53764</a></p>



<a name="133799584"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2353695%20unusable%20variables/near/133799584" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> lqd <a href="https://rust-lang.github.io/zulip_archive/stream/122657-t-compiler/wg-nll/topic/.2353695.20unusable.20variables.html#133799584">(Sep 12 2018 at 13:45)</a>:</h4>
<p>sensible :)</p>



<a name="133799590"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2353695%20unusable%20variables/near/133799590" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pnkfelix <a href="https://rust-lang.github.io/zulip_archive/stream/122657-t-compiler/wg-nll/topic/.2353695.20unusable.20variables.html#133799590">(Sep 12 2018 at 13:45)</a>:</h4>
<p>You might be able to make headway by adding <code>-Z borrowck=mir -Z two-phase-borrows</code> to your <code>RUSTFLAGS</code> environment variable</p>



<a name="133799662"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2353695%20unusable%20variables/near/133799662" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> lqd <a href="https://rust-lang.github.io/zulip_archive/stream/122657-t-compiler/wg-nll/topic/.2353695.20unusable.20variables.html#133799662">(Sep 12 2018 at 13:46)</a>:</h4>
<p>let's try that</p>



<a name="133799672"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2353695%20unusable%20variables/near/133799672" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pnkfelix <a href="https://rust-lang.github.io/zulip_archive/stream/122657-t-compiler/wg-nll/topic/.2353695.20unusable.20variables.html#133799672">(Sep 12 2018 at 13:46)</a>:</h4>
<p>Or you could just locally test your experiment atop my PR <a href="https://github.com/rust-lang/rust/issues/54139" target="_blank" title="https://github.com/rust-lang/rust/issues/54139">#54139</a> which migrates 99.9% of the remainder of run-pass to ui</p>



<a name="133799718"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2353695%20unusable%20variables/near/133799718" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> lqd <a href="https://rust-lang.github.io/zulip_archive/stream/122657-t-compiler/wg-nll/topic/.2353695.20unusable.20variables.html#133799718">(Sep 12 2018 at 13:47)</a>:</h4>
<p>something tells me changing rustflags is going to rebuild from scratch though</p>



<a name="133800014"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2353695%20unusable%20variables/near/133800014" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> lqd <a href="https://rust-lang.github.io/zulip_archive/stream/122657-t-compiler/wg-nll/topic/.2353695.20unusable.20variables.html#133800014">(Sep 12 2018 at 13:52)</a>:</h4>
<p><span class="user-mention" data-user-id="116083">@pnkfelix</span> yup :/ maybe it should be one of the other rustflags ?</p>



<a name="133800072"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2353695%20unusable%20variables/near/133800072" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pnkfelix <a href="https://rust-lang.github.io/zulip_archive/stream/122657-t-compiler/wg-nll/topic/.2353695.20unusable.20variables.html#133800072">(Sep 12 2018 at 13:52)</a>:</h4>
<p>are you using <code>x.py</code>, or are you running <code>compiletest</code> directly?</p>



<a name="133800113"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2353695%20unusable%20variables/near/133800113" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> lqd <a href="https://rust-lang.github.io/zulip_archive/stream/122657-t-compiler/wg-nll/topic/.2353695.20unusable.20variables.html#133800113">(Sep 12 2018 at 13:53)</a>:</h4>
<p>x.py</p>



<a name="133800120"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2353695%20unusable%20variables/near/133800120" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> lqd <a href="https://rust-lang.github.io/zulip_archive/stream/122657-t-compiler/wg-nll/topic/.2353695.20unusable.20variables.html#133800120">(Sep 12 2018 at 13:53)</a>:</h4>
<p>david's line to be precise</p>



<a name="133800121"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2353695%20unusable%20variables/near/133800121" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pnkfelix <a href="https://rust-lang.github.io/zulip_archive/stream/122657-t-compiler/wg-nll/topic/.2353695.20unusable.20variables.html#133800121">(Sep 12 2018 at 13:53)</a>:</h4>
<p>what I would do is pass <code>--verbose</code> to <code>x.py test</code> to see how its invoking <code>compiletest</code> to do the <code>run-pass</code> test suite, and then run <code>compiletest</code> directly with <code>RUST_FLAGS</code></p>



<a name="133800129"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2353695%20unusable%20variables/near/133800129" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pnkfelix <a href="https://rust-lang.github.io/zulip_archive/stream/122657-t-compiler/wg-nll/topic/.2353695.20unusable.20variables.html#133800129">(Sep 12 2018 at 13:53)</a>:</h4>
<p>that should (I hope) avoid the rebuild issue</p>



<a name="133800139"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2353695%20unusable%20variables/near/133800139" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pnkfelix <a href="https://rust-lang.github.io/zulip_archive/stream/122657-t-compiler/wg-nll/topic/.2353695.20unusable.20variables.html#133800139">(Sep 12 2018 at 13:54)</a>:</h4>
<p>though if its already rebuilding, this advice is coming too late?</p>



<a name="133800190"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2353695%20unusable%20variables/near/133800190" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> lqd <a href="https://rust-lang.github.io/zulip_archive/stream/122657-t-compiler/wg-nll/topic/.2353695.20unusable.20variables.html#133800190">(Sep 12 2018 at 13:54)</a>:</h4>
<p>yeah I'll try that as soon as it's done rebuilding :)</p>



<a name="133802812"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2353695%20unusable%20variables/near/133802812" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> lqd <a href="https://rust-lang.github.io/zulip_archive/stream/122657-t-compiler/wg-nll/topic/.2353695.20unusable.20variables.html#133802812">(Sep 12 2018 at 14:35)</a>:</h4>
<p><span class="user-mention" data-user-id="116083">@pnkfelix</span> I added nll flags wherever I could, the env var, in compiletest's host-rustcflags and target-rustcflags: <a href="https://gist.githubusercontent.com/lqd/e7c3affd2fb9eb114ffd7a6eeaf684aa/raw/2dc03214aa42ef78c9ebc7fdb817ea881d84e907/nll-run-pass.txt" target="_blank" title="https://gist.githubusercontent.com/lqd/e7c3affd2fb9eb114ffd7a6eeaf684aa/raw/2dc03214aa42ef78c9ebc7fdb817ea881d84e907/nll-run-pass.txt">results</a></p>



<a name="133802917"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2353695%20unusable%20variables/near/133802917" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pnkfelix <a href="https://rust-lang.github.io/zulip_archive/stream/122657-t-compiler/wg-nll/topic/.2353695.20unusable.20variables.html#133802917">(Sep 12 2018 at 14:37)</a>:</h4>
<p>okay that's good. And you already shared the <code>ui/</code> results (because it looks like your build host is one where the PRs to move a lot of <code>run-pass</code> to <code>ui/</code> have landed)</p>



<a name="133802924"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2353695%20unusable%20variables/near/133802924" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pnkfelix <a href="https://rust-lang.github.io/zulip_archive/stream/122657-t-compiler/wg-nll/topic/.2353695.20unusable.20variables.html#133802924">(Sep 12 2018 at 14:37)</a>:</h4>
<p>yes?</p>



<a name="133802947"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2353695%20unusable%20variables/near/133802947" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pnkfelix <a href="https://rust-lang.github.io/zulip_archive/stream/122657-t-compiler/wg-nll/topic/.2353695.20unusable.20variables.html#133802947">(Sep 12 2018 at 14:37)</a>:</h4>
<p>/me goes to look at the <a href="https://gist.github.com/lqd/2d9b8d72de483de8d0a877f08d113f4d" target="_blank" title="https://gist.github.com/lqd/2d9b8d72de483de8d0a877f08d113f4d">diff</a> (of ui results)</p>



<a name="133803035"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2353695%20unusable%20variables/near/133803035" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> lqd <a href="https://rust-lang.github.io/zulip_archive/stream/122657-t-compiler/wg-nll/topic/.2353695.20unusable.20variables.html#133803035">(Sep 12 2018 at 14:38)</a>:</h4>
<p>yes, it's this morning's master</p>



<a name="133803062"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2353695%20unusable%20variables/near/133803062" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pnkfelix <a href="https://rust-lang.github.io/zulip_archive/stream/122657-t-compiler/wg-nll/topic/.2353695.20unusable.20variables.html#133803062">(Sep 12 2018 at 14:39)</a>:</h4>
<p>ugh these diagnostic changes look like they will hurt us</p>



<a name="133803076"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2353695%20unusable%20variables/near/133803076" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pnkfelix <a href="https://rust-lang.github.io/zulip_archive/stream/122657-t-compiler/wg-nll/topic/.2353695.20unusable.20variables.html#133803076">(Sep 12 2018 at 14:39)</a>:</h4>
<p>we should figure out a way to ignore this fake read in terms of how we report the diagnostics</p>



<a name="133803082"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2353695%20unusable%20variables/near/133803082" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> lqd <a href="https://rust-lang.github.io/zulip_archive/stream/122657-t-compiler/wg-nll/topic/.2353695.20unusable.20variables.html#133803082">(Sep 12 2018 at 14:39)</a>:</h4>
<p>yeah :)</p>



<a name="133803223"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2353695%20unusable%20variables/near/133803223" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pnkfelix <a href="https://rust-lang.github.io/zulip_archive/stream/122657-t-compiler/wg-nll/topic/.2353695.20unusable.20variables.html#133803223">(Sep 12 2018 at 14:41)</a>:</h4>
<p>but still, its a pretty small number of diagnostic regressions</p>



<a name="133803268"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2353695%20unusable%20variables/near/133803268" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pnkfelix <a href="https://rust-lang.github.io/zulip_archive/stream/122657-t-compiler/wg-nll/topic/.2353695.20unusable.20variables.html#133803268">(Sep 12 2018 at 14:42)</a>:</h4>
<p>my intuition is that we should consider landing this</p>



<a name="133803270"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2353695%20unusable%20variables/near/133803270" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> lqd <a href="https://rust-lang.github.io/zulip_archive/stream/122657-t-compiler/wg-nll/topic/.2353695.20unusable.20variables.html#133803270">(Sep 12 2018 at 14:42)</a>:</h4>
<p>did this come up before ? either during the recent "making plans" (I don't think it did) or when you discussed this fix with <span class="user-mention" data-user-id="116118">@Matthew Jasper</span> a couple weeks back IIRC ?</p>



<a name="133803272"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2353695%20unusable%20variables/near/133803272" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pnkfelix <a href="https://rust-lang.github.io/zulip_archive/stream/122657-t-compiler/wg-nll/topic/.2353695.20unusable.20variables.html#133803272">(Sep 12 2018 at 14:42)</a>:</h4>
<p><span class="user-mention" data-user-id="116009">@nikomatsakis</span> ^</p>



<a name="133803303"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2353695%20unusable%20variables/near/133803303" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pnkfelix <a href="https://rust-lang.github.io/zulip_archive/stream/122657-t-compiler/wg-nll/topic/.2353695.20unusable.20variables.html#133803303">(Sep 12 2018 at 14:43)</a>:</h4>
<blockquote>
<p>did this come up before ? either during the recent "making plans" (I don't think it did) or when you discussed this fix with <span class="user-mention" data-user-id="116118">@Matthew Jasper</span> a couple weeks back IIRC ?</p>
</blockquote>
<p>"this" being the changes to diagnostics that result from ReadForMatch? or are you referring to something else?</p>



<a name="133803329"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2353695%20unusable%20variables/near/133803329" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> lqd <a href="https://rust-lang.github.io/zulip_archive/stream/122657-t-compiler/wg-nll/topic/.2353695.20unusable.20variables.html#133803329">(Sep 12 2018 at 14:43)</a>:</h4>
<p>yeah, it looks like only this diagnostics suffers, that's good, the fallout is small and can be fixed :)</p>



<a name="133803359"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2353695%20unusable%20variables/near/133803359" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> lqd <a href="https://rust-lang.github.io/zulip_archive/stream/122657-t-compiler/wg-nll/topic/.2353695.20unusable.20variables.html#133803359">(Sep 12 2018 at 14:43)</a>:</h4>
<p>yes, "this" being this diagnostics regression</p>



<a name="133803419"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2353695%20unusable%20variables/near/133803419" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> lqd <a href="https://rust-lang.github.io/zulip_archive/stream/122657-t-compiler/wg-nll/topic/.2353695.20unusable.20variables.html#133803419">(Sep 12 2018 at 14:44)</a>:</h4>
<p>I don't remember it coming up when we talked about "what could possibly go wrong if we add a fake read" then</p>



<a name="133803445"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2353695%20unusable%20variables/near/133803445" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> lqd <a href="https://rust-lang.github.io/zulip_archive/stream/122657-t-compiler/wg-nll/topic/.2353695.20unusable.20variables.html#133803445">(Sep 12 2018 at 14:44)</a>:</h4>
<p>(esp, how we'd fix it, if it did come up)</p>



<a name="133803677"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2353695%20unusable%20variables/near/133803677" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pnkfelix <a href="https://rust-lang.github.io/zulip_archive/stream/122657-t-compiler/wg-nll/topic/.2353695.20unusable.20variables.html#133803677">(Sep 12 2018 at 14:48)</a>:</h4>
<p>its possible I'm wrong and this diagnostic will be an "improvement"</p>



<a name="133803681"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2353695%20unusable%20variables/near/133803681" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pnkfelix <a href="https://rust-lang.github.io/zulip_archive/stream/122657-t-compiler/wg-nll/topic/.2353695.20unusable.20variables.html#133803681">(Sep 12 2018 at 14:48)</a>:</h4>
<p>or at least bring us closer to what AST-borrowck reported in such cases</p>



<a name="133807937"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2353695%20unusable%20variables/near/133807937" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> lqd <a href="https://rust-lang.github.io/zulip_archive/stream/122657-t-compiler/wg-nll/topic/.2353695.20unusable.20variables.html#133807937">(Sep 12 2018 at 15:52)</a>:</h4>
<blockquote>
<p>its possible I'm wrong and this diagnostic will be an "improvement"</p>
</blockquote>
<p>surely not this <em>modified</em> diagnostic ?</p>



<a name="133807966"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2353695%20unusable%20variables/near/133807966" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> davidtwco <a href="https://rust-lang.github.io/zulip_archive/stream/122657-t-compiler/wg-nll/topic/.2353695.20unusable.20variables.html#133807966">(Sep 12 2018 at 15:53)</a>:</h4>
<p>It could be if the original diagnostic was misleading.</p>



<a name="133807977"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2353695%20unusable%20variables/near/133807977" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> davidtwco <a href="https://rust-lang.github.io/zulip_archive/stream/122657-t-compiler/wg-nll/topic/.2353695.20unusable.20variables.html#133807977">(Sep 12 2018 at 15:53)</a>:</h4>
<p>(because we weren't doing a fake read earlier)</p>



<a name="133808084"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2353695%20unusable%20variables/near/133808084" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> lqd <a href="https://rust-lang.github.io/zulip_archive/stream/122657-t-compiler/wg-nll/topic/.2353695.20unusable.20variables.html#133808084">(Sep 12 2018 at 15:55)</a>:</h4>
<p>yeah but this diagnostic only shows up when there is a real read, and shows where that read happens (which ofc in this case is changed by the fake read)</p>



<a name="133808163"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2353695%20unusable%20variables/near/133808163" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> lqd <a href="https://rust-lang.github.io/zulip_archive/stream/122657-t-compiler/wg-nll/topic/.2353695.20unusable.20variables.html#133808163">(Sep 12 2018 at 15:56)</a>:</h4>
<p>but yeah at least it's an interesting thought</p>



<a name="133808187"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2353695%20unusable%20variables/near/133808187" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> lqd <a href="https://rust-lang.github.io/zulip_archive/stream/122657-t-compiler/wg-nll/topic/.2353695.20unusable.20variables.html#133808187">(Sep 12 2018 at 15:56)</a>:</h4>
<p>and we can probably have both the compile error in this case, and the correct diagnostic in all other cases</p>



<a name="133809412"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2353695%20unusable%20variables/near/133809412" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://rust-lang.github.io/zulip_archive/stream/122657-t-compiler/wg-nll/topic/.2353695.20unusable.20variables.html#133809412">(Sep 12 2018 at 16:14)</a>:</h4>
<p>interesting</p>



<a name="133809414"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2353695%20unusable%20variables/near/133809414" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://rust-lang.github.io/zulip_archive/stream/122657-t-compiler/wg-nll/topic/.2353695.20unusable.20variables.html#133809414">(Sep 12 2018 at 16:14)</a>:</h4>
<p>I think fixing the diagnostics shouldn't be too hard</p>



<a name="133812783"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2353695%20unusable%20variables/near/133812783" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> lqd <a href="https://rust-lang.github.io/zulip_archive/stream/122657-t-compiler/wg-nll/topic/.2353695.20unusable.20variables.html#133812783">(Sep 12 2018 at 17:10)</a>:</h4>
<p><span class="user-mention" data-user-id="116009">@nikomatsakis</span> would I need add the fake <code>ReadForMatch </code> <a href="https://github.com/rust-lang/rust/blob/master/src/librustc_mir/build/matches/mod.rs#L308" target="_blank" title="https://github.com/rust-lang/rust/blob/master/src/librustc_mir/build/matches/mod.rs#L308">around here</a> as well ? (this is new from your ascription support PR)</p>



<a name="133812792"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2353695%20unusable%20variables/near/133812792" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://rust-lang.github.io/zulip_archive/stream/122657-t-compiler/wg-nll/topic/.2353695.20unusable.20variables.html#133812792">(Sep 12 2018 at 17:11)</a>:</h4>
<p>yep</p>



<a name="133812801"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2353695%20unusable%20variables/near/133812801" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> lqd <a href="https://rust-lang.github.io/zulip_archive/stream/122657-t-compiler/wg-nll/topic/.2353695.20unusable.20variables.html#133812801">(Sep 12 2018 at 17:11)</a>:</h4>
<p>will do</p>



<a name="133883015"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2353695%20unusable%20variables/near/133883015" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> lqd <a href="https://rust-lang.github.io/zulip_archive/stream/122657-t-compiler/wg-nll/topic/.2353695.20unusable.20variables.html#133883015">(Sep 13 2018 at 13:09)</a>:</h4>
<p><span class="user-mention" data-user-id="116083">@pnkfelix</span> if we wanted to keep these fake reads, how do you think we should fix the diagnostic regression they produce ?</p>



<a name="133883133"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2353695%20unusable%20variables/near/133883133" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pnkfelix <a href="https://rust-lang.github.io/zulip_archive/stream/122657-t-compiler/wg-nll/topic/.2353695.20unusable.20variables.html#133883133">(Sep 13 2018 at 13:11)</a>:</h4>
<p>I'm not sure we should worry about "fixing" it...</p>



<a name="133883143"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2353695%20unusable%20variables/near/133883143" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pnkfelix <a href="https://rust-lang.github.io/zulip_archive/stream/122657-t-compiler/wg-nll/topic/.2353695.20unusable.20variables.html#133883143">(Sep 13 2018 at 13:11)</a>:</h4>
<p>the scenario where this arises is pretty limited</p>



<a name="133883210"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2353695%20unusable%20variables/near/133883210" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pnkfelix <a href="https://rust-lang.github.io/zulip_archive/stream/122657-t-compiler/wg-nll/topic/.2353695.20unusable.20variables.html#133883210">(Sep 13 2018 at 13:12)</a>:</h4>
<p>and in some ways the new diagnostic just points out the core of the problem: if you want to store something in a local, it should not have dangling references to temporaries from the stack that was formed during evaluation of its initializer expression.</p>



<a name="133883217"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2353695%20unusable%20variables/near/133883217" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> lqd <a href="https://rust-lang.github.io/zulip_archive/stream/122657-t-compiler/wg-nll/topic/.2353695.20unusable.20variables.html#133883217">(Sep 13 2018 at 13:12)</a>:</h4>
<p>do you think we should then bless the 6-7 tests diffs ?</p>



<a name="133883227"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2353695%20unusable%20variables/near/133883227" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pnkfelix <a href="https://rust-lang.github.io/zulip_archive/stream/122657-t-compiler/wg-nll/topic/.2353695.20unusable.20variables.html#133883227">(Sep 13 2018 at 13:12)</a>:</h4>
<p>yeah I'm now on the side of blessing them, I think</p>



<a name="133883236"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2353695%20unusable%20variables/near/133883236" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> lqd <a href="https://rust-lang.github.io/zulip_archive/stream/122657-t-compiler/wg-nll/topic/.2353695.20unusable.20variables.html#133883236">(Sep 13 2018 at 13:12)</a>:</h4>
<p>interesting</p>



<a name="133883244"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2353695%20unusable%20variables/near/133883244" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pnkfelix <a href="https://rust-lang.github.io/zulip_archive/stream/122657-t-compiler/wg-nll/topic/.2353695.20unusable.20variables.html#133883244">(Sep 13 2018 at 13:13)</a>:</h4>
<p>might be good to double check with other members of <span class="user-group-mention" data-user-group-id="491">@WG-compiler-nll</span></p>



<a name="133883250"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2353695%20unusable%20variables/near/133883250" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> lqd <a href="https://rust-lang.github.io/zulip_archive/stream/122657-t-compiler/wg-nll/topic/.2353695.20unusable.20variables.html#133883250">(Sep 13 2018 at 13:13)</a>:</h4>
<p>agreed</p>



<a name="133883384"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2353695%20unusable%20variables/near/133883384" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> lqd <a href="https://rust-lang.github.io/zulip_archive/stream/122657-t-compiler/wg-nll/topic/.2353695.20unusable.20variables.html#133883384">(Sep 13 2018 at 13:15)</a>:</h4>
<p>for convenience, the diagnostic differences are <a href="https://gist.github.com/lqd/2d9b8d72de483de8d0a877f08d113f4d" target="_blank" title="https://gist.github.com/lqd/2d9b8d72de483de8d0a877f08d113f4d">here</a></p>



<a name="133886396"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2353695%20unusable%20variables/near/133886396" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://rust-lang.github.io/zulip_archive/stream/122657-t-compiler/wg-nll/topic/.2353695.20unusable.20variables.html#133886396">(Sep 13 2018 at 14:01)</a>:</h4>
<p>hmm, <span class="user-mention" data-user-id="116113">@lqd</span>, I'd probably be ok with blessing them, but I think it <em>may</em> be fairly easy to improve them</p>



<a name="133886443"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2353695%20unusable%20variables/near/133886443" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://rust-lang.github.io/zulip_archive/stream/122657-t-compiler/wg-nll/topic/.2353695.20unusable.20variables.html#133886443">(Sep 13 2018 at 14:01)</a>:</h4>
<p>(where is the PR?)</p>



<a name="133886490"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2353695%20unusable%20variables/near/133886490" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://rust-lang.github.io/zulip_archive/stream/122657-t-compiler/wg-nll/topic/.2353695.20unusable.20variables.html#133886490">(Sep 13 2018 at 14:02)</a>:</h4>
<p>oh, there isn't one?</p>



<a name="133886506"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2353695%20unusable%20variables/near/133886506" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> lqd <a href="https://rust-lang.github.io/zulip_archive/stream/122657-t-compiler/wg-nll/topic/.2353695.20unusable.20variables.html#133886506">(Sep 13 2018 at 14:02)</a>:</h4>
<p>not yet, as I thought we'd fix the regressions first ?</p>



<a name="133886517"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2353695%20unusable%20variables/near/133886517" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> lqd <a href="https://rust-lang.github.io/zulip_archive/stream/122657-t-compiler/wg-nll/topic/.2353695.20unusable.20variables.html#133886517">(Sep 13 2018 at 14:02)</a>:</h4>
<p>the <em>diagnostics</em> regressions that is</p>



<a name="133886662"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2353695%20unusable%20variables/near/133886662" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> lqd <a href="https://rust-lang.github.io/zulip_archive/stream/122657-t-compiler/wg-nll/topic/.2353695.20unusable.20variables.html#133886662">(Sep 13 2018 at 14:04)</a>:</h4>
<p>but if everyone wants to bless these diffs I can make a PR soon</p>



<a name="133887879"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2353695%20unusable%20variables/near/133887879" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://rust-lang.github.io/zulip_archive/stream/122657-t-compiler/wg-nll/topic/.2353695.20unusable.20variables.html#133887879">(Sep 13 2018 at 14:20)</a>:</h4>
<p>I always prefer to have a PR</p>



<a name="133887884"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2353695%20unusable%20variables/near/133887884" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://rust-lang.github.io/zulip_archive/stream/122657-t-compiler/wg-nll/topic/.2353695.20unusable.20variables.html#133887884">(Sep 13 2018 at 14:20)</a>:</h4>
<p>feel free to mark it as <code>[WIP]</code></p>



<a name="133887889"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2353695%20unusable%20variables/near/133887889" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://rust-lang.github.io/zulip_archive/stream/122657-t-compiler/wg-nll/topic/.2353695.20unusable.20variables.html#133887889">(Sep 13 2018 at 14:20)</a>:</h4>
<p>but it makes the workflow easier</p>



<a name="133887908"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2353695%20unusable%20variables/near/133887908" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://rust-lang.github.io/zulip_archive/stream/122657-t-compiler/wg-nll/topic/.2353695.20unusable.20variables.html#133887908">(Sep 13 2018 at 14:20)</a>:</h4>
<blockquote>
<p>feel free to mark it as <code>[WIP]</code></p>
</blockquote>
<p>(in that case, bors won't land it)</p>



<a name="133887916"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2353695%20unusable%20variables/near/133887916" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://rust-lang.github.io/zulip_archive/stream/122657-t-compiler/wg-nll/topic/.2353695.20unusable.20variables.html#133887916">(Sep 13 2018 at 14:20)</a>:</h4>
<p>by this I mean: even if we <em>don't</em> bless the regressions, I'd prefer to have a PR</p>



<a name="133887927"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2353695%20unusable%20variables/near/133887927" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://rust-lang.github.io/zulip_archive/stream/122657-t-compiler/wg-nll/topic/.2353695.20unusable.20variables.html#133887927">(Sep 13 2018 at 14:20)</a>:</h4>
<p>so I can see the diffs, make comments, etc</p>



<a name="133887942"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2353695%20unusable%20variables/near/133887942" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://rust-lang.github.io/zulip_archive/stream/122657-t-compiler/wg-nll/topic/.2353695.20unusable.20variables.html#133887942">(Sep 13 2018 at 14:21)</a>:</h4>
<p>actually my preferred workflow is this:</p>
<p>Always run the tests with <code>--bless</code>, so we can easily see the diffs</p>



<a name="133887965"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2353695%20unusable%20variables/near/133887965" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://rust-lang.github.io/zulip_archive/stream/122657-t-compiler/wg-nll/topic/.2353695.20unusable.20variables.html#133887965">(Sep 13 2018 at 14:21)</a>:</h4>
<p>then we can separately decide whether to land it in that state or not :)</p>



<a name="133888218"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2353695%20unusable%20variables/near/133888218" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> lqd <a href="https://rust-lang.github.io/zulip_archive/stream/122657-t-compiler/wg-nll/topic/.2353695.20unusable.20variables.html#133888218">(Sep 13 2018 at 14:24)</a>:</h4>
<p>:) ok I'll push the type ascription commit + the blessed tests to my branch and make a PR then</p>



<a name="133889525"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2353695%20unusable%20variables/near/133889525" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://rust-lang.github.io/zulip_archive/stream/122657-t-compiler/wg-nll/topic/.2353695.20unusable.20variables.html#133889525">(Sep 13 2018 at 14:41)</a>:</h4>
<p>cool :)</p>



<a name="133890107"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2353695%20unusable%20variables/near/133890107" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> lqd <a href="https://rust-lang.github.io/zulip_archive/stream/122657-t-compiler/wg-nll/topic/.2353695.20unusable.20variables.html#133890107">(Sep 13 2018 at 14:49)</a>:</h4>
<p><span class="user-mention" data-user-id="116107">@davidtwco</span> we mentioned the mir-opt suite yesterday, do you know how to update them ? --bless doesn't seem to do so</p>



<a name="133890227"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2353695%20unusable%20variables/near/133890227" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> davidtwco <a href="https://rust-lang.github.io/zulip_archive/stream/122657-t-compiler/wg-nll/topic/.2353695.20unusable.20variables.html#133890227">(Sep 13 2018 at 14:51)</a>:</h4>
<p>I think I've had to do it once. I think I just wrote an extra line until it passed.</p>



<a name="133890370"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2353695%20unusable%20variables/near/133890370" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> lqd <a href="https://rust-lang.github.io/zulip_archive/stream/122657-t-compiler/wg-nll/topic/.2353695.20unusable.20variables.html#133890370">(Sep 13 2018 at 14:53)</a>:</h4>
<p>oh</p>



<a name="133890375"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2353695%20unusable%20variables/near/133890375" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> lqd <a href="https://rust-lang.github.io/zulip_archive/stream/122657-t-compiler/wg-nll/topic/.2353695.20unusable.20variables.html#133890375">(Sep 13 2018 at 14:53)</a>:</h4>
<p>alright thank you</p>



<a name="133890500"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2353695%20unusable%20variables/near/133890500" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> lqd <a href="https://rust-lang.github.io/zulip_archive/stream/122657-t-compiler/wg-nll/topic/.2353695.20unusable.20variables.html#133890500">(Sep 13 2018 at 14:55)</a>:</h4>
<p>since they all fail now I was wondering if there was an expected way to fix those, or at least not deal with them until we have to, when the PR is finished</p>



<a name="133890650"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2353695%20unusable%20variables/near/133890650" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> lqd <a href="https://rust-lang.github.io/zulip_archive/stream/122657-t-compiler/wg-nll/topic/.2353695.20unusable.20variables.html#133890650">(Sep 13 2018 at 14:56)</a>:</h4>
<p>I guess it'll just fail on Travis, but at least I'd have wanted to see if these were the only ones failing now, I don't know how close to the end of the tests these are run by x.py test</p>



<a name="133891063"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2353695%20unusable%20variables/near/133891063" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://rust-lang.github.io/zulip_archive/stream/122657-t-compiler/wg-nll/topic/.2353695.20unusable.20variables.html#133891063">(Sep 13 2018 at 15:02)</a>:</h4>
<blockquote>
<p>since they all fail now I was wondering if there was an expected way to fix those, or at least not deal with them until we have to, when the PR is finished</p>
</blockquote>
<p>you have to edit them by hand to make the "expected" match the actual</p>



<a name="133891068"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2353695%20unusable%20variables/near/133891068" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://rust-lang.github.io/zulip_archive/stream/122657-t-compiler/wg-nll/topic/.2353695.20unusable.20variables.html#133891068">(Sep 13 2018 at 15:02)</a>:</h4>
<p>plausibly we should remove them</p>



<a name="133891070"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2353695%20unusable%20variables/near/133891070" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://rust-lang.github.io/zulip_archive/stream/122657-t-compiler/wg-nll/topic/.2353695.20unusable.20variables.html#133891070">(Sep 13 2018 at 15:03)</a>:</h4>
<p>they are annoying</p>



<a name="133891081"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2353695%20unusable%20variables/near/133891081" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://rust-lang.github.io/zulip_archive/stream/122657-t-compiler/wg-nll/topic/.2353695.20unusable.20variables.html#133891081">(Sep 13 2018 at 15:03)</a>:</h4>
<p>and/or port them to ui tests</p>



<a name="133891085"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2353695%20unusable%20variables/near/133891085" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://rust-lang.github.io/zulip_archive/stream/122657-t-compiler/wg-nll/topic/.2353695.20unusable.20variables.html#133891085">(Sep 13 2018 at 15:03)</a>:</h4>
<p>they were good when we were just bootstrapping but we have better a test suite  now</p>



<a name="133891086"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2353695%20unusable%20variables/near/133891086" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://rust-lang.github.io/zulip_archive/stream/122657-t-compiler/wg-nll/topic/.2353695.20unusable.20variables.html#133891086">(Sep 13 2018 at 15:03)</a>:</h4>
<p>(I mean the NLL ones specifically)</p>



<a name="133892903"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2353695%20unusable%20variables/near/133892903" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> lqd <a href="https://rust-lang.github.io/zulip_archive/stream/122657-t-compiler/wg-nll/topic/.2353695.20unusable.20variables.html#133892903">(Sep 13 2018 at 15:23)</a>:</h4>
<p>opened <a href="https://github.com/rust-lang/rust/pull/54188" target="_blank" title="https://github.com/rust-lang/rust/pull/54188">https://github.com/rust-lang/rust/pull/54188</a> for discussion, so it's very WIP, but here goes nothing</p>



<a name="133958924"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2353695%20unusable%20variables/near/133958924" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://rust-lang.github.io/zulip_archive/stream/122657-t-compiler/wg-nll/topic/.2353695.20unusable.20variables.html#133958924">(Sep 14 2018 at 15:07)</a>:</h4>
<p><span class="user-mention" data-user-id="116113">@lqd</span> I left a comment.  I think that if we <em>want</em> to identify this case and give a custom error, it would be relatively easy to do so.</p>



<a name="133958930"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2353695%20unusable%20variables/near/133958930" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://rust-lang.github.io/zulip_archive/stream/122657-t-compiler/wg-nll/topic/.2353695.20unusable.20variables.html#133958930">(Sep 14 2018 at 15:07)</a>:</h4>
<p>I think the current error is not <em>that</em> bad</p>



<a name="133958962"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2353695%20unusable%20variables/near/133958962" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://rust-lang.github.io/zulip_archive/stream/122657-t-compiler/wg-nll/topic/.2353695.20unusable.20variables.html#133958962">(Sep 14 2018 at 15:07)</a>:</h4>
<p>so maybe it's fine as is</p>



<a name="133958976"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2353695%20unusable%20variables/near/133958976" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> lqd <a href="https://rust-lang.github.io/zulip_archive/stream/122657-t-compiler/wg-nll/topic/.2353695.20unusable.20variables.html#133958976">(Sep 14 2018 at 15:08)</a>:</h4>
<p><span class="user-mention" data-user-id="116009">@nikomatsakis</span> what would ideally want ?</p>



<a name="133959021"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2353695%20unusable%20variables/near/133959021" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://rust-lang.github.io/zulip_archive/stream/122657-t-compiler/wg-nll/topic/.2353695.20unusable.20variables.html#133959021">(Sep 14 2018 at 15:08)</a>:</h4>
<p>I left a suggestion in the issue but that's I think a key question :)</p>



<a name="133959046"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2353695%20unusable%20variables/near/133959046" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> lqd <a href="https://rust-lang.github.io/zulip_archive/stream/122657-t-compiler/wg-nll/topic/.2353695.20unusable.20variables.html#133959046">(Sep 14 2018 at 15:08)</a>:</h4>
<p>I can do what is suggested in the issue</p>



<a name="133959066"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2353695%20unusable%20variables/near/133959066" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://rust-lang.github.io/zulip_archive/stream/122657-t-compiler/wg-nll/topic/.2353695.20unusable.20variables.html#133959066">(Sep 14 2018 at 15:08)</a>:</h4>
<p>actually</p>



<a name="133959068"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2353695%20unusable%20variables/near/133959068" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://rust-lang.github.io/zulip_archive/stream/122657-t-compiler/wg-nll/topic/.2353695.20unusable.20variables.html#133959068">(Sep 14 2018 at 15:08)</a>:</h4>
<p>maybe just this?</p>



<a name="133959076"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2353695%20unusable%20variables/near/133959076" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://rust-lang.github.io/zulip_archive/stream/122657-t-compiler/wg-nll/topic/.2353695.20unusable.20variables.html#133959076">(Sep 14 2018 at 15:08)</a>:</h4>
<div class="codehilite"><pre><span></span>error[E0597]: `pointer` does not live long enough
  --&gt; $DIR/wf-method-late-bound-regions.rs:30:18
   |
LL |     let dangling = {
   |         -------- borrow later stored here
LL |         let pointer = Box::new(42);
LL |         f2.xmute(&amp;pointer)
   |                  ^^^^^^^^ borrowed value does not live long enough
LL |     };
   | - `pointer` dropped here while still borrowed
</pre></div>



<a name="133959091"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2353695%20unusable%20variables/near/133959091" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://rust-lang.github.io/zulip_archive/stream/122657-t-compiler/wg-nll/topic/.2353695.20unusable.20variables.html#133959091">(Sep 14 2018 at 15:09)</a>:</h4>
<p>that is, "borrow later stored here" and not "borrow later used here"?</p>



<a name="133959122"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2353695%20unusable%20variables/near/133959122" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> lqd <a href="https://rust-lang.github.io/zulip_archive/stream/122657-t-compiler/wg-nll/topic/.2353695.20unusable.20variables.html#133959122">(Sep 14 2018 at 15:09)</a>:</h4>
<p>oh interesting</p>



<a name="133959229"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2353695%20unusable%20variables/near/133959229" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pnkfelix <a href="https://rust-lang.github.io/zulip_archive/stream/122657-t-compiler/wg-nll/topic/.2353695.20unusable.20variables.html#133959229">(Sep 14 2018 at 15:10)</a>:</h4>
<p>next PL I invent, the destination of an imperative update is going to be on the RHS.</p>



<a name="133959248"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2353695%20unusable%20variables/near/133959248" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pnkfelix <a href="https://rust-lang.github.io/zulip_archive/stream/122657-t-compiler/wg-nll/topic/.2353695.20unusable.20variables.html#133959248">(Sep 14 2018 at 15:10)</a>:</h4>
<p>(and its going to use <code>=:</code> as the operator!)</p>



<a name="133959263"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2353695%20unusable%20variables/near/133959263" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> lqd <a href="https://rust-lang.github.io/zulip_archive/stream/122657-t-compiler/wg-nll/topic/.2353695.20unusable.20variables.html#133959263">(Sep 14 2018 at 15:11)</a>:</h4>
<p>with the <code>FakeReadCause</code> the message in the 0597 error can be adjusted easily I think ?</p>



<a name="133959390"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2353695%20unusable%20variables/near/133959390" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> lqd <a href="https://rust-lang.github.io/zulip_archive/stream/122657-t-compiler/wg-nll/topic/.2353695.20unusable.20variables.html#133959390">(Sep 14 2018 at 15:12)</a>:</h4>
<p>sounds straightforward</p>



<a name="133959444"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2353695%20unusable%20variables/near/133959444" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://rust-lang.github.io/zulip_archive/stream/122657-t-compiler/wg-nll/topic/.2353695.20unusable.20variables.html#133959444">(Sep 14 2018 at 15:13)</a>:</h4>
<p>seems fairly easy</p>



<a name="133959496"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2353695%20unusable%20variables/near/133959496" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> lqd <a href="https://rust-lang.github.io/zulip_archive/stream/122657-t-compiler/wg-nll/topic/.2353695.20unusable.20variables.html#133959496">(Sep 14 2018 at 15:13)</a>:</h4>
<p>yeah, ok I'll do that</p>



<a name="133959552"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2353695%20unusable%20variables/near/133959552" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> lqd <a href="https://rust-lang.github.io/zulip_archive/stream/122657-t-compiler/wg-nll/topic/.2353695.20unusable.20variables.html#133959552">(Sep 14 2018 at 15:14)</a>:</h4>
<p>I was wondering what kind of comment would be need at the point where we inject the fake read ?</p>



<a name="133959573"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2353695%20unusable%20variables/near/133959573" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> lqd <a href="https://rust-lang.github.io/zulip_archive/stream/122657-t-compiler/wg-nll/topic/.2353695.20unusable.20variables.html#133959573">(Sep 14 2018 at 15:14)</a>:</h4>
<p>what I have was tailored to the original experiment: "let's see what this breaks"</p>



<a name="133959636"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2353695%20unusable%20variables/near/133959636" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> lqd <a href="https://rust-lang.github.io/zulip_archive/stream/122657-t-compiler/wg-nll/topic/.2353695.20unusable.20variables.html#133959636">(Sep 14 2018 at 15:15)</a>:</h4>
<p>that is <a href="https://github.com/rust-lang/rust/pull/54188/files#diff-ef9c98f22bf95e3bda12c849d5550cedR268" target="_blank" title="https://github.com/rust-lang/rust/pull/54188/files#diff-ef9c98f22bf95e3bda12c849d5550cedR268">starting here</a></p>



<a name="133960149"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2353695%20unusable%20variables/near/133960149" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://rust-lang.github.io/zulip_archive/stream/122657-t-compiler/wg-nll/topic/.2353695.20unusable.20variables.html#133960149">(Sep 14 2018 at 15:20)</a>:</h4>
<p>yeah, I think something like</p>



<a name="133960329"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2353695%20unusable%20variables/near/133960329" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://rust-lang.github.io/zulip_archive/stream/122657-t-compiler/wg-nll/topic/.2353695.20unusable.20variables.html#133960329">(Sep 14 2018 at 15:22)</a>:</h4>
<p>Officially, the semantics of</p>
<div class="codehilite"><pre><span></span>let pattern = &lt;expr&gt;;
</pre></div>


<p>is that <code>&lt;expr&gt;</code> is evaluated into a temporary and then this temporary is matched into the pattern.<br>
However, if we see the simple pattern <code>let var = &lt;expr&gt;</code>, we optimize this to evaluate <code>&lt;expr&gt;</code> directly<br>
into the variable <code>var</code>. This is mostly unobservable, but in some cases it can affect the borrow checker,<br>
as in <a href="https://github.com/rust-lang/rust/issues/53695" target="_blank" title="https://github.com/rust-lang/rust/issues/53695">#53695</a>. Therefore, we insert a "fake read" here to ensure that we get appropriate errors.</p>



<a name="133960334"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2353695%20unusable%20variables/near/133960334" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://rust-lang.github.io/zulip_archive/stream/122657-t-compiler/wg-nll/topic/.2353695.20unusable.20variables.html#133960334">(Sep 14 2018 at 15:22)</a>:</h4>
<p>we could put more detail, but perhaps that suffices</p>



<a name="133960534"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2353695%20unusable%20variables/near/133960534" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> lqd <a href="https://rust-lang.github.io/zulip_archive/stream/122657-t-compiler/wg-nll/topic/.2353695.20unusable.20variables.html#133960534">(Sep 14 2018 at 15:25)</a>:</h4>
<p>nice</p>



<a name="133960592"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2353695%20unusable%20variables/near/133960592" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> lqd <a href="https://rust-lang.github.io/zulip_archive/stream/122657-t-compiler/wg-nll/topic/.2353695.20unusable.20variables.html#133960592">(Sep 14 2018 at 15:26)</a>:</h4>
<p>thanks niko</p>



<a name="133965534"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2353695%20unusable%20variables/near/133965534" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> lqd <a href="https://rust-lang.github.io/zulip_archive/stream/122657-t-compiler/wg-nll/topic/.2353695.20unusable.20variables.html#133965534">(Sep 14 2018 at 16:56)</a>:</h4>
<p><span class="user-mention" data-user-id="116009">@nikomatsakis</span> in refactoring <code>ReadForMatch</code> into <code>FakeRead</code> do I also need to rename the <code>-Z nll_dont_emit_read_for_match</code> flag ?</p>



<a name="133965967"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2353695%20unusable%20variables/near/133965967" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> lqd <a href="https://rust-lang.github.io/zulip_archive/stream/122657-t-compiler/wg-nll/topic/.2353695.20unusable.20variables.html#133965967">(Sep 14 2018 at 17:04)</a>:</h4>
<p>(I assume this user-facing flag can stay the same, only needing renaming its documentation to update the kind of statement to its new name)</p>



<a name="133969012"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2353695%20unusable%20variables/near/133969012" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://rust-lang.github.io/zulip_archive/stream/122657-t-compiler/wg-nll/topic/.2353695.20unusable.20variables.html#133969012">(Sep 14 2018 at 17:59)</a>:</h4>
<p><span class="user-mention" data-user-id="116113">@lqd</span> I would not change the <code>-Z</code> flag</p>



<a name="133973230"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2353695%20unusable%20variables/near/133973230" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> lqd <a href="https://rust-lang.github.io/zulip_archive/stream/122657-t-compiler/wg-nll/topic/.2353695.20unusable.20variables.html#133973230">(Sep 14 2018 at 19:11)</a>:</h4>
<p>haha Matthew's PR just landed as I was finishing this</p>



<a name="133973940"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2353695%20unusable%20variables/near/133973940" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://rust-lang.github.io/zulip_archive/stream/122657-t-compiler/wg-nll/topic/.2353695.20unusable.20variables.html#133973940">(Sep 14 2018 at 19:23)</a>:</h4>
<p>which?</p>



<a name="133973985"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2353695%20unusable%20variables/near/133973985" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> lqd <a href="https://rust-lang.github.io/zulip_archive/stream/122657-t-compiler/wg-nll/topic/.2353695.20unusable.20variables.html#133973985">(Sep 14 2018 at 19:24)</a>:</h4>
<p><a href="https://github.com/rust-lang/rust/issues/54088" target="_blank" title="https://github.com/rust-lang/rust/issues/54088">#54088</a></p>



<a name="133973997"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2353695%20unusable%20variables/near/133973997" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> lqd <a href="https://rust-lang.github.io/zulip_archive/stream/122657-t-compiler/wg-nll/topic/.2353695.20unusable.20variables.html#133973997">(Sep 14 2018 at 19:24)</a>:</h4>
<p>just a tiny conflict no biggie :)</p>



<a name="133974008"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2353695%20unusable%20variables/near/133974008" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> lqd <a href="https://rust-lang.github.io/zulip_archive/stream/122657-t-compiler/wg-nll/topic/.2353695.20unusable.20variables.html#133974008">(Sep 14 2018 at 19:24)</a>:</h4>
<p>I'll rebase and push shortly</p>



<a name="133974268"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2353695%20unusable%20variables/near/133974268" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://rust-lang.github.io/zulip_archive/stream/122657-t-compiler/wg-nll/topic/.2353695.20unusable.20variables.html#133974268">(Sep 14 2018 at 19:31)</a>:</h4>
<p><span class="user-mention" data-user-id="116113">@lqd</span> I left a few nits on the PR</p>



<a name="133974271"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2353695%20unusable%20variables/near/133974271" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://rust-lang.github.io/zulip_archive/stream/122657-t-compiler/wg-nll/topic/.2353695.20unusable.20variables.html#133974271">(Sep 14 2018 at 19:31)</a>:</h4>
<p>just about where to put the comments</p>



<a name="133974272"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2353695%20unusable%20variables/near/133974272" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> lqd <a href="https://rust-lang.github.io/zulip_archive/stream/122657-t-compiler/wg-nll/topic/.2353695.20unusable.20variables.html#133974272">(Sep 14 2018 at 19:31)</a>:</h4>
<p><span class="user-mention" data-user-id="116009">@nikomatsakis</span> I've updated <a href="https://github.com/rust-lang/rust/issues/54188" target="_blank" title="https://github.com/rust-lang/rust/issues/54188">#54188</a> to add the "borrow later stored here" message</p>



<a name="133974273"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2353695%20unusable%20variables/near/133974273" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://rust-lang.github.io/zulip_archive/stream/122657-t-compiler/wg-nll/topic/.2353695.20unusable.20variables.html#133974273">(Sep 14 2018 at 19:31)</a>:</h4>
<p>looks great! <span class="emoji emoji-1f4af" title="100">:100:</span></p>



<a name="133974277"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2353695%20unusable%20variables/near/133974277" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> lqd <a href="https://rust-lang.github.io/zulip_archive/stream/122657-t-compiler/wg-nll/topic/.2353695.20unusable.20variables.html#133974277">(Sep 14 2018 at 19:31)</a>:</h4>
<p>dang you're fast</p>



<a name="133974348"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2353695%20unusable%20variables/near/133974348" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> lqd <a href="https://rust-lang.github.io/zulip_archive/stream/122657-t-compiler/wg-nll/topic/.2353695.20unusable.20variables.html#133974348">(Sep 14 2018 at 19:32)</a>:</h4>
<p>thanks for the comments, they're spot on</p>



<a name="133974474"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2353695%20unusable%20variables/near/133974474" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> lqd <a href="https://rust-lang.github.io/zulip_archive/stream/122657-t-compiler/wg-nll/topic/.2353695.20unusable.20variables.html#133974474">(Sep 14 2018 at 19:35)</a>:</h4>
<p>there is a <a href="https://github.com/rust-lang/rust/blob/7dc76cedc7269f02648aa4ffae5e4b360fa86d40/src/librustc_mir/build/matches/mod.rs#L148-L154" target="_blank" title="https://github.com/rust-lang/rust/blob/7dc76cedc7269f02648aa4ffae5e4b360fa86d40/src/librustc_mir/build/matches/mod.rs#L148-L154">decent comment</a> at the fake read match insertion point, do you want me to move it to FakeReadCause::ForMatch ?</p>



<a name="133974558"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2353695%20unusable%20variables/near/133974558" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://rust-lang.github.io/zulip_archive/stream/122657-t-compiler/wg-nll/topic/.2353695.20unusable.20variables.html#133974558">(Sep 14 2018 at 19:37)</a>:</h4>
<p>I would move it in the same way</p>



<a name="133974847"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2353695%20unusable%20variables/near/133974847" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> lqd <a href="https://rust-lang.github.io/zulip_archive/stream/122657-t-compiler/wg-nll/topic/.2353695.20unusable.20variables.html#133974847">(Sep 14 2018 at 19:43)</a>:</h4>
<p>(tests will still fail as I still haven't updated the mir-opt suite yet, which I will try to do tomorrow as I'm 2h late for dinner ;)</p>



<a name="133975214"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2353695%20unusable%20variables/near/133975214" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> lqd <a href="https://rust-lang.github.io/zulip_archive/stream/122657-t-compiler/wg-nll/topic/.2353695.20unusable.20variables.html#133975214">(Sep 14 2018 at 19:50)</a>:</h4>
<p>(and probably why it should still stay as a WIP PR ?)</p>



<a name="133977144"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2353695%20unusable%20variables/near/133977144" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> lqd <a href="https://rust-lang.github.io/zulip_archive/stream/122657-t-compiler/wg-nll/topic/.2353695.20unusable.20variables.html#133977144">(Sep 14 2018 at 20:29)</a>:</h4>
<p>(comments moved, helper function hopefully acceptable -- I'll update the tests tomorrow though I really gotta go)</p>



<a name="133985256"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2353695%20unusable%20variables/near/133985256" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> lqd <a href="https://rust-lang.github.io/zulip_archive/stream/122657-t-compiler/wg-nll/topic/.2353695.20unusable.20variables.html#133985256">(Sep 14 2018 at 23:16)</a>:</h4>
<p>I'm unsure about <a href="https://github.com/rust-lang/rust/pull/54188/files#diff-0f6e0a8f7d78f19e578a987acec63115R219" target="_blank" title="https://github.com/rust-lang/rust/pull/54188/files#diff-0f6e0a8f7d78f19e578a987acec63115R219">this change</a>: without checking the fake read cause, the fake reads for lets would show up in this <code>min_const_fn</code> check for a match (that matches were detected in const fn because of their fake reads was surprising but ok). Maybe these tests are run after <code>mir-opt</code>so we'll see how they go</p>



<a name="133988208"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2353695%20unusable%20variables/near/133988208" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://rust-lang.github.io/zulip_archive/stream/122657-t-compiler/wg-nll/topic/.2353695.20unusable.20variables.html#133988208">(Sep 15 2018 at 00:32)</a>:</h4>
<p>hmm, that might want to just check for <code>FakeReadCause::ForMatch</code>...but all in all that feels a bit hokey in any case</p>



<a name="133988213"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2353695%20unusable%20variables/near/133988213" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://rust-lang.github.io/zulip_archive/stream/122657-t-compiler/wg-nll/topic/.2353695.20unusable.20variables.html#133988213">(Sep 15 2018 at 00:32)</a>:</h4>
<p>it's ok though <code>min_const_fn</code> is a bit of a hack</p>



<a name="133988215"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2353695%20unusable%20variables/near/133988215" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://rust-lang.github.io/zulip_archive/stream/122657-t-compiler/wg-nll/topic/.2353695.20unusable.20variables.html#133988215">(Sep 15 2018 at 00:32)</a>:</h4>
<p>(temporary hack)</p>



<a name="133988221"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2353695%20unusable%20variables/near/133988221" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://rust-lang.github.io/zulip_archive/stream/122657-t-compiler/wg-nll/topic/.2353695.20unusable.20variables.html#133988221">(Sep 15 2018 at 00:32)</a>:</h4>
<p>I am not sure whether <code>let x</code> was meant to be included (cc <span class="user-mention" data-user-id="124288">@Oli</span>?)</p>



<a name="133991064"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2353695%20unusable%20variables/near/133991064" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> lqd <a href="https://rust-lang.github.io/zulip_archive/stream/122657-t-compiler/wg-nll/topic/.2353695.20unusable.20variables.html#133991064">(Sep 15 2018 at 01:57)</a>:</h4>
<p>I <em>think</em> min_const_fn was so minimal that <code>let x </code> is not included. Either way, it would make more sense to look for FakeReadCause::ForMatch so I'll do this in the mornng</p>



<a name="133998097"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2353695%20unusable%20variables/near/133998097" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> oli <a href="https://rust-lang.github.io/zulip_archive/stream/122657-t-compiler/wg-nll/topic/.2353695.20unusable.20variables.html#133998097">(Sep 15 2018 at 05:42)</a>:</h4>
<p>Yes, <code>let</code> bindigs are forbidden. But even if you remove the fake read, you should still get a min const fn error for the switch terminator</p>



<a name="134000777"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2353695%20unusable%20variables/near/134000777" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> lqd <a href="https://rust-lang.github.io/zulip_archive/stream/122657-t-compiler/wg-nll/topic/.2353695.20unusable.20variables.html#134000777">(Sep 15 2018 at 07:24)</a>:</h4>
<p>hmm the CI seems to have passed so maybe everything works</p>



<a name="134001099"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2353695%20unusable%20variables/near/134001099" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> lqd <a href="https://rust-lang.github.io/zulip_archive/stream/122657-t-compiler/wg-nll/topic/.2353695.20unusable.20variables.html#134001099">(Sep 15 2018 at 07:36)</a>:</h4>
<p>(most likely it doesn't run all the the tests that bors does, as I think ui-fulldeps fails rn — maybe not, I'm confused. It seems to have been run in Travis, while some fail locally, for reasons of help messages disappearing when proc macros panic <span class="emoji emoji-1f615" title="confused">:confused:</span>  )</p>



<a name="134005869"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2353695%20unusable%20variables/near/134005869" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://rust-lang.github.io/zulip_archive/stream/122657-t-compiler/wg-nll/topic/.2353695.20unusable.20variables.html#134005869">(Sep 15 2018 at 10:13)</a>:</h4>
<p><span class="user-mention" data-user-id="116113">@lqd</span> <a href="https://play.rust-lang.org/?gist=a8a4e69c7b7175a07dc0005509a00119&amp;version=nightly&amp;mode=debug&amp;edition=2015" target="_blank" title="https://play.rust-lang.org/?gist=a8a4e69c7b7175a07dc0005509a00119&amp;version=nightly&amp;mode=debug&amp;edition=2015">it seems you are correct</a>, but I would guess that this must be being enforced in some other way.</p>



<a name="134005890"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2353695%20unusable%20variables/near/134005890" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> lqd <a href="https://rust-lang.github.io/zulip_archive/stream/122657-t-compiler/wg-nll/topic/.2353695.20unusable.20variables.html#134005890">(Sep 15 2018 at 10:13)</a>:</h4>
<p>yeah through mir assignments IIRC</p>



<a name="134005956"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2353695%20unusable%20variables/near/134005956" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> lqd <a href="https://rust-lang.github.io/zulip_archive/stream/122657-t-compiler/wg-nll/topic/.2353695.20unusable.20variables.html#134005956">(Sep 15 2018 at 10:14)</a>:</h4>
<p><span class="user-mention" data-user-id="116009">@nikomatsakis</span>  in any case I'll defer to your judgment on how to proceed :) (in the meantime I'll take care of the crater run results)</p>



<a name="134006092"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2353695%20unusable%20variables/near/134006092" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://rust-lang.github.io/zulip_archive/stream/122657-t-compiler/wg-nll/topic/.2353695.20unusable.20variables.html#134006092">(Sep 15 2018 at 10:17)</a>:</h4>
<p><span class="user-mention" data-user-id="116113">@lqd</span> in that case it seems fine to leave it the way you had it.</p>



<a name="134006098"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2353695%20unusable%20variables/near/134006098" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://rust-lang.github.io/zulip_archive/stream/122657-t-compiler/wg-nll/topic/.2353695.20unusable.20variables.html#134006098">(Sep 15 2018 at 10:17)</a>:</h4>
<p>I .. presume we have tests of all this stuff</p>



<a name="134006102"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2353695%20unusable%20variables/near/134006102" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://rust-lang.github.io/zulip_archive/stream/122657-t-compiler/wg-nll/topic/.2353695.20unusable.20variables.html#134006102">(Sep 15 2018 at 10:18)</a>:</h4>
<p>can't remember</p>



<a name="134006142"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2353695%20unusable%20variables/near/134006142" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://rust-lang.github.io/zulip_archive/stream/122657-t-compiler/wg-nll/topic/.2353695.20unusable.20variables.html#134006142">(Sep 15 2018 at 10:18)</a>:</h4>
<p>but dear me I would hope so</p>



<a name="134006148"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2353695%20unusable%20variables/near/134006148" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://rust-lang.github.io/zulip_archive/stream/122657-t-compiler/wg-nll/topic/.2353695.20unusable.20variables.html#134006148">(Sep 15 2018 at 10:18)</a>:</h4>
<p>by "this stuff" I mean the things that are excluded by <code>min_const_fn</code></p>



<a name="134006153"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2353695%20unusable%20variables/near/134006153" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> lqd <a href="https://rust-lang.github.io/zulip_archive/stream/122657-t-compiler/wg-nll/topic/.2353695.20unusable.20variables.html#134006153">(Sep 15 2018 at 10:18)</a>:</h4>
<p>I remember oli and centril going back and forth on tests about this, for a while</p>



<a name="134006162"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2353695%20unusable%20variables/near/134006162" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://rust-lang.github.io/zulip_archive/stream/122657-t-compiler/wg-nll/topic/.2353695.20unusable.20variables.html#134006162">(Sep 15 2018 at 10:18)</a>:</h4>
<p>in that case, it seems like if we want to grow, we can update the tests, and we'll find this case readily enough</p>



<a name="134006166"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2353695%20unusable%20variables/near/134006166" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://rust-lang.github.io/zulip_archive/stream/122657-t-compiler/wg-nll/topic/.2353695.20unusable.20variables.html#134006166">(Sep 15 2018 at 10:18)</a>:</h4>
<p>yes, I remember that</p>



<a name="134006167"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2353695%20unusable%20variables/near/134006167" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> lqd <a href="https://rust-lang.github.io/zulip_archive/stream/122657-t-compiler/wg-nll/topic/.2353695.20unusable.20variables.html#134006167">(Sep 15 2018 at 10:18)</a>:</h4>
<p>and they wanted to be very conservative, and strongly validate it, so I presume we do as well</p>



<a name="134108332"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2353695%20unusable%20variables/near/134108332" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> lqd <a href="https://rust-lang.github.io/zulip_archive/stream/122657-t-compiler/wg-nll/topic/.2353695.20unusable.20variables.html#134108332">(Sep 17 2018 at 15:37)</a>:</h4>
<p><span class="user-mention" data-user-id="116009">@nikomatsakis</span> is there anything more I can do for <a href="https://github.com/rust-lang/rust/issues/54188" target="_blank" title="https://github.com/rust-lang/rust/issues/54188">#54188</a> ?</p>



<a name="134108423"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2353695%20unusable%20variables/near/134108423" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://rust-lang.github.io/zulip_archive/stream/122657-t-compiler/wg-nll/topic/.2353695.20unusable.20variables.html#134108423">(Sep 17 2018 at 15:38)</a>:</h4>
<p>r+</p>



<a name="134108427"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2353695%20unusable%20variables/near/134108427" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://rust-lang.github.io/zulip_archive/stream/122657-t-compiler/wg-nll/topic/.2353695.20unusable.20variables.html#134108427">(Sep 17 2018 at 15:38)</a>:</h4>
<p>looks good to me!</p>



<a name="134108460"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2353695%20unusable%20variables/near/134108460" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> lqd <a href="https://rust-lang.github.io/zulip_archive/stream/122657-t-compiler/wg-nll/topic/.2353695.20unusable.20variables.html#134108460">(Sep 17 2018 at 15:39)</a>:</h4>
<p>yay :)</p>



<a name="134172287"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2353695%20unusable%20variables/near/134172287" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> lqd <a href="https://rust-lang.github.io/zulip_archive/stream/122657-t-compiler/wg-nll/topic/.2353695.20unusable.20variables.html#134172287">(Sep 18 2018 at 15:12)</a>:</h4>
<p><span class="user-mention" data-user-id="116009">@nikomatsakis</span> btw I've rebased <a href="https://github.com/rust-lang/rust/issues/54188" target="_blank" title="https://github.com/rust-lang/rust/issues/54188">#54188</a></p>



<a name="134173563"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2353695%20unusable%20variables/near/134173563" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> lqd <a href="https://rust-lang.github.io/zulip_archive/stream/122657-t-compiler/wg-nll/topic/.2353695.20unusable.20variables.html#134173563">(Sep 18 2018 at 15:34)</a>:</h4>
<p><span class="user-mention" data-user-id="116107">@davidtwco</span> thanks :)</p>



<a name="134294061"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2353695%20unusable%20variables/near/134294061" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> lqd <a href="https://rust-lang.github.io/zulip_archive/stream/122657-t-compiler/wg-nll/topic/.2353695.20unusable.20variables.html#134294061">(Sep 20 2018 at 08:17)</a>:</h4>
<p>hum, I'm not sure I understand why this linker error pops up in <a href="https://github.com/rust-lang/rust/pull/54188#issuecomment-422986265" target="_blank" title="https://github.com/rust-lang/rust/pull/54188#issuecomment-422986265">#54188</a> ? should I look into it in more detail <span class="user-mention" data-user-id="116009">@nikomatsakis</span> ?</p>



<a name="134298046"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2353695%20unusable%20variables/near/134298046" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pnkfelix <a href="https://rust-lang.github.io/zulip_archive/stream/122657-t-compiler/wg-nll/topic/.2353695.20unusable.20variables.html#134298046">(Sep 20 2018 at 09:39)</a>:</h4>
<p>It might be spurious; we've been having some linker issues connected to codegen-units and/or incremental compilation</p>



<a name="134298131"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2353695%20unusable%20variables/near/134298131" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pnkfelix <a href="https://rust-lang.github.io/zulip_archive/stream/122657-t-compiler/wg-nll/topic/.2353695.20unusable.20variables.html#134298131">(Sep 20 2018 at 09:40)</a>:</h4>
<p>Also, just in case you didn't notice, this has the <code>// run-rustfix</code> attribute; so the thing being compiled when linker fails is the <code>extern-const.fixed</code></p>



<a name="134298151"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2353695%20unusable%20variables/near/134298151" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pnkfelix <a href="https://rust-lang.github.io/zulip_archive/stream/122657-t-compiler/wg-nll/topic/.2353695.20unusable.20variables.html#134298151">(Sep 20 2018 at 09:42)</a>:</h4>
<p>(which has replaced the <code>const C: u8</code> with a <code>static C: u8;</code>.) I don't see how that could be related to your PR, unless somehow you've affected codegen for statics as well as <code>let</code>-bound variables...?</p>



<a name="134298687"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2353695%20unusable%20variables/near/134298687" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> lqd <a href="https://rust-lang.github.io/zulip_archive/stream/122657-t-compiler/wg-nll/topic/.2353695.20unusable.20variables.html#134298687">(Sep 20 2018 at 09:55)</a>:</h4>
<p>I'm confused about why the codegen would only be affected after running rustfix, what does it do to statics that regular compilation and linking don't, and are thus unaffected ?</p>



<a name="134298735"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2353695%20unusable%20variables/near/134298735" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> lqd <a href="https://rust-lang.github.io/zulip_archive/stream/122657-t-compiler/wg-nll/topic/.2353695.20unusable.20variables.html#134298735">(Sep 20 2018 at 09:56)</a>:</h4>
<p>but it may very well be such a case</p>



<a name="134298908"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2353695%20unusable%20variables/near/134298908" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> lqd <a href="https://rust-lang.github.io/zulip_archive/stream/122657-t-compiler/wg-nll/topic/.2353695.20unusable.20variables.html#134298908">(Sep 20 2018 at 10:00)</a>:</h4>
<p>locally I did just have an error for the ui/duplicate/dupe-symbols-7.rs case (ui tests in compare mode) and passes successfully if I run tests again</p>



<a name="134298962"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2353695%20unusable%20variables/near/134298962" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> lqd <a href="https://rust-lang.github.io/zulip_archive/stream/122657-t-compiler/wg-nll/topic/.2353695.20unusable.20variables.html#134298962">(Sep 20 2018 at 10:01)</a>:</h4>
<p>I'll try to reproduce these rustfix cases at lunch break</p>



<a name="134299274"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2353695%20unusable%20variables/near/134299274" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> lqd <a href="https://rust-lang.github.io/zulip_archive/stream/122657-t-compiler/wg-nll/topic/.2353695.20unusable.20variables.html#134299274">(Sep 20 2018 at 10:09)</a>:</h4>
<p>(to be clearer, I would be less confused if we had zero other tests similar <code>static C: u8</code> which would also fail, before getting to the rustfixed tests :)</p>



<a name="134299951"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2353695%20unusable%20variables/near/134299951" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pnkfelix <a href="https://rust-lang.github.io/zulip_archive/stream/122657-t-compiler/wg-nll/topic/.2353695.20unusable.20variables.html#134299951">(Sep 20 2018 at 10:23)</a>:</h4>
<p>part of the problem is that when we get failures connected to codegen-units, they are often connected to how the code was partitioned into those units, which can mean that similar looking code can have wildly different probabilty of causing a link-time failure...</p>



<a name="134300102"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2353695%20unusable%20variables/near/134300102" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> lqd <a href="https://rust-lang.github.io/zulip_archive/stream/122657-t-compiler/wg-nll/topic/.2353695.20unusable.20variables.html#134300102">(Sep 20 2018 at 10:26)</a>:</h4>
<p>yeah :/ anyway I'm just rerunning everything locally again, and then I'll focus on these specific tests</p>



<a name="134300106"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2353695%20unusable%20variables/near/134300106" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pnkfelix <a href="https://rust-lang.github.io/zulip_archive/stream/122657-t-compiler/wg-nll/topic/.2353695.20unusable.20variables.html#134300106">(Sep 20 2018 at 10:26)</a>:</h4>
<p>Also, I somehow was unaware of codegen-units being set to N (where N &gt; 1) by default in all modes. Which happened in PR <a href="https://github.com/rust-lang/rust/issues/46910" target="_blank" title="https://github.com/rust-lang/rust/issues/46910">#46910</a> (landed December 25 2017...)</p>



<a name="134300124"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2353695%20unusable%20variables/near/134300124" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pnkfelix <a href="https://rust-lang.github.io/zulip_archive/stream/122657-t-compiler/wg-nll/topic/.2353695.20unusable.20variables.html#134300124">(Sep 20 2018 at 10:27)</a>:</h4>
<p>It was probably a good thing in terms of finding codegen-units related bugs, compared to our prior mode of only turning codegen-units on for non-optimizing mode, while our test suite was running with optimization on by default...</p>



<a name="134300170"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2353695%20unusable%20variables/near/134300170" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pnkfelix <a href="https://rust-lang.github.io/zulip_archive/stream/122657-t-compiler/wg-nll/topic/.2353695.20unusable.20variables.html#134300170">(Sep 20 2018 at 10:28)</a>:</h4>
<p>But the compiler team needs to make sure to be proactive about identifying such bugs and then fixing them...</p>



<a name="134300184"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2353695%20unusable%20variables/near/134300184" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pnkfelix <a href="https://rust-lang.github.io/zulip_archive/stream/122657-t-compiler/wg-nll/topic/.2353695.20unusable.20variables.html#134300184">(Sep 20 2018 at 10:29)</a>:</h4>
<p>I'm going to cc <span class="user-mention" data-user-id="124287">@mw</span> on your PR in the meantime, as they might have insight that I lack about how to address this</p>



<a name="134300188"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2353695%20unusable%20variables/near/134300188" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> lqd <a href="https://rust-lang.github.io/zulip_archive/stream/122657-t-compiler/wg-nll/topic/.2353695.20unusable.20variables.html#134300188">(Sep 20 2018 at 10:29)</a>:</h4>
<p>mixing this with "interesting" cases of incremental, multithreading llvm codegen, the various LTOs configurations, etc :)</p>



<a name="134300247"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2353695%20unusable%20variables/near/134300247" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pnkfelix <a href="https://rust-lang.github.io/zulip_archive/stream/122657-t-compiler/wg-nll/topic/.2353695.20unusable.20variables.html#134300247">(Sep 20 2018 at 10:30)</a>:</h4>
<p>in fact, I will also nominate the PR since it would be nice to discuss this during the compiler team meeting later today</p>



<a name="134300251"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2353695%20unusable%20variables/near/134300251" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> lqd <a href="https://rust-lang.github.io/zulip_archive/stream/122657-t-compiler/wg-nll/topic/.2353695.20unusable.20variables.html#134300251">(Sep 20 2018 at 10:30)</a>:</h4>
<p>didn't you also discuss this in the <a href="https://github.com/rust-lang/rust/issues/53695#issuecomment-421126482" target="_blank" title="https://github.com/rust-lang/rust/issues/53695#issuecomment-421126482">lang meeting</a> last week ?</p>



<a name="134300269"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2353695%20unusable%20variables/near/134300269" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> lqd <a href="https://rust-lang.github.io/zulip_archive/stream/122657-t-compiler/wg-nll/topic/.2353695.20unusable.20variables.html#134300269">(Sep 20 2018 at 10:31)</a>:</h4>
<p>it would be good in any case, since it's a bit low-key but has possibly impact over lots of things</p>



<a name="134300311"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2353695%20unusable%20variables/near/134300311" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pnkfelix <a href="https://rust-lang.github.io/zulip_archive/stream/122657-t-compiler/wg-nll/topic/.2353695.20unusable.20variables.html#134300311">(Sep 20 2018 at 10:32)</a>:</h4>
<p>We didn't discuss codegen-unit linker issues in lang meeting</p>



<a name="134300315"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2353695%20unusable%20variables/near/134300315" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> lqd <a href="https://rust-lang.github.io/zulip_archive/stream/122657-t-compiler/wg-nll/topic/.2353695.20unusable.20variables.html#134300315">(Sep 20 2018 at 10:32)</a>:</h4>
<p>oh understood</p>



<a name="134300319"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2353695%20unusable%20variables/near/134300319" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pnkfelix <a href="https://rust-lang.github.io/zulip_archive/stream/122657-t-compiler/wg-nll/topic/.2353695.20unusable.20variables.html#134300319">(Sep 20 2018 at 10:32)</a>:</h4>
<p>That is, the lang meeting was about the change to the language semantics, but I just want to talk with compiler team about the test failure you encoutered.</p>



<a name="134300339"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2353695%20unusable%20variables/near/134300339" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> lqd <a href="https://rust-lang.github.io/zulip_archive/stream/122657-t-compiler/wg-nll/topic/.2353695.20unusable.20variables.html#134300339">(Sep 20 2018 at 10:33)</a>:</h4>
<p>hopefully I'll discover more about whether this is spurious or reproducible today before the meeting</p>



<a name="134300921"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2353695%20unusable%20variables/near/134300921" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> lqd <a href="https://rust-lang.github.io/zulip_archive/stream/122657-t-compiler/wg-nll/topic/.2353695.20unusable.20variables.html#134300921">(Sep 20 2018 at 10:47)</a>:</h4>
<p><span class="user-mention" data-user-id="116083">@pnkfelix</span> do you know how to run the rustfix test suite ? it is not <code>x.py test src/test/rustfix</code> apparently</p>



<a name="134300966"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2353695%20unusable%20variables/near/134300966" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pnkfelix <a href="https://rust-lang.github.io/zulip_archive/stream/122657-t-compiler/wg-nll/topic/.2353695.20unusable.20variables.html#134300966">(Sep 20 2018 at 10:48)</a>:</h4>
<p>I think you just run the <code>ui</code> tests</p>



<a name="134300970"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2353695%20unusable%20variables/near/134300970" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pnkfelix <a href="https://rust-lang.github.io/zulip_archive/stream/122657-t-compiler/wg-nll/topic/.2353695.20unusable.20variables.html#134300970">(Sep 20 2018 at 10:48)</a>:</h4>
<p>the <code>// run-rustfix</code> attribute is what is causing that <code>rustfix</code> to be run</p>



<a name="134300979"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2353695%20unusable%20variables/near/134300979" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pnkfelix <a href="https://rust-lang.github.io/zulip_archive/stream/122657-t-compiler/wg-nll/topic/.2353695.20unusable.20variables.html#134300979">(Sep 20 2018 at 10:48)</a>:</h4>
<p>but you may also be able to just cut-and-paste the <code>rustc</code> invocation that the log includes</p>



<a name="134301007"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2353695%20unusable%20variables/near/134301007" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pnkfelix <a href="https://rust-lang.github.io/zulip_archive/stream/122657-t-compiler/wg-nll/topic/.2353695.20unusable.20variables.html#134301007">(Sep 20 2018 at 10:49)</a>:</h4>
<p>because the output from <code>rustfix</code> is actually checked into the repository</p>



<a name="134301019"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2353695%20unusable%20variables/near/134301019" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pnkfelix <a href="https://rust-lang.github.io/zulip_archive/stream/122657-t-compiler/wg-nll/topic/.2353695.20unusable.20variables.html#134301019">(Sep 20 2018 at 10:49)</a>:</h4>
<p>(part of <code>// run-rustfix</code> is comparing the output that rustfix to the checked in file)</p>



<a name="134301084"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2353695%20unusable%20variables/near/134301084" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pnkfelix <a href="https://rust-lang.github.io/zulip_archive/stream/122657-t-compiler/wg-nll/topic/.2353695.20unusable.20variables.html#134301084">(Sep 20 2018 at 10:50)</a>:</h4>
<p>So you may be able to just run this:</p>
<div class="codehilite"><pre><span></span>&quot;/checkout/obj/build/x86_64-unknown-linux-gnu/stage2/bin/rustc&quot; &quot;/checkout/src/test/ui/extern/extern-const.fixed&quot; &quot;--target=x86_64-unknown-linux-gnu&quot; &quot;--error-format&quot; &quot;json&quot; &quot;-Zui-testing&quot; &quot;-C&quot; &quot;prefer-dynamic&quot; &quot;-o&quot; &quot;/checkout/obj/build/x86_64-unknown-linux-gnu/test/ui/extern/extern-const/a&quot; &quot;-Crpath&quot; &quot;-Zunstable-options&quot; &quot;-Lnative=/checkout/obj/build/x86_64-unknown-linux-gnu/native/rust-test-helpers&quot; &quot;-Z&quot; &quot;continue-parse-after-error&quot; &quot;-L&quot; &quot;/checkout/obj/build/x86_64-unknown-linux-gnu/test/ui/extern/extern-const/auxiliary&quot;
</pre></div>


<p>(adapted accordingly to your local machine)</p>



<a name="134301085"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2353695%20unusable%20variables/near/134301085" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> lqd <a href="https://rust-lang.github.io/zulip_archive/stream/122657-t-compiler/wg-nll/topic/.2353695.20unusable.20variables.html#134301085">(Sep 20 2018 at 10:50)</a>:</h4>
<p>it's run as part of the existing ui tests ?</p>



<a name="134301092"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2353695%20unusable%20variables/near/134301092" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pnkfelix <a href="https://rust-lang.github.io/zulip_archive/stream/122657-t-compiler/wg-nll/topic/.2353695.20unusable.20variables.html#134301092">(Sep 20 2018 at 10:50)</a>:</h4>
<p>yes i think so</p>



<a name="134301099"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2353695%20unusable%20variables/near/134301099" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> lqd <a href="https://rust-lang.github.io/zulip_archive/stream/122657-t-compiler/wg-nll/topic/.2353695.20unusable.20variables.html#134301099">(Sep 20 2018 at 10:50)</a>:</h4>
<p>if so, then no it's not reproducible over here :/</p>



<a name="134301104"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2353695%20unusable%20variables/near/134301104" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pnkfelix <a href="https://rust-lang.github.io/zulip_archive/stream/122657-t-compiler/wg-nll/topic/.2353695.20unusable.20variables.html#134301104">(Sep 20 2018 at 10:50)</a>:</h4>
<p>Yeah I'm not totally surprised to hear that</p>



<a name="134301125"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2353695%20unusable%20variables/near/134301125" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pnkfelix <a href="https://rust-lang.github.io/zulip_archive/stream/122657-t-compiler/wg-nll/topic/.2353695.20unusable.20variables.html#134301125">(Sep 20 2018 at 10:51)</a>:</h4>
<p>I don't know how deterministic our codegen-units partitioning is</p>



<a name="134301127"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2353695%20unusable%20variables/near/134301127" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> lqd <a href="https://rust-lang.github.io/zulip_archive/stream/122657-t-compiler/wg-nll/topic/.2353695.20unusable.20variables.html#134301127">(Sep 20 2018 at 10:51)</a>:</h4>
<p>apart from the spurious error I mentioned earlier, which went away when rerunning tests, they seem to pass</p>



<a name="134301138"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2353695%20unusable%20variables/near/134301138" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pnkfelix <a href="https://rust-lang.github.io/zulip_archive/stream/122657-t-compiler/wg-nll/topic/.2353695.20unusable.20variables.html#134301138">(Sep 20 2018 at 10:51)</a>:</h4>
<p>you <em>could</em> try manually pumping up the codegen units for that one test</p>



<a name="134301217"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2353695%20unusable%20variables/near/134301217" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pnkfelix <a href="https://rust-lang.github.io/zulip_archive/stream/122657-t-compiler/wg-nll/topic/.2353695.20unusable.20variables.html#134301217">(Sep 20 2018 at 10:52)</a>:</h4>
<p>(this is why I want to discuss this among the compiler team; to get feedback about whether pumping up the #codegen-units is a decent strategy to increase likelihood of such problems...)</p>



<a name="134301234"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2353695%20unusable%20variables/near/134301234" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> lqd <a href="https://rust-lang.github.io/zulip_archive/stream/122657-t-compiler/wg-nll/topic/.2353695.20unusable.20variables.html#134301234">(Sep 20 2018 at 10:52)</a>:</h4>
<p>agreed, this seems worthwhile to discuss :)</p>



<a name="134301235"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2353695%20unusable%20variables/near/134301235" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pnkfelix <a href="https://rust-lang.github.io/zulip_archive/stream/122657-t-compiler/wg-nll/topic/.2353695.20unusable.20variables.html#134301235">(Sep 20 2018 at 10:52)</a>:</h4>
<p>I've seen github comments with <span class="user-mention" data-user-id="124287">@mw</span> advising others to pump up to 99 (or even 999?) codegen-units to try to replicate bugs...</p>



<a name="134301257"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2353695%20unusable%20variables/near/134301257" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pnkfelix <a href="https://rust-lang.github.io/zulip_archive/stream/122657-t-compiler/wg-nll/topic/.2353695.20unusable.20variables.html#134301257">(Sep 20 2018 at 10:53)</a>:</h4>
<p>The other Q I have is whether a retry might just work</p>



<a name="134301267"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2353695%20unusable%20variables/near/134301267" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pnkfelix <a href="https://rust-lang.github.io/zulip_archive/stream/122657-t-compiler/wg-nll/topic/.2353695.20unusable.20variables.html#134301267">(Sep 20 2018 at 10:53)</a>:</h4>
<p>or if the codegen-unit partitioning is sufficiently deterministic that we do not expect retry's to fix the problem.</p>



<a name="134301364"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2353695%20unusable%20variables/near/134301364" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> lqd <a href="https://rust-lang.github.io/zulip_archive/stream/122657-t-compiler/wg-nll/topic/.2353695.20unusable.20variables.html#134301364">(Sep 20 2018 at 10:54)</a>:</h4>
<p>I guess it'll be another interesting question for the meeting</p>



<a name="134301393"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2353695%20unusable%20variables/near/134301393" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> lqd <a href="https://rust-lang.github.io/zulip_archive/stream/122657-t-compiler/wg-nll/topic/.2353695.20unusable.20variables.html#134301393">(Sep 20 2018 at 10:55)</a>:</h4>
<p>even though y'all might have talked about it in the "spurious ui tests failures" topic in #t-compiler</p>



<a name="134301397"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2353695%20unusable%20variables/near/134301397" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pnkfelix <a href="https://rust-lang.github.io/zulip_archive/stream/122657-t-compiler/wg-nll/topic/.2353695.20unusable.20variables.html#134301397">(Sep 20 2018 at 10:55)</a>:</h4>
<p>Yeah I'm taking notes on them as I think of them (in the github issue)</p>



<a name="134301405"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2353695%20unusable%20variables/near/134301405" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pnkfelix <a href="https://rust-lang.github.io/zulip_archive/stream/122657-t-compiler/wg-nll/topic/.2353695.20unusable.20variables.html#134301405">(Sep 20 2018 at 10:55)</a>:</h4>
<p>well I feel like that topic is perhaps broader</p>



<a name="134301407"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2353695%20unusable%20variables/near/134301407" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pnkfelix <a href="https://rust-lang.github.io/zulip_archive/stream/122657-t-compiler/wg-nll/topic/.2353695.20unusable.20variables.html#134301407">(Sep 20 2018 at 10:55)</a>:</h4>
<p>(but I could be wrong)</p>



<a name="134301533"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2353695%20unusable%20variables/near/134301533" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> lqd <a href="https://rust-lang.github.io/zulip_archive/stream/122657-t-compiler/wg-nll/topic/.2353695.20unusable.20variables.html#134301533">(Sep 20 2018 at 10:57)</a>:</h4>
<p>running the command manually does fail reliably!</p>



<a name="134301587"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2353695%20unusable%20variables/near/134301587" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pnkfelix <a href="https://rust-lang.github.io/zulip_archive/stream/122657-t-compiler/wg-nll/topic/.2353695.20unusable.20variables.html#134301587">(Sep 20 2018 at 10:58)</a>:</h4>
<p>oh you've reproduced locally then?</p>



<a name="134301588"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2353695%20unusable%20variables/near/134301588" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pnkfelix <a href="https://rust-lang.github.io/zulip_archive/stream/122657-t-compiler/wg-nll/topic/.2353695.20unusable.20variables.html#134301588">(Sep 20 2018 at 10:58)</a>:</h4>
<p>that is a good sign</p>



<a name="134301623"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2353695%20unusable%20variables/near/134301623" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> lqd <a href="https://rust-lang.github.io/zulip_archive/stream/122657-t-compiler/wg-nll/topic/.2353695.20unusable.20variables.html#134301623">(Sep 20 2018 at 10:59)</a>:</h4>
<p>it might be using already built things though</p>



<a name="134301627"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2353695%20unusable%20variables/near/134301627" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> lqd <a href="https://rust-lang.github.io/zulip_archive/stream/122657-t-compiler/wg-nll/topic/.2353695.20unusable.20variables.html#134301627">(Sep 20 2018 at 10:59)</a>:</h4>
<p>but yeah, maybe a good sign</p>



<a name="134301638"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2353695%20unusable%20variables/near/134301638" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pnkfelix <a href="https://rust-lang.github.io/zulip_archive/stream/122657-t-compiler/wg-nll/topic/.2353695.20unusable.20variables.html#134301638">(Sep 20 2018 at 10:59)</a>:</h4>
<p>Yes; I had thought from what you said above that you were not seeing the linker failure locally under any scenario</p>



<a name="134301649"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2353695%20unusable%20variables/near/134301649" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> lqd <a href="https://rust-lang.github.io/zulip_archive/stream/122657-t-compiler/wg-nll/topic/.2353695.20unusable.20variables.html#134301649">(Sep 20 2018 at 11:00)</a>:</h4>
<p>I do not see the error running the ui tests</p>



<a name="134301715"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2353695%20unusable%20variables/near/134301715" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> lqd <a href="https://rust-lang.github.io/zulip_archive/stream/122657-t-compiler/wg-nll/topic/.2353695.20unusable.20variables.html#134301715">(Sep 20 2018 at 11:00)</a>:</h4>
<p>as you said, I tried adapting the command failing on CI to my build, and this fails</p>



<a name="134301725"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2353695%20unusable%20variables/near/134301725" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pnkfelix <a href="https://rust-lang.github.io/zulip_archive/stream/122657-t-compiler/wg-nll/topic/.2353695.20unusable.20variables.html#134301725">(Sep 20 2018 at 11:00)</a>:</h4>
<p>This is how <code>compiletest</code> is being invoked: </p>
<div class="codehilite"><pre><span></span>&quot;/checkout/obj/build/x86_64-unknown-linux-gnu/stage0-tools-bin/compiletest&quot; &quot;--compile-lib-path&quot; &quot;/checkout/obj/build/x86_64-unknown-linux-gnu/stage2/lib&quot; &quot;--run-lib-path&quot; &quot;/checkout/obj/build/x86_64-unknown-linux-gnu/stage2/lib/rustlib/x86_64-unknown-linux-gnu/lib&quot; &quot;--rustc-path&quot; &quot;/checkout/obj/build/x86_64-unknown-linux-gnu/stage2/bin/rustc&quot; &quot;--src-base&quot; &quot;/checkout/src/test/ui&quot; &quot;--build-base&quot; &quot;/checkout/obj/build/x86_64-unknown-linux-gnu/test/ui&quot; &quot;--stage-id&quot; &quot;stage2-x86_64-unknown-linux-gnu&quot; &quot;--mode&quot; &quot;ui&quot; &quot;--target&quot; &quot;x86_64-unknown-linux-gnu&quot; &quot;--host&quot; &quot;x86_64-unknown-linux-gnu&quot; &quot;--llvm-filecheck&quot; &quot;/checkout/obj/build/x86_64-unknown-linux-gnu/llvm/build/bin/FileCheck&quot; &quot;--host-rustcflags&quot; &quot;-Crpath -Zunstable-options &quot; &quot;--target-rustcflags&quot; &quot;-Crpath -Zunstable-options  -Lnative=/checkout/obj/build/x86_64-unknown-linux-gnu/native/rust-test-helpers&quot; &quot;--docck-python&quot; &quot;/usr/bin/python2.7&quot; &quot;--lldb-python&quot; &quot;/usr/bin/python2.7&quot; &quot;--gdb&quot; &quot;/usr/bin/gdb&quot; &quot;--llvm-version&quot; &quot;8.0.0svn\n&quot; &quot;--cc&quot; &quot;&quot; &quot;--cxx&quot; &quot;&quot; &quot;--cflags&quot; &quot;&quot; &quot;--llvm-components&quot; &quot;&quot; &quot;--llvm-cxxflags&quot; &quot;&quot; &quot;--adb-path&quot; &quot;adb&quot; &quot;--adb-test-dir&quot; &quot;/data/tmp/work&quot; &quot;--android-cross-path&quot; &quot;&quot; &quot;--color&quot; &quot;always&quot;
</pre></div>


<p>so you could try adapting that locally</p>



<a name="134301744"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2353695%20unusable%20variables/near/134301744" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pnkfelix <a href="https://rust-lang.github.io/zulip_archive/stream/122657-t-compiler/wg-nll/topic/.2353695.20unusable.20variables.html#134301744">(Sep 20 2018 at 11:01)</a>:</h4>
<p>(you'd want to make sure you delete the stamp file, if any, for the test that is failing first)</p>



<a name="134301793"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2353695%20unusable%20variables/near/134301793" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pnkfelix <a href="https://rust-lang.github.io/zulip_archive/stream/122657-t-compiler/wg-nll/topic/.2353695.20unusable.20variables.html#134301793">(Sep 20 2018 at 11:02)</a>:</h4>
<p><del>it looks like the <code>x.py</code> command being run is <code>x.py check</code></del> (which ... I am not familiar with; I only use <code>x.py build</code> and <code>x.py test</code> ...)</p>



<a name="134301913"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2353695%20unusable%20variables/near/134301913" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pnkfelix <a href="https://rust-lang.github.io/zulip_archive/stream/122657-t-compiler/wg-nll/topic/.2353695.20unusable.20variables.html#134301913">(Sep 20 2018 at 11:04)</a>:</h4>
<p>And that is confusing to me, because I would have thought that <code>x.py check</code>'s running of <code>cargo check</code> would not link code ... but maybe I misunderstand the scope of <code>cargo check</code></p>



<a name="134301950"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2353695%20unusable%20variables/near/134301950" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pnkfelix <a href="https://rust-lang.github.io/zulip_archive/stream/122657-t-compiler/wg-nll/topic/.2353695.20unusable.20variables.html#134301950">(Sep 20 2018 at 11:05)</a>:</h4>
<p>oh no I'm totally wrong</p>



<a name="134301958"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2353695%20unusable%20variables/near/134301958" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> lqd <a href="https://rust-lang.github.io/zulip_archive/stream/122657-t-compiler/wg-nll/topic/.2353695.20unusable.20variables.html#134301958">(Sep 20 2018 at 11:05)</a>:</h4>
<p><span class="user-mention" data-user-id="116083">@pnkfelix</span> you and me rn <a href="https://i.imgur.com/UaLpJOK.png" target="_blank" title="https://i.imgur.com/UaLpJOK.png">https://i.imgur.com/UaLpJOK.png</a></p>
<div class="message_inline_image"><a href="https://i.imgur.com/UaLpJOK.png" target="_blank" title="https://i.imgur.com/UaLpJOK.png"><img src="https://i.imgur.com/UaLpJOK.png"></a></div>



<a name="134301960"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2353695%20unusable%20variables/near/134301960" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pnkfelix <a href="https://rust-lang.github.io/zulip_archive/stream/122657-t-compiler/wg-nll/topic/.2353695.20unusable.20variables.html#134301960">(Sep 20 2018 at 11:05)</a>:</h4>
<p>it is using <code>x.py test</code>; its the <em>Makefile</em> target that is named <code>check</code></p>



<a name="134302689"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2353695%20unusable%20variables/near/134302689" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> lqd <a href="https://rust-lang.github.io/zulip_archive/stream/122657-t-compiler/wg-nll/topic/.2353695.20unusable.20variables.html#134302689">(Sep 20 2018 at 11:19)</a>:</h4>
<p><span class="user-mention" data-user-id="116083">@pnkfelix</span> I remove the built tests, run ./x.py test for that test, it passes, run the command which failed on CI, it fails, <a href="https://gist.github.com/lqd/f204d50a61b8753e3a9c2238b4d9d039" target="_blank" title="https://gist.github.com/lqd/f204d50a61b8753e3a9c2238b4d9d039">log</a></p>



<a name="134302746"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2353695%20unusable%20variables/near/134302746" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pnkfelix <a href="https://rust-lang.github.io/zulip_archive/stream/122657-t-compiler/wg-nll/topic/.2353695.20unusable.20variables.html#134302746">(Sep 20 2018 at 11:20)</a>:</h4>
<p><span class="user-mention" data-user-id="116113">@lqd</span> okay. Out of curiosity, did you try running the <code>compiletest</code> invocation I posted?</p>



<a name="134302751"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2353695%20unusable%20variables/near/134302751" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pnkfelix <a href="https://rust-lang.github.io/zulip_archive/stream/122657-t-compiler/wg-nll/topic/.2353695.20unusable.20variables.html#134302751">(Sep 20 2018 at 11:20)</a>:</h4>
<p>(admittedly it would probably be a pain to adapt to your local system)</p>



<a name="134302763"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2353695%20unusable%20variables/near/134302763" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pnkfelix <a href="https://rust-lang.github.io/zulip_archive/stream/122657-t-compiler/wg-nll/topic/.2353695.20unusable.20variables.html#134302763">(Sep 20 2018 at 11:21)</a>:</h4>
<p>anyway, the fact that you can replicate the failure via the command should serve well enough to track this down</p>



<a name="134302764"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2353695%20unusable%20variables/near/134302764" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> lqd <a href="https://rust-lang.github.io/zulip_archive/stream/122657-t-compiler/wg-nll/topic/.2353695.20unusable.20variables.html#134302764">(Sep 20 2018 at 11:21)</a>:</h4>
<p>is that what is output at the end of a x.py test failure ?</p>



<a name="134302770"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2353695%20unusable%20variables/near/134302770" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pnkfelix <a href="https://rust-lang.github.io/zulip_archive/stream/122657-t-compiler/wg-nll/topic/.2353695.20unusable.20variables.html#134302770">(Sep 20 2018 at 11:21)</a>:</h4>
<p>Yes it is part of that output I believe</p>



<a name="134302777"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2353695%20unusable%20variables/near/134302777" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pnkfelix <a href="https://rust-lang.github.io/zulip_archive/stream/122657-t-compiler/wg-nll/topic/.2353695.20unusable.20variables.html#134302777">(Sep 20 2018 at 11:21)</a>:</h4>
<p>I was just cut-and-pasting it out of the raw Travis log</p>



<a name="134302780"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2353695%20unusable%20variables/near/134302780" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> lqd <a href="https://rust-lang.github.io/zulip_archive/stream/122657-t-compiler/wg-nll/topic/.2353695.20unusable.20variables.html#134302780">(Sep 20 2018 at 11:21)</a>:</h4>
<p>I did, but I'll retry if you want; do you want me to try after removing the built tests or not ?</p>



<a name="134302784"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2353695%20unusable%20variables/near/134302784" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pnkfelix <a href="https://rust-lang.github.io/zulip_archive/stream/122657-t-compiler/wg-nll/topic/.2353695.20unusable.20variables.html#134302784">(Sep 20 2018 at 11:21)</a>:</h4>
<p>You will need to remove the stamp files</p>



<a name="134302811"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2353695%20unusable%20variables/near/134302811" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pnkfelix <a href="https://rust-lang.github.io/zulip_archive/stream/122657-t-compiler/wg-nll/topic/.2353695.20unusable.20variables.html#134302811">(Sep 20 2018 at 11:22)</a>:</h4>
<p>I don't know if you need to remove the built object code</p>



<a name="134302823"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2353695%20unusable%20variables/near/134302823" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pnkfelix <a href="https://rust-lang.github.io/zulip_archive/stream/122657-t-compiler/wg-nll/topic/.2353695.20unusable.20variables.html#134302823">(Sep 20 2018 at 11:22)</a>:</h4>
<p>Sorry</p>



<a name="134302827"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2353695%20unusable%20variables/near/134302827" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pnkfelix <a href="https://rust-lang.github.io/zulip_archive/stream/122657-t-compiler/wg-nll/topic/.2353695.20unusable.20variables.html#134302827">(Sep 20 2018 at 11:22)</a>:</h4>
<p>And its not a big deal</p>



<a name="134302830"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2353695%20unusable%20variables/near/134302830" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pnkfelix <a href="https://rust-lang.github.io/zulip_archive/stream/122657-t-compiler/wg-nll/topic/.2353695.20unusable.20variables.html#134302830">(Sep 20 2018 at 11:22)</a>:</h4>
<p>Oh sorry, if you already tried <code>compiletest</code> then maybe  don't bother</p>



<a name="134302833"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2353695%20unusable%20variables/near/134302833" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pnkfelix <a href="https://rust-lang.github.io/zulip_archive/stream/122657-t-compiler/wg-nll/topic/.2353695.20unusable.20variables.html#134302833">(Sep 20 2018 at 11:22)</a>:</h4>
<p>I was just curious</p>



<a name="134302840"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2353695%20unusable%20variables/near/134302840" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> lqd <a href="https://rust-lang.github.io/zulip_archive/stream/122657-t-compiler/wg-nll/topic/.2353695.20unusable.20variables.html#134302840">(Sep 20 2018 at 11:22)</a>:</h4>
<p>it looked like what ./x.py test does naturally</p>



<a name="134302841"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2353695%20unusable%20variables/near/134302841" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pnkfelix <a href="https://rust-lang.github.io/zulip_archive/stream/122657-t-compiler/wg-nll/topic/.2353695.20unusable.20variables.html#134302841">(Sep 20 2018 at 11:22)</a>:</h4>
<p>sure</p>



<a name="134302849"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2353695%20unusable%20variables/near/134302849" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pnkfelix <a href="https://rust-lang.github.io/zulip_archive/stream/122657-t-compiler/wg-nll/topic/.2353695.20unusable.20variables.html#134302849">(Sep 20 2018 at 11:23)</a>:</h4>
<p>just trying to gather data</p>



<a name="134302853"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2353695%20unusable%20variables/near/134302853" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> lqd <a href="https://rust-lang.github.io/zulip_archive/stream/122657-t-compiler/wg-nll/topic/.2353695.20unusable.20variables.html#134302853">(Sep 20 2018 at 11:23)</a>:</h4>
<p>which ignored this test, as it didn't fail</p>



<a name="134302855"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2353695%20unusable%20variables/near/134302855" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> lqd <a href="https://rust-lang.github.io/zulip_archive/stream/122657-t-compiler/wg-nll/topic/.2353695.20unusable.20variables.html#134302855">(Sep 20 2018 at 11:23)</a>:</h4>
<p>sure</p>



<a name="134302865"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2353695%20unusable%20variables/near/134302865" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pnkfelix <a href="https://rust-lang.github.io/zulip_archive/stream/122657-t-compiler/wg-nll/topic/.2353695.20unusable.20variables.html#134302865">(Sep 20 2018 at 11:23)</a>:</h4>
<p>since you <em>do</em> see the problem when you run the command ...</p>



<a name="134302867"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2353695%20unusable%20variables/near/134302867" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pnkfelix <a href="https://rust-lang.github.io/zulip_archive/stream/122657-t-compiler/wg-nll/topic/.2353695.20unusable.20variables.html#134302867">(Sep 20 2018 at 11:23)</a>:</h4>
<p>wait, you say it ignored this test</p>



<a name="134302868"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2353695%20unusable%20variables/near/134302868" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> lqd <a href="https://rust-lang.github.io/zulip_archive/stream/122657-t-compiler/wg-nll/topic/.2353695.20unusable.20variables.html#134302868">(Sep 20 2018 at 11:23)</a>:</h4>
<p>yeah it's mind boggling</p>



<a name="134302875"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2353695%20unusable%20variables/near/134302875" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pnkfelix <a href="https://rust-lang.github.io/zulip_archive/stream/122657-t-compiler/wg-nll/topic/.2353695.20unusable.20variables.html#134302875">(Sep 20 2018 at 11:23)</a>:</h4>
<p>as in, it wasn't tested at all? That makes it sound like you <em>do</em> have stamp files lying around?</p>



<a name="134302927"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2353695%20unusable%20variables/near/134302927" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pnkfelix <a href="https://rust-lang.github.io/zulip_archive/stream/122657-t-compiler/wg-nll/topic/.2353695.20unusable.20variables.html#134302927">(Sep 20 2018 at 11:24)</a>:</h4>
<p>You could try running <code>touch</code> on the input <code>.rs</code> file for this test</p>



<a name="134302933"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2353695%20unusable%20variables/near/134302933" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pnkfelix <a href="https://rust-lang.github.io/zulip_archive/stream/122657-t-compiler/wg-nll/topic/.2353695.20unusable.20variables.html#134302933">(Sep 20 2018 at 11:24)</a>:</h4>
<p>if you don't want to bother with trying to track down the stamp files</p>



<a name="134302955"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2353695%20unusable%20variables/near/134302955" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> lqd <a href="https://rust-lang.github.io/zulip_archive/stream/122657-t-compiler/wg-nll/topic/.2353695.20unusable.20variables.html#134302955">(Sep 20 2018 at 11:25)</a>:</h4>
<p>I'm nuking the whole tests to try the compiletest command again</p>



<a name="134302964"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2353695%20unusable%20variables/near/134302964" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> lqd <a href="https://rust-lang.github.io/zulip_archive/stream/122657-t-compiler/wg-nll/topic/.2353695.20unusable.20variables.html#134302964">(Sep 20 2018 at 11:25)</a>:</h4>
<p>it'll take a while, and I won't know if this specific test was ignored or not</p>



<a name="134303009"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2353695%20unusable%20variables/near/134303009" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> lqd <a href="https://rust-lang.github.io/zulip_archive/stream/122657-t-compiler/wg-nll/topic/.2353695.20unusable.20variables.html#134303009">(Sep 20 2018 at 11:26)</a>:</h4>
<p>but I do consistently get similar linker errors, but not on that test, and rerunning makes these errors go away</p>



<a name="134303011"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2353695%20unusable%20variables/near/134303011" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pnkfelix <a href="https://rust-lang.github.io/zulip_archive/stream/122657-t-compiler/wg-nll/topic/.2353695.20unusable.20variables.html#134303011">(Sep 20 2018 at 11:26)</a>:</h4>
<p>yeah, that's a problem with the current output</p>



<a name="134303013"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2353695%20unusable%20variables/near/134303013" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pnkfelix <a href="https://rust-lang.github.io/zulip_archive/stream/122657-t-compiler/wg-nll/topic/.2353695.20unusable.20variables.html#134303013">(Sep 20 2018 at 11:26)</a>:</h4>
<p>we used to print out every test name as we ran</p>



<a name="134303017"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2353695%20unusable%20variables/near/134303017" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pnkfelix <a href="https://rust-lang.github.io/zulip_archive/stream/122657-t-compiler/wg-nll/topic/.2353695.20unusable.20variables.html#134303017">(Sep 20 2018 at 11:26)</a>:</h4>
<p>obviously the newer output is nicer for the common case when you don't care about the test names as you run</p>



<a name="134303021"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2353695%20unusable%20variables/near/134303021" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> lqd <a href="https://rust-lang.github.io/zulip_archive/stream/122657-t-compiler/wg-nll/topic/.2353695.20unusable.20variables.html#134303021">(Sep 20 2018 at 11:26)</a>:</h4>
<p>CI does that so maybe we can still have this info ?</p>



<a name="134303023"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2353695%20unusable%20variables/near/134303023" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pnkfelix <a href="https://rust-lang.github.io/zulip_archive/stream/122657-t-compiler/wg-nll/topic/.2353695.20unusable.20variables.html#134303023">(Sep 20 2018 at 11:26)</a>:</h4>
<p>but I would like to know if there's a way to get back the prior behavior...</p>



<a name="134303025"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2353695%20unusable%20variables/near/134303025" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pnkfelix <a href="https://rust-lang.github.io/zulip_archive/stream/122657-t-compiler/wg-nll/topic/.2353695.20unusable.20variables.html#134303025">(Sep 20 2018 at 11:26)</a>:</h4>
<p>hmm good point</p>



<a name="134303138"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2353695%20unusable%20variables/near/134303138" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pnkfelix <a href="https://rust-lang.github.io/zulip_archive/stream/122657-t-compiler/wg-nll/topic/.2353695.20unusable.20variables.html#134303138">(Sep 20 2018 at 11:29)</a>:</h4>
<p>Bet you its this <code>[00:01:44] configure: rust.verbose-tests   := True</code></p>



<a name="134303198"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2353695%20unusable%20variables/near/134303198" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> lqd <a href="https://rust-lang.github.io/zulip_archive/stream/122657-t-compiler/wg-nll/topic/.2353695.20unusable.20variables.html#134303198">(Sep 20 2018 at 11:30)</a>:</h4>
<p>oh</p>



<a name="134303223"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2353695%20unusable%20variables/near/134303223" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> lqd <a href="https://rust-lang.github.io/zulip_archive/stream/122657-t-compiler/wg-nll/topic/.2353695.20unusable.20variables.html#134303223">(Sep 20 2018 at 11:31)</a>:</h4>
<p>I'll try to flip this switch in config.toml</p>



<a name="134303503"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2353695%20unusable%20variables/near/134303503" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> lqd <a href="https://rust-lang.github.io/zulip_archive/stream/122657-t-compiler/wg-nll/topic/.2353695.20unusable.20variables.html#134303503">(Sep 20 2018 at 11:36)</a>:</h4>
<p>(flipping the switch works, rerunning the ui tests and then the compiletest command directly)</p>



<a name="134304683"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2353695%20unusable%20variables/near/134304683" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> lqd <a href="https://rust-lang.github.io/zulip_archive/stream/122657-t-compiler/wg-nll/topic/.2353695.20unusable.20variables.html#134304683">(Sep 20 2018 at 12:00)</a>:</h4>
<p><span class="user-mention" data-user-id="116083">@pnkfelix</span> update: 1) rerunning x.py test to build the tests correctly with the verbose-tests option and to get the compiletest command in case of failure: I made sure the test failing the PR ran (<code>test [ui] ui/extern/extern-const.rs ... ok</code>)  2) I also later had an <a href="https://gist.github.com/lqd/4b9bed44ce52c6eb7329f2017ccec7c6" target="_blank" title="https://gist.github.com/lqd/4b9bed44ce52c6eb7329f2017ccec7c6">ICE</a>  3) the ICE disappeared when rerunning the compiletest command, <code>test [ui] ui/run-pass/rfcs/rfc-2126-extern-absolute-paths/test.rs ... ok</code> 4) then I removed the tests and reran the compiletest command and the ui suite passed (including <code>test [ui] ui/extern/extern-const.rs ... ok</code>)</p>



<a name="134304809"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2353695%20unusable%20variables/near/134304809" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> lqd <a href="https://rust-lang.github.io/zulip_archive/stream/122657-t-compiler/wg-nll/topic/.2353695.20unusable.20variables.html#134304809">(Sep 20 2018 at 12:02)</a>:</h4>
<p>6) I reran our previous command failing CI, which I can only hope would be valid after compiling and running the ui tests (that is, not missing various .a files or whatever it needs), and it failed with the undefined reference to C</p>



<a name="134304949"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2353695%20unusable%20variables/near/134304949" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> lqd <a href="https://rust-lang.github.io/zulip_archive/stream/122657-t-compiler/wg-nll/topic/.2353695.20unusable.20variables.html#134304949">(Sep 20 2018 at 12:04)</a>:</h4>
<p>I don't know what is going anymore :)</p>



<a name="134305071"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2353695%20unusable%20variables/near/134305071" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> lqd <a href="https://rust-lang.github.io/zulip_archive/stream/122657-t-compiler/wg-nll/topic/.2353695.20unusable.20variables.html#134305071">(Sep 20 2018 at 12:07)</a>:</h4>
<p>the command uses -L ./build/x86_64-unknown-linux-gnu/test/ui/extern/extern-const/auxiliary which doesn't exist in my build</p>



<a name="134305163"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2353695%20unusable%20variables/near/134305163" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> lqd <a href="https://rust-lang.github.io/zulip_archive/stream/122657-t-compiler/wg-nll/topic/.2353695.20unusable.20variables.html#134305163">(Sep 20 2018 at 12:08)</a>:</h4>
<p>maybe it's at a different place here, I'll try and look for that</p>



<a name="134305476"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2353695%20unusable%20variables/near/134305476" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pnkfelix <a href="https://rust-lang.github.io/zulip_archive/stream/122657-t-compiler/wg-nll/topic/.2353695.20unusable.20variables.html#134305476">(Sep 20 2018 at 12:15)</a>:</h4>
<p>Well don't look <em>too</em> hard</p>



<a name="134305487"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2353695%20unusable%20variables/near/134305487" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pnkfelix <a href="https://rust-lang.github.io/zulip_archive/stream/122657-t-compiler/wg-nll/topic/.2353695.20unusable.20variables.html#134305487">(Sep 20 2018 at 12:15)</a>:</h4>
<p>I think compiletest unconditionally adds that <code>-L</code> options</p>



<a name="134305490"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2353695%20unusable%20variables/near/134305490" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pnkfelix <a href="https://rust-lang.github.io/zulip_archive/stream/122657-t-compiler/wg-nll/topic/.2353695.20unusable.20variables.html#134305490">(Sep 20 2018 at 12:15)</a>:</h4>
<p>to increase the linker's search paths</p>



<a name="134305537"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2353695%20unusable%20variables/near/134305537" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pnkfelix <a href="https://rust-lang.github.io/zulip_archive/stream/122657-t-compiler/wg-nll/topic/.2353695.20unusable.20variables.html#134305537">(Sep 20 2018 at 12:16)</a>:</h4>
<p>but my understanding is that <code>-L &lt;dir&gt;</code> has no effect if <code>&lt;dir&gt;</code> does not exist...</p>



<a name="134305570"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2353695%20unusable%20variables/near/134305570" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> lqd <a href="https://rust-lang.github.io/zulip_archive/stream/122657-t-compiler/wg-nll/topic/.2353695.20unusable.20variables.html#134305570">(Sep 20 2018 at 12:17)</a>:</h4>
<p>yeah I feel like this test might not need the auxiliary folder some other tests need</p>



<a name="134305637"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2353695%20unusable%20variables/near/134305637" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> lqd <a href="https://rust-lang.github.io/zulip_archive/stream/122657-t-compiler/wg-nll/topic/.2353695.20unusable.20variables.html#134305637">(Sep 20 2018 at 12:18)</a>:</h4>
<p>also the CI has an './obj' dir that we don't, locally it seems everything is in './build'</p>



<a name="134305707"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2353695%20unusable%20variables/near/134305707" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> lqd <a href="https://rust-lang.github.io/zulip_archive/stream/122657-t-compiler/wg-nll/topic/.2353695.20unusable.20variables.html#134305707">(Sep 20 2018 at 12:20)</a>:</h4>
<p>or maybe obj has noting to do with .o and .a and it's just the rust checkout</p>



<a name="134305727"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2353695%20unusable%20variables/near/134305727" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pnkfelix <a href="https://rust-lang.github.io/zulip_archive/stream/122657-t-compiler/wg-nll/topic/.2353695.20unusable.20variables.html#134305727">(Sep 20 2018 at 12:20)</a>:</h4>
<p>my guess is that they go into <code>/checkout/obj</code> before they run any <code>x.py</code> command</p>



<a name="134305733"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2353695%20unusable%20variables/near/134305733" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pnkfelix <a href="https://rust-lang.github.io/zulip_archive/stream/122657-t-compiler/wg-nll/topic/.2353695.20unusable.20variables.html#134305733">(Sep 20 2018 at 12:20)</a>:</h4>
<p>or at least, that matches my own work flow</p>



<a name="134305747"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2353695%20unusable%20variables/near/134305747" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> lqd <a href="https://rust-lang.github.io/zulip_archive/stream/122657-t-compiler/wg-nll/topic/.2353695.20unusable.20variables.html#134305747">(Sep 20 2018 at 12:21)</a>:</h4>
<p>oh ok, not my own but maybe I should lol</p>



<a name="134305750"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2353695%20unusable%20variables/near/134305750" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pnkfelix <a href="https://rust-lang.github.io/zulip_archive/stream/122657-t-compiler/wg-nll/topic/.2353695.20unusable.20variables.html#134305750">(Sep 20 2018 at 12:21)</a>:</h4>
<p>(i.e., I don't run <code>x.py</code> at the root directory of the <code>rust.git</code> checkout. I keep it isolated.)</p>



<a name="134305754"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2353695%20unusable%20variables/near/134305754" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pnkfelix <a href="https://rust-lang.github.io/zulip_archive/stream/122657-t-compiler/wg-nll/topic/.2353695.20unusable.20variables.html#134305754">(Sep 20 2018 at 12:21)</a>:</h4>
<p>but I'm not the normal case here; I think most people do it like you describe</p>



<a name="134305762"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2353695%20unusable%20variables/near/134305762" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pnkfelix <a href="https://rust-lang.github.io/zulip_archive/stream/122657-t-compiler/wg-nll/topic/.2353695.20unusable.20variables.html#134305762">(Sep 20 2018 at 12:21)</a>:</h4>
<p>(I believe that's <em>why</em> <del>they</del> "we" started generating output into a <code>build</code> subdirectory rather than the current working directory)</p>



<a name="134305764"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2353695%20unusable%20variables/near/134305764" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> lqd <a href="https://rust-lang.github.io/zulip_archive/stream/122657-t-compiler/wg-nll/topic/.2353695.20unusable.20variables.html#134305764">(Sep 20 2018 at 12:21)</a>:</h4>
<p>yeah it seems you're right, they have checkout/src and checkout/obj/build</p>



<a name="134305920"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2353695%20unusable%20variables/near/134305920" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> lqd <a href="https://rust-lang.github.io/zulip_archive/stream/122657-t-compiler/wg-nll/topic/.2353695.20unusable.20variables.html#134305920">(Sep 20 2018 at 12:24)</a>:</h4>
<p>the maybe I didn't adapt the command to my local build correctly, I just changed every /obj/build into ./build</p>



<a name="134305931"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2353695%20unusable%20variables/near/134305931" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pnkfelix <a href="https://rust-lang.github.io/zulip_archive/stream/122657-t-compiler/wg-nll/topic/.2353695.20unusable.20variables.html#134305931">(Sep 20 2018 at 12:24)</a>:</h4>
<p>that sounds like it should work, as long as you did it across the board</p>



<a name="134305943"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2353695%20unusable%20variables/near/134305943" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pnkfelix <a href="https://rust-lang.github.io/zulip_archive/stream/122657-t-compiler/wg-nll/topic/.2353695.20unusable.20variables.html#134305943">(Sep 20 2018 at 12:25)</a>:</h4>
<p>So based on the conversation so far, I take it we have two questions:</p>



<a name="134305955"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2353695%20unusable%20variables/near/134305955" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pnkfelix <a href="https://rust-lang.github.io/zulip_archive/stream/122657-t-compiler/wg-nll/topic/.2353695.20unusable.20variables.html#134305955">(Sep 20 2018 at 12:25)</a>:</h4>
<p>1. Why is the <code>rustc</code> invocation on the .checked file causing a linker failure. This is the thing you were able to replicate locally</p>



<a name="134306008"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2353695%20unusable%20variables/near/134306008" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pnkfelix <a href="https://rust-lang.github.io/zulip_archive/stream/122657-t-compiler/wg-nll/topic/.2353695.20unusable.20variables.html#134306008">(Sep 20 2018 at 12:26)</a>:</h4>
<p>2. Why aren't you seeing the linker failure when you run <code>x.py test</code> locally, even though you were able to replicate 1. I.e. how can it be that your test run isn't hitting the same steps that Travis does?</p>



<a name="134306010"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2353695%20unusable%20variables/near/134306010" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pnkfelix <a href="https://rust-lang.github.io/zulip_archive/stream/122657-t-compiler/wg-nll/topic/.2353695.20unusable.20variables.html#134306010">(Sep 20 2018 at 12:26)</a>:</h4>
<p>Okay. And right now you are focusing on question 2</p>



<a name="134306014"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2353695%20unusable%20variables/near/134306014" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pnkfelix <a href="https://rust-lang.github.io/zulip_archive/stream/122657-t-compiler/wg-nll/topic/.2353695.20unusable.20variables.html#134306014">(Sep 20 2018 at 12:26)</a>:</h4>
<p>Which is fine as long as you care about the question.</p>



<a name="134306026"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2353695%20unusable%20variables/near/134306026" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> lqd <a href="https://rust-lang.github.io/zulip_archive/stream/122657-t-compiler/wg-nll/topic/.2353695.20unusable.20variables.html#134306026">(Sep 20 2018 at 12:27)</a>:</h4>
<p>(the other random linking and ICE errors unrelated to this test also disappear when rerunning ./x.py test)</p>



<a name="134306028"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2353695%20unusable%20variables/near/134306028" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pnkfelix <a href="https://rust-lang.github.io/zulip_archive/stream/122657-t-compiler/wg-nll/topic/.2353695.20unusable.20variables.html#134306028">(Sep 20 2018 at 12:27)</a>:</h4>
<p>(It is certainly a good question, since it might be a symptom of something wrong with your testing work flow)</p>



<a name="134306040"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2353695%20unusable%20variables/near/134306040" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pnkfelix <a href="https://rust-lang.github.io/zulip_archive/stream/122657-t-compiler/wg-nll/topic/.2353695.20unusable.20variables.html#134306040">(Sep 20 2018 at 12:27)</a>:</h4>
<p>Right, we definitely have a number of linking and ICEs that disappear mysteriously on re-run</p>



<a name="134306210"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2353695%20unusable%20variables/near/134306210" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> lqd <a href="https://rust-lang.github.io/zulip_archive/stream/122657-t-compiler/wg-nll/topic/.2353695.20unusable.20variables.html#134306210">(Sep 20 2018 at 12:31)</a>:</h4>
<p><span class="user-mention" data-user-id="116083">@pnkfelix</span> I'm really confused about this test</p>



<a name="134306219"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2353695%20unusable%20variables/near/134306219" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> lqd <a href="https://rust-lang.github.io/zulip_archive/stream/122657-t-compiler/wg-nll/topic/.2353695.20unusable.20variables.html#134306219">(Sep 20 2018 at 12:31)</a>:</h4>
<p>(I'm focusing on question 1 now)</p>



<a name="134306276"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2353695%20unusable%20variables/near/134306276" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> lqd <a href="https://rust-lang.github.io/zulip_archive/stream/122657-t-compiler/wg-nll/topic/.2353695.20unusable.20variables.html#134306276">(Sep 20 2018 at 12:32)</a>:</h4>
<p>this is an extern static, what is rustc trying to do, building an .o/dylib/etc  that doesn't care about the undefined reference ?</p>



<a name="134306291"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2353695%20unusable%20variables/near/134306291" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> lqd <a href="https://rust-lang.github.io/zulip_archive/stream/122657-t-compiler/wg-nll/topic/.2353695.20unusable.20variables.html#134306291">(Sep 20 2018 at 12:33)</a>:</h4>
<p>anything else, building an executable for this main for instance, will fail linking IIUC</p>



<a name="134306292"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2353695%20unusable%20variables/near/134306292" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pnkfelix <a href="https://rust-lang.github.io/zulip_archive/stream/122657-t-compiler/wg-nll/topic/.2353695.20unusable.20variables.html#134306292">(Sep 20 2018 at 12:33)</a>:</h4>
<p>well, the original code had an <code>extern const</code>... and <code>rustfix</code> updates that to an <code>extern static</code>, because <code>extern const</code> is deprecated...</p>



<a name="134306299"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2353695%20unusable%20variables/near/134306299" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pnkfelix <a href="https://rust-lang.github.io/zulip_archive/stream/122657-t-compiler/wg-nll/topic/.2353695.20unusable.20variables.html#134306299">(Sep 20 2018 at 12:33)</a>:</h4>
<p>(I infer)</p>



<a name="134306303"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2353695%20unusable%20variables/near/134306303" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pnkfelix <a href="https://rust-lang.github.io/zulip_archive/stream/122657-t-compiler/wg-nll/topic/.2353695.20unusable.20variables.html#134306303">(Sep 20 2018 at 12:34)</a>:</h4>
<p>I would <em>hope</em> that as part of these, we also supply a file that fills in that static. Unless the linkage for that <code>extern static</code> variable is weak...? But rustfix doesn't annotate it as such</p>



<a name="134306347"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2353695%20unusable%20variables/near/134306347" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pnkfelix <a href="https://rust-lang.github.io/zulip_archive/stream/122657-t-compiler/wg-nll/topic/.2353695.20unusable.20variables.html#134306347">(Sep 20 2018 at 12:34)</a>:</h4>
<p>Anyway I would track down when that test itself was added</p>



<a name="134306349"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2353695%20unusable%20variables/near/134306349" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pnkfelix <a href="https://rust-lang.github.io/zulip_archive/stream/122657-t-compiler/wg-nll/topic/.2353695.20unusable.20variables.html#134306349">(Sep 20 2018 at 12:34)</a>:</h4>
<p>the .fixed file, that is</p>



<a name="134306351"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2353695%20unusable%20variables/near/134306351" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> lqd <a href="https://rust-lang.github.io/zulip_archive/stream/122657-t-compiler/wg-nll/topic/.2353695.20unusable.20variables.html#134306351">(Sep 20 2018 at 12:34)</a>:</h4>
<p>ok I'll do that</p>



<a name="134306380"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2353695%20unusable%20variables/near/134306380" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> lqd <a href="https://rust-lang.github.io/zulip_archive/stream/122657-t-compiler/wg-nll/topic/.2353695.20unusable.20variables.html#134306380">(Sep 20 2018 at 12:35)</a>:</h4>
<p>it probably was one of the compile-fail tests which were merged into ui</p>



<a name="134306528"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2353695%20unusable%20variables/near/134306528" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pnkfelix <a href="https://rust-lang.github.io/zulip_archive/stream/122657-t-compiler/wg-nll/topic/.2353695.20unusable.20variables.html#134306528">(Sep 20 2018 at 12:38)</a>:</h4>
<p>yeah. I'm backtracking from the parent of that PR</p>



<a name="134306550"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2353695%20unusable%20variables/near/134306550" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pnkfelix <a href="https://rust-lang.github.io/zulip_archive/stream/122657-t-compiler/wg-nll/topic/.2353695.20unusable.20variables.html#134306550">(Sep 20 2018 at 12:39)</a>:</h4>
<p>hmm weird, I don't see an <code>extern/</code> nor an <code>extern-const.rs</code> yet in the parent tree</p>



<a name="134306556"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2353695%20unusable%20variables/near/134306556" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> lqd <a href="https://rust-lang.github.io/zulip_archive/stream/122657-t-compiler/wg-nll/topic/.2353695.20unusable.20variables.html#134306556">(Sep 20 2018 at 12:40)</a>:</h4>
<p>it's a couple commits before yeah</p>



<a name="134306610"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2353695%20unusable%20variables/near/134306610" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> lqd <a href="https://rust-lang.github.io/zulip_archive/stream/122657-t-compiler/wg-nll/topic/.2353695.20unusable.20variables.html#134306610">(Sep 20 2018 at 12:40)</a>:</h4>
<p>that is, a couple commits up there are extern tests</p>



<a name="134306619"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2353695%20unusable%20variables/near/134306619" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pnkfelix <a href="https://rust-lang.github.io/zulip_archive/stream/122657-t-compiler/wg-nll/topic/.2353695.20unusable.20variables.html#134306619">(Sep 20 2018 at 12:40)</a>:</h4>
<p>oh wait, maybe <code>git blame</code> is the answer here</p>



<a name="134306622"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2353695%20unusable%20variables/near/134306622" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> lqd <a href="https://rust-lang.github.io/zulip_archive/stream/122657-t-compiler/wg-nll/topic/.2353695.20unusable.20variables.html#134306622">(Sep 20 2018 at 12:40)</a>:</h4>
<p>I can't find the one I'm looking for or the extern folder, so there's some reorg there</p>



<a name="134306625"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2353695%20unusable%20variables/near/134306625" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pnkfelix <a href="https://rust-lang.github.io/zulip_archive/stream/122657-t-compiler/wg-nll/topic/.2353695.20unusable.20variables.html#134306625">(Sep 20 2018 at 12:40)</a>:</h4>
<p><a href="https://github.com/rust-lang/rust/commit/98a04291e4db92ae86d7e3a20b5763cb926ebfbf" target="_blank" title="https://github.com/rust-lang/rust/commit/98a04291e4db92ae86d7e3a20b5763cb926ebfbf">https://github.com/rust-lang/rust/commit/98a04291e4db92ae86d7e3a20b5763cb926ebfbf</a></p>



<a name="134306700"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2353695%20unusable%20variables/near/134306700" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> lqd <a href="https://rust-lang.github.io/zulip_archive/stream/122657-t-compiler/wg-nll/topic/.2353695.20unusable.20variables.html#134306700">(Sep 20 2018 at 12:42)</a>:</h4>
<p>yay</p>



<a name="134306705"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2353695%20unusable%20variables/near/134306705" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pnkfelix <a href="https://rust-lang.github.io/zulip_archive/stream/122657-t-compiler/wg-nll/topic/.2353695.20unusable.20variables.html#134306705">(Sep 20 2018 at 12:42)</a>:</h4>
<p>which is part of <a href="https://github.com/rust-lang/rust/issues/50724" target="_blank" title="https://github.com/rust-lang/rust/issues/50724">#50724</a></p>



<a name="134306720"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2353695%20unusable%20variables/near/134306720" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pnkfelix <a href="https://rust-lang.github.io/zulip_archive/stream/122657-t-compiler/wg-nll/topic/.2353695.20unusable.20variables.html#134306720">(Sep 20 2018 at 12:42)</a>:</h4>
<p>but so weird, how did this ever pass <code>rustc</code> being run on the <code>.fixed</code> code? Is it legal to do this without providing a object file that defines the static?</p>



<a name="134306781"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2353695%20unusable%20variables/near/134306781" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> lqd <a href="https://rust-lang.github.io/zulip_archive/stream/122657-t-compiler/wg-nll/topic/.2353695.20unusable.20variables.html#134306781">(Sep 20 2018 at 12:44)</a>:</h4>
<p>for a lib/.a maybe, for an executable I would assume not</p>



<a name="134306784"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2353695%20unusable%20variables/near/134306784" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> lqd <a href="https://rust-lang.github.io/zulip_archive/stream/122657-t-compiler/wg-nll/topic/.2353695.20unusable.20variables.html#134306784">(Sep 20 2018 at 12:44)</a>:</h4>
<p>and if this was part of a compile-fail that would make sense</p>



<a name="134306821"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2353695%20unusable%20variables/near/134306821" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pnkfelix <a href="https://rust-lang.github.io/zulip_archive/stream/122657-t-compiler/wg-nll/topic/.2353695.20unusable.20variables.html#134306821">(Sep 20 2018 at 12:45)</a>:</h4>
<p>you know what I advise, right now?</p>



<a name="134306823"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2353695%20unusable%20variables/near/134306823" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> lqd <a href="https://rust-lang.github.io/zulip_archive/stream/122657-t-compiler/wg-nll/topic/.2353695.20unusable.20variables.html#134306823">(Sep 20 2018 at 12:45)</a>:</h4>
<p>but I'm not even sure of that anymore (if it was a compile-fail or not) (also rustfix is not supposed to work flawlessly on code with compile errors (I guess those are linking errors rather than compiling/parsing so it still works nicely :)</p>



<a name="134306824"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2353695%20unusable%20variables/near/134306824" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pnkfelix <a href="https://rust-lang.github.io/zulip_archive/stream/122657-t-compiler/wg-nll/topic/.2353695.20unusable.20variables.html#134306824">(Sep 20 2018 at 12:45)</a>:</h4>
<p>move this test back to <code>compile-fail</code></p>



<a name="134306870"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2353695%20unusable%20variables/near/134306870" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pnkfelix <a href="https://rust-lang.github.io/zulip_archive/stream/122657-t-compiler/wg-nll/topic/.2353695.20unusable.20variables.html#134306870">(Sep 20 2018 at 12:46)</a>:</h4>
<p>tag it with the issue that's about reviewing the port of those tests</p>



<a name="134306881"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2353695%20unusable%20variables/near/134306881" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pnkfelix <a href="https://rust-lang.github.io/zulip_archive/stream/122657-t-compiler/wg-nll/topic/.2353695.20unusable.20variables.html#134306881">(Sep 20 2018 at 12:46)</a>:</h4>
<p>(as well as any other relevant issue numbers, to save people the trouble of digging through the git history the way that we have.)</p>



<a name="134306892"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2353695%20unusable%20variables/near/134306892" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pnkfelix <a href="https://rust-lang.github.io/zulip_archive/stream/122657-t-compiler/wg-nll/topic/.2353695.20unusable.20variables.html#134306892">(Sep 20 2018 at 12:47)</a>:</h4>
<p>and then we'll retry landing your PR</p>



<a name="134306908"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2353695%20unusable%20variables/near/134306908" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> lqd <a href="https://rust-lang.github.io/zulip_archive/stream/122657-t-compiler/wg-nll/topic/.2353695.20unusable.20variables.html#134306908">(Sep 20 2018 at 12:47)</a>:</h4>
<p>ok I'll try that after work, thanks Felix</p>



<a name="134306909"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2353695%20unusable%20variables/near/134306909" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pnkfelix <a href="https://rust-lang.github.io/zulip_archive/stream/122657-t-compiler/wg-nll/topic/.2353695.20unusable.20variables.html#134306909">(Sep 20 2018 at 12:47)</a>:</h4>
<p>In other words, this rat hole is fun and all, but lets try to make resolving it orthogonal to landing the work that resolves <a href="https://github.com/rust-lang/rust/issues/53695" target="_blank" title="https://github.com/rust-lang/rust/issues/53695">#53695</a> <span class="emoji emoji-1f400" title="rat">:rat:</span> <span class="emoji emoji-1f573" title="hole">:hole:</span></p>



<a name="134306962"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2353695%20unusable%20variables/near/134306962" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> lqd <a href="https://rust-lang.github.io/zulip_archive/stream/122657-t-compiler/wg-nll/topic/.2353695.20unusable.20variables.html#134306962">(Sep 20 2018 at 12:48)</a>:</h4>
<p>:)</p>



<a name="134307012"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2353695%20unusable%20variables/near/134307012" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pnkfelix <a href="https://rust-lang.github.io/zulip_archive/stream/122657-t-compiler/wg-nll/topic/.2353695.20unusable.20variables.html#134307012">(Sep 20 2018 at 12:50)</a>:</h4>
<p>oh wait</p>



<a name="134307058"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2353695%20unusable%20variables/near/134307058" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pnkfelix <a href="https://rust-lang.github.io/zulip_archive/stream/122657-t-compiler/wg-nll/topic/.2353695.20unusable.20variables.html#134307058">(Sep 20 2018 at 12:50)</a>:</h4>
<p>shoot, it predates the <code>compile-fail</code> to <code>ui</code> migration</p>



<a name="134307069"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2353695%20unusable%20variables/near/134307069" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pnkfelix <a href="https://rust-lang.github.io/zulip_archive/stream/122657-t-compiler/wg-nll/topic/.2353695.20unusable.20variables.html#134307069">(Sep 20 2018 at 12:50)</a>:</h4>
<p>whatever's happening here, its not an artifact of that</p>



<a name="134307174"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2353695%20unusable%20variables/near/134307174" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> lqd <a href="https://rust-lang.github.io/zulip_archive/stream/122657-t-compiler/wg-nll/topic/.2353695.20unusable.20variables.html#134307174">(Sep 20 2018 at 12:52)</a>:</h4>
<p>are we trying to successfully compile a rustfixed file where the original is bound to fail compiling ?</p>



<a name="134307183"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2353695%20unusable%20variables/near/134307183" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> lqd <a href="https://rust-lang.github.io/zulip_archive/stream/122657-t-compiler/wg-nll/topic/.2353695.20unusable.20variables.html#134307183">(Sep 20 2018 at 12:53)</a>:</h4>
<p>or am I just missing an auxiliary folder lol</p>



<a name="134307380"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2353695%20unusable%20variables/near/134307380" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> lqd <a href="https://rust-lang.github.io/zulip_archive/stream/122657-t-compiler/wg-nll/topic/.2353695.20unusable.20variables.html#134307380">(Sep 20 2018 at 12:56)</a>:</h4>
<p><span class="user-mention" data-user-id="116083">@pnkfelix</span> do you happen to have a <code>build/x86_64-unknown-linux-gnu/test/ui/extern/extern-const/auxiliary</code> folder  in any recent build ?</p>



<a name="134307519"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2353695%20unusable%20variables/near/134307519" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> lqd <a href="https://rust-lang.github.io/zulip_archive/stream/122657-t-compiler/wg-nll/topic/.2353695.20unusable.20variables.html#134307519">(Sep 20 2018 at 12:59)</a>:</h4>
<p>also you probably have more important stuff to do...</p>



<a name="134307826"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2353695%20unusable%20variables/near/134307826" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pnkfelix <a href="https://rust-lang.github.io/zulip_archive/stream/122657-t-compiler/wg-nll/topic/.2353695.20unusable.20variables.html#134307826">(Sep 20 2018 at 13:05)</a>:</h4>
<p>I don't have that directory</p>



<a name="134307837"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2353695%20unusable%20variables/near/134307837" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pnkfelix <a href="https://rust-lang.github.io/zulip_archive/stream/122657-t-compiler/wg-nll/topic/.2353695.20unusable.20variables.html#134307837">(Sep 20 2018 at 13:05)</a>:</h4>
<p>and that's on a successful test run</p>



<a name="134307841"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2353695%20unusable%20variables/near/134307841" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pnkfelix <a href="https://rust-lang.github.io/zulip_archive/stream/122657-t-compiler/wg-nll/topic/.2353695.20unusable.20variables.html#134307841">(Sep 20 2018 at 13:05)</a>:</h4>
<p>what the heck is going on</p>



<a name="134307922"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2353695%20unusable%20variables/near/134307922" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pnkfelix <a href="https://rust-lang.github.io/zulip_archive/stream/122657-t-compiler/wg-nll/topic/.2353695.20unusable.20variables.html#134307922">(Sep 20 2018 at 13:06)</a>:</h4>
<p>(i'm considering my effort here to be part of prep for the compiler meeting in an hour)</p>



<a name="134307974"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2353695%20unusable%20variables/near/134307974" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> lqd <a href="https://rust-lang.github.io/zulip_archive/stream/122657-t-compiler/wg-nll/topic/.2353695.20unusable.20variables.html#134307974">(Sep 20 2018 at 13:07)</a>:</h4>
<p>so it's indeed probably automatically adding the -L like you said earlier</p>



<a name="134307991"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2353695%20unusable%20variables/near/134307991" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pnkfelix <a href="https://rust-lang.github.io/zulip_archive/stream/122657-t-compiler/wg-nll/topic/.2353695.20unusable.20variables.html#134307991">(Sep 20 2018 at 13:07)</a>:</h4>
<p>hmm I think I might even have the object code that the successful compile generates</p>



<a name="134308281"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2353695%20unusable%20variables/near/134308281" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pnkfelix <a href="https://rust-lang.github.io/zulip_archive/stream/122657-t-compiler/wg-nll/topic/.2353695.20unusable.20variables.html#134308281">(Sep 20 2018 at 13:13)</a>:</h4>
<p>well that's interestin... in the playpen the .fixed code fails to compile (link failure), but on my linux machine it succeeds...</p>



<a name="134308288"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2353695%20unusable%20variables/near/134308288" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> lqd <a href="https://rust-lang.github.io/zulip_archive/stream/122657-t-compiler/wg-nll/topic/.2353695.20unusable.20variables.html#134308288">(Sep 20 2018 at 13:14)</a>:</h4>
<p>it will depend if you make it Run or just Build</p>



<a name="134308335"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2353695%20unusable%20variables/near/134308335" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pnkfelix <a href="https://rust-lang.github.io/zulip_archive/stream/122657-t-compiler/wg-nll/topic/.2353695.20unusable.20variables.html#134308335">(Sep 20 2018 at 13:14)</a>:</h4>
<p>oh so we must default to some sort of dynamic linkage then?</p>



<a name="134308344"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2353695%20unusable%20variables/near/134308344" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> lqd <a href="https://rust-lang.github.io/zulip_archive/stream/122657-t-compiler/wg-nll/topic/.2353695.20unusable.20variables.html#134308344">(Sep 20 2018 at 13:14)</a>:</h4>
<p>I think so yeah</p>



<a name="134308350"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2353695%20unusable%20variables/near/134308350" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pnkfelix <a href="https://rust-lang.github.io/zulip_archive/stream/122657-t-compiler/wg-nll/topic/.2353695.20unusable.20variables.html#134308350">(Sep 20 2018 at 13:14)</a>:</h4>
<p>or the Build command only bulids to a .rlib, not to a binary? Hmm...</p>



<a name="134308433"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2353695%20unusable%20variables/near/134308433" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> lqd <a href="https://rust-lang.github.io/zulip_archive/stream/122657-t-compiler/wg-nll/topic/.2353695.20unusable.20variables.html#134308433">(Sep 20 2018 at 13:16)</a>:</h4>
<p>dynamic linking for this specific test I think</p>



<a name="134308460"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2353695%20unusable%20variables/near/134308460" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pnkfelix <a href="https://rust-lang.github.io/zulip_archive/stream/122657-t-compiler/wg-nll/topic/.2353695.20unusable.20variables.html#134308460">(Sep 20 2018 at 13:16)</a>:</h4>
<p>even show assembly doesn't work</p>



<a name="134308471"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2353695%20unusable%20variables/near/134308471" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> lqd <a href="https://rust-lang.github.io/zulip_archive/stream/122657-t-compiler/wg-nll/topic/.2353695.20unusable.20variables.html#134308471">(Sep 20 2018 at 13:16)</a>:</h4>
<p>that is, if you cargo build it in a regular project it will fail to build (fail to link to be precise, with the same error)</p>



<a name="134308503"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2353695%20unusable%20variables/near/134308503" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pnkfelix <a href="https://rust-lang.github.io/zulip_archive/stream/122657-t-compiler/wg-nll/topic/.2353695.20unusable.20variables.html#134308503">(Sep 20 2018 at 13:16)</a>:</h4>
<p>so <code>rustc</code> on the file will succeed, but <code>cargo build</code> will fail?</p>



<a name="134308530"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2353695%20unusable%20variables/near/134308530" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> lqd <a href="https://rust-lang.github.io/zulip_archive/stream/122657-t-compiler/wg-nll/topic/.2353695.20unusable.20variables.html#134308530">(Sep 20 2018 at 13:17)</a>:</h4>
<p>rustc with the flags that compile-test passes you mean ?</p>



<a name="134308549"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2353695%20unusable%20variables/near/134308549" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> lqd <a href="https://rust-lang.github.io/zulip_archive/stream/122657-t-compiler/wg-nll/topic/.2353695.20unusable.20variables.html#134308549">(Sep 20 2018 at 13:17)</a>:</h4>
<p>it does for both cases I tihnk</p>



<a name="134308556"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2353695%20unusable%20variables/near/134308556" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> lqd <a href="https://rust-lang.github.io/zulip_archive/stream/122657-t-compiler/wg-nll/topic/.2353695.20unusable.20variables.html#134308556">(Sep 20 2018 at 13:17)</a>:</h4>
<p>rustc will work, cargo build won't</p>



<a name="134308635"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2353695%20unusable%20variables/near/134308635" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> lqd <a href="https://rust-lang.github.io/zulip_archive/stream/122657-t-compiler/wg-nll/topic/.2353695.20unusable.20variables.html#134308635">(Sep 20 2018 at 13:18)</a>:</h4>
<p>my goodness</p>



<a name="134308715"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2353695%20unusable%20variables/near/134308715" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pnkfelix <a href="https://rust-lang.github.io/zulip_archive/stream/122657-t-compiler/wg-nll/topic/.2353695.20unusable.20variables.html#134308715">(Sep 20 2018 at 13:20)</a>:</h4>
<p>Okay, something new:</p>



<a name="134308726"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2353695%20unusable%20variables/near/134308726" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pnkfelix <a href="https://rust-lang.github.io/zulip_archive/stream/122657-t-compiler/wg-nll/topic/.2353695.20unusable.20variables.html#134308726">(Sep 20 2018 at 13:20)</a>:</h4>
<p>inserting a real <em>use</em> of <code>_x</code> will force the failure</p>



<a name="134308728"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2353695%20unusable%20variables/near/134308728" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> lqd <a href="https://rust-lang.github.io/zulip_archive/stream/122657-t-compiler/wg-nll/topic/.2353695.20unusable.20variables.html#134308728">(Sep 20 2018 at 13:20)</a>:</h4>
<p><span class="user-mention" data-user-id="116083">@pnkfelix</span> do you know if we can get the command compiletest executes for a specific test ? just like it shows when the test fails, but I'd like to compare the one it runs on the "unfixed code" vs the fixed which fails</p>



<a name="134308732"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2353695%20unusable%20variables/near/134308732" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pnkfelix <a href="https://rust-lang.github.io/zulip_archive/stream/122657-t-compiler/wg-nll/topic/.2353695.20unusable.20variables.html#134308732">(Sep 20 2018 at 13:20)</a>:</h4>
<p>OHO</p>



<a name="134308737"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2353695%20unusable%20variables/near/134308737" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pnkfelix <a href="https://rust-lang.github.io/zulip_archive/stream/122657-t-compiler/wg-nll/topic/.2353695.20unusable.20variables.html#134308737">(Sep 20 2018 at 13:20)</a>:</h4>
<p>OH OH OH</p>



<a name="134308743"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2353695%20unusable%20variables/near/134308743" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pnkfelix <a href="https://rust-lang.github.io/zulip_archive/stream/122657-t-compiler/wg-nll/topic/.2353695.20unusable.20variables.html#134308743">(Sep 20 2018 at 13:20)</a>:</h4>
<p>you're inserting a FakeRead</p>



<a name="134308748"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2353695%20unusable%20variables/near/134308748" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> lqd <a href="https://rust-lang.github.io/zulip_archive/stream/122657-t-compiler/wg-nll/topic/.2353695.20unusable.20variables.html#134308748">(Sep 20 2018 at 13:20)</a>:</h4>
<p>OH</p>



<a name="134308751"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2353695%20unusable%20variables/near/134308751" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pnkfelix <a href="https://rust-lang.github.io/zulip_archive/stream/122657-t-compiler/wg-nll/topic/.2353695.20unusable.20variables.html#134308751">(Sep 20 2018 at 13:20)</a>:</h4>
<p>I wonder if that actually <em>is</em> affecting codegen for this test</p>



<a name="134308765"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2353695%20unusable%20variables/near/134308765" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pnkfelix <a href="https://rust-lang.github.io/zulip_archive/stream/122657-t-compiler/wg-nll/topic/.2353695.20unusable.20variables.html#134308765">(Sep 20 2018 at 13:20)</a>:</h4>
<p>okay</p>



<a name="134308767"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2353695%20unusable%20variables/near/134308767" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pnkfelix <a href="https://rust-lang.github.io/zulip_archive/stream/122657-t-compiler/wg-nll/topic/.2353695.20unusable.20variables.html#134308767">(Sep 20 2018 at 13:20)</a>:</h4>
<p>new plan</p>



<a name="134308773"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2353695%20unusable%20variables/near/134308773" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pnkfelix <a href="https://rust-lang.github.io/zulip_archive/stream/122657-t-compiler/wg-nll/topic/.2353695.20unusable.20variables.html#134308773">(Sep 20 2018 at 13:20)</a>:</h4>
<p>add <code>// skip-trans</code> to this test</p>



<a name="134308786"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2353695%20unusable%20variables/near/134308786" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pnkfelix <a href="https://rust-lang.github.io/zulip_archive/stream/122657-t-compiler/wg-nll/topic/.2353695.20unusable.20variables.html#134308786">(Sep 20 2018 at 13:21)</a>:</h4>
<p>or wait</p>



<a name="134308790"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2353695%20unusable%20variables/near/134308790" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pnkfelix <a href="https://rust-lang.github.io/zulip_archive/stream/122657-t-compiler/wg-nll/topic/.2353695.20unusable.20variables.html#134308790">(Sep 20 2018 at 13:21)</a>:</h4>
<p>I dont' know if that's supported in <code>ui/</code> on master</p>



<a name="134308795"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2353695%20unusable%20variables/near/134308795" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pnkfelix <a href="https://rust-lang.github.io/zulip_archive/stream/122657-t-compiler/wg-nll/topic/.2353695.20unusable.20variables.html#134308795">(Sep 20 2018 at 13:21)</a>:</h4>
<p>one of my PR adds support for it</p>



<a name="134308797"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2353695%20unusable%20variables/near/134308797" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pnkfelix <a href="https://rust-lang.github.io/zulip_archive/stream/122657-t-compiler/wg-nll/topic/.2353695.20unusable.20variables.html#134308797">(Sep 20 2018 at 13:21)</a>:</h4>
<p>darn</p>



<a name="134308821"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2353695%20unusable%20variables/near/134308821" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pnkfelix <a href="https://rust-lang.github.io/zulip_archive/stream/122657-t-compiler/wg-nll/topic/.2353695.20unusable.20variables.html#134308821">(Sep 20 2018 at 13:21)</a>:</h4>
<p>anyway, yeah, I totally bet that LLVM is optimizing away the use</p>



<a name="134308824"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2353695%20unusable%20variables/near/134308824" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pnkfelix <a href="https://rust-lang.github.io/zulip_archive/stream/122657-t-compiler/wg-nll/topic/.2353695.20unusable.20variables.html#134308824">(Sep 20 2018 at 13:21)</a>:</h4>
<p>or something</p>



<a name="134308866"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2353695%20unusable%20variables/near/134308866" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pnkfelix <a href="https://rust-lang.github.io/zulip_archive/stream/122657-t-compiler/wg-nll/topic/.2353695.20unusable.20variables.html#134308866">(Sep 20 2018 at 13:22)</a>:</h4>
<p>and your PR is forcing it to show up</p>



<a name="134308884"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2353695%20unusable%20variables/near/134308884" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> lqd <a href="https://rust-lang.github.io/zulip_archive/stream/122657-t-compiler/wg-nll/topic/.2353695.20unusable.20variables.html#134308884">(Sep 20 2018 at 13:22)</a>:</h4>
<p>these FakeReads don't seem to be removed by a MIR pass before codegen ? I think niko and matthew were having such a conversation about this recently</p>



<a name="134308888"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2353695%20unusable%20variables/near/134308888" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pnkfelix <a href="https://rust-lang.github.io/zulip_archive/stream/122657-t-compiler/wg-nll/topic/.2353695.20unusable.20variables.html#134308888">(Sep 20 2018 at 13:22)</a>:</h4>
<p>but this test as written seems kind of bogus to me</p>



<a name="134308896"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2353695%20unusable%20variables/near/134308896" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pnkfelix <a href="https://rust-lang.github.io/zulip_archive/stream/122657-t-compiler/wg-nll/topic/.2353695.20unusable.20variables.html#134308896">(Sep 20 2018 at 13:22)</a>:</h4>
<p>or at least</p>



<a name="134308917"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2353695%20unusable%20variables/near/134308917" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pnkfelix <a href="https://rust-lang.github.io/zulip_archive/stream/122657-t-compiler/wg-nll/topic/.2353695.20unusable.20variables.html#134308917">(Sep 20 2018 at 13:22)</a>:</h4>
<p>I don't know if we should be guaranteeing that the compiler will actually compile the <code>extern-const.fixed</code> variant.</p>



<a name="134308946"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2353695%20unusable%20variables/near/134308946" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pnkfelix <a href="https://rust-lang.github.io/zulip_archive/stream/122657-t-compiler/wg-nll/topic/.2353695.20unusable.20variables.html#134308946">(Sep 20 2018 at 13:23)</a>:</h4>
<p>I'll file a new bug regarding <em>that</em> question.</p>



<a name="134309641"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2353695%20unusable%20variables/near/134309641" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://rust-lang.github.io/zulip_archive/stream/122657-t-compiler/wg-nll/topic/.2353695.20unusable.20variables.html#134309641">(Sep 20 2018 at 13:34)</a>:</h4>
<blockquote>
<p>I don't know how deterministic our codegen-units partitioning is</p>
</blockquote>
<p>afaik it is quite deterministic</p>



<a name="134309661"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2353695%20unusable%20variables/near/134309661" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://rust-lang.github.io/zulip_archive/stream/122657-t-compiler/wg-nll/topic/.2353695.20unusable.20variables.html#134309661">(Sep 20 2018 at 13:34)</a>:</h4>
<p>what is the current status here?</p>



<a name="134309690"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2353695%20unusable%20variables/near/134309690" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pnkfelix <a href="https://rust-lang.github.io/zulip_archive/stream/122657-t-compiler/wg-nll/topic/.2353695.20unusable.20variables.html#134309690">(Sep 20 2018 at 13:35)</a>:</h4>
<p>new data, <code>cargo build --release</code> builds successfully, while <code>cargo build</code> does not</p>



<a name="134309749"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2353695%20unusable%20variables/near/134309749" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pnkfelix <a href="https://rust-lang.github.io/zulip_archive/stream/122657-t-compiler/wg-nll/topic/.2353695.20unusable.20variables.html#134309749">(Sep 20 2018 at 13:36)</a>:</h4>
<p>filed <a href="https://github.com/rust-lang/rust/issues/54388" target="_blank" title="https://github.com/rust-lang/rust/issues/54388">#54388</a></p>



<a name="134309758"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2353695%20unusable%20variables/near/134309758" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pnkfelix <a href="https://rust-lang.github.io/zulip_archive/stream/122657-t-compiler/wg-nll/topic/.2353695.20unusable.20variables.html#134309758">(Sep 20 2018 at 13:36)</a>:</h4>
<p>The current status I <em>think</em> is that this PR is exposing a bug elsewhere</p>



<a name="134310350"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2353695%20unusable%20variables/near/134310350" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://rust-lang.github.io/zulip_archive/stream/122657-t-compiler/wg-nll/topic/.2353695.20unusable.20variables.html#134310350">(Sep 20 2018 at 13:48)</a>:</h4>
<p>I see</p>



<a name="134329495"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2353695%20unusable%20variables/near/134329495" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pnkfelix <a href="https://rust-lang.github.io/zulip_archive/stream/122657-t-compiler/wg-nll/topic/.2353695.20unusable.20variables.html#134329495">(Sep 20 2018 at 18:58)</a>:</h4>
<p><span class="user-mention" data-user-id="116113">@lqd</span> I posted my new plan of attack for your PR as a <a href="https://github.com/rust-lang/rust/pull/54188#issuecomment-423295274" target="_blank" title="https://github.com/rust-lang/rust/pull/54188#issuecomment-423295274">comment</a></p>



<a name="134329703"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2353695%20unusable%20variables/near/134329703" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> lqd <a href="https://rust-lang.github.io/zulip_archive/stream/122657-t-compiler/wg-nll/topic/.2353695.20unusable.20variables.html#134329703">(Sep 20 2018 at 19:01)</a>:</h4>
<p><span class="user-mention" data-user-id="116083">@pnkfelix</span> merci felix :) sounds like an interesting thing to try at the very least, maybe it'll blow up elsewhere in other debug tests</p>



<a name="134329954"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2353695%20unusable%20variables/near/134329954" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> lqd <a href="https://rust-lang.github.io/zulip_archive/stream/122657-t-compiler/wg-nll/topic/.2353695.20unusable.20variables.html#134329954">(Sep 20 2018 at 19:05)</a>:</h4>
<p><span class="user-mention" data-user-id="116083">@pnkfelix</span> though if LLVM is involved, I was worried it'd mean that FakeReads now, and ReadForMatch before, really do impact codegen, while I was assuming they would not</p>



<a name="134330073"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2353695%20unusable%20variables/near/134330073" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pnkfelix <a href="https://rust-lang.github.io/zulip_archive/stream/122657-t-compiler/wg-nll/topic/.2353695.20unusable.20variables.html#134330073">(Sep 20 2018 at 19:06)</a>:</h4>
<p>well since you can replicate locally, we could see if the LLVM IR is being changed</p>



<a name="134330081"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2353695%20unusable%20variables/near/134330081" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pnkfelix <a href="https://rust-lang.github.io/zulip_archive/stream/122657-t-compiler/wg-nll/topic/.2353695.20unusable.20variables.html#134330081">(Sep 20 2018 at 19:06)</a>:</h4>
<p>on this test case</p>



<a name="134330087"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2353695%20unusable%20variables/near/134330087" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pnkfelix <a href="https://rust-lang.github.io/zulip_archive/stream/122657-t-compiler/wg-nll/topic/.2353695.20unusable.20variables.html#134330087">(Sep 20 2018 at 19:06)</a>:</h4>
<p>but only if you're really really curious...</p>



<a name="134330131"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2353695%20unusable%20variables/near/134330131" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> lqd <a href="https://rust-lang.github.io/zulip_archive/stream/122657-t-compiler/wg-nll/topic/.2353695.20unusable.20variables.html#134330131">(Sep 20 2018 at 19:07)</a>:</h4>
<p>I can check the IR tomorrow, and do your suggestion tonight</p>



<a name="134330232"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2353695%20unusable%20variables/near/134330232" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> lqd <a href="https://rust-lang.github.io/zulip_archive/stream/122657-t-compiler/wg-nll/topic/.2353695.20unusable.20variables.html#134330232">(Sep 20 2018 at 19:08)</a>:</h4>
<p>or maybe should I try the suggestion only after checking the IR ?</p>



<a name="134330871"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2353695%20unusable%20variables/near/134330871" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> lqd <a href="https://rust-lang.github.io/zulip_archive/stream/122657-t-compiler/wg-nll/topic/.2353695.20unusable.20variables.html#134330871">(Sep 20 2018 at 19:18)</a>:</h4>
<p>I assume the "CI before r+" didn't run this test ?</p>



<a name="134335119"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2353695%20unusable%20variables/near/134335119" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pnkfelix <a href="https://rust-lang.github.io/zulip_archive/stream/122657-t-compiler/wg-nll/topic/.2353695.20unusable.20variables.html#134335119">(Sep 20 2018 at 20:31)</a>:</h4>
<blockquote>
<p>I assume the "CI before r+" didn't run this test ?</p>
</blockquote>
<p>I don't understand what you're asking here. Or rather, my guess is that it <em>did</em> run the test, but the behavior we are seeing is non-deterministic (at least for builds w/o <code>-g</code>)</p>



<a name="134335178"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2353695%20unusable%20variables/near/134335178" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pnkfelix <a href="https://rust-lang.github.io/zulip_archive/stream/122657-t-compiler/wg-nll/topic/.2353695.20unusable.20variables.html#134335178">(Sep 20 2018 at 20:32)</a>:</h4>
<p>because I think that codegen-units are affecting LLVM's ability to optimize away the references to the symbol that is later causing the link-time failure.</p>



<a name="134336444"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2353695%20unusable%20variables/near/134336444" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> lqd <a href="https://rust-lang.github.io/zulip_archive/stream/122657-t-compiler/wg-nll/topic/.2353695.20unusable.20variables.html#134336444">(Sep 20 2018 at 20:53)</a>:</h4>
<p>I mean it seemed the test code was deterministic when we tried it manually both with a debug and release builds, but non-deterministic inside x.py and CI</p>



<a name="134336925"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2353695%20unusable%20variables/near/134336925" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pnkfelix <a href="https://rust-lang.github.io/zulip_archive/stream/122657-t-compiler/wg-nll/topic/.2353695.20unusable.20variables.html#134336925">(Sep 20 2018 at 21:01)</a>:</h4>
<p>well, one thing I've been wondering about that: Do you have your own settings in a config.toml file?</p>



<a name="134336933"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2353695%20unusable%20variables/near/134336933" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pnkfelix <a href="https://rust-lang.github.io/zulip_archive/stream/122657-t-compiler/wg-nll/topic/.2353695.20unusable.20variables.html#134336933">(Sep 20 2018 at 21:01)</a>:</h4>
<p>or do you not use one?</p>



<a name="134336991"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2353695%20unusable%20variables/near/134336991" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> lqd <a href="https://rust-lang.github.io/zulip_archive/stream/122657-t-compiler/wg-nll/topic/.2353695.20unusable.20variables.html#134336991">(Sep 20 2018 at 21:02)</a>:</h4>
<p>I do use one</p>



<a name="134337001"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2353695%20unusable%20variables/near/134337001" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pnkfelix <a href="https://rust-lang.github.io/zulip_archive/stream/122657-t-compiler/wg-nll/topic/.2353695.20unusable.20variables.html#134337001">(Sep 20 2018 at 21:02)</a>:</h4>
<p>can you gist it for me?</p>



<a name="134337035"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2353695%20unusable%20variables/near/134337035" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> lqd <a href="https://rust-lang.github.io/zulip_archive/stream/122657-t-compiler/wg-nll/topic/.2353695.20unusable.20variables.html#134337035">(Sep 20 2018 at 21:03)</a>:</h4>
<p>I'm not on the same computer as before, but can reproduce the "fails on debug, succeeds on release"</p>



<a name="134337038"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2353695%20unusable%20variables/near/134337038" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> lqd <a href="https://rust-lang.github.io/zulip_archive/stream/122657-t-compiler/wg-nll/topic/.2353695.20unusable.20variables.html#134337038">(Sep 20 2018 at 21:03)</a>:</h4>
<p>yeah I will gist it</p>



<a name="134337047"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2353695%20unusable%20variables/near/134337047" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pnkfelix <a href="https://rust-lang.github.io/zulip_archive/stream/122657-t-compiler/wg-nll/topic/.2353695.20unusable.20variables.html#134337047">(Sep 20 2018 at 21:03)</a>:</h4>
<p>(basically I'm musing if we should be changing more of those settings to try to get ourselves in a closer state to what the CI runs before we run <code>x.py</code> ourselves. Because there is <em>some</em> reason it generates that command line that you were able to use to reproduce the problem locally...)</p>



<a name="134337108"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2353695%20unusable%20variables/near/134337108" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pnkfelix <a href="https://rust-lang.github.io/zulip_archive/stream/122657-t-compiler/wg-nll/topic/.2353695.20unusable.20variables.html#134337108">(Sep 20 2018 at 21:04)</a>:</h4>
<p>the "fails on debug" is almost certainly due to the embedded debug-info in the object file causing the linker to say "HEY! Where's that symbol!?!"</p>



<a name="134337125"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2353695%20unusable%20variables/near/134337125" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pnkfelix <a href="https://rust-lang.github.io/zulip_archive/stream/122657-t-compiler/wg-nll/topic/.2353695.20unusable.20variables.html#134337125">(Sep 20 2018 at 21:04)</a>:</h4>
<p>(but its also possible that its not optimizing away the read in that scenario)</p>



<a name="134337138"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2353695%20unusable%20variables/near/134337138" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pnkfelix <a href="https://rust-lang.github.io/zulip_archive/stream/122657-t-compiler/wg-nll/topic/.2353695.20unusable.20variables.html#134337138">(Sep 20 2018 at 21:05)</a>:</h4>
<p>(these are all reasons why it might be interesting to look at the LLVM IR)</p>



<a name="134337204"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2353695%20unusable%20variables/near/134337204" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> lqd <a href="https://rust-lang.github.io/zulip_archive/stream/122657-t-compiler/wg-nll/topic/.2353695.20unusable.20variables.html#134337204">(Sep 20 2018 at 21:06)</a>:</h4>
<p>it's very <a href="https://gist.github.com/lqd/b1eea526df3bc5650255c55e79d65ace" target="_blank" title="https://gist.github.com/lqd/b1eea526df3bc5650255c55e79d65ace">vanilla</a> IIRC, oh maybe you're thinking of enabling llvm assertions ?</p>



<a name="134337216"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2353695%20unusable%20variables/near/134337216" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pnkfelix <a href="https://rust-lang.github.io/zulip_archive/stream/122657-t-compiler/wg-nll/topic/.2353695.20unusable.20variables.html#134337216">(Sep 20 2018 at 21:06)</a>:</h4>
<p>no, I know from experience that we are nowhere near LLVM assertion clean, unfortunately.</p>



<a name="134337218"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2353695%20unusable%20variables/near/134337218" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> lqd <a href="https://rust-lang.github.io/zulip_archive/stream/122657-t-compiler/wg-nll/topic/.2353695.20unusable.20variables.html#134337218">(Sep 20 2018 at 21:06)</a>:</h4>
<p>heh</p>



<a name="134337221"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2353695%20unusable%20variables/near/134337221" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pnkfelix <a href="https://rust-lang.github.io/zulip_archive/stream/122657-t-compiler/wg-nll/topic/.2353695.20unusable.20variables.html#134337221">(Sep 20 2018 at 21:06)</a>:</h4>
<p>you're right, this <em>is</em> very vanilla</p>



<a name="134337249"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2353695%20unusable%20variables/near/134337249" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pnkfelix <a href="https://rust-lang.github.io/zulip_archive/stream/122657-t-compiler/wg-nll/topic/.2353695.20unusable.20variables.html#134337249">(Sep 20 2018 at 21:07)</a>:</h4>
<p>There's this: <code>debuginfo-lines = true</code></p>



<a name="134337259"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2353695%20unusable%20variables/near/134337259" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> lqd <a href="https://rust-lang.github.io/zulip_archive/stream/122657-t-compiler/wg-nll/topic/.2353695.20unusable.20variables.html#134337259">(Sep 20 2018 at 21:07)</a>:</h4>
<p>hmm</p>



<a name="134337261"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2353695%20unusable%20variables/near/134337261" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pnkfelix <a href="https://rust-lang.github.io/zulip_archive/stream/122657-t-compiler/wg-nll/topic/.2353695.20unusable.20variables.html#134337261">(Sep 20 2018 at 21:07)</a>:</h4>
<p>i dunno if that's just affecting the rustc build itself, or if it affects the build products during testing</p>



<a name="134337310"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2353695%20unusable%20variables/near/134337310" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pnkfelix <a href="https://rust-lang.github.io/zulip_archive/stream/122657-t-compiler/wg-nll/topic/.2353695.20unusable.20variables.html#134337310">(Sep 20 2018 at 21:08)</a>:</h4>
<p>(one would think <code>#debuginfo-tests = true</code> would be the thing that controls the latter...)</p>



<a name="134337406"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2353695%20unusable%20variables/near/134337406" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pnkfelix <a href="https://rust-lang.github.io/zulip_archive/stream/122657-t-compiler/wg-nll/topic/.2353695.20unusable.20variables.html#134337406">(Sep 20 2018 at 21:10)</a>:</h4>
<p>but yeah, I don't see any smoking guns here</p>



<a name="134337430"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2353695%20unusable%20variables/near/134337430" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pnkfelix <a href="https://rust-lang.github.io/zulip_archive/stream/122657-t-compiler/wg-nll/topic/.2353695.20unusable.20variables.html#134337430">(Sep 20 2018 at 21:10)</a>:</h4>
<p>one would hope <code>use-jemalloc = false</code> would not affect e.g. codegen-unit partitioning...</p>



<a name="134337456"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2353695%20unusable%20variables/near/134337456" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pnkfelix <a href="https://rust-lang.github.io/zulip_archive/stream/122657-t-compiler/wg-nll/topic/.2353695.20unusable.20variables.html#134337456">(Sep 20 2018 at 21:11)</a>:</h4>
<p>(Do you have jemalloc turned off so that you can use other tools that need the system allocator? just curious)</p>



<a name="134337525"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2353695%20unusable%20variables/near/134337525" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> lqd <a href="https://rust-lang.github.io/zulip_archive/stream/122657-t-compiler/wg-nll/topic/.2353695.20unusable.20variables.html#134337525">(Sep 20 2018 at 21:12)</a>:</h4>
<p>I do have it turned off so I can profile yeah (I have never tried running valgrind and others without it being turned off but maybe it would work)</p>



<a name="134337552"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2353695%20unusable%20variables/near/134337552" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pnkfelix <a href="https://rust-lang.github.io/zulip_archive/stream/122657-t-compiler/wg-nll/topic/.2353695.20unusable.20variables.html#134337552">(Sep 20 2018 at 21:13)</a>:</h4>
<p>anyway I'd say you should just kill the <code>// run-rustfix</code> line in that test and then ask someone to re-r+ the PR</p>



<a name="134337572"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2353695%20unusable%20variables/near/134337572" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pnkfelix <a href="https://rust-lang.github.io/zulip_archive/stream/122657-t-compiler/wg-nll/topic/.2353695.20unusable.20variables.html#134337572">(Sep 20 2018 at 21:13)</a>:</h4>
<p>but if you won't have time to do that tonight, that's fine. Just let me know and that way I'll see about putting up a PR to fix the test.</p>



<a name="134337574"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2353695%20unusable%20variables/near/134337574" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> lqd <a href="https://rust-lang.github.io/zulip_archive/stream/122657-t-compiler/wg-nll/topic/.2353695.20unusable.20variables.html#134337574">(Sep 20 2018 at 21:13)</a>:</h4>
<p>yeah I was testing this, and seemed to work (it also needs the .fixed deleted otherwise it panics)</p>



<a name="134337579"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2353695%20unusable%20variables/near/134337579" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pnkfelix <a href="https://rust-lang.github.io/zulip_archive/stream/122657-t-compiler/wg-nll/topic/.2353695.20unusable.20variables.html#134337579">(Sep 20 2018 at 21:13)</a>:</h4>
<p>oh of course</p>



<a name="134337625"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2353695%20unusable%20variables/near/134337625" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> lqd <a href="https://rust-lang.github.io/zulip_archive/stream/122657-t-compiler/wg-nll/topic/.2353695.20unusable.20variables.html#134337625">(Sep 20 2018 at 21:14)</a>:</h4>
<p>I was trying to get you the ir but with the command from earlier I can't find it whenI --emit=llvm-ir :/</p>



<a name="134337632"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2353695%20unusable%20variables/near/134337632" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pnkfelix <a href="https://rust-lang.github.io/zulip_archive/stream/122657-t-compiler/wg-nll/topic/.2353695.20unusable.20variables.html#134337632">(Sep 20 2018 at 21:14)</a>:</h4>
<p>it ends up in the <code>--output-dir</code> in the command I think</p>



<a name="134337636"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2353695%20unusable%20variables/near/134337636" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pnkfelix <a href="https://rust-lang.github.io/zulip_archive/stream/122657-t-compiler/wg-nll/topic/.2353695.20unusable.20variables.html#134337636">(Sep 20 2018 at 21:14)</a>:</h4>
<p>or did the command use <code>-o</code> ?</p>



<a name="134337647"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2353695%20unusable%20variables/near/134337647" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> lqd <a href="https://rust-lang.github.io/zulip_archive/stream/122657-t-compiler/wg-nll/topic/.2353695.20unusable.20variables.html#134337647">(Sep 20 2018 at 21:15)</a>:</h4>
<p>it did yeah, I should be looking for $test-name.ll right ?</p>



<a name="134337651"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2353695%20unusable%20variables/near/134337651" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pnkfelix <a href="https://rust-lang.github.io/zulip_archive/stream/122657-t-compiler/wg-nll/topic/.2353695.20unusable.20variables.html#134337651">(Sep 20 2018 at 21:15)</a>:</h4>
<p>if it uses <code>-o</code> then I think you end up overwriting the executable with the LLVM IR.</p>



<a name="134337657"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2353695%20unusable%20variables/near/134337657" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pnkfelix <a href="https://rust-lang.github.io/zulip_archive/stream/122657-t-compiler/wg-nll/topic/.2353695.20unusable.20variables.html#134337657">(Sep 20 2018 at 21:15)</a>:</h4>
<p>its the best</p>



<a name="134337661"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2353695%20unusable%20variables/near/134337661" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> lqd <a href="https://rust-lang.github.io/zulip_archive/stream/122657-t-compiler/wg-nll/topic/.2353695.20unusable.20variables.html#134337661">(Sep 20 2018 at 21:15)</a>:</h4>
<p>oh ok lol</p>



<a name="134337683"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2353695%20unusable%20variables/near/134337683" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> lqd <a href="https://rust-lang.github.io/zulip_archive/stream/122657-t-compiler/wg-nll/topic/.2353695.20unusable.20variables.html#134337683">(Sep 20 2018 at 21:15)</a>:</h4>
<p>lol it did</p>



<a name="134337727"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2353695%20unusable%20variables/near/134337727" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> lqd <a href="https://rust-lang.github.io/zulip_archive/stream/122657-t-compiler/wg-nll/topic/.2353695.20unusable.20variables.html#134337727">(Sep 20 2018 at 21:16)</a>:</h4>
<p>aptly named ./build/x86_64-apple-darwin/test/ui/extern/extern-const/a, let me gist that to you</p>



<a name="134337774"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2353695%20unusable%20variables/near/134337774" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> lqd <a href="https://rust-lang.github.io/zulip_archive/stream/122657-t-compiler/wg-nll/topic/.2353695.20unusable.20variables.html#134337774">(Sep 20 2018 at 21:17)</a>:</h4>
<p><a href="https://gist.github.com/lqd/c2bc1eb891b59c6258fdcfd4961bed7b" target="_blank" title="https://gist.github.com/lqd/c2bc1eb891b59c6258fdcfd4961bed7b">here it is</a></p>



<a name="134338153"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2353695%20unusable%20variables/near/134338153" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> lqd <a href="https://rust-lang.github.io/zulip_archive/stream/122657-t-compiler/wg-nll/topic/.2353695.20unusable.20variables.html#134338153">(Sep 20 2018 at 21:25)</a>:</h4>
<p>ok I've updated <a href="https://github.com/rust-lang/rust/issues/54188" target="_blank" title="https://github.com/rust-lang/rust/issues/54188">#54188</a> to disable rustfix on <code>extern-const.rs</code> as you proposed, let's see how it fares on CI <span class="user-mention" data-user-id="116083">@pnkfelix</span>  (but tomorrow, for our TZ :)</p>



<a name="134338331"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2353695%20unusable%20variables/near/134338331" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pnkfelix <a href="https://rust-lang.github.io/zulip_archive/stream/122657-t-compiler/wg-nll/topic/.2353695.20unusable.20variables.html#134338331">(Sep 20 2018 at 21:28)</a>:</h4>
<p>right, so I think this is where we have the read from the undefined static <code>C</code>: <a href="https://gist.github.com/lqd/c2bc1eb891b59c6258fdcfd4961bed7b#file-extern-const-ll-L135" target="_blank" title="https://gist.github.com/lqd/c2bc1eb891b59c6258fdcfd4961bed7b#file-extern-const-ll-L135">https://gist.github.com/lqd/c2bc1eb891b59c6258fdcfd4961bed7b#file-extern-const-ll-L135</a></p>



<a name="134338343"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2353695%20unusable%20variables/near/134338343" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pnkfelix <a href="https://rust-lang.github.io/zulip_archive/stream/122657-t-compiler/wg-nll/topic/.2353695.20unusable.20variables.html#134338343">(Sep 20 2018 at 21:29)</a>:</h4>
<p>and I assume that on a <code>rustc</code> build without your PR, we don't see that <code>%0 = load i8, i8* @C, align 1</code></p>



<a name="134338436"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2353695%20unusable%20variables/near/134338436" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> lqd <a href="https://rust-lang.github.io/zulip_archive/stream/122657-t-compiler/wg-nll/topic/.2353695.20unusable.20variables.html#134338436">(Sep 20 2018 at 21:31)</a>:</h4>
<p>I might have messed up the thing that removes FakeReads from reaching codegen</p>



<a name="134338451"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2353695%20unusable%20variables/near/134338451" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pnkfelix <a href="https://rust-lang.github.io/zulip_archive/stream/122657-t-compiler/wg-nll/topic/.2353695.20unusable.20variables.html#134338451">(Sep 20 2018 at 21:31)</a>:</h4>
<p>that's a decent theory. It would be good to check it.</p>



<a name="134338457"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2353695%20unusable%20variables/near/134338457" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> lqd <a href="https://rust-lang.github.io/zulip_archive/stream/122657-t-compiler/wg-nll/topic/.2353695.20unusable.20variables.html#134338457">(Sep 20 2018 at 21:31)</a>:</h4>
<p>or we don't have such a thing and FakeReads were RealReads all along m night shyamalan plot twist</p>



<a name="134338530"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2353695%20unusable%20variables/near/134338530" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pnkfelix <a href="https://rust-lang.github.io/zulip_archive/stream/122657-t-compiler/wg-nll/topic/.2353695.20unusable.20variables.html#134338530">(Sep 20 2018 at 21:32)</a>:</h4>
<p>oh</p>



<a name="134338535"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2353695%20unusable%20variables/near/134338535" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pnkfelix <a href="https://rust-lang.github.io/zulip_archive/stream/122657-t-compiler/wg-nll/topic/.2353695.20unusable.20variables.html#134338535">(Sep 20 2018 at 21:33)</a>:</h4>
<p>plot twist indeed</p>



<a name="134338546"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2353695%20unusable%20variables/near/134338546" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pnkfelix <a href="https://rust-lang.github.io/zulip_archive/stream/122657-t-compiler/wg-nll/topic/.2353695.20unusable.20variables.html#134338546">(Sep 20 2018 at 21:33)</a>:</h4>
<p>--emit llvm-ir on my rustc <em>does</em> have <code>%0 = load i8, i8* @C, align 1</code></p>



<a name="134338560"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2353695%20unusable%20variables/near/134338560" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> lqd <a href="https://rust-lang.github.io/zulip_archive/stream/122657-t-compiler/wg-nll/topic/.2353695.20unusable.20variables.html#134338560">(Sep 20 2018 at 21:33)</a>:</h4>
<p>we've been plot twisted!</p>



<a name="134338576"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2353695%20unusable%20variables/near/134338576" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pnkfelix <a href="https://rust-lang.github.io/zulip_archive/stream/122657-t-compiler/wg-nll/topic/.2353695.20unusable.20variables.html#134338576">(Sep 20 2018 at 21:33)</a>:</h4>
<p>(at least, it does at <code>-C opt-level=0</code> ... looking at other scenarios now...)</p>



<a name="134338655"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2353695%20unusable%20variables/near/134338655" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> lqd <a href="https://rust-lang.github.io/zulip_archive/stream/122657-t-compiler/wg-nll/topic/.2353695.20unusable.20variables.html#134338655">(Sep 20 2018 at 21:34)</a>:</h4>
<p><span class="user-mention" data-user-id="116083">@pnkfelix</span> thanks for helping out btw, doing this alone would have been way harder (probably impossible)</p>



<a name="134338662"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2353695%20unusable%20variables/near/134338662" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pnkfelix <a href="https://rust-lang.github.io/zulip_archive/stream/122657-t-compiler/wg-nll/topic/.2353695.20unusable.20variables.html#134338662">(Sep 20 2018 at 21:34)</a>:</h4>
<p>might LTO be getting rid of it, hmm ...</p>



<a name="134338786"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2353695%20unusable%20variables/near/134338786" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pnkfelix <a href="https://rust-lang.github.io/zulip_archive/stream/122657-t-compiler/wg-nll/topic/.2353695.20unusable.20variables.html#134338786">(Sep 20 2018 at 21:37)</a>:</h4>
<p>It still links even when I disable ThinLTO  and am at <code>-C opt-level=0</code>.</p>



<a name="134339568"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2353695%20unusable%20variables/near/134339568" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> lqd <a href="https://rust-lang.github.io/zulip_archive/stream/122657-t-compiler/wg-nll/topic/.2353695.20unusable.20variables.html#134339568">(Sep 20 2018 at 21:48)</a>:</h4>
<p><span class="user-mention" data-user-id="116083">@pnkfelix</span> do you remember where should I look for something (like a MIR pass) eliminating ReadForMatch before codegen ? (IIRC you created ReadForMatch so I'll check with you :)</p>



<a name="134341458"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2353695%20unusable%20variables/near/134341458" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Matthew Jasper <a href="https://rust-lang.github.io/zulip_archive/stream/122657-t-compiler/wg-nll/topic/.2353695.20unusable.20variables.html#134341458">(Sep 20 2018 at 22:20)</a>:</h4>
<p>ReadForMatch reaches codegen (but the PR I have open for matches will need to add a pass to remove them, for other reasons).</p>



<a name="134341578"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2353695%20unusable%20variables/near/134341578" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> lqd <a href="https://rust-lang.github.io/zulip_archive/stream/122657-t-compiler/wg-nll/topic/.2353695.20unusable.20variables.html#134341578">(Sep 20 2018 at 22:23)</a>:</h4>
<p>yeah I seemed to remember your &amp; niko's conversation about that</p>



<a name="134372124"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/122657-t-compiler/wg-nll/topic/%2353695%20unusable%20variables/near/134372124" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> lqd <a href="https://rust-lang.github.io/zulip_archive/stream/122657-t-compiler/wg-nll/topic/.2353695.20unusable.20variables.html#134372124">(Sep 21 2018 at 11:34)</a>:</h4>
<p><span class="user-mention" data-user-id="116083">@pnkfelix</span> thanks for nudging bors</p>



<hr><p>Last updated: Aug 07 2021 at 22:04 UTC</p>
</html>