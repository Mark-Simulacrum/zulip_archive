<html>
<head><meta charset="utf-8"><title>breaking changes to summarize · t-compiler/wg-self-profile · Zulip Chat Archive</title></head>
<h2>Stream: <a href="https://rust-lang.github.io/zulip_archive/stream/187831-t-compiler/wg-self-profile/index.html">t-compiler/wg-self-profile</a></h2>
<h3>Topic: <a href="https://rust-lang.github.io/zulip_archive/stream/187831-t-compiler/wg-self-profile/topic/breaking.20changes.20to.20summarize.html">breaking changes to summarize</a></h3>

<hr>

<base href="https://rust-lang.zulipchat.com">

<head><link href="https://rust-lang.github.io/zulip_archive/style.css" rel="stylesheet"></head>

<a name="177201709"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/187831-t-compiler/wg-self-profile/topic/breaking%20changes%20to%20summarize/near/177201709" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> simulacrum <a href="https://rust-lang.github.io/zulip_archive/stream/187831-t-compiler/wg-self-profile/topic/breaking.20changes.20to.20summarize.html#177201709">(Oct 02 2019 at 23:17)</a>:</h4>
<p><span class="user-mention" data-user-id="124287">@mw</span> I believe something landed in the last few days that broke summarize; I'd appreciate a ping or so on the PRs to the measureme repo so I can update it on the perf server</p>



<a name="177201714"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/187831-t-compiler/wg-self-profile/topic/breaking%20changes%20to%20summarize/near/177201714" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> simulacrum <a href="https://rust-lang.github.io/zulip_archive/stream/187831-t-compiler/wg-self-profile/topic/breaking.20changes.20to.20summarize.html#177201714">(Oct 02 2019 at 23:17)</a>:</h4>
<p>I guess I can make it always update to latest</p>



<a name="177201718"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/187831-t-compiler/wg-self-profile/topic/breaking%20changes%20to%20summarize/near/177201718" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> simulacrum <a href="https://rust-lang.github.io/zulip_archive/stream/187831-t-compiler/wg-self-profile/topic/breaking.20changes.20to.20summarize.html#177201718">(Oct 02 2019 at 23:17)</a>:</h4>
<p>I'd just rather not</p>



<a name="177201735"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/187831-t-compiler/wg-self-profile/topic/breaking%20changes%20to%20summarize/near/177201735" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> simulacrum <a href="https://rust-lang.github.io/zulip_archive/stream/187831-t-compiler/wg-self-profile/topic/breaking.20changes.20to.20summarize.html#177201735">(Oct 02 2019 at 23:18)</a>:</h4>
<p>since that also seems error prone</p>



<a name="177201817"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/187831-t-compiler/wg-self-profile/topic/breaking%20changes%20to%20summarize/near/177201817" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> simulacrum <a href="https://rust-lang.github.io/zulip_archive/stream/187831-t-compiler/wg-self-profile/topic/breaking.20changes.20to.20summarize.html#177201817">(Oct 02 2019 at 23:19)</a>:</h4>
<p>hm actually it looks like summarize is just broken:</p>
<div class="codehilite"><pre><span></span>    stderr=    Checking issue-32278-big-array-of-strings v0.1.0 (/tmp/.tmpW1HBwV)
    thread &#39;main&#39; panicked at &#39;assertion failed: `(left == right)`
      left: `&quot;codegen_and_optimize_crate&quot;`,
     right: `&quot;codegen_crate&quot;`&#39;, summarize/src/analysis.rs:121:17
    note: Run with `RUST_BACKTRACE=1` environment variable to display a backtrace.
    thread &#39;main&#39; panicked at &#39;summarize failed in &quot;/tmp/.tmpW1HBwV/self-profile-output&quot;; prefix is &quot;issue_32278_big_array_of_strings-12842&quot;&#39;, collector/src/bin/rustc-fake.rs:96:21
    note: run with `RUST_BACKTRACE=1` environment variable to display a backtrace.
    error: Could not compile `issue-32278-big-array-of-strings`.

    To learn more, run the command again with --verbose.
</pre></div>



<a name="177201931"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/187831-t-compiler/wg-self-profile/topic/breaking%20changes%20to%20summarize/near/177201931" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> simulacrum <a href="https://rust-lang.github.io/zulip_archive/stream/187831-t-compiler/wg-self-profile/topic/breaking.20changes.20to.20summarize.html#177201931">(Oct 02 2019 at 23:21)</a>:</h4>
<p>cc <span class="user-mention" data-user-id="125250">@Wesley Wiser</span></p>



<a name="177201943"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/187831-t-compiler/wg-self-profile/topic/breaking%20changes%20to%20summarize/near/177201943" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> simulacrum <a href="https://rust-lang.github.io/zulip_archive/stream/187831-t-compiler/wg-self-profile/topic/breaking.20changes.20to.20summarize.html#177201943">(Oct 02 2019 at 23:21)</a>:</h4>
<p>this is kind of painful</p>



<a name="177202005"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/187831-t-compiler/wg-self-profile/topic/breaking%20changes%20to%20summarize/near/177202005" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> simulacrum <a href="https://rust-lang.github.io/zulip_archive/stream/187831-t-compiler/wg-self-profile/topic/breaking.20changes.20to.20summarize.html#177202005">(Oct 02 2019 at 23:22)</a>:</h4>
<p>I guess we just won't get self profile data for some time</p>



<a name="177259460"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/187831-t-compiler/wg-self-profile/topic/breaking%20changes%20to%20summarize/near/177259460" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wesley Wiser <a href="https://rust-lang.github.io/zulip_archive/stream/187831-t-compiler/wg-self-profile/topic/breaking.20changes.20to.20summarize.html#177259460">(Oct 03 2019 at 16:08)</a>:</h4>
<p>Hmm... that's a little concerning. I don't recall anything landing recently that I would have broken this.</p>



<a name="177259790"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/187831-t-compiler/wg-self-profile/topic/breaking%20changes%20to%20summarize/near/177259790" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> simulacrum <a href="https://rust-lang.github.io/zulip_archive/stream/187831-t-compiler/wg-self-profile/topic/breaking.20changes.20to.20summarize.html#177259790">(Oct 03 2019 at 16:11)</a>:</h4>
<p>to be clear I'm seeing this on every single perf build</p>



<a name="177259805"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/187831-t-compiler/wg-self-profile/topic/breaking%20changes%20to%20summarize/near/177259805" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> simulacrum <a href="https://rust-lang.github.io/zulip_archive/stream/187831-t-compiler/wg-self-profile/topic/breaking.20changes.20to.20summarize.html#177259805">(Oct 03 2019 at 16:11)</a>:</h4>
<p>Have not tried to reproduce locally yet, ended up just disabling self profile on perf collection for now</p>



<a name="177260322"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/187831-t-compiler/wg-self-profile/topic/breaking%20changes%20to%20summarize/near/177260322" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wesley Wiser <a href="https://rust-lang.github.io/zulip_archive/stream/187831-t-compiler/wg-self-profile/topic/breaking.20changes.20to.20summarize.html#177260322">(Oct 03 2019 at 16:16)</a>:</h4>
<p>Most of the changes recently have been in the other tools so we should be able to rule them out</p>



<a name="177260326"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/187831-t-compiler/wg-self-profile/topic/breaking%20changes%20to%20summarize/near/177260326" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wesley Wiser <a href="https://rust-lang.github.io/zulip_archive/stream/187831-t-compiler/wg-self-profile/topic/breaking.20changes.20to.20summarize.html#177260326">(Oct 03 2019 at 16:16)</a>:</h4>
<p>That leaves</p>



<a name="177260339"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/187831-t-compiler/wg-self-profile/topic/breaking%20changes%20to%20summarize/near/177260339" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wesley Wiser <a href="https://rust-lang.github.io/zulip_archive/stream/187831-t-compiler/wg-self-profile/topic/breaking.20changes.20to.20summarize.html#177260339">(Oct 03 2019 at 16:16)</a>:</h4>
<p><a href="https://github.com/rust-lang/measureme/commit/5b76a032daca7cd6e412a8dede6c535019067fff" target="_blank" title="https://github.com/rust-lang/measureme/commit/5b76a032daca7cd6e412a8dede6c535019067fff">https://github.com/rust-lang/measureme/commit/5b76a032daca7cd6e412a8dede6c535019067fff</a></p>



<a name="177260386"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/187831-t-compiler/wg-self-profile/topic/breaking%20changes%20to%20summarize/near/177260386" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wesley Wiser <a href="https://rust-lang.github.io/zulip_archive/stream/187831-t-compiler/wg-self-profile/topic/breaking.20changes.20to.20summarize.html#177260386">(Oct 03 2019 at 16:17)</a>:</h4>
<p>and<br>
<a href="https://github.com/rust-lang/rust/pull/64840" target="_blank" title="https://github.com/rust-lang/rust/pull/64840">https://github.com/rust-lang/rust/pull/64840</a></p>



<a name="177261310"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/187831-t-compiler/wg-self-profile/topic/breaking%20changes%20to%20summarize/near/177261310" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> simulacrum <a href="https://rust-lang.github.io/zulip_archive/stream/187831-t-compiler/wg-self-profile/topic/breaking.20changes.20to.20summarize.html#177261310">(Oct 03 2019 at 16:27)</a>:</h4>
<p>I'm 99% sure its the rust-lang/rust PR because I only updated measureme on the perf server _after_ I noticed these errors, in the hope that they'd go away</p>



<a name="177425056"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/187831-t-compiler/wg-self-profile/topic/breaking%20changes%20to%20summarize/near/177425056" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> andjo403 <a href="https://rust-lang.github.io/zulip_archive/stream/187831-t-compiler/wg-self-profile/topic/breaking.20changes.20to.20summarize.html#177425056">(Oct 05 2019 at 18:12)</a>:</h4>
<p>think that I have found what event causes the panic  <a href="https://github.com/rust-lang/rust/pull/64840#discussion_r331756092" target="_blank" title="https://github.com/rust-lang/rust/pull/64840#discussion_r331756092">https://github.com/rust-lang/rust/pull/64840#discussion_r331756092</a></p>



<a name="177425084"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/187831-t-compiler/wg-self-profile/topic/breaking%20changes%20to%20summarize/near/177425084" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> andjo403 <a href="https://rust-lang.github.io/zulip_archive/stream/187831-t-compiler/wg-self-profile/topic/breaking.20changes.20to.20summarize.html#177425084">(Oct 05 2019 at 18:13)</a>:</h4>
<p>but do not know how to solve it by any other way then remove the trace</p>



<a name="177498297"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/187831-t-compiler/wg-self-profile/topic/breaking%20changes%20to%20summarize/near/177498297" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> mw <a href="https://rust-lang.github.io/zulip_archive/stream/187831-t-compiler/wg-self-profile/topic/breaking.20changes.20to.20summarize.html#177498297">(Oct 07 2019 at 08:04)</a>:</h4>
<p>oh sorry, yes that rustc PR changed some of the event names. I didn't realize that summarize was relying a specific names there.</p>



<a name="177498338"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/187831-t-compiler/wg-self-profile/topic/breaking%20changes%20to%20summarize/near/177498338" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> mw <a href="https://rust-lang.github.io/zulip_archive/stream/187831-t-compiler/wg-self-profile/topic/breaking.20changes.20to.20summarize.html#177498338">(Oct 07 2019 at 08:06)</a>:</h4>
<p>Hm, OK now I see what the problem is.</p>



<a name="177498458"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/187831-t-compiler/wg-self-profile/topic/breaking%20changes%20to%20summarize/near/177498458" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> mw <a href="https://rust-lang.github.io/zulip_archive/stream/187831-t-compiler/wg-self-profile/topic/breaking.20changes.20to.20summarize.html#177498458">(Oct 07 2019 at 08:07)</a>:</h4>
<p>the backend actually is asynchronous there, so the weird nesting of events is correct ...</p>



<a name="177499350"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/187831-t-compiler/wg-self-profile/topic/breaking%20changes%20to%20summarize/near/177499350" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> mw <a href="https://rust-lang.github.io/zulip_archive/stream/187831-t-compiler/wg-self-profile/topic/breaking.20changes.20to.20summarize.html#177499350">(Oct 07 2019 at 08:23)</a>:</h4>
<p>I approved <span class="user-mention" data-user-id="125799">@Andreas Jonson</span>'s PR (<a href="https://github.com/rust-lang/rust/pull/65137" target="_blank" title="https://github.com/rust-lang/rust/pull/65137">https://github.com/rust-lang/rust/pull/65137</a>) for in order to quickly unbreak summarize (thanks again!). I'll take a closer look as part of the second event review round.</p>



<a name="177499371"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/187831-t-compiler/wg-self-profile/topic/breaking%20changes%20to%20summarize/near/177499371" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> mw <a href="https://rust-lang.github.io/zulip_archive/stream/187831-t-compiler/wg-self-profile/topic/breaking.20changes.20to.20summarize.html#177499371">(Oct 07 2019 at 08:23)</a>:</h4>
<p>I wonder if we can prevent breakage like this in the future?</p>



<a name="177511543"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/187831-t-compiler/wg-self-profile/topic/breaking%20changes%20to%20summarize/near/177511543" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> simulacrum <a href="https://rust-lang.github.io/zulip_archive/stream/187831-t-compiler/wg-self-profile/topic/breaking.20changes.20to.20summarize.html#177511543">(Oct 07 2019 at 11:49)</a>:</h4>
<p>maybe we can run cargotest with self profile enabled and summarize that data? probably fairly low overhead time wise</p>



<hr><p>Last updated: Aug 07 2021 at 22:04 UTC</p>
</html>