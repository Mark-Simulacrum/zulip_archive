<html>
<head><meta charset="utf-8"><title>False positive of #[global_allocator] confliction detection? · t-libs/wg-allocators · Zulip Chat Archive</title></head>
<h2>Stream: <a href="https://zulip-archive.rust-lang.org/stream/197181-t-libs/wg-allocators/index.html">t-libs/wg-allocators</a></h2>
<h3>Topic: <a href="https://zulip-archive.rust-lang.org/stream/197181-t-libs/wg-allocators/topic/False.20positive.20of.20.23.5Bglobal_allocator.5D.20confliction.20detection.3F.html">False positive of #[global_allocator] confliction detection?</a></h3>

<hr>

<base href="https://rust-lang.zulipchat.com">

<head><link href="https://zulip-archive.rust-lang.org/style.css" rel="stylesheet"></head>

<a name="251110193"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/197181-t-libs/wg-allocators/topic/False%20positive%20of%20%23%5Bglobal_allocator%5D%20confliction%20detection%3F/near/251110193" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Hiroki Tokunaga <a href="https://zulip-archive.rust-lang.org/stream/197181-t-libs/wg-allocators/topic/False.20positive.20of.20.23.5Bglobal_allocator.5D.20confliction.20detection.3F.html#251110193">(Aug 29 2021 at 06:23)</a>:</h4>
<p>Hello. I posted a question about the #[global_allocator] conflictions to StackOverflow. However, one of the Rust community members said that it may be a false positive rather than a usage problem. Could someone check the question? <a href="https://stackoverflow.com/questions/68955652/how-to-avoid-global-allocator-conflicts">https://stackoverflow.com/questions/68955652/how-to-avoid-global-allocator-conflicts</a></p>



<a name="251110592"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/197181-t-libs/wg-allocators/topic/False%20positive%20of%20%23%5Bglobal_allocator%5D%20confliction%20detection%3F/near/251110592" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> bjorn3 <a href="https://zulip-archive.rust-lang.org/stream/197181-t-libs/wg-allocators/topic/False.20positive.20of.20.23.5Bglobal_allocator.5D.20confliction.20detection.3F.html#251110592">(Aug 29 2021 at 06:31)</a>:</h4>
<p>Would setting <code>resolver = 2</code> in the <code>[workspace]</code> section of the root <code>Cargo.toml</code> work?</p>



<a name="251110700"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/197181-t-libs/wg-allocators/topic/False%20positive%20of%20%23%5Bglobal_allocator%5D%20confliction%20detection%3F/near/251110700" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Hiroki Tokunaga <a href="https://zulip-archive.rust-lang.org/stream/197181-t-libs/wg-allocators/topic/False.20positive.20of.20.23.5Bglobal_allocator.5D.20confliction.20detection.3F.html#251110700">(Aug 29 2021 at 06:33)</a>:</h4>
<p>It didn't work.</p>



<a name="251110859"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/197181-t-libs/wg-allocators/topic/False%20positive%20of%20%23%5Bglobal_allocator%5D%20confliction%20detection%3F/near/251110859" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> bjorn3 <a href="https://zulip-archive.rust-lang.org/stream/197181-t-libs/wg-allocators/topic/False.20positive.20of.20.23.5Bglobal_allocator.5D.20confliction.20detection.3F.html#251110859">(Aug 29 2021 at 06:36)</a>:</h4>
<p>Then I think only removing <code>heap</code> from the default features of <code>bar</code> will help</p>



<a name="251111156"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/197181-t-libs/wg-allocators/topic/False%20positive%20of%20%23%5Bglobal_allocator%5D%20confliction%20detection%3F/near/251111156" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Hiroki Tokunaga <a href="https://zulip-archive.rust-lang.org/stream/197181-t-libs/wg-allocators/topic/False.20positive.20of.20.23.5Bglobal_allocator.5D.20confliction.20detection.3F.html#251111156">(Aug 29 2021 at 06:43)</a>:</h4>
<p>So I removed the <code>heap</code> feature from the default ones and made <code>baz</code> depend on <code>bar</code> with the <code>heap</code> feature. However, this caused the same error.</p>



<a name="251115726"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/197181-t-libs/wg-allocators/topic/False%20positive%20of%20%23%5Bglobal_allocator%5D%20confliction%20detection%3F/near/251115726" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> bjorn3 <a href="https://zulip-archive.rust-lang.org/stream/197181-t-libs/wg-allocators/topic/False.20positive.20of.20.23.5Bglobal_allocator.5D.20confliction.20detection.3F.html#251115726">(Aug 29 2021 at 08:10)</a>:</h4>
<p>If foo, bar and baz are all compiled together, the heap feature will be globally enabled for bar if either foo or baz depends on it. Cargo will take the union of all the features each dependent crate requires and compile dependencies <strong>once</strong> with these features.</p>



<a name="251133124"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/197181-t-libs/wg-allocators/topic/False%20positive%20of%20%23%5Bglobal_allocator%5D%20confliction%20detection%3F/near/251133124" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Hiroki Tokunaga <a href="https://zulip-archive.rust-lang.org/stream/197181-t-libs/wg-allocators/topic/False.20positive.20of.20.23.5Bglobal_allocator.5D.20confliction.20detection.3F.html#251133124">(Aug 29 2021 at 13:35)</a>:</h4>
<p>Thank you for the information. Could I quote your comment as an answer to the question, or could you answer it?</p>



<a name="251141260"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/197181-t-libs/wg-allocators/topic/False%20positive%20of%20%23%5Bglobal_allocator%5D%20confliction%20detection%3F/near/251141260" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> bjorn3 <a href="https://zulip-archive.rust-lang.org/stream/197181-t-libs/wg-allocators/topic/False.20positive.20of.20.23.5Bglobal_allocator.5D.20confliction.20detection.3F.html#251141260">(Aug 29 2021 at 16:01)</a>:</h4>
<p>I don't have a stackoverflow account. It is fine to quote my comment.</p>



<hr><p>Last updated: Apr 12 2022 at 20:01 UTC</p>
</html>