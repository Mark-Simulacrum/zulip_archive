<html>
<head><meta charset="utf-8"><title>CTFE impl · project-safe-transmute · Zulip Chat Archive</title></head>
<h2>Stream: <a href="https://zulip-archive.rust-lang.org/stream/216762-project-safe-transmute/index.html">project-safe-transmute</a></h2>
<h3>Topic: <a href="https://zulip-archive.rust-lang.org/stream/216762-project-safe-transmute/topic/CTFE.20impl.html">CTFE impl</a></h3>

<hr>

<base href="https://rust-lang.zulipchat.com">

<head><link href="https://zulip-archive.rust-lang.org/style.css" rel="stylesheet"></head>

<a name="266104560"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/216762-project-safe-transmute/topic/CTFE%20impl/near/266104560" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> oli <a href="https://zulip-archive.rust-lang.org/stream/216762-project-safe-transmute/topic/CTFE.20impl.html#266104560">(Dec 26 2021 at 11:07)</a>:</h4>
<p>Really evil idea: instead of having magically generated impls for types, could we convert your algorithm to a const one and put it into libcore? Then we add an API to get the layout of a type in CTFE and add a generic impl that has where bounds checking in CTFE that your two types are safely transmutable. Not quite sure if I'm serious, CTFE is probably not up to the task yet, but it would be cool lol</p>



<a name="266125171"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/216762-project-safe-transmute/topic/CTFE%20impl/near/266125171" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jack Wrenn <a href="https://zulip-archive.rust-lang.org/stream/216762-project-safe-transmute/topic/CTFE.20impl.html#266125171">(Dec 26 2021 at 19:56)</a>:</h4>
<p>Oh, I've totally already tried that. <span aria-label="grinning" class="emoji emoji-1f600" role="img" title="grinning">:grinning:</span> The sticking points were that:</p>
<ul>
<li>CTFE is unfortunately far from being up to the task</li>
<li>it's unclear how to do lifetime and visibility checking</li>
<li>the unstable API surface is <em>much</em> larger (because you also need that api to get the layout of a type)</li>
</ul>



<a name="266128371"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/216762-project-safe-transmute/topic/CTFE%20impl/near/266128371" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> oli <a href="https://zulip-archive.rust-lang.org/stream/216762-project-safe-transmute/topic/CTFE.20impl.html#266128371">(Dec 26 2021 at 21:23)</a>:</h4>
<p>Well. We can dump the layout, lifetime and visibility data as raw bytes and let the CTFE side figure out what it means</p>



<a name="266128423"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/216762-project-safe-transmute/topic/CTFE%20impl/near/266128423" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> oli <a href="https://zulip-archive.rust-lang.org/stream/216762-project-safe-transmute/topic/CTFE.20impl.html#266128423">(Dec 26 2021 at 21:24)</a>:</h4>
<p>Yea, this wasn't a very serious proposal xD but it would be awesome if we could some day impl it that way instead of with straight up compiler magic</p>



<hr><p>Last updated: Apr 12 2022 at 20:01 UTC</p>
</html>