<html>
<head><meta charset="utf-8"><title>Current use cases of rustc MIR · project-stable-mir · Zulip Chat Archive</title></head>
<h2>Stream: <a href="https://zulip-archive.rust-lang.org/stream/320896-project-stable-mir/index.html">project-stable-mir</a></h2>
<h3>Topic: <a href="https://zulip-archive.rust-lang.org/stream/320896-project-stable-mir/topic/Current.20use.20cases.20of.20rustc.20MIR.html">Current use cases of rustc MIR</a></h3>

<hr>

<base href="https://rust-lang.zulipchat.com">

<head><link href="https://zulip-archive.rust-lang.org/style.css" rel="stylesheet"></head>

<a name="278062564"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/320896-project-stable-mir/topic/Current%20use%20cases%20of%20rustc%20MIR/near/278062564" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Celina V. <a href="https://zulip-archive.rust-lang.org/stream/320896-project-stable-mir/topic/Current.20use.20cases.20of.20rustc.20MIR.html#278062564">(Apr 06 2022 at 18:01)</a>:</h4>
<p>I'm creating this topic to start gathering how different tools are using MIR to help us understand current use cases. If you are working or using a tool that uses MIR, can you please add some information about your tool. Here is a quick set of questions that would help us understand your use case:</p>
<ol>
<li>What's the name of the tool? If possible, can you please add a link to the source code or any relevant documentation?</li>
<li>How does it interface with the compiler? E.g.: Fork the compiler, custom driver, custom codegen.</li>
<li>Does this tool rely on any data flow analysis information?</li>
<li>Does it require any sort of extra metadata?</li>
<li>Does it perform any code transformation?</li>
<li>Any other information that you would like to be captured in a stable MIR?</li>
</ol>



<a name="278071443"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/320896-project-stable-mir/topic/Current%20use%20cases%20of%20rustc%20MIR/near/278071443" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> bjorn3 <a href="https://zulip-archive.rust-lang.org/stream/320896-project-stable-mir/topic/Current.20use.20cases.20of.20rustc.20MIR.html#278071443">(Apr 06 2022 at 19:07)</a>:</h4>
<ol>
<li><a href="https://github.com/bjorn3/rustc_codegen_cranelift">rustc_codegen_cranelift</a>: Cranelift based codegen backend focused on compilation speed.</li>
<li>Custom codegen using <code>-Zcodegen-backend</code>.</li>
<li>No</li>
<li>No</li>
<li>No</li>
<li>Nothing the LLVM backend doesn't need either.<br>
note: cg_clif will likely keep using the unstable MIR format as it is planned to be distributed as part of rustc in the future</li>
</ol>



<a name="278288367"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/320896-project-stable-mir/topic/Current%20use%20cases%20of%20rustc%20MIR/near/278288367" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Xavier Denis <a href="https://zulip-archive.rust-lang.org/stream/320896-project-stable-mir/topic/Current.20use.20cases.20of.20rustc.20MIR.html#278288367">(Apr 08 2022 at 11:08)</a>:</h4>
<ol>
<li><a href="https://github.com/xldenis/creusot">Creusot</a>: A deductive verifier for safe code.</li>
<li>Custom Driver</li>
<li>Yes, liveness + initialization checks</li>
<li>Yes, we currently have to create a custom metadata file which we use to encode the contracts of verified functions in dependent crates</li>
<li>Only minor MIR cleanups: removing false edges, etc..</li>
<li>Invariants, proof assertions and ghost code. In general annotations on <code>DefId</code>s are important as they are used to signal different thigns to Creusot (ie: 'trust this function')</li>
</ol>



<a name="278409038"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/320896-project-stable-mir/topic/Current%20use%20cases%20of%20rustc%20MIR/near/278409038" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Vytautas Astrauskas [he/him] <a href="https://zulip-archive.rust-lang.org/stream/320896-project-stable-mir/topic/Current.20use.20cases.20of.20rustc.20MIR.html#278409038">(Apr 09 2022 at 12:59)</a>:</h4>
<ol>
<li><a href="https://github.com/viperproject/prusti-dev">Prusti</a>: a deductive verifier.</li>
<li>Custom driver.</li>
<li>Yes: borrowck facts, liveness, initialization.</li>
<li>Currently no, but it is possible that we will follow the Creusot path.</li>
<li>No: it is important for us that the used MIR is as close to the unoptimized MIR as possible.</li>
<li>Same as Creusot.</li>
</ol>



<a name="278409157"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/320896-project-stable-mir/topic/Current%20use%20cases%20of%20rustc%20MIR/near/278409157" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Vytautas Astrauskas [he/him] <a href="https://zulip-archive.rust-lang.org/stream/320896-project-stable-mir/topic/Current.20use.20cases.20of.20rustc.20MIR.html#278409157">(Apr 09 2022 at 13:00)</a>:</h4>
<p><span class="user-mention" data-user-id="116852">@Andrea Lattuada</span> Could you please add <a href="https://github.com/secure-foundations/verus">Verus</a>?</p>



<hr><p>Last updated: Apr 12 2022 at 20:01 UTC</p>
</html>