<html>
<head><meta charset="utf-8"><title>How to force-build for armv8.0-a instead of armv8.3-a? · t-compiler/arm · Zulip Chat Archive</title></head>
<h2>Stream: <a href="https://zulip-archive.rust-lang.org/stream/242906-t-compiler/arm/index.html">t-compiler/arm</a></h2>
<h3>Topic: <a href="https://zulip-archive.rust-lang.org/stream/242906-t-compiler/arm/topic/How.20to.20force-build.20for.20armv8.2E0-a.20instead.20of.20armv8.2E3-a.3F.html">How to force-build for armv8.0-a instead of armv8.3-a?</a></h3>

<hr>

<base href="https://rust-lang.zulipchat.com">

<head><link href="https://zulip-archive.rust-lang.org/style.css" rel="stylesheet"></head>

<a name="220363239"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/242906-t-compiler/arm/topic/How%20to%20force-build%20for%20armv8.0-a%20instead%20of%20armv8.3-a%3F/near/220363239" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mike Hommey <a href="https://zulip-archive.rust-lang.org/stream/242906-t-compiler/arm/topic/How.20to.20force-build.20for.20armv8.2E0-a.20instead.20of.20armv8.2E3-a.3F.html#220363239">(Dec 18 2020 at 11:55)</a>:</h4>
<p>(on aarch64-apple-darwin) I tried <code>-C target-feature=-apple-a12,-v8.3a,-v8.2a,-v8.1a</code> but that doesn't seem to work (e.g. <code>ldadd</code> instructions are still emitted)</p>



<a name="220368241"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/242906-t-compiler/arm/topic/How%20to%20force-build%20for%20armv8.0-a%20instead%20of%20armv8.3-a%3F/near/220368241" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nagisa <a href="https://zulip-archive.rust-lang.org/stream/242906-t-compiler/arm/topic/How.20to.20force-build.20for.20armv8.2E0-a.20instead.20of.20armv8.2E3-a.3F.html#220368241">(Dec 18 2020 at 12:56)</a>:</h4>
<p>(deleted)</p>



<a name="220368245"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/242906-t-compiler/arm/topic/How%20to%20force-build%20for%20armv8.0-a%20instead%20of%20armv8.3-a%3F/near/220368245" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nagisa <a href="https://zulip-archive.rust-lang.org/stream/242906-t-compiler/arm/topic/How.20to.20force-build.20for.20armv8.2E0-a.20instead.20of.20armv8.2E3-a.3F.html#220368245">(Dec 18 2020 at 12:56)</a>:</h4>
<p>(deleted)</p>



<a name="220368328"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/242906-t-compiler/arm/topic/How%20to%20force-build%20for%20armv8.0-a%20instead%20of%20armv8.3-a%3F/near/220368328" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nagisa <a href="https://zulip-archive.rust-lang.org/stream/242906-t-compiler/arm/topic/How.20to.20force-build.20for.20armv8.2E0-a.20instead.20of.20armv8.2E3-a.3F.html#220368328">(Dec 18 2020 at 12:57)</a>:</h4>
<p>(deleted)</p>



<a name="220368441"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/242906-t-compiler/arm/topic/How%20to%20force-build%20for%20armv8.0-a%20instead%20of%20armv8.3-a%3F/near/220368441" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nagisa <a href="https://zulip-archive.rust-lang.org/stream/242906-t-compiler/arm/topic/How.20to.20force-build.20for.20armv8.2E0-a.20instead.20of.20armv8.2E3-a.3F.html#220368441">(Dec 18 2020 at 12:58)</a>:</h4>
<p>(deleted)</p>



<a name="220368572"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/242906-t-compiler/arm/topic/How%20to%20force-build%20for%20armv8.0-a%20instead%20of%20armv8.3-a%3F/near/220368572" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nagisa <a href="https://zulip-archive.rust-lang.org/stream/242906-t-compiler/arm/topic/How.20to.20force-build.20for.20armv8.2E0-a.20instead.20of.20armv8.2E3-a.3F.html#220368572">(Dec 18 2020 at 13:00)</a>:</h4>
<p>(deleted)</p>



<a name="220368699"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/242906-t-compiler/arm/topic/How%20to%20force-build%20for%20armv8.0-a%20instead%20of%20armv8.3-a%3F/near/220368699" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nagisa <a href="https://zulip-archive.rust-lang.org/stream/242906-t-compiler/arm/topic/How.20to.20force-build.20for.20armv8.2E0-a.20instead.20of.20armv8.2E3-a.3F.html#220368699">(Dec 18 2020 at 13:01)</a>:</h4>
<p>(deleted)</p>



<a name="220369653"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/242906-t-compiler/arm/topic/How%20to%20force-build%20for%20armv8.0-a%20instead%20of%20armv8.3-a%3F/near/220369653" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nagisa <a href="https://zulip-archive.rust-lang.org/stream/242906-t-compiler/arm/topic/How.20to.20force-build.20for.20armv8.2E0-a.20instead.20of.20armv8.2E3-a.3F.html#220369653">(Dec 18 2020 at 13:10)</a>:</h4>
<p>Q: Are you building _everything_ with these flags? Including the libstd and libcore?</p>



<a name="220424244"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/242906-t-compiler/arm/topic/How%20to%20force-build%20for%20armv8.0-a%20instead%20of%20armv8.3-a%3F/near/220424244" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mike Hommey <a href="https://zulip-archive.rust-lang.org/stream/242906-t-compiler/arm/topic/How.20to.20force-build.20for.20armv8.2E0-a.20instead.20of.20armv8.2E3-a.3F.html#220424244">(Dec 18 2020 at 20:26)</a>:</h4>
<p>mmmm are you saying I could be seeing ldadds from inlined libstd code? I guess that's plausible, since their bitcode files would be tagged with apple-a12...</p>



<a name="220424418"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/242906-t-compiler/arm/topic/How%20to%20force-build%20for%20armv8.0-a%20instead%20of%20armv8.3-a%3F/near/220424418" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mike Hommey <a href="https://zulip-archive.rust-lang.org/stream/242906-t-compiler/arm/topic/How.20to.20force-build.20for.20armv8.2E0-a.20instead.20of.20armv8.2E3-a.3F.html#220424418">(Dec 18 2020 at 20:28)</a>:</h4>
<p>I should probably try -Z build-std, or hack the target definition and rebuild the entire compiler</p>



<a name="220425183"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/242906-t-compiler/arm/topic/How%20to%20force-build%20for%20armv8.0-a%20instead%20of%20armv8.3-a%3F/near/220425183" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mike Hommey <a href="https://zulip-archive.rust-lang.org/stream/242906-t-compiler/arm/topic/How.20to.20force-build.20for.20armv8.2E0-a.20instead.20of.20armv8.2E3-a.3F.html#220425183">(Dec 18 2020 at 20:36)</a>:</h4>
<p>well, -Z build-std doesn't work... it somehow pulls in 2 different libcore and is not happy about it.</p>



<a name="220427193"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/242906-t-compiler/arm/topic/How%20to%20force-build%20for%20armv8.0-a%20instead%20of%20armv8.3-a%3F/near/220427193" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nagisa <a href="https://zulip-archive.rust-lang.org/stream/242906-t-compiler/arm/topic/How.20to.20force-build.20for.20armv8.2E0-a.20instead.20of.20armv8.2E3-a.3F.html#220427193">(Dec 18 2020 at 20:57)</a>:</h4>
<p>That's the idea, yeah. Ribs can and do conrain machine code generated at their respective build tine</p>



<a name="220431099"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/242906-t-compiler/arm/topic/How%20to%20force-build%20for%20armv8.0-a%20instead%20of%20armv8.3-a%3F/near/220431099" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> simulacrum <a href="https://zulip-archive.rust-lang.org/stream/242906-t-compiler/arm/topic/How.20to.20force-build.20for.20armv8.2E0-a.20instead.20of.20armv8.2E3-a.3F.html#220431099">(Dec 18 2020 at 21:38)</a>:</h4>
<p>build-std should be fixed in the next few days (or you can go back to wednesday's nightly I think)</p>



<hr><p>Last updated: Apr 12 2022 at 20:01 UTC</p>
</html>