<html>
<head><meta charset="utf-8"><title>Run against external project · clippy · Zulip Chat Archive</title></head>
<h2>Stream: <a href="https://zulip-archive.rust-lang.org/stream/257328-clippy/index.html">clippy</a></h2>
<h3>Topic: <a href="https://zulip-archive.rust-lang.org/stream/257328-clippy/topic/Run.20against.20external.20project.html">Run against external project</a></h3>

<hr>

<base href="https://rust-lang.zulipchat.com">

<head><link href="https://zulip-archive.rust-lang.org/style.css" rel="stylesheet"></head>

<a name="225619307"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257328-clippy/topic/Run%20against%20external%20project/near/225619307" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Cameron Steffen <a href="https://zulip-archive.rust-lang.org/stream/257328-clippy/topic/Run.20against.20external.20project.html#225619307">(Feb 08 2021 at 22:32)</a>:</h4>
<p>How do I run my version of clippy against another project?</p>



<a name="225623165"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257328-clippy/topic/Run%20against%20external%20project/near/225623165" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> matthiaskrgr <a href="https://zulip-archive.rust-lang.org/stream/257328-clippy/topic/Run.20against.20external.20project.html#225623165">(Feb 08 2021 at 23:08)</a>:</h4>
<p>mmh it's a bit tricky</p>



<a name="225623234"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257328-clippy/topic/Run%20against%20external%20project/near/225623234" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> matthiaskrgr <a href="https://zulip-archive.rust-lang.org/stream/257328-clippy/topic/Run.20against.20external.20project.html#225623234">(Feb 08 2021 at 23:09)</a>:</h4>
<p>copy the <code>rust-toolchain</code> file from your clippy repo into your target repo (the repo you want to check  with your clippy)</p>



<a name="225623333"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257328-clippy/topic/Run%20against%20external%20project/near/225623333" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> matthiaskrgr <a href="https://zulip-archive.rust-lang.org/stream/257328-clippy/topic/Run.20against.20external.20project.html#225623333">(Feb 08 2021 at 23:10)</a>:</h4>
<p>then, from within the target repo:<br>
<code>cargo run --manifest-path=path/to/your/clippys/Cargo.toml --bin cargo-clippy</code></p>



<a name="225623402"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257328-clippy/topic/Run%20against%20external%20project/near/225623402" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> matthiaskrgr <a href="https://zulip-archive.rust-lang.org/stream/257328-clippy/topic/Run.20against.20external.20project.html#225623402">(Feb 08 2021 at 23:10)</a>:</h4>
<p>if the repo you want to check requires a rust-toolchain file that is different from clippys you'll have a problem :/</p>



<a name="225630571"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257328-clippy/topic/Run%20against%20external%20project/near/225630571" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Cameron Steffen <a href="https://zulip-archive.rust-lang.org/stream/257328-clippy/topic/Run.20against.20external.20project.html#225630571">(Feb 09 2021 at 00:38)</a>:</h4>
<p>thanks that worked!</p>



<a name="225630622"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257328-clippy/topic/Run%20against%20external%20project/near/225630622" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Cameron Steffen <a href="https://zulip-archive.rust-lang.org/stream/257328-clippy/topic/Run.20against.20external.20project.html#225630622">(Feb 09 2021 at 00:39)</a>:</h4>
<p>I wonder why I couldn't run cargo-clippy directly like in<code>integration_test</code> though?</p>



<a name="225634297"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257328-clippy/topic/Run%20against%20external%20project/near/225634297" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> matthiaskrgr <a href="https://zulip-archive.rust-lang.org/stream/257328-clippy/topic/Run.20against.20external.20project.html#225634297">(Feb 09 2021 at 01:24)</a>:</h4>
<p>the <code>rust-toolchain</code> file overrides everything inside the clippy repo, once you built it inside the clippy repo and try to use it outside of it, you get conflicting rustc versions/rustc libs</p>



<a name="225661845"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257328-clippy/topic/Run%20against%20external%20project/near/225661845" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> flip1995 <a href="https://zulip-archive.rust-lang.org/stream/257328-clippy/topic/Run.20against.20external.20project.html#225661845">(Feb 09 2021 at 09:19)</a>:</h4>
<p>I run Clippy on repos like this:</p>
<div class="codehilite"><pre><span></span><code>cargo install &amp;&amp; cp ~/.cargo/bin/*clippy* $(rustc --print sysroot)/bin
cd /path/to/crate
LD_LIBRARY_PATH=$(rustc +nightly-2021-02-01)/lib cargo +nightly-2021-02-01 clippy
</code></pre></div>
<p>Insert the nightly from the <code>rust-toolchain</code> file in the last comment</p>



<a name="225698172"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257328-clippy/topic/Run%20against%20external%20project/near/225698172" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Cameron Steffen <a href="https://zulip-archive.rust-lang.org/stream/257328-clippy/topic/Run.20against.20external.20project.html#225698172">(Feb 09 2021 at 14:35)</a>:</h4>
<p>Okay follow-up question, how do I run clippy with modifications to rustc?</p>



<a name="225700462"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257328-clippy/topic/Run%20against%20external%20project/near/225700462" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Cameron Steffen <a href="https://zulip-archive.rust-lang.org/stream/257328-clippy/topic/Run.20against.20external.20project.html#225700462">(Feb 09 2021 at 14:51)</a>:</h4>
<p><span class="user-mention" data-user-id="264664">@flip1995</span> I'm trying to dig in to the use_self issue</p>



<a name="225700995"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257328-clippy/topic/Run%20against%20external%20project/near/225700995" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> matthiaskrgr <a href="https://zulip-archive.rust-lang.org/stream/257328-clippy/topic/Run.20against.20external.20project.html#225700995">(Feb 09 2021 at 14:54)</a>:</h4>
<p>does it work if you modify the git subtree of clippy that is included inside the rustc repo?</p>



<a name="225701024"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257328-clippy/topic/Run%20against%20external%20project/near/225701024" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> matthiaskrgr <a href="https://zulip-archive.rust-lang.org/stream/257328-clippy/topic/Run.20against.20external.20project.html#225701024">(Feb 09 2021 at 14:54)</a>:</h4>
<p>(you can modify the clippy code and rustc code at the same time then)</p>



<a name="225701284"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257328-clippy/topic/Run%20against%20external%20project/near/225701284" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> flip1995 <a href="https://zulip-archive.rust-lang.org/stream/257328-clippy/topic/Run.20against.20external.20project.html#225701284">(Feb 09 2021 at 14:56)</a>:</h4>
<p><span class="user-mention silent" data-user-id="360405">Cameron Steffen</span> <a href="#narrow/stream/257328-clippy/topic/Run.20against.20external.20project/near/225698172">said</a>:</p>
<blockquote>
<p>Okay follow-up question, how do I run clippy with modifications to rustc?</p>
</blockquote>
<p>Uhm, back in the day I did this by compiling rustc from source <code>./x.py build</code> and then link the toolchain <code>rustup toolchain link rustc build/x86-.../satge1</code> and then compile Clippy wiht <code>cargo +rustc build</code>. But I don't know how to get components in linked toolchains, so that isn't possible. I'm writing this, because I hope someone knows how to do this and can tell me.</p>
<p>Anyway. You can change Clippy in rust-lang/rust and then build it there directly with <code>./x.py build src/tools/clippy</code>, copy the binaries to ~/.cargo and try <code>cargo +rustc clippy</code> in the crate you want to compile. You probably will have to set <code>LD_LIBRARY_PATH</code> for some libraries it may not find.</p>



<a name="225701486"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257328-clippy/topic/Run%20against%20external%20project/near/225701486" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> flip1995 <a href="https://zulip-archive.rust-lang.org/stream/257328-clippy/topic/Run.20against.20external.20project.html#225701486">(Feb 09 2021 at 14:57)</a>:</h4>
<p><span class="user-mention silent" data-user-id="360405">Cameron Steffen</span> <a href="#narrow/stream/257328-clippy/topic/Run.20against.20external.20project/near/225700462">said</a>:</p>
<blockquote>
<p><span class="user-mention silent" data-user-id="264664">flip1995</span> I'm trying to dig in to the use_self issue</p>
</blockquote>
<p>Oh, good luck.</p>



<a name="225701566"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257328-clippy/topic/Run%20against%20external%20project/near/225701566" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Cameron Steffen <a href="https://zulip-archive.rust-lang.org/stream/257328-clippy/topic/Run.20against.20external.20project.html#225701566">(Feb 09 2021 at 14:58)</a>:</h4>
<p>thanks</p>



<a name="225701737"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257328-clippy/topic/Run%20against%20external%20project/near/225701737" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Cameron Steffen <a href="https://zulip-archive.rust-lang.org/stream/257328-clippy/topic/Run.20against.20external.20project.html#225701737">(Feb 09 2021 at 14:59)</a>:</h4>
<p>Am I fearless, or just foolish? We'll find out.</p>



<a name="225702738"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257328-clippy/topic/Run%20against%20external%20project/near/225702738" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> matthiaskrgr <a href="https://zulip-archive.rust-lang.org/stream/257328-clippy/topic/Run.20against.20external.20project.html#225702738">(Feb 09 2021 at 15:05)</a>:</h4>
<p>foolish concurrency!  wait..</p>



<a name="225702950"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257328-clippy/topic/Run%20against%20external%20project/near/225702950" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Cameron Steffen <a href="https://zulip-archive.rust-lang.org/stream/257328-clippy/topic/Run.20against.20external.20project.html#225702950">(Feb 09 2021 at 15:06)</a>:</h4>
<p>that's funny. someone should write a blog post about foolish concurrency and fearless concurrency.</p>



<a name="225703471"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257328-clippy/topic/Run%20against%20external%20project/near/225703471" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> flip1995 <a href="https://zulip-archive.rust-lang.org/stream/257328-clippy/topic/Run.20against.20external.20project.html#225703471">(Feb 09 2021 at 15:09)</a>:</h4>
<p>At least you will know why I didn't work on the PR for a few months. <span aria-label="neutral" class="emoji emoji-1f610" role="img" title="neutral">:neutral:</span> Or you find a fix immediately and I'm just dumb, that would be great <span aria-label="tada" class="emoji emoji-1f389" role="img" title="tada">:tada:</span></p>



<a name="225706870"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257328-clippy/topic/Run%20against%20external%20project/near/225706870" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Cameron Steffen <a href="https://zulip-archive.rust-lang.org/stream/257328-clippy/topic/Run.20against.20external.20project.html#225706870">(Feb 09 2021 at 15:32)</a>:</h4>
<p>ugh. now I get this when I try to build clippy in rustc</p>



<a name="225706885"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257328-clippy/topic/Run%20against%20external%20project/near/225706885" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Cameron Steffen <a href="https://zulip-archive.rust-lang.org/stream/257328-clippy/topic/Run.20against.20external.20project.html#225706885">(Feb 09 2021 at 15:32)</a>:</h4>
<p>CMake Error: The source directory "../rust/src/llvm-project/llvm" does not exist.</p>



<a name="225707079"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257328-clippy/topic/Run%20against%20external%20project/near/225707079" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> flip1995 <a href="https://zulip-archive.rust-lang.org/stream/257328-clippy/topic/Run.20against.20external.20project.html#225707079">(Feb 09 2021 at 15:33)</a>:</h4>
<p><code>git submodule update --init</code></p>



<a name="225718675"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257328-clippy/topic/Run%20against%20external%20project/near/225718675" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Nelson <a href="https://zulip-archive.rust-lang.org/stream/257328-clippy/topic/Run.20against.20external.20project.html#225718675">(Feb 09 2021 at 16:44)</a>:</h4>
<p>consider setting <code>download-ci-llvm = true</code></p>



<a name="225718715"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257328-clippy/topic/Run%20against%20external%20project/near/225718715" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Nelson <a href="https://zulip-archive.rust-lang.org/stream/257328-clippy/topic/Run.20against.20external.20project.html#225718715">(Feb 09 2021 at 16:44)</a>:</h4>
<p>or in general <code>profile = "compiler"</code> has lots of useful defaults</p>



<a name="225719369"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257328-clippy/topic/Run%20against%20external%20project/near/225719369" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Nelson <a href="https://zulip-archive.rust-lang.org/stream/257328-clippy/topic/Run.20against.20external.20project.html#225719369">(Feb 09 2021 at 16:48)</a>:</h4>
<p><span class="user-mention" data-user-id="264664">@flip1995</span> you can see all the defaults in <code>src/bootstrap/defaults/config.compiler.toml</code></p>



<a name="225719899"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257328-clippy/topic/Run%20against%20external%20project/near/225719899" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> flip1995 <a href="https://zulip-archive.rust-lang.org/stream/257328-clippy/topic/Run.20against.20external.20project.html#225719899">(Feb 09 2021 at 16:52)</a>:</h4>
<p>Wait, I don't have to build LLVM all the time? <span aria-label="open mouth" class="emoji emoji-1f62e" role="img" title="open mouth">:open_mouth:</span> <span aria-label="tada" class="emoji emoji-1f389" role="img" title="tada">:tada:</span></p>



<a name="225720559"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257328-clippy/topic/Run%20against%20external%20project/near/225720559" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Cameron Steffen <a href="https://zulip-archive.rust-lang.org/stream/257328-clippy/topic/Run.20against.20external.20project.html#225720559">(Feb 09 2021 at 16:56)</a>:</h4>
<p>Yeah I thought that was possible but couldn't figure it out. The link in the rustc dev guide is broken.</p>



<a name="225720590"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257328-clippy/topic/Run%20against%20external%20project/near/225720590" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Nelson <a href="https://zulip-archive.rust-lang.org/stream/257328-clippy/topic/Run.20against.20external.20project.html#225720590">(Feb 09 2021 at 16:56)</a>:</h4>
<p><span class="user-mention silent" data-user-id="360405">Cameron Steffen</span> <a href="#narrow/stream/257328-clippy/topic/Run.20against.20external.20project/near/225720559">said</a>:</p>
<blockquote>
<p>Yeah I thought that was possible but couldn't figure it out. The link in the rustc dev guide is broken.</p>
</blockquote>
<p>can you link the page with the broken link?</p>



<a name="225720686"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257328-clippy/topic/Run%20against%20external%20project/near/225720686" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Cameron Steffen <a href="https://zulip-archive.rust-lang.org/stream/257328-clippy/topic/Run.20against.20external.20project.html#225720686">(Feb 09 2021 at 16:57)</a>:</h4>
<p>bottom of this section <a href="https://rustc-dev-guide.rust-lang.org/getting-started.html#configuring-the-compiler">https://rustc-dev-guide.rust-lang.org/getting-started.html#configuring-the-compiler</a></p>



<a name="225720795"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257328-clippy/topic/Run%20against%20external%20project/near/225720795" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Nelson <a href="https://zulip-archive.rust-lang.org/stream/257328-clippy/topic/Run.20against.20external.20project.html#225720795">(Feb 09 2021 at 16:57)</a>:</h4>
<p>oh that should just be removed I think</p>



<a name="225720842"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257328-clippy/topic/Run%20against%20external%20project/near/225720842" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Nelson <a href="https://zulip-archive.rust-lang.org/stream/257328-clippy/topic/Run.20against.20external.20project.html#225720842">(Feb 09 2021 at 16:58)</a>:</h4>
<p><code>profile = "compiler"</code> sets <code>download-ci-llvm</code> by default</p>



<a name="225721583"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257328-clippy/topic/Run%20against%20external%20project/near/225721583" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Nelson <a href="https://zulip-archive.rust-lang.org/stream/257328-clippy/topic/Run.20against.20external.20project.html#225721583">(Feb 09 2021 at 17:02)</a>:</h4>
<p>oh right this is <a href="https://github.com/rust-lang/rustc-dev-guide/pull/1043">https://github.com/rust-lang/rustc-dev-guide/pull/1043</a></p>



<a name="225722109"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257328-clippy/topic/Run%20against%20external%20project/near/225722109" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Cameron Steffen <a href="https://zulip-archive.rust-lang.org/stream/257328-clippy/topic/Run.20against.20external.20project.html#225722109">(Feb 09 2021 at 17:04)</a>:</h4>
<p>I have that and I'm pretty sure it still built llvm?</p>



<a name="225722235"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257328-clippy/topic/Run%20against%20external%20project/near/225722235" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Cameron Steffen <a href="https://zulip-archive.rust-lang.org/stream/257328-clippy/topic/Run.20against.20external.20project.html#225722235">(Feb 09 2021 at 17:05)</a>:</h4>
<p>It just finished though. Took about 3.5 years.</p>



<a name="225722243"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257328-clippy/topic/Run%20against%20external%20project/near/225722243" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Nelson <a href="https://zulip-archive.rust-lang.org/stream/257328-clippy/topic/Run.20against.20external.20project.html#225722243">(Feb 09 2021 at 17:05)</a>:</h4>
<p><span class="user-mention" data-user-id="360405">@Cameron Steffen</span> can you post your config.toml? also, what platform are you on?</p>



<a name="225722380"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257328-clippy/topic/Run%20against%20external%20project/near/225722380" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Cameron Steffen <a href="https://zulip-archive.rust-lang.org/stream/257328-clippy/topic/Run.20against.20external.20project.html#225722380">(Feb 09 2021 at 17:06)</a>:</h4>
<div class="codehilite" data-code-language="#"><pre><span></span><code>profile = "compiler"
changelog-seen = 2
</code></pre></div>



<a name="225722409"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257328-clippy/topic/Run%20against%20external%20project/near/225722409" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Cameron Steffen <a href="https://zulip-archive.rust-lang.org/stream/257328-clippy/topic/Run.20against.20external.20project.html#225722409">(Feb 09 2021 at 17:06)</a>:</h4>
<p>mac</p>



<a name="225722487"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257328-clippy/topic/Run%20against%20external%20project/near/225722487" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Nelson <a href="https://zulip-archive.rust-lang.org/stream/257328-clippy/topic/Run.20against.20external.20project.html#225722487">(Feb 09 2021 at 17:06)</a>:</h4>
<p>hmm, and what commit are you on?</p>



<a name="225722525"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257328-clippy/topic/Run%20against%20external%20project/near/225722525" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Nelson <a href="https://zulip-archive.rust-lang.org/stream/257328-clippy/topic/Run.20against.20external.20project.html#225722525">(Feb 09 2021 at 17:07)</a>:</h4>
<p>or where did you branch from master I guess is the better question</p>



<a name="225722559"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257328-clippy/topic/Run%20against%20external%20project/near/225722559" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Cameron Steffen <a href="https://zulip-archive.rust-lang.org/stream/257328-clippy/topic/Run.20against.20external.20project.html#225722559">(Feb 09 2021 at 17:07)</a>:</h4>
<p>0fc6756b42e</p>



<a name="225722642"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257328-clippy/topic/Run%20against%20external%20project/near/225722642" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> flip1995 <a href="https://zulip-archive.rust-lang.org/stream/257328-clippy/topic/Run.20against.20external.20project.html#225722642">(Feb 09 2021 at 17:07)</a>:</h4>
<blockquote>
<p>mac</p>
</blockquote>
<p>I mean, the comment above the <code>download-ci-llvm</code> says that it currently only works on linux.</p>



<a name="225722647"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257328-clippy/topic/Run%20against%20external%20project/near/225722647" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Nelson <a href="https://zulip-archive.rust-lang.org/stream/257328-clippy/topic/Run.20against.20external.20project.html#225722647">(Feb 09 2021 at 17:07)</a>:</h4>
<p><del>I don't have the commit localy</del> never mind, forgot to fetch</p>



<a name="225722661"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257328-clippy/topic/Run%20against%20external%20project/near/225722661" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Nelson <a href="https://zulip-archive.rust-lang.org/stream/257328-clippy/topic/Run.20against.20external.20project.html#225722661">(Feb 09 2021 at 17:07)</a>:</h4>
<p><span class="user-mention silent" data-user-id="264664">flip1995</span> <a href="#narrow/stream/257328-clippy/topic/Run.20against.20external.20project/near/225722642">said</a>:</p>
<blockquote>
<blockquote>
<p>mac</p>
</blockquote>
<p>I mean, the comment above the <code>download-ci-llvm</code> says that it currently only works on linux.</p>
</blockquote>
<p>oh oops the comment is wrong lol</p>



<a name="225722896"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257328-clippy/topic/Run%20against%20external%20project/near/225722896" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Nelson <a href="https://zulip-archive.rust-lang.org/stream/257328-clippy/topic/Run.20against.20external.20project.html#225722896">(Feb 09 2021 at 17:09)</a>:</h4>
<p>hmm, it should be picked up here: <a href="https://github.com/rust-lang/rust/blob/0fc6756b42e0556cc2e18079f5fc6b4d58f4e81a/src/bootstrap/bootstrap.py#L478">https://github.com/rust-lang/rust/blob/0fc6756b42e0556cc2e18079f5fc6b4d58f4e81a/src/bootstrap/bootstrap.py#L478</a></p>



<a name="225722932"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257328-clippy/topic/Run%20against%20external%20project/near/225722932" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Nelson <a href="https://zulip-archive.rust-lang.org/stream/257328-clippy/topic/Run.20against.20external.20project.html#225722932">(Feb 09 2021 at 17:09)</a>:</h4>
<p>unless you're on aarch64 maybe?</p>



<a name="225723008"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257328-clippy/topic/Run%20against%20external%20project/near/225723008" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Cameron Steffen <a href="https://zulip-archive.rust-lang.org/stream/257328-clippy/topic/Run.20against.20external.20project.html#225723008">(Feb 09 2021 at 17:10)</a>:</h4>
<p>no that is my platty</p>



<a name="225723083"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257328-clippy/topic/Run%20against%20external%20project/near/225723083" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Nelson <a href="https://zulip-archive.rust-lang.org/stream/257328-clippy/topic/Run.20against.20external.20project.html#225723083">(Feb 09 2021 at 17:10)</a>:</h4>
<p>that is very strange</p>



<a name="225723142"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257328-clippy/topic/Run%20against%20external%20project/near/225723142" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Nelson <a href="https://zulip-archive.rust-lang.org/stream/257328-clippy/topic/Run.20against.20external.20project.html#225723142">(Feb 09 2021 at 17:11)</a>:</h4>
<p>exactly what command are you running?</p>



<a name="225723145"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257328-clippy/topic/Run%20against%20external%20project/near/225723145" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Cameron Steffen <a href="https://zulip-archive.rust-lang.org/stream/257328-clippy/topic/Run.20against.20external.20project.html#225723145">(Feb 09 2021 at 17:11)</a>:</h4>
<p>does it take a while to install even if it is working?</p>



<a name="225723183"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257328-clippy/topic/Run%20against%20external%20project/near/225723183" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Cameron Steffen <a href="https://zulip-archive.rust-lang.org/stream/257328-clippy/topic/Run.20against.20external.20project.html#225723183">(Feb 09 2021 at 17:11)</a>:</h4>
<p><code>./x.py build src/tools/clippy</code></p>



<a name="225723185"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257328-clippy/topic/Run%20against%20external%20project/near/225723185" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Nelson <a href="https://zulip-archive.rust-lang.org/stream/257328-clippy/topic/Run.20against.20external.20project.html#225723185">(Feb 09 2021 at 17:11)</a>:</h4>
<p>it takes me about ~10 seconds to download and install it on x64 linux</p>



<a name="225723197"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257328-clippy/topic/Run%20against%20external%20project/near/225723197" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Cameron Steffen <a href="https://zulip-archive.rust-lang.org/stream/257328-clippy/topic/Run.20against.20external.20project.html#225723197">(Feb 09 2021 at 17:11)</a>:</h4>
<p>hmm</p>



<a name="225723323"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257328-clippy/topic/Run%20against%20external%20project/near/225723323" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Nelson <a href="https://zulip-archive.rust-lang.org/stream/257328-clippy/topic/Run.20against.20external.20project.html#225723323">(Feb 09 2021 at 17:12)</a>:</h4>
<p>yeah the first output I get for that command with a clean cache is </p>
<div class="codehilite"><pre><span></span><code>downloading https://static.rust-lang.org/dist/2020-12-30/rust-std-beta-x86_64-unknown-linux-gnu.tar.xz
</code></pre></div>



<a name="225723358"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257328-clippy/topic/Run%20against%20external%20project/near/225723358" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Nelson <a href="https://zulip-archive.rust-lang.org/stream/257328-clippy/topic/Run.20against.20external.20project.html#225723358">(Feb 09 2021 at 17:12)</a>:</h4>
<p>and then later</p>
<div class="codehilite"><pre><span></span><code>downloading https://ci-artifacts.rust-lang.org/rustc-builds/d95d4f0189e02ac2cd9056a0b39b0d5ab94fe69e/rust-dev-nightly-x86_64-unknown-linux-gnu.tar.xz
</code></pre></div>



<a name="225723372"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257328-clippy/topic/Run%20against%20external%20project/near/225723372" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Nelson <a href="https://zulip-archive.rust-lang.org/stream/257328-clippy/topic/Run.20against.20external.20project.html#225723372">(Feb 09 2021 at 17:12)</a>:</h4>
<p>^ which is LLVM, it's badly named</p>



<a name="225723765"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257328-clippy/topic/Run%20against%20external%20project/near/225723765" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Nelson <a href="https://zulip-archive.rust-lang.org/stream/257328-clippy/topic/Run.20against.20external.20project.html#225723765">(Feb 09 2021 at 17:15)</a>:</h4>
<p>try <code>x.py build -v</code> and send me the output?</p>



<a name="225723858"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257328-clippy/topic/Run%20against%20external%20project/near/225723858" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Cameron Steffen <a href="https://zulip-archive.rust-lang.org/stream/257328-clippy/topic/Run.20against.20external.20project.html#225723858">(Feb 09 2021 at 17:15)</a>:</h4>
<p>I think it's working now after x.py clean</p>



<a name="225723920"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257328-clippy/topic/Run%20against%20external%20project/near/225723920" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Cameron Steffen <a href="https://zulip-archive.rust-lang.org/stream/257328-clippy/topic/Run.20against.20external.20project.html#225723920">(Feb 09 2021 at 17:16)</a>:</h4>
<p>yup</p>



<a name="225723963"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257328-clippy/topic/Run%20against%20external%20project/near/225723963" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Cameron Steffen <a href="https://zulip-archive.rust-lang.org/stream/257328-clippy/topic/Run.20against.20external.20project.html#225723963">(Feb 09 2021 at 17:16)</a>:</h4>
<p>is this newly supported on mac?</p>



<a name="225723969"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257328-clippy/topic/Run%20against%20external%20project/near/225723969" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Nelson <a href="https://zulip-archive.rust-lang.org/stream/257328-clippy/topic/Run.20against.20external.20project.html#225723969">(Feb 09 2021 at 17:16)</a>:</h4>
<p>ah ok, weird that it depends on the build cache</p>



<a name="225723997"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257328-clippy/topic/Run%20against%20external%20project/near/225723997" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Nelson <a href="https://zulip-archive.rust-lang.org/stream/257328-clippy/topic/Run.20against.20external.20project.html#225723997">(Feb 09 2021 at 17:16)</a>:</h4>
<p><span class="user-mention silent" data-user-id="360405">Cameron Steffen</span> <a href="#narrow/stream/257328-clippy/topic/Run.20against.20external.20project/near/225723963">said</a>:</p>
<blockquote>
<p>is this newly supported on mac?</p>
</blockquote>
<p>yes: <a href="https://github.com/rust-lang/rust/pull/80932/">https://github.com/rust-lang/rust/pull/80932/</a></p>



<a name="225724043"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257328-clippy/topic/Run%20against%20external%20project/near/225724043" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Cameron Steffen <a href="https://zulip-archive.rust-lang.org/stream/257328-clippy/topic/Run.20against.20external.20project.html#225724043">(Feb 09 2021 at 17:16)</a>:</h4>
<p>you're a life saver!</p>



<a name="225724154"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257328-clippy/topic/Run%20against%20external%20project/near/225724154" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Cameron Steffen <a href="https://zulip-archive.rust-lang.org/stream/257328-clippy/topic/Run.20against.20external.20project.html#225724154">(Feb 09 2021 at 17:17)</a>:</h4>
<p>okay random question. I'm confused about stage 1 and 2 cause it seems like it's zero-based and sometimes one-based, am I right?</p>



<a name="225724201"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257328-clippy/topic/Run%20against%20external%20project/near/225724201" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Nelson <a href="https://zulip-archive.rust-lang.org/stream/257328-clippy/topic/Run.20against.20external.20project.html#225724201">(Feb 09 2021 at 17:18)</a>:</h4>
<p><a href="https://rustc-dev-guide.rust-lang.org/building/bootstrapping.html#understanding-stages-of-bootstrap">https://rustc-dev-guide.rust-lang.org/building/bootstrapping.html#understanding-stages-of-bootstrap</a></p>



<a name="225724367"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257328-clippy/topic/Run%20against%20external%20project/near/225724367" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Cameron Steffen <a href="https://zulip-archive.rust-lang.org/stream/257328-clippy/topic/Run.20against.20external.20project.html#225724367">(Feb 09 2021 at 17:19)</a>:</h4>
<p>let's just make that consistent please thanks <span aria-label="laughing" class="emoji emoji-1f606" role="img" title="laughing">:laughing:</span></p>



<a name="225724529"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257328-clippy/topic/Run%20against%20external%20project/near/225724529" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Nelson <a href="https://zulip-archive.rust-lang.org/stream/257328-clippy/topic/Run.20against.20external.20project.html#225724529">(Feb 09 2021 at 17:20)</a>:</h4>
<p>I tried :( <a href="https://github.com/rust-lang/rustc-dev-guide/pull/843">https://github.com/rust-lang/rustc-dev-guide/pull/843</a></p>



<a name="225724661"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257328-clippy/topic/Run%20against%20external%20project/near/225724661" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Cameron Steffen <a href="https://zulip-archive.rust-lang.org/stream/257328-clippy/topic/Run.20against.20external.20project.html#225724661">(Feb 09 2021 at 17:21)</a>:</h4>
<p>same link?</p>



<a name="225724883"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257328-clippy/topic/Run%20against%20external%20project/near/225724883" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Nelson <a href="https://zulip-archive.rust-lang.org/stream/257328-clippy/topic/Run.20against.20external.20project.html#225724883">(Feb 09 2021 at 17:22)</a>:</h4>
<p>Fixed, thanks</p>



<a name="225725288"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257328-clippy/topic/Run%20against%20external%20project/near/225725288" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Cameron Steffen <a href="https://zulip-archive.rust-lang.org/stream/257328-clippy/topic/Run.20against.20external.20project.html#225725288">(Feb 09 2021 at 17:25)</a>:</h4>
<p>I see that you put a lot of effort into making rustc more approachable. <span aria-label="thumbs up" class="emoji emoji-1f44d" role="img" title="thumbs up">:thumbs_up:</span></p>



<a name="225739625"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257328-clippy/topic/Run%20against%20external%20project/near/225739625" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Cameron Steffen <a href="https://zulip-archive.rust-lang.org/stream/257328-clippy/topic/Run.20against.20external.20project.html#225739625">(Feb 09 2021 at 18:59)</a>:</h4>
<p>Ugh I'm still struggling with getting clippy from rustc to run. Is <code>cargo +rustc</code> supposed to work?</p>



<a name="225745030"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257328-clippy/topic/Run%20against%20external%20project/near/225745030" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Cameron Steffen <a href="https://zulip-archive.rust-lang.org/stream/257328-clippy/topic/Run.20against.20external.20project.html#225745030">(Feb 09 2021 at 19:37)</a>:</h4>
<p>aHA! Got it working after figuring out <code>rustup toolchain link</code> and using  the necessary <code>LD_LIBRARY_PATH</code> as shown <a href="https://github.com/rust-lang/rustup/issues/2548">here</a></p>



<hr><p>Last updated: Apr 12 2022 at 20:01 UTC</p>
</html>