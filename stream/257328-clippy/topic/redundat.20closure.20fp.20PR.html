<html>
<head><meta charset="utf-8"><title>redundat closure fp PR · clippy · Zulip Chat Archive</title></head>
<h2>Stream: <a href="https://zulip-archive.rust-lang.org/stream/257328-clippy/index.html">clippy</a></h2>
<h3>Topic: <a href="https://zulip-archive.rust-lang.org/stream/257328-clippy/topic/redundat.20closure.20fp.20PR.html">redundat closure fp PR</a></h3>

<hr>

<base href="https://rust-lang.zulipchat.com">

<head><link href="https://zulip-archive.rust-lang.org/style.css" rel="stylesheet"></head>

<a name="258122802"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257328-clippy/topic/redundat%20closure%20fp%20PR/near/258122802" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> divma <a href="https://zulip-archive.rust-lang.org/stream/257328-clippy/topic/redundat.20closure.20fp.20PR.html#258122802">(Oct 19 2021 at 00:24)</a>:</h4>
<p>Could I get a review/advice on <a href="https://github.com/rust-lang/rust-clippy/pull/7821">https://github.com/rust-lang/rust-clippy/pull/7821</a> ?</p>



<a name="258134626"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257328-clippy/topic/redundat%20closure%20fp%20PR/near/258134626" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> dswijj <a href="https://zulip-archive.rust-lang.org/stream/257328-clippy/topic/redundat.20closure.20fp.20PR.html#258134626">(Oct 19 2021 at 03:08)</a>:</h4>
<p>Not a clippy team member, but I'll chime in if you don't mind :)</p>
<p>Maybe adding a test case for the FP in <a href="https://github.com/rust-lang/rust/issues/7812">#7812</a> will be nice just to be sure</p>



<a name="258196620"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257328-clippy/topic/redundat%20closure%20fp%20PR/near/258196620" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> flip1995 <a href="https://zulip-archive.rust-lang.org/stream/257328-clippy/topic/redundat.20closure.20fp.20PR.html#258196620">(Oct 19 2021 at 13:44)</a>:</h4>
<p>Sorry for the delay. I hope to get in my reviews by the weekend.</p>



<a name="258209680"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257328-clippy/topic/redundat%20closure%20fp%20PR/near/258209680" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> divma <a href="https://zulip-archive.rust-lang.org/stream/257328-clippy/topic/redundat.20closure.20fp.20PR.html#258209680">(Oct 19 2021 at 14:58)</a>:</h4>
<p>hey <span class="user-mention" data-user-id="431151">@dswijj</span> thanks for the review. Yeah I plan to add tests (as soon as I understand how/where to put them) you answered my question in any case :)</p>



<a name="258210686"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257328-clippy/topic/redundat%20closure%20fp%20PR/near/258210686" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> xFrednet <a href="https://zulip-archive.rust-lang.org/stream/257328-clippy/topic/redundat.20closure.20fp.20PR.html#258210686">(Oct 19 2021 at 15:03)</a>:</h4>
<p>Hey <span class="user-mention" data-user-id="259439">@divma</span> You can add your tests in <code>tests/ui/redundant_closure_call_late.rs</code> the test files seem to be a bit convoluted when it comes to this lint ^^</p>



<a name="258210928"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257328-clippy/topic/redundat%20closure%20fp%20PR/near/258210928" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> xFrednet <a href="https://zulip-archive.rust-lang.org/stream/257328-clippy/topic/redundat.20closure.20fp.20PR.html#258210928">(Oct 19 2021 at 15:05)</a>:</h4>
<p>That file at least also has some cases that trigger <code>redundant_closure</code></p>



<a name="258211177"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257328-clippy/topic/redundat%20closure%20fp%20PR/near/258211177" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> xFrednet <a href="https://zulip-archive.rust-lang.org/stream/257328-clippy/topic/redundat.20closure.20fp.20PR.html#258211177">(Oct 19 2021 at 15:06)</a>:</h4>
<p><code>tests/ui/eta.rs</code> also seems like a good choice. That file was used to add tests in <a href="https://github.com/rust-lang/rust-clippy/issues/7661">rust-clippy#7661</a></p>
<p>This file seems to be the correct one to use <span aria-label="upside down" class="emoji emoji-1f643" role="img" title="upside down">:upside_down:</span></p>



<a name="264649726"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257328-clippy/topic/redundat%20closure%20fp%20PR/near/264649726" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> divma <a href="https://zulip-archive.rust-lang.org/stream/257328-clippy/topic/redundat.20closure.20fp.20PR.html#264649726">(Dec 12 2021 at 23:26)</a>:</h4>
<p>Anyone here knows a way to know if some code was coerced? I tried with this change without success</p>
<div class="codehilite" data-code-language="Diff"><pre><span></span><code><span class="gd">- cx.typeck_results().expr_ty_adjusted(callee);</span>
<span class="gi">+ cx.typeck_results().expr_ty(callee);</span>
</code></pre></div>



<a name="264649752"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257328-clippy/topic/redundat%20closure%20fp%20PR/near/264649752" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> divma <a href="https://zulip-archive.rust-lang.org/stream/257328-clippy/topic/redundat.20closure.20fp.20PR.html#264649752">(Dec 12 2021 at 23:27)</a>:</h4>
<p>so adjustments don't seem to get that</p>



<a name="264650184"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257328-clippy/topic/redundat%20closure%20fp%20PR/near/264650184" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> divma <a href="https://zulip-archive.rust-lang.org/stream/257328-clippy/topic/redundat.20closure.20fp.20PR.html#264650184">(Dec 12 2021 at 23:38)</a>:</h4>
<p>tried too with <code>cx.typeck_results().is_coercion_cast(the_id)</code></p>



<a name="264651559"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257328-clippy/topic/redundat%20closure%20fp%20PR/near/264651559" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> divma <a href="https://zulip-archive.rust-lang.org/stream/257328-clippy/topic/redundat.20closure.20fp.20PR.html#264651559">(Dec 13 2021 at 00:07)</a>:</h4>
<p>maybe I'm using the wrong hir_id? not sure</p>



<a name="264662726"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257328-clippy/topic/redundat%20closure%20fp%20PR/near/264662726" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> DevinR528 <a href="https://zulip-archive.rust-lang.org/stream/257328-clippy/topic/redundat.20closure.20fp.20PR.html#264662726">(Dec 13 2021 at 04:28)</a>:</h4>
<p>(deleted)</p>



<a name="265025855"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257328-clippy/topic/redundat%20closure%20fp%20PR/near/265025855" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> divma <a href="https://zulip-archive.rust-lang.org/stream/257328-clippy/topic/redundat.20closure.20fp.20PR.html#265025855">(Dec 15 2021 at 15:29)</a>:</h4>
<p>I'll try this out in a few days and report back. Thanks for the suggestion!</p>



<a name="265506703"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257328-clippy/topic/redundat%20closure%20fp%20PR/near/265506703" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Cameron Steffen <a href="https://zulip-archive.rust-lang.org/stream/257328-clippy/topic/redundat.20closure.20fp.20PR.html#265506703">(Dec 19 2021 at 23:35)</a>:</h4>
<p>Implicit coercions can be observed directly using <code>cx.typeck_results().expr_adjustments()</code>. This is like "what is the cause of <code>expr_ty_adjusted</code> being different?"</p>



<hr><p>Last updated: Apr 12 2022 at 20:01 UTC</p>
</html>