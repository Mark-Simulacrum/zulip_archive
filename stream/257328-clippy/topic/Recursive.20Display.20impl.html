<html>
<head><meta charset="utf-8"><title>Recursive Display impl · clippy · Zulip Chat Archive</title></head>
<h2>Stream: <a href="https://zulip-archive.rust-lang.org/stream/257328-clippy/index.html">clippy</a></h2>
<h3>Topic: <a href="https://zulip-archive.rust-lang.org/stream/257328-clippy/topic/Recursive.20Display.20impl.html">Recursive Display impl</a></h3>

<hr>

<base href="https://rust-lang.zulipchat.com">

<head><link href="https://zulip-archive.rust-lang.org/style.css" rel="stylesheet"></head>

<a name="265693615"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257328-clippy/topic/Recursive%20Display%20impl/near/265693615" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> jamesmcm <a href="https://zulip-archive.rust-lang.org/stream/257328-clippy/topic/Recursive.20Display.20impl.html#265693615">(Dec 21 2021 at 14:56)</a>:</h4>
<p>Hey,<br>
 I wanted to take a look at implementing the Recursive Display Impl lint (see issues <a href="https://github.com/rust-lang/rust-clippy/issues/2691">#2691</a> and <a href="https://github.com/rust-lang/rust-clippy/issues/7830">#7830</a> ).<br>
But it's not clear to me if it's possible to check whether the expression in the Display impl ever ends up using Display of self when it's done indirectly (e.g. via <code>.to_string()</code> or de-referencing inside a format string <code>&amp;*self</code>- see the examples in the issues) - it's not as simple as just matching a method name in this case (as is done for the <a href="https://github.com/rust-lang/rust-clippy/blob/3bfe98d372fc4dacd12a7f0c06d44d72e2e96cd2/clippy_lints/src/to_string_in_display.rs">existing lint on .to_string() inside Display</a>, and the <a href="https://github.com/rust-lang/rust-clippy/blob/3bfe98d372fc4dacd12a7f0c06d44d72e2e96cd2/clippy_lints/src/main_recursion.rs">main() recursion lint</a>), instead we need to check all of the calls that the expression makes (i.e. the actual generated code).</p>



<a name="266115078"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257328-clippy/topic/Recursive%20Display%20impl/near/266115078" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Cameron Steffen <a href="https://zulip-archive.rust-lang.org/stream/257328-clippy/topic/Recursive.20Display.20impl.html#266115078">(Dec 26 2021 at 15:53)</a>:</h4>
<p>This would work very similar to the <code>format_in_format_args</code> lint</p>



<a name="266115086"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257328-clippy/topic/Recursive%20Display%20impl/near/266115086" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Cameron Steffen <a href="https://zulip-archive.rust-lang.org/stream/257328-clippy/topic/Recursive.20Display.20impl.html#266115086">(Dec 26 2021 at 15:53)</a>:</h4>
<p><a href="https://github.com/rust-lang/rust-clippy/pull/7743">https://github.com/rust-lang/rust-clippy/pull/7743</a></p>



<a name="266288442"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257328-clippy/topic/Recursive%20Display%20impl/near/266288442" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> jamesmcm <a href="https://zulip-archive.rust-lang.org/stream/257328-clippy/topic/Recursive.20Display.20impl.html#266288442">(Dec 28 2021 at 20:08)</a>:</h4>
<p>thanks! I opened the PR at <a href="https://github.com/rust-lang/rust-clippy/pull/8188">https://github.com/rust-lang/rust-clippy/pull/8188</a></p>



<hr><p>Last updated: Apr 12 2022 at 20:01 UTC</p>
</html>