<html>
<head><meta charset="utf-8"><title>NestedVisitorMap · clippy · Zulip Chat Archive</title></head>
<h2>Stream: <a href="https://zulip-archive.rust-lang.org/stream/257328-clippy/index.html">clippy</a></h2>
<h3>Topic: <a href="https://zulip-archive.rust-lang.org/stream/257328-clippy/topic/NestedVisitorMap.html">NestedVisitorMap</a></h3>

<hr>

<base href="https://rust-lang.zulipchat.com">

<head><link href="https://zulip-archive.rust-lang.org/style.css" rel="stylesheet"></head>

<a name="260302564"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257328-clippy/topic/NestedVisitorMap/near/260302564" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Alex Macleod <a href="https://zulip-archive.rust-lang.org/stream/257328-clippy/topic/NestedVisitorMap.html#260302564">(Nov 04 2021 at 17:04)</a>:</h4>
<p>Hello! For a <code>rustc_hir::intravisit::Visitor</code> is there a rule of thumb for which <code>NestedVisitorMap</code> I should be using? I've read some of the docs but I'm not sure what something being nested actually means</p>



<a name="260303484"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257328-clippy/topic/NestedVisitorMap/near/260303484" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> flip1995 <a href="https://zulip-archive.rust-lang.org/stream/257328-clippy/topic/NestedVisitorMap.html#260303484">(Nov 04 2021 at 17:10)</a>:</h4>
<p>My rule of thumb is this is, on the example of visiting a function body:</p>
<ul>
<li>Do you want to only do a shallow visit? -&gt; None</li>
<li>Do you also want to visit closure-definition-like things? -&gt; OnlyBodies</li>
<li>Do you also want to visit function bodies that are defined in the function body, you're currently visiting? -&gt; All</li>
</ul>



<a name="260303673"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257328-clippy/topic/NestedVisitorMap/near/260303673" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> flip1995 <a href="https://zulip-archive.rust-lang.org/stream/257328-clippy/topic/NestedVisitorMap.html#260303673">(Nov 04 2021 at 17:11)</a>:</h4>
<p>If you visit a function body, you probably want to do <code>OnlyBodies</code>. If you just want to walk an expression with your visitor, you want to use <code>None</code>. I'm not sure if we ever use <code>All</code> in Clippy (EDIT: we do in a few cases, not sure why though).</p>



<hr><p>Last updated: Apr 12 2022 at 20:01 UTC</p>
</html>