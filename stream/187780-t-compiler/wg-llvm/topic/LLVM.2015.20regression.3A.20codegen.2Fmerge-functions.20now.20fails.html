<html>
<head><meta charset="utf-8"><title>LLVM 15 regression: codegen/merge-functions now fails · t-compiler/wg-llvm · Zulip Chat Archive</title></head>
<h2>Stream: <a href="https://zulip-archive.rust-lang.org/stream/187780-t-compiler/wg-llvm/index.html">t-compiler/wg-llvm</a></h2>
<h3>Topic: <a href="https://zulip-archive.rust-lang.org/stream/187780-t-compiler/wg-llvm/topic/LLVM.2015.20regression.3A.20codegen.2Fmerge-functions.20now.20fails.html">LLVM 15 regression: codegen/merge-functions now fails</a></h3>

<hr>

<base href="https://rust-lang.zulipchat.com">

<head><link href="https://zulip-archive.rust-lang.org/style.css" rel="stylesheet"></head>

<a name="270468926"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/187780-t-compiler/wg-llvm/topic/LLVM%2015%20regression%3A%20codegen/merge-functions%20now%20fails/near/270468926" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> durin42 <a href="https://zulip-archive.rust-lang.org/stream/187780-t-compiler/wg-llvm/topic/LLVM.2015.20regression.3A.20codegen.2Fmerge-functions.20now.20fails.html#270468926">(Feb 02 2022 at 22:29)</a>:</h4>
<p>LLVM change <a href="https://github.com/llvm/llvm-project/commit/1e353f092288309d74d380367aa50bbd383780ed">1e353f092288</a> changed some optimizations such that the two functions in codegen/merge-functions no longer compile down to equivalent IR, at least at <code>-O</code>. From some asking around (including <a href="https://reviews.llvm.org/rG1e353f092288309d74d380367aa50bbd383780ed#1056245">on the diffusion revision in phabrciator</a> ) it sounds like unless we're specifically worried about the way the code in that test optimizes (are we?) we should rework the test some so that we can still test the function-merging behavior without relying on that specific optimization. Anyone here have thoughts?</p>



<a name="270531890"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/187780-t-compiler/wg-llvm/topic/LLVM%2015%20regression%3A%20codegen/merge-functions%20now%20fails/near/270531890" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Nikita Popov <a href="https://zulip-archive.rust-lang.org/stream/187780-t-compiler/wg-llvm/topic/LLVM.2015.20regression.3A.20codegen.2Fmerge-functions.20now.20fails.html#270531890">(Feb 03 2022 at 11:06)</a>:</h4>
<p>The patch has been reverted.</p>



<a name="270546172"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/187780-t-compiler/wg-llvm/topic/LLVM%2015%20regression%3A%20codegen/merge-functions%20now%20fails/near/270546172" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> durin42 <a href="https://zulip-archive.rust-lang.org/stream/187780-t-compiler/wg-llvm/topic/LLVM.2015.20regression.3A.20codegen.2Fmerge-functions.20now.20fails.html#270546172">(Feb 03 2022 at 13:14)</a>:</h4>
<p>I saw! Thanks for diving in there.</p>



<hr><p>Last updated: Apr 12 2022 at 20:01 UTC</p>
</html>