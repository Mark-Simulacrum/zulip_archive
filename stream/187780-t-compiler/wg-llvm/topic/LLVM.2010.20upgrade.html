<html>
<head><meta charset="utf-8"><title>LLVM 10 upgrade · t-compiler/wg-llvm · Zulip Chat Archive</title></head>
<h2>Stream: <a href="https://rust-lang.github.io/zulip_archive/stream/187780-t-compiler/wg-llvm/index.html">t-compiler/wg-llvm</a></h2>
<h3>Topic: <a href="https://rust-lang.github.io/zulip_archive/stream/187780-t-compiler/wg-llvm/topic/LLVM.2010.20upgrade.html">LLVM 10 upgrade</a></h3>

<hr>

<base href="https://rust-lang.zulipchat.com">

<head><link href="https://rust-lang.github.io/zulip_archive/style.css" rel="stylesheet"></head>

<a name="184854035"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/187780-t-compiler/wg-llvm/topic/LLVM%2010%20upgrade/near/184854035" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Nikita Popov <a href="https://rust-lang.github.io/zulip_archive/stream/187780-t-compiler/wg-llvm/topic/LLVM.2010.20upgrade.html#184854035">(Jan 05 2020 at 16:03)</a>:</h4>
<p>FYI I've started some work on upgrading on LLVM 10 in <a href="https://github.com/rust-lang/rust/pull/67759" target="_blank" title="https://github.com/rust-lang/rust/pull/67759">https://github.com/rust-lang/rust/pull/67759</a>. Unfortunately things look quite bleak where compile-time is concerned.</p>



<a name="185063493"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/187780-t-compiler/wg-llvm/topic/LLVM%2010%20upgrade/near/185063493" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> cuviper <a href="https://rust-lang.github.io/zulip_archive/stream/187780-t-compiler/wg-llvm/topic/LLVM.2010.20upgrade.html#185063493">(Jan 07 2020 at 22:50)</a>:</h4>
<p>should we rebase on 9.0.1 in the meantime?</p>



<a name="185064427"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/187780-t-compiler/wg-llvm/topic/LLVM%2010%20upgrade/near/185064427" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Nikita Popov <a href="https://rust-lang.github.io/zulip_archive/stream/187780-t-compiler/wg-llvm/topic/LLVM.2010.20upgrade.html#185064427">(Jan 07 2020 at 23:02)</a>:</h4>
<p>Sounds reasonable.</p>



<a name="185949780"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/187780-t-compiler/wg-llvm/topic/LLVM%2010%20upgrade/near/185949780" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Alex Crichton <a href="https://rust-lang.github.io/zulip_archive/stream/187780-t-compiler/wg-llvm/topic/LLVM.2010.20upgrade.html#185949780">(Jan 17 2020 at 19:45)</a>:</h4>
<p>As a heads up, it looks like the wasm dwarf patches have landed in LLVM 10, so we won't need to rebase those</p>



<a name="191153963"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/187780-t-compiler/wg-llvm/topic/LLVM%2010%20upgrade/near/191153963" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> cuviper <a href="https://rust-lang.github.io/zulip_archive/stream/187780-t-compiler/wg-llvm/topic/LLVM.2010.20upgrade.html#191153963">(Mar 19 2020 at 18:12)</a>:</h4>
<p><span class="user-mention" data-user-id="133224">@Nikita Popov</span> can we get a PR with the latest LLVM 10 compatibility changes? I guess performance is still a concern for updating the submodule, but I will probably want to move rustc to LLVM 10 in Fedora soon anyway.</p>



<a name="191154023"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/187780-t-compiler/wg-llvm/topic/LLVM%2010%20upgrade/near/191154023" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> cuviper <a href="https://rust-lang.github.io/zulip_archive/stream/187780-t-compiler/wg-llvm/topic/LLVM.2010.20upgrade.html#191154023">(Mar 19 2020 at 18:12)</a>:</h4>
<p>I can cherry-pick into a new PR myself, if you like</p>



<a name="191161761"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/187780-t-compiler/wg-llvm/topic/LLVM%2010%20upgrade/near/191161761" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Nikita Popov <a href="https://rust-lang.github.io/zulip_archive/stream/187780-t-compiler/wg-llvm/topic/LLVM.2010.20upgrade.html#191161761">(Mar 19 2020 at 19:13)</a>:</h4>
<p><span class="user-mention" data-user-id="138448">@cuviper</span> I've opened <a href="https://github.com/rust-lang/rust/pull/70163" target="_blank" title="https://github.com/rust-lang/rust/pull/70163">https://github.com/rust-lang/rust/pull/70163</a> with everything but the submodule update.</p>



<a name="191162626"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/187780-t-compiler/wg-llvm/topic/LLVM%2010%20upgrade/near/191162626" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Nikita Popov <a href="https://rust-lang.github.io/zulip_archive/stream/187780-t-compiler/wg-llvm/topic/LLVM.2010.20upgrade.html#191162626">(Mar 19 2020 at 19:20)</a>:</h4>
<p>And yeah, I didn't have much luck figuring out what the compile-time issue is. If anyone else could take a poke at that, it would be great.</p>



<a name="191163106"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/187780-t-compiler/wg-llvm/topic/LLVM%2010%20upgrade/near/191163106" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Nikita Popov <a href="https://rust-lang.github.io/zulip_archive/stream/187780-t-compiler/wg-llvm/topic/LLVM.2010.20upgrade.html#191163106">(Mar 19 2020 at 19:24)</a>:</h4>
<p>On the positive side, I got somewhat pissed about the the criminal negligence that LLVM has towards compile-time and have set up <a href="http://llvm-compile-time-tracker.com/" target="_blank" title="http://llvm-compile-time-tracker.com/">http://llvm-compile-time-tracker.com/</a> over the weekend. Maybe it will help to identify issues early.</p>



<a name="191167427"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/187780-t-compiler/wg-llvm/topic/LLVM%2010%20upgrade/near/191167427" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> cuviper <a href="https://rust-lang.github.io/zulip_archive/stream/187780-t-compiler/wg-llvm/topic/LLVM.2010.20upgrade.html#191167427">(Mar 19 2020 at 19:59)</a>:</h4>
<p>Thanks! I'll give that a spin locally and then <code>r+</code></p>



<a name="191764870"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/187780-t-compiler/wg-llvm/topic/LLVM%2010%20upgrade/near/191764870" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> RalfJ <a href="https://rust-lang.github.io/zulip_archive/stream/187780-t-compiler/wg-llvm/topic/LLVM.2010.20upgrade.html#191764870">(Mar 25 2020 at 15:37)</a>:</h4>
<p>so how hard would it be to retroactively fill that website with data from the LLVM 10 dev cycle to maybe narrow down the regression?</p>



<a name="192321205"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/187780-t-compiler/wg-llvm/topic/LLVM%2010%20upgrade/near/192321205" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> cuviper <a href="https://rust-lang.github.io/zulip_archive/stream/187780-t-compiler/wg-llvm/topic/LLVM.2010.20upgrade.html#192321205">(Mar 30 2020 at 21:43)</a>:</h4>
<div class="codehilite"><pre><span></span>$ git log --oneline release/9.x..release/10.x | wc -l
17808
</pre></div>



<a name="192321222"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/187780-t-compiler/wg-llvm/topic/LLVM%2010%20upgrade/near/192321222" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> cuviper <a href="https://rust-lang.github.io/zulip_archive/stream/187780-t-compiler/wg-llvm/topic/LLVM.2010.20upgrade.html#192321222">(Mar 30 2020 at 21:43)</a>:</h4>
<p>seems hard to retroactively do all of that</p>



<a name="192321269"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/187780-t-compiler/wg-llvm/topic/LLVM%2010%20upgrade/near/192321269" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> cuviper <a href="https://rust-lang.github.io/zulip_archive/stream/187780-t-compiler/wg-llvm/topic/LLVM.2010.20upgrade.html#192321269">(Mar 30 2020 at 21:44)</a>:</h4>
<p>maybe it could be done like a bisection?</p>



<a name="192321592"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/187780-t-compiler/wg-llvm/topic/LLVM%2010%20upgrade/near/192321592" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> cuviper <a href="https://rust-lang.github.io/zulip_archive/stream/187780-t-compiler/wg-llvm/topic/LLVM.2010.20upgrade.html#192321592">(Mar 30 2020 at 21:47)</a>:</h4>
<p>but there's probably not one thing to zero in on -- more likely a lot of performance paper cuts</p>



<a name="192480364"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/187780-t-compiler/wg-llvm/topic/LLVM%2010%20upgrade/near/192480364" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> mark-i-m <a href="https://rust-lang.github.io/zulip_archive/stream/187780-t-compiler/wg-llvm/topic/LLVM.2010.20upgrade.html#192480364">(Apr 01 2020 at 03:41)</a>:</h4>
<p>Could it be bisected?</p>



<a name="194739887"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/187780-t-compiler/wg-llvm/topic/LLVM%2010%20upgrade/near/194739887" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> RalfJ <a href="https://rust-lang.github.io/zulip_archive/stream/187780-t-compiler/wg-llvm/topic/LLVM.2010.20upgrade.html#194739887">(Apr 20 2020 at 22:11)</a>:</h4>
<p>Looks like we are not the only ones suffering from LLVM getting slower:<br>
<a href="https://lists.llvm.org/pipermail/llvm-dev/2020-April/140938.html" title="https://lists.llvm.org/pipermail/llvm-dev/2020-April/140938.html">https://lists.llvm.org/pipermail/llvm-dev/2020-April/140938.html</a></p>



<a name="195292795"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/187780-t-compiler/wg-llvm/topic/LLVM%2010%20upgrade/near/195292795" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> mark-i-m <a href="https://rust-lang.github.io/zulip_archive/stream/187780-t-compiler/wg-llvm/topic/LLVM.2010.20upgrade.html#195292795">(Apr 25 2020 at 16:49)</a>:</h4>
<p>Is it a viable path to just skip LLVM 10 altogether and hope that LLVM 11 has better perf?</p>



<a name="195292829"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/187780-t-compiler/wg-llvm/topic/LLVM%2010%20upgrade/near/195292829" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> mark-i-m <a href="https://rust-lang.github.io/zulip_archive/stream/187780-t-compiler/wg-llvm/topic/LLVM.2010.20upgrade.html#195292829">(Apr 25 2020 at 16:50)</a>:</h4>
<p>i.e. is that something we could actually consider, or does it have other technical problems?</p>



<a name="195293348"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/187780-t-compiler/wg-llvm/topic/LLVM%2010%20upgrade/near/195293348" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> cuviper <a href="https://rust-lang.github.io/zulip_archive/stream/187780-t-compiler/wg-llvm/topic/LLVM.2010.20upgrade.html#195293348">(Apr 25 2020 at 17:01)</a>:</h4>
<p>sure, I see no technical problem with that</p>



<a name="195293357"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/187780-t-compiler/wg-llvm/topic/LLVM%2010%20upgrade/near/195293357" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> cuviper <a href="https://rust-lang.github.io/zulip_archive/stream/187780-t-compiler/wg-llvm/topic/LLVM.2010.20upgrade.html#195293357">(Apr 25 2020 at 17:01)</a>:</h4>
<p>the rust repo <em>supports</em> LLVM 10 now</p>



<a name="195295584"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/187780-t-compiler/wg-llvm/topic/LLVM%2010%20upgrade/near/195295584" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Amanieu <a href="https://rust-lang.github.io/zulip_archive/stream/187780-t-compiler/wg-llvm/topic/LLVM.2010.20upgrade.html#195295584">(Apr 25 2020 at 17:56)</a>:</h4>
<p>Well there's the fact that debuginfo for RISC-V is pretty broken in LLVM 9... It's fixed in LLVM 10.</p>



<a name="195392546"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/187780-t-compiler/wg-llvm/topic/LLVM%2010%20upgrade/near/195392546" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> mati865 <a href="https://rust-lang.github.io/zulip_archive/stream/187780-t-compiler/wg-llvm/topic/LLVM.2010.20upgrade.html#195392546">(Apr 27 2020 at 09:29)</a>:</h4>
<p>LLVM tends to optimise more and more. It's more likely LLVM 11 will be even slower than LLVM 10 than the opposite.<br>
There is fairly recent comparison from Clang 6 to Clang 10(pre-release): <a href="https://openbenchmarking.org/result/1912190-HU-COREI759690" title="https://openbenchmarking.org/result/1912190-HU-COREI759690">https://openbenchmarking.org/result/1912190-HU-COREI759690</a> just hit ctrl+f and search for "Time To Compile".<br>
More detailed Clang 9 vs Clang 10 (final): <a href="https://www.phoronix.com/scan.php?page=article&amp;item=clang-10-benchmarks&amp;num=4" title="https://www.phoronix.com/scan.php?page=article&amp;item=clang-10-benchmarks&amp;num=4">https://www.phoronix.com/scan.php?page=article&amp;item=clang-10-benchmarks&amp;num=4</a></p>



<a name="195929754"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/187780-t-compiler/wg-llvm/topic/LLVM%2010%20upgrade/near/195929754" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> mark-i-m <a href="https://rust-lang.github.io/zulip_archive/stream/187780-t-compiler/wg-llvm/topic/LLVM.2010.20upgrade.html#195929754">(May 01 2020 at 03:57)</a>:</h4>
<p>Hmm... well that's troubling trend.</p>



<a name="195929799"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/187780-t-compiler/wg-llvm/topic/LLVM%2010%20upgrade/near/195929799" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> mark-i-m <a href="https://rust-lang.github.io/zulip_archive/stream/187780-t-compiler/wg-llvm/topic/LLVM.2010.20upgrade.html#195929799">(May 01 2020 at 03:58)</a>:</h4>
<p>Is there a way to turn off llvm optimizations selectively? e.g. only keep optimizations that were enabled in llvm 9? then we could incrementally turn on the optimizations we want</p>



<a name="196059179"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/187780-t-compiler/wg-llvm/topic/LLVM%2010%20upgrade/near/196059179" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Nikita Popov <a href="https://rust-lang.github.io/zulip_archive/stream/187780-t-compiler/wg-llvm/topic/LLVM.2010.20upgrade.html#196059179">(May 02 2020 at 16:25)</a>:</h4>
<p>Things are looking pretty good for LLVM 11 actually. We're down about 7-8% since I started measuring. Of course, no idea how well that will translate to Rust, which generates significantly different IR than clang.</p>



<a name="197086773"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/187780-t-compiler/wg-llvm/topic/LLVM%2010%20upgrade/near/197086773" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nagisa <a href="https://rust-lang.github.io/zulip_archive/stream/187780-t-compiler/wg-llvm/topic/LLVM.2010.20upgrade.html#197086773">(May 11 2020 at 00:00)</a>:</h4>
<p><span class="user-mention" data-user-id="133224">@Nikita Popov</span> congrats on being almost at the top of HN!</p>



<a name="197087129"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/187780-t-compiler/wg-llvm/topic/LLVM%2010%20upgrade/near/197087129" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nagisa <a href="https://rust-lang.github.io/zulip_archive/stream/187780-t-compiler/wg-llvm/topic/LLVM.2010.20upgrade.html#197087129">(May 11 2020 at 00:09)</a>:</h4>
<p>… and top now.</p>



<a name="197182013"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/187780-t-compiler/wg-llvm/topic/LLVM%2010%20upgrade/near/197182013" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> mark-i-m <a href="https://rust-lang.github.io/zulip_archive/stream/187780-t-compiler/wg-llvm/topic/LLVM.2010.20upgrade.html#197182013">(May 11 2020 at 17:57)</a>:</h4>
<p><span class="user-mention" data-user-id="133224">@Nikita Popov</span> Your blog post is excellent! And thanks for all your hard work. This is excellent :)</p>



<a name="197683604"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/187780-t-compiler/wg-llvm/topic/LLVM%2010%20upgrade/near/197683604" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> vertexclique <a href="https://rust-lang.github.io/zulip_archive/stream/187780-t-compiler/wg-llvm/topic/LLVM.2010.20upgrade.html#197683604">(May 15 2020 at 12:35)</a>:</h4>
<p><span class="user-mention" data-user-id="133224">@Nikita Popov</span> Hi Nikita, would like to ask that how can i help to incorporate Aarch64 TME extensions. Or is there a plan? I've checked out locally but I don't see any incorporations at the <a href="https://github.com/rust-lang/llvm-project/tree/rustc/10.0-2020-05-05">https://github.com/rust-lang/llvm-project/tree/rustc/10.0-2020-05-05</a></p>



<a name="197685979"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/187780-t-compiler/wg-llvm/topic/LLVM%2010%20upgrade/near/197685979" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Nikita Popov <a href="https://rust-lang.github.io/zulip_archive/stream/187780-t-compiler/wg-llvm/topic/LLVM.2010.20upgrade.html#197685979">(May 15 2020 at 12:56)</a>:</h4>
<p>From what I see, TME support was added in <a href="https://github.com/llvm/llvm-project/commit/a36d31478c182903523e04eb271bbf102bfab2cc">https://github.com/llvm/llvm-project/commit/a36d31478c182903523e04eb271bbf102bfab2cc</a>, which is part of LLVM 10.</p>



<a name="197705198"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/187780-t-compiler/wg-llvm/topic/LLVM%2010%20upgrade/near/197705198" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> vertexclique <a href="https://rust-lang.github.io/zulip_archive/stream/187780-t-compiler/wg-llvm/topic/LLVM.2010.20upgrade.html#197705198">(May 15 2020 at 15:06)</a>:</h4>
<p>Yes, after the upgrade I will open a pr against stdarch I presume.</p>



<a name="198092223"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/187780-t-compiler/wg-llvm/topic/LLVM%2010%20upgrade/near/198092223" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Alex Crichton <a href="https://rust-lang.github.io/zulip_archive/stream/187780-t-compiler/wg-llvm/topic/LLVM.2010.20upgrade.html#198092223">(May 19 2020 at 16:32)</a>:</h4>
<p><span class="user-mention" data-user-id="133224">@Nikita Popov</span> FWIW I updated the container to 20.04 locally and it did indeed still fail, the error was a giant wall of text though but it did seem somewhat related to the lack of <code>-std=...</code> flags</p>



<a name="198118264"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/187780-t-compiler/wg-llvm/topic/LLVM%2010%20upgrade/near/198118264" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Nikita Popov <a href="https://rust-lang.github.io/zulip_archive/stream/187780-t-compiler/wg-llvm/topic/LLVM.2010.20upgrade.html#198118264">(May 19 2020 at 19:56)</a>:</h4>
<p><span class="user-mention" data-user-id="116015">@Alex Crichton</span> Thanks for testing that. I've now worked around the issue by passing CMAKE_CXX_STANDARD from our side, though LLD should really be setting this itself. Fingers crossed that this is not going to be a long whack-a-mole again...</p>



<a name="198121770"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/187780-t-compiler/wg-llvm/topic/LLVM%2010%20upgrade/near/198121770" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Alex Crichton <a href="https://rust-lang.github.io/zulip_archive/stream/187780-t-compiler/wg-llvm/topic/LLVM.2010.20upgrade.html#198121770">(May 19 2020 at 20:25)</a>:</h4>
<p><span class="user-mention" data-user-id="133224">@Nikita Popov</span> btw once this lands, mind gc'ing the old 10.0 branches which ended up getting unused?</p>



<a name="198221231"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/187780-t-compiler/wg-llvm/topic/LLVM%2010%20upgrade/near/198221231" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Alex Crichton <a href="https://rust-lang.github.io/zulip_archive/stream/187780-t-compiler/wg-llvm/topic/LLVM.2010.20upgrade.html#198221231">(May 20 2020 at 16:11)</a>:</h4>
<p><span class="user-mention" data-user-id="133224">@Nikita Popov</span> hey wanna try to help debug this issue here?</p>



<a name="198221240"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/187780-t-compiler/wg-llvm/topic/LLVM%2010%20upgrade/near/198221240" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Alex Crichton <a href="https://rust-lang.github.io/zulip_archive/stream/187780-t-compiler/wg-llvm/topic/LLVM.2010.20upgrade.html#198221240">(May 20 2020 at 16:11)</a>:</h4>
<p>may be faster than going through comments on a PR</p>



<a name="198221427"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/187780-t-compiler/wg-llvm/topic/LLVM%2010%20upgrade/near/198221427" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Alex Crichton <a href="https://rust-lang.github.io/zulip_archive/stream/187780-t-compiler/wg-llvm/topic/LLVM.2010.20upgrade.html#198221427">(May 20 2020 at 16:13)</a>:</h4>
<p>the <a href="https://gist.github.com/alexcrichton/8211dbc21165df3f24ac99d35858085d">raw log</a> of a build after updating to 20.04 indicates that this is the host build of LLVM, so not related to cross-compiles yet</p>



<a name="198221469"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/187780-t-compiler/wg-llvm/topic/LLVM%2010%20upgrade/near/198221469" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Alex Crichton <a href="https://rust-lang.github.io/zulip_archive/stream/187780-t-compiler/wg-llvm/topic/LLVM.2010.20upgrade.html#198221469">(May 20 2020 at 16:13)</a>:</h4>
<p>I'm manually going into the container and reexecuting the <code>c++</code> commands rather than updating the source</p>



<a name="198221529"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/187780-t-compiler/wg-llvm/topic/LLVM%2010%20upgrade/near/198221529" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Alex Crichton <a href="https://rust-lang.github.io/zulip_archive/stream/187780-t-compiler/wg-llvm/topic/LLVM.2010.20upgrade.html#198221529">(May 20 2020 at 16:14)</a>:</h4>
<p>I threw on <code>-H</code> which apparently prints out header paths</p>



<a name="198221541"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/187780-t-compiler/wg-llvm/topic/LLVM%2010%20upgrade/near/198221541" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Alex Crichton <a href="https://rust-lang.github.io/zulip_archive/stream/187780-t-compiler/wg-llvm/topic/LLVM.2010.20upgrade.html#198221541">(May 20 2020 at 16:14)</a>:</h4>
<p>and nothing comes from the host LLVM (if any), so all #include is coming from the build directory for LLVM</p>



<a name="198221576"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/187780-t-compiler/wg-llvm/topic/LLVM%2010%20upgrade/near/198221576" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Alex Crichton <a href="https://rust-lang.github.io/zulip_archive/stream/187780-t-compiler/wg-llvm/topic/LLVM.2010.20upgrade.html#198221576">(May 20 2020 at 16:14)</a>:</h4>
<p>I see <code>/checkout/obj/build/x86_64-unknown-linux-gnu/llvm/build/include/llvm/IR/IntrinsicEnums.inc</code> included as well yeah</p>



<a name="198221645"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/187780-t-compiler/wg-llvm/topic/LLVM%2010%20upgrade/near/198221645" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Alex Crichton <a href="https://rust-lang.github.io/zulip_archive/stream/187780-t-compiler/wg-llvm/topic/LLVM.2010.20upgrade.html#198221645">(May 20 2020 at 16:15)</a>:</h4>
<p>oh dear, I think I mixed up my build directories</p>



<a name="198221818"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/187780-t-compiler/wg-llvm/topic/LLVM%2010%20upgrade/near/198221818" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Alex Crichton <a href="https://rust-lang.github.io/zulip_archive/stream/187780-t-compiler/wg-llvm/topic/LLVM.2010.20upgrade.html#198221818">(May 20 2020 at 16:16)</a>:</h4>
<p>ok I'm blowing things away and restarting</p>



<a name="198221972"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/187780-t-compiler/wg-llvm/topic/LLVM%2010%20upgrade/near/198221972" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Nikita Popov <a href="https://rust-lang.github.io/zulip_archive/stream/187780-t-compiler/wg-llvm/topic/LLVM.2010.20upgrade.html#198221972">(May 20 2020 at 16:18)</a>:</h4>
<p>By the way, how did you manage to run the image in the first place? For me it gets stuck at "Configuring tzdata", because it expects user input.</p>



<a name="198222022"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/187780-t-compiler/wg-llvm/topic/LLVM%2010%20upgrade/near/198222022" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Alex Crichton <a href="https://rust-lang.github.io/zulip_archive/stream/187780-t-compiler/wg-llvm/topic/LLVM.2010.20upgrade.html#198222022">(May 20 2020 at 16:18)</a>:</h4>
<p><code>ENV DEBIAN_FRONTEND noninteractive</code></p>



<a name="198222037"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/187780-t-compiler/wg-llvm/topic/LLVM%2010%20upgrade/near/198222037" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Alex Crichton <a href="https://rust-lang.github.io/zulip_archive/stream/187780-t-compiler/wg-llvm/topic/LLVM.2010.20upgrade.html#198222037">(May 20 2020 at 16:18)</a>:</h4>
<p>right above the apt-get line</p>



<a name="198222136"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/187780-t-compiler/wg-llvm/topic/LLVM%2010%20upgrade/near/198222136" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Alex Crichton <a href="https://rust-lang.github.io/zulip_archive/stream/187780-t-compiler/wg-llvm/topic/LLVM.2010.20upgrade.html#198222136">(May 20 2020 at 16:19)</a>:</h4>
<p>it's a bad hack :(</p>



<a name="198222309"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/187780-t-compiler/wg-llvm/topic/LLVM%2010%20upgrade/near/198222309" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Nikita Popov <a href="https://rust-lang.github.io/zulip_archive/stream/187780-t-compiler/wg-llvm/topic/LLVM.2010.20upgrade.html#198222309">(May 20 2020 at 16:20)</a>:</h4>
<p>Thanks, that did it</p>



<a name="198222349"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/187780-t-compiler/wg-llvm/topic/LLVM%2010%20upgrade/near/198222349" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Alex Crichton <a href="https://rust-lang.github.io/zulip_archive/stream/187780-t-compiler/wg-llvm/topic/LLVM.2010.20upgrade.html#198222349">(May 20 2020 at 16:21)</a>:</h4>
<p>FWIW the <code>-std=c++11</code> flag was coming from <code>llvm-config</code></p>



<a name="198222389"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/187780-t-compiler/wg-llvm/topic/LLVM%2010%20upgrade/near/198222389" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Alex Crichton <a href="https://rust-lang.github.io/zulip_archive/stream/187780-t-compiler/wg-llvm/topic/LLVM.2010.20upgrade.html#198222389">(May 20 2020 at 16:21)</a>:</h4>
<p>but I'm pretty sure I built an older LLVM then updated the submodule and didn't rebuild</p>



<a name="198222406"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/187780-t-compiler/wg-llvm/topic/LLVM%2010%20upgrade/near/198222406" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Alex Crichton <a href="https://rust-lang.github.io/zulip_archive/stream/187780-t-compiler/wg-llvm/topic/LLVM.2010.20upgrade.html#198222406">(May 20 2020 at 16:21)</a>:</h4>
<p>basically I got the submodules mixed up</p>



<a name="198222591"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/187780-t-compiler/wg-llvm/topic/LLVM%2010%20upgrade/near/198222591" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Nikita Popov <a href="https://rust-lang.github.io/zulip_archive/stream/187780-t-compiler/wg-llvm/topic/LLVM.2010.20upgrade.html#198222591">(May 20 2020 at 16:22)</a>:</h4>
<p>Ah, so just updating the image might be sufficient after all?</p>



<a name="198222628"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/187780-t-compiler/wg-llvm/topic/LLVM%2010%20upgrade/near/198222628" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Alex Crichton <a href="https://rust-lang.github.io/zulip_archive/stream/187780-t-compiler/wg-llvm/topic/LLVM.2010.20upgrade.html#198222628">(May 20 2020 at 16:23)</a>:</h4>
<p>it may be yeah</p>



<a name="198222643"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/187780-t-compiler/wg-llvm/topic/LLVM%2010%20upgrade/near/198222643" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Alex Crichton <a href="https://rust-lang.github.io/zulip_archive/stream/187780-t-compiler/wg-llvm/topic/LLVM.2010.20upgrade.html#198222643">(May 20 2020 at 16:23)</a>:</h4>
<p>I'm re-running the build to confirm/deny that</p>



<a name="198222683"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/187780-t-compiler/wg-llvm/topic/LLVM%2010%20upgrade/near/198222683" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Alex Crichton <a href="https://rust-lang.github.io/zulip_archive/stream/187780-t-compiler/wg-llvm/topic/LLVM.2010.20upgrade.html#198222683">(May 20 2020 at 16:23)</a>:</h4>
<p>I'm not certain I mixed up the submodules, but my submodule was definitely at not the commit I expected</p>



<a name="198222720"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/187780-t-compiler/wg-llvm/topic/LLVM%2010%20upgrade/near/198222720" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Alex Crichton <a href="https://rust-lang.github.io/zulip_archive/stream/187780-t-compiler/wg-llvm/topic/LLVM.2010.20upgrade.html#198222720">(May 20 2020 at 16:23)</a>:</h4>
<p>I am now certain, however, it is correct</p>



<a name="198224114"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/187780-t-compiler/wg-llvm/topic/LLVM%2010%20upgrade/near/198224114" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Alex Crichton <a href="https://rust-lang.github.io/zulip_archive/stream/187780-t-compiler/wg-llvm/topic/LLVM.2010.20upgrade.html#198224114">(May 20 2020 at 16:34)</a>:</h4>
<p>ok freebsd build of llvm is making progres</p>



<a name="198224251"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/187780-t-compiler/wg-llvm/topic/LLVM%2010%20upgrade/near/198224251" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Alex Crichton <a href="https://rust-lang.github.io/zulip_archive/stream/187780-t-compiler/wg-llvm/topic/LLVM.2010.20upgrade.html#198224251">(May 20 2020 at 16:35)</a>:</h4>
<p><span class="user-mention" data-user-id="133224">@Nikita Popov</span> ok so I was wrong, updating to ubuntu 20.04 does not fix the llvm build</p>



<a name="198224280"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/187780-t-compiler/wg-llvm/topic/LLVM%2010%20upgrade/near/198224280" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Alex Crichton <a href="https://rust-lang.github.io/zulip_archive/stream/187780-t-compiler/wg-llvm/topic/LLVM.2010.20upgrade.html#198224280">(May 20 2020 at 16:35)</a>:</h4>
<p>I must have accidentally switched back</p>



<a name="198224355"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/187780-t-compiler/wg-llvm/topic/LLVM%2010%20upgrade/near/198224355" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Alex Crichton <a href="https://rust-lang.github.io/zulip_archive/stream/187780-t-compiler/wg-llvm/topic/LLVM.2010.20upgrade.html#198224355">(May 20 2020 at 16:36)</a>:</h4>
<p>it's the <a href="https://gist.github.com/alexcrichton/661a5a0f6f64c37344c901c6b9fcbc08#file-out-log-L1239-L1272">same error as before</a></p>



<a name="198224430"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/187780-t-compiler/wg-llvm/topic/LLVM%2010%20upgrade/near/198224430" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Alex Crichton <a href="https://rust-lang.github.io/zulip_archive/stream/187780-t-compiler/wg-llvm/topic/LLVM.2010.20upgrade.html#198224430">(May 20 2020 at 16:36)</a>:</h4>
<p>I think this has to do with the freebsd toolchain itself</p>



<a name="198224434"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/187780-t-compiler/wg-llvm/topic/LLVM%2010%20upgrade/near/198224434" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Alex Crichton <a href="https://rust-lang.github.io/zulip_archive/stream/187780-t-compiler/wg-llvm/topic/LLVM.2010.20upgrade.html#198224434">(May 20 2020 at 16:36)</a>:</h4>
<p>and how we assemble it</p>



<a name="198224448"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/187780-t-compiler/wg-llvm/topic/LLVM%2010%20upgrade/near/198224448" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Alex Crichton <a href="https://rust-lang.github.io/zulip_archive/stream/187780-t-compiler/wg-llvm/topic/LLVM.2010.20upgrade.html#198224448">(May 20 2020 at 16:37)</a>:</h4>
<p>so I think we should just disable it and move on</p>



<a name="198224456"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/187780-t-compiler/wg-llvm/topic/LLVM%2010%20upgrade/near/198224456" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Alex Crichton <a href="https://rust-lang.github.io/zulip_archive/stream/187780-t-compiler/wg-llvm/topic/LLVM.2010.20upgrade.html#198224456">(May 20 2020 at 16:37)</a>:</h4>
<p>cc'ing folks who might know how to rebuild it</p>



<a name="198232971"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/187780-t-compiler/wg-llvm/topic/LLVM%2010%20upgrade/near/198232971" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Nikita Popov <a href="https://rust-lang.github.io/zulip_archive/stream/187780-t-compiler/wg-llvm/topic/LLVM.2010.20upgrade.html#198232971">(May 20 2020 at 17:45)</a>:</h4>
<p><span class="user-mention" data-user-id="116015">@Alex Crichton</span> I managed to get it to build with this patch: <a href="https://gist.github.com/nikic/1200fed33696d1622a4ec1f523d2e651">https://gist.github.com/nikic/1200fed33696d1622a4ec1f523d2e651</a></p>



<a name="198233266"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/187780-t-compiler/wg-llvm/topic/LLVM%2010%20upgrade/near/198233266" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Nikita Popov <a href="https://rust-lang.github.io/zulip_archive/stream/187780-t-compiler/wg-llvm/topic/LLVM.2010.20upgrade.html#198233266">(May 20 2020 at 17:47)</a>:</h4>
<p>This uses LLVMs own vector implementation instead of the libc++ one, which is probably too old for that target.</p>



<a name="198234199"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/187780-t-compiler/wg-llvm/topic/LLVM%2010%20upgrade/near/198234199" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Nikita Popov <a href="https://rust-lang.github.io/zulip_archive/stream/187780-t-compiler/wg-llvm/topic/LLVM.2010.20upgrade.html#198234199">(May 20 2020 at 17:54)</a>:</h4>
<p>I can apply this to our LLVM fork for now and open an issue for updating the freebsd toolchain. Though also happy to just disable the freebsd builds, if that's preferred.</p>



<a name="198235694"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/187780-t-compiler/wg-llvm/topic/LLVM%2010%20upgrade/near/198235694" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Alex Crichton <a href="https://rust-lang.github.io/zulip_archive/stream/187780-t-compiler/wg-llvm/topic/LLVM.2010.20upgrade.html#198235694">(May 20 2020 at 18:06)</a>:</h4>
<p><span class="user-mention" data-user-id="133224">@Nikita Popov</span> nice! That seems like a fine patch to drop in</p>



<a name="198235702"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/187780-t-compiler/wg-llvm/topic/LLVM%2010%20upgrade/near/198235702" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Alex Crichton <a href="https://rust-lang.github.io/zulip_archive/stream/187780-t-compiler/wg-llvm/topic/LLVM.2010.20upgrade.html#198235702">(May 20 2020 at 18:06)</a>:</h4>
<p>it's not even something we use</p>



<a name="198235718"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/187780-t-compiler/wg-llvm/topic/LLVM%2010%20upgrade/near/198235718" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Alex Crichton <a href="https://rust-lang.github.io/zulip_archive/stream/187780-t-compiler/wg-llvm/topic/LLVM.2010.20upgrade.html#198235718">(May 20 2020 at 18:06)</a>:</h4>
<p>or, well maybe we do ship that nowadays</p>



<a name="198235770"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/187780-t-compiler/wg-llvm/topic/LLVM%2010%20upgrade/near/198235770" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Alex Crichton <a href="https://rust-lang.github.io/zulip_archive/stream/187780-t-compiler/wg-llvm/topic/LLVM.2010.20upgrade.html#198235770">(May 20 2020 at 18:06)</a>:</h4>
<p>if that fixes the build, it's probably best to land that patch but also open an issue and cc freebsd folks</p>



<a name="198235785"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/187780-t-compiler/wg-llvm/topic/LLVM%2010%20upgrade/near/198235785" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Alex Crichton <a href="https://rust-lang.github.io/zulip_archive/stream/187780-t-compiler/wg-llvm/topic/LLVM.2010.20upgrade.html#198235785">(May 20 2020 at 18:07)</a>:</h4>
<p>it seems harmless enough to carry for now but if we can fix the underlying problem that'd be best since this will likely crop up again</p>



<a name="198238757"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/187780-t-compiler/wg-llvm/topic/LLVM%2010%20upgrade/near/198238757" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Nikita Popov <a href="https://rust-lang.github.io/zulip_archive/stream/187780-t-compiler/wg-llvm/topic/LLVM.2010.20upgrade.html#198238757">(May 20 2020 at 18:30)</a>:</h4>
<p>Yeah. Old distros versions used in CI are a recurring problem with LLVM upgrades. I've opened <a href="https://github.com/rust-lang/rust/issues/72390">https://github.com/rust-lang/rust/issues/72390</a> but not sure who to ping for FreeBSD. Do you happen to know anyone offhand?</p>



<a name="198244723"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/187780-t-compiler/wg-llvm/topic/LLVM%2010%20upgrade/near/198244723" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Alex Crichton <a href="https://rust-lang.github.io/zulip_archive/stream/187780-t-compiler/wg-llvm/topic/LLVM.2010.20upgrade.html#198244723">(May 20 2020 at 19:18)</a>:</h4>
<p>Ah sorry I don't know anyone offhand, I'd just git blame the toolchain script and cc the folks there</p>



<a name="198244754"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/187780-t-compiler/wg-llvm/topic/LLVM%2010%20upgrade/near/198244754" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Alex Crichton <a href="https://rust-lang.github.io/zulip_archive/stream/187780-t-compiler/wg-llvm/topic/LLVM.2010.20upgrade.html#198244754">(May 20 2020 at 19:18)</a>:</h4>
<p>It should be possible to update the distros at any time, it just requires an explicit opt-in which requires some work</p>



<a name="198291982"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/187780-t-compiler/wg-llvm/topic/LLVM%2010%20upgrade/near/198291982" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sebastien Marie (semarie) <a href="https://rust-lang.github.io/zulip_archive/stream/187780-t-compiler/wg-llvm/topic/LLVM.2010.20upgrade.html#198291982">(May 21 2020 at 07:01)</a>:</h4>
<p>on FreeBSD side, I think that Alan Somers (@asomers on github) is still active on rust work. Else, he should be able to ping the right person.</p>



<a name="198527191"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/187780-t-compiler/wg-llvm/topic/LLVM%2010%20upgrade/near/198527191" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Nikita Popov <a href="https://rust-lang.github.io/zulip_archive/stream/187780-t-compiler/wg-llvm/topic/LLVM.2010.20upgrade.html#198527191">(May 23 2020 at 09:31)</a>:</h4>
<p><span class="user-mention silent" data-user-id="116015">Alex Crichton</span> <a href="#narrow/stream/187780-t-compiler.2Fwg-llvm/topic/LLVM.2010.20upgrade/near/198121770">said</a>:</p>
<blockquote>
<p><span class="user-mention silent" data-user-id="133224">Nikita Popov</span> btw once this lands, mind gc'ing the old 10.0 branches which ended up getting unused?</p>
</blockquote>
<p>There's one unused branch at <a href="https://github.com/rust-lang/llvm-project/tree/rustc/10.0-2020-02-05">https://github.com/rust-lang/llvm-project/tree/rustc/10.0-2020-02-05</a> (all the other ones were on my fork). I tried deleting it, but the repo uses branch protection, so it was rejected.</p>



<a name="198767996"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/187780-t-compiler/wg-llvm/topic/LLVM%2010%20upgrade/near/198767996" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Alex Crichton <a href="https://rust-lang.github.io/zulip_archive/stream/187780-t-compiler/wg-llvm/topic/LLVM.2010.20upgrade.html#198767996">(May 26 2020 at 14:16)</a>:</h4>
<p><span class="user-mention" data-user-id="133224">@Nikita Popov</span> oh oops good point, should be deleted now!</p>



<hr><p>Last updated: Aug 07 2021 at 22:04 UTC</p>
</html>