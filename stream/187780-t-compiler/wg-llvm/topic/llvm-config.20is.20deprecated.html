<html>
<head><meta charset="utf-8"><title>llvm-config is deprecated · t-compiler/wg-llvm · Zulip Chat Archive</title></head>
<h2>Stream: <a href="https://zulip-archive.rust-lang.org/stream/187780-t-compiler/wg-llvm/index.html">t-compiler/wg-llvm</a></h2>
<h3>Topic: <a href="https://zulip-archive.rust-lang.org/stream/187780-t-compiler/wg-llvm/topic/llvm-config.20is.20deprecated.html">llvm-config is deprecated</a></h3>

<hr>

<base href="https://rust-lang.zulipchat.com">

<head><link href="https://zulip-archive.rust-lang.org/style.css" rel="stylesheet"></head>

<a name="271340195"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/187780-t-compiler/wg-llvm/topic/llvm-config%20is%20deprecated/near/271340195" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nagisa <a href="https://zulip-archive.rust-lang.org/stream/187780-t-compiler/wg-llvm/topic/llvm-config.20is.20deprecated.html#271340195">(Feb 09 2022 at 20:09)</a>:</h4>
<p>From LLVM14-enabled rustc build logs:</p>
<div class="codehilite"><pre><span></span><code>CMake Deprecation Warning at CMakeLists.txt:25 (message):
  Using llvm-config to detect the LLVM installation is deprecated.  The
  installed cmake files should be used instead.  CMake should be able to
  detect your LLVM install automatically, but you can also use LLVM_DIR to
</code></pre></div>
<p>We should look into this and see if cmake files are appropriate for us, and if not, report to upstream that cmake is not a full replacement for our needs.</p>



<a name="271399713"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/187780-t-compiler/wg-llvm/topic/llvm-config%20is%20deprecated/near/271399713" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Nikita Popov <a href="https://zulip-archive.rust-lang.org/stream/187780-t-compiler/wg-llvm/topic/llvm-config.20is.20deprecated.html#271399713">(Feb 10 2022 at 08:26)</a>:</h4>
<p>I expect that switching to LLVM_DIR will be fine and may do away with some of the hacks we currently do. Though possibly we should start building lld as an llvm subproject rather than a standalone build.</p>



<a name="271399747"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/187780-t-compiler/wg-llvm/topic/llvm-config%20is%20deprecated/near/271399747" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Nikita Popov <a href="https://zulip-archive.rust-lang.org/stream/187780-t-compiler/wg-llvm/topic/llvm-config.20is.20deprecated.html#271399747">(Feb 10 2022 at 08:27)</a>:</h4>
<p>At least we seem to be building other things like clang and polly that way, and it's not immediately clear why we don't do the same for lld.</p>



<a name="271399785"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/187780-t-compiler/wg-llvm/topic/llvm-config%20is%20deprecated/near/271399785" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Nikita Popov <a href="https://zulip-archive.rust-lang.org/stream/187780-t-compiler/wg-llvm/topic/llvm-config.20is.20deprecated.html#271399785">(Feb 10 2022 at 08:28)</a>:</h4>
<p>There's some discussion of removing standalone builds entirely here, though I do hope that doesn't happen: <a href="https://discourse.llvm.org/t/standalone-build-for-clang-lld-fix-or-remove/59977">https://discourse.llvm.org/t/standalone-build-for-clang-lld-fix-or-remove/59977</a></p>



<a name="271416980"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/187780-t-compiler/wg-llvm/topic/llvm-config%20is%20deprecated/near/271416980" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> bjorn3 <a href="https://zulip-archive.rust-lang.org/stream/187780-t-compiler/wg-llvm/topic/llvm-config.20is.20deprecated.html#271416980">(Feb 10 2022 at 11:15)</a>:</h4>
<p>fedora and gentoo seem to agree that standalone builds should be kept.</p>



<a name="271468274"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/187780-t-compiler/wg-llvm/topic/llvm-config%20is%20deprecated/near/271468274" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Josh Triplett <a href="https://zulip-archive.rust-lang.org/stream/187780-t-compiler/wg-llvm/topic/llvm-config.20is.20deprecated.html#271468274">(Feb 10 2022 at 17:52)</a>:</h4>
<p>Can't hurt for someone wearing a compiler team hat to post that we need them too. Just in case distros find a different solution and that's seen as the only opposition.</p>



<hr><p>Last updated: Apr 12 2022 at 20:01 UTC</p>
</html>