<html>
<head><meta charset="utf-8"><title>Chalk Status · wg-traits · Zulip Chat Archive</title></head>
<h2>Stream: <a href="https://zulip-archive.rust-lang.org/stream/144729-wg-traits/index.html">wg-traits</a></h2>
<h3>Topic: <a href="https://zulip-archive.rust-lang.org/stream/144729-wg-traits/topic/Chalk.20Status.html">Chalk Status</a></h3>

<hr>

<base href="https://rust-lang.zulipchat.com">

<head><link href="https://zulip-archive.rust-lang.org/style.css" rel="stylesheet"></head>

<a name="259868911"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/144729-wg-traits/topic/Chalk%20Status/near/259868911" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jake <a href="https://zulip-archive.rust-lang.org/stream/144729-wg-traits/topic/Chalk.20Status.html#259868911">(Nov 01 2021 at 14:18)</a>:</h4>
<p>I've been looking through documentation and familiarizing myself with the current situation regarding chalk, but I have a couple more meta questions I figured I'd ask here. Is the plan still to (eventually) integrate chalk into rustc? What is the status of that, given that a number of the justifications for chalk (GATs and such) seem to be making it into rustc on their own? I found <a href="https://github.com/rust-lang/rust/issues/48049">#48049</a> but that seems inactive. I ask because I am interested in contributing to chalk, but of course want to make sure that my contributions would represent a productive step forward for Rust as a whole</p>



<a name="259870608"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/144729-wg-traits/topic/Chalk%20Status/near/259870608" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jack Huey <a href="https://zulip-archive.rust-lang.org/stream/144729-wg-traits/topic/Chalk.20Status.html#259870608">(Nov 01 2021 at 14:31)</a>:</h4>
<p>Hi <span class="user-mention" data-user-id="310518">@Jake</span>, I'll write a more informative comment late as far as status and such, but yes Chalk is still active, though there hasn't been a lot of work done lately. There are definitely some useful things to do, I'll list them later</p>



<a name="259870782"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/144729-wg-traits/topic/Chalk%20Status/near/259870782" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Laurențiu <a href="https://zulip-archive.rust-lang.org/stream/144729-wg-traits/topic/Chalk.20Status.html#259870782">(Nov 01 2021 at 14:32)</a>:</h4>
<p>It's also used in rust-analyzer so improvements to chalk can be important for everyone using it.</p>



<a name="259871130"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/144729-wg-traits/topic/Chalk%20Status/near/259871130" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Florian Diebold <a href="https://zulip-archive.rust-lang.org/stream/144729-wg-traits/topic/Chalk.20Status.html#259871130">(Nov 01 2021 at 14:35)</a>:</h4>
<p>for rust-analyzer, <a href="https://github.com/rust-lang/chalk/issues/727">rust-lang/chalk#727</a> is probably the biggest issue right now</p>



<a name="259871132"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/144729-wg-traits/topic/Chalk%20Status/near/259871132" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jack Huey <a href="https://zulip-archive.rust-lang.org/stream/144729-wg-traits/topic/Chalk.20Status.html#259871132">(Nov 01 2021 at 14:35)</a>:</h4>
<p>The issue I would like to see worked on that is the most "isolated" is <a href="https://github.com/rust-lang/chalk/issues/688">chalk#688</a></p>



<a name="259871158"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/144729-wg-traits/topic/Chalk%20Status/near/259871158" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Florian Diebold <a href="https://zulip-archive.rust-lang.org/stream/144729-wg-traits/topic/Chalk.20Status.html#259871158">(Nov 01 2021 at 14:35)</a>:</h4>
<p>oh, and that one, yeah</p>



<a name="259871368"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/144729-wg-traits/topic/Chalk%20Status/near/259871368" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jack Huey <a href="https://zulip-archive.rust-lang.org/stream/144729-wg-traits/topic/Chalk.20Status.html#259871368">(Nov 01 2021 at 14:37)</a>:</h4>
<p>I haven't looked at <a href="https://github.com/rust-lang/chalk/issues/727">chalk#727</a> really</p>



<a name="259872296"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/144729-wg-traits/topic/Chalk%20Status/near/259872296" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Florian Diebold <a href="https://zulip-archive.rust-lang.org/stream/144729-wg-traits/topic/Chalk.20Status.html#259872296">(Nov 01 2021 at 14:44)</a>:</h4>
<p>727 probably has some simpler reproductions, see this comment: <a href="https://github.com/rust-analyzer/rust-analyzer/issues/6418#issuecomment-781056988">https://github.com/rust-analyzer/rust-analyzer/issues/6418#issuecomment-781056988</a></p>



<a name="259874390"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/144729-wg-traits/topic/Chalk%20Status/near/259874390" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jack Huey <a href="https://zulip-archive.rust-lang.org/stream/144729-wg-traits/topic/Chalk.20Status.html#259874390">(Nov 01 2021 at 15:00)</a>:</h4>
<p>Yeah, the first step to <a href="https://github.com/rust-lang/chalk/issues/688">chalk#688</a> is to refactor the chalk-integration code to be able to reproduce the problem</p>



<a name="260086999"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/144729-wg-traits/topic/Chalk%20Status/near/260086999" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jake <a href="https://zulip-archive.rust-lang.org/stream/144729-wg-traits/topic/Chalk.20Status.html#260086999">(Nov 03 2021 at 03:44)</a>:</h4>
<p>I plan to start looking at <a href="https://github.com/rust-lang/chalk/issues/688">chalk#688</a> ; right now I'm just trying to familiarize myself with the codebase, and I have a question: I see the term "free" variable floating around for two different uses: First, for an unbound inference variable, and second, for a bound type with a depth greater than the number of in-scope binders. The first usage makes sense to me, but I am having a little trouble with the second; how do we get into a situation where we find such a type, and how should it be interpreted? (I understand that this question is a bit open ended, so would be more than happy with just a pointer in the right direction or a link to an example or something)</p>



<a name="260264352"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/144729-wg-traits/topic/Chalk%20Status/near/260264352" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jack Huey <a href="https://zulip-archive.rust-lang.org/stream/144729-wg-traits/topic/Chalk.20Status.html#260264352">(Nov 04 2021 at 12:49)</a>:</h4>
<p>I'll try to reply to this today</p>



<a name="260307484"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/144729-wg-traits/topic/Chalk%20Status/near/260307484" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jake <a href="https://zulip-archive.rust-lang.org/stream/144729-wg-traits/topic/Chalk.20Status.html#260307484">(Nov 04 2021 at 17:38)</a>:</h4>
<p>That would be great, but also please don't worry about this too much. I'm aware that beginner questions are awkward to answer sometimes, and I'll probably be able to make progress on the issue regardless</p>



<a name="260308186"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/144729-wg-traits/topic/Chalk%20Status/near/260308186" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jack Huey <a href="https://zulip-archive.rust-lang.org/stream/144729-wg-traits/topic/Chalk.20Status.html#260308186">(Nov 04 2021 at 17:44)</a>:</h4>
<p>So, I've seen "free" used in two places: 1) In rustc when type checking function bodies, the lifetime parameters are "free" 2) In more "logical" contexts, where a bound type has a greater debruijn index than in-scope binders</p>



<a name="260308225"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/144729-wg-traits/topic/Chalk%20Status/near/260308225" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jack Huey <a href="https://zulip-archive.rust-lang.org/stream/144729-wg-traits/topic/Chalk.20Status.html#260308225">(Nov 04 2021 at 17:44)</a>:</h4>
<p>For unbound inference vars, I'm not sure I've heard it used as "free", just unbound, I guess</p>



<a name="260308373"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/144729-wg-traits/topic/Chalk%20Status/near/260308373" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jack Huey <a href="https://zulip-archive.rust-lang.org/stream/144729-wg-traits/topic/Chalk.20Status.html#260308373">(Nov 04 2021 at 17:45)</a>:</h4>
<p>For the latter, we generally <em>don't</em> want that to happen. But it can happen if we i.e. fold through binders, but then pass around a type with bound vars</p>



<a name="260308460"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/144729-wg-traits/topic/Chalk%20Status/near/260308460" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jack Huey <a href="https://zulip-archive.rust-lang.org/stream/144729-wg-traits/topic/Chalk.20Status.html#260308460">(Nov 04 2021 at 17:46)</a>:</h4>
<p>Some of my work from the end of last year is to help us <em>not</em> get into these situations (by tracking what bound vars we actually have)</p>



<a name="260315248"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/144729-wg-traits/topic/Chalk%20Status/near/260315248" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jake <a href="https://zulip-archive.rust-lang.org/stream/144729-wg-traits/topic/Chalk.20Status.html#260315248">(Nov 04 2021 at 18:36)</a>:</h4>
<p>Ok, I see, that makes sense to me. So in the example in <a href="https://github.com/rust-lang/chalk/issues/688">chalk#688</a> :</p>
<div class="codehilite" data-code-language="Rust"><pre><span></span><code><span class="n">Implemented</span><span class="p">({</span><span class="n">closure</span>:<span class="nc">ClosureId</span><span class="p">(</span><span class="mi">3</span><span class="p">)}</span><span class="o">&lt;</span><span class="p">[</span><span class="o">?</span><span class="mi">0</span><span class="w"> </span>:<span class="o">=</span><span class="w"> </span><span class="p">()</span><span class="w"> </span><span class="k">for</span><span class="o">&lt;</span><span class="mi">0</span><span class="o">&gt;</span><span class="w"> </span><span class="p">[</span><span class="w"></span>
<span class="w">    </span><span class="o">?</span><span class="mi">0</span><span class="w"> </span>:<span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="o">&amp;'</span><span class="nb">static</span><span class="w"> </span><span class="mi">2</span><span class="o">&lt;</span><span class="p">[</span><span class="o">?</span><span class="mi">0</span><span class="w"> </span>:<span class="o">=</span><span class="w"> </span><span class="o">^</span><span class="mf">1.0</span><span class="p">,</span><span class="w"> </span><span class="o">?</span><span class="mi">1</span><span class="w"> </span>:<span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="o">&amp;'</span><span class="nb">static</span><span class="w"> </span><span class="o">^</span><span class="mf">1.1</span><span class="p">)]</span><span class="o">&gt;</span><span class="p">),</span><span class="w"></span>
<span class="w">    </span><span class="o">?</span><span class="mi">1</span><span class="w"> </span>:<span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="o">&amp;'</span><span class="nb">static</span><span class="w"> </span><span class="mi">2</span><span class="o">&lt;</span><span class="p">[</span><span class="o">?</span><span class="mi">0</span><span class="w"> </span>:<span class="o">=</span><span class="w"> </span><span class="o">^</span><span class="mf">1.2</span><span class="p">,</span><span class="w"> </span><span class="o">?</span><span class="mi">1</span><span class="w"> </span>:<span class="o">=</span><span class="w"> </span><span class="o">^</span><span class="mf">1.1</span><span class="p">]</span><span class="o">&gt;</span><span class="p">),</span><span class="w"></span>
<span class="w">    </span><span class="o">?</span><span class="mi">2</span><span class="w"> </span>:<span class="o">=</span><span class="w"> </span><span class="n">Ordering</span><span class="o">&lt;</span><span class="p">[]</span><span class="o">&gt;</span><span class="p">]</span><span class="w"></span>
<span class="p">]</span><span class="o">&gt;</span><span class="w"> </span>: <span class="nb">FnMut</span><span class="o">&lt;</span><span class="mi">2</span><span class="o">&lt;</span><span class="p">[</span><span class="w"></span>
<span class="w">    </span><span class="o">?</span><span class="mi">0</span><span class="w"> </span>:<span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="o">&amp;'</span><span class="nb">static</span><span class="w"> </span><span class="mi">2</span><span class="o">&lt;</span><span class="p">[</span><span class="o">?</span><span class="mi">0</span><span class="w"> </span>:<span class="o">=</span><span class="w"> </span><span class="o">^</span><span class="mf">0.3</span><span class="p">,</span><span class="w"> </span><span class="o">?</span><span class="mi">1</span><span class="w"> </span>:<span class="o">=</span><span class="w"> </span><span class="o">^</span><span class="mf">0.4</span><span class="p">]</span><span class="o">&gt;</span><span class="p">),</span><span class="w"></span>
<span class="w">    </span><span class="o">?</span><span class="mi">1</span><span class="w"> </span>:<span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="o">&amp;'</span><span class="nb">static</span><span class="w"> </span><span class="mi">2</span><span class="o">&lt;</span><span class="p">[</span><span class="o">?</span><span class="mi">0</span><span class="w"> </span>:<span class="o">=</span><span class="w"> </span><span class="o">^</span><span class="mf">0.3</span><span class="p">,</span><span class="w"> </span><span class="o">?</span><span class="mi">1</span><span class="w"> </span>:<span class="o">=</span><span class="w"> </span><span class="o">^</span><span class="mf">0.4</span><span class="p">]</span><span class="o">&gt;</span><span class="p">)</span><span class="w"></span>
<span class="p">]</span><span class="o">&gt;&gt;</span><span class="p">)</span><span class="w"></span>
</code></pre></div>
<p>there seem to be a number of free (in the second sense) bound types. I assume this means that the goal, as written, can't actually appear as a goal in the solver. Should I instead interpret it as having a <code>ForAll&lt;whatever necessary&gt;</code> binder around the outside? I fear I may be misunderstanding some of the convention/notation here.</p>



<a name="260315777"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/144729-wg-traits/topic/Chalk%20Status/near/260315777" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jack Huey <a href="https://zulip-archive.rust-lang.org/stream/144729-wg-traits/topic/Chalk.20Status.html#260315777">(Nov 04 2021 at 18:40)</a>:</h4>
<p>Yeah, this is true. That's essentially coming from rust-analyzer. I can't quite remember what the exact goal that rust-analyzer gives us.</p>



<a name="260315858"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/144729-wg-traits/topic/Chalk%20Status/near/260315858" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jack Huey <a href="https://zulip-archive.rust-lang.org/stream/144729-wg-traits/topic/Chalk.20Status.html#260315858">(Nov 04 2021 at 18:41)</a>:</h4>
<p>But essentially the issue comes during the "we don't know what fn sig our closure has" phase</p>



<a name="260315995"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/144729-wg-traits/topic/Chalk%20Status/near/260315995" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jack Huey <a href="https://zulip-archive.rust-lang.org/stream/144729-wg-traits/topic/Chalk.20Status.html#260315995">(Nov 04 2021 at 18:42)</a>:</h4>
<p>This thread has some context: <a href="#narrow/stream/144729-wg-traits/topic/closure.20goal.20keeps.20expanding.20lifetimes.20chalk.23688">https://rust-lang.zulipchat.com/#narrow/stream/144729-wg-traits/topic/closure.20goal.20keeps.20expanding.20lifetimes.20chalk.23688</a></p>



<a name="260316108"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/144729-wg-traits/topic/Chalk%20Status/near/260316108" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jack Huey <a href="https://zulip-archive.rust-lang.org/stream/144729-wg-traits/topic/Chalk.20Status.html#260316108">(Nov 04 2021 at 18:43)</a>:</h4>
<p>Also see <a href="https://github.com/jackh726/chalk/tree/688">https://github.com/jackh726/chalk/tree/688</a></p>



<a name="260321264"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/144729-wg-traits/topic/Chalk%20Status/near/260321264" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Florian Diebold <a href="https://zulip-archive.rust-lang.org/stream/144729-wg-traits/topic/Chalk.20Status.html#260321264">(Nov 04 2021 at 19:22)</a>:</h4>
<p>there shouldn't be any free variables in goals, I think that debug output is just just not including the <code>Canonical</code> wrapping everything. So those free variables would probably be referring to canonicalized inference variables, i.e. they're existentially quantified</p>



<a name="260598935"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/144729-wg-traits/topic/Chalk%20Status/near/260598935" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jake <a href="https://zulip-archive.rust-lang.org/stream/144729-wg-traits/topic/Chalk.20Status.html#260598935">(Nov 07 2021 at 22:23)</a>:</h4>
<p><span class="user-mention" data-user-id="232957">@Jack Huey</span> thanks, those links were super helpful and I understand what's going on much better now. I see what you were trying to do with your update to <code>chalk-integration</code>, and may just continue work on (or at least inspired by) your branch. That being said, my first thought for testing this was to simply allow manual implementations of <code>Fn*</code> traits on types that had an appropriate annotation. Is adding a flag to <code>chalk-solve</code> that allows manual impls of these traits (with some capability to disable this) just too big a can of worms to open?</p>



<a name="260598994"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/144729-wg-traits/topic/Chalk%20Status/near/260598994" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jack Huey <a href="https://zulip-archive.rust-lang.org/stream/144729-wg-traits/topic/Chalk.20Status.html#260598994">(Nov 07 2021 at 22:24)</a>:</h4>
<p>Ah, like a way to override the builtin impls?</p>



<a name="260599024"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/144729-wg-traits/topic/Chalk%20Status/near/260599024" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jake <a href="https://zulip-archive.rust-lang.org/stream/144729-wg-traits/topic/Chalk.20Status.html#260599024">(Nov 07 2021 at 22:25)</a>:</h4>
<p>Thats not how I was thinking about it, but that probably makes even more sense</p>



<a name="260599132"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/144729-wg-traits/topic/Chalk%20Status/near/260599132" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jack Huey <a href="https://zulip-archive.rust-lang.org/stream/144729-wg-traits/topic/Chalk.20Status.html#260599132">(Nov 07 2021 at 22:27)</a>:</h4>
<p>I would maybe do this through the <a href="https://github.com/rust-lang/chalk/blob/9240a006f49542667faa2e972e14e5314a16f3be/chalk-solve/src/lib.rs#L47"><code>custom_clauses</code></a> function, and ensure we don't use builtin clauses if there are other clauses that would conflict</p>



<a name="260600021"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/144729-wg-traits/topic/Chalk%20Status/near/260600021" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jake <a href="https://zulip-archive.rust-lang.org/stream/144729-wg-traits/topic/Chalk.20Status.html#260600021">(Nov 07 2021 at 22:47)</a>:</h4>
<p>I see, that makes sense. Unless you think this is unnecessarily much work, I might try this then</p>



<a name="260600068"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/144729-wg-traits/topic/Chalk%20Status/near/260600068" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jack Huey <a href="https://zulip-archive.rust-lang.org/stream/144729-wg-traits/topic/Chalk.20Status.html#260600068">(Nov 07 2021 at 22:48)</a>:</h4>
<p>I'm not 100% sure the best approach tbh</p>



<a name="260600071"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/144729-wg-traits/topic/Chalk%20Status/near/260600071" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jack Huey <a href="https://zulip-archive.rust-lang.org/stream/144729-wg-traits/topic/Chalk.20Status.html#260600071">(Nov 07 2021 at 22:48)</a>:</h4>
<p>And it's been a while and it's a bit of cache for me</p>



<a name="260600160"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/144729-wg-traits/topic/Chalk%20Status/near/260600160" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jake <a href="https://zulip-archive.rust-lang.org/stream/144729-wg-traits/topic/Chalk.20Status.html#260600160">(Nov 07 2021 at 22:50)</a>:</h4>
<p>I might just go for it, at worst it'll be a good learning experience</p>



<a name="260600361"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/144729-wg-traits/topic/Chalk%20Status/near/260600361" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jack Huey <a href="https://zulip-archive.rust-lang.org/stream/144729-wg-traits/topic/Chalk.20Status.html#260600361">(Nov 07 2021 at 22:55)</a>:</h4>
<p>yeah for sure</p>



<a name="260600368"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/144729-wg-traits/topic/Chalk%20Status/near/260600368" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jack Huey <a href="https://zulip-archive.rust-lang.org/stream/144729-wg-traits/topic/Chalk.20Status.html#260600368">(Nov 07 2021 at 22:55)</a>:</h4>
<p>Let me know if you have questions</p>



<a name="260607954"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/144729-wg-traits/topic/Chalk%20Status/near/260607954" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jake <a href="https://zulip-archive.rust-lang.org/stream/144729-wg-traits/topic/Chalk.20Status.html#260607954">(Nov 08 2021 at 01:55)</a>:</h4>
<p><span class="user-mention" data-user-id="232957">@Jack Huey</span> we'd probably want to gate the ability to do overrides somehow, yes? It seems that otherwise we'd lose any option to test that manual implementations are usually disallowed, which seems unfortunate. What's the right way to do that? A second flag like <code>disable_coherence</code>?</p>



<a name="260608079"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/144729-wg-traits/topic/Chalk%20Status/near/260608079" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jack Huey <a href="https://zulip-archive.rust-lang.org/stream/144729-wg-traits/topic/Chalk.20Status.html#260608079">(Nov 08 2021 at 01:58)</a>:</h4>
<p>Nah, no need to gate I don't think</p>



<a name="260608097"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/144729-wg-traits/topic/Chalk%20Status/near/260608097" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jake <a href="https://zulip-archive.rust-lang.org/stream/144729-wg-traits/topic/Chalk.20Status.html#260608097">(Nov 08 2021 at 01:59)</a>:</h4>
<p>Alright. Can be added in later anyway, if we care to</p>



<a name="260608268"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/144729-wg-traits/topic/Chalk%20Status/near/260608268" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jack Huey <a href="https://zulip-archive.rust-lang.org/stream/144729-wg-traits/topic/Chalk.20Status.html#260608268">(Nov 08 2021 at 02:01)</a>:</h4>
<p>I feel like at some point we'll just transition into just a better test syntax</p>



<a name="260713908"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/144729-wg-traits/topic/Chalk%20Status/near/260713908" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jake <a href="https://zulip-archive.rust-lang.org/stream/144729-wg-traits/topic/Chalk.20Status.html#260713908">(Nov 08 2021 at 20:25)</a>:</h4>
<p>Is it intentional that <a href="https://rust-lang.github.io/chalk/chalk_ir/struct.TraitRef.html#method.with_as"><code>with_as</code></a> returns an opaque type and not an explicit <code>SeparatorTraitRef</code>? The <code>Debug</code> impl for <code>SeparatorTraitRef</code> doesn't seem terribly useful on its own</p>



<a name="262940508"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/144729-wg-traits/topic/Chalk%20Status/near/262940508" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Aaron Hill <a href="https://zulip-archive.rust-lang.org/stream/144729-wg-traits/topic/Chalk.20Status.html#262940508">(Nov 28 2021 at 18:03)</a>:</h4>
<p><span class="user-mention silent" data-user-id="232957">Jack Huey</span> <a href="#narrow/stream/144729-wg-traits/topic/Chalk.20Status/near/259870608">said</a>:</p>
<blockquote>
<p>Hi <span class="user-mention silent" data-user-id="310518">Jake</span>, I'll write a more informative comment late as far as status and such, but yes Chalk is still active, though there hasn't been a lot of work done lately. There are definitely some useful things to do, I'll list them later</p>
</blockquote>
<p>Following up on this - are we still planning to integrate chalk into rustc at some point?</p>



<a name="262940523"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/144729-wg-traits/topic/Chalk%20Status/near/262940523" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jack Huey <a href="https://zulip-archive.rust-lang.org/stream/144729-wg-traits/topic/Chalk.20Status.html#262940523">(Nov 28 2021 at 18:04)</a>:</h4>
<p>Yes!</p>



<a name="262940575"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/144729-wg-traits/topic/Chalk%20Status/near/262940575" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jack Huey <a href="https://zulip-archive.rust-lang.org/stream/144729-wg-traits/topic/Chalk.20Status.html#262940575">(Nov 28 2021 at 18:04)</a>:</h4>
<p>I think the big blocker here is figuring out how to extract out TyKind and such into a shared library</p>



<a name="262940601"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/144729-wg-traits/topic/Chalk%20Status/near/262940601" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jack Huey <a href="https://zulip-archive.rust-lang.org/stream/144729-wg-traits/topic/Chalk.20Status.html#262940601">(Nov 28 2021 at 18:05)</a>:</h4>
<p>I had problems with variance, specifically with <code>'tcx</code> changing from covariant to invariant in a lot of places</p>



<a name="262940652"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/144729-wg-traits/topic/Chalk%20Status/near/262940652" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jack Huey <a href="https://zulip-archive.rust-lang.org/stream/144729-wg-traits/topic/Chalk.20Status.html#262940652">(Nov 28 2021 at 18:06)</a>:</h4>
<p>Because after extracting into an <code>I: Interner</code>, <code>'tcx</code> ends up behind a projection</p>



<hr><p>Last updated: Apr 12 2022 at 20:01 UTC</p>
</html>