<html>
<head><meta charset="utf-8"><title>publish failed · wg-traits · Zulip Chat Archive</title></head>
<h2>Stream: <a href="https://zulip-archive.rust-lang.org/stream/144729-wg-traits/index.html">wg-traits</a></h2>
<h3>Topic: <a href="https://zulip-archive.rust-lang.org/stream/144729-wg-traits/topic/publish.20failed.html">publish failed</a></h3>

<hr>

<base href="https://rust-lang.zulipchat.com">

<head><link href="https://zulip-archive.rust-lang.org/style.css" rel="stylesheet"></head>

<a name="218989204"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/144729-wg-traits/topic/publish%20failed/near/218989204" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Florian Diebold <a href="https://zulip-archive.rust-lang.org/stream/144729-wg-traits/topic/publish.20failed.html#218989204">(Dec 06 2020 at 14:30)</a>:</h4>
<p>looks like the weekly release <a href="https://github.com/rust-lang/chalk/runs/1504988475?check_suite_focus=true">failed</a>. Can we retrigger it somehow?</p>



<a name="218989270"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/144729-wg-traits/topic/publish%20failed/near/218989270" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Léo Lanteri Thauvin <a href="https://zulip-archive.rust-lang.org/stream/144729-wg-traits/topic/publish.20failed.html#218989270">(Dec 06 2020 at 14:32)</a>:</h4>
<p>Seems like <code>chalk-derive</code> was released, but not the other crates</p>



<a name="218989295"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/144729-wg-traits/topic/publish%20failed/near/218989295" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Léo Lanteri Thauvin <a href="https://zulip-archive.rust-lang.org/stream/144729-wg-traits/topic/publish.20failed.html#218989295">(Dec 06 2020 at 14:33)</a>:</h4>
<p><a href="#narrow/stream/144729-wg-traits/topic/publishing/near/216741161">This happened in the past</a> and I think <span class="user-mention" data-user-id="232957">@Jack Huey</span> had to manually release the crates</p>



<a name="218996251"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/144729-wg-traits/topic/publish%20failed/near/218996251" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jack Huey <a href="https://zulip-archive.rust-lang.org/stream/144729-wg-traits/topic/publish.20failed.html#218996251">(Dec 06 2020 at 17:39)</a>:</h4>
<p>Bleh,don't know why it failed. I'll do a manual release in a bit</p>



<a name="219244680"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/144729-wg-traits/topic/publish%20failed/near/219244680" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pksunkara <a href="https://zulip-archive.rust-lang.org/stream/144729-wg-traits/topic/publish.20failed.html#219244680">(Dec 08 2020 at 18:38)</a>:</h4>
<p>What's happening? Both the times, It failed at the same point. But the failure is not always happening because the previous <a href="https://github.com/rust-lang/chalk/runs/1468639645?check_suite_focus=true">passed</a></p>



<a name="219245097"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/144729-wg-traits/topic/publish%20failed/near/219245097" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jack Huey <a href="https://zulip-archive.rust-lang.org/stream/144729-wg-traits/topic/publish.20failed.html#219245097">(Dec 08 2020 at 18:41)</a>:</h4>
<p>I don't know what's happening. Both failed after the "Uploading chalk-derive" step. And yeah, it isn't always failing because the manual release I did literally the next day was fine.</p>



<a name="219773735"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/144729-wg-traits/topic/publish%20failed/near/219773735" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pksunkara <a href="https://zulip-archive.rust-lang.org/stream/144729-wg-traits/topic/publish.20failed.html#219773735">(Dec 13 2020 at 18:39)</a>:</h4>
<p>Uh, this happened again. <a href="https://github.com/rust-lang/chalk/runs/1544055416?check_suite_focus=true">https://github.com/rust-lang/chalk/runs/1544055416?check_suite_focus=true</a></p>



<a name="219773757"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/144729-wg-traits/topic/publish%20failed/near/219773757" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pksunkara <a href="https://zulip-archive.rust-lang.org/stream/144729-wg-traits/topic/publish.20failed.html#219773757">(Dec 13 2020 at 18:39)</a>:</h4>
<p>Who has access to <a href="http://crates.io">crates.io</a> for chalk_derive?</p>



<a name="219773844"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/144729-wg-traits/topic/publish%20failed/near/219773844" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pksunkara <a href="https://zulip-archive.rust-lang.org/stream/144729-wg-traits/topic/publish.20failed.html#219773844">(Dec 13 2020 at 18:41)</a>:</h4>
<p>It looks like <a href="http://crates.io">crates.io</a> is not responding correctly after chalk_derive is published. And it is only happening this one crate. Not other chalk crates or rust-analyzer crates</p>



<a name="219774065"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/144729-wg-traits/topic/publish%20failed/near/219774065" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Léo Lanteri Thauvin <a href="https://zulip-archive.rust-lang.org/stream/144729-wg-traits/topic/publish.20failed.html#219774065">(Dec 13 2020 at 18:46)</a>:</h4>
<p>There’s <a href="https://crates.io/users/rust-lang-chalk-publish-bot">rust-lang-chalk-publish-bot</a></p>



<a name="219779368"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/144729-wg-traits/topic/publish%20failed/near/219779368" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jack Huey <a href="https://zulip-archive.rust-lang.org/stream/144729-wg-traits/topic/publish.20failed.html#219779368">(Dec 13 2020 at 20:22)</a>:</h4>
<p><span class="user-mention" data-user-id="121055">@Pietro Albini</span></p>



<a name="219779397"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/144729-wg-traits/topic/publish%20failed/near/219779397" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Pietro Albini <a href="https://zulip-archive.rust-lang.org/stream/144729-wg-traits/topic/publish.20failed.html#219779397">(Dec 13 2020 at 20:23)</a>:</h4>
<p>gah</p>



<a name="219779403"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/144729-wg-traits/topic/publish%20failed/near/219779403" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Pietro Albini <a href="https://zulip-archive.rust-lang.org/stream/144729-wg-traits/topic/publish.20failed.html#219779403">(Dec 13 2020 at 20:23)</a>:</h4>
<p>let me look in the <a href="http://crates.io">crates.io</a> logs</p>



<a name="219779690"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/144729-wg-traits/topic/publish%20failed/near/219779690" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Pietro Albini <a href="https://zulip-archive.rust-lang.org/stream/144729-wg-traits/topic/publish.20failed.html#219779690">(Dec 13 2020 at 20:28)</a>:</h4>
<p><span class="user-mention" data-user-id="254853">@pksunkara</span> <span class="user-mention" data-user-id="232957">@Jack Huey</span>  it seems like... it published fine?</p>



<a name="219779692"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/144729-wg-traits/topic/publish%20failed/near/219779692" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jack Huey <a href="https://zulip-archive.rust-lang.org/stream/144729-wg-traits/topic/publish.20failed.html#219779692">(Dec 13 2020 at 20:28)</a>:</h4>
<p>It's really weird because I never run into this when I do manual publishs</p>



<a name="219779698"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/144729-wg-traits/topic/publish%20failed/near/219779698" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Pietro Albini <a href="https://zulip-archive.rust-lang.org/stream/144729-wg-traits/topic/publish.20failed.html#219779698">(Dec 13 2020 at 20:28)</a>:</h4>
<p>Dec 13 00:56:47 crates-io app/web.2 at=info method=PUT path="/api/v1/crates/new" request_id=7f4bc97f-1305-438f-8c7e-934cf0340ff6 fwd="IP" service=510ms status=200 user_agent="cargo 1.48.0 (65cbdd2dc 2020-10-14)" metadata_length="1096" crate_name="chalk-derive" crate_version="0.44.0" uid="90893" tokenid="31237"</p>



<a name="219779710"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/144729-wg-traits/topic/publish%20failed/near/219779710" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jack Huey <a href="https://zulip-archive.rust-lang.org/stream/144729-wg-traits/topic/publish.20failed.html#219779710">(Dec 13 2020 at 20:29)</a>:</h4>
<p><span class="user-mention silent" data-user-id="254853">pksunkara</span> <a href="#narrow/stream/144729-wg-traits/topic/publish.20failed/near/219773844">said</a>:</p>
<blockquote>
<p>It looks like <a href="http://crates.io">crates.io</a> is not responding correctly after chalk_derive is published. And it is only happening this one crate. Not other chalk crates or rust-analyzer crates</p>
</blockquote>
<p>It seems like it's not the publish, but <a href="http://crates.io">crates.io</a> after</p>



<a name="219779711"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/144729-wg-traits/topic/publish%20failed/near/219779711" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Pietro Albini <a href="https://zulip-archive.rust-lang.org/stream/144729-wg-traits/topic/publish.20failed.html#219779711">(Dec 13 2020 at 20:29)</a>:</h4>
<p>the backend responded with a status of 200</p>



<a name="219779717"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/144729-wg-traits/topic/publish%20failed/near/219779717" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jack Huey <a href="https://zulip-archive.rust-lang.org/stream/144729-wg-traits/topic/publish.20failed.html#219779717">(Dec 13 2020 at 20:29)</a>:</h4>
<p>Hmm</p>



<a name="219779772"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/144729-wg-traits/topic/publish%20failed/near/219779772" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jack Huey <a href="https://zulip-archive.rust-lang.org/stream/144729-wg-traits/topic/publish.20failed.html#219779772">(Dec 13 2020 at 20:30)</a>:</h4>
<p>Maybe to try to prevent this, we can just add a short cooldown between crate publishes <span class="user-mention" data-user-id="254853">@pksunkara</span>. This is a bit weird.</p>



<a name="219779833"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/144729-wg-traits/topic/publish%20failed/near/219779833" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pksunkara <a href="https://zulip-archive.rust-lang.org/stream/144729-wg-traits/topic/publish.20failed.html#219779833">(Dec 13 2020 at 20:31)</a>:</h4>
<p>This was waiting for 48 mind IIUC waiting for <a href="http://crates.io">crates.io</a> response</p>



<a name="219779835"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/144729-wg-traits/topic/publish%20failed/near/219779835" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pksunkara <a href="https://zulip-archive.rust-lang.org/stream/144729-wg-traits/topic/publish.20failed.html#219779835">(Dec 13 2020 at 20:31)</a>:</h4>
<p>Was something changed recently?</p>



<a name="219779901"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/144729-wg-traits/topic/publish%20failed/near/219779901" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Pietro Albini <a href="https://zulip-archive.rust-lang.org/stream/144729-wg-traits/topic/publish.20failed.html#219779901">(Dec 13 2020 at 20:33)</a>:</h4>
<p>so, I looked in the logs, and the publish request was not followed by any other one from that IP</p>



<a name="219779916"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/144729-wg-traits/topic/publish%20failed/near/219779916" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jack Huey <a href="https://zulip-archive.rust-lang.org/stream/144729-wg-traits/topic/publish.20failed.html#219779916">(Dec 13 2020 at 20:33)</a>:</h4>
<p>Oh wait really? That's probably why it was killed...</p>



<a name="219779920"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/144729-wg-traits/topic/publish%20failed/near/219779920" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Pietro Albini <a href="https://zulip-archive.rust-lang.org/stream/144729-wg-traits/topic/publish.20failed.html#219779920">(Dec 13 2020 at 20:33)</a>:</h4>
<p>so the "error:" is from that request</p>



<a name="219779921"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/144729-wg-traits/topic/publish%20failed/near/219779921" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jack Huey <a href="https://zulip-archive.rust-lang.org/stream/144729-wg-traits/topic/publish.20failed.html#219779921">(Dec 13 2020 at 20:33)</a>:</h4>
<p><span class="user-mention silent" data-user-id="121055">Pietro Albini</span> <a href="#narrow/stream/144729-wg-traits/topic/publish.20failed/near/219779901">said</a>:</p>
<blockquote>
<p>so, I looked in the logs, and the publish request was not followed by any other one from that IP</p>
</blockquote>
<p>the plot thickens</p>



<a name="219779991"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/144729-wg-traits/topic/publish%20failed/near/219779991" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Pietro Albini <a href="https://zulip-archive.rust-lang.org/stream/144729-wg-traits/topic/publish.20failed.html#219779991">(Dec 13 2020 at 20:34)</a>:</h4>
<p>what are you using to publish chalk?</p>



<a name="219780019"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/144729-wg-traits/topic/publish%20failed/near/219780019" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jack Huey <a href="https://zulip-archive.rust-lang.org/stream/144729-wg-traits/topic/publish.20failed.html#219780019">(Dec 13 2020 at 20:35)</a>:</h4>
<p><a href="https://github.com/pksunkara/cargo-workspaces">https://github.com/pksunkara/cargo-workspaces</a></p>



<a name="219780026"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/144729-wg-traits/topic/publish%20failed/near/219780026" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Pietro Albini <a href="https://zulip-archive.rust-lang.org/stream/144729-wg-traits/topic/publish.20failed.html#219780026">(Dec 13 2020 at 20:35)</a>:</h4>
<p>does it have any kind of verbose log?</p>



<a name="219780039"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/144729-wg-traits/topic/publish%20failed/near/219780039" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Pietro Albini <a href="https://zulip-archive.rust-lang.org/stream/144729-wg-traits/topic/publish.20failed.html#219780039">(Dec 13 2020 at 20:36)</a>:</h4>
<p>it'd be interesting to enable any verbose log on that tool and try publishing on <a href="http://staging.crates.io">staging.crates.io</a></p>



<a name="219780051"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/144729-wg-traits/topic/publish%20failed/near/219780051" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jack Huey <a href="https://zulip-archive.rust-lang.org/stream/144729-wg-traits/topic/publish.20failed.html#219780051">(Dec 13 2020 at 20:36)</a>:</h4>
<p>not that I can tell. (<span class="user-mention" data-user-id="254853">@pksunkara</span> wrote it)</p>



<a name="219780081"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/144729-wg-traits/topic/publish%20failed/near/219780081" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Pietro Albini <a href="https://zulip-archive.rust-lang.org/stream/144729-wg-traits/topic/publish.20failed.html#219780081">(Dec 13 2020 at 20:36)</a>:</h4>
<p>can you open an issue on rust-lang/crates.io and cc me on it?</p>



<a name="219780082"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/144729-wg-traits/topic/publish%20failed/near/219780082" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jack Huey <a href="https://zulip-archive.rust-lang.org/stream/144729-wg-traits/topic/publish.20failed.html#219780082">(Dec 13 2020 at 20:36)</a>:</h4>
<p><a href="https://github.com/pksunkara/cargo-workspaces/blob/dad322bb36839dc734ea2ff5816180af4320b7e6/cargo-workspaces/src/publish.rs#L100">this line</a> might be relevant</p>



<a name="219780083"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/144729-wg-traits/topic/publish%20failed/near/219780083" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Pietro Albini <a href="https://zulip-archive.rust-lang.org/stream/144729-wg-traits/topic/publish.20failed.html#219780083">(Dec 13 2020 at 20:36)</a>:</h4>
<p>I'll take a look tomorrow morning an try to reproduce</p>



<a name="219780094"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/144729-wg-traits/topic/publish%20failed/near/219780094" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jack Huey <a href="https://zulip-archive.rust-lang.org/stream/144729-wg-traits/topic/publish.20failed.html#219780094">(Dec 13 2020 at 20:36)</a>:</h4>
<p><span class="user-mention" data-user-id="121055">@Pietro Albini</span> yes, I'll do that. I'll try to look at it today. (<code>staging.crates.io</code> is okay to use to test?)</p>



<a name="219780105"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/144729-wg-traits/topic/publish%20failed/near/219780105" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Pietro Albini <a href="https://zulip-archive.rust-lang.org/stream/144729-wg-traits/topic/publish.20failed.html#219780105">(Dec 13 2020 at 20:37)</a>:</h4>
<p>yeah, feel free to do whatever to <a href="http://staging.crates.io">staging.crates.io</a></p>



<a name="219780109"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/144729-wg-traits/topic/publish%20failed/near/219780109" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Pietro Albini <a href="https://zulip-archive.rust-lang.org/stream/144729-wg-traits/topic/publish.20failed.html#219780109">(Dec 13 2020 at 20:37)</a>:</h4>
<p>tbh we should "advertise" it a bit more</p>



<a name="219780117"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/144729-wg-traits/topic/publish%20failed/near/219780117" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Pietro Albini <a href="https://zulip-archive.rust-lang.org/stream/144729-wg-traits/topic/publish.20failed.html#219780117">(Dec 13 2020 at 20:37)</a>:</h4>
<p>having <a href="http://staging.crates.io">staging.crates.io</a> attached to <a href="http://staging.docs.rs">staging.docs.rs</a> is in my never-ending backlog</p>



<a name="219780123"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/144729-wg-traits/topic/publish%20failed/near/219780123" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Pietro Albini <a href="https://zulip-archive.rust-lang.org/stream/144729-wg-traits/topic/publish.20failed.html#219780123">(Dec 13 2020 at 20:37)</a>:</h4>
<p>(we don't have <a href="http://staging.docs.rs">staging.docs.rs</a> yet)</p>



<a name="219780172"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/144729-wg-traits/topic/publish%20failed/near/219780172" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pksunkara <a href="https://zulip-archive.rust-lang.org/stream/144729-wg-traits/topic/publish.20failed.html#219780172">(Dec 13 2020 at 20:38)</a>:</h4>
<p>The tool just calls cargo underneath</p>



<a name="219780189"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/144729-wg-traits/topic/publish%20failed/near/219780189" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pksunkara <a href="https://zulip-archive.rust-lang.org/stream/144729-wg-traits/topic/publish.20failed.html#219780189">(Dec 13 2020 at 20:38)</a>:</h4>
<p>You can also try printing the err and out of the underlying cargo command</p>



<a name="219780288"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/144729-wg-traits/topic/publish%20failed/near/219780288" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jack Huey <a href="https://zulip-archive.rust-lang.org/stream/144729-wg-traits/topic/publish.20failed.html#219780288">(Dec 13 2020 at 20:40)</a>:</h4>
<p>I'm at tad worried I'm not going to be able to reproduce since it never seems to happen when I manually publish :/</p>



<a name="219780362"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/144729-wg-traits/topic/publish%20failed/near/219780362" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jack Huey <a href="https://zulip-archive.rust-lang.org/stream/144729-wg-traits/topic/publish.20failed.html#219780362">(Dec 13 2020 at 20:42)</a>:</h4>
<p>Nonetheless, I'll try it once or twice late and if I can't get it to repro, I'll add a bunch of verbose logging so if it happens again we can hopefully tell why</p>



<a name="220273362"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/144729-wg-traits/topic/publish%20failed/near/220273362" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jack Huey <a href="https://zulip-archive.rust-lang.org/stream/144729-wg-traits/topic/publish.20failed.html#220273362">(Dec 17 2020 at 17:21)</a>:</h4>
<p>Okay so I haven't had time this week to do anything. But <span class="user-mention" data-user-id="254853">@pksunkara</span> would you be able to publish a new version of cargo-workspaces with more verbose logging (i.e. for cargo errors and such). I've made Chalk publish use the verbose flag.</p>



<a name="220274212"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/144729-wg-traits/topic/publish%20failed/near/220274212" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pksunkara <a href="https://zulip-archive.rust-lang.org/stream/144729-wg-traits/topic/publish.20failed.html#220274212">(Dec 17 2020 at 17:26)</a>:</h4>
<p>Oh I didn't realize we wanted to test that. Will do it tonight</p>



<a name="220276577"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/144729-wg-traits/topic/publish%20failed/near/220276577" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jack Huey <a href="https://zulip-archive.rust-lang.org/stream/144729-wg-traits/topic/publish.20failed.html#220276577">(Dec 17 2020 at 17:42)</a>:</h4>
<p>No worries. It would be helpful to have it by auto release on Saturday in case it fails again. But if you can't get to it or don't have time, no worries.</p>



<a name="220305947"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/144729-wg-traits/topic/publish%20failed/near/220305947" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pksunkara <a href="https://zulip-archive.rust-lang.org/stream/144729-wg-traits/topic/publish.20failed.html#220305947">(Dec 17 2020 at 21:33)</a>:</h4>
<p>To confirm, we want to see <code>cargo -v</code> output, right?</p>



<a name="220308001"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/144729-wg-traits/topic/publish%20failed/near/220308001" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pksunkara <a href="https://zulip-archive.rust-lang.org/stream/144729-wg-traits/topic/publish.20failed.html#220308001">(Dec 17 2020 at 21:50)</a>:</h4>
<p>Done, published 0.2.16</p>



<a name="220308181"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/144729-wg-traits/topic/publish%20failed/near/220308181" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jack Huey <a href="https://zulip-archive.rust-lang.org/stream/144729-wg-traits/topic/publish.20failed.html#220308181">(Dec 17 2020 at 21:51)</a>:</h4>
<p>Yeah, as much useful info as possible</p>



<a name="220622852"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/144729-wg-traits/topic/publish%20failed/near/220622852" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pksunkara <a href="https://zulip-archive.rust-lang.org/stream/144729-wg-traits/topic/publish.20failed.html#220622852">(Dec 21 2020 at 19:49)</a>:</h4>
<p>Publishing worked this week, <a href="https://github.com/rust-lang/chalk/runs/1583175235?check_suite_focus=true#step:5:137">https://github.com/rust-lang/chalk/runs/1583175235?check_suite_focus=true#step:5:137</a></p>



<a name="221177699"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/144729-wg-traits/topic/publish%20failed/near/221177699" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pksunkara <a href="https://zulip-archive.rust-lang.org/stream/144729-wg-traits/topic/publish.20failed.html#221177699">(Dec 29 2020 at 23:52)</a>:</h4>
<p>Worked this week again. Still no idea what the original issue is</p>



<a name="221185101"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/144729-wg-traits/topic/publish%20failed/near/221185101" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jack Huey <a href="https://zulip-archive.rust-lang.org/stream/144729-wg-traits/topic/publish.20failed.html#221185101">(Dec 30 2020 at 02:36)</a>:</h4>
<p>Yeah :/ well, at least if it does pop up again, we should get some logging</p>



<a name="223110346"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/144729-wg-traits/topic/publish%20failed/near/223110346" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pksunkara <a href="https://zulip-archive.rust-lang.org/stream/144729-wg-traits/topic/publish.20failed.html#223110346">(Jan 18 2021 at 11:51)</a>:</h4>
<p>Someone encountered this bug locally, <a href="https://github.com/pksunkara/cargo-workspaces/issues/37">https://github.com/pksunkara/cargo-workspaces/issues/37</a></p>



<a name="223542605"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/144729-wg-traits/topic/publish%20failed/near/223542605" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pksunkara <a href="https://zulip-archive.rust-lang.org/stream/144729-wg-traits/topic/publish.20failed.html#223542605">(Jan 21 2021 at 17:28)</a>:</h4>
<p>That guy actually found the issue with the verbose logging, <a href="https://github.com/pksunkara/cargo-workspaces/issues/37#issuecomment-764527248">https://github.com/pksunkara/cargo-workspaces/issues/37#issuecomment-764527248</a></p>



<a name="223555302"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/144729-wg-traits/topic/publish%20failed/near/223555302" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jack Huey <a href="https://zulip-archive.rust-lang.org/stream/144729-wg-traits/topic/publish.20failed.html#223555302">(Jan 21 2021 at 19:03)</a>:</h4>
<p>Hmm...that's weird. I think we're good about dependency versions...</p>



<a name="224756106"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/144729-wg-traits/topic/publish%20failed/near/224756106" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jack Huey <a href="https://zulip-archive.rust-lang.org/stream/144729-wg-traits/topic/publish.20failed.html#224756106">(Feb 01 2021 at 16:55)</a>:</h4>
<p>Might have caught this (or being caught currently). Did a manual publish. <code>chalk-derive</code> got published but release is still going 45 minutes later</p>



<a name="224756121"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/144729-wg-traits/topic/publish%20failed/near/224756121" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jack Huey <a href="https://zulip-archive.rust-lang.org/stream/144729-wg-traits/topic/publish.20failed.html#224756121">(Feb 01 2021 at 16:55)</a>:</h4>
<p><a href="https://github.com/rust-lang/chalk/runs/1807968169?check_suite_focus=true">https://github.com/rust-lang/chalk/runs/1807968169?check_suite_focus=true</a></p>



<a name="224756431"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/144729-wg-traits/topic/publish%20failed/near/224756431" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jack Huey <a href="https://zulip-archive.rust-lang.org/stream/144729-wg-traits/topic/publish.20failed.html#224756431">(Feb 01 2021 at 16:57)</a>:</h4>
<p>It's a bit unfortunate I can't see the current logs from the "Release" section</p>



<a name="224756485"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/144729-wg-traits/topic/publish%20failed/near/224756485" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jack Huey <a href="https://zulip-archive.rust-lang.org/stream/144729-wg-traits/topic/publish.20failed.html#224756485">(Feb 01 2021 at 16:57)</a>:</h4>
<p>Cancelling this now...</p>



<a name="224756600"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/144729-wg-traits/topic/publish%20failed/near/224756600" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jack Huey <a href="https://zulip-archive.rust-lang.org/stream/144729-wg-traits/topic/publish.20failed.html#224756600">(Feb 01 2021 at 16:58)</a>:</h4>
<div class="codehilite"><pre><span></span><code>Uploading chalk-derive v0.53.0 (/Users/runner/work/chalk/chalk/chalk-derive)
debug cargo stdout
</code></pre></div>



<a name="224756616"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/144729-wg-traits/topic/publish%20failed/near/224756616" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jack Huey <a href="https://zulip-archive.rust-lang.org/stream/144729-wg-traits/topic/publish.20failed.html#224756616">(Feb 01 2021 at 16:58)</a>:</h4>
<p>the last output</p>



<a name="224756646"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/144729-wg-traits/topic/publish%20failed/near/224756646" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jack Huey <a href="https://zulip-archive.rust-lang.org/stream/144729-wg-traits/topic/publish.20failed.html#224756646">(Feb 01 2021 at 16:58)</a>:</h4>
<p>(where it was stuck for 45 minutes)</p>



<a name="224757044"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/144729-wg-traits/topic/publish%20failed/near/224757044" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jack Huey <a href="https://zulip-archive.rust-lang.org/stream/144729-wg-traits/topic/publish.20failed.html#224757044">(Feb 01 2021 at 17:01)</a>:</h4>
<p>vs where it was from release Saturday:</p>
<div class="codehilite"><pre><span></span><code>Uploading chalk-derive v0.52.0 (/Users/runner/work/chalk/chalk/chalk-derive)
debug cargo stdout
info waiting ...
info published chalk-derive
``
</code></pre></div>



<a name="224757338"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/144729-wg-traits/topic/publish%20failed/near/224757338" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jack Huey <a href="https://zulip-archive.rust-lang.org/stream/144729-wg-traits/topic/publish.20failed.html#224757338">(Feb 01 2021 at 17:02)</a>:</h4>
<p>Wonder if it's the <code>check_index</code> call?</p>



<a name="224757416"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/144729-wg-traits/topic/publish%20failed/near/224757416" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jack Huey <a href="https://zulip-archive.rust-lang.org/stream/144729-wg-traits/topic/publish.20failed.html#224757416">(Feb 01 2021 at 17:02)</a>:</h4>
<p><span class="user-mention" data-user-id="121055">@Pietro Albini</span> you checked last time if there was anything strange on the <a href="http://crates.io">crates.io</a> side, right?</p>



<a name="224757476"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/144729-wg-traits/topic/publish%20failed/near/224757476" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jack Huey <a href="https://zulip-archive.rust-lang.org/stream/144729-wg-traits/topic/publish.20failed.html#224757476">(Feb 01 2021 at 17:03)</a>:</h4>
<p>Just ran into this issue again, after not encountering it for a several weeks :/</p>



<a name="224757551"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/144729-wg-traits/topic/publish%20failed/near/224757551" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jack Huey <a href="https://zulip-archive.rust-lang.org/stream/144729-wg-traits/topic/publish.20failed.html#224757551">(Feb 01 2021 at 17:03)</a>:</h4>
<p><span class="user-mention silent" data-user-id="232957">Jack Huey</span> <a href="#narrow/stream/144729-wg-traits/topic/publish.20failed/near/224757338">said</a>:</p>
<blockquote>
<p>Wonder if it's the <code>check_index</code> call?</p>
</blockquote>
<p><a href="https://github.com/pksunkara/cargo-workspaces/blob/b1962f44732d2d532b7de67ff9f10253784eca07/cargo-workspaces/src/utils/cargo.rs#L327">reference</a></p>



<a name="224757865"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/144729-wg-traits/topic/publish%20failed/near/224757865" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Pietro Albini <a href="https://zulip-archive.rust-lang.org/stream/144729-wg-traits/topic/publish.20failed.html#224757865">(Feb 01 2021 at 17:05)</a>:</h4>
<p><span class="user-mention silent" data-user-id="232957">Jack Huey</span> <a href="#narrow/stream/144729-wg-traits/topic/publish.20failed/near/224757416">said</a>:</p>
<blockquote>
<p><span class="user-mention silent" data-user-id="121055">Pietro Albini</span> you checked last time if there was anything strange on the <a href="http://crates.io">crates.io</a> side, right?</p>
</blockquote>
<p>yeah, I didn't see anything wrong on the <a href="http://crates.io">crates.io</a> side</p>



<a name="224758026"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/144729-wg-traits/topic/publish%20failed/near/224758026" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jack Huey <a href="https://zulip-archive.rust-lang.org/stream/144729-wg-traits/topic/publish.20failed.html#224758026">(Feb 01 2021 at 17:06)</a>:</h4>
<p>bleh</p>



<a name="224758040"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/144729-wg-traits/topic/publish%20failed/near/224758040" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jack Huey <a href="https://zulip-archive.rust-lang.org/stream/144729-wg-traits/topic/publish.20failed.html#224758040">(Feb 01 2021 at 17:06)</a>:</h4>
<p>Thanks for looking <span class="user-mention" data-user-id="121055">@Pietro Albini</span></p>



<a name="224758081"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/144729-wg-traits/topic/publish%20failed/near/224758081" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Pietro Albini <a href="https://zulip-archive.rust-lang.org/stream/144729-wg-traits/topic/publish.20failed.html#224758081">(Feb 01 2021 at 17:06)</a>:</h4>
<p>(at least back then, didn't check now)</p>



<a name="224758097"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/144729-wg-traits/topic/publish%20failed/near/224758097" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jack Huey <a href="https://zulip-archive.rust-lang.org/stream/144729-wg-traits/topic/publish.20failed.html#224758097">(Feb 01 2021 at 17:06)</a>:</h4>
<p>ohh</p>



<a name="224758099"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/144729-wg-traits/topic/publish%20failed/near/224758099" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Pietro Albini <a href="https://zulip-archive.rust-lang.org/stream/144729-wg-traits/topic/publish.20failed.html#224758099">(Feb 01 2021 at 17:06)</a>:</h4>
<p>but I don't really have time to do so</p>



<a name="224758125"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/144729-wg-traits/topic/publish%20failed/near/224758125" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jack Huey <a href="https://zulip-archive.rust-lang.org/stream/144729-wg-traits/topic/publish.20failed.html#224758125">(Feb 01 2021 at 17:07)</a>:</h4>
<p>No problem</p>



<a name="224763293"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/144729-wg-traits/topic/publish%20failed/near/224763293" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jack Huey <a href="https://zulip-archive.rust-lang.org/stream/144729-wg-traits/topic/publish.20failed.html#224763293">(Feb 01 2021 at 17:41)</a>:</h4>
<p>Ugh I tried again and I think it got stuck again :(</p>



<a name="228078956"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/144729-wg-traits/topic/publish%20failed/near/228078956" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pksunkara <a href="https://zulip-archive.rust-lang.org/stream/144729-wg-traits/topic/publish.20failed.html#228078956">(Feb 27 2021 at 19:51)</a>:</h4>
<p><span class="user-mention" data-user-id="232957">@Jack Huey</span> So, basically we are encountering this error even with <code>cargo</code>? Since we are just forwarding the ouput from cargo now and we don't see anything in there</p>



<a name="228080465"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/144729-wg-traits/topic/publish%20failed/near/228080465" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jack Huey <a href="https://zulip-archive.rust-lang.org/stream/144729-wg-traits/topic/publish.20failed.html#228080465">(Feb 27 2021 at 20:18)</a>:</h4>
<p><span aria-label="shrug" class="emoji emoji-1f937" role="img" title="shrug">:shrug:</span>‍♀️maybe?</p>



<a name="235570707"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/144729-wg-traits/topic/publish%20failed/near/235570707" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jack Huey <a href="https://zulip-archive.rust-lang.org/stream/144729-wg-traits/topic/publish.20failed.html#235570707">(Apr 21 2021 at 19:51)</a>:</h4>
<p><span class="user-mention" data-user-id="254853">@pksunkara</span> failed again: <a href="https://github.com/rust-lang/chalk/runs/2371903491?check_suite_focus=true">https://github.com/rust-lang/chalk/runs/2371903491?check_suite_focus=true</a></p>



<a name="235578241"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/144729-wg-traits/topic/publish%20failed/near/235578241" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pksunkara <a href="https://zulip-archive.rust-lang.org/stream/144729-wg-traits/topic/publish.20failed.html#235578241">(Apr 21 2021 at 20:47)</a>:</h4>
<p>A recent change is giving me more info now. <code>error: publishing has timed out</code></p>



<a name="235578524"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/144729-wg-traits/topic/publish%20failed/near/235578524" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pksunkara <a href="https://zulip-archive.rust-lang.org/stream/144729-wg-traits/topic/publish.20failed.html#235578524">(Apr 21 2021 at 20:50)</a>:</h4>
<p>This <a href="https://github.com/pksunkara/cargo-workspaces/blob/master/cargo-workspaces/src/utils/cargo.rs#L360">line</a> is getting triggered</p>



<a name="235579538"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/144729-wg-traits/topic/publish%20failed/near/235579538" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jack Huey <a href="https://zulip-archive.rust-lang.org/stream/144729-wg-traits/topic/publish.20failed.html#235579538">(Apr 21 2021 at 20:57)</a>:</h4>
<p>I saw that</p>



<a name="238511553"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/144729-wg-traits/topic/publish%20failed/near/238511553" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jack Huey <a href="https://zulip-archive.rust-lang.org/stream/144729-wg-traits/topic/publish.20failed.html#238511553">(May 12 2021 at 17:20)</a>:</h4>
<p><span class="user-group-mention" data-user-group-id="692">@WG-traits</span> can someone make a PR to bump the Chalk version to <code>v0.67.0</code>? Publish failed a couple weeks ago and things are out of sync.</p>



<a name="238513163"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/144729-wg-traits/topic/publish%20failed/near/238513163" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Léo Lanteri Thauvin <a href="https://zulip-archive.rust-lang.org/stream/144729-wg-traits/topic/publish.20failed.html#238513163">(May 12 2021 at 17:31)</a>:</h4>
<p>Can do</p>



<a name="238513292"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/144729-wg-traits/topic/publish%20failed/near/238513292" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jack Huey <a href="https://zulip-archive.rust-lang.org/stream/144729-wg-traits/topic/publish.20failed.html#238513292">(May 12 2021 at 17:32)</a>:</h4>
<p>Thank you &lt;3</p>



<a name="238514083"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/144729-wg-traits/topic/publish%20failed/near/238514083" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Léo Lanteri Thauvin <a href="https://zulip-archive.rust-lang.org/stream/144729-wg-traits/topic/publish.20failed.html#238514083">(May 12 2021 at 17:37)</a>:</h4>
<p><a href="https://github.com/rust-lang/chalk/issues/706">chalk#706</a></p>



<a name="238514398"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/144729-wg-traits/topic/publish%20failed/near/238514398" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jack Huey <a href="https://zulip-archive.rust-lang.org/stream/144729-wg-traits/topic/publish.20failed.html#238514398">(May 12 2021 at 17:39)</a>:</h4>
<p><span aria-label="hearts" class="emoji emoji-2665" role="img" title="hearts">:hearts:</span></p>



<a name="239720526"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/144729-wg-traits/topic/publish%20failed/near/239720526" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pksunkara <a href="https://zulip-archive.rust-lang.org/stream/144729-wg-traits/topic/publish.20failed.html#239720526">(May 21 2021 at 09:18)</a>:</h4>
<p><span class="user-mention" data-user-id="232957">@Jack Huey</span> I am sorry, but something changed recently and we are getting continous failures.</p>



<a name="239720915"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/144729-wg-traits/topic/publish%20failed/near/239720915" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pksunkara <a href="https://zulip-archive.rust-lang.org/stream/144729-wg-traits/topic/publish.20failed.html#239720915">(May 21 2021 at 09:22)</a>:</h4>
<p><span class="user-mention" data-user-id="121055">@Pietro Albini</span> What's the most reliable way to update the local index?</p>



<a name="239720994"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/144729-wg-traits/topic/publish%20failed/near/239720994" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pksunkara <a href="https://zulip-archive.rust-lang.org/stream/144729-wg-traits/topic/publish.20failed.html#239720994">(May 21 2021 at 09:22)</a>:</h4>
<p>If you check <a href="https://github.com/rust-lang/chalk/runs/2592743962?check_suite_focus=true#step:5:654">here</a>, chalk-solve is published, but in the next step, we can't find it</p>



<a name="239721015"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/144729-wg-traits/topic/publish%20failed/near/239721015" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Pietro Albini <a href="https://zulip-archive.rust-lang.org/stream/144729-wg-traits/topic/publish.20failed.html#239721015">(May 21 2021 at 09:22)</a>:</h4>
<div class="codehilite"><pre><span></span><code>git fetch
git reset --hard origin/master
</code></pre></div>



<a name="239721064"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/144729-wg-traits/topic/publish%20failed/near/239721064" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Pietro Albini <a href="https://zulip-archive.rust-lang.org/stream/144729-wg-traits/topic/publish.20failed.html#239721064">(May 21 2021 at 09:22)</a>:</h4>
<p>but cargo already does that</p>



<a name="239721088"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/144729-wg-traits/topic/publish%20failed/near/239721088" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Pietro Albini <a href="https://zulip-archive.rust-lang.org/stream/144729-wg-traits/topic/publish.20failed.html#239721088">(May 21 2021 at 09:23)</a>:</h4>
<p>hmm, how do you check whether the package is uploaded?</p>



<a name="239721182"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/144729-wg-traits/topic/publish%20failed/near/239721182" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pksunkara <a href="https://zulip-archive.rust-lang.org/stream/144729-wg-traits/topic/publish.20failed.html#239721182">(May 21 2021 at 09:23)</a>:</h4>
<p>I actually check that it's available in index</p>



<a name="239721189"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/144729-wg-traits/topic/publish%20failed/near/239721189" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pksunkara <a href="https://zulip-archive.rust-lang.org/stream/144729-wg-traits/topic/publish.20failed.html#239721189">(May 21 2021 at 09:23)</a>:</h4>
<p>which makes it more confusing</p>



<a name="239721247"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/144729-wg-traits/topic/publish%20failed/near/239721247" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Pietro Albini <a href="https://zulip-archive.rust-lang.org/stream/144729-wg-traits/topic/publish.20failed.html#239721247">(May 21 2021 at 09:24)</a>:</h4>
<p>the same index cargo is using?</p>



<a name="239721267"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/144729-wg-traits/topic/publish%20failed/near/239721267" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pksunkara <a href="https://zulip-archive.rust-lang.org/stream/144729-wg-traits/topic/publish.20failed.html#239721267">(May 21 2021 at 09:24)</a>:</h4>
<p><a href="https://github.com/pksunkara/cargo-workspaces/blob/master/cargo-workspaces/src/utils/cargo.rs#L336">https://github.com/pksunkara/cargo-workspaces/blob/master/cargo-workspaces/src/utils/cargo.rs#L336</a></p>



<a name="239721273"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/144729-wg-traits/topic/publish%20failed/near/239721273" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pksunkara <a href="https://zulip-archive.rust-lang.org/stream/144729-wg-traits/topic/publish.20failed.html#239721273">(May 21 2021 at 09:24)</a>:</h4>
<p>Yeah</p>



<a name="239721405"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/144729-wg-traits/topic/publish%20failed/near/239721405" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Pietro Albini <a href="https://zulip-archive.rust-lang.org/stream/144729-wg-traits/topic/publish.20failed.html#239721405">(May 21 2021 at 09:25)</a>:</h4>
<p>wut</p>



<a name="239721451"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/144729-wg-traits/topic/publish%20failed/near/239721451" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Pietro Albini <a href="https://zulip-archive.rust-lang.org/stream/144729-wg-traits/topic/publish.20failed.html#239721451">(May 21 2021 at 09:26)</a>:</h4>
<p>I'm... not sure</p>



<a name="239721466"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/144729-wg-traits/topic/publish%20failed/near/239721466" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Pietro Albini <a href="https://zulip-archive.rust-lang.org/stream/144729-wg-traits/topic/publish.20failed.html#239721466">(May 21 2021 at 09:26)</a>:</h4>
<p>this seems more like a cargo problem tho</p>



<a name="239721580"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/144729-wg-traits/topic/publish%20failed/near/239721580" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pksunkara <a href="https://zulip-archive.rust-lang.org/stream/144729-wg-traits/topic/publish.20failed.html#239721580">(May 21 2021 at 09:27)</a>:</h4>
<p>I guess, the following code doesn't actually do <code>git reset --hard origin/master</code>? <a href="https://docs.rs/crates-index/0.16.6/src/crates_index/bare_index.rs.html#74">https://docs.rs/crates-index/0.16.6/src/crates_index/bare_index.rs.html#74</a></p>



<a name="239721872"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/144729-wg-traits/topic/publish%20failed/near/239721872" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pksunkara <a href="https://zulip-archive.rust-lang.org/stream/144729-wg-traits/topic/publish.20failed.html#239721872">(May 21 2021 at 09:30)</a>:</h4>
<p>IIRC I am not sure if <code>reset --hard</code> was needed or not</p>



<a name="239721996"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/144729-wg-traits/topic/publish%20failed/near/239721996" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Pietro Albini <a href="https://zulip-archive.rust-lang.org/stream/144729-wg-traits/topic/publish.20failed.html#239721996">(May 21 2021 at 09:31)</a>:</h4>
<p>well it does the equivalent when reading from a bare repository</p>



<a name="239722082"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/144729-wg-traits/topic/publish%20failed/near/239722082" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Pietro Albini <a href="https://zulip-archive.rust-lang.org/stream/144729-wg-traits/topic/publish.20failed.html#239722082">(May 21 2021 at 09:32)</a>:</h4>
<p>it reads the tree of <code>origin/HEAD</code> / <code>origin/master</code> directly without every checking out the repo on disk</p>



<a name="239724250"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/144729-wg-traits/topic/publish%20failed/near/239724250" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pksunkara <a href="https://zulip-archive.rust-lang.org/stream/144729-wg-traits/topic/publish.20failed.html#239724250">(May 21 2021 at 09:51)</a>:</h4>
<p><a href="https://github.com/rust-lang/cargo/blob/163097cdd9da796b2e50f983343ea451aa6a3e91/src/cargo/sources/git/utils.rs#L716">https://github.com/rust-lang/cargo/blob/163097cdd9da796b2e50f983343ea451aa6a3e91/src/cargo/sources/git/utils.rs#L716</a> is the related code in cargo for future reference</p>



<a name="239726324"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/144729-wg-traits/topic/publish%20failed/near/239726324" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pksunkara <a href="https://zulip-archive.rust-lang.org/stream/144729-wg-traits/topic/publish.20failed.html#239726324">(May 21 2021 at 10:08)</a>:</h4>
<p><a href="https://github.com/rust-lang/cargo/commit/4c02977c219ef79b5eb09cb1fb39c4068de61559">https://github.com/rust-lang/cargo/commit/4c02977c219ef79b5eb09cb1fb39c4068de61559</a> changed cargo handling from <code>master</code> to <code>HEAD</code></p>



<a name="239728205"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/144729-wg-traits/topic/publish%20failed/near/239728205" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pksunkara <a href="https://zulip-archive.rust-lang.org/stream/144729-wg-traits/topic/publish.20failed.html#239728205">(May 21 2021 at 10:26)</a>:</h4>
<p>After more research (<a href="https://github.com/sunng87/cargo-release/issues/224#issuecomment-790395825">comment</a>), I can only conclude that cargo is still trying to read <code>origin/master</code> instead of <code>origin/HEAD</code></p>



<a name="239747605"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/144729-wg-traits/topic/publish%20failed/near/239747605" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jack Huey <a href="https://zulip-archive.rust-lang.org/stream/144729-wg-traits/topic/publish.20failed.html#239747605">(May 21 2021 at 13:11)</a>:</h4>
<p><span aria-label="oh no" class="emoji emoji-1f615" role="img" title="oh no">:oh_no:</span> thanks for looking into this <span class="user-mention" data-user-id="254853">@pksunkara</span></p>



<a name="239747861"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/144729-wg-traits/topic/publish%20failed/near/239747861" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pksunkara <a href="https://zulip-archive.rust-lang.org/stream/144729-wg-traits/topic/publish.20failed.html#239747861">(May 21 2021 at 13:13)</a>:</h4>
<p>I will have to compile cargo locally and see what it is doing to figure out the bug. But I should have a workaround</p>



<a name="240555602"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/144729-wg-traits/topic/publish%20failed/near/240555602" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pksunkara <a href="https://zulip-archive.rust-lang.org/stream/144729-wg-traits/topic/publish.20failed.html#240555602">(May 28 2021 at 02:37)</a>:</h4>
<p><span class="user-mention" data-user-id="232957">@Jack Huey</span> Finally fixed the issue after a lot of local debugging.  Am very confident that we should not see this anymore. Can you please revert the verbose mode you made in this commit? <a href="https://github.com/rust-lang/chalk/commit/28e4dbbe4aa04bfc33a90589d3fb0eeca0db8feb#diff-551d1fcf87f78cc3bc18a7b332a4dc5d8773a512062df881c5aba28a6f5c48d7">https://github.com/rust-lang/chalk/commit/28e4dbbe4aa04bfc33a90589d3fb0eeca0db8feb#diff-551d1fcf87f78cc3bc18a7b332a4dc5d8773a512062df881c5aba28a6f5c48d7</a></p>



<a name="240555626"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/144729-wg-traits/topic/publish%20failed/near/240555626" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jack Huey <a href="https://zulip-archive.rust-lang.org/stream/144729-wg-traits/topic/publish.20failed.html#240555626">(May 28 2021 at 02:37)</a>:</h4>
<p>What was the issue</p>



<a name="240555787"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/144729-wg-traits/topic/publish%20failed/near/240555787" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pksunkara <a href="https://zulip-archive.rust-lang.org/stream/144729-wg-traits/topic/publish.20failed.html#240555787">(May 28 2021 at 02:40)</a>:</h4>
<p>Basically, cargo older versions were using <code>master</code> to read. But newer ones use <code>HEAD</code>. There was some mismatch which kept causing the publish timeout. This was solved when I updated the <code>cratex-index</code> dep. But now, older cargos (basically below 1.53.0) don't work anymore reliably.</p>



<a name="240555798"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/144729-wg-traits/topic/publish%20failed/near/240555798" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pksunkara <a href="https://zulip-archive.rust-lang.org/stream/144729-wg-traits/topic/publish.20failed.html#240555798">(May 28 2021 at 02:41)</a>:</h4>
<p>I have made a fix to that lib to fetch <code>master</code> too to support older cargo</p>



<hr><p>Last updated: Apr 12 2022 at 20:01 UTC</p>
</html>