<html>
<head><meta charset="utf-8"><title>Chalk bugfixing and getting familiar · wg-traits · Zulip Chat Archive</title></head>
<h2>Stream: <a href="https://zulip-archive.rust-lang.org/stream/144729-wg-traits/index.html">wg-traits</a></h2>
<h3>Topic: <a href="https://zulip-archive.rust-lang.org/stream/144729-wg-traits/topic/Chalk.20bugfixing.20and.20getting.20familiar.html">Chalk bugfixing and getting familiar</a></h3>

<hr>

<base href="https://rust-lang.zulipchat.com">

<head><link href="https://zulip-archive.rust-lang.org/style.css" rel="stylesheet"></head>

<a name="275165440"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/144729-wg-traits/topic/Chalk%20bugfixing%20and%20getting%20familiar/near/275165440" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Alex Vlasov <a href="https://zulip-archive.rust-lang.org/stream/144729-wg-traits/topic/Chalk.20bugfixing.20and.20getting.20familiar.html#275165440">(Mar 13 2022 at 17:27)</a>:</h4>
<p>I've tried to look into the Chalk and while some things are quite intuitive other are not (or may look like a bug).</p>
<p>Going into one of the issues I've found in a list of pushed clauses a line like<br>
<code>for&lt;type, type&gt; WellFormed(^0.0: Combine&lt;^0.1&gt;) :- ForAll&lt;&gt; { WellFormed(^1.1: HList) }, Implemented(^0.0: Combine&lt;^0.1&gt;)</code></p>
<p>There are other clauses like this for which I do not see any problem, like <code>for&lt;type, type&gt; AliasEq(&lt;&lt;Exact&lt;Uint(Usize)&gt; as FilterBase&gt;::Extract as Tuple&gt;::HList = ^0.0) :- AliasEq(&lt;^0.1 as Tuple&gt;::HList = ^0.0), AliasEq(&lt;Exact&lt;Uint(Usize)&gt; as FilterBase&gt;::Extract = ^0.1)</code> or similar that form a closure over <code>0.0</code>, <code>0.1</code>, an potentially other variables. If I get it right then it reads something like: <code>^0.0</code> is some <code>HList</code> for chain of traits and associated types iff there exists some type <code>0.1</code> when considered as <code>Tuple</code> gives it's <code>HList</code> as <code>^0.0</code>, and if out initial chain of traits and associated types can be stopped in a middle and this type is some <code>0.1</code>. </p>
<p>On the other side <code>for&lt;type, type&gt; WellFormed(^0.0: Combine&lt;^0.1&gt;) :- ForAll&lt;&gt; { WellFormed(^1.1: HList) }, Implemented(^0.0: Combine&lt;^0.1&gt;)</code> doesn't form a closure - it biases the fact that <code>0.0</code> is well-formed <code>Combine&lt;0.1&gt;</code> on some  I believe unrelated fact that some other type <code>1.1</code> is well-formed <code>HList</code>. Should I read it like that <code>there should exist an implementation of HList</code>, or is it a plain bug?</p>
<p>Based on definition</p>
<div class="codehilite"><pre><span></span><code>            trait Combine&lt;T&gt;
            where
              T: HList
            {
              type Output: HList;
            }
</code></pre></div>
<p>I think it should be <code>for&lt;type, type&gt; WellFormed(^0.0: Combine&lt;^0.1&gt;) :- ForAll&lt;&gt; { WellFormed(^0.1: HList) }, Implemented(^0.0: Combine&lt;^0.1&gt;)</code> (note <code>1.1</code> -&gt; <code>0.1</code> change in <code>WellFormed(^0.1: HList) </code></p>



<a name="275165671"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/144729-wg-traits/topic/Chalk%20bugfixing%20and%20getting%20familiar/near/275165671" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jack Huey <a href="https://zulip-archive.rust-lang.org/stream/144729-wg-traits/topic/Chalk.20bugfixing.20and.20getting.20familiar.html#275165671">(Mar 13 2022 at 17:32)</a>:</h4>
<p>There's a <code>ForAll&lt;&gt;</code> wrapped around that <code>WellFormed</code> goal. So it is indeed <code>^1.1</code>, since it refers to the second type in <code>for&lt;type, type&gt;</code></p>



<a name="275165758"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/144729-wg-traits/topic/Chalk%20bugfixing%20and%20getting%20familiar/near/275165758" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Alex Vlasov <a href="https://zulip-archive.rust-lang.org/stream/144729-wg-traits/topic/Chalk.20bugfixing.20and.20getting.20familiar.html#275165758">(Mar 13 2022 at 17:34)</a>:</h4>
<p>Is there any doc on indexing of <code>for&lt;type, type&gt;</code> and how <code>0.0</code>, <code>0.1</code> and <code>1.x</code> related? This one I couldn't figure out yet to be completely sure in my inderstanding</p>



<a name="275165824"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/144729-wg-traits/topic/Chalk%20bugfixing%20and%20getting%20familiar/near/275165824" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jack Huey <a href="https://zulip-archive.rust-lang.org/stream/144729-wg-traits/topic/Chalk.20bugfixing.20and.20getting.20familiar.html#275165824">(Mar 13 2022 at 17:36)</a>:</h4>
<p><a href="https://rust-lang.github.io/chalk/book/glossary.html">https://rust-lang.github.io/chalk/book/glossary.html</a></p>



<a name="275165833"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/144729-wg-traits/topic/Chalk%20bugfixing%20and%20getting%20familiar/near/275165833" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jack Huey <a href="https://zulip-archive.rust-lang.org/stream/144729-wg-traits/topic/Chalk.20bugfixing.20and.20getting.20familiar.html#275165833">(Mar 13 2022 at 17:36)</a>:</h4>
<p>The "De Bruijn Index" section specifically</p>



<a name="275166367"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/144729-wg-traits/topic/Chalk%20bugfixing%20and%20getting%20familiar/near/275166367" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Alex Vlasov <a href="https://zulip-archive.rust-lang.org/stream/144729-wg-traits/topic/Chalk.20bugfixing.20and.20getting.20familiar.html#275166367">(Mar 13 2022 at 17:50)</a>:</h4>
<p>Ok, so basically <code>for&lt;type, type&gt; WellFormed(^0.0: Combine&lt;^0.1&gt;) :- ForAll&lt;&gt; { WellFormed(^1.1: HList) }, Implemented(^0.0: Combine&lt;^0.1&gt;)</code> means that type <code>0</code> in scope 0 is <code>Combine</code> over type <code>1</code> in scope <code>0</code> iff for all types <code>1</code> in some other scope <code>1</code> the type is <code>HList</code>?</p>



<a name="275170388"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/144729-wg-traits/topic/Chalk%20bugfixing%20and%20getting%20familiar/near/275170388" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Florian Diebold <a href="https://zulip-archive.rust-lang.org/stream/144729-wg-traits/topic/Chalk.20bugfixing.20and.20getting.20familiar.html#275170388">(Mar 13 2022 at 19:21)</a>:</h4>
<p>the <code>^1.1</code> is referring to the same type as the <code>^0.1</code>s. The first number basically how many binders (<code>ForAll</code> or <code>for</code> or <code>Exists</code>) you're skipping to find the one you're referring to, so when you 'enter' the <code>ForAll</code> anything that would previously have been <code>^0.x</code> is now <code>^1.x</code>, and so on. DeBruijn indices can be a bit confusing at first, but the nice thing is that they're kind of 'local' (you can just take parts of an expression and they make sense)</p>



<a name="275170471"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/144729-wg-traits/topic/Chalk%20bugfixing%20and%20getting%20familiar/near/275170471" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Alex Vlasov <a href="https://zulip-archive.rust-lang.org/stream/144729-wg-traits/topic/Chalk.20bugfixing.20and.20getting.20familiar.html#275170471">(Mar 13 2022 at 19:22)</a>:</h4>
<p>I think it's what I've meant. Most likely i've found a problem for the issue I'm investigating, now trying to find out how to fix it</p>



<a name="275170505"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/144729-wg-traits/topic/Chalk%20bugfixing%20and%20getting%20familiar/near/275170505" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Florian Diebold <a href="https://zulip-archive.rust-lang.org/stream/144729-wg-traits/topic/Chalk.20bugfixing.20and.20getting.20familiar.html#275170505">(Mar 13 2022 at 19:23)</a>:</h4>
<p>also, the <code>ForAll&lt;&gt;</code> is basically a noop since it doesn't introduce any new bound variables. The example could also be written <code>for&lt;type, type&gt; WellFormed(^0.0: Combine&lt;^0.1&gt;) :- WellFormed(^0.1: HList), Implemented(^0.0: Combine&lt;^0.1&gt;)</code>, this is probably just an artifact of how the clauses are generated</p>



<hr><p>Last updated: Apr 12 2022 at 20:01 UTC</p>
</html>