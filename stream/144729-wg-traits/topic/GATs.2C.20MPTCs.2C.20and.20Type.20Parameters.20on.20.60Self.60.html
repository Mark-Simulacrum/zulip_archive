<html>
<head><meta charset="utf-8"><title>GATs, MPTCs, and Type Parameters on `Self` · wg-traits · Zulip Chat Archive</title></head>
<h2>Stream: <a href="https://zulip-archive.rust-lang.org/stream/144729-wg-traits/index.html">wg-traits</a></h2>
<h3>Topic: <a href="https://zulip-archive.rust-lang.org/stream/144729-wg-traits/topic/GATs.2C.20MPTCs.2C.20and.20Type.20Parameters.20on.20.60Self.60.html">GATs, MPTCs, and Type Parameters on `Self`</a></h3>

<hr>

<base href="https://rust-lang.zulipchat.com">

<head><link href="https://zulip-archive.rust-lang.org/style.css" rel="stylesheet"></head>

<a name="248920777"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/144729-wg-traits/topic/GATs%2C%20MPTCs%2C%20and%20Type%20Parameters%20on%20%60Self%60/near/248920777" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Zoey <a href="https://zulip-archive.rust-lang.org/stream/144729-wg-traits/topic/GATs.2C.20MPTCs.2C.20and.20Type.20Parameters.20on.20.60Self.60.html#248920777">(Aug 09 2021 at 23:07)</a>:</h4>
<p>I recently attempted to more-accurately define the example of functional categories from <a href="https://www.fpcomplete.com/blog/monads-gats-nightly-rust/">Monads and GATs in nightly Rust (FPComplete / M. Snoyman)</a>; I ended up with a synthetic <code>Id</code> supertrait which maps- via a GAT- the first type parameter to its type constructor.</p>
<p>( See the example code at <a href="https://rust.godbolt.org/z/8eWsqoWPo">https://rust.godbolt.org/z/8eWsqoWPo</a> )</p>
<div class="codehilite" data-code-language="Rust"><pre><span></span><code><span class="k">trait</span><span class="w"> </span><span class="n">Id</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="k">type</span> <span class="nc">New</span><span class="o">&lt;</span><span class="n">Ego</span><span class="o">&gt;</span><span class="p">;</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>
</code></pre></div>
<p>Implementing this trait for each type that will participate in the categories hierarchy allows it to be used in a category definition such as the following excerpt:</p>
<div class="codehilite" data-code-language="Rust"><pre><span></span><code><span class="k">trait</span><span class="w"> </span><span class="n">Functor</span>: <span class="nc">Id</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="k">type</span> <span class="nc">Item</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="k">fn</span> <span class="nf">fmap</span><span class="o">&lt;</span><span class="n">B</span><span class="p">,</span><span class="w"> </span><span class="n">F</span>: <span class="nb">Fn</span><span class="p">(</span><span class="bp">Self</span>::<span class="n">Item</span><span class="p">)</span><span class="w"> </span>-&gt; <span class="nc">B</span><span class="o">&gt;</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="w"> </span><span class="n">f</span>: <span class="nc">F</span><span class="p">)</span><span class="w"> </span>-&gt; <span class="nc">Self</span>::<span class="n">New</span><span class="o">&lt;</span><span class="n">B</span><span class="o">&gt;</span><span class="p">;</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>
</code></pre></div>
<p>Notice that, unlike the GAT implementation on the blog post, a <code>Functor</code> implementation is type-constrained to produce the <em>same</em> <code>Functor</code> implementation for the output of <code>fmap</code>, but this is only true as long as the <code>Id</code> implementation is truthful.</p>
<p>There are three problems with this solution:</p>
<ul>
<li><code>Id</code> can be implemented dishonestly, producing unexpected types, but it  is not auto-implemented, because auto traits do not allow type parameters</li>
<li><code>Id</code> effectively takes the place of an update syntax over <code>Self</code>, whereas <code>Self</code> could hypothetically be made to do this on its own</li>
<li>Only one type parameter is supported- thus forbidding usage of <a href="https://wiki.haskell.org/Multi-parameter_type_class">Multi-parameter Type Classes</a> locking us away from a host of common categories such as contextual monads</li>
</ul>
<p>The reason we need to express this at all, however, is that traits are only describable from a <code>self</code> context; if we could define traits in terms of a global space, such that Self is a type parameter, we could eliminate the need for most of this complexity, enabling the much simpler Haskell syntax. GATs handle the rest by allowing subtypes with type parameters.</p>
<p>In summary, while I recognize this is far too vague for an RFC, I'd suggest we do one of two things:</p>
<ul>
<li>Enable type parameters on <code>Self</code> (but how do we represent the variadic nature of Self types without variadic generics support?)</li>
<li>Allow global-context trait definitions by creating a syntax for a special-case of Self as a type parameter to the trait, such that a single generic parameter can be bound to both the <code>self</code> parameter <em>and</em> others.</li>
</ul>
<p>Thoughts?</p>



<a name="249162580"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/144729-wg-traits/topic/GATs%2C%20MPTCs%2C%20and%20Type%20Parameters%20on%20%60Self%60/near/249162580" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jack Huey <a href="https://zulip-archive.rust-lang.org/stream/144729-wg-traits/topic/GATs.2C.20MPTCs.2C.20and.20Type.20Parameters.20on.20.60Self.60.html#249162580">(Aug 11 2021 at 20:07)</a>:</h4>
<p>Hi <span class="user-mention" data-user-id="398288">@Zoey</span>. Don't have ton of time right now to dig into this, but if you ping towards the end of the week, I can look more at it</p>



<a name="249398701"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/144729-wg-traits/topic/GATs%2C%20MPTCs%2C%20and%20Type%20Parameters%20on%20%60Self%60/near/249398701" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Zoey <a href="https://zulip-archive.rust-lang.org/stream/144729-wg-traits/topic/GATs.2C.20MPTCs.2C.20and.20Type.20Parameters.20on.20.60Self.60.html#249398701">(Aug 13 2021 at 18:53)</a>:</h4>
<p><span class="user-mention" data-user-id="232957">@Jack Huey</span> Hey Jack, pinging you as requested :)</p>



<a name="249399025"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/144729-wg-traits/topic/GATs%2C%20MPTCs%2C%20and%20Type%20Parameters%20on%20%60Self%60/near/249399025" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jack Huey <a href="https://zulip-archive.rust-lang.org/stream/144729-wg-traits/topic/GATs.2C.20MPTCs.2C.20and.20Type.20Parameters.20on.20.60Self.60.html#249399025">(Aug 13 2021 at 18:56)</a>:</h4>
<p><span aria-label="wave" class="emoji emoji-1f44b" role="img" title="wave">:wave:</span></p>



<a name="249404885"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/144729-wg-traits/topic/GATs%2C%20MPTCs%2C%20and%20Type%20Parameters%20on%20%60Self%60/near/249404885" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jack Huey <a href="https://zulip-archive.rust-lang.org/stream/144729-wg-traits/topic/GATs.2C.20MPTCs.2C.20and.20Type.20Parameters.20on.20.60Self.60.html#249404885">(Aug 13 2021 at 19:45)</a>:</h4>
<p>whoops. Was reading this then got pulled away</p>



<a name="249406102"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/144729-wg-traits/topic/GATs%2C%20MPTCs%2C%20and%20Type%20Parameters%20on%20%60Self%60/near/249406102" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jack Huey <a href="https://zulip-archive.rust-lang.org/stream/144729-wg-traits/topic/GATs.2C.20MPTCs.2C.20and.20Type.20Parameters.20on.20.60Self.60.html#249406102">(Aug 13 2021 at 19:57)</a>:</h4>
<p>Okay, so I see what's trying to be accomplished here</p>



<a name="249406402"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/144729-wg-traits/topic/GATs%2C%20MPTCs%2C%20and%20Type%20Parameters%20on%20%60Self%60/near/249406402" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jack Huey <a href="https://zulip-archive.rust-lang.org/stream/144729-wg-traits/topic/GATs.2C.20MPTCs.2C.20and.20Type.20Parameters.20on.20.60Self.60.html#249406402">(Aug 13 2021 at 19:59)</a>:</h4>
<p>So, first question</p>



<a name="249406462"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/144729-wg-traits/topic/GATs%2C%20MPTCs%2C%20and%20Type%20Parameters%20on%20%60Self%60/near/249406462" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jack Huey <a href="https://zulip-archive.rust-lang.org/stream/144729-wg-traits/topic/GATs.2C.20MPTCs.2C.20and.20Type.20Parameters.20on.20.60Self.60.html#249406462">(Aug 13 2021 at 20:00)</a>:</h4>
<p>Why is it necessary to split out <code>Id</code> here?</p>



<a name="249406591"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/144729-wg-traits/topic/GATs%2C%20MPTCs%2C%20and%20Type%20Parameters%20on%20%60Self%60/near/249406591" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Zoey <a href="https://zulip-archive.rust-lang.org/stream/144729-wg-traits/topic/GATs.2C.20MPTCs.2C.20and.20Type.20Parameters.20on.20.60Self.60.html#249406591">(Aug 13 2021 at 20:01)</a>:</h4>
<p>If you don't, there's no way to describe "Self but with one parameter modified"- and, if you don't, I could lie by giving you a <em>different</em> functor implementation in response to the first one (See the Monads and GATs article linked above).</p>



<a name="249406797"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/144729-wg-traits/topic/GATs%2C%20MPTCs%2C%20and%20Type%20Parameters%20on%20%60Self%60/near/249406797" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jack Huey <a href="https://zulip-archive.rust-lang.org/stream/144729-wg-traits/topic/GATs.2C.20MPTCs.2C.20and.20Type.20Parameters.20on.20.60Self.60.html#249406797">(Aug 13 2021 at 20:02)</a>:</h4>
<p>I'm not sure I follow. Why doesn't this work: <a href="https://rust.godbolt.org/z/r55eo8Tsh">https://rust.godbolt.org/z/r55eo8Tsh</a></p>



<a name="249407001"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/144729-wg-traits/topic/GATs%2C%20MPTCs%2C%20and%20Type%20Parameters%20on%20%60Self%60/near/249407001" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Zoey <a href="https://zulip-archive.rust-lang.org/stream/144729-wg-traits/topic/GATs.2C.20MPTCs.2C.20and.20Type.20Parameters.20on.20.60Self.60.html#249407001">(Aug 13 2021 at 20:04)</a>:</h4>
<p>Ah, because of massive redundancy and potential for inconsistancy; <code>Id</code> is simulating a compiler-intrinsic / auto-trait; The way your example works, anyone could "lie" in their impl of Functor, but- aside from that- you couldn't generate a <code>monad</code> instance without redefining New for that, and so on for each subsequent category</p>



<a name="249407617"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/144729-wg-traits/topic/GATs%2C%20MPTCs%2C%20and%20Type%20Parameters%20on%20%60Self%60/near/249407617" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jack Huey <a href="https://zulip-archive.rust-lang.org/stream/144729-wg-traits/topic/GATs.2C.20MPTCs.2C.20and.20Type.20Parameters.20on.20.60Self.60.html#249407617">(Aug 13 2021 at 20:09)</a>:</h4>
<p>So you're basically trying to come up with a design that allows you to create traits that disallow</p>
<div class="codehilite" data-code-language="Rust"><pre><span></span><code><span class="k">impl</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;</span><span class="w"> </span><span class="n">Functor</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="nb">Box</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="k">type</span> <span class="nc">New</span><span class="o">&lt;</span><span class="n">U</span><span class="o">&gt;</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">U</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="k">type</span> <span class="nc">Item</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">T</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="k">fn</span> <span class="nf">fmap</span><span class="o">&lt;</span><span class="n">B</span><span class="p">,</span><span class="w"> </span><span class="n">F</span>: <span class="nb">Fn</span><span class="p">(</span><span class="bp">Self</span>::<span class="n">Item</span><span class="p">)</span><span class="w"> </span>-&gt; <span class="nc">B</span><span class="o">&gt;</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="w"> </span><span class="n">f</span>: <span class="nc">F</span><span class="p">)</span><span class="w"> </span>-&gt; <span class="nc">B</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">        </span><span class="n">f</span><span class="p">(</span><span class="o">*</span><span class="bp">self</span><span class="p">)</span><span class="w"></span>
<span class="w">    </span><span class="p">}</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>
</code></pre></div>



<a name="249407645"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/144729-wg-traits/topic/GATs%2C%20MPTCs%2C%20and%20Type%20Parameters%20on%20%60Self%60/near/249407645" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Zoey <a href="https://zulip-archive.rust-lang.org/stream/144729-wg-traits/topic/GATs.2C.20MPTCs.2C.20and.20Type.20Parameters.20on.20.60Self.60.html#249407645">(Aug 13 2021 at 20:09)</a>:</h4>
<p>I was mulling over it the other night, and realized that if, for a trait <code>T&lt;Y&gt;</code> with implementer  <code>Foo&lt;Bar, Baz&gt; such that Y maps to Baz</code> and <code>Bar</code> is provided by <code>impl&lt;Bar&gt;</code>, if we consider <code>Self</code> in context, it currently equates <code>Self</code> =&gt; <code>Foo&lt;Bar, Y&gt;</code>, right?</p>
<p>If so, what if we give <code>Self</code> optional generic parameters when in trait context, and those parameters are allowed to override the associated types of the Self type in a sort of "update" syntax?</p>
<div class="codehilite" data-code-language="Rust"><pre><span></span><code><span class="k">fn</span> <span class="nf">fmap</span><span class="o">&lt;</span><span class="n">B</span><span class="p">,</span><span class="w"> </span><span class="n">F</span>: <span class="nb">Fn</span><span class="p">(</span><span class="bp">Self</span>::<span class="n">Item</span><span class="p">)</span><span class="w"> </span>-&gt; <span class="nc">B</span><span class="o">&gt;</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="w"> </span><span class="n">f</span>: <span class="nc">F</span><span class="p">)</span><span class="w"> </span>-&gt; <span class="nc">Self</span><span class="o">&lt;</span><span class="n">Item</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">B</span><span class="o">&gt;</span><span class="p">;</span><span class="w"></span>
</code></pre></div>
<p>Any that aren't explicitly mentioned are "filled in" with the ones on the current <code>Self</code></p>



<a name="249407902"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/144729-wg-traits/topic/GATs%2C%20MPTCs%2C%20and%20Type%20Parameters%20on%20%60Self%60/near/249407902" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Zoey <a href="https://zulip-archive.rust-lang.org/stream/144729-wg-traits/topic/GATs.2C.20MPTCs.2C.20and.20Type.20Parameters.20on.20.60Self.60.html#249407902">(Aug 13 2021 at 20:11)</a>:</h4>
<p>As for the example you just gave- that looks more like a catamorphism- B isn't wrapped in a Functor at all?</p>
<p>What I'm trying to prevent with <code>Id</code> is, quoting from the article, a "horrifically non-sensible implementation such as" the following:</p>
<div class="codehilite" data-code-language="Rust"><pre><span></span><code><span class="k">impl</span><span class="o">&lt;</span><span class="n">A</span><span class="o">&gt;</span><span class="w"> </span><span class="n">Functor</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">MyOption</span><span class="o">&lt;</span><span class="n">A</span><span class="o">&gt;</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="k">type</span> <span class="nc">Unwrapped</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">A</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="k">type</span> <span class="nc">Wrapped</span><span class="o">&lt;</span><span class="n">B</span><span class="o">&gt;</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">Result</span><span class="o">&lt;</span><span class="n">B</span><span class="p">,</span><span class="w"> </span><span class="nb">String</span><span class="o">&gt;</span><span class="p">;</span><span class="w"> </span><span class="c1">// wut?</span>

<span class="w">    </span><span class="k">fn</span> <span class="nf">map</span><span class="o">&lt;</span><span class="n">F</span>: <span class="nb">FnMut</span><span class="p">(</span><span class="n">A</span><span class="p">)</span><span class="w"> </span>-&gt; <span class="nc">B</span><span class="p">,</span><span class="w"> </span><span class="n">B</span><span class="o">&gt;</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="w"> </span><span class="k">mut</span><span class="w"> </span><span class="n">f</span>: <span class="nc">F</span><span class="p">)</span><span class="w"> </span>-&gt; <span class="nb">Result</span><span class="o">&lt;</span><span class="n">B</span><span class="p">,</span><span class="w"> </span><span class="nb">String</span><span class="o">&gt;</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">        </span><span class="k">match</span><span class="w"> </span><span class="bp">self</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">            </span><span class="n">MyOption</span>::<span class="nb">Some</span><span class="p">(</span><span class="n">a</span><span class="p">)</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="nb">Ok</span><span class="p">(</span><span class="n">f</span><span class="p">(</span><span class="n">a</span><span class="p">)),</span><span class="w"></span>
<span class="w">            </span><span class="n">MyOption</span>::<span class="nb">None</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="nb">Err</span><span class="p">(</span><span class="s">"Well this is weird, isn't it?"</span><span class="p">.</span><span class="n">to_owned</span><span class="p">()),</span><span class="w"></span>
<span class="w">        </span><span class="p">}</span><span class="w"></span>
<span class="w">    </span><span class="p">}</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>
</code></pre></div>
<p>Such a definition would allow <code>Option::&lt;T&gt;::map</code> to produce a <code>Result&lt;T, ...&gt;</code> or anything else that implements <code>Functor</code>.</p>



<a name="249408252"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/144729-wg-traits/topic/GATs%2C%20MPTCs%2C%20and%20Type%20Parameters%20on%20%60Self%60/near/249408252" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jack Huey <a href="https://zulip-archive.rust-lang.org/stream/144729-wg-traits/topic/GATs.2C.20MPTCs.2C.20and.20Type.20Parameters.20on.20.60Self.60.html#249408252">(Aug 13 2021 at 20:13)</a>:</h4>
<p>the idea is roughly the same</p>



<a name="249408338"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/144729-wg-traits/topic/GATs%2C%20MPTCs%2C%20and%20Type%20Parameters%20on%20%60Self%60/near/249408338" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jack Huey <a href="https://zulip-archive.rust-lang.org/stream/144729-wg-traits/topic/GATs.2C.20MPTCs.2C.20and.20Type.20Parameters.20on.20.60Self.60.html#249408338">(Aug 13 2021 at 20:14)</a>:</h4>
<p>that the type that we return doesn't necessarily have to be <code>Self</code></p>



<a name="249408413"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/144729-wg-traits/topic/GATs%2C%20MPTCs%2C%20and%20Type%20Parameters%20on%20%60Self%60/near/249408413" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jack Huey <a href="https://zulip-archive.rust-lang.org/stream/144729-wg-traits/topic/GATs.2C.20MPTCs.2C.20and.20Type.20Parameters.20on.20.60Self.60.html#249408413">(Aug 13 2021 at 20:15)</a>:</h4>
<p>have to think, but associated types doesn't feel like the right way to approach this</p>



<a name="249408421"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/144729-wg-traits/topic/GATs%2C%20MPTCs%2C%20and%20Type%20Parameters%20on%20%60Self%60/near/249408421" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Zoey <a href="https://zulip-archive.rust-lang.org/stream/144729-wg-traits/topic/GATs.2C.20MPTCs.2C.20and.20Type.20Parameters.20on.20.60Self.60.html#249408421">(Aug 13 2021 at 20:15)</a>:</h4>
<blockquote>
<p>that the type that we return doesn't necessarily have to be Self</p>
</blockquote>
<p>Correct- and if we can define it as "Self in every way <em>except</em> this one", and we can define it at the trait level rather than the implementor level, that would allow enforced correctness and more concise code.</p>



<a name="249408589"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/144729-wg-traits/topic/GATs%2C%20MPTCs%2C%20and%20Type%20Parameters%20on%20%60Self%60/near/249408589" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Zoey <a href="https://zulip-archive.rust-lang.org/stream/144729-wg-traits/topic/GATs.2C.20MPTCs.2C.20and.20Type.20Parameters.20on.20.60Self.60.html#249408589">(Aug 13 2021 at 20:16)</a>:</h4>
<blockquote>
<p>have to think, but associated types doesn't feel like the right way to approach this</p>
</blockquote>
<p>Higher-kinded types would be the most appropriate solution, but - with GATs- this appears to be the most-consistent way to go about encoding category theory and morphisms.</p>
<p>I did mention- in my opening post- that, if we can use <code>Self</code> generically alongside an associated-type-update syntax, we could theoretically do true HKT</p>
<p><code>fn fmap&lt;X, Y, A: Functor&lt;Item = X&gt;, B: A&lt;Item = Y&gt;, F: Fn(X) -&gt; Y&gt;(self: A, f: F) -&gt; B;</code></p>



<a name="249408687"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/144729-wg-traits/topic/GATs%2C%20MPTCs%2C%20and%20Type%20Parameters%20on%20%60Self%60/near/249408687" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jack Huey <a href="https://zulip-archive.rust-lang.org/stream/144729-wg-traits/topic/GATs.2C.20MPTCs.2C.20and.20Type.20Parameters.20on.20.60Self.60.html#249408687">(Aug 13 2021 at 20:17)</a>:</h4>
<p>It's interesting to think about</p>



<a name="249408826"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/144729-wg-traits/topic/GATs%2C%20MPTCs%2C%20and%20Type%20Parameters%20on%20%60Self%60/near/249408826" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jack Huey <a href="https://zulip-archive.rust-lang.org/stream/144729-wg-traits/topic/GATs.2C.20MPTCs.2C.20and.20Type.20Parameters.20on.20.60Self.60.html#249408826">(Aug 13 2021 at 20:18)</a>:</h4>
<p>But I feel like the best approach for this would be start by asking "why would we need this" and "what would this kind of feature allow us to do that existing features (or planned) wouldn't"</p>



<a name="249408962"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/144729-wg-traits/topic/GATs%2C%20MPTCs%2C%20and%20Type%20Parameters%20on%20%60Self%60/near/249408962" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jack Huey <a href="https://zulip-archive.rust-lang.org/stream/144729-wg-traits/topic/GATs.2C.20MPTCs.2C.20and.20Type.20Parameters.20on.20.60Self.60.html#249408962">(Aug 13 2021 at 20:19)</a>:</h4>
<p>Looking above at your "problems with this solution":</p>



<a name="249409048"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/144729-wg-traits/topic/GATs%2C%20MPTCs%2C%20and%20Type%20Parameters%20on%20%60Self%60/near/249409048" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jack Huey <a href="https://zulip-archive.rust-lang.org/stream/144729-wg-traits/topic/GATs.2C.20MPTCs.2C.20and.20Type.20Parameters.20on.20.60Self.60.html#249409048">(Aug 13 2021 at 20:20)</a>:</h4>
<blockquote>
<p>Id effectively takes the place of an update syntax over Self, whereas Self could hypothetically be made to do this on its own</p>
</blockquote>
<p>Not sure that's really a <em>problem</em>, as much as an observation</p>



<a name="249409107"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/144729-wg-traits/topic/GATs%2C%20MPTCs%2C%20and%20Type%20Parameters%20on%20%60Self%60/near/249409107" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Zoey <a href="https://zulip-archive.rust-lang.org/stream/144729-wg-traits/topic/GATs.2C.20MPTCs.2C.20and.20Type.20Parameters.20on.20.60Self.60.html#249409107">(Aug 13 2021 at 20:20)</a>:</h4>
<p>It's a problem because Self can have multiple parameters, and Id::New&lt;T&gt; can't- Id also cannot be trusted, whereas Self can be</p>



<a name="249409168"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/144729-wg-traits/topic/GATs%2C%20MPTCs%2C%20and%20Type%20Parameters%20on%20%60Self%60/near/249409168" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jack Huey <a href="https://zulip-archive.rust-lang.org/stream/144729-wg-traits/topic/GATs.2C.20MPTCs.2C.20and.20Type.20Parameters.20on.20.60Self.60.html#249409168">(Aug 13 2021 at 20:21)</a>:</h4>
<p>I mean, that's your point 3, yeah</p>



<a name="249409227"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/144729-wg-traits/topic/GATs%2C%20MPTCs%2C%20and%20Type%20Parameters%20on%20%60Self%60/near/249409227" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jack Huey <a href="https://zulip-archive.rust-lang.org/stream/144729-wg-traits/topic/GATs.2C.20MPTCs.2C.20and.20Type.20Parameters.20on.20.60Self.60.html#249409227">(Aug 13 2021 at 20:22)</a>:</h4>
<p>but just saying that <code>Id</code> takes the place of a "self update syntax" isn't a problem</p>



<a name="249409328"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/144729-wg-traits/topic/GATs%2C%20MPTCs%2C%20and%20Type%20Parameters%20on%20%60Self%60/near/249409328" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Zoey <a href="https://zulip-archive.rust-lang.org/stream/144729-wg-traits/topic/GATs.2C.20MPTCs.2C.20and.20Type.20Parameters.20on.20.60Self.60.html#249409328">(Aug 13 2021 at 20:22)</a>:</h4>
<p>If <code>Id</code> were a builtin and could do true updates, I'd be fine with that; it feels less elegant, but that's mostly a bikeshed.</p>



<a name="249409330"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/144729-wg-traits/topic/GATs%2C%20MPTCs%2C%20and%20Type%20Parameters%20on%20%60Self%60/near/249409330" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jack Huey <a href="https://zulip-archive.rust-lang.org/stream/144729-wg-traits/topic/GATs.2C.20MPTCs.2C.20and.20Type.20Parameters.20on.20.60Self.60.html#249409330">(Aug 13 2021 at 20:22)</a>:</h4>
<p>As far as <code>Id</code> being implemented dishonestly, this is true</p>



<a name="249409396"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/144729-wg-traits/topic/GATs%2C%20MPTCs%2C%20and%20Type%20Parameters%20on%20%60Self%60/near/249409396" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jack Huey <a href="https://zulip-archive.rust-lang.org/stream/144729-wg-traits/topic/GATs.2C.20MPTCs.2C.20and.20Type.20Parameters.20on.20.60Self.60.html#249409396">(Aug 13 2021 at 20:23)</a>:</h4>
<p>So, how would you expect <code>Functor</code> on a struct with multiple type parameters to look?</p>



<a name="249409727"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/144729-wg-traits/topic/GATs%2C%20MPTCs%2C%20and%20Type%20Parameters%20on%20%60Self%60/near/249409727" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Zoey <a href="https://zulip-archive.rust-lang.org/stream/144729-wg-traits/topic/GATs.2C.20MPTCs.2C.20and.20Type.20Parameters.20on.20.60Self.60.html#249409727">(Aug 13 2021 at 20:25)</a>:</h4>
<blockquote>
<p>So, how would you expect <code>Functor</code> on a struct with multiple type parameters to look?</p>
</blockquote>
<p>It'd be encoded by the trait being unaware of the presence of multiple type parameters, because it's using <code>Self</code> to refer back; Effectively, the other parameter would be hidden.</p>
<p>For categories that require multiple parameters, they'd simply <code>update</code> both of the associated types, instead of just one. The implicit update syntax where it "fills in" the rest to be consistent with the current <code>Self</code> handles the rest.</p>



<a name="249410193"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/144729-wg-traits/topic/GATs%2C%20MPTCs%2C%20and%20Type%20Parameters%20on%20%60Self%60/near/249410193" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jack Huey <a href="https://zulip-archive.rust-lang.org/stream/144729-wg-traits/topic/GATs.2C.20MPTCs.2C.20and.20Type.20Parameters.20on.20.60Self.60.html#249410193">(Aug 13 2021 at 20:29)</a>:</h4>
<p>I mean, what would the equivalent of <code>fmap</code> look like?</p>



<a name="249410420"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/144729-wg-traits/topic/GATs%2C%20MPTCs%2C%20and%20Type%20Parameters%20on%20%60Self%60/near/249410420" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jack Huey <a href="https://zulip-archive.rust-lang.org/stream/144729-wg-traits/topic/GATs.2C.20MPTCs.2C.20and.20Type.20Parameters.20on.20.60Self.60.html#249410420">(Aug 13 2021 at 20:31)</a>:</h4>
<p>i.e. would you expect that <code>fmap</code> to only be able to change one type parameter? Or would you expect it to be able to change <em>all</em> type parameters? Or <em>any</em>?</p>



<a name="249410635"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/144729-wg-traits/topic/GATs%2C%20MPTCs%2C%20and%20Type%20Parameters%20on%20%60Self%60/near/249410635" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jack Huey <a href="https://zulip-archive.rust-lang.org/stream/144729-wg-traits/topic/GATs.2C.20MPTCs.2C.20and.20Type.20Parameters.20on.20.60Self.60.html#249410635">(Aug 13 2021 at 20:33)</a>:</h4>
<p>One (or really, a fixed number), are relatively easy, since you could just make <code>type New&lt;A, B&gt; = MyStruct&lt;Z, Y, A, B&gt;;</code> (on <code>MyStruct&lt;Z, Y, X, W&gt;</code>)</p>



<a name="249410744"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/144729-wg-traits/topic/GATs%2C%20MPTCs%2C%20and%20Type%20Parameters%20on%20%60Self%60/near/249410744" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jack Huey <a href="https://zulip-archive.rust-lang.org/stream/144729-wg-traits/topic/GATs.2C.20MPTCs.2C.20and.20Type.20Parameters.20on.20.60Self.60.html#249410744">(Aug 13 2021 at 20:34)</a>:</h4>
<p><em>all</em> is not doable right now (but you could conceivably imagine that maybe with variadic generics you might be able to get there)</p>



<a name="249410787"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/144729-wg-traits/topic/GATs%2C%20MPTCs%2C%20and%20Type%20Parameters%20on%20%60Self%60/near/249410787" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Zoey <a href="https://zulip-archive.rust-lang.org/stream/144729-wg-traits/topic/GATs.2C.20MPTCs.2C.20and.20Type.20Parameters.20on.20.60Self.60.html#249410787">(Aug 13 2021 at 20:34)</a>:</h4>
<blockquote>
<p>I mean, what would the equivalent of fmap look like?</p>
</blockquote>
<p>With multiple category parameters?</p>
<div class="codehilite" data-code-language="Rust"><pre><span></span><code><span class="k">trait</span><span class="w"> </span><span class="n">Bifunctor</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="k">type</span> <span class="nc">Left</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="k">type</span> <span class="nc">Right</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="k">fn</span> <span class="nf">bimap</span><span class="o">&lt;</span><span class="n">L</span><span class="p">,</span><span class="w"> </span><span class="n">R</span><span class="p">,</span><span class="w"> </span><span class="n">FL</span>: <span class="nb">Fn</span><span class="p">(</span><span class="bp">Self</span>::<span class="n">Left</span><span class="p">)</span><span class="w"> </span>-&gt; <span class="nc">L</span><span class="p">,</span><span class="w"> </span><span class="n">FL</span>: <span class="nb">Fn</span><span class="p">(</span><span class="bp">Self</span>::<span class="n">Right</span><span class="p">)</span><span class="w"> </span>-&gt; <span class="nc">R</span><span class="o">&gt;</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="w"> </span><span class="n">fl</span>: <span class="nc">FL</span><span class="p">,</span><span class="w"> </span><span class="n">fr</span>: <span class="nc">FR</span><span class="p">)</span><span class="w"> </span>-&gt; <span class="nc">Self</span>::<span class="n">New</span><span class="o">&lt;</span><span class="n">Left</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">L</span><span class="p">,</span><span class="w"> </span><span class="n">Right</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">R</span><span class="o">&gt;</span><span class="p">;</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>
</code></pre></div>



<a name="249410889"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/144729-wg-traits/topic/GATs%2C%20MPTCs%2C%20and%20Type%20Parameters%20on%20%60Self%60/near/249410889" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jack Huey <a href="https://zulip-archive.rust-lang.org/stream/144729-wg-traits/topic/GATs.2C.20MPTCs.2C.20and.20Type.20Parameters.20on.20.60Self.60.html#249410889">(Aug 13 2021 at 20:35)</a>:</h4>
<p><em>any</em>, I'm not even sure. You would have to have some way of pick a function (almost like monomorphization) by the type parameter to change</p>



<a name="249411023"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/144729-wg-traits/topic/GATs%2C%20MPTCs%2C%20and%20Type%20Parameters%20on%20%60Self%60/near/249411023" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jack Huey <a href="https://zulip-archive.rust-lang.org/stream/144729-wg-traits/topic/GATs.2C.20MPTCs.2C.20and.20Type.20Parameters.20on.20.60Self.60.html#249411023">(Aug 13 2021 at 20:36)</a>:</h4>
<p><span class="user-mention silent" data-user-id="398288">Zoey</span> <a href="#narrow/stream/144729-wg-traits/topic/GATs.2C.20MPTCs.2C.20and.20Type.20Parameters.20on.20.60Self.60/near/249410787">said</a>:</p>
<blockquote>
<blockquote>
<p>I mean, what would the equivalent of fmap look like?</p>
</blockquote>
<p>With multiple category parameters?</p>
<p><div class="codehilite" data-code-language="Rust"><pre><span></span><code><span class="k">trait</span><span class="w"> </span><span class="n">Bifunctor</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="k">type</span> <span class="nc">Left</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="k">type</span> <span class="nc">Right</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="k">fn</span> <span class="nf">bimap</span><span class="o">&lt;</span><span class="n">L</span><span class="p">,</span><span class="w"> </span><span class="n">R</span><span class="p">,</span><span class="w"> </span><span class="n">FL</span>: <span class="nb">Fn</span><span class="p">(</span><span class="bp">Self</span>::<span class="n">Left</span><span class="p">)</span><span class="w"> </span>-&gt; <span class="nc">L</span><span class="p">,</span><span class="w"> </span><span class="n">FL</span>: <span class="nb">Fn</span><span class="p">(</span><span class="bp">Self</span>::<span class="n">Right</span><span class="p">)</span><span class="w"> </span>-&gt; <span class="nc">R</span><span class="o">&gt;</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="w"> </span><span class="n">fl</span>: <span class="nc">FL</span><span class="p">,</span><span class="w"> </span><span class="n">fr</span>: <span class="nc">FR</span><span class="p">)</span><span class="w"> </span>-&gt; <span class="nc">Self</span>::<span class="n">New</span><span class="o">&lt;</span><span class="n">Left</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">L</span><span class="p">,</span><span class="w"> </span><span class="n">Right</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">R</span><span class="o">&gt;</span><span class="p">;</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>
</code></pre></div><br>
</p>
</blockquote>
<p>Right, so this doesn't work with <code>Id</code>, but it would work with the code I gave</p>



<a name="249411234"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/144729-wg-traits/topic/GATs%2C%20MPTCs%2C%20and%20Type%20Parameters%20on%20%60Self%60/near/249411234" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Zoey <a href="https://zulip-archive.rust-lang.org/stream/144729-wg-traits/topic/GATs.2C.20MPTCs.2C.20and.20Type.20Parameters.20on.20.60Self.60.html#249411234">(Aug 13 2021 at 20:38)</a>:</h4>
<p>I think considering supertraits may help; A category could be defined that requires membership with Functor but returns a new functor of a separate content type- for example, the <code>Bind</code> operation from Monad; We'd need to redefine New for each typeclass, and be unable to represent it without variadics.</p>



<a name="249411419"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/144729-wg-traits/topic/GATs%2C%20MPTCs%2C%20and%20Type%20Parameters%20on%20%60Self%60/near/249411419" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jack Huey <a href="https://zulip-archive.rust-lang.org/stream/144729-wg-traits/topic/GATs.2C.20MPTCs.2C.20and.20Type.20Parameters.20on.20.60Self.60.html#249411419">(Aug 13 2021 at 20:40)</a>:</h4>
<p>The fundamental problem here is just that traits don't know about an implementer's parameters. And, as such, it can't "name"</p>



<a name="249411505"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/144729-wg-traits/topic/GATs%2C%20MPTCs%2C%20and%20Type%20Parameters%20on%20%60Self%60/near/249411505" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Zoey <a href="https://zulip-archive.rust-lang.org/stream/144729-wg-traits/topic/GATs.2C.20MPTCs.2C.20and.20Type.20Parameters.20on.20.60Self.60.html#249411505">(Aug 13 2021 at 20:40)</a>:</h4>
<p>Ah, right! I see where the problem could be from your read:</p>
<p>Okay, so the other thing about the <code>Self-update</code> syntax is that it doesn't care about the implementor- it can <em>only</em> update associated types from <em>itself</em> or its supertraits.</p>
<p>(Incidentally, "Self-update syntax" sounds like a reasonable name for an RFC or feature gate)</p>



<a name="249411590"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/144729-wg-traits/topic/GATs%2C%20MPTCs%2C%20and%20Type%20Parameters%20on%20%60Self%60/near/249411590" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jack Huey <a href="https://zulip-archive.rust-lang.org/stream/144729-wg-traits/topic/GATs.2C.20MPTCs.2C.20and.20Type.20Parameters.20on.20.60Self.60.html#249411590">(Aug 13 2021 at 20:41)</a>:</h4>
<p>Like, I guess what would you expect <code>Self&lt;U&gt;</code> to be inside of a trait? You do briefly state this. For <code>Box&lt;T&gt;</code>, it's probably <code>Box&lt;U&gt;</code>, but for you <code>MyStruct&lt;X, Y&gt;</code>, is it <code>MyStruct&lt;U, Y&gt;</code> or <code>MyStruct&lt;X, U&gt;</code></p>



<a name="249411843"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/144729-wg-traits/topic/GATs%2C%20MPTCs%2C%20and%20Type%20Parameters%20on%20%60Self%60/near/249411843" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jack Huey <a href="https://zulip-archive.rust-lang.org/stream/144729-wg-traits/topic/GATs.2C.20MPTCs.2C.20and.20Type.20Parameters.20on.20.60Self.60.html#249411843">(Aug 13 2021 at 20:43)</a>:</h4>
<p>To do this ("properly", I guess), we need some way to encode in a trait the idea that "an implementor must have a type parameter <code>T</code>", and then that <code>T</code> can be used</p>



<a name="249411905"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/144729-wg-traits/topic/GATs%2C%20MPTCs%2C%20and%20Type%20Parameters%20on%20%60Self%60/near/249411905" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jack Huey <a href="https://zulip-archive.rust-lang.org/stream/144729-wg-traits/topic/GATs.2C.20MPTCs.2C.20and.20Type.20Parameters.20on.20.60Self.60.html#249411905">(Aug 13 2021 at 20:44)</a>:</h4>
<p>Pseudo-syntax: <code>trait Foo: Self&lt;T&gt;</code></p>



<a name="249411994"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/144729-wg-traits/topic/GATs%2C%20MPTCs%2C%20and%20Type%20Parameters%20on%20%60Self%60/near/249411994" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Zoey <a href="https://zulip-archive.rust-lang.org/stream/144729-wg-traits/topic/GATs.2C.20MPTCs.2C.20and.20Type.20Parameters.20on.20.60Self.60.html#249411994">(Aug 13 2021 at 20:44)</a>:</h4>
<p><span class="user-mention silent" data-user-id="232957">Jack Huey</span> <a href="#narrow/stream/144729-wg-traits/topic/GATs.2C.20MPTCs.2C.20and.20Type.20Parameters.20on.20.60Self.60/near/249411843">said</a>:</p>
<blockquote>
<p>To do this ("properly", I guess), we need some way to encode in a trait the idea that "an implementor must have a type parameter <code>T</code>", and then that <code>T</code> can be used</p>
</blockquote>
<p>nonono, this is way too powerful and far more than I'm asking for- let me restrict it so we aren't talking about something universal in extent</p>
<p>The implementor is irrelevant, with regards to the request; I'm going to write up a scoped-down solution.</p>



<a name="249412060"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/144729-wg-traits/topic/GATs%2C%20MPTCs%2C%20and%20Type%20Parameters%20on%20%60Self%60/near/249412060" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jack Huey <a href="https://zulip-archive.rust-lang.org/stream/144729-wg-traits/topic/GATs.2C.20MPTCs.2C.20and.20Type.20Parameters.20on.20.60Self.60.html#249412060">(Aug 13 2021 at 20:45)</a>:</h4>
<p>Then <code>fn map&lt;U, F: Fn(T) -&gt; U&gt;(self, f: F) -&gt; Self&lt;U&gt;</code></p>



<a name="249412457"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/144729-wg-traits/topic/GATs%2C%20MPTCs%2C%20and%20Type%20Parameters%20on%20%60Self%60/near/249412457" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jack Huey <a href="https://zulip-archive.rust-lang.org/stream/144729-wg-traits/topic/GATs.2C.20MPTCs.2C.20and.20Type.20Parameters.20on.20.60Self.60.html#249412457">(Aug 13 2021 at 20:48)</a>:</h4>
<p><span class="user-mention silent" data-user-id="232957">Jack Huey</span> <a href="#narrow/stream/144729-wg-traits/topic/GATs.2C.20MPTCs.2C.20and.20Type.20Parameters.20on.20.60Self.60/near/249411905">said</a>:</p>
<blockquote>
<p>Pseudo-syntax: <code>trait Foo: Self&lt;T&gt;</code></p>
</blockquote>
<p>unsure what an impl would look like though...</p>



<a name="249412530"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/144729-wg-traits/topic/GATs%2C%20MPTCs%2C%20and%20Type%20Parameters%20on%20%60Self%60/near/249412530" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Zoey <a href="https://zulip-archive.rust-lang.org/stream/144729-wg-traits/topic/GATs.2C.20MPTCs.2C.20and.20Type.20Parameters.20on.20.60Self.60.html#249412530">(Aug 13 2021 at 20:49)</a>:</h4>
<blockquote>
<p>unsure what an impl would look like though...</p>
</blockquote>
<p>I'm writing a formalization as fast as I can- I think we lost coherence and diverged at some point</p>



<a name="249412670"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/144729-wg-traits/topic/GATs%2C%20MPTCs%2C%20and%20Type%20Parameters%20on%20%60Self%60/near/249412670" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jack Huey <a href="https://zulip-archive.rust-lang.org/stream/144729-wg-traits/topic/GATs.2C.20MPTCs.2C.20and.20Type.20Parameters.20on.20.60Self.60.html#249412670">(Aug 13 2021 at 20:50)</a>:</h4>
<p>I think I'm following</p>



<a name="249412920"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/144729-wg-traits/topic/GATs%2C%20MPTCs%2C%20and%20Type%20Parameters%20on%20%60Self%60/near/249412920" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Zoey <a href="https://zulip-archive.rust-lang.org/stream/144729-wg-traits/topic/GATs.2C.20MPTCs.2C.20and.20Type.20Parameters.20on.20.60Self.60.html#249412920">(Aug 13 2021 at 20:53)</a>:</h4>
<p>To formalize and restrict so it's not so hard to work with:</p>
<p><code>Self</code>-update syntax allows traits to refer to <code>Self</code> with changes to a subset of associated types such that all associated types which are not explicitly mentioned remain equivalent. <br>
When in a trait <code>T</code>, <code>Self</code> is equivalent to <code>Self&lt;&gt;</code>; <br>
When in a trait <code>T</code> with AssocType <code>Y</code>, <code>Self</code> is equivalent to <code>Self&lt;&gt;</code>, <code>Self&lt;Y = Self::Y&gt;</code>;<br>
When in a trait <code>T</code> with AssocTypes <code>Y</code>, <code>Z</code>, <code>Self</code> is equivalent to <code>Self&lt;&gt;</code>, <code>Self&lt;Y = Self::Y&gt;</code>, <code>Self&lt;Z = Self::Z&gt;</code>, <code>Self&lt;Y = Self::Y, Z = Self::Z&gt;</code></p>
<p>For traits with supertraits, associated types on those supertraits can be referenced as if they were associated types in <code>Self</code>, but (until we come up with a syntax for it and solve any other problems therein) you can only update one associated types from one supertrait at a time:</p>
<p>When in a trait Foo: Bar where Foo has associated type X and Bar has associated type Y:<br>
<code>Self&lt;X = Self::X&gt;</code> ≈ <code>Self</code><br>
<code>&lt;Self as Bar&gt;::&lt;Y = Self::Y&gt;</code> ≈ <code>Self</code><br>
Updates can be performed to the supertrait by using <code>&lt;Self as SuperTrait&gt;::&lt;...&gt;</code> syntax, but - as you cannot <code>as</code>-cast for multiple types in the same expression, and we lack intersection types, we restrict to updating one supertrait or the current trait itself at a time.</p>



<a name="249413094"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/144729-wg-traits/topic/GATs%2C%20MPTCs%2C%20and%20Type%20Parameters%20on%20%60Self%60/near/249413094" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jack Huey <a href="https://zulip-archive.rust-lang.org/stream/144729-wg-traits/topic/GATs.2C.20MPTCs.2C.20and.20Type.20Parameters.20on.20.60Self.60.html#249413094">(Aug 13 2021 at 20:55)</a>:</h4>
<p>I got lost/sidetracked after the first paragraph</p>



<a name="249413117"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/144729-wg-traits/topic/GATs%2C%20MPTCs%2C%20and%20Type%20Parameters%20on%20%60Self%60/near/249413117" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jack Huey <a href="https://zulip-archive.rust-lang.org/stream/144729-wg-traits/topic/GATs.2C.20MPTCs.2C.20and.20Type.20Parameters.20on.20.60Self.60.html#249413117">(Aug 13 2021 at 20:55)</a>:</h4>
<p>But I feel like this is possible doable</p>



<a name="249413151"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/144729-wg-traits/topic/GATs%2C%20MPTCs%2C%20and%20Type%20Parameters%20on%20%60Self%60/near/249413151" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Zoey <a href="https://zulip-archive.rust-lang.org/stream/144729-wg-traits/topic/GATs.2C.20MPTCs.2C.20and.20Type.20Parameters.20on.20.60Self.60.html#249413151">(Aug 13 2021 at 20:56)</a>:</h4>
<p>Where precisely did you get lost? I can refine it</p>



<a name="249413313"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/144729-wg-traits/topic/GATs%2C%20MPTCs%2C%20and%20Type%20Parameters%20on%20%60Self%60/near/249413313" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jack Huey <a href="https://zulip-archive.rust-lang.org/stream/144729-wg-traits/topic/GATs.2C.20MPTCs.2C.20and.20Type.20Parameters.20on.20.60Self.60.html#249413313">(Aug 13 2021 at 20:57)</a>:</h4>
<p>Reminds me of the "struct update" syntax being extended to allowing</p>
<div class="codehilite" data-code-language="Rust"><pre><span></span><code><span class="kd">let</span><span class="w"> </span><span class="n">x</span>: <span class="nc">Struct</span><span class="o">&lt;</span><span class="n">U</span><span class="o">&gt;</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Struct</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">  </span><span class="n">other</span><span class="p">,</span><span class="w"></span>
<span class="w">  </span><span class="n">p</span>: <span class="nc">u</span><span class="p">,</span><span class="w"></span>
<span class="p">};</span><span class="w"></span>
<span class="kd">let</span><span class="w"> </span><span class="n">y</span>: <span class="nc">Struct</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Struct</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">  </span><span class="n">p</span>: <span class="nc">t</span><span class="p">,</span><span class="w"></span>
<span class="w">  </span><span class="o">..</span><span class="n">x</span><span class="p">,</span><span class="w"></span>
<span class="p">};</span><span class="w"></span>
</code></pre></div>



<a name="249413440"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/144729-wg-traits/topic/GATs%2C%20MPTCs%2C%20and%20Type%20Parameters%20on%20%60Self%60/near/249413440" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jack Huey <a href="https://zulip-archive.rust-lang.org/stream/144729-wg-traits/topic/GATs.2C.20MPTCs.2C.20and.20Type.20Parameters.20on.20.60Self.60.html#249413440">(Aug 13 2021 at 20:58)</a>:</h4>
<p>/me goes to find that PR</p>



<a name="249413532"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/144729-wg-traits/topic/GATs%2C%20MPTCs%2C%20and%20Type%20Parameters%20on%20%60Self%60/near/249413532" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jack Huey <a href="https://zulip-archive.rust-lang.org/stream/144729-wg-traits/topic/GATs.2C.20MPTCs.2C.20and.20Type.20Parameters.20on.20.60Self.60.html#249413532">(Aug 13 2021 at 20:59)</a>:</h4>
<p><a href="https://github.com/rust-lang/rust/issues/86555">https://github.com/rust-lang/rust/issues/86555</a></p>



<a name="249413606"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/144729-wg-traits/topic/GATs%2C%20MPTCs%2C%20and%20Type%20Parameters%20on%20%60Self%60/near/249413606" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Zoey <a href="https://zulip-archive.rust-lang.org/stream/144729-wg-traits/topic/GATs.2C.20MPTCs.2C.20and.20Type.20Parameters.20on.20.60Self.60.html#249413606">(Aug 13 2021 at 21:00)</a>:</h4>
<p>I've wanted that for a while- This is similar but potentially much more powerful in what it can accomplish for the ecosystem. It may also allow us to avoid <code>specialization</code> while gaining massive performance benefits in generic code.</p>



<a name="249413753"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/144729-wg-traits/topic/GATs%2C%20MPTCs%2C%20and%20Type%20Parameters%20on%20%60Self%60/near/249413753" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jack Huey <a href="https://zulip-archive.rust-lang.org/stream/144729-wg-traits/topic/GATs.2C.20MPTCs.2C.20and.20Type.20Parameters.20on.20.60Self.60.html#249413753">(Aug 13 2021 at 21:00)</a>:</h4>
<p><span class="user-mention silent" data-user-id="232957">Jack Huey</span> <a href="#narrow/stream/144729-wg-traits/topic/GATs.2C.20MPTCs.2C.20and.20Type.20Parameters.20on.20.60Self.60/near/249411843">said</a>:</p>
<blockquote>
<p>To do this ("properly", I guess), we need some way to encode in a trait the idea that "an implementor must have a type parameter <code>T</code>", and then that <code>T</code> can be used</p>
</blockquote>
<p>now that I think about it...this is <em>nearly</em> an associated type</p>



<a name="249413797"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/144729-wg-traits/topic/GATs%2C%20MPTCs%2C%20and%20Type%20Parameters%20on%20%60Self%60/near/249413797" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Zoey <a href="https://zulip-archive.rust-lang.org/stream/144729-wg-traits/topic/GATs.2C.20MPTCs.2C.20and.20Type.20Parameters.20on.20.60Self.60.html#249413797">(Aug 13 2021 at 21:01)</a>:</h4>
<p>Exactly! That's why we skip caring about the implementer and stick to the trait level</p>



<a name="249413938"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/144729-wg-traits/topic/GATs%2C%20MPTCs%2C%20and%20Type%20Parameters%20on%20%60Self%60/near/249413938" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Zoey <a href="https://zulip-archive.rust-lang.org/stream/144729-wg-traits/topic/GATs.2C.20MPTCs.2C.20and.20Type.20Parameters.20on.20.60Self.60.html#249413938">(Aug 13 2021 at 21:02)</a>:</h4>
<p>So far as I can currently tell, we could actually do this all as a not-quite-sugar-but-close, but it would probably be better done at a higher level.</p>



<a name="249414239"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/144729-wg-traits/topic/GATs%2C%20MPTCs%2C%20and%20Type%20Parameters%20on%20%60Self%60/near/249414239" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jack Huey <a href="https://zulip-archive.rust-lang.org/stream/144729-wg-traits/topic/GATs.2C.20MPTCs.2C.20and.20Type.20Parameters.20on.20.60Self.60.html#249414239">(Aug 13 2021 at 21:04)</a>:</h4>
<p>Interestingly, in the case, using a "self-update syntax" like that forbids using the associated type as any <em>other</em> than a parameter</p>
<div class="codehilite" data-code-language="Rust"><pre><span></span><code><span class="k">trait</span><span class="w"> </span><span class="n">Functor</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">  </span><span class="k">type</span> <span class="nc">Item</span><span class="p">;</span><span class="w"></span>
<span class="w">  </span><span class="k">fn</span> <span class="nf">map</span><span class="o">&lt;</span><span class="n">U</span><span class="p">,</span><span class="w"> </span><span class="n">F</span>: <span class="nb">Fn</span><span class="p">(</span><span class="bp">Self</span>::<span class="n">Item</span><span class="p">)</span><span class="w"> </span>-&gt; <span class="nc">U</span><span class="o">&gt;</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="w"> </span><span class="n">f</span>: <span class="nc">F</span><span class="p">)</span><span class="w"> </span>-&gt; <span class="nc">Self</span><span class="o">&lt;</span><span class="n">Item</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">U</span><span class="o">&gt;</span><span class="p">;</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="k">struct</span> <span class="nc">BadOption</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;</span><span class="p">(</span><span class="n">T</span><span class="p">);</span><span class="w"></span>

<span class="k">impl</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;</span><span class="w"> </span><span class="n">Functor</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">BadOption</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">  </span><span class="k">type</span> <span class="nc">Item</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">();</span><span class="w"></span>
<span class="w">  </span><span class="k">fn</span> <span class="nf">map</span><span class="o">&lt;</span><span class="n">U</span><span class="p">,</span><span class="w"> </span><span class="n">F</span>: <span class="nb">Fn</span><span class="p">(</span><span class="bp">Self</span>::<span class="n">Item</span><span class="p">)</span><span class="w"> </span>-&gt; <span class="nc">U</span><span class="o">&gt;</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="w"> </span><span class="n">f</span>: <span class="nc">F</span><span class="p">)</span><span class="w"> </span>-&gt; <span class="nc">BadOption</span><span class="o">&lt;</span><span class="n">U</span><span class="o">&gt;</span><span class="w"> </span><span class="p">{}</span><span class="w"> </span><span class="c1">// Problem! `U != ()`</span>
<span class="p">}</span><span class="w"></span>
</code></pre></div>



<a name="249414468"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/144729-wg-traits/topic/GATs%2C%20MPTCs%2C%20and%20Type%20Parameters%20on%20%60Self%60/near/249414468" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jack Huey <a href="https://zulip-archive.rust-lang.org/stream/144729-wg-traits/topic/GATs.2C.20MPTCs.2C.20and.20Type.20Parameters.20on.20.60Self.60.html#249414468">(Aug 13 2021 at 21:06)</a>:</h4>
<p>also prevents</p>
<div class="codehilite" data-code-language="Rust"><pre><span></span><code><span class="k">impl</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;</span><span class="w"> </span><span class="n">Functor</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">BadOption</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">  </span><span class="k">type</span> <span class="nc">Item</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">Option</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;</span><span class="p">;</span><span class="w"></span>
<span class="w">  </span><span class="k">fn</span> <span class="nf">map</span><span class="o">&lt;</span><span class="n">U</span><span class="p">,</span><span class="w"> </span><span class="n">F</span>: <span class="nb">Fn</span><span class="p">(</span><span class="bp">Self</span>::<span class="n">Item</span><span class="p">)</span><span class="w"> </span>-&gt; <span class="nc">U</span><span class="o">&gt;</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="w"> </span><span class="n">f</span>: <span class="nc">F</span><span class="p">)</span><span class="w"> </span>-&gt; <span class="nc">BadOption</span><span class="o">&lt;</span><span class="n">U</span><span class="o">&gt;</span><span class="w"> </span><span class="p">{}</span><span class="w"> </span><span class="c1">// Problem! `U != Option&lt;T&gt;`</span>
<span class="p">}</span><span class="w"></span>
</code></pre></div>



<a name="249414778"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/144729-wg-traits/topic/GATs%2C%20MPTCs%2C%20and%20Type%20Parameters%20on%20%60Self%60/near/249414778" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Zoey <a href="https://zulip-archive.rust-lang.org/stream/144729-wg-traits/topic/GATs.2C.20MPTCs.2C.20and.20Type.20Parameters.20on.20.60Self.60.html#249414778">(Aug 13 2021 at 21:09)</a>:</h4>
<p>Interesting- Item should be referring to <code>T</code> directly here, I think, but yeah- that's pretty much the point :)</p>
<p>It doesn't enforce <code>laws</code> in the category theory sense, but it does prevent "illegal" abstractions such as those which care too much about the details.</p>
<p>I'll note that I had to add a clause at the end of <a href="#narrow/stream/144729-wg-traits/topic/GATs.2C.20MPTCs.2C.20and.20Type.20Parameters.20on.20.60Self.60/near/249412920">the above formalization</a> which constrains the updated Self type to not refer to <code>Functor with updates</code> but <em>literally the implementing type</em> but with the new associations.</p>
<p><code>Self</code> already does this, but it helps to clarify why this is not an equivalent ask to simply saying <code>Self&lt;T = ...&gt;</code> somehow equates to <code>Functor&lt;T = ...&gt;</code>, which would allow <code>Option</code> to return <code>Result</code> etc again.</p>



<a name="249415804"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/144729-wg-traits/topic/GATs%2C%20MPTCs%2C%20and%20Type%20Parameters%20on%20%60Self%60/near/249415804" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jack Huey <a href="https://zulip-archive.rust-lang.org/stream/144729-wg-traits/topic/GATs.2C.20MPTCs.2C.20and.20Type.20Parameters.20on.20.60Self.60.html#249415804">(Aug 13 2021 at 21:18)</a>:</h4>
<blockquote>
<p>I'll note that I had to add a clause at the end</p>
</blockquote>
<p>That makes sense. Otherwise, I would expect some <code>U: Functor&lt;Item = B&gt;</code> where <code>U</code> is returned</p>



<a name="249415897"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/144729-wg-traits/topic/GATs%2C%20MPTCs%2C%20and%20Type%20Parameters%20on%20%60Self%60/near/249415897" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Zoey <a href="https://zulip-archive.rust-lang.org/stream/144729-wg-traits/topic/GATs.2C.20MPTCs.2C.20and.20Type.20Parameters.20on.20.60Self.60.html#249415897">(Aug 13 2021 at 21:19)</a>:</h4>
<p>Yeah, I think it's important for Self to remain conceptually-consistent with its current meaning, and that clause ensures that we don't surprise people.</p>
<p>I think I'm starting to see an actual possibility for an RFC taking shape here... I'm not sure where to begin with actually writing one, but I could learn. Would you agree that this seems doable and simple enough to be desirable?</p>



<a name="249415968"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/144729-wg-traits/topic/GATs%2C%20MPTCs%2C%20and%20Type%20Parameters%20on%20%60Self%60/near/249415968" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jack Huey <a href="https://zulip-archive.rust-lang.org/stream/144729-wg-traits/topic/GATs.2C.20MPTCs.2C.20and.20Type.20Parameters.20on.20.60Self.60.html#249415968">(Aug 13 2021 at 21:20)</a>:</h4>
<p>Interestingly, when you can write <code>where T::Item == Foo</code>, I would if you could write <code>where Self::Item == Foo</code></p>



<a name="249416028"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/144729-wg-traits/topic/GATs%2C%20MPTCs%2C%20and%20Type%20Parameters%20on%20%60Self%60/near/249416028" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Zoey <a href="https://zulip-archive.rust-lang.org/stream/144729-wg-traits/topic/GATs.2C.20MPTCs.2C.20and.20Type.20Parameters.20on.20.60Self.60.html#249416028">(Aug 13 2021 at 21:21)</a>:</h4>
<p>Isn't that currently possible already?</p>



<a name="249416062"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/144729-wg-traits/topic/GATs%2C%20MPTCs%2C%20and%20Type%20Parameters%20on%20%60Self%60/near/249416062" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jack Huey <a href="https://zulip-archive.rust-lang.org/stream/144729-wg-traits/topic/GATs.2C.20MPTCs.2C.20and.20Type.20Parameters.20on.20.60Self.60.html#249416062">(Aug 13 2021 at 21:21)</a>:</h4>
<p>This seems doable and simple enough to be desirable, given that it solves a class of problems not currently solvable.</p>



<a name="249416065"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/144729-wg-traits/topic/GATs%2C%20MPTCs%2C%20and%20Type%20Parameters%20on%20%60Self%60/near/249416065" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jack Huey <a href="https://zulip-archive.rust-lang.org/stream/144729-wg-traits/topic/GATs.2C.20MPTCs.2C.20and.20Type.20Parameters.20on.20.60Self.60.html#249416065">(Aug 13 2021 at 21:21)</a>:</h4>
<p>Nope</p>



<a name="249416120"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/144729-wg-traits/topic/GATs%2C%20MPTCs%2C%20and%20Type%20Parameters%20on%20%60Self%60/near/249416120" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Zoey <a href="https://zulip-archive.rust-lang.org/stream/144729-wg-traits/topic/GATs.2C.20MPTCs.2C.20and.20Type.20Parameters.20on.20.60Self.60.html#249416120">(Aug 13 2021 at 21:22)</a>:</h4>
<p>Can you give an example of using that last bit you suggested, and how it differs from what I proposed?</p>



<a name="249416174"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/144729-wg-traits/topic/GATs%2C%20MPTCs%2C%20and%20Type%20Parameters%20on%20%60Self%60/near/249416174" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Zoey <a href="https://zulip-archive.rust-lang.org/stream/144729-wg-traits/topic/GATs.2C.20MPTCs.2C.20and.20Type.20Parameters.20on.20.60Self.60.html#249416174">(Aug 13 2021 at 21:23)</a>:</h4>
<p><span class="user-mention silent" data-user-id="232957">Jack Huey</span> <a href="#narrow/stream/144729-wg-traits/topic/GATs.2C.20MPTCs.2C.20and.20Type.20Parameters.20on.20.60Self.60/near/249416062">said</a>:</p>
<blockquote>
<p>This seems doable and simple enough to be desirable, given that it solves a class of problems not currently solvable.</p>
</blockquote>
<p>I've been looking at building a category hierarchy based on the <code>Id</code> GAT but I'd be willing to switch my efforts to this if I'd have your support and advice.</p>



<a name="249416288"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/144729-wg-traits/topic/GATs%2C%20MPTCs%2C%20and%20Type%20Parameters%20on%20%60Self%60/near/249416288" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jack Huey <a href="https://zulip-archive.rust-lang.org/stream/144729-wg-traits/topic/GATs.2C.20MPTCs.2C.20and.20Type.20Parameters.20on.20.60Self.60.html#249416288">(Aug 13 2021 at 21:24)</a>:</h4>
<p>See <a href="https://github.com/rust-lang/rust/issues/87471">#87471</a> though</p>



<a name="249416363"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/144729-wg-traits/topic/GATs%2C%20MPTCs%2C%20and%20Type%20Parameters%20on%20%60Self%60/near/249416363" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jack Huey <a href="https://zulip-archive.rust-lang.org/stream/144729-wg-traits/topic/GATs.2C.20MPTCs.2C.20and.20Type.20Parameters.20on.20.60Self.60.html#249416363">(Aug 13 2021 at 21:25)</a>:</h4>
<p>I'm pretty strapped for time, but given that there's general support from the lang team, I wouldn't mind mentoring (or attempting to; not even sure where I'd begin)</p>



<a name="249416527"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/144729-wg-traits/topic/GATs%2C%20MPTCs%2C%20and%20Type%20Parameters%20on%20%60Self%60/near/249416527" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Zoey <a href="https://zulip-archive.rust-lang.org/stream/144729-wg-traits/topic/GATs.2C.20MPTCs.2C.20and.20Type.20Parameters.20on.20.60Self.60.html#249416527">(Aug 13 2021 at 21:26)</a>:</h4>
<p><span class="user-mention silent" data-user-id="232957">Jack Huey</span> <a href="#narrow/stream/144729-wg-traits/topic/GATs.2C.20MPTCs.2C.20and.20Type.20Parameters.20on.20.60Self.60/near/249416288">said</a>:</p>
<blockquote>
<p>See <a href="https://github.com/rust-lang/rust/issues/87471">#87471</a> though</p>
</blockquote>
<p>I'm not sure this is required to implement the feature I described- and seems to be orthogonal; such a feature could potentially add some work around where we substitute symbolically but I don't see anything that would block either RFC.</p>



<a name="249416551"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/144729-wg-traits/topic/GATs%2C%20MPTCs%2C%20and%20Type%20Parameters%20on%20%60Self%60/near/249416551" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jack Huey <a href="https://zulip-archive.rust-lang.org/stream/144729-wg-traits/topic/GATs.2C.20MPTCs.2C.20and.20Type.20Parameters.20on.20.60Self.60.html#249416551">(Aug 13 2021 at 21:27)</a>:</h4>
<p>You're correct. Completely orthogonal and just a thought</p>



<a name="249416903"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/144729-wg-traits/topic/GATs%2C%20MPTCs%2C%20and%20Type%20Parameters%20on%20%60Self%60/near/249416903" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jack Huey <a href="https://zulip-archive.rust-lang.org/stream/144729-wg-traits/topic/GATs.2C.20MPTCs.2C.20and.20Type.20Parameters.20on.20.60Self.60.html#249416903">(Aug 13 2021 at 21:31)</a>:</h4>
<p>If you're serious about pursuing this, I would start by outlining<br>
1) What is a problem/class of problems that existing/planned features can't solve.<br>
2) What is the general syntax/feature that you're proposing.<br>
3) How the feature can solve those problem(s).</p>
<p>And probably open a lang-team MCP. I'm really not quite sure if they want to start another initiative, but like I said, if there's support, I'm willing to be a liaison.</p>



<a name="249417115"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/144729-wg-traits/topic/GATs%2C%20MPTCs%2C%20and%20Type%20Parameters%20on%20%60Self%60/near/249417115" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Zoey <a href="https://zulip-archive.rust-lang.org/stream/144729-wg-traits/topic/GATs.2C.20MPTCs.2C.20and.20Type.20Parameters.20on.20.60Self.60.html#249417115">(Aug 13 2021 at 21:33)</a>:</h4>
<p>Hm- reading the guide for MCPs, it looks like it describes a "lightweight RFC" for "non-user-facing" changes. Wouldn't a full RFC be more appropriate?</p>



<a name="249417345"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/144729-wg-traits/topic/GATs%2C%20MPTCs%2C%20and%20Type%20Parameters%20on%20%60Self%60/near/249417345" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jack Huey <a href="https://zulip-archive.rust-lang.org/stream/144729-wg-traits/topic/GATs.2C.20MPTCs.2C.20and.20Type.20Parameters.20on.20.60Self.60.html#249417345">(Aug 13 2021 at 21:36)</a>:</h4>
<p>Maybe it's just called a "proposal" now</p>



<a name="249417346"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/144729-wg-traits/topic/GATs%2C%20MPTCs%2C%20and%20Type%20Parameters%20on%20%60Self%60/near/249417346" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jack Huey <a href="https://zulip-archive.rust-lang.org/stream/144729-wg-traits/topic/GATs.2C.20MPTCs.2C.20and.20Type.20Parameters.20on.20.60Self.60.html#249417346">(Aug 13 2021 at 21:36)</a>:</h4>
<p><a href="https://lang-team.rust-lang.org/initiatives/process.html">https://lang-team.rust-lang.org/initiatives/process.html</a></p>



<a name="249417403"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/144729-wg-traits/topic/GATs%2C%20MPTCs%2C%20and%20Type%20Parameters%20on%20%60Self%60/near/249417403" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jack Huey <a href="https://zulip-archive.rust-lang.org/stream/144729-wg-traits/topic/GATs.2C.20MPTCs.2C.20and.20Type.20Parameters.20on.20.60Self.60.html#249417403">(Aug 13 2021 at 21:37)</a>:</h4>
<p>Yes, there's an issue template on <a href="https://github.com/rust-lang/lang-team">https://github.com/rust-lang/lang-team</a></p>



<a name="249417443"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/144729-wg-traits/topic/GATs%2C%20MPTCs%2C%20and%20Type%20Parameters%20on%20%60Self%60/near/249417443" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Zoey <a href="https://zulip-archive.rust-lang.org/stream/144729-wg-traits/topic/GATs.2C.20MPTCs.2C.20and.20Type.20Parameters.20on.20.60Self.60.html#249417443">(Aug 13 2021 at 21:37)</a>:</h4>
<p>Are you on the lang team? You mentioned you'd be willing to be the <code>liaison</code>, but this document restricts that role to lang-team membership.</p>



<a name="249417686"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/144729-wg-traits/topic/GATs%2C%20MPTCs%2C%20and%20Type%20Parameters%20on%20%60Self%60/near/249417686" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jack Huey <a href="https://zulip-archive.rust-lang.org/stream/144729-wg-traits/topic/GATs.2C.20MPTCs.2C.20and.20Type.20Parameters.20on.20.60Self.60.html#249417686">(Aug 13 2021 at 21:40)</a>:</h4>
<p>Oh does it? I thought I remember at some point it being not necessarily lang team members</p>



<a name="249417716"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/144729-wg-traits/topic/GATs%2C%20MPTCs%2C%20and%20Type%20Parameters%20on%20%60Self%60/near/249417716" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jack Huey <a href="https://zulip-archive.rust-lang.org/stream/144729-wg-traits/topic/GATs.2C.20MPTCs.2C.20and.20Type.20Parameters.20on.20.60Self.60.html#249417716">(Aug 13 2021 at 21:40)</a>:</h4>
<p>So, you'd have to find someone from the lang team interested enough to be liaison</p>



<a name="249417739"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/144729-wg-traits/topic/GATs%2C%20MPTCs%2C%20and%20Type%20Parameters%20on%20%60Self%60/near/249417739" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Zoey <a href="https://zulip-archive.rust-lang.org/stream/144729-wg-traits/topic/GATs.2C.20MPTCs.2C.20and.20Type.20Parameters.20on.20.60Self.60.html#249417739">(Aug 13 2021 at 21:41)</a>:</h4>
<p><code>A lang team member can decide to be your liaison and second your proposal.</code> - it doesn't say that a liaison must be from the lang-team, but it does say that a lang-team member can be a liaison.</p>
<p>Sadly, <a href="https://lang-team.rust-lang.org/initiatives/process/roles/liaison.html">https://lang-team.rust-lang.org/initiatives/process/roles/liaison.html</a> <em>does</em> restrict it to lang-team membership.</p>



<a name="249417877"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/144729-wg-traits/topic/GATs%2C%20MPTCs%2C%20and%20Type%20Parameters%20on%20%60Self%60/near/249417877" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jack Huey <a href="https://zulip-archive.rust-lang.org/stream/144729-wg-traits/topic/GATs.2C.20MPTCs.2C.20and.20Type.20Parameters.20on.20.60Self.60.html#249417877">(Aug 13 2021 at 21:43)</a>:</h4>
<p>Well, nonetheless, you can still open an initiative issue. I'm still willing to mentor</p>



<a name="249418045"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/144729-wg-traits/topic/GATs%2C%20MPTCs%2C%20and%20Type%20Parameters%20on%20%60Self%60/near/249418045" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Zoey <a href="https://zulip-archive.rust-lang.org/stream/144729-wg-traits/topic/GATs.2C.20MPTCs.2C.20and.20Type.20Parameters.20on.20.60Self.60.html#249418045">(Aug 13 2021 at 21:45)</a>:</h4>
<p>Any chance you know of a good way to find a lang-team member who may be interested, or should I start by writing it up, <em>then</em> find someone interested in liaison-ing? The guide recommends identifying a potential owner prior to a proposal, but doesn't require a liaison until after filing.</p>
<p>I don't know if I'm qualified to be the <code>Owner</code> yet, according to this document, as I've not yet worked on RustC internals, but it does say that delegation of that portion is an option.</p>



<a name="249418046"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/144729-wg-traits/topic/GATs%2C%20MPTCs%2C%20and%20Type%20Parameters%20on%20%60Self%60/near/249418046" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jack Huey <a href="https://zulip-archive.rust-lang.org/stream/144729-wg-traits/topic/GATs.2C.20MPTCs.2C.20and.20Type.20Parameters.20on.20.60Self.60.html#249418046">(Aug 13 2021 at 21:45)</a>:</h4>
<p>Unsure if we could "co-own", or if that's even necessarily. These are questions for <span class="user-group-mention" data-user-group-id="1977">@T-lang</span></p>



<a name="249418214"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/144729-wg-traits/topic/GATs%2C%20MPTCs%2C%20and%20Type%20Parameters%20on%20%60Self%60/near/249418214" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jack Huey <a href="https://zulip-archive.rust-lang.org/stream/144729-wg-traits/topic/GATs.2C.20MPTCs.2C.20and.20Type.20Parameters.20on.20.60Self.60.html#249418214">(Aug 13 2021 at 21:47)</a>:</h4>
<p>I would probably start by filling out the initiative issue (<a href="https://github.com/rust-lang/lang-team/blob/master/.github/ISSUE_TEMPLATE/initiative_proposal.md">https://github.com/rust-lang/lang-team/blob/master/.github/ISSUE_TEMPLATE/initiative_proposal.md</a>)</p>



<a name="249418285"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/144729-wg-traits/topic/GATs%2C%20MPTCs%2C%20and%20Type%20Parameters%20on%20%60Self%60/near/249418285" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jack Huey <a href="https://zulip-archive.rust-lang.org/stream/144729-wg-traits/topic/GATs.2C.20MPTCs.2C.20and.20Type.20Parameters.20on.20.60Self.60.html#249418285">(Aug 13 2021 at 21:48)</a>:</h4>
<p>That would get a good way there in terms of "presenting it" to people</p>



<a name="249418326"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/144729-wg-traits/topic/GATs%2C%20MPTCs%2C%20and%20Type%20Parameters%20on%20%60Self%60/near/249418326" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jack Huey <a href="https://zulip-archive.rust-lang.org/stream/144729-wg-traits/topic/GATs.2C.20MPTCs.2C.20and.20Type.20Parameters.20on.20.60Self.60.html#249418326">(Aug 13 2021 at 21:49)</a>:</h4>
<p>Then maybe either open an issue, or make a post in <a class="stream" data-stream-id="213817" href="/#narrow/stream/213817-t-lang">#t-lang</a> and see what people think</p>



<a name="249418468"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/144729-wg-traits/topic/GATs%2C%20MPTCs%2C%20and%20Type%20Parameters%20on%20%60Self%60/near/249418468" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Zoey <a href="https://zulip-archive.rust-lang.org/stream/144729-wg-traits/topic/GATs.2C.20MPTCs.2C.20and.20Type.20Parameters.20on.20.60Self.60.html#249418468">(Aug 13 2021 at 21:50)</a>:</h4>
<p>Alright- I'll do a preliminary writeup in t-lang, then file an initiative. I think we've done the <code>Talk about it on internals, Zulip, etc to flesh it out a bit</code> step quite a bit, since it reduced it from "This needs variadic types, HKT, and universal type qualifiers" to "Actually, this helps provide HKT, and could theoretically be syntactic sugar"</p>



<a name="249418533"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/144729-wg-traits/topic/GATs%2C%20MPTCs%2C%20and%20Type%20Parameters%20on%20%60Self%60/near/249418533" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jack Huey <a href="https://zulip-archive.rust-lang.org/stream/144729-wg-traits/topic/GATs.2C.20MPTCs.2C.20and.20Type.20Parameters.20on.20.60Self.60.html#249418533">(Aug 13 2021 at 21:51)</a>:</h4>
<p>Well, I wouldn't necessarily say one day's discussion is "fleshing it out"</p>



<a name="249418539"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/144729-wg-traits/topic/GATs%2C%20MPTCs%2C%20and%20Type%20Parameters%20on%20%60Self%60/near/249418539" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jack Huey <a href="https://zulip-archive.rust-lang.org/stream/144729-wg-traits/topic/GATs.2C.20MPTCs.2C.20and.20Type.20Parameters.20on.20.60Self.60.html#249418539">(Aug 13 2021 at 21:51)</a>:</h4>
<p>but it's a start :)</p>



<a name="249418629"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/144729-wg-traits/topic/GATs%2C%20MPTCs%2C%20and%20Type%20Parameters%20on%20%60Self%60/near/249418629" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Zoey <a href="https://zulip-archive.rust-lang.org/stream/144729-wg-traits/topic/GATs.2C.20MPTCs.2C.20and.20Type.20Parameters.20on.20.60Self.60.html#249418629">(Aug 13 2021 at 21:52)</a>:</h4>
<p>Yeah, we haven't been the most thorough yet- but it is vastly simpler than the original comment- and, unlike that comment, it's not a question, it's a potential answer.</p>



<a name="249419037"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/144729-wg-traits/topic/GATs%2C%20MPTCs%2C%20and%20Type%20Parameters%20on%20%60Self%60/near/249419037" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jack Huey <a href="https://zulip-archive.rust-lang.org/stream/144729-wg-traits/topic/GATs.2C.20MPTCs.2C.20and.20Type.20Parameters.20on.20.60Self.60.html#249419037">(Aug 13 2021 at 21:57)</a>:</h4>
<p>Anyways, gotta run now.</p>



<a name="249419045"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/144729-wg-traits/topic/GATs%2C%20MPTCs%2C%20and%20Type%20Parameters%20on%20%60Self%60/near/249419045" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jack Huey <a href="https://zulip-archive.rust-lang.org/stream/144729-wg-traits/topic/GATs.2C.20MPTCs.2C.20and.20Type.20Parameters.20on.20.60Self.60.html#249419045">(Aug 13 2021 at 21:57)</a>:</h4>
<p>Keep me posted!</p>



<a name="249419345"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/144729-wg-traits/topic/GATs%2C%20MPTCs%2C%20and%20Type%20Parameters%20on%20%60Self%60/near/249419345" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jack Huey <a href="https://zulip-archive.rust-lang.org/stream/144729-wg-traits/topic/GATs.2C.20MPTCs.2C.20and.20Type.20Parameters.20on.20.60Self.60.html#249419345">(Aug 13 2021 at 22:00)</a>:</h4>
<p>Oh, quickly. Just thought. But you could potentially imagine that an alternative way to think about this:</p>



<a name="249419346"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/144729-wg-traits/topic/GATs%2C%20MPTCs%2C%20and%20Type%20Parameters%20on%20%60Self%60/near/249419346" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jack Huey <a href="https://zulip-archive.rust-lang.org/stream/144729-wg-traits/topic/GATs.2C.20MPTCs.2C.20and.20Type.20Parameters.20on.20.60Self.60.html#249419346">(Aug 13 2021 at 22:00)</a>:</h4>
<p>Is if a trait had an associated type <code>Self</code> with generics for each other associated type</p>



<a name="249419394"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/144729-wg-traits/topic/GATs%2C%20MPTCs%2C%20and%20Type%20Parameters%20on%20%60Self%60/near/249419394" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jack Huey <a href="https://zulip-archive.rust-lang.org/stream/144729-wg-traits/topic/GATs.2C.20MPTCs.2C.20and.20Type.20Parameters.20on.20.60Self.60.html#249419394">(Aug 13 2021 at 22:00)</a>:</h4>
<p>Err wait</p>



<a name="249419415"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/144729-wg-traits/topic/GATs%2C%20MPTCs%2C%20and%20Type%20Parameters%20on%20%60Self%60/near/249419415" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jack Huey <a href="https://zulip-archive.rust-lang.org/stream/144729-wg-traits/topic/GATs.2C.20MPTCs.2C.20and.20Type.20Parameters.20on.20.60Self.60.html#249419415">(Aug 13 2021 at 22:00)</a>:</h4>
<p>Hold on (on mobile now)</p>



<hr><p>Last updated: Apr 12 2022 at 20:01 UTC</p>
</html>