<html>
<head><meta charset="utf-8"><title>chalk: Not enough bound vars: ^0 not found in [] · wg-traits · Zulip Chat Archive</title></head>
<h2>Stream: <a href="https://zulip-archive.rust-lang.org/stream/144729-wg-traits/index.html">wg-traits</a></h2>
<h3>Topic: <a href="https://zulip-archive.rust-lang.org/stream/144729-wg-traits/topic/chalk.3A.20Not.20enough.20bound.20vars.3A.20.5E0.20not.20found.20in.20.5B.5D.html">chalk: Not enough bound vars: ^0 not found in []</a></h3>

<hr>

<base href="https://rust-lang.zulipchat.com">

<head><link href="https://zulip-archive.rust-lang.org/style.css" rel="stylesheet"></head>

<a name="272734501"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/144729-wg-traits/topic/chalk%3A%20Not%20enough%20bound%20vars%3A%20%5E0%20not%20found%20in%20%5B%5D/near/272734501" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Dario Nieuwenhuis <a href="https://zulip-archive.rust-lang.org/stream/144729-wg-traits/topic/chalk.3A.20Not.20enough.20bound.20vars.3A.20.5E0.20not.20found.20in.20.5B.5D.html#272734501">(Feb 21 2022 at 20:59)</a>:</h4>
<p>(Apologies if this is the wrong place for such questions, I'm quite new to all this!)</p>
<p>I'm getting this error <a href="https://github.com/rust-lang/rust/blob/master/compiler/rustc_traits/src/chalk/db.rs#L485">here</a> when compiling this code</p>
<div class="codehilite" data-code-language="Rust"><pre><span></span><code><span class="k">fn</span> <span class="nf">main</span><span class="p">()</span><span class="w"> </span><span class="p">{}</span><span class="w"></span>
<span class="k">async</span><span class="w"> </span><span class="k">fn</span> <span class="nf">lol</span><span class="p">(</span><span class="n">x</span>: <span class="kt">u32</span><span class="p">)</span><span class="w"> </span>-&gt; <span class="kt">u32</span> <span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="n">x</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>
</code></pre></div>
<p><a href="https://gist.github.com/Dirbaio/2b9374ff4fce37afb9d665dc9f0000df">logs</a></p>
<p>It happens when the future has no lifetimes at all. Is the added BoundVar supposed to refer to the chalk binder <code>existential_binder</code>?</p>



<a name="272734674"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/144729-wg-traits/topic/chalk%3A%20Not%20enough%20bound%20vars%3A%20%5E0%20not%20found%20in%20%5B%5D/near/272734674" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Michael Goulet (compiler-errors) <a href="https://zulip-archive.rust-lang.org/stream/144729-wg-traits/topic/chalk.3A.20Not.20enough.20bound.20vars.3A.20.5E0.20not.20found.20in.20.5B.5D.html#272734674">(Feb 21 2022 at 21:01)</a>:</h4>
<p>This error is occurring while you've made modifications to the compiler? Otherwise, what version are you compiling with?</p>



<a name="272734711"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/144729-wg-traits/topic/chalk%3A%20Not%20enough%20bound%20vars%3A%20%5E0%20not%20found%20in%20%5B%5D/near/272734711" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jack Huey <a href="https://zulip-archive.rust-lang.org/stream/144729-wg-traits/topic/chalk.3A.20Not.20enough.20bound.20vars.3A.20.5E0.20not.20found.20in.20.5B.5D.html#272734711">(Feb 21 2022 at 21:01)</a>:</h4>
<p>(also, compiling under <code>-Z chalk</code>?)</p>



<a name="272734719"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/144729-wg-traits/topic/chalk%3A%20Not%20enough%20bound%20vars%3A%20%5E0%20not%20found%20in%20%5B%5D/near/272734719" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Dario Nieuwenhuis <a href="https://zulip-archive.rust-lang.org/stream/144729-wg-traits/topic/chalk.3A.20Not.20enough.20bound.20vars.3A.20.5E0.20not.20found.20in.20.5B.5D.html#272734719">(Feb 21 2022 at 21:01)</a>:</h4>
<p>unmodified master (other than a few added debug logs). Yes, -Zchalk</p>



<a name="272734801"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/144729-wg-traits/topic/chalk%3A%20Not%20enough%20bound%20vars%3A%20%5E0%20not%20found%20in%20%5B%5D/near/272734801" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Dario Nieuwenhuis <a href="https://zulip-archive.rust-lang.org/stream/144729-wg-traits/topic/chalk.3A.20Not.20enough.20bound.20vars.3A.20.5E0.20not.20found.20in.20.5B.5D.html#272734801">(Feb 21 2022 at 21:02)</a>:</h4>
<p>Works without -Zchalk</p>



<a name="272734854"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/144729-wg-traits/topic/chalk%3A%20Not%20enough%20bound%20vars%3A%20%5E0%20not%20found%20in%20%5B%5D/near/272734854" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Dario Nieuwenhuis <a href="https://zulip-archive.rust-lang.org/stream/144729-wg-traits/topic/chalk.3A.20Not.20enough.20bound.20vars.3A.20.5E0.20not.20found.20in.20.5B.5D.html#272734854">(Feb 21 2022 at 21:03)</a>:</h4>
<p>I think the check only happens with debug assertions? I have <code>[rust] debug=true</code> in config.toml</p>



<a name="272735122"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/144729-wg-traits/topic/chalk%3A%20Not%20enough%20bound%20vars%3A%20%5E0%20not%20found%20in%20%5B%5D/near/272735122" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Dario Nieuwenhuis <a href="https://zulip-archive.rust-lang.org/stream/144729-wg-traits/topic/chalk.3A.20Not.20enough.20bound.20vars.3A.20.5E0.20not.20found.20in.20.5B.5D.html#272735122">(Feb 21 2022 at 21:07)</a>:</h4>
<p>yes, it's this check here failing <a href="https://github.com/rust-lang/rust/blob/master/compiler/rustc_middle/src/ty/sty.rs#L1164">https://github.com/rust-lang/rust/blob/master/compiler/rustc_middle/src/ty/sty.rs#L1164</a></p>



<a name="272735238"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/144729-wg-traits/topic/chalk%3A%20Not%20enough%20bound%20vars%3A%20%5E0%20not%20found%20in%20%5B%5D/near/272735238" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Dario Nieuwenhuis <a href="https://zulip-archive.rust-lang.org/stream/144729-wg-traits/topic/chalk.3A.20Not.20enough.20bound.20vars.3A.20.5E0.20not.20found.20in.20.5B.5D.html#272735238">(Feb 21 2022 at 21:08)</a>:</h4>
<p>so the issue is the added BoundVar with index 0 is invalid when folding, it only bevomes valid later when wrapping it into the <code>existential_binder</code></p>



<a name="272735265"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/144729-wg-traits/topic/chalk%3A%20Not%20enough%20bound%20vars%3A%20%5E0%20not%20found%20in%20%5B%5D/near/272735265" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Dario Nieuwenhuis <a href="https://zulip-archive.rust-lang.org/stream/144729-wg-traits/topic/chalk.3A.20Not.20enough.20bound.20vars.3A.20.5E0.20not.20found.20in.20.5B.5D.html#272735265">(Feb 21 2022 at 21:08)</a>:</h4>
<p>is there any way to rewrite this so it's no longer temporarily invalid? I'll try PRing it</p>



<a name="272735582"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/144729-wg-traits/topic/chalk%3A%20Not%20enough%20bound%20vars%3A%20%5E0%20not%20found%20in%20%5B%5D/near/272735582" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jack Huey <a href="https://zulip-archive.rust-lang.org/stream/144729-wg-traits/topic/chalk.3A.20Not.20enough.20bound.20vars.3A.20.5E0.20not.20found.20in.20.5B.5D.html#272735582">(Feb 21 2022 at 21:13)</a>:</h4>
<p>Probably some problem with either the rust-&gt;chalk or chalk-&gt;rust "lowering"</p>



<a name="272735664"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/144729-wg-traits/topic/chalk%3A%20Not%20enough%20bound%20vars%3A%20%5E0%20not%20found%20in%20%5B%5D/near/272735664" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jack Huey <a href="https://zulip-archive.rust-lang.org/stream/144729-wg-traits/topic/chalk.3A.20Not.20enough.20bound.20vars.3A.20.5E0.20not.20found.20in.20.5B.5D.html#272735664">(Feb 21 2022 at 21:14)</a>:</h4>
<p>I would have to look at some logs to be able to give any more specific advice here</p>



<a name="272735705"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/144729-wg-traits/topic/chalk%3A%20Not%20enough%20bound%20vars%3A%20%5E0%20not%20found%20in%20%5B%5D/near/272735705" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Dario Nieuwenhuis <a href="https://zulip-archive.rust-lang.org/stream/144729-wg-traits/topic/chalk.3A.20Not.20enough.20bound.20vars.3A.20.5E0.20not.20found.20in.20.5B.5D.html#272735705">(Feb 21 2022 at 21:15)</a>:</h4>
<p>here are the logs <a href="https://gist.github.com/Dirbaio/2b9374ff4fce37afb9d665dc9f0000df">https://gist.github.com/Dirbaio/2b9374ff4fce37afb9d665dc9f0000df</a><br>
the troublesome fold is here <a href="https://github.com/rust-lang/rust/blob/master/compiler/rustc_traits/src/chalk/db.rs#L485">https://github.com/rust-lang/rust/blob/master/compiler/rustc_traits/src/chalk/db.rs#L485</a></p>



<a name="272735865"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/144729-wg-traits/topic/chalk%3A%20Not%20enough%20bound%20vars%3A%20%5E0%20not%20found%20in%20%5B%5D/near/272735865" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Michael Goulet (compiler-errors) <a href="https://zulip-archive.rust-lang.org/stream/144729-wg-traits/topic/chalk.3A.20Not.20enough.20bound.20vars.3A.20.5E0.20not.20found.20in.20.5B.5D.html#272735865">(Feb 21 2022 at 21:17)</a>:</h4>
<p>Suspicious if there is a type that has a bound var that is escaping out of a binder somewhere..</p>



<a name="272735879"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/144729-wg-traits/topic/chalk%3A%20Not%20enough%20bound%20vars%3A%20%5E0%20not%20found%20in%20%5B%5D/near/272735879" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Michael Goulet (compiler-errors) <a href="https://zulip-archive.rust-lang.org/stream/144729-wg-traits/topic/chalk.3A.20Not.20enough.20bound.20vars.3A.20.5E0.20not.20found.20in.20.5B.5D.html#272735879">(Feb 21 2022 at 21:17)</a>:</h4>
<p>If you can't figure it out <span class="user-mention" data-user-id="348152">@Dario Nieuwenhuis</span> then let me know, and I can probably take a stab at it.</p>



<a name="272735945"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/144729-wg-traits/topic/chalk%3A%20Not%20enough%20bound%20vars%3A%20%5E0%20not%20found%20in%20%5B%5D/near/272735945" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Dario Nieuwenhuis <a href="https://zulip-archive.rust-lang.org/stream/144729-wg-traits/topic/chalk.3A.20Not.20enough.20bound.20vars.3A.20.5E0.20not.20found.20in.20.5B.5D.html#272735945">(Feb 21 2022 at 21:18)</a>:</h4>
<p>the bound var that causes the fail is this one <a href="https://github.com/rust-lang/rust/blob/master/compiler/rustc_traits/src/chalk/db.rs#L492">https://github.com/rust-lang/rust/blob/master/compiler/rustc_traits/src/chalk/db.rs#L492</a><br>
it doesn't come from earlier</p>



<a name="272735995"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/144729-wg-traits/topic/chalk%3A%20Not%20enough%20bound%20vars%3A%20%5E0%20not%20found%20in%20%5B%5D/near/272735995" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Michael Goulet (compiler-errors) <a href="https://zulip-archive.rust-lang.org/stream/144729-wg-traits/topic/chalk.3A.20Not.20enough.20bound.20vars.3A.20.5E0.20not.20found.20in.20.5B.5D.html#272735995">(Feb 21 2022 at 21:19)</a>:</h4>
<p>oh, maybe that <code>ty::INNERMOST</code> debruijn index needs to get shifted if we enter into a binder in the <code>BottomUpFolder</code></p>



<a name="272736197"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/144729-wg-traits/topic/chalk%3A%20Not%20enough%20bound%20vars%3A%20%5E0%20not%20found%20in%20%5B%5D/near/272736197" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Dario Nieuwenhuis <a href="https://zulip-archive.rust-lang.org/stream/144729-wg-traits/topic/chalk.3A.20Not.20enough.20bound.20vars.3A.20.5E0.20not.20found.20in.20.5B.5D.html#272736197">(Feb 21 2022 at 21:21)</a>:</h4>
<p>oh yeah that's suspicious as well, it seems to me we want the outermost one?</p>



<a name="272736257"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/144729-wg-traits/topic/chalk%3A%20Not%20enough%20bound%20vars%3A%20%5E0%20not%20found%20in%20%5B%5D/near/272736257" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Michael Goulet (compiler-errors) <a href="https://zulip-archive.rust-lang.org/stream/144729-wg-traits/topic/chalk.3A.20Not.20enough.20bound.20vars.3A.20.5E0.20not.20found.20in.20.5B.5D.html#272736257">(Feb 21 2022 at 21:22)</a>:</h4>
<p>yeah, <code>BottomUpFolder</code>s are not binder-aware, as I've found in other issues</p>



<a name="272736431"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/144729-wg-traits/topic/chalk%3A%20Not%20enough%20bound%20vars%3A%20%5E0%20not%20found%20in%20%5B%5D/near/272736431" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Dario Nieuwenhuis <a href="https://zulip-archive.rust-lang.org/stream/144729-wg-traits/topic/chalk.3A.20Not.20enough.20bound.20vars.3A.20.5E0.20not.20found.20in.20.5B.5D.html#272736431">(Feb 21 2022 at 21:24)</a>:</h4>
<p>ah so the issue is that yep</p>



<a name="272736486"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/144729-wg-traits/topic/chalk%3A%20Not%20enough%20bound%20vars%3A%20%5E0%20not%20found%20in%20%5B%5D/near/272736486" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Dario Nieuwenhuis <a href="https://zulip-archive.rust-lang.org/stream/144729-wg-traits/topic/chalk.3A.20Not.20enough.20bound.20vars.3A.20.5E0.20not.20found.20in.20.5B.5D.html#272736486">(Feb 21 2022 at 21:25)</a>:</h4>
<p>what's the best way around it? writing a custom folder?</p>



<a name="272738312"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/144729-wg-traits/topic/chalk%3A%20Not%20enough%20bound%20vars%3A%20%5E0%20not%20found%20in%20%5B%5D/near/272738312" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Michael Goulet (compiler-errors) <a href="https://zulip-archive.rust-lang.org/stream/144729-wg-traits/topic/chalk.3A.20Not.20enough.20bound.20vars.3A.20.5E0.20not.20found.20in.20.5B.5D.html#272738312">(Feb 21 2022 at 21:51)</a>:</h4>
<p>You could start with that!</p>



<a name="272738499"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/144729-wg-traits/topic/chalk%3A%20Not%20enough%20bound%20vars%3A%20%5E0%20not%20found%20in%20%5B%5D/near/272738499" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Dario Nieuwenhuis <a href="https://zulip-archive.rust-lang.org/stream/144729-wg-traits/topic/chalk.3A.20Not.20enough.20bound.20vars.3A.20.5E0.20not.20found.20in.20.5B.5D.html#272738499">(Feb 21 2022 at 21:54)</a>:</h4>
<p>got it, it seems to be working :D</p>



<a name="272738537"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/144729-wg-traits/topic/chalk%3A%20Not%20enough%20bound%20vars%3A%20%5E0%20not%20found%20in%20%5B%5D/near/272738537" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Dario Nieuwenhuis <a href="https://zulip-archive.rust-lang.org/stream/144729-wg-traits/topic/chalk.3A.20Not.20enough.20bound.20vars.3A.20.5E0.20not.20found.20in.20.5B.5D.html#272738537">(Feb 21 2022 at 21:55)</a>:</h4>
<p>how do I test this? tests are typically run without debug assertions right?</p>



<a name="272738541"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/144729-wg-traits/topic/chalk%3A%20Not%20enough%20bound%20vars%3A%20%5E0%20not%20found%20in%20%5B%5D/near/272738541" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Dario Nieuwenhuis <a href="https://zulip-archive.rust-lang.org/stream/144729-wg-traits/topic/chalk.3A.20Not.20enough.20bound.20vars.3A.20.5E0.20not.20found.20in.20.5B.5D.html#272738541">(Feb 21 2022 at 21:55)</a>:</h4>
<p>which is why this wasn't caught</p>



<a name="272738567"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/144729-wg-traits/topic/chalk%3A%20Not%20enough%20bound%20vars%3A%20%5E0%20not%20found%20in%20%5B%5D/near/272738567" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Michael Goulet (compiler-errors) <a href="https://zulip-archive.rust-lang.org/stream/144729-wg-traits/topic/chalk.3A.20Not.20enough.20bound.20vars.3A.20.5E0.20not.20found.20in.20.5B.5D.html#272738567">(Feb 21 2022 at 21:55)</a>:</h4>
<p><code>// compile-flags: -C debug-assertions -Z chalk</code> perhaps?</p>



<a name="272738574"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/144729-wg-traits/topic/chalk%3A%20Not%20enough%20bound%20vars%3A%20%5E0%20not%20found%20in%20%5B%5D/near/272738574" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Michael Goulet (compiler-errors) <a href="https://zulip-archive.rust-lang.org/stream/144729-wg-traits/topic/chalk.3A.20Not.20enough.20bound.20vars.3A.20.5E0.20not.20found.20in.20.5B.5D.html#272738574">(Feb 21 2022 at 21:55)</a>:</h4>
<p>(add it to a UI test)</p>



<a name="272738620"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/144729-wg-traits/topic/chalk%3A%20Not%20enough%20bound%20vars%3A%20%5E0%20not%20found%20in%20%5B%5D/near/272738620" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Dario Nieuwenhuis <a href="https://zulip-archive.rust-lang.org/stream/144729-wg-traits/topic/chalk.3A.20Not.20enough.20bound.20vars.3A.20.5E0.20not.20found.20in.20.5B.5D.html#272738620">(Feb 21 2022 at 21:56)</a>:</h4>
<p>it needs rustc itself to be built with debug assertions to catch it</p>



<a name="272738647"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/144729-wg-traits/topic/chalk%3A%20Not%20enough%20bound%20vars%3A%20%5E0%20not%20found%20in%20%5B%5D/near/272738647" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Michael Goulet (compiler-errors) <a href="https://zulip-archive.rust-lang.org/stream/144729-wg-traits/topic/chalk.3A.20Not.20enough.20bound.20vars.3A.20.5E0.20not.20found.20in.20.5B.5D.html#272738647">(Feb 21 2022 at 21:56)</a>:</h4>
<p>oh oops, sorry that might enable debug assertions in the test program, lol</p>



<a name="272738678"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/144729-wg-traits/topic/chalk%3A%20Not%20enough%20bound%20vars%3A%20%5E0%20not%20found%20in%20%5B%5D/near/272738678" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Dario Nieuwenhuis <a href="https://zulip-archive.rust-lang.org/stream/144729-wg-traits/topic/chalk.3A.20Not.20enough.20bound.20vars.3A.20.5E0.20not.20found.20in.20.5B.5D.html#272738678">(Feb 21 2022 at 21:57)</a>:</h4>
<p>the previous code seems quite wrong, it probably causes issues other than failing that debug-assertion, that should be testable</p>



<a name="272742422"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/144729-wg-traits/topic/chalk%3A%20Not%20enough%20bound%20vars%3A%20%5E0%20not%20found%20in%20%5B%5D/near/272742422" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Dario Nieuwenhuis <a href="https://zulip-archive.rust-lang.org/stream/144729-wg-traits/topic/chalk.3A.20Not.20enough.20bound.20vars.3A.20.5E0.20not.20found.20in.20.5B.5D.html#272742422">(Feb 21 2022 at 22:54)</a>:</h4>
<p>the above code still doesn't build though. I guess generators are still super WIP in chalk?</p>
<div class="codehilite"><pre><span></span><code>error[E0277]: the trait bound `[static lol::{closure#0} upvar_tys=(unavailable)]: Generator&lt;ResumeTy&gt;` is not satisfied
  --&gt; snippets/good.rs:2:29
   |
2  |   async fn lol(x: u32) -&gt; u32 {
   |  _____________________________^
3  | |     x
4  | | }
   | |_^ the trait `Generator&lt;ResumeTy&gt;` is not implemented for `[static lol::{closure#0} upvar_tys=(unavailable)]`
   |
note: required by a bound in `from_generator`
  --&gt; /home/dirbaio/rust/library/core/src/future/mod.rs:67:8
   |
67 |     T: Generator&lt;ResumeTy, Yield = ()&gt;,
   |        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ required by this bound in `from_generator`

error[E0280]: the requirement `&lt;[static lol::{closure#0} upvar_tys=(unavailable)] as Generator&lt;ResumeTy&gt;&gt;::Yield == ()` is not satisfied
  --&gt; snippets/good.rs:2:29
   |
2  |   async fn lol(x: u32) -&gt; u32 {
   |  _____________________________^
3  | |     x
4  | | }
   | |_^
   |
note: required by a bound in `from_generator`
  --&gt; /home/dirbaio/rust/library/core/src/future/mod.rs:67:28
   |
67 |     T: Generator&lt;ResumeTy, Yield = ()&gt;,
   |                            ^^^^^^^^^^ required by this bound in `from_generator`

error[E0280]: the requirement `&lt;Opaque(DefId(2:13176 ~ core[23f5]::future::from_generator::{opaque#0}), [[static lol::{closure#0} upvar_tys=(unavailable)]]) as Future&gt;::Output == u32` is not satisfied
 --&gt; snippets/good.rs:2:25
  |
2 | async fn lol(x: u32) -&gt; u32 {
  |                         ^^^

error: aborting due to 3 previous errors
</code></pre></div>



<a name="272742437"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/144729-wg-traits/topic/chalk%3A%20Not%20enough%20bound%20vars%3A%20%5E0%20not%20found%20in%20%5B%5D/near/272742437" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jack Huey <a href="https://zulip-archive.rust-lang.org/stream/144729-wg-traits/topic/chalk.3A.20Not.20enough.20bound.20vars.3A.20.5E0.20not.20found.20in.20.5B.5D.html#272742437">(Feb 21 2022 at 22:54)</a>:</h4>
<p>Generators are a known issue I think</p>



<a name="272742439"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/144729-wg-traits/topic/chalk%3A%20Not%20enough%20bound%20vars%3A%20%5E0%20not%20found%20in%20%5B%5D/near/272742439" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jack Huey <a href="https://zulip-archive.rust-lang.org/stream/144729-wg-traits/topic/chalk.3A.20Not.20enough.20bound.20vars.3A.20.5E0.20not.20found.20in.20.5B.5D.html#272742439">(Feb 21 2022 at 22:54)</a>:</h4>
<p>Will have to look at this later</p>



<a name="272742472"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/144729-wg-traits/topic/chalk%3A%20Not%20enough%20bound%20vars%3A%20%5E0%20not%20found%20in%20%5B%5D/near/272742472" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Dario Nieuwenhuis <a href="https://zulip-archive.rust-lang.org/stream/144729-wg-traits/topic/chalk.3A.20Not.20enough.20bound.20vars.3A.20.5E0.20not.20found.20in.20.5B.5D.html#272742472">(Feb 21 2022 at 22:55)</a>:</h4>
<p>at least with my fix it no longer ICEs, should I still PR it?</p>



<a name="272742485"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/144729-wg-traits/topic/chalk%3A%20Not%20enough%20bound%20vars%3A%20%5E0%20not%20found%20in%20%5B%5D/near/272742485" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jack Huey <a href="https://zulip-archive.rust-lang.org/stream/144729-wg-traits/topic/chalk.3A.20Not.20enough.20bound.20vars.3A.20.5E0.20not.20found.20in.20.5B.5D.html#272742485">(Feb 21 2022 at 22:55)</a>:</h4>
<p>Yes :)</p>



<a name="272742490"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/144729-wg-traits/topic/chalk%3A%20Not%20enough%20bound%20vars%3A%20%5E0%20not%20found%20in%20%5B%5D/near/272742490" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jack Huey <a href="https://zulip-archive.rust-lang.org/stream/144729-wg-traits/topic/chalk.3A.20Not.20enough.20bound.20vars.3A.20.5E0.20not.20found.20in.20.5B.5D.html#272742490">(Feb 21 2022 at 22:55)</a>:</h4>
<p>r? me for that</p>



<a name="272742504"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/144729-wg-traits/topic/chalk%3A%20Not%20enough%20bound%20vars%3A%20%5E0%20not%20found%20in%20%5B%5D/near/272742504" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Dario Nieuwenhuis <a href="https://zulip-archive.rust-lang.org/stream/144729-wg-traits/topic/chalk.3A.20Not.20enough.20bound.20vars.3A.20.5E0.20not.20found.20in.20.5B.5D.html#272742504">(Feb 21 2022 at 22:55)</a>:</h4>
<p>with a test that enforces that doesn't ICE? or should I not bother?</p>



<a name="272742564"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/144729-wg-traits/topic/chalk%3A%20Not%20enough%20bound%20vars%3A%20%5E0%20not%20found%20in%20%5B%5D/near/272742564" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jack Huey <a href="https://zulip-archive.rust-lang.org/stream/144729-wg-traits/topic/chalk.3A.20Not.20enough.20bound.20vars.3A.20.5E0.20not.20found.20in.20.5B.5D.html#272742564">(Feb 21 2022 at 22:56)</a>:</h4>
<p>Sure, this would be a good use case for the <code>known-bug</code> attribute</p>



<a name="272742581"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/144729-wg-traits/topic/chalk%3A%20Not%20enough%20bound%20vars%3A%20%5E0%20not%20found%20in%20%5B%5D/near/272742581" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jack Huey <a href="https://zulip-archive.rust-lang.org/stream/144729-wg-traits/topic/chalk.3A.20Not.20enough.20bound.20vars.3A.20.5E0.20not.20found.20in.20.5B.5D.html#272742581">(Feb 21 2022 at 22:56)</a>:</h4>
<p>Just make a src/test/ui/chalk/bugs directory</p>



<a name="272742600"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/144729-wg-traits/topic/chalk%3A%20Not%20enough%20bound%20vars%3A%20%5E0%20not%20found%20in%20%5B%5D/near/272742600" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Dario Nieuwenhuis <a href="https://zulip-archive.rust-lang.org/stream/144729-wg-traits/topic/chalk.3A.20Not.20enough.20bound.20vars.3A.20.5E0.20not.20found.20in.20.5B.5D.html#272742600">(Feb 21 2022 at 22:57)</a>:</h4>
<p>// check-fail<br>
// known-bug</p>
<p>?</p>



<a name="272742638"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/144729-wg-traits/topic/chalk%3A%20Not%20enough%20bound%20vars%3A%20%5E0%20not%20found%20in%20%5B%5D/near/272742638" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jack Huey <a href="https://zulip-archive.rust-lang.org/stream/144729-wg-traits/topic/chalk.3A.20Not.20enough.20bound.20vars.3A.20.5E0.20not.20found.20in.20.5B.5D.html#272742638">(Feb 21 2022 at 22:57)</a>:</h4>
<p>And // compile-flags: -Z chalk</p>



<a name="272742683"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/144729-wg-traits/topic/chalk%3A%20Not%20enough%20bound%20vars%3A%20%5E0%20not%20found%20in%20%5B%5D/near/272742683" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Dario Nieuwenhuis <a href="https://zulip-archive.rust-lang.org/stream/144729-wg-traits/topic/chalk.3A.20Not.20enough.20bound.20vars.3A.20.5E0.20not.20found.20in.20.5B.5D.html#272742683">(Feb 21 2022 at 22:58)</a>:</h4>
<p>nice, thanks! :D</p>



<a name="272743752"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/144729-wg-traits/topic/chalk%3A%20Not%20enough%20bound%20vars%3A%20%5E0%20not%20found%20in%20%5B%5D/near/272743752" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Dario Nieuwenhuis <a href="https://zulip-archive.rust-lang.org/stream/144729-wg-traits/topic/chalk.3A.20Not.20enough.20bound.20vars.3A.20.5E0.20not.20found.20in.20.5B.5D.html#272743752">(Feb 21 2022 at 23:13)</a>:</h4>
<p>done! :D <a href="https://github.com/rust-lang/rust/issues/94235">#94235</a></p>



<a name="272743822"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/144729-wg-traits/topic/chalk%3A%20Not%20enough%20bound%20vars%3A%20%5E0%20not%20found%20in%20%5B%5D/near/272743822" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jack Huey <a href="https://zulip-archive.rust-lang.org/stream/144729-wg-traits/topic/chalk.3A.20Not.20enough.20bound.20vars.3A.20.5E0.20not.20found.20in.20.5B.5D.html#272743822">(Feb 21 2022 at 23:14)</a>:</h4>
<p>Thanks, I'll take a look later :)</p>



<hr><p>Last updated: Apr 12 2022 at 20:01 UTC</p>
</html>