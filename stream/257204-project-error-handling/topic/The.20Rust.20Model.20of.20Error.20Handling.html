<html>
<head><meta charset="utf-8"><title>The Rust Model of Error Handling · project-error-handling · Zulip Chat Archive</title></head>
<h2>Stream: <a href="https://zulip-archive.rust-lang.org/stream/257204-project-error-handling/index.html">project-error-handling</a></h2>
<h3>Topic: <a href="https://zulip-archive.rust-lang.org/stream/257204-project-error-handling/topic/The.20Rust.20Model.20of.20Error.20Handling.html">The Rust Model of Error Handling</a></h3>

<hr>

<base href="https://rust-lang.zulipchat.com">

<head><link href="https://zulip-archive.rust-lang.org/style.css" rel="stylesheet"></head>

<a name="271049787"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257204-project-error-handling/topic/The%20Rust%20Model%20of%20Error%20Handling/near/271049787" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jane Lusby [she/her] <a href="https://zulip-archive.rust-lang.org/stream/257204-project-error-handling/topic/The.20Rust.20Model.20of.20Error.20Handling.html#271049787">(Feb 07 2022 at 22:09)</a>:</h4>
<p>I'm planning on writing a 2022 roadmap / status update for the error handling project group and I thought it might be a good time to step back and do some holistic planning around error handling in rust.</p>



<a name="271049922"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257204-project-error-handling/topic/The%20Rust%20Model%20of%20Error%20Handling/near/271049922" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jane Lusby [she/her] <a href="https://zulip-archive.rust-lang.org/stream/257204-project-error-handling/topic/The.20Rust.20Model.20of.20Error.20Handling.html#271049922">(Feb 07 2022 at 22:10)</a>:</h4>
<p>As a first step I want to create a collaborative document outlining "The Rust Model of Error Handling" to make sure we're all on the same page and using the same definitions in discussions about error handling.</p>



<a name="271049938"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257204-project-error-handling/topic/The%20Rust%20Model%20of%20Error%20Handling/near/271049938" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jane Lusby [she/her] <a href="https://zulip-archive.rust-lang.org/stream/257204-project-error-handling/topic/The.20Rust.20Model.20of.20Error.20Handling.html#271049938">(Feb 07 2022 at 22:11)</a>:</h4>
<p>I've started drafting that document here: <a href="https://hackmd.io/VN6AtpySR4Or_CV8b8XjRg">https://hackmd.io/VN6AtpySR4Or_CV8b8XjRg</a></p>



<a name="271049972"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257204-project-error-handling/topic/The%20Rust%20Model%20of%20Error%20Handling/near/271049972" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jane Lusby [she/her] <a href="https://zulip-archive.rust-lang.org/stream/257204-project-error-handling/topic/The.20Rust.20Model.20of.20Error.20Handling.html#271049972">(Feb 07 2022 at 22:11)</a>:</h4>
<p>For now I'm starting with a couple of sections</p>



<a name="271050038"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257204-project-error-handling/topic/The%20Rust%20Model%20of%20Error%20Handling/near/271050038" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jane Lusby [she/her] <a href="https://zulip-archive.rust-lang.org/stream/257204-project-error-handling/topic/The.20Rust.20Model.20of.20Error.20Handling.html#271050038">(Feb 07 2022 at 22:11)</a>:</h4>
<p><code>Definitions</code> is for establishing common definitions for frequently overloaded / confusing terms used when talking about error handling</p>



<a name="271050132"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257204-project-error-handling/topic/The%20Rust%20Model%20of%20Error%20Handling/near/271050132" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jane Lusby [she/her] <a href="https://zulip-archive.rust-lang.org/stream/257204-project-error-handling/topic/The.20Rust.20Model.20of.20Error.20Handling.html#271050132">(Feb 07 2022 at 22:12)</a>:</h4>
<p><code>Core Design Goals</code> is to outline the practical features of rust error handling and possibly to prioritize them relative to eachother</p>



<a name="271050590"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257204-project-error-handling/topic/The%20Rust%20Model%20of%20Error%20Handling/near/271050590" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jane Lusby [she/her] <a href="https://zulip-archive.rust-lang.org/stream/257204-project-error-handling/topic/The.20Rust.20Model.20of.20Error.20Handling.html#271050590">(Feb 07 2022 at 22:14)</a>:</h4>
<p>and then <code>Current areas of confusion</code> is for the topics of discussion that tend to be contentious / unclear to different users</p>



<a name="271051008"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257204-project-error-handling/topic/The%20Rust%20Model%20of%20Error%20Handling/near/271051008" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jane Lusby [she/her] <a href="https://zulip-archive.rust-lang.org/stream/257204-project-error-handling/topic/The.20Rust.20Model.20of.20Error.20Handling.html#271051008">(Feb 07 2022 at 22:17)</a>:</h4>
<p>The draft is very rough at the moment, my current focus is filling in the core design goals section</p>



<a name="271051095"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257204-project-error-handling/topic/The%20Rust%20Model%20of%20Error%20Handling/near/271051095" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jane Lusby [she/her] <a href="https://zulip-archive.rust-lang.org/stream/257204-project-error-handling/topic/The.20Rust.20Model.20of.20Error.20Handling.html#271051095">(Feb 07 2022 at 22:17)</a>:</h4>
<p>For definitions I'm just putting in the terms that I think need to be defined but leaving definitions of them for later, I'm particularly curious to see and compare what definitions other people would provide for these terms</p>



<a name="271134485"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257204-project-error-handling/topic/The%20Rust%20Model%20of%20Error%20Handling/near/271134485" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sean Chen (he/him) <a href="https://zulip-archive.rust-lang.org/stream/257204-project-error-handling/topic/The.20Rust.20Model.20of.20Error.20Handling.html#271134485">(Feb 08 2022 at 14:24)</a>:</h4>
<p>Would it be appropriate to also add more general Rust terms that are used as part of error handling machinery? Downcasting is at the forefront of my mind. I remember being a concept that took me some time to understand but which crops up occasionally in the context of error handling.</p>



<a name="271135728"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257204-project-error-handling/topic/The%20Rust%20Model%20of%20Error%20Handling/near/271135728" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sean Chen (he/him) <a href="https://zulip-archive.rust-lang.org/stream/257204-project-error-handling/topic/The.20Rust.20Model.20of.20Error.20Handling.html#271135728">(Feb 08 2022 at 14:31)</a>:</h4>
<p>Generic member access is perhaps another term as well.</p>



<a name="271140646"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257204-project-error-handling/topic/The%20Rust%20Model%20of%20Error%20Handling/near/271140646" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jane Lusby [she/her] <a href="https://zulip-archive.rust-lang.org/stream/257204-project-error-handling/topic/The.20Rust.20Model.20of.20Error.20Handling.html#271140646">(Feb 08 2022 at 15:04)</a>:</h4>
<p>absolutely</p>



<a name="271143436"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257204-project-error-handling/topic/The%20Rust%20Model%20of%20Error%20Handling/near/271143436" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Ed Page <a href="https://zulip-archive.rust-lang.org/stream/257204-project-error-handling/topic/The.20Rust.20Model.20of.20Error.20Handling.html#271143436">(Feb 08 2022 at 15:22)</a>:</h4>
<blockquote>
<p>Errors should be fast by default<br>
Errors should be informative by default</p>
</blockquote>
<p>Any thoughts on when these are in conflict (e.g. file errors)?</p>
<p>Anecdote: in one library, I ran into this tension and provided parallel <code>-&gt; Option</code> / <code>-&gt; Result</code> functions to make the performance / informative distinction clear.</p>
<blockquote>
<p>Introducing new errors or changing error messages shouldn’t be a breaking change by default</p>
</blockquote>
<p>I feel like "breaking changes" is a topic in of itself (encouraging stable APIs), for example</p>
<ul>
<li><code>?</code> encouraging <code>impl From</code> which puts implementation details in your public API </li>
<li>Implicit or explicit contracts around <code>source</code> which probably ties into your usage / best practice section</li>
</ul>



<a name="271143790"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257204-project-error-handling/topic/The%20Rust%20Model%20of%20Error%20Handling/near/271143790" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jane Lusby [she/her] <a href="https://zulip-archive.rust-lang.org/stream/257204-project-error-handling/topic/The.20Rust.20Model.20of.20Error.20Handling.html#271143790">(Feb 08 2022 at 15:25)</a>:</h4>
<blockquote>
<p>Any thoughts on when these are in conflict (e.g. file errors)?</p>
</blockquote>
<p>I think they're pretty commonly in conflict, like you said, the question of whether or not to include a PathBuf in a file error by default. My expectation is that we would prioritize fast by default over informative by default given previous decisions, but we could revisit that decision and changing our mind could certainly have a large impact!</p>



<a name="271146244"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257204-project-error-handling/topic/The%20Rust%20Model%20of%20Error%20Handling/near/271146244" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Nick Cameron <a href="https://zulip-archive.rust-lang.org/stream/257204-project-error-handling/topic/The.20Rust.20Model.20of.20Error.20Handling.html#271146244">(Feb 08 2022 at 15:41)</a>:</h4>
<p>For core features (and maybe areas of confusion), I think it would be good to mention the different kinds of backtraces, and how they are constructed. Off the top of my head: backtraces in Errors , on panics, and in debuggers</p>



<a name="271146455"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257204-project-error-handling/topic/The%20Rust%20Model%20of%20Error%20Handling/near/271146455" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Nick Cameron <a href="https://zulip-archive.rust-lang.org/stream/257204-project-error-handling/topic/The.20Rust.20Model.20of.20Error.20Handling.html#271146455">(Feb 08 2022 at 15:42)</a>:</h4>
<p>For core features: probably worth mentioning concrete errors vs trait object errors more explicitly</p>



<a name="271146771"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257204-project-error-handling/topic/The%20Rust%20Model%20of%20Error%20Handling/near/271146771" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Nick Cameron <a href="https://zulip-archive.rust-lang.org/stream/257204-project-error-handling/topic/The.20Rust.20Model.20of.20Error.20Handling.html#271146771">(Feb 08 2022 at 15:44)</a>:</h4>
<p>On error reporting, I think it might be worth mentioning reporting errors for programmers doing debugging or in logs, vs reporting errors to users (which is really error handling not error reporting, but I think that can be confusing)</p>



<a name="271146823"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257204-project-error-handling/topic/The%20Rust%20Model%20of%20Error%20Handling/near/271146823" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jane Lusby [she/her] <a href="https://zulip-archive.rust-lang.org/stream/257204-project-error-handling/topic/The.20Rust.20Model.20of.20Error.20Handling.html#271146823">(Feb 08 2022 at 15:45)</a>:</h4>
<p><span class="user-mention silent" data-user-id="256841">Nick Cameron</span> <a href="#narrow/stream/257204-project-error-handling/topic/The.20Rust.20Model.20of.20Error.20Handling/near/271146771">said</a>:</p>
<blockquote>
<p>On error reporting, I think it might be worth mentioning reporting errors for programmers doing debugging or in logs, vs reporting errors to users (which is really error handling not error reporting, but I think that can be confusing)</p>
</blockquote>
<p>I think i did mention this one, let me check</p>



<a name="271146880"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257204-project-error-handling/topic/The%20Rust%20Model%20of%20Error%20Handling/near/271146880" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jane Lusby [she/her] <a href="https://zulip-archive.rust-lang.org/stream/257204-project-error-handling/topic/The.20Rust.20Model.20of.20Error.20Handling.html#271146880">(Feb 08 2022 at 15:45)</a>:</h4>
<blockquote>
<ul>
<li>It should be possible for the same error to be formatted differently depending on where it is being displayed (e.g. multiple lines if going to a terminal but all in a single line if going to a log file)</li>
</ul>
</blockquote>



<a name="271146989"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257204-project-error-handling/topic/The%20Rust%20Model%20of%20Error%20Handling/near/271146989" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jane Lusby [she/her] <a href="https://zulip-archive.rust-lang.org/stream/257204-project-error-handling/topic/The.20Rust.20Model.20of.20Error.20Handling.html#271146989">(Feb 08 2022 at 15:46)</a>:</h4>
<p>i can make this more explicit about why you'd want to do that (e.g. reporting to users vs reporting to devs)</p>



<a name="271146998"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257204-project-error-handling/topic/The%20Rust%20Model%20of%20Error%20Handling/near/271146998" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Nick Cameron <a href="https://zulip-archive.rust-lang.org/stream/257204-project-error-handling/topic/The.20Rust.20Model.20of.20Error.20Handling.html#271146998">(Feb 08 2022 at 15:46)</a>:</h4>
<p>sorry kid just came home, more later,,,</p>



<a name="271161354"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257204-project-error-handling/topic/The%20Rust%20Model%20of%20Error%20Handling/near/271161354" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Nick Cameron <a href="https://zulip-archive.rust-lang.org/stream/257204-project-error-handling/topic/The.20Rust.20Model.20of.20Error.20Handling.html#271161354">(Feb 08 2022 at 17:24)</a>:</h4>
<p>Yeah, I was thinking of a higher level  division than that, I think. Like in terminal case there is a difference between essentially just logging the error (which is actually what most Rust CLI apps do, due to being often aimed at devs, or immaturity) and producing a 'good' message for the user. In particular that might include localisation or fancy rendering (like the rustc error messages with code snippets). And an internal error might need to be both logged and rendered for the user. (Oh and if its not a CLI app, the error will need rendering as graphics or a dialog box or whatever)</p>



<a name="271161482"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257204-project-error-handling/topic/The%20Rust%20Model%20of%20Error%20Handling/near/271161482" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Nick Cameron <a href="https://zulip-archive.rust-lang.org/stream/257204-project-error-handling/topic/The.20Rust.20Model.20of.20Error.20Handling.html#271161482">(Feb 08 2022 at 17:25)</a>:</h4>
<p>So I guess you cover it with "formatted differently" but I feel like that doesn't do justice to the difference in approaches</p>



<a name="271161547"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257204-project-error-handling/topic/The%20Rust%20Model%20of%20Error%20Handling/near/271161547" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Nick Cameron <a href="https://zulip-archive.rust-lang.org/stream/257204-project-error-handling/topic/The.20Rust.20Model.20of.20Error.20Handling.html#271161547">(Feb 08 2022 at 17:25)</a>:</h4>
<p>It would be uncommon to have one code path with different formatting rules , I guess</p>



<a name="271161804"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257204-project-error-handling/topic/The%20Rust%20Model%20of%20Error%20Handling/near/271161804" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Nick Cameron <a href="https://zulip-archive.rust-lang.org/stream/257204-project-error-handling/topic/The.20Rust.20Model.20of.20Error.20Handling.html#271161804">(Feb 08 2022 at 17:27)</a>:</h4>
<p>Not sure if you want to cover this, but under areas of confusion you could add whether to use a library and if so which one(s), and if multiple, how do they combine/interact</p>



<a name="271162748"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257204-project-error-handling/topic/The%20Rust%20Model%20of%20Error%20Handling/near/271162748" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Ed Page <a href="https://zulip-archive.rust-lang.org/stream/257204-project-error-handling/topic/The.20Rust.20Model.20of.20Error.20Handling.html#271162748">(Feb 08 2022 at 17:33)</a>:</h4>
<blockquote>
<p>Yeah, I was thinking of a higher level division than that, I think. Like in terminal case there is a difference between essentially just logging the error (which is actually what most Rust CLI apps do, due to being often aimed at devs, or immaturity) and producing a 'good' message for the user. In particular that might include localisation or fancy rendering (like the rustc error messages with code snippets). </p>
</blockquote>
<p>Balancing user-reporting vs logging is tricky.</p>
<ul>
<li>Clap focuses on user-reporting and we are getting some requests for instead doing logging (since they are already logging). </li>
<li><code>toml_edit</code> also does user-reporting while <code>toml-rs</code> did formatted for error logging but at the cost of <code>toml_edit</code> not providing the details for error logging.</li>
</ul>
<p>I feel like the common Rust pattern for providing context via chaining only helps with error logging but doesn't work well for user reporting.  Chains tend to just be a linked list of disparate messages without coherence or a contract on how to combine opaquely (via <code>Display</code>) or via downcasts.  <code>clap</code> is experimenting with providing all of its user-reporting data as a <code>Vec&lt;(ContextKind, ContextValue)&gt;</code> so we can provide a contract on what any of the context means.</p>



<a name="271162844"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257204-project-error-handling/topic/The%20Rust%20Model%20of%20Error%20Handling/near/271162844" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jane Lusby [she/her] <a href="https://zulip-archive.rust-lang.org/stream/257204-project-error-handling/topic/The.20Rust.20Model.20of.20Error.20Handling.html#271162844">(Feb 08 2022 at 17:33)</a>:</h4>
<p><span class="user-mention silent" data-user-id="256841">Nick Cameron</span> <a href="#narrow/stream/257204-project-error-handling/topic/The.20Rust.20Model.20of.20Error.20Handling/near/271161804">said</a>:</p>
<blockquote>
<p>Not sure if you want to cover this, but under areas of confusion you could add whether to use a library and if so which one(s), and if multiple, how do they combine/interact</p>
</blockquote>
<p>that seems like a good idea, but also I don't want this to be all controlled by me. A big part of why I want to do this model of errors is because I want to make sure that my conceptualization of error handling in rust is aligned with the rest of the community's. I'm worried that I've done a poor job including other perspectives and I want to make sure I'm not just forcing my ideas on everyone else.</p>



<a name="271162941"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257204-project-error-handling/topic/The%20Rust%20Model%20of%20Error%20Handling/near/271162941" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jane Lusby [she/her] <a href="https://zulip-archive.rust-lang.org/stream/257204-project-error-handling/topic/The.20Rust.20Model.20of.20Error.20Handling.html#271162941">(Feb 08 2022 at 17:34)</a>:</h4>
<p>which along those lines, can everyone else edit this document?</p>



<a name="271165336"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257204-project-error-handling/topic/The%20Rust%20Model%20of%20Error%20Handling/near/271165336" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sean Chen (he/him) <a href="https://zulip-archive.rust-lang.org/stream/257204-project-error-handling/topic/The.20Rust.20Model.20of.20Error.20Handling.html#271165336">(Feb 08 2022 at 17:52)</a>:</h4>
<p><span class="user-mention silent" data-user-id="220273">Jane Lusby [she/her]</span> <a href="#narrow/stream/257204-project-error-handling/topic/The.20Rust.20Model.20of.20Error.20Handling/near/271162941">said</a>:</p>
<blockquote>
<p>which along those lines, can everyone else edit this document?</p>
</blockquote>
<p>Yep</p>



<a name="271255605"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257204-project-error-handling/topic/The%20Rust%20Model%20of%20Error%20Handling/near/271255605" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Nick Cameron <a href="https://zulip-archive.rust-lang.org/stream/257204-project-error-handling/topic/The.20Rust.20Model.20of.20Error.20Handling.html#271255605">(Feb 09 2022 at 10:20)</a>:</h4>
<p>I did some editing and added a comment to clarify one point</p>



<a name="271275833"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257204-project-error-handling/topic/The%20Rust%20Model%20of%20Error%20Handling/near/271275833" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Plecra <a href="https://zulip-archive.rust-lang.org/stream/257204-project-error-handling/topic/The.20Rust.20Model.20of.20Error.20Handling.html#271275833">(Feb 09 2022 at 13:28)</a>:</h4>
<blockquote>
<p>Unrecoverable error propagation should be hidden / should not affect public APIs</p>
</blockquote>
<p>I'm not sure I'm understanding this right. This seems to describe panics, but I also would've thought <code>Result::Err</code>s which result in a <code>std::process::exit</code> as often unrecoverable. I think that aligns with the definition given as well?</p>



<a name="271276432"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257204-project-error-handling/topic/The%20Rust%20Model%20of%20Error%20Handling/near/271276432" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Plecra <a href="https://zulip-archive.rust-lang.org/stream/257204-project-error-handling/topic/The.20Rust.20Model.20of.20Error.20Handling.html#271276432">(Feb 09 2022 at 13:33)</a>:</h4>
<blockquote>
<p>The relationship between panics (unrecoverable error handling) and the error trait / result (recoverable error handling)</p>
</blockquote>
<p>Woah! Yeah, I thought this might be what threw me off. Recoverability, as laid out in "Recoverable and unrecoverable errors", has nothing to do with panic vs Result. It's a higher level property of the actual error condition being one that the application can't do anything about.</p>



<a name="271280404"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257204-project-error-handling/topic/The%20Rust%20Model%20of%20Error%20Handling/near/271280404" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Plecra <a href="https://zulip-archive.rust-lang.org/stream/257204-project-error-handling/topic/The.20Rust.20Model.20of.20Error.20Handling.html#271280404">(Feb 09 2022 at 13:54)</a>:</h4>
<p>(Btw, from my experience with error crates, I suspect things like <code>thiserror</code> aren't actually very helpful. The public enum design is only suitable in a very select few cases, and it normally doesn't make any sense to directly surface the errors from other libraries. I've found nearly every library is better served by a small, deliberately designed opaque error type. I'd definitely like to explore some real world cases to see if we can give good advice about writing custom error types)</p>



<a name="271281253"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257204-project-error-handling/topic/The%20Rust%20Model%20of%20Error%20Handling/near/271281253" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Nick Cameron <a href="https://zulip-archive.rust-lang.org/stream/257204-project-error-handling/topic/The.20Rust.20Model.20of.20Error.20Handling.html#271281253">(Feb 09 2022 at 14:00)</a>:</h4>
<p>There might be a mismatch because I wrote the definition for recoverable and unrecoverable errors and Jane wrote the lower down bit, I think we have different opinions about the precise meaning</p>



<a name="271282009"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257204-project-error-handling/topic/The%20Rust%20Model%20of%20Error%20Handling/near/271282009" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Plecra <a href="https://zulip-archive.rust-lang.org/stream/257204-project-error-handling/topic/The.20Rust.20Model.20of.20Error.20Handling.html#271282009">(Feb 09 2022 at 14:04)</a>:</h4>
<p>Absolutely fair enough :) I was adding my take on the difference between the two</p>



<a name="271283311"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257204-project-error-handling/topic/The%20Rust%20Model%20of%20Error%20Handling/near/271283311" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Nick Cameron <a href="https://zulip-archive.rust-lang.org/stream/257204-project-error-handling/topic/The.20Rust.20Model.20of.20Error.20Handling.html#271283311">(Feb 09 2022 at 14:13)</a>:</h4>
<p><span class="user-mention silent" data-user-id="263805">Plecra</span> <a href="#narrow/stream/257204-project-error-handling/topic/The.20Rust.20Model.20of.20Error.20Handling/near/271280404">said</a>:</p>
<blockquote>
<p>(Btw, from my experience with error crates, I suspect things like <code>thiserror</code> aren't actually very helpful. The public enum design is only suitable in a very select few cases, and it normally doesn't make any sense to directly surface the errors from other libraries. I've found nearly every library is better served by a small, deliberately designed opaque error type. I'd definitely like to explore some real world cases to see if we can give good advice about writing custom error types)</p>
</blockquote>
<p>I feel like this is the $64k question for error handling. On the one hand the 'enum of errors' works really well locally recovering from errors. OTOH it doesn't scale well and it is way more common for errors to be handled remotely and generically. However, I haven't seen any good guidance on exactly when to use one or the other and where to convert between the two.</p>



<a name="271283444"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257204-project-error-handling/topic/The%20Rust%20Model%20of%20Error%20Handling/near/271283444" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Nick Cameron <a href="https://zulip-archive.rust-lang.org/stream/257204-project-error-handling/topic/The.20Rust.20Model.20of.20Error.20Handling.html#271283444">(Feb 09 2022 at 14:14)</a>:</h4>
<p>(I had this idea of 'error modules' at some point of the boundaries where one converts from concrete to abstract errors, but I don't think it is actually very helpful)</p>



<a name="271480287"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257204-project-error-handling/topic/The%20Rust%20Model%20of%20Error%20Handling/near/271480287" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Ben Reeves <a href="https://zulip-archive.rust-lang.org/stream/257204-project-error-handling/topic/The.20Rust.20Model.20of.20Error.20Handling.html#271480287">(Feb 10 2022 at 19:16)</a>:</h4>
<p>Just seeing this now. I realize I've been a bit off the radar recently, but I'm still very much at work on the error return tracing stuff at my job. I'll see if I can take a look at the draft and offer any perspective from the error tracing side of things, if that would be valuable</p>



<a name="271481666"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257204-project-error-handling/topic/The%20Rust%20Model%20of%20Error%20Handling/near/271481666" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jane Lusby [she/her] <a href="https://zulip-archive.rust-lang.org/stream/257204-project-error-handling/topic/The.20Rust.20Model.20of.20Error.20Handling.html#271481666">(Feb 10 2022 at 19:26)</a>:</h4>
<p><span class="user-mention silent" data-user-id="435059">Ben Reeves</span> <a href="#narrow/stream/257204-project-error-handling/topic/The.20Rust.20Model.20of.20Error.20Handling/near/271480287">said</a>:</p>
<blockquote>
<p>Just seeing this now. I realize I've been a bit off the radar recently, but I'm still very much at work on the error return tracing stuff at my job. I'll see if I can take a look at the draft and offer any perspective from the error tracing side of things, if that would be valuable</p>
</blockquote>
<p>yes please!</p>



<a name="271481687"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257204-project-error-handling/topic/The%20Rust%20Model%20of%20Error%20Handling/near/271481687" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jane Lusby [she/her] <a href="https://zulip-archive.rust-lang.org/stream/257204-project-error-handling/topic/The.20Rust.20Model.20of.20Error.20Handling.html#271481687">(Feb 10 2022 at 19:26)</a>:</h4>
<p>though also any thoughts on error handling in general would also be quite welcome</p>



<a name="271481720"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257204-project-error-handling/topic/The%20Rust%20Model%20of%20Error%20Handling/near/271481720" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jane Lusby [she/her] <a href="https://zulip-archive.rust-lang.org/stream/257204-project-error-handling/topic/The.20Rust.20Model.20of.20Error.20Handling.html#271481720">(Feb 10 2022 at 19:26)</a>:</h4>
<p>trying to get as diverse a set of perspectives as I can</p>



<a name="271507050"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257204-project-error-handling/topic/The%20Rust%20Model%20of%20Error%20Handling/near/271507050" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Vincent Isambart <a href="https://zulip-archive.rust-lang.org/stream/257204-project-error-handling/topic/The.20Rust.20Model.20of.20Error.20Handling.html#271507050">(Feb 10 2022 at 22:55)</a>:</h4>
<p>Reading this thread, one think that came to mind: How do you handle internationalization in the opaque error type case?<br>
If it's a crate you control, you could make sure all the strings you need are extracted, but for a third party crate, with currently no real internationalization standard crate I know of, that seems difficult.</p>



<a name="271542779"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257204-project-error-handling/topic/The%20Rust%20Model%20of%20Error%20Handling/near/271542779" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Nick Cameron <a href="https://zulip-archive.rust-lang.org/stream/257204-project-error-handling/topic/The.20Rust.20Model.20of.20Error.20Handling.html#271542779">(Feb 11 2022 at 08:13)</a>:</h4>
<p>You could still extract data from an opaque type that could then be localised, either by downcasting or by generic member access. But the app has to know what to expect from the errors, which signals to me that a purely opaque type is the wrong abstraction</p>



<a name="271583161"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257204-project-error-handling/topic/The%20Rust%20Model%20of%20Error%20Handling/near/271583161" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Plecra <a href="https://zulip-archive.rust-lang.org/stream/257204-project-error-handling/topic/The.20Rust.20Model.20of.20Error.20Handling.html#271583161">(Feb 11 2022 at 14:20)</a>:</h4>
<p>Intuitively, it seems like i18n of errors is something that an application will have to implement manually for concrete error types. Libraries won't reliably provide translations for any given language a caller wants in generic code.</p>



<a name="271583301"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257204-project-error-handling/topic/The%20Rust%20Model%20of%20Error%20Handling/near/271583301" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Plecra <a href="https://zulip-archive.rust-lang.org/stream/257204-project-error-handling/topic/The.20Rust.20Model.20of.20Error.20Handling.html#271583301">(Feb 11 2022 at 14:21)</a>:</h4>
<p>What would a good API look like here? I think we have to assume that crates will rarely give non-english errors themselves.</p>



<a name="271588419"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257204-project-error-handling/topic/The%20Rust%20Model%20of%20Error%20Handling/near/271588419" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Nick Cameron <a href="https://zulip-archive.rust-lang.org/stream/257204-project-error-handling/topic/The.20Rust.20Model.20of.20Error.20Handling.html#271588419">(Feb 11 2022 at 15:00)</a>:</h4>
<p>Right, and its not just i18n, I think in general to present an error to a user there is a processing step that can only be accomplished by the application, not the upstream crates, e.g., rendering in a GUI, forwarding to a web frontend, adjusting the error message to be optimal for the <br>
audience, etc. Upstream libs can only make error messages suitable for logging (and even then, your app might want to do structured logging or filtering, etc.). Basically I think errors should be data structures and shouldn't try to make error messages, ever</p>



<a name="271589500"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257204-project-error-handling/topic/The%20Rust%20Model%20of%20Error%20Handling/near/271589500" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Ed Page <a href="https://zulip-archive.rust-lang.org/stream/257204-project-error-handling/topic/The.20Rust.20Model.20of.20Error.20Handling.html#271589500">(Feb 11 2022 at 15:08)</a>:</h4>
<blockquote>
<p>Basically I think errors should be data structures</p>
</blockquote>
<p>While I agree, it presents its own challenges.  You either need to either know about all error types, with graceful fallbacks, or you need common patterns and vocabulary terms so you can generically process all errors.</p>
<p>Examples of systems I worked on include:</p>
<ul>
<li><code>Vec&lt;Key, Value&gt;</code> where <code>Key</code> was shared across multiple products that were integrated and there was a localization table for <code>Key</code>.  <code>Value</code> was a <code>Box&lt;Any&gt;</code> with one type in it was another localization lookup key.  We would just render the context as a bulleted list after a static description pulled from a localization table based on the <code>ErrorKind</code></li>
<li>The error contains a key and a json blob.  The key is to look up the renderer for the json blob.</li>
</ul>



<a name="276415920"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257204-project-error-handling/topic/The%20Rust%20Model%20of%20Error%20Handling/near/276415920" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jane Lusby [she/her] <a href="https://zulip-archive.rust-lang.org/stream/257204-project-error-handling/topic/The.20Rust.20Model.20of.20Error.20Handling.html#276415920">(Mar 23 2022 at 23:27)</a>:</h4>
<p>revisiting this again today, I'm thinking about taking the discussion we had so far and trying to start a broader conversation about the strengths and weaknesses of rust error handling today</p>



<a name="276415932"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257204-project-error-handling/topic/The%20Rust%20Model%20of%20Error%20Handling/near/276415932" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jane Lusby [she/her] <a href="https://zulip-archive.rust-lang.org/stream/257204-project-error-handling/topic/The.20Rust.20Model.20of.20Error.20Handling.html#276415932">(Mar 23 2022 at 23:27)</a>:</h4>
<p>and then basically make some sort of call for blog posts or something similar</p>



<a name="276428259"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257204-project-error-handling/topic/The%20Rust%20Model%20of%20Error%20Handling/near/276428259" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jane Lusby [she/her] <a href="https://zulip-archive.rust-lang.org/stream/257204-project-error-handling/topic/The.20Rust.20Model.20of.20Error.20Handling.html#276428259">(Mar 24 2022 at 03:06)</a>:</h4>
<p>started out with this</p>



<a name="276428260"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257204-project-error-handling/topic/The%20Rust%20Model%20of%20Error%20Handling/near/276428260" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jane Lusby [she/her] <a href="https://zulip-archive.rust-lang.org/stream/257204-project-error-handling/topic/The.20Rust.20Model.20of.20Error.20Handling.html#276428260">(Mar 24 2022 at 03:06)</a>:</h4>
<p><a href="https://twitter.com/yaahc_/status/1506799278211014658?s=20&amp;t=yx-qegk-Zrf-mmRBfkVkfw">https://twitter.com/yaahc_/status/1506799278211014658?s=20&amp;t=yx-qegk-Zrf-mmRBfkVkfw</a></p>
<div class="inline-preview-twitter"><div class="twitter-tweet"><a href="https://twitter.com/yaahc_/status/1506799278211014658?s=20&amp;t=yx-qegk-Zrf-mmRBfkVkfw"><img class="twitter-avatar" src="https://uploads.zulipusercontent.net/eeaff3a60f7422ff43d15ea1fba5c17154dd4cc3/68747470733a2f2f7062732e7477696d672e636f6d2f70726f66696c655f696d616765732f313236303734363233383532373332343136322f6f4d4a48724846435f6e6f726d616c2e6a7067"></a><p>Hey <a href="https://twitter.com/rustlang">@rustlang</a> community, show me your best or worst error handling code in rust

I'm doing an analysis of the strengths, weaknesses, best pratices, and footguns of rust error handling for the error handling project group and could use some more examples.</p><span>- Yaah (@yaahc_)</span></div></div>



<a name="276432871"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257204-project-error-handling/topic/The%20Rust%20Model%20of%20Error%20Handling/near/276432871" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Nelson <a href="https://zulip-archive.rust-lang.org/stream/257204-project-error-handling/topic/The.20Rust.20Model.20of.20Error.20Handling.html#276432871">(Mar 24 2022 at 05:02)</a>:</h4>
<p><a href="https://nitter.net/mgattozzi/status/1506809138101297152#m">https://nitter.net/mgattozzi/status/1506809138101297152#m</a> definitely reflects my experience trying to buffer errors, it's very painful</p>



<a name="276432900"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257204-project-error-handling/topic/The%20Rust%20Model%20of%20Error%20Handling/near/276432900" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Nelson <a href="https://zulip-archive.rust-lang.org/stream/257204-project-error-handling/topic/The.20Rust.20Model.20of.20Error.20Handling.html#276432900">(Mar 24 2022 at 05:03)</a>:</h4>
<p>Every place with Result suddenly needs a <code>match</code> and ... some other things I don't remember, it's been nearly 3 years at this point</p>



<a name="276432966"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257204-project-error-handling/topic/The%20Rust%20Model%20of%20Error%20Handling/near/276432966" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jane Lusby [she/her] <a href="https://zulip-archive.rust-lang.org/stream/257204-project-error-handling/topic/The.20Rust.20Model.20of.20Error.20Handling.html#276432966">(Mar 24 2022 at 05:05)</a>:</h4>
<p>I'd love to see and play with an example</p>



<a name="276432974"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257204-project-error-handling/topic/The%20Rust%20Model%20of%20Error%20Handling/near/276432974" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jane Lusby [she/her] <a href="https://zulip-archive.rust-lang.org/stream/257204-project-error-handling/topic/The.20Rust.20Model.20of.20Error.20Handling.html#276432974">(Mar 24 2022 at 05:05)</a>:</h4>
<p>If you have any you can share</p>



<a name="276432978"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257204-project-error-handling/topic/The%20Rust%20Model%20of%20Error%20Handling/near/276432978" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Nelson <a href="https://zulip-archive.rust-lang.org/stream/257204-project-error-handling/topic/The.20Rust.20Model.20of.20Error.20Handling.html#276432978">(Mar 24 2022 at 05:05)</a>:</h4>
<p>I don't remember where I read this, but I vaguely recall reading a suggestion about "localized global handlers", where you say </p>
<div class="codehilite" data-code-language="Rust"><pre><span></span><code><span class="n">with</span><span class="w"> </span><span class="s">"error-handler"</span><span class="w"> </span><span class="o">|</span><span class="n">err</span><span class="o">|</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="o">..</span><span class="p">.</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>
</code></pre></div>
<p>and that sounded super cool</p>



<a name="276433021"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257204-project-error-handling/topic/The%20Rust%20Model%20of%20Error%20Handling/near/276433021" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Nelson <a href="https://zulip-archive.rust-lang.org/stream/257204-project-error-handling/topic/The.20Rust.20Model.20of.20Error.20Handling.html#276433021">(Mar 24 2022 at 05:06)</a>:</h4>
<p>Oh sure let me pull up the code</p>



<a name="276433071"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257204-project-error-handling/topic/The%20Rust%20Model%20of%20Error%20Handling/near/276433071" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Nelson <a href="https://zulip-archive.rust-lang.org/stream/257204-project-error-handling/topic/The.20Rust.20Model.20of.20Error.20Handling.html#276433071">(Mar 24 2022 at 05:07)</a>:</h4>
<p>ok, here's one example: <a href="https://github.com/jyn514/saltwater/blob/097c72d30e325de57fbed8a506431754a0560374/saltwater-parser/analyze/expr.rs#L109-L115">https://github.com/jyn514/saltwater/blob/097c72d30e325de57fbed8a506431754a0560374/saltwater-parser/analyze/expr.rs#L109-L115</a><br>
<code>self.err</code> buffers the error for later handling</p>



<a name="276433113"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257204-project-error-handling/topic/The%20Rust%20Model%20of%20Error%20Handling/near/276433113" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Nelson <a href="https://zulip-archive.rust-lang.org/stream/257204-project-error-handling/topic/The.20Rust.20Model.20of.20Error.20Handling.html#276433113">(Mar 24 2022 at 05:08)</a>:</h4>
<p>without immediately returning and preventing further errors from being reported</p>



<a name="276433139"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257204-project-error-handling/topic/The%20Rust%20Model%20of%20Error%20Handling/near/276433139" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Nelson <a href="https://zulip-archive.rust-lang.org/stream/257204-project-error-handling/topic/The.20Rust.20Model.20of.20Error.20Handling.html#276433139">(Mar 24 2022 at 05:09)</a>:</h4>
<p>ah yeah now I'm remembering why this is annoying <a href="https://github.com/jyn514/saltwater/blob/097c72d30e325de57fbed8a506431754a0560374/saltwater-parser/data/error.rs#L13">https://github.com/jyn514/saltwater/blob/097c72d30e325de57fbed8a506431754a0560374/saltwater-parser/data/error.rs#L13</a></p>



<a name="276433144"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257204-project-error-handling/topic/The%20Rust%20Model%20of%20Error%20Handling/near/276433144" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Nelson <a href="https://zulip-archive.rust-lang.org/stream/257204-project-error-handling/topic/The.20Rust.20Model.20of.20Error.20Handling.html#276433144">(Mar 24 2022 at 05:09)</a>:</h4>
<p>there's absolutely no existing abstractions for this, you have to come up with your own models</p>



<a name="276433162"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257204-project-error-handling/topic/The%20Rust%20Model%20of%20Error%20Handling/near/276433162" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jane Lusby [she/her] <a href="https://zulip-archive.rust-lang.org/stream/257204-project-error-handling/topic/The.20Rust.20Model.20of.20Error.20Handling.html#276433162">(Mar 24 2022 at 05:09)</a>:</h4>
<p>Yeah</p>



<a name="276433215"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257204-project-error-handling/topic/The%20Rust%20Model%20of%20Error%20Handling/near/276433215" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Nelson <a href="https://zulip-archive.rust-lang.org/stream/257204-project-error-handling/topic/The.20Rust.20Model.20of.20Error.20Handling.html#276433215">(Mar 24 2022 at 05:10)</a>:</h4>
<p><code>location.with(err)</code> is also not my favorite<br>
<a href="https://github.com/jyn514/saltwater/blob/097c72d30e325de57fbed8a506431754a0560374/saltwater-parser/data/error.rs#L62">https://github.com/jyn514/saltwater/blob/097c72d30e325de57fbed8a506431754a0560374/saltwater-parser/data/error.rs#L62</a></p>



<a name="276433222"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257204-project-error-handling/topic/The%20Rust%20Model%20of%20Error%20Handling/near/276433222" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Nelson <a href="https://zulip-archive.rust-lang.org/stream/257204-project-error-handling/topic/The.20Rust.20Model.20of.20Error.20Handling.html#276433222">(Mar 24 2022 at 05:10)</a>:</h4>
<p>but not sure there's any way around that, since <code>location</code> has no relation to the stack trace, it's a diagnostic span pointing somewhere in the input</p>



<a name="276433315"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257204-project-error-handling/topic/The%20Rust%20Model%20of%20Error%20Handling/near/276433315" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Nelson <a href="https://zulip-archive.rust-lang.org/stream/257204-project-error-handling/topic/The.20Rust.20Model.20of.20Error.20Handling.html#276433315">(Mar 24 2022 at 05:12)</a>:</h4>
<p>LOL I just remembered this is the enum that <span class="user-mention silent" data-user-id="119235">David Tolnay</span> used as a test suite for thiserror <a href="https://github.com/jyn514/saltwater/blob/097c72d30e325de57fbed8a506431754a0560374/saltwater-parser/data/error.rs#L107">https://github.com/jyn514/saltwater/blob/097c72d30e325de57fbed8a506431754a0560374/saltwater-parser/data/error.rs#L107</a></p>



<a name="276433344"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257204-project-error-handling/topic/The%20Rust%20Model%20of%20Error%20Handling/near/276433344" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jane Lusby [she/her] <a href="https://zulip-archive.rust-lang.org/stream/257204-project-error-handling/topic/The.20Rust.20Model.20of.20Error.20Handling.html#276433344">(Mar 24 2022 at 05:12)</a>:</h4>
<p>Lol</p>



<a name="276433345"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257204-project-error-handling/topic/The%20Rust%20Model%20of%20Error%20Handling/near/276433345" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jane Lusby [she/her] <a href="https://zulip-archive.rust-lang.org/stream/257204-project-error-handling/topic/The.20Rust.20Model.20of.20Error.20Handling.html#276433345">(Mar 24 2022 at 05:13)</a>:</h4>
<p>Nice</p>



<a name="276433362"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257204-project-error-handling/topic/The%20Rust%20Model%20of%20Error%20Handling/near/276433362" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jane Lusby [she/her] <a href="https://zulip-archive.rust-lang.org/stream/257204-project-error-handling/topic/The.20Rust.20Model.20of.20Error.20Handling.html#276433362">(Mar 24 2022 at 05:13)</a>:</h4>
<p>And yeah, errors for parsers and compliers are some of the hardest to represent with error trait as it is currently, and aggregated errors</p>



<a name="276433402"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257204-project-error-handling/topic/The%20Rust%20Model%20of%20Error%20Handling/near/276433402" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jane Lusby [she/her] <a href="https://zulip-archive.rust-lang.org/stream/257204-project-error-handling/topic/The.20Rust.20Model.20of.20Error.20Handling.html#276433402">(Mar 24 2022 at 05:14)</a>:</h4>
<p>I feel like you handled it how I would have</p>



<a name="276433415"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257204-project-error-handling/topic/The%20Rust%20Model%20of%20Error%20Handling/near/276433415" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jane Lusby [she/her] <a href="https://zulip-archive.rust-lang.org/stream/257204-project-error-handling/topic/The.20Rust.20Model.20of.20Error.20Handling.html#276433415">(Mar 24 2022 at 05:14)</a>:</h4>
<p>Localized error handlers sounds kinda like an error effect handler</p>



<a name="276433421"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257204-project-error-handling/topic/The%20Rust%20Model%20of%20Error%20Handling/near/276433421" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Nelson <a href="https://zulip-archive.rust-lang.org/stream/257204-project-error-handling/topic/The.20Rust.20Model.20of.20Error.20Handling.html#276433421">(Mar 24 2022 at 05:14)</a>:</h4>
<p>I'm very surprised to hear that tbh <span aria-label="sweat smile" class="emoji emoji-1f605" role="img" title="sweat smile">:sweat_smile:</span> I wrote most of this code in my first few months of learning rust lol</p>



<a name="276433430"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257204-project-error-handling/topic/The%20Rust%20Model%20of%20Error%20Handling/near/276433430" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Nelson <a href="https://zulip-archive.rust-lang.org/stream/257204-project-error-handling/topic/The.20Rust.20Model.20of.20Error.20Handling.html#276433430">(Mar 24 2022 at 05:14)</a>:</h4>
<p>oh, maybe I rewrote the error handling later, don't remember</p>



<a name="276433445"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257204-project-error-handling/topic/The%20Rust%20Model%20of%20Error%20Handling/near/276433445" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Nelson <a href="https://zulip-archive.rust-lang.org/stream/257204-project-error-handling/topic/The.20Rust.20Model.20of.20Error.20Handling.html#276433445">(Mar 24 2022 at 05:15)</a>:</h4>
<p><span class="user-mention silent" data-user-id="220273">Jane Lusby [she/her]</span> <a href="#narrow/stream/257204-project-error-handling/topic/The.20Rust.20Model.20of.20Error.20Handling/near/276433415">said</a>:</p>
<blockquote>
<p>Localized error handlers sounds kinda like an error effect handler</p>
</blockquote>
<p>yeah that was the name I heard!</p>



<a name="276433456"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257204-project-error-handling/topic/The%20Rust%20Model%20of%20Error%20Handling/near/276433456" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Nelson <a href="https://zulip-archive.rust-lang.org/stream/257204-project-error-handling/topic/The.20Rust.20Model.20of.20Error.20Handling.html#276433456">(Mar 24 2022 at 05:15)</a>:</h4>
<p>"effect handlers", somewhere in #langdev on the community server</p>



<a name="276433457"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257204-project-error-handling/topic/The%20Rust%20Model%20of%20Error%20Handling/near/276433457" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jane Lusby [she/her] <a href="https://zulip-archive.rust-lang.org/stream/257204-project-error-handling/topic/The.20Rust.20Model.20of.20Error.20Handling.html#276433457">(Mar 24 2022 at 05:15)</a>:</h4>
<p>Aah, yea that tracks</p>



<a name="276433468"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257204-project-error-handling/topic/The%20Rust%20Model%20of%20Error%20Handling/near/276433468" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jane Lusby [she/her] <a href="https://zulip-archive.rust-lang.org/stream/257204-project-error-handling/topic/The.20Rust.20Model.20of.20Error.20Handling.html#276433468">(Mar 24 2022 at 05:15)</a>:</h4>
<p>I've been talking with niko about effect handlers but it's mostly from a lang theory perspective and not really something that seems easy to add to rust</p>



<a name="276433517"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257204-project-error-handling/topic/The%20Rust%20Model%20of%20Error%20Handling/near/276433517" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jane Lusby [she/her] <a href="https://zulip-archive.rust-lang.org/stream/257204-project-error-handling/topic/The.20Rust.20Model.20of.20Error.20Handling.html#276433517">(Mar 24 2022 at 05:16)</a>:</h4>
<p>Just me being interested in it for the very reasons it's hard here</p>



<a name="276433518"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257204-project-error-handling/topic/The%20Rust%20Model%20of%20Error%20Handling/near/276433518" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jane Lusby [she/her] <a href="https://zulip-archive.rust-lang.org/stream/257204-project-error-handling/topic/The.20Rust.20Model.20of.20Error.20Handling.html#276433518">(Mar 24 2022 at 05:16)</a>:</h4>
<p>Lol</p>



<a name="276433623"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257204-project-error-handling/topic/The%20Rust%20Model%20of%20Error%20Handling/near/276433623" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Nelson <a href="https://zulip-archive.rust-lang.org/stream/257204-project-error-handling/topic/The.20Rust.20Model.20of.20Error.20Handling.html#276433623">(Mar 24 2022 at 05:18)</a>:</h4>
<p>/me needs to stop reading this code before he gets the urge to start working on it again</p>



<a name="276433990"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257204-project-error-handling/topic/The%20Rust%20Model%20of%20Error%20Handling/near/276433990" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jane Lusby [she/her] <a href="https://zulip-archive.rust-lang.org/stream/257204-project-error-handling/topic/The.20Rust.20Model.20of.20Error.20Handling.html#276433990">(Mar 24 2022 at 05:27)</a>:</h4>
<p>Loool</p>



<a name="276434006"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257204-project-error-handling/topic/The%20Rust%20Model%20of%20Error%20Handling/near/276434006" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Nelson <a href="https://zulip-archive.rust-lang.org/stream/257204-project-error-handling/topic/The.20Rust.20Model.20of.20Error.20Handling.html#276434006">(Mar 24 2022 at 05:27)</a>:</h4>
<p>Ok, here's another example: control flow is forced to be separate from error handling, I want <code>self.err</code> to always be coupled with <code>return pretend_zero</code> in this function, but there's no way to do that without a macro<br>
<a href="https://github.com/jyn514/saltwater/blob/097c72d30e325de57fbed8a506431754a0560374/saltwater-parser/analyze/expr.rs#L246">https://github.com/jyn514/saltwater/blob/097c72d30e325de57fbed8a506431754a0560374/saltwater-parser/analyze/expr.rs#L246</a></p>



<a name="276434064"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257204-project-error-handling/topic/The%20Rust%20Model%20of%20Error%20Handling/near/276434064" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jane Lusby [she/her] <a href="https://zulip-archive.rust-lang.org/stream/257204-project-error-handling/topic/The.20Rust.20Model.20of.20Error.20Handling.html#276434064">(Mar 24 2022 at 05:28)</a>:</h4>
<p>Could you have the return type pretend_zero only be synthesized by a err call?</p>



<a name="276434075"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257204-project-error-handling/topic/The%20Rust%20Model%20of%20Error%20Handling/near/276434075" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jane Lusby [she/her] <a href="https://zulip-archive.rust-lang.org/stream/257204-project-error-handling/topic/The.20Rust.20Model.20of.20Error.20Handling.html#276434075">(Mar 24 2022 at 05:28)</a>:</h4>
<p>So you just go return self.err(...); And any other code path is a compiler error,</p>



<a name="276434078"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257204-project-error-handling/topic/The%20Rust%20Model%20of%20Error%20Handling/near/276434078" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jane Lusby [she/her] <a href="https://zulip-archive.rust-lang.org/stream/257204-project-error-handling/topic/The.20Rust.20Model.20of.20Error.20Handling.html#276434078">(Mar 24 2022 at 05:29)</a>:</h4>
<p>Or maybe there's another way to create that as appropriate</p>



<a name="276434079"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257204-project-error-handling/topic/The%20Rust%20Model%20of%20Error%20Handling/near/276434079" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Nelson <a href="https://zulip-archive.rust-lang.org/stream/257204-project-error-handling/topic/The.20Rust.20Model.20of.20Error.20Handling.html#276434079">(Mar 24 2022 at 05:29)</a>:</h4>
<p>Hmm, I don't see a convenient way to do that. err() is used in many more places than just this function</p>



<a name="276434083"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257204-project-error-handling/topic/The%20Rust%20Model%20of%20Error%20Handling/near/276434083" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jane Lusby [she/her] <a href="https://zulip-archive.rust-lang.org/stream/257204-project-error-handling/topic/The.20Rust.20Model.20of.20Error.20Handling.html#276434083">(Mar 24 2022 at 05:29)</a>:</h4>
<p>Hmm</p>



<a name="276434091"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257204-project-error-handling/topic/The%20Rust%20Model%20of%20Error%20Handling/near/276434091" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Nelson <a href="https://zulip-archive.rust-lang.org/stream/257204-project-error-handling/topic/The.20Rust.20Model.20of.20Error.20Handling.html#276434091">(Mar 24 2022 at 05:29)</a>:</h4>
<p>using a closure might be possible but I'd be worried about borrowck errors from borrowing self</p>



<a name="276434313"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257204-project-error-handling/topic/The%20Rust%20Model%20of%20Error%20Handling/near/276434313" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Nelson <a href="https://zulip-archive.rust-lang.org/stream/257204-project-error-handling/topic/The.20Rust.20Model.20of.20Error.20Handling.html#276434313">(Mar 24 2022 at 05:34)</a>:</h4>
<p>Ok looking back this code is not as bad as I remember haha</p>



<a name="276434319"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257204-project-error-handling/topic/The%20Rust%20Model%20of%20Error%20Handling/near/276434319" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Nelson <a href="https://zulip-archive.rust-lang.org/stream/257204-project-error-handling/topic/The.20Rust.20Model.20of.20Error.20Handling.html#276434319">(Mar 24 2022 at 05:34)</a>:</h4>
<p>I rolled my own libraries and stuff but the call sites are pretty reasonable</p>



<a name="276434532"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257204-project-error-handling/topic/The%20Rust%20Model%20of%20Error%20Handling/near/276434532" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jane Lusby [she/her] <a href="https://zulip-archive.rust-lang.org/stream/257204-project-error-handling/topic/The.20Rust.20Model.20of.20Error.20Handling.html#276434532">(Mar 24 2022 at 05:40)</a>:</h4>
<p>So this method is aggregating the errors into self</p>



<a name="276434570"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257204-project-error-handling/topic/The%20Rust%20Model%20of%20Error%20Handling/near/276434570" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jane Lusby [she/her] <a href="https://zulip-archive.rust-lang.org/stream/257204-project-error-handling/topic/The.20Rust.20Model.20of.20Error.20Handling.html#276434570">(Mar 24 2022 at 05:40)</a>:</h4>
<p>(deleted)</p>



<a name="276434571"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257204-project-error-handling/topic/The%20Rust%20Model%20of%20Error%20Handling/near/276434571" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jane Lusby [she/her] <a href="https://zulip-archive.rust-lang.org/stream/257204-project-error-handling/topic/The.20Rust.20Model.20of.20Error.20Handling.html#276434571">(Mar 24 2022 at 05:40)</a>:</h4>
<p>But each call only produces one error right?</p>



<a name="276434588"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257204-project-error-handling/topic/The%20Rust%20Model%20of%20Error%20Handling/near/276434588" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jane Lusby [she/her] <a href="https://zulip-archive.rust-lang.org/stream/257204-project-error-handling/topic/The.20Rust.20Model.20of.20Error.20Handling.html#276434588">(Mar 24 2022 at 05:41)</a>:</h4>
<p>(deleted)</p>



<a name="276434590"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257204-project-error-handling/topic/The%20Rust%20Model%20of%20Error%20Handling/near/276434590" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jane Lusby [she/her] <a href="https://zulip-archive.rust-lang.org/stream/257204-project-error-handling/topic/The.20Rust.20Model.20of.20Error.20Handling.html#276434590">(Mar 24 2022 at 05:41)</a>:</h4>
<p>(deleted)</p>



<a name="276434591"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257204-project-error-handling/topic/The%20Rust%20Model%20of%20Error%20Handling/near/276434591" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jane Lusby [she/her] <a href="https://zulip-archive.rust-lang.org/stream/257204-project-error-handling/topic/The.20Rust.20Model.20of.20Error.20Handling.html#276434591">(Mar 24 2022 at 05:41)</a>:</h4>
<p>Wondering if this could have used Result still</p>



<a name="276434592"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257204-project-error-handling/topic/The%20Rust%20Model%20of%20Error%20Handling/near/276434592" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jane Lusby [she/her] <a href="https://zulip-archive.rust-lang.org/stream/257204-project-error-handling/topic/The.20Rust.20Model.20of.20Error.20Handling.html#276434592">(Mar 24 2022 at 05:41)</a>:</h4>
<p>(deleted)</p>



<a name="276434593"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257204-project-error-handling/topic/The%20Rust%20Model%20of%20Error%20Handling/near/276434593" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jane Lusby [she/her] <a href="https://zulip-archive.rust-lang.org/stream/257204-project-error-handling/topic/The.20Rust.20Model.20of.20Error.20Handling.html#276434593">(Mar 24 2022 at 05:41)</a>:</h4>
<p>(deleted)</p>



<a name="276434594"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257204-project-error-handling/topic/The%20Rust%20Model%20of%20Error%20Handling/near/276434594" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jane Lusby [she/her] <a href="https://zulip-archive.rust-lang.org/stream/257204-project-error-handling/topic/The.20Rust.20Model.20of.20Error.20Handling.html#276434594">(Mar 24 2022 at 05:41)</a>:</h4>
<p>(deleted)</p>



<a name="276434595"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257204-project-error-handling/topic/The%20Rust%20Model%20of%20Error%20Handling/near/276434595" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jane Lusby [she/her] <a href="https://zulip-archive.rust-lang.org/stream/257204-project-error-handling/topic/The.20Rust.20Model.20of.20Error.20Handling.html#276434595">(Mar 24 2022 at 05:41)</a>:</h4>
<p>You still have to combine the error with the location but that seems fairly unavoidable</p>



<a name="276434600"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257204-project-error-handling/topic/The%20Rust%20Model%20of%20Error%20Handling/near/276434600" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jane Lusby [she/her] <a href="https://zulip-archive.rust-lang.org/stream/257204-project-error-handling/topic/The.20Rust.20Model.20of.20Error.20Handling.html#276434600">(Mar 24 2022 at 05:41)</a>:</h4>
<p>Wow zulip</p>



<a name="276434687"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257204-project-error-handling/topic/The%20Rust%20Model%20of%20Error%20Handling/near/276434687" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jane Lusby [she/her] <a href="https://zulip-archive.rust-lang.org/stream/257204-project-error-handling/topic/The.20Rust.20Model.20of.20Error.20Handling.html#276434687">(Mar 24 2022 at 05:43)</a>:</h4>
<p>Or a try block probably would have helped a lot here</p>



<a name="276434779"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257204-project-error-handling/topic/The%20Rust%20Model%20of%20Error%20Handling/near/276434779" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Nelson <a href="https://zulip-archive.rust-lang.org/stream/257204-project-error-handling/topic/The.20Rust.20Model.20of.20Error.20Handling.html#276434779">(Mar 24 2022 at 05:45)</a>:</h4>
<p>I don't see how Result is useful. I need to both produce the error and also a valid type (well, valid in the sense of an Ok variant, it has <code>Type::Error</code> set)</p>



<a name="276434854"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257204-project-error-handling/topic/The%20Rust%20Model%20of%20Error%20Handling/near/276434854" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Nelson <a href="https://zulip-archive.rust-lang.org/stream/257204-project-error-handling/topic/The.20Rust.20Model.20of.20Error.20Handling.html#276434854">(Mar 24 2022 at 05:46)</a>:</h4>
<p>Not all places short circuit either, most of them continue running after generating an error</p>



<a name="276435259"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257204-project-error-handling/topic/The%20Rust%20Model%20of%20Error%20Handling/near/276435259" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jane Lusby [she/her] <a href="https://zulip-archive.rust-lang.org/stream/257204-project-error-handling/topic/The.20Rust.20Model.20of.20Error.20Handling.html#276435259">(Mar 24 2022 at 05:54)</a>:</h4>
<p>I was imagining you propagate out the error and then have the caller or some wrapping function aggregate the error and then construct and return the pretend_zero</p>



<a name="276435272"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257204-project-error-handling/topic/The%20Rust%20Model%20of%20Error%20Handling/near/276435272" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jane Lusby [she/her] <a href="https://zulip-archive.rust-lang.org/stream/257204-project-error-handling/topic/The.20Rust.20Model.20of.20Error.20Handling.html#276435272">(Mar 24 2022 at 05:54)</a>:</h4>
<p>Oh, didn't know this didn't short circuit</p>



<a name="276435279"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257204-project-error-handling/topic/The%20Rust%20Model%20of%20Error%20Handling/near/276435279" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Nelson <a href="https://zulip-archive.rust-lang.org/stream/257204-project-error-handling/topic/The.20Rust.20Model.20of.20Error.20Handling.html#276435279">(Mar 24 2022 at 05:54)</a>:</h4>
<p>Ah hmm I see what you mean - yeah I do that in some places</p>



<a name="276435283"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257204-project-error-handling/topic/The%20Rust%20Model%20of%20Error%20Handling/near/276435283" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jane Lusby [she/her] <a href="https://zulip-archive.rust-lang.org/stream/257204-project-error-handling/topic/The.20Rust.20Model.20of.20Error.20Handling.html#276435283">(Mar 24 2022 at 05:54)</a>:</h4>
<p>I thought you said every err here was followed by a return</p>



<a name="276435309"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257204-project-error-handling/topic/The%20Rust%20Model%20of%20Error%20Handling/near/276435309" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Nelson <a href="https://zulip-archive.rust-lang.org/stream/257204-project-error-handling/topic/The.20Rust.20Model.20of.20Error.20Handling.html#276435309">(Mar 24 2022 at 05:55)</a>:</h4>
<p>In this specific function, not everywhere in this file. But yeah you're right, for this function Result would be a good choice</p>



<a name="276435310"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257204-project-error-handling/topic/The%20Rust%20Model%20of%20Error%20Handling/near/276435310" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jane Lusby [she/her] <a href="https://zulip-archive.rust-lang.org/stream/257204-project-error-handling/topic/The.20Rust.20Model.20of.20Error.20Handling.html#276435310">(Mar 24 2022 at 05:55)</a>:</h4>
<p>Tho honestly, this would be best represented by an inner try block, assuming they all short circuit that is</p>



<a name="276435401"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257204-project-error-handling/topic/The%20Rust%20Model%20of%20Error%20Handling/near/276435401" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Nelson <a href="https://zulip-archive.rust-lang.org/stream/257204-project-error-handling/topic/The.20Rust.20Model.20of.20Error.20Handling.html#276435401">(Mar 24 2022 at 05:56)</a>:</h4>
<p>another place that did use result: <a href="https://github.com/jyn514/saltwater/blob/097c72d30e325de57fbed8a506431754a0560374/saltwater-parser/analyze/expr.rs#L1052">https://github.com/jyn514/saltwater/blob/097c72d30e325de57fbed8a506431754a0560374/saltwater-parser/analyze/expr.rs#L1052</a></p>



<a name="276452223"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257204-project-error-handling/topic/The%20Rust%20Model%20of%20Error%20Handling/near/276452223" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Nick Cameron <a href="https://zulip-archive.rust-lang.org/stream/257204-project-error-handling/topic/The.20Rust.20Model.20of.20Error.20Handling.html#276452223">(Mar 24 2022 at 09:55)</a>:</h4>
<p>Specifically for parsers/compilers, I think that handling those errors is not error handling in the sense of 'Rust model of error handling' a compiler finding an error in source code is an expected event and processing those is part of the normal execution path. We shouldn't expect any generic error handling framework to help at all. Of course a compiler can encounter real errors (e.g., not being able to write to a file) that should be handled in the same way as for other programs. I'm not sure about error buffering in general, but I expect the libraries you want for that are completely different to the ones you'd want for regular error handling</p>



<a name="276453431"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257204-project-error-handling/topic/The%20Rust%20Model%20of%20Error%20Handling/near/276453431" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> matt rice <a href="https://zulip-archive.rust-lang.org/stream/257204-project-error-handling/topic/The.20Rust.20Model.20of.20Error.20Handling.html#276453431">(Mar 24 2022 at 10:05)</a>:</h4>
<p>One thing I don't see mentioned which i've only encountered a couple of times, is when an error has a lifetime associated with it, and when you need to propagate this error up into another error which outlives that, this doesn't technically contradict "Information should not be lost when reporting errors", because of "when reporting", but is a pretty thin line and I didn't see anything about it mentioned.</p>



<a name="276479746"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257204-project-error-handling/topic/The%20Rust%20Model%20of%20Error%20Handling/near/276479746" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jane Lusby [she/her] <a href="https://zulip-archive.rust-lang.org/stream/257204-project-error-handling/topic/The.20Rust.20Model.20of.20Error.20Handling.html#276479746">(Mar 24 2022 at 14:05)</a>:</h4>
<p>(deleted)</p>



<a name="276479982"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257204-project-error-handling/topic/The%20Rust%20Model%20of%20Error%20Handling/near/276479982" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jane Lusby [she/her] <a href="https://zulip-archive.rust-lang.org/stream/257204-project-error-handling/topic/The.20Rust.20Model.20of.20Error.20Handling.html#276479982">(Mar 24 2022 at 14:06)</a>:</h4>
<p><span class="user-mention" data-user-id="254366">@matt rice</span> The thing that I have traditionally seen people do in that scenario is have an API for converting their borrowing error types into an owned version</p>



<a name="276482592"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257204-project-error-handling/topic/The%20Rust%20Model%20of%20Error%20Handling/near/276482592" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> matt rice <a href="https://zulip-archive.rust-lang.org/stream/257204-project-error-handling/topic/The.20Rust.20Model.20of.20Error.20Handling.html#276482592">(Mar 24 2022 at 14:24)</a>:</h4>
<p>I've generally just handled it in a lossy way like <code>Error::ErrorWasReported</code>, this is kind of lossy, but I was doing it in an application rather than a library, so it didn't matter so much where things were reported as long as I could eventually return non-zero.</p>



<a name="276492467"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257204-project-error-handling/topic/The%20Rust%20Model%20of%20Error%20Handling/near/276492467" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jane Lusby [she/her] <a href="https://zulip-archive.rust-lang.org/stream/257204-project-error-handling/topic/The.20Rust.20Model.20of.20Error.20Handling.html#276492467">(Mar 24 2022 at 15:30)</a>:</h4>
<p>I don't really have a good name for this concept but I want to do a study of library APIs that use either flat style error types, where there's one central error that covers errors from many different APIs, vs libraries that export many separate error types</p>



<a name="276492498"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257204-project-error-handling/topic/The%20Rust%20Model%20of%20Error%20Handling/near/276492498" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jane Lusby [she/her] <a href="https://zulip-archive.rust-lang.org/stream/257204-project-error-handling/topic/The.20Rust.20Model.20of.20Error.20Handling.html#276492498">(Mar 24 2022 at 15:30)</a>:</h4>
<p>evaluate the pros and cons of each approach</p>



<a name="276494480"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257204-project-error-handling/topic/The%20Rust%20Model%20of%20Error%20Handling/near/276494480" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Josh Triplett <a href="https://zulip-archive.rust-lang.org/stream/257204-project-error-handling/topic/The.20Rust.20Model.20of.20Error.20Handling.html#276494480">(Mar 24 2022 at 15:42)</a>:</h4>
<p><span class="user-mention silent" data-user-id="220273">Jane Lusby [she/her]</span> <a href="#narrow/stream/257204-project-error-handling/topic/The.20Rust.20Model.20of.20Error.20Handling/near/276492467">said</a>:</p>
<blockquote>
<p>I don't really have a good name for this concept but I want to do a study of library APIs that use either flat style error types, where there's one central error that covers errors from many different APIs, vs libraries that export many separate error types</p>
</blockquote>
<p>That's a really good concept to look at.</p>



<a name="276494835"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257204-project-error-handling/topic/The%20Rust%20Model%20of%20Error%20Handling/near/276494835" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Josh Triplett <a href="https://zulip-archive.rust-lang.org/stream/257204-project-error-handling/topic/The.20Rust.20Model.20of.20Error.20Handling.html#276494835">(Mar 24 2022 at 15:44)</a>:</h4>
<p>Central error handling seems really common for convenience, or for libraries that are built upon a C library that returns a C error code or similar, it's common to have a single error type.</p>



<a name="276495065"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257204-project-error-handling/topic/The%20Rust%20Model%20of%20Error%20Handling/near/276495065" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Josh Triplett <a href="https://zulip-archive.rust-lang.org/stream/257204-project-error-handling/topic/The.20Rust.20Model.20of.20Error.20Handling.html#276495065">(Mar 24 2022 at 15:46)</a>:</h4>
<p>And they can be convenient for users of the library if they're bubbling up errors in the thiserror style rather than in the catch-all anyhow/eyre style.</p>



<a name="276495093"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257204-project-error-handling/topic/The%20Rust%20Model%20of%20Error%20Handling/near/276495093" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Josh Triplett <a href="https://zulip-archive.rust-lang.org/stream/257204-project-error-handling/topic/The.20Rust.20Model.20of.20Error.20Handling.html#276495093">(Mar 24 2022 at 15:46)</a>:</h4>
<p>But separate types for different modules or even for different functions can be really convenient for the user as well, if you're actually going to <em>handle</em> the errors.</p>



<a name="276495156"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257204-project-error-handling/topic/The%20Rust%20Model%20of%20Error%20Handling/near/276495156" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Josh Triplett <a href="https://zulip-archive.rust-lang.org/stream/257204-project-error-handling/topic/The.20Rust.20Model.20of.20Error.20Handling.html#276495156">(Mar 24 2022 at 15:46)</a>:</h4>
<p>Because then you don't have to handle errors that function can't return.</p>



<a name="276498907"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257204-project-error-handling/topic/The%20Rust%20Model%20of%20Error%20Handling/near/276498907" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jane Lusby [she/her] <a href="https://zulip-archive.rust-lang.org/stream/257204-project-error-handling/topic/The.20Rust.20Model.20of.20Error.20Handling.html#276498907">(Mar 24 2022 at 16:09)</a>:</h4>
<p>yea, there's also the issue of representing multiple levels of error cases, where your library has lower level apis that produce errors that conceptually mean different things for different higher level APIs</p>



<a name="276499000"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257204-project-error-handling/topic/The%20Rust%20Model%20of%20Error%20Handling/near/276499000" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jane Lusby [she/her] <a href="https://zulip-archive.rust-lang.org/stream/257204-project-error-handling/topic/The.20Rust.20Model.20of.20Error.20Handling.html#276499000">(Mar 24 2022 at 16:10)</a>:</h4>
<p>which is much harder to represent with a single flat error type than with multiple error types and source errors</p>



<a name="276499792"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257204-project-error-handling/topic/The%20Rust%20Model%20of%20Error%20Handling/near/276499792" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> matt rice <a href="https://zulip-archive.rust-lang.org/stream/257204-project-error-handling/topic/The.20Rust.20Model.20of.20Error.20Handling.html#276499792">(Mar 24 2022 at 16:15)</a>:</h4>
<p>Yeah, I think I usually do something in between, with each module having its own error type, and then a error type wrapping those, and if multiple error types overlap omitting things like From impls.</p>



<a name="276499831"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257204-project-error-handling/topic/The%20Rust%20Model%20of%20Error%20Handling/near/276499831" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> scottmcm <a href="https://zulip-archive.rust-lang.org/stream/257204-project-error-handling/topic/The.20Rust.20Model.20of.20Error.20Handling.html#276499831">(Mar 24 2022 at 16:15)</a>:</h4>
<p>I'll second <span class="user-mention silent" data-user-id="256841">Nick Cameron</span>'s point here.  I don't think of "spit out infos/warns/errors as you go" as <em>error handling</em>, especially because I find that I often want to do the best I can to have even most of the "errors" not prevent creating a "best effort" return value.</p>
<p>So my approach the last few times I've had that need was essentially to pass <code>&amp;mut FnMut(Thing)</code> into the code that can find the problems, so it can be passed as <code>|_| {}</code> or <code>|x| log!(x)</code> or <code>|x| v.push(x)</code> or <code>|_| { failed = true; }</code> or whatever as appropriate.  (Albeit this wasn't in Rust, so I'm paraphrasing a bit.)</p>



<a name="276499871"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257204-project-error-handling/topic/The%20Rust%20Model%20of%20Error%20Handling/near/276499871" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jane Lusby [she/her] <a href="https://zulip-archive.rust-lang.org/stream/257204-project-error-handling/topic/The.20Rust.20Model.20of.20Error.20Handling.html#276499871">(Mar 24 2022 at 16:15)</a>:</h4>
<p>In general though, one thing I'm thinking about doing is taking all the examples of error handling ppl sent me on twitter and classifying them and then doing a series of case studies on the various approaches people take to solving similar problems</p>



<a name="276500122"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257204-project-error-handling/topic/The%20Rust%20Model%20of%20Error%20Handling/near/276500122" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jane Lusby [she/her] <a href="https://zulip-archive.rust-lang.org/stream/257204-project-error-handling/topic/The.20Rust.20Model.20of.20Error.20Handling.html#276500122">(Mar 24 2022 at 16:17)</a>:</h4>
<p>im not sure if it would be helpful to ppl to have a bunch of real world error handling examples organized like that, on the one hand they can see exactly how things are done, but on the other hand it might take quite a lot of time to review the examples well enough to understand why they made the decisions they did, so it could be too much information</p>



<a name="276694300"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257204-project-error-handling/topic/The%20Rust%20Model%20of%20Error%20Handling/near/276694300" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jane Lusby [she/her] <a href="https://zulip-archive.rust-lang.org/stream/257204-project-error-handling/topic/The.20Rust.20Model.20of.20Error.20Handling.html#276694300">(Mar 26 2022 at 00:17)</a>:</h4>
<p>My organized summary of the responses I got to the twitter thread on best and worst of error handling <a href="https://hackmd.io/DB9gsezMT-OhAxDrmbf4oQ">https://hackmd.io/DB9gsezMT-OhAxDrmbf4oQ</a></p>



<a name="276694382"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257204-project-error-handling/topic/The%20Rust%20Model%20of%20Error%20Handling/near/276694382" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jane Lusby [she/her] <a href="https://zulip-archive.rust-lang.org/stream/257204-project-error-handling/topic/The.20Rust.20Model.20of.20Error.20Handling.html#276694382">(Mar 26 2022 at 00:18)</a>:</h4>
<p><span class="user-mention silent" data-user-id="256841">Nick Cameron</span> <a href="#narrow/stream/257204-project-error-handling/topic/The.20Rust.20Model.20of.20Error.20Handling/near/276452223">said</a>:</p>
<blockquote>
<p>Specifically for parsers/compilers, I think that handling those errors is not error handling in the sense of 'Rust model of error handling' a compiler finding an error in source code is an expected event and processing those is part of the normal execution path. We shouldn't expect any generic error handling framework to help at all. Of course a compiler can encounter real errors (e.g., not being able to write to a file) that should be handled in the same way as for other programs. I'm not sure about error buffering in general, but I expect the libraries you want for that are completely different to the ones you'd want for regular error handling</p>
</blockquote>
<p>I know this isn't exactly a scientific study or really indicative of the true relative impact of these problems, but not having good options for aggregating errors was the issue that came up the most in the thread</p>



<a name="276694392"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257204-project-error-handling/topic/The%20Rust%20Model%20of%20Error%20Handling/near/276694392" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jane Lusby [she/her] <a href="https://zulip-archive.rust-lang.org/stream/257204-project-error-handling/topic/The.20Rust.20Model.20of.20Error.20Handling.html#276694392">(Mar 26 2022 at 00:19)</a>:</h4>
<p>and is one of the only ones that came up multiple times independently</p>



<a name="276694397"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257204-project-error-handling/topic/The%20Rust%20Model%20of%20Error%20Handling/near/276694397" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jane Lusby [she/her] <a href="https://zulip-archive.rust-lang.org/stream/257204-project-error-handling/topic/The.20Rust.20Model.20of.20Error.20Handling.html#276694397">(Mar 26 2022 at 00:19)</a>:</h4>
<p>along with general confusion around how to structure errors</p>



<a name="276694417"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257204-project-error-handling/topic/The%20Rust%20Model%20of%20Error%20Handling/near/276694417" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jane Lusby [she/her] <a href="https://zulip-archive.rust-lang.org/stream/257204-project-error-handling/topic/The.20Rust.20Model.20of.20Error.20Handling.html#276694417">(Mar 26 2022 at 00:19)</a>:</h4>
<p>so it's probably worth investing energy into, even if that doesn't mean new APIs in std/core</p>



<a name="276721853"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257204-project-error-handling/topic/The%20Rust%20Model%20of%20Error%20Handling/near/276721853" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Ed Page <a href="https://zulip-archive.rust-lang.org/stream/257204-project-error-handling/topic/The.20Rust.20Model.20of.20Error.20Handling.html#276721853">(Mar 26 2022 at 11:46)</a>:</h4>
<p>Side note: zebra-test sounds similar to assert_cmd / assert_fs with snapbox and trycmd being the next steps up.</p>



<a name="276726938"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257204-project-error-handling/topic/The%20Rust%20Model%20of%20Error%20Handling/near/276726938" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Nick Cameron <a href="https://zulip-archive.rust-lang.org/stream/257204-project-error-handling/topic/The.20Rust.20Model.20of.20Error.20Handling.html#276726938">(Mar 26 2022 at 13:46)</a>:</h4>
<p><span class="user-mention silent" data-user-id="220273">Jane Lusby [she/her]</span> <a href="#narrow/stream/257204-project-error-handling/topic/The.20Rust.20Model.20of.20Error.20Handling/near/276694417">said</a>:</p>
<blockquote>
<p>so it's probably worth investing energy into, even if that doesn't mean new APIs in std/core</p>
</blockquote>
<p>Yeah, its probably an area we should include in a guide or something, rather than support in libs</p>



<a name="276734028"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257204-project-error-handling/topic/The%20Rust%20Model%20of%20Error%20Handling/near/276734028" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pachi <a href="https://zulip-archive.rust-lang.org/stream/257204-project-error-handling/topic/The.20Rust.20Model.20of.20Error.20Handling.html#276734028">(Mar 26 2022 at 16:32)</a>:</h4>
<p><span class="user-mention" data-user-id="256841">@Nick Cameron</span> <span class="user-mention" data-user-id="220273">@Jane Lusby [she/her]</span> Related to that usecase (some form of parsing with recoverable errors or need to propagate warnings), I wonder if it's possible to collect warnings/errors/info messages from the log façade into a Vec&lt;String&gt; or something like it. That would avoid having to pass to any function that can emit those warnings some form of context and duplicating the mechanism with log. Still, I'm not sure how to do it. No docs explain something like that (only outputting to console or to a file) AFAICT.</p>



<a name="276734154"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257204-project-error-handling/topic/The%20Rust%20Model%20of%20Error%20Handling/near/276734154" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jane Lusby [she/her] <a href="https://zulip-archive.rust-lang.org/stream/257204-project-error-handling/topic/The.20Rust.20Model.20of.20Error.20Handling.html#276734154">(Mar 26 2022 at 16:36)</a>:</h4>
<p>I'm not a huge fan of solving that problem on the back of a logging framework</p>



<a name="276734206"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257204-project-error-handling/topic/The%20Rust%20Model%20of%20Error%20Handling/near/276734206" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jane Lusby [she/her] <a href="https://zulip-archive.rust-lang.org/stream/257204-project-error-handling/topic/The.20Rust.20Model.20of.20Error.20Handling.html#276734206">(Mar 26 2022 at 16:36)</a>:</h4>
<p>To me this is sounding like another example of a problem caused by not having an effects system</p>



<a name="276734218"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257204-project-error-handling/topic/The%20Rust%20Model%20of%20Error%20Handling/near/276734218" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jane Lusby [she/her] <a href="https://zulip-archive.rust-lang.org/stream/257204-project-error-handling/topic/The.20Rust.20Model.20of.20Error.20Handling.html#276734218">(Mar 26 2022 at 16:37)</a>:</h4>
<p>Or at least, one that could easily be solved by an effect system</p>



<a name="276736702"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257204-project-error-handling/topic/The%20Rust%20Model%20of%20Error%20Handling/near/276736702" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Ed Page <a href="https://zulip-archive.rust-lang.org/stream/257204-project-error-handling/topic/The.20Rust.20Model.20of.20Error.20Handling.html#276736702">(Mar 26 2022 at 17:33)</a>:</h4>
<p>If desired, some additional examples / use cases of processing messages</p>
<ul>
<li>commited is a commit style checker: <a href="https://github.com/crate-ci/committed/blob/master/src/report.rs">https://github.com/crate-ci/committed/blob/master/src/report.rs</a></li>
<li>typos is a programming spell checker: <a href="https://github.com/crate-ci/typos/blob/master/src/bin/typos-cli/report.rs">https://github.com/crate-ci/typos/blob/master/src/bin/typos-cli/report.rs</a></li>
</ul>



<a name="276743989"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257204-project-error-handling/topic/The%20Rust%20Model%20of%20Error%20Handling/near/276743989" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pachi <a href="https://zulip-archive.rust-lang.org/stream/257204-project-error-handling/topic/The.20Rust.20Model.20of.20Error.20Handling.html#276743989">(Mar 26 2022 at 20:22)</a>:</h4>
<p><span class="user-mention" data-user-id="220273">@Jane Lusby [she/her]</span> indeed, using logging looks like a hack. The proposal of Contexts and Capabilities looks like a better solution (is that what you are referring to when mentioning an effects system?) (<a href="https://tmandry.gitlab.io/blog/posts/2021-12-21-context-capabilities/">https://tmandry.gitlab.io/blog/posts/2021-12-21-context-capabilities/</a>)</p>



<a name="276744961"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257204-project-error-handling/topic/The%20Rust%20Model%20of%20Error%20Handling/near/276744961" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jane Lusby [she/her] <a href="https://zulip-archive.rust-lang.org/stream/257204-project-error-handling/topic/The.20Rust.20Model.20of.20Error.20Handling.html#276744961">(Mar 26 2022 at 20:47)</a>:</h4>
<p>That's the closest thing in the works, yeah</p>



<a name="276744971"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257204-project-error-handling/topic/The%20Rust%20Model%20of%20Error%20Handling/near/276744971" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jane Lusby [she/her] <a href="https://zulip-archive.rust-lang.org/stream/257204-project-error-handling/topic/The.20Rust.20Model.20of.20Error.20Handling.html#276744971">(Mar 26 2022 at 20:47)</a>:</h4>
<p>I'm just referring to effects systems generally though</p>



<a name="276816705"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257204-project-error-handling/topic/The%20Rust%20Model%20of%20Error%20Handling/near/276816705" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jane Lusby [she/her] <a href="https://zulip-archive.rust-lang.org/stream/257204-project-error-handling/topic/The.20Rust.20Model.20of.20Error.20Handling.html#276816705">(Mar 28 2022 at 00:51)</a>:</h4>
<p><span class="user-mention silent" data-user-id="424212">Ed Page</span> <a href="#narrow/stream/257204-project-error-handling/topic/The.20Rust.20Model.20of.20Error.20Handling/near/276721853">said</a>:</p>
<blockquote>
<p>Side note: zebra-test sounds similar to assert_cmd / assert_fs with snapbox and trycmd being the next steps up.</p>
</blockquote>
<p>I should really try out those crates, the rest of zebra-test isn't really the interesting part for me, but I did end up copying the context_from stuff into a WIP PR for color-eyre if you want to check it out:</p>



<a name="276816707"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257204-project-error-handling/topic/The%20Rust%20Model%20of%20Error%20Handling/near/276816707" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jane Lusby [she/her] <a href="https://zulip-archive.rust-lang.org/stream/257204-project-error-handling/topic/The.20Rust.20Model.20of.20Error.20Handling.html#276816707">(Mar 28 2022 at 00:51)</a>:</h4>
<p><a href="https://github.com/yaahc/color-eyre/pull/107">https://github.com/yaahc/color-eyre/pull/107</a></p>



<a name="277800732"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257204-project-error-handling/topic/The%20Rust%20Model%20of%20Error%20Handling/near/277800732" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jane Lusby [she/her] <a href="https://zulip-archive.rust-lang.org/stream/257204-project-error-handling/topic/The.20Rust.20Model.20of.20Error.20Handling.html#277800732">(Apr 04 2022 at 22:09)</a>:</h4>
<p>touching on this again, as I work through the various problems ppl brought up in that twitter thread I'm going to create an error handling FAQ that can start to cross link to various docs with a focus on updating existing docs when there is confusion</p>



<a name="277801074"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257204-project-error-handling/topic/The%20Rust%20Model%20of%20Error%20Handling/near/277801074" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jane Lusby [she/her] <a href="https://zulip-archive.rust-lang.org/stream/257204-project-error-handling/topic/The.20Rust.20Model.20of.20Error.20Handling.html#277801074">(Apr 04 2022 at 22:13)</a>:</h4>
<p>starting with a question someone brought up in one of the error handling office hours meetings I've started holding. I had someone who was confused on when to use panic vs Result. There are existing lines in the docs on <code>panic!</code> that cover this but it's currently scattered across multiple paragraphs, gonna consolidate this into one section and cross link it from the various <code>unwrap</code>/<code>expect</code> methods on <code>Option</code> and <code>Result</code>.</p>



<a name="277806698"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257204-project-error-handling/topic/The%20Rust%20Model%20of%20Error%20Handling/near/277806698" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jane Lusby [she/her] <a href="https://zulip-archive.rust-lang.org/stream/257204-project-error-handling/topic/The.20Rust.20Model.20of.20Error.20Handling.html#277806698">(Apr 04 2022 at 23:13)</a>:</h4>
<p><a href="https://github.com/rust-lang/rust/pull/95660">https://github.com/rust-lang/rust/pull/95660</a></p>



<a name="277809188"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257204-project-error-handling/topic/The%20Rust%20Model%20of%20Error%20Handling/near/277809188" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> scottmcm <a href="https://zulip-archive.rust-lang.org/stream/257204-project-error-handling/topic/The.20Rust.20Model.20of.20Error.20Handling.html#277809188">(Apr 04 2022 at 23:45)</a>:</h4>
<p>Sounds good.  I was just doing a review of some code from someone new to rust, and they were bothering with a <code>Result</code> return from an <code>include_str!("...").parse()</code> (essentially), so a good place to link for "no you can just panic here" would have been helpful.</p>



<a name="278051935"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257204-project-error-handling/topic/The%20Rust%20Model%20of%20Error%20Handling/near/278051935" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jane Lusby [she/her] <a href="https://zulip-archive.rust-lang.org/stream/257204-project-error-handling/topic/The.20Rust.20Model.20of.20Error.20Handling.html#278051935">(Apr 06 2022 at 16:40)</a>:</h4>
<p>Okay, I created the error handling FAQ starting point</p>



<a name="278051937"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257204-project-error-handling/topic/The%20Rust%20Model%20of%20Error%20Handling/near/278051937" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jane Lusby [she/her] <a href="https://zulip-archive.rust-lang.org/stream/257204-project-error-handling/topic/The.20Rust.20Model.20of.20Error.20Handling.html#278051937">(Apr 06 2022 at 16:40)</a>:</h4>
<p><a href="https://github.com/rust-lang/project-error-handling/issues/50">https://github.com/rust-lang/project-error-handling/issues/50</a></p>



<a name="278128641"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257204-project-error-handling/topic/The%20Rust%20Model%20of%20Error%20Handling/near/278128641" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Nick Cameron <a href="https://zulip-archive.rust-lang.org/stream/257204-project-error-handling/topic/The.20Rust.20Model.20of.20Error.20Handling.html#278128641">(Apr 07 2022 at 07:55)</a>:</h4>
<p>There's an interesting point made in the Hyper 1.0 roadmap (<a href="https://github.com/hyperium/hyper/pull/2806/files">https://github.com/hyperium/hyper/pull/2806/files</a>) about error handling which I hadn't considered: if an error exposes underlying errors from dependencies via <code>source()</code>, then the dependency may be made public and thus an implicit (well, known only at runtime-only) part of the API, which seems obviously bad. I wonder if there should be advice in the FAQ for how to deal with this? I.e., some errors should probably be converted when added to the source or something?</p>



<a name="278128751"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257204-project-error-handling/topic/The%20Rust%20Model%20of%20Error%20Handling/near/278128751" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Nick Cameron <a href="https://zulip-archive.rust-lang.org/stream/257204-project-error-handling/topic/The.20Rust.20Model.20of.20Error.20Handling.html#278128751">(Apr 07 2022 at 07:56)</a>:</h4>
<p>(In general, this seems like another instance of the problem of errors crossing abstraction boundaries, much like showing stringified errors to users)</p>



<a name="278128801"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257204-project-error-handling/topic/The%20Rust%20Model%20of%20Error%20Handling/near/278128801" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jane Lusby [she/her] <a href="https://zulip-archive.rust-lang.org/stream/257204-project-error-handling/topic/The.20Rust.20Model.20of.20Error.20Handling.html#278128801">(Apr 07 2022 at 07:56)</a>:</h4>
<p>I actually just added a note about that to eyre the other day</p>



<a name="278128840"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257204-project-error-handling/topic/The%20Rust%20Model%20of%20Error%20Handling/near/278128840" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jane Lusby [she/her] <a href="https://zulip-archive.rust-lang.org/stream/257204-project-error-handling/topic/The.20Rust.20Model.20of.20Error.20Handling.html#278128840">(Apr 07 2022 at 07:57)</a>:</h4>
<p><a href="https://github.com/yaahc/eyre/#usage-recommendations-and-stability-considerations">https://github.com/yaahc/eyre/#usage-recommendations-and-stability-considerations</a></p>



<a name="278128948"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257204-project-error-handling/topic/The%20Rust%20Model%20of%20Error%20Handling/near/278128948" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jane Lusby [she/her] <a href="https://zulip-archive.rust-lang.org/stream/257204-project-error-handling/topic/The.20Rust.20Model.20of.20Error.20Handling.html#278128948">(Apr 07 2022 at 07:58)</a>:</h4>
<p>I'd be down to add that to the faq but I'd want to do so based on someone asking about it not ppl pointing it out as a footgun, otherwise it doesn't seem like a good fit for that format</p>



<a name="278129161"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257204-project-error-handling/topic/The%20Rust%20Model%20of%20Error%20Handling/near/278129161" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jane Lusby [she/her] <a href="https://zulip-archive.rust-lang.org/stream/257204-project-error-handling/topic/The.20Rust.20Model.20of.20Error.20Handling.html#278129161">(Apr 07 2022 at 08:00)</a>:</h4>
<p>I guess I didn't get into source specifically</p>



<a name="278129203"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257204-project-error-handling/topic/The%20Rust%20Model%20of%20Error%20Handling/near/278129203" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jane Lusby [she/her] <a href="https://zulip-archive.rust-lang.org/stream/257204-project-error-handling/topic/The.20Rust.20Model.20of.20Error.20Handling.html#278129203">(Apr 07 2022 at 08:00)</a>:</h4>
<p>And how source has the same issue as eyre Report or a box dyn error</p>



<a name="278129297"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257204-project-error-handling/topic/The%20Rust%20Model%20of%20Error%20Handling/near/278129297" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jane Lusby [she/her] <a href="https://zulip-archive.rust-lang.org/stream/257204-project-error-handling/topic/The.20Rust.20Model.20of.20Error.20Handling.html#278129297">(Apr 07 2022 at 08:01)</a>:</h4>
<p><span class="user-mention" data-user-id="256841">@Nick Cameron</span> thinking about it more I don't think that should be its own question, but it definitely feels like it belongs in the "how should I structure my errors" question</p>



<a name="278129312"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257204-project-error-handling/topic/The%20Rust%20Model%20of%20Error%20Handling/near/278129312" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jane Lusby [she/her] <a href="https://zulip-archive.rust-lang.org/stream/257204-project-error-handling/topic/The.20Rust.20Model.20of.20Error.20Handling.html#278129312">(Apr 07 2022 at 08:01)</a>:</h4>
<p>Which will almost certainly be a book in its own right x.x</p>



<a name="278201283"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257204-project-error-handling/topic/The%20Rust%20Model%20of%20Error%20Handling/near/278201283" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> scottmcm <a href="https://zulip-archive.rust-lang.org/stream/257204-project-error-handling/topic/The.20Rust.20Model.20of.20Error.20Handling.html#278201283">(Apr 07 2022 at 17:46)</a>:</h4>
<p>It seems like that's even more so the case for anything that allows downcasting -- like <a href="https://docs.rs/anyhow/latest/anyhow/struct.Error.html#method.downcast">https://docs.rs/anyhow/latest/anyhow/struct.Error.html#method.downcast</a> means that any error from a dependency is implicitly part of your public API</p>



<a name="278205328"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257204-project-error-handling/topic/The%20Rust%20Model%20of%20Error%20Handling/near/278205328" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jane Lusby [she/her] <a href="https://zulip-archive.rust-lang.org/stream/257204-project-error-handling/topic/The.20Rust.20Model.20of.20Error.20Handling.html#278205328">(Apr 07 2022 at 18:17)</a>:</h4>
<p>Yeah <span aria-label="pensive" class="emoji emoji-1f614" role="img" title="pensive">:pensive:</span></p>



<a name="278209122"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257204-project-error-handling/topic/The%20Rust%20Model%20of%20Error%20Handling/near/278209122" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Ed Page <a href="https://zulip-archive.rust-lang.org/stream/257204-project-error-handling/topic/The.20Rust.20Model.20of.20Error.20Handling.html#278209122">(Apr 07 2022 at 18:47)</a>:</h4>
<p>I think this comes down to expectations which we can define, whether its downcasting, MSRV, <code>unstable</code> feature flags, "bugs", string output format, etc.  Anything can be a breaking change to someone, so we have to set expectations for what we will keep compatibility one.</p>



<a name="278209246"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/257204-project-error-handling/topic/The%20Rust%20Model%20of%20Error%20Handling/near/278209246" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jane Lusby [she/her] <a href="https://zulip-archive.rust-lang.org/stream/257204-project-error-handling/topic/The.20Rust.20Model.20of.20Error.20Handling.html#278209246">(Apr 07 2022 at 18:48)</a>:</h4>
<p>maybe we should just update the standard library docs on <code>downcast</code> and <code>source</code> to assert that a type being namable via <code>downcast</code> does not imply a stability guarantee by the author who exposed that type via source or w/e, and that it is up to library authors to create a stability commitment for what types can be stably downcasted too.</p>



<hr><p>Last updated: Apr 12 2022 at 20:01 UTC</p>
</html>