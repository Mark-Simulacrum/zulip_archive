<html>
<head><meta charset="utf-8"><title>I-prioritize #74657 linker-plugin-lto stopped working in Rus · t-compiler/wg-prioritization/alerts · Zulip Chat Archive</title></head>
<h2>Stream: <a href="https://rust-lang.github.io/zulip_archive/stream/245100-t-compiler/wg-prioritization/alerts/index.html">t-compiler/wg-prioritization/alerts</a></h2>
<h3>Topic: <a href="https://rust-lang.github.io/zulip_archive/stream/245100-t-compiler/wg-prioritization/alerts/topic/I-prioritize.20.2374657.20linker-plugin-lto.20stopped.20working.20in.20Rus.html">I-prioritize #74657 linker-plugin-lto stopped working in Rus</a></h3>

<hr>

<base href="https://rust-lang.zulipchat.com">

<head><link href="https://rust-lang.github.io/zulip_archive/style.css" rel="stylesheet"></head>

<a name="204726459"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/245100-t-compiler/wg-prioritization/alerts/topic/I-prioritize%20%2374657%20linker-plugin-lto%20stopped%20working%20in%20Rus/near/204726459" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> triagebot <a href="https://rust-lang.github.io/zulip_archive/stream/245100-t-compiler/wg-prioritization/alerts/topic/I-prioritize.20.2374657.20linker-plugin-lto.20stopped.20working.20in.20Rus.html#204726459">(Jul 22 2020 at 21:45)</a>:</h4>
<p><span class="user-group-mention" data-user-group-id="3111">@WG-prioritization/alerts</span> issue <a href="https://github.com/rust-lang/rust/issues/74657">#74657</a> has been requested for prioritization.</p>
<h1><a href="https://forge.rust-lang.org/compiler/prioritization/procedure.html#assign-priority-to-unprioritized-issues-with-i-prioritize-label">Procedure</a></h1>
<ul>
<li>Priority?</li>
<li>Regression?</li>
<li>Notify people/groups?</li>
<li>Needs <code>I-nominated</code>?</li>
</ul>



<a name="205372799"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/245100-t-compiler/wg-prioritization/alerts/topic/I-prioritize%20%2374657%20linker-plugin-lto%20stopped%20working%20in%20Rus/near/205372799" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Santiago Pastorino <a href="https://rust-lang.github.io/zulip_archive/stream/245100-t-compiler/wg-prioritization/alerts/topic/I-prioritize.20.2374657.20linker-plugin-lto.20stopped.20working.20in.20Rus.html#205372799">(Jul 29 2020 at 15:31)</a>:</h4>
<p>this went unnoticed, taking a look at it right now</p>



<a name="205372846"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/245100-t-compiler/wg-prioritization/alerts/topic/I-prioritize%20%2374657%20linker-plugin-lto%20stopped%20working%20in%20Rus/near/205372846" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Santiago Pastorino <a href="https://rust-lang.github.io/zulip_archive/stream/245100-t-compiler/wg-prioritization/alerts/topic/I-prioritize.20.2374657.20linker-plugin-lto.20stopped.20working.20in.20Rus.html#205372846">(Jul 29 2020 at 15:31)</a>:</h4>
<p>and is the last one lacking prioritization :)</p>



<a name="205373088"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/245100-t-compiler/wg-prioritization/alerts/topic/I-prioritize%20%2374657%20linker-plugin-lto%20stopped%20working%20in%20Rus/near/205373088" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> lcnr <a href="https://rust-lang.github.io/zulip_archive/stream/245100-t-compiler/wg-prioritization/alerts/topic/I-prioritize.20.2374657.20linker-plugin-lto.20stopped.20working.20in.20Rus.html#205373088">(Jul 29 2020 at 15:33)</a>:</h4>
<p>hmm, <code>P-high</code> maybe <span aria-label="thinking" class="emoji emoji-1f914" role="img" title="thinking">:thinking:</span></p>



<a name="205373106"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/245100-t-compiler/wg-prioritization/alerts/topic/I-prioritize%20%2374657%20linker-plugin-lto%20stopped%20working%20in%20Rus/near/205373106" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Santiago Pastorino <a href="https://rust-lang.github.io/zulip_archive/stream/245100-t-compiler/wg-prioritization/alerts/topic/I-prioritize.20.2374657.20linker-plugin-lto.20stopped.20working.20in.20Rus.html#205373106">(Jul 29 2020 at 15:33)</a>:</h4>
<p>yeah I was wondering the same</p>



<a name="205373123"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/245100-t-compiler/wg-prioritization/alerts/topic/I-prioritize%20%2374657%20linker-plugin-lto%20stopped%20working%20in%20Rus/near/205373123" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> lcnr <a href="https://rust-lang.github.io/zulip_archive/stream/245100-t-compiler/wg-prioritization/alerts/topic/I-prioritize.20.2374657.20linker-plugin-lto.20stopped.20working.20in.20Rus.html#205373123">(Jul 29 2020 at 15:33)</a>:</h4>
<p>I think we need a mvce here though</p>



<a name="205373138"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/245100-t-compiler/wg-prioritization/alerts/topic/I-prioritize%20%2374657%20linker-plugin-lto%20stopped%20working%20in%20Rus/near/205373138" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Santiago Pastorino <a href="https://rust-lang.github.io/zulip_archive/stream/245100-t-compiler/wg-prioritization/alerts/topic/I-prioritize.20.2374657.20linker-plugin-lto.20stopped.20working.20in.20Rus.html#205373138">(Jul 29 2020 at 15:33)</a>:</h4>
<p>but I'm right now thinking loudly, why not <code>P-critical</code>?</p>



<a name="205373254"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/245100-t-compiler/wg-prioritization/alerts/topic/I-prioritize%20%2374657%20linker-plugin-lto%20stopped%20working%20in%20Rus/near/205373254" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Santiago Pastorino <a href="https://rust-lang.github.io/zulip_archive/stream/245100-t-compiler/wg-prioritization/alerts/topic/I-prioritize.20.2374657.20linker-plugin-lto.20stopped.20working.20in.20Rus.html#205373254">(Jul 29 2020 at 15:34)</a>:</h4>
<p>I'm trying to think, what kind of peculiarity this have that is uncommon</p>



<a name="205373274"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/245100-t-compiler/wg-prioritization/alerts/topic/I-prioritize%20%2374657%20linker-plugin-lto%20stopped%20working%20in%20Rus/near/205373274" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Santiago Pastorino <a href="https://rust-lang.github.io/zulip_archive/stream/245100-t-compiler/wg-prioritization/alerts/topic/I-prioritize.20.2374657.20linker-plugin-lto.20stopped.20working.20in.20Rus.html#205373274">(Jul 29 2020 at 15:34)</a>:</h4>
<p>my first reaction was, if Firefox doesn't compile then <code>P-critical</code></p>



<a name="205373279"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/245100-t-compiler/wg-prioritization/alerts/topic/I-prioritize%20%2374657%20linker-plugin-lto%20stopped%20working%20in%20Rus/near/205373279" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Santiago Pastorino <a href="https://rust-lang.github.io/zulip_archive/stream/245100-t-compiler/wg-prioritization/alerts/topic/I-prioritize.20.2374657.20linker-plugin-lto.20stopped.20working.20in.20Rus.html#205373279">(Jul 29 2020 at 15:34)</a>:</h4>
<p>:)</p>



<a name="205373318"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/245100-t-compiler/wg-prioritization/alerts/topic/I-prioritize%20%2374657%20linker-plugin-lto%20stopped%20working%20in%20Rus/near/205373318" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> lcnr <a href="https://rust-lang.github.io/zulip_archive/stream/245100-t-compiler/wg-prioritization/alerts/topic/I-prioritize.20.2374657.20linker-plugin-lto.20stopped.20working.20in.20Rus.html#205373318">(Jul 29 2020 at 15:35)</a>:</h4>
<p><code> RUSTFLAGS="-Clinker-plugin-lto=LLVMgold.so"</code> and only on some target apparently</p>



<a name="205373467"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/245100-t-compiler/wg-prioritization/alerts/topic/I-prioritize%20%2374657%20linker-plugin-lto%20stopped%20working%20in%20Rus/near/205373467" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Santiago Pastorino <a href="https://rust-lang.github.io/zulip_archive/stream/245100-t-compiler/wg-prioritization/alerts/topic/I-prioritize.20.2374657.20linker-plugin-lto.20stopped.20working.20in.20Rus.html#205373467">(Jul 29 2020 at 15:36)</a>:</h4>
<p>ahh ok</p>



<a name="205373501"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/245100-t-compiler/wg-prioritization/alerts/topic/I-prioritize%20%2374657%20linker-plugin-lto%20stopped%20working%20in%20Rus/near/205373501" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Santiago Pastorino <a href="https://rust-lang.github.io/zulip_archive/stream/245100-t-compiler/wg-prioritization/alerts/topic/I-prioritize.20.2374657.20linker-plugin-lto.20stopped.20working.20in.20Rus.html#205373501">(Jul 29 2020 at 15:36)</a>:</h4>
<p>yeah saw the flags, but didn't realize about the targets</p>



<a name="205373555"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/245100-t-compiler/wg-prioritization/alerts/topic/I-prioritize%20%2374657%20linker-plugin-lto%20stopped%20working%20in%20Rus/near/205373555" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> lcnr <a href="https://rust-lang.github.io/zulip_archive/stream/245100-t-compiler/wg-prioritization/alerts/topic/I-prioritize.20.2374657.20linker-plugin-lto.20stopped.20working.20in.20Rus.html#205373555">(Jul 29 2020 at 15:36)</a>:</h4>
<p>so most firefox targets still work here</p>



<a name="205373582"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/245100-t-compiler/wg-prioritization/alerts/topic/I-prioritize%20%2374657%20linker-plugin-lto%20stopped%20working%20in%20Rus/near/205373582" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> lcnr <a href="https://rust-lang.github.io/zulip_archive/stream/245100-t-compiler/wg-prioritization/alerts/topic/I-prioritize.20.2374657.20linker-plugin-lto.20stopped.20working.20in.20Rus.html#205373582">(Jul 29 2020 at 15:36)</a>:</h4>
<p>at least from what I can tell it would be quite bad if this weren't the case</p>



<a name="205373667"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/245100-t-compiler/wg-prioritization/alerts/topic/I-prioritize%20%2374657%20linker-plugin-lto%20stopped%20working%20in%20Rus/near/205373667" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Léo Lanteri Thauvin <a href="https://rust-lang.github.io/zulip_archive/stream/245100-t-compiler/wg-prioritization/alerts/topic/I-prioritize.20.2374657.20linker-plugin-lto.20stopped.20working.20in.20Rus.html#205373667">(Jul 29 2020 at 15:37)</a>:</h4>
<p>I guess this was fixed on Firefox’s side, see the linkrf bugzilla issue</p>



<a name="205373917"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/245100-t-compiler/wg-prioritization/alerts/topic/I-prioritize%20%2374657%20linker-plugin-lto%20stopped%20working%20in%20Rus/near/205373917" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Santiago Pastorino <a href="https://rust-lang.github.io/zulip_archive/stream/245100-t-compiler/wg-prioritization/alerts/topic/I-prioritize.20.2374657.20linker-plugin-lto.20stopped.20working.20in.20Rus.html#205373917">(Jul 29 2020 at 15:39)</a>:</h4>
<p>yeah they worked around the issue</p>



<a name="205373986"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/245100-t-compiler/wg-prioritization/alerts/topic/I-prioritize%20%2374657%20linker-plugin-lto%20stopped%20working%20in%20Rus/near/205373986" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Santiago Pastorino <a href="https://rust-lang.github.io/zulip_archive/stream/245100-t-compiler/wg-prioritization/alerts/topic/I-prioritize.20.2374657.20linker-plugin-lto.20stopped.20working.20in.20Rus.html#205373986">(Jul 29 2020 at 15:40)</a>:</h4>
<p>going with <code>P-high</code> then</p>



<a name="205374101"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/245100-t-compiler/wg-prioritization/alerts/topic/I-prioritize%20%2374657%20linker-plugin-lto%20stopped%20working%20in%20Rus/near/205374101" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Santiago Pastorino <a href="https://rust-lang.github.io/zulip_archive/stream/245100-t-compiler/wg-prioritization/alerts/topic/I-prioritize.20.2374657.20linker-plugin-lto.20stopped.20working.20in.20Rus.html#205374101">(Jul 29 2020 at 15:41)</a>:</h4>
<p>this even hit archlinux firefox builds</p>



<a name="205374111"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/245100-t-compiler/wg-prioritization/alerts/topic/I-prioritize%20%2374657%20linker-plugin-lto%20stopped%20working%20in%20Rus/near/205374111" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Santiago Pastorino <a href="https://rust-lang.github.io/zulip_archive/stream/245100-t-compiler/wg-prioritization/alerts/topic/I-prioritize.20.2374657.20linker-plugin-lto.20stopped.20working.20in.20Rus.html#205374111">(Jul 29 2020 at 15:41)</a>:</h4>
<p>or am I wrong?</p>



<a name="205374112"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/245100-t-compiler/wg-prioritization/alerts/topic/I-prioritize%20%2374657%20linker-plugin-lto%20stopped%20working%20in%20Rus/near/205374112" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Santiago Pastorino <a href="https://rust-lang.github.io/zulip_archive/stream/245100-t-compiler/wg-prioritization/alerts/topic/I-prioritize.20.2374657.20linker-plugin-lto.20stopped.20working.20in.20Rus.html#205374112">(Jul 29 2020 at 15:41)</a>:</h4>
<p><a href="https://github.com/archlinux/svntogit-packages/commit/7d760401eaef0b80514d2c87b0bfd1f0fb35cc30">https://github.com/archlinux/svntogit-packages/commit/7d760401eaef0b80514d2c87b0bfd1f0fb35cc30</a></p>



<a name="205374500"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/245100-t-compiler/wg-prioritization/alerts/topic/I-prioritize%20%2374657%20linker-plugin-lto%20stopped%20working%20in%20Rus/near/205374500" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> lcnr <a href="https://rust-lang.github.io/zulip_archive/stream/245100-t-compiler/wg-prioritization/alerts/topic/I-prioritize.20.2374657.20linker-plugin-lto.20stopped.20working.20in.20Rus.html#205374500">(Jul 29 2020 at 15:44)</a>:</h4>
<p>wasn't that fix for a build perf regression?</p>



<a name="205374505"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/245100-t-compiler/wg-prioritization/alerts/topic/I-prioritize%20%2374657%20linker-plugin-lto%20stopped%20working%20in%20Rus/near/205374505" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> lcnr <a href="https://rust-lang.github.io/zulip_archive/stream/245100-t-compiler/wg-prioritization/alerts/topic/I-prioritize.20.2374657.20linker-plugin-lto.20stopped.20working.20in.20Rus.html#205374505">(Jul 29 2020 at 15:44)</a>:</h4>
<p><span aria-label="shock" class="emoji emoji-1f628" role="img" title="shock">:shock:</span></p>



<a name="205374527"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/245100-t-compiler/wg-prioritization/alerts/topic/I-prioritize%20%2374657%20linker-plugin-lto%20stopped%20working%20in%20Rus/near/205374527" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> lcnr <a href="https://rust-lang.github.io/zulip_archive/stream/245100-t-compiler/wg-prioritization/alerts/topic/I-prioritize.20.2374657.20linker-plugin-lto.20stopped.20working.20in.20Rus.html#205374527">(Jul 29 2020 at 15:44)</a>:</h4>
<p><a href="https://bugzilla.mozilla.org/show_bug.cgi?id=1654465">https://bugzilla.mozilla.org/show_bug.cgi?id=1654465</a></p>



<a name="205374535"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/245100-t-compiler/wg-prioritization/alerts/topic/I-prioritize%20%2374657%20linker-plugin-lto%20stopped%20working%20in%20Rus/near/205374535" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Santiago Pastorino <a href="https://rust-lang.github.io/zulip_archive/stream/245100-t-compiler/wg-prioritization/alerts/topic/I-prioritize.20.2374657.20linker-plugin-lto.20stopped.20working.20in.20Rus.html#205374535">(Jul 29 2020 at 15:44)</a>:</h4>
<p>to be honest unsure</p>



<a name="205374560"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/245100-t-compiler/wg-prioritization/alerts/topic/I-prioritize%20%2374657%20linker-plugin-lto%20stopped%20working%20in%20Rus/near/205374560" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Santiago Pastorino <a href="https://rust-lang.github.io/zulip_archive/stream/245100-t-compiler/wg-prioritization/alerts/topic/I-prioritize.20.2374657.20linker-plugin-lto.20stopped.20working.20in.20Rus.html#205374560">(Jul 29 2020 at 15:45)</a>:</h4>
<p>too long didn't properly read :)</p>



<a name="205374639"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/245100-t-compiler/wg-prioritization/alerts/topic/I-prioritize%20%2374657%20linker-plugin-lto%20stopped%20working%20in%20Rus/near/205374639" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Santiago Pastorino <a href="https://rust-lang.github.io/zulip_archive/stream/245100-t-compiler/wg-prioritization/alerts/topic/I-prioritize.20.2374657.20linker-plugin-lto.20stopped.20working.20in.20Rus.html#205374639">(Jul 29 2020 at 15:45)</a>:</h4>
<p><span class="user-mention" data-user-id="216206">@lcnr</span> thoughts about what to do here?</p>



<a name="205374722"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/245100-t-compiler/wg-prioritization/alerts/topic/I-prioritize%20%2374657%20linker-plugin-lto%20stopped%20working%20in%20Rus/near/205374722" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> lcnr <a href="https://rust-lang.github.io/zulip_archive/stream/245100-t-compiler/wg-prioritization/alerts/topic/I-prioritize.20.2374657.20linker-plugin-lto.20stopped.20working.20in.20Rus.html#205374722">(Jul 29 2020 at 15:46)</a>:</h4>
<p>ping ICE breakers and hope they are able to somehow minimize this <span aria-label="sweat smile" class="emoji emoji-1f605" role="img" title="sweat smile">:sweat_smile:</span> </p>
<p>This seems like an annoying bug to track down</p>



<a name="205374778"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/245100-t-compiler/wg-prioritization/alerts/topic/I-prioritize%20%2374657%20linker-plugin-lto%20stopped%20working%20in%20Rus/near/205374778" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Santiago Pastorino <a href="https://rust-lang.github.io/zulip_archive/stream/245100-t-compiler/wg-prioritization/alerts/topic/I-prioritize.20.2374657.20linker-plugin-lto.20stopped.20working.20in.20Rus.html#205374778">(Jul 29 2020 at 15:46)</a>:</h4>
<p>hehe, but should we start with <code>P-high</code> then?</p>



<a name="205374819"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/245100-t-compiler/wg-prioritization/alerts/topic/I-prioritize%20%2374657%20linker-plugin-lto%20stopped%20working%20in%20Rus/near/205374819" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> lcnr <a href="https://rust-lang.github.io/zulip_archive/stream/245100-t-compiler/wg-prioritization/alerts/topic/I-prioritize.20.2374657.20linker-plugin-lto.20stopped.20working.20in.20Rus.html#205374819">(Jul 29 2020 at 15:47)</a>:</h4>
<p>A comment in the that thread mentions that some args to <code>rustc</code> changed with that version</p>



<a name="205374974"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/245100-t-compiler/wg-prioritization/alerts/topic/I-prioritize%20%2374657%20linker-plugin-lto%20stopped%20working%20in%20Rus/near/205374974" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> lcnr <a href="https://rust-lang.github.io/zulip_archive/stream/245100-t-compiler/wg-prioritization/alerts/topic/I-prioritize.20.2374657.20linker-plugin-lto.20stopped.20working.20in.20Rus.html#205374974">(Jul 29 2020 at 15:48)</a>:</h4>
<div class="codehilite"><pre><span></span><code>Since the original problem is that cargo &gt;= 1.45 passes extra flags (-C embed-bitcode=no)
to rustc that are incompatible with -Clto, and while
it knows to adjust based on the lto setting in the build profile
(which CARGO_PROFILE_RELEASE_LTO overrides the default of), cargo
ignores flags passed via cargo rustc -- ... when making those
adjustments.

So, we need to override with -C embed-bitcode=yes on our own at the
same time we pass -Clto. But doing that through cargo rustc -- ...
is not enough because all the dependencies of the crate built with
-Clto need to be built with -C embed-bitcode=yes. So we need to
override with RUSTFLAGS, which will affect all the dependencies.
But we also need to do this consistently across all crates, not only the
dependencies of crates built with -Clto, otherwise we&#39;d still end up
building crates twice (once with and once without the override).
</code></pre></div>



<a name="205375063"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/245100-t-compiler/wg-prioritization/alerts/topic/I-prioritize%20%2374657%20linker-plugin-lto%20stopped%20working%20in%20Rus/near/205375063" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> lcnr <a href="https://rust-lang.github.io/zulip_archive/stream/245100-t-compiler/wg-prioritization/alerts/topic/I-prioritize.20.2374657.20linker-plugin-lto.20stopped.20working.20in.20Rus.html#205375063">(Jul 29 2020 at 15:49)</a>:</h4>
<p>maybe :/ from what I can see the issue isn't really <code>P-critical</code>, but I also don't know what causes it</p>



<a name="205375124"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/245100-t-compiler/wg-prioritization/alerts/topic/I-prioritize%20%2374657%20linker-plugin-lto%20stopped%20working%20in%20Rus/near/205375124" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Santiago Pastorino <a href="https://rust-lang.github.io/zulip_archive/stream/245100-t-compiler/wg-prioritization/alerts/topic/I-prioritize.20.2374657.20linker-plugin-lto.20stopped.20working.20in.20Rus.html#205375124">(Jul 29 2020 at 15:49)</a>:</h4>
<p>hmm right</p>



<a name="205375205"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/245100-t-compiler/wg-prioritization/alerts/topic/I-prioritize%20%2374657%20linker-plugin-lto%20stopped%20working%20in%20Rus/near/205375205" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Santiago Pastorino <a href="https://rust-lang.github.io/zulip_archive/stream/245100-t-compiler/wg-prioritization/alerts/topic/I-prioritize.20.2374657.20linker-plugin-lto.20stopped.20working.20in.20Rus.html#205375205">(Jul 29 2020 at 15:50)</a>:</h4>
<p>I guess I'd go with <code>P-high</code> until someone figures out something that gives more light</p>



<a name="205375270"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/245100-t-compiler/wg-prioritization/alerts/topic/I-prioritize%20%2374657%20linker-plugin-lto%20stopped%20working%20in%20Rus/near/205375270" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> lcnr <a href="https://rust-lang.github.io/zulip_archive/stream/245100-t-compiler/wg-prioritization/alerts/topic/I-prioritize.20.2374657.20linker-plugin-lto.20stopped.20working.20in.20Rus.html#205375270">(Jul 29 2020 at 15:50)</a>:</h4>
<p>we should also ping cleanup here I think</p>



<a name="205375295"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/245100-t-compiler/wg-prioritization/alerts/topic/I-prioritize%20%2374657%20linker-plugin-lto%20stopped%20working%20in%20Rus/near/205375295" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> lcnr <a href="https://rust-lang.github.io/zulip_archive/stream/245100-t-compiler/wg-prioritization/alerts/topic/I-prioritize.20.2374657.20linker-plugin-lto.20stopped.20working.20in.20Rus.html#205375295">(Jul 29 2020 at 15:50)</a>:</h4>
<p>if someone wants to spend a few hours building firefox</p>



<a name="205375317"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/245100-t-compiler/wg-prioritization/alerts/topic/I-prioritize%20%2374657%20linker-plugin-lto%20stopped%20working%20in%20Rus/near/205375317" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Santiago Pastorino <a href="https://rust-lang.github.io/zulip_archive/stream/245100-t-compiler/wg-prioritization/alerts/topic/I-prioritize.20.2374657.20linker-plugin-lto.20stopped.20working.20in.20Rus.html#205375317">(Jul 29 2020 at 15:50)</a>:</h4>
<p>lol</p>



<a name="205375334"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/245100-t-compiler/wg-prioritization/alerts/topic/I-prioritize%20%2374657%20linker-plugin-lto%20stopped%20working%20in%20Rus/near/205375334" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Santiago Pastorino <a href="https://rust-lang.github.io/zulip_archive/stream/245100-t-compiler/wg-prioritization/alerts/topic/I-prioritize.20.2374657.20linker-plugin-lto.20stopped.20working.20in.20Rus.html#205375334">(Jul 29 2020 at 15:51)</a>:</h4>
<p>right, I've pinged them</p>



<a name="205375338"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/245100-t-compiler/wg-prioritization/alerts/topic/I-prioritize%20%2374657%20linker-plugin-lto%20stopped%20working%20in%20Rus/near/205375338" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Santiago Pastorino <a href="https://rust-lang.github.io/zulip_archive/stream/245100-t-compiler/wg-prioritization/alerts/topic/I-prioritize.20.2374657.20linker-plugin-lto.20stopped.20working.20in.20Rus.html#205375338">(Jul 29 2020 at 15:51)</a>:</h4>
<p>going with <code>P-high</code>for now then</p>



<a name="205375460"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/245100-t-compiler/wg-prioritization/alerts/topic/I-prioritize%20%2374657%20linker-plugin-lto%20stopped%20working%20in%20Rus/near/205375460" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Léo Lanteri Thauvin <a href="https://rust-lang.github.io/zulip_archive/stream/245100-t-compiler/wg-prioritization/alerts/topic/I-prioritize.20.2374657.20linker-plugin-lto.20stopped.20working.20in.20Rus.html#205375460">(Jul 29 2020 at 15:52)</a>:</h4>
<p>IIRC this was also reproducible with rusqlite?</p>



<a name="205375784"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/245100-t-compiler/wg-prioritization/alerts/topic/I-prioritize%20%2374657%20linker-plugin-lto%20stopped%20working%20in%20Rus/near/205375784" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> lcnr <a href="https://rust-lang.github.io/zulip_archive/stream/245100-t-compiler/wg-prioritization/alerts/topic/I-prioritize.20.2374657.20linker-plugin-lto.20stopped.20working.20in.20Rus.html#205375784">(Jul 29 2020 at 15:55)</a>:</h4>
<p>hmm, yeah. Looks like the issue was with <code>rusqlite</code>...</p>



<a name="205375816"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/245100-t-compiler/wg-prioritization/alerts/topic/I-prioritize%20%2374657%20linker-plugin-lto%20stopped%20working%20in%20Rus/near/205375816" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> lcnr <a href="https://rust-lang.github.io/zulip_archive/stream/245100-t-compiler/wg-prioritization/alerts/topic/I-prioritize.20.2374657.20linker-plugin-lto.20stopped.20working.20in.20Rus.html#205375816">(Jul 29 2020 at 15:55)</a>:</h4>
<p>so maybe it's not "if someone wants to spend a few hours building firefox" bad</p>



<a name="205376381"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/245100-t-compiler/wg-prioritization/alerts/topic/I-prioritize%20%2374657%20linker-plugin-lto%20stopped%20working%20in%20Rus/near/205376381" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Léo Lanteri Thauvin <a href="https://rust-lang.github.io/zulip_archive/stream/245100-t-compiler/wg-prioritization/alerts/topic/I-prioritize.20.2374657.20linker-plugin-lto.20stopped.20working.20in.20Rus.html#205376381">(Jul 29 2020 at 16:00)</a>:</h4>
<p>We already have the bisection though</p>



<a name="205376410"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/245100-t-compiler/wg-prioritization/alerts/topic/I-prioritize%20%2374657%20linker-plugin-lto%20stopped%20working%20in%20Rus/near/205376410" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Léo Lanteri Thauvin <a href="https://rust-lang.github.io/zulip_archive/stream/245100-t-compiler/wg-prioritization/alerts/topic/I-prioritize.20.2374657.20linker-plugin-lto.20stopped.20working.20in.20Rus.html#205376410">(Jul 29 2020 at 16:00)</a>:</h4>
<p><a href="https://github.com/rust-lang/rust/commit/1357af3a55e24c7d28abb5eda258662f2307fadd">https://github.com/rust-lang/rust/commit/1357af3a55e24c7d28abb5eda258662f2307fadd</a></p>



<a name="205376468"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/245100-t-compiler/wg-prioritization/alerts/topic/I-prioritize%20%2374657%20linker-plugin-lto%20stopped%20working%20in%20Rus/near/205376468" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> lcnr <a href="https://rust-lang.github.io/zulip_archive/stream/245100-t-compiler/wg-prioritization/alerts/topic/I-prioritize.20.2374657.20linker-plugin-lto.20stopped.20working.20in.20Rus.html#205376468">(Jul 29 2020 at 16:00)</a>:</h4>
<p>but no mvce, if I didn't miss something here</p>



<a name="205376485"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/245100-t-compiler/wg-prioritization/alerts/topic/I-prioritize%20%2374657%20linker-plugin-lto%20stopped%20working%20in%20Rus/near/205376485" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Léo Lanteri Thauvin <a href="https://rust-lang.github.io/zulip_archive/stream/245100-t-compiler/wg-prioritization/alerts/topic/I-prioritize.20.2374657.20linker-plugin-lto.20stopped.20working.20in.20Rus.html#205376485">(Jul 29 2020 at 16:00)</a>:</h4>
<p>Right</p>



<a name="205376540"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/245100-t-compiler/wg-prioritization/alerts/topic/I-prioritize%20%2374657%20linker-plugin-lto%20stopped%20working%20in%20Rus/near/205376540" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Léo Lanteri Thauvin <a href="https://rust-lang.github.io/zulip_archive/stream/245100-t-compiler/wg-prioritization/alerts/topic/I-prioritize.20.2374657.20linker-plugin-lto.20stopped.20working.20in.20Rus.html#205376540">(Jul 29 2020 at 16:01)</a>:</h4>
<p>We should ping <span class="user-mention silent" data-user-id="116015">Alex Crichton</span>  I think</p>



<a name="205376577"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/245100-t-compiler/wg-prioritization/alerts/topic/I-prioritize%20%2374657%20linker-plugin-lto%20stopped%20working%20in%20Rus/near/205376577" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> lcnr <a href="https://rust-lang.github.io/zulip_archive/stream/245100-t-compiler/wg-prioritization/alerts/topic/I-prioritize.20.2374657.20linker-plugin-lto.20stopped.20working.20in.20Rus.html#205376577">(Jul 29 2020 at 16:01)</a>:</h4>
<p>hmm, yeah... might help</p>



<a name="205376597"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/245100-t-compiler/wg-prioritization/alerts/topic/I-prioritize%20%2374657%20linker-plugin-lto%20stopped%20working%20in%20Rus/near/205376597" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Léo Lanteri Thauvin <a href="https://rust-lang.github.io/zulip_archive/stream/245100-t-compiler/wg-prioritization/alerts/topic/I-prioritize.20.2374657.20linker-plugin-lto.20stopped.20working.20in.20Rus.html#205376597">(Jul 29 2020 at 16:01)</a>:</h4>
<p>You do it or shall I?</p>



<a name="205376752"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/245100-t-compiler/wg-prioritization/alerts/topic/I-prioritize%20%2374657%20linker-plugin-lto%20stopped%20working%20in%20Rus/near/205376752" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> lcnr <a href="https://rust-lang.github.io/zulip_archive/stream/245100-t-compiler/wg-prioritization/alerts/topic/I-prioritize.20.2374657.20linker-plugin-lto.20stopped.20working.20in.20Rus.html#205376752">(Jul 29 2020 at 16:02)</a>:</h4>
<p>feel free, I should actually be working for uni rn <span aria-label="sweat smile" class="emoji emoji-1f605" role="img" title="sweat smile">:sweat_smile:</span></p>



<hr><p>Last updated: Aug 07 2021 at 22:04 UTC</p>
</html>