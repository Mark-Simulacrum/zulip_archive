<html>
<head><meta charset="utf-8"><title>#90752 Miscompilation where binding only some fields leaks … · t-compiler/wg-prioritization/alerts · Zulip Chat Archive</title></head>
<h2>Stream: <a href="https://zulip-archive.rust-lang.org/stream/245100-t-compiler/wg-prioritization/alerts/index.html">t-compiler/wg-prioritization/alerts</a></h2>
<h3>Topic: <a href="https://zulip-archive.rust-lang.org/stream/245100-t-compiler/wg-prioritization/alerts/topic/.2390752.20Miscompilation.20where.20binding.20only.20some.20fields.20leaks.20.E2.80.A6.html">#90752 Miscompilation where binding only some fields leaks …</a></h3>

<hr>

<base href="https://rust-lang.zulipchat.com">

<head><link href="https://zulip-archive.rust-lang.org/style.css" rel="stylesheet"></head>

<a name="260942981"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/245100-t-compiler/wg-prioritization/alerts/topic/%2390752%20Miscompilation%20where%20binding%20only%20some%20fields%20leaks%20%E2%80%A6/near/260942981" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> triagebot <a href="https://zulip-archive.rust-lang.org/stream/245100-t-compiler/wg-prioritization/alerts/topic/.2390752.20Miscompilation.20where.20binding.20only.20some.20fields.20leaks.20.E2.80.A6.html#260942981">(Nov 10 2021 at 03:56)</a>:</h4>
<p><span class="user-group-mention" data-user-group-id="3111">@WG-prioritization/alerts</span> issue <a href="https://github.com/rust-lang/rust/issues/90752">#90752</a> has been requested for prioritization.</p>
<h1><a href="https://forge.rust-lang.org/compiler/prioritization/procedure.html#assign-priority-to-unprioritized-issues-with-i-prioritize-label">Procedure</a></h1>
<ul>
<li>Priority?</li>
<li>Regression?</li>
<li>Notify people/groups?</li>
<li>Needs <code>I-nominated</code>?</li>
</ul>



<a name="260943955"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/245100-t-compiler/wg-prioritization/alerts/topic/%2390752%20Miscompilation%20where%20binding%20only%20some%20fields%20leaks%20%E2%80%A6/near/260943955" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Noah Lev <a href="https://zulip-archive.rust-lang.org/stream/245100-t-compiler/wg-prioritization/alerts/topic/.2390752.20Miscompilation.20where.20binding.20only.20some.20fields.20leaks.20.E2.80.A6.html#260943955">(Nov 10 2021 at 04:14)</a>:</h4>
<p>P-high? not sure if it's a regression, but it may be given the recent changes to Drop as part of precise closure capture, etc.</p>



<a name="260943967"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/245100-t-compiler/wg-prioritization/alerts/topic/%2390752%20Miscompilation%20where%20binding%20only%20some%20fields%20leaks%20%E2%80%A6/near/260943967" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Noah Lev <a href="https://zulip-archive.rust-lang.org/stream/245100-t-compiler/wg-prioritization/alerts/topic/.2390752.20Miscompilation.20where.20binding.20only.20some.20fields.20leaks.20.E2.80.A6.html#260943967">(Nov 10 2021 at 04:14)</a>:</h4>
<p>We could also just wait until T-compiler discusses it in their meeting</p>



<a name="260943968"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/245100-t-compiler/wg-prioritization/alerts/topic/%2390752%20Miscompilation%20where%20binding%20only%20some%20fields%20leaks%20%E2%80%A6/near/260943968" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Noah Lev <a href="https://zulip-archive.rust-lang.org/stream/245100-t-compiler/wg-prioritization/alerts/topic/.2390752.20Miscompilation.20where.20binding.20only.20some.20fields.20leaks.20.E2.80.A6.html#260943968">(Nov 10 2021 at 04:14)</a>:</h4>
<p>(since it's nominated)</p>



<a name="260946261"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/245100-t-compiler/wg-prioritization/alerts/topic/%2390752%20Miscompilation%20where%20binding%20only%20some%20fields%20leaks%20%E2%80%A6/near/260946261" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Gary Guo <a href="https://zulip-archive.rust-lang.org/stream/245100-t-compiler/wg-prioritization/alerts/topic/.2390752.20Miscompilation.20where.20binding.20only.20some.20fields.20leaks.20.E2.80.A6.html#260946261">(Nov 10 2021 at 05:02)</a>:</h4>
<p>Regression from 1.42 to 1.43.</p>



<a name="260946266"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/245100-t-compiler/wg-prioritization/alerts/topic/%2390752%20Miscompilation%20where%20binding%20only%20some%20fields%20leaks%20%E2%80%A6/near/260946266" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Gary Guo <a href="https://zulip-archive.rust-lang.org/stream/245100-t-compiler/wg-prioritization/alerts/topic/.2390752.20Miscompilation.20where.20binding.20only.20some.20fields.20leaks.20.E2.80.A6.html#260946266">(Nov 10 2021 at 05:03)</a>:</h4>
<p>I think this should be P-critical</p>



<a name="260946916"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/245100-t-compiler/wg-prioritization/alerts/topic/%2390752%20Miscompilation%20where%20binding%20only%20some%20fields%20leaks%20%E2%80%A6/near/260946916" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Noah Lev <a href="https://zulip-archive.rust-lang.org/stream/245100-t-compiler/wg-prioritization/alerts/topic/.2390752.20Miscompilation.20where.20binding.20only.20some.20fields.20leaks.20.E2.80.A6.html#260946916">(Nov 10 2021 at 05:16)</a>:</h4>
<p>P-critical is usually a release blocker though, and this regressed almost two years ago</p>



<a name="260946969"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/245100-t-compiler/wg-prioritization/alerts/topic/%2390752%20Miscompilation%20where%20binding%20only%20some%20fields%20leaks%20%E2%80%A6/near/260946969" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Noah Lev <a href="https://zulip-archive.rust-lang.org/stream/245100-t-compiler/wg-prioritization/alerts/topic/.2390752.20Miscompilation.20where.20binding.20only.20some.20fields.20leaks.20.E2.80.A6.html#260946969">(Nov 10 2021 at 05:16)</a>:</h4>
<p>But I'd be okay with it if others prefer P-critical</p>



<a name="260950824"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/245100-t-compiler/wg-prioritization/alerts/topic/%2390752%20Miscompilation%20where%20binding%20only%20some%20fields%20leaks%20%E2%80%A6/near/260950824" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Gary Guo <a href="https://zulip-archive.rust-lang.org/stream/245100-t-compiler/wg-prioritization/alerts/topic/.2390752.20Miscompilation.20where.20binding.20only.20some.20fields.20leaks.20.E2.80.A6.html#260950824">(Nov 10 2021 at 06:31)</a>:</h4>
<p>I <em>think</em> this could be unsound (since it's somewhat related to <a href="https://github.com/rust-lang/rust/issues/74551">#74551</a>)</p>



<a name="260951811"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/245100-t-compiler/wg-prioritization/alerts/topic/%2390752%20Miscompilation%20where%20binding%20only%20some%20fields%20leaks%20%E2%80%A6/near/260951811" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> matthiaskrgr <a href="https://zulip-archive.rust-lang.org/stream/245100-t-compiler/wg-prioritization/alerts/topic/.2390752.20Miscompilation.20where.20binding.20only.20some.20fields.20leaks.20.E2.80.A6.html#260951811">(Nov 10 2021 at 06:50)</a>:</h4>
<blockquote>
<p>regressed almost two years ago<br>
even more reason to have it fixed sooner rather then later? <span aria-label="upside down" class="emoji emoji-1f643" role="img" title="upside down">:upside_down:</span></p>
</blockquote>



<a name="261220059"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/245100-t-compiler/wg-prioritization/alerts/topic/%2390752%20Miscompilation%20where%20binding%20only%20some%20fields%20leaks%20%E2%80%A6/near/261220059" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> inquisitivecrystal <a href="https://zulip-archive.rust-lang.org/stream/245100-t-compiler/wg-prioritization/alerts/topic/.2390752.20Miscompilation.20where.20binding.20only.20some.20fields.20leaks.20.E2.80.A6.html#261220059">(Nov 12 2021 at 07:39)</a>:</h4>
<p>If I had to assign a label, I'd say <code>P-critical</code>.</p>



<a name="261220076"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/245100-t-compiler/wg-prioritization/alerts/topic/%2390752%20Miscompilation%20where%20binding%20only%20some%20fields%20leaks%20%E2%80%A6/near/261220076" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> inquisitivecrystal <a href="https://zulip-archive.rust-lang.org/stream/245100-t-compiler/wg-prioritization/alerts/topic/.2390752.20Miscompilation.20where.20binding.20only.20some.20fields.20leaks.20.E2.80.A6.html#261220076">(Nov 12 2021 at 07:39)</a>:</h4>
<p>Nominating seems like the right thing to do in this case though.</p>



<a name="261905234"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/245100-t-compiler/wg-prioritization/alerts/topic/%2390752%20Miscompilation%20where%20binding%20only%20some%20fields%20leaks%20%E2%80%A6/near/261905234" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> apiraino <a href="https://zulip-archive.rust-lang.org/stream/245100-t-compiler/wg-prioritization/alerts/topic/.2390752.20Miscompilation.20where.20binding.20only.20some.20fields.20leaks.20.E2.80.A6.html#261905234">(Nov 18 2021 at 09:44)</a>:</h4>
<p>I'll assign a p-critical in the meantime. We'll try to discuss this today, I'd like to understand if this issue can be mitigated in the short term (i.e. before the next release) and if a <code>p-critical</code> assigned today would be a release blocker. it looks the long term solution is not straightforward</p>



<a name="261905262"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/245100-t-compiler/wg-prioritization/alerts/topic/%2390752%20Miscompilation%20where%20binding%20only%20some%20fields%20leaks%20%E2%80%A6/near/261905262" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> triagebot <a href="https://zulip-archive.rust-lang.org/stream/245100-t-compiler/wg-prioritization/alerts/topic/.2390752.20Miscompilation.20where.20binding.20only.20some.20fields.20leaks.20.E2.80.A6.html#261905262">(Nov 18 2021 at 09:44)</a>:</h4>
<p>Issue <a href="https://github.com/rust-lang/rust/issues/90752">#90752</a>'s prioritization request has been removed.</p>



<a name="262107456"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/245100-t-compiler/wg-prioritization/alerts/topic/%2390752%20Miscompilation%20where%20binding%20only%20some%20fields%20leaks%20%E2%80%A6/near/262107456" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> inquisitivecrystal <a href="https://zulip-archive.rust-lang.org/stream/245100-t-compiler/wg-prioritization/alerts/topic/.2390752.20Miscompilation.20where.20binding.20only.20some.20fields.20leaks.20.E2.80.A6.html#262107456">(Nov 19 2021 at 18:23)</a>:</h4>
<p>I read through the T-compiler discussions. It seems that while people were initially unsure even there, <code>P-critical</code> was probably correct.</p>



<hr><p>Last updated: Apr 12 2022 at 20:01 UTC</p>
</html>