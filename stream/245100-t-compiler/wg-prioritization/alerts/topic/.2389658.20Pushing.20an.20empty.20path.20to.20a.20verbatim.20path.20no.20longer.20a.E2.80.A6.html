<html>
<head><meta charset="utf-8"><title>#89658 Pushing an empty path to a verbatim path no longer a… · t-compiler/wg-prioritization/alerts · Zulip Chat Archive</title></head>
<h2>Stream: <a href="https://zulip-archive.rust-lang.org/stream/245100-t-compiler/wg-prioritization/alerts/index.html">t-compiler/wg-prioritization/alerts</a></h2>
<h3>Topic: <a href="https://zulip-archive.rust-lang.org/stream/245100-t-compiler/wg-prioritization/alerts/topic/.2389658.20Pushing.20an.20empty.20path.20to.20a.20verbatim.20path.20no.20longer.20a.E2.80.A6.html">#89658 Pushing an empty path to a verbatim path no longer a…</a></h3>

<hr>

<base href="https://rust-lang.zulipchat.com">

<head><link href="https://zulip-archive.rust-lang.org/style.css" rel="stylesheet"></head>

<a name="256678860"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/245100-t-compiler/wg-prioritization/alerts/topic/%2389658%20Pushing%20an%20empty%20path%20to%20a%20verbatim%20path%20no%20longer%20a%E2%80%A6/near/256678860" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> triagebot <a href="https://zulip-archive.rust-lang.org/stream/245100-t-compiler/wg-prioritization/alerts/topic/.2389658.20Pushing.20an.20empty.20path.20to.20a.20verbatim.20path.20no.20longer.20a.E2.80.A6.html#256678860">(Oct 08 2021 at 02:18)</a>:</h4>
<p><span class="user-group-mention" data-user-group-id="3111">@WG-prioritization/alerts</span> issue <a href="https://github.com/rust-lang/rust/issues/89658">#89658</a> has been requested for prioritization.</p>
<h1><a href="https://forge.rust-lang.org/compiler/prioritization/procedure.html#assign-priority-to-unprioritized-issues-with-i-prioritize-label">Procedure</a></h1>
<ul>
<li>Priority?</li>
<li>Regression?</li>
<li>Notify people/groups?</li>
<li>Needs <code>I-nominated</code>?</li>
</ul>



<a name="256678861"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/245100-t-compiler/wg-prioritization/alerts/topic/%2389658%20Pushing%20an%20empty%20path%20to%20a%20verbatim%20path%20no%20longer%20a%E2%80%A6/near/256678861" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> triagebot <a href="https://zulip-archive.rust-lang.org/stream/245100-t-compiler/wg-prioritization/alerts/topic/.2389658.20Pushing.20an.20empty.20path.20to.20a.20verbatim.20path.20no.20longer.20a.E2.80.A6.html#256678861">(Oct 08 2021 at 02:18)</a>:</h4>
<p>Issue <a href="https://github.com/rust-lang/rust/issues/89658">#89658</a>'s prioritization request has been removed.</p>



<a name="256678863"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/245100-t-compiler/wg-prioritization/alerts/topic/%2389658%20Pushing%20an%20empty%20path%20to%20a%20verbatim%20path%20no%20longer%20a%E2%80%A6/near/256678863" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> triagebot <a href="https://zulip-archive.rust-lang.org/stream/245100-t-compiler/wg-prioritization/alerts/topic/.2389658.20Pushing.20an.20empty.20path.20to.20a.20verbatim.20path.20no.20longer.20a.E2.80.A6.html#256678863">(Oct 08 2021 at 02:18)</a>:</h4>
<p><span class="user-group-mention" data-user-group-id="3111">@WG-prioritization/alerts</span> issue <a href="https://github.com/rust-lang/rust/issues/89658">#89658</a> has been requested for prioritization.</p>
<h1><a href="https://forge.rust-lang.org/compiler/prioritization/procedure.html#assign-priority-to-unprioritized-issues-with-i-prioritize-label">Procedure</a></h1>
<ul>
<li>Priority?</li>
<li>Regression?</li>
<li>Notify people/groups?</li>
<li>Needs <code>I-nominated</code>?</li>
</ul>



<a name="256702588"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/245100-t-compiler/wg-prioritization/alerts/topic/%2389658%20Pushing%20an%20empty%20path%20to%20a%20verbatim%20path%20no%20longer%20a%E2%80%A6/near/256702588" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> apiraino <a href="https://zulip-archive.rust-lang.org/stream/245100-t-compiler/wg-prioritization/alerts/topic/.2389658.20Pushing.20an.20empty.20path.20to.20a.20verbatim.20path.20no.20longer.20a.E2.80.A6.html#256702588">(Oct 08 2021 at 08:01)</a>:</h4>
<p>Relevant discussion <a class="stream-topic" data-stream-id="219381" href="/#narrow/stream/219381-t-libs/topic/windows.20verbatim.20paths.2C.20normalization.20vs.2E.20canonicalize.20etc.2E">#t-libs &gt; windows verbatim paths, normalization vs. canonicalize etc.</a> <br>
I /think/ the mentioned PR <a href="https://github.com/rust-lang/rust/issues/89270">#89270</a> implemented the desired behaviour of handling Windows UNC paths.</p>
<p>Well, while I was pondering it this was a regression or the new desired behaviour, PR author jumped in with a fix, so it's a regression.</p>



<a name="256702612"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/245100-t-compiler/wg-prioritization/alerts/topic/%2389658%20Pushing%20an%20empty%20path%20to%20a%20verbatim%20path%20no%20longer%20a%E2%80%A6/near/256702612" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> apiraino <a href="https://zulip-archive.rust-lang.org/stream/245100-t-compiler/wg-prioritization/alerts/topic/.2389658.20Pushing.20an.20empty.20path.20to.20a.20verbatim.20path.20no.20longer.20a.E2.80.A6.html#256702612">(Oct 08 2021 at 08:01)</a>:</h4>
<p>in this case I'd say <code>P-high</code> because breaking production code</p>



<a name="256702842"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/245100-t-compiler/wg-prioritization/alerts/topic/%2389658%20Pushing%20an%20empty%20path%20to%20a%20verbatim%20path%20no%20longer%20a%E2%80%A6/near/256702842" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> apiraino <a href="https://zulip-archive.rust-lang.org/stream/245100-t-compiler/wg-prioritization/alerts/topic/.2389658.20Pushing.20an.20empty.20path.20to.20a.20verbatim.20path.20no.20longer.20a.E2.80.A6.html#256702842">(Oct 08 2021 at 08:03)</a>:</h4>
<p>this is T-libs stuff, I didn't realize that... <em>sigh</em></p>



<a name="256704405"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/245100-t-compiler/wg-prioritization/alerts/topic/%2389658%20Pushing%20an%20empty%20path%20to%20a%20verbatim%20path%20no%20longer%20a%E2%80%A6/near/256704405" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sean Young <a href="https://zulip-archive.rust-lang.org/stream/245100-t-compiler/wg-prioritization/alerts/topic/.2389658.20Pushing.20an.20empty.20path.20to.20a.20verbatim.20path.20no.20longer.20a.E2.80.A6.html#256704405">(Oct 08 2021 at 08:18)</a>:</h4>
<p>I've just added a comment to <a href="https://github.com/rust-lang/rust/issues/89658">https://github.com/rust-lang/rust/issues/89658</a></p>
<p>1.</p>
<p>I've created a fix for normpath: <a href="https://github.com/dylni/normpath/pull/4">https://github.com/dylni/normpath/pull/4</a></p>
<p>2</p>
<p>Appending directory separators using <code>.push("")</code> is a debatable.</p>
<p>3</p>
<p>I don't believe to require a fix. Since verbatim paths have special handling to ensure the returned path normalized, yes there are differences. The output of <code>.push()</code> on verbatim and non-verbatim paths will have to be different.</p>
<p>Consider:</p>
<div class="codehilite"><pre><span></span><code>   let mut foo = PathBuf::from(&quot;/tmp/foo&quot;);
   foo.push(&quot;.&quot;);
   let mut bar = PathBuf::from(&quot;\\?\tmp\foo&quot;);
   bar.push(&quot;.&quot;);
</code></pre></div>
<p>Since bar is normalized, bar will be <code>\\?\tmp\foo</code>, yet foo will be <code>/tmp/foo/.</code>.</p>
<p>4</p>
<p>There is a host of issues which <a href="https://github.com/rust-lang/rust/pull/89270">https://github.com/rust-lang/rust/pull/89270</a> fixes. So, there might be breakage in some edge cases, but counter this to the list of issues it resolves.</p>



<a name="256705775"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/245100-t-compiler/wg-prioritization/alerts/topic/%2389658%20Pushing%20an%20empty%20path%20to%20a%20verbatim%20path%20no%20longer%20a%E2%80%A6/near/256705775" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> apiraino <a href="https://zulip-archive.rust-lang.org/stream/245100-t-compiler/wg-prioritization/alerts/topic/.2389658.20Pushing.20an.20empty.20path.20to.20a.20verbatim.20path.20no.20longer.20a.E2.80.A6.html#256705775">(Oct 08 2021 at 08:29)</a>:</h4>
<blockquote>
<p>There is a host of issues which <a href="https://github.com/rust-lang/rust/issues/89270">#89270</a> fixes. So, there might be breakage in some edge cases, but counter this to the list of issues it resolves.</p>
</blockquote>
<p>was exactly my thought.</p>
<p>Thank you <span class="user-mention" data-user-id="445327">@Sean Young</span> for jumping in very quickly with useful insights and context!</p>



<a name="256705949"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/245100-t-compiler/wg-prioritization/alerts/topic/%2389658%20Pushing%20an%20empty%20path%20to%20a%20verbatim%20path%20no%20longer%20a%E2%80%A6/near/256705949" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> triagebot <a href="https://zulip-archive.rust-lang.org/stream/245100-t-compiler/wg-prioritization/alerts/topic/.2389658.20Pushing.20an.20empty.20path.20to.20a.20verbatim.20path.20no.20longer.20a.E2.80.A6.html#256705949">(Oct 08 2021 at 08:31)</a>:</h4>
<p>Issue <a href="https://github.com/rust-lang/rust/issues/89658">#89658</a>'s prioritization request has been removed.</p>



<a name="256711835"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/245100-t-compiler/wg-prioritization/alerts/topic/%2389658%20Pushing%20an%20empty%20path%20to%20a%20verbatim%20path%20no%20longer%20a%E2%80%A6/near/256711835" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sean Young <a href="https://zulip-archive.rust-lang.org/stream/245100-t-compiler/wg-prioritization/alerts/topic/.2389658.20Pushing.20an.20empty.20path.20to.20a.20verbatim.20path.20no.20longer.20a.E2.80.A6.html#256711835">(Oct 08 2021 at 09:23)</a>:</h4>
<p>I've also created this pr, so that the existing behaviour is maintianed for <code>.push("")</code>:</p>
<p><a href="https://github.com/rust-lang/rust/pull/89665">https://github.com/rust-lang/rust/pull/89665</a></p>



<a name="259019469"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/245100-t-compiler/wg-prioritization/alerts/topic/%2389658%20Pushing%20an%20empty%20path%20to%20a%20verbatim%20path%20no%20longer%20a%E2%80%A6/near/259019469" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> triagebot <a href="https://zulip-archive.rust-lang.org/stream/245100-t-compiler/wg-prioritization/alerts/topic/.2389658.20Pushing.20an.20empty.20path.20to.20a.20verbatim.20path.20no.20longer.20a.E2.80.A6.html#259019469">(Oct 25 2021 at 20:56)</a>:</h4>
<p><span class="user-group-mention" data-user-group-id="3111">@WG-prioritization/alerts</span> issue <a href="https://github.com/rust-lang/rust/issues/89658">#89658</a> has been requested for prioritization.</p>
<h1><a href="https://forge.rust-lang.org/compiler/prioritization/procedure.html#assign-priority-to-unprioritized-issues-with-i-prioritize-label">Procedure</a></h1>
<ul>
<li>Priority?</li>
<li>Regression?</li>
<li>Notify people/groups?</li>
<li>Needs <code>I-nominated</code>?</li>
</ul>



<a name="259019546"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/245100-t-compiler/wg-prioritization/alerts/topic/%2389658%20Pushing%20an%20empty%20path%20to%20a%20verbatim%20path%20no%20longer%20a%E2%80%A6/near/259019546" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> triagebot <a href="https://zulip-archive.rust-lang.org/stream/245100-t-compiler/wg-prioritization/alerts/topic/.2389658.20Pushing.20an.20empty.20path.20to.20a.20verbatim.20path.20no.20longer.20a.E2.80.A6.html#259019546">(Oct 25 2021 at 20:57)</a>:</h4>
<p>Issue <a href="https://github.com/rust-lang/rust/issues/89658">#89658</a>'s prioritization request has been removed.</p>



<hr><p>Last updated: Apr 12 2022 at 20:01 UTC</p>
</html>