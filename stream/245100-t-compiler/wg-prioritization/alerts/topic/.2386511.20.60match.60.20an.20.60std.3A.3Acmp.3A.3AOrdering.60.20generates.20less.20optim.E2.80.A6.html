<html>
<head><meta charset="utf-8"><title>#86511 `match` an `std::cmp::Ordering` generates less optim… · t-compiler/wg-prioritization/alerts · Zulip Chat Archive</title></head>
<h2>Stream: <a href="https://rust-lang.github.io/zulip_archive/stream/245100-t-compiler/wg-prioritization/alerts/index.html">t-compiler/wg-prioritization/alerts</a></h2>
<h3>Topic: <a href="https://rust-lang.github.io/zulip_archive/stream/245100-t-compiler/wg-prioritization/alerts/topic/.2386511.20.60match.60.20an.20.60std.3A.3Acmp.3A.3AOrdering.60.20generates.20less.20optim.E2.80.A6.html">#86511 `match` an `std::cmp::Ordering` generates less optim…</a></h3>

<hr>

<base href="https://rust-lang.zulipchat.com">

<head><link href="https://rust-lang.github.io/zulip_archive/style.css" rel="stylesheet"></head>

<a name="243363721"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/245100-t-compiler/wg-prioritization/alerts/topic/%2386511%20%60match%60%20an%20%60std%3A%3Acmp%3A%3AOrdering%60%20generates%20less%20optim%E2%80%A6/near/243363721" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> triagebot <a href="https://rust-lang.github.io/zulip_archive/stream/245100-t-compiler/wg-prioritization/alerts/topic/.2386511.20.60match.60.20an.20.60std.3A.3Acmp.3A.3AOrdering.60.20generates.20less.20optim.E2.80.A6.html#243363721">(Jun 21 2021 at 10:32)</a>:</h4>
<p><span class="user-group-mention" data-user-group-id="3111">@WG-prioritization/alerts</span> issue <a href="https://github.com/rust-lang/rust/issues/86511">#86511</a> has been requested for prioritization.</p>
<h1><a href="https://forge.rust-lang.org/compiler/prioritization/procedure.html#assign-priority-to-unprioritized-issues-with-i-prioritize-label">Procedure</a></h1>
<ul>
<li>Priority?</li>
<li>Regression?</li>
<li>Notify people/groups?</li>
<li>Needs <code>I-nominated</code>?</li>
</ul>



<a name="243380443"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/245100-t-compiler/wg-prioritization/alerts/topic/%2386511%20%60match%60%20an%20%60std%3A%3Acmp%3A%3AOrdering%60%20generates%20less%20optim%E2%80%A6/near/243380443" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Yuki Okushi <a href="https://rust-lang.github.io/zulip_archive/stream/245100-t-compiler/wg-prioritization/alerts/topic/.2386511.20.60match.60.20an.20.60std.3A.3Acmp.3A.3AOrdering.60.20generates.20less.20optim.E2.80.A6.html#243380443">(Jun 21 2021 at 13:20)</a>:</h4>
<p>hmm, just looking at assembly but it seems bad</p>



<a name="243380646"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/245100-t-compiler/wg-prioritization/alerts/topic/%2386511%20%60match%60%20an%20%60std%3A%3Acmp%3A%3AOrdering%60%20generates%20less%20optim%E2%80%A6/near/243380646" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Yuki Okushi <a href="https://rust-lang.github.io/zulip_archive/stream/245100-t-compiler/wg-prioritization/alerts/topic/.2386511.20.60match.60.20an.20.60std.3A.3Acmp.3A.3AOrdering.60.20generates.20less.20optim.E2.80.A6.html#243380646">(Jun 21 2021 at 13:22)</a>:</h4>
<p>marked as regression-from-stable-to-beta as 1.54.0 has this regression</p>



<a name="243494874"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/245100-t-compiler/wg-prioritization/alerts/topic/%2386511%20%60match%60%20an%20%60std%3A%3Acmp%3A%3AOrdering%60%20generates%20less%20optim%E2%80%A6/near/243494874" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Léo Lanteri Thauvin <a href="https://rust-lang.github.io/zulip_archive/stream/245100-t-compiler/wg-prioritization/alerts/topic/.2386511.20.60match.60.20an.20.60std.3A.3Acmp.3A.3AOrdering.60.20generates.20less.20optim.E2.80.A6.html#243494874">(Jun 22 2021 at 10:07)</a>:</h4>
<p>There's been no bisection across all linked issues</p>



<a name="243495706"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/245100-t-compiler/wg-prioritization/alerts/topic/%2386511%20%60match%60%20an%20%60std%3A%3Acmp%3A%3AOrdering%60%20generates%20less%20optim%E2%80%A6/near/243495706" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> inquisitivecrystal <a href="https://rust-lang.github.io/zulip_archive/stream/245100-t-compiler/wg-prioritization/alerts/topic/.2386511.20.60match.60.20an.20.60std.3A.3Acmp.3A.3AOrdering.60.20generates.20less.20optim.E2.80.A6.html#243495706">(Jun 22 2021 at 10:16)</a>:</h4>
<p>I had a go a few hours ago, but I couldn't figure out how to get the difference to show up in a way I could distinguish. :/ Although it might be a target specific thing, there's a fair chance that it was just my inexperience looking at assembly.</p>



<a name="243749176"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/245100-t-compiler/wg-prioritization/alerts/topic/%2386511%20%60match%60%20an%20%60std%3A%3Acmp%3A%3AOrdering%60%20generates%20less%20optim%E2%80%A6/near/243749176" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> inquisitivecrystal <a href="https://rust-lang.github.io/zulip_archive/stream/245100-t-compiler/wg-prioritization/alerts/topic/.2386511.20.60match.60.20an.20.60std.3A.3Acmp.3A.3AOrdering.60.20generates.20less.20optim.E2.80.A6.html#243749176">(Jun 24 2021 at 07:15)</a>:</h4>
<p>Should 2 of these be closed as dupliciates in favor of the third? Or are they distinct?</p>



<a name="243749396"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/245100-t-compiler/wg-prioritization/alerts/topic/%2386511%20%60match%60%20an%20%60std%3A%3Acmp%3A%3AOrdering%60%20generates%20less%20optim%E2%80%A6/near/243749396" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> inquisitivecrystal <a href="https://rust-lang.github.io/zulip_archive/stream/245100-t-compiler/wg-prioritization/alerts/topic/.2386511.20.60match.60.20an.20.60std.3A.3Acmp.3A.3AOrdering.60.20generates.20less.20optim.E2.80.A6.html#243749396">(Jun 24 2021 at 07:18)</a>:</h4>
<p>I might be inclined to go with <code>P-high</code>. It's a performance regression bad enough that 3 people noticed, so it merits a very high priority. At the same time, I don't think performance regressions are <code>P-critical</code> unless they're, well, critical. It doesn't seem like this one is quite at that level, given how narrow the case where it applies is.</p>



<a name="243754985"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/245100-t-compiler/wg-prioritization/alerts/topic/%2386511%20%60match%60%20an%20%60std%3A%3Acmp%3A%3AOrdering%60%20generates%20less%20optim%E2%80%A6/near/243754985" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> apiraino <a href="https://rust-lang.github.io/zulip_archive/stream/245100-t-compiler/wg-prioritization/alerts/topic/.2386511.20.60match.60.20an.20.60std.3A.3Acmp.3A.3AOrdering.60.20generates.20less.20optim.E2.80.A6.html#243754985">(Jun 24 2021 at 08:25)</a>:</h4>
<p>hm .. indeed this also looks to me as a duplicate. I'll try getting more eyes on these issues, seems they passed under the radar</p>



<a name="243755805"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/245100-t-compiler/wg-prioritization/alerts/topic/%2386511%20%60match%60%20an%20%60std%3A%3Acmp%3A%3AOrdering%60%20generates%20less%20optim%E2%80%A6/near/243755805" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> apiraino <a href="https://rust-lang.github.io/zulip_archive/stream/245100-t-compiler/wg-prioritization/alerts/topic/.2386511.20.60match.60.20an.20.60std.3A.3Acmp.3A.3AOrdering.60.20generates.20less.20optim.E2.80.A6.html#243755805">(Jun 24 2021 at 08:34)</a>:</h4>
<p><span class="user-mention silent" data-user-id="255061">Léo Lanteri Thauvin</span> <a href="#narrow/stream/245100-t-compiler.2Fwg-prioritization.2Falerts/topic/.2386511.20.60match.60.20an.20.60std.3A.3Acmp.3A.3AOrdering.60.20generates.20less.20optim.E2.80.A6/near/243494874">said</a>:</p>
<blockquote>
<p>There's been no bisection across all linked issues</p>
</blockquote>
<p>I am curious about how would a semi-automated bisection be like on this code. I imagine starting from the mcve in this issue and ... somehow compare the generated asm? But what would be the tooling involved for that?</p>



<a name="244533723"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/245100-t-compiler/wg-prioritization/alerts/topic/%2386511%20%60match%60%20an%20%60std%3A%3Acmp%3A%3AOrdering%60%20generates%20less%20optim%E2%80%A6/near/244533723" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> apiraino <a href="https://rust-lang.github.io/zulip_archive/stream/245100-t-compiler/wg-prioritization/alerts/topic/.2386511.20.60match.60.20an.20.60std.3A.3Acmp.3A.3AOrdering.60.20generates.20less.20optim.E2.80.A6.html#244533723">(Jul 01 2021 at 08:29)</a>:</h4>
<p><span class="user-group-mention" data-user-group-id="2403">@WG-prioritization</span> I think I'll add <code>I-nominated</code> to this one and try to get more eyeballs during today's T-compiler meeting. Just want to be sure it is correctly framed</p>



<a name="244533884"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/245100-t-compiler/wg-prioritization/alerts/topic/%2386511%20%60match%60%20an%20%60std%3A%3Acmp%3A%3AOrdering%60%20generates%20less%20optim%E2%80%A6/near/244533884" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Stu <a href="https://rust-lang.github.io/zulip_archive/stream/245100-t-compiler/wg-prioritization/alerts/topic/.2386511.20.60match.60.20an.20.60std.3A.3Acmp.3A.3AOrdering.60.20generates.20less.20optim.E2.80.A6.html#244533884">(Jul 01 2021 at 08:31)</a>:</h4>
<p>Yea sounds good. The issue should definitely not be forgotten IMO.</p>



<a name="244656323"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/245100-t-compiler/wg-prioritization/alerts/topic/%2386511%20%60match%60%20an%20%60std%3A%3Acmp%3A%3AOrdering%60%20generates%20less%20optim%E2%80%A6/near/244656323" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> inquisitivecrystal <a href="https://rust-lang.github.io/zulip_archive/stream/245100-t-compiler/wg-prioritization/alerts/topic/.2386511.20.60match.60.20an.20.60std.3A.3Acmp.3A.3AOrdering.60.20generates.20less.20optim.E2.80.A6.html#244656323">(Jul 02 2021 at 03:32)</a>:</h4>
<p><code>I-nominated</code> sounds good to me! It's definitely important that someone get assigned to this.</p>



<a name="247558489"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/245100-t-compiler/wg-prioritization/alerts/topic/%2386511%20%60match%60%20an%20%60std%3A%3Acmp%3A%3AOrdering%60%20generates%20less%20optim%E2%80%A6/near/247558489" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> apiraino <a href="https://rust-lang.github.io/zulip_archive/stream/245100-t-compiler/wg-prioritization/alerts/topic/.2386511.20.60match.60.20an.20.60std.3A.3Acmp.3A.3AOrdering.60.20generates.20less.20optim.E2.80.A6.html#247558489">(Jul 29 2021 at 08:53)</a>:</h4>
<p>This issue has been discussed by T-compiler but now won't make it to the release. I'd bump it up with a P-high to boost the signal for the next 1.55</p>



<a name="247558515"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/245100-t-compiler/wg-prioritization/alerts/topic/%2386511%20%60match%60%20an%20%60std%3A%3Acmp%3A%3AOrdering%60%20generates%20less%20optim%E2%80%A6/near/247558515" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> triagebot <a href="https://rust-lang.github.io/zulip_archive/stream/245100-t-compiler/wg-prioritization/alerts/topic/.2386511.20.60match.60.20an.20.60std.3A.3Acmp.3A.3AOrdering.60.20generates.20less.20optim.E2.80.A6.html#247558515">(Jul 29 2021 at 08:53)</a>:</h4>
<p>Issue <a href="https://github.com/rust-lang/rust/issues/86511">#86511</a>'s prioritization request has been removed.</p>



<hr><p>Last updated: Aug 07 2021 at 22:04 UTC</p>
</html>