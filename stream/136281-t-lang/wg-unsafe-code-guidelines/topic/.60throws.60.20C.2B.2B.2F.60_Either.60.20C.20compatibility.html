<html>
<head><meta charset="utf-8"><title>`throws` C++/`_Either` C compatibility · t-lang/wg-unsafe-code-guidelines · Zulip Chat Archive</title></head>
<h2>Stream: <a href="https://zulip-archive.rust-lang.org/stream/136281-t-lang/wg-unsafe-code-guidelines/index.html">t-lang/wg-unsafe-code-guidelines</a></h2>
<h3>Topic: <a href="https://zulip-archive.rust-lang.org/stream/136281-t-lang/wg-unsafe-code-guidelines/topic/.60throws.60.20C.2B.2B.2F.60_Either.60.20C.20compatibility.html">`throws` C++/`_Either` C compatibility</a></h3>

<hr>

<base href="https://rust-lang.zulipchat.com">

<head><link href="https://zulip-archive.rust-lang.org/style.css" rel="stylesheet"></head>

<a name="131151106"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/136281-t-lang/wg-unsafe-code-guidelines/topic/%60throws%60%20C%2B%2B/%60_Either%60%20C%20compatibility/near/131151106" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Nicole Mazzuca <a href="https://zulip-archive.rust-lang.org/stream/136281-t-lang/wg-unsafe-code-guidelines/topic/.60throws.60.20C.2B.2B.2F.60_Either.60.20C.20compatibility.html#131151106">(Aug 09 2018 at 05:07)</a>:</h4>
<p>Have people been thinking about how to make us compatible with <a href="https://docs.google.com/viewer?a=v&amp;pid=forums&amp;srcid=MTEwODAzNzI2MjM1OTc0MjE3MjkBMDIyMjg0NDY2NTc4NzYyMDQzODYBX1RlYjRCNjREQUFKATAuMQFpc29jcHAub3JnAXYy&amp;authuser=0" target="_blank" title="https://docs.google.com/viewer?a=v&amp;pid=forums&amp;srcid=MTEwODAzNzI2MjM1OTc0MjE3MjkBMDIyMjg0NDY2NTc4NzYyMDQzODYBX1RlYjRCNjREQUFKATAuMQFpc29jcHAub3JnAXYy&amp;authuser=0">https://docs.google.com/viewer?a=v&amp;pid=forums&amp;srcid=MTEwODAzNzI2MjM1OTc0MjE3MjkBMDIyMjg0NDY2NTc4NzYyMDQzODYBX1RlYjRCNjREQUFKATAuMQFpc29jcHAub3JnAXYy&amp;authuser=0</a> ?</p>
<p>Ability to communicate high-level errors between the three systems languages is a high priority thing for the new static exceptions proposal.</p>



<a name="131163080"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/136281-t-lang/wg-unsafe-code-guidelines/topic/%60throws%60%20C%2B%2B/%60_Either%60%20C%20compatibility/near/131163080" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/136281-t-lang/wg-unsafe-code-guidelines/topic/.60throws.60.20C.2B.2B.2F.60_Either.60.20C.20compatibility.html#131163080">(Aug 09 2018 at 10:26)</a>:</h4>
<p>I haven't looked at that specific proposal, but I do think that we should find ways to be "officially" compatible with various other exception mechanisms</p>



<a name="131163092"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/136281-t-lang/wg-unsafe-code-guidelines/topic/%60throws%60%20C%2B%2B/%60_Either%60%20C%20compatibility/near/131163092" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/136281-t-lang/wg-unsafe-code-guidelines/topic/.60throws.60.20C.2B.2B.2F.60_Either.60.20C.20compatibility.html#131163092">(Aug 09 2018 at 10:26)</a>:</h4>
<p>this came up in the context of <code>setjmp</code> etc as well</p>



<a name="131163097"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/136281-t-lang/wg-unsafe-code-guidelines/topic/%60throws%60%20C%2B%2B/%60_Either%60%20C%20compatibility/near/131163097" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/136281-t-lang/wg-unsafe-code-guidelines/topic/.60throws.60.20C.2B.2B.2F.60_Either.60.20C.20compatibility.html#131163097">(Aug 09 2018 at 10:26)</a>:</h4>
<p>and Microsoft's error handling mechanism, the name of which escapes me just now</p>



<a name="131163438"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/136281-t-lang/wg-unsafe-code-guidelines/topic/%60throws%60%20C%2B%2B/%60_Either%60%20C%20compatibility/near/131163438" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> RalfJ <a href="https://zulip-archive.rust-lang.org/stream/136281-t-lang/wg-unsafe-code-guidelines/topic/.60throws.60.20C.2B.2B.2F.60_Either.60.20C.20compatibility.html#131163438">(Aug 09 2018 at 10:34)</a>:</h4>
<p>woah that stuff looks extremely familiar</p>



<a name="131163439"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/136281-t-lang/wg-unsafe-code-guidelines/topic/%60throws%60%20C%2B%2B/%60_Either%60%20C%20compatibility/near/131163439" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> RalfJ <a href="https://zulip-archive.rust-lang.org/stream/136281-t-lang/wg-unsafe-code-guidelines/topic/.60throws.60.20C.2B.2B.2F.60_Either.60.20C.20compatibility.html#131163439">(Aug 09 2018 at 10:34)</a>:</h4>
<p>are they copying this from Rust verbatim? ;)</p>



<a name="131163450"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/136281-t-lang/wg-unsafe-code-guidelines/topic/%60throws%60%20C%2B%2B/%60_Either%60%20C%20compatibility/near/131163450" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> RalfJ <a href="https://zulip-archive.rust-lang.org/stream/136281-t-lang/wg-unsafe-code-guidelines/topic/.60throws.60.20C.2B.2B.2F.60_Either.60.20C.20compatibility.html#131163450">(Aug 09 2018 at 10:35)</a>:</h4>
<p>they even have <code>try!</code>...</p>



<a name="131163521"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/136281-t-lang/wg-unsafe-code-guidelines/topic/%60throws%60%20C%2B%2B/%60_Either%60%20C%20compatibility/near/131163521" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> RalfJ <a href="https://zulip-archive.rust-lang.org/stream/136281-t-lang/wg-unsafe-code-guidelines/topic/.60throws.60.20C.2B.2B.2F.60_Either.60.20C.20compatibility.html#131163521">(Aug 09 2018 at 10:36)</a>:</h4>
<blockquote>
<p>I don't wish to mention the `m word' in this paper,</p>
</blockquote>
<p><span class="emoji emoji-1f602" title="joy">:joy:</span></p>



<a name="131175017"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/136281-t-lang/wg-unsafe-code-guidelines/topic/%60throws%60%20C%2B%2B/%60_Either%60%20C%20compatibility/near/131175017" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Nicole Mazzuca <a href="https://zulip-archive.rust-lang.org/stream/136281-t-lang/wg-unsafe-code-guidelines/topic/.60throws.60.20C.2B.2B.2F.60_Either.60.20C.20compatibility.html#131175017">(Aug 09 2018 at 14:17)</a>:</h4>
<p>SEH, but to be clear this is _extremely_ different. This has a similar ABI to Rust Either&lt;T, E&gt;, and is written like those <code>throws</code> functions that may or may not have gotten int</p>



<a name="131175352"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/136281-t-lang/wg-unsafe-code-guidelines/topic/%60throws%60%20C%2B%2B/%60_Either%60%20C%20compatibility/near/131175352" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> RalfJ <a href="https://zulip-archive.rust-lang.org/stream/136281-t-lang/wg-unsafe-code-guidelines/topic/.60throws.60.20C.2B.2B.2F.60_Either.60.20C.20compatibility.html#131175352">(Aug 09 2018 at 14:23)</a>:</h4>
<p>to me this sounds like having two return continuations</p>



<a name="131175356"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/136281-t-lang/wg-unsafe-code-guidelines/topic/%60throws%60%20C%2B%2B/%60_Either%60%20C%20compatibility/near/131175356" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> RalfJ <a href="https://zulip-archive.rust-lang.org/stream/136281-t-lang/wg-unsafe-code-guidelines/topic/.60throws.60.20C.2B.2B.2F.60_Either.60.20C.20compatibility.html#131175356">(Aug 09 2018 at 14:23)</a>:</h4>
<p>in CPS terminology</p>



<a name="131175360"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/136281-t-lang/wg-unsafe-code-guidelines/topic/%60throws%60%20C%2B%2B/%60_Either%60%20C%20compatibility/near/131175360" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> RalfJ <a href="https://zulip-archive.rust-lang.org/stream/136281-t-lang/wg-unsafe-code-guidelines/topic/.60throws.60.20C.2B.2B.2F.60_Either.60.20C.20compatibility.html#131175360">(Aug 09 2018 at 14:23)</a>:</h4>
<p>which they also avoid talking about, but still, that's exactly what it is?</p>



<a name="131175449"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/136281-t-lang/wg-unsafe-code-guidelines/topic/%60throws%60%20C%2B%2B/%60_Either%60%20C%20compatibility/near/131175449" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Nicole Mazzuca <a href="https://zulip-archive.rust-lang.org/stream/136281-t-lang/wg-unsafe-code-guidelines/topic/.60throws.60.20C.2B.2B.2F.60_Either.60.20C.20compatibility.html#131175449">(Aug 09 2018 at 14:24)</a>:</h4>
<p>similar, yeah, but using the return slot</p>



<a name="131175458"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/136281-t-lang/wg-unsafe-code-guidelines/topic/%60throws%60%20C%2B%2B/%60_Either%60%20C%20compatibility/near/131175458" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Nicole Mazzuca <a href="https://zulip-archive.rust-lang.org/stream/136281-t-lang/wg-unsafe-code-guidelines/topic/.60throws.60.20C.2B.2B.2F.60_Either.60.20C.20compatibility.html#131175458">(Aug 09 2018 at 14:24)</a>:</h4>
<p>it's really just <code>Result&lt;T, E&gt;</code></p>



<a name="131175467"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/136281-t-lang/wg-unsafe-code-guidelines/topic/%60throws%60%20C%2B%2B/%60_Either%60%20C%20compatibility/near/131175467" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Nicole Mazzuca <a href="https://zulip-archive.rust-lang.org/stream/136281-t-lang/wg-unsafe-code-guidelines/topic/.60throws.60.20C.2B.2B.2F.60_Either.60.20C.20compatibility.html#131175467">(Aug 09 2018 at 14:24)</a>:</h4>
<p>with a special ABI</p>



<a name="131176265"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/136281-t-lang/wg-unsafe-code-guidelines/topic/%60throws%60%20C%2B%2B/%60_Either%60%20C%20compatibility/near/131176265" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> RalfJ <a href="https://zulip-archive.rust-lang.org/stream/136281-t-lang/wg-unsafe-code-guidelines/topic/.60throws.60.20C.2B.2B.2F.60_Either.60.20C.20compatibility.html#131176265">(Aug 09 2018 at 14:38)</a>:</h4>
<p>So it always jumps back to the same address, and the only special thing is an enum layout optimization where the tag is stored in some flag register?</p>



<a name="131176278"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/136281-t-lang/wg-unsafe-code-guidelines/topic/%60throws%60%20C%2B%2B/%60_Either%60%20C%20compatibility/near/131176278" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Nicole Mazzuca <a href="https://zulip-archive.rust-lang.org/stream/136281-t-lang/wg-unsafe-code-guidelines/topic/.60throws.60.20C.2B.2B.2F.60_Either.60.20C.20compatibility.html#131176278">(Aug 09 2018 at 14:38)</a>:</h4>
<p>yep</p>



<a name="131176294"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/136281-t-lang/wg-unsafe-code-guidelines/topic/%60throws%60%20C%2B%2B/%60_Either%60%20C%20compatibility/near/131176294" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> RalfJ <a href="https://zulip-archive.rust-lang.org/stream/136281-t-lang/wg-unsafe-code-guidelines/topic/.60throws.60.20C.2B.2B.2F.60_Either.60.20C.20compatibility.html#131176294">(Aug 09 2018 at 14:38)</a>:</h4>
<p>makes sense</p>



<a name="131176303"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/136281-t-lang/wg-unsafe-code-guidelines/topic/%60throws%60%20C%2B%2B/%60_Either%60%20C%20compatibility/near/131176303" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> RalfJ <a href="https://zulip-archive.rust-lang.org/stream/136281-t-lang/wg-unsafe-code-guidelines/topic/.60throws.60.20C.2B.2B.2F.60_Either.60.20C.20compatibility.html#131176303">(Aug 09 2018 at 14:38)</a>:</h4>
<p>did they do this after seeing how well it works in Rust?</p>



<a name="131176313"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/136281-t-lang/wg-unsafe-code-guidelines/topic/%60throws%60%20C%2B%2B/%60_Either%60%20C%20compatibility/near/131176313" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Nicole Mazzuca <a href="https://zulip-archive.rust-lang.org/stream/136281-t-lang/wg-unsafe-code-guidelines/topic/.60throws.60.20C.2B.2B.2F.60_Either.60.20C.20compatibility.html#131176313">(Aug 09 2018 at 14:39)</a>:</h4>
<p>I dunno</p>



<a name="131176314"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/136281-t-lang/wg-unsafe-code-guidelines/topic/%60throws%60%20C%2B%2B/%60_Either%60%20C%20compatibility/near/131176314" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> RalfJ <a href="https://zulip-archive.rust-lang.org/stream/136281-t-lang/wg-unsafe-code-guidelines/topic/.60throws.60.20C.2B.2B.2F.60_Either.60.20C.20compatibility.html#131176314">(Aug 09 2018 at 14:39)</a>:</h4>
<p>Rust isn't mentioned, except for the changelog saying it used to be mentioned^^</p>



<a name="131176325"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/136281-t-lang/wg-unsafe-code-guidelines/topic/%60throws%60%20C%2B%2B/%60_Either%60%20C%20compatibility/near/131176325" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Nicole Mazzuca <a href="https://zulip-archive.rust-lang.org/stream/136281-t-lang/wg-unsafe-code-guidelines/topic/.60throws.60.20C.2B.2B.2F.60_Either.60.20C.20compatibility.html#131176325">(Aug 09 2018 at 14:39)</a>:</h4>
<p>I think they mostly took it from Haskell?</p>



<a name="131176331"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/136281-t-lang/wg-unsafe-code-guidelines/topic/%60throws%60%20C%2B%2B/%60_Either%60%20C%20compatibility/near/131176331" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Nicole Mazzuca <a href="https://zulip-archive.rust-lang.org/stream/136281-t-lang/wg-unsafe-code-guidelines/topic/.60throws.60.20C.2B.2B.2F.60_Either.60.20C.20compatibility.html#131176331">(Aug 09 2018 at 14:39)</a>:</h4>
<p>but I imagine that Rust was also a major inspiration</p>



<a name="131176337"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/136281-t-lang/wg-unsafe-code-guidelines/topic/%60throws%60%20C%2B%2B/%60_Either%60%20C%20compatibility/near/131176337" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> RalfJ <a href="https://zulip-archive.rust-lang.org/stream/136281-t-lang/wg-unsafe-code-guidelines/topic/.60throws.60.20C.2B.2B.2F.60_Either.60.20C.20compatibility.html#131176337">(Aug 09 2018 at 14:39)</a>:</h4>
<p>so Haskell has sth. like <code>try!</code>?</p>



<a name="131176347"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/136281-t-lang/wg-unsafe-code-guidelines/topic/%60throws%60%20C%2B%2B/%60_Either%60%20C%20compatibility/near/131176347" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Nicole Mazzuca <a href="https://zulip-archive.rust-lang.org/stream/136281-t-lang/wg-unsafe-code-guidelines/topic/.60throws.60.20C.2B.2B.2F.60_Either.60.20C.20compatibility.html#131176347">(Aug 09 2018 at 14:39)</a>:</h4>
<p>but the older papers included a "what this might look like in Rust"</p>



<a name="131176358"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/136281-t-lang/wg-unsafe-code-guidelines/topic/%60throws%60%20C%2B%2B/%60_Either%60%20C%20compatibility/near/131176358" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Nicole Mazzuca <a href="https://zulip-archive.rust-lang.org/stream/136281-t-lang/wg-unsafe-code-guidelines/topic/.60throws.60.20C.2B.2B.2F.60_Either.60.20C.20compatibility.html#131176358">(Aug 09 2018 at 14:40)</a>:</h4>
<p>because they really want ABI-compat for this between the three languages</p>



<a name="131176406"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/136281-t-lang/wg-unsafe-code-guidelines/topic/%60throws%60%20C%2B%2B/%60_Either%60%20C%20compatibility/near/131176406" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Nicole Mazzuca <a href="https://zulip-archive.rust-lang.org/stream/136281-t-lang/wg-unsafe-code-guidelines/topic/.60throws.60.20C.2B.2B.2F.60_Either.60.20C.20compatibility.html#131176406">(Aug 09 2018 at 14:40)</a>:</h4>
<p>Haskell has monads, so it doesn't need <code>try</code></p>



<a name="131176408"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/136281-t-lang/wg-unsafe-code-guidelines/topic/%60throws%60%20C%2B%2B/%60_Either%60%20C%20compatibility/near/131176408" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> RalfJ <a href="https://zulip-archive.rust-lang.org/stream/136281-t-lang/wg-unsafe-code-guidelines/topic/.60throws.60.20C.2B.2B.2F.60_Either.60.20C.20compatibility.html#131176408">(Aug 09 2018 at 14:40)</a>:</h4>
<p>well for us it would be a special ABI, I guess, for functions returning <code>Result</code>.</p>



<a name="131176417"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/136281-t-lang/wg-unsafe-code-guidelines/topic/%60throws%60%20C%2B%2B/%60_Either%60%20C%20compatibility/near/131176417" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> RalfJ <a href="https://zulip-archive.rust-lang.org/stream/136281-t-lang/wg-unsafe-code-guidelines/topic/.60throws.60.20C.2B.2B.2F.60_Either.60.20C.20compatibility.html#131176417">(Aug 09 2018 at 14:40)</a>:</h4>
<p>but everything else would just work</p>



<a name="131176435"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/136281-t-lang/wg-unsafe-code-guidelines/topic/%60throws%60%20C%2B%2B/%60_Either%60%20C%20compatibility/near/131176435" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Nicole Mazzuca <a href="https://zulip-archive.rust-lang.org/stream/136281-t-lang/wg-unsafe-code-guidelines/topic/.60throws.60.20C.2B.2B.2F.60_Either.60.20C.20compatibility.html#131176435">(Aug 09 2018 at 14:40)</a>:</h4>
<p>yeah, that was their plan</p>



<a name="131176467"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/136281-t-lang/wg-unsafe-code-guidelines/topic/%60throws%60%20C%2B%2B/%60_Either%60%20C%20compatibility/near/131176467" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Nicole Mazzuca <a href="https://zulip-archive.rust-lang.org/stream/136281-t-lang/wg-unsafe-code-guidelines/topic/.60throws.60.20C.2B.2B.2F.60_Either.60.20C.20compatibility.html#131176467">(Aug 09 2018 at 14:41)</a>:</h4>
<p>what ever happened with <code>throws</code> functions?</p>



<a name="131176491"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/136281-t-lang/wg-unsafe-code-guidelines/topic/%60throws%60%20C%2B%2B/%60_Either%60%20C%20compatibility/near/131176491" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Nicole Mazzuca <a href="https://zulip-archive.rust-lang.org/stream/136281-t-lang/wg-unsafe-code-guidelines/topic/.60throws.60.20C.2B.2B.2F.60_Either.60.20C.20compatibility.html#131176491">(Aug 09 2018 at 14:41)</a>:</h4>
<p><code>fn blah() -&gt; T throws U</code></p>



<a name="131178032"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/136281-t-lang/wg-unsafe-code-guidelines/topic/%60throws%60%20C%2B%2B/%60_Either%60%20C%20compatibility/near/131178032" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/136281-t-lang/wg-unsafe-code-guidelines/topic/.60throws.60.20C.2B.2B.2F.60_Either.60.20C.20compatibility.html#131178032">(Aug 09 2018 at 15:05)</a>:</h4>
<p>we've talked about enhancing the Rust ABI to treat <code>Result</code> specially</p>



<a name="131178039"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/136281-t-lang/wg-unsafe-code-guidelines/topic/%60throws%60%20C%2B%2B/%60_Either%60%20C%20compatibility/near/131178039" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/136281-t-lang/wg-unsafe-code-guidelines/topic/.60throws.60.20C.2B.2B.2F.60_Either.60.20C.20compatibility.html#131178039">(Aug 09 2018 at 15:05)</a>:</h4>
<p>seems like it would be good to be compatible, in that case</p>



<a name="132008523"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/136281-t-lang/wg-unsafe-code-guidelines/topic/%60throws%60%20C%2B%2B/%60_Either%60%20C%20compatibility/near/132008523" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> alercah <a href="https://zulip-archive.rust-lang.org/stream/136281-t-lang/wg-unsafe-code-guidelines/topic/.60throws.60.20C.2B.2B.2F.60_Either.60.20C.20compatibility.html#132008523">(Aug 12 2018 at 19:33)</a>:</h4>
<p>I think <span class="user-mention" data-user-id="120791">@RalfJ</span> meant SEH for Windows?</p>
<p>Is there a specific reason that unwinding isn't cross-language compatible? The Itanium ABI, at least, is specifically designed to allow interplay between unwinding mechanisms in a safe way.</p>



<a name="132008529"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/136281-t-lang/wg-unsafe-code-guidelines/topic/%60throws%60%20C%2B%2B/%60_Either%60%20C%20compatibility/near/132008529" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> alercah <a href="https://zulip-archive.rust-lang.org/stream/136281-t-lang/wg-unsafe-code-guidelines/topic/.60throws.60.20C.2B.2B.2F.60_Either.60.20C.20compatibility.html#132008529">(Aug 12 2018 at 19:33)</a>:</h4>
<p>(I need to read the paper still)</p>



<a name="132008530"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/136281-t-lang/wg-unsafe-code-guidelines/topic/%60throws%60%20C%2B%2B/%60_Either%60%20C%20compatibility/near/132008530" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> alercah <a href="https://zulip-archive.rust-lang.org/stream/136281-t-lang/wg-unsafe-code-guidelines/topic/.60throws.60.20C.2B.2B.2F.60_Either.60.20C.20compatibility.html#132008530">(Aug 12 2018 at 19:33)</a>:</h4>
<p>FWIW if this ends up with anyone going to a C++ committee meeting, I'd be happy to have an excuse as I would love to meet up with a number of friends. ;)</p>



<a name="132010221"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/136281-t-lang/wg-unsafe-code-guidelines/topic/%60throws%60%20C%2B%2B/%60_Either%60%20C%20compatibility/near/132010221" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> alercah <a href="https://zulip-archive.rust-lang.org/stream/136281-t-lang/wg-unsafe-code-guidelines/topic/.60throws.60.20C.2B.2B.2F.60_Either.60.20C.20compatibility.html#132010221">(Aug 12 2018 at 20:35)</a>:</h4>
<p>(Ah, I see that unwinding isn't directly related to this proposal because it mostly intends to avoid it, but it is necessary for <code>setjmp</code> and SEH as well as existing C++ exceptions)</p>



<a name="132012078"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/136281-t-lang/wg-unsafe-code-guidelines/topic/%60throws%60%20C%2B%2B/%60_Either%60%20C%20compatibility/near/132012078" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> alercah <a href="https://zulip-archive.rust-lang.org/stream/136281-t-lang/wg-unsafe-code-guidelines/topic/.60throws.60.20C.2B.2B.2F.60_Either.60.20C.20compatibility.html#132012078">(Aug 12 2018 at 21:39)</a>:</h4>
<p>Wow, I dislike the proposed C++ type using <code>void*</code> and suggesting putting a pointer to a dynamic allocation into a <code>intptr_t</code>. I agree that we could do it with special ABI, but we'd have to be careful whether that imposes a performance hit because of having to translate between the memory and calling-convention representations.</p>



<a name="132012142"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/136281-t-lang/wg-unsafe-code-guidelines/topic/%60throws%60%20C%2B%2B/%60_Either%60%20C%20compatibility/near/132012142" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> alercah <a href="https://zulip-archive.rust-lang.org/stream/136281-t-lang/wg-unsafe-code-guidelines/topic/.60throws.60.20C.2B.2B.2F.60_Either.60.20C.20compatibility.html#132012142">(Aug 12 2018 at 21:41)</a>:</h4>
<p>Possibly it would make sense to have an <code>extern "throws"</code> ABI as an interim measure?</p>



<a name="136025021"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/136281-t-lang/wg-unsafe-code-guidelines/topic/%60throws%60%20C%2B%2B/%60_Either%60%20C%20compatibility/near/136025021" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Darsstar <a href="https://zulip-archive.rust-lang.org/stream/136281-t-lang/wg-unsafe-code-guidelines/topic/.60throws.60.20C.2B.2B.2F.60_Either.60.20C.20compatibility.html#136025021">(Oct 18 2018 at 07:18)</a>:</h4>
<p>The author of the paper had some <a href="https://www.reddit.com/r/cpp/comments/9owiju/exceptions_may_finally_get_fixed/e7xygud/" target="_blank" title="https://www.reddit.com/r/cpp/comments/9owiju/exceptions_may_finally_get_fixed/e7xygud/">progress to report</a> yesterday:</p>
<blockquote>
<p>The WG14 discussion on this just closed. I won't repeat my notes here as it is bad form to do so (official minutes only!), but I think I am allowed to say that the vote went as follows:</p>
<p>Does WG14 like the general direction of N2289?</p>
<p>Favour: 15 Opposed: 2 Abstentions: 2</p>
</blockquote>



<a name="136058122"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/136281-t-lang/wg-unsafe-code-guidelines/topic/%60throws%60%20C%2B%2B/%60_Either%60%20C%20compatibility/near/136058122" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Nicole Mazzuca <a href="https://zulip-archive.rust-lang.org/stream/136281-t-lang/wg-unsafe-code-guidelines/topic/.60throws.60.20C.2B.2B.2F.60_Either.60.20C.20compatibility.html#136058122">(Oct 18 2018 at 17:23)</a>:</h4>
<p>woot! :D</p>



<hr><p>Last updated: Apr 12 2022 at 20:01 UTC</p>
</html>