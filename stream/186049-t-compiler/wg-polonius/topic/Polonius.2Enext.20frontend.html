<html>
<head><meta charset="utf-8"><title>Polonius.next frontend · t-compiler/wg-polonius · Zulip Chat Archive</title></head>
<h2>Stream: <a href="https://zulip-archive.rust-lang.org/stream/186049-t-compiler/wg-polonius/index.html">t-compiler/wg-polonius</a></h2>
<h3>Topic: <a href="https://zulip-archive.rust-lang.org/stream/186049-t-compiler/wg-polonius/topic/Polonius.2Enext.20frontend.html">Polonius.next frontend</a></h3>

<hr>

<base href="https://rust-lang.zulipchat.com">

<head><link href="https://zulip-archive.rust-lang.org/style.css" rel="stylesheet"></head>

<a name="254720397"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/186049-t-compiler/wg-polonius/topic/Polonius.next%20frontend/near/254720397" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Dylan MacKenzie (ecstatic-morse) <a href="https://zulip-archive.rust-lang.org/stream/186049-t-compiler/wg-polonius/topic/Polonius.2Enext.20frontend.html#254720397">(Sep 24 2021 at 15:14)</a>:</h4>
<p>Should I stop working on Souffle integration in <code>rustc</code> current? It's basically done btw, just needs some cleanup. The main motivation was prototyping, but it seems like Niko's frontend is another way of solving that problem.</p>



<a name="254720559"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/186049-t-compiler/wg-polonius/topic/Polonius.next%20frontend/near/254720559" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> lqd <a href="https://zulip-archive.rust-lang.org/stream/186049-t-compiler/wg-polonius/topic/Polonius.2Enext.20frontend.html#254720559">(Sep 24 2021 at 15:15)</a>:</h4>
<p>I would think that this would still be worthwhile</p>



<a name="254720652"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/186049-t-compiler/wg-polonius/topic/Polonius.next%20frontend/near/254720652" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> lqd <a href="https://zulip-archive.rust-lang.org/stream/186049-t-compiler/wg-polonius/topic/Polonius.2Enext.20frontend.html#254720652">(Sep 24 2021 at 15:16)</a>:</h4>
<p>esp since you've already done a bunch of work on it and it seems close to being ready</p>



<a name="254720936"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/186049-t-compiler/wg-polonius/topic/Polonius.next%20frontend/near/254720936" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> lqd <a href="https://zulip-archive.rust-lang.org/stream/186049-t-compiler/wg-polonius/topic/Polonius.2Enext.20frontend.html#254720936">(Sep 24 2021 at 15:18)</a>:</h4>
<p>like: there still be can be some prototyping left to do, when this encounters the real MIR (and we've done the new fact generation)</p>



<a name="254720942"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/186049-t-compiler/wg-polonius/topic/Polonius.next%20frontend/near/254720942" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Dylan MacKenzie (ecstatic-morse) <a href="https://zulip-archive.rust-lang.org/stream/186049-t-compiler/wg-polonius/topic/Polonius.2Enext.20frontend.html#254720942">(Sep 24 2021 at 15:18)</a>:</h4>
<p>I do want to know what <span class="user-mention" data-user-id="116009">@nikomatsakis</span> thinks, but I'll try to get it in a reviewable state over the weekend.</p>



<a name="254720998"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/186049-t-compiler/wg-polonius/topic/Polonius.next%20frontend/near/254720998" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> lqd <a href="https://zulip-archive.rust-lang.org/stream/186049-t-compiler/wg-polonius/topic/Polonius.2Enext.20frontend.html#254720998">(Sep 24 2021 at 15:18)</a>:</h4>
<p>sure, me too, that was just my personal opinion</p>



<a name="254730376"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/186049-t-compiler/wg-polonius/topic/Polonius.next%20frontend/near/254730376" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/186049-t-compiler/wg-polonius/topic/Polonius.2Enext.20frontend.html#254730376">(Sep 24 2021 at 16:16)</a>:</h4>
<p>it seems orthogonal enough I guess</p>



<a name="254730404"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/186049-t-compiler/wg-polonius/topic/Polonius.next%20frontend/near/254730404" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/186049-t-compiler/wg-polonius/topic/Polonius.2Enext.20frontend.html#254730404">(Sep 24 2021 at 16:17)</a>:</h4>
<p>I envision a <a href="http://polonius.next">polonius.next</a> front-end as being a way to capture isolate regression tests and things</p>



<a name="254731037"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/186049-t-compiler/wg-polonius/topic/Polonius.next%20frontend/near/254731037" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> lqd <a href="https://zulip-archive.rust-lang.org/stream/186049-t-compiler/wg-polonius/topic/Polonius.2Enext.20frontend.html#254731037">(Sep 24 2021 at 16:21)</a>:</h4>
<p>like the old NLL-prototype tests, the ones we currently have in the polonius repo (but richer, like we discussed a few times before IIRC), and the chalk self-contained tests (which I believe can be extracted from rust-analyzer or something)</p>



<a name="254731229"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/186049-t-compiler/wg-polonius/topic/Polonius.next%20frontend/near/254731229" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Dylan MacKenzie (ecstatic-morse) <a href="https://zulip-archive.rust-lang.org/stream/186049-t-compiler/wg-polonius/topic/Polonius.2Enext.20frontend.html#254731229">(Sep 24 2021 at 16:22)</a>:</h4>
<p>Okay, just let me know what's most beneficial in the near-term and I'll try to work with that. I don't want to be off doing my own thing if others are blocked on the lack of a prototyping system.</p>



<a name="254733236"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/186049-t-compiler/wg-polonius/topic/Polonius.next%20frontend/near/254733236" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/186049-t-compiler/wg-polonius/topic/Polonius.2Enext.20frontend.html#254733236">(Sep 24 2021 at 16:35)</a>:</h4>
<p>OK <span class="user-mention" data-user-id="116113">@lqd</span> moving to this topic</p>



<a name="254733307"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/186049-t-compiler/wg-polonius/topic/Polonius.next%20frontend/near/254733307" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/186049-t-compiler/wg-polonius/topic/Polonius.2Enext.20frontend.html#254733307">(Sep 24 2021 at 16:36)</a>:</h4>
<p>so I added this ast module you can see :)</p>



<a name="254733353"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/186049-t-compiler/wg-polonius/topic/Polonius.next%20frontend/near/254733353" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/186049-t-compiler/wg-polonius/topic/Polonius.2Enext.20frontend.html#254733353">(Sep 24 2021 at 16:36)</a>:</h4>
<p>it corresponds very closely to what you see in the hackmd</p>



<a name="254733395"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/186049-t-compiler/wg-polonius/topic/Polonius.next%20frontend/near/254733395" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/186049-t-compiler/wg-polonius/topic/Polonius.2Enext.20frontend.html#254733395">(Sep 24 2021 at 16:36)</a>:</h4>
<p>oh I guess I have to deal with recursive types, bah</p>



<a name="254733397"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/186049-t-compiler/wg-polonius/topic/Polonius.next%20frontend/near/254733397" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> lqd <a href="https://zulip-archive.rust-lang.org/stream/186049-t-compiler/wg-polonius/topic/Polonius.2Enext.20frontend.html#254733397">(Sep 24 2021 at 16:36)</a>:</h4>
<p>yup</p>



<a name="254733453"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/186049-t-compiler/wg-polonius/topic/Polonius.next%20frontend/near/254733453" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/186049-t-compiler/wg-polonius/topic/Polonius.2Enext.20frontend.html#254733453">(Sep 24 2021 at 16:37)</a>:</h4>
<p>now I was working on a PEG parser...</p>



<a name="254733537"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/186049-t-compiler/wg-polonius/topic/Polonius.next%20frontend/near/254733537" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/186049-t-compiler/wg-polonius/topic/Polonius.2Enext.20frontend.html#254733537">(Sep 24 2021 at 16:37)</a>:</h4>
<p>which is fairly simple</p>



<a name="254733625"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/186049-t-compiler/wg-polonius/topic/Polonius.next%20frontend/near/254733625" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> lqd <a href="https://zulip-archive.rust-lang.org/stream/186049-t-compiler/wg-polonius/topic/Polonius.2Enext.20frontend.html#254733625">(Sep 24 2021 at 16:38)</a>:</h4>
<p>I see</p>



<a name="254733641"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/186049-t-compiler/wg-polonius/topic/Polonius.next%20frontend/near/254733641" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/186049-t-compiler/wg-polonius/topic/Polonius.2Enext.20frontend.html#254733641">(Sep 24 2021 at 16:38)</a>:</h4>
<p>so I could commit this and you could try to finish that out, if you wanted :)</p>



<a name="254733651"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/186049-t-compiler/wg-polonius/topic/Polonius.next%20frontend/near/254733651" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/186049-t-compiler/wg-polonius/topic/Polonius.2Enext.20frontend.html#254733651">(Sep 24 2021 at 16:38)</a>:</h4>
<p>alternatively,</p>



<a name="254733652"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/186049-t-compiler/wg-polonius/topic/Polonius.next%20frontend/near/254733652" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/186049-t-compiler/wg-polonius/topic/Polonius.2Enext.20frontend.html#254733652">(Sep 24 2021 at 16:38)</a>:</h4>
<p>if you prefer,</p>



<a name="254733659"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/186049-t-compiler/wg-polonius/topic/Polonius.next%20frontend/near/254733659" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/186049-t-compiler/wg-polonius/topic/Polonius.2Enext.20frontend.html#254733659">(Sep 24 2021 at 16:38)</a>:</h4>
<p>you can work on fact generation</p>



<a name="254733667"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/186049-t-compiler/wg-polonius/topic/Polonius.next%20frontend/near/254733667" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> lqd <a href="https://zulip-archive.rust-lang.org/stream/186049-t-compiler/wg-polonius/topic/Polonius.2Enext.20frontend.html#254733667">(Sep 24 2021 at 16:38)</a>:</h4>
<p>ok that sounds good to me :)</p>



<a name="254733673"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/186049-t-compiler/wg-polonius/topic/Polonius.next%20frontend/near/254733673" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/186049-t-compiler/wg-polonius/topic/Polonius.2Enext.20frontend.html#254733673">(Sep 24 2021 at 16:38)</a>:</h4>
<p>I was going to write some function from <code>&amp;Ast -&gt; Vec&lt;Facts&gt;</code></p>



<a name="254733686"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/186049-t-compiler/wg-polonius/topic/Polonius.next%20frontend/near/254733686" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> lqd <a href="https://zulip-archive.rust-lang.org/stream/186049-t-compiler/wg-polonius/topic/Polonius.2Enext.20frontend.html#254733686">(Sep 24 2021 at 16:38)</a>:</h4>
<p>either work for me tbh</p>



<a name="254733709"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/186049-t-compiler/wg-polonius/topic/Polonius.next%20frontend/near/254733709" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/186049-t-compiler/wg-polonius/topic/Polonius.2Enext.20frontend.html#254733709">(Sep 24 2021 at 16:38)</a>:</h4>
<p>I have no idea how hard that will be</p>



<a name="254733764"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/186049-t-compiler/wg-polonius/topic/Polonius.next%20frontend/near/254733764" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/186049-t-compiler/wg-polonius/topic/Polonius.2Enext.20frontend.html#254733764">(Sep 24 2021 at 16:39)</a>:</h4>
<p>I'm fine with either one, the fact generation is a bit more exploratory :P but it might be a good way to ensure we agree on the rules</p>



<a name="254733797"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/186049-t-compiler/wg-polonius/topic/Polonius.next%20frontend/near/254733797" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/186049-t-compiler/wg-polonius/topic/Polonius.2Enext.20frontend.html#254733797">(Sep 24 2021 at 16:39)</a>:</h4>
<p>(i.e., if you take first stab at it, then I review)</p>



<a name="254733852"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/186049-t-compiler/wg-polonius/topic/Polonius.next%20frontend/near/254733852" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/186049-t-compiler/wg-polonius/topic/Polonius.2Enext.20frontend.html#254733852">(Sep 24 2021 at 16:39)</a>:</h4>
<p>let's do that-- you try the fact generation to start :)</p>



<a name="254733872"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/186049-t-compiler/wg-polonius/topic/Polonius.next%20frontend/near/254733872" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> lqd <a href="https://zulip-archive.rust-lang.org/stream/186049-t-compiler/wg-polonius/topic/Polonius.2Enext.20frontend.html#254733872">(Sep 24 2021 at 16:39)</a>:</h4>
<p>alright that sounds good, I'll try to start with fact gen</p>



<a name="254733923"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/186049-t-compiler/wg-polonius/topic/Polonius.next%20frontend/near/254733923" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/186049-t-compiler/wg-polonius/topic/Polonius.2Enext.20frontend.html#254733923">(Sep 24 2021 at 16:40)</a>:</h4>
<p>let me push the ast code</p>



<a name="254733935"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/186049-t-compiler/wg-polonius/topic/Polonius.next%20frontend/near/254733935" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/186049-t-compiler/wg-polonius/topic/Polonius.2Enext.20frontend.html#254733935">(Sep 24 2021 at 16:40)</a>:</h4>
<p>and I'll comment out the parser for now</p>



<a name="254734094"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/186049-t-compiler/wg-polonius/topic/Polonius.next%20frontend/near/254734094" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/186049-t-compiler/wg-polonius/topic/Polonius.2Enext.20frontend.html#254734094">(Sep 24 2021 at 16:41)</a>:</h4>
<p>done</p>



<a name="254734120"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/186049-t-compiler/wg-polonius/topic/Polonius.next%20frontend/near/254734120" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> lqd <a href="https://zulip-archive.rust-lang.org/stream/186049-t-compiler/wg-polonius/topic/Polonius.2Enext.20frontend.html#254734120">(Sep 24 2021 at 16:41)</a>:</h4>
<p>thanks :)</p>



<a name="254734500"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/186049-t-compiler/wg-polonius/topic/Polonius.next%20frontend/near/254734500" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> lqd <a href="https://zulip-archive.rust-lang.org/stream/186049-t-compiler/wg-polonius/topic/Polonius.2Enext.20frontend.html#254734500">(Sep 24 2021 at 16:43)</a>:</h4>
<p><span class="user-mention" data-user-id="116009">@nikomatsakis</span> the <code>ast.rs</code> file seems missing ^^</p>



<a name="254734513"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/186049-t-compiler/wg-polonius/topic/Polonius.next%20frontend/near/254734513" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/186049-t-compiler/wg-polonius/topic/Polonius.2Enext.20frontend.html#254734513">(Sep 24 2021 at 16:43)</a>:</h4>
<p>oh ..?</p>



<a name="254734520"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/186049-t-compiler/wg-polonius/topic/Polonius.next%20frontend/near/254734520" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/186049-t-compiler/wg-polonius/topic/Polonius.2Enext.20frontend.html#254734520">(Sep 24 2021 at 16:43)</a>:</h4>
<p>doh :)</p>



<a name="254734638"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/186049-t-compiler/wg-polonius/topic/Polonius.next%20frontend/near/254734638" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/186049-t-compiler/wg-polonius/topic/Polonius.2Enext.20frontend.html#254734638">(Sep 24 2021 at 16:44)</a>:</h4>
<p>pushed</p>



<a name="254734715"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/186049-t-compiler/wg-polonius/topic/Polonius.next%20frontend/near/254734715" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> lqd <a href="https://zulip-archive.rust-lang.org/stream/186049-t-compiler/wg-polonius/topic/Polonius.2Enext.20frontend.html#254734715">(Sep 24 2021 at 16:45)</a>:</h4>
<p>thanks <span aria-label="pray" class="emoji emoji-1f64f" role="img" title="pray">:pray:</span></p>



<a name="254738463"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/186049-t-compiler/wg-polonius/topic/Polonius.next%20frontend/near/254738463" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/186049-t-compiler/wg-polonius/topic/Polonius.2Enext.20frontend.html#254738463">(Sep 24 2021 at 17:08)</a>:</h4>
<p><span class="user-mention" data-user-id="116113">@lqd</span> pushing some code, incomplete parser</p>



<a name="254738691"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/186049-t-compiler/wg-polonius/topic/Polonius.next%20frontend/near/254738691" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> lqd <a href="https://zulip-archive.rust-lang.org/stream/186049-t-compiler/wg-polonius/topic/Polonius.2Enext.20frontend.html#254738691">(Sep 24 2021 at 17:10)</a>:</h4>
<p>timely, I was creating up a dummy ast to start emitting some facts ...</p>



<a name="254738864"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/186049-t-compiler/wg-polonius/topic/Polonius.next%20frontend/near/254738864" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/186049-t-compiler/wg-polonius/topic/Polonius.2Enext.20frontend.html#254738864">(Sep 24 2021 at 17:11)</a>:</h4>
<p>I'll try to have statements up soon</p>



<a name="254739219"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/186049-t-compiler/wg-polonius/topic/Polonius.next%20frontend/near/254739219" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> lqd <a href="https://zulip-archive.rust-lang.org/stream/186049-t-compiler/wg-polonius/topic/Polonius.2Enext.20frontend.html#254739219">(Sep 24 2021 at 17:13)</a>:</h4>
<p>don't rush on my behalf, I'm so slow :/</p>



<a name="254739472"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/186049-t-compiler/wg-polonius/topic/Polonius.next%20frontend/near/254739472" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> lqd <a href="https://zulip-archive.rust-lang.org/stream/186049-t-compiler/wg-polonius/topic/Polonius.2Enext.20frontend.html#254739472">(Sep 24 2021 at 17:14)</a>:</h4>
<p>(I'm unlikely to have something interesting to show before the member constraints call but will continue over the weekend)</p>



<a name="254739541"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/186049-t-compiler/wg-polonius/topic/Polonius.next%20frontend/near/254739541" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/186049-t-compiler/wg-polonius/topic/Polonius.2Enext.20frontend.html#254739541">(Sep 24 2021 at 17:14)</a>:</h4>
<p>no worries</p>



<a name="254739561"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/186049-t-compiler/wg-polonius/topic/Polonius.next%20frontend/near/254739561" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/186049-t-compiler/wg-polonius/topic/Polonius.2Enext.20frontend.html#254739561">(Sep 24 2021 at 17:14)</a>:</h4>
<p>I'm hoping to have the parser by then</p>



<a name="254739569"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/186049-t-compiler/wg-polonius/topic/Polonius.next%20frontend/near/254739569" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/186049-t-compiler/wg-polonius/topic/Polonius.2Enext.20frontend.html#254739569">(Sep 24 2021 at 17:14)</a>:</h4>
<p>it's close</p>



<a name="254739759"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/186049-t-compiler/wg-polonius/topic/Polonius.next%20frontend/near/254739759" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> lqd <a href="https://zulip-archive.rust-lang.org/stream/186049-t-compiler/wg-polonius/topic/Polonius.2Enext.20frontend.html#254739759">(Sep 24 2021 at 17:15)</a>:</h4>
<p>awesome</p>



<a name="254741287"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/186049-t-compiler/wg-polonius/topic/Polonius.next%20frontend/near/254741287" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/186049-t-compiler/wg-polonius/topic/Polonius.2Enext.20frontend.html#254741287">(Sep 24 2021 at 17:26)</a>:</h4>
<p><span class="user-mention" data-user-id="116113">@lqd</span> pushed some more stuff, can now parse basic blocks, statements</p>



<a name="254741365"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/186049-t-compiler/wg-polonius/topic/Polonius.next%20frontend/near/254741365" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> lqd <a href="https://zulip-archive.rust-lang.org/stream/186049-t-compiler/wg-polonius/topic/Polonius.2Enext.20frontend.html#254741365">(Sep 24 2021 at 17:27)</a>:</h4>
<p>thanks a bunch :)</p>



<a name="254741523"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/186049-t-compiler/wg-polonius/topic/Polonius.next%20frontend/near/254741523" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/186049-t-compiler/wg-polonius/topic/Polonius.2Enext.20frontend.html#254741523">(Sep 24 2021 at 17:28)</a>:</h4>
<p>oh, I forget semicolons</p>



<a name="254741528"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/186049-t-compiler/wg-polonius/topic/Polonius.next%20frontend/near/254741528" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/186049-t-compiler/wg-polonius/topic/Polonius.2Enext.20frontend.html#254741528">(Sep 24 2021 at 17:28)</a>:</h4>
<p>I should add those</p>



<a name="254743563"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/186049-t-compiler/wg-polonius/topic/Polonius.next%20frontend/near/254743563" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/186049-t-compiler/wg-polonius/topic/Polonius.2Enext.20frontend.html#254743563">(Sep 24 2021 at 17:41)</a>:</h4>
<p>pushed struct declarations</p>



<a name="254745966"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/186049-t-compiler/wg-polonius/topic/Polonius.next%20frontend/near/254745966" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/186049-t-compiler/wg-polonius/topic/Polonius.2Enext.20frontend.html#254745966">(Sep 24 2021 at 17:58)</a>:</h4>
<p>ok, pushed fn prototypes</p>



<a name="254745986"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/186049-t-compiler/wg-polonius/topic/Polonius.next%20frontend/near/254745986" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/186049-t-compiler/wg-polonius/topic/Polonius.2Enext.20frontend.html#254745986">(Sep 24 2021 at 17:58)</a>:</h4>
<p>so parser is "code complete"</p>



<a name="254746089"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/186049-t-compiler/wg-polonius/topic/Polonius.next%20frontend/near/254746089" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> lqd <a href="https://zulip-archive.rust-lang.org/stream/186049-t-compiler/wg-polonius/topic/Polonius.2Enext.20frontend.html#254746089">(Sep 24 2021 at 17:59)</a>:</h4>
<p>incredible, right on time as you predicted :)</p>



<a name="254746329"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/186049-t-compiler/wg-polonius/topic/Polonius.next%20frontend/near/254746329" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/186049-t-compiler/wg-polonius/topic/Polonius.2Enext.20frontend.html#254746329">(Sep 24 2021 at 18:00)</a>:</h4>
<p>heh, yes</p>



<a name="255778575"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/186049-t-compiler/wg-polonius/topic/Polonius.next%20frontend/near/255778575" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/186049-t-compiler/wg-polonius/topic/Polonius.2Enext.20frontend.html#255778575">(Oct 01 2021 at 17:21)</a>:</h4>
<p>just curious, <span class="user-mention" data-user-id="116113">@lqd</span>, if you ever had any time to poke on this :) no worries if not!</p>



<a name="255778592"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/186049-t-compiler/wg-polonius/topic/Polonius.next%20frontend/near/255778592" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/186049-t-compiler/wg-polonius/topic/Polonius.2Enext.20frontend.html#255778592">(Oct 01 2021 at 17:21)</a>:</h4>
<p>we should schedule the next hackathon</p>



<a name="255778618"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/186049-t-compiler/wg-polonius/topic/Polonius.next%20frontend/near/255778618" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> lqd <a href="https://zulip-archive.rust-lang.org/stream/186049-t-compiler/wg-polonius/topic/Polonius.2Enext.20frontend.html#255778618">(Oct 01 2021 at 17:21)</a>:</h4>
<p>I'm poking as we speak</p>



<a name="257732880"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/186049-t-compiler/wg-polonius/topic/Polonius.next%20frontend/near/257732880" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Dylan MacKenzie (ecstatic-morse) <a href="https://zulip-archive.rust-lang.org/stream/186049-t-compiler/wg-polonius/topic/Polonius.2Enext.20frontend.html#257732880">(Oct 15 2021 at 17:15)</a>:</h4>
<p><span class="user-mention" data-user-id="116113">@lqd</span> Looking through the PR now. We want to handle <code>drop(place)</code> like <code>let place_ref = &amp;mut place; Drop::drop(place_ref);</code> (treat it like a mutable borrow). This isn't implemented currently right?</p>



<a name="257732979"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/186049-t-compiler/wg-polonius/topic/Polonius.next%20frontend/near/257732979" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> lqd <a href="https://zulip-archive.rust-lang.org/stream/186049-t-compiler/wg-polonius/topic/Polonius.2Enext.20frontend.html#257732979">(Oct 15 2021 at 17:16)</a>:</h4>
<p>right, it is not yet</p>



<a name="257733033"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/186049-t-compiler/wg-polonius/topic/Polonius.next%20frontend/near/257733033" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> lqd <a href="https://zulip-archive.rust-lang.org/stream/186049-t-compiler/wg-polonius/topic/Polonius.2Enext.20frontend.html#257733033">(Oct 15 2021 at 17:16)</a>:</h4>
<p>there are some semantics I'm unsure of in the current AST</p>



<a name="257733109"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/186049-t-compiler/wg-polonius/topic/Polonius.next%20frontend/near/257733109" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Dylan MacKenzie (ecstatic-morse) <a href="https://zulip-archive.rust-lang.org/stream/186049-t-compiler/wg-polonius/topic/Polonius.2Enext.20frontend.html#257733109">(Oct 15 2021 at 17:17)</a>:</h4>
<p>Okay. I could work on that, or something else. Whatever you like.</p>



<a name="257733215"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/186049-t-compiler/wg-polonius/topic/Polonius.next%20frontend/near/257733215" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> lqd <a href="https://zulip-archive.rust-lang.org/stream/186049-t-compiler/wg-polonius/topic/Polonius.2Enext.20frontend.html#257733215">(Oct 15 2021 at 17:18)</a>:</h4>
<p>some expressions are parsed as drop, and I'm unsure whether that's on purpose and real drops or just a catch all, etc</p>



<a name="257733261"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/186049-t-compiler/wg-polonius/topic/Polonius.next%20frontend/near/257733261" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> lqd <a href="https://zulip-archive.rust-lang.org/stream/186049-t-compiler/wg-polonius/topic/Polonius.2Enext.20frontend.html#257733261">(Oct 15 2021 at 17:18)</a>:</h4>
<p>for sure, I myself wanted to push a bit more on emitting subset facts</p>



<a name="257733268"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/186049-t-compiler/wg-polonius/topic/Polonius.next%20frontend/near/257733268" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Dylan MacKenzie (ecstatic-morse) <a href="https://zulip-archive.rust-lang.org/stream/186049-t-compiler/wg-polonius/topic/Polonius.2Enext.20frontend.html#257733268">(Oct 15 2021 at 17:18)</a>:</h4>
<p>Lemme have a look</p>



<a name="257733313"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/186049-t-compiler/wg-polonius/topic/Polonius.next%20frontend/near/257733313" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> lqd <a href="https://zulip-archive.rust-lang.org/stream/186049-t-compiler/wg-polonius/topic/Polonius.2Enext.20frontend.html#257733313">(Oct 15 2021 at 17:19)</a>:</h4>
<p>did anything jump at you being egregiously wrong ?</p>



<a name="257733383"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/186049-t-compiler/wg-polonius/topic/Polonius.next%20frontend/near/257733383" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Dylan MacKenzie (ecstatic-morse) <a href="https://zulip-archive.rust-lang.org/stream/186049-t-compiler/wg-polonius/topic/Polonius.2Enext.20frontend.html#257733383">(Oct 15 2021 at 17:19)</a>:</h4>
<p>Not yet. Is there some place I should look at first?</p>



<a name="257733547"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/186049-t-compiler/wg-polonius/topic/Polonius.next%20frontend/near/257733547" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> lqd <a href="https://zulip-archive.rust-lang.org/stream/186049-t-compiler/wg-polonius/topic/Polonius.2Enext.20frontend.html#257733547">(Oct 15 2021 at 17:20)</a>:</h4>
<p>not anything specific</p>



<a name="257733557"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/186049-t-compiler/wg-polonius/topic/Polonius.next%20frontend/near/257733557" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Dylan MacKenzie (ecstatic-morse) <a href="https://zulip-archive.rust-lang.org/stream/186049-t-compiler/wg-polonius/topic/Polonius.2Enext.20frontend.html#257733557">(Oct 15 2021 at 17:20)</a>:</h4>
<p>Ah, so this is not the MIR's <code>Drop</code>. It's just anything that's not an assignment.</p>



<a name="257733608"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/186049-t-compiler/wg-polonius/topic/Polonius.next%20frontend/near/257733608" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> lqd <a href="https://zulip-archive.rust-lang.org/stream/186049-t-compiler/wg-polonius/topic/Polonius.2Enext.20frontend.html#257733608">(Oct 15 2021 at 17:21)</a>:</h4>
<p>it looked like it</p>



<a name="257733644"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/186049-t-compiler/wg-polonius/topic/Polonius.next%20frontend/near/257733644" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> lqd <a href="https://zulip-archive.rust-lang.org/stream/186049-t-compiler/wg-polonius/topic/Polonius.2Enext.20frontend.html#257733644">(Oct 15 2021 at 17:21)</a>:</h4>
<p>but maybe it's supposed to be later, I wasn't sure</p>



<a name="257733656"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/186049-t-compiler/wg-polonius/topic/Polonius.next%20frontend/near/257733656" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> lqd <a href="https://zulip-archive.rust-lang.org/stream/186049-t-compiler/wg-polonius/topic/Polonius.2Enext.20frontend.html#257733656">(Oct 15 2021 at 17:21)</a>:</h4>
<p>I think I added a todo about this</p>



<a name="257733774"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/186049-t-compiler/wg-polonius/topic/Polonius.next%20frontend/near/257733774" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> lqd <a href="https://zulip-archive.rust-lang.org/stream/186049-t-compiler/wg-polonius/topic/Polonius.2Enext.20frontend.html#257733774">(Oct 15 2021 at 17:22)</a>:</h4>
<p>there are other workarounds I had to use here and there to get function calls to parse, adding move/copy etc for the arguments</p>



<a name="257733934"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/186049-t-compiler/wg-polonius/topic/Polonius.next%20frontend/near/257733934" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Dylan MacKenzie (ecstatic-morse) <a href="https://zulip-archive.rust-lang.org/stream/186049-t-compiler/wg-polonius/topic/Polonius.2Enext.20frontend.html#257733934">(Oct 15 2021 at 17:23)</a>:</h4>
<p>I don't think so. I assume we'd write out the function call manually. The name just confused me, so we can remove that one TODO.</p>



<a name="257733960"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/186049-t-compiler/wg-polonius/topic/Polonius.next%20frontend/near/257733960" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> lqd <a href="https://zulip-archive.rust-lang.org/stream/186049-t-compiler/wg-polonius/topic/Polonius.2Enext.20frontend.html#257733960">(Oct 15 2021 at 17:23)</a>:</h4>
<p>sounds good</p>



<a name="257734100"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/186049-t-compiler/wg-polonius/topic/Polonius.next%20frontend/near/257734100" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Dylan MacKenzie (ecstatic-morse) <a href="https://zulip-archive.rust-lang.org/stream/186049-t-compiler/wg-polonius/topic/Polonius.2Enext.20frontend.html#257734100">(Oct 15 2021 at 17:24)</a>:</h4>
<p><span class="user-mention silent" data-user-id="116113">lqd</span> <a href="#narrow/stream/186049-t-compiler.2Fwg-polonius/topic/Polonius.2Enext.20frontend/near/257733774">said</a>:</p>
<blockquote>
<p>there are other workarounds I had to use here and there to get function calls to parse, adding move/copy etc for the arguments</p>
</blockquote>
<p>I'll poke around here.</p>



<a name="257734221"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/186049-t-compiler/wg-polonius/topic/Polonius.next%20frontend/near/257734221" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> lqd <a href="https://zulip-archive.rust-lang.org/stream/186049-t-compiler/wg-polonius/topic/Polonius.2Enext.20frontend.html#257734221">(Oct 15 2021 at 17:25)</a>:</h4>
<p>great, thank you</p>



<a name="257735059"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/186049-t-compiler/wg-polonius/topic/Polonius.next%20frontend/near/257735059" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> lqd <a href="https://zulip-archive.rust-lang.org/stream/186049-t-compiler/wg-polonius/topic/Polonius.2Enext.20frontend.html#257735059">(Oct 15 2021 at 17:30)</a>:</h4>
<p>re: your GH comment, good idea to rename the ast node from Drop to something else less confusing</p>



<a name="257735630"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/186049-t-compiler/wg-polonius/topic/Polonius.next%20frontend/near/257735630" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Dylan MacKenzie (ecstatic-morse) <a href="https://zulip-archive.rust-lang.org/stream/186049-t-compiler/wg-polonius/topic/Polonius.2Enext.20frontend.html#257735630">(Oct 15 2021 at 17:35)</a>:</h4>
<p>Do you know if we'll need bounds on lifetime parameters in function prototypes?</p>



<a name="257735680"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/186049-t-compiler/wg-polonius/topic/Polonius.next%20frontend/near/257735680" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Dylan MacKenzie (ecstatic-morse) <a href="https://zulip-archive.rust-lang.org/stream/186049-t-compiler/wg-polonius/topic/Polonius.2Enext.20frontend.html#257735680">(Oct 15 2021 at 17:35)</a>:</h4>
<p>I think so right?</p>



<a name="257735705"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/186049-t-compiler/wg-polonius/topic/Polonius.next%20frontend/near/257735705" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> lqd <a href="https://zulip-archive.rust-lang.org/stream/186049-t-compiler/wg-polonius/topic/Polonius.2Enext.20frontend.html#257735705">(Oct 15 2021 at 17:35)</a>:</h4>
<p>I was expecting so yeah</p>



<a name="257735880"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/186049-t-compiler/wg-polonius/topic/Polonius.next%20frontend/near/257735880" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Dylan MacKenzie (ecstatic-morse) <a href="https://zulip-archive.rust-lang.org/stream/186049-t-compiler/wg-polonius/topic/Polonius.2Enext.20frontend.html#257735880">(Oct 15 2021 at 17:36)</a>:</h4>
<p>Okay. I could do that (which would avoid merge conflicts). Unless there's something else on the critical path.</p>



<a name="257736185"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/186049-t-compiler/wg-polonius/topic/Polonius.next%20frontend/near/257736185" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> lqd <a href="https://zulip-archive.rust-lang.org/stream/186049-t-compiler/wg-polonius/topic/Polonius.2Enext.20frontend.html#257736185">(Oct 15 2021 at 17:38)</a>:</h4>
<p>it's fine by me, but it also seems like tedious tasks while your talents could be served in more important areas; unfortunately I'm not sure whether there's something on the critical path</p>



<a name="257736403"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/186049-t-compiler/wg-polonius/topic/Polonius.next%20frontend/near/257736403" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> lqd <a href="https://zulip-archive.rust-lang.org/stream/186049-t-compiler/wg-polonius/topic/Polonius.2Enext.20frontend.html#257736403">(Oct 15 2021 at 17:40)</a>:</h4>
<p>but that would definitely be useful and appreciated, let's be clear ^^</p>



<a name="257736600"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/186049-t-compiler/wg-polonius/topic/Polonius.next%20frontend/near/257736600" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> lqd <a href="https://zulip-archive.rust-lang.org/stream/186049-t-compiler/wg-polonius/topic/Polonius.2Enext.20frontend.html#257736600">(Oct 15 2021 at 17:41)</a>:</h4>
<p>(ah another parsing related one was: I was thinking we could collect the full statement somewhere in the ast node, in order to emit it as <code>node_text</code> for soufflé and the fact viz) (but I could also just pretty print the ast and emit that, it just seemed easier to do while parsing)</p>



<a name="257736800"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/186049-t-compiler/wg-polonius/topic/Polonius.next%20frontend/near/257736800" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Dylan MacKenzie (ecstatic-morse) <a href="https://zulip-archive.rust-lang.org/stream/186049-t-compiler/wg-polonius/topic/Polonius.2Enext.20frontend.html#257736800">(Oct 15 2021 at 17:43)</a>:</h4>
<p>Does the parser generator support <code>Span</code>s?</p>



<a name="257736935"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/186049-t-compiler/wg-polonius/topic/Polonius.next%20frontend/near/257736935" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> lqd <a href="https://zulip-archive.rust-lang.org/stream/186049-t-compiler/wg-polonius/topic/Polonius.2Enext.20frontend.html#257736935">(Oct 15 2021 at 17:44)</a>:</h4>
<p>I haven't checked this crate at all, I have no idea</p>



<a name="257737033"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/186049-t-compiler/wg-polonius/topic/Polonius.next%20frontend/near/257737033" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Dylan MacKenzie (ecstatic-morse) <a href="https://zulip-archive.rust-lang.org/stream/186049-t-compiler/wg-polonius/topic/Polonius.2Enext.20frontend.html#257737033">(Oct 15 2021 at 17:45)</a>:</h4>
<p>I'll check. That seems like a "principled" way of handling things.</p>



<a name="257737104"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/186049-t-compiler/wg-polonius/topic/Polonius.next%20frontend/near/257737104" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> lqd <a href="https://zulip-archive.rust-lang.org/stream/186049-t-compiler/wg-polonius/topic/Polonius.2Enext.20frontend.html#257737104">(Oct 15 2021 at 17:45)</a>:</h4>
<p>very true, they must somewhat do so to support parsing errors</p>



<a name="257737394"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/186049-t-compiler/wg-polonius/topic/Polonius.next%20frontend/near/257737394" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> lqd <a href="https://zulip-archive.rust-lang.org/stream/186049-t-compiler/wg-polonius/topic/Polonius.2Enext.20frontend.html#257737394">(Oct 15 2021 at 17:47)</a>:</h4>
<p>hopefully it's not just some internal construct and is usable in the grammar</p>



<a name="257737575"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/186049-t-compiler/wg-polonius/topic/Polonius.next%20frontend/near/257737575" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Dylan MacKenzie (ecstatic-morse) <a href="https://zulip-archive.rust-lang.org/stream/186049-t-compiler/wg-polonius/topic/Polonius.2Enext.20frontend.html#257737575">(Oct 15 2021 at 17:48)</a>:</h4>
<p>They do. I'll span some stuff. Doing lifetime bounds on function parameters requires porting over the variance rules, which will be a bit involved.</p>



<a name="257737710"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/186049-t-compiler/wg-polonius/topic/Polonius.next%20frontend/near/257737710" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> lqd <a href="https://zulip-archive.rust-lang.org/stream/186049-t-compiler/wg-polonius/topic/Polonius.2Enext.20frontend.html#257737710">(Oct 15 2021 at 17:49)</a>:</h4>
<p>yeah I'm going to port the variance rules to emit the correct introduce_subset facts</p>



<a name="257737930"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/186049-t-compiler/wg-polonius/topic/Polonius.next%20frontend/near/257737930" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> lqd <a href="https://zulip-archive.rust-lang.org/stream/186049-t-compiler/wg-polonius/topic/Polonius.2Enext.20frontend.html#257737930">(Oct 15 2021 at 17:51)</a>:</h4>
<p>we probably will need the ones about implied bounds as well and I'm not sure we have some definitive documentation about this, like we have for variance (maybe we can make do without them until then)</p>



<a name="257738223"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/186049-t-compiler/wg-polonius/topic/Polonius.next%20frontend/near/257738223" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> lqd <a href="https://zulip-archive.rust-lang.org/stream/186049-t-compiler/wg-polonius/topic/Polonius.2Enext.20frontend.html#257738223">(Oct 15 2021 at 17:53)</a>:</h4>
<p>(or maybe if we don't expect they help validate/invalidate the proof of concept analysis, we don't do that and add fact gen to rustc instead)</p>



<a name="257738255"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/186049-t-compiler/wg-polonius/topic/Polonius.next%20frontend/near/257738255" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Dylan MacKenzie (ecstatic-morse) <a href="https://zulip-archive.rust-lang.org/stream/186049-t-compiler/wg-polonius/topic/Polonius.2Enext.20frontend.html#257738255">(Oct 15 2021 at 17:53)</a>:</h4>
<p>I don't think we'll have implied bounds unless we have lifetime bounds on structs. Is that in the cards for the frontend? At some point we'll feel good enough about all this that we'll port it to rustc</p>



<a name="257738743"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/186049-t-compiler/wg-polonius/topic/Polonius.next%20frontend/near/257738743" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> lqd <a href="https://zulip-archive.rust-lang.org/stream/186049-t-compiler/wg-polonius/topic/Polonius.2Enext.20frontend.html#257738743">(Oct 15 2021 at 17:56)</a>:</h4>
<p>in the absolute we could be super thorough in the frontend, to help with in-tree tests and all, whether that's worth the work to do all that, and if/when we do that work, I'm not sure ^^ probably the best bang for our buck is porting to rustc sooner rather than later</p>



<a name="257739227"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/186049-t-compiler/wg-polonius/topic/Polonius.next%20frontend/near/257739227" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> lqd <a href="https://zulip-archive.rust-lang.org/stream/186049-t-compiler/wg-polonius/topic/Polonius.2Enext.20frontend.html#257739227">(Oct 15 2021 at 18:00)</a>:</h4>
<p>(especially once we figure out the current set of problematic cases you've uncovered, so that we can look for more of those in rustc's tests :)</p>



<a name="257739328"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/186049-t-compiler/wg-polonius/topic/Polonius.next%20frontend/near/257739328" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Dylan MacKenzie (ecstatic-morse) <a href="https://zulip-archive.rust-lang.org/stream/186049-t-compiler/wg-polonius/topic/Polonius.2Enext.20frontend.html#257739328">(Oct 15 2021 at 18:00)</a>:</h4>
<p>I've got some <code>ariadne</code> boilerplate laying around, so I'll do the <code>Span</code> stuff and then re-evaluate.</p>



<a name="257739590"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/186049-t-compiler/wg-polonius/topic/Polonius.next%20frontend/near/257739590" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> lqd <a href="https://zulip-archive.rust-lang.org/stream/186049-t-compiler/wg-polonius/topic/Polonius.2Enext.20frontend.html#257739590">(Oct 15 2021 at 18:02)</a>:</h4>
<p>sweet</p>



<a name="257856681"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/186049-t-compiler/wg-polonius/topic/Polonius.next%20frontend/near/257856681" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Dylan MacKenzie (ecstatic-morse) <a href="https://zulip-archive.rust-lang.org/stream/186049-t-compiler/wg-polonius/topic/Polonius.2Enext.20frontend.html#257856681">(Oct 16 2021 at 19:56)</a>:</h4>
<p>I have some time today, so I could help out a bit. I see a few open tasks (mostly from your todos) that wouldn't conflict too much with the main PR:</p>
<ul>
<li>lifetime parameters on functions</li>
<li>borrows and invalidations of struct fields</li>
<li>sanity check for types (no field projections on an <code>i32</code>)</li>
<li>write down (or link to) detailed rules for loan invalidation</li>
</ul>



<a name="257856798"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/186049-t-compiler/wg-polonius/topic/Polonius.next%20frontend/near/257856798" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> lqd <a href="https://zulip-archive.rust-lang.org/stream/186049-t-compiler/wg-polonius/topic/Polonius.2Enext.20frontend.html#257856798">(Oct 16 2021 at 19:58)</a>:</h4>
<p>all of those sound great to me</p>



<a name="257856828"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/186049-t-compiler/wg-polonius/topic/Polonius.next%20frontend/near/257856828" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> lqd <a href="https://zulip-archive.rust-lang.org/stream/186049-t-compiler/wg-polonius/topic/Polonius.2Enext.20frontend.html#257856828">(Oct 16 2021 at 19:58)</a>:</h4>
<p>thanks for the 2 earlier PRs, I'll merge the last one and rebase over them</p>



<a name="257856862"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/186049-t-compiler/wg-polonius/topic/Polonius.next%20frontend/near/257856862" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Dylan MacKenzie (ecstatic-morse) <a href="https://zulip-archive.rust-lang.org/stream/186049-t-compiler/wg-polonius/topic/Polonius.2Enext.20frontend.html#257856862">(Oct 16 2021 at 19:59)</a>:</h4>
<p>Cool. You'll have to keep the input string around while emitting facts, but that shouldn't be a problem.</p>



<a name="257856885"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/186049-t-compiler/wg-polonius/topic/Polonius.next%20frontend/near/257856885" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> lqd <a href="https://zulip-archive.rust-lang.org/stream/186049-t-compiler/wg-polonius/topic/Polonius.2Enext.20frontend.html#257856885">(Oct 16 2021 at 19:59)</a>:</h4>
<p>yeah, sounds fine</p>



<a name="257856969"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/186049-t-compiler/wg-polonius/topic/Polonius.next%20frontend/near/257856969" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> lqd <a href="https://zulip-archive.rust-lang.org/stream/186049-t-compiler/wg-polonius/topic/Polonius.2Enext.20frontend.html#257856969">(Oct 16 2021 at 20:00)</a>:</h4>
<p>it'll probably change the parser test snapshots, so I'll find out hwo to move them out of band while doing the rebase</p>



<a name="257857005"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/186049-t-compiler/wg-polonius/topic/Polonius.next%20frontend/near/257857005" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> lqd <a href="https://zulip-archive.rust-lang.org/stream/186049-t-compiler/wg-polonius/topic/Polonius.2Enext.20frontend.html#257857005">(Oct 16 2021 at 20:00)</a>:</h4>
<p>(it's probably just calling one of the other assertions, with json/yaml formats instead of just inline Debug output)</p>



<a name="257857039"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/186049-t-compiler/wg-polonius/topic/Polonius.next%20frontend/near/257857039" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Dylan MacKenzie (ecstatic-morse) <a href="https://zulip-archive.rust-lang.org/stream/186049-t-compiler/wg-polonius/topic/Polonius.2Enext.20frontend.html#257857039">(Oct 16 2021 at 20:01)</a>:</h4>
<p>Oh, actually I didn't think inline snapshots could be blessed, but that's wrong: <a href="https://docs.rs/insta/1.8.0/insta/index.html#inline-snapshots">https://docs.rs/insta/1.8.0/insta/index.html#inline-snapshots</a></p>



<a name="257857051"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/186049-t-compiler/wg-polonius/topic/Polonius.next%20frontend/near/257857051" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> lqd <a href="https://zulip-archive.rust-lang.org/stream/186049-t-compiler/wg-polonius/topic/Polonius.2Enext.20frontend.html#257857051">(Oct 16 2021 at 20:01)</a>:</h4>
<p>though as I said in the comment, even just this debug assert has nice ergonomics since they're automatically updated</p>



<a name="257857064"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/186049-t-compiler/wg-polonius/topic/Polonius.next%20frontend/near/257857064" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> lqd <a href="https://zulip-archive.rust-lang.org/stream/186049-t-compiler/wg-polonius/topic/Polonius.2Enext.20frontend.html#257857064">(Oct 16 2021 at 20:01)</a>:</h4>
<p>yeah that's really nice</p>



<a name="257857117"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/186049-t-compiler/wg-polonius/topic/Polonius.next%20frontend/near/257857117" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Dylan MacKenzie (ecstatic-morse) <a href="https://zulip-archive.rust-lang.org/stream/186049-t-compiler/wg-polonius/topic/Polonius.2Enext.20frontend.html#257857117">(Oct 16 2021 at 20:02)</a>:</h4>
<p>Yeah, my bad. It's just personal preference. The status quo is fine then.</p>



<a name="257857141"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/186049-t-compiler/wg-polonius/topic/Polonius.next%20frontend/near/257857141" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> lqd <a href="https://zulip-archive.rust-lang.org/stream/186049-t-compiler/wg-polonius/topic/Polonius.2Enext.20frontend.html#257857141">(Oct 16 2021 at 20:02)</a>:</h4>
<p>oh I don't mind, it makes the tests simpler/shorter</p>



<a name="257857164"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/186049-t-compiler/wg-polonius/topic/Polonius.next%20frontend/near/257857164" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> lqd <a href="https://zulip-archive.rust-lang.org/stream/186049-t-compiler/wg-polonius/topic/Polonius.2Enext.20frontend.html#257857164">(Oct 16 2021 at 20:02)</a>:</h4>
<p>hopefully the stored snapshots are still readable as AST documentation</p>



<a name="257857328"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/186049-t-compiler/wg-polonius/topic/Polonius.next%20frontend/near/257857328" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> lqd <a href="https://zulip-archive.rust-lang.org/stream/186049-t-compiler/wg-polonius/topic/Polonius.2Enext.20frontend.html#257857328">(Oct 16 2021 at 20:05)</a>:</h4>
<p>they should look fine in RON, we'll see :) otherwise yeah we can just keep them as-is for some easy to read reference</p>



<a name="257857403"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/186049-t-compiler/wg-polonius/topic/Polonius.next%20frontend/near/257857403" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Dylan MacKenzie (ecstatic-morse) <a href="https://zulip-archive.rust-lang.org/stream/186049-t-compiler/wg-polonius/topic/Polonius.2Enext.20frontend.html#257857403">(Oct 16 2021 at 20:06)</a>:</h4>
<p>RON is dope. Especially for ASTs</p>



<a name="257857489"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/186049-t-compiler/wg-polonius/topic/Polonius.next%20frontend/near/257857489" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> lqd <a href="https://zulip-archive.rust-lang.org/stream/186049-t-compiler/wg-polonius/topic/Polonius.2Enext.20frontend.html#257857489">(Oct 16 2021 at 20:08)</a>:</h4>
<p>I'll do that then</p>



<a name="257857847"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/186049-t-compiler/wg-polonius/topic/Polonius.next%20frontend/near/257857847" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Dylan MacKenzie (ecstatic-morse) <a href="https://zulip-archive.rust-lang.org/stream/186049-t-compiler/wg-polonius/topic/Polonius.2Enext.20frontend.html#257857847">(Oct 16 2021 at 20:12)</a>:</h4>
<p>Also, I wonder if we'll want a "shallow" borrow (a shared borrow of a place that doesn't conflict with mutable borrows of that place's fields). I don't think we'll be able to replicate examples using <code>match</code> otherwise.</p>



<a name="257858234"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/186049-t-compiler/wg-polonius/topic/Polonius.next%20frontend/near/257858234" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> lqd <a href="https://zulip-archive.rust-lang.org/stream/186049-t-compiler/wg-polonius/topic/Polonius.2Enext.20frontend.html#257858234">(Oct 16 2021 at 20:17)</a>:</h4>
<p>oh I hadn't considered that, that sounds like something we'd need (I remember <code>match</code>, guards, fake reads etc being touchy but have litle to no experience with them)</p>



<a name="257863818"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/186049-t-compiler/wg-polonius/topic/Polonius.next%20frontend/near/257863818" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Domenic Quirl <a href="https://zulip-archive.rust-lang.org/stream/186049-t-compiler/wg-polonius/topic/Polonius.2Enext.20frontend.html#257863818">(Oct 16 2021 at 21:45)</a>:</h4>
<p>FWIW regarding <code>insta</code>, there is also an assertion that keeps the current format, but as a file. So the <code>Debug</code> is saved in the snapshot file</p>



<a name="257863964"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/186049-t-compiler/wg-polonius/topic/Polonius.next%20frontend/near/257863964" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> lqd <a href="https://zulip-archive.rust-lang.org/stream/186049-t-compiler/wg-polonius/topic/Polonius.2Enext.20frontend.html#257863964">(Oct 16 2021 at 21:47)</a>:</h4>
<p>which one is that ? is it done by using a snapshot name in all macros actually ?</p>



<a name="257864041"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/186049-t-compiler/wg-polonius/topic/Polonius.next%20frontend/near/257864041" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> lqd <a href="https://zulip-archive.rust-lang.org/stream/186049-t-compiler/wg-polonius/topic/Polonius.2Enext.20frontend.html#257864041">(Oct 16 2021 at 21:48)</a>:</h4>
<p>(ie, do the macros both support inline snapshots and out of bands snapshots ?)</p>



<a name="257864066"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/186049-t-compiler/wg-polonius/topic/Polonius.next%20frontend/near/257864066" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> lqd <a href="https://zulip-archive.rust-lang.org/stream/186049-t-compiler/wg-polonius/topic/Polonius.2Enext.20frontend.html#257864066">(Oct 16 2021 at 21:48)</a>:</h4>
<p>(looks like it)</p>



<a name="257864372"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/186049-t-compiler/wg-polonius/topic/Polonius.next%20frontend/near/257864372" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Domenic Quirl <a href="https://zulip-archive.rust-lang.org/stream/186049-t-compiler/wg-polonius/topic/Polonius.2Enext.20frontend.html#257864372">(Oct 16 2021 at 21:53)</a>:</h4>
<p>It's this one </p>
<div class="codehilite" data-code-language="Rust"><pre><span></span><code><span class="n">insta</span>::<span class="n">assert_snapshot</span><span class="o">!</span><span class="p">(</span><span class="w"></span>
<span class="w">    </span><span class="n">snapshot_name_from_thread</span><span class="p">().</span><span class="n">expect</span><span class="p">(</span><span class="s">"could not compute snapshot name"</span><span class="p">),</span><span class="w"></span>
<span class="w">    </span><span class="n">tree</span><span class="p">.</span><span class="n">debug</span><span class="p">(</span><span class="n">tree</span><span class="p">.</span><span class="n">resolver</span><span class="p">().</span><span class="n">as_ref</span><span class="p">(),</span><span class="w"> </span><span class="kc">true</span><span class="p">),</span><span class="w"></span>
<span class="w">    </span><span class="n">input</span><span class="w"> </span><span class="p">);</span><span class="w"></span>
</code></pre></div>



<a name="257864444"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/186049-t-compiler/wg-polonius/topic/Polonius.next%20frontend/near/257864444" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Domenic Quirl <a href="https://zulip-archive.rust-lang.org/stream/186049-t-compiler/wg-polonius/topic/Polonius.2Enext.20frontend.html#257864444">(Oct 16 2021 at 21:54)</a>:</h4>
<p>(don't mind the weird way to call debug, this is from a project of mine)</p>



<a name="257864501"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/186049-t-compiler/wg-polonius/topic/Polonius.next%20frontend/near/257864501" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Domenic Quirl <a href="https://zulip-archive.rust-lang.org/stream/186049-t-compiler/wg-polonius/topic/Polonius.2Enext.20frontend.html#257864501">(Oct 16 2021 at 21:55)</a>:</h4>
<p>So yeah, name plus output plus input (since input appears in the snapshots as a reference)</p>



<a name="257864519"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/186049-t-compiler/wg-polonius/topic/Polonius.next%20frontend/near/257864519" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> lqd <a href="https://zulip-archive.rust-lang.org/stream/186049-t-compiler/wg-polonius/topic/Polonius.2Enext.20frontend.html#257864519">(Oct 16 2021 at 21:55)</a>:</h4>
<p>it looks like just asserting works like this as well</p>



<a name="257864570"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/186049-t-compiler/wg-polonius/topic/Polonius.next%20frontend/near/257864570" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> lqd <a href="https://zulip-archive.rust-lang.org/stream/186049-t-compiler/wg-polonius/topic/Polonius.2Enext.20frontend.html#257864570">(Oct 16 2021 at 21:56)</a>:</h4>
<p>the name being optional, it creates an out of band snapshot with its own generated name</p>



<a name="257864578"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/186049-t-compiler/wg-polonius/topic/Polonius.next%20frontend/near/257864578" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> lqd <a href="https://zulip-archive.rust-lang.org/stream/186049-t-compiler/wg-polonius/topic/Polonius.2Enext.20frontend.html#257864578">(Oct 16 2021 at 21:56)</a>:</h4>
<p>seems to work nicely, thanks for the info !</p>



<a name="257864609"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/186049-t-compiler/wg-polonius/topic/Polonius.next%20frontend/near/257864609" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> lqd <a href="https://zulip-archive.rust-lang.org/stream/186049-t-compiler/wg-polonius/topic/Polonius.2Enext.20frontend.html#257864609">(Oct 16 2021 at 21:57)</a>:</h4>
<p>(and there's a VSCode extension to help with snapshot files as well, nice)</p>



<a name="257864616"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/186049-t-compiler/wg-polonius/topic/Polonius.next%20frontend/near/257864616" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Domenic Quirl <a href="https://zulip-archive.rust-lang.org/stream/186049-t-compiler/wg-polonius/topic/Polonius.2Enext.20frontend.html#257864616">(Oct 16 2021 at 21:57)</a>:</h4>
<p>Possible, it's been I while since I made these</p>



<a name="257864684"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/186049-t-compiler/wg-polonius/topic/Polonius.next%20frontend/near/257864684" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Domenic Quirl <a href="https://zulip-archive.rust-lang.org/stream/186049-t-compiler/wg-polonius/topic/Polonius.2Enext.20frontend.html#257864684">(Oct 16 2021 at 21:58)</a>:</h4>
<p>Tell me if you can get that extension to work, I don't think it did for me at the time</p>



<a name="257864701"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/186049-t-compiler/wg-polonius/topic/Polonius.next%20frontend/near/257864701" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> lqd <a href="https://zulip-archive.rust-lang.org/stream/186049-t-compiler/wg-polonius/topic/Polonius.2Enext.20frontend.html#257864701">(Oct 16 2021 at 21:58)</a>:</h4>
<p>will do, though I suspect one doesn't need it as much if you mostly use inline snapshots like I did here</p>



<a name="257864704"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/186049-t-compiler/wg-polonius/topic/Polonius.next%20frontend/near/257864704" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Domenic Quirl <a href="https://zulip-archive.rust-lang.org/stream/186049-t-compiler/wg-polonius/topic/Polonius.2Enext.20frontend.html#257864704">(Oct 16 2021 at 21:58)</a>:</h4>
<p>But sounds like the snapshots in general work for you <span aria-label="+1" class="emoji emoji-1f44d" role="img" title="+1">:+1:</span></p>



<a name="257864747"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/186049-t-compiler/wg-polonius/topic/Polonius.next%20frontend/near/257864747" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> lqd <a href="https://zulip-archive.rust-lang.org/stream/186049-t-compiler/wg-polonius/topic/Polonius.2Enext.20frontend.html#257864747">(Oct 16 2021 at 21:59)</a>:</h4>
<p>yeah using insta was a great recommendation, thanks</p>



<a name="258260873"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/186049-t-compiler/wg-polonius/topic/Polonius.next%20frontend/near/258260873" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> lqd <a href="https://zulip-archive.rust-lang.org/stream/186049-t-compiler/wg-polonius/topic/Polonius.2Enext.20frontend.html#258260873">(Oct 19 2021 at 19:52)</a>:</h4>
<p><span class="user-mention silent" data-user-id="337115">Domenic Quirl</span> <a href="#narrow/stream/186049-t-compiler.2Fwg-polonius/topic/Polonius.2Enext.20frontend/near/257864684">said</a>:</p>
<blockquote>
<p>Tell me if you can get that extension to work, I don't think it did for me at the time</p>
</blockquote>
<p>I don't think it works correctly for me either, it doesn't jump to the stored snapshots at least. the other commands may work, and there's some UI to compare snapshots but that's less feature-ful than the CLI</p>



<a name="258265231"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/186049-t-compiler/wg-polonius/topic/Polonius.next%20frontend/near/258265231" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> lqd <a href="https://zulip-archive.rust-lang.org/stream/186049-t-compiler/wg-polonius/topic/Polonius.2Enext.20frontend.html#258265231">(Oct 19 2021 at 20:20)</a>:</h4>
<p>I'm not sure what you all would like to see in fact generation before we start merging some of it ? But I've marked <a href="https://github.com/nikomatsakis/polonius.next/pull/4">https://github.com/nikomatsakis/polonius.next/pull/4</a> as not WIP any more. It's missing a bunch of things and all, but hopefully it's a start.</p>
<p>Dylan has been kindly adding some things that were missing elsewhere, in the parser and implementing some rules already. It will likely be easier to improve fact gen after all these have been merged (rather than rebasing this big PR if we merge these newer ones first).</p>



<a name="258339294"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/186049-t-compiler/wg-polonius/topic/Polonius.next%20frontend/near/258339294" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Domenic Quirl <a href="https://zulip-archive.rust-lang.org/stream/186049-t-compiler/wg-polonius/topic/Polonius.2Enext.20frontend.html#258339294">(Oct 20 2021 at 09:43)</a>:</h4>
<p><span class="user-mention silent" data-user-id="116113">lqd</span> <a href="#narrow/stream/186049-t-compiler.2Fwg-polonius/topic/Polonius.2Enext.20frontend/near/258260873">said</a>:</p>
<blockquote>
<p>I don't think it works correctly for me either, it doesn't jump to the stored snapshots at least. the other commands may work, and there's some UI to compare snapshots but that's less feature-ful than the CLI</p>
</blockquote>
<p>Also thanks for sharing <span aria-label="thumbs up" class="emoji emoji-1f44d" role="img" title="thumbs up">:thumbs_up:</span></p>



<a name="258339686"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/186049-t-compiler/wg-polonius/topic/Polonius.next%20frontend/near/258339686" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Domenic Quirl <a href="https://zulip-archive.rust-lang.org/stream/186049-t-compiler/wg-polonius/topic/Polonius.2Enext.20frontend.html#258339686">(Oct 20 2021 at 09:46)</a>:</h4>
<p><span class="user-mention silent" data-user-id="116113">lqd</span> <a href="#narrow/stream/186049-t-compiler.2Fwg-polonius/topic/Polonius.2Enext.20frontend/near/258265231">said</a>:</p>
<blockquote>
<p>I'm not sure what you all would like to see in fact generation before we start merging some of it ? But I've marked <a href="https://github.com/nikomatsakis/polonius.next/pull/4">https://github.com/nikomatsakis/polonius.next/pull/4</a> as not WIP any more. It's missing a bunch of things and all, but hopefully it's a start.</p>
<p>Dylan has been kindly adding some things that were missing elsewhere, in the parser and implementing some rules already. It will likely be easier to improve fact gen after all these have been merged (rather than rebasing this big PR if we merge these newer ones first).</p>
</blockquote>
<p>I think it's just that in general, we should be careful with integrating parts of the pipeline that are knowingly incorrect. We know about that and are actively working on fact gen at the moment, so if you're saying that will be easier if we merge the partial implementation then I'm ok with saying "go for it". But we should keep an eye on this and make sure to patch it up as soon as possible, at least to the level we have discovered things already so it matches our current understanding.</p>



<hr><p>Last updated: Apr 12 2022 at 20:01 UTC</p>
</html>