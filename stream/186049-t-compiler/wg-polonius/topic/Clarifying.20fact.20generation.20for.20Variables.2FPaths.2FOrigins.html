<html>
<head><meta charset="utf-8"><title>Clarifying fact generation for Variables/Paths/Origins · t-compiler/wg-polonius · Zulip Chat Archive</title></head>
<h2>Stream: <a href="https://zulip-archive.rust-lang.org/stream/186049-t-compiler/wg-polonius/index.html">t-compiler/wg-polonius</a></h2>
<h3>Topic: <a href="https://zulip-archive.rust-lang.org/stream/186049-t-compiler/wg-polonius/topic/Clarifying.20fact.20generation.20for.20Variables.2FPaths.2FOrigins.html">Clarifying fact generation for Variables/Paths/Origins</a></h3>

<hr>

<base href="https://rust-lang.zulipchat.com">

<head><link href="https://zulip-archive.rust-lang.org/style.css" rel="stylesheet"></head>

<a name="251037592"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/186049-t-compiler/wg-polonius/topic/Clarifying%20fact%20generation%20for%20Variables/Paths/Origins/near/251037592" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Domenic Quirl <a href="https://zulip-archive.rust-lang.org/stream/186049-t-compiler/wg-polonius/topic/Clarifying.20fact.20generation.20for.20Variables.2FPaths.2FOrigins.html#251037592">(Aug 28 2021 at 07:44)</a>:</h4>
<p>After we talked yesterday, I was thinking about the "an origin is accessed" information (I also just read your remaining discussion from tonight, but want to get this out first). If I have some variable that is <code>var_used_at</code> some position, and the <code>use_of_var_derefs_origin</code> o, then I take it o is accessed (same for the <code>drop</code> versions of these). If <code>x</code> is some <code>Foo&lt;'a, 'b&gt; { a: &amp;'a mut Bar, b: &amp;'b mut Baz }</code>, presumably a use of <code>x</code> derefs both <code>'a</code> and <code>'b</code>?</p>



<a name="251037606"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/186049-t-compiler/wg-polonius/topic/Clarifying%20fact%20generation%20for%20Variables/Paths/Origins/near/251037606" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Domenic Quirl <a href="https://zulip-archive.rust-lang.org/stream/186049-t-compiler/wg-polonius/topic/Clarifying.20fact.20generation.20for.20Variables.2FPaths.2FOrigins.html#251037606">(Aug 28 2021 at 07:44)</a>:</h4>
<p>Further, I am wondering about how currently paths relate to origins</p>



<a name="251037697"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/186049-t-compiler/wg-polonius/topic/Clarifying%20fact%20generation%20for%20Variables/Paths/Origins/near/251037697" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Domenic Quirl <a href="https://zulip-archive.rust-lang.org/stream/186049-t-compiler/wg-polonius/topic/Clarifying.20fact.20generation.20for.20Variables.2FPaths.2FOrigins.html#251037697">(Aug 28 2021 at 07:46)</a>:</h4>
<p>There is <code>path_accessed_at</code>, which seems to me like the closest thing to the use of a path, but afaik there is no relation that relates paths to origins (except if <code>path_is_var</code> and the variable facts apply)?</p>



<a name="251037736"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/186049-t-compiler/wg-polonius/topic/Clarifying%20fact%20generation%20for%20Variables/Paths/Origins/near/251037736" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Domenic Quirl <a href="https://zulip-archive.rust-lang.org/stream/186049-t-compiler/wg-polonius/topic/Clarifying.20fact.20generation.20for.20Variables.2FPaths.2FOrigins.html#251037736">(Aug 28 2021 at 07:48)</a>:</h4>
<p>What I am wondering is code like </p>
<div class="codehilite" data-code-language="Rust"><pre><span></span><code><span class="kd">let</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Foo</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="n">a</span><span class="p">,</span><span class="w"> </span><span class="n">b</span><span class="w"> </span><span class="p">};</span><span class="w"> </span><span class="c1">// Foo from above</span>
<span class="kd">let</span><span class="w"> </span><span class="n">p</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">&amp;</span><span class="k">mut</span><span class="w"> </span><span class="n">x</span><span class="p">.</span><span class="n">a</span><span class="p">;</span><span class="w"></span>
<span class="n">bar</span><span class="p">(</span><span class="o">&amp;</span><span class="k">mut</span><span class="w"> </span><span class="n">x</span><span class="p">.</span><span class="n">b</span><span class="p">);</span><span class="w"></span>
<span class="nb">drop</span><span class="p">(</span><span class="n">p</span><span class="p">);</span><span class="w"></span>
</code></pre></div>



<a name="251037813"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/186049-t-compiler/wg-polonius/topic/Clarifying%20fact%20generation%20for%20Variables/Paths/Origins/near/251037813" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Domenic Quirl <a href="https://zulip-archive.rust-lang.org/stream/186049-t-compiler/wg-polonius/topic/Clarifying.20fact.20generation.20for.20Variables.2FPaths.2FOrigins.html#251037813">(Aug 28 2021 at 07:49)</a>:</h4>
<p>where paths are borrowed individually, which can't deref all origins of the root <code>x</code></p>



<a name="251037939"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/186049-t-compiler/wg-polonius/topic/Clarifying%20fact%20generation%20for%20Variables/Paths/Origins/near/251037939" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Domenic Quirl <a href="https://zulip-archive.rust-lang.org/stream/186049-t-compiler/wg-polonius/topic/Clarifying.20fact.20generation.20for.20Variables.2FPaths.2FOrigins.html#251037939">(Aug 28 2021 at 07:52)</a>:</h4>
<p>My intuition is that, currently, this is encoded in the loan facts (that is, there will be a loan issued for the borrow with a new origin, and a corresponding subset that relates it to <code>'a</code>/<code>'b</code>), but is not explicit in the other facts. Is that correct?</p>



<a name="251072756"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/186049-t-compiler/wg-polonius/topic/Clarifying%20fact%20generation%20for%20Variables/Paths/Origins/near/251072756" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/186049-t-compiler/wg-polonius/topic/Clarifying.20fact.20generation.20for.20Variables.2FPaths.2FOrigins.html#251072756">(Aug 28 2021 at 18:13)</a>:</h4>
<p><span class="user-mention silent" data-user-id="337115">Domenic Quirl</span> <a href="#narrow/stream/186049-t-compiler.2Fwg-polonius/topic/Clarifying.20fact.20generation.20for.20Variables.2FPaths.2FOrigins/near/251037592">said</a>:</p>
<blockquote>
<p>...presumably a use of <code>x</code> derefs both <code>'a</code> and <code>'b</code>?</p>
</blockquote>
<p>correct</p>



<a name="251072811"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/186049-t-compiler/wg-polonius/topic/Clarifying%20fact%20generation%20for%20Variables/Paths/Origins/near/251072811" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/186049-t-compiler/wg-polonius/topic/Clarifying.20fact.20generation.20for.20Variables.2FPaths.2FOrigins.html#251072811">(Aug 28 2021 at 18:14)</a>:</h4>
<p><span class="user-mention silent" data-user-id="337115">Domenic Quirl</span> <a href="#narrow/stream/186049-t-compiler.2Fwg-polonius/topic/Clarifying.20fact.20generation.20for.20Variables.2FPaths.2FOrigins/near/251037939">said</a>:</p>
<blockquote>
<p>My intuition is that, currently, this is encoded in the loan facts (that is, there will be a loan issued for the borrow with a new origin, and a corresponding subset that relates it to <code>'a</code>/<code>'b</code>), but is not explicit in the other facts. Is that correct?</p>
</blockquote>
<p>I think so</p>



<a name="251072819"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/186049-t-compiler/wg-polonius/topic/Clarifying%20fact%20generation%20for%20Variables/Paths/Origins/near/251072819" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/186049-t-compiler/wg-polonius/topic/Clarifying.20fact.20generation.20for.20Variables.2FPaths.2FOrigins.html#251072819">(Aug 28 2021 at 18:14)</a>:</h4>
<p>have to double check but that sounds plausible :)</p>



<hr><p>Last updated: Apr 12 2022 at 20:01 UTC</p>
</html>