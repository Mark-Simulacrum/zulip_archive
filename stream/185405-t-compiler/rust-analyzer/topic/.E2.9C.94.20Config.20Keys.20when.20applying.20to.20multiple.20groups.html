<html>
<head><meta charset="utf-8"><title>✔ Config Keys when applying to multiple groups · t-compiler/rust-analyzer · Zulip Chat Archive</title></head>
<h2>Stream: <a href="https://zulip-archive.rust-lang.org/stream/185405-t-compiler/rust-analyzer/index.html">t-compiler/rust-analyzer</a></h2>
<h3>Topic: <a href="https://zulip-archive.rust-lang.org/stream/185405-t-compiler/rust-analyzer/topic/.E2.9C.94.20Config.20Keys.20when.20applying.20to.20multiple.20groups.html">✔ Config Keys when applying to multiple groups</a></h3>

<hr>

<base href="https://rust-lang.zulipchat.com">

<head><link href="https://zulip-archive.rust-lang.org/style.css" rel="stylesheet"></head>

<a name="266505436"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/185405-t-compiler/rust-analyzer/topic/%E2%9C%94%20Config%20Keys%20when%20applying%20to%20multiple%20groups/near/266505436" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lukas Wirth <a href="https://zulip-archive.rust-lang.org/stream/185405-t-compiler/rust-analyzer/topic/.E2.9C.94.20Config.20Keys.20when.20applying.20to.20multiple.20groups.html#266505436">(Dec 31 2021 at 14:09)</a>:</h4>
<p>In <a href="https://github.com/rust-analyzer/rust-analyzer/pull/11145">https://github.com/rust-analyzer/rust-analyzer/pull/11145</a> we want to add a new config key to specify whether to fill struct field defaults with <code>todo!</code> or <code>Default::default</code>(if applicable), this would apply to diagnostics but struct field completions in struct literals can also make use of this configuration for the snippet completion's default, so now the question is where a good spot for that config would be in since it applies to both <code>completion</code> and <code>diagnostics</code>(and maybe even <code>assists</code>?)</p>



<a name="266505503"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/185405-t-compiler/rust-analyzer/topic/%E2%9C%94%20Config%20Keys%20when%20applying%20to%20multiple%20groups/near/266505503" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lukas Wirth <a href="https://zulip-archive.rust-lang.org/stream/185405-t-compiler/rust-analyzer/topic/.E2.9C.94.20Config.20Keys.20when.20applying.20to.20multiple.20groups.html#266505503">(Dec 31 2021 at 14:10)</a>:</h4>
<p>I don't think we had such a case of a config being applicable for multiple IDE parts yet? I guess one way would be to duplicate the config for both but that feels wrong to me since this is not something you would want to ever work differently I believe<br>
I think <code>assists</code> would be probably fit the best for the all rounder configs? <code>add_missing_match_arms</code> could also use this in which case this could be made more general as well by having this as a default filling element in general I suppose and not just fields.</p>



<a name="266505821"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/185405-t-compiler/rust-analyzer/topic/%E2%9C%94%20Config%20Keys%20when%20applying%20to%20multiple%20groups/near/266505821" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Notification Bot <a href="https://zulip-archive.rust-lang.org/stream/185405-t-compiler/rust-analyzer/topic/.E2.9C.94.20Config.20Keys.20when.20applying.20to.20multiple.20groups.html#266505821">(Dec 31 2021 at 14:17)</a>:</h4>
<p><span class="user-mention silent" data-user-id="300586">Lukas Wirth</span> has marked this topic as resolved.</p>



<a name="266621233"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/185405-t-compiler/rust-analyzer/topic/%E2%9C%94%20Config%20Keys%20when%20applying%20to%20multiple%20groups/near/266621233" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> matklad <a href="https://zulip-archive.rust-lang.org/stream/185405-t-compiler/rust-analyzer/topic/.E2.9C.94.20Config.20Keys.20when.20applying.20to.20multiple.20groups.html#266621233">(Jan 02 2022 at 16:20)</a>:</h4>
<p>I don't think we should do this (as <code>Default::default</code> is never what one wants), but for the general question:</p>
<ul>
<li>in terms of implementation, <code>CompletionConfig</code> and <code>AssistConfig</code> should have identical, unrelated fields for these. It's up to the caller to implement the logic of "single user-specified options affects both behaviors"</li>
<li>in terms of UI, I think we already solved similar issue for auto-import merging behavior. There, the config is in the <code>assists</code>. So, I feel we should just do the same and not think to much (that's my general approach for working on RA -- I just copy-paste code and tricks around :) ). It also feels generally OK -- you can view assists as a general "code assistance"</li>
</ul>



<a name="266622514"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/185405-t-compiler/rust-analyzer/topic/%E2%9C%94%20Config%20Keys%20when%20applying%20to%20multiple%20groups/near/266622514" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lukas Wirth <a href="https://zulip-archive.rust-lang.org/stream/185405-t-compiler/rust-analyzer/topic/.E2.9C.94.20Config.20Keys.20when.20applying.20to.20multiple.20groups.html#266622514">(Jan 02 2022 at 16:50)</a>:</h4>
<p>Hmm ye <code>Default::default</code> filling is probably not too useful, though I do think having the configuration for "reasonable defaults" wouldn't be a bad choice</p>



<a name="266623103"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/185405-t-compiler/rust-analyzer/topic/%E2%9C%94%20Config%20Keys%20when%20applying%20to%20multiple%20groups/near/266623103" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> matklad <a href="https://zulip-archive.rust-lang.org/stream/185405-t-compiler/rust-analyzer/topic/.E2.9C.94.20Config.20Keys.20when.20applying.20to.20multiple.20groups.html#266623103">(Jan 02 2022 at 17:01)</a>:</h4>
<p>Yeah, that's my reasoning exactly. "reasonable" means Pareto-optimal -- we can't do anything <em>strictly</em> better. And there's a possible Pareto-improvement to <code>Default::default</code>  -- instead of literal <code>Default::default</code>, use appropriate default value for each type ("zero" literals for primitive types, <code>T::new()</code> if that exists, <code>T::default</code> if that exists).</p>



<a name="266818221"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/185405-t-compiler/rust-analyzer/topic/%E2%9C%94%20Config%20Keys%20when%20applying%20to%20multiple%20groups/near/266818221" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Coenen Benjamin <a href="https://zulip-archive.rust-lang.org/stream/185405-t-compiler/rust-analyzer/topic/.E2.9C.94.20Config.20Keys.20when.20applying.20to.20multiple.20groups.html#266818221">(Jan 04 2022 at 15:03)</a>:</h4>
<p>I implemented what you suggested but I still have an issue, if you know what's wrong let me know :) <a href="https://github.com/rust-analyzer/rust-analyzer/pull/11145#issuecomment-1004884170">https://github.com/rust-analyzer/rust-analyzer/pull/11145#issuecomment-1004884170</a></p>



<a name="266821597"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/185405-t-compiler/rust-analyzer/topic/%E2%9C%94%20Config%20Keys%20when%20applying%20to%20multiple%20groups/near/266821597" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lukas Wirth <a href="https://zulip-archive.rust-lang.org/stream/185405-t-compiler/rust-analyzer/topic/.E2.9C.94.20Config.20Keys.20when.20applying.20to.20multiple.20groups.html#266821597">(Jan 04 2022 at 15:31)</a>:</h4>
<p>Does it never find the <code>new</code> method for any types? <span aria-label="thinking" class="emoji emoji-1f914" role="img" title="thinking">:thinking:</span></p>



<a name="266827904"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/185405-t-compiler/rust-analyzer/topic/%E2%9C%94%20Config%20Keys%20when%20applying%20to%20multiple%20groups/near/266827904" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Coenen Benjamin <a href="https://zulip-archive.rust-lang.org/stream/185405-t-compiler/rust-analyzer/topic/.E2.9C.94.20Config.20Keys.20when.20applying.20to.20multiple.20groups.html#266827904">(Jan 04 2022 at 16:17)</a>:</h4>
<p>Yes it doesn't find new at all. At least that what I saw. Maybe I'm wrong or I'm misinterpreting something</p>



<a name="267068312"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/185405-t-compiler/rust-analyzer/topic/%E2%9C%94%20Config%20Keys%20when%20applying%20to%20multiple%20groups/near/267068312" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Coenen Benjamin <a href="https://zulip-archive.rust-lang.org/stream/185405-t-compiler/rust-analyzer/topic/.E2.9C.94.20Config.20Keys.20when.20applying.20to.20multiple.20groups.html#267068312">(Jan 06 2022 at 14:46)</a>:</h4>
<p><span class="user-mention" data-user-id="300586">@Lukas Wirth</span> I found my mistake on <a href="https://github.com/rust-analyzer/rust-analyzer/pull/11145">https://github.com/rust-analyzer/rust-analyzer/pull/11145</a> basically I was calling for <code>iterate_on_methods</code> and <code>new</code> is an associated function then I had to call <code>iterate_on_associated_item</code> my bad. It's ready for review :)</p>



<a name="267068611"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/185405-t-compiler/rust-analyzer/topic/%E2%9C%94%20Config%20Keys%20when%20applying%20to%20multiple%20groups/near/267068611" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lukas Wirth <a href="https://zulip-archive.rust-lang.org/stream/185405-t-compiler/rust-analyzer/topic/.E2.9C.94.20Config.20Keys.20when.20applying.20to.20multiple.20groups.html#267068611">(Jan 06 2022 at 14:48)</a>:</h4>
<p>o ye that would explain it <span aria-label="big smile" class="emoji emoji-1f604" role="img" title="big smile">:big_smile:</span></p>



<hr><p>Last updated: Apr 12 2022 at 20:01 UTC</p>
</html>