<html>
<head><meta charset="utf-8"><title>Highlight exit points: `.await` · t-compiler/rust-analyzer · Zulip Chat Archive</title></head>
<h2>Stream: <a href="https://zulip-archive.rust-lang.org/stream/185405-t-compiler/rust-analyzer/index.html">t-compiler/rust-analyzer</a></h2>
<h3>Topic: <a href="https://zulip-archive.rust-lang.org/stream/185405-t-compiler/rust-analyzer/topic/Highlight.20exit.20points.3A.20.60.2Eawait.60.html">Highlight exit points: `.await`</a></h3>

<hr>

<base href="https://rust-lang.zulipchat.com">

<head><link href="https://zulip-archive.rust-lang.org/style.css" rel="stylesheet"></head>

<a name="258359541"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/185405-t-compiler/rust-analyzer/topic/Highlight%20exit%20points%3A%20%60.await%60/near/258359541" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Yoshua Wuyts [he/they] <a href="https://zulip-archive.rust-lang.org/stream/185405-t-compiler/rust-analyzer/topic/Highlight.20exit.20points.3A.20.60.2Eawait.60.html#258359541">(Oct 20 2021 at 12:41)</a>:</h4>
<p>Hey, I was wondering if it would be useful to highlight <code>.await</code> as an "exit point" in Rust-Analyzer as well. It's a bit different from <code>return</code> and <code>?</code> in that it doesn't cause a value to be returned, but it does mark a point where the function can be cancelled, and in turn where destructors may be run.</p>



<a name="258360158"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/185405-t-compiler/rust-analyzer/topic/Highlight%20exit%20points%3A%20%60.await%60/near/258360158" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Yoshua Wuyts [he/they] <a href="https://zulip-archive.rust-lang.org/stream/185405-t-compiler/rust-analyzer/topic/Highlight.20exit.20points.3A.20.60.2Eawait.60.html#258360158">(Oct 20 2021 at 12:46)</a>:</h4>
<p>(currently working on some writing on cancellation in Rust, and happened to think about how RA highlights exit points)</p>



<a name="258360481"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/185405-t-compiler/rust-analyzer/topic/Highlight%20exit%20points%3A%20%60.await%60/near/258360481" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lukas Wirth <a href="https://zulip-archive.rust-lang.org/stream/185405-t-compiler/rust-analyzer/topic/Highlight.20exit.20points.3A.20.60.2Eawait.60.html#258360481">(Oct 20 2021 at 12:48)</a>:</h4>
<p>Is highlighting yield points separately not enough?</p>



<a name="258360507"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/185405-t-compiler/rust-analyzer/topic/Highlight%20exit%20points%3A%20%60.await%60/near/258360507" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Yoshua Wuyts [he/they] <a href="https://zulip-archive.rust-lang.org/stream/185405-t-compiler/rust-analyzer/topic/Highlight.20exit.20points.3A.20.60.2Eawait.60.html#258360507">(Oct 20 2021 at 12:48)</a>:</h4>
<p>Possibly!</p>



<a name="258360526"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/185405-t-compiler/rust-analyzer/topic/Highlight%20exit%20points%3A%20%60.await%60/near/258360526" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lukas Wirth <a href="https://zulip-archive.rust-lang.org/stream/185405-t-compiler/rust-analyzer/topic/Highlight.20exit.20points.3A.20.60.2Eawait.60.html#258360526">(Oct 20 2021 at 12:49)</a>:</h4>
<p>Because that we should already be doing</p>



<a name="258360556"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/185405-t-compiler/rust-analyzer/topic/Highlight%20exit%20points%3A%20%60.await%60/near/258360556" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lukas Wirth <a href="https://zulip-archive.rust-lang.org/stream/185405-t-compiler/rust-analyzer/topic/Highlight.20exit.20points.3A.20.60.2Eawait.60.html#258360556">(Oct 20 2021 at 12:49)</a>:</h4>
<p>if you put the cursor on the <code>.await</code> or <code>async</code> tokens it should highlight all  yield points of the context</p>



<a name="258360717"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/185405-t-compiler/rust-analyzer/topic/Highlight%20exit%20points%3A%20%60.await%60/near/258360717" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Yoshua Wuyts [he/they] <a href="https://zulip-archive.rust-lang.org/stream/185405-t-compiler/rust-analyzer/topic/Highlight.20exit.20points.3A.20.60.2Eawait.60.html#258360717">(Oct 20 2021 at 12:50)</a>:</h4>
<p>I guess I'm currently in the mindset of: "it's not commonly understood that seeing <code>.await</code> in your code may mean your code never progresses past that point, and may cause destructors to run".</p>



<a name="258360785"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/185405-t-compiler/rust-analyzer/topic/Highlight%20exit%20points%3A%20%60.await%60/near/258360785" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Yoshua Wuyts [he/they] <a href="https://zulip-archive.rust-lang.org/stream/185405-t-compiler/rust-analyzer/topic/Highlight.20exit.20points.3A.20.60.2Eawait.60.html#258360785">(Oct 20 2021 at 12:50)</a>:</h4>
<p>But maybe I'm overthinking it?</p>



<a name="258360881"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/185405-t-compiler/rust-analyzer/topic/Highlight%20exit%20points%3A%20%60.await%60/near/258360881" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Yoshua Wuyts [he/they] <a href="https://zulip-archive.rust-lang.org/stream/185405-t-compiler/rust-analyzer/topic/Highlight.20exit.20points.3A.20.60.2Eawait.60.html#258360881">(Oct 20 2021 at 12:51)</a>:</h4>
<p>maybe highlighting all yields points is indeed enough</p>



<a name="258361085"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/185405-t-compiler/rust-analyzer/topic/Highlight%20exit%20points%3A%20%60.await%60/near/258361085" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lukas Wirth <a href="https://zulip-archive.rust-lang.org/stream/185405-t-compiler/rust-analyzer/topic/Highlight.20exit.20points.3A.20.60.2Eawait.60.html#258361085">(Oct 20 2021 at 12:52)</a>:</h4>
<p>It might make sense to consider highlighting both as some grouped highlighting in certain cases(question there would be then, when?), but I personally consider yield and exit points to be different.</p>



<a name="258361353"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/185405-t-compiler/rust-analyzer/topic/Highlight%20exit%20points%3A%20%60.await%60/near/258361353" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Yoshua Wuyts [he/they] <a href="https://zulip-archive.rust-lang.org/stream/185405-t-compiler/rust-analyzer/topic/Highlight.20exit.20points.3A.20.60.2Eawait.60.html#258361353">(Oct 20 2021 at 12:54)</a>:</h4>
<p>_nods_, yeah</p>



<a name="258361426"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/185405-t-compiler/rust-analyzer/topic/Highlight%20exit%20points%3A%20%60.await%60/near/258361426" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Yoshua Wuyts [he/they] <a href="https://zulip-archive.rust-lang.org/stream/185405-t-compiler/rust-analyzer/topic/Highlight.20exit.20points.3A.20.60.2Eawait.60.html#258361426">(Oct 20 2021 at 12:55)</a>:</h4>
<p>Maybe we just need to keep this in mind when we want to answer questions like: "where would the destructors for &lt;type&gt; be run?"</p>



<a name="258361491"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/185405-t-compiler/rust-analyzer/topic/Highlight%20exit%20points%3A%20%60.await%60/near/258361491" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Yoshua Wuyts [he/they] <a href="https://zulip-archive.rust-lang.org/stream/185405-t-compiler/rust-analyzer/topic/Highlight.20exit.20points.3A.20.60.2Eawait.60.html#258361491">(Oct 20 2021 at 12:55)</a>:</h4>
<p>Which feels separate from what both exit points / yield points currently show in Rust</p>



<a name="258361982"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/185405-t-compiler/rust-analyzer/topic/Highlight%20exit%20points%3A%20%60.await%60/near/258361982" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lukas Wirth <a href="https://zulip-archive.rust-lang.org/stream/185405-t-compiler/rust-analyzer/topic/Highlight.20exit.20points.3A.20.60.2Eawait.60.html#258361982">(Oct 20 2021 at 12:58)</a>:</h4>
<p>Ye showing "(possible) destruction points" seems like a separate thing from the two</p>



<hr><p>Last updated: Apr 12 2022 at 20:01 UTC</p>
</html>