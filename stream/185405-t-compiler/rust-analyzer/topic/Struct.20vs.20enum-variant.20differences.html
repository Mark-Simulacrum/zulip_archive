<html>
<head><meta charset="utf-8"><title>Struct vs enum-variant differences · t-compiler/rust-analyzer · Zulip Chat Archive</title></head>
<h2>Stream: <a href="https://zulip-archive.rust-lang.org/stream/185405-t-compiler/rust-analyzer/index.html">t-compiler/rust-analyzer</a></h2>
<h3>Topic: <a href="https://zulip-archive.rust-lang.org/stream/185405-t-compiler/rust-analyzer/topic/Struct.20vs.20enum-variant.20differences.html">Struct vs enum-variant differences</a></h3>

<hr>

<base href="https://rust-lang.zulipchat.com">

<head><link href="https://zulip-archive.rust-lang.org/style.css" rel="stylesheet"></head>

<a name="275063156"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/185405-t-compiler/rust-analyzer/topic/Struct%20vs%20enum-variant%20differences/near/275063156" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Morgan Wolfe <a href="https://zulip-archive.rust-lang.org/stream/185405-t-compiler/rust-analyzer/topic/Struct.20vs.20enum-variant.20differences.html#275063156">(Mar 11 2022 at 23:44)</a>:</h4>
<p>I was looking at adding support for union literals (<a href="https://github.com/rust-analyzer/rust-analyzer/issues/11568">https://github.com/rust-analyzer/rust-analyzer/issues/11568</a>), which are of course very similar to structs, and while trying to refactor some stuff out of crates/ide_completion/src/render/struct_literal.rs to avoid just copying it all wholesale, I noticed that it's all <em>similar</em> to the enum variant code but not similar enough to actually deduplicate. Additionally, I realized that means that the actual user experience is different when auto-completing struct literals versus enum variants - specifically, you get <code>Struct{ a: (), b: ()}</code> for structs and just <code>Enum::Variant</code> for enums.<br>
At least from the bit of looking I've done so far, it seems like it should be pretty simple to unify behaviors for structs, enum variants, and (eventually) unions, but I'd like to know if there's a good reason not to do this or a good reason why it hasn't been done already before I just dive in.</p>



<a name="275064131"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/185405-t-compiler/rust-analyzer/topic/Struct%20vs%20enum-variant%20differences/near/275064131" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lukas Wirth <a href="https://zulip-archive.rust-lang.org/stream/185405-t-compiler/rust-analyzer/topic/Struct.20vs.20enum-variant.20differences.html#275064131">(Mar 11 2022 at 23:58)</a>:</h4>
<p>No you are right, enum variants are pretty much just structs (I think we store both in the HIR under the same thing which is just a variant), the reason we don't have "complete" enum variant completions yet is just that it wasn't implemented yet</p>



<a name="275064140"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/185405-t-compiler/rust-analyzer/topic/Struct%20vs%20enum-variant%20differences/near/275064140" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lukas Wirth <a href="https://zulip-archive.rust-lang.org/stream/185405-t-compiler/rust-analyzer/topic/Struct.20vs.20enum-variant.20differences.html#275064140">(Mar 11 2022 at 23:58)</a>:</h4>
<p>So unifying these sounds like a great idea</p>



<a name="275064328"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/185405-t-compiler/rust-analyzer/topic/Struct%20vs%20enum-variant%20differences/near/275064328" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Morgan Wolfe <a href="https://zulip-archive.rust-lang.org/stream/185405-t-compiler/rust-analyzer/topic/Struct.20vs.20enum-variant.20differences.html#275064328">(Mar 12 2022 at 00:00)</a>:</h4>
<p>Cool beans. I'll get right on it</p>



<hr><p>Last updated: Apr 12 2022 at 20:01 UTC</p>
</html>