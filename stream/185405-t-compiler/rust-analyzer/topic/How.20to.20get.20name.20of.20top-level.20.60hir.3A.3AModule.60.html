<html>
<head><meta charset="utf-8"><title>How to get name of top-level `hir::Module` · t-compiler/rust-analyzer · Zulip Chat Archive</title></head>
<h2>Stream: <a href="https://zulip-archive.rust-lang.org/stream/185405-t-compiler/rust-analyzer/index.html">t-compiler/rust-analyzer</a></h2>
<h3>Topic: <a href="https://zulip-archive.rust-lang.org/stream/185405-t-compiler/rust-analyzer/topic/How.20to.20get.20name.20of.20top-level.20.60hir.3A.3AModule.60.html">How to get name of top-level `hir::Module`</a></h3>

<hr>

<base href="https://rust-lang.zulipchat.com">

<head><link href="https://zulip-archive.rust-lang.org/style.css" rel="stylesheet"></head>

<a name="255574576"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/185405-t-compiler/rust-analyzer/topic/How%20to%20get%20name%20of%20top-level%20%60hir%3A%3AModule%60/near/255574576" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Aramis Razzaghipour <a href="https://zulip-archive.rust-lang.org/stream/185405-t-compiler/rust-analyzer/topic/How.20to.20get.20name.20of.20top-level.20.60hir.3A.3AModule.60.html#255574576">(Sep 30 2021 at 13:34)</a>:</h4>
<p>Calling <code>hir::Module::name</code> on a top-level module (crate?) always returns <code>None</code>, since <code>hir::Module::name</code> early-returns with <code>None</code> for modules which don’t have parents. How can I get the name of a top-level <code>hir::Module</code>?</p>



<a name="255575504"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/185405-t-compiler/rust-analyzer/topic/How%20to%20get%20name%20of%20top-level%20%60hir%3A%3AModule%60/near/255575504" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lukas Wirth <a href="https://zulip-archive.rust-lang.org/stream/185405-t-compiler/rust-analyzer/topic/How.20to.20get.20name.20of.20top-level.20.60hir.3A.3AModule.60.html#255575504">(Sep 30 2021 at 13:41)</a>:</h4>
<p>The root module isn't named so you probably would have to derive it from its path if you are interested in whether its <code>lib.rs</code>, <code>main.rs</code> etc</p>



<a name="255576768"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/185405-t-compiler/rust-analyzer/topic/How%20to%20get%20name%20of%20top-level%20%60hir%3A%3AModule%60/near/255576768" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Aramis Razzaghipour <a href="https://zulip-archive.rust-lang.org/stream/185405-t-compiler/rust-analyzer/topic/How.20to.20get.20name.20of.20top-level.20.60hir.3A.3AModule.60.html#255576768">(Sep 30 2021 at 13:49)</a>:</h4>
<p><span class="user-mention silent" data-user-id="300586">Lukas Wirth</span> <a href="#narrow/stream/185405-t-compiler.2Frust-analyzer/topic/How.20to.20get.20name.20of.20top-level.20.60hir.3A.3AModule.60/near/255575504">said</a>:</p>
<blockquote>
<p>The root module isn't named so you probably would have to derive it from its path if you are interested in whether its <code>lib.rs</code>, <code>main.rs</code> etc</p>
</blockquote>
<p>Thanks for the quick reply! I don’t care about <code>lib.rs</code> vs <code>main.rs</code>, just the crate name as listed in its <code>Cargo.toml</code>. How can I obtain this?</p>



<a name="255577042"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/185405-t-compiler/rust-analyzer/topic/How%20to%20get%20name%20of%20top-level%20%60hir%3A%3AModule%60/near/255577042" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lukas Wirth <a href="https://zulip-archive.rust-lang.org/stream/185405-t-compiler/rust-analyzer/topic/How.20to.20get.20name.20of.20top-level.20.60hir.3A.3AModule.60.html#255577042">(Sep 30 2021 at 13:51)</a>:</h4>
<p>There is this <br>
<a href="https://github.com/rust-analyzer/rust-analyzer/blob/533ca584c31a251bc47f978b55df9b69058dabba\crates\hir\src\lib.rs#L186">https://github.com/rust-analyzer/rust-analyzer/blob/533ca584c31a251bc47f978b55df9b69058dabba\crates\hir\src\lib.rs#L186</a></p>



<a name="255577188"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/185405-t-compiler/rust-analyzer/topic/How%20to%20get%20name%20of%20top-level%20%60hir%3A%3AModule%60/near/255577188" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lukas Wirth <a href="https://zulip-archive.rust-lang.org/stream/185405-t-compiler/rust-analyzer/topic/How.20to.20get.20name.20of.20top-level.20.60hir.3A.3AModule.60.html#255577188">(Sep 30 2021 at 13:52)</a>:</h4>
<p>I am not 100% this will always work though as crate names are a bit tricky, see the following comment</p>
<div class="codehilite"><pre><span></span><code>    /// A name used in the package&#39;s project declaration: for Cargo projects,
    /// its `[package].name` can be different for other project types or even
    /// absent (a dummy crate for the code snippet, for example).
    ///
    /// For purposes of analysis, crates are anonymous (only names in
    /// `Dependency` matters), this name should only be used for UI.
</code></pre></div>



<a name="255577266"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/185405-t-compiler/rust-analyzer/topic/How%20to%20get%20name%20of%20top-level%20%60hir%3A%3AModule%60/near/255577266" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lukas Wirth <a href="https://zulip-archive.rust-lang.org/stream/185405-t-compiler/rust-analyzer/topic/How.20to.20get.20name.20of.20top-level.20.60hir.3A.3AModule.60.html#255577266">(Sep 30 2021 at 13:52)</a>:</h4>
<p>It should do what you want I assume though</p>



<a name="255578288"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/185405-t-compiler/rust-analyzer/topic/How%20to%20get%20name%20of%20top-level%20%60hir%3A%3AModule%60/near/255578288" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Aramis Razzaghipour <a href="https://zulip-archive.rust-lang.org/stream/185405-t-compiler/rust-analyzer/topic/How.20to.20get.20name.20of.20top-level.20.60hir.3A.3AModule.60.html#255578288">(Sep 30 2021 at 13:58)</a>:</h4>
<p>Would it be unreasonable to modify <code>hir::Module::name</code> to always return a <code>hir::Name </code>instead of an <code>Option&lt;hir::Name&gt;</code>, using the crate’s display name where appropriate?</p>



<a name="255579411"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/185405-t-compiler/rust-analyzer/topic/How%20to%20get%20name%20of%20top-level%20%60hir%3A%3AModule%60/near/255579411" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lukas Wirth <a href="https://zulip-archive.rust-lang.org/stream/185405-t-compiler/rust-analyzer/topic/How.20to.20get.20name.20of.20top-level.20.60hir.3A.3AModule.60.html#255579411">(Sep 30 2021 at 14:04)</a>:</h4>
<p>It would seem somewhat odd to me, as the root module isn't the same as the crate. Note that wouldn't get rid of the Option anyways as as the comment states, the display name can be absent as well</p>



<a name="255590083"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/185405-t-compiler/rust-analyzer/topic/How%20to%20get%20name%20of%20top-level%20%60hir%3A%3AModule%60/near/255590083" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Aramis Razzaghipour <a href="https://zulip-archive.rust-lang.org/stream/185405-t-compiler/rust-analyzer/topic/How.20to.20get.20name.20of.20top-level.20.60hir.3A.3AModule.60.html#255590083">(Sep 30 2021 at 15:05)</a>:</h4>
<p>Hmm, that is a good point. In any case, I realised that I was approaching the problem in the wrong way, and inspecting the textual name isn’t necessary. Thank you for the help, regardless!</p>



<hr><p>Last updated: Apr 12 2022 at 20:01 UTC</p>
</html>