<html>
<head><meta charset="utf-8"><title>lsif: Get canonical form of a token · t-compiler/rust-analyzer · Zulip Chat Archive</title></head>
<h2>Stream: <a href="https://zulip-archive.rust-lang.org/stream/185405-t-compiler/rust-analyzer/index.html">t-compiler/rust-analyzer</a></h2>
<h3>Topic: <a href="https://zulip-archive.rust-lang.org/stream/185405-t-compiler/rust-analyzer/topic/lsif.3A.20Get.20canonical.20form.20of.20a.20token.html">lsif: Get canonical form of a token</a></h3>

<hr>

<base href="https://rust-lang.zulipchat.com">

<head><link href="https://zulip-archive.rust-lang.org/style.css" rel="stylesheet"></head>

<a name="253742300"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/185405-t-compiler/rust-analyzer/topic/lsif%3A%20Get%20canonical%20form%20of%20a%20token/near/253742300" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> hkalbasi <a href="https://zulip-archive.rust-lang.org/stream/185405-t-compiler/rust-analyzer/topic/lsif.3A.20Get.20canonical.20form.20of.20a.20token.html#253742300">(Sep 17 2021 at 13:33)</a>:</h4>
<p>Equal tokens have equal result for hover, definition, references and such queries. So reusing them would be a win in emitting lsif, both in performance and output size.</p>
<p>What is the best way for achieving this? One way is to converting tokens to a canonical thing (for example Vec to ::std::vec::Vec, but it can be an internal id as well) and memoizing result based on it. Another way is calculating all references when reaching a token, and mark all usages of it as equal. Current finding reference for lsp search all files so I suspect this would become quadratic?</p>



<a name="253765714"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/185405-t-compiler/rust-analyzer/topic/lsif%3A%20Get%20canonical%20form%20of%20a%20token/near/253765714" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> hkalbasi <a href="https://zulip-archive.rust-lang.org/stream/185405-t-compiler/rust-analyzer/topic/lsif.3A.20Get.20canonical.20form.20of.20a.20token.html#253765714">(Sep 17 2021 at 16:07)</a>:</h4>
<p>Can <code>Definition</code> or <code>Local</code> act as such an id?</p>



<a name="253766823"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/185405-t-compiler/rust-analyzer/topic/lsif%3A%20Get%20canonical%20form%20of%20a%20token/near/253766823" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lukas Wirth <a href="https://zulip-archive.rust-lang.org/stream/185405-t-compiler/rust-analyzer/topic/lsif.3A.20Get.20canonical.20form.20of.20a.20token.html#253766823">(Sep 17 2021 at 16:15)</a>:</h4>
<p><code>Definition</code> and <code>Local</code> are backed by a unique ID yes</p>



<hr><p>Last updated: Apr 12 2022 at 20:01 UTC</p>
</html>