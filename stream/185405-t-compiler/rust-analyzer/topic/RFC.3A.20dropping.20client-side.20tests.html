<html>
<head><meta charset="utf-8"><title>RFC: dropping client-side tests · t-compiler/rust-analyzer · Zulip Chat Archive</title></head>
<h2>Stream: <a href="https://zulip-archive.rust-lang.org/stream/185405-t-compiler/rust-analyzer/index.html">t-compiler/rust-analyzer</a></h2>
<h3>Topic: <a href="https://zulip-archive.rust-lang.org/stream/185405-t-compiler/rust-analyzer/topic/RFC.3A.20dropping.20client-side.20tests.html">RFC: dropping client-side tests</a></h3>

<hr>

<base href="https://rust-lang.zulipchat.com">

<head><link href="https://zulip-archive.rust-lang.org/style.css" rel="stylesheet"></head>

<a name="258875946"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/185405-t-compiler/rust-analyzer/topic/RFC%3A%20dropping%20client-side%20tests/near/258875946" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Laurențiu <a href="https://zulip-archive.rust-lang.org/stream/185405-t-compiler/rust-analyzer/topic/RFC.3A.20dropping.20client-side.20tests.html#258875946">(Oct 24 2021 at 12:15)</a>:</h4>
<p>We have a couple of client-side tests (for runnables), but it feels like dealing with the npm ecosystem won't become any easier in the near future. <code>mocha</code> pulls in 77 dependencies including things like <a href="https://github.com/sindresorhus/has-flag/blob/main/index.js">https://github.com/sindresorhus/has-flag/blob/main/index.js</a>. How would y'all feel about removing those tests?</p>



<a name="258876082"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/185405-t-compiler/rust-analyzer/topic/RFC%3A%20dropping%20client-side%20tests/near/258876082" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Laurențiu <a href="https://zulip-archive.rust-lang.org/stream/185405-t-compiler/rust-analyzer/topic/RFC.3A.20dropping.20client-side.20tests.html#258876082">(Oct 24 2021 at 12:18)</a>:</h4>
<p><a href="/user_uploads/4715/5_R5Awf1yZoOkDwzPU1THa-S/image.png">image.png</a></p>
<div class="message_inline_image"><a href="/user_uploads/4715/5_R5Awf1yZoOkDwzPU1THa-S/image.png" title="image.png"><img src="/user_uploads/4715/5_R5Awf1yZoOkDwzPU1THa-S/image.png"></a></div>



<a name="258877030"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/185405-t-compiler/rust-analyzer/topic/RFC%3A%20dropping%20client-side%20tests/near/258877030" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Florian Diebold <a href="https://zulip-archive.rust-lang.org/stream/185405-t-compiler/rust-analyzer/topic/RFC.3A.20dropping.20client-side.20tests.html#258877030">(Oct 24 2021 at 12:41)</a>:</h4>
<p>if it's just about the test framework, maybe we can set up something minimal ourselves?</p>



<a name="258877074"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/185405-t-compiler/rust-analyzer/topic/RFC%3A%20dropping%20client-side%20tests/near/258877074" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Laurențiu <a href="https://zulip-archive.rust-lang.org/stream/185405-t-compiler/rust-analyzer/topic/RFC.3A.20dropping.20client-side.20tests.html#258877074">(Oct 24 2021 at 12:42)</a>:</h4>
<p>Yeah, we could also do that</p>



<a name="258938526"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/185405-t-compiler/rust-analyzer/topic/RFC%3A%20dropping%20client-side%20tests/near/258938526" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> matklad <a href="https://zulip-archive.rust-lang.org/stream/185405-t-compiler/rust-analyzer/topic/RFC.3A.20dropping.20client-side.20tests.html#258938526">(Oct 25 2021 at 10:05)</a>:</h4>
<p>No super-strong opinion here -- I don't feel these tests bring a lot of value, but I also don't find them actively harmful. I guess, my perference would be:</p>
<ul>
<li>replace mocha with our own minimal test framework to remove roadbblock for writing better tests in the future</li>
<li>reconsider how client-side testing is done overall. I have a gut feeling that we could benefit from a very-integrated tests, which opens a test project in VS Code and clicks around.</li>
</ul>



<a name="260698911"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/185405-t-compiler/rust-analyzer/topic/RFC%3A%20dropping%20client-side%20tests/near/260698911" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Anatol Ulrich <a href="https://zulip-archive.rust-lang.org/stream/185405-t-compiler/rust-analyzer/topic/RFC.3A.20dropping.20client-side.20tests.html#260698911">(Nov 08 2021 at 18:28)</a>:</h4>
<p>dependencies whose entire implementation is just a few lines is a bit par for the course in the npm world. That's what you get when you don't have a stdlib to speak of I'd say… in my book, generally there's little harm caused by that</p>
<p>FWIW, I've recently used <a href="https://github.com/avajs/ava">ava</a> which clocks in at "just" 60 deps and was quite a nice/lean setup + use experience.</p>



<a name="260704331"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/185405-t-compiler/rust-analyzer/topic/RFC%3A%20dropping%20client-side%20tests/near/260704331" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Laurențiu <a href="https://zulip-archive.rust-lang.org/stream/185405-t-compiler/rust-analyzer/topic/RFC.3A.20dropping.20client-side.20tests.html#260704331">(Nov 08 2021 at 19:11)</a>:</h4>
<p>I know it's common, and it's all fun and games until someone publishes a malicious <code>path-exists</code> package and you lose all your cookies, saved passwords and access tokens just because it's one of the 77 dependencies of the testing framework you've been using for 50 lines of tests that never failed and probably never will.</p>



<a name="260705972"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/185405-t-compiler/rust-analyzer/topic/RFC%3A%20dropping%20client-side%20tests/near/260705972" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Laurențiu <a href="https://zulip-archive.rust-lang.org/stream/185405-t-compiler/rust-analyzer/topic/RFC.3A.20dropping.20client-side.20tests.html#260705972">(Nov 08 2021 at 19:25)</a>:</h4>
<p>It would be fine if we had a fancy test suite, but <a href="https://github.com/rust-analyzer/rust-analyzer/blob/master/editors/code/tests/unit/launch_config.test.ts">these</a> are half of our tests.</p>



<a name="260736214"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/185405-t-compiler/rust-analyzer/topic/RFC%3A%20dropping%20client-side%20tests/near/260736214" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Anatol Ulrich <a href="https://zulip-archive.rust-lang.org/stream/185405-t-compiler/rust-analyzer/topic/RFC.3A.20dropping.20client-side.20tests.html#260736214">(Nov 08 2021 at 23:55)</a>:</h4>
<p><span class="user-mention silent" data-user-id="203546">Laurențiu</span> <a href="#narrow/stream/185405-t-compiler.2Frust-analyzer/topic/RFC.3A.20dropping.20client-side.20tests/near/260704331">said</a>:</p>
<blockquote>
<p>I know it's common, and it's all fun and games until someone publishes a malicious <code>path-exists</code> package </p>
</blockquote>
<p>I mean you <em>could</em> vendor it all, probably little risk from just freezing stuff in time (that said, personally I would not do this)</p>



<a name="260736219"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/185405-t-compiler/rust-analyzer/topic/RFC%3A%20dropping%20client-side%20tests/near/260736219" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Anatol Ulrich <a href="https://zulip-archive.rust-lang.org/stream/185405-t-compiler/rust-analyzer/topic/RFC.3A.20dropping.20client-side.20tests.html#260736219">(Nov 08 2021 at 23:55)</a>:</h4>
<p><span class="user-mention silent" data-user-id="203546">Laurențiu</span> <a href="#narrow/stream/185405-t-compiler.2Frust-analyzer/topic/RFC.3A.20dropping.20client-side.20tests/near/260705972">said</a>:</p>
<blockquote>
<p>It would be fine if we had a fancy test suite, but <a href="https://github.com/rust-analyzer/rust-analyzer/blob/master/editors/code/tests/unit/launch_config.test.ts">these</a> are half of our tests.</p>
</blockquote>
<p>fair&gt;</p>



<hr><p>Last updated: Apr 12 2022 at 20:01 UTC</p>
</html>