<html>
<head><meta charset="utf-8"><title>Doubts regarding adding a new module assist · t-compiler/rust-analyzer · Zulip Chat Archive</title></head>
<h2>Stream: <a href="https://zulip-archive.rust-lang.org/stream/185405-t-compiler/rust-analyzer/index.html">t-compiler/rust-analyzer</a></h2>
<h3>Topic: <a href="https://zulip-archive.rust-lang.org/stream/185405-t-compiler/rust-analyzer/topic/Doubts.20regarding.20adding.20a.20new.20module.20assist.html">Doubts regarding adding a new module assist</a></h3>

<hr>

<base href="https://rust-lang.zulipchat.com">

<head><link href="https://zulip-archive.rust-lang.org/style.css" rel="stylesheet"></head>

<a name="245946848"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/185405-t-compiler/rust-analyzer/topic/Doubts%20regarding%20adding%20a%20new%20module%20assist/near/245946848" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Fenil Jain <a href="https://zulip-archive.rust-lang.org/stream/185405-t-compiler/rust-analyzer/topic/Doubts.20regarding.20adding.20a.20new.20module.20assist.html#245946848">(Jul 14 2021 at 11:24)</a>:</h4>
<p>Hey everyone, I had a look at <a href="https://github.com/rust-analyzer/rust-analyzer/issues/9591">https://github.com/rust-analyzer/rust-analyzer/issues/9591</a> and would like to work on it. While thinking about the process I have a couple of doubts I want to get clarified:</p>
<ul>
<li>How will the assist get invoked? Issue mentions selection, but I have no idea if its possible, most other assists seem to use cursor position as the reference. If it possible, is there some guide? If not, where do we invoke it from(maybe from the struct/func def)?</li>
<li>On what node types can we invoke it? struct and function?</li>
<li>Lets say we are doing it for a struct, as mentioned in issue, will it mean taking all impl blocks of that struct(even from different files)?</li>
</ul>



<a name="245946994"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/185405-t-compiler/rust-analyzer/topic/Doubts%20regarding%20adding%20a%20new%20module%20assist/near/245946994" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jonas Schievink  [he/him] <a href="https://zulip-archive.rust-lang.org/stream/185405-t-compiler/rust-analyzer/topic/Doubts.20regarding.20adding.20a.20new.20module.20assist.html#245946994">(Jul 14 2021 at 11:26)</a>:</h4>
<p>"Extract type alias" uses the current selection</p>



<a name="245947044"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/185405-t-compiler/rust-analyzer/topic/Doubts%20regarding%20adding%20a%20new%20module%20assist/near/245947044" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jonas Schievink  [he/him] <a href="https://zulip-archive.rust-lang.org/stream/185405-t-compiler/rust-analyzer/topic/Doubts.20regarding.20adding.20a.20new.20module.20assist.html#245947044">(Jul 14 2021 at 11:27)</a>:</h4>
<p>the new assist should work on any collection of items, I think</p>



<a name="247849291"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/185405-t-compiler/rust-analyzer/topic/Doubts%20regarding%20adding%20a%20new%20module%20assist/near/247849291" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Fenil Jain <a href="https://zulip-archive.rust-lang.org/stream/185405-t-compiler/rust-analyzer/topic/Doubts.20regarding.20adding.20a.20new.20module.20assist.html#247849291">(Aug 01 2021 at 09:12)</a>:</h4>
<p>Hey, what could be the best way to rename a given struct/function/enum, etc. over all instances, I was trying to do it with to_def finding refs, and then trying to replace, but it seems to be a lot of work, I guessed I will confirm once.</p>



<a name="247851234"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/185405-t-compiler/rust-analyzer/topic/Doubts%20regarding%20adding%20a%20new%20module%20assist/near/247851234" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lukas Wirth <a href="https://zulip-archive.rust-lang.org/stream/185405-t-compiler/rust-analyzer/topic/Doubts.20regarding.20adding.20a.20new.20module.20assist.html#247851234">(Aug 01 2021 at 10:03)</a>:</h4>
<p>Yes, going with <code>to_def</code> and then finding references seems like the correct approach for this</p>



<a name="248592159"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/185405-t-compiler/rust-analyzer/topic/Doubts%20regarding%20adding%20a%20new%20module%20assist/near/248592159" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Fenil Jain <a href="https://zulip-archive.rust-lang.org/stream/185405-t-compiler/rust-analyzer/topic/Doubts.20regarding.20adding.20a.20new.20module.20assist.html#248592159">(Aug 06 2021 at 10:10)</a>:</h4>
<p>Hey, what could be the best way to resolving imports in this case. I would have to move/retain/duplicate imports according to the content selected for extraction in new module, so there could be references I would have to shift to new module, or keep in both, new module and container module. Any reference I could be guided to?</p>



<a name="248594993"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/185405-t-compiler/rust-analyzer/topic/Doubts%20regarding%20adding%20a%20new%20module%20assist/near/248594993" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lukas Wirth <a href="https://zulip-archive.rust-lang.org/stream/185405-t-compiler/rust-analyzer/topic/Doubts.20regarding.20adding.20a.20new.20module.20assist.html#248594993">(Aug 06 2021 at 10:34)</a>:</h4>
<p>Hmm, you probably want to do usage searches of all the items in your selection</p>



<a name="248595147"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/185405-t-compiler/rust-analyzer/topic/Doubts%20regarding%20adding%20a%20new%20module%20assist/near/248595147" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lukas Wirth <a href="https://zulip-archive.rust-lang.org/stream/185405-t-compiler/rust-analyzer/topic/Doubts.20regarding.20adding.20a.20new.20module.20assist.html#248595147">(Aug 06 2021 at 10:36)</a>:</h4>
<p>So basically you want to go through all NameRefs in your selection, turn them to hir nodes via <code>NameRefClass::classify</code>, then do <a href="https://github.com/rust-analyzer/rust-analyzer/blob/master/crates/ide_db/src/search.rs#L307">usage searches</a> on them with the file as a scope, that way you can check if you find imports in the current file, as well as whether this name ref is used outside of your selection</p>



<a name="248595167"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/185405-t-compiler/rust-analyzer/topic/Doubts%20regarding%20adding%20a%20new%20module%20assist/near/248595167" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lukas Wirth <a href="https://zulip-archive.rust-lang.org/stream/185405-t-compiler/rust-analyzer/topic/Doubts.20regarding.20adding.20a.20new.20module.20assist.html#248595167">(Aug 06 2021 at 10:36)</a>:</h4>
<p>Limiting the search to your file cna be done with <a href="https://github.com/rust-analyzer/rust-analyzer/blob/master/crates/ide_db/src/search.rs#L334-L336">https://github.com/rust-analyzer/rust-analyzer/blob/master/crates/ide_db/src/search.rs#L334-L336</a></p>



<a name="248595189"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/185405-t-compiler/rust-analyzer/topic/Doubts%20regarding%20adding%20a%20new%20module%20assist/near/248595189" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lukas Wirth <a href="https://zulip-archive.rust-lang.org/stream/185405-t-compiler/rust-analyzer/topic/Doubts.20regarding.20adding.20a.20new.20module.20assist.html#248595189">(Aug 06 2021 at 10:36)</a>:</h4>
<p>Similar thing can be applied to <code>Name</code>s since you would move those definitions you want to know what paths to fix up</p>



<a name="248835009"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/185405-t-compiler/rust-analyzer/topic/Doubts%20regarding%20adding%20a%20new%20module%20assist/near/248835009" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Fenil Jain <a href="https://zulip-archive.rust-lang.org/stream/185405-t-compiler/rust-analyzer/topic/Doubts.20regarding.20adding.20a.20new.20module.20assist.html#248835009">(Aug 09 2021 at 11:58)</a>:</h4>
<p>I have trying to implement what you said, there are some problems I am facing, this is one of my test-cases:</p>
<div class="codehilite" data-code-language="Rust"><pre><span></span><code><span class="w">                </span><span class="k">use</span><span class="w"> </span><span class="n">std</span>::<span class="n">collections</span>::<span class="n">HashMap</span><span class="p">;</span><span class="w"></span>

<span class="w">                </span><span class="k">pub</span><span class="w"> </span><span class="k">struct</span> <span class="nc">PublicStruct</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">                    </span><span class="n">field</span>: <span class="nc">PrivateStruct</span><span class="p">,</span><span class="w"></span>
<span class="w">                </span><span class="p">}</span><span class="w"></span>

<span class="w">                </span><span class="k">impl</span><span class="w"> </span><span class="n">PublicStruct</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">                    </span><span class="k">pub</span><span class="w"> </span><span class="k">fn</span> <span class="nf">new</span><span class="p">()</span><span class="w"> </span>-&gt; <span class="nc">Self</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">                        </span><span class="bp">Self</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="n">field</span>: <span class="nc">PrivateStruct</span>::<span class="n">new</span><span class="p">()</span><span class="w"> </span><span class="p">}</span><span class="w"></span>
<span class="w">                    </span><span class="p">}</span><span class="w"></span>
<span class="w">                </span><span class="p">}</span><span class="w"></span>

<span class="w">                </span><span class="k">fn</span> <span class="nf">foo</span><span class="p">()</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">                    </span><span class="kd">let</span><span class="w"> </span><span class="n">_s</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">PrivateStruct</span>::<span class="n">new</span><span class="p">();</span><span class="w"></span>
<span class="w">                    </span><span class="kd">let</span><span class="w"> </span><span class="n">_a</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bar</span><span class="p">();</span><span class="w"></span>
<span class="w">                </span><span class="p">}</span><span class="w"></span>

<span class="w">                </span><span class="cp">$</span><span class="mi">0</span><span class="w"></span>
<span class="w">                </span><span class="k">struct</span> <span class="nc">PrivateStruct</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">                    </span><span class="n">inner</span>: <span class="nc">HashMap</span><span class="o">&lt;</span><span class="kt">i32</span><span class="p">,</span><span class="w"> </span><span class="kt">i32</span><span class="o">&gt;</span><span class="p">,</span><span class="w"></span>
<span class="w">                </span><span class="p">}</span><span class="w"></span>

<span class="w">                </span><span class="k">pub</span><span class="w"> </span><span class="k">struct</span> <span class="nc">PrivateStruct1</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">                    </span><span class="k">pub</span><span class="w"> </span><span class="n">inner</span>: <span class="kt">i32</span><span class="p">,</span><span class="w"></span>
<span class="w">                </span><span class="p">}</span><span class="w"></span>

<span class="w">                </span><span class="k">impl</span><span class="w"> </span><span class="n">PrivateStruct</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">                    </span><span class="k">fn</span> <span class="nf">new</span><span class="p">()</span><span class="w"> </span>-&gt; <span class="nc">Self</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">                         </span><span class="n">PrivateStruct</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="n">inner</span>: <span class="nc">HashMap</span>::<span class="n">new</span><span class="p">()</span><span class="w"> </span><span class="p">}</span><span class="w"></span>
<span class="w">                    </span><span class="p">}</span><span class="w"></span>
<span class="w">                </span><span class="p">}</span><span class="w"></span>

<span class="w">                </span><span class="k">fn</span> <span class="nf">bar</span><span class="p">()</span><span class="w"> </span>-&gt; <span class="kt">i32</span> <span class="p">{</span><span class="w"></span>
<span class="w">                    </span><span class="mi">2</span><span class="w"></span>
<span class="w">                </span><span class="p">}</span><span class="w"></span>
<span class="w">                </span><span class="cp">$</span><span class="mi">0</span><span class="w"></span>
<span class="w">            </span><span class="p">}</span><span class="w"></span>
</code></pre></div>
<p>In this I want to detect and use HashMap, but it neither passes in Name::classify or NameRef::classify</p>
<p>Is there something I am doing wrong? Or there is some other way I should approach this?</p>



<a name="249024569"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/185405-t-compiler/rust-analyzer/topic/Doubts%20regarding%20adding%20a%20new%20module%20assist/near/249024569" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Fenil Jain <a href="https://zulip-archive.rust-lang.org/stream/185405-t-compiler/rust-analyzer/topic/Doubts.20regarding.20adding.20a.20new.20module.20assist.html#249024569">(Aug 10 2021 at 19:27)</a>:</h4>
<p>Sorry for the ping, <span class="user-mention" data-user-id="300586">@Lukas Wirth</span> any idea about this?</p>



<a name="249025143"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/185405-t-compiler/rust-analyzer/topic/Doubts%20regarding%20adding%20a%20new%20module%20assist/near/249025143" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lukas Wirth <a href="https://zulip-archive.rust-lang.org/stream/185405-t-compiler/rust-analyzer/topic/Doubts.20regarding.20adding.20a.20new.20module.20assist.html#249025143">(Aug 10 2021 at 19:31)</a>:</h4>
<p>Oh sorry I missed this, and don't worry, pinging me is fine</p>



<a name="249025256"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/185405-t-compiler/rust-analyzer/topic/Doubts%20regarding%20adding%20a%20new%20module%20assist/near/249025256" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lukas Wirth <a href="https://zulip-archive.rust-lang.org/stream/185405-t-compiler/rust-analyzer/topic/Doubts.20regarding.20adding.20a.20new.20module.20assist.html#249025256">(Aug 10 2021 at 19:32)</a>:</h4>
<p>test's do not have the std/core sources so HashMap doesn't exist in the test fixture here</p>



<a name="249025355"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/185405-t-compiler/rust-analyzer/topic/Doubts%20regarding%20adding%20a%20new%20module%20assist/near/249025355" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lukas Wirth <a href="https://zulip-archive.rust-lang.org/stream/185405-t-compiler/rust-analyzer/topic/Doubts.20regarding.20adding.20a.20new.20module.20assist.html#249025355">(Aug 10 2021 at 19:33)</a>:</h4>
<p>so instead you could just add a </p>
<div class="codehilite" data-code-language="Rust"><pre><span></span><code><span class="k">mod</span> <span class="nn">std</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="k">pub</span><span class="w"> </span><span class="k">mod</span> <span class="nn">collections</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">        </span><span class="k">pub</span><span class="w"> </span><span class="k">struct</span> <span class="nc">HashMap</span><span class="o">&lt;</span><span class="n">K</span><span class="p">,</span><span class="w"> </span><span class="n">V</span><span class="o">&gt;</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="p">}</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>
</code></pre></div>



<a name="249220722"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/185405-t-compiler/rust-analyzer/topic/Doubts%20regarding%20adding%20a%20new%20module%20assist/near/249220722" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Fenil Jain <a href="https://zulip-archive.rust-lang.org/stream/185405-t-compiler/rust-analyzer/topic/Doubts.20regarding.20adding.20a.20new.20module.20assist.html#249220722">(Aug 12 2021 at 11:06)</a>:</h4>
<p>Hey, so I have been looking at other import related code, I am still not 100% sure, what is the best way to get the complete use statement from a path/path segment. So after extracting path / path-segment from above method. I can surely remove them, but then I would also need to get the complete usetree till there(more precisely each path till given search path) so that I can place it in the new module. Is this the right way to approach this, or there could be something else?</p>



<a name="249224346"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/185405-t-compiler/rust-analyzer/topic/Doubts%20regarding%20adding%20a%20new%20module%20assist/near/249224346" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lukas Wirth <a href="https://zulip-archive.rust-lang.org/stream/185405-t-compiler/rust-analyzer/topic/Doubts.20regarding.20adding.20a.20new.20module.20assist.html#249224346">(Aug 12 2021 at 11:51)</a>:</h4>
<p>So basically you got a path segment in a use tree, and you want to reconstruct the actual path the segment is part of right?</p>



<a name="249224393"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/185405-t-compiler/rust-analyzer/topic/Doubts%20regarding%20adding%20a%20new%20module%20assist/near/249224393" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lukas Wirth <a href="https://zulip-archive.rust-lang.org/stream/185405-t-compiler/rust-analyzer/topic/Doubts.20regarding.20adding.20a.20new.20module.20assist.html#249224393">(Aug 12 2021 at 11:52)</a>:</h4>
<p>as in</p>
<div class="codehilite" data-code-language="Rust"><pre><span></span><code><span class="k">use</span><span class="w"> </span><span class="n">foo</span>::<span class="p">{</span><span class="n">bar</span>::<span class="p">{</span><span class="n">Baz</span><span class="p">}};</span><span class="w"></span>
</code></pre></div>
<p>You want to extract the path <code>foo::bar::Baz</code> for <code>Baz</code>?</p>



<a name="249225053"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/185405-t-compiler/rust-analyzer/topic/Doubts%20regarding%20adding%20a%20new%20module%20assist/near/249225053" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Fenil Jain <a href="https://zulip-archive.rust-lang.org/stream/185405-t-compiler/rust-analyzer/topic/Doubts.20regarding.20adding.20a.20new.20module.20assist.html#249225053">(Aug 12 2021 at 11:58)</a>:</h4>
<p>Yeah that's right, I also wanted to confirm if that's the right way, or I can do something else too....when I had a look at auto_import resolve they formed the ModPath and then called mod_path_to_ast to get this tree easily.</p>



<a name="249225707"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/185405-t-compiler/rust-analyzer/topic/Doubts%20regarding%20adding%20a%20new%20module%20assist/near/249225707" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lukas Wirth <a href="https://zulip-archive.rust-lang.org/stream/185405-t-compiler/rust-analyzer/topic/Doubts.20regarding.20adding.20a.20new.20module.20assist.html#249225707">(Aug 12 2021 at 12:05)</a>:</h4>
<p>Reconstructing the imports by walking the use tree up seems fine to me.</p>



<a name="249225774"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/185405-t-compiler/rust-analyzer/topic/Doubts%20regarding%20adding%20a%20new%20module%20assist/near/249225774" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lukas Wirth <a href="https://zulip-archive.rust-lang.org/stream/185405-t-compiler/rust-analyzer/topic/Doubts.20regarding.20adding.20a.20new.20module.20assist.html#249225774">(Aug 12 2021 at 12:06)</a>:</h4>
<p>But you can also try using <code>Module::find_use_path_prefixed</code> since you have the items you want to import</p>



<a name="249230575"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/185405-t-compiler/rust-analyzer/topic/Doubts%20regarding%20adding%20a%20new%20module%20assist/near/249230575" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Fenil Jain <a href="https://zulip-archive.rust-lang.org/stream/185405-t-compiler/rust-analyzer/topic/Doubts.20regarding.20adding.20a.20new.20module.20assist.html#249230575">(Aug 12 2021 at 12:56)</a>:</h4>
<p>Interestingly find_use_path_prefixed gives self::&lt;Type&gt;, most probably because it is already imported in the current module, and as the new module will be made after this(along with all other changes), there is no way to scope it to new module.</p>



<a name="249234320"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/185405-t-compiler/rust-analyzer/topic/Doubts%20regarding%20adding%20a%20new%20module%20assist/near/249234320" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lukas Wirth <a href="https://zulip-archive.rust-lang.org/stream/185405-t-compiler/rust-analyzer/topic/Doubts.20regarding.20adding.20a.20new.20module.20assist.html#249234320">(Aug 12 2021 at 13:27)</a>:</h4>
<p>(deleted)</p>



<a name="249234383"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/185405-t-compiler/rust-analyzer/topic/Doubts%20regarding%20adding%20a%20new%20module%20assist/near/249234383" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lukas Wirth <a href="https://zulip-archive.rust-lang.org/stream/185405-t-compiler/rust-analyzer/topic/Doubts.20regarding.20adding.20a.20new.20module.20assist.html#249234383">(Aug 12 2021 at 13:28)</a>:</h4>
<p>(deleted)</p>



<a name="249234428"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/185405-t-compiler/rust-analyzer/topic/Doubts%20regarding%20adding%20a%20new%20module%20assist/near/249234428" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lukas Wirth <a href="https://zulip-archive.rust-lang.org/stream/185405-t-compiler/rust-analyzer/topic/Doubts.20regarding.20adding.20a.20new.20module.20assist.html#249234428">(Aug 12 2021 at 13:28)</a>:</h4>
<p>Oh wait now I see what you mean</p>



<a name="249234445"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/185405-t-compiler/rust-analyzer/topic/Doubts%20regarding%20adding%20a%20new%20module%20assist/near/249234445" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lukas Wirth <a href="https://zulip-archive.rust-lang.org/stream/185405-t-compiler/rust-analyzer/topic/Doubts.20regarding.20adding.20a.20new.20module.20assist.html#249234445">(Aug 12 2021 at 13:28)</a>:</h4>
<p>Ye, that might make this not work then</p>



<a name="249360210"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/185405-t-compiler/rust-analyzer/topic/Doubts%20regarding%20adding%20a%20new%20module%20assist/near/249360210" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Fenil Jain <a href="https://zulip-archive.rust-lang.org/stream/185405-t-compiler/rust-analyzer/topic/Doubts.20regarding.20adding.20a.20new.20module.20assist.html#249360210">(Aug 13 2021 at 13:29)</a>:</h4>
<p>Hey, I got the import path from path keyword and now I was trying to remove that import for one of the usecases, so I found the range to remove and called builder.delete() but I get this: " assertion failed: check_disjoint(indels) ", any idea about it?</p>



<a name="249365573"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/185405-t-compiler/rust-analyzer/topic/Doubts%20regarding%20adding%20a%20new%20module%20assist/near/249365573" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lukas Wirth <a href="https://zulip-archive.rust-lang.org/stream/185405-t-compiler/rust-analyzer/topic/Doubts.20regarding.20adding.20a.20new.20module.20assist.html#249365573">(Aug 13 2021 at 14:16)</a>:</h4>
<p>that means the edits you are creating are overlapping</p>



<a name="249365671"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/185405-t-compiler/rust-analyzer/topic/Doubts%20regarding%20adding%20a%20new%20module%20assist/near/249365671" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lukas Wirth <a href="https://zulip-archive.rust-lang.org/stream/185405-t-compiler/rust-analyzer/topic/Doubts.20regarding.20adding.20a.20new.20module.20assist.html#249365671">(Aug 13 2021 at 14:17)</a>:</h4>
<p>basically you are trying to remove/replace a certain part of the source twice which isn't valid</p>



<a name="249452774"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/185405-t-compiler/rust-analyzer/topic/Doubts%20regarding%20adding%20a%20new%20module%20assist/near/249452774" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Fenil Jain <a href="https://zulip-archive.rust-lang.org/stream/185405-t-compiler/rust-analyzer/topic/Doubts.20regarding.20adding.20a.20new.20module.20assist.html#249452774">(Aug 14 2021 at 10:18)</a>:</h4>
<p>Hey, is there a way to change ast in place, to explain better, till now I have been changing visibility, resolving references and imports, without extracting the actual module. Now as I am trying to extract a new module, I got the the blockexpr as its body, but now instead of changing it in real code, I have to change this ast::BlockExpr, is this the right way to do it? If yes, how to do it?</p>



<a name="249452984"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/185405-t-compiler/rust-analyzer/topic/Doubts%20regarding%20adding%20a%20new%20module%20assist/near/249452984" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lukas Wirth <a href="https://zulip-archive.rust-lang.org/stream/185405-t-compiler/rust-analyzer/topic/Doubts.20regarding.20adding.20a.20new.20module.20assist.html#249452984">(Aug 14 2021 at 10:23)</a>:</h4>
<p>take a look at the <code>ted</code> module and hows its being used</p>



<a name="249453022"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/185405-t-compiler/rust-analyzer/topic/Doubts%20regarding%20adding%20a%20new%20module%20assist/near/249453022" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lukas Wirth <a href="https://zulip-archive.rust-lang.org/stream/185405-t-compiler/rust-analyzer/topic/Doubts.20regarding.20adding.20a.20new.20module.20assist.html#249453022">(Aug 14 2021 at 10:24)</a>:</h4>
<p>basically you can <code>clone_for_update</code> a node which gives you back a node you can modify</p>



<a name="249453110"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/185405-t-compiler/rust-analyzer/topic/Doubts%20regarding%20adding%20a%20new%20module%20assist/near/249453110" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lukas Wirth <a href="https://zulip-archive.rust-lang.org/stream/185405-t-compiler/rust-analyzer/topic/Doubts.20regarding.20adding.20a.20new.20module.20assist.html#249453110">(Aug 14 2021 at 10:26)</a>:</h4>
<p>Take a look at the <code>inline_call</code> assist which uses this to replace things inside the function body that is being inlined</p>



<a name="249453111"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/185405-t-compiler/rust-analyzer/topic/Doubts%20regarding%20adding%20a%20new%20module%20assist/near/249453111" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lukas Wirth <a href="https://zulip-archive.rust-lang.org/stream/185405-t-compiler/rust-analyzer/topic/Doubts.20regarding.20adding.20a.20new.20module.20assist.html#249453111">(Aug 14 2021 at 10:27)</a>:</h4>
<p>i think thats closest to what yo uwant right now</p>



<a name="249453160"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/185405-t-compiler/rust-analyzer/topic/Doubts%20regarding%20adding%20a%20new%20module%20assist/near/249453160" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Fenil Jain <a href="https://zulip-archive.rust-lang.org/stream/185405-t-compiler/rust-analyzer/topic/Doubts.20regarding.20adding.20a.20new.20module.20assist.html#249453160">(Aug 14 2021 at 10:28)</a>:</h4>
<p>I'll have a look, thnx :)</p>



<a name="249453946"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/185405-t-compiler/rust-analyzer/topic/Doubts%20regarding%20adding%20a%20new%20module%20assist/near/249453946" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Fenil Jain <a href="https://zulip-archive.rust-lang.org/stream/185405-t-compiler/rust-analyzer/topic/Doubts.20regarding.20adding.20a.20new.20module.20assist.html#249453946">(Aug 14 2021 at 10:51)</a>:</h4>
<div class="codehilite"><pre><span></span><code>the trait bound `syntax::ast::Visibility: Element` is not satisfied
the trait `Element` is not implemented for `syntax::ast::Visibility`
</code></pre></div>
<p>I wanted to change visibility for nodes, I checked other visibility assists too, I dont think they had any use of ted.</p>



<a name="249454791"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/185405-t-compiler/rust-analyzer/topic/Doubts%20regarding%20adding%20a%20new%20module%20assist/near/249454791" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lukas Wirth <a href="https://zulip-archive.rust-lang.org/stream/185405-t-compiler/rust-analyzer/topic/Doubts.20regarding.20adding.20a.20new.20module.20assist.html#249454791">(Aug 14 2021 at 11:13)</a>:</h4>
<p>only a few assists use <code>ted</code> currently as its a new api that got introduced a few months ago</p>



<a name="249454849"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/185405-t-compiler/rust-analyzer/topic/Doubts%20regarding%20adding%20a%20new%20module%20assist/near/249454849" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lukas Wirth <a href="https://zulip-archive.rust-lang.org/stream/185405-t-compiler/rust-analyzer/topic/Doubts.20regarding.20adding.20a.20new.20module.20assist.html#249454849">(Aug 14 2021 at 11:14)</a>:</h4>
<p>when using ted you usually have to call <code>syntax()</code> on the nodes you wanna replace as it works on <code>SyntaxNode</code>/<code>SyntaxToken</code> and not on the strictly typed syntax nodes</p>



<a name="249457638"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/185405-t-compiler/rust-analyzer/topic/Doubts%20regarding%20adding%20a%20new%20module%20assist/near/249457638" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Fenil Jain <a href="https://zulip-archive.rust-lang.org/stream/185405-t-compiler/rust-analyzer/topic/Doubts.20regarding.20adding.20a.20new.20module.20assist.html#249457638">(Aug 14 2021 at 12:29)</a>:</h4>
<p>Oh got it, my bad...</p>



<a name="249457879"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/185405-t-compiler/rust-analyzer/topic/Doubts%20regarding%20adding%20a%20new%20module%20assist/near/249457879" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lukas Wirth <a href="https://zulip-archive.rust-lang.org/stream/185405-t-compiler/rust-analyzer/topic/Doubts.20regarding.20adding.20a.20new.20module.20assist.html#249457879">(Aug 14 2021 at 12:35)</a>:</h4>
<p>Not your fault, I dont think we have that part documented too well yet, not sure</p>



<a name="249561097"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/185405-t-compiler/rust-analyzer/topic/Doubts%20regarding%20adding%20a%20new%20module%20assist/near/249561097" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Fenil Jain <a href="https://zulip-archive.rust-lang.org/stream/185405-t-compiler/rust-analyzer/topic/Doubts.20regarding.20adding.20a.20new.20module.20assist.html#249561097">(Aug 16 2021 at 08:22)</a>:</h4>
<p>Hey, I tried to get things work with ted, I looked around at another code and all, but couldnt figure out why there's no error but at the same time no update too.....I feel like I am doing some silly mistake, not sure.....if possible could u have a look here:</p>
<p>This is processing the ast::Struct part:<br>
<a href="https://github.com/feniljain/rust-analyzer/blob/a0c9662b7ee512c1a3ac0da53602c8c4c2f5e3fb/crates/ide_assists/src/handlers/extract_module.rs#L160-L188">https://github.com/feniljain/rust-analyzer/blob/a0c9662b7ee512c1a3ac0da53602c8c4c2f5e3fb/crates/ide_assists/src/handlers/extract_module.rs#L160-L188</a></p>
<p>And I am updating this visibility using ted over here:<br>
<a href="https://github.com/feniljain/rust-analyzer/blob/extract_module/crates/ide_assists/src/handlers/extract_module.rs#L601-L608">https://github.com/feniljain/rust-analyzer/blob/extract_module/crates/ide_assists/src/handlers/extract_module.rs#L601-L608</a></p>



<a name="249569223"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/185405-t-compiler/rust-analyzer/topic/Doubts%20regarding%20adding%20a%20new%20module%20assist/near/249569223" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lukas Wirth <a href="https://zulip-archive.rust-lang.org/stream/185405-t-compiler/rust-analyzer/topic/Doubts.20regarding.20adding.20a.20new.20module.20assist.html#249569223">(Aug 16 2021 at 10:00)</a>:</h4>
<p>Do you mean with <code>no update</code> that <code>println!("{:?}", node_kw.text());</code> isnt printing anything different?</p>



<a name="249569255"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/185405-t-compiler/rust-analyzer/topic/Doubts%20regarding%20adding%20a%20new%20module%20assist/near/249569255" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lukas Wirth <a href="https://zulip-archive.rust-lang.org/stream/185405-t-compiler/rust-analyzer/topic/Doubts.20regarding.20adding.20a.20new.20module.20assist.html#249569255">(Aug 16 2021 at 10:01)</a>:</h4>
<p>you are only printing the keywords text there, so that wont include the visibility mod</p>



<a name="249569438"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/185405-t-compiler/rust-analyzer/topic/Doubts%20regarding%20adding%20a%20new%20module%20assist/near/249569438" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Fenil Jain <a href="https://zulip-archive.rust-lang.org/stream/185405-t-compiler/rust-analyzer/topic/Doubts.20regarding.20adding.20a.20new.20module.20assist.html#249569438">(Aug 16 2021 at 10:02)</a>:</h4>
<p>Nope I meant they should show up when running test...</p>



<a name="249569892"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/185405-t-compiler/rust-analyzer/topic/Doubts%20regarding%20adding%20a%20new%20module%20assist/near/249569892" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lukas Wirth <a href="https://zulip-archive.rust-lang.org/stream/185405-t-compiler/rust-analyzer/topic/Doubts.20regarding.20adding.20a.20new.20module.20assist.html#249569892">(Aug 16 2021 at 10:07)</a>:</h4>
<p>Oh, you are <code>clone_for_update</code>ing the nodes you are modifying each instead of the top node if I see this correctly</p>



<a name="249569937"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/185405-t-compiler/rust-analyzer/topic/Doubts%20regarding%20adding%20a%20new%20module%20assist/near/249569937" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lukas Wirth <a href="https://zulip-archive.rust-lang.org/stream/185405-t-compiler/rust-analyzer/topic/Doubts.20regarding.20adding.20a.20new.20module.20assist.html#249569937">(Aug 16 2021 at 10:07)</a>:</h4>
<p>you want to <code>clone_for_update</code> the body <code>ast::BlockExpr</code> once, and then modify that/its children nodes</p>



<a name="249570011"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/185405-t-compiler/rust-analyzer/topic/Doubts%20regarding%20adding%20a%20new%20module%20assist/near/249570011" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lukas Wirth <a href="https://zulip-archive.rust-lang.org/stream/185405-t-compiler/rust-analyzer/topic/Doubts.20regarding.20adding.20a.20new.20module.20assist.html#249570011">(Aug 16 2021 at 10:08)</a>:</h4>
<p>if you <code>clone_for_update</code> the children you wont modify the block expr, just the freshly cloned children which you are discarding again</p>



<a name="249581509"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/185405-t-compiler/rust-analyzer/topic/Doubts%20regarding%20adding%20a%20new%20module%20assist/near/249581509" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Fenil Jain <a href="https://zulip-archive.rust-lang.org/stream/185405-t-compiler/rust-analyzer/topic/Doubts.20regarding.20adding.20a.20new.20module.20assist.html#249581509">(Aug 16 2021 at 12:27)</a>:</h4>
<p>yeah I tried that too, but ig last time I tried I did something wrong, so this time I resolved the imports firsts, then I took the body_stmts and converted it to body, and cloned it for update, then I sent a reference to that body and now I am using that. I get this error in the process:</p>
<p>thread 'handlers::extract_module::tests::test_extract_module' panicked at 'called <code>Option::unwrap()</code> on a <code>None</code> value', /home/feniljain/.cargo/registry/src/github.com-1ecc6299db9ec823/rowan-0.13.0-pre.7/src/cursor.rs:1226:64</p>
<p>It's not very helpful, do u have any idea about this?</p>



<a name="249581818"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/185405-t-compiler/rust-analyzer/topic/Doubts%20regarding%20adding%20a%20new%20module%20assist/near/249581818" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lukas Wirth <a href="https://zulip-archive.rust-lang.org/stream/185405-t-compiler/rust-analyzer/topic/Doubts.20regarding.20adding.20a.20new.20module.20assist.html#249581818">(Aug 16 2021 at 12:30)</a>:</h4>
<p>That panic indicates that you are iterating(or going through its children in some form) a node while mutating it which is a no go</p>



<a name="249581900"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/185405-t-compiler/rust-analyzer/topic/Doubts%20regarding%20adding%20a%20new%20module%20assist/near/249581900" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lukas Wirth <a href="https://zulip-archive.rust-lang.org/stream/185405-t-compiler/rust-analyzer/topic/Doubts.20regarding.20adding.20a.20new.20module.20assist.html#249581900">(Aug 16 2021 at 12:31)</a>:</h4>
<p>You can circumvent that problem by first fetching all nodes and their replacements and collecting those pairs into a vec, then do the actual replacement last by going through the vec</p>



<a name="249581913"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/185405-t-compiler/rust-analyzer/topic/Doubts%20regarding%20adding%20a%20new%20module%20assist/near/249581913" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lukas Wirth <a href="https://zulip-archive.rust-lang.org/stream/185405-t-compiler/rust-analyzer/topic/Doubts.20regarding.20adding.20a.20new.20module.20assist.html#249581913">(Aug 16 2021 at 12:31)</a>:</h4>
<p>most assist that run into that problem do it that way</p>



<a name="249582385"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/185405-t-compiler/rust-analyzer/topic/Doubts%20regarding%20adding%20a%20new%20module%20assist/near/249582385" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Laurențiu <a href="https://zulip-archive.rust-lang.org/stream/185405-t-compiler/rust-analyzer/topic/Doubts.20regarding.20adding.20a.20new.20module.20assist.html#249582385">(Aug 16 2021 at 12:36)</a>:</h4>
<p><code>cargo clippy -- -A clippy::all -W clippy::needless_collect</code> will show you those XD</p>



<a name="249583121"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/185405-t-compiler/rust-analyzer/topic/Doubts%20regarding%20adding%20a%20new%20module%20assist/near/249583121" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lukas Wirth <a href="https://zulip-archive.rust-lang.org/stream/185405-t-compiler/rust-analyzer/topic/Doubts.20regarding.20adding.20a.20new.20module.20assist.html#249583121">(Aug 16 2021 at 12:43)</a>:</h4>
<p>That worries me that those might get "fixed" by accident then <span aria-label="grimacing" class="emoji emoji-1f62c" role="img" title="grimacing">:grimacing:</span></p>



<a name="249732941"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/185405-t-compiler/rust-analyzer/topic/Doubts%20regarding%20adding%20a%20new%20module%20assist/near/249732941" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Fenil Jain <a href="https://zulip-archive.rust-lang.org/stream/185405-t-compiler/rust-analyzer/topic/Doubts.20regarding.20adding.20a.20new.20module.20assist.html#249732941">(Aug 17 2021 at 15:10)</a>:</h4>
<p>Let's say I clone the node which has to be operated upon, would the update still reflect?</p>



<a name="249733259"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/185405-t-compiler/rust-analyzer/topic/Doubts%20regarding%20adding%20a%20new%20module%20assist/near/249733259" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lukas Wirth <a href="https://zulip-archive.rust-lang.org/stream/185405-t-compiler/rust-analyzer/topic/Doubts.20regarding.20adding.20a.20new.20module.20assist.html#249733259">(Aug 17 2021 at 15:12)</a>:</h4>
<p>Yes basically, if you <code>clone_for_update</code> a node then modifications on its children will be reflected in this original node</p>



<a name="249733328"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/185405-t-compiler/rust-analyzer/topic/Doubts%20regarding%20adding%20a%20new%20module%20assist/near/249733328" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lukas Wirth <a href="https://zulip-archive.rust-lang.org/stream/185405-t-compiler/rust-analyzer/topic/Doubts.20regarding.20adding.20a.20new.20module.20assist.html#249733328">(Aug 17 2021 at 15:13)</a>:</h4>
<p>So <code>clone</code>-ing a node that has been <code>clone_for_update</code>d will still be linked to this mutable clone just fine</p>



<a name="249733429"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/185405-t-compiler/rust-analyzer/topic/Doubts%20regarding%20adding%20a%20new%20module%20assist/near/249733429" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Fenil Jain <a href="https://zulip-archive.rust-lang.org/stream/185405-t-compiler/rust-analyzer/topic/Doubts.20regarding.20adding.20a.20new.20module.20assist.html#249733429">(Aug 17 2021 at 15:14)</a>:</h4>
<p>I meant cloning it before clone_for_update</p>



<a name="249733492"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/185405-t-compiler/rust-analyzer/topic/Doubts%20regarding%20adding%20a%20new%20module%20assist/near/249733492" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lukas Wirth <a href="https://zulip-archive.rust-lang.org/stream/185405-t-compiler/rust-analyzer/topic/Doubts.20regarding.20adding.20a.20new.20module.20assist.html#249733492">(Aug 17 2021 at 15:14)</a>:</h4>
<p>if you clone a node and then do <code>clone_for_update</code> then only the clone will reflect the changes</p>



<a name="249733516"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/185405-t-compiler/rust-analyzer/topic/Doubts%20regarding%20adding%20a%20new%20module%20assist/near/249733516" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lukas Wirth <a href="https://zulip-archive.rust-lang.org/stream/185405-t-compiler/rust-analyzer/topic/Doubts.20regarding.20adding.20a.20new.20module.20assist.html#249733516">(Aug 17 2021 at 15:15)</a>:</h4>
<p>the original will still be an immutable version</p>



<a name="249734322"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/185405-t-compiler/rust-analyzer/topic/Doubts%20regarding%20adding%20a%20new%20module%20assist/near/249734322" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Fenil Jain <a href="https://zulip-archive.rust-lang.org/stream/185405-t-compiler/rust-analyzer/topic/Doubts.20regarding.20adding.20a.20new.20module.20assist.html#249734322">(Aug 17 2021 at 15:21)</a>:</h4>
<p>Umm...okay maybe help me through this, so you said, you can collect the nodes you want to operate on and then do ted modifications on them right? That means taking references <code>&amp;SyntaxNode</code> in a vec and then <code>clone_for_update</code> the <code>BlockExpr</code>, after this go over the vec and apply the ted operation right?</p>



<a name="249735650"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/185405-t-compiler/rust-analyzer/topic/Doubts%20regarding%20adding%20a%20new%20module%20assist/near/249735650" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lukas Wirth <a href="https://zulip-archive.rust-lang.org/stream/185405-t-compiler/rust-analyzer/topic/Doubts.20regarding.20adding.20a.20new.20module.20assist.html#249735650">(Aug 17 2021 at 15:30)</a>:</h4>
<p>You want to <code>clone_for_update</code> the node you wanna modify first, then collect the children and their replacements of that node, after collecting them all you <em>then</em> want to apply the replacements via <code>ted</code></p>



<a name="249735751"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/185405-t-compiler/rust-analyzer/topic/Doubts%20regarding%20adding%20a%20new%20module%20assist/near/249735751" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lukas Wirth <a href="https://zulip-archive.rust-lang.org/stream/185405-t-compiler/rust-analyzer/topic/Doubts.20regarding.20adding.20a.20new.20module.20assist.html#249735751">(Aug 17 2021 at 15:31)</a>:</h4>
<p><a href="https://github.com/rust-analyzer/rust-analyzer/blob/master/crates/ide_assists/src/handlers/convert_bool_then.rs#L37-L106">https://github.com/rust-analyzer/rust-analyzer/blob/master/crates/ide_assists/src/handlers/convert_bool_then.rs#L37-L106</a></p>



<a name="249735778"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/185405-t-compiler/rust-analyzer/topic/Doubts%20regarding%20adding%20a%20new%20module%20assist/near/249735778" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lukas Wirth <a href="https://zulip-archive.rust-lang.org/stream/185405-t-compiler/rust-analyzer/topic/Doubts.20regarding.20adding.20a.20new.20module.20assist.html#249735778">(Aug 17 2021 at 15:31)</a>:</h4>
<p>See that assist for an example</p>



<a name="249735919"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/185405-t-compiler/rust-analyzer/topic/Doubts%20regarding%20adding%20a%20new%20module%20assist/near/249735919" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lukas Wirth <a href="https://zulip-archive.rust-lang.org/stream/185405-t-compiler/rust-analyzer/topic/Doubts.20regarding.20adding.20a.20new.20module.20assist.html#249735919">(Aug 17 2021 at 15:32)</a>:</h4>
<p>It first <code>clone_for_update</code>s the expression(<code>closure_body</code>), then iterates over it collecting the replacement pairs and after doing so it applies them all.</p>



<a name="249740051"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/185405-t-compiler/rust-analyzer/topic/Doubts%20regarding%20adding%20a%20new%20module%20assist/near/249740051" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Fenil Jain <a href="https://zulip-archive.rust-lang.org/stream/185405-t-compiler/rust-analyzer/topic/Doubts.20regarding.20adding.20a.20new.20module.20assist.html#249740051">(Aug 17 2021 at 16:02)</a>:</h4>
<p>Yup got it, I understood it wrong first time, thnx a lot <span aria-label="raised hands" class="emoji emoji-1f64c" role="img" title="raised hands">:raised_hands:</span></p>



<a name="249773208"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/185405-t-compiler/rust-analyzer/topic/Doubts%20regarding%20adding%20a%20new%20module%20assist/near/249773208" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Fenil Jain <a href="https://zulip-archive.rust-lang.org/stream/185405-t-compiler/rust-analyzer/topic/Doubts.20regarding.20adding.20a.20new.20module.20assist.html#249773208">(Aug 17 2021 at 20:16)</a>:</h4>
<p><a href="https://github.com/rust-analyzer/rust-analyzer/pull/9939">https://github.com/rust-analyzer/rust-analyzer/pull/9939</a></p>



<a name="249833463"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/185405-t-compiler/rust-analyzer/topic/Doubts%20regarding%20adding%20a%20new%20module%20assist/near/249833463" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Fenil Jain <a href="https://zulip-archive.rust-lang.org/stream/185405-t-compiler/rust-analyzer/topic/Doubts.20regarding.20adding.20a.20new.20module.20assist.html#249833463">(Aug 18 2021 at 11:01)</a>:</h4>
<p><span class="user-mention" data-user-id="300586">@Lukas Wirth</span>  In PR comments you were suggesting me to use ItemList instead of BlockExpr right?</p>



<a name="249833601"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/185405-t-compiler/rust-analyzer/topic/Doubts%20regarding%20adding%20a%20new%20module%20assist/near/249833601" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lukas Wirth <a href="https://zulip-archive.rust-lang.org/stream/185405-t-compiler/rust-analyzer/topic/Doubts.20regarding.20adding.20a.20new.20module.20assist.html#249833601">(Aug 18 2021 at 11:02)</a>:</h4>
<p>Either that or you keep the items in a vec instead, something similar to how its done in extract_function <br>
<a href="https://github.com/rust-analyzer/rust-analyzer/blob/master/crates/ide_assists/src/handlers/extract_function.rs#L283-L287">https://github.com/rust-analyzer/rust-analyzer/blob/master/crates/ide_assists/src/handlers/extract_function.rs#L283-L287</a><br>
<a href="https://github.com/rust-analyzer/rust-analyzer/blob/master/crates/ide_assists/src/handlers/extract_function.rs#L145-L169">https://github.com/rust-analyzer/rust-analyzer/blob/master/crates/ide_assists/src/handlers/extract_function.rs#L145-L169</a></p>



<a name="249833618"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/185405-t-compiler/rust-analyzer/topic/Doubts%20regarding%20adding%20a%20new%20module%20assist/near/249833618" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lukas Wirth <a href="https://zulip-archive.rust-lang.org/stream/185405-t-compiler/rust-analyzer/topic/Doubts.20regarding.20adding.20a.20new.20module.20assist.html#249833618">(Aug 18 2021 at 11:03)</a>:</h4>
<p>where BlockExpr would be ItemList for you</p>



<a name="249833650"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/185405-t-compiler/rust-analyzer/topic/Doubts%20regarding%20adding%20a%20new%20module%20assist/near/249833650" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lukas Wirth <a href="https://zulip-archive.rust-lang.org/stream/185405-t-compiler/rust-analyzer/topic/Doubts.20regarding.20adding.20a.20new.20module.20assist.html#249833650">(Aug 18 2021 at 11:03)</a>:</h4>
<p>and a Statement/Expression is an Item for you</p>



<a name="252131132"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/185405-t-compiler/rust-analyzer/topic/Doubts%20regarding%20adding%20a%20new%20module%20assist/near/252131132" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Fenil Jain <a href="https://zulip-archive.rust-lang.org/stream/185405-t-compiler/rust-analyzer/topic/Doubts.20regarding.20adding.20a.20new.20module.20assist.html#252131132">(Sep 06 2021 at 06:13)</a>:</h4>
<p>Hey, sorry I had to go on a hiatus due to personal reasons, I started to work on this again, I have made all the changes suggested on PR, while completing that process I noticed a few import related issues, I am currently trying to fix them, and in one of the tests I am trying to get usages of a trait-bound in new module, with its definition in main module, does usages not consider its trait definition, coz I am not able to get it in .usages()</p>



<a name="253400702"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/185405-t-compiler/rust-analyzer/topic/Doubts%20regarding%20adding%20a%20new%20module%20assist/near/253400702" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Fenil Jain <a href="https://zulip-archive.rust-lang.org/stream/185405-t-compiler/rust-analyzer/topic/Doubts.20regarding.20adding.20a.20new.20module.20assist.html#253400702">(Sep 15 2021 at 11:55)</a>:</h4>
<p>Hey <span class="user-mention" data-user-id="300586">@Lukas Wirth</span> as you are back now, maybe any ideas on this?</p>



<a name="253401843"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/185405-t-compiler/rust-analyzer/topic/Doubts%20regarding%20adding%20a%20new%20module%20assist/near/253401843" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lukas Wirth <a href="https://zulip-archive.rust-lang.org/stream/185405-t-compiler/rust-analyzer/topic/Doubts.20regarding.20adding.20a.20new.20module.20assist.html#253401843">(Sep 15 2021 at 12:03)</a>:</h4>
<p>Will take a look, gotta refresh my memory of this first</p>



<a name="253404721"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/185405-t-compiler/rust-analyzer/topic/Doubts%20regarding%20adding%20a%20new%20module%20assist/near/253404721" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lukas Wirth <a href="https://zulip-archive.rust-lang.org/stream/185405-t-compiler/rust-analyzer/topic/Doubts.20regarding.20adding.20a.20new.20module.20assist.html#253404721">(Sep 15 2021 at 12:28)</a>:</h4>
<p>Ah I see, usages only gives you back the, well, usages of something</p>



<a name="253404729"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/185405-t-compiler/rust-analyzer/topic/Doubts%20regarding%20adding%20a%20new%20module%20assist/near/253404729" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lukas Wirth <a href="https://zulip-archive.rust-lang.org/stream/185405-t-compiler/rust-analyzer/topic/Doubts.20regarding.20adding.20a.20new.20module.20assist.html#253404729">(Sep 15 2021 at 12:28)</a>:</h4>
<p>to get the definition source</p>



<a name="253404756"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/185405-t-compiler/rust-analyzer/topic/Doubts%20regarding%20adding%20a%20new%20module%20assist/near/253404756" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lukas Wirth <a href="https://zulip-archive.rust-lang.org/stream/185405-t-compiler/rust-analyzer/topic/Doubts.20regarding.20adding.20a.20new.20module.20assist.html#253404756">(Sep 15 2021 at 12:28)</a>:</h4>
<p>you need to go through the the HasSource trait, one moment</p>



<a name="253404801"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/185405-t-compiler/rust-analyzer/topic/Doubts%20regarding%20adding%20a%20new%20module%20assist/near/253404801" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lukas Wirth <a href="https://zulip-archive.rust-lang.org/stream/185405-t-compiler/rust-analyzer/topic/Doubts.20regarding.20adding.20a.20new.20module.20assist.html#253404801">(Sep 15 2021 at 12:28)</a>:</h4>
<p>This here, <a href="https://github.com/rust-analyzer/rust-analyzer/blob/master/crates/hir/src/has_source.rs#L17-L20">https://github.com/rust-analyzer/rust-analyzer/blob/master/crates/hir/src/has_source.rs#L17-L20</a></p>



<a name="253404903"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/185405-t-compiler/rust-analyzer/topic/Doubts%20regarding%20adding%20a%20new%20module%20assist/near/253404903" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lukas Wirth <a href="https://zulip-archive.rust-lang.org/stream/185405-t-compiler/rust-analyzer/topic/Doubts.20regarding.20adding.20a.20new.20module.20assist.html#253404903">(Sep 15 2021 at 12:29)</a>:</h4>
<p>so if you got a definition <code>def</code>, you can get its usages via <code>def.usages().all()</code> while getting the source ast via <code>def.source()</code></p>



<a name="253407570"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/185405-t-compiler/rust-analyzer/topic/Doubts%20regarding%20adding%20a%20new%20module%20assist/near/253407570" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Fenil Jain <a href="https://zulip-archive.rust-lang.org/stream/185405-t-compiler/rust-analyzer/topic/Doubts.20regarding.20adding.20a.20new.20module.20assist.html#253407570">(Sep 15 2021 at 12:52)</a>:</h4>
<p>Oh I see, I assumed that part wrong, cool got it.</p>



<a name="253456153"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/185405-t-compiler/rust-analyzer/topic/Doubts%20regarding%20adding%20a%20new%20module%20assist/near/253456153" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Fenil Jain <a href="https://zulip-archive.rust-lang.org/stream/185405-t-compiler/rust-analyzer/topic/Doubts.20regarding.20adding.20a.20new.20module.20assist.html#253456153">(Sep 15 2021 at 17:36)</a>:</h4>
<p>Okay so the Definition does not have HasSource trait implement upon, to give some context on what I am doing, this is a part of import resolve, I go over each name and nameref in selected region(new module), then I find usages to understand if it's references exist outside and inside module, and then act upon imports individually, like adding a super import or reconstructing import  from use stmt. What could be the best approach in this situation?</p>



<a name="253457095"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/185405-t-compiler/rust-analyzer/topic/Doubts%20regarding%20adding%20a%20new%20module%20assist/near/253457095" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lukas Wirth <a href="https://zulip-archive.rust-lang.org/stream/185405-t-compiler/rust-analyzer/topic/Doubts.20regarding.20adding.20a.20new.20module.20assist.html#253457095">(Sep 15 2021 at 17:42)</a>:</h4>
<p>So you want to figure out in what module a definition lives in?</p>



<a name="253460373"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/185405-t-compiler/rust-analyzer/topic/Doubts%20regarding%20adding%20a%20new%20module%20assist/near/253460373" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Fenil Jain <a href="https://zulip-archive.rust-lang.org/stream/185405-t-compiler/rust-analyzer/topic/Doubts.20regarding.20adding.20a.20new.20module.20assist.html#253460373">(Sep 15 2021 at 18:01)</a>:</h4>
<p>Yeah, but while analyzing it would still have not changed to new module so we will always get the same parent module.</p>



<a name="253461171"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/185405-t-compiler/rust-analyzer/topic/Doubts%20regarding%20adding%20a%20new%20module%20assist/near/253461171" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lukas Wirth <a href="https://zulip-archive.rust-lang.org/stream/185405-t-compiler/rust-analyzer/topic/Doubts.20regarding.20adding.20a.20new.20module.20assist.html#253461171">(Sep 15 2021 at 18:06)</a>:</h4>
<p>I don't think I follow, but don't you know where you are moving the things?</p>



<a name="253461320"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/185405-t-compiler/rust-analyzer/topic/Doubts%20regarding%20adding%20a%20new%20module%20assist/near/253461320" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lukas Wirth <a href="https://zulip-archive.rust-lang.org/stream/185405-t-compiler/rust-analyzer/topic/Doubts.20regarding.20adding.20a.20new.20module.20assist.html#253461320">(Sep 15 2021 at 18:07)</a>:</h4>
<p>Basically, you know that every definition you extract will move location into this new module, so that means you have to adjust all paths pointing to the item by inserting the module into the paths</p>



<a name="253461332"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/185405-t-compiler/rust-analyzer/topic/Doubts%20regarding%20adding%20a%20new%20module%20assist/near/253461332" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lukas Wirth <a href="https://zulip-archive.rust-lang.org/stream/185405-t-compiler/rust-analyzer/topic/Doubts.20regarding.20adding.20a.20new.20module.20assist.html#253461332">(Sep 15 2021 at 18:07)</a>:</h4>
<p>Or am I missing something here</p>



<a name="253463753"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/185405-t-compiler/rust-analyzer/topic/Doubts%20regarding%20adding%20a%20new%20module%20assist/near/253463753" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Fenil Jain <a href="https://zulip-archive.rust-lang.org/stream/185405-t-compiler/rust-analyzer/topic/Doubts.20regarding.20adding.20a.20new.20module.20assist.html#253463753">(Sep 15 2021 at 18:24)</a>:</h4>
<p>Hmmm...shall I just force-push on the PR? Most tests are failing due to indentation issue nothing more, I can then explain better maybe, with direct code extracts and tests itself......</p>



<a name="253465352"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/185405-t-compiler/rust-analyzer/topic/Doubts%20regarding%20adding%20a%20new%20module%20assist/near/253465352" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lukas Wirth <a href="https://zulip-archive.rust-lang.org/stream/185405-t-compiler/rust-analyzer/topic/Doubts.20regarding.20adding.20a.20new.20module.20assist.html#253465352">(Sep 15 2021 at 18:34)</a>:</h4>
<p>sure</p>



<a name="253470090"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/185405-t-compiler/rust-analyzer/topic/Doubts%20regarding%20adding%20a%20new%20module%20assist/near/253470090" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Fenil Jain <a href="https://zulip-archive.rust-lang.org/stream/185405-t-compiler/rust-analyzer/topic/Doubts.20regarding.20adding.20a.20new.20module.20assist.html#253470090">(Sep 15 2021 at 19:05)</a>:</h4>
<p>This is the test which I need to pass: <a href="https://github.com/rust-analyzer/rust-analyzer/blob/b3f174df1d03878fec8fb9af35bbc04ab2caaa04/crates/ide_assists/src/handlers/extract_module.rs#L1266-L1312">https://github.com/rust-analyzer/rust-analyzer/blob/b3f174df1d03878fec8fb9af35bbc04ab2caaa04/crates/ide_assists/src/handlers/extract_module.rs#L1266-L1312</a></p>
<p>Over here I will explain the problem, so inside selection it checks all name and namerefs for import resolution, it reaches JustATrait now I need to find its usages + source to check if it exists inside and outside module, the explanation for it is here: <a href="https://github.com/rust-analyzer/rust-analyzer/blob/b3f174df1d03878fec8fb9af35bbc04ab2caaa04/crates/ide_assists/src/handlers/extract_module.rs#L1266-L1312">https://github.com/rust-analyzer/rust-analyzer/blob/b3f174df1d03878fec8fb9af35bbc04ab2caaa04/crates/ide_assists/src/handlers/extract_module.rs#L1266-L1312</a></p>
<p>Now in this function: <a href="https://github.com/rust-analyzer/rust-analyzer/blob/b3f174df1d03878fec8fb9af35bbc04ab2caaa04/crates/ide_assists/src/handlers/extract_module.rs#L488">https://github.com/rust-analyzer/rust-analyzer/blob/b3f174df1d03878fec8fb9af35bbc04ab2caaa04/crates/ide_assists/src/handlers/extract_module.rs#L488</a>,  I get definitions and then I do usage search on them, I want to perform source search too, which currently isnt possible.....</p>



<a name="253498804"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/185405-t-compiler/rust-analyzer/topic/Doubts%20regarding%20adding%20a%20new%20module%20assist/near/253498804" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lukas Wirth <a href="https://zulip-archive.rust-lang.org/stream/185405-t-compiler/rust-analyzer/topic/Doubts.20regarding.20adding.20a.20new.20module.20assist.html#253498804">(Sep 15 2021 at 22:38)</a>:</h4>
<p>I don't understand what a source search is supposed to be, you can get the definition via the <code>HasSource</code> trait, which yes isnt implemented on definition, but on the things inside the definition enum</p>



<a name="253499278"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/185405-t-compiler/rust-analyzer/topic/Doubts%20regarding%20adding%20a%20new%20module%20assist/near/253499278" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lukas Wirth <a href="https://zulip-archive.rust-lang.org/stream/185405-t-compiler/rust-analyzer/topic/Doubts.20regarding.20adding.20a.20new.20module.20assist.html#253499278">(Sep 15 2021 at 22:42)</a>:</h4>
<p>So if I see this right the problem you are having right now is figuring out the difference between a defs module and the module your extracting in right now? For the def you can just fetch it by calling <code>module</code> on it, for the other one you wanna do <code>sema.scope(node).module()</code> where node is some node of the things you are extracting</p>



<a name="253499764"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/185405-t-compiler/rust-analyzer/topic/Doubts%20regarding%20adding%20a%20new%20module%20assist/near/253499764" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lukas Wirth <a href="https://zulip-archive.rust-lang.org/stream/185405-t-compiler/rust-analyzer/topic/Doubts.20regarding.20adding.20a.20new.20module.20assist.html#253499764">(Sep 15 2021 at 22:46)</a>:</h4>
<p>Similarly if the modules do not differ, then you can fetch the source of the definition and check its text range, if its inside the selection then you are extracting the definition into the new module, if not then you aren't</p>



<a name="255194176"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/185405-t-compiler/rust-analyzer/topic/Doubts%20regarding%20adding%20a%20new%20module%20assist/near/255194176" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Fenil Jain <a href="https://zulip-archive.rust-lang.org/stream/185405-t-compiler/rust-analyzer/topic/Doubts.20regarding.20adding.20a.20new.20module.20assist.html#255194176">(Sep 28 2021 at 10:31)</a>:</h4>
<p>I have pushed the code with all the mentioned changes, I have added testcases, and different comments too. Do let me know if there are any changes you find suitable.</p>



<a name="255940809"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/185405-t-compiler/rust-analyzer/topic/Doubts%20regarding%20adding%20a%20new%20module%20assist/near/255940809" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Fenil Jain <a href="https://zulip-archive.rust-lang.org/stream/185405-t-compiler/rust-analyzer/topic/Doubts.20regarding.20adding.20a.20new.20module.20assist.html#255940809">(Oct 03 2021 at 10:14)</a>:</h4>
<p>Hey <span class="user-mention" data-user-id="300586">@Lukas Wirth</span>, I just saw you self-assigned the issue, I wanted to know if you already began working on it? Coz I have refactored considerable amount, and would like to know if I could push that?</p>



<a name="255940860"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/185405-t-compiler/rust-analyzer/topic/Doubts%20regarding%20adding%20a%20new%20module%20assist/near/255940860" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lukas Wirth <a href="https://zulip-archive.rust-lang.org/stream/185405-t-compiler/rust-analyzer/topic/Doubts.20regarding.20adding.20a.20new.20module.20assist.html#255940860">(Oct 03 2021 at 10:15)</a>:</h4>
<p>Feel free to push it, I did work a bit on it to familiarize myself with the idea of what the assist has to do but that is not connected to your PR directly</p>



<a name="255941138"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/185405-t-compiler/rust-analyzer/topic/Doubts%20regarding%20adding%20a%20new%20module%20assist/near/255941138" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Fenil Jain <a href="https://zulip-archive.rust-lang.org/stream/185405-t-compiler/rust-analyzer/topic/Doubts.20regarding.20adding.20a.20new.20module.20assist.html#255941138">(Oct 03 2021 at 10:20)</a>:</h4>
<p>Nice, please allow me to do it by the end of day, I am in middle of refactoring something in that.</p>



<a name="255941602"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/185405-t-compiler/rust-analyzer/topic/Doubts%20regarding%20adding%20a%20new%20module%20assist/near/255941602" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lukas Wirth <a href="https://zulip-archive.rust-lang.org/stream/185405-t-compiler/rust-analyzer/topic/Doubts.20regarding.20adding.20a.20new.20module.20assist.html#255941602">(Oct 03 2021 at 10:28)</a>:</h4>
<p>Take your time</p>



<a name="257154329"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/185405-t-compiler/rust-analyzer/topic/Doubts%20regarding%20adding%20a%20new%20module%20assist/near/257154329" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Fenil Jain <a href="https://zulip-archive.rust-lang.org/stream/185405-t-compiler/rust-analyzer/topic/Doubts.20regarding.20adding.20a.20new.20module.20assist.html#257154329">(Oct 12 2021 at 06:10)</a>:</h4>
<p>I had a small doubt while applying the changes mentioned here:</p>
<p><a href="https://github.com/rust-analyzer/rust-analyzer/pull/9939#discussion_r726108882">https://github.com/rust-analyzer/rust-analyzer/pull/9939#discussion_r726108882</a></p>
<p>So<code> field_list()</code> isnt a common method among ADT members and I wanted a simple reusable piece for ADT and that's why I used descendants to lower into the ast in search of <code>RecordFields</code>, should I just change it for all cases like, using <code>field_list()</code> and <code>record_field_list()</code> for respective members or it's okay to continue with <code>descendants()</code>?</p>



<a name="257156951"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/185405-t-compiler/rust-analyzer/topic/Doubts%20regarding%20adding%20a%20new%20module%20assist/near/257156951" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lukas Wirth <a href="https://zulip-archive.rust-lang.org/stream/185405-t-compiler/rust-analyzer/topic/Doubts.20regarding.20adding.20a.20new.20module.20assist.html#257156951">(Oct 12 2021 at 06:48)</a>:</h4>
<p>I'd say swap to the field list functions, note that currently your code only handles <code>RecordFields</code> and not <code>TupleFields</code> which it should anyways. You can just pass them around in an <code>Either&lt;ast::RecordField, ast::TupleField&gt;</code> or cast them back to <code>SyntaxNode</code> if that makes things simpler.</p>



<a name="257176681"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/185405-t-compiler/rust-analyzer/topic/Doubts%20regarding%20adding%20a%20new%20module%20assist/near/257176681" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Fenil Jain <a href="https://zulip-archive.rust-lang.org/stream/185405-t-compiler/rust-analyzer/topic/Doubts.20regarding.20adding.20a.20new.20module.20assist.html#257176681">(Oct 12 2021 at 09:52)</a>:</h4>
<p>Hey, I pushed the changes, but I think as I was amending the og commit every time till now and now I made new commits and pushed it, the commits between this duration got included too, I tried to cherry pick these commits in a new branch and force-push to the existing one, so that I could have the commits I made, only in the PR, but It stated: "everything up to date" during that, and now I am confused what can I possibly do it fix it, any ideas regarding same?</p>



<a name="257177377"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/185405-t-compiler/rust-analyzer/topic/Doubts%20regarding%20adding%20a%20new%20module%20assist/near/257177377" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Laurențiu <a href="https://zulip-archive.rust-lang.org/stream/185405-t-compiler/rust-analyzer/topic/Doubts.20regarding.20adding.20a.20new.20module.20assist.html#257177377">(Oct 12 2021 at 09:58)</a>:</h4>
<p>Uh-oh</p>



<a name="257177413"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/185405-t-compiler/rust-analyzer/topic/Doubts%20regarding%20adding%20a%20new%20module%20assist/near/257177413" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Laurențiu <a href="https://zulip-archive.rust-lang.org/stream/185405-t-compiler/rust-analyzer/topic/Doubts.20regarding.20adding.20a.20new.20module.20assist.html#257177413">(Oct 12 2021 at 09:59)</a>:</h4>
<p><a href="https://github.com/rust-analyzer/rust-analyzer/pull/9939/commits/7453346345008015c379f14e3cd139a6b9b650c2">https://github.com/rust-analyzer/rust-analyzer/pull/9939/commits/7453346345008015c379f14e3cd139a6b9b650c2</a> does this contain everything you want?</p>



<a name="257177591"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/185405-t-compiler/rust-analyzer/topic/Doubts%20regarding%20adding%20a%20new%20module%20assist/near/257177591" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Fenil Jain <a href="https://zulip-archive.rust-lang.org/stream/185405-t-compiler/rust-analyzer/topic/Doubts.20regarding.20adding.20a.20new.20module.20assist.html#257177591">(Oct 12 2021 at 10:00)</a>:</h4>
<p>Nope there's other commits too which I pushed after resolving the reviews given</p>



<a name="257177666"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/185405-t-compiler/rust-analyzer/topic/Doubts%20regarding%20adding%20a%20new%20module%20assist/near/257177666" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Fenil Jain <a href="https://zulip-archive.rust-lang.org/stream/185405-t-compiler/rust-analyzer/topic/Doubts.20regarding.20adding.20a.20new.20module.20assist.html#257177666">(Oct 12 2021 at 10:00)</a>:</h4>
<p><a href="https://github.com/rust-analyzer/rust-analyzer/pull/9939/commits/8f0edf73fd572c7a91f9f1bae0438b8f92e62d3d">https://github.com/rust-analyzer/rust-analyzer/pull/9939/commits/8f0edf73fd572c7a91f9f1bae0438b8f92e62d3d</a></p>
<p><a href="https://github.com/rust-analyzer/rust-analyzer/pull/9939/commits/436a5a4be2ad544342fbcc73c52d94b5d9bf9efc">https://github.com/rust-analyzer/rust-analyzer/pull/9939/commits/436a5a4be2ad544342fbcc73c52d94b5d9bf9efc</a></p>
<p>These are the ones containing final fixes</p>



<a name="257178027"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/185405-t-compiler/rust-analyzer/topic/Doubts%20regarding%20adding%20a%20new%20module%20assist/near/257178027" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Laurențiu <a href="https://zulip-archive.rust-lang.org/stream/185405-t-compiler/rust-analyzer/topic/Doubts.20regarding.20adding.20a.20new.20module.20assist.html#257178027">(Oct 12 2021 at 10:04)</a>:</h4>
<p>You can either look for the old version in <code>git reflog</code>, <code>git reset --hard</code> to it, then start again</p>



<a name="257178053"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/185405-t-compiler/rust-analyzer/topic/Doubts%20regarding%20adding%20a%20new%20module%20assist/near/257178053" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Laurențiu <a href="https://zulip-archive.rust-lang.org/stream/185405-t-compiler/rust-analyzer/topic/Doubts.20regarding.20adding.20a.20new.20module.20assist.html#257178053">(Oct 12 2021 at 10:04)</a>:</h4>
<p>Or make a new branch from our <code>master</code> and cherry-pick the three commits (if it's only three of them)</p>



<a name="257178088"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/185405-t-compiler/rust-analyzer/topic/Doubts%20regarding%20adding%20a%20new%20module%20assist/near/257178088" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Laurențiu <a href="https://zulip-archive.rust-lang.org/stream/185405-t-compiler/rust-analyzer/topic/Doubts.20regarding.20adding.20a.20new.20module.20assist.html#257178088">(Oct 12 2021 at 10:04)</a>:</h4>
<p>I'd do the latter if I was sure there are only three, something like:</p>
<div class="codehilite"><pre><span></span><code>git remote add upstream https://github.com/rust-analyzer/rust-analyzer # if you don&#39;t have it already
git fetch upstream
git checkout -b extract-module-2
git reset --hard upstream/master
git cherry-pick 7453346345008015c379f14e3cd139a6b9b650c2 8f0edf73fd572c7a91f9f1bae0438b8f92e62d3d 436a5a4be2ad544342fbcc73c52d94b5d9bf9efc # check that they&#39;re in chronological order
</code></pre></div>



<a name="257178432"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/185405-t-compiler/rust-analyzer/topic/Doubts%20regarding%20adding%20a%20new%20module%20assist/near/257178432" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Laurențiu <a href="https://zulip-archive.rust-lang.org/stream/185405-t-compiler/rust-analyzer/topic/Doubts.20regarding.20adding.20a.20new.20module.20assist.html#257178432">(Oct 12 2021 at 10:07)</a>:</h4>
<p>(Not tested)</p>



<a name="257178932"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/185405-t-compiler/rust-analyzer/topic/Doubts%20regarding%20adding%20a%20new%20module%20assist/near/257178932" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Fenil Jain <a href="https://zulip-archive.rust-lang.org/stream/185405-t-compiler/rust-analyzer/topic/Doubts.20regarding.20adding.20a.20new.20module.20assist.html#257178932">(Oct 12 2021 at 10:11)</a>:</h4>
<p>Yeah I did the same but when I tried to push it stated: "everything up to date"</p>



<a name="257179108"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/185405-t-compiler/rust-analyzer/topic/Doubts%20regarding%20adding%20a%20new%20module%20assist/near/257179108" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lukas Wirth <a href="https://zulip-archive.rust-lang.org/stream/185405-t-compiler/rust-analyzer/topic/Doubts.20regarding.20adding.20a.20new.20module.20assist.html#257179108">(Oct 12 2021 at 10:13)</a>:</h4>
<p>Try clearing the branch to master, force push the cleared version, then cherry pick the commits over and force push again</p>



<a name="257179162"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/185405-t-compiler/rust-analyzer/topic/Doubts%20regarding%20adding%20a%20new%20module%20assist/near/257179162" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lukas Wirth <a href="https://zulip-archive.rust-lang.org/stream/185405-t-compiler/rust-analyzer/topic/Doubts.20regarding.20adding.20a.20new.20module.20assist.html#257179162">(Oct 12 2021 at 10:14)</a>:</h4>
<p>A bit odd that you get an <code>everything up to date</code> there tbh <span aria-label="confused" class="emoji emoji-1f615" role="img" title="confused">:confused:</span></p>



<a name="257184627"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/185405-t-compiler/rust-analyzer/topic/Doubts%20regarding%20adding%20a%20new%20module%20assist/near/257184627" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Fenil Jain <a href="https://zulip-archive.rust-lang.org/stream/185405-t-compiler/rust-analyzer/topic/Doubts.20regarding.20adding.20a.20new.20module.20assist.html#257184627">(Oct 12 2021 at 11:07)</a>:</h4>
<p>Okay when I try git push origin +extract_module with current branch synced up with master, it still says <code>everything up to date</code></p>
<p><a href="/user_uploads/4715/9cZ9FynOMxKgb8F_buZ6w05I/RustAnalyzer.png">RustAnalyzer.png</a></p>
<div class="message_inline_image"><a href="/user_uploads/4715/9cZ9FynOMxKgb8F_buZ6w05I/RustAnalyzer.png" title="RustAnalyzer.png"><img src="/user_uploads/4715/9cZ9FynOMxKgb8F_buZ6w05I/RustAnalyzer.png"></a></div>



<a name="257184797"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/185405-t-compiler/rust-analyzer/topic/Doubts%20regarding%20adding%20a%20new%20module%20assist/near/257184797" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Laurențiu <a href="https://zulip-archive.rust-lang.org/stream/185405-t-compiler/rust-analyzer/topic/Doubts.20regarding.20adding.20a.20new.20module.20assist.html#257184797">(Oct 12 2021 at 11:09)</a>:</h4>
<p>You're pushing the old branch</p>



<a name="257184813"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/185405-t-compiler/rust-analyzer/topic/Doubts%20regarding%20adding%20a%20new%20module%20assist/near/257184813" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Laurențiu <a href="https://zulip-archive.rust-lang.org/stream/185405-t-compiler/rust-analyzer/topic/Doubts.20regarding.20adding.20a.20new.20module.20assist.html#257184813">(Oct 12 2021 at 11:09)</a>:</h4>
<p><code>git push -u origin extract_module_2</code></p>



<a name="257184823"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/185405-t-compiler/rust-analyzer/topic/Doubts%20regarding%20adding%20a%20new%20module%20assist/near/257184823" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Laurențiu <a href="https://zulip-archive.rust-lang.org/stream/185405-t-compiler/rust-analyzer/topic/Doubts.20regarding.20adding.20a.20new.20module.20assist.html#257184823">(Oct 12 2021 at 11:09)</a>:</h4>
<p>Also, what's <code>+</code> there?</p>



<a name="257184858"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/185405-t-compiler/rust-analyzer/topic/Doubts%20regarding%20adding%20a%20new%20module%20assist/near/257184858" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Fenil Jain <a href="https://zulip-archive.rust-lang.org/stream/185405-t-compiler/rust-analyzer/topic/Doubts.20regarding.20adding.20a.20new.20module.20assist.html#257184858">(Oct 12 2021 at 11:09)</a>:</h4>
<p>Thats for only force pushing a particular branch</p>
<p>So I am force pushing to extract_module from extract_module_fix branch</p>



<a name="257185034"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/185405-t-compiler/rust-analyzer/topic/Doubts%20regarding%20adding%20a%20new%20module%20assist/near/257185034" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Laurențiu <a href="https://zulip-archive.rust-lang.org/stream/185405-t-compiler/rust-analyzer/topic/Doubts.20regarding.20adding.20a.20new.20module.20assist.html#257185034">(Oct 12 2021 at 11:11)</a>:</h4>
<p>TIL</p>



<a name="257185292"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/185405-t-compiler/rust-analyzer/topic/Doubts%20regarding%20adding%20a%20new%20module%20assist/near/257185292" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Laurențiu <a href="https://zulip-archive.rust-lang.org/stream/185405-t-compiler/rust-analyzer/topic/Doubts.20regarding.20adding.20a.20new.20module.20assist.html#257185292">(Oct 12 2021 at 11:13)</a>:</h4>
<p>Try <code>git push -u origin extract_module_2</code>. I can never remember if that's the local or remote branch name</p>



<a name="257202864"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/185405-t-compiler/rust-analyzer/topic/Doubts%20regarding%20adding%20a%20new%20module%20assist/near/257202864" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Fenil Jain <a href="https://zulip-archive.rust-lang.org/stream/185405-t-compiler/rust-analyzer/topic/Doubts.20regarding.20adding.20a.20new.20module.20assist.html#257202864">(Oct 12 2021 at 13:31)</a>:</h4>
<p>I have reopened it and I think now it is proper</p>



<a name="257209232"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/185405-t-compiler/rust-analyzer/topic/Doubts%20regarding%20adding%20a%20new%20module%20assist/near/257209232" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Laurențiu <a href="https://zulip-archive.rust-lang.org/stream/185405-t-compiler/rust-analyzer/topic/Doubts.20regarding.20adding.20a.20new.20module.20assist.html#257209232">(Oct 12 2021 at 14:11)</a>:</h4>
<p>Yeah, it looks fine</p>



<a name="258689003"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/185405-t-compiler/rust-analyzer/topic/Doubts%20regarding%20adding%20a%20new%20module%20assist/near/258689003" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Fenil Jain <a href="https://zulip-archive.rust-lang.org/stream/185405-t-compiler/rust-analyzer/topic/Doubts.20regarding.20adding.20a.20new.20module.20assist.html#258689003">(Oct 22 2021 at 09:58)</a>:</h4>
<p>Thnx a lot for all the help <span aria-label="peace sign" class="emoji emoji-270c" role="img" title="peace sign">:peace_sign:</span></p>



<hr><p>Last updated: Apr 12 2022 at 20:01 UTC</p>
</html>