<html>
<head><meta charset="utf-8"><title>Rust Analyzer Assist Test · t-compiler/rust-analyzer · Zulip Chat Archive</title></head>
<h2>Stream: <a href="https://zulip-archive.rust-lang.org/stream/185405-t-compiler/rust-analyzer/index.html">t-compiler/rust-analyzer</a></h2>
<h3>Topic: <a href="https://zulip-archive.rust-lang.org/stream/185405-t-compiler/rust-analyzer/topic/Rust.20Analyzer.20Assist.20Test.html">Rust Analyzer Assist Test</a></h3>

<hr>

<base href="https://rust-lang.zulipchat.com">

<head><link href="https://zulip-archive.rust-lang.org/style.css" rel="stylesheet"></head>

<a name="248846173"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/185405-t-compiler/rust-analyzer/topic/Rust%20Analyzer%20Assist%20Test/near/248846173" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mahdi Faramarzpour <a href="https://zulip-archive.rust-lang.org/stream/185405-t-compiler/rust-analyzer/topic/Rust.20Analyzer.20Assist.20Test.html#248846173">(Aug 09 2021 at 13:32)</a>:</h4>
<p>I've added <code>generate_method</code> assist, and created this new test:</p>
<div class="codehilite" data-code-language="Rust"><pre><span></span><code><span class="cp">#[test]</span><span class="w"></span>
<span class="w">    </span><span class="k">fn</span> <span class="nf">create_method</span><span class="p">()</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">        </span><span class="n">check_assist</span><span class="p">(</span><span class="w"></span>
<span class="w">            </span><span class="n">generate_method</span><span class="p">,</span><span class="w"></span>
<span class="w">            </span><span class="s">r"</span>
<span class="s">struct S;</span>

<span class="s">fn foo() {</span>
<span class="s">    S.bar$0();</span>
<span class="s">}</span>

<span class="s">"</span><span class="p">,</span><span class="w"></span>
<span class="w">            </span><span class="s">r"</span>
<span class="s">struct S;</span>

<span class="s">fn foo() {</span>
<span class="s">    S.bar();</span>
<span class="s">}</span>
<span class="s">impl S {</span>


<span class="s">fn bar(&amp;self) -&gt; () {</span>
<span class="s">    todo!()</span>
<span class="s">}</span>
<span class="s">}</span>

<span class="s">"</span><span class="p">,</span><span class="w"></span>
<span class="w">        </span><span class="p">)</span><span class="w"></span>
<span class="w">    </span><span class="p">}</span><span class="w"></span>
</code></pre></div>
<p>But it fails, with the following message:</p>
<div class="codehilite"><pre><span></span><code>Left:
struct S;

fn foo() {
    S.bar();
}
impl S {


fn bar(&amp;self) -&gt; () {
    todo!()
}
}



Right:
struct S;

fn foo() {
    S.bar();
}
impl S {


fn bar(&amp;self) ${0:-&gt; ()} {
    todo!()
}
}
</code></pre></div>
<p>The assist already works well, I have no idea why it adds this piece of code in the signature: <code>${0:-&gt; ()}</code></p>



<a name="248846344"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/185405-t-compiler/rust-analyzer/topic/Rust%20Analyzer%20Assist%20Test/near/248846344" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Laurențiu <a href="https://zulip-archive.rust-lang.org/stream/185405-t-compiler/rust-analyzer/topic/Rust.20Analyzer.20Assist.20Test.html#248846344">(Aug 09 2021 at 13:34)</a>:</h4>
<p>Not sure about the syntax, but that's probably the cursor position after applying the assist.</p>



<a name="248846732"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/185405-t-compiler/rust-analyzer/topic/Rust%20Analyzer%20Assist%20Test/near/248846732" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> matklad <a href="https://zulip-archive.rust-lang.org/stream/185405-t-compiler/rust-analyzer/topic/Rust.20Analyzer.20Assist.20Test.html#248846732">(Aug 09 2021 at 13:37)</a>:</h4>
<p>That's the snippet for the return type</p>



<a name="248846748"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/185405-t-compiler/rust-analyzer/topic/Rust%20Analyzer%20Assist%20Test/near/248846748" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mahdi Faramarzpour <a href="https://zulip-archive.rust-lang.org/stream/185405-t-compiler/rust-analyzer/topic/Rust.20Analyzer.20Assist.20Test.html#248846748">(Aug 09 2021 at 13:37)</a>:</h4>
<p>Oh! I didn't know the cursor position should also be mentioned in that fixture.</p>



<a name="248846887"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/185405-t-compiler/rust-analyzer/topic/Rust%20Analyzer%20Assist%20Test/near/248846887" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Laurențiu <a href="https://zulip-archive.rust-lang.org/stream/185405-t-compiler/rust-analyzer/topic/Rust.20Analyzer.20Assist.20Test.html#248846887">(Aug 09 2021 at 13:38)</a>:</h4>
<p>Does it mean that <code>-&gt; ()</code> should be selected?</p>



<a name="248846942"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/185405-t-compiler/rust-analyzer/topic/Rust%20Analyzer%20Assist%20Test/near/248846942" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> matklad <a href="https://zulip-archive.rust-lang.org/stream/185405-t-compiler/rust-analyzer/topic/Rust.20Analyzer.20Assist.20Test.html#248846942">(Aug 09 2021 at 13:39)</a>:</h4>
<p>yeah</p>



<a name="248846961"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/185405-t-compiler/rust-analyzer/topic/Rust%20Analyzer%20Assist%20Test/near/248846961" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mahdi Faramarzpour <a href="https://zulip-archive.rust-lang.org/stream/185405-t-compiler/rust-analyzer/topic/Rust.20Analyzer.20Assist.20Test.html#248846961">(Aug 09 2021 at 13:39)</a>:</h4>
<p>Yes, that's actually the case.</p>



<a name="248847076"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/185405-t-compiler/rust-analyzer/topic/Rust%20Analyzer%20Assist%20Test/near/248847076" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> matklad <a href="https://zulip-archive.rust-lang.org/stream/185405-t-compiler/rust-analyzer/topic/Rust.20Analyzer.20Assist.20Test.html#248847076">(Aug 09 2021 at 13:40)</a>:</h4>
<p><span class="user-mention" data-user-id="424024">@Mahdi Faramarzpour</span> yeah, it actually one of the important bits of the assist experince -- where does the cursor end up being after the edit. In general, proper cursor positioning is what creates the fluidity feeling when using an IDE</p>



<a name="248847109"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/185405-t-compiler/rust-analyzer/topic/Rust%20Analyzer%20Assist%20Test/near/248847109" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> matklad <a href="https://zulip-archive.rust-lang.org/stream/185405-t-compiler/rust-analyzer/topic/Rust.20Analyzer.20Assist.20Test.html#248847109">(Aug 09 2021 at 13:40)</a>:</h4>
<p>(and VS Code cursor positioning logic is, well, less than optimal)</p>



<a name="248847383"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/185405-t-compiler/rust-analyzer/topic/Rust%20Analyzer%20Assist%20Test/near/248847383" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mahdi Faramarzpour <a href="https://zulip-archive.rust-lang.org/stream/185405-t-compiler/rust-analyzer/topic/Rust.20Analyzer.20Assist.20Test.html#248847383">(Aug 09 2021 at 13:42)</a>:</h4>
<p>So can you give me some insight about the syntax regarding this <code>$0</code> or <code>${0:-&gt; ()}</code> ? what exactly do these symbols mean?</p>



<a name="248847916"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/185405-t-compiler/rust-analyzer/topic/Rust%20Analyzer%20Assist%20Test/near/248847916" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Laurențiu <a href="https://zulip-archive.rust-lang.org/stream/185405-t-compiler/rust-analyzer/topic/Rust.20Analyzer.20Assist.20Test.html#248847916">(Aug 09 2021 at 13:46)</a>:</h4>
<p>They're like tab stops IIRC, so the cursor is on <code>$0</code>, but you can tab to <code>$1</code> etc.</p>



<a name="248847974"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/185405-t-compiler/rust-analyzer/topic/Rust%20Analyzer%20Assist%20Test/near/248847974" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Laurențiu <a href="https://zulip-archive.rust-lang.org/stream/185405-t-compiler/rust-analyzer/topic/Rust.20Analyzer.20Assist.20Test.html#248847974">(Aug 09 2021 at 13:47)</a>:</h4>
<p>And <code>${0:xoxo}</code> means "output <code>xoxo</code> here and select it"</p>



<hr><p>Last updated: Apr 12 2022 at 20:01 UTC</p>
</html>