<html>
<head><meta charset="utf-8"><title>remove `--no-log-buffering` cli flag · t-compiler/rust-analyzer · Zulip Chat Archive</title></head>
<h2>Stream: <a href="https://zulip-archive.rust-lang.org/stream/185405-t-compiler/rust-analyzer/index.html">t-compiler/rust-analyzer</a></h2>
<h3>Topic: <a href="https://zulip-archive.rust-lang.org/stream/185405-t-compiler/rust-analyzer/topic/remove.20.60--no-log-buffering.60.20cli.20flag.html">remove `--no-log-buffering` cli flag</a></h3>

<hr>

<base href="https://rust-lang.zulipchat.com">

<head><link href="https://zulip-archive.rust-lang.org/style.css" rel="stylesheet"></head>

<a name="252403721"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/185405-t-compiler/rust-analyzer/topic/remove%20%60--no-log-buffering%60%20cli%20flag/near/252403721" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wall.E <a href="https://zulip-archive.rust-lang.org/stream/185405-t-compiler/rust-analyzer/topic/remove.20.60--no-log-buffering.60.20cli.20flag.html#252403721">(Sep 08 2021 at 04:13)</a>:</h4>
<p>After replacing <code>log</code> with <code>tracing</code>, the event write operation is already "no buffering", it uses <code>std::io::Write::write_all</code>. So should we remove the <code>--no-log-buffering</code> flag? <br>
<a href="https://github.com/tokio-rs/tracing/blob/1c73db2973b83e46c13f0ab426d80c442ebacc34/tracing-subscriber/src/fmt/fmt_subscriber.rs#L696">https://github.com/tokio-rs/tracing/blob/1c73db2973b83e46c13f0ab426d80c442ebacc34/tracing-subscriber/src/fmt/fmt_subscriber.rs#L696</a></p>



<a name="252417057"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/185405-t-compiler/rust-analyzer/topic/remove%20%60--no-log-buffering%60%20cli%20flag/near/252417057" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Laurențiu <a href="https://zulip-archive.rust-lang.org/stream/185405-t-compiler/rust-analyzer/topic/remove.20.60--no-log-buffering.60.20cli.20flag.html#252417057">(Sep 08 2021 at 07:18)</a>:</h4>
<p>I don't think <code>write_all</code> flushes the backing stream. So if you call <code>write_all</code> on a <code>BufWriter</code>, it does buffering, but if you call it on a <code>File</code> it doesn't.</p>



<a name="252418257"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/185405-t-compiler/rust-analyzer/topic/remove%20%60--no-log-buffering%60%20cli%20flag/near/252418257" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Laurențiu <a href="https://zulip-archive.rust-lang.org/stream/185405-t-compiler/rust-analyzer/topic/remove.20.60--no-log-buffering.60.20cli.20flag.html#252418257">(Sep 08 2021 at 07:31)</a>:</h4>
<p><a href="https://doc.rust-lang.org/std/io/struct.LineWriter.html">https://doc.rust-lang.org/std/io/struct.LineWriter.html</a> is the line-buffered equivalent of <code>BufWriter</code></p>



<a name="252422415"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/185405-t-compiler/rust-analyzer/topic/remove%20%60--no-log-buffering%60%20cli%20flag/near/252422415" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Laurențiu <a href="https://zulip-archive.rust-lang.org/stream/185405-t-compiler/rust-analyzer/topic/remove.20.60--no-log-buffering.60.20cli.20flag.html#252422415">(Sep 08 2021 at 08:12)</a>:</h4>
<p>TBH, with file logging enabled it might be fine to always do line buffering</p>



<a name="252424976"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/185405-t-compiler/rust-analyzer/topic/remove%20%60--no-log-buffering%60%20cli%20flag/near/252424976" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Wall.E <a href="https://zulip-archive.rust-lang.org/stream/185405-t-compiler/rust-analyzer/topic/remove.20.60--no-log-buffering.60.20cli.20flag.html#252424976">(Sep 08 2021 at 08:35)</a>:</h4>
<p>I'm sorry, I misunderstood the meaning of document of <code>write_all</code>.</p>



<a name="252431651"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/185405-t-compiler/rust-analyzer/topic/remove%20%60--no-log-buffering%60%20cli%20flag/near/252431651" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Laurențiu <a href="https://zulip-archive.rust-lang.org/stream/185405-t-compiler/rust-analyzer/topic/remove.20.60--no-log-buffering.60.20cli.20flag.html#252431651">(Sep 08 2021 at 09:37)</a>:</h4>
<p>It's just <code>write</code> called in a loop: <a href="https://doc.rust-lang.org/src/std/io/mod.rs.html#1446-1461">https://doc.rust-lang.org/src/std/io/mod.rs.html#1446-1461</a></p>



<hr><p>Last updated: Apr 12 2022 at 20:01 UTC</p>
</html>