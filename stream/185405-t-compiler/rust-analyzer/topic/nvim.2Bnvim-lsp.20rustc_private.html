<html>
<head><meta charset="utf-8"><title>nvim+nvim-lsp rustc_private · t-compiler/rust-analyzer · Zulip Chat Archive</title></head>
<h2>Stream: <a href="https://zulip-archive.rust-lang.org/stream/185405-t-compiler/rust-analyzer/index.html">t-compiler/rust-analyzer</a></h2>
<h3>Topic: <a href="https://zulip-archive.rust-lang.org/stream/185405-t-compiler/rust-analyzer/topic/nvim.2Bnvim-lsp.20rustc_private.html">nvim+nvim-lsp rustc_private</a></h3>

<hr>

<base href="https://rust-lang.zulipchat.com">

<head><link href="https://zulip-archive.rust-lang.org/style.css" rel="stylesheet"></head>

<a name="235471089"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/185405-t-compiler/rust-analyzer/topic/nvim%2Bnvim-lsp%20rustc_private/near/235471089" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> csmoe <a href="https://zulip-archive.rust-lang.org/stream/185405-t-compiler/rust-analyzer/topic/nvim.2Bnvim-lsp.20rustc_private.html#235471089">(Apr 21 2021 at 08:10)</a>:</h4>
<p>is ra only works for vscode with <code>rustc_private</code>? I installed the rust-src component and enabled rust-analyzer in my Cargo.toml:</p>
<div class="codehilite" data-code-language="TOML"><pre><span></span><code><span class="k">[package.metadata.rust-analyzer]</span>
<span class="n">rustc_private</span> <span class="o">=</span> <span class="kc">true</span>
</code></pre></div>
<p>but it still error with <code>unresolved extern crate</code>.<br>
<a href="/user_uploads/4715/02RF7f7AkTkkTGxWFjTkw68m/image.png">image.png</a></p>
<div class="message_inline_image"><a href="/user_uploads/4715/02RF7f7AkTkkTGxWFjTkw68m/image.png" title="image.png"><img src="/user_uploads/4715/02RF7f7AkTkkTGxWFjTkw68m/image.png"></a></div>



<a name="235481597"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/185405-t-compiler/rust-analyzer/topic/nvim%2Bnvim-lsp%20rustc_private/near/235481597" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Laurențiu <a href="https://zulip-archive.rust-lang.org/stream/185405-t-compiler/rust-analyzer/topic/nvim.2Bnvim-lsp.20rustc_private.html#235481597">(Apr 21 2021 at 09:43)</a>:</h4>
<p>I'm not sure, but from the docs it sounds like you also need to set <code>rust-analyzer.rustcSource</code>. <code>rust-src</code> has the standard library, not compiler source code</p>



<a name="258568651"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/185405-t-compiler/rust-analyzer/topic/nvim%2Bnvim-lsp%20rustc_private/near/258568651" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> divma <a href="https://zulip-archive.rust-lang.org/stream/185405-t-compiler/rust-analyzer/topic/nvim.2Bnvim-lsp.20rustc_private.html#258568651">(Oct 21 2021 at 15:41)</a>:</h4>
<p>hey <span class="user-mention" data-user-id="116773">@csmoe</span> do you have this working currently? I'm trying to get types on clippy, which has the rustc_private, and added rust-src as the source. I still can't get working info on rustc_*</p>



<a name="258569221"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/185405-t-compiler/rust-analyzer/topic/nvim%2Bnvim-lsp%20rustc_private/near/258569221" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Laurențiu <a href="https://zulip-archive.rust-lang.org/stream/185405-t-compiler/rust-analyzer/topic/nvim.2Bnvim-lsp.20rustc_private.html#258569221">(Oct 21 2021 at 15:44)</a>:</h4>
<p><span class="user-mention" data-user-id="259439">@divma</span> do you have <code>rustc-src</code>?</p>



<a name="258569959"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/185405-t-compiler/rust-analyzer/topic/nvim%2Bnvim-lsp%20rustc_private/near/258569959" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> divma <a href="https://zulip-archive.rust-lang.org/stream/185405-t-compiler/rust-analyzer/topic/nvim.2Bnvim-lsp.20rustc_private.html#258569959">(Oct 21 2021 at 15:49)</a>:</h4>
<p>I did <code>rustup component add rust-src --toolchain nightly</code> and stable too, same for <code>rustc-dev</code></p>



<a name="258570202"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/185405-t-compiler/rust-analyzer/topic/nvim%2Bnvim-lsp%20rustc_private/near/258570202" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> divma <a href="https://zulip-archive.rust-lang.org/stream/185405-t-compiler/rust-analyzer/topic/nvim.2Bnvim-lsp.20rustc_private.html#258570202">(Oct 21 2021 at 15:50)</a>:</h4>
<p>I just realized it's <code>rust-src</code> (without c) and if I do the same with <code>rustc-src</code> I get <code>does not contain component 'rustc-src'</code>. Do I get this in any other way, or are those one and the same?</p>



<a name="258570544"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/185405-t-compiler/rust-analyzer/topic/nvim%2Bnvim-lsp%20rustc_private/near/258570544" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Laurențiu <a href="https://zulip-archive.rust-lang.org/stream/185405-t-compiler/rust-analyzer/topic/nvim.2Bnvim-lsp.20rustc_private.html#258570544">(Oct 21 2021 at 15:53)</a>:</h4>
<p>Sorry, it's <code>rustc-dev</code>, including the target tuple, e.g. <code>rustc-dev-x86_64-unknown-linux-gnu</code>.</p>



<a name="258570591"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/185405-t-compiler/rust-analyzer/topic/nvim%2Bnvim-lsp%20rustc_private/near/258570591" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Laurențiu <a href="https://zulip-archive.rust-lang.org/stream/185405-t-compiler/rust-analyzer/topic/nvim.2Bnvim-lsp.20rustc_private.html#258570591">(Oct 21 2021 at 15:53)</a>:</h4>
<p>Oh wait</p>



<a name="258570627"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/185405-t-compiler/rust-analyzer/topic/nvim%2Bnvim-lsp%20rustc_private/near/258570627" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Laurențiu <a href="https://zulip-archive.rust-lang.org/stream/185405-t-compiler/rust-analyzer/topic/nvim.2Bnvim-lsp.20rustc_private.html#258570627">(Oct 21 2021 at 15:53)</a>:</h4>
<p>Do you want to use the <code>rust-lang/rust</code> version of <code>rustc</code> or the one in your toolchain?</p>



<a name="258572055"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/185405-t-compiler/rust-analyzer/topic/nvim%2Bnvim-lsp%20rustc_private/near/258572055" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> divma <a href="https://zulip-archive.rust-lang.org/stream/185405-t-compiler/rust-analyzer/topic/nvim.2Bnvim-lsp.20rustc_private.html#258572055">(Oct 21 2021 at 16:02)</a>:</h4>
<p>I'm trying to use it with clippy. They already have a <code>rust-toolchain</code> file.</p>
<div class="codehilite" data-code-language="TOML"><pre><span></span><code><span class="k">[toolchain]</span>
<span class="n">channel</span> <span class="o">=</span> <span class="s">"nightly-2021-10-07"</span>
<span class="n">components</span> <span class="o">=</span> <span class="p">[</span><span class="s">"llvm-tools-preview"</span><span class="p">,</span> <span class="s">"rustc-dev"</span><span class="p">,</span> <span class="s">"rust-src"</span><span class="p">]</span>
</code></pre></div>
<p>I.. want to use whatever lets me get it working there <span aria-label="sweat" class="emoji emoji-1f613" role="img" title="sweat">:sweat:</span>  If I understand correctly, this is what you suggest?</p>
<div class="codehilite" data-code-language="Bash"><pre><span></span><code>$ rustup component add rust-src --toolchain nightly-2021-10-07 --target x86_64-unknown-linux-gnu
info: component <span class="s1">'rust-src'</span> is up to date
$ rustup component add rustc-dev --toolchain nightly-2021-10-07 --target x86_64-unknown-linux-gnu
info: component <span class="s1">'rustc-dev'</span> <span class="k">for</span> target <span class="s1">'x86_64-unknown-linux-gnu'</span> is up to date
</code></pre></div>
<p>What am I missing?</p>



<a name="258572162"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/185405-t-compiler/rust-analyzer/topic/nvim%2Bnvim-lsp%20rustc_private/near/258572162" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> divma <a href="https://zulip-archive.rust-lang.org/stream/185405-t-compiler/rust-analyzer/topic/nvim.2Bnvim-lsp.20rustc_private.html#258572162">(Oct 21 2021 at 16:02)</a>:</h4>
<p>BTW I did the same with <code>llvm-tools-preview</code></p>



<a name="258572711"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/185405-t-compiler/rust-analyzer/topic/nvim%2Bnvim-lsp%20rustc_private/near/258572711" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Laurențiu <a href="https://zulip-archive.rust-lang.org/stream/185405-t-compiler/rust-analyzer/topic/nvim.2Bnvim-lsp.20rustc_private.html#258572711">(Oct 21 2021 at 16:06)</a>:</h4>
<p>Oh, so <code>rustc-dev</code> works too? It's confusing that it doesn't show up in <code>rustup component list</code></p>



<a name="258572777"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/185405-t-compiler/rust-analyzer/topic/nvim%2Bnvim-lsp%20rustc_private/near/258572777" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Laurențiu <a href="https://zulip-archive.rust-lang.org/stream/185405-t-compiler/rust-analyzer/topic/nvim.2Bnvim-lsp.20rustc_private.html#258572777">(Oct 21 2021 at 16:06)</a>:</h4>
<p>Did you set <code>rust-analyzer.rustcSource</code>? <code>"discover"</code> should work.</p>



<a name="258574548"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/185405-t-compiler/rust-analyzer/topic/nvim%2Bnvim-lsp%20rustc_private/near/258574548" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> divma <a href="https://zulip-archive.rust-lang.org/stream/185405-t-compiler/rust-analyzer/topic/nvim.2Bnvim-lsp.20rustc_private.html#258574548">(Oct 21 2021 at 16:17)</a>:</h4>
<p>That's what I've always used (<code>"discover"</code>) and tried changing it to <code>"rust-src"</code>but no luck</p>



<a name="258574584"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/185405-t-compiler/rust-analyzer/topic/nvim%2Bnvim-lsp%20rustc_private/near/258574584" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> divma <a href="https://zulip-archive.rust-lang.org/stream/185405-t-compiler/rust-analyzer/topic/nvim.2Bnvim-lsp.20rustc_private.html#258574584">(Oct 21 2021 at 16:18)</a>:</h4>
<p>I do not get errors tho, no "crate not found" or similar</p>



<a name="258574686"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/185405-t-compiler/rust-analyzer/topic/nvim%2Bnvim-lsp%20rustc_private/near/258574686" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> divma <a href="https://zulip-archive.rust-lang.org/stream/185405-t-compiler/rust-analyzer/topic/nvim.2Bnvim-lsp.20rustc_private.html#258574686">(Oct 21 2021 at 16:18)</a>:</h4>
<p>But hovering, going to type definition, etc.. nothing works with <code>rustc_*</code></p>



<a name="258575218"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/185405-t-compiler/rust-analyzer/topic/nvim%2Bnvim-lsp%20rustc_private/near/258575218" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Laurențiu <a href="https://zulip-archive.rust-lang.org/stream/185405-t-compiler/rust-analyzer/topic/nvim.2Bnvim-lsp.20rustc_private.html#258575218">(Oct 21 2021 at 16:21)</a>:</h4>
<p>Hmm, go to def works for me on <code>rustc_hir::BinOpKind</code></p>



<a name="258575331"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/185405-t-compiler/rust-analyzer/topic/nvim%2Bnvim-lsp%20rustc_private/near/258575331" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> divma <a href="https://zulip-archive.rust-lang.org/stream/185405-t-compiler/rust-analyzer/topic/nvim.2Bnvim-lsp.20rustc_private.html#258575331">(Oct 21 2021 at 16:22)</a>:</h4>
<p>could you share your ra setup?</p>



<a name="258575464"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/185405-t-compiler/rust-analyzer/topic/nvim%2Bnvim-lsp%20rustc_private/near/258575464" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Laurențiu <a href="https://zulip-archive.rust-lang.org/stream/185405-t-compiler/rust-analyzer/topic/nvim.2Bnvim-lsp.20rustc_private.html#258575464">(Oct 21 2021 at 16:22)</a>:</h4>
<p>No, sorry, I only tested in Code</p>



<a name="258575670"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/185405-t-compiler/rust-analyzer/topic/nvim%2Bnvim-lsp%20rustc_private/near/258575670" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> divma <a href="https://zulip-archive.rust-lang.org/stream/185405-t-compiler/rust-analyzer/topic/nvim.2Bnvim-lsp.20rustc_private.html#258575670">(Oct 21 2021 at 16:24)</a>:</h4>
<p>this is my lua config for RA</p>
<div class="codehilite" data-code-language="Lua"><pre><span></span><code><span class="kd">local</span> <span class="n">capabilities</span> <span class="o">=</span> <span class="n">vim</span><span class="p">.</span><span class="n">lsp</span><span class="p">.</span><span class="n">protocol</span><span class="p">.</span><span class="n">make_client_capabilities</span><span class="p">()</span>
<span class="n">capabilities</span><span class="p">.</span><span class="n">textDocument</span><span class="p">.</span><span class="n">completion</span><span class="p">.</span><span class="n">completionItem</span><span class="p">.</span><span class="n">snippetSupport</span> <span class="o">=</span> <span class="kc">true</span>

<span class="nb">require</span><span class="p">(</span><span class="s1">'lspconfig'</span><span class="p">).</span><span class="n">rust_analyzer</span><span class="p">.</span><span class="n">setup</span><span class="p">({</span>
    <span class="n">capabilities</span> <span class="o">=</span> <span class="n">capabilities</span><span class="p">,</span>
    <span class="p">[</span><span class="s2">"rust-analyzer"</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
        <span class="n">rustcSource</span> <span class="o">=</span> <span class="s2">"rust-src"</span><span class="p">,</span> <span class="c1">-- I had "discover" before, same result</span>
        <span class="n">cargo</span> <span class="o">=</span> <span class="p">{</span>
            <span class="n">loadOutDirsFromCheck</span> <span class="o">=</span> <span class="kc">true</span> <span class="c1">--added this recetly but doesn't seem related</span>
        <span class="p">},</span>
        <span class="n">procMacro</span> <span class="o">=</span> <span class="p">{</span>
            <span class="n">enable</span> <span class="o">=</span> <span class="kc">true</span>
        <span class="p">},</span>
        <span class="n">updates</span> <span class="o">=</span> <span class="p">{</span>
            <span class="n">channel</span> <span class="o">=</span> <span class="s2">"nightly"</span><span class="p">,</span> <span class="c1">-- added this to try and get it to work</span>
        <span class="p">},</span>
        <span class="n">completion</span> <span class="o">=</span> <span class="p">{</span>
            <span class="n">snippets</span> <span class="o">=</span> <span class="p">{</span>
                <span class="n">arc</span> <span class="o">=</span> <span class="p">{</span>
                    <span class="n">postfix</span> <span class="o">=</span> <span class="s2">"arc"</span><span class="p">,</span>
                    <span class="n">body</span> <span class="o">=</span> <span class="s2">"Arc::new(${receiver})"</span><span class="p">,</span>
                    <span class="n">scope</span> <span class="o">=</span> <span class="s2">"expr"</span><span class="p">,</span>
                    <span class="n">requires</span> <span class="o">=</span> <span class="s2">"std::sync::Arc"</span><span class="p">,</span>
                <span class="p">}</span>
            <span class="p">}</span>
        <span class="p">},</span>
    <span class="p">}</span>
<span class="p">})</span>
</code></pre></div>



<a name="258575747"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/185405-t-compiler/rust-analyzer/topic/nvim%2Bnvim-lsp%20rustc_private/near/258575747" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> divma <a href="https://zulip-archive.rust-lang.org/stream/185405-t-compiler/rust-analyzer/topic/nvim.2Bnvim-lsp.20rustc_private.html#258575747">(Oct 21 2021 at 16:24)</a>:</h4>
<p>most use VS Code right? where's the vim gang :(</p>



<a name="258575795"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/185405-t-compiler/rust-analyzer/topic/nvim%2Bnvim-lsp%20rustc_private/near/258575795" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> matklad <a href="https://zulip-archive.rust-lang.org/stream/185405-t-compiler/rust-analyzer/topic/nvim.2Bnvim-lsp.20rustc_private.html#258575795">(Oct 21 2021 at 16:25)</a>:</h4>
<p>cc <span class="user-mention" data-user-id="428521">@sim</span> :)</p>



<a name="258576110"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/185405-t-compiler/rust-analyzer/topic/nvim%2Bnvim-lsp%20rustc_private/near/258576110" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Laurențiu <a href="https://zulip-archive.rust-lang.org/stream/185405-t-compiler/rust-analyzer/topic/nvim.2Bnvim-lsp.20rustc_private.html#258576110">(Oct 21 2021 at 16:26)</a>:</h4>
<p>Yeah, I can't make it work in <code>rust-tools</code></p>



<a name="258577273"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/185405-t-compiler/rust-analyzer/topic/nvim%2Bnvim-lsp%20rustc_private/near/258577273" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Laurențiu <a href="https://zulip-archive.rust-lang.org/stream/185405-t-compiler/rust-analyzer/topic/nvim.2Bnvim-lsp.20rustc_private.html#258577273">(Oct 21 2021 at 16:33)</a>:</h4>
<p>Weird, the log file doesn't catch the LSP config</p>



<a name="258578962"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/185405-t-compiler/rust-analyzer/topic/nvim%2Bnvim-lsp%20rustc_private/near/258578962" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Laurențiu <a href="https://zulip-archive.rust-lang.org/stream/185405-t-compiler/rust-analyzer/topic/nvim.2Bnvim-lsp.20rustc_private.html#258578962">(Oct 21 2021 at 16:44)</a>:</h4>
<p>Oh, I think nvim sends an empty <code>initializationOptions</code> at start-up. We get a <code>workspace/didChangeConfiguration</code>, but we don't support that for some of the settings.</p>



<a name="258580628"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/185405-t-compiler/rust-analyzer/topic/nvim%2Bnvim-lsp%20rustc_private/near/258580628" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Laurențiu <a href="https://zulip-archive.rust-lang.org/stream/185405-t-compiler/rust-analyzer/topic/nvim.2Bnvim-lsp.20rustc_private.html#258580628">(Oct 21 2021 at 16:56)</a>:</h4>
<p>Filed <a href="https://github.com/neovim/nvim-lspconfig/issues/1334">https://github.com/neovim/nvim-lspconfig/issues/1334</a></p>



<a name="258595509"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/185405-t-compiler/rust-analyzer/topic/nvim%2Bnvim-lsp%20rustc_private/near/258595509" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Laurențiu <a href="https://zulip-archive.rust-lang.org/stream/185405-t-compiler/rust-analyzer/topic/nvim.2Bnvim-lsp.20rustc_private.html#258595509">(Oct 21 2021 at 18:32)</a>:</h4>
<p>Well, that was embarrassing.</p>



<a name="258597934"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/185405-t-compiler/rust-analyzer/topic/nvim%2Bnvim-lsp%20rustc_private/near/258597934" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> divma <a href="https://zulip-archive.rust-lang.org/stream/185405-t-compiler/rust-analyzer/topic/nvim.2Bnvim-lsp.20rustc_private.html#258597934">(Oct 21 2021 at 18:49)</a>:</h4>
<p>I found someone that has their configuration working and the only difference is that they use a different package manager</p>



<a name="258598003"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/185405-t-compiler/rust-analyzer/topic/nvim%2Bnvim-lsp%20rustc_private/near/258598003" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> divma <a href="https://zulip-archive.rust-lang.org/stream/185405-t-compiler/rust-analyzer/topic/nvim.2Bnvim-lsp.20rustc_private.html#258598003">(Oct 21 2021 at 18:50)</a>:</h4>
<p>then we did what you suggested in the issue, used trace logs</p>



<a name="258598028"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/185405-t-compiler/rust-analyzer/topic/nvim%2Bnvim-lsp%20rustc_private/near/258598028" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> divma <a href="https://zulip-archive.rust-lang.org/stream/185405-t-compiler/rust-analyzer/topic/nvim.2Bnvim-lsp.20rustc_private.html#258598028">(Oct 21 2021 at 18:50)</a>:</h4>
<p>and indeed they get a didChangeConfiguration</p>



<a name="258598036"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/185405-t-compiler/rust-analyzer/topic/nvim%2Bnvim-lsp%20rustc_private/near/258598036" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> divma <a href="https://zulip-archive.rust-lang.org/stream/185405-t-compiler/rust-analyzer/topic/nvim.2Bnvim-lsp.20rustc_private.html#258598036">(Oct 21 2021 at 18:50)</a>:</h4>
<p>I do have one, but it's empty</p>



<a name="258598059"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/185405-t-compiler/rust-analyzer/topic/nvim%2Bnvim-lsp%20rustc_private/near/258598059" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> divma <a href="https://zulip-archive.rust-lang.org/stream/185405-t-compiler/rust-analyzer/topic/nvim.2Bnvim-lsp.20rustc_private.html#258598059">(Oct 21 2021 at 18:50)</a>:</h4>
<p>we believe it's because the configuration is done before lsp is ready</p>



<a name="258598098"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/185405-t-compiler/rust-analyzer/topic/nvim%2Bnvim-lsp%20rustc_private/near/258598098" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> divma <a href="https://zulip-archive.rust-lang.org/stream/185405-t-compiler/rust-analyzer/topic/nvim.2Bnvim-lsp.20rustc_private.html#258598098">(Oct 21 2021 at 18:51)</a>:</h4>
<p>his package manager calls the configuration for each package after those are loaded</p>



<a name="258598225"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/185405-t-compiler/rust-analyzer/topic/nvim%2Bnvim-lsp%20rustc_private/near/258598225" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> divma <a href="https://zulip-archive.rust-lang.org/stream/185405-t-compiler/rust-analyzer/topic/nvim.2Bnvim-lsp.20rustc_private.html#258598225">(Oct 21 2021 at 18:52)</a>:</h4>
<p>for the future soul that arrives here suffering I'm using plug, the other guy whose config is used (same config as mine) uses packer <span aria-label="rolling eyes" class="emoji emoji-1f644" role="img" title="rolling eyes">:rolling_eyes:</span></p>



<a name="258598402"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/185405-t-compiler/rust-analyzer/topic/nvim%2Bnvim-lsp%20rustc_private/near/258598402" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> divma <a href="https://zulip-archive.rust-lang.org/stream/185405-t-compiler/rust-analyzer/topic/nvim.2Bnvim-lsp.20rustc_private.html#258598402">(Oct 21 2021 at 18:53)</a>:</h4>
<p>tbbh i have no idea what it is or how to solve it</p>



<a name="258598917"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/185405-t-compiler/rust-analyzer/topic/nvim%2Bnvim-lsp%20rustc_private/near/258598917" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> divma <a href="https://zulip-archive.rust-lang.org/stream/185405-t-compiler/rust-analyzer/topic/nvim.2Bnvim-lsp.20rustc_private.html#258598917">(Oct 21 2021 at 18:57)</a>:</h4>
<p>oh GOD</p>



<a name="258598924"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/185405-t-compiler/rust-analyzer/topic/nvim%2Bnvim-lsp%20rustc_private/near/258598924" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> divma <a href="https://zulip-archive.rust-lang.org/stream/185405-t-compiler/rust-analyzer/topic/nvim.2Bnvim-lsp.20rustc_private.html#258598924">(Oct 21 2021 at 18:57)</a>:</h4>
<p>ignore everything</p>



<a name="258599003"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/185405-t-compiler/rust-analyzer/topic/nvim%2Bnvim-lsp%20rustc_private/near/258599003" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> divma <a href="https://zulip-archive.rust-lang.org/stream/185405-t-compiler/rust-analyzer/topic/nvim.2Bnvim-lsp.20rustc_private.html#258599003">(Oct 21 2021 at 18:58)</a>:</h4>
<p>I'm an idiot (I'm probably arriving to the same conclusion of the issue)</p>



<a name="258599024"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/185405-t-compiler/rust-analyzer/topic/nvim%2Bnvim-lsp%20rustc_private/near/258599024" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> divma <a href="https://zulip-archive.rust-lang.org/stream/185405-t-compiler/rust-analyzer/topic/nvim.2Bnvim-lsp.20rustc_private.html#258599024">(Oct 21 2021 at 18:58)</a>:</h4>
<p>all of that needed to go inside settings</p>



<a name="258599122"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/185405-t-compiler/rust-analyzer/topic/nvim%2Bnvim-lsp%20rustc_private/near/258599122" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> divma <a href="https://zulip-archive.rust-lang.org/stream/185405-t-compiler/rust-analyzer/topic/nvim.2Bnvim-lsp.20rustc_private.html#258599122">(Oct 21 2021 at 18:58)</a>:</h4>
<p>forgive me <span class="user-mention" data-user-id="203546">@Laurențiu</span> you had to suffer the embarrassment on my behalf</p>



<a name="258599495"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/185405-t-compiler/rust-analyzer/topic/nvim%2Bnvim-lsp%20rustc_private/near/258599495" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> divma <a href="https://zulip-archive.rust-lang.org/stream/185405-t-compiler/rust-analyzer/topic/nvim.2Bnvim-lsp.20rustc_private.html#258599495">(Oct 21 2021 at 19:01)</a>:</h4>
<p>TLDR this configuration works:</p>
<div class="codehilite" data-code-language="Lua"><pre><span></span><code><span class="kd">local</span> <span class="n">capabilities</span> <span class="o">=</span> <span class="n">vim</span><span class="p">.</span><span class="n">lsp</span><span class="p">.</span><span class="n">protocol</span><span class="p">.</span><span class="n">make_client_capabilities</span><span class="p">()</span>
<span class="n">capabilities</span><span class="p">.</span><span class="n">textDocument</span><span class="p">.</span><span class="n">completion</span><span class="p">.</span><span class="n">completionItem</span><span class="p">.</span><span class="n">snippetSupport</span> <span class="o">=</span> <span class="kc">true</span>

<span class="nb">require</span><span class="p">(</span><span class="s1">'lspconfig'</span><span class="p">).</span><span class="n">rust_analyzer</span><span class="p">.</span><span class="n">setup</span><span class="p">({</span>
    <span class="n">capabilities</span> <span class="o">=</span> <span class="n">capabilities</span><span class="p">,</span>
    <span class="n">settings</span> <span class="o">=</span> <span class="p">{</span> <span class="c1">-- this higher level was missing :facepalm:</span>
        <span class="p">[</span><span class="s2">"rust-analyzer"</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
            <span class="n">rustcSource</span> <span class="o">=</span> <span class="s2">"discover"</span><span class="p">,</span>
            <span class="n">procMacro</span> <span class="o">=</span> <span class="p">{</span>
                <span class="n">enable</span> <span class="o">=</span> <span class="kc">true</span>
            <span class="p">},</span>
            <span class="n">completion</span> <span class="o">=</span> <span class="p">{</span>
                <span class="n">snippets</span> <span class="o">=</span> <span class="p">{</span>
                    <span class="n">arc</span> <span class="o">=</span> <span class="p">{</span>
                        <span class="n">postfix</span> <span class="o">=</span> <span class="s2">"arc"</span><span class="p">,</span>
                        <span class="n">body</span> <span class="o">=</span> <span class="s2">"Arc::new(${receiver})"</span><span class="p">,</span>
                        <span class="n">scope</span> <span class="o">=</span> <span class="s2">"expr"</span><span class="p">,</span>
                        <span class="n">requires</span> <span class="o">=</span> <span class="s2">"std::sync::Arc"</span><span class="p">,</span>
                    <span class="p">}</span>
                <span class="p">}</span>
            <span class="p">},</span>
        <span class="p">}</span>

    <span class="p">}</span>
<span class="p">})</span>
</code></pre></div>



<a name="258599674"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/185405-t-compiler/rust-analyzer/topic/nvim%2Bnvim-lsp%20rustc_private/near/258599674" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> matklad <a href="https://zulip-archive.rust-lang.org/stream/185405-t-compiler/rust-analyzer/topic/nvim.2Bnvim-lsp.20rustc_private.html#258599674">(Oct 21 2021 at 19:02)</a>:</h4>
<p><span aria-label="thinking" class="emoji emoji-1f914" role="img" title="thinking">:thinking:</span> I wonder if nvim can print some kind of diagnistics here? When I was playing with it, figuring out the exact syntax to use for settings was a pain as well.</p>



<a name="258599895"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/185405-t-compiler/rust-analyzer/topic/nvim%2Bnvim-lsp%20rustc_private/near/258599895" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> divma <a href="https://zulip-archive.rust-lang.org/stream/185405-t-compiler/rust-analyzer/topic/nvim.2Bnvim-lsp.20rustc_private.html#258599895">(Oct 21 2021 at 19:03)</a>:</h4>
<p>at some point I even added a <code>garbage: asdfas</code>entry to check if it would complain or something.. it is confusing  to get it right</p>



<a name="258599920"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/185405-t-compiler/rust-analyzer/topic/nvim%2Bnvim-lsp%20rustc_private/near/258599920" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> divma <a href="https://zulip-archive.rust-lang.org/stream/185405-t-compiler/rust-analyzer/topic/nvim.2Bnvim-lsp.20rustc_private.html#258599920">(Oct 21 2021 at 19:03)</a>:</h4>
<p>(it did not complain ofc)</p>



<a name="258600100"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/185405-t-compiler/rust-analyzer/topic/nvim%2Bnvim-lsp%20rustc_private/near/258600100" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> matklad <a href="https://zulip-archive.rust-lang.org/stream/185405-t-compiler/rust-analyzer/topic/nvim.2Bnvim-lsp.20rustc_private.html#258600100">(Oct 21 2021 at 19:05)</a>:</h4>
<p>Seems like a good idea to open an issue upstream about emitting a warning for an unknown key in this case!</p>



<a name="258603416"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/185405-t-compiler/rust-analyzer/topic/nvim%2Bnvim-lsp%20rustc_private/near/258603416" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Laurențiu <a href="https://zulip-archive.rust-lang.org/stream/185405-t-compiler/rust-analyzer/topic/nvim.2Bnvim-lsp.20rustc_private.html#258603416">(Oct 21 2021 at 19:29)</a>:</h4>
<p>How does that work? You're not setting <code>init_options</code>.</p>



<a name="258604809"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/185405-t-compiler/rust-analyzer/topic/nvim%2Bnvim-lsp%20rustc_private/near/258604809" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Laurențiu <a href="https://zulip-archive.rust-lang.org/stream/185405-t-compiler/rust-analyzer/topic/nvim.2Bnvim-lsp.20rustc_private.html#258604809">(Oct 21 2021 at 19:39)</a>:</h4>
<p>I changed mine to <code>init_options</code> and I see it passed in the LSP log like in Code, but it's still not working</p>



<a name="258612276"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/185405-t-compiler/rust-analyzer/topic/nvim%2Bnvim-lsp%20rustc_private/near/258612276" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> divma <a href="https://zulip-archive.rust-lang.org/stream/185405-t-compiler/rust-analyzer/topic/nvim.2Bnvim-lsp.20rustc_private.html#258612276">(Oct 21 2021 at 20:30)</a>:</h4>
<p><span class="user-mention silent" data-user-id="203546">Laurențiu</span> <a href="#narrow/stream/185405-t-compiler.2Frust-analyzer/topic/nvim.2Bnvim-lsp.20rustc_private/near/258604809">said</a>:</p>
<blockquote>
<p>I changed mine to <code>init_options</code> and I see it passed in the LSP log like in Code, but it's still not working</p>
</blockquote>
<p>In the lspconfig repo they had a minimal config added this year (my wrong config is at least two years old). I edited it to get the bare bare minimals</p>



<a name="258612287"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/185405-t-compiler/rust-analyzer/topic/nvim%2Bnvim-lsp%20rustc_private/near/258612287" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> divma <a href="https://zulip-archive.rust-lang.org/stream/185405-t-compiler/rust-analyzer/topic/nvim.2Bnvim-lsp.20rustc_private.html#258612287">(Oct 21 2021 at 20:30)</a>:</h4>
<p>Here it is:</p>



<a name="258612324"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/185405-t-compiler/rust-analyzer/topic/nvim%2Bnvim-lsp%20rustc_private/near/258612324" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> divma <a href="https://zulip-archive.rust-lang.org/stream/185405-t-compiler/rust-analyzer/topic/nvim.2Bnvim-lsp.20rustc_private.html#258612324">(Oct 21 2021 at 20:30)</a>:</h4>
<div class="codehilite" data-code-language="Lua"><pre><span></span><code><span class="n">vim</span><span class="p">.</span><span class="n">cmd</span> <span class="s">[[set runtimepath=$VIMRUNTIME]]</span>
<span class="n">vim</span><span class="p">.</span><span class="n">cmd</span> <span class="s">[[set packpath=/tmp/nvim/site]]</span>

<span class="kd">local</span> <span class="n">package_root</span> <span class="o">=</span> <span class="s1">'/tmp/nvim/site/pack'</span>
<span class="kd">local</span> <span class="n">install_path</span> <span class="o">=</span> <span class="n">package_root</span> <span class="o">..</span> <span class="s1">'/packer/start/packer.nvim'</span>

<span class="c1">-- get a package manager without too much hassle.</span>
<span class="kd">local</span> <span class="kr">function</span> <span class="nf">load_plugins</span><span class="p">()</span>
  <span class="nb">require</span><span class="p">(</span><span class="s1">'packer'</span><span class="p">).</span><span class="n">startup</span> <span class="p">{</span>
    <span class="p">{</span>
      <span class="s1">'wbthomason/packer.nvim'</span><span class="p">,</span>
      <span class="s1">'neovim/nvim-lspconfig'</span><span class="p">,</span>
    <span class="p">},</span>
    <span class="n">config</span> <span class="o">=</span> <span class="p">{</span>
      <span class="n">package_root</span> <span class="o">=</span> <span class="n">package_root</span><span class="p">,</span>
      <span class="n">compile_path</span> <span class="o">=</span> <span class="n">install_path</span> <span class="o">..</span> <span class="s1">'/plugin/packer_compiled.lua'</span><span class="p">,</span>
    <span class="p">},</span>
  <span class="p">}</span>
<span class="kr">end</span>

<span class="n">_G</span><span class="p">.</span><span class="n">load_config</span> <span class="o">=</span> <span class="kr">function</span><span class="p">()</span>
    <span class="n">vim</span><span class="p">.</span><span class="n">lsp</span><span class="p">.</span><span class="n">set_log_level</span><span class="p">(</span><span class="s1">'trace'</span><span class="p">)</span>
    <span class="nb">require</span><span class="p">(</span><span class="s1">'lspconfig'</span><span class="p">).</span><span class="n">rust_analyzer</span><span class="p">.</span><span class="n">setup</span> <span class="p">{</span>
        <span class="n">on_attach</span> <span class="o">=</span> <span class="n">on_attach</span><span class="p">,</span>
        <span class="n">settings</span> <span class="o">=</span> <span class="p">{</span>
            <span class="p">[</span><span class="s2">"rust-analyzer"</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
                <span class="n">rustcSource</span> <span class="o">=</span> <span class="s2">"discover"</span><span class="p">,</span>
                <span class="n">procMacro</span> <span class="o">=</span> <span class="p">{</span>
                    <span class="n">enable</span> <span class="o">=</span> <span class="kc">true</span>
                <span class="p">},</span>
            <span class="p">}</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="kr">end</span>

<span class="kr">if</span> <span class="n">vim</span><span class="p">.</span><span class="n">fn</span><span class="p">.</span><span class="n">isdirectory</span><span class="p">(</span><span class="n">install_path</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span> <span class="kr">then</span>
  <span class="n">vim</span><span class="p">.</span><span class="n">fn</span><span class="p">.</span><span class="n">system</span> <span class="p">{</span> <span class="s1">'git'</span><span class="p">,</span> <span class="s1">'clone'</span><span class="p">,</span> <span class="s1">'https://github.com/wbthomason/packer.nvim'</span><span class="p">,</span> <span class="n">install_path</span> <span class="p">}</span>
  <span class="n">load_plugins</span><span class="p">()</span>
  <span class="nb">require</span><span class="p">(</span><span class="s1">'packer'</span><span class="p">).</span><span class="n">sync</span><span class="p">()</span>
  <span class="n">vim</span><span class="p">.</span><span class="n">cmd</span> <span class="s">[[autocmd User PackerComplete ++once lua load_config()]]</span>
<span class="kr">else</span>
  <span class="n">load_plugins</span><span class="p">()</span>
  <span class="nb">require</span><span class="p">(</span><span class="s1">'packer'</span><span class="p">).</span><span class="n">sync</span><span class="p">()</span>
  <span class="n">_G</span><span class="p">.</span><span class="n">load_config</span><span class="p">()</span>
<span class="kr">end</span>
</code></pre></div>



<a name="258612342"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/185405-t-compiler/rust-analyzer/topic/nvim%2Bnvim-lsp%20rustc_private/near/258612342" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> divma <a href="https://zulip-archive.rust-lang.org/stream/185405-t-compiler/rust-analyzer/topic/nvim.2Bnvim-lsp.20rustc_private.html#258612342">(Oct 21 2021 at 20:30)</a>:</h4>
<p>that's a <code>init.lua</code></p>



<a name="258612408"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/185405-t-compiler/rust-analyzer/topic/nvim%2Bnvim-lsp%20rustc_private/near/258612408" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> divma <a href="https://zulip-archive.rust-lang.org/stream/185405-t-compiler/rust-analyzer/topic/nvim.2Bnvim-lsp.20rustc_private.html#258612408">(Oct 21 2021 at 20:31)</a>:</h4>
<p>and now you call vim <code>nvim -u path_to/init.lua path_to/rust_file.rs</code></p>



<a name="258612461"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/185405-t-compiler/rust-analyzer/topic/nvim%2Bnvim-lsp%20rustc_private/near/258612461" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> divma <a href="https://zulip-archive.rust-lang.org/stream/185405-t-compiler/rust-analyzer/topic/nvim.2Bnvim-lsp.20rustc_private.html#258612461">(Oct 21 2021 at 20:31)</a>:</h4>
<p>I tried it inside clippy and I get hover with rustc_* and the rest as well</p>



<a name="258612682"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/185405-t-compiler/rust-analyzer/topic/nvim%2Bnvim-lsp%20rustc_private/near/258612682" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> divma <a href="https://zulip-archive.rust-lang.org/stream/185405-t-compiler/rust-analyzer/topic/nvim.2Bnvim-lsp.20rustc_private.html#258612682">(Oct 21 2021 at 20:32)</a>:</h4>
<p>by calling <code>lua vim.lsp.buf.hover()</code>while the cursor is somewhere relevant. I didn't even add key mappings..</p>



<a name="258613469"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/185405-t-compiler/rust-analyzer/topic/nvim%2Bnvim-lsp%20rustc_private/near/258613469" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> divma <a href="https://zulip-archive.rust-lang.org/stream/185405-t-compiler/rust-analyzer/topic/nvim.2Bnvim-lsp.20rustc_private.html#258613469">(Oct 21 2021 at 20:38)</a>:</h4>
<p>maybe with that you can check what's different and why is the config you have still not working</p>



<a name="258614038"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/185405-t-compiler/rust-analyzer/topic/nvim%2Bnvim-lsp%20rustc_private/near/258614038" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Notification Bot <a href="https://zulip-archive.rust-lang.org/stream/185405-t-compiler/rust-analyzer/topic/nvim.2Bnvim-lsp.20rustc_private.html#258614038">(Oct 21 2021 at 20:42)</a>:</h4>
<p><span class="user-mention silent" data-user-id="259439">divma</span> has marked this topic as resolved.</p>



<a name="258614059"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/185405-t-compiler/rust-analyzer/topic/nvim%2Bnvim-lsp%20rustc_private/near/258614059" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Notification Bot <a href="https://zulip-archive.rust-lang.org/stream/185405-t-compiler/rust-analyzer/topic/nvim.2Bnvim-lsp.20rustc_private.html#258614059">(Oct 21 2021 at 20:42)</a>:</h4>
<p><span class="user-mention silent" data-user-id="259439">divma</span> has marked this topic as unresolved.</p>



<a name="258636212"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/185405-t-compiler/rust-analyzer/topic/nvim%2Bnvim-lsp%20rustc_private/near/258636212" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> sim <a href="https://zulip-archive.rust-lang.org/stream/185405-t-compiler/rust-analyzer/topic/nvim.2Bnvim-lsp.20rustc_private.html#258636212">(Oct 21 2021 at 23:56)</a>:</h4>
<p>should we add this to the rust-tools wiki?</p>



<a name="258836834"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/185405-t-compiler/rust-analyzer/topic/nvim%2Bnvim-lsp%20rustc_private/near/258836834" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Laurențiu <a href="https://zulip-archive.rust-lang.org/stream/185405-t-compiler/rust-analyzer/topic/nvim.2Bnvim-lsp.20rustc_private.html#258836834">(Oct 23 2021 at 18:36)</a>:</h4>
<p><span class="user-mention silent" data-user-id="259439">divma</span> <a href="#narrow/stream/185405-t-compiler.2Frust-analyzer/topic/nvim.2Bnvim-lsp.20rustc_private/near/258613469">said</a>:</p>
<blockquote>
<p>maybe with that you can check what's different and why is the config you have still not working</p>
</blockquote>
<p>Well, everything is different: my <code>init.vim</code> is Vimscript with some bits of Lua, I'm using a different plugin manager and a different Rust plugin (<code>rust-tools</code>).</p>



<a name="258836916"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/185405-t-compiler/rust-analyzer/topic/nvim%2Bnvim-lsp%20rustc_private/near/258836916" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Laurențiu <a href="https://zulip-archive.rust-lang.org/stream/185405-t-compiler/rust-analyzer/topic/nvim.2Bnvim-lsp.20rustc_private.html#258836916">(Oct 23 2021 at 18:38)</a>:</h4>
<p>I should probably look into it, but I'll need to spend a week-end on this, or on trying to make this <del>awful</del> Bluetooth mouse work on the awful Linux Bluetooth stack and TBH neither option seems too appealing. <span aria-label="sweat smile" class="emoji emoji-1f605" role="img" title="sweat smile">:sweat_smile:</span></p>



<hr><p>Last updated: Apr 12 2022 at 20:01 UTC</p>
</html>