<html>
<head><meta charset="utf-8"><title>IDE broken in `#[test]` functions · t-compiler/rust-analyzer · Zulip Chat Archive</title></head>
<h2>Stream: <a href="https://zulip-archive.rust-lang.org/stream/185405-t-compiler/rust-analyzer/index.html">t-compiler/rust-analyzer</a></h2>
<h3>Topic: <a href="https://zulip-archive.rust-lang.org/stream/185405-t-compiler/rust-analyzer/topic/IDE.20broken.20in.20.60.23.5Btest.5D.60.20functions.html">IDE broken in `#[test]` functions</a></h3>

<hr>

<base href="https://rust-lang.zulipchat.com">

<head><link href="https://zulip-archive.rust-lang.org/style.css" rel="stylesheet"></head>

<a name="250766582"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/185405-t-compiler/rust-analyzer/topic/IDE%20broken%20in%20%60%23%5Btest%5D%60%20functions/near/250766582" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jonas Schievink  [he/him] <a href="https://zulip-archive.rust-lang.org/stream/185405-t-compiler/rust-analyzer/topic/IDE.20broken.20in.20.60.23.5Btest.5D.60.20functions.html#250766582">(Aug 26 2021 at 12:54)</a>:</h4>
<p><a href="/user_uploads/4715/gDT7zk8ZapvvcMpFx-YNtoCK/screenshot-2021-08-26-145159.png">screenshot-2021-08-26-145159.png</a> </p>
<div class="message_inline_image"><a href="/user_uploads/4715/gDT7zk8ZapvvcMpFx-YNtoCK/screenshot-2021-08-26-145159.png" title="screenshot-2021-08-26-145159.png"><img src="/user_uploads/4715/gDT7zk8ZapvvcMpFx-YNtoCK/screenshot-2021-08-26-145159.png"></a></div><p>We seem to have lost IDE functionality in <code>#[test]</code> functions, does anyone know what happened there?</p>



<a name="250766729"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/185405-t-compiler/rust-analyzer/topic/IDE%20broken%20in%20%60%23%5Btest%5D%60%20functions/near/250766729" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lukas Wirth <a href="https://zulip-archive.rust-lang.org/stream/185405-t-compiler/rust-analyzer/topic/IDE.20broken.20in.20.60.23.5Btest.5D.60.20functions.html#250766729">(Aug 26 2021 at 12:55)</a>:</h4>
<p>We expand the test attribute now(to just the item itself again)</p>



<a name="250766879"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/185405-t-compiler/rust-analyzer/topic/IDE%20broken%20in%20%60%23%5Btest%5D%60%20functions/near/250766879" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lukas Wirth <a href="https://zulip-archive.rust-lang.org/stream/185405-t-compiler/rust-analyzer/topic/IDE.20broken.20in.20.60.23.5Btest.5D.60.20functions.html#250766879">(Aug 26 2021 at 12:56)</a>:</h4>
<p>So completions don't work and inlay hints are lost</p>



<a name="250766894"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/185405-t-compiler/rust-analyzer/topic/IDE%20broken%20in%20%60%23%5Btest%5D%60%20functions/near/250766894" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lukas Wirth <a href="https://zulip-archive.rust-lang.org/stream/185405-t-compiler/rust-analyzer/topic/IDE.20broken.20in.20.60.23.5Btest.5D.60.20functions.html#250766894">(Aug 26 2021 at 12:56)</a>:</h4>
<p>not sure why we lose more stuff like highlighting though</p>



<a name="250767009"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/185405-t-compiler/rust-analyzer/topic/IDE%20broken%20in%20%60%23%5Btest%5D%60%20functions/near/250767009" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jonas Schievink  [he/him] <a href="https://zulip-archive.rust-lang.org/stream/185405-t-compiler/rust-analyzer/topic/IDE.20broken.20in.20.60.23.5Btest.5D.60.20functions.html#250767009">(Aug 26 2021 at 12:57)</a>:</h4>
<p>Is "Expand Macro Recursively" now mutually recursive with <code>!</code>-macros? Because the output still contains the <code>assert!</code>, so maybe we fail to expand that for some reason</p>



<a name="250767061"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/185405-t-compiler/rust-analyzer/topic/IDE%20broken%20in%20%60%23%5Btest%5D%60%20functions/near/250767061" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lukas Wirth <a href="https://zulip-archive.rust-lang.org/stream/185405-t-compiler/rust-analyzer/topic/IDE.20broken.20in.20.60.23.5Btest.5D.60.20functions.html#250767061">(Aug 26 2021 at 12:58)</a>:</h4>
<p>No expand macro recursively only expands one of the two recursively</p>



<a name="250767107"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/185405-t-compiler/rust-analyzer/topic/IDE%20broken%20in%20%60%23%5Btest%5D%60%20functions/near/250767107" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jonas Schievink  [he/him] <a href="https://zulip-archive.rust-lang.org/stream/185405-t-compiler/rust-analyzer/topic/IDE.20broken.20in.20.60.23.5Btest.5D.60.20functions.html#250767107">(Aug 26 2021 at 12:58)</a>:</h4>
<p>ah</p>



<a name="250767109"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/185405-t-compiler/rust-analyzer/topic/IDE%20broken%20in%20%60%23%5Btest%5D%60%20functions/near/250767109" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lukas Wirth <a href="https://zulip-archive.rust-lang.org/stream/185405-t-compiler/rust-analyzer/topic/IDE.20broken.20in.20.60.23.5Btest.5D.60.20functions.html#250767109">(Aug 26 2021 at 12:58)</a>:</h4>
<p>so in this case it only expands the attributes</p>



<a name="250767152"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/185405-t-compiler/rust-analyzer/topic/IDE%20broken%20in%20%60%23%5Btest%5D%60%20functions/near/250767152" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lukas Wirth <a href="https://zulip-archive.rust-lang.org/stream/185405-t-compiler/rust-analyzer/topic/IDE.20broken.20in.20.60.23.5Btest.5D.60.20functions.html#250767152">(Aug 26 2021 at 12:58)</a>:</h4>
<p>but ye this seems to be an issue with bang macros inside attributes?</p>



<a name="250767180"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/185405-t-compiler/rust-analyzer/topic/IDE%20broken%20in%20%60%23%5Btest%5D%60%20functions/near/250767180" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lukas Wirth <a href="https://zulip-archive.rust-lang.org/stream/185405-t-compiler/rust-analyzer/topic/IDE.20broken.20in.20.60.23.5Btest.5D.60.20functions.html#250767180">(Aug 26 2021 at 12:58)</a>:</h4>
<p>highlighting works fine for anything other than bang macro input</p>



<a name="250767187"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/185405-t-compiler/rust-analyzer/topic/IDE%20broken%20in%20%60%23%5Btest%5D%60%20functions/near/250767187" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lukas Wirth <a href="https://zulip-archive.rust-lang.org/stream/185405-t-compiler/rust-analyzer/topic/IDE.20broken.20in.20.60.23.5Btest.5D.60.20functions.html#250767187">(Aug 26 2021 at 12:58)</a>:</h4>
<p><span aria-label="thinking" class="emoji emoji-1f914" role="img" title="thinking">:thinking:</span></p>



<a name="250767440"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/185405-t-compiler/rust-analyzer/topic/IDE%20broken%20in%20%60%23%5Btest%5D%60%20functions/near/250767440" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lukas Wirth <a href="https://zulip-archive.rust-lang.org/stream/185405-t-compiler/rust-analyzer/topic/IDE.20broken.20in.20.60.23.5Btest.5D.60.20functions.html#250767440">(Aug 26 2021 at 13:00)</a>:</h4>
<p>I guess token descending is only working on attributes when both are used</p>



<a name="250767562"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/185405-t-compiler/rust-analyzer/topic/IDE%20broken%20in%20%60%23%5Btest%5D%60%20functions/near/250767562" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> matklad <a href="https://zulip-archive.rust-lang.org/stream/185405-t-compiler/rust-analyzer/topic/IDE.20broken.20in.20.60.23.5Btest.5D.60.20functions.html#250767562">(Aug 26 2021 at 13:00)</a>:</h4>
<p>Is <code>#[test]</code> a macro though?</p>



<a name="250767593"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/185405-t-compiler/rust-analyzer/topic/IDE%20broken%20in%20%60%23%5Btest%5D%60%20functions/near/250767593" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> matklad <a href="https://zulip-archive.rust-lang.org/stream/185405-t-compiler/rust-analyzer/topic/IDE.20broken.20in.20.60.23.5Btest.5D.60.20functions.html#250767593">(Aug 26 2021 at 13:01)</a>:</h4>
<p>I thought it was just an attr?</p>



<a name="250767752"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/185405-t-compiler/rust-analyzer/topic/IDE%20broken%20in%20%60%23%5Btest%5D%60%20functions/near/250767752" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lukas Wirth <a href="https://zulip-archive.rust-lang.org/stream/185405-t-compiler/rust-analyzer/topic/IDE.20broken.20in.20.60.23.5Btest.5D.60.20functions.html#250767752">(Aug 26 2021 at 13:02)</a>:</h4>
<p>It is an attr living in <code>crate::macros::builtin::test</code> re-exported in the prelude</p>



<a name="250767894"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/185405-t-compiler/rust-analyzer/topic/IDE%20broken%20in%20%60%23%5Btest%5D%60%20functions/near/250767894" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> matklad <a href="https://zulip-archive.rust-lang.org/stream/185405-t-compiler/rust-analyzer/topic/IDE.20broken.20in.20.60.23.5Btest.5D.60.20functions.html#250767894">(Aug 26 2021 at 13:03)</a>:</h4>
<p>Huh.... Yeah, not sure what's the best solution here is then</p>



<a name="250767921"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/185405-t-compiler/rust-analyzer/topic/IDE%20broken%20in%20%60%23%5Btest%5D%60%20functions/near/250767921" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lukas Wirth <a href="https://zulip-archive.rust-lang.org/stream/185405-t-compiler/rust-analyzer/topic/IDE.20broken.20in.20.60.23.5Btest.5D.60.20functions.html#250767921">(Aug 26 2021 at 13:03)</a>:</h4>
<p>But we might want to keep it special cased after all as we don't gain anything from handling it as an identity expansion, we get some downsides from it only honestly, like duplicating all test functions which eats a bunch of memory</p>



<a name="250768440"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/185405-t-compiler/rust-analyzer/topic/IDE%20broken%20in%20%60%23%5Btest%5D%60%20functions/near/250768440" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> bjorn3 <a href="https://zulip-archive.rust-lang.org/stream/185405-t-compiler/rust-analyzer/topic/IDE.20broken.20in.20.60.23.5Btest.5D.60.20functions.html#250768440">(Aug 26 2021 at 13:06)</a>:</h4>
<p><span class="user-mention silent" data-user-id="133169">matklad</span> <a href="#narrow/stream/185405-t-compiler.2Frust-analyzer/topic/IDE.20broken.20in.20.60.23.5Btest.5D.60.20functions/near/250767562">said</a>:</p>
<blockquote>
<p>Is <code>#[test]</code> a macro though?</p>
</blockquote>
<p><code>#[test] fn foo() {}</code> expands to the following in rust:</p>
<div class="codehilite" data-code-language="Rust"><pre><span></span><code><span class="cp">#[cfg(test)]</span><span class="w"></span>
<span class="cp">#[rustc_test_marker]</span><span class="w"></span>
<span class="k">pub</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="n">foo</span>: <span class="nc">test</span>::<span class="n">TestDescAndFn</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">test</span>::<span class="n">TestDescAndFn</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="n">desc</span>: <span class="nc">test</span>::<span class="n">TestDesc</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">        </span><span class="n">name</span>: <span class="nc">test</span>::<span class="n">StaticTestName</span><span class="p">(</span><span class="s">"foo"</span><span class="p">),</span><span class="w"></span>
<span class="w">        </span><span class="n">ignore</span>: <span class="nc">false</span><span class="p">,</span><span class="w"></span>
<span class="w">        </span><span class="n">allow_fail</span>: <span class="nc">false</span><span class="p">,</span><span class="w"></span>
<span class="w">        </span><span class="n">compile_fail</span>: <span class="nc">false</span><span class="p">,</span><span class="w"></span>
<span class="w">        </span><span class="n">no_run</span>: <span class="nc">false</span><span class="p">,</span><span class="w"></span>
<span class="w">        </span><span class="n">should_panic</span>: <span class="nc">test</span>::<span class="n">ShouldPanic</span>::<span class="n">No</span><span class="p">,</span><span class="w"></span>
<span class="w">        </span><span class="n">test_type</span>: <span class="nc">test</span>::<span class="n">TestType</span>::<span class="n">Unknown</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="p">},</span><span class="w"></span>
<span class="w">    </span><span class="n">testfn</span>: <span class="nc">test</span>::<span class="n">StaticTestFn</span><span class="p">(</span><span class="o">||</span><span class="w"> </span><span class="n">test</span>::<span class="n">assert_test_result</span><span class="p">(</span><span class="n">foo</span><span class="p">())),</span><span class="w"></span>
<span class="p">};</span><span class="w"></span>
<span class="k">fn</span> <span class="nf">foo</span><span class="p">()</span><span class="w"> </span><span class="p">{}</span><span class="w"></span>
</code></pre></div>



<a name="250768469"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/185405-t-compiler/rust-analyzer/topic/IDE%20broken%20in%20%60%23%5Btest%5D%60%20functions/near/250768469" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jonas Schievink  [he/him] <a href="https://zulip-archive.rust-lang.org/stream/185405-t-compiler/rust-analyzer/topic/IDE.20broken.20in.20.60.23.5Btest.5D.60.20functions.html#250768469">(Aug 26 2021 at 13:06)</a>:</h4>
<p>Yeah, this change might not be worth it currently, losing most IDE functionality is a bit jarring</p>



<a name="250768846"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/185405-t-compiler/rust-analyzer/topic/IDE%20broken%20in%20%60%23%5Btest%5D%60%20functions/near/250768846" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> matklad <a href="https://zulip-archive.rust-lang.org/stream/185405-t-compiler/rust-analyzer/topic/IDE.20broken.20in.20.60.23.5Btest.5D.60.20functions.html#250768846">(Aug 26 2021 at 13:09)</a>:</h4>
<p><span aria-label="thinking" class="emoji emoji-1f914" role="img" title="thinking">:thinking:</span> </p>
<p>I wonder if we should have an "derive-like attr macro" feature?</p>



<a name="250768948"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/185405-t-compiler/rust-analyzer/topic/IDE%20broken%20in%20%60%23%5Btest%5D%60%20functions/near/250768948" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> matklad <a href="https://zulip-archive.rust-lang.org/stream/185405-t-compiler/rust-analyzer/topic/IDE.20broken.20in.20.60.23.5Btest.5D.60.20functions.html#250768948">(Aug 26 2021 at 13:10)</a>:</h4>
<p>That is, an attr macro that only adds items -- those are much easier to support in an IDE.</p>



<a name="250769044"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/185405-t-compiler/rust-analyzer/topic/IDE%20broken%20in%20%60%23%5Btest%5D%60%20functions/near/250769044" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> matklad <a href="https://zulip-archive.rust-lang.org/stream/185405-t-compiler/rust-analyzer/topic/IDE.20broken.20in.20.60.23.5Btest.5D.60.20functions.html#250769044">(Aug 26 2021 at 13:10)</a>:</h4>
<p>Well, probably not -- I was thinking about things like <code>tokio_main</code>, but they <em>need</em> to change the item, because they want to re-use the name. The <code>test</code> is special</p>



<a name="250769127"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/185405-t-compiler/rust-analyzer/topic/IDE%20broken%20in%20%60%23%5Btest%5D%60%20functions/near/250769127" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> matklad <a href="https://zulip-archive.rust-lang.org/stream/185405-t-compiler/rust-analyzer/topic/IDE.20broken.20in.20.60.23.5Btest.5D.60.20functions.html#250769127">(Aug 26 2021 at 13:11)</a>:</h4>
<p>wait, <span class="user-mention" data-user-id="133247">@bjorn3</span> are you sure that it expands to both const and the original fn? How does it work, they both are in the value namespace?</p>



<a name="250770287"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/185405-t-compiler/rust-analyzer/topic/IDE%20broken%20in%20%60%23%5Btest%5D%60%20functions/near/250770287" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> bjorn3 <a href="https://zulip-archive.rust-lang.org/stream/185405-t-compiler/rust-analyzer/topic/IDE.20broken.20in.20.60.23.5Btest.5D.60.20functions.html#250770287">(Aug 26 2021 at 13:19)</a>:</h4>
<p>Yes, I used <code>--test -Zunpretty=expanded</code></p>



<a name="250770619"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/185405-t-compiler/rust-analyzer/topic/IDE%20broken%20in%20%60%23%5Btest%5D%60%20functions/near/250770619" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lukas Wirth <a href="https://zulip-archive.rust-lang.org/stream/185405-t-compiler/rust-analyzer/topic/IDE.20broken.20in.20.60.23.5Btest.5D.60.20functions.html#250770619">(Aug 26 2021 at 13:22)</a>:</h4>
<p>Probably works due to hygiene right? The const name is def site, function name is call site I imagine?</p>



<a name="250770632"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/185405-t-compiler/rust-analyzer/topic/IDE%20broken%20in%20%60%23%5Btest%5D%60%20functions/near/250770632" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> bjorn3 <a href="https://zulip-archive.rust-lang.org/stream/185405-t-compiler/rust-analyzer/topic/IDE.20broken.20in.20.60.23.5Btest.5D.60.20functions.html#250770632">(Aug 26 2021 at 13:22)</a>:</h4>
<p>I think this works as <code>const foo</code> has a different hygiene context making it opaque to the rest of the code. <code>-Zunpretty=expanded,hygiene</code> gives:</p>
<div class="codehilite" data-code-language="Rust"><pre><span></span><code><span class="cp">#[cfg /* 324#3 */(test)]</span><span class="w"></span>
<span class="cp">#[rustc_test_marker /* 1070#3 */]</span><span class="w"></span>
<span class="k">pub</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="n">foo</span><span class="w"> </span><span class="cm">/* 1382#3 */</span>: <span class="nc">test</span><span class="w"> </span><span class="cm">/* 1231#3 */</span>::<span class="n">TestDescAndFn</span><span class="w"> </span><span class="cm">/* 1548#3 */</span><span class="w"> </span><span class="o">=</span><span class="w"></span>
<span class="w">    </span><span class="n">test</span><span class="w"> </span><span class="cm">/* 1231#3 */</span>::<span class="n">TestDescAndFn</span><span class="w"> </span><span class="cm">/* 1548#3</span>
<span class="cm">        */</span><span class="p">{</span><span class="n">desc</span><span class="w"> </span><span class="cm">/* 1557#3 */</span>:
               <span class="nc">test</span><span class="w"> </span><span class="cm">/* 1231#3 */</span>::<span class="n">TestDesc</span><span class="w"> </span><span class="cm">/* 1549#3</span>
<span class="cm">                   */</span><span class="p">{</span><span class="n">name</span><span class="w"> </span><span class="cm">/* 779#3 */</span>:
                          <span class="nc">test</span><span class="w"> </span><span class="cm">/* 1231#3 */</span>::<span class="n">StaticTestName</span><span class="w"> </span><span class="cm">/* 1550#3</span>
<span class="cm">                              */</span><span class="p">(</span><span class="s">"foo"</span><span class="p">),</span><span class="w"></span>
<span class="w">                      </span><span class="n">ignore</span><span class="w"> </span><span class="cm">/* 634#3 */</span>: <span class="nc">false</span><span class="p">,</span><span class="w"></span>
<span class="w">                      </span><span class="n">allow_fail</span><span class="w"> </span><span class="cm">/* 240#3 */</span>: <span class="nc">false</span><span class="p">,</span><span class="w"></span>
<span class="w">                      </span><span class="n">compile_fail</span><span class="w"> </span><span class="cm">/* 1551#3 */</span>: <span class="nc">false</span><span class="p">,</span><span class="w"></span>
<span class="w">                      </span><span class="n">no_run</span><span class="w"> </span><span class="cm">/* 1552#3 */</span>: <span class="nc">false</span><span class="p">,</span><span class="w"></span>
<span class="w">                      </span><span class="n">should_panic</span><span class="w"> </span><span class="cm">/* 1088#3 */</span>:
                          <span class="nc">test</span><span class="w"> </span><span class="cm">/* 1231#3 */</span>::<span class="n">ShouldPanic</span><span class="w"> </span><span class="cm">/* 1553#3 */</span>::<span class="n">No</span><span class="w"> </span><span class="cm">/*</span>
<span class="cm">                              1554#3 */</span><span class="p">,</span><span class="w"></span>
<span class="w">                      </span><span class="n">test_type</span><span class="w"> </span><span class="cm">/* 1556#3 */</span>:
                          <span class="nc">test</span><span class="w"> </span><span class="cm">/* 1231#3 */</span>::<span class="n">TestType</span><span class="w"> </span><span class="cm">/* 1555#3 */</span>::<span class="n">Unknown</span><span class="w"> </span><span class="cm">/*</span>
<span class="cm">                              193#3 */</span><span class="p">,},</span><span class="w"></span>
<span class="w">           </span><span class="n">testfn</span><span class="w"> </span><span class="cm">/* 1558#3 */</span>:
               <span class="nc">test</span><span class="w"> </span><span class="cm">/* 1231#3 */</span>::<span class="n">StaticTestFn</span><span class="w"> </span><span class="cm">/* 1546#3</span>
<span class="cm">                   */</span><span class="p">(</span><span class="o">||</span><span class="w"></span>
<span class="w">                          </span><span class="n">test</span><span class="w"> </span><span class="cm">/* 1231#3 */</span>::<span class="n">assert_test_result</span><span class="w"> </span><span class="cm">/* 1547#3</span>
<span class="cm">                              */</span><span class="p">(</span><span class="n">foo</span><span class="w"> </span><span class="cm">/* 1382#0 */</span><span class="p">())),};</span><span class="w"></span>
<span class="k">fn</span> <span class="nf">foo</span><span class="w"> </span><span class="cm">/* 1382#0 */</span><span class="p">()</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="p">}</span><span class="w"></span>
<span class="cp">#[rustc_main /* 1042#4 */]</span><span class="w"></span>
<span class="k">pub</span><span class="w"> </span><span class="k">fn</span> <span class="nf">main</span><span class="w"> </span><span class="cm">/* 723#4 */</span><span class="p">()</span><span class="w"> </span>-&gt; <span class="p">()</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="k">extern</span><span class="w"> </span><span class="k">crate</span><span class="w"> </span><span class="n">test</span><span class="w"> </span><span class="cm">/* 1231#4 */</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">test</span><span class="w"> </span><span class="cm">/* 1231#4 */</span>::<span class="n">test_main_static</span><span class="w"> </span><span class="cm">/* 1562#4 */</span><span class="p">(</span><span class="o">&amp;</span><span class="p">[</span><span class="o">&amp;</span><span class="n">foo</span><span class="w"> </span><span class="cm">/* 1382#5 */</span><span class="p">])</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="cm">/*</span>
<span class="cm">Expansions:</span>
<span class="cm">crate0::{{expn0}}: parent: crate0::{{expn0}}, call_site_ctxt: #0, def_site_ctxt: #0, kind: Root</span>
<span class="cm">crate0::{{expn1}}: parent: crate0::{{expn0}}, call_site_ctxt: #0, def_site_ctxt: #0, kind: AstPass(StdImports)</span>
<span class="cm">crate0::{{expn2}}: parent: crate0::{{expn0}}, call_site_ctxt: #0, def_site_ctxt: #0, kind: Macro(Attr, "test")</span>
<span class="cm">crate0::{{expn3}}: parent: crate0::{{expn0}}, call_site_ctxt: #0, def_site_ctxt: #0, kind: AstPass(TestHarness)</span>
<span class="cm">crate0::{{expn4}}: parent: crate0::{{expn0}}, call_site_ctxt: #0, def_site_ctxt: #0, kind: AstPass(TestHarness)</span>

<span class="cm">SyntaxContexts:</span>
<span class="cm">#0: parent: #0, outer_mark: (crate0::{{expn0}}, Opaque)</span>
<span class="cm">#1: parent: #0, outer_mark: (crate0::{{expn1}}, Opaque)</span>
<span class="cm">#2: parent: #0, outer_mark: (crate0::{{expn1}}, Transparent)</span>
<span class="cm">#3: parent: #0, outer_mark: (crate0::{{expn2}}, Opaque)</span>
<span class="cm">#4: parent: #0, outer_mark: (crate0::{{expn3}}, Opaque)</span>
<span class="cm">#5: parent: #3, outer_mark: (crate0::{{expn4}}, Opaque)</span>
<span class="cm">*/</span><span class="w"></span>
</code></pre></div>
<p>Syntax context <code>#3</code> is opaque.</p>



<hr><p>Last updated: Apr 12 2022 at 20:01 UTC</p>
</html>