<html>
<head><meta charset="utf-8"><title>Trying to load documentation of an item brakes everything · t-compiler/rust-analyzer · Zulip Chat Archive</title></head>
<h2>Stream: <a href="https://zulip-archive.rust-lang.org/stream/185405-t-compiler/rust-analyzer/index.html">t-compiler/rust-analyzer</a></h2>
<h3>Topic: <a href="https://zulip-archive.rust-lang.org/stream/185405-t-compiler/rust-analyzer/topic/Trying.20to.20load.20documentation.20of.20an.20item.20brakes.20everything.html">Trying to load documentation of an item brakes everything</a></h3>

<hr>

<base href="https://rust-lang.zulipchat.com">

<head><link href="https://zulip-archive.rust-lang.org/style.css" rel="stylesheet"></head>

<a name="268272361"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/185405-t-compiler/rust-analyzer/topic/Trying%20to%20load%20documentation%20of%20an%20item%20brakes%20everything/near/268272361" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Waffle Lapkin <a href="https://zulip-archive.rust-lang.org/stream/185405-t-compiler/rust-analyzer/topic/Trying.20to.20load.20documentation.20of.20an.20item.20brakes.20everything.html#268272361">(Jan 17 2022 at 13:47)</a>:</h4>
<p>I'm observing some weird behaviour from RA: when I'm loading documentation of <code>tokio::mpsc::Receiver</code> in a particular file, documentation stops loading even for other items in the project until I restart the server. </p>
<p>Here is a demonstration: <a href="https://www.youtube.com/watch?v=4ON8gtWC61I">https://www.youtube.com/watch?v=4ON8gtWC61I</a></p>
<div class="youtube-video message_inline_image"><a data-id="4ON8gtWC61I" href="https://www.youtube.com/watch?v=4ON8gtWC61I"><img src="https://uploads.zulipusercontent.net/23b512832ecbc87075df290eba122d39192b264d/68747470733a2f2f692e7974696d672e636f6d2f76692f344f4e38677457433631492f64656661756c742e6a7067"></a></div><ul>
<li>Documentation works fine</li>
<li>I'm trying to load documentation of <code>tokio::mpsc::Receiver</code></li>
<li>Documentation brakes in the entire project</li>
</ul>
<p>Here is the project @ commit that is problematic: <a href="https://github.com/teloxide/teloxide-core/tree/f1daac243ab6237d4de7bc08adf3ff151e6e8017">https://github.com/teloxide/teloxide-core/tree/f1daac243ab6237d4de7bc08adf3ff151e6e8017</a></p>
<p>This doesn't happen <em>every</em> time, but reloading until it doesn't break is annoying</p>



<a name="268274125"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/185405-t-compiler/rust-analyzer/topic/Trying%20to%20load%20documentation%20of%20an%20item%20brakes%20everything/near/268274125" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Laurențiu <a href="https://zulip-archive.rust-lang.org/stream/185405-t-compiler/rust-analyzer/topic/Trying.20to.20load.20documentation.20of.20an.20item.20brakes.20everything.html#268274125">(Jan 17 2022 at 14:01)</a>:</h4>
<p>Ouch, do you have anything in the logs?</p>



<a name="268274157"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/185405-t-compiler/rust-analyzer/topic/Trying%20to%20load%20documentation%20of%20an%20item%20brakes%20everything/near/268274157" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Laurențiu <a href="https://zulip-archive.rust-lang.org/stream/185405-t-compiler/rust-analyzer/topic/Trying.20to.20load.20documentation.20of.20an.20item.20brakes.20everything.html#268274157">(Jan 17 2022 at 14:01)</a>:</h4>
<p>Also, the initial load seems painfully slow</p>



<a name="268274905"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/185405-t-compiler/rust-analyzer/topic/Trying%20to%20load%20documentation%20of%20an%20item%20brakes%20everything/near/268274905" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Laurențiu <a href="https://zulip-archive.rust-lang.org/stream/185405-t-compiler/rust-analyzer/topic/Trying.20to.20load.20documentation.20of.20an.20item.20brakes.20everything.html#268274905">(Jan 17 2022 at 14:07)</a>:</h4>
<p><a href="/user_uploads/4715/I8Yp60yxUP5ak2P77M__OFl2/image.png">image.png</a></p>
<div class="message_inline_image"><a href="/user_uploads/4715/I8Yp60yxUP5ak2P77M__OFl2/image.png" title="image.png"><img src="/user_uploads/4715/I8Yp60yxUP5ak2P77M__OFl2/image.png"></a></div>



<a name="268274930"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/185405-t-compiler/rust-analyzer/topic/Trying%20to%20load%20documentation%20of%20an%20item%20brakes%20everything/near/268274930" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Laurențiu <a href="https://zulip-archive.rust-lang.org/stream/185405-t-compiler/rust-analyzer/topic/Trying.20to.20load.20documentation.20of.20an.20item.20brakes.20everything.html#268274930">(Jan 17 2022 at 14:07)</a>:</h4>
<p>It seems to work for me (looks like there's a small bug  rendering a link, though?)</p>



<a name="268275049"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/185405-t-compiler/rust-analyzer/topic/Trying%20to%20load%20documentation%20of%20an%20item%20brakes%20everything/near/268275049" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Laurențiu <a href="https://zulip-archive.rust-lang.org/stream/185405-t-compiler/rust-analyzer/topic/Trying.20to.20load.20documentation.20of.20an.20item.20brakes.20everything.html#268275049">(Jan 17 2022 at 14:08)</a>:</h4>
<p>Cache priming takes 8.3 s here</p>



<a name="268275056"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/185405-t-compiler/rust-analyzer/topic/Trying%20to%20load%20documentation%20of%20an%20item%20brakes%20everything/near/268275056" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lukas Wirth <a href="https://zulip-archive.rust-lang.org/stream/185405-t-compiler/rust-analyzer/topic/Trying.20to.20load.20documentation.20of.20an.20item.20brakes.20everything.html#268275056">(Jan 17 2022 at 14:08)</a>:</h4>
<p>The  link bug is known, its a problem with outline links with backticks which I think is a bug in <code>pulldown_cmark_to_cmark</code> <a href="https://github.com/rust-analyzer/rust-analyzer/issues/11008">r-a#11008</a></p>



<a name="268275993"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/185405-t-compiler/rust-analyzer/topic/Trying%20to%20load%20documentation%20of%20an%20item%20brakes%20everything/near/268275993" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Waffle Lapkin <a href="https://zulip-archive.rust-lang.org/stream/185405-t-compiler/rust-analyzer/topic/Trying.20to.20load.20documentation.20of.20an.20item.20brakes.20everything.html#268275993">(Jan 17 2022 at 14:17)</a>:</h4>
<p><span class="user-mention silent" data-user-id="203546">Laurențiu</span> <a href="#narrow/stream/185405-t-compiler.2Frust-analyzer/topic/Trying.20to.20load.20documentation.20of.20an.20item.20brakes.20everything/near/268274125">said</a>:</p>
<blockquote>
<p>Ouch, do you have anything in the logs?</p>
</blockquote>
<p>I have a couple of timeouts:</p>
<div class="codehilite" data-code-language="Text only"><pre><span></span><code>WARN [1/17/2022, 5:13:52 PM]: LSP request timed out {
  method: 'rust-analyzer/inlayHints',
  param: {
    textDocument: {
      uri: 'file:///home/waffle/projects/repos/teloxide-core/src/adaptors/throttle.rs'
    }
  },
  error: [$i [Error]: canceled by client
    at Gt (/home/waffle/.vscode/extensions/matklad.rust-analyzer-0.3.907/out/main.js:4:223)
    at rn (/home/waffle/.vscode/extensions/matklad.rust-analyzer-0.3.907/out/main.js:3:6520)
    at Immediate.&lt;anonymous&gt; (/home/waffle/.vscode/extensions/matklad.rust-analyzer-0.3.907/out/main.js:3:6373)
    at processImmediate (internal/timers.js:461:21)] {
    code: -32800,
    data: undefined
  }
}
WARN [1/17/2022, 5:14:10 PM]: LSP request timed out {
  method: 'rust-analyzer/inlayHints',
  param: {
    textDocument: {
      uri: 'file:///home/waffle/projects/repos/teloxide-core/src/adaptors/throttle.rs'
    }
  },
  error: [$i [Error]: canceled by client
    at Gt (/home/waffle/.vscode/extensions/matklad.rust-analyzer-0.3.907/out/main.js:4:223)
    at rn (/home/waffle/.vscode/extensions/matklad.rust-analyzer-0.3.907/out/main.js:3:6520)
    at Immediate.&lt;anonymous&gt; (/home/waffle/.vscode/extensions/matklad.rust-analyzer-0.3.907/out/main.js:3:6373)
    at processImmediate (internal/timers.js:461:21)] {
    code: -32800,
    data: undefined
  }
}
</code></pre></div>



<a name="268276179"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/185405-t-compiler/rust-analyzer/topic/Trying%20to%20load%20documentation%20of%20an%20item%20brakes%20everything/near/268276179" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Laurențiu <a href="https://zulip-archive.rust-lang.org/stream/185405-t-compiler/rust-analyzer/topic/Trying.20to.20load.20documentation.20of.20an.20item.20brakes.20everything.html#268276179">(Jan 17 2022 at 14:18)</a>:</h4>
<p>Do the other features still work when this happens?</p>



<a name="268276447"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/185405-t-compiler/rust-analyzer/topic/Trying%20to%20load%20documentation%20of%20an%20item%20brakes%20everything/near/268276447" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Waffle Lapkin <a href="https://zulip-archive.rust-lang.org/stream/185405-t-compiler/rust-analyzer/topic/Trying.20to.20load.20documentation.20of.20an.20item.20brakes.20everything.html#268276447">(Jan 17 2022 at 14:20)</a>:</h4>
<p>No, go-to-definition, auto-completion and similar also stop working</p>



<a name="268276495"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/185405-t-compiler/rust-analyzer/topic/Trying%20to%20load%20documentation%20of%20an%20item%20brakes%20everything/near/268276495" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Waffle Lapkin <a href="https://zulip-archive.rust-lang.org/stream/185405-t-compiler/rust-analyzer/topic/Trying.20to.20load.20documentation.20of.20an.20item.20brakes.20everything.html#268276495">(Jan 17 2022 at 14:21)</a>:</h4>
<p><span class="user-mention silent" data-user-id="203546">Laurențiu</span> <a href="#narrow/stream/185405-t-compiler.2Frust-analyzer/topic/Trying.20to.20load.20documentation.20of.20an.20item.20brakes.20everything/near/268274157">said</a>:</p>
<blockquote>
<p>Also, the initial load (cache priming, actually) seems painfully slow</p>
</blockquote>
<p>Isn't this normal? <span aria-label="grimacing" class="emoji emoji-1f62c" role="img" title="grimacing">:grimacing:</span> I'm so used to it, that I didn't even think about it</p>



<a name="268276819"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/185405-t-compiler/rust-analyzer/topic/Trying%20to%20load%20documentation%20of%20an%20item%20brakes%20everything/near/268276819" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Laurențiu <a href="https://zulip-archive.rust-lang.org/stream/185405-t-compiler/rust-analyzer/topic/Trying.20to.20load.20documentation.20of.20an.20item.20brakes.20everything.html#268276819">(Jan 17 2022 at 14:24)</a>:</h4>
<blockquote>
<p>I have a couple of timeouts:</p>
</blockquote>
<p>That's under Rust Analyzer Client, right? What about Rust Analyzer Language Server?</p>



<a name="268277020"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/185405-t-compiler/rust-analyzer/topic/Trying%20to%20load%20documentation%20of%20an%20item%20brakes%20everything/near/268277020" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Waffle Lapkin <a href="https://zulip-archive.rust-lang.org/stream/185405-t-compiler/rust-analyzer/topic/Trying.20to.20load.20documentation.20of.20an.20item.20brakes.20everything.html#268277020">(Jan 17 2022 at 14:26)</a>:</h4>
<p>Yes, that's Rust Analyzer Client. Rust Analyzer Language Server Trace is just empty</p>



<a name="268277093"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/185405-t-compiler/rust-analyzer/topic/Trying%20to%20load%20documentation%20of%20an%20item%20brakes%20everything/near/268277093" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Laurențiu <a href="https://zulip-archive.rust-lang.org/stream/185405-t-compiler/rust-analyzer/topic/Trying.20to.20load.20documentation.20of.20an.20item.20brakes.20everything.html#268277093">(Jan 17 2022 at 14:26)</a>:</h4>
<p>When something crashes there's a third one called Rust Analyzer Server</p>



<a name="268277124"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/185405-t-compiler/rust-analyzer/topic/Trying%20to%20load%20documentation%20of%20an%20item%20brakes%20everything/near/268277124" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Waffle Lapkin <a href="https://zulip-archive.rust-lang.org/stream/185405-t-compiler/rust-analyzer/topic/Trying.20to.20load.20documentation.20of.20an.20item.20brakes.20everything.html#268277124">(Jan 17 2022 at 14:27)</a>:</h4>
<p>Also, I just got the same problem without any timeout warnings</p>



<a name="268277339"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/185405-t-compiler/rust-analyzer/topic/Trying%20to%20load%20documentation%20of%20an%20item%20brakes%20everything/near/268277339" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Laurențiu <a href="https://zulip-archive.rust-lang.org/stream/185405-t-compiler/rust-analyzer/topic/Trying.20to.20load.20documentation.20of.20an.20item.20brakes.20everything.html#268277339">(Jan 17 2022 at 14:28)</a>:</h4>
<p>Oh, wait. I think I reproduced it</p>



<a name="268277387"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/185405-t-compiler/rust-analyzer/topic/Trying%20to%20load%20documentation%20of%20an%20item%20brakes%20everything/near/268277387" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Laurențiu <a href="https://zulip-archive.rust-lang.org/stream/185405-t-compiler/rust-analyzer/topic/Trying.20to.20load.20documentation.20of.20an.20item.20brakes.20everything.html#268277387">(Jan 17 2022 at 14:29)</a>:</h4>
<p><a href="/user_uploads/4715/TTLOTCwyTOSw4mabC2qAkZ0_/image.png">image.png</a></p>
<div class="message_inline_image"><a href="/user_uploads/4715/TTLOTCwyTOSw4mabC2qAkZ0_/image.png" title="image.png"><img src="/user_uploads/4715/TTLOTCwyTOSw4mabC2qAkZ0_/image.png"></a></div>



<a name="268277471"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/185405-t-compiler/rust-analyzer/topic/Trying%20to%20load%20documentation%20of%20an%20item%20brakes%20everything/near/268277471" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Laurențiu <a href="https://zulip-archive.rust-lang.org/stream/185405-t-compiler/rust-analyzer/topic/Trying.20to.20load.20documentation.20of.20an.20item.20brakes.20everything.html#268277471">(Jan 17 2022 at 14:29)</a>:</h4>
<p>Does it use a lot of CPU when it starts hanging?</p>



<a name="268277641"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/185405-t-compiler/rust-analyzer/topic/Trying%20to%20load%20documentation%20of%20an%20item%20brakes%20everything/near/268277641" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Waffle Lapkin <a href="https://zulip-archive.rust-lang.org/stream/185405-t-compiler/rust-analyzer/topic/Trying.20to.20load.20documentation.20of.20an.20item.20brakes.20everything.html#268277641">(Jan 17 2022 at 14:31)</a>:</h4>
<p>Oh, I found the Rust Analyzer Language Server logs too, but they don't fit into a zulip message, so here:<br>
<a href="/user_uploads/4715/nX28FXB2lq_UavTwTTKzxY80/ra_log.txt">ra_log.txt</a></p>



<a name="268278052"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/185405-t-compiler/rust-analyzer/topic/Trying%20to%20load%20documentation%20of%20an%20item%20brakes%20everything/near/268278052" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Laurențiu <a href="https://zulip-archive.rust-lang.org/stream/185405-t-compiler/rust-analyzer/topic/Trying.20to.20load.20documentation.20of.20an.20item.20brakes.20everything.html#268278052">(Jan 17 2022 at 14:34)</a>:</h4>
<p><span class="user-mention" data-user-id="300586">@Lukas Wirth</span> running <code>analysis-stats</code> on that repo is so fun</p>



<a name="268278105"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/185405-t-compiler/rust-analyzer/topic/Trying%20to%20load%20documentation%20of%20an%20item%20brakes%20everything/near/268278105" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lukas Wirth <a href="https://zulip-archive.rust-lang.org/stream/185405-t-compiler/rust-analyzer/topic/Trying.20to.20load.20documentation.20of.20an.20item.20brakes.20everything.html#268278105">(Jan 17 2022 at 14:35)</a>:</h4>
<p>found some nice panics or does it just immediately hang? <span aria-label="grimacing" class="emoji emoji-1f62c" role="img" title="grimacing">:grimacing:</span></p>



<a name="268278188"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/185405-t-compiler/rust-analyzer/topic/Trying%20to%20load%20documentation%20of%20an%20item%20brakes%20everything/near/268278188" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Laurențiu <a href="https://zulip-archive.rust-lang.org/stream/185405-t-compiler/rust-analyzer/topic/Trying.20to.20load.20documentation.20of.20an.20item.20brakes.20everything.html#268278188">(Jan 17 2022 at 14:35)</a>:</h4>
<p>Neither, it just processes about one and a half functions per second</p>



<a name="268278202"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/185405-t-compiler/rust-analyzer/topic/Trying%20to%20load%20documentation%20of%20an%20item%20brakes%20everything/near/268278202" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Laurențiu <a href="https://zulip-archive.rust-lang.org/stream/185405-t-compiler/rust-analyzer/topic/Trying.20to.20load.20documentation.20of.20an.20item.20brakes.20everything.html#268278202">(Jan 17 2022 at 14:35)</a>:</h4>
<p>I think we really don't like that <code>requester_forward</code> macro</p>



<a name="268278236"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/185405-t-compiler/rust-analyzer/topic/Trying%20to%20load%20documentation%20of%20an%20item%20brakes%20everything/near/268278236" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Waffle Lapkin <a href="https://zulip-archive.rust-lang.org/stream/185405-t-compiler/rust-analyzer/topic/Trying.20to.20load.20documentation.20of.20an.20item.20brakes.20everything.html#268278236">(Jan 17 2022 at 14:35)</a>:</h4>
<p><span class="user-mention silent" data-user-id="203546">Laurențiu</span> <a href="#narrow/stream/185405-t-compiler.2Frust-analyzer/topic/Trying.20to.20load.20documentation.20of.20an.20item.20brakes.20everything/near/268277471">said</a>:</p>
<blockquote>
<p>Does it use a lot of CPU when it starts hanging?</p>
</blockquote>
<p>Oh, that's weird. RA is constantly spending one full core even before the hang</p>



<a name="268278238"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/185405-t-compiler/rust-analyzer/topic/Trying%20to%20load%20documentation%20of%20an%20item%20brakes%20everything/near/268278238" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Laurențiu <a href="https://zulip-archive.rust-lang.org/stream/185405-t-compiler/rust-analyzer/topic/Trying.20to.20load.20documentation.20of.20an.20item.20brakes.20everything.html#268278238">(Jan 17 2022 at 14:36)</a>:</h4>
<p>It also seems to process functions multiple times, but that can't be right. After a couple of minutes it's still on <code>requests::requester</code></p>



<a name="268278329"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/185405-t-compiler/rust-analyzer/topic/Trying%20to%20load%20documentation%20of%20an%20item%20brakes%20everything/near/268278329" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Waffle Lapkin <a href="https://zulip-archive.rust-lang.org/stream/185405-t-compiler/rust-analyzer/topic/Trying.20to.20load.20documentation.20of.20an.20item.20brakes.20everything.html#268278329">(Jan 17 2022 at 14:36)</a>:</h4>
<p><span class="user-mention silent" data-user-id="203546">Laurențiu</span> <a href="#narrow/stream/185405-t-compiler.2Frust-analyzer/topic/Trying.20to.20load.20documentation.20of.20an.20item.20brakes.20everything/near/268278202">said</a>:</p>
<blockquote>
<p>I think we really don't like that <code>requester_forward</code> macro</p>
</blockquote>
<p>oh, right, that macro xd</p>



<a name="268278361"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/185405-t-compiler/rust-analyzer/topic/Trying%20to%20load%20documentation%20of%20an%20item%20brakes%20everything/near/268278361" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Laurențiu <a href="https://zulip-archive.rust-lang.org/stream/185405-t-compiler/rust-analyzer/topic/Trying.20to.20load.20documentation.20of.20an.20item.20brakes.20everything.html#268278361">(Jan 17 2022 at 14:36)</a>:</h4>
<p>It moved on to <code>adaptors::parse</code> mode now, which is just as slow</p>



<a name="268278571"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/185405-t-compiler/rust-analyzer/topic/Trying%20to%20load%20documentation%20of%20an%20item%20brakes%20everything/near/268278571" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Laurențiu <a href="https://zulip-archive.rust-lang.org/stream/185405-t-compiler/rust-analyzer/topic/Trying.20to.20load.20documentation.20of.20an.20item.20brakes.20everything.html#268278571">(Jan 17 2022 at 14:38)</a>:</h4>
<p>I think there are two issues here: <code>chalk</code> gets stuck on some code (I couldn't find which), as it sometimes <a href="https://github.com/rust-analyzer/rust-analyzer/issues/7796">does</a>, but we're also very slow on those macros (or something else in the code).</p>



<a name="268278745"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/185405-t-compiler/rust-analyzer/topic/Trying%20to%20load%20documentation%20of%20an%20item%20brakes%20everything/near/268278745" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Laurențiu <a href="https://zulip-archive.rust-lang.org/stream/185405-t-compiler/rust-analyzer/topic/Trying.20to.20load.20documentation.20of.20an.20item.20brakes.20everything.html#268278745">(Jan 17 2022 at 14:40)</a>:</h4>
<p><code>analysis-stats</code> took 315 s for me as opposed to 50 s or so on <code>rust-analyzer</code> itself, which has about 15x more code</p>



<a name="268278965"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/185405-t-compiler/rust-analyzer/topic/Trying%20to%20load%20documentation%20of%20an%20item%20brakes%20everything/near/268278965" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Waffle Lapkin <a href="https://zulip-archive.rust-lang.org/stream/185405-t-compiler/rust-analyzer/topic/Trying.20to.20load.20documentation.20of.20an.20item.20brakes.20everything.html#268278965">(Jan 17 2022 at 14:42)</a>:</h4>
<p>I guess going so hard with big traits / macro / etc wasn't a good idea to begin with</p>



<a name="268279049"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/185405-t-compiler/rust-analyzer/topic/Trying%20to%20load%20documentation%20of%20an%20item%20brakes%20everything/near/268279049" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Laurențiu <a href="https://zulip-archive.rust-lang.org/stream/185405-t-compiler/rust-analyzer/topic/Trying.20to.20load.20documentation.20of.20an.20item.20brakes.20everything.html#268279049">(Jan 17 2022 at 14:42)</a>:</h4>
<p>We actively avoid proc macros and interfaces heavy with generics to keep compile times fast</p>



<a name="268279544"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/185405-t-compiler/rust-analyzer/topic/Trying%20to%20load%20documentation%20of%20an%20item%20brakes%20everything/near/268279544" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Waffle Lapkin <a href="https://zulip-archive.rust-lang.org/stream/185405-t-compiler/rust-analyzer/topic/Trying.20to.20load.20documentation.20of.20an.20item.20brakes.20everything.html#268279544">(Jan 17 2022 at 14:47)</a>:</h4>
<p>One day I'll figure out how to make optional parameters &amp; extensible interfaces without writing such generic-heavy code...</p>



<a name="268279612"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/185405-t-compiler/rust-analyzer/topic/Trying%20to%20load%20documentation%20of%20an%20item%20brakes%20everything/near/268279612" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Laurențiu <a href="https://zulip-archive.rust-lang.org/stream/185405-t-compiler/rust-analyzer/topic/Trying.20to.20load.20documentation.20of.20an.20item.20brakes.20everything.html#268279612">(Jan 17 2022 at 14:47)</a>:</h4>
<p>921/1808 50% processing: adaptors::throttle::send_invoice (/home/grayshade/teloxide-core/src/adaptors/throttle.rs 34..427)</p>



<a name="268279635"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/185405-t-compiler/rust-analyzer/topic/Trying%20to%20load%20documentation%20of%20an%20item%20brakes%20everything/near/268279635" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Laurențiu <a href="https://zulip-archive.rust-lang.org/stream/185405-t-compiler/rust-analyzer/topic/Trying.20to.20load.20documentation.20of.20an.20item.20brakes.20everything.html#268279635">(Jan 17 2022 at 14:48)</a>:</h4>
<p>Ah</p>



<a name="268279686"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/185405-t-compiler/rust-analyzer/topic/Trying%20to%20load%20documentation%20of%20an%20item%20brakes%20everything/near/268279686" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Laurențiu <a href="https://zulip-archive.rust-lang.org/stream/185405-t-compiler/rust-analyzer/topic/Trying.20to.20load.20documentation.20of.20an.20item.20brakes.20everything.html#268279686">(Jan 17 2022 at 14:48)</a>:</h4>
<p>I thought it got stuck there, but it just takes a really long time on those functions</p>



<a name="268279697"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/185405-t-compiler/rust-analyzer/topic/Trying%20to%20load%20documentation%20of%20an%20item%20brakes%20everything/near/268279697" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Laurențiu <a href="https://zulip-archive.rust-lang.org/stream/185405-t-compiler/rust-analyzer/topic/Trying.20to.20load.20documentation.20of.20an.20item.20brakes.20everything.html#268279697">(Jan 17 2022 at 14:48)</a>:</h4>
<p>Like tens of seconds</p>



<a name="268280001"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/185405-t-compiler/rust-analyzer/topic/Trying%20to%20load%20documentation%20of%20an%20item%20brakes%20everything/near/268280001" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Waffle Lapkin <a href="https://zulip-archive.rust-lang.org/stream/185405-t-compiler/rust-analyzer/topic/Trying.20to.20load.20documentation.20of.20an.20item.20brakes.20everything.html#268280001">(Jan 17 2022 at 14:51)</a>:</h4>
<p>ftr <code>send_invoice</code> looks like this: <a href="/user_uploads/4715/wLuBt3Wv7J9euzIDscrcnVZA/2022-01-17_17-50.png">2022-01-17_17-50.png</a></p>
<div class="message_inline_image"><a href="/user_uploads/4715/wLuBt3Wv7J9euzIDscrcnVZA/2022-01-17_17-50.png" title="2022-01-17_17-50.png"><img src="/user_uploads/4715/wLuBt3Wv7J9euzIDscrcnVZA/2022-01-17_17-50.png"></a></div>



<a name="268280063"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/185405-t-compiler/rust-analyzer/topic/Trying%20to%20load%20documentation%20of%20an%20item%20brakes%20everything/near/268280063" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Waffle Lapkin <a href="https://zulip-archive.rust-lang.org/stream/185405-t-compiler/rust-analyzer/topic/Trying.20to.20load.20documentation.20of.20an.20item.20brakes.20everything.html#268280063">(Jan 17 2022 at 14:51)</a>:</h4>
<p>I wonder if removing all <code>Into&lt;&gt;</code>s would make anything better <span aria-label="thinking" class="emoji emoji-1f914" role="img" title="thinking">:thinking:</span></p>



<a name="268280701"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/185405-t-compiler/rust-analyzer/topic/Trying%20to%20load%20documentation%20of%20an%20item%20brakes%20everything/near/268280701" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Laurențiu <a href="https://zulip-archive.rust-lang.org/stream/185405-t-compiler/rust-analyzer/topic/Trying.20to.20load.20documentation.20of.20an.20item.20brakes.20everything.html#268280701">(Jan 17 2022 at 14:57)</a>:</h4>
<p>One trick (which might not help here) is to split the function in two, a generic and a non-generic part</p>



<a name="268281654"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/185405-t-compiler/rust-analyzer/topic/Trying%20to%20load%20documentation%20of%20an%20item%20brakes%20everything/near/268281654" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Waffle Lapkin <a href="https://zulip-archive.rust-lang.org/stream/185405-t-compiler/rust-analyzer/topic/Trying.20to.20load.20documentation.20of.20an.20item.20brakes.20everything.html#268281654">(Jan 17 2022 at 15:04)</a>:</h4>
<p><span class="user-mention silent" data-user-id="273349">Waffle Lapkin</span> <a href="#narrow/stream/185405-t-compiler.2Frust-analyzer/topic/Trying.20to.20load.20documentation.20of.20an.20item.20brakes.20everything/near/268278236">said</a>:</p>
<blockquote>
<p><span class="user-mention silent" data-user-id="203546">Laurențiu</span> <a href="#narrow/stream/185405-t-compiler.2Frust-analyzer/topic/Trying.20to.20load.20documentation.20of.20an.20item.20brakes.20everything/near/268277471">said</a>:</p>
<blockquote>
<p>Does it use a lot of CPU when it starts hanging?</p>
</blockquote>
<p>Oh, that's weird. RA is constantly spending one full core even before the hang</p>
</blockquote>
<p>It seems like it starts spending one full core when you open one of the modules with <code>requester_forward!</code> calls (Basically any submodule of <code>adaptors</code>). I just happened to have the module open when I reloaded the server that time.</p>
<p>Also, some modules are easier than others. For example I can open <code>parse_mode</code>or <code>trace</code> and after some time RA stops using 100% cpu, but with <code>throttle</code> it just doesn't happen. One possible way in which <code>throttle</code> is worse than any other module is that it creates a closure per function:</p>
<div class="codehilite" data-code-language="Rust"><pre><span></span><code><span class="fm">macro_rules!</span><span class="w"> </span><span class="n">f</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="p">(</span><span class="cp">$m</span>:<span class="nc">ident</span><span class="w"> </span><span class="cp">$this</span>:<span class="nc">ident</span><span class="w"> </span><span class="p">(</span><span class="cp">$($arg</span>:<span class="nc">ident</span><span class="w"> </span>: <span class="cp">$T</span>:<span class="nc">ty</span><span class="p">),</span><span class="o">*</span><span class="p">))</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">        </span><span class="n">ThrottlingRequest</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">            </span><span class="n">request</span>: <span class="cp">$this</span><span class="p">.</span><span class="n">inner</span><span class="p">().</span><span class="cp">$m</span><span class="p">(</span><span class="cp">$($arg</span><span class="p">),</span><span class="o">*</span><span class="p">),</span><span class="w"></span>
<span class="w">            </span><span class="n">chat_id</span>: <span class="o">|</span><span class="n">p</span><span class="o">|</span><span class="w"> </span><span class="p">(</span><span class="o">&amp;</span><span class="n">p</span><span class="p">.</span><span class="n">payload_ref</span><span class="p">().</span><span class="n">chat_id</span><span class="p">).</span><span class="n">into</span><span class="p">(),</span><span class="w"> </span><span class="c1">// &lt;-- here</span>
<span class="w">            </span><span class="n">worker</span>: <span class="cp">$this</span><span class="p">.</span><span class="n">queue</span><span class="p">.</span><span class="n">clone</span><span class="p">(),</span><span class="w"></span>
<span class="w">        </span><span class="p">}</span><span class="w"></span>
<span class="w">    </span><span class="p">};</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>
</code></pre></div>



<a name="268281783"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/185405-t-compiler/rust-analyzer/topic/Trying%20to%20load%20documentation%20of%20an%20item%20brakes%20everything/near/268281783" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Laurențiu <a href="https://zulip-archive.rust-lang.org/stream/185405-t-compiler/rust-analyzer/topic/Trying.20to.20load.20documentation.20of.20an.20item.20brakes.20everything.html#268281783">(Jan 17 2022 at 15:05)</a>:</h4>
<p>We're spending the time in chalk, which is the trait solver, so it might be related to all those generics</p>



<a name="268281919"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/185405-t-compiler/rust-analyzer/topic/Trying%20to%20load%20documentation%20of%20an%20item%20brakes%20everything/near/268281919" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Waffle Lapkin <a href="https://zulip-archive.rust-lang.org/stream/185405-t-compiler/rust-analyzer/topic/Trying.20to.20load.20documentation.20of.20an.20item.20brakes.20everything.html#268281919">(Jan 17 2022 at 15:06)</a>:</h4>
<p>Well, generics are the same for all modules, so <code>throttle</code> shouldn't be that different from others <span aria-label="thinking" class="emoji emoji-1f914" role="img" title="thinking">:thinking:</span></p>



<a name="268282009"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/185405-t-compiler/rust-analyzer/topic/Trying%20to%20load%20documentation%20of%20an%20item%20brakes%20everything/near/268282009" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Laurențiu <a href="https://zulip-archive.rust-lang.org/stream/185405-t-compiler/rust-analyzer/topic/Trying.20to.20load.20documentation.20of.20an.20item.20brakes.20everything.html#268282009">(Jan 17 2022 at 15:06)</a>:</h4>
<p>But <code>requests::requester</code> and <code>adaptors::parse</code> are slow too</p>



<a name="268282296"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/185405-t-compiler/rust-analyzer/topic/Trying%20to%20load%20documentation%20of%20an%20item%20brakes%20everything/near/268282296" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Waffle Lapkin <a href="https://zulip-archive.rust-lang.org/stream/185405-t-compiler/rust-analyzer/topic/Trying.20to.20load.20documentation.20of.20an.20item.20brakes.20everything.html#268282296">(Jan 17 2022 at 15:09)</a>:</h4>
<p>Yes, that's also true</p>



<a name="268287838"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/185405-t-compiler/rust-analyzer/topic/Trying%20to%20load%20documentation%20of%20an%20item%20brakes%20everything/near/268287838" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Waffle Lapkin <a href="https://zulip-archive.rust-lang.org/stream/185405-t-compiler/rust-analyzer/topic/Trying.20to.20load.20documentation.20of.20an.20item.20brakes.20everything.html#268287838">(Jan 17 2022 at 15:53)</a>:</h4>
<p>welp</p>



<a name="268287876"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/185405-t-compiler/rust-analyzer/topic/Trying%20to%20load%20documentation%20of%20an%20item%20brakes%20everything/near/268287876" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Waffle Lapkin <a href="https://zulip-archive.rust-lang.org/stream/185405-t-compiler/rust-analyzer/topic/Trying.20to.20load.20documentation.20of.20an.20item.20brakes.20everything.html#268287876">(Jan 17 2022 at 15:54)</a>:</h4>
<p>Removing all generics helps, but it's still slow</p>



<a name="268288126"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/185405-t-compiler/rust-analyzer/topic/Trying%20to%20load%20documentation%20of%20an%20item%20brakes%20everything/near/268288126" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Laurențiu <a href="https://zulip-archive.rust-lang.org/stream/185405-t-compiler/rust-analyzer/topic/Trying.20to.20load.20documentation.20of.20an.20item.20brakes.20everything.html#268288126">(Jan 17 2022 at 15:55)</a>:</h4>
<p>:(</p>



<a name="268288799"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/185405-t-compiler/rust-analyzer/topic/Trying%20to%20load%20documentation%20of%20an%20item%20brakes%20everything/near/268288799" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Waffle Lapkin <a href="https://zulip-archive.rust-lang.org/stream/185405-t-compiler/rust-analyzer/topic/Trying.20to.20load.20documentation.20of.20an.20item.20brakes.20everything.html#268288799">(Jan 17 2022 at 16:01)</a>:</h4>
<p>Here is the removal: <a href="https://github.com/teloxide/teloxide-core/pull/168">https://github.com/teloxide/teloxide-core/pull/168</a>, if you want to compare <code>analysis-stats</code></p>



<a name="268289326"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/185405-t-compiler/rust-analyzer/topic/Trying%20to%20load%20documentation%20of%20an%20item%20brakes%20everything/near/268289326" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Laurențiu <a href="https://zulip-archive.rust-lang.org/stream/185405-t-compiler/rust-analyzer/topic/Trying.20to.20load.20documentation.20of.20an.20item.20brakes.20everything.html#268289326">(Jan 17 2022 at 16:05)</a>:</h4>
<p>Well, it's still slow, but over twice as fast</p>



<a name="268289773"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/185405-t-compiler/rust-analyzer/topic/Trying%20to%20load%20documentation%20of%20an%20item%20brakes%20everything/near/268289773" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Laurențiu <a href="https://zulip-archive.rust-lang.org/stream/185405-t-compiler/rust-analyzer/topic/Trying.20to.20load.20documentation.20of.20an.20item.20brakes.20everything.html#268289773">(Jan 17 2022 at 16:09)</a>:</h4>
<p>I still see some under <code>types</code></p>



<a name="268290937"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/185405-t-compiler/rust-analyzer/topic/Trying%20to%20load%20documentation%20of%20an%20item%20brakes%20everything/near/268290937" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Waffle Lapkin <a href="https://zulip-archive.rust-lang.org/stream/185405-t-compiler/rust-analyzer/topic/Trying.20to.20load.20documentation.20of.20an.20item.20brakes.20everything.html#268290937">(Jan 17 2022 at 16:21)</a>:</h4>
<p>Some what?</p>



<a name="268290960"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/185405-t-compiler/rust-analyzer/topic/Trying%20to%20load%20documentation%20of%20an%20item%20brakes%20everything/near/268290960" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Laurențiu <a href="https://zulip-archive.rust-lang.org/stream/185405-t-compiler/rust-analyzer/topic/Trying.20to.20load.20documentation.20of.20an.20item.20brakes.20everything.html#268290960">(Jan 17 2022 at 16:21)</a>:</h4>
<p>Some <code>Into&lt;String&gt;</code>s</p>



<a name="268291081"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/185405-t-compiler/rust-analyzer/topic/Trying%20to%20load%20documentation%20of%20an%20item%20brakes%20everything/near/268291081" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Waffle Lapkin <a href="https://zulip-archive.rust-lang.org/stream/185405-t-compiler/rust-analyzer/topic/Trying.20to.20load.20documentation.20of.20an.20item.20brakes.20everything.html#268291081">(Jan 17 2022 at 16:22)</a>:</h4>
<p>Ah, I see</p>



<a name="268291098"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/185405-t-compiler/rust-analyzer/topic/Trying%20to%20load%20documentation%20of%20an%20item%20brakes%20everything/near/268291098" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Laurențiu <a href="https://zulip-archive.rust-lang.org/stream/185405-t-compiler/rust-analyzer/topic/Trying.20to.20load.20documentation.20of.20an.20item.20brakes.20everything.html#268291098">(Jan 17 2022 at 16:23)</a>:</h4>
<p><span class="user-mention silent" data-user-id="273349">Waffle Lapkin</span> <a href="#narrow/stream/185405-t-compiler.2Frust-analyzer/topic/Trying.20to.20load.20documentation.20of.20an.20item.20brakes.20everything/near/268288799">said</a>:</p>
<blockquote>
<p>Here is the removal: <a href="https://github.com/teloxide/teloxide-core/pull/168">https://github.com/teloxide/teloxide-core/pull/168</a>, if you want to compare <code>analysis-stats</code></p>
</blockquote>
<p>That must have hurt</p>



<a name="268291242"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/185405-t-compiler/rust-analyzer/topic/Trying%20to%20load%20documentation%20of%20an%20item%20brakes%20everything/near/268291242" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Waffle Lapkin <a href="https://zulip-archive.rust-lang.org/stream/185405-t-compiler/rust-analyzer/topic/Trying.20to.20load.20documentation.20of.20an.20item.20brakes.20everything.html#268291242">(Jan 17 2022 at 16:24)</a>:</h4>
<p>Most of the changes were made by just a single line diff in a code-gen utility :D</p>



<a name="268294097"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/185405-t-compiler/rust-analyzer/topic/Trying%20to%20load%20documentation%20of%20an%20item%20brakes%20everything/near/268294097" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Waffle Lapkin <a href="https://zulip-archive.rust-lang.org/stream/185405-t-compiler/rust-analyzer/topic/Trying.20to.20load.20documentation.20of.20an.20item.20brakes.20everything.html#268294097">(Jan 17 2022 at 16:55)</a>:</h4>
<p>Are there any way to profile RA? I want to figure what exactly is the problem. </p>
<p>The IDEA for example works fine-ish (it's laggy, but doesn't hang), so I think RA could also, given some optimizations :)</p>



<a name="268294224"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/185405-t-compiler/rust-analyzer/topic/Trying%20to%20load%20documentation%20of%20an%20item%20brakes%20everything/near/268294224" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Laurențiu <a href="https://zulip-archive.rust-lang.org/stream/185405-t-compiler/rust-analyzer/topic/Trying.20to.20load.20documentation.20of.20an.20item.20brakes.20everything.html#268294224">(Jan 17 2022 at 16:56)</a>:</h4>
<p><a href="https://github.com/rust-analyzer/rust-analyzer/tree/master/docs/dev#profiling">https://github.com/rust-analyzer/rust-analyzer/tree/master/docs/dev#profiling</a> and <code>perf</code> or any C profiler</p>



<a name="268294407"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/185405-t-compiler/rust-analyzer/topic/Trying%20to%20load%20documentation%20of%20an%20item%20brakes%20everything/near/268294407" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Laurențiu <a href="https://zulip-archive.rust-lang.org/stream/185405-t-compiler/rust-analyzer/topic/Trying.20to.20load.20documentation.20of.20an.20item.20brakes.20everything.html#268294407">(Jan 17 2022 at 16:58)</a>:</h4>
<p>You can also use <code>pprof</code>: <a href="https://github.com/rust-analyzer/rust-analyzer/blob/master/crates/profile/src/lib.rs#L50">https://github.com/rust-analyzer/rust-analyzer/blob/master/crates/profile/src/lib.rs#L50</a></p>



<a name="268294553"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/185405-t-compiler/rust-analyzer/topic/Trying%20to%20load%20documentation%20of%20an%20item%20brakes%20everything/near/268294553" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Waffle Lapkin <a href="https://zulip-archive.rust-lang.org/stream/185405-t-compiler/rust-analyzer/topic/Trying.20to.20load.20documentation.20of.20an.20item.20brakes.20everything.html#268294553">(Jan 17 2022 at 17:00)</a>:</h4>
<p>Thanks! Will try</p>



<hr><p>Last updated: Apr 12 2022 at 20:01 UTC</p>
</html>