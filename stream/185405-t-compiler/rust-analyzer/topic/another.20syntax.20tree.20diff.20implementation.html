<html>
<head><meta charset="utf-8"><title>another syntax tree diff implementation · t-compiler/rust-analyzer · Zulip Chat Archive</title></head>
<h2>Stream: <a href="https://zulip-archive.rust-lang.org/stream/185405-t-compiler/rust-analyzer/index.html">t-compiler/rust-analyzer</a></h2>
<h3>Topic: <a href="https://zulip-archive.rust-lang.org/stream/185405-t-compiler/rust-analyzer/topic/another.20syntax.20tree.20diff.20implementation.html">another syntax tree diff implementation</a></h3>

<hr>

<base href="https://rust-lang.zulipchat.com">

<head><link href="https://zulip-archive.rust-lang.org/style.css" rel="stylesheet"></head>

<a name="276591234"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/185405-t-compiler/rust-analyzer/topic/another%20syntax%20tree%20diff%20implementation/near/276591234" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> yipinliu <a href="https://zulip-archive.rust-lang.org/stream/185405-t-compiler/rust-analyzer/topic/another.20syntax.20tree.20diff.20implementation.html#276591234">(Mar 25 2022 at 09:00)</a>:</h4>
<p>Hi, all. I'm currently working on this <a href="https://github.com/rust-analyzer/rust-analyzer/pull/11813">PR</a>, and it's half done. It can generate the following diff result for now:<br>
source:<br>
<a href="/user_uploads/4715/vRGCXj3Fvn0mCEWBY0u1s5_V/source.png">source.png</a> </p>
<div class="message_inline_image"><a href="/user_uploads/4715/vRGCXj3Fvn0mCEWBY0u1s5_V/source.png" title="source.png"><img src="/user_uploads/4715/vRGCXj3Fvn0mCEWBY0u1s5_V/source.png"></a></div><p>destination:<br>
<a href="/user_uploads/4715/qwthF2wjZzETbXKWCJjW0PBi/dst.png">dst.png</a> </p>
<div class="message_inline_image"><a href="/user_uploads/4715/qwthF2wjZzETbXKWCJjW0PBi/dst.png" title="dst.png"><img src="/user_uploads/4715/qwthF2wjZzETbXKWCJjW0PBi/dst.png"></a></div><p>The red node in the source tree is marked as deletion. The green node in the destination tree is marked as insertion. After this PR is done, the result should be better.</p>
<p>But I'm blocked by not knowing how to convert the insertion nodes to <code>TreeDiff::insertions</code>, since in the algorithm result, inserting a node just means to insert the node, not to insert the entire subtree. I have no idea how to convert the algorithm result to <code>TextEdit</code>. Does anyone have any idea?</p>



<a name="276595298"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/185405-t-compiler/rust-analyzer/topic/another%20syntax%20tree%20diff%20implementation/near/276595298" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lukas Wirth <a href="https://zulip-archive.rust-lang.org/stream/185405-t-compiler/rust-analyzer/topic/another.20syntax.20tree.20diff.20implementation.html#276595298">(Mar 25 2022 at 09:44)</a>:</h4>
<p>Note that you don't necessarily have to use our current <code>TreeDiff</code> structure as the target output for the algorithm, we mainly need a way to turn it into a <code>TextEdit</code></p>



<a name="276595502"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/185405-t-compiler/rust-analyzer/topic/another%20syntax%20tree%20diff%20implementation/near/276595502" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lukas Wirth <a href="https://zulip-archive.rust-lang.org/stream/185405-t-compiler/rust-analyzer/topic/another.20syntax.20tree.20diff.20implementation.html#276595502">(Mar 25 2022 at 09:47)</a>:</h4>
<p>I don't know how the gumtree alogrithm works though so I can't really be much of help here otherwise right now.</p>



<hr><p>Last updated: Apr 12 2022 at 20:01 UTC</p>
</html>