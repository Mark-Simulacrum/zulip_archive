<html>
<head><meta charset="utf-8"><title>running RA on docs.rs · t-compiler/rust-analyzer · Zulip Chat Archive</title></head>
<h2>Stream: <a href="https://rust-lang.github.io/zulip_archive/stream/185405-t-compiler/rust-analyzer/index.html">t-compiler/rust-analyzer</a></h2>
<h3>Topic: <a href="https://rust-lang.github.io/zulip_archive/stream/185405-t-compiler/rust-analyzer/topic/running.20RA.20on.20docs.2Ers.html">running RA on docs.rs</a></h3>

<hr>

<base href="https://rust-lang.zulipchat.com">

<head><link href="https://rust-lang.github.io/zulip_archive/style.css" rel="stylesheet"></head>

<a name="223135877"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/185405-t-compiler/rust-analyzer/topic/running%20RA%20on%20docs.rs/near/223135877" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Florian Diebold <a href="https://rust-lang.github.io/zulip_archive/stream/185405-t-compiler/rust-analyzer/topic/running.20RA.20on.20docs.2Ers.html#223135877">(Jan 18 2021 at 15:44)</a>:</h4>
<p><span class="user-mention silent" data-user-id="232545">Joshua Nelson</span> <a href="#narrow/stream/185405-t-compiler.2Fwg-rls-2.2E0/topic/Steering.20meeting/near/223135648">said</a>:</p>
<blockquote>
<p><span class="user-mention silent" data-user-id="211727">Jonas Schievink</span> <a href="#narrow/stream/185405-t-compiler.2Fwg-rls-2.2E0/topic/Steering.20meeting/near/223135485">said</a>:</p>
<blockquote>
<p>If sorting issues by number of <span aria-label="+1" class="emoji emoji-1f44d" role="img" title="+1">:+1:</span> reactions is anything to go by, reducing memory usage and supporting inner items properly are high on the list</p>
</blockquote>
<p>big +1 to less memory usage, I don't even use RA on <a href="http://docs.rs">docs.rs</a> because it crashes my laptop</p>
</blockquote>
<p>is <a href="http://docs.rs">docs.rs</a> that huge? maybe there's something else going on, it might be worth running analysis-stats on it and/or creating an issue</p>



<a name="223138046"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/185405-t-compiler/rust-analyzer/topic/running%20RA%20on%20docs.rs/near/223138046" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Nelson <a href="https://rust-lang.github.io/zulip_archive/stream/185405-t-compiler/rust-analyzer/topic/running.20RA.20on.20docs.2Ers.html#223138046">(Jan 18 2021 at 16:03)</a>:</h4>
<p>I did: <a href="https://github.com/rust-analyzer/rust-analyzer/issues/7052">https://github.com/rust-analyzer/rust-analyzer/issues/7052</a></p>



<a name="223138119"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/185405-t-compiler/rust-analyzer/topic/running%20RA%20on%20docs.rs/near/223138119" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Nelson <a href="https://rust-lang.github.io/zulip_archive/stream/185405-t-compiler/rust-analyzer/topic/running.20RA.20on.20docs.2Ers.html#223138119">(Jan 18 2021 at 16:03)</a>:</h4>
<p>the debug tools didn't work for me: <a href="https://github.com/rust-analyzer/rust-analyzer/issues/7052#issuecomment-751499782">https://github.com/rust-analyzer/rust-analyzer/issues/7052#issuecomment-751499782</a><br>
and no one else was able to reproduce the memory usage: <a href="https://github.com/rust-analyzer/rust-analyzer/issues/7052#issuecomment-751518257">https://github.com/rust-analyzer/rust-analyzer/issues/7052#issuecomment-751518257</a></p>



<a name="223138215"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/185405-t-compiler/rust-analyzer/topic/running%20RA%20on%20docs.rs/near/223138215" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Nelson <a href="https://rust-lang.github.io/zulip_archive/stream/185405-t-compiler/rust-analyzer/topic/running.20RA.20on.20docs.2Ers.html#223138215">(Jan 18 2021 at 16:04)</a>:</h4>
<p>and then it got marked as unactionable</p>



<a name="223138221"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/185405-t-compiler/rust-analyzer/topic/running%20RA%20on%20docs.rs/near/223138221" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Nelson <a href="https://rust-lang.github.io/zulip_archive/stream/185405-t-compiler/rust-analyzer/topic/running.20RA.20on.20docs.2Ers.html#223138221">(Jan 18 2021 at 16:04)</a>:</h4>
<p>so I don't know what the next steps are</p>



<a name="223138576"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/185405-t-compiler/rust-analyzer/topic/running%20RA%20on%20docs.rs/near/223138576" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Edwin Cheng <a href="https://rust-lang.github.io/zulip_archive/stream/185405-t-compiler/rust-analyzer/topic/running.20RA.20on.20docs.2Ers.html#223138576">(Jan 18 2021 at 16:07)</a>:</h4>
<p>Do you see the panic now ?</p>



<a name="223138633"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/185405-t-compiler/rust-analyzer/topic/running%20RA%20on%20docs.rs/near/223138633" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Nelson <a href="https://rust-lang.github.io/zulip_archive/stream/185405-t-compiler/rust-analyzer/topic/running.20RA.20on.20docs.2Ers.html#223138633">(Jan 18 2021 at 16:08)</a>:</h4>
<p>I see <em>a</em> panic:</p>
<div class="codehilite"><pre><span></span><code>[Info  - 11:07:36 AM] Connection to server got closed. Server will restart.
[Error - 11:07:36 AM] Request textDocument/semanticTokens/full failed.
Error: Connection got disposed.
    at Object.dispose (/home/joshua/.vscode/extensions/matklad.rust-analyzer-0.2.457/out/src/main.js:5534:27)
    at Object.dispose (/home/joshua/.vscode/extensions/matklad.rust-analyzer-0.2.457/out/src/main.js:11546:35)
    at LanguageClient.handleConnectionClosed (/home/joshua/.vscode/extensions/matklad.rust-analyzer-0.2.457/out/src/main.js:13897:42)
    at LanguageClient.handleConnectionClosed (/home/joshua/.vscode/extensions/matklad.rust-analyzer-0.2.457/out/src/main.js:16803:15)
    at closeHandler (/home/joshua/.vscode/extensions/matklad.rust-analyzer-0.2.457/out/src/main.js:13884:18)
    at CallbackList.invoke (/home/joshua/.vscode/extensions/matklad.rust-analyzer-0.2.457/out/src/main.js:3527:39)
    at Emitter.fire (/home/joshua/.vscode/extensions/matklad.rust-analyzer-0.2.457/out/src/main.js:3589:36)
    at closeHandler (/home/joshua/.vscode/extensions/matklad.rust-analyzer-0.2.457/out/src/main.js:4747:26)
    at CallbackList.invoke (/home/joshua/.vscode/extensions/matklad.rust-analyzer-0.2.457/out/src/main.js:3527:39)
    at Emitter.fire (/home/joshua/.vscode/extensions/matklad.rust-analyzer-0.2.457/out/src/main.js:3589:36)
    at StreamMessageWriter.fireClose (/home/joshua/.vscode/extensions/matklad.rust-analyzer-0.2.457/out/src/main.js:4009:27)
    at Socket.&lt;anonymous&gt; (/home/joshua/.vscode/extensions/matklad.rust-analyzer-0.2.457/out/src/main.js:4042:42)
    at Socket.emit (events.js:223:5)
    at Pipe.&lt;anonymous&gt; (net.js:664:12)
</code></pre></div>



<a name="223138715"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/185405-t-compiler/rust-analyzer/topic/running%20RA%20on%20docs.rs/near/223138715" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Nelson <a href="https://rust-lang.github.io/zulip_archive/stream/185405-t-compiler/rust-analyzer/topic/running.20RA.20on.20docs.2Ers.html#223138715">(Jan 18 2021 at 16:08)</a>:</h4>
<p>I never saw the original panic even 3 weeks ago, maybe I wasn't looking at the logs</p>



<a name="223138755"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/185405-t-compiler/rust-analyzer/topic/running%20RA%20on%20docs.rs/near/223138755" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Nelson <a href="https://rust-lang.github.io/zulip_archive/stream/185405-t-compiler/rust-analyzer/topic/running.20RA.20on.20docs.2Ers.html#223138755">(Jan 18 2021 at 16:09)</a>:</h4>
<p>the server just crashed I think because it's back to 55/369 roots, it was at 200 just a second ago</p>



<a name="223138760"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/185405-t-compiler/rust-analyzer/topic/running%20RA%20on%20docs.rs/near/223138760" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jonas Schievink  [he/him] <a href="https://rust-lang.github.io/zulip_archive/stream/185405-t-compiler/rust-analyzer/topic/running.20RA.20on.20docs.2Ers.html#223138760">(Jan 18 2021 at 16:09)</a>:</h4>
<p>I think running the memory usage command now (intentionally) breaks salsa invariants, so a panic is expected</p>



<a name="223138785"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/185405-t-compiler/rust-analyzer/topic/running%20RA%20on%20docs.rs/near/223138785" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Nelson <a href="https://rust-lang.github.io/zulip_archive/stream/185405-t-compiler/rust-analyzer/topic/running.20RA.20on.20docs.2Ers.html#223138785">(Jan 18 2021 at 16:09)</a>:</h4>
<p>not sure if that's an OOM or not</p>



<a name="223138802"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/185405-t-compiler/rust-analyzer/topic/running%20RA%20on%20docs.rs/near/223138802" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Nelson <a href="https://rust-lang.github.io/zulip_archive/stream/185405-t-compiler/rust-analyzer/topic/running.20RA.20on.20docs.2Ers.html#223138802">(Jan 18 2021 at 16:09)</a>:</h4>
<p>but it happens pretty consistently</p>



<a name="223138817"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/185405-t-compiler/rust-analyzer/topic/running%20RA%20on%20docs.rs/near/223138817" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Nelson <a href="https://rust-lang.github.io/zulip_archive/stream/185405-t-compiler/rust-analyzer/topic/running.20RA.20on.20docs.2Ers.html#223138817">(Jan 18 2021 at 16:09)</a>:</h4>
<p><span class="user-mention silent" data-user-id="211727">Jonas Schievink</span> <a href="#narrow/stream/185405-t-compiler.2Fwg-rls-2.2E0/topic/running.20RA.20on.20docs.2Ers/near/223138760">said</a>:</p>
<blockquote>
<p>I think running the memory usage command now (intentionally) breaks salsa invariants, so a panic is expected</p>
</blockquote>
<p>this is without running any commands at all</p>



<a name="223138828"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/185405-t-compiler/rust-analyzer/topic/running%20RA%20on%20docs.rs/near/223138828" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Nelson <a href="https://rust-lang.github.io/zulip_archive/stream/185405-t-compiler/rust-analyzer/topic/running.20RA.20on.20docs.2Ers.html#223138828">(Jan 18 2021 at 16:09)</a>:</h4>
<p>I just have it open to a file without making any changes</p>



<a name="223138902"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/185405-t-compiler/rust-analyzer/topic/running%20RA%20on%20docs.rs/near/223138902" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Nelson <a href="https://rust-lang.github.io/zulip_archive/stream/185405-t-compiler/rust-analyzer/topic/running.20RA.20on.20docs.2Ers.html#223138902">(Jan 18 2021 at 16:10)</a>:</h4>
<p>ok the server keeps getting OOM'd so I'm going to close RA now</p>



<a name="223138958"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/185405-t-compiler/rust-analyzer/topic/running%20RA%20on%20docs.rs/near/223138958" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jonas Schievink  [he/him] <a href="https://rust-lang.github.io/zulip_archive/stream/185405-t-compiler/rust-analyzer/topic/running.20RA.20on.20docs.2Ers.html#223138958">(Jan 18 2021 at 16:10)</a>:</h4>
<p>on linux <code>dmesg</code> will tell you if something gets OOM-killed</p>



<a name="223139086"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/185405-t-compiler/rust-analyzer/topic/running%20RA%20on%20docs.rs/near/223139086" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Nelson <a href="https://rust-lang.github.io/zulip_archive/stream/185405-t-compiler/rust-analyzer/topic/running.20RA.20on.20docs.2Ers.html#223139086">(Jan 18 2021 at 16:11)</a>:</h4>
<p>I'm using earlyoom, let me see where it sends its logs</p>



<a name="223139111"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/185405-t-compiler/rust-analyzer/topic/running%20RA%20on%20docs.rs/near/223139111" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Nelson <a href="https://rust-lang.github.io/zulip_archive/stream/185405-t-compiler/rust-analyzer/topic/running.20RA.20on.20docs.2Ers.html#223139111">(Jan 18 2021 at 16:11)</a>:</h4>
<p>(without earlyoom my computer will freeze up completely instead of killing a process)</p>



<a name="223139502"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/185405-t-compiler/rust-analyzer/topic/running%20RA%20on%20docs.rs/near/223139502" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Laurențiu <a href="https://rust-lang.github.io/zulip_archive/stream/185405-t-compiler/rust-analyzer/topic/running.20RA.20on.20docs.2Ers.html#223139502">(Jan 18 2021 at 16:14)</a>:</h4>
<p>Did anyone else try it on Windows?</p>



<a name="223139516"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/185405-t-compiler/rust-analyzer/topic/running%20RA%20on%20docs.rs/near/223139516" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Nelson <a href="https://rust-lang.github.io/zulip_archive/stream/185405-t-compiler/rust-analyzer/topic/running.20RA.20on.20docs.2Ers.html#223139516">(Jan 18 2021 at 16:14)</a>:</h4>
<p>yup it was killed:</p>
<div class="codehilite"><pre><span></span><code>Jan 18 11:13:42 joshua-ThinkPad-P51s earlyoom[988]: mem avail:   834 of  7597 MiB (10 %), swap free:   77 of  975 MiB ( 7 %)
Jan 18 11:13:42 joshua-ThinkPad-P51s earlyoom[988]: low memory! at or below SIGTERM limits: mem 10 %, swap 10 %
Jan 18 11:13:42 joshua-ThinkPad-P51s earlyoom[988]: sending SIGTERM to process 51844 &quot;rust-analyzer-x&quot;: badness 216, VmRSS 1850 MiB
Jan 18 11:13:42 joshua-ThinkPad-P51s earlyoom[988]: process exited after 0.1 seconds
Jan 18 11:14:07 joshua-ThinkPad-P51s earlyoom[988]: mem avail:  2206 of  7597 MiB (29 %), swap free:   77 of  975 MiB ( 7 %)
</code></pre></div>



<a name="223139560"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/185405-t-compiler/rust-analyzer/topic/running%20RA%20on%20docs.rs/near/223139560" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Nelson <a href="https://rust-lang.github.io/zulip_archive/stream/185405-t-compiler/rust-analyzer/topic/running.20RA.20on.20docs.2Ers.html#223139560">(Jan 18 2021 at 16:15)</a>:</h4>
<p>I can close some tabs and see how much memory it will take if I let it run long enough</p>



<a name="223139756"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/185405-t-compiler/rust-analyzer/topic/running%20RA%20on%20docs.rs/near/223139756" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Nelson <a href="https://rust-lang.github.io/zulip_archive/stream/185405-t-compiler/rust-analyzer/topic/running.20RA.20on.20docs.2Ers.html#223139756">(Jan 18 2021 at 16:16)</a>:</h4>
<p>it got up to 2.7 GB this time and seems to be working reasonably well</p>



<a name="223139770"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/185405-t-compiler/rust-analyzer/topic/running%20RA%20on%20docs.rs/near/223139770" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Nelson <a href="https://rust-lang.github.io/zulip_archive/stream/185405-t-compiler/rust-analyzer/topic/running.20RA.20on.20docs.2Ers.html#223139770">(Jan 18 2021 at 16:16)</a>:</h4>
<p>but I had to close pretty much everything except the zulip tab</p>



<a name="223139984"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/185405-t-compiler/rust-analyzer/topic/running%20RA%20on%20docs.rs/near/223139984" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Nelson <a href="https://rust-lang.github.io/zulip_archive/stream/185405-t-compiler/rust-analyzer/topic/running.20RA.20on.20docs.2Ers.html#223139984">(Jan 18 2021 at 16:18)</a>:</h4>
<p>so it's not a <em>bug</em> in RA, it just uses too much memory for me to use it normally</p>



<a name="223140355"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/185405-t-compiler/rust-analyzer/topic/running%20RA%20on%20docs.rs/near/223140355" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Nelson <a href="https://rust-lang.github.io/zulip_archive/stream/185405-t-compiler/rust-analyzer/topic/running.20RA.20on.20docs.2Ers.html#223140355">(Jan 18 2021 at 16:21)</a>:</h4>
<p>I tried the 'clear database' command again and it has the same issue as before, it shows -3.2 GB which I think means it <em>allocated</em> memory while the command was running</p>



<a name="223140364"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/185405-t-compiler/rust-analyzer/topic/running%20RA%20on%20docs.rs/near/223140364" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Nelson <a href="https://rust-lang.github.io/zulip_archive/stream/185405-t-compiler/rust-analyzer/topic/running.20RA.20on.20docs.2Ers.html#223140364">(Jan 18 2021 at 16:21)</a>:</h4>
<p><code>top</code> still shows RA using 2.7 GB RSS</p>



<a name="223140390"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/185405-t-compiler/rust-analyzer/topic/running%20RA%20on%20docs.rs/near/223140390" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Nelson <a href="https://rust-lang.github.io/zulip_archive/stream/185405-t-compiler/rust-analyzer/topic/running.20RA.20on.20docs.2Ers.html#223140390">(Jan 18 2021 at 16:21)</a>:</h4>
<p>anyway, let me know if I can help more with this</p>



<a name="223140514"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/185405-t-compiler/rust-analyzer/topic/running%20RA%20on%20docs.rs/near/223140514" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Edwin Cheng <a href="https://rust-lang.github.io/zulip_archive/stream/185405-t-compiler/rust-analyzer/topic/running.20RA.20on.20docs.2Ers.html#223140514">(Jan 18 2021 at 16:22)</a>:</h4>
<p>Here is my machine stats from <code>top</code>:</p>
<div class="codehilite"><pre><span></span><code>  PID USER      PR  NI    VIRT    RES    SHR S  %CPU  %MEM     TIME+ COMMAND
 109309 edwin     20   0 1920708   1.4g  15504 S   0.0   8.8   0:35.15 rust-analyzer
 109872 edwin     20   0  153216  79268  69088 S   0.0   0.5   0:02.13 /home/edwin/.cargo/bin/rust-analyzer proc-macro
</code></pre></div>



<a name="223140569"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/185405-t-compiler/rust-analyzer/topic/running%20RA%20on%20docs.rs/near/223140569" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Edwin Cheng <a href="https://rust-lang.github.io/zulip_archive/stream/185405-t-compiler/rust-analyzer/topic/running.20RA.20on.20docs.2Ers.html#223140569">(Jan 18 2021 at 16:23)</a>:</h4>
<p>So it is around 1.5g and no panic occuried..</p>



<a name="223140588"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/185405-t-compiler/rust-analyzer/topic/running%20RA%20on%20docs.rs/near/223140588" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Nelson <a href="https://rust-lang.github.io/zulip_archive/stream/185405-t-compiler/rust-analyzer/topic/running.20RA.20on.20docs.2Ers.html#223140588">(Jan 18 2021 at 16:23)</a>:</h4>
<p><span aria-label="shrug" class="emoji emoji-1f937" role="img" title="shrug">:shrug:</span> that is not my experience</p>



<a name="223140618"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/185405-t-compiler/rust-analyzer/topic/running%20RA%20on%20docs.rs/near/223140618" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Nelson <a href="https://rust-lang.github.io/zulip_archive/stream/185405-t-compiler/rust-analyzer/topic/running.20RA.20on.20docs.2Ers.html#223140618">(Jan 18 2021 at 16:23)</a>:</h4>
<p>I'm on debian 10 with <code>rustc 1.49.0 (e1884a8e3 2020-12-29)</code> if it helps</p>



<a name="223140753"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/185405-t-compiler/rust-analyzer/topic/running%20RA%20on%20docs.rs/near/223140753" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Edwin Cheng <a href="https://rust-lang.github.io/zulip_archive/stream/185405-t-compiler/rust-analyzer/topic/running.20RA.20on.20docs.2Ers.html#223140753">(Jan 18 2021 at 16:25)</a>:</h4>
<p>x86 ?</p>



<a name="223140765"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/185405-t-compiler/rust-analyzer/topic/running%20RA%20on%20docs.rs/near/223140765" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Nelson <a href="https://rust-lang.github.io/zulip_archive/stream/185405-t-compiler/rust-analyzer/topic/running.20RA.20on.20docs.2Ers.html#223140765">(Jan 18 2021 at 16:25)</a>:</h4>
<p>x86_64, yeah. This is an 7th-gen intel i5 with 4 cores (2 physical cores) and 8 GB memory</p>



<a name="223140883"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/185405-t-compiler/rust-analyzer/topic/running%20RA%20on%20docs.rs/near/223140883" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Edwin Cheng <a href="https://rust-lang.github.io/zulip_archive/stream/185405-t-compiler/rust-analyzer/topic/running.20RA.20on.20docs.2Ers.html#223140883">(Jan 18 2021 at 16:26)</a>:</h4>
<p>Iam still on 1.48 , let me update and try</p>



<a name="223140913"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/185405-t-compiler/rust-analyzer/topic/running%20RA%20on%20docs.rs/near/223140913" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Nelson <a href="https://rust-lang.github.io/zulip_archive/stream/185405-t-compiler/rust-analyzer/topic/running.20RA.20on.20docs.2Ers.html#223140913">(Jan 18 2021 at 16:27)</a>:</h4>
<p>hmm, I might have some RA settings that aren't the default? How do I find those?</p>



<a name="223140937"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/185405-t-compiler/rust-analyzer/topic/running%20RA%20on%20docs.rs/near/223140937" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Edwin Cheng <a href="https://rust-lang.github.io/zulip_archive/stream/185405-t-compiler/rust-analyzer/topic/running.20RA.20on.20docs.2Ers.html#223140937">(Jan 18 2021 at 16:27)</a>:</h4>
<p>If you are using vscode, just copy the json settings ?</p>



<a name="223141022"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/185405-t-compiler/rust-analyzer/topic/running%20RA%20on%20docs.rs/near/223141022" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> oliver <a href="https://rust-lang.github.io/zulip_archive/stream/185405-t-compiler/rust-analyzer/topic/running.20RA.20on.20docs.2Ers.html#223141022">(Jan 18 2021 at 16:28)</a>:</h4>
<p>do you only have the one Rust extension running?</p>



<a name="223141038"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/185405-t-compiler/rust-analyzer/topic/running%20RA%20on%20docs.rs/near/223141038" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Nelson <a href="https://rust-lang.github.io/zulip_archive/stream/185405-t-compiler/rust-analyzer/topic/running.20RA.20on.20docs.2Ers.html#223141038">(Jan 18 2021 at 16:28)</a>:</h4>
<div class="codehilite"><pre><span></span><code>    &quot;rust-analyzer.checkOnSave.overrideCommand&quot;: null,
    &quot;rust-analyzer.checkOnSave.allTargets&quot;: false,
    &quot;rust-analyzer.checkOnSave.enable&quot;: false
</code></pre></div>



<a name="223141054"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/185405-t-compiler/rust-analyzer/topic/running%20RA%20on%20docs.rs/near/223141054" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Nelson <a href="https://rust-lang.github.io/zulip_archive/stream/185405-t-compiler/rust-analyzer/topic/running.20RA.20on.20docs.2Ers.html#223141054">(Jan 18 2021 at 16:29)</a>:</h4>
<p><span class="user-mention silent" data-user-id="281739">oliver</span> <a href="#narrow/stream/185405-t-compiler.2Fwg-rls-2.2E0/topic/running.20RA.20on.20docs.2Ers/near/223141022">said</a>:</p>
<blockquote>
<p>do you only have the one Rust extension running?</p>
</blockquote>
<p>yes, RA works fine on other projects, and works fine on this one other than the memory usage</p>



<a name="223141086"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/185405-t-compiler/rust-analyzer/topic/running%20RA%20on%20docs.rs/near/223141086" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Nelson <a href="https://rust-lang.github.io/zulip_archive/stream/185405-t-compiler/rust-analyzer/topic/running.20RA.20on.20docs.2Ers.html#223141086">(Jan 18 2021 at 16:29)</a>:</h4>
<p>and top specifically shows <code>rust-analyzer-x</code>, not VSCode, as using the memory</p>



<a name="223141228"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/185405-t-compiler/rust-analyzer/topic/running%20RA%20on%20docs.rs/near/223141228" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Nelson <a href="https://rust-lang.github.io/zulip_archive/stream/185405-t-compiler/rust-analyzer/topic/running.20RA.20on.20docs.2Ers.html#223141228">(Jan 18 2021 at 16:30)</a>:</h4>
<p><span class="user-mention silent" data-user-id="232545">Joshua Nelson</span> <a href="#narrow/stream/185405-t-compiler.2Fwg-rls-2.2E0/topic/running.20RA.20on.20docs.2Ers/near/223141038">said</a>:</p>
<blockquote>
<p><div class="codehilite"><pre><span></span><code>    &quot;rust-analyzer.checkOnSave.overrideCommand&quot;: null,
    &quot;rust-analyzer.checkOnSave.allTargets&quot;: false,
    &quot;rust-analyzer.checkOnSave.enable&quot;: false
</code></pre></div><br>
</p>
</blockquote>
<p>(I have a bunch more things in settings, but none of them start with <code>rust-analyzer</code>)</p>



<a name="223141330"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/185405-t-compiler/rust-analyzer/topic/running%20RA%20on%20docs.rs/near/223141330" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> oliver <a href="https://rust-lang.github.io/zulip_archive/stream/185405-t-compiler/rust-analyzer/topic/running.20RA.20on.20docs.2Ers.html#223141330">(Jan 18 2021 at 16:31)</a>:</h4>
<p>me</p>
<div class="codehilite" data-code-language="JSON"><pre><span></span><code>    <span class="nt">"rust-analyzer.updates.channel"</span><span class="p">:</span> <span class="s2">"nightly"</span><span class="p">,</span>
    <span class="nt">"rust-analyzer.updates.askBeforeDownload"</span><span class="p">:</span> <span class="kc">false</span><span class="p">,</span>
    <span class="nt">"rust-analyzer.cargo.allFeatures"</span><span class="p">:</span> <span class="kc">true</span><span class="p">,</span>
    <span class="nt">"rust-analyzer.assist.importMergeBehaviour"</span><span class="p">:</span> <span class="s2">"full"</span><span class="p">,</span>
    <span class="nt">"rust-analyzer.cargo.target"</span><span class="p">:</span> <span class="kc">null</span><span class="p">,</span>
    <span class="nt">"rust-analyzer.cargoRunner"</span><span class="p">:</span> <span class="kc">null</span><span class="p">,</span>
</code></pre></div>



<a name="223141397"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/185405-t-compiler/rust-analyzer/topic/running%20RA%20on%20docs.rs/near/223141397" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Laurențiu <a href="https://rust-lang.github.io/zulip_archive/stream/185405-t-compiler/rust-analyzer/topic/running.20RA.20on.20docs.2Ers.html#223141397">(Jan 18 2021 at 16:32)</a>:</h4>
<p>Does <code>rust-analyzer-x analysis-stats .</code> work?</p>



<a name="223141488"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/185405-t-compiler/rust-analyzer/topic/running%20RA%20on%20docs.rs/near/223141488" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> oliver <a href="https://rust-lang.github.io/zulip_archive/stream/185405-t-compiler/rust-analyzer/topic/running.20RA.20on.20docs.2Ers.html#223141488">(Jan 18 2021 at 16:33)</a>:</h4>
<p>as well ofc <code>"rust-client.rustupPath": "~/.cargo/bin/rustup",</code></p>



<a name="223141520"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/185405-t-compiler/rust-analyzer/topic/running%20RA%20on%20docs.rs/near/223141520" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Nelson <a href="https://rust-lang.github.io/zulip_archive/stream/185405-t-compiler/rust-analyzer/topic/running.20RA.20on.20docs.2Ers.html#223141520">(Jan 18 2021 at 16:33)</a>:</h4>
<p>hmm I need to find where in PATH rust-analyzer is, one sec</p>



<a name="223141537"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/185405-t-compiler/rust-analyzer/topic/running%20RA%20on%20docs.rs/near/223141537" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Laurențiu <a href="https://rust-lang.github.io/zulip_archive/stream/185405-t-compiler/rust-analyzer/topic/running.20RA.20on.20docs.2Ers.html#223141537">(Jan 18 2021 at 16:34)</a>:</h4>
<p>Why does it say <code>-x</code>?</p>



<a name="223141597"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/185405-t-compiler/rust-analyzer/topic/running%20RA%20on%20docs.rs/near/223141597" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Nelson <a href="https://rust-lang.github.io/zulip_archive/stream/185405-t-compiler/rust-analyzer/topic/running.20RA.20on.20docs.2Ers.html#223141597">(Jan 18 2021 at 16:34)</a>:</h4>
<p>oh it must be <code>/home/joshua/.config/Code/User/globalStorage/matklad.rust-analyzer/rust-analyzer-x86_64-unknown-linux-gnu</code></p>



<a name="223141605"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/185405-t-compiler/rust-analyzer/topic/running%20RA%20on%20docs.rs/near/223141605" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Nelson <a href="https://rust-lang.github.io/zulip_archive/stream/185405-t-compiler/rust-analyzer/topic/running.20RA.20on.20docs.2Ers.html#223141605">(Jan 18 2021 at 16:34)</a>:</h4>
<p>I guess top cut it off because it was too long lol</p>



<a name="223141615"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/185405-t-compiler/rust-analyzer/topic/running%20RA%20on%20docs.rs/near/223141615" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Laurențiu <a href="https://rust-lang.github.io/zulip_archive/stream/185405-t-compiler/rust-analyzer/topic/running.20RA.20on.20docs.2Ers.html#223141615">(Jan 18 2021 at 16:34)</a>:</h4>
<p>Right</p>



<a name="223141639"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/185405-t-compiler/rust-analyzer/topic/running%20RA%20on%20docs.rs/near/223141639" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Nelson <a href="https://rust-lang.github.io/zulip_archive/stream/185405-t-compiler/rust-analyzer/topic/running.20RA.20on.20docs.2Ers.html#223141639">(Jan 18 2021 at 16:34)</a>:</h4>
<blockquote>
<p>Failed to create perf counter: Operation not permitted (os error 1)</p>
</blockquote>
<p>do I need to run it with sudo?</p>



<a name="223141654"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/185405-t-compiler/rust-analyzer/topic/running%20RA%20on%20docs.rs/near/223141654" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Nelson <a href="https://rust-lang.github.io/zulip_archive/stream/185405-t-compiler/rust-analyzer/topic/running.20RA.20on.20docs.2Ers.html#223141654">(Jan 18 2021 at 16:35)</a>:</h4>
<p>(does RA try to modify things in the home directory?)</p>



<a name="223141677"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/185405-t-compiler/rust-analyzer/topic/running%20RA%20on%20docs.rs/near/223141677" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Laurențiu <a href="https://rust-lang.github.io/zulip_archive/stream/185405-t-compiler/rust-analyzer/topic/running.20RA.20on.20docs.2Ers.html#223141677">(Jan 18 2021 at 16:35)</a>:</h4>
<p>Maybe try installing GNU <code>time</code> and running <code>command time ~/.config/Code/User/globalStorage/matklad.rust-analyzer/rust-analyzer-x86_64-unknown-linux-gnu analysis-stats .</code></p>



<a name="223141691"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/185405-t-compiler/rust-analyzer/topic/running%20RA%20on%20docs.rs/near/223141691" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Laurențiu <a href="https://rust-lang.github.io/zulip_archive/stream/185405-t-compiler/rust-analyzer/topic/running.20RA.20on.20docs.2Ers.html#223141691">(Jan 18 2021 at 16:35)</a>:</h4>
<p>For the perf counters yes, but you don't _need_ them, I suppose</p>



<a name="223141713"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/185405-t-compiler/rust-analyzer/topic/running%20RA%20on%20docs.rs/near/223141713" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Nelson <a href="https://rust-lang.github.io/zulip_archive/stream/185405-t-compiler/rust-analyzer/topic/running.20RA.20on.20docs.2Ers.html#223141713">(Jan 18 2021 at 16:35)</a>:</h4>
<p>oh sorry it got OOM killed again, let me finish the other thing I'm doing</p>
<div class="codehilite"><pre><span></span><code>&gt; /home/joshua/.config/Code/User/globalStorage/matklad.rust-analyzer/rust-analyzer-x86_64-unknown-linux-gnu analysis-stats .
Failed to create perf counter: Operation not permitted (os error 1)
Terminated
</code></pre></div>



<a name="223141719"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/185405-t-compiler/rust-analyzer/topic/running%20RA%20on%20docs.rs/near/223141719" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Laurențiu <a href="https://rust-lang.github.io/zulip_archive/stream/185405-t-compiler/rust-analyzer/topic/running.20RA.20on.20docs.2Ers.html#223141719">(Jan 18 2021 at 16:35)</a>:</h4>
<p>It runs <code>cargo metadata</code> so it might write some files as <code>root</code> if you use <code>sudo</code></p>



<a name="223141790"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/185405-t-compiler/rust-analyzer/topic/running%20RA%20on%20docs.rs/near/223141790" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Laurențiu <a href="https://rust-lang.github.io/zulip_archive/stream/185405-t-compiler/rust-analyzer/topic/running.20RA.20on.20docs.2Ers.html#223141790">(Jan 18 2021 at 16:36)</a>:</h4>
<p>Cool, then it's easier to reproduce it</p>



<a name="223141878"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/185405-t-compiler/rust-analyzer/topic/running%20RA%20on%20docs.rs/near/223141878" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Laurențiu <a href="https://rust-lang.github.io/zulip_archive/stream/185405-t-compiler/rust-analyzer/topic/running.20RA.20on.20docs.2Ers.html#223141878">(Jan 18 2021 at 16:37)</a>:</h4>
<div class="codehilite"><pre><span></span><code>Database loaded:     2.28s, 516minstr
  crates: 9, mods: 102, decls: 900, fns: 623
Item Collection:     10.07s, 106ginstr
  exprs: 48928, ??ty: 676 (1%), ?ty: 797 (1%), !ty: 93
Inference:           6.56s, 59ginstr
Total:               16.63s, 165ginstr
17.83user 0.41system 0:19.51elapsed 93%CPU (0avgtext+0avgdata 1206296maxresident)k
179344inputs+16520outputs (94major+382095minor)pagefaults 0swaps
</code></pre></div>



<a name="223141899"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/185405-t-compiler/rust-analyzer/topic/running%20RA%20on%20docs.rs/near/223141899" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Laurențiu <a href="https://rust-lang.github.io/zulip_archive/stream/185405-t-compiler/rust-analyzer/topic/running.20RA.20on.20docs.2Ers.html#223141899">(Jan 18 2021 at 16:37)</a>:</h4>
<p>So it's using.. 1.2G on my system</p>



<a name="223142031"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/185405-t-compiler/rust-analyzer/topic/running%20RA%20on%20docs.rs/near/223142031" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Laurențiu <a href="https://rust-lang.github.io/zulip_archive/stream/185405-t-compiler/rust-analyzer/topic/running.20RA.20on.20docs.2Ers.html#223142031">(Jan 18 2021 at 16:38)</a>:</h4>
<p>What distro are you running? Maybe it's allocator-specific?</p>



<a name="223142210"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/185405-t-compiler/rust-analyzer/topic/running%20RA%20on%20docs.rs/near/223142210" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Edwin Cheng <a href="https://rust-lang.github.io/zulip_archive/stream/185405-t-compiler/rust-analyzer/topic/running.20RA.20on.20docs.2Ers.html#223142210">(Jan 18 2021 at 16:40)</a>:</h4>
<p><span class="user-mention silent" data-user-id="232545">Joshua Nelson</span> <a href="#narrow/stream/185405-t-compiler.2Fwg-rls-2.2E0/topic/running.20RA.20on.20docs.2Ers/near/223141228">said</a>:</p>
<blockquote>
<p><span class="user-mention silent" data-user-id="232545">Joshua Nelson</span> <a href="#narrow/stream/185405-t-compiler.2Fwg-rls-2.2E0/topic/running.20RA.20on.20docs.2Ers/near/223141038">said</a>:</p>
<blockquote>
<p><div class="codehilite"><pre><span></span><code>    &quot;rust-analyzer.checkOnSave.overrideCommand&quot;: null,
    &quot;rust-analyzer.checkOnSave.allTargets&quot;: false,
    &quot;rust-analyzer.checkOnSave.enable&quot;: false
</code></pre></div><br>
</p>
</blockquote>
<p>(I have a bunch more things in settings, but none of them start with <code>rust-analyzer</code>)</p>
</blockquote>
<p>So you do not enable proc-macro support ...? Um..</p>



<a name="223142235"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/185405-t-compiler/rust-analyzer/topic/running%20RA%20on%20docs.rs/near/223142235" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Laurențiu <a href="https://rust-lang.github.io/zulip_archive/stream/185405-t-compiler/rust-analyzer/topic/running.20RA.20on.20docs.2Ers.html#223142235">(Jan 18 2021 at 16:40)</a>:</h4>
<p><code>analysis-stats</code> also doesn't enable proc macros by default</p>



<a name="223142250"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/185405-t-compiler/rust-analyzer/topic/running%20RA%20on%20docs.rs/near/223142250" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Laurențiu <a href="https://rust-lang.github.io/zulip_archive/stream/185405-t-compiler/rust-analyzer/topic/running.20RA.20on.20docs.2Ers.html#223142250">(Jan 18 2021 at 16:40)</a>:</h4>
<p>If you're using a pre-built binary, I guess it's not CentOS 7, so the oldest one that works is Ubuntu 16.04 with GLIBC 2.23 and the new allocator got merged in 2.26..</p>



<a name="223142419"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/185405-t-compiler/rust-analyzer/topic/running%20RA%20on%20docs.rs/near/223142419" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Nelson <a href="https://rust-lang.github.io/zulip_archive/stream/185405-t-compiler/rust-analyzer/topic/running.20RA.20on.20docs.2Ers.html#223142419">(Jan 18 2021 at 16:42)</a>:</h4>
<p>this is ubuntu 20.04</p>



<a name="223142427"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/185405-t-compiler/rust-analyzer/topic/running%20RA%20on%20docs.rs/near/223142427" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Florian Diebold <a href="https://rust-lang.github.io/zulip_archive/stream/185405-t-compiler/rust-analyzer/topic/running.20RA.20on.20docs.2Ers.html#223142427">(Jan 18 2021 at 16:42)</a>:</h4>
<p>there's also the <code>--memory-usage</code> argument to <code>analysis-stats</code></p>



<a name="223142444"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/185405-t-compiler/rust-analyzer/topic/running%20RA%20on%20docs.rs/near/223142444" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Florian Diebold <a href="https://rust-lang.github.io/zulip_archive/stream/185405-t-compiler/rust-analyzer/topic/running.20RA.20on.20docs.2Ers.html#223142444">(Jan 18 2021 at 16:42)</a>:</h4>
<div class="codehilite"><pre><span></span><code>Database loaded:     1.26s, 512minstr, 129mb
  crates: 9, mods: 102, decls: 900, fns: 623
Item Collection:     25.28s, 136ginstr, 755mb
  exprs: 49526, ??ty: 246 (0%), ?ty: 455 (0%), !ty: 10
Inference:           16.16s, 76ginstr, 306mb
Total:               41.44s, 212ginstr, 1062mb
43.09user 0.69system 0:43.95elapsed 99%CPU (0avgtext+0avgdata 1226628maxresident)k
0inputs+8outputs (0major+373318minor)pagefaults 0swaps
</code></pre></div>



<a name="223142448"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/185405-t-compiler/rust-analyzer/topic/running%20RA%20on%20docs.rs/near/223142448" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Laurențiu <a href="https://rust-lang.github.io/zulip_archive/stream/185405-t-compiler/rust-analyzer/topic/running.20RA.20on.20docs.2Ers.html#223142448">(Jan 18 2021 at 16:42)</a>:</h4>
<p>Not if it OOMs <span aria-label="smiley" class="emoji emoji-1f603" role="img" title="smiley">:smiley:</span></p>



<a name="223142488"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/185405-t-compiler/rust-analyzer/topic/running%20RA%20on%20docs.rs/near/223142488" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Nelson <a href="https://rust-lang.github.io/zulip_archive/stream/185405-t-compiler/rust-analyzer/topic/running.20RA.20on.20docs.2Ers.html#223142488">(Jan 18 2021 at 16:43)</a>:</h4>
<p><span class="user-mention silent" data-user-id="216201">Edwin Cheng</span> <a href="#narrow/stream/185405-t-compiler.2Fwg-rls-2.2E0/topic/running.20RA.20on.20docs.2Ers/near/223142210">said</a>:</p>
<blockquote>
<p><span class="user-mention silent" data-user-id="232545">Joshua Nelson</span> <a href="#narrow/stream/185405-t-compiler.2Fwg-rls-2.2E0/topic/running.20RA.20on.20docs.2Ers/near/223141228">said</a>:</p>
<blockquote>
<p><span class="user-mention silent" data-user-id="232545">Joshua Nelson</span> <a href="#narrow/stream/185405-t-compiler.2Fwg-rls-2.2E0/topic/running.20RA.20on.20docs.2Ers/near/223141038">said</a>:</p>
<blockquote>
<p><div class="codehilite"><pre><span></span><code>    &quot;rust-analyzer.checkOnSave.overrideCommand&quot;: null,
    &quot;rust-analyzer.checkOnSave.allTargets&quot;: false,
    &quot;rust-analyzer.checkOnSave.enable&quot;: false
</code></pre></div><br>
</p>
</blockquote>
<p>(I have a bunch more things in settings, but none of them start with <code>rust-analyzer</code>)</p>
</blockquote>
<p>So you do not enable proc-macro support ...? Um..</p>
</blockquote>
<p><a href="http://docs.rs">docs.rs</a> doesn't use a ton of proc-macros I don't think</p>



<a name="223142520"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/185405-t-compiler/rust-analyzer/topic/running%20RA%20on%20docs.rs/near/223142520" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Florian Diebold <a href="https://rust-lang.github.io/zulip_archive/stream/185405-t-compiler/rust-analyzer/topic/running.20RA.20on.20docs.2Ers.html#223142520">(Jan 18 2021 at 16:43)</a>:</h4>
<p>in any case, it seems to OOM without proc-macros anyway</p>



<a name="223142530"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/185405-t-compiler/rust-analyzer/topic/running%20RA%20on%20docs.rs/near/223142530" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Nelson <a href="https://rust-lang.github.io/zulip_archive/stream/185405-t-compiler/rust-analyzer/topic/running.20RA.20on.20docs.2Ers.html#223142530">(Jan 18 2021 at 16:43)</a>:</h4>
<p>still waiting for the other build to finish, sorry</p>



<a name="223142563"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/185405-t-compiler/rust-analyzer/topic/running%20RA%20on%20docs.rs/near/223142563" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Nelson <a href="https://rust-lang.github.io/zulip_archive/stream/185405-t-compiler/rust-analyzer/topic/running.20RA.20on.20docs.2Ers.html#223142563">(Jan 18 2021 at 16:44)</a>:</h4>
<p>clearly the solution is for rust to just be a simpler language to compile <span aria-label="laughing" class="emoji emoji-1f606" role="img" title="laughing">:laughing:</span></p>



<a name="223142662"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/185405-t-compiler/rust-analyzer/topic/running%20RA%20on%20docs.rs/near/223142662" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Edwin Cheng <a href="https://rust-lang.github.io/zulip_archive/stream/185405-t-compiler/rust-analyzer/topic/running.20RA.20on.20docs.2Ers.html#223142662">(Jan 18 2021 at 16:44)</a>:</h4>
<p>Okay, rust 1.49 build and disabled proc-macro in my machine:</p>
<div class="codehilite"><pre><span></span><code>    PID USER      PR  NI    VIRT    RES    SHR S  %CPU  %MEM     TIME+ COMMAND
 130314 edwin     20   0 1645292   1.1g  16156 S   0.0   7.3   0:29.51 rust-analyzer
</code></pre></div>



<a name="223142813"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/185405-t-compiler/rust-analyzer/topic/running%20RA%20on%20docs.rs/near/223142813" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Edwin Cheng <a href="https://rust-lang.github.io/zulip_archive/stream/185405-t-compiler/rust-analyzer/topic/running.20RA.20on.20docs.2Ers.html#223142813">(Jan 18 2021 at 16:46)</a>:</h4>
<p><span class="user-mention" data-user-id="232545">@Joshua Nelson</span> what's your rust-analyzer version ?</p>



<a name="223142867"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/185405-t-compiler/rust-analyzer/topic/running%20RA%20on%20docs.rs/near/223142867" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Nelson <a href="https://rust-lang.github.io/zulip_archive/stream/185405-t-compiler/rust-analyzer/topic/running.20RA.20on.20docs.2Ers.html#223142867">(Jan 18 2021 at 16:47)</a>:</h4>
<p>--version tells me <code>rust-analyzer fde4a86</code></p>



<a name="223142873"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/185405-t-compiler/rust-analyzer/topic/running%20RA%20on%20docs.rs/near/223142873" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Nelson <a href="https://rust-lang.github.io/zulip_archive/stream/185405-t-compiler/rust-analyzer/topic/running.20RA.20on.20docs.2Ers.html#223142873">(Jan 18 2021 at 16:47)</a>:</h4>
<p>not sure how to get a date from that</p>



<a name="223142907"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/185405-t-compiler/rust-analyzer/topic/running%20RA%20on%20docs.rs/near/223142907" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Laurențiu <a href="https://rust-lang.github.io/zulip_archive/stream/185405-t-compiler/rust-analyzer/topic/running.20RA.20on.20docs.2Ers.html#223142907">(Jan 18 2021 at 16:47)</a>:</h4>
<p>It's today's</p>



<a name="223143020"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/185405-t-compiler/rust-analyzer/topic/running%20RA%20on%20docs.rs/near/223143020" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Edwin Cheng <a href="https://rust-lang.github.io/zulip_archive/stream/185405-t-compiler/rust-analyzer/topic/running.20RA.20on.20docs.2Ers.html#223143020">(Jan 18 2021 at 16:48)</a>:</h4>
<p>You build from source ? but your path is vscode extension one ?</p>



<a name="223143059"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/185405-t-compiler/rust-analyzer/topic/running%20RA%20on%20docs.rs/near/223143059" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Nelson <a href="https://rust-lang.github.io/zulip_archive/stream/185405-t-compiler/rust-analyzer/topic/running.20RA.20on.20docs.2Ers.html#223143059">(Jan 18 2021 at 16:49)</a>:</h4>
<p>I did not build from source. This is from the 'rust-analyzer server is not installed' button in vscode</p>



<a name="223143125"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/185405-t-compiler/rust-analyzer/topic/running%20RA%20on%20docs.rs/near/223143125" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Nelson <a href="https://rust-lang.github.io/zulip_archive/stream/185405-t-compiler/rust-analyzer/topic/running.20RA.20on.20docs.2Ers.html#223143125">(Jan 18 2021 at 16:50)</a>:</h4>
<p>(the other build is <em>still</em> running, sorry)</p>



<a name="223143241"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/185405-t-compiler/rust-analyzer/topic/running%20RA%20on%20docs.rs/near/223143241" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Laurențiu <a href="https://rust-lang.github.io/zulip_archive/stream/185405-t-compiler/rust-analyzer/topic/running.20RA.20on.20docs.2Ers.html#223143241">(Jan 18 2021 at 16:51)</a>:</h4>
<p>Tried it in Docker:</p>
<div class="codehilite"><pre><span></span><code>Failed to create perf counter: Operation not permitted (os error 1)
Database loaded:     374.68ms, 131mb
Failed to create perf counter: Operation not permitted (os error 1)
  crates: 9, mods: 102, decls: 900, fns: 623
Item Collection:     10.05s, 771mb
Failed to create perf counter: Operation not permitted (os error 1)
  exprs: 48928, ??ty: 676 (1%), ?ty: 797 (1%), !ty: 93
Inference:           6.43s, 301mb
Total:               16.48s, 1072mb
</code></pre></div>



<a name="223143431"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/185405-t-compiler/rust-analyzer/topic/running%20RA%20on%20docs.rs/near/223143431" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Laurențiu <a href="https://rust-lang.github.io/zulip_archive/stream/185405-t-compiler/rust-analyzer/topic/running.20RA.20on.20docs.2Ers.html#223143431">(Jan 18 2021 at 16:53)</a>:</h4>
<p>Next step would be a live USB <span aria-label="smile" class="emoji emoji-1f642" role="img" title="smile">:smile:</span></p>



<a name="223143660"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/185405-t-compiler/rust-analyzer/topic/running%20RA%20on%20docs.rs/near/223143660" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Nelson <a href="https://rust-lang.github.io/zulip_archive/stream/185405-t-compiler/rust-analyzer/topic/running.20RA.20on.20docs.2Ers.html#223143660">(Jan 18 2021 at 16:55)</a>:</h4>
<p>I wouldn't expect it to be related to the distro</p>



<a name="223143698"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/185405-t-compiler/rust-analyzer/topic/running%20RA%20on%20docs.rs/near/223143698" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> oliver <a href="https://rust-lang.github.io/zulip_archive/stream/185405-t-compiler/rust-analyzer/topic/running.20RA.20on.20docs.2Ers.html#223143698">(Jan 18 2021 at 16:55)</a>:</h4>
<p>I'm on the same thing as you and using <code>935Mb</code></p>



<a name="223143891"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/185405-t-compiler/rust-analyzer/topic/running%20RA%20on%20docs.rs/near/223143891" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Nelson <a href="https://rust-lang.github.io/zulip_archive/stream/185405-t-compiler/rust-analyzer/topic/running.20RA.20on.20docs.2Ers.html#223143891">(Jan 18 2021 at 16:57)</a>:</h4>
<p><span class="user-mention silent" data-user-id="203546">Laurențiu Nicola</span> <a href="#narrow/stream/185405-t-compiler.2Fwg-rls-2.2E0/topic/running.20RA.20on.20docs.2Ers/near/223141677">said</a>:</p>
<blockquote>
<p>Maybe try installing GNU <code>time</code> and running <code>command time ~/.config/Code/User/globalStorage/matklad.rust-analyzer/rust-analyzer-x86_64-unknown-linux-gnu analysis-stats .</code></p>
</blockquote>
<p>ok the other build finally finished, running this now</p>



<a name="223144046"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/185405-t-compiler/rust-analyzer/topic/running%20RA%20on%20docs.rs/near/223144046" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Nelson <a href="https://rust-lang.github.io/zulip_archive/stream/185405-t-compiler/rust-analyzer/topic/running.20RA.20on.20docs.2Ers.html#223144046">(Jan 18 2021 at 16:59)</a>:</h4>
<div class="codehilite"><pre><span></span><code>&gt; command time -v /home/joshua/.config/Code/User/globalStorage/matklad.rust-analyzer/rust-analyzer-x86_64-unknown-linux-gnu analysis-stats .
Database loaded:     45.09s
  crates: 9, mods: 102, decls: 900, fns: 623
Item Collection:     17.72s
92/623 14% processing: web::crate_details::tests::test_last_successful_build_with_intermittent_releases_failed_or_ya3/623 14% processing: web::crate_details::tests::test_last_successful_build_with_intermittent_releases_failed_or_yan  exprs: 49528, ??ty: 246 (0%), ?ty: 455 (0%), !ty: 11
Inference:           11.38s
Total:               29.09s
    Command being timed: &quot;/home/joshua/.config/Code/User/globalStorage/matklad.rust-analyzer/rust-analyzer-x86_64-unknown-linux-gnu analysis-stats .&quot;
    User time (seconds): 33.97
    System time (seconds): 10.80
    Percent of CPU this job got: 59%
    Elapsed (wall clock) time (h:mm:ss or m:ss): 1:15.48
    Average shared text size (kbytes): 0
    Average unshared data size (kbytes): 0
    Average stack size (kbytes): 0
    Average total size (kbytes): 0
    Maximum resident set size (kbytes): 2867164
</code></pre></div>



<a name="223144233"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/185405-t-compiler/rust-analyzer/topic/running%20RA%20on%20docs.rs/near/223144233" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Nelson <a href="https://rust-lang.github.io/zulip_archive/stream/185405-t-compiler/rust-analyzer/topic/running.20RA.20on.20docs.2Ers.html#223144233">(Jan 18 2021 at 17:01)</a>:</h4>
<p>oh whoops let me run that again with --memory-usage</p>



<a name="223144309"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/185405-t-compiler/rust-analyzer/topic/running%20RA%20on%20docs.rs/near/223144309" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Nelson <a href="https://rust-lang.github.io/zulip_archive/stream/185405-t-compiler/rust-analyzer/topic/running.20RA.20on.20docs.2Ers.html#223144309">(Jan 18 2021 at 17:01)</a>:</h4>
<div class="codehilite"><pre><span></span><code>&gt; command time -v /home/joshua/.config/Code/User/globalStorage/matklad.rust-analyzer/rust-analyzer-x86_64-unknown-linux-gnu analysis-stats --memory-usage .
Database loaded:     10.98s, 1682mb
  crates: 9, mods: 102, decls: 900, fns: 623
Item Collection:     18.26s, -3332mb
92/623 14% processing: web::crate_details::tests::test_last_successful_build_with_intermittent_releases_failed_or_ya3/623 14% processing: web::crate_details::tests::test_last_successful_build_with_intermittent_releases_failed_or_yan  exprs: 49528, ??ty: 246 (0%), ?ty: 455 (0%), !ty: 11
Inference:           12.36s, 307mb
Total:               30.63s, -3025mb
    Command being timed: &quot;/home/joshua/.config/Code/User/globalStorage/matklad.rust-analyzer/rust-analyzer-x86_64-unknown-linux-gnu analysis-stats --memory-usage .&quot;
    User time (seconds): 33.40
    System time (seconds): 3.47
    Percent of CPU this job got: 85%
    Elapsed (wall clock) time (h:mm:ss or m:ss): 0:42.93
    Average shared text size (kbytes): 0
    Average unshared data size (kbytes): 0
    Average stack size (kbytes): 0
    Average total size (kbytes): 0
    Maximum resident set size (kbytes): 2872688
</code></pre></div>



<a name="223144357"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/185405-t-compiler/rust-analyzer/topic/running%20RA%20on%20docs.rs/near/223144357" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Nelson <a href="https://rust-lang.github.io/zulip_archive/stream/185405-t-compiler/rust-analyzer/topic/running.20RA.20on.20docs.2Ers.html#223144357">(Jan 18 2021 at 17:02)</a>:</h4>
<blockquote>
<p>Total:               30.63s, -3025mb</p>
</blockquote>
<p>this looks very wrong</p>



<a name="223144376"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/185405-t-compiler/rust-analyzer/topic/running%20RA%20on%20docs.rs/near/223144376" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> oliver <a href="https://rust-lang.github.io/zulip_archive/stream/185405-t-compiler/rust-analyzer/topic/running.20RA.20on.20docs.2Ers.html#223144376">(Jan 18 2021 at 17:02)</a>:</h4>
<p>like corrupted memory wrong...</p>



<a name="223144421"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/185405-t-compiler/rust-analyzer/topic/running%20RA%20on%20docs.rs/near/223144421" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Daniel Silverstone <a href="https://rust-lang.github.io/zulip_archive/stream/185405-t-compiler/rust-analyzer/topic/running.20RA.20on.20docs.2Ers.html#223144421">(Jan 18 2021 at 17:02)</a>:</h4>
<p>Is that using an i32 somewhere to count memory usage?</p>



<a name="223144424"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/185405-t-compiler/rust-analyzer/topic/running%20RA%20on%20docs.rs/near/223144424" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jonas Schievink  [he/him] <a href="https://rust-lang.github.io/zulip_archive/stream/185405-t-compiler/rust-analyzer/topic/running.20RA.20on.20docs.2Ers.html#223144424">(Jan 18 2021 at 17:02)</a>:</h4>
<p>what, with the cli?? that should never happen</p>



<a name="223144440"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/185405-t-compiler/rust-analyzer/topic/running%20RA%20on%20docs.rs/near/223144440" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Nelson <a href="https://rust-lang.github.io/zulip_archive/stream/185405-t-compiler/rust-analyzer/topic/running.20RA.20on.20docs.2Ers.html#223144440">(Jan 18 2021 at 17:03)</a>:</h4>
<p>that's what it says</p>



<a name="223144594"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/185405-t-compiler/rust-analyzer/topic/running%20RA%20on%20docs.rs/near/223144594" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jonas Schievink  [he/him] <a href="https://rust-lang.github.io/zulip_archive/stream/185405-t-compiler/rust-analyzer/topic/running.20RA.20on.20docs.2Ers.html#223144594">(Jan 18 2021 at 17:04)</a>:</h4>
<p>we use <code>isize</code> to count this</p>



<a name="223144664"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/185405-t-compiler/rust-analyzer/topic/running%20RA%20on%20docs.rs/near/223144664" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Nelson <a href="https://rust-lang.github.io/zulip_archive/stream/185405-t-compiler/rust-analyzer/topic/running.20RA.20on.20docs.2Ers.html#223144664">(Jan 18 2021 at 17:05)</a>:</h4>
<p>hmm, isize is 8 bytes on x64</p>



<a name="223144682"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/185405-t-compiler/rust-analyzer/topic/running%20RA%20on%20docs.rs/near/223144682" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jonas Schievink  [he/him] <a href="https://rust-lang.github.io/zulip_archive/stream/185405-t-compiler/rust-analyzer/topic/running.20RA.20on.20docs.2Ers.html#223144682">(Jan 18 2021 at 17:05)</a>:</h4>
<p>why is the actual per-query memory usage missing? did this break recently?</p>



<a name="223144712"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/185405-t-compiler/rust-analyzer/topic/running%20RA%20on%20docs.rs/near/223144712" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> oliver <a href="https://rust-lang.github.io/zulip_archive/stream/185405-t-compiler/rust-analyzer/topic/running.20RA.20on.20docs.2Ers.html#223144712">(Jan 18 2021 at 17:06)</a>:</h4>
<p>you need to wait a bit for that</p>



<a name="223144768"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/185405-t-compiler/rust-analyzer/topic/running%20RA%20on%20docs.rs/near/223144768" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jonas Schievink  [he/him] <a href="https://rust-lang.github.io/zulip_archive/stream/185405-t-compiler/rust-analyzer/topic/running.20RA.20on.20docs.2Ers.html#223144768">(Jan 18 2021 at 17:06)</a>:</h4>
<p>it happens locally too, it just exits without outputting it</p>



<a name="223144831"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/185405-t-compiler/rust-analyzer/topic/running%20RA%20on%20docs.rs/near/223144831" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Nelson <a href="https://rust-lang.github.io/zulip_archive/stream/185405-t-compiler/rust-analyzer/topic/running.20RA.20on.20docs.2Ers.html#223144831">(Jan 18 2021 at 17:07)</a>:</h4>
<p><span class="user-mention silent" data-user-id="223910">Daniel Silverstone</span> <a href="#narrow/stream/185405-t-compiler.2Fwg-rls-2.2E0/topic/running.20RA.20on.20docs.2Ers/near/223144421">said</a>:</p>
<blockquote>
<p>Is that using an i32 somewhere to count memory usage?</p>
</blockquote>
<p>hmm, casting that to u32 isn't very informative: <a href="https://play.rust-lang.org/?version=stable&amp;mode=debug&amp;edition=2018&amp;gist=75edeec5350fc6b12e9f50b2a64def8d">https://play.rust-lang.org/?version=stable&amp;mode=debug&amp;edition=2018&amp;gist=75edeec5350fc6b12e9f50b2a64def8d</a></p>



<a name="223144840"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/185405-t-compiler/rust-analyzer/topic/running%20RA%20on%20docs.rs/near/223144840" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jonas Schievink  [he/him] <a href="https://rust-lang.github.io/zulip_archive/stream/185405-t-compiler/rust-analyzer/topic/running.20RA.20on.20docs.2Ers.html#223144840">(Jan 18 2021 at 17:07)</a>:</h4>
<p>ah, now you have to pass <code>--verbose</code> too</p>



<a name="223144876"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/185405-t-compiler/rust-analyzer/topic/running%20RA%20on%20docs.rs/near/223144876" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Nelson <a href="https://rust-lang.github.io/zulip_archive/stream/185405-t-compiler/rust-analyzer/topic/running.20RA.20on.20docs.2Ers.html#223144876">(Jan 18 2021 at 17:07)</a>:</h4>
<p>sure, running that</p>



<a name="223144884"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/185405-t-compiler/rust-analyzer/topic/running%20RA%20on%20docs.rs/near/223144884" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jonas Schievink  [he/him] <a href="https://rust-lang.github.io/zulip_archive/stream/185405-t-compiler/rust-analyzer/topic/running.20RA.20on.20docs.2Ers.html#223144884">(Jan 18 2021 at 17:07)</a>:</h4>
<p>can't wait for this to be a bug in glibc's memory allocator</p>



<a name="223144972"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/185405-t-compiler/rust-analyzer/topic/running%20RA%20on%20docs.rs/near/223144972" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Nelson <a href="https://rust-lang.github.io/zulip_archive/stream/185405-t-compiler/rust-analyzer/topic/running.20RA.20on.20docs.2Ers.html#223144972">(Jan 18 2021 at 17:08)</a>:</h4>
<p>hmm, this output is weird:</p>
<div class="codehilite"><pre><span></span><code>/home/joshua/src/rust/docs.rs/src/web/mod.rs 372:22-372:25: Expected str, got &amp;str
/home/joshua/src/rust/docs.rs/src/web/rustdoc.rs 388:25-388:40: Expected &amp;str, got &amp;String
/home/joshua/src/rust/docs.rs/src/web/builds.rs 269:20-269:22: Expected &amp;(dyn ToSql + Sync), got &amp;_
/home/joshua/src/rust/docs.rs/src/web/metrics.rs 41:21-41:38: Expected Box&lt;dyn Handler, Global&gt;, got Box&lt;impl Handler, Global&gt;
/home/joshua/src/rust/docs.rs/src/test/fakes.rs 303:40-303:52: Expected _, got &amp;str
/home/joshua/src/rust/docs.rs/src/test/fakes.rs 305:36-305:42: Expected &amp;str, got &amp;&lt;[&amp;String] as Join&lt;&amp;str&gt;&gt;::Output
/home/joshua/src/rust/docs.rs/src/test/fakes.rs 314:56-314:70: Expected Option&lt;&amp;str&gt;, got Option&lt;&amp;String&gt;
/home/joshua/src/rust/docs.rs/src/db/migrate.rs 64:8-180:9: Expected Vec&lt;Box&lt;dyn PostgresMigration, Global&gt;&gt;, got Vec&lt;Box&lt;Amigration, Global&gt;&gt;
</code></pre></div>



<a name="223145171"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/185405-t-compiler/rust-analyzer/topic/running%20RA%20on%20docs.rs/near/223145171" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Nelson <a href="https://rust-lang.github.io/zulip_archive/stream/185405-t-compiler/rust-analyzer/topic/running.20RA.20on.20docs.2Ers.html#223145171">(Jan 18 2021 at 17:10)</a>:</h4>
<p>anyway, here's with --verbose: <a href="https://gist.github.com/jyn514/01a0f789a2464d116d5c3974d4b1f52f">https://gist.github.com/jyn514/01a0f789a2464d116d5c3974d4b1f52f</a></p>



<a name="223145212"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/185405-t-compiler/rust-analyzer/topic/running%20RA%20on%20docs.rs/near/223145212" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Nelson <a href="https://rust-lang.github.io/zulip_archive/stream/185405-t-compiler/rust-analyzer/topic/running.20RA.20on.20docs.2Ers.html#223145212">(Jan 18 2021 at 17:11)</a>:</h4>
<blockquote>
<p>Total:               29.23s, -3025mb</p>
</blockquote>
<p>smh</p>



<a name="223145254"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/185405-t-compiler/rust-analyzer/topic/running%20RA%20on%20docs.rs/near/223145254" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Nelson <a href="https://rust-lang.github.io/zulip_archive/stream/185405-t-compiler/rust-analyzer/topic/running.20RA.20on.20docs.2Ers.html#223145254">(Jan 18 2021 at 17:11)</a>:</h4>
<p>the culprit seems to be</p>
<div class="codehilite"><pre><span></span><code> -3280mb FileTextQuery (purge)
</code></pre></div>



<a name="223145314"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/185405-t-compiler/rust-analyzer/topic/running%20RA%20on%20docs.rs/near/223145314" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jonas Schievink  [he/him] <a href="https://rust-lang.github.io/zulip_archive/stream/185405-t-compiler/rust-analyzer/topic/running.20RA.20on.20docs.2Ers.html#223145314">(Jan 18 2021 at 17:12)</a>:</h4>
<p>oh</p>
<p><code>int uordblks;</code></p>



<a name="223145339"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/185405-t-compiler/rust-analyzer/topic/running%20RA%20on%20docs.rs/near/223145339" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jonas Schievink  [he/him] <a href="https://rust-lang.github.io/zulip_archive/stream/185405-t-compiler/rust-analyzer/topic/running.20RA.20on.20docs.2Ers.html#223145339">(Jan 18 2021 at 17:12)</a>:</h4>
<p><code>int</code> is <code>i32</code> on x86_64</p>



<a name="223145347"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/185405-t-compiler/rust-analyzer/topic/running%20RA%20on%20docs.rs/near/223145347" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Nelson <a href="https://rust-lang.github.io/zulip_archive/stream/185405-t-compiler/rust-analyzer/topic/running.20RA.20on.20docs.2Ers.html#223145347">(Jan 18 2021 at 17:12)</a>:</h4>
<p>that would do it</p>



<a name="223145366"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/185405-t-compiler/rust-analyzer/topic/running%20RA%20on%20docs.rs/near/223145366" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Nelson <a href="https://rust-lang.github.io/zulip_archive/stream/185405-t-compiler/rust-analyzer/topic/running.20RA.20on.20docs.2Ers.html#223145366">(Jan 18 2021 at 17:12)</a>:</h4>
<p>where is <code>uordblks</code> from?</p>



<a name="223145385"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/185405-t-compiler/rust-analyzer/topic/running%20RA%20on%20docs.rs/near/223145385" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jonas Schievink  [he/him] <a href="https://rust-lang.github.io/zulip_archive/stream/185405-t-compiler/rust-analyzer/topic/running.20RA.20on.20docs.2Ers.html#223145385">(Jan 18 2021 at 17:12)</a>:</h4>
<p><a href="https://man7.org/linux/man-pages/man3/mallinfo.3.html">https://man7.org/linux/man-pages/man3/mallinfo.3.html</a></p>



<a name="223145423"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/185405-t-compiler/rust-analyzer/topic/running%20RA%20on%20docs.rs/near/223145423" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jonas Schievink  [he/him] <a href="https://rust-lang.github.io/zulip_archive/stream/185405-t-compiler/rust-analyzer/topic/running.20RA.20on.20docs.2Ers.html#223145423">(Jan 18 2021 at 17:12)</a>:</h4>
<p>that's what we use to figure out the memory usage via <code>mallinfo()</code></p>



<a name="223145482"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/185405-t-compiler/rust-analyzer/topic/running%20RA%20on%20docs.rs/near/223145482" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Nelson <a href="https://rust-lang.github.io/zulip_archive/stream/185405-t-compiler/rust-analyzer/topic/running.20RA.20on.20docs.2Ers.html#223145482">(Jan 18 2021 at 17:13)</a>:</h4>
<p>looks like <code>malloc_info()</code> handles this: <a href="https://stackoverflow.com/questions/40878169/64-bit-capable-alternative-to-mallinfo">https://stackoverflow.com/questions/40878169/64-bit-capable-alternative-to-mallinfo</a></p>



<a name="223145496"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/185405-t-compiler/rust-analyzer/topic/running%20RA%20on%20docs.rs/near/223145496" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Nelson <a href="https://rust-lang.github.io/zulip_archive/stream/185405-t-compiler/rust-analyzer/topic/running.20RA.20on.20docs.2Ers.html#223145496">(Jan 18 2021 at 17:13)</a>:</h4>
<p><a href="https://linux.die.net/man/3/malloc_info">https://linux.die.net/man/3/malloc_info</a></p>



<a name="223145513"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/185405-t-compiler/rust-analyzer/topic/running%20RA%20on%20docs.rs/near/223145513" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Nelson <a href="https://rust-lang.github.io/zulip_archive/stream/185405-t-compiler/rust-analyzer/topic/running.20RA.20on.20docs.2Ers.html#223145513">(Jan 18 2021 at 17:13)</a>:</h4>
<p>lol wtf why is it XML</p>



<a name="223145528"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/185405-t-compiler/rust-analyzer/topic/running%20RA%20on%20docs.rs/near/223145528" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jonas Schievink  [he/him] <a href="https://rust-lang.github.io/zulip_archive/stream/185405-t-compiler/rust-analyzer/topic/running.20RA.20on.20docs.2Ers.html#223145528">(Jan 18 2021 at 17:13)</a>:</h4>
<p>XML?!</p>



<a name="223145585"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/185405-t-compiler/rust-analyzer/topic/running%20RA%20on%20docs.rs/near/223145585" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Laurențiu <a href="https://rust-lang.github.io/zulip_archive/stream/185405-t-compiler/rust-analyzer/topic/running.20RA.20on.20docs.2Ers.html#223145585">(Jan 18 2021 at 17:14)</a>:</h4>
<p>What's a block in <code>mallinfo</code>?</p>



<a name="223145624"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/185405-t-compiler/rust-analyzer/topic/running%20RA%20on%20docs.rs/near/223145624" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Laurențiu <a href="https://rust-lang.github.io/zulip_archive/stream/185405-t-compiler/rust-analyzer/topic/running.20RA.20on.20docs.2Ers.html#223145624">(Jan 18 2021 at 17:14)</a>:</h4>
<p>If they're not bytes, it might still fit in an <code>int</code></p>



<a name="223145786"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/185405-t-compiler/rust-analyzer/topic/running%20RA%20on%20docs.rs/near/223145786" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Nelson <a href="https://rust-lang.github.io/zulip_archive/stream/185405-t-compiler/rust-analyzer/topic/running.20RA.20on.20docs.2Ers.html#223145786">(Jan 18 2021 at 17:16)</a>:</h4>
<p>oh great, there's malloc_stats but it only prints to stdout <span aria-label="joy" class="emoji emoji-1f602" role="img" title="joy">:joy:</span> <a href="https://man7.org/linux/man-pages/man3/malloc_stats.3.html">https://man7.org/linux/man-pages/man3/malloc_stats.3.html</a></p>



<a name="223145800"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/185405-t-compiler/rust-analyzer/topic/running%20RA%20on%20docs.rs/near/223145800" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Nelson <a href="https://rust-lang.github.io/zulip_archive/stream/185405-t-compiler/rust-analyzer/topic/running.20RA.20on.20docs.2Ers.html#223145800">(Jan 18 2021 at 17:16)</a>:</h4>
<p>what clown designed this</p>



<a name="223145831"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/185405-t-compiler/rust-analyzer/topic/running%20RA%20on%20docs.rs/near/223145831" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jonas Schievink  [he/him] <a href="https://rust-lang.github.io/zulip_archive/stream/185405-t-compiler/rust-analyzer/topic/running.20RA.20on.20docs.2Ers.html#223145831">(Jan 18 2021 at 17:17)</a>:</h4>
<p>urgh this sucks, we've wanted a high-performance pure-Rust allocator for a long time now</p>



<a name="223145847"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/185405-t-compiler/rust-analyzer/topic/running%20RA%20on%20docs.rs/near/223145847" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jonas Schievink  [he/him] <a href="https://rust-lang.github.io/zulip_archive/stream/185405-t-compiler/rust-analyzer/topic/running.20RA.20on.20docs.2Ers.html#223145847">(Jan 18 2021 at 17:17)</a>:</h4>
<p>it would be much easier to support this then</p>



<a name="223145972"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/185405-t-compiler/rust-analyzer/topic/running%20RA%20on%20docs.rs/near/223145972" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Nelson <a href="https://rust-lang.github.io/zulip_archive/stream/185405-t-compiler/rust-analyzer/topic/running.20RA.20on.20docs.2Ers.html#223145972">(Jan 18 2021 at 17:18)</a>:</h4>
<p>I think jemalloc has support for introspection</p>



<a name="223146028"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/185405-t-compiler/rust-analyzer/topic/running%20RA%20on%20docs.rs/near/223146028" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jonas Schievink  [he/him] <a href="https://rust-lang.github.io/zulip_archive/stream/185405-t-compiler/rust-analyzer/topic/running.20RA.20on.20docs.2Ers.html#223146028">(Jan 18 2021 at 17:18)</a>:</h4>
<p>I think we used to use that, even</p>



<a name="223146056"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/185405-t-compiler/rust-analyzer/topic/running%20RA%20on%20docs.rs/near/223146056" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jonas Schievink  [he/him] <a href="https://rust-lang.github.io/zulip_archive/stream/185405-t-compiler/rust-analyzer/topic/running.20RA.20on.20docs.2Ers.html#223146056">(Jan 18 2021 at 17:18)</a>:</h4>
<p>but that required passing a cargo feature</p>



<a name="223146328"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/185405-t-compiler/rust-analyzer/topic/running%20RA%20on%20docs.rs/near/223146328" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Nelson <a href="https://rust-lang.github.io/zulip_archive/stream/185405-t-compiler/rust-analyzer/topic/running.20RA.20on.20docs.2Ers.html#223146328">(Jan 18 2021 at 17:21)</a>:</h4>
<p><span class="user-mention silent" data-user-id="211727">Jonas Schievink</span> <a href="#narrow/stream/185405-t-compiler.2Fwg-rls-2.2E0/topic/running.20RA.20on.20docs.2Ers/near/223146056">said</a>:</p>
<blockquote>
<p>but that required passing a cargo feature</p>
</blockquote>
<p>what's wrong with that?</p>



<a name="223146625"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/185405-t-compiler/rust-analyzer/topic/running%20RA%20on%20docs.rs/near/223146625" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jonas Schievink  [he/him] <a href="https://rust-lang.github.io/zulip_archive/stream/185405-t-compiler/rust-analyzer/topic/running.20RA.20on.20docs.2Ers.html#223146625">(Jan 18 2021 at 17:24)</a>:</h4>
<p>minor annoyance, not sure if there was anything else...</p>



<a name="223146681"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/185405-t-compiler/rust-analyzer/topic/running%20RA%20on%20docs.rs/near/223146681" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jonas Schievink  [he/him] <a href="https://rust-lang.github.io/zulip_archive/stream/185405-t-compiler/rust-analyzer/topic/running.20RA.20on.20docs.2Ers.html#223146681">(Jan 18 2021 at 17:24)</a>:</h4>
<p><a href="https://github.com/rust-analyzer/rust-analyzer/pull/5479">https://github.com/rust-analyzer/rust-analyzer/pull/5479</a></p>



<a name="223146727"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/185405-t-compiler/rust-analyzer/topic/running%20RA%20on%20docs.rs/near/223146727" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jonas Schievink  [he/him] <a href="https://rust-lang.github.io/zulip_archive/stream/185405-t-compiler/rust-analyzer/topic/running.20RA.20on.20docs.2Ers.html#223146727">(Jan 18 2021 at 17:25)</a>:</h4>
<p>removing jemalloc entirely was probably not the right move then</p>



<a name="223146742"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/185405-t-compiler/rust-analyzer/topic/running%20RA%20on%20docs.rs/near/223146742" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jonas Schievink  [he/him] <a href="https://rust-lang.github.io/zulip_archive/stream/185405-t-compiler/rust-analyzer/topic/running.20RA.20on.20docs.2Ers.html#223146742">(Jan 18 2021 at 17:25)</a>:</h4>
<p>mallinfo is also way way slower than jemalloc's API</p>



<a name="223146755"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/185405-t-compiler/rust-analyzer/topic/running%20RA%20on%20docs.rs/near/223146755" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Nelson <a href="https://rust-lang.github.io/zulip_archive/stream/185405-t-compiler/rust-analyzer/topic/running.20RA.20on.20docs.2Ers.html#223146755">(Jan 18 2021 at 17:25)</a>:</h4>
<p>if features are annoying, you could set jemalloc on by default</p>



<a name="223146797"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/185405-t-compiler/rust-analyzer/topic/running%20RA%20on%20docs.rs/near/223146797" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Nelson <a href="https://rust-lang.github.io/zulip_archive/stream/185405-t-compiler/rust-analyzer/topic/running.20RA.20on.20docs.2Ers.html#223146797">(Jan 18 2021 at 17:26)</a>:</h4>
<p>and then only disable it if someone really cares</p>



<a name="223146859"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/185405-t-compiler/rust-analyzer/topic/running%20RA%20on%20docs.rs/near/223146859" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jonas Schievink  [he/him] <a href="https://rust-lang.github.io/zulip_archive/stream/185405-t-compiler/rust-analyzer/topic/running.20RA.20on.20docs.2Ers.html#223146859">(Jan 18 2021 at 17:26)</a>:</h4>
<p>I can't find what removed it entirely though</p>



<a name="223146923"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/185405-t-compiler/rust-analyzer/topic/running%20RA%20on%20docs.rs/near/223146923" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Nelson <a href="https://rust-lang.github.io/zulip_archive/stream/185405-t-compiler/rust-analyzer/topic/running.20RA.20on.20docs.2Ers.html#223146923">(Jan 18 2021 at 17:27)</a>:</h4>
<p><span class="user-mention silent" data-user-id="211727">Jonas Schievink</span> <a href="#narrow/stream/185405-t-compiler.2Fwg-rls-2.2E0/topic/running.20RA.20on.20docs.2Ers/near/223144884">said</a>:</p>
<blockquote>
<p>can't wait for this to be a bug in glibc's memory allocator</p>
</blockquote>
<p>I guess in a sense it was lmao</p>



<a name="223147031"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/185405-t-compiler/rust-analyzer/topic/running%20RA%20on%20docs.rs/near/223147031" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Daniel Silverstone <a href="https://rust-lang.github.io/zulip_archive/stream/185405-t-compiler/rust-analyzer/topic/running.20RA.20on.20docs.2Ers.html#223147031">(Jan 18 2021 at 17:28)</a>:</h4>
<p>What's surprising is how much more RSS you seem to need over other people though</p>



<a name="223147054"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/185405-t-compiler/rust-analyzer/topic/running%20RA%20on%20docs.rs/near/223147054" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Nelson <a href="https://rust-lang.github.io/zulip_archive/stream/185405-t-compiler/rust-analyzer/topic/running.20RA.20on.20docs.2Ers.html#223147054">(Jan 18 2021 at 17:28)</a>:</h4>
<p>yeah :( IDK what's up with that</p>



<a name="223147090"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/185405-t-compiler/rust-analyzer/topic/running%20RA%20on%20docs.rs/near/223147090" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Nelson <a href="https://rust-lang.github.io/zulip_archive/stream/185405-t-compiler/rust-analyzer/topic/running.20RA.20on.20docs.2Ers.html#223147090">(Jan 18 2021 at 17:29)</a>:</h4>
<p>could someone else post the <code>--verbose</code> output for the query memory usage?</p>



<a name="223147121"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/185405-t-compiler/rust-analyzer/topic/running%20RA%20on%20docs.rs/near/223147121" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Nelson <a href="https://rust-lang.github.io/zulip_archive/stream/185405-t-compiler/rust-analyzer/topic/running.20RA.20on.20docs.2Ers.html#223147121">(Jan 18 2021 at 17:29)</a>:</h4>
<p>maybe <span class="user-mention" data-user-id="211727">@Jonas Schievink</span> or <span class="user-mention" data-user-id="203546">@Laurențiu Nicola</span> since you had about ~1.3 GB used?</p>



<a name="223147559"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/185405-t-compiler/rust-analyzer/topic/running%20RA%20on%20docs.rs/near/223147559" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> oliver <a href="https://rust-lang.github.io/zulip_archive/stream/185405-t-compiler/rust-analyzer/topic/running.20RA.20on.20docs.2Ers.html#223147559">(Jan 18 2021 at 17:33)</a>:</h4>
<p><a href="https://paste.debian.net/1181653/">https://paste.debian.net/1181653/</a></p>



<a name="223147654"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/185405-t-compiler/rust-analyzer/topic/running%20RA%20on%20docs.rs/near/223147654" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Laurențiu <a href="https://rust-lang.github.io/zulip_archive/stream/185405-t-compiler/rust-analyzer/topic/running.20RA.20on.20docs.2Ers.html#223147654">(Jan 18 2021 at 17:34)</a>:</h4>
<p><a href="https://bpa.st/JHYA">https://bpa.st/JHYA</a></p>



<a name="223147696"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/185405-t-compiler/rust-analyzer/topic/running%20RA%20on%20docs.rs/near/223147696" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Edwin Cheng <a href="https://rust-lang.github.io/zulip_archive/stream/185405-t-compiler/rust-analyzer/topic/running.20RA.20on.20docs.2Ers.html#223147696">(Jan 18 2021 at 17:34)</a>:</h4>
<p><a href="https://gist.github.com/edwin0cheng/82663ac774ae14aa362236fadfce52e3">https://gist.github.com/edwin0cheng/82663ac774ae14aa362236fadfce52e3</a></p>



<a name="223147722"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/185405-t-compiler/rust-analyzer/topic/running%20RA%20on%20docs.rs/near/223147722" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> matklad <a href="https://rust-lang.github.io/zulip_archive/stream/185405-t-compiler/rust-analyzer/topic/running.20RA.20on.20docs.2Ers.html#223147722">(Jan 18 2021 at 17:35)</a>:</h4>
<blockquote>
<p>urgh this sucks, we've wanted a high-performance pure-Rust allocator for a long time now</p>
</blockquote>
<p>this needs <code>#[thread_local]</code> sadly</p>



<a name="223148116"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/185405-t-compiler/rust-analyzer/topic/running%20RA%20on%20docs.rs/near/223148116" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jonas Schievink  [he/him] <a href="https://rust-lang.github.io/zulip_archive/stream/185405-t-compiler/rust-analyzer/topic/running.20RA.20on.20docs.2Ers.html#223148116">(Jan 18 2021 at 17:39)</a>:</h4>
<p>looks like the regression was due to the hygiene frame query then</p>



<a name="223148286"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/185405-t-compiler/rust-analyzer/topic/running%20RA%20on%20docs.rs/near/223148286" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jonas Schievink  [he/him] <a href="https://rust-lang.github.io/zulip_archive/stream/185405-t-compiler/rust-analyzer/topic/running.20RA.20on.20docs.2Ers.html#223148286">(Jan 18 2021 at 17:41)</a>:</h4>
<p>low-effort improvement: <a href="https://github.com/rust-analyzer/rust-analyzer/pull/7331">https://github.com/rust-analyzer/rust-analyzer/pull/7331</a></p>



<a name="223149309"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/185405-t-compiler/rust-analyzer/topic/running%20RA%20on%20docs.rs/near/223149309" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Nelson <a href="https://rust-lang.github.io/zulip_archive/stream/185405-t-compiler/rust-analyzer/topic/running.20RA.20on.20docs.2Ers.html#223149309">(Jan 18 2021 at 17:53)</a>:</h4>
<p>Wow, FileTextQuery is using <em>significantly</em> less memory for you</p>



<a name="223149322"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/185405-t-compiler/rust-analyzer/topic/running%20RA%20on%20docs.rs/near/223149322" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Nelson <a href="https://rust-lang.github.io/zulip_archive/stream/185405-t-compiler/rust-analyzer/topic/running.20RA.20on.20docs.2Ers.html#223149322">(Jan 18 2021 at 17:53)</a>:</h4>
<p>I don't know why that would be different</p>



<a name="223149442"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/185405-t-compiler/rust-analyzer/topic/running%20RA%20on%20docs.rs/near/223149442" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Edwin Cheng <a href="https://rust-lang.github.io/zulip_archive/stream/185405-t-compiler/rust-analyzer/topic/running.20RA.20on.20docs.2Ers.html#223149442">(Jan 18 2021 at 17:55)</a>:</h4>
<p>Do you have any text files generated from the project ? We all tested from a fresh github pull</p>



<a name="223149469"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/185405-t-compiler/rust-analyzer/topic/running%20RA%20on%20docs.rs/near/223149469" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jonas Schievink  [he/him] <a href="https://rust-lang.github.io/zulip_archive/stream/185405-t-compiler/rust-analyzer/topic/running.20RA.20on.20docs.2Ers.html#223149469">(Jan 18 2021 at 17:55)</a>:</h4>
<p>it's not actually using over 3 GB, that's the mallinfo wraparound</p>



<a name="223149537"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/185405-t-compiler/rust-analyzer/topic/running%20RA%20on%20docs.rs/near/223149537" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jonas Schievink  [he/him] <a href="https://rust-lang.github.io/zulip_archive/stream/185405-t-compiler/rust-analyzer/topic/running.20RA.20on.20docs.2Ers.html#223149537">(Jan 18 2021 at 17:56)</a>:</h4>
<p>FileTextQuery really is just the raw file contents of on-disk files, you'd notice if <a href="http://docs.rs">docs.rs</a> was more than 3 GB in size</p>



<a name="223149541"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/185405-t-compiler/rust-analyzer/topic/running%20RA%20on%20docs.rs/near/223149541" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jonas Schievink  [he/him] <a href="https://rust-lang.github.io/zulip_archive/stream/185405-t-compiler/rust-analyzer/topic/running.20RA.20on.20docs.2Ers.html#223149541">(Jan 18 2021 at 17:56)</a>:</h4>
<p>well, that plus dependencies</p>



<a name="223149592"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/185405-t-compiler/rust-analyzer/topic/running%20RA%20on%20docs.rs/near/223149592" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> cynecx <a href="https://rust-lang.github.io/zulip_archive/stream/185405-t-compiler/rust-analyzer/topic/running.20RA.20on.20docs.2Ers.html#223149592">(Jan 18 2021 at 17:57)</a>:</h4>
<p>perhaps its the allocator not releasing memory to the system?</p>



<a name="223149597"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/185405-t-compiler/rust-analyzer/topic/running%20RA%20on%20docs.rs/near/223149597" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jonas Schievink  [he/him] <a href="https://rust-lang.github.io/zulip_archive/stream/185405-t-compiler/rust-analyzer/topic/running.20RA.20on.20docs.2Ers.html#223149597">(Jan 18 2021 at 17:57)</a>:</h4>
<p>60 MB sounds about right for FileTextQuery</p>



<a name="223149623"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/185405-t-compiler/rust-analyzer/topic/running%20RA%20on%20docs.rs/near/223149623" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jonas Schievink  [he/him] <a href="https://rust-lang.github.io/zulip_archive/stream/185405-t-compiler/rust-analyzer/topic/running.20RA.20on.20docs.2Ers.html#223149623">(Jan 18 2021 at 17:57)</a>:</h4>
<p><span class="user-mention silent" data-user-id="211568">cynecx</span> <a href="#narrow/stream/185405-t-compiler.2Fwg-rls-2.2E0/topic/running.20RA.20on.20docs.2Ers/near/223149592">said</a>:</p>
<blockquote>
<p>perhaps its the allocator not releasing memory to the system?</p>
</blockquote>
<p>we measure what the allocator reports, not what the kernel reports</p>



<a name="223150595"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/185405-t-compiler/rust-analyzer/topic/running%20RA%20on%20docs.rs/near/223150595" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> cynecx <a href="https://rust-lang.github.io/zulip_archive/stream/185405-t-compiler/rust-analyzer/topic/running.20RA.20on.20docs.2Ers.html#223150595">(Jan 18 2021 at 18:11)</a>:</h4>
<p>(deleted)</p>



<a name="223150609"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/185405-t-compiler/rust-analyzer/topic/running%20RA%20on%20docs.rs/near/223150609" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> cynecx <a href="https://rust-lang.github.io/zulip_archive/stream/185405-t-compiler/rust-analyzer/topic/running.20RA.20on.20docs.2Ers.html#223150609">(Jan 18 2021 at 18:11)</a>:</h4>
<p>isn't vfs unsually high? 60mb vs 813mb.</p>



<a name="223151043"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/185405-t-compiler/rust-analyzer/topic/running%20RA%20on%20docs.rs/near/223151043" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jonas Schievink  [he/him] <a href="https://rust-lang.github.io/zulip_archive/stream/185405-t-compiler/rust-analyzer/topic/running.20RA.20on.20docs.2Ers.html#223151043">(Jan 18 2021 at 18:18)</a>:</h4>
<p>currently adding back jemalloc support for more accurate stats</p>



<a name="223151848"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/185405-t-compiler/rust-analyzer/topic/running%20RA%20on%20docs.rs/near/223151848" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Florian Diebold <a href="https://rust-lang.github.io/zulip_archive/stream/185405-t-compiler/rust-analyzer/topic/running.20RA.20on.20docs.2Ers.html#223151848">(Jan 18 2021 at 18:29)</a>:</h4>
<p>/me waits for the bug to disappear with jemalloc</p>



<a name="223152440"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/185405-t-compiler/rust-analyzer/topic/running%20RA%20on%20docs.rs/near/223152440" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Nelson <a href="https://rust-lang.github.io/zulip_archive/stream/185405-t-compiler/rust-analyzer/topic/running.20RA.20on.20docs.2Ers.html#223152440">(Jan 18 2021 at 18:37)</a>:</h4>
<p><span class="user-mention silent" data-user-id="216201">Edwin Cheng</span> <a href="#narrow/stream/185405-t-compiler.2Fwg-rls-2.2E0/topic/running.20RA.20on.20docs.2Ers/near/223149442">said</a>:</p>
<blockquote>
<p>Do you have any text files generated from the project ? We all tested from a fresh github pull</p>
</blockquote>
<p>hmm I do have a bunch of untracked files, let me try deleting those</p>



<a name="223152497"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/185405-t-compiler/rust-analyzer/topic/running%20RA%20on%20docs.rs/near/223152497" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Nelson <a href="https://rust-lang.github.io/zulip_archive/stream/185405-t-compiler/rust-analyzer/topic/running.20RA.20on.20docs.2Ers.html#223152497">(Jan 18 2021 at 18:38)</a>:</h4>
<p>oh I bet I know what it is - does rust-analyzer try to look for recursive projects? It might be looking in <code>.rustwide</code> even though it shouldn't</p>



<a name="223152565"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/185405-t-compiler/rust-analyzer/topic/running%20RA%20on%20docs.rs/near/223152565" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jonas Schievink  [he/him] <a href="https://rust-lang.github.io/zulip_archive/stream/185405-t-compiler/rust-analyzer/topic/running.20RA.20on.20docs.2Ers.html#223152565">(Jan 18 2021 at 18:39)</a>:</h4>
<p>hmm, that could be it</p>



<a name="223152646"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/185405-t-compiler/rust-analyzer/topic/running%20RA%20on%20docs.rs/near/223152646" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> cynecx <a href="https://rust-lang.github.io/zulip_archive/stream/185405-t-compiler/rust-analyzer/topic/running.20RA.20on.20docs.2Ers.html#223152646">(Jan 18 2021 at 18:40)</a>:</h4>
<p>well that actually explains why vfs is so high lol</p>



<a name="223152655"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/185405-t-compiler/rust-analyzer/topic/running%20RA%20on%20docs.rs/near/223152655" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Nelson <a href="https://rust-lang.github.io/zulip_archive/stream/185405-t-compiler/rust-analyzer/topic/running.20RA.20on.20docs.2Ers.html#223152655">(Jan 18 2021 at 18:40)</a>:</h4>
<p>ok yeah I removed those and it's down to 1.9 GB</p>



<a name="223172415"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/185405-t-compiler/rust-analyzer/topic/running%20RA%20on%20docs.rs/near/223172415" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joshua Nelson <a href="https://rust-lang.github.io/zulip_archive/stream/185405-t-compiler/rust-analyzer/topic/running.20RA.20on.20docs.2Ers.html#223172415">(Jan 18 2021 at 23:20)</a>:</h4>
<p>(continued in <a href="#narrow/stream/185405-t-compiler.2Fwg-rls-2.2E0/topic/VFS.20eagerly.20loads.20all.20.2Ers.20files.20in.20the.20project.20directory">https://rust-lang.zulipchat.com/#narrow/stream/185405-t-compiler.2Fwg-rls-2.2E0/topic/VFS.20eagerly.20loads.20all.20.2Ers.20files.20in.20the.20project.20directory</a>)</p>



<a name="227094741"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/185405-t-compiler/rust-analyzer/topic/running%20RA%20on%20docs.rs/near/227094741" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Laurențiu <a href="https://rust-lang.github.io/zulip_archive/stream/185405-t-compiler/rust-analyzer/topic/running.20RA.20on.20docs.2Ers.html#227094741">(Feb 20 2021 at 14:26)</a>:</h4>
<p><span class="user-mention silent" data-user-id="211727">Jonas Schievink  [he/him]</span> <a href="#narrow/stream/185405-t-compiler.2Fwg-rls-2.2E0/topic/running.20RA.20on.20docs.2Ers/near/223145339">said</a>:</p>
<blockquote>
<p><code>int</code> is <code>i32</code> on x86_64</p>
</blockquote>
<blockquote>
<p>The mallinfo2 function is added to report statistics as per mallinfo,<br>
  but with larger field widths to accurately report values that are<br>
  larger than fit in an integer.</p>
</blockquote>



<a name="227094867"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/185405-t-compiler/rust-analyzer/topic/running%20RA%20on%20docs.rs/near/227094867" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Laurențiu <a href="https://rust-lang.github.io/zulip_archive/stream/185405-t-compiler/rust-analyzer/topic/running.20RA.20on.20docs.2Ers.html#227094867">(Feb 20 2021 at 14:29)</a>:</h4>
<p>At least if you're running Arch or Gentoo</p>



<hr><p>Last updated: Aug 07 2021 at 22:04 UTC</p>
</html>