<html>
<head><meta charset="utf-8"><title>nvim LSP warns on rust-analyzer/inlayHints · t-compiler/rust-analyzer · Zulip Chat Archive</title></head>
<h2>Stream: <a href="https://zulip-archive.rust-lang.org/stream/185405-t-compiler/rust-analyzer/index.html">t-compiler/rust-analyzer</a></h2>
<h3>Topic: <a href="https://zulip-archive.rust-lang.org/stream/185405-t-compiler/rust-analyzer/topic/nvim.20LSP.20warns.20on.20rust-analyzer.2FinlayHints.html">nvim LSP warns on rust-analyzer/inlayHints</a></h3>

<hr>

<base href="https://rust-lang.zulipchat.com">

<head><link href="https://zulip-archive.rust-lang.org/style.css" rel="stylesheet"></head>

<a name="265335003"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/185405-t-compiler/rust-analyzer/topic/nvim%20LSP%20warns%20on%20rust-analyzer/inlayHints/near/265335003" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Felipe Sere <a href="https://zulip-archive.rust-lang.org/stream/185405-t-compiler/rust-analyzer/topic/nvim.20LSP.20warns.20on.20rust-analyzer.2FinlayHints.html#265335003">(Dec 17 2021 at 17:58)</a>:</h4>
<p>Hello all, first-time Zulip user here <span aria-label="wave" class="emoji emoji-1f44b" role="img" title="wave">:wave:</span><br>
As of a few weeks ago I get a warning from nvim LSP when opening a Rust file that looks like this:</p>
<div class="codehilite"><pre><span></span><code>WARN][2021-10-03 15:35:02] .../lua/vim/lsp.lua:87      &quot;method rust-analyzer/inlayHints is not suppor
ted by any of the servers registered for the current buffer&quot;
</code></pre></div>
<p>I grepped around the code base and inlayHints <em>are</em> an experimental extension, but they are still very much present.</p>
<p>I'll be digging into how the interaction between nvim LSP and rust-analyzer works in the coming days, but I wanted to open this early in case anyone can close this early with "Yep,  we know this and someone will deal with it" <span aria-label="sweat smile" class="emoji emoji-1f605" role="img" title="sweat smile">:sweat_smile:</span></p>



<a name="265335471"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/185405-t-compiler/rust-analyzer/topic/nvim%20LSP%20warns%20on%20rust-analyzer/inlayHints/near/265335471" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Laurențiu <a href="https://zulip-archive.rust-lang.org/stream/185405-t-compiler/rust-analyzer/topic/nvim.20LSP.20warns.20on.20rust-analyzer.2FinlayHints.html#265335471">(Dec 17 2021 at 18:01)</a>:</h4>
<p><a href="https://github.com/simrat39/rust-tools.nvim/">https://github.com/simrat39/rust-tools.nvim/</a> supports those</p>



<a name="265335741"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/185405-t-compiler/rust-analyzer/topic/nvim%20LSP%20warns%20on%20rust-analyzer/inlayHints/near/265335741" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Felipe Sere <a href="https://zulip-archive.rust-lang.org/stream/185405-t-compiler/rust-analyzer/topic/nvim.20LSP.20warns.20on.20rust-analyzer.2FinlayHints.html#265335741">(Dec 17 2021 at 18:02)</a>:</h4>
<p>Ah so I might be able to just swap out the plugins outright...</p>



<a name="265335874"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/185405-t-compiler/rust-analyzer/topic/nvim%20LSP%20warns%20on%20rust-analyzer/inlayHints/near/265335874" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Laurențiu <a href="https://zulip-archive.rust-lang.org/stream/185405-t-compiler/rust-analyzer/topic/nvim.20LSP.20warns.20on.20rust-analyzer.2FinlayHints.html#265335874">(Dec 17 2021 at 18:03)</a>:</h4>
<p>Inlay hints are (still) a LSP extension specific to RA. I assume that error message is saying that the NVim LSP client doesn't understand the it</p>



<a name="265335977"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/185405-t-compiler/rust-analyzer/topic/nvim%20LSP%20warns%20on%20rust-analyzer/inlayHints/near/265335977" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Laurențiu <a href="https://zulip-archive.rust-lang.org/stream/185405-t-compiler/rust-analyzer/topic/nvim.20LSP.20warns.20on.20rust-analyzer.2FinlayHints.html#265335977">(Dec 17 2021 at 18:04)</a>:</h4>
<p>Which is normal, that's why it's an extension (unless we're missing a capability or something)</p>



<a name="265340764"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/185405-t-compiler/rust-analyzer/topic/nvim%20LSP%20warns%20on%20rust-analyzer/inlayHints/near/265340764" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Laurențiu <a href="https://zulip-archive.rust-lang.org/stream/185405-t-compiler/rust-analyzer/topic/nvim.20LSP.20warns.20on.20rust-analyzer.2FinlayHints.html#265340764">(Dec 17 2021 at 18:38)</a>:</h4>
<p>Hmm, actually the warning says that the server doesn't support inlay hints</p>



<a name="265340771"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/185405-t-compiler/rust-analyzer/topic/nvim%20LSP%20warns%20on%20rust-analyzer/inlayHints/near/265340771" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Laurențiu <a href="https://zulip-archive.rust-lang.org/stream/185405-t-compiler/rust-analyzer/topic/nvim.20LSP.20warns.20on.20rust-analyzer.2FinlayHints.html#265340771">(Dec 17 2021 at 18:38)</a>:</h4>
<p>That's a bit weird, maybe it's crashing?</p>



<a name="265343417"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/185405-t-compiler/rust-analyzer/topic/nvim%20LSP%20warns%20on%20rust-analyzer/inlayHints/near/265343417" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Felipe Sere <a href="https://zulip-archive.rust-lang.org/stream/185405-t-compiler/rust-analyzer/topic/nvim.20LSP.20warns.20on.20rust-analyzer.2FinlayHints.html#265343417">(Dec 17 2021 at 18:59)</a>:</h4>
<p>I realize I pulled the nvim logs. Where would I find the RA logs?</p>



<a name="265343452"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/185405-t-compiler/rust-analyzer/topic/nvim%20LSP%20warns%20on%20rust-analyzer/inlayHints/near/265343452" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Felipe Sere <a href="https://zulip-archive.rust-lang.org/stream/185405-t-compiler/rust-analyzer/topic/nvim.20LSP.20warns.20on.20rust-analyzer.2FinlayHints.html#265343452">(Dec 17 2021 at 18:59)</a>:</h4>
<p>I can also try the other plugin and see if it warns similarly</p>



<a name="265343646"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/185405-t-compiler/rust-analyzer/topic/nvim%20LSP%20warns%20on%20rust-analyzer/inlayHints/near/265343646" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Laurențiu <a href="https://zulip-archive.rust-lang.org/stream/185405-t-compiler/rust-analyzer/topic/nvim.20LSP.20warns.20on.20rust-analyzer.2FinlayHints.html#265343646">(Dec 17 2021 at 19:00)</a>:</h4>
<p>You can try to set something like <code>RA_LOG=info RA_LOG_FILE=/tmp/ra.log</code> before running Vim</p>



<a name="265343657"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/185405-t-compiler/rust-analyzer/topic/nvim%20LSP%20warns%20on%20rust-analyzer/inlayHints/near/265343657" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Laurențiu <a href="https://zulip-archive.rust-lang.org/stream/185405-t-compiler/rust-analyzer/topic/nvim.20LSP.20warns.20on.20rust-analyzer.2FinlayHints.html#265343657">(Dec 17 2021 at 19:00)</a>:</h4>
<p>Those are environment variables, so you might want to use <code>export</code></p>



<a name="265343749"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/185405-t-compiler/rust-analyzer/topic/nvim%20LSP%20warns%20on%20rust-analyzer/inlayHints/near/265343749" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Laurențiu <a href="https://zulip-archive.rust-lang.org/stream/185405-t-compiler/rust-analyzer/topic/nvim.20LSP.20warns.20on.20rust-analyzer.2FinlayHints.html#265343749">(Dec 17 2021 at 19:01)</a>:</h4>
<p>Does it happen every time? Are you testing on a specific project?</p>



<a name="265344560"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/185405-t-compiler/rust-analyzer/topic/nvim%20LSP%20warns%20on%20rust-analyzer/inlayHints/near/265344560" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Felipe Sere <a href="https://zulip-archive.rust-lang.org/stream/185405-t-compiler/rust-analyzer/topic/nvim.20LSP.20warns.20on.20rust-analyzer.2FinlayHints.html#265344560">(Dec 17 2021 at 19:06)</a>:</h4>
<p>Happens every time, on any Rust project</p>



<a name="265345073"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/185405-t-compiler/rust-analyzer/topic/nvim%20LSP%20warns%20on%20rust-analyzer/inlayHints/near/265345073" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Laurențiu <a href="https://zulip-archive.rust-lang.org/stream/185405-t-compiler/rust-analyzer/topic/nvim.20LSP.20warns.20on.20rust-analyzer.2FinlayHints.html#265345073">(Dec 17 2021 at 19:10)</a>:</h4>
<p>What do you get for <code>rust-analyzer --version</code>?</p>



<a name="265345149"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/185405-t-compiler/rust-analyzer/topic/nvim%20LSP%20warns%20on%20rust-analyzer/inlayHints/near/265345149" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Felipe Sere <a href="https://zulip-archive.rust-lang.org/stream/185405-t-compiler/rust-analyzer/topic/nvim.20LSP.20warns.20on.20rust-analyzer.2FinlayHints.html#265345149">(Dec 17 2021 at 19:11)</a>:</h4>
<div class="codehilite"><pre><span></span><code>❯ rust-analyzer --version
rust-analyzer 7d6fcbc0b 2021-12-07 dev
</code></pre></div>



<a name="265345418"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/185405-t-compiler/rust-analyzer/topic/nvim%20LSP%20warns%20on%20rust-analyzer/inlayHints/near/265345418" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Laurențiu <a href="https://zulip-archive.rust-lang.org/stream/185405-t-compiler/rust-analyzer/topic/nvim.20LSP.20warns.20on.20rust-analyzer.2FinlayHints.html#265345418">(Dec 17 2021 at 19:13)</a>:</h4>
<p>Yeah, I'm not sure what's up. Maybe NVim has an option to trace the LSP communication (RA has one too, <code>RA_LOG=lsp_server=debug</code>).</p>



<a name="265345432"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/185405-t-compiler/rust-analyzer/topic/nvim%20LSP%20warns%20on%20rust-analyzer/inlayHints/near/265345432" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Laurențiu <a href="https://zulip-archive.rust-lang.org/stream/185405-t-compiler/rust-analyzer/topic/nvim.20LSP.20warns.20on.20rust-analyzer.2FinlayHints.html#265345432">(Dec 17 2021 at 19:14)</a>:</h4>
<p>Unfortunately, I kinda' gave up on Vim, so I can't test</p>



<a name="265347472"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/185405-t-compiler/rust-analyzer/topic/nvim%20LSP%20warns%20on%20rust-analyzer/inlayHints/near/265347472" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Felipe Sere <a href="https://zulip-archive.rust-lang.org/stream/185405-t-compiler/rust-analyzer/topic/nvim.20LSP.20warns.20on.20rust-analyzer.2FinlayHints.html#265347472">(Dec 17 2021 at 19:30)</a>:</h4>
<p>I have 226k lines of logs, but inlay hints almost don't appear at all? It pops up early as part of the config</p>
<div class="codehilite"><pre><span></span><code>        inlayHints_chainingHints: true,
        inlayHints_maxLength: Some(
            25,
        ),
        inlayHints_parameterHints: true,
        inlayHints_typeHints: true,
        inlayHints_hideNamedConstructorHints: false,
</code></pre></div>
<p>I also see</p>
<div class="codehilite"><pre><span></span><code>[INFO rust_analyzer::main_loop] handle_event(Request(Request { id: RequestId(I32(2)), method: &quot;rust-analyzer/inlayHints&quot;, params: Object({&quot;textDocument&quot;: Object({&quot;uri&quot;: String(&quot;file:///Users/felipesere/Development/rust/journal/src/main.rs&quot;)})}) }))
[INFO rust_analyzer::global_state] handled rust-analyzer/inlayHints - (2) in 61.46µs
</code></pre></div>



<a name="265347971"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/185405-t-compiler/rust-analyzer/topic/nvim%20LSP%20warns%20on%20rust-analyzer/inlayHints/near/265347971" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Laurențiu <a href="https://zulip-archive.rust-lang.org/stream/185405-t-compiler/rust-analyzer/topic/nvim.20LSP.20warns.20on.20rust-analyzer.2FinlayHints.html#265347971">(Dec 17 2021 at 19:31)</a>:</h4>
<p>Okay, so the server does respond to <code>rust-analyzer/inlayHints</code> at some point</p>



<a name="265361436"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/185405-t-compiler/rust-analyzer/topic/nvim%20LSP%20warns%20on%20rust-analyzer/inlayHints/near/265361436" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Felipe Sere <a href="https://zulip-archive.rust-lang.org/stream/185405-t-compiler/rust-analyzer/topic/nvim.20LSP.20warns.20on.20rust-analyzer.2FinlayHints.html#265361436">(Dec 17 2021 at 21:15)</a>:</h4>
<p>Yeah so I get type hints, but the warning still pops up. I'll meddle with the other plugin over the coming days. Thanks for helping me getting those logs :)</p>



<a name="265361525"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/185405-t-compiler/rust-analyzer/topic/nvim%20LSP%20warns%20on%20rust-analyzer/inlayHints/near/265361525" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Laurențiu <a href="https://zulip-archive.rust-lang.org/stream/185405-t-compiler/rust-analyzer/topic/nvim.20LSP.20warns.20on.20rust-analyzer.2FinlayHints.html#265361525">(Dec 17 2021 at 21:15)</a>:</h4>
<p>Feel free to file an issue, especially if you find something actionable</p>



<a name="265361595"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/185405-t-compiler/rust-analyzer/topic/nvim%20LSP%20warns%20on%20rust-analyzer/inlayHints/near/265361595" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Laurențiu <a href="https://zulip-archive.rust-lang.org/stream/185405-t-compiler/rust-analyzer/topic/nvim.20LSP.20warns.20on.20rust-analyzer.2FinlayHints.html#265361595">(Dec 17 2021 at 21:16)</a>:</h4>
<p>I didn't even know that nvim supports inlay hints, I think that was one of the strong points of rust-tools</p>



<a name="265362416"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/185405-t-compiler/rust-analyzer/topic/nvim%20LSP%20warns%20on%20rust-analyzer/inlayHints/near/265362416" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Laurențiu <a href="https://zulip-archive.rust-lang.org/stream/185405-t-compiler/rust-analyzer/topic/nvim.20LSP.20warns.20on.20rust-analyzer.2FinlayHints.html#265362416">(Dec 17 2021 at 21:23)</a>:</h4>
<p><span class="user-mention silent" data-user-id="203546">Laurențiu</span> <a href="#narrow/stream/185405-t-compiler.2Frust-analyzer/topic/nvim.20LSP.20warns.20on.20rust-analyzer.2FinlayHints/near/265345432">said</a>:</p>
<blockquote>
<p>Unfortunately, I kinda' gave up on Vim, so I can't test</p>
</blockquote>
<p>I didn't even finish setting up these fancy new plugins, then I found out I should be using a different one for completions. And before setting that up, another, better, one appeared. And it seems that I could be using a Lua plugin manager, and maybe even rewrite my <code>init.vim</code> in Lua. I don't usually complain about churn in software, but this was too much even for me <span aria-label="sweat smile" class="emoji emoji-1f605" role="img" title="sweat smile">:sweat_smile:</span>.</p>



<a name="265362645"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/185405-t-compiler/rust-analyzer/topic/nvim%20LSP%20warns%20on%20rust-analyzer/inlayHints/near/265362645" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Felipe Sere <a href="https://zulip-archive.rust-lang.org/stream/185405-t-compiler/rust-analyzer/topic/nvim.20LSP.20warns.20on.20rust-analyzer.2FinlayHints.html#265362645">(Dec 17 2021 at 21:25)</a>:</h4>
<p>Yeah , I feel that churn too. My dotfiles might get more commits than my work <span aria-label="face palm" class="emoji emoji-1f926" role="img" title="face palm">:face_palm:</span>‍♂️</p>



<a name="265362991"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/185405-t-compiler/rust-analyzer/topic/nvim%20LSP%20warns%20on%20rust-analyzer/inlayHints/near/265362991" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Laurențiu <a href="https://zulip-archive.rust-lang.org/stream/185405-t-compiler/rust-analyzer/topic/nvim.20LSP.20warns.20on.20rust-analyzer.2FinlayHints.html#265362991">(Dec 17 2021 at 21:28)</a>:</h4>
<p>So I thought I would give <a href="https://helix-editor.com/">https://helix-editor.com/</a> a try. Vim wasn't my main editor anyway, and the nice thing about Helix is that everything works out of the box (not that it has too many features, but..)</p>



<hr><p>Last updated: Apr 12 2022 at 20:01 UTC</p>
</html>