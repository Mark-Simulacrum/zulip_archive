<html>
<head><meta charset="utf-8"><title>status sync · t-compiler/wg-rfc-2229 · Zulip Chat Archive</title></head>
<h2>Stream: <a href="https://zulip-archive.rust-lang.org/stream/189812-t-compiler/wg-rfc-2229/index.html">t-compiler/wg-rfc-2229</a></h2>
<h3>Topic: <a href="https://zulip-archive.rust-lang.org/stream/189812-t-compiler/wg-rfc-2229/topic/status.20sync.html">status sync</a></h3>

<hr>

<base href="https://rust-lang.zulipchat.com">

<head><link href="https://zulip-archive.rust-lang.org/style.css" rel="stylesheet"></head>

<a name="240606825"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/189812-t-compiler/wg-rfc-2229/topic/status%20sync/near/240606825" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/189812-t-compiler/wg-rfc-2229/topic/status.20sync.html#240606825">(May 28 2021 at 13:53)</a>:</h4>
<p>Hey <span class="user-group-mention" data-user-group-id="1175">@WG-rfc-2229</span> -- sorry that I've been missing meetings lately. Things have been quite busy at work. I'd kind of like to get a dump of where you all are at and how I can help.</p>



<a name="240606867"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/189812-t-compiler/wg-rfc-2229/topic/status%20sync/near/240606867" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/189812-t-compiler/wg-rfc-2229/topic/status.20sync.html#240606867">(May 28 2021 at 13:53)</a>:</h4>
<p>I think that <span class="user-mention" data-user-id="281950">@Aman Arora</span>, you're kind of stuck figuring out how to gather more data about the sizes of closures?</p>



<a name="240633677"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/189812-t-compiler/wg-rfc-2229/topic/status%20sync/near/240633677" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Aman Arora <a href="https://zulip-archive.rust-lang.org/stream/189812-t-compiler/wg-rfc-2229/topic/status.20sync.html#240633677">(May 28 2021 at 17:11)</a>:</h4>
<p>Yes, I'd like some help figuring out how the deal with generics and an error that I'm seeing while trying to compute the size.</p>
<p>At least how I understand it, I'd have to change quite a bit of how the data is pipelined across to make generics work</p>



<a name="240635941"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/189812-t-compiler/wg-rfc-2229/topic/status%20sync/near/240635941" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/189812-t-compiler/wg-rfc-2229/topic/status.20sync.html#240635941">(May 28 2021 at 17:28)</a>:</h4>
<p>bother</p>



<a name="240642572"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/189812-t-compiler/wg-rfc-2229/topic/status%20sync/near/240642572" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> rocksand <a href="https://zulip-archive.rust-lang.org/stream/189812-t-compiler/wg-rfc-2229/topic/status.20sync.html#240642572">(May 28 2021 at 18:22)</a>:</h4>
<p>I have done a lot of work since our last sync apart from PR  85724</p>



<a name="240642792"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/189812-t-compiler/wg-rfc-2229/topic/status%20sync/near/240642792" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> rocksand <a href="https://zulip-archive.rust-lang.org/stream/189812-t-compiler/wg-rfc-2229/topic/status.20sync.html#240642792">(May 28 2021 at 18:24)</a>:</h4>
<p>However, I was wondering whether some of the blog post content should be moved to the rust-reference or the edition-guide or both? I saw that you tagged us on a edition-guide issues, but I also remember you mentioning the edition-guide a few weeks ago</p>



<a name="241074760"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/189812-t-compiler/wg-rfc-2229/topic/status%20sync/near/241074760" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Aman Arora <a href="https://zulip-archive.rust-lang.org/stream/189812-t-compiler/wg-rfc-2229/topic/status.20sync.html#241074760">(Jun 01 2021 at 20:59)</a>:</h4>
<p><span class="user-mention" data-user-id="116009">@nikomatsakis</span>  should be reschedule our meeting time if some other times works better?</p>



<a name="241075466"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/189812-t-compiler/wg-rfc-2229/topic/status%20sync/near/241075466" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/189812-t-compiler/wg-rfc-2229/topic/status.20sync.html#241075466">(Jun 01 2021 at 21:04)</a>:</h4>
<p>I think this week it works ok</p>



<a name="241075483"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/189812-t-compiler/wg-rfc-2229/topic/status%20sync/near/241075483" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/189812-t-compiler/wg-rfc-2229/topic/status.20sync.html#241075483">(Jun 01 2021 at 21:04)</a>:</h4>
<p>next week I'm pretty busy but can find a time if needd</p>



<a name="241075730"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/189812-t-compiler/wg-rfc-2229/topic/status%20sync/near/241075730" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/189812-t-compiler/wg-rfc-2229/topic/status.20sync.html#241075730">(Jun 01 2021 at 21:07)</a>:</h4>
<p><span class="user-mention" data-user-id="307184">@rocksand</span> is there a need for a test on <a href="https://github.com/rust-lang/rust/issues/85724">#85724</a> ?</p>



<a name="241075738"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/189812-t-compiler/wg-rfc-2229/topic/status%20sync/near/241075738" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/189812-t-compiler/wg-rfc-2229/topic/status.20sync.html#241075738">(Jun 01 2021 at 21:07)</a>:</h4>
<p>or did <a href="https://github.com/rust-lang/rust/pull/82536/">https://github.com/rust-lang/rust/pull/82536/</a> already add it?</p>



<a name="241075975"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/189812-t-compiler/wg-rfc-2229/topic/status%20sync/near/241075975" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/189812-t-compiler/wg-rfc-2229/topic/status.20sync.html#241075975">(Jun 01 2021 at 21:08)</a>:</h4>
<p>er, <a href="https://github.com/rust-lang/rust/pull/85564">https://github.com/rust-lang/rust/pull/85564</a></p>



<a name="241076003"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/189812-t-compiler/wg-rfc-2229/topic/status%20sync/near/241076003" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/189812-t-compiler/wg-rfc-2229/topic/status.20sync.html#241076003">(Jun 01 2021 at 21:09)</a>:</h4>
<p>OK, I see it does have a regression test</p>



<a name="241076231"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/189812-t-compiler/wg-rfc-2229/topic/status%20sync/near/241076231" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> rocksand <a href="https://zulip-archive.rust-lang.org/stream/189812-t-compiler/wg-rfc-2229/topic/status.20sync.html#241076231">(Jun 01 2021 at 21:11)</a>:</h4>
<p><span class="user-mention" data-user-id="116009">@nikomatsakis</span>  Yes, <a href="https://github.com/rust-lang/rust/issues/82536">#82536</a> already added it, but if you think there needs more test cases let me know</p>



<a name="241076263"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/189812-t-compiler/wg-rfc-2229/topic/status%20sync/near/241076263" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> rocksand <a href="https://zulip-archive.rust-lang.org/stream/189812-t-compiler/wg-rfc-2229/topic/status.20sync.html#241076263">(Jun 01 2021 at 21:11)</a>:</h4>
<p>nvm, I just saw you approved it</p>



<a name="241076440"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/189812-t-compiler/wg-rfc-2229/topic/status%20sync/near/241076440" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> rocksand <a href="https://zulip-archive.rust-lang.org/stream/189812-t-compiler/wg-rfc-2229/topic/status.20sync.html#241076440">(Jun 01 2021 at 21:12)</a>:</h4>
<p><span class="user-mention silent" data-user-id="307184">rocksand</span> <a href="#narrow/stream/189812-t-compiler.2Fwg-rfc-2229/topic/status.20sync/near/240642792">said</a>:</p>
<blockquote>
<p>However, I was wondering whether some of the blog post content should be moved to the rust-reference or the edition-guide or both? I saw that you tagged us on a edition-guide issues, but I also remember you mentioning the edition-guide a few weeks ago</p>
</blockquote>
<p><span class="user-mention" data-user-id="116009">@nikomatsakis</span>  Also, I was still wondering what I should be adding to the edition-guide versus the rust reference...</p>



<a name="241077272"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/189812-t-compiler/wg-rfc-2229/topic/status%20sync/near/241077272" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/189812-t-compiler/wg-rfc-2229/topic/status.20sync.html#241077272">(Jun 01 2021 at 21:18)</a>:</h4>
<p>Ah yes</p>



<a name="241077287"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/189812-t-compiler/wg-rfc-2229/topic/status%20sync/near/241077287" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/189812-t-compiler/wg-rfc-2229/topic/status.20sync.html#241077287">(Jun 01 2021 at 21:18)</a>:</h4>
<p>It's possible that some material should go both places</p>



<a name="241077306"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/189812-t-compiler/wg-rfc-2229/topic/status%20sync/near/241077306" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/189812-t-compiler/wg-rfc-2229/topic/status.20sync.html#241077306">(Jun 01 2021 at 21:18)</a>:</h4>
<p>The edition guide should contain:</p>



<a name="241077319"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/189812-t-compiler/wg-rfc-2229/topic/status%20sync/near/241077319" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/189812-t-compiler/wg-rfc-2229/topic/status.20sync.html#241077319">(Jun 01 2021 at 21:18)</a>:</h4>
<ul>
<li>high level overview of the feature (already there, I think)</li>
</ul>



<a name="241077406"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/189812-t-compiler/wg-rfc-2229/topic/status%20sync/near/241077406" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/189812-t-compiler/wg-rfc-2229/topic/status.20sync.html#241077406">(Jun 01 2021 at 21:19)</a>:</h4>
<ul>
<li>going over each of the migration scenarios, explaining what is happening</li>
</ul>



<a name="241078018"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/189812-t-compiler/wg-rfc-2229/topic/status%20sync/near/241078018" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/189812-t-compiler/wg-rfc-2229/topic/status.20sync.html#241078018">(Jun 01 2021 at 21:25)</a>:</h4>
<p>The reference may also include the second set of information</p>



<a name="241078021"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/189812-t-compiler/wg-rfc-2229/topic/status%20sync/near/241078021" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/189812-t-compiler/wg-rfc-2229/topic/status.20sync.html#241078021">(Jun 01 2021 at 21:25)</a>:</h4>
<p>That seems like "part of the language spec" to my mind</p>



<a name="241078023"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/189812-t-compiler/wg-rfc-2229/topic/status%20sync/near/241078023" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/189812-t-compiler/wg-rfc-2229/topic/status.20sync.html#241078023">(Jun 01 2021 at 21:26)</a>:</h4>
<p>("what migration lints apply")</p>



<a name="241078070"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/189812-t-compiler/wg-rfc-2229/topic/status%20sync/near/241078070" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/189812-t-compiler/wg-rfc-2229/topic/status.20sync.html#241078070">(Jun 01 2021 at 21:26)</a>:</h4>
<p>but I would prioritize putting it in the edition guide</p>



<a name="241311784"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/189812-t-compiler/wg-rfc-2229/topic/status%20sync/near/241311784" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Aman Arora <a href="https://zulip-archive.rust-lang.org/stream/189812-t-compiler/wg-rfc-2229/topic/status.20sync.html#241311784">(Jun 02 2021 at 20:00)</a>:</h4>
<p><span class="user-mention" data-user-id="116009">@nikomatsakis</span>  are we doing zoom or zulip aysnc?</p>



<a name="241312077"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/189812-t-compiler/wg-rfc-2229/topic/status%20sync/near/241312077" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Aman Arora <a href="https://zulip-archive.rust-lang.org/stream/189812-t-compiler/wg-rfc-2229/topic/status.20sync.html#241312077">(Jun 02 2021 at 20:03)</a>:</h4>
<p><a href="https://hackmd.io/NzREH22HTFq1kefIFG0XSw?both">https://hackmd.io/NzREH22HTFq1kefIFG0XSw?both</a></p>



<a name="241313465"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/189812-t-compiler/wg-rfc-2229/topic/status%20sync/near/241313465" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Aman Arora <a href="https://zulip-archive.rust-lang.org/stream/189812-t-compiler/wg-rfc-2229/topic/status.20sync.html#241313465">(Jun 02 2021 at 20:14)</a>:</h4>
<p>Insignficant annotation:</p>
<ul>
<li>Do collections because they are mostly freeing memory</li>
<li>Run lint on compiler</li>
<li>Go through all Drop impl in stdlib</li>
<li>drain/into_iter will possibly free memory</li>
<li>Possibly ping T-LIBS</li>
</ul>



<a name="241315052"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/189812-t-compiler/wg-rfc-2229/topic/status%20sync/near/241315052" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Aman Arora <a href="https://zulip-archive.rust-lang.org/stream/189812-t-compiler/wg-rfc-2229/topic/status.20sync.html#241315052">(Jun 02 2021 at 20:27)</a>:</h4>
<p>Size optimization:</p>
<ul>
<li>Remove trailing derefs if the trailing derefs are on a dyn type</li>
</ul>



<a name="241508803"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/189812-t-compiler/wg-rfc-2229/topic/status%20sync/near/241508803" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Aman Arora <a href="https://zulip-archive.rust-lang.org/stream/189812-t-compiler/wg-rfc-2229/topic/status.20sync.html#241508803">(Jun 04 2021 at 09:10)</a>:</h4>
<p>So just the profile from <code>x build -i --stage 2</code> is here: <a href="https://docs.google.com/spreadsheets/d/1zNWWvTQ9kd0TDraNY_55HFDbHMaBl1NZn8chi30_M4g/edit#gid=845050938">https://docs.google.com/spreadsheets/d/1zNWWvTQ9kd0TDraNY_55HFDbHMaBl1NZn8chi30_M4g/edit#gid=845050938</a></p>



<a name="241508834"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/189812-t-compiler/wg-rfc-2229/topic/status%20sync/near/241508834" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Aman Arora <a href="https://zulip-archive.rust-lang.org/stream/189812-t-compiler/wg-rfc-2229/topic/status.20sync.html#241508834">(Jun 04 2021 at 09:10)</a>:</h4>
<p>There are two sheets in this one is data the other is a chart with % change</p>



<a name="241509299"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/189812-t-compiler/wg-rfc-2229/topic/status%20sync/near/241509299" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Aman Arora <a href="https://zulip-archive.rust-lang.org/stream/189812-t-compiler/wg-rfc-2229/topic/status.20sync.html#241509299">(Jun 04 2021 at 09:15)</a>:</h4>
<p>actually now that im going though the data, there are some duplicates</p>



<a name="241509456"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/189812-t-compiler/wg-rfc-2229/topic/status%20sync/near/241509456" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Aman Arora <a href="https://zulip-archive.rust-lang.org/stream/189812-t-compiler/wg-rfc-2229/topic/status.20sync.html#241509456">(Jun 04 2021 at 09:16)</a>:</h4>
<p>Is there a reason that we'd call the crete fn_mono_item on the same closure 3 times in a row?</p>



<a name="241509643"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/189812-t-compiler/wg-rfc-2229/topic/status%20sync/near/241509643" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Aman Arora <a href="https://zulip-archive.rust-lang.org/stream/189812-t-compiler/wg-rfc-2229/topic/status.20sync.html#241509643">(Jun 04 2021 at 09:18)</a>:</h4>
<p>eg: this one <a href="https://github.com/rust-lang/rust/blob/master/compiler/rustc_expand/src/mbe/macro_rules.rs#L374-L384">https://github.com/rust-lang/rust/blob/master/compiler/rustc_expand/src/mbe/macro_rules.rs#L374-L384</a></p>



<a name="241509807"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/189812-t-compiler/wg-rfc-2229/topic/status%20sync/near/241509807" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Aman Arora <a href="https://zulip-archive.rust-lang.org/stream/189812-t-compiler/wg-rfc-2229/topic/status.20sync.html#241509807">(Jun 04 2021 at 09:20)</a>:</h4>
<p>or why it's be called 30+ times</p>



<a name="241510009"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/189812-t-compiler/wg-rfc-2229/topic/status%20sync/near/241510009" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Aman Arora <a href="https://zulip-archive.rust-lang.org/stream/189812-t-compiler/wg-rfc-2229/topic/status.20sync.html#241510009">(Jun 04 2021 at 09:22)</a>:</h4>
<p><span class="user-mention silent" data-user-id="281950">Aman Arora</span> <a href="#narrow/stream/189812-t-compiler.2Fwg-rfc-2229/topic/status.20sync/near/241509807">said</a>:</p>
<blockquote>
<p>or why it's be called 30+ times</p>
</blockquote>
<p>this is because it's in a macro<br>
<a href="https://github.com/rust-lang/rust/blob/master/compiler/rustc_builtin_macros/src/lib.rs#L53-L55">https://github.com/rust-lang/rust/blob/master/compiler/rustc_builtin_macros/src/lib.rs#L53-L55</a></p>



<a name="241534064"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/189812-t-compiler/wg-rfc-2229/topic/status%20sync/near/241534064" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/189812-t-compiler/wg-rfc-2229/topic/status.20sync.html#241534064">(Jun 04 2021 at 13:25)</a>:</h4>
<p>it's certainly worth noting that the number of times we see a closure here doesn't correspond to the number of times it's <em>instantiated</em></p>



<a name="241534109"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/189812-t-compiler/wg-rfc-2229/topic/status%20sync/near/241534109" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/189812-t-compiler/wg-rfc-2229/topic/status.20sync.html#241534109">(Jun 04 2021 at 13:25)</a>:</h4>
<p><span class="user-mention silent" data-user-id="281950">Aman Arora</span> <a href="#narrow/stream/189812-t-compiler.2Fwg-rfc-2229/topic/status.20sync/near/241508803">said</a>:</p>
<blockquote>
<p>So just the profile from <code>x build -i --stage 2</code> is here: <a href="https://docs.google.com/spreadsheets/d/1zNWWvTQ9kd0TDraNY_55HFDbHMaBl1NZn8chi30_M4g/edit#gid=845050938">https://docs.google.com/spreadsheets/d/1zNWWvTQ9kd0TDraNY_55HFDbHMaBl1NZn8chi30_M4g/edit#gid=845050938</a></p>
</blockquote>
<p>I don't have access to this...can you grant to <code>rust@nikomatsakis.com</code> ?</p>



<a name="241571506"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/189812-t-compiler/wg-rfc-2229/topic/status%20sync/near/241571506" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Aman Arora <a href="https://zulip-archive.rust-lang.org/stream/189812-t-compiler/wg-rfc-2229/topic/status.20sync.html#241571506">(Jun 04 2021 at 17:54)</a>:</h4>
<p><span class="user-mention" data-user-id="116009">@nikomatsakis</span>  this should be public now</p>



<a name="241571743"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/189812-t-compiler/wg-rfc-2229/topic/status%20sync/near/241571743" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Aman Arora <a href="https://zulip-archive.rust-lang.org/stream/189812-t-compiler/wg-rfc-2229/topic/status.20sync.html#241571743">(Jun 04 2021 at 17:56)</a>:</h4>
<div class="codehilite" data-code-language="Rust"><pre><span></span><code><span class="k">fn</span> <span class="nf">f</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;</span><span class="p">(</span><span class="n">t</span>: <span class="nc">T</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="kd">let</span><span class="w"> </span><span class="n">c</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="n">t</span><span class="p">;</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>
</code></pre></div>
<p>From what I understand for all <code>T</code> used to parameterize <code>f</code>, c will have the same def_id, right?</p>



<a name="241575211"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/189812-t-compiler/wg-rfc-2229/topic/status%20sync/near/241575211" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/189812-t-compiler/wg-rfc-2229/topic/status.20sync.html#241575211">(Jun 04 2021 at 18:26)</a>:</h4>
<p><span class="user-mention" data-user-id="281950">@Aman Arora</span> yes</p>



<a name="241575315"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/189812-t-compiler/wg-rfc-2229/topic/status%20sync/near/241575315" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/189812-t-compiler/wg-rfc-2229/topic/status.20sync.html#241575315">(Jun 04 2021 at 18:27)</a>:</h4>
<p>what is this charting?</p>



<a name="241575318"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/189812-t-compiler/wg-rfc-2229/topic/status%20sync/near/241575318" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/189812-t-compiler/wg-rfc-2229/topic/status.20sync.html#241575318">(Jun 04 2021 at 18:27)</a>:</h4>
<p>I was trying to sort by change</p>



<a name="241575341"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/189812-t-compiler/wg-rfc-2229/topic/status%20sync/near/241575341" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/189812-t-compiler/wg-rfc-2229/topic/status.20sync.html#241575341">(Jun 04 2021 at 18:27)</a>:</h4>
<p>I'm trying to figure out how to reduce this into a useful number :)</p>



<a name="241575357"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/189812-t-compiler/wg-rfc-2229/topic/status%20sync/near/241575357" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/189812-t-compiler/wg-rfc-2229/topic/status.20sync.html#241575357">(Jun 04 2021 at 18:27)</a>:</h4>
<p>7024    120 Real(Named("compiler/rustc_interface/src/passes.rs")) "Some(LineInfo { line_index: 115  start_col: CharPos(48)  end_col: CharPos(74) }) Some(LineInfo { line_index: 139 start_col: CharPos(0)   end_col: CharPos(5) })"     -6904   -98.29157175</p>



<a name="241575360"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/189812-t-compiler/wg-rfc-2229/topic/status%20sync/near/241575360" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Aman Arora <a href="https://zulip-archive.rust-lang.org/stream/189812-t-compiler/wg-rfc-2229/topic/status.20sync.html#241575360">(Jun 04 2021 at 18:27)</a>:</h4>
<p>The chart is %change</p>



<a name="241575364"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/189812-t-compiler/wg-rfc-2229/topic/status%20sync/near/241575364" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/189812-t-compiler/wg-rfc-2229/topic/status.20sync.html#241575364">(Jun 04 2021 at 18:27)</a>:</h4>
<p>that's kind of amazing :)</p>



<a name="241575434"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/189812-t-compiler/wg-rfc-2229/topic/status%20sync/near/241575434" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/189812-t-compiler/wg-rfc-2229/topic/status.20sync.html#241575434">(Jun 04 2021 at 18:28)</a>:</h4>
<p>I want to have a figure like "N% of closures stayed the same size or got smaller"</p>



<a name="241575451"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/189812-t-compiler/wg-rfc-2229/topic/status%20sync/near/241575451" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Aman Arora <a href="https://zulip-archive.rust-lang.org/stream/189812-t-compiler/wg-rfc-2229/topic/status.20sync.html#241575451">(Jun 04 2021 at 18:28)</a>:</h4>
<p>okay one sec</p>



<a name="241575487"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/189812-t-compiler/wg-rfc-2229/topic/status%20sync/near/241575487" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/189812-t-compiler/wg-rfc-2229/topic/status.20sync.html#241575487">(Jun 04 2021 at 18:28)</a>:</h4>
<p>it looks like 20425 stayed the same</p>



<a name="241575494"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/189812-t-compiler/wg-rfc-2229/topic/status%20sync/near/241575494" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/189812-t-compiler/wg-rfc-2229/topic/status.20sync.html#241575494">(Jun 04 2021 at 18:28)</a>:</h4>
<p>out of 21261</p>



<a name="241575525"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/189812-t-compiler/wg-rfc-2229/topic/status%20sync/near/241575525" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/189812-t-compiler/wg-rfc-2229/topic/status.20sync.html#241575525">(Jun 04 2021 at 18:29)</a>:</h4>
<p>96%</p>



<a name="241575560"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/189812-t-compiler/wg-rfc-2229/topic/status%20sync/near/241575560" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/189812-t-compiler/wg-rfc-2229/topic/status.20sync.html#241575560">(Jun 04 2021 at 18:29)</a>:</h4>
<p>Average is 0.03 bytes growth</p>



<a name="241575637"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/189812-t-compiler/wg-rfc-2229/topic/status%20sync/near/241575637" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/189812-t-compiler/wg-rfc-2229/topic/status.20sync.html#241575637">(Jun 04 2021 at 18:30)</a>:</h4>
<p>the average growth <em>if things grow</em> is 9 bytes</p>



<a name="241575679"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/189812-t-compiler/wg-rfc-2229/topic/status%20sync/near/241575679" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/189812-t-compiler/wg-rfc-2229/topic/status.20sync.html#241575679">(Jun 04 2021 at 18:30)</a>:</h4>
<p>132 grew by more than 8 bytes</p>



<a name="241575759"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/189812-t-compiler/wg-rfc-2229/topic/status%20sync/near/241575759" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Aman Arora <a href="https://zulip-archive.rust-lang.org/stream/189812-t-compiler/wg-rfc-2229/topic/status.20sync.html#241575759">(Jun 04 2021 at 18:31)</a>:</h4>
<p><span class="user-mention silent" data-user-id="116009">nikomatsakis</span> <a href="#narrow/stream/189812-t-compiler.2Fwg-rfc-2229/topic/status.20sync/near/241575494">said</a>:</p>
<blockquote>
<p>out of 21261</p>
</blockquote>
<p>Weirdly enough the chart gices a different impression</p>



<a name="241575789"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/189812-t-compiler/wg-rfc-2229/topic/status%20sync/near/241575789" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/189812-t-compiler/wg-rfc-2229/topic/status.20sync.html#241575789">(Jun 04 2021 at 18:31)</a>:</h4>
<p>yes the chart is kind of misleading I think</p>



<a name="241575877"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/189812-t-compiler/wg-rfc-2229/topic/status%20sync/near/241575877" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/189812-t-compiler/wg-rfc-2229/topic/status.20sync.html#241575877">(Jun 04 2021 at 18:32)</a>:</h4>
<p>I'm trying to figure out how to make a historgram</p>



<a name="241575913"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/189812-t-compiler/wg-rfc-2229/topic/status%20sync/near/241575913" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Aman Arora <a href="https://zulip-archive.rust-lang.org/stream/189812-t-compiler/wg-rfc-2229/topic/status.20sync.html#241575913">(Jun 04 2021 at 18:32)</a>:</h4>
<p>I can try one min</p>



<a name="241575939"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/189812-t-compiler/wg-rfc-2229/topic/status%20sync/near/241575939" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/189812-t-compiler/wg-rfc-2229/topic/status.20sync.html#241575939">(Jun 04 2021 at 18:32)</a>:</h4>
<p>from column I</p>



<a name="241575957"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/189812-t-compiler/wg-rfc-2229/topic/status%20sync/near/241575957" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/189812-t-compiler/wg-rfc-2229/topic/status.20sync.html#241575957">(Jun 04 2021 at 18:32)</a>:</h4>
<p>I think what i <em>really</em> want to see though</p>



<a name="241575992"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/189812-t-compiler/wg-rfc-2229/topic/status%20sync/near/241575992" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/189812-t-compiler/wg-rfc-2229/topic/status.20sync.html#241575992">(Jun 04 2021 at 18:33)</a>:</h4>
<p>"is an additive histogram"... e.g., "how many are this size or smaller"?</p>



<a name="241576000"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/189812-t-compiler/wg-rfc-2229/topic/status%20sync/near/241576000" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/189812-t-compiler/wg-rfc-2229/topic/status.20sync.html#241576000">(Jun 04 2021 at 18:33)</a>:</h4>
<p>not sure though :)</p>



<a name="241576036"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/189812-t-compiler/wg-rfc-2229/topic/status%20sync/near/241576036" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/189812-t-compiler/wg-rfc-2229/topic/status.20sync.html#241576036">(Jun 04 2021 at 18:33)</a>:</h4>
<p><span class="user-mention" data-user-id="281950">@Aman Arora</span> I think part of why the chart looks bad is the %change</p>



<a name="241576060"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/189812-t-compiler/wg-rfc-2229/topic/status%20sync/near/241576060" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/189812-t-compiler/wg-rfc-2229/topic/status.20sync.html#241576060">(Jun 04 2021 at 18:33)</a>:</h4>
<p>although the average % is only 3%</p>



<a name="241576089"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/189812-t-compiler/wg-rfc-2229/topic/status%20sync/near/241576089" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/189812-t-compiler/wg-rfc-2229/topic/status.20sync.html#241576089">(Jun 04 2021 at 18:33)</a>:</h4>
<p>but things like 8 bytes growth from an 8 byte closure...</p>



<a name="241576181"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/189812-t-compiler/wg-rfc-2229/topic/status%20sync/near/241576181" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/189812-t-compiler/wg-rfc-2229/topic/status.20sync.html#241576181">(Jun 04 2021 at 18:34)</a>:</h4>
<p>but when you look at the average size of a closure before and after you get:</p>



<a name="241576197"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/189812-t-compiler/wg-rfc-2229/topic/status%20sync/near/241576197" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/189812-t-compiler/wg-rfc-2229/topic/status.20sync.html#241576197">(Jun 04 2021 at 18:34)</a>:</h4>
<ul>
<li>Before: 12.24 bytes</li>
</ul>



<a name="241576203"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/189812-t-compiler/wg-rfc-2229/topic/status%20sync/near/241576203" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/189812-t-compiler/wg-rfc-2229/topic/status.20sync.html#241576203">(Jun 04 2021 at 18:34)</a>:</h4>
<ul>
<li>After: 12.28 bytes</li>
</ul>



<a name="241576227"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/189812-t-compiler/wg-rfc-2229/topic/status%20sync/near/241576227" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/189812-t-compiler/wg-rfc-2229/topic/status.20sync.html#241576227">(Jun 04 2021 at 18:34)</a>:</h4>
<p>the worst case is "grew by 120 bytes"</p>



<a name="241576250"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/189812-t-compiler/wg-rfc-2229/topic/status%20sync/near/241576250" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/189812-t-compiler/wg-rfc-2229/topic/status.20sync.html#241576250">(Jun 04 2021 at 18:35)</a>:</h4>
<p>but the best case is 'got smaller by 6904 bytes" lol</p>



<a name="241576265"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/189812-t-compiler/wg-rfc-2229/topic/status%20sync/near/241576265" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Aman Arora <a href="https://zulip-archive.rust-lang.org/stream/189812-t-compiler/wg-rfc-2229/topic/status.20sync.html#241576265">(Jun 04 2021 at 18:35)</a>:</h4>
<p>SO there are two closures which are 2000bytes + in size that were barely affected</p>



<a name="241576292"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/189812-t-compiler/wg-rfc-2229/topic/status%20sync/near/241576292" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Aman Arora <a href="https://zulip-archive.rust-lang.org/stream/189812-t-compiler/wg-rfc-2229/topic/status.20sync.html#241576292">(Jun 04 2021 at 18:35)</a>:</h4>
<p>I'm wondering what impact does that have on these averages</p>



<a name="241576326"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/189812-t-compiler/wg-rfc-2229/topic/status%20sync/near/241576326" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Aman Arora <a href="https://zulip-archive.rust-lang.org/stream/189812-t-compiler/wg-rfc-2229/topic/status.20sync.html#241576326">(Jun 04 2021 at 18:35)</a>:</h4>
<p>They are near the bottom from rustdoc i have highlighted them in orange</p>



<a name="241576407"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/189812-t-compiler/wg-rfc-2229/topic/status%20sync/near/241576407" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/189812-t-compiler/wg-rfc-2229/topic/status.20sync.html#241576407">(Jun 04 2021 at 18:36)</a>:</h4>
<p>you could make an average from "Small closures" (&lt;16 btes) etc?</p>



<a name="241576455"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/189812-t-compiler/wg-rfc-2229/topic/status%20sync/near/241576455" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/189812-t-compiler/wg-rfc-2229/topic/status.20sync.html#241576455">(Jun 04 2021 at 18:36)</a>:</h4>
<p>can you give <a href="mailto:rust@nikomatsakis.com">rust@nikomatsakis.com</a> full editing rights?</p>



<a name="241576459"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/189812-t-compiler/wg-rfc-2229/topic/status%20sync/near/241576459" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Aman Arora <a href="https://zulip-archive.rust-lang.org/stream/189812-t-compiler/wg-rfc-2229/topic/status.20sync.html#241576459">(Jun 04 2021 at 18:36)</a>:</h4>
<p>i can add a filter</p>



<a name="241576462"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/189812-t-compiler/wg-rfc-2229/topic/status%20sync/near/241576462" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/189812-t-compiler/wg-rfc-2229/topic/status.20sync.html#241576462">(Jun 04 2021 at 18:36)</a>:</h4>
<p>or maybe I'll download into excel</p>



<a name="241576516"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/189812-t-compiler/wg-rfc-2229/topic/status%20sync/near/241576516" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Aman Arora <a href="https://zulip-archive.rust-lang.org/stream/189812-t-compiler/wg-rfc-2229/topic/status.20sync.html#241576516">(Jun 04 2021 at 18:37)</a>:</h4>
<p>yes, one sec</p>



<a name="241576658"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/189812-t-compiler/wg-rfc-2229/topic/status%20sync/near/241576658" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Aman Arora <a href="https://zulip-archive.rust-lang.org/stream/189812-t-compiler/wg-rfc-2229/topic/status.20sync.html#241576658">(Jun 04 2021 at 18:38)</a>:</h4>
<p>you should have the edit rights now</p>



<a name="241576936"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/189812-t-compiler/wg-rfc-2229/topic/status%20sync/near/241576936" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Aman Arora <a href="https://zulip-archive.rust-lang.org/stream/189812-t-compiler/wg-rfc-2229/topic/status.20sync.html#241576936">(Jun 04 2021 at 18:40)</a>:</h4>
<p>So I have added a column with number 16 on it, it is change if the original closure size &lt;= 16</p>



<a name="241576977"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/189812-t-compiler/wg-rfc-2229/topic/status%20sync/near/241576977" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Aman Arora <a href="https://zulip-archive.rust-lang.org/stream/189812-t-compiler/wg-rfc-2229/topic/status.20sync.html#241576977">(Jun 04 2021 at 18:40)</a>:</h4>
<p>you can change 16 to whatever number, highlight the data and in the bottom good drive shows Sum/aggregate information</p>



<a name="241577004"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/189812-t-compiler/wg-rfc-2229/topic/status%20sync/near/241577004" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Aman Arora <a href="https://zulip-archive.rust-lang.org/stream/189812-t-compiler/wg-rfc-2229/topic/status.20sync.html#241577004">(Jun 04 2021 at 18:41)</a>:</h4>
<p>for 16 bytes avg change is 0.26</p>



<a name="241577067"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/189812-t-compiler/wg-rfc-2229/topic/status%20sync/near/241577067" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Aman Arora <a href="https://zulip-archive.rust-lang.org/stream/189812-t-compiler/wg-rfc-2229/topic/status.20sync.html#241577067">(Jun 04 2021 at 18:41)</a>:</h4>
<p>for considering closures upto 64 byes, avg change is 0.37</p>



<a name="241577155"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/189812-t-compiler/wg-rfc-2229/topic/status%20sync/near/241577155" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Aman Arora <a href="https://zulip-archive.rust-lang.org/stream/189812-t-compiler/wg-rfc-2229/topic/status.20sync.html#241577155">(Jun 04 2021 at 18:42)</a>:</h4>
<p>and the change is 0.36 bytes even if I increase the number to 256</p>



<a name="241577359"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/189812-t-compiler/wg-rfc-2229/topic/status%20sync/near/241577359" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/189812-t-compiler/wg-rfc-2229/topic/status.20sync.html#241577359">(Jun 04 2021 at 18:44)</a>:</h4>
<p>I made some interesting charts here locally</p>



<a name="241577365"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/189812-t-compiler/wg-rfc-2229/topic/status%20sync/near/241577365" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/189812-t-compiler/wg-rfc-2229/topic/status.20sync.html#241577365">(Jun 04 2021 at 18:44)</a>:</h4>
<p>let me show you</p>



<a name="241577514"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/189812-t-compiler/wg-rfc-2229/topic/status%20sync/near/241577514" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/189812-t-compiler/wg-rfc-2229/topic/status.20sync.html#241577514">(Jun 04 2021 at 18:45)</a>:</h4>
<p>ok take a look at the Growth by closure size tab</p>



<a name="241577666"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/189812-t-compiler/wg-rfc-2229/topic/status%20sync/near/241577666" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Aman Arora <a href="https://zulip-archive.rust-lang.org/stream/189812-t-compiler/wg-rfc-2229/topic/status.20sync.html#241577666">(Jun 04 2021 at 18:46)</a>:</h4>
<p>Avg growth isn't bad at all</p>



<a name="241577757"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/189812-t-compiler/wg-rfc-2229/topic/status%20sync/near/241577757" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/189812-t-compiler/wg-rfc-2229/topic/status.20sync.html#241577757">(Jun 04 2021 at 18:47)</a>:</h4>
<p>nope</p>



<a name="241577766"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/189812-t-compiler/wg-rfc-2229/topic/status%20sync/near/241577766" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/189812-t-compiler/wg-rfc-2229/topic/status.20sync.html#241577766">(Jun 04 2021 at 18:47)</a>:</h4>
<p>to me these stats look ... fine</p>



<a name="241577956"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/189812-t-compiler/wg-rfc-2229/topic/status%20sync/near/241577956" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Aman Arora <a href="https://zulip-archive.rust-lang.org/stream/189812-t-compiler/wg-rfc-2229/topic/status.20sync.html#241577956">(Jun 04 2021 at 18:49)</a>:</h4>
<p>I think it still might be good idea to collect some information from outside the compiler</p>



<a name="241577967"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/189812-t-compiler/wg-rfc-2229/topic/status%20sync/near/241577967" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Aman Arora <a href="https://zulip-archive.rust-lang.org/stream/189812-t-compiler/wg-rfc-2229/topic/status.20sync.html#241577967">(Jun 04 2021 at 18:49)</a>:</h4>
<p>I'll run cargo again</p>



<a name="241578066"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/189812-t-compiler/wg-rfc-2229/topic/status%20sync/near/241578066" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Aman Arora <a href="https://zulip-archive.rust-lang.org/stream/189812-t-compiler/wg-rfc-2229/topic/status.20sync.html#241578066">(Jun 04 2021 at 18:50)</a>:</h4>
<p>And we should probably discuss what kind of artifact we should be generating, if say -Zprofile-closure-size is passed to the compiler</p>



<a name="241578093"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/189812-t-compiler/wg-rfc-2229/topic/status%20sync/near/241578093" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Aman Arora <a href="https://zulip-archive.rust-lang.org/stream/189812-t-compiler/wg-rfc-2229/topic/status.20sync.html#241578093">(Jun 04 2021 at 18:50)</a>:</h4>
<p>because right now i just println!() the relevant information</p>



<a name="241578374"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/189812-t-compiler/wg-rfc-2229/topic/status%20sync/near/241578374" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/189812-t-compiler/wg-rfc-2229/topic/status.20sync.html#241578374">(Jun 04 2021 at 18:53)</a>:</h4>
<p>I think <code>println!</code> is...probalby ok :)</p>



<a name="241578386"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/189812-t-compiler/wg-rfc-2229/topic/status%20sync/near/241578386" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/189812-t-compiler/wg-rfc-2229/topic/status.20sync.html#241578386">(Jun 04 2021 at 18:53)</a>:</h4>
<p>dumping to a file is prob a bit better</p>



<a name="241578409"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/189812-t-compiler/wg-rfc-2229/topic/status%20sync/near/241578409" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/189812-t-compiler/wg-rfc-2229/topic/status.20sync.html#241578409">(Jun 04 2021 at 18:53)</a>:</h4>
<p>but yes gathering more data is always good</p>



<a name="241578418"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/189812-t-compiler/wg-rfc-2229/topic/status%20sync/near/241578418" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Aman Arora <a href="https://zulip-archive.rust-lang.org/stream/189812-t-compiler/wg-rfc-2229/topic/status.20sync.html#241578418">(Jun 04 2021 at 18:53)</a>:</h4>
<p>Yes, I was thinking taking hints from -Zself-profile or how measureme works</p>



<a name="241578421"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/189812-t-compiler/wg-rfc-2229/topic/status%20sync/near/241578421" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/189812-t-compiler/wg-rfc-2229/topic/status.20sync.html#241578421">(Jun 04 2021 at 18:53)</a>:</h4>
<p>and we should be able to clone the spreadsheet to get a similar analysis</p>



<a name="241578520"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/189812-t-compiler/wg-rfc-2229/topic/status%20sync/near/241578520" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Aman Arora <a href="https://zulip-archive.rust-lang.org/stream/189812-t-compiler/wg-rfc-2229/topic/status.20sync.html#241578520">(Jun 04 2021 at 18:54)</a>:</h4>
<p>Yes, I also don't think based on the data we have we should be adding optimization overhead to the compiler just yet</p>



<a name="241578555"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/189812-t-compiler/wg-rfc-2229/topic/status%20sync/near/241578555" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/189812-t-compiler/wg-rfc-2229/topic/status.20sync.html#241578555">(Jun 04 2021 at 18:54)</a>:</h4>
<p>it would be interesting to look at some of the cases that grew by a lot =</p>



<a name="241578624"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/189812-t-compiler/wg-rfc-2229/topic/status%20sync/near/241578624" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Aman Arora <a href="https://zulip-archive.rust-lang.org/stream/189812-t-compiler/wg-rfc-2229/topic/status.20sync.html#241578624">(Jun 04 2021 at 18:55)</a>:</h4>
<p>Yes, I'll take time and look at the &gt;=200% cases. I'm also interested to see the 2k byte closures in rustdoc</p>



<a name="241578648"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/189812-t-compiler/wg-rfc-2229/topic/status%20sync/near/241578648" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Aman Arora <a href="https://zulip-archive.rust-lang.org/stream/189812-t-compiler/wg-rfc-2229/topic/status.20sync.html#241578648">(Jun 04 2021 at 18:55)</a>:</h4>
<p>Though optimizing that's outside of 2229</p>



<a name="241578718"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/189812-t-compiler/wg-rfc-2229/topic/status%20sync/near/241578718" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/189812-t-compiler/wg-rfc-2229/topic/status.20sync.html#241578718">(Jun 04 2021 at 18:56)</a>:</h4>
<p>yes</p>



<a name="241649875"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/189812-t-compiler/wg-rfc-2229/topic/status%20sync/near/241649875" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Aman Arora <a href="https://zulip-archive.rust-lang.org/stream/189812-t-compiler/wg-rfc-2229/topic/status.20sync.html#241649875">(Jun 05 2021 at 18:26)</a>:</h4>
<p>So there is somewhat a privacy concern because when any pkg from the cargo, it dumps the home folder and therefore user's userid. </p>
<p>eg: Real(Named("/users/a52arora/.cargo/registry/src/github.com-1ecc6299db9ec823/miniz_oxide-0.4.0/src/deflate/core.rs")) "Some(LineInfo { line_index: 1075</p>



<a name="242036723"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/189812-t-compiler/wg-rfc-2229/topic/status%20sync/near/242036723" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/189812-t-compiler/wg-rfc-2229/topic/status.20sync.html#242036723">(Jun 09 2021 at 09:14)</a>:</h4>
<p>That's a good callout -- we can either make folks aware of that or try to anonymize the data somehow</p>



<a name="242036743"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/189812-t-compiler/wg-rfc-2229/topic/status%20sync/near/242036743" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/189812-t-compiler/wg-rfc-2229/topic/status.20sync.html#242036743">(Jun 09 2021 at 09:14)</a>:</h4>
<p>if we have them upload the data via a google form, we could promise not to release the details</p>



<a name="242036770"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/189812-t-compiler/wg-rfc-2229/topic/status%20sync/near/242036770" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/189812-t-compiler/wg-rfc-2229/topic/status.20sync.html#242036770">(Jun 09 2021 at 09:15)</a>:</h4>
<p>btw, <span class="user-mention" data-user-id="281950">@Aman Arora</span> / <span class="user-mention" data-user-id="307184">@rocksand</span>, I can't make a meeting today</p>



<a name="242037014"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/189812-t-compiler/wg-rfc-2229/topic/status%20sync/near/242037014" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Aman Arora <a href="https://zulip-archive.rust-lang.org/stream/189812-t-compiler/wg-rfc-2229/topic/status.20sync.html#242037014">(Jun 09 2021 at 09:17)</a>:</h4>
<p>I was thinking something like -Zprofile-closures=nocollect</p>



<a name="242037344"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/189812-t-compiler/wg-rfc-2229/topic/status%20sync/near/242037344" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Aman Arora <a href="https://zulip-archive.rust-lang.org/stream/189812-t-compiler/wg-rfc-2229/topic/status.20sync.html#242037344">(Jun 09 2021 at 09:20)</a>:</h4>
<p>I went through couple of the increase in closure size, all of them come from the fact that certain parts of a strict are captured individually now</p>



<a name="242037441"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/189812-t-compiler/wg-rfc-2229/topic/status%20sync/near/242037441" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Aman Arora <a href="https://zulip-archive.rust-lang.org/stream/189812-t-compiler/wg-rfc-2229/topic/status.20sync.html#242037441">(Jun 09 2021 at 09:21)</a>:</h4>
<p>Most of these cases had the closure only capture some and not all of the fields</p>



<a name="242037455"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/189812-t-compiler/wg-rfc-2229/topic/status%20sync/near/242037455" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Aman Arora <a href="https://zulip-archive.rust-lang.org/stream/189812-t-compiler/wg-rfc-2229/topic/status.20sync.html#242037455">(Jun 09 2021 at 09:21)</a>:</h4>
<p>So the optimization we had discussed wouldn't quite work</p>



<a name="242037584"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/189812-t-compiler/wg-rfc-2229/topic/status%20sync/near/242037584" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Aman Arora <a href="https://zulip-archive.rust-lang.org/stream/189812-t-compiler/wg-rfc-2229/topic/status.20sync.html#242037584">(Jun 09 2021 at 09:22)</a>:</h4>
<p>One interesting possibility though is if we have an immutable ref, then any precise path starting at that would also be an immutable ref and therefore we should be able to capture that ref on its own</p>



<a name="242037658"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/189812-t-compiler/wg-rfc-2229/topic/status%20sync/near/242037658" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Aman Arora <a href="https://zulip-archive.rust-lang.org/stream/189812-t-compiler/wg-rfc-2229/topic/status.20sync.html#242037658">(Jun 09 2021 at 09:23)</a>:</h4>
<p>This can be especially useful when we consider methods on a struct and &amp;self is partially my captured by the closure</p>



<a name="242039489"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/189812-t-compiler/wg-rfc-2229/topic/status%20sync/near/242039489" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Aman Arora <a href="https://zulip-archive.rust-lang.org/stream/189812-t-compiler/wg-rfc-2229/topic/status.20sync.html#242039489">(Jun 09 2021 at 09:41)</a>:</h4>
<p><span class="user-mention silent" data-user-id="116009">nikomatsakis</span> <a href="#narrow/stream/189812-t-compiler.2Fwg-rfc-2229/topic/status.20sync/near/242036743">said</a>:</p>
<blockquote>
<p>if we have them upload the data via a google form, we could promise not to release the details</p>
</blockquote>
<p>Not sure how this will work tbh</p>



<a name="242040138"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/189812-t-compiler/wg-rfc-2229/topic/status%20sync/near/242040138" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Aman Arora <a href="https://zulip-archive.rust-lang.org/stream/189812-t-compiler/wg-rfc-2229/topic/status.20sync.html#242040138">(Jun 09 2021 at 09:48)</a>:</h4>
<p>I was expcting them to upload a csv somewhere, but not sure where</p>



<hr><p>Last updated: Apr 12 2022 at 20:01 UTC</p>
</html>