<html>
<head><meta charset="utf-8"><title>test failures · t-compiler/wg-rfc-2229 · Zulip Chat Archive</title></head>
<h2>Stream: <a href="https://rust-lang.github.io/zulip_archive/stream/189812-t-compiler/wg-rfc-2229/index.html">t-compiler/wg-rfc-2229</a></h2>
<h3>Topic: <a href="https://rust-lang.github.io/zulip_archive/stream/189812-t-compiler/wg-rfc-2229/topic/test.20failures.html">test failures</a></h3>

<hr>

<base href="https://rust-lang.zulipchat.com">

<head><link href="https://rust-lang.github.io/zulip_archive/style.css" rel="stylesheet"></head>

<a name="160211482"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/189812-t-compiler/wg-rfc-2229/topic/test%20failures/near/160211482" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> blitzerr <a href="https://rust-lang.github.io/zulip_archive/stream/189812-t-compiler/wg-rfc-2229/topic/test.20failures.html#160211482">(Mar 07 2019 at 16:12)</a>:</h4>
<p><span class="user-mention" data-user-id="116009">@nikomatsakis</span> based on our discussion  we want to inspect the self type <a href="https://github.com/rust-lang/rust/blob/f22dca0a1bef4141e75326caacc3cd59f3d5be8e/src/librustc/traits/select.rs#L2886" target="_blank" title="https://github.com/rust-lang/rust/blob/f22dca0a1bef4141e75326caacc3cd59f3d5be8e/src/librustc/traits/select.rs#L2886">here</a>.</p>



<a name="160211617"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/189812-t-compiler/wg-rfc-2229/topic/test%20failures/near/160211617" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> blitzerr <a href="https://rust-lang.github.io/zulip_archive/stream/189812-t-compiler/wg-rfc-2229/topic/test.20failures.html#160211617">(Mar 07 2019 at 16:13)</a>:</h4>
<p>But when I print the debug logs <br>
<code>debug!("vtable_auto_impl: nested={:?}", nested);</code><br>
doesn't get printed. So, are we sure that's the code path that is executed in the test ?</p>



<a name="160217383"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/189812-t-compiler/wg-rfc-2229/topic/test%20failures/near/160217383" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://rust-lang.github.io/zulip_archive/stream/189812-t-compiler/wg-rfc-2229/topic/test.20failures.html#160217383">(Mar 07 2019 at 17:13)</a>:</h4>
<p><span class="user-mention" data-user-id="128294">@blitzerr</span> good question =) remind me what the test is, again?</p>



<a name="160217386"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/189812-t-compiler/wg-rfc-2229/topic/test%20failures/near/160217386" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://rust-lang.github.io/zulip_archive/stream/189812-t-compiler/wg-rfc-2229/topic/test.20failures.html#160217386">(Mar 07 2019 at 17:13)</a>:</h4>
<p>I could be wrong of course</p>



<a name="160217527"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/189812-t-compiler/wg-rfc-2229/topic/test%20failures/near/160217527" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> blitzerr <a href="https://rust-lang.github.io/zulip_archive/stream/189812-t-compiler/wg-rfc-2229/topic/test.20failures.html#160217527">(Mar 07 2019 at 17:15)</a>:</h4>
<p><span class="user-mention" data-user-id="116009">@nikomatsakis</span> <br>
<a href="https://github.com/rust-lang/rust/blob/master/src/test/ui/not-clone-closure.rs" target="_blank" title="https://github.com/rust-lang/rust/blob/master/src/test/ui/not-clone-closure.rs">https://github.com/rust-lang/rust/blob/master/src/test/ui/not-clone-closure.rs</a></p>



<a name="160217591"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/189812-t-compiler/wg-rfc-2229/topic/test%20failures/near/160217591" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> blitzerr <a href="https://rust-lang.github.io/zulip_archive/stream/189812-t-compiler/wg-rfc-2229/topic/test.20failures.html#160217591">(Mar 07 2019 at 17:16)</a>:</h4>
<p>I was tracking the call stack <a href="https://paper.dropbox.com/doc/UI-tests-failing--AY3k7qd76AgO_i03iNl0wTcbAg-X96kJW6agXuvx36GPxmcg" target="_blank" title="https://paper.dropbox.com/doc/UI-tests-failing--AY3k7qd76AgO_i03iNl0wTcbAg-X96kJW6agXuvx36GPxmcg">here</a></p>



<a name="160217642"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/189812-t-compiler/wg-rfc-2229/topic/test%20failures/near/160217642" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> blitzerr <a href="https://rust-lang.github.io/zulip_archive/stream/189812-t-compiler/wg-rfc-2229/topic/test.20failures.html#160217642">(Mar 07 2019 at 17:17)</a>:</h4>
<p>That is in progress ..</p>



<a name="160220894"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/189812-t-compiler/wg-rfc-2229/topic/test%20failures/near/160220894" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://rust-lang.github.io/zulip_archive/stream/189812-t-compiler/wg-rfc-2229/topic/test.20failures.html#160220894">(Mar 07 2019 at 17:58)</a>:</h4>
<p>Ah, <span class="user-mention" data-user-id="128294">@blitzerr</span>, yeah, that's a slightly different path</p>



<a name="160220899"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/189812-t-compiler/wg-rfc-2229/topic/test%20failures/near/160220899" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://rust-lang.github.io/zulip_archive/stream/189812-t-compiler/wg-rfc-2229/topic/test.20failures.html#160220899">(Mar 07 2019 at 17:58)</a>:</h4>
<p>same root problem though</p>



<a name="160220907"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/189812-t-compiler/wg-rfc-2229/topic/test%20failures/near/160220907" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://rust-lang.github.io/zulip_archive/stream/189812-t-compiler/wg-rfc-2229/topic/test.20failures.html#160220907">(Mar 07 2019 at 17:59)</a>:</h4>
<p>But the trait here is <code>Clone</code>, not an auto trait</p>



<a name="160220956"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/189812-t-compiler/wg-rfc-2229/topic/test%20failures/near/160220956" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://rust-lang.github.io/zulip_archive/stream/189812-t-compiler/wg-rfc-2229/topic/test.20failures.html#160220956">(Mar 07 2019 at 17:59)</a>:</h4>
<p>the "constituent types" callback in that case is <a href="https://github.com/rust-lang/rust/blob/f22dca0a1bef4141e75326caacc3cd59f3d5be8e/src/librustc/traits/select.rs#L2460-L2463" target="_blank" title="https://github.com/rust-lang/rust/blob/f22dca0a1bef4141e75326caacc3cd59f3d5be8e/src/librustc/traits/select.rs#L2460-L2463">here</a></p>



<a name="160221038"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/189812-t-compiler/wg-rfc-2229/topic/test%20failures/near/160221038" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://rust-lang.github.io/zulip_archive/stream/189812-t-compiler/wg-rfc-2229/topic/test.20failures.html#160221038">(Mar 07 2019 at 18:00)</a>:</h4>
<p>and we wind up <a href="https://github.com/rust-lang/rust/blob/f22dca0a1bef4141e75326caacc3cd59f3d5be8e/src/librustc/traits/select.rs#L1629" target="_blank" title="https://github.com/rust-lang/rust/blob/f22dca0a1bef4141e75326caacc3cd59f3d5be8e/src/librustc/traits/select.rs#L1629">assembling the candidates here</a></p>



<a name="160221081"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/189812-t-compiler/wg-rfc-2229/topic/test%20failures/near/160221081" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://rust-lang.github.io/zulip_archive/stream/189812-t-compiler/wg-rfc-2229/topic/test.20failures.html#160221081">(Mar 07 2019 at 18:00)</a>:</h4>
<p>so we will wind up <a href="https://github.com/rust-lang/rust/blob/f22dca0a1bef4141e75326caacc3cd59f3d5be8e/src/librustc/traits/select.rs#L2707" target="_blank" title="https://github.com/rust-lang/rust/blob/f22dca0a1bef4141e75326caacc3cd59f3d5be8e/src/librustc/traits/select.rs#L2707">doing the "confirmation step" here</a></p>



<a name="160221111"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/189812-t-compiler/wg-rfc-2229/topic/test%20failures/near/160221111" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://rust-lang.github.io/zulip_archive/stream/189812-t-compiler/wg-rfc-2229/topic/test.20failures.html#160221111">(Mar 07 2019 at 18:01)</a>:</h4>
<p>and hence the <code>cause</code> that we want to alter is <a href="https://github.com/rust-lang/rust/blob/f22dca0a1bef4141e75326caacc3cd59f3d5be8e/src/librustc/traits/select.rs#L2836" target="_blank" title="https://github.com/rust-lang/rust/blob/f22dca0a1bef4141e75326caacc3cd59f3d5be8e/src/librustc/traits/select.rs#L2836">on this line</a></p>



<a name="160252341"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/189812-t-compiler/wg-rfc-2229/topic/test%20failures/near/160252341" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> blitzerr <a href="https://rust-lang.github.io/zulip_archive/stream/189812-t-compiler/wg-rfc-2229/topic/test.20failures.html#160252341">(Mar 08 2019 at 00:38)</a>:</h4>
<p><span class="user-mention" data-user-id="116009">@nikomatsakis</span>  Got it, thanks a lot. I will get on this today.</p>



<a name="160379148"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/189812-t-compiler/wg-rfc-2229/topic/test%20failures/near/160379148" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> blitzerr <a href="https://rust-lang.github.io/zulip_archive/stream/189812-t-compiler/wg-rfc-2229/topic/test.20failures.html#160379148">(Mar 09 2019 at 18:54)</a>:</h4>
<p><span class="user-mention" data-user-id="116009">@nikomatsakis</span>  is there a reason we should not unwrap the tuple <a href="https://github.com/blitzerr/rust/blob/64d0145d19e5eeed73d877186ccf12345ba02f95/src/librustc/traits/select.rs#L2440" target="_blank" title="https://github.com/blitzerr/rust/blob/64d0145d19e5eeed73d877186ccf12345ba02f95/src/librustc/traits/select.rs#L2440">here</a> rather than return a (vec![], bool,) tuple and then based on that call the <code>obligation.cause.clone()</code> as mentioned <a href="https://paper.dropbox.com/doc/RFC-2229-Roadmap--AY0fhzLGTN5T9sKY213U6a65Ag-cJKrePDCZR54T5kVbuoQk#:uid=916240896182703889444600&amp;h2=Error-message" target="_blank" title="https://paper.dropbox.com/doc/RFC-2229-Roadmap--AY0fhzLGTN5T9sKY213U6a65Ag-cJKrePDCZR54T5kVbuoQk#:uid=916240896182703889444600&amp;h2=Error-message">here</a> under the bullet point with  <strong> <em>green</em> </strong> background which was the cleanest as we discussed ?</p>



<a name="160397532"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/189812-t-compiler/wg-rfc-2229/topic/test%20failures/near/160397532" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> blitzerr <a href="https://rust-lang.github.io/zulip_archive/stream/189812-t-compiler/wg-rfc-2229/topic/test.20failures.html#160397532">(Mar 10 2019 at 03:57)</a>:</h4>
<p>In terms of code I replaced</p>
<div class="codehilite"><pre><span></span><span class="k">if</span><span class="w"> </span><span class="n">is_copy_trait</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="n">is_clone_trait</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="n">Where</span><span class="p">(</span><span class="n">ty</span>::<span class="n">Binder</span>::<span class="n">bind</span><span class="p">(</span><span class="n">vec</span><span class="o">!</span><span class="p">[</span><span class="n">substs</span><span class="p">.</span><span class="n">upvar_tuple_ty</span><span class="p">(</span><span class="n">def_id</span><span class="p">,</span><span class="w"> </span><span class="bp">self</span><span class="p">.</span><span class="n">tcx</span><span class="p">())])))</span><span class="w"></span>
</pre></div>


<p>with</p>
<div class="codehilite"><pre><span></span><span class="k">if</span><span class="w"> </span><span class="n">is_copy_trait</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="n">is_clone_trait</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="kd">let</span><span class="w"> </span><span class="n">upvars</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">match</span><span class="w"> </span><span class="n">substs</span><span class="p">.</span><span class="n">upvar_tuple_ty</span><span class="p">(</span><span class="n">def_id</span><span class="p">,</span><span class="w"> </span><span class="bp">self</span><span class="p">.</span><span class="n">tcx</span><span class="p">())</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="n">ty</span>::<span class="n">Tuple</span><span class="p">(</span><span class="n">tys</span><span class="p">)</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="n">tys</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="k">ref</span><span class="w"> </span><span class="n">t</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="n">bug</span><span class="o">!</span><span class="p">(</span><span class="s">&quot;A tuple was expected but found : {:?}&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">t</span><span class="p">),</span><span class="w"></span>
<span class="p">};</span><span class="w"></span>
<span class="n">Where</span><span class="p">(</span><span class="n">ty</span>::<span class="n">Binder</span>::<span class="n">bind</span><span class="p">(</span><span class="n">upvars</span><span class="p">.</span><span class="n">to_vec</span><span class="p">()))</span><span class="w"></span>
</pre></div>


<p>in <code>fn copy_clone_conditions()</code> under the <code>ty::Closure(def_id, substs) =&gt; {</code> match condition</p>



<a name="160397800"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/189812-t-compiler/wg-rfc-2229/topic/test%20failures/near/160397800" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> blitzerr <a href="https://rust-lang.github.io/zulip_archive/stream/189812-t-compiler/wg-rfc-2229/topic/test.20failures.html#160397800">(Mar 10 2019 at 04:04)</a>:</h4>
<p>and I get this error</p>
<div class="codehilite"><pre><span></span><span class="n">error</span><span class="p">[</span><span class="n">E0308</span><span class="p">]</span>: <span class="nc">mismatched</span><span class="w"> </span><span class="n">types</span><span class="o">============================&gt;</span><span class="w">        </span><span class="p">]</span><span class="w"> </span><span class="mi">107</span><span class="o">/</span><span class="mi">125</span><span class="w"></span>
<span class="w">    </span><span class="o">-</span>-&gt; <span class="nc">src</span><span class="o">/</span><span class="n">librustc</span><span class="o">/</span><span class="n">traits</span><span class="o">/</span><span class="n">select</span><span class="p">.</span><span class="n">rs</span>:<span class="mi">2443</span>:<span class="mi">25</span><span class="w"></span>
<span class="w">     </span><span class="o">|</span><span class="w"></span>
<span class="mi">2443</span><span class="w"> </span><span class="o">|</span><span class="w">                         </span><span class="n">ty</span>::<span class="n">Tuple</span><span class="p">(</span><span class="n">tys</span><span class="p">)</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="n">tys</span><span class="p">,</span><span class="w"></span>
<span class="w">     </span><span class="o">|</span><span class="w">                         </span><span class="o">^^^^^^^^^^^^^^</span><span class="w"> </span><span class="n">expected</span><span class="w"> </span><span class="k">struct</span> <span class="err">`</span><span class="n">ty</span>::<span class="n">TyS</span><span class="err">`</span><span class="p">,</span><span class="w"> </span><span class="n">found</span><span class="w"> </span><span class="k">enum</span> <span class="err">`</span><span class="n">ty</span>::<span class="n">sty</span>::<span class="n">TyKind</span><span class="err">`</span><span class="w"></span>
<span class="w">     </span><span class="o">|</span><span class="w"></span>
<span class="w">     </span><span class="o">=</span><span class="w"> </span><span class="n">note</span>: <span class="nc">expected</span><span class="w"> </span><span class="k">type</span> <span class="err">`</span><span class="n">ty</span>::<span class="n">TyS</span><span class="o">&lt;</span><span class="na">&#39;_</span><span class="o">&gt;</span><span class="err">`</span><span class="w"></span>
<span class="w">                </span><span class="n">found</span><span class="w"> </span><span class="k">type</span> <span class="err">`</span><span class="n">ty</span>::<span class="n">sty</span>::<span class="n">TyKind</span><span class="o">&lt;</span><span class="na">&#39;_</span><span class="o">&gt;</span><span class="err">`</span><span class="w"></span>
</pre></div>


<p>Want to make sure this is okay before I proceed further.  File from the branch without the recent changes <a href="https://github.com/blitzerr/rust/blob/64d0145d19e5eeed73d877186ccf12345ba02f95/src/librustc/traits/select.rs#L2440" target="_blank" title="https://github.com/blitzerr/rust/blob/64d0145d19e5eeed73d877186ccf12345ba02f95/src/librustc/traits/select.rs#L2440">here</a></p>



<a name="160398062"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/189812-t-compiler/wg-rfc-2229/topic/test%20failures/near/160398062" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> blitzerr <a href="https://rust-lang.github.io/zulip_archive/stream/189812-t-compiler/wg-rfc-2229/topic/test.20failures.html#160398062">(Mar 10 2019 at 04:12)</a>:</h4>
<p>Otherwise as we discussed, we will have to change </p>
<div class="codehilite"><pre><span></span><span class="k">enum</span> <span class="nc">BuiltinImplConditions</span><span class="o">&lt;</span><span class="na">&#39;tcx</span><span class="o">&gt;</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w"> </span><span class="mi">314</span><span class="w">     </span><span class="sd">/// The impl is conditional on T1,T2,.. : Trait</span>
<span class="w"> </span><span class="mi">315</span><span class="w">     </span><span class="n">Where</span><span class="p">(</span><span class="n">ty</span>::<span class="n">Binder</span><span class="o">&lt;</span><span class="nb">Vec</span><span class="o">&lt;</span><span class="n">Ty</span><span class="o">&lt;</span><span class="na">&#39;tcx</span><span class="o">&gt;&gt;&gt;</span><span class="p">),</span><span class="w"></span>
<span class="w"> </span><span class="mi">316</span><span class="w">     </span><span class="sd">/// There is no built-in impl. There may be some other</span>
<span class="w"> </span><span class="mi">317</span><span class="w">     </span><span class="sd">/// candidate (a where-clause or user-defined impl).</span>
<span class="w"> </span><span class="mi">318</span><span class="w">     </span><span class="nb">None</span><span class="p">,</span><span class="w"></span>
<span class="w"> </span><span class="mi">319</span><span class="w">     </span><span class="sd">/// It is unknown whether there is an impl.</span>
<span class="w"> </span><span class="mi">320</span><span class="w">     </span><span class="n">Ambiguous</span><span class="p">,</span><span class="w"></span>
<span class="w"> </span><span class="mi">321</span><span class="w"> </span><span class="p">}</span><span class="w"></span>
</pre></div>


<p>to</p>
<div class="codehilite"><pre><span></span><span class="n">Where</span><span class="p">(</span><span class="n">ty</span>::<span class="n">Binder</span><span class="o">&lt;</span><span class="p">(</span><span class="nb">Vec</span><span class="o">&lt;</span><span class="n">Ty</span><span class="o">&lt;</span><span class="na">&#39;tcx</span><span class="o">&gt;&gt;</span><span class="p">,</span><span class="w"> </span><span class="kt">bool</span><span class="p">)</span><span class="o">&gt;</span><span class="p">),</span><span class="w"></span>
</pre></div>


<p>Which one do you agree with more ?</p>



<a name="160435325"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/189812-t-compiler/wg-rfc-2229/topic/test%20failures/near/160435325" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> ange <a href="https://rust-lang.github.io/zulip_archive/stream/189812-t-compiler/wg-rfc-2229/topic/test.20failures.html#160435325">(Mar 10 2019 at 22:20)</a>:</h4>
<blockquote>
<p>and I get this error</p>
</blockquote>
<p><span class="user-mention" data-user-id="128294">@blitzerr</span> not sure if this helps, but the error seems to be because <code>match substs.upvar_tuple_ty(def_id, self.tcx())</code> should be <code>match substs.upvar_tuple_ty(def_id, self.tcx()).sty</code> instead?</p>



<a name="160442479"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/189812-t-compiler/wg-rfc-2229/topic/test%20failures/near/160442479" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> blitzerr <a href="https://rust-lang.github.io/zulip_archive/stream/189812-t-compiler/wg-rfc-2229/topic/test.20failures.html#160442479">(Mar 11 2019 at 01:08)</a>:</h4>
<p>Thanks <span class="user-mention" data-user-id="127677">@ange</span>  that definitely solves the error.</p>



<a name="160443888"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/189812-t-compiler/wg-rfc-2229/topic/test%20failures/near/160443888" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> blitzerr <a href="https://rust-lang.github.io/zulip_archive/stream/189812-t-compiler/wg-rfc-2229/topic/test.20failures.html#160443888">(Mar 11 2019 at 01:30)</a>:</h4>
<p>Was I reading it wrong - the error message </p>
<div class="codehilite"><pre><span></span><span class="n">note</span>: <span class="nc">expected</span><span class="w"> </span><span class="k">type</span> <span class="err">`</span><span class="n">ty</span>::<span class="n">TyS</span><span class="o">&lt;</span><span class="na">&#39;_</span><span class="o">&gt;</span><span class="err">`</span><span class="w"></span>
<span class="w">                </span><span class="n">found</span><span class="w"> </span><span class="k">type</span> <span class="err">`</span><span class="n">ty</span>::<span class="n">sty</span>::<span class="n">TyKind</span><span class="o">&lt;</span><span class="na">&#39;_</span><span class="o">&gt;</span><span class="err">`</span><span class="w"></span>
</pre></div>


<p>should be </p>
<div class="codehilite"><pre><span></span><span class="n">note</span>: <span class="nc">expected</span><span class="w"> </span><span class="k">type</span> <span class="err">`</span><span class="n">ty</span>::<span class="n">sty</span>::<span class="n">TyKind</span><span class="o">&lt;</span><span class="na">&#39;_</span><span class="o">&gt;</span><span class="err">`</span><span class="w"></span>
<span class="w">                </span><span class="n">found</span><span class="w"> </span><span class="k">type</span> <span class="err">`</span><span class="n">ty</span>::<span class="n">TyS</span><span class="o">&lt;</span><span class="na">&#39;_</span><span class="o">&gt;</span><span class="err">`</span><span class="w"></span>
</pre></div>


<p>?</p>



<a name="160449176"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/189812-t-compiler/wg-rfc-2229/topic/test%20failures/near/160449176" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> blitzerr <a href="https://rust-lang.github.io/zulip_archive/stream/189812-t-compiler/wg-rfc-2229/topic/test.20failures.html#160449176">(Mar 11 2019 at 03:49)</a>:</h4>
<p><span class="user-mention" data-user-id="116009">@nikomatsakis</span>  Apparently this does not solve the problem.So I will get back to returning the (vec, bool) and give that a shot</p>



<a name="160483092"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/189812-t-compiler/wg-rfc-2229/topic/test%20failures/near/160483092" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> ange <a href="https://rust-lang.github.io/zulip_archive/stream/189812-t-compiler/wg-rfc-2229/topic/test.20failures.html#160483092">(Mar 11 2019 at 14:29)</a>:</h4>
<p><span class="user-mention" data-user-id="128294">@blitzerr</span> can one link to a specific line of the Roadmap document somehow?</p>



<a name="160497367"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/189812-t-compiler/wg-rfc-2229/topic/test%20failures/near/160497367" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> blitzerr <a href="https://rust-lang.github.io/zulip_archive/stream/189812-t-compiler/wg-rfc-2229/topic/test.20failures.html#160497367">(Mar 11 2019 at 17:04)</a>:</h4>
<p><span class="user-mention" data-user-id="127677">@ange</span>  Unfortunately, links can only be generated for headings (H1/H2) not for a line of text</p>



<a name="160497916"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/189812-t-compiler/wg-rfc-2229/topic/test%20failures/near/160497916" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> ange <a href="https://rust-lang.github.io/zulip_archive/stream/189812-t-compiler/wg-rfc-2229/topic/test.20failures.html#160497916">(Mar 11 2019 at 17:11)</a>:</h4>
<p>ok. I was going to ask re: the two options for fixing the ui change in <code>not-clone-closure.rs</code>. Would adding a <code>Synthetic</code> flag to the <code>Ty</code> be viable alternative? Returning an extra bool from <code>constituent_types_for_ty</code> seems a bit ugly. Special-casing the closure-tuple case in <code>confirm_auto_impl_candidate</code> feels a bit awkward. That said, I doubt there'd be any more synthetic types in the future, so there's that :-)</p>



<a name="160497961"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/189812-t-compiler/wg-rfc-2229/topic/test%20failures/near/160497961" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> ange <a href="https://rust-lang.github.io/zulip_archive/stream/189812-t-compiler/wg-rfc-2229/topic/test.20failures.html#160497961">(Mar 11 2019 at 17:11)</a>:</h4>
<p><span class="user-mention" data-user-id="128294">@blitzerr</span> just a question for the next time the subject comes up</p>



<a name="160498586"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/189812-t-compiler/wg-rfc-2229/topic/test%20failures/near/160498586" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> blitzerr <a href="https://rust-lang.github.io/zulip_archive/stream/189812-t-compiler/wg-rfc-2229/topic/test.20failures.html#160498586">(Mar 11 2019 at 17:17)</a>:</h4>
<p>Ty is a central datastructure and putting things in it, that's not required for the entire duration is a waste. In our case, it needs to span across a couple function calls.</p>



<a name="160498869"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/189812-t-compiler/wg-rfc-2229/topic/test%20failures/near/160498869" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> ange <a href="https://rust-lang.github.io/zulip_archive/stream/189812-t-compiler/wg-rfc-2229/topic/test.20failures.html#160498869">(Mar 11 2019 at 17:21)</a>:</h4>
<p>I agree that if there's no other applicable use, it makes sense to keep the change localized. space-wise there shouldn't be an issue (only half of the flag bits are currently used), but there's the mental load to think of, true</p>



<a name="160499246"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/189812-t-compiler/wg-rfc-2229/topic/test%20failures/near/160499246" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> blitzerr <a href="https://rust-lang.github.io/zulip_archive/stream/189812-t-compiler/wg-rfc-2229/topic/test.20failures.html#160499246">(Mar 11 2019 at 17:25)</a>:</h4>
<p><span class="user-mention" data-user-id="127677">@ange</span>  ya, that's the idea.</p>



<a name="160534457"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/189812-t-compiler/wg-rfc-2229/topic/test%20failures/near/160534457" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> blitzerr <a href="https://rust-lang.github.io/zulip_archive/stream/189812-t-compiler/wg-rfc-2229/topic/test.20failures.html#160534457">(Mar 12 2019 at 01:31)</a>:</h4>
<p><span class="user-mention" data-user-id="116009">@nikomatsakis</span>  After implementing what we discussed for both <code>confirm_auto_impl_candidate</code> and <code>confirm_builtin_candidate</code>, it solved the two tests I was eyeing (ui/not-clone-closure.rs and ui/closures/closure-move-sync.rs) but overall it has led to an increase in failures. For all the failures please look <a href="https://paper.dropbox.com/doc/UI-tests-failing--AZHjpemHBuQGurG0bc40B_h5Ag-X96kJW6agXuvx36GPxmcg" target="_blank" title="https://paper.dropbox.com/doc/UI-tests-failing--AZHjpemHBuQGurG0bc40B_h5Ag-X96kJW6agXuvx36GPxmcg">here</a>. The test failures are handled by the last two commits. The compilation for changes in <code>select.rs</code> is extremely slow (takes an hour on my system), so the progress is slow.</p>



<a name="160714119"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/189812-t-compiler/wg-rfc-2229/topic/test%20failures/near/160714119" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://rust-lang.github.io/zulip_archive/stream/189812-t-compiler/wg-rfc-2229/topic/test.20failures.html#160714119">(Mar 13 2019 at 18:22)</a>:</h4>
<p><span class="user-mention" data-user-id="128294">@blitzerr</span> sorry I got a bit overwhelmed as usual, trying to catch up here</p>



<a name="160714152"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/189812-t-compiler/wg-rfc-2229/topic/test%20failures/near/160714152" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://rust-lang.github.io/zulip_archive/stream/189812-t-compiler/wg-rfc-2229/topic/test.20failures.html#160714152">(Mar 13 2019 at 18:23)</a>:</h4>
<p>I requested access to that paper doc btw</p>



<a name="160739880"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/189812-t-compiler/wg-rfc-2229/topic/test%20failures/near/160739880" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> blitzerr <a href="https://rust-lang.github.io/zulip_archive/stream/189812-t-compiler/wg-rfc-2229/topic/test.20failures.html#160739880">(Mar 14 2019 at 00:22)</a>:</h4>
<p><span class="user-mention" data-user-id="116009">@nikomatsakis</span> <br>
You should have access now. Sorry about that.</p>



<a name="161282219"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/189812-t-compiler/wg-rfc-2229/topic/test%20failures/near/161282219" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://rust-lang.github.io/zulip_archive/stream/189812-t-compiler/wg-rfc-2229/topic/test.20failures.html#161282219">(Mar 20 2019 at 19:21)</a>:</h4>
<p><span class="user-mention" data-user-id="128294">@blitzerr</span> where can I find your code?</p>



<a name="161282703"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/189812-t-compiler/wg-rfc-2229/topic/test%20failures/near/161282703" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://rust-lang.github.io/zulip_archive/stream/189812-t-compiler/wg-rfc-2229/topic/test.20failures.html#161282703">(Mar 20 2019 at 19:28)</a>:</h4>
<p>Great, I'm doing a local build now</p>



<a name="161283704"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/189812-t-compiler/wg-rfc-2229/topic/test%20failures/near/161283704" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://rust-lang.github.io/zulip_archive/stream/189812-t-compiler/wg-rfc-2229/topic/test.20failures.html#161283704">(Mar 20 2019 at 19:40)</a>:</h4>
<p><span class="user-mention" data-user-id="128294">@blitzerr</span> so I started doing some investigation. The first test case I looked at, <code>src/test/ui/closure-move-sync.rs</code> -- your branch produces the same output as nightly</p>



<a name="161283766"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/189812-t-compiler/wg-rfc-2229/topic/test%20failures/near/161283766" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://rust-lang.github.io/zulip_archive/stream/189812-t-compiler/wg-rfc-2229/topic/test.20failures.html#161283766">(Mar 20 2019 at 19:41)</a>:</h4>
<p>oh, maybe I misunderstood the doc</p>



<a name="161283906"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/189812-t-compiler/wg-rfc-2229/topic/test%20failures/near/161283906" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://rust-lang.github.io/zulip_archive/stream/189812-t-compiler/wg-rfc-2229/topic/test.20failures.html#161283906">(Mar 20 2019 at 19:42)</a>:</h4>
<p>OK, so, maybe I'll leave some comments in the doc</p>



<a name="161284782"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/189812-t-compiler/wg-rfc-2229/topic/test%20failures/near/161284782" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://rust-lang.github.io/zulip_archive/stream/189812-t-compiler/wg-rfc-2229/topic/test.20failures.html#161284782">(Mar 20 2019 at 19:52)</a>:</h4>
<p>ok, it's not duplicate prevention</p>



<a name="161284826"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/189812-t-compiler/wg-rfc-2229/topic/test%20failures/near/161284826" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://rust-lang.github.io/zulip_archive/stream/189812-t-compiler/wg-rfc-2229/topic/test.20failures.html#161284826">(Mar 20 2019 at 19:52)</a>:</h4>
<p>if I edit the <code>not-send-sync.rs</code> test case like so:</p>
<div class="codehilite"><pre><span></span><span class="cp">#![feature(generators)]</span><span class="w"></span>

<span class="k">use</span><span class="w"> </span><span class="n">std</span>::<span class="n">cell</span>::<span class="n">Cell</span><span class="p">;</span><span class="w"></span>

<span class="k">fn</span> <span class="nf">main</span><span class="p">()</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="k">fn</span> <span class="nf">assert_sync</span><span class="o">&lt;</span><span class="n">T</span>: <span class="nb">Sync</span><span class="o">&gt;</span><span class="p">(</span><span class="n">_</span>: <span class="nc">T</span><span class="p">)</span><span class="w"> </span><span class="p">{}</span><span class="w"></span>
<span class="w">    </span><span class="k">fn</span> <span class="nf">assert_send</span><span class="o">&lt;</span><span class="n">T</span>: <span class="nb">Send</span><span class="o">&gt;</span><span class="p">(</span><span class="n">_</span>: <span class="nc">T</span><span class="p">)</span><span class="w"> </span><span class="p">{}</span><span class="w"></span>

<span class="w">    </span><span class="n">assert_sync</span><span class="p">(</span><span class="o">||</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">        </span><span class="c1">//~^ ERROR: E0277</span>
<span class="w">        </span><span class="kd">let</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Cell</span>::<span class="n">new</span><span class="p">(</span><span class="mi">2</span><span class="p">);</span><span class="w"></span>
<span class="w">        </span><span class="kr">yield</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="p">});</span><span class="w"></span>

<span class="c1">//    let a = Cell::new(2);</span>
<span class="c1">//    assert_send(|| {</span>
<span class="c1">//        //~^ ERROR: E0277</span>
<span class="c1">//        drop(&amp;a);</span>
<span class="c1">//        yield;</span>
<span class="c1">//    });</span>
<span class="p">}</span><span class="w"></span>
</pre></div>


<p>then we no longer get errors :(</p>



<a name="161284836"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/189812-t-compiler/wg-rfc-2229/topic/test%20failures/near/161284836" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://rust-lang.github.io/zulip_archive/stream/189812-t-compiler/wg-rfc-2229/topic/test.20failures.html#161284836">(Mar 20 2019 at 19:53)</a>:</h4>
<p>curious</p>



<a name="161285329"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/189812-t-compiler/wg-rfc-2229/topic/test%20failures/near/161285329" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://rust-lang.github.io/zulip_archive/stream/189812-t-compiler/wg-rfc-2229/topic/test.20failures.html#161285329">(Mar 20 2019 at 19:58)</a>:</h4>
<p>also curious, running with <code>RUST_LOG=rustc::traits</code> winds up with an ICE :(</p>



<a name="161289764"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/189812-t-compiler/wg-rfc-2229/topic/test%20failures/near/161289764" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> blitzerr <a href="https://rust-lang.github.io/zulip_archive/stream/189812-t-compiler/wg-rfc-2229/topic/test.20failures.html#161289764">(Mar 20 2019 at 20:48)</a>:</h4>
<p>I ran it with RUST_LOG=rustc::traits::select and it was fine. I will try that and see.</p>



<a name="161460850"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/189812-t-compiler/wg-rfc-2229/topic/test%20failures/near/161460850" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://rust-lang.github.io/zulip_archive/stream/189812-t-compiler/wg-rfc-2229/topic/test.20failures.html#161460850">(Mar 22 2019 at 16:05)</a>:</h4>
<p>On this topic, <span class="user-mention" data-user-id="128294">@blitzerr</span> --</p>



<a name="161460855"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/189812-t-compiler/wg-rfc-2229/topic/test%20failures/near/161460855" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://rust-lang.github.io/zulip_archive/stream/189812-t-compiler/wg-rfc-2229/topic/test.20failures.html#161460855">(Mar 22 2019 at 16:05)</a>:</h4>
<p>what I wanted to do but didn't find time to do</p>



<a name="161460867"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/189812-t-compiler/wg-rfc-2229/topic/test%20failures/near/161460867" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://rust-lang.github.io/zulip_archive/stream/189812-t-compiler/wg-rfc-2229/topic/test.20failures.html#161460867">(Mar 22 2019 at 16:05)</a>:</h4>
<p>well, first of all, I presume you are able to reproduce that the above test case (with the second case commented out) passes, right?</p>



<a name="161460886"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/189812-t-compiler/wg-rfc-2229/topic/test%20failures/near/161460886" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://rust-lang.github.io/zulip_archive/stream/189812-t-compiler/wg-rfc-2229/topic/test.20failures.html#161460886">(Mar 22 2019 at 16:06)</a>:</h4>
<p>so what I had started to do was reverting some of your commits one by one</p>



<a name="161460922"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/189812-t-compiler/wg-rfc-2229/topic/test%20failures/near/161460922" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://rust-lang.github.io/zulip_archive/stream/189812-t-compiler/wg-rfc-2229/topic/test.20failures.html#161460922">(Mar 22 2019 at 16:06)</a>:</h4>
<p>basically trying to bisect where the failure came from</p>



<a name="161460929"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/189812-t-compiler/wg-rfc-2229/topic/test%20failures/near/161460929" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://rust-lang.github.io/zulip_archive/stream/189812-t-compiler/wg-rfc-2229/topic/test.20failures.html#161460929">(Mar 22 2019 at 16:06)</a>:</h4>
<p>e.g., you changed things to return a tuple</p>



<a name="161460932"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/189812-t-compiler/wg-rfc-2229/topic/test%20failures/near/161460932" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://rust-lang.github.io/zulip_archive/stream/189812-t-compiler/wg-rfc-2229/topic/test.20failures.html#161460932">(Mar 22 2019 at 16:06)</a>:</h4>
<p>that is, the (vec, bool) tuple</p>



<a name="161460948"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/189812-t-compiler/wg-rfc-2229/topic/test%20failures/near/161460948" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://rust-lang.github.io/zulip_archive/stream/189812-t-compiler/wg-rfc-2229/topic/test.20failures.html#161460948">(Mar 22 2019 at 16:06)</a>:</h4>
<p>I changed all the cases to have the bool be "false"</p>



<a name="161460955"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/189812-t-compiler/wg-rfc-2229/topic/test%20failures/near/161460955" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://rust-lang.github.io/zulip_archive/stream/189812-t-compiler/wg-rfc-2229/topic/test.20failures.html#161460955">(Mar 22 2019 at 16:06)</a>:</h4>
<p>and the test <em>still</em> was (incorrectly) passing</p>



<a name="161460964"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/189812-t-compiler/wg-rfc-2229/topic/test%20failures/near/161460964" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://rust-lang.github.io/zulip_archive/stream/189812-t-compiler/wg-rfc-2229/topic/test.20failures.html#161460964">(Mar 22 2019 at 16:06)</a>:</h4>
<p>so yeah I would suggest you do some of this "quasi-bisection"</p>



<a name="161460980"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/189812-t-compiler/wg-rfc-2229/topic/test%20failures/near/161460980" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://rust-lang.github.io/zulip_archive/stream/189812-t-compiler/wg-rfc-2229/topic/test.20failures.html#161460980">(Mar 22 2019 at 16:06)</a>:</h4>
<p>since I'm a bit confused as to what is going on</p>



<a name="161461004"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/189812-t-compiler/wg-rfc-2229/topic/test%20failures/near/161461004" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://rust-lang.github.io/zulip_archive/stream/189812-t-compiler/wg-rfc-2229/topic/test.20failures.html#161461004">(Mar 22 2019 at 16:07)</a>:</h4>
<p>this btw is a case where using the <code>-i</code> really helps</p>



<a name="161461008"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/189812-t-compiler/wg-rfc-2229/topic/test%20failures/near/161461008" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://rust-lang.github.io/zulip_archive/stream/189812-t-compiler/wg-rfc-2229/topic/test.20failures.html#161461008">(Mar 22 2019 at 16:07)</a>:</h4>
<p>because rebuilding the compiler can be (relatively) swift</p>



<a name="161461010"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/189812-t-compiler/wg-rfc-2229/topic/test%20failures/near/161461010" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://rust-lang.github.io/zulip_archive/stream/189812-t-compiler/wg-rfc-2229/topic/test.20failures.html#161461010">(Mar 22 2019 at 16:07)</a>:</h4>
<p>if you're having trouble with that, we can discuss :)</p>



<a name="161461210"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/189812-t-compiler/wg-rfc-2229/topic/test%20failures/near/161461210" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> blitzerr <a href="https://rust-lang.github.io/zulip_archive/stream/189812-t-compiler/wg-rfc-2229/topic/test.20failures.html#161461210">(Mar 22 2019 at 16:09)</a>:</h4>
<p>Sure <span class="user-mention" data-user-id="116009">@nikomatsakis</span> I will do that dissection. Haven't found time since my last comment on the paper doc. <br>
I do use -i always. <span aria-label="grinning" class="emoji emoji-1f600" role="img" title="grinning">:grinning:</span></p>



<a name="161461240"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/189812-t-compiler/wg-rfc-2229/topic/test%20failures/near/161461240" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://rust-lang.github.io/zulip_archive/stream/189812-t-compiler/wg-rfc-2229/topic/test.20failures.html#161461240">(Mar 22 2019 at 16:09)</a>:</h4>
<p>well, specifically I mean in conjunction with <code>--keep-stage</code>, as well</p>



<a name="161461255"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/189812-t-compiler/wg-rfc-2229/topic/test%20failures/near/161461255" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> blitzerr <a href="https://rust-lang.github.io/zulip_archive/stream/189812-t-compiler/wg-rfc-2229/topic/test.20failures.html#161461255">(Mar 22 2019 at 16:09)</a>:</h4>
<p>This branch is old and so didn't need to sync from mainline</p>



<a name="161461330"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/189812-t-compiler/wg-rfc-2229/topic/test%20failures/near/161461330" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> blitzerr <a href="https://rust-lang.github.io/zulip_archive/stream/189812-t-compiler/wg-rfc-2229/topic/test.20failures.html#161461330">(Mar 22 2019 at 16:10)</a>:</h4>
<p>Keep stage is a test specific flag right ?</p>



<a name="161461356"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/189812-t-compiler/wg-rfc-2229/topic/test%20failures/near/161461356" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> blitzerr <a href="https://rust-lang.github.io/zulip_archive/stream/189812-t-compiler/wg-rfc-2229/topic/test.20failures.html#161461356">(Mar 22 2019 at 16:10)</a>:</h4>
<p>By that I mean you use it as ./x.py test ...</p>



<a name="161461965"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/189812-t-compiler/wg-rfc-2229/topic/test%20failures/near/161461965" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://rust-lang.github.io/zulip_archive/stream/189812-t-compiler/wg-rfc-2229/topic/test.20failures.html#161461965">(Mar 22 2019 at 16:16)</a>:</h4>
<p>no, keep-stage is a super hack</p>



<a name="161461968"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/189812-t-compiler/wg-rfc-2229/topic/test%20failures/near/161461968" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://rust-lang.github.io/zulip_archive/stream/189812-t-compiler/wg-rfc-2229/topic/test.20failures.html#161461968">(Mar 22 2019 at 16:16)</a>:</h4>
<p>that avoids rebuilding libraries</p>



<a name="161461978"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/189812-t-compiler/wg-rfc-2229/topic/test%20failures/near/161461978" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://rust-lang.github.io/zulip_archive/stream/189812-t-compiler/wg-rfc-2229/topic/test.20failures.html#161461978">(Mar 22 2019 at 16:16)</a>:</h4>
<p>which can have a big impact on total turnaround time</p>



<a name="161461981"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/189812-t-compiler/wg-rfc-2229/topic/test%20failures/near/161461981" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://rust-lang.github.io/zulip_archive/stream/189812-t-compiler/wg-rfc-2229/topic/test.20failures.html#161461981">(Mar 22 2019 at 16:16)</a>:</h4>
<p>there are two workflows</p>



<a name="161462064"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/189812-t-compiler/wg-rfc-2229/topic/test%20failures/near/161462064" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://rust-lang.github.io/zulip_archive/stream/189812-t-compiler/wg-rfc-2229/topic/test.20failures.html#161462064">(Mar 22 2019 at 16:18)</a>:</h4>
<p><a href="https://rust-lang.github.io/rustc-guide/how-to-build-and-run.html#suggested-workflows-for-faster-builds-of-the-compiler" target="_blank" title="https://rust-lang.github.io/rustc-guide/how-to-build-and-run.html#suggested-workflows-for-faster-builds-of-the-compiler">one workflow is documented here</a>, but there's another option that may be better</p>



<a name="161462113"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/189812-t-compiler/wg-rfc-2229/topic/test%20failures/near/161462113" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://rust-lang.github.io/zulip_archive/stream/189812-t-compiler/wg-rfc-2229/topic/test.20failures.html#161462113">(Mar 22 2019 at 16:18)</a>:</h4>
<p>I should open a PR for that in rustc-guide</p>



<a name="161462142"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/189812-t-compiler/wg-rfc-2229/topic/test%20failures/near/161462142" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://rust-lang.github.io/zulip_archive/stream/189812-t-compiler/wg-rfc-2229/topic/test.20failures.html#161462142">(Mar 22 2019 at 16:18)</a>:</h4>
<p>the basic idea would be to do</p>
<div class="codehilite"><pre><span></span>./x.py build -i src/libstd # first build
./x.py build -i --keep-stage 1 src/libstd # later builds
</pre></div>



<a name="161462151"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/189812-t-compiler/wg-rfc-2229/topic/test%20failures/near/161462151" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://rust-lang.github.io/zulip_archive/stream/189812-t-compiler/wg-rfc-2229/topic/test.20failures.html#161462151">(Mar 22 2019 at 16:18)</a>:</h4>
<p>then you can just run the test by running <code>rustc</code> by hand on the test file</p>



<a name="161462153"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/189812-t-compiler/wg-rfc-2229/topic/test%20failures/near/161462153" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://rust-lang.github.io/zulip_archive/stream/189812-t-compiler/wg-rfc-2229/topic/test.20failures.html#161462153">(Mar 22 2019 at 16:18)</a>:</h4>
<p>that's what I do anyway</p>



<a name="161462168"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/189812-t-compiler/wg-rfc-2229/topic/test%20failures/near/161462168" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://rust-lang.github.io/zulip_archive/stream/189812-t-compiler/wg-rfc-2229/topic/test.20failures.html#161462168">(Mar 22 2019 at 16:19)</a>:</h4>
<p>I don't really use the test runner when I'm debugging an individual test</p>



<a name="161462191"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/189812-t-compiler/wg-rfc-2229/topic/test%20failures/near/161462191" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://rust-lang.github.io/zulip_archive/stream/189812-t-compiler/wg-rfc-2229/topic/test.20failures.html#161462191">(Mar 22 2019 at 16:19)</a>:</h4>
<blockquote>
<p>I should open a PR for that in rustc-guide</p>
</blockquote>
<p>ps, if you wanted to open a PR amending the section that talks about using <code>--stage 1</code> to talk about that workflow, i'd be appreciative :)</p>



<a name="161462200"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/189812-t-compiler/wg-rfc-2229/topic/test%20failures/near/161462200" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://rust-lang.github.io/zulip_archive/stream/189812-t-compiler/wg-rfc-2229/topic/test.20failures.html#161462200">(Mar 22 2019 at 16:19)</a>:</h4>
<p>not sure if it requires detailed edits to surrounding text though</p>



<a name="161462213"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/189812-t-compiler/wg-rfc-2229/topic/test%20failures/near/161462213" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://rust-lang.github.io/zulip_archive/stream/189812-t-compiler/wg-rfc-2229/topic/test.20failures.html#161462213">(Mar 22 2019 at 16:19)</a>:</h4>
<p>the main thing is that the <code>--stage 1</code> flow can be <em>a bit faster</em> sometimes, particularly on the initial build, but it also sometimes fails in weird ways that the one above would not</p>



<a name="161462219"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/189812-t-compiler/wg-rfc-2229/topic/test%20failures/near/161462219" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://rust-lang.github.io/zulip_archive/stream/189812-t-compiler/wg-rfc-2229/topic/test.20failures.html#161462219">(Mar 22 2019 at 16:19)</a>:</h4>
<p>so probably better to just recommend the second one</p>



<a name="161462559"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/189812-t-compiler/wg-rfc-2229/topic/test%20failures/near/161462559" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> blitzerr <a href="https://rust-lang.github.io/zulip_archive/stream/189812-t-compiler/wg-rfc-2229/topic/test.20failures.html#161462559">(Mar 22 2019 at 16:23)</a>:</h4>
<p><span class="user-mention" data-user-id="116009">@nikomatsakis</span>  I will open a PR</p>



<a name="161731572"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/189812-t-compiler/wg-rfc-2229/topic/test%20failures/near/161731572" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> blitzerr <a href="https://rust-lang.github.io/zulip_archive/stream/189812-t-compiler/wg-rfc-2229/topic/test.20failures.html#161731572">(Mar 26 2019 at 04:51)</a>:</h4>
<p><span class="user-mention" data-user-id="116009">@nikomatsakis</span>  In my branch, there two commits that were exclusively for fixing the test errors. I changed them both to return false in all the cases and the <code>not-send-sync.rs</code> still fails. I will go further down the rabbit hole tomorrow and figure out the provenance of the error.</p>



<a name="162418540"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/189812-t-compiler/wg-rfc-2229/topic/test%20failures/near/162418540" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> ange <a href="https://rust-lang.github.io/zulip_archive/stream/189812-t-compiler/wg-rfc-2229/topic/test.20failures.html#162418540">(Apr 03 2019 at 11:06)</a>:</h4>
<p><span class="user-mention" data-user-id="128294">@blitzerr</span> fwiw, I haven't forgotten about this. did a loop to get the test results for every commit so I can read up and get some idea of what started failing when, hopefully on friday</p>



<a name="162578524"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/189812-t-compiler/wg-rfc-2229/topic/test%20failures/near/162578524" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> blitzerr <a href="https://rust-lang.github.io/zulip_archive/stream/189812-t-compiler/wg-rfc-2229/topic/test.20failures.html#162578524">(Apr 04 2019 at 23:21)</a>:</h4>
<p><span class="user-mention" data-user-id="127677">@ange</span>  thanks a lot. Let me know if anything is not clear in the doc or commits</p>



<a name="162719412"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/189812-t-compiler/wg-rfc-2229/topic/test%20failures/near/162719412" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> ange <a href="https://rust-lang.github.io/zulip_archive/stream/189812-t-compiler/wg-rfc-2229/topic/test.20failures.html#162719412">(Apr 06 2019 at 20:36)</a>:</h4>
<p>So, re: the <code>ui/generator/not-send-sync.rs</code> testcase, this is the summary of the differences in the compiler output for the commits in this branch:</p>
<div class="codehilite"><pre><span></span>for sha in 75a369c5b1 e9faf40169 7fa36f4f63 8b32d92153 61a1d2c75d 59a6a0c400 8568565465 136a711012 4a02c5b487 64d0145d19 662e0a8396 7567a314b6; do echo &quot;--- $sha ---&quot;; grep  -e &#39;required because.*`(&#39; -e &#39;\[E0277&#39; not-send-sync-results/${sha}.out; done
--- 75a369c5b1 ---
error[E0277]: `std::cell::Cell&lt;i32&gt;` cannot be shared between threads safely
error[E0277]: `std::cell::Cell&lt;i32&gt;` cannot be shared between threads safely
--- e9faf40169 ---
error[E0277]: `std::cell::Cell&lt;i32&gt;` cannot be shared between threads safely
error[E0277]: `std::cell::Cell&lt;i32&gt;` cannot be shared between threads safely
--- 7fa36f4f63 ---
error[E0277]: `std::cell::Cell&lt;i32&gt;` cannot be shared between threads safely
   = note: required because it appears within the type `(&amp;std::cell::Cell&lt;i32&gt;,)`
--- 8b32d92153 ---
error[E0277]: `std::cell::Cell&lt;i32&gt;` cannot be shared between threads safely
   = note: required because it appears within the type `(&amp;std::cell::Cell&lt;i32&gt;,)`
--- 61a1d2c75d ---
error[E0277]: `std::cell::Cell&lt;i32&gt;` cannot be shared between threads safely
   = note: required because it appears within the type `(&amp;std::cell::Cell&lt;i32&gt;,)`
--- 59a6a0c400 ---
error[E0277]: `std::cell::Cell&lt;i32&gt;` cannot be shared between threads safely
   = note: required because it appears within the type `(&amp;std::cell::Cell&lt;i32&gt;,)`
--- 8568565465 ---
error[E0277]: `std::cell::Cell&lt;i32&gt;` cannot be shared between threads safely
   = note: required because it appears within the type `(&amp;std::cell::Cell&lt;i32&gt;,)`
--- 136a711012 ---
error[E0277]: `std::cell::Cell&lt;i32&gt;` cannot be shared between threads safely
   = note: required because it appears within the type `(&amp;std::cell::Cell&lt;i32&gt;,)`
--- 4a02c5b487 ---
--- 64d0145d19 ---
error[E0277]: `std::cell::Cell&lt;i32&gt;` cannot be shared between threads safely
   = note: required because it appears within the type `(&amp;std::cell::Cell&lt;i32&gt;,)`
--- 662e0a8396 ---
error[E0277]: `std::cell::Cell&lt;i32&gt;` cannot be shared between threads safely
   = note: required because it appears within the type `(&amp;std::cell::Cell&lt;i32&gt;,)`
--- 7567a314b6 ---
error[E0277]: `std::cell::Cell&lt;i32&gt;` cannot be shared between threads safely
</pre></div>


<p>(4a02c5b487 is blank cause it failed to build)</p>



<a name="162719564"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/189812-t-compiler/wg-rfc-2229/topic/test%20failures/near/162719564" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> ange <a href="https://rust-lang.github.io/zulip_archive/stream/189812-t-compiler/wg-rfc-2229/topic/test.20failures.html#162719564">(Apr 06 2019 at 20:40)</a>:</h4>
<p>unfortunately I'm visiting friends in berlin and traveling back home tomorrow, so couldn't really get into the actual error. I did capture the debug output when compiling the testcase though, so normalizing and diffing the debug logs might give some good clues as to where unexpected divergences in the output arise <span aria-label="fingers crossed" class="emoji emoji-1f91e" role="img" title="fingers crossed">:fingers_crossed:</span></p>



<a name="162933191"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/189812-t-compiler/wg-rfc-2229/topic/test%20failures/near/162933191" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> ange <a href="https://rust-lang.github.io/zulip_archive/stream/189812-t-compiler/wg-rfc-2229/topic/test.20failures.html#162933191">(Apr 09 2019 at 17:49)</a>:</h4>
<p>I should add that I had accidentally built in a rust source tree without the correct config.toml, so got only minimal debugging output. tried to rebuild again but kept running into seemingly unrelated segfaults. threw out llvm (only other variable and also where the segfault was manifesting) and now waiting for it to hopefully go through...</p>



<a name="163140223"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/189812-t-compiler/wg-rfc-2229/topic/test%20failures/near/163140223" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> ange <a href="https://rust-lang.github.io/zulip_archive/stream/189812-t-compiler/wg-rfc-2229/topic/test.20failures.html#163140223">(Apr 11 2019 at 21:51)</a>:</h4>
<p>FWIW, the first differences that seem significant in the debug output, when compiling <code>ui/generator/not-send-sync.rs</code> with <code>e9faf40169</code> vs <code>7567a314b6</code> are</p>
<div class="codehilite"><pre><span></span>rustc::traits::select: builtin_bound: nested=Binder(([], false))
rustc::traits::select: builtin_bound: nested=Binder(([{integer}], false))
ena::unify: TyVidEqKey: created new key: TyVidEqKey { vid: _#13t, phantom: PhantomData }
ena::unify: TyVid: created new key: _#13t
rustc::infer::type_variable: new_var(index=_#13t, diverging=false, origin=ClosureSynthetic(src/test/ui/generator/not-send-sync.rs:9:17: 13:6)
</pre></div>


<p>The first two lines are simply the addition of the boolean, the last three lines are completely absent in the earlier commit (for which the testcase passes).</p>
<p>This results in <code>GeneratorSubsts { substs: [(), (), _, _] }</code> that have one extra <code>, _</code>, this in turn results in an extra obligation predicate. This of course spills over the rest of the diff, until we get to the unification, where (surprisingly?) there's one less call into ena in the later commit (the one that has the extra <code>_</code>). Ah, this seems to be balanced by an extra call to ena that appears much later. Then at ~85% of the diff I'm losing track of the differences, until we eventually get the shared error message for the second closure. Recall, with the later commit, we're losing the error message for the first closure. Then the earlier (correct) commit enters <code>process_obligations</code> 3 more times, does some unification and spits out the error message. This could be a diff artifact though.</p>



<a name="163140312"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/189812-t-compiler/wg-rfc-2229/topic/test%20failures/near/163140312" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> ange <a href="https://rust-lang.github.io/zulip_archive/stream/189812-t-compiler/wg-rfc-2229/topic/test.20failures.html#163140312">(Apr 11 2019 at 21:52)</a>:</h4>
<p>This all seems in order to me, AFAICT with the addition of the tuple there should be one extra type variable. Dunno if <span class="user-mention" data-user-id="116009">@nikomatsakis</span> sees any smoking guns in the above cc: <span class="user-mention" data-user-id="128294">@blitzerr</span></p>



<a name="163409760"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/189812-t-compiler/wg-rfc-2229/topic/test%20failures/near/163409760" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://rust-lang.github.io/zulip_archive/stream/189812-t-compiler/wg-rfc-2229/topic/test.20failures.html#163409760">(Apr 15 2019 at 19:42)</a>:</h4>
<p>hmm</p>



<a name="163409767"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/189812-t-compiler/wg-rfc-2229/topic/test%20failures/near/163409767" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://rust-lang.github.io/zulip_archive/stream/189812-t-compiler/wg-rfc-2229/topic/test.20failures.html#163409767">(Apr 15 2019 at 19:42)</a>:</h4>
<p>I guess I gotta re-test locally</p>



<a name="163412187"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/189812-t-compiler/wg-rfc-2229/topic/test%20failures/near/163412187" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> ange <a href="https://rust-lang.github.io/zulip_archive/stream/189812-t-compiler/wg-rfc-2229/topic/test.20failures.html#163412187">(Apr 15 2019 at 20:12)</a>:</h4>
<p>To be clear, the issue is there, it's just that the differences I could track in the debug output seem to be accounted for by the change introduced in the patch</p>



<a name="164562605"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/189812-t-compiler/wg-rfc-2229/topic/test%20failures/near/164562605" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://rust-lang.github.io/zulip_archive/stream/189812-t-compiler/wg-rfc-2229/topic/test.20failures.html#164562605">(Apr 30 2019 at 18:23)</a>:</h4>
<p>Ok, I'm trying to remember the status now :)</p>



<a name="164562646"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/189812-t-compiler/wg-rfc-2229/topic/test%20failures/near/164562646" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://rust-lang.github.io/zulip_archive/stream/189812-t-compiler/wg-rfc-2229/topic/test.20failures.html#164562646">(Apr 30 2019 at 18:23)</a>:</h4>
<p>Ah, right, I vaguely recall -- we added some logic to suppress some duplicate lines</p>



<a name="164562653"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/189812-t-compiler/wg-rfc-2229/topic/test%20failures/near/164562653" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://rust-lang.github.io/zulip_archive/stream/189812-t-compiler/wg-rfc-2229/topic/test.20failures.html#164562653">(Apr 30 2019 at 18:23)</a>:</h4>
<p>and we wound up masking errors intead</p>



<a name="164562825"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/189812-t-compiler/wg-rfc-2229/topic/test%20failures/near/164562825" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://rust-lang.github.io/zulip_archive/stream/189812-t-compiler/wg-rfc-2229/topic/test.20failures.html#164562825">(Apr 30 2019 at 18:25)</a>:</h4>
<p>although from what I can tell</p>



<a name="164562840"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/189812-t-compiler/wg-rfc-2229/topic/test%20failures/near/164562840" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://rust-lang.github.io/zulip_archive/stream/189812-t-compiler/wg-rfc-2229/topic/test.20failures.html#164562840">(Apr 30 2019 at 18:25)</a>:</h4>
<p>the test maybe just started failing due to th change itself</p>



<a name="164562848"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/189812-t-compiler/wg-rfc-2229/topic/test%20failures/near/164562848" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://rust-lang.github.io/zulip_archive/stream/189812-t-compiler/wg-rfc-2229/topic/test.20failures.html#164562848">(Apr 30 2019 at 18:25)</a>:</h4>
<blockquote>
<p>Ah, right, I vaguely recall -- we added some logic to suppress some duplicate lines</p>
</blockquote>
<p>and not so much as a result of this lgoic</p>



<a name="164562940"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/189812-t-compiler/wg-rfc-2229/topic/test%20failures/near/164562940" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> blitzerr <a href="https://rust-lang.github.io/zulip_archive/stream/189812-t-compiler/wg-rfc-2229/topic/test.20failures.html#164562940">(Apr 30 2019 at 18:26)</a>:</h4>
<p>I remember I had a doc. Let me find that. It had the failures</p>



<a name="164562953"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/189812-t-compiler/wg-rfc-2229/topic/test%20failures/near/164562953" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> blitzerr <a href="https://rust-lang.github.io/zulip_archive/stream/189812-t-compiler/wg-rfc-2229/topic/test.20failures.html#164562953">(Apr 30 2019 at 18:26)</a>:</h4>
<p><a href="https://paper.dropbox.com/doc/UI-tests-failing-X96kJW6agXuvx36GPxmcg" target="_blank" title="https://paper.dropbox.com/doc/UI-tests-failing-X96kJW6agXuvx36GPxmcg">https://paper.dropbox.com/doc/UI-tests-failing-X96kJW6agXuvx36GPxmcg</a></p>



<a name="164563050"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/189812-t-compiler/wg-rfc-2229/topic/test%20failures/near/164563050" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> blitzerr <a href="https://rust-lang.github.io/zulip_archive/stream/189812-t-compiler/wg-rfc-2229/topic/test.20failures.html#164563050">(Apr 30 2019 at 18:27)</a>:</h4>
<p>That is possible.</p>



<a name="164563078"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/189812-t-compiler/wg-rfc-2229/topic/test%20failures/near/164563078" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> blitzerr <a href="https://rust-lang.github.io/zulip_archive/stream/189812-t-compiler/wg-rfc-2229/topic/test.20failures.html#164563078">(Apr 30 2019 at 18:27)</a>:</h4>
<p>We never ran the tests with the incremental changes</p>



<a name="164563184"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/189812-t-compiler/wg-rfc-2229/topic/test%20failures/near/164563184" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://rust-lang.github.io/zulip_archive/stream/189812-t-compiler/wg-rfc-2229/topic/test.20failures.html#164563184">(Apr 30 2019 at 18:28)</a>:</h4>
<p>I'm digging in</p>



<a name="164572799"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/189812-t-compiler/wg-rfc-2229/topic/test%20failures/near/164572799" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://rust-lang.github.io/zulip_archive/stream/189812-t-compiler/wg-rfc-2229/topic/test.20failures.html#164572799">(Apr 30 2019 at 20:15)</a>:</h4>
<p><span class="user-mention" data-user-id="128294">@blitzerr</span> I may have found the problem, testing a fix now</p>



<a name="164573081"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/189812-t-compiler/wg-rfc-2229/topic/test%20failures/near/164573081" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://rust-lang.github.io/zulip_archive/stream/189812-t-compiler/wg-rfc-2229/topic/test.20failures.html#164573081">(Apr 30 2019 at 20:18)</a>:</h4>
<p>the tl;dr is that, in your branch, you have lost the "witness" when enumerating the constituent types for generators:</p>
<p><a href="https://github.com/rust-lang/rust/blob/5b7baa53c91d7c33b925fc8aec553e3521548a07/src/librustc/traits/select.rs#L2601" target="_blank" title="https://github.com/rust-lang/rust/blob/5b7baa53c91d7c33b925fc8aec553e3521548a07/src/librustc/traits/select.rs#L2601">https://github.com/rust-lang/rust/blob/5b7baa53c91d7c33b925fc8aec553e3521548a07/src/librustc/traits/select.rs#L2601</a></p>



<a name="164573104"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/189812-t-compiler/wg-rfc-2229/topic/test%20failures/near/164573104" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://rust-lang.github.io/zulip_archive/stream/189812-t-compiler/wg-rfc-2229/topic/test.20failures.html#164573104">(Apr 30 2019 at 20:18)</a>:</h4>
<p>(that's the master code, not your branch)</p>



<a name="164573134"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/189812-t-compiler/wg-rfc-2229/topic/test%20failures/near/164573134" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://rust-lang.github.io/zulip_archive/stream/189812-t-compiler/wg-rfc-2229/topic/test.20failures.html#164573134">(Apr 30 2019 at 20:19)</a>:</h4>
<p>this witness, in particular, carries the types of local variables in the generator that are live across yields</p>



<a name="164573136"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/189812-t-compiler/wg-rfc-2229/topic/test%20failures/near/164573136" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://rust-lang.github.io/zulip_archive/stream/189812-t-compiler/wg-rfc-2229/topic/test.20failures.html#164573136">(Apr 30 2019 at 20:19)</a>:</h4>
<p>which is <em>exactly</em> what this test is testing</p>



<a name="164573139"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/189812-t-compiler/wg-rfc-2229/topic/test%20failures/near/164573139" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> blitzerr <a href="https://rust-lang.github.io/zulip_archive/stream/189812-t-compiler/wg-rfc-2229/topic/test.20failures.html#164573139">(Apr 30 2019 at 20:19)</a>:</h4>
<p><span aria-label="tada" class="emoji emoji-1f389" role="img" title="tada">:tada:</span> <span aria-label="octopus" class="emoji emoji-1f419" role="img" title="octopus">:octopus:</span>  <span aria-label="crab" class="emoji emoji-1f980" role="img" title="crab">:crab:</span></p>



<a name="164573167"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/189812-t-compiler/wg-rfc-2229/topic/test%20failures/near/164573167" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://rust-lang.github.io/zulip_archive/stream/189812-t-compiler/wg-rfc-2229/topic/test.20failures.html#164573167">(Apr 30 2019 at 20:19)</a>:</h4>
<p>building a branch locally now to see if this fixes the problem, but I strongly suspect it will</p>



<a name="164573528"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/189812-t-compiler/wg-rfc-2229/topic/test%20failures/near/164573528" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> blitzerr <a href="https://rust-lang.github.io/zulip_archive/stream/189812-t-compiler/wg-rfc-2229/topic/test.20failures.html#164573528">(Apr 30 2019 at 20:23)</a>:</h4>
<p>Ohh man !</p>



<a name="164573588"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/189812-t-compiler/wg-rfc-2229/topic/test%20failures/near/164573588" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> blitzerr <a href="https://rust-lang.github.io/zulip_archive/stream/189812-t-compiler/wg-rfc-2229/topic/test.20failures.html#164573588">(Apr 30 2019 at 20:24)</a>:</h4>
<p>You mean in one of  my commits, I just removed it ?</p>



<a name="164573598"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/189812-t-compiler/wg-rfc-2229/topic/test%20failures/near/164573598" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://rust-lang.github.io/zulip_archive/stream/189812-t-compiler/wg-rfc-2229/topic/test.20failures.html#164573598">(Apr 30 2019 at 20:24)</a>:</h4>
<p>yeah</p>



<a name="164573610"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/189812-t-compiler/wg-rfc-2229/topic/test%20failures/near/164573610" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://rust-lang.github.io/zulip_archive/stream/189812-t-compiler/wg-rfc-2229/topic/test.20failures.html#164573610">(Apr 30 2019 at 20:24)</a>:</h4>
<p>copy-n-paste bug, basically :)</p>



<a name="164573612"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/189812-t-compiler/wg-rfc-2229/topic/test%20failures/near/164573612" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://rust-lang.github.io/zulip_archive/stream/189812-t-compiler/wg-rfc-2229/topic/test.20failures.html#164573612">(Apr 30 2019 at 20:24)</a>:</h4>
<p>ok, it seems to work</p>



<a name="164573635"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/189812-t-compiler/wg-rfc-2229/topic/test%20failures/near/164573635" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> blitzerr <a href="https://rust-lang.github.io/zulip_archive/stream/189812-t-compiler/wg-rfc-2229/topic/test.20failures.html#164573635">(Apr 30 2019 at 20:24)</a>:</h4>
<p>lol</p>



<a name="164573649"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/189812-t-compiler/wg-rfc-2229/topic/test%20failures/near/164573649" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> blitzerr <a href="https://rust-lang.github.io/zulip_archive/stream/189812-t-compiler/wg-rfc-2229/topic/test.20failures.html#164573649">(Apr 30 2019 at 20:24)</a>:</h4>
<blockquote>
<p>ok, it seems to work</p>
</blockquote>
<p>That is great</p>



<a name="164573653"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/189812-t-compiler/wg-rfc-2229/topic/test%20failures/near/164573653" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://rust-lang.github.io/zulip_archive/stream/189812-t-compiler/wg-rfc-2229/topic/test.20failures.html#164573653">(Apr 30 2019 at 20:25)</a>:</h4>
<p>I pushed a commit to your branch</p>



<a name="164573681"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/189812-t-compiler/wg-rfc-2229/topic/test%20failures/near/164573681" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://rust-lang.github.io/zulip_archive/stream/189812-t-compiler/wg-rfc-2229/topic/test.20failures.html#164573681">(Apr 30 2019 at 20:25)</a>:</h4>
<p>I'm starting a full test run now, but it'll probably be a while :)</p>



<a name="164574071"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/189812-t-compiler/wg-rfc-2229/topic/test%20failures/near/164574071" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> blitzerr <a href="https://rust-lang.github.io/zulip_archive/stream/189812-t-compiler/wg-rfc-2229/topic/test.20failures.html#164574071">(Apr 30 2019 at 20:30)</a>:</h4>
<p>Based on missing the witness part, it should only fail generator tests right ?</p>



<a name="164574081"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/189812-t-compiler/wg-rfc-2229/topic/test%20failures/near/164574081" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> blitzerr <a href="https://rust-lang.github.io/zulip_archive/stream/189812-t-compiler/wg-rfc-2229/topic/test.20failures.html#164574081">(Apr 30 2019 at 20:30)</a>:</h4>
<p>But what about the closure tests ?</p>



<a name="164574120"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/189812-t-compiler/wg-rfc-2229/topic/test%20failures/near/164574120" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> blitzerr <a href="https://rust-lang.github.io/zulip_archive/stream/189812-t-compiler/wg-rfc-2229/topic/test.20failures.html#164574120">(Apr 30 2019 at 20:31)</a>:</h4>
<p>It might be a good idea to try some of the tests mentioned in <a href="https://paper.dropbox.com/doc/UI-tests-failing-X96kJW6agXuvx36GPxmcg" target="_blank" title="https://paper.dropbox.com/doc/UI-tests-failing-X96kJW6agXuvx36GPxmcg">here</a> before running the full ui suite ? What do you think ?</p>



<a name="164574248"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/189812-t-compiler/wg-rfc-2229/topic/test%20failures/near/164574248" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> blitzerr <a href="https://rust-lang.github.io/zulip_archive/stream/189812-t-compiler/wg-rfc-2229/topic/test.20failures.html#164574248">(Apr 30 2019 at 20:33)</a>:</h4>
<p><span class="user-mention" data-user-id="116009">@nikomatsakis</span>  <span aria-label="point up" class="emoji emoji-1f446" role="img" title="point up">:point_up:</span></p>



<a name="164574783"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/189812-t-compiler/wg-rfc-2229/topic/test%20failures/near/164574783" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://rust-lang.github.io/zulip_archive/stream/189812-t-compiler/wg-rfc-2229/topic/test.20failures.html#164574783">(Apr 30 2019 at 20:40)</a>:</h4>
<p>there are still plenty of errors in the ui test suite</p>



<a name="164574798"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/189812-t-compiler/wg-rfc-2229/topic/test%20failures/near/164574798" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://rust-lang.github.io/zulip_archive/stream/189812-t-compiler/wg-rfc-2229/topic/test.20failures.html#164574798">(Apr 30 2019 at 20:41)</a>:</h4>
<p>I'm running with --bless and will look in a bit more detail</p>



<a name="164574806"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/189812-t-compiler/wg-rfc-2229/topic/test%20failures/near/164574806" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://rust-lang.github.io/zulip_archive/stream/189812-t-compiler/wg-rfc-2229/topic/test.20failures.html#164574806">(Apr 30 2019 at 20:41)</a>:</h4>
<p>the good news is that, with <code>--bless</code>, the tests<br>
 pass</p>



<a name="164574810"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/189812-t-compiler/wg-rfc-2229/topic/test%20failures/near/164574810" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://rust-lang.github.io/zulip_archive/stream/189812-t-compiler/wg-rfc-2229/topic/test.20failures.html#164574810">(Apr 30 2019 at 20:41)</a>:</h4>
<p>that is, we are still generating the same set of errors we did before</p>



<a name="164574908"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/189812-t-compiler/wg-rfc-2229/topic/test%20failures/near/164574908" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://rust-lang.github.io/zulip_archive/stream/189812-t-compiler/wg-rfc-2229/topic/test.20failures.html#164574908">(Apr 30 2019 at 20:42)</a>:</h4>
<p>but it does seem like we're not <em>quite</em> getting the 'backtrace" data right</p>



<a name="164574925"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/189812-t-compiler/wg-rfc-2229/topic/test%20failures/near/164574925" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> blitzerr <a href="https://rust-lang.github.io/zulip_archive/stream/189812-t-compiler/wg-rfc-2229/topic/test.20failures.html#164574925">(Apr 30 2019 at 20:42)</a>:</h4>
<p>so doesn't bless changes the output accordingly ?</p>



<a name="164574955"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/189812-t-compiler/wg-rfc-2229/topic/test%20failures/near/164574955" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> blitzerr <a href="https://rust-lang.github.io/zulip_archive/stream/189812-t-compiler/wg-rfc-2229/topic/test.20failures.html#164574955">(Apr 30 2019 at 20:43)</a>:</h4>
<p>Then the tests will pass unless we introduced a crash ? Is that understanding right ?</p>



<a name="164577216"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/189812-t-compiler/wg-rfc-2229/topic/test%20failures/near/164577216" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://rust-lang.github.io/zulip_archive/stream/189812-t-compiler/wg-rfc-2229/topic/test.20failures.html#164577216">(Apr 30 2019 at 21:11)</a>:</h4>
<blockquote>
<p>so doesn't bless changes the output accordingly ?</p>
</blockquote>
<p>bless updates the reference files, but not the <code>//~ ERROR</code> anotations</p>



<a name="164577222"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/189812-t-compiler/wg-rfc-2229/topic/test%20failures/near/164577222" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://rust-lang.github.io/zulip_archive/stream/189812-t-compiler/wg-rfc-2229/topic/test.20failures.html#164577222">(Apr 30 2019 at 21:11)</a>:</h4>
<p>so you have to still get the same <em>number</em> of errors, but the text can change</p>



<a name="164577238"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/189812-t-compiler/wg-rfc-2229/topic/test%20failures/near/164577238" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://rust-lang.github.io/zulip_archive/stream/189812-t-compiler/wg-rfc-2229/topic/test.20failures.html#164577238">(Apr 30 2019 at 21:11)</a>:</h4>
<p>I (personaly) always run with <code>--bless</code>, but then I just use <code>git diff</code> to compare output</p>



<a name="164577599"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/189812-t-compiler/wg-rfc-2229/topic/test%20failures/near/164577599" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> blitzerr <a href="https://rust-lang.github.io/zulip_archive/stream/189812-t-compiler/wg-rfc-2229/topic/test.20failures.html#164577599">(Apr 30 2019 at 21:16)</a>:</h4>
<p>I see. Makes sense.</p>



<a name="164577617"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/189812-t-compiler/wg-rfc-2229/topic/test%20failures/near/164577617" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> blitzerr <a href="https://rust-lang.github.io/zulip_archive/stream/189812-t-compiler/wg-rfc-2229/topic/test.20failures.html#164577617">(Apr 30 2019 at 21:16)</a>:</h4>
<p>It's always helpful to know people's workflow</p>



<a name="164577624"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/189812-t-compiler/wg-rfc-2229/topic/test%20failures/near/164577624" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://rust-lang.github.io/zulip_archive/stream/189812-t-compiler/wg-rfc-2229/topic/test.20failures.html#164577624">(Apr 30 2019 at 21:16)</a>:</h4>
<p>this is partly because I the emacs integration w/ git is really great</p>



<a name="164577637"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/189812-t-compiler/wg-rfc-2229/topic/test%20failures/near/164577637" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://rust-lang.github.io/zulip_archive/stream/189812-t-compiler/wg-rfc-2229/topic/test.20failures.html#164577637">(Apr 30 2019 at 21:17)</a>:</h4>
<p>so it's easy to browse the list of files w/ diffs etc</p>



<a name="164577806"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/189812-t-compiler/wg-rfc-2229/topic/test%20failures/near/164577806" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> blitzerr <a href="https://rust-lang.github.io/zulip_archive/stream/189812-t-compiler/wg-rfc-2229/topic/test.20failures.html#164577806">(Apr 30 2019 at 21:19)</a>:</h4>
<p>Waaatt ? You don't use vs-code with rust analyzer ? <span aria-label="smiley" class="emoji emoji-1f603" role="img" title="smiley">:smiley:</span></p>



<a name="164578141"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/189812-t-compiler/wg-rfc-2229/topic/test%20failures/near/164578141" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://rust-lang.github.io/zulip_archive/stream/189812-t-compiler/wg-rfc-2229/topic/test.20failures.html#164578141">(Apr 30 2019 at 21:23)</a>:</h4>
<p>I have interated r-a into emacs, at least on my local machine ... still need to do that on my linux desktop that I use for rustc...</p>



<a name="164578327"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/189812-t-compiler/wg-rfc-2229/topic/test%20failures/near/164578327" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> blitzerr <a href="https://rust-lang.github.io/zulip_archive/stream/189812-t-compiler/wg-rfc-2229/topic/test.20failures.html#164578327">(Apr 30 2019 at 21:25)</a>:</h4>
<p>They didn't have integration steps for vim, so I just use bare-bones vim for rustc</p>



<a name="164627251"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/189812-t-compiler/wg-rfc-2229/topic/test%20failures/near/164627251" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> blitzerr <a href="https://rust-lang.github.io/zulip_archive/stream/189812-t-compiler/wg-rfc-2229/topic/test.20failures.html#164627251">(May 01 2019 at 14:28)</a>:</h4>
<p><span class="user-mention" data-user-id="116009">@nikomatsakis</span> <br>
Curious if the entire suite of test passed with your changes ?</p>



<a name="164635055"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/189812-t-compiler/wg-rfc-2229/topic/test%20failures/near/164635055" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://rust-lang.github.io/zulip_archive/stream/189812-t-compiler/wg-rfc-2229/topic/test.20failures.html#164635055">(May 01 2019 at 16:13)</a>:</h4>
<p>no, there are plenty of failures, I've not had time to dig into 'em</p>



<a name="165443133"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/189812-t-compiler/wg-rfc-2229/topic/test%20failures/near/165443133" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> blitzerr <a href="https://rust-lang.github.io/zulip_archive/stream/189812-t-compiler/wg-rfc-2229/topic/test.20failures.html#165443133">(May 12 2019 at 03:09)</a>:</h4>
<p>I pushed a change as you suggested that fixed a few test cases. We still have 68 failed tests. They have this symptoms.</p>



<a name="165443135"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/189812-t-compiler/wg-rfc-2229/topic/test%20failures/near/165443135" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> blitzerr <a href="https://rust-lang.github.io/zulip_archive/stream/189812-t-compiler/wg-rfc-2229/topic/test.20failures.html#165443135">(May 12 2019 at 03:09)</a>:</h4>
<div class="codehilite"><pre><span></span><span class="o">----</span><span class="w"> </span><span class="p">[</span><span class="n">ui</span><span class="p">]</span><span class="w"> </span><span class="n">ui</span><span class="o">/</span><span class="n">feature</span><span class="o">-</span><span class="n">gates</span><span class="o">/</span><span class="n">feature</span><span class="o">-</span><span class="n">gate</span><span class="o">-</span><span class="n">trivial_bounds</span><span class="p">.</span><span class="n">rs</span><span class="w"> </span><span class="n">stdout</span><span class="w"> </span><span class="o">----</span><span class="w"></span>
<span class="n">diff</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">stderr</span>:

<span class="mi">107</span><span class="w"> </span><span class="n">LL</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="p">}</span><span class="w"></span>
<span class="mi">108</span><span class="w">    </span><span class="o">|</span><span class="w"> </span><span class="o">|</span><span class="n">_</span><span class="o">^</span><span class="w"> </span><span class="n">doesn</span><span class="na">&#39;t</span><span class="w"> </span><span class="n">have</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">size</span><span class="w"> </span><span class="n">known</span><span class="w"> </span><span class="n">at</span><span class="w"> </span><span class="n">compile</span><span class="o">-</span><span class="n">time</span><span class="w"></span>
<span class="mi">109</span><span class="w">    </span><span class="o">|</span><span class="w"></span>
<span class="o">-</span><span class="w">      </span><span class="o">=</span><span class="w"> </span><span class="n">help</span>: <span class="nc">within</span><span class="w"> </span><span class="err">`</span><span class="n">Dst</span><span class="o">&lt;</span><span class="p">(</span><span class="n">dyn</span><span class="w"> </span><span class="n">A</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nb">&#39;static</span><span class="p">)</span><span class="o">&gt;</span><span class="err">`</span><span class="p">,</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="k">trait</span><span class="w"> </span><span class="err">`</span><span class="n">std</span>::<span class="n">marker</span>::<span class="nb">Sized</span><span class="err">`</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">not</span><span class="w"> </span><span class="n">implemented</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="err">`</span><span class="p">(</span><span class="n">dyn</span><span class="w"> </span><span class="n">A</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nb">&#39;static</span><span class="p">)</span><span class="err">`</span><span class="w"></span>
<span class="o">+</span><span class="w">      </span><span class="o">=</span><span class="w"> </span><span class="n">help</span>: <span class="nc">the</span><span class="w"> </span><span class="k">trait</span><span class="w"> </span><span class="err">`</span><span class="n">std</span>::<span class="n">marker</span>::<span class="nb">Sized</span><span class="err">`</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">not</span><span class="w"> </span><span class="n">implemented</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="err">`</span><span class="p">(</span><span class="n">dyn</span><span class="w"> </span><span class="n">A</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nb">&#39;static</span><span class="p">)</span><span class="err">`</span><span class="w"></span>
<span class="mi">111</span><span class="w">    </span><span class="o">=</span><span class="w"> </span><span class="n">note</span>: <span class="nc">to</span><span class="w"> </span><span class="n">learn</span><span class="w"> </span><span class="n">more</span><span class="p">,</span><span class="w"> </span><span class="n">visit</span><span class="w"> </span><span class="o">&lt;</span><span class="n">https</span>:<span class="c1">//doc.rust-lang.org/book/ch19-04-advanced-types.html#dynamically-sized-types-and-the-sized-trait&gt;</span>
<span class="o">-</span><span class="w">      </span><span class="o">=</span><span class="w"> </span><span class="n">note</span>: <span class="nc">required</span><span class="w"> </span><span class="n">because</span><span class="w"> </span><span class="n">it</span><span class="w"> </span><span class="n">appears</span><span class="w"> </span><span class="n">within</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="k">type</span> <span class="err">`</span><span class="n">Dst</span><span class="o">&lt;</span><span class="p">(</span><span class="n">dyn</span><span class="w"> </span><span class="n">A</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nb">&#39;static</span><span class="p">)</span><span class="o">&gt;</span><span class="err">`</span><span class="w"></span>
<span class="mi">113</span><span class="w">    </span><span class="o">=</span><span class="w"> </span><span class="n">help</span>: <span class="nc">see</span><span class="w"> </span><span class="n">issue</span><span class="w"> </span><span class="err">#</span><span class="mi">48214</span><span class="w"></span>
<span class="mi">114</span><span class="w">    </span><span class="o">=</span><span class="w"> </span><span class="n">help</span>: <span class="nc">add</span><span class="w"> </span><span class="cp">#![feature(trivial_bounds)]</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="k">crate</span><span class="w"> </span><span class="n">attributes</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">enable</span><span class="w"></span>
<span class="mi">115</span><span class="w"></span>
</pre></div>



<a name="165443227"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/189812-t-compiler/wg-rfc-2229/topic/test%20failures/near/165443227" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> blitzerr <a href="https://rust-lang.github.io/zulip_archive/stream/189812-t-compiler/wg-rfc-2229/topic/test.20failures.html#165443227">(May 12 2019 at 03:10)</a>:</h4>
<div class="codehilite"><pre><span></span><span class="o">----</span><span class="w"> </span><span class="p">[</span><span class="n">ui</span><span class="p">]</span><span class="w"> </span><span class="n">ui</span><span class="o">/</span><span class="kr">unsized</span><span class="o">-</span><span class="n">locals</span><span class="o">/</span><span class="n">issue</span><span class="o">-</span><span class="mi">50940</span><span class="o">-</span><span class="n">with</span><span class="o">-</span><span class="n">feature</span><span class="p">.</span><span class="n">rs</span><span class="w"> </span><span class="n">stdout</span><span class="w"> </span><span class="o">----</span><span class="w"></span>
<span class="n">diff</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">stderr</span>:

<span class="mi">4</span><span class="w">   </span><span class="n">LL</span><span class="w"> </span><span class="o">|</span><span class="w">     </span><span class="n">A</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="k">fn</span><span class="p">(</span><span class="kt">str</span><span class="p">)</span><span class="w"> </span>-&gt; <span class="nc">A</span><span class="o">&lt;</span><span class="kt">str</span><span class="o">&gt;</span><span class="p">;</span><span class="w"></span>
<span class="mi">5</span><span class="w">      </span><span class="o">|</span><span class="w">     </span><span class="o">^</span><span class="w"> </span><span class="n">doesn</span><span class="na">&#39;t</span><span class="w"> </span><span class="n">have</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">size</span><span class="w"> </span><span class="n">known</span><span class="w"> </span><span class="n">at</span><span class="w"> </span><span class="n">compile</span><span class="o">-</span><span class="n">time</span><span class="w"></span>
<span class="mi">6</span><span class="w">      </span><span class="o">|</span><span class="w"></span>
<span class="o">-</span><span class="w">      </span><span class="o">=</span><span class="w"> </span><span class="n">help</span>: <span class="nc">within</span><span class="w"> </span><span class="err">`</span><span class="n">main</span>::<span class="n">A</span><span class="o">&lt;</span><span class="kt">str</span><span class="o">&gt;</span><span class="err">`</span><span class="p">,</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="k">trait</span><span class="w"> </span><span class="err">`</span><span class="n">std</span>::<span class="n">marker</span>::<span class="nb">Sized</span><span class="err">`</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">not</span><span class="w"> </span><span class="n">implemented</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="err">`</span><span class="kt">str</span><span class="err">`</span><span class="w"></span>
<span class="o">+</span><span class="w">      </span><span class="o">=</span><span class="w"> </span><span class="n">help</span>: <span class="nc">the</span><span class="w"> </span><span class="k">trait</span><span class="w"> </span><span class="err">`</span><span class="n">std</span>::<span class="n">marker</span>::<span class="nb">Sized</span><span class="err">`</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">not</span><span class="w"> </span><span class="n">implemented</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="err">`</span><span class="kt">str</span><span class="err">`</span><span class="w"></span>
<span class="mi">8</span><span class="w">      </span><span class="o">=</span><span class="w"> </span><span class="n">note</span>: <span class="nc">to</span><span class="w"> </span><span class="n">learn</span><span class="w"> </span><span class="n">more</span><span class="p">,</span><span class="w"> </span><span class="n">visit</span><span class="w"> </span><span class="o">&lt;</span><span class="n">https</span>:<span class="c1">//doc.rust-lang.org/book/ch19-04-advanced-types.html#dynamically-sized-types-and-the-sized-trait&gt;</span>
<span class="o">-</span><span class="w">      </span><span class="o">=</span><span class="w"> </span><span class="n">note</span>: <span class="nc">required</span><span class="w"> </span><span class="n">because</span><span class="w"> </span><span class="n">it</span><span class="w"> </span><span class="n">appears</span><span class="w"> </span><span class="n">within</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="k">type</span> <span class="err">`</span><span class="n">main</span>::<span class="n">A</span><span class="o">&lt;</span><span class="kt">str</span><span class="o">&gt;</span><span class="err">`</span><span class="w"></span>
<span class="mi">10</span><span class="w">     </span><span class="o">=</span><span class="w"> </span><span class="n">note</span>: <span class="nc">the</span><span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="k">type</span> <span class="nc">of</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">function</span><span class="w"> </span><span class="n">must</span><span class="w"> </span><span class="n">have</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">statically</span><span class="w"> </span><span class="n">known</span><span class="w"> </span><span class="n">size</span><span class="w"></span>
<span class="mi">11</span><span class="w"></span>
<span class="mi">12</span><span class="w">  </span><span class="n">error</span>: <span class="nc">aborting</span><span class="w"> </span><span class="n">due</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">previous</span><span class="w"> </span><span class="n">error</span><span class="w"></span>
</pre></div>



<a name="165443268"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/189812-t-compiler/wg-rfc-2229/topic/test%20failures/near/165443268" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> blitzerr <a href="https://rust-lang.github.io/zulip_archive/stream/189812-t-compiler/wg-rfc-2229/topic/test.20failures.html#165443268">(May 12 2019 at 03:11)</a>:</h4>
<p>Those two are similar. Some of the other ones are</p>



<a name="165443270"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/189812-t-compiler/wg-rfc-2229/topic/test%20failures/near/165443270" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> blitzerr <a href="https://rust-lang.github.io/zulip_archive/stream/189812-t-compiler/wg-rfc-2229/topic/test.20failures.html#165443270">(May 12 2019 at 03:11)</a>:</h4>
<div class="codehilite"><pre><span></span><span class="o">----</span><span class="w"> </span><span class="p">[</span><span class="n">ui</span><span class="p">]</span><span class="w"> </span><span class="n">ui</span><span class="o">/</span><span class="n">suggestions</span><span class="o">/</span><span class="n">path</span><span class="o">-</span><span class="n">by</span><span class="o">-</span><span class="n">value</span><span class="p">.</span><span class="n">rs</span><span class="w"> </span><span class="n">stdout</span><span class="w"> </span><span class="o">----</span><span class="w"></span>
<span class="n">diff</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">stderr</span>:

<span class="mi">2</span><span class="w">     </span><span class="o">-</span>-&gt; <span class="cp">$DIR</span><span class="o">/</span><span class="n">path</span><span class="o">-</span><span class="n">by</span><span class="o">-</span><span class="n">value</span><span class="p">.</span><span class="n">rs</span>:<span class="mi">3</span>:<span class="mi">6</span><span class="w"></span>
<span class="mi">3</span><span class="w">      </span><span class="o">|</span><span class="w"></span>
<span class="mi">4</span><span class="w">   </span><span class="n">LL</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="k">fn</span> <span class="nf">f</span><span class="p">(</span><span class="n">p</span>: <span class="nc">Path</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="p">}</span><span class="w"></span>
<span class="o">-</span><span class="w">      </span><span class="o">|</span><span class="w">      </span><span class="o">^</span><span class="w"> </span><span class="n">borrow</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="err">`</span><span class="n">Path</span><span class="err">`</span><span class="w"> </span><span class="n">instead</span><span class="w"></span>
<span class="o">+</span><span class="w">      </span><span class="o">|</span><span class="w">      </span><span class="o">^</span><span class="w"> </span><span class="n">doesn</span><span class="na">&#39;t</span><span class="w"> </span><span class="n">have</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">size</span><span class="w"> </span><span class="n">known</span><span class="w"> </span><span class="n">at</span><span class="w"> </span><span class="n">compile</span><span class="o">-</span><span class="n">time</span><span class="w"></span>
<span class="mi">6</span><span class="w">      </span><span class="o">|</span><span class="w"></span>
<span class="o">-</span><span class="w">      </span><span class="o">=</span><span class="w"> </span><span class="n">help</span>: <span class="nc">within</span><span class="w"> </span><span class="err">`</span><span class="n">std</span>::<span class="n">path</span>::<span class="n">Path</span><span class="err">`</span><span class="p">,</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="k">trait</span><span class="w"> </span><span class="err">`</span><span class="n">std</span>::<span class="n">marker</span>::<span class="nb">Sized</span><span class="err">`</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">not</span><span class="w"> </span><span class="n">implemented</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="err">`</span><span class="p">[</span><span class="kt">u8</span><span class="p">]</span><span class="err">`</span><span class="w"></span>
<span class="o">+</span><span class="w">      </span><span class="o">=</span><span class="w"> </span><span class="n">help</span>: <span class="nc">the</span><span class="w"> </span><span class="k">trait</span><span class="w"> </span><span class="err">`</span><span class="n">std</span>::<span class="n">marker</span>::<span class="nb">Sized</span><span class="err">`</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">not</span><span class="w"> </span><span class="n">implemented</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="err">`</span><span class="p">[</span><span class="kt">u8</span><span class="p">]</span><span class="err">`</span><span class="w"></span>
<span class="mi">8</span><span class="w">      </span><span class="o">=</span><span class="w"> </span><span class="n">note</span>: <span class="nc">to</span><span class="w"> </span><span class="n">learn</span><span class="w"> </span><span class="n">more</span><span class="p">,</span><span class="w"> </span><span class="n">visit</span><span class="w"> </span><span class="o">&lt;</span><span class="n">https</span>:<span class="c1">//doc.rust-lang.org/book/ch19-04-advanced-types.html#dynamically-sized-types-and-the-sized-trait&gt;</span>
<span class="o">-</span><span class="w">      </span><span class="o">=</span><span class="w"> </span><span class="n">note</span>: <span class="nc">required</span><span class="w"> </span><span class="n">because</span><span class="w"> </span><span class="n">it</span><span class="w"> </span><span class="n">appears</span><span class="w"> </span><span class="n">within</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="k">type</span> <span class="err">`</span><span class="n">std</span>::<span class="n">path</span>::<span class="n">Path</span><span class="err">`</span><span class="w"></span>
<span class="mi">10</span><span class="w">     </span><span class="o">=</span><span class="w"> </span><span class="n">note</span>: <span class="nc">all</span><span class="w"> </span><span class="n">local</span><span class="w"> </span><span class="n">variables</span><span class="w"> </span><span class="n">must</span><span class="w"> </span><span class="n">have</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">statically</span><span class="w"> </span><span class="n">known</span><span class="w"> </span><span class="n">size</span><span class="w"></span>
<span class="mi">11</span><span class="w">     </span><span class="o">=</span><span class="w"> </span><span class="n">help</span>: <span class="nc">unsized</span><span class="w"> </span><span class="n">locals</span><span class="w"> </span><span class="n">are</span><span class="w"> </span><span class="n">gated</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">an</span><span class="w"> </span><span class="n">unstable</span><span class="w"> </span><span class="n">feature</span><span class="w"></span>
<span class="mi">12</span><span class="w"></span>
</pre></div>



<a name="165443324"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/189812-t-compiler/wg-rfc-2229/topic/test%20failures/near/165443324" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> blitzerr <a href="https://rust-lang.github.io/zulip_archive/stream/189812-t-compiler/wg-rfc-2229/topic/test.20failures.html#165443324">(May 12 2019 at 03:12)</a>:</h4>
<div class="codehilite"><pre><span></span><span class="o">----</span><span class="w"> </span><span class="p">[</span><span class="n">ui</span><span class="p">]</span><span class="w"> </span><span class="n">ui</span><span class="o">/</span><span class="n">traits</span><span class="o">/</span><span class="k">trait</span><span class="o">-</span><span class="n">suggest</span><span class="o">-</span><span class="k">where</span><span class="o">-</span><span class="n">clause</span><span class="p">.</span><span class="n">rs</span><span class="w"> </span><span class="n">stdout</span><span class="w"> </span><span class="o">----</span><span class="w"></span>
<span class="n">diff</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">stderr</span>:

<span class="mi">15</span><span class="w">  </span><span class="n">LL</span><span class="w"> </span><span class="o">|</span><span class="w">     </span><span class="n">mem</span>::<span class="n">size_of</span>::<span class="o">&lt;</span><span class="n">Misc</span><span class="o">&lt;</span><span class="n">U</span><span class="o">&gt;&gt;</span><span class="p">();</span><span class="w"></span>
<span class="mi">16</span><span class="w">     </span><span class="o">|</span><span class="w">     </span><span class="o">^^^^^^^^^^^^^^^^^^^^^^^</span><span class="w"> </span><span class="n">doesn</span><span class="na">&#39;t</span><span class="w"> </span><span class="n">have</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">size</span><span class="w"> </span><span class="n">known</span><span class="w"> </span><span class="n">at</span><span class="w"> </span><span class="n">compile</span><span class="o">-</span><span class="n">time</span><span class="w"></span>
<span class="mi">17</span><span class="w">     </span><span class="o">|</span><span class="w"></span>
<span class="o">-</span><span class="w">      </span><span class="o">=</span><span class="w"> </span><span class="n">help</span>: <span class="nc">within</span><span class="w"> </span><span class="err">`</span><span class="n">Misc</span><span class="o">&lt;</span><span class="n">U</span><span class="o">&gt;</span><span class="err">`</span><span class="p">,</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="k">trait</span><span class="w"> </span><span class="err">`</span><span class="n">std</span>::<span class="n">marker</span>::<span class="nb">Sized</span><span class="err">`</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">not</span><span class="w"> </span><span class="n">implemented</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="err">`</span><span class="n">U</span><span class="err">`</span><span class="w"></span>
<span class="o">+</span><span class="w">      </span><span class="o">=</span><span class="w"> </span><span class="n">help</span>: <span class="nc">the</span><span class="w"> </span><span class="k">trait</span><span class="w"> </span><span class="err">`</span><span class="n">std</span>::<span class="n">marker</span>::<span class="nb">Sized</span><span class="err">`</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">not</span><span class="w"> </span><span class="n">implemented</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="err">`</span><span class="n">U</span><span class="err">`</span><span class="w"></span>
<span class="mi">19</span><span class="w">     </span><span class="o">=</span><span class="w"> </span><span class="n">note</span>: <span class="nc">to</span><span class="w"> </span><span class="n">learn</span><span class="w"> </span><span class="n">more</span><span class="p">,</span><span class="w"> </span><span class="n">visit</span><span class="w"> </span><span class="o">&lt;</span><span class="n">https</span>:<span class="c1">//doc.rust-lang.org/book/ch19-04-advanced-types.html#dynamically-sized-types-and-the-sized-trait&gt;</span>
<span class="mi">20</span><span class="w">     </span><span class="o">=</span><span class="w"> </span><span class="n">help</span>: <span class="nc">consider</span><span class="w"> </span><span class="n">adding</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="err">`</span><span class="k">where</span><span class="w"> </span><span class="n">U</span>: <span class="nc">std</span>::<span class="n">marker</span>::<span class="nb">Sized</span><span class="err">`</span><span class="w"> </span><span class="n">bound</span><span class="w"></span>
<span class="o">-</span><span class="w">      </span><span class="o">=</span><span class="w"> </span><span class="n">note</span>: <span class="nc">required</span><span class="w"> </span><span class="n">because</span><span class="w"> </span><span class="n">it</span><span class="w"> </span><span class="n">appears</span><span class="w"> </span><span class="n">within</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="k">type</span> <span class="err">`</span><span class="n">Misc</span><span class="o">&lt;</span><span class="n">U</span><span class="o">&gt;</span><span class="err">`</span><span class="w"></span>
<span class="mi">22</span><span class="w">     </span><span class="o">=</span><span class="w"> </span><span class="n">note</span>: <span class="nc">required</span><span class="w"> </span><span class="n">by</span><span class="w"> </span><span class="err">`</span><span class="n">std</span>::<span class="n">mem</span>::<span class="n">size_of</span><span class="err">`</span><span class="w"></span>
<span class="mi">23</span><span class="w"></span>
<span class="mi">24</span><span class="w">  </span><span class="n">error</span><span class="p">[</span><span class="n">E0277</span><span class="p">]</span>: <span class="nc">the</span><span class="w"> </span><span class="k">trait</span><span class="w"> </span><span class="n">bound</span><span class="w"> </span><span class="err">`</span><span class="kt">u64</span>: <span class="nc">std</span>::<span class="n">convert</span>::<span class="nb">From</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;</span><span class="err">`</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">not</span><span class="w"> </span><span class="n">satisfied</span><span class="w"></span>
</pre></div>



<a name="165443337"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/189812-t-compiler/wg-rfc-2229/topic/test%20failures/near/165443337" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> blitzerr <a href="https://rust-lang.github.io/zulip_archive/stream/189812-t-compiler/wg-rfc-2229/topic/test.20failures.html#165443337">(May 12 2019 at 03:12)</a>:</h4>
<p><span class="user-mention" data-user-id="116009">@nikomatsakis</span>  <span aria-label="point of information" class="emoji emoji-261d" role="img" title="point of information">:point_of_information:</span></p>



<a name="165475672"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/189812-t-compiler/wg-rfc-2229/topic/test%20failures/near/165475672" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> blitzerr <a href="https://rust-lang.github.io/zulip_archive/stream/189812-t-compiler/wg-rfc-2229/topic/test.20failures.html#165475672">(May 12 2019 at 18:31)</a>:</h4>
<p>Tracking details <a href="https://paper.dropbox.com/doc/UI-tests-failing--Ac8CJDkVgakYmE9LncnFnUXMAg-X96kJW6agXuvx36GPxmcg#:h2=May-12" target="_blank" title="https://paper.dropbox.com/doc/UI-tests-failing--Ac8CJDkVgakYmE9LncnFnUXMAg-X96kJW6agXuvx36GPxmcg#:h2=May-12">here</a></p>



<a name="165491308"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/189812-t-compiler/wg-rfc-2229/topic/test%20failures/near/165491308" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> blitzerr <a href="https://rust-lang.github.io/zulip_archive/stream/189812-t-compiler/wg-rfc-2229/topic/test.20failures.html#165491308">(May 13 2019 at 01:48)</a>:</h4>
<p>I created another <a href="https://github.com/blitzerr/rust/commits/upvar-tys-squashed" target="_blank" title="https://github.com/blitzerr/rust/commits/upvar-tys-squashed">branch</a> with all chanegs squashed into 1. Maybe that will be better to locate changes that caused errors.</p>



<a name="165491546"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/189812-t-compiler/wg-rfc-2229/topic/test%20failures/near/165491546" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> blitzerr <a href="https://rust-lang.github.io/zulip_archive/stream/189812-t-compiler/wg-rfc-2229/topic/test.20failures.html#165491546">(May 13 2019 at 01:54)</a>:</h4>
<p>Also I don't see <code>ppaux.rs</code> anymore in the <a href="https://github.com/rust-lang/rust/tree/master/src/librustc/util" target="_blank" title="https://github.com/rust-lang/rust/tree/master/src/librustc/util">rust-mainline</a>. So merging will be interesting <span aria-label="slight smile" class="emoji emoji-1f642" role="img" title="slight smile">:slight_smile:</span></p>



<a name="165550704"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/189812-t-compiler/wg-rfc-2229/topic/test%20failures/near/165550704" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://rust-lang.github.io/zulip_archive/stream/189812-t-compiler/wg-rfc-2229/topic/test.20failures.html#165550704">(May 13 2019 at 17:41)</a>:</h4>
<p>lol uh yeah I think <span class="user-mention" data-user-id="119009">@eddyb</span> did some rewrite</p>



<a name="165550794"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/189812-t-compiler/wg-rfc-2229/topic/test%20failures/near/165550794" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://rust-lang.github.io/zulip_archive/stream/189812-t-compiler/wg-rfc-2229/topic/test.20failures.html#165550794">(May 13 2019 at 17:42)</a>:</h4>
<p>sounds like progress, <span class="user-mention" data-user-id="128294">@blitzerr</span></p>



<a name="165550818"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/189812-t-compiler/wg-rfc-2229/topic/test%20failures/near/165550818" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://rust-lang.github.io/zulip_archive/stream/189812-t-compiler/wg-rfc-2229/topic/test.20failures.html#165550818">(May 13 2019 at 17:42)</a>:</h4>
<p>these all seem to have to do with the "within" text... hmmm...</p>



<a name="165550876"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/189812-t-compiler/wg-rfc-2229/topic/test%20failures/near/165550876" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> eddyb <a href="https://rust-lang.github.io/zulip_archive/stream/189812-t-compiler/wg-rfc-2229/topic/test.20failures.html#165550876">(May 13 2019 at 17:43)</a>:</h4>
<p><span class="user-mention" data-user-id="128294">@blitzerr</span> most ppaux changes should be made against <code>src/librustc/ty/print/pretty.rs</code> now</p>



<a name="165550985"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/189812-t-compiler/wg-rfc-2229/topic/test%20failures/near/165550985" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> blitzerr <a href="https://rust-lang.github.io/zulip_archive/stream/189812-t-compiler/wg-rfc-2229/topic/test.20failures.html#165550985">(May 13 2019 at 17:44)</a>:</h4>
<p>Ya a lot of them have to do with <code>within</code> context</p>



<a name="165551040"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/189812-t-compiler/wg-rfc-2229/topic/test%20failures/near/165551040" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> blitzerr <a href="https://rust-lang.github.io/zulip_archive/stream/189812-t-compiler/wg-rfc-2229/topic/test.20failures.html#165551040">(May 13 2019 at 17:45)</a>:</h4>
<p>Thanks a lot <span class="user-mention" data-user-id="119009">@eddyb</span> . Will keep that in mind about ppaux. <code>pretty</code> sounds like a better name for it</p>



<a name="165551135"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/189812-t-compiler/wg-rfc-2229/topic/test%20failures/near/165551135" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> blitzerr <a href="https://rust-lang.github.io/zulip_archive/stream/189812-t-compiler/wg-rfc-2229/topic/test.20failures.html#165551135">(May 13 2019 at 17:46)</a>:</h4>
<p><span class="user-mention" data-user-id="116009">@nikomatsakis</span>  Do you know where the <code>within</code> text comes from  ?</p>



<a name="165551172"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/189812-t-compiler/wg-rfc-2229/topic/test%20failures/near/165551172" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> blitzerr <a href="https://rust-lang.github.io/zulip_archive/stream/189812-t-compiler/wg-rfc-2229/topic/test.20failures.html#165551172">(May 13 2019 at 17:46)</a>:</h4>
<p>Also, you can look at the squashed branch, it should give us a better coverage of actual change as we did, un-did and re-did a few changes</p>



<a name="165913544"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/189812-t-compiler/wg-rfc-2229/topic/test%20failures/near/165913544" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> blitzerr <a href="https://rust-lang.github.io/zulip_archive/stream/189812-t-compiler/wg-rfc-2229/topic/test.20failures.html#165913544">(May 17 2019 at 16:12)</a>:</h4>
<p>Hi <span class="user-mention" data-user-id="116009">@nikomatsakis</span> <br>
If you have some pointers on the next set of failures, then let me know. I plan on making some progress this weekend.</p>



<a name="165919005"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/189812-t-compiler/wg-rfc-2229/topic/test%20failures/near/165919005" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://rust-lang.github.io/zulip_archive/stream/189812-t-compiler/wg-rfc-2229/topic/test.20failures.html#165919005">(May 17 2019 at 17:22)</a>:</h4>
<p><span class="user-mention" data-user-id="128294">@blitzerr</span> let me take a look</p>



<a name="165919485"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/189812-t-compiler/wg-rfc-2229/topic/test%20failures/near/165919485" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> blitzerr <a href="https://rust-lang.github.io/zulip_archive/stream/189812-t-compiler/wg-rfc-2229/topic/test.20failures.html#165919485">(May 17 2019 at 17:28)</a>:</h4>
<p>Thank you sir. <span aria-label="grinning" class="emoji emoji-1f600" role="img" title="grinning">:grinning:</span></p>



<a name="165922919"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/189812-t-compiler/wg-rfc-2229/topic/test%20failures/near/165922919" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://rust-lang.github.io/zulip_archive/stream/189812-t-compiler/wg-rfc-2229/topic/test.20failures.html#165922919">(May 17 2019 at 18:09)</a>:</h4>
<p><span class="user-mention" data-user-id="128294">@blitzerr</span> wait, where did you push those commits?</p>



<a name="165922936"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/189812-t-compiler/wg-rfc-2229/topic/test%20failures/near/165922936" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://rust-lang.github.io/zulip_archive/stream/189812-t-compiler/wg-rfc-2229/topic/test.20failures.html#165922936">(May 17 2019 at 18:09)</a>:</h4>
<p>I pulled from your branch but I still see 1000+ failures</p>



<a name="165922945"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/189812-t-compiler/wg-rfc-2229/topic/test%20failures/near/165922945" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://rust-lang.github.io/zulip_archive/stream/189812-t-compiler/wg-rfc-2229/topic/test.20failures.html#165922945">(May 17 2019 at 18:09)</a>:</h4>
<p>oh, I see, d'oh</p>



<a name="165923138"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/189812-t-compiler/wg-rfc-2229/topic/test%20failures/near/165923138" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://rust-lang.github.io/zulip_archive/stream/189812-t-compiler/wg-rfc-2229/topic/test.20failures.html#165923138">(May 17 2019 at 18:11)</a>:</h4>
<blockquote>
<p>Ya a lot of them have to do with <code>within</code> context</p>
</blockquote>
<p>you asked where that text comes from -- the answer is <a href="https://github.com/rust-lang/rust/blob/b982867a7349f84c17317599b59aeb5a7d8a83be/src/librustc/traits/error_reporting.rs#L634-L637" target="_blank" title="https://github.com/rust-lang/rust/blob/b982867a7349f84c17317599b59aeb5a7d8a83be/src/librustc/traits/error_reporting.rs#L634-L637">this line in the trait error-reporting code</a>, I believe.</p>



<a name="165924069"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/189812-t-compiler/wg-rfc-2229/topic/test%20failures/near/165924069" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://rust-lang.github.io/zulip_archive/stream/189812-t-compiler/wg-rfc-2229/topic/test.20failures.html#165924069">(May 17 2019 at 18:22)</a>:</h4>
<p><span class="user-mention" data-user-id="128294">@blitzerr</span> I...might have found your problem. Running a quick test now.</p>



<a name="165930537"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/189812-t-compiler/wg-rfc-2229/topic/test%20failures/near/165930537" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> blitzerr <a href="https://rust-lang.github.io/zulip_archive/stream/189812-t-compiler/wg-rfc-2229/topic/test.20failures.html#165930537">(May 17 2019 at 19:42)</a>:</h4>
<p>Awesome !</p>



<a name="165930550"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/189812-t-compiler/wg-rfc-2229/topic/test%20failures/near/165930550" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> blitzerr <a href="https://rust-lang.github.io/zulip_archive/stream/189812-t-compiler/wg-rfc-2229/topic/test.20failures.html#165930550">(May 17 2019 at 19:42)</a>:</h4>
<p>Thank you, thank you</p>



<a name="165931769"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/189812-t-compiler/wg-rfc-2229/topic/test%20failures/near/165931769" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://rust-lang.github.io/zulip_archive/stream/189812-t-compiler/wg-rfc-2229/topic/test.20failures.html#165931769">(May 17 2019 at 20:00)</a>:</h4>
<p>it looks like I was correct</p>



<a name="165931774"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/189812-t-compiler/wg-rfc-2229/topic/test%20failures/near/165931774" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://rust-lang.github.io/zulip_archive/stream/189812-t-compiler/wg-rfc-2229/topic/test.20failures.html#165931774">(May 17 2019 at 20:00)</a>:</h4>
<p>but the bug was in 2 places</p>



<a name="165931797"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/189812-t-compiler/wg-rfc-2229/topic/test%20failures/near/165931797" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://rust-lang.github.io/zulip_archive/stream/189812-t-compiler/wg-rfc-2229/topic/test.20failures.html#165931797">(May 17 2019 at 20:01)</a>:</h4>
<p>re-running the test at the moment</p>



<a name="165931799"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/189812-t-compiler/wg-rfc-2229/topic/test%20failures/near/165931799" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://rust-lang.github.io/zulip_archive/stream/189812-t-compiler/wg-rfc-2229/topic/test.20failures.html#165931799">(May 17 2019 at 20:01)</a>:</h4>
<div class="codehilite"><pre><span></span>modified   src/librustc/traits/select.rs
<span class="gu">@@ -2770,7 +2770,7 @@ impl&lt;&#39;cx, &#39;gcx, &#39;tcx&gt; SelectionContext&lt;&#39;cx, &#39;gcx, &#39;tcx&gt; {</span>
                 ),
             };

<span class="gd">-            let cause = if is_closure_tuple {</span>
<span class="gi">+            let cause = if !is_closure_tuple {</span>
                 obligation.derived_cause(BuiltinDerivedObligation)
             } else {
                 obligation.cause.clone()
<span class="gu">@@ -2829,7 +2829,7 @@ impl&lt;&#39;cx, &#39;gcx, &#39;tcx&gt; SelectionContext&lt;&#39;cx, &#39;gcx, &#39;tcx&gt; {</span>
     ) -&gt; VtableAutoImplData&lt;PredicateObligation&lt;&#39;tcx&gt;&gt; {
         debug!(&quot;vtable_auto_impl: nested={:?}&quot;, nested);

<span class="gd">-        let cause = if is_upvar_tuple_ty {</span>
<span class="gi">+        let cause = if !is_upvar_tuple_ty {</span>
             obligation.derived_cause(BuiltinDerivedObligation)
         } else {
             obligation.cause.clone()
</pre></div>



<a name="165933265"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/189812-t-compiler/wg-rfc-2229/topic/test%20failures/near/165933265" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://rust-lang.github.io/zulip_archive/stream/189812-t-compiler/wg-rfc-2229/topic/test.20failures.html#165933265">(May 17 2019 at 20:20)</a>:</h4>
<p><span class="user-mention" data-user-id="128294">@blitzerr</span> can you give me perm to write to that branch?</p>



<a name="165933268"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/189812-t-compiler/wg-rfc-2229/topic/test%20failures/near/165933268" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://rust-lang.github.io/zulip_archive/stream/189812-t-compiler/wg-rfc-2229/topic/test.20failures.html#165933268">(May 17 2019 at 20:20)</a>:</h4>
<p>or else open a PR or something?</p>



<a name="165933306"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/189812-t-compiler/wg-rfc-2229/topic/test%20failures/near/165933306" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://rust-lang.github.io/zulip_archive/stream/189812-t-compiler/wg-rfc-2229/topic/test.20failures.html#165933306">(May 17 2019 at 20:21)</a>:</h4>
<p>we appear to be down to 9 diffs</p>



<a name="165933310"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/189812-t-compiler/wg-rfc-2229/topic/test%20failures/near/165933310" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://rust-lang.github.io/zulip_archive/stream/189812-t-compiler/wg-rfc-2229/topic/test.20failures.html#165933310">(May 17 2019 at 20:21)</a>:</h4>
<p>those 9 diffs I don't quite understand yet</p>



<a name="165933342"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/189812-t-compiler/wg-rfc-2229/topic/test%20failures/near/165933342" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://rust-lang.github.io/zulip_archive/stream/189812-t-compiler/wg-rfc-2229/topic/test.20failures.html#165933342">(May 17 2019 at 20:21)</a>:</h4>
<p><em>oh</em> I...think maybe I do</p>



<a name="165933387"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/189812-t-compiler/wg-rfc-2229/topic/test%20failures/near/165933387" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://rust-lang.github.io/zulip_archive/stream/189812-t-compiler/wg-rfc-2229/topic/test.20failures.html#165933387">(May 17 2019 at 20:22)</a>:</h4>
<p>but I don't know how to fix it</p>



<a name="165933410"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/189812-t-compiler/wg-rfc-2229/topic/test%20failures/near/165933410" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> blitzerr <a href="https://rust-lang.github.io/zulip_archive/stream/189812-t-compiler/wg-rfc-2229/topic/test.20failures.html#165933410">(May 17 2019 at 20:22)</a>:</h4>
<p>You have pushed chnages to my branch before. Is it not working this time ?</p>



<a name="165933417"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/189812-t-compiler/wg-rfc-2229/topic/test%20failures/near/165933417" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> blitzerr <a href="https://rust-lang.github.io/zulip_archive/stream/189812-t-compiler/wg-rfc-2229/topic/test.20failures.html#165933417">(May 17 2019 at 20:22)</a>:</h4>
<p>*changes</p>



<a name="165933560"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/189812-t-compiler/wg-rfc-2229/topic/test%20failures/near/165933560" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> blitzerr <a href="https://rust-lang.github.io/zulip_archive/stream/189812-t-compiler/wg-rfc-2229/topic/test.20failures.html#165933560">(May 17 2019 at 20:24)</a>:</h4>
<p><span class="user-mention" data-user-id="116009">@nikomatsakis</span>  Which branch are you trying to write to <code>upvar-tuple</code> or <code>upvar-tys-squashed</code> ?</p>



<a name="165933600"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/189812-t-compiler/wg-rfc-2229/topic/test%20failures/near/165933600" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://rust-lang.github.io/zulip_archive/stream/189812-t-compiler/wg-rfc-2229/topic/test.20failures.html#165933600">(May 17 2019 at 20:25)</a>:</h4>
<p>upvar-tys-squashed</p>



<a name="165933615"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/189812-t-compiler/wg-rfc-2229/topic/test%20failures/near/165933615" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://rust-lang.github.io/zulip_archive/stream/189812-t-compiler/wg-rfc-2229/topic/test.20failures.html#165933615">(May 17 2019 at 20:25)</a>:</h4>
<p>which would no longer be squashed :)</p>



<a name="165933622"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/189812-t-compiler/wg-rfc-2229/topic/test%20failures/near/165933622" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://rust-lang.github.io/zulip_archive/stream/189812-t-compiler/wg-rfc-2229/topic/test.20failures.html#165933622">(May 17 2019 at 20:25)</a>:</h4>
<p>I can force push to upvar-tuple if you want</p>



<a name="165933629"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/189812-t-compiler/wg-rfc-2229/topic/test%20failures/near/165933629" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://rust-lang.github.io/zulip_archive/stream/189812-t-compiler/wg-rfc-2229/topic/test.20failures.html#165933629">(May 17 2019 at 20:25)</a>:</h4>
<p>I think maybe you have an open PR for that?</p>



<a name="165933654"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/189812-t-compiler/wg-rfc-2229/topic/test%20failures/near/165933654" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> blitzerr <a href="https://rust-lang.github.io/zulip_archive/stream/189812-t-compiler/wg-rfc-2229/topic/test.20failures.html#165933654">(May 17 2019 at 20:25)</a>:</h4>
<p>Ya, maybe I will just create a  new PR <span aria-label="slight smile" class="emoji emoji-1f642" role="img" title="slight smile">:slight_smile:</span></p>



<a name="165933756"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/189812-t-compiler/wg-rfc-2229/topic/test%20failures/near/165933756" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> blitzerr <a href="https://rust-lang.github.io/zulip_archive/stream/189812-t-compiler/wg-rfc-2229/topic/test.20failures.html#165933756">(May 17 2019 at 20:27)</a>:</h4>
<p>Do you prefer to have one squashed PR or incremental commits ? What would be easier for you to review ? <br>
<span class="user-mention" data-user-id="116009">@nikomatsakis</span></p>



<a name="165933875"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/189812-t-compiler/wg-rfc-2229/topic/test%20failures/near/165933875" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://rust-lang.github.io/zulip_archive/stream/189812-t-compiler/wg-rfc-2229/topic/test.20failures.html#165933875">(May 17 2019 at 20:28)</a>:</h4>
<p>mmm I mean commits are good unless they are revising one another</p>



<a name="165933881"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/189812-t-compiler/wg-rfc-2229/topic/test%20failures/near/165933881" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://rust-lang.github.io/zulip_archive/stream/189812-t-compiler/wg-rfc-2229/topic/test.20failures.html#165933881">(May 17 2019 at 20:28)</a>:</h4>
<p>in cases like this what I usually do is to squash to 1 commit</p>



<a name="165933889"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/189812-t-compiler/wg-rfc-2229/topic/test%20failures/near/165933889" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://rust-lang.github.io/zulip_archive/stream/189812-t-compiler/wg-rfc-2229/topic/test.20failures.html#165933889">(May 17 2019 at 20:28)</a>:</h4>
<p>and then maybe, just before opening the PR, try to break that 1 commit into steps if I can</p>



<a name="165933894"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/189812-t-compiler/wg-rfc-2229/topic/test%20failures/near/165933894" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://rust-lang.github.io/zulip_archive/stream/189812-t-compiler/wg-rfc-2229/topic/test.20failures.html#165933894">(May 17 2019 at 20:29)</a>:</h4>
<p>really it doesn't matter <em>that</em> much in this case</p>



<a name="165934023"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/189812-t-compiler/wg-rfc-2229/topic/test%20failures/near/165934023" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> blitzerr <a href="https://rust-lang.github.io/zulip_archive/stream/189812-t-compiler/wg-rfc-2229/topic/test.20failures.html#165934023">(May 17 2019 at 20:30)</a>:</h4>
<p>The changes here were/are revising each other a lot <span aria-label="slight smile" class="emoji emoji-1f642" role="img" title="slight smile">:slight_smile:</span></p>



<a name="165934047"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/189812-t-compiler/wg-rfc-2229/topic/test%20failures/near/165934047" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> blitzerr <a href="https://rust-lang.github.io/zulip_archive/stream/189812-t-compiler/wg-rfc-2229/topic/test.20failures.html#165934047">(May 17 2019 at 20:31)</a>:</h4>
<p>Sounds good.</p>



<a name="165934145"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/189812-t-compiler/wg-rfc-2229/topic/test%20failures/near/165934145" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> blitzerr <a href="https://rust-lang.github.io/zulip_archive/stream/189812-t-compiler/wg-rfc-2229/topic/test.20failures.html#165934145">(May 17 2019 at 20:32)</a>:</h4>
<p><span class="user-mention" data-user-id="116009">@nikomatsakis</span>  Let me know which branch you end up pushing and I will take them all and create one PR. If you have some idea for the remaining 9 that you would like me to explore, let me know.</p>



<a name="165934217"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/189812-t-compiler/wg-rfc-2229/topic/test%20failures/near/165934217" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://rust-lang.github.io/zulip_archive/stream/189812-t-compiler/wg-rfc-2229/topic/test.20failures.html#165934217">(May 17 2019 at 20:33)</a>:</h4>
<p><span class="user-mention" data-user-id="128294">@blitzerr</span> for now I just pushed to upvar-tys-squashed on nikomatsakis/rust</p>



<a name="165934221"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/189812-t-compiler/wg-rfc-2229/topic/test%20failures/near/165934221" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://rust-lang.github.io/zulip_archive/stream/189812-t-compiler/wg-rfc-2229/topic/test.20failures.html#165934221">(May 17 2019 at 20:33)</a>:</h4>
<p>those 9 failures are here:</p>



<a name="165934281"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/189812-t-compiler/wg-rfc-2229/topic/test%20failures/near/165934281" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://rust-lang.github.io/zulip_archive/stream/189812-t-compiler/wg-rfc-2229/topic/test.20failures.html#165934281">(May 17 2019 at 20:34)</a>:</h4>
<div class="codehilite"><pre><span></span>modified   src/test/ui/closures/closure-move-sync.stderr
<span class="gu">@@ -6,7 +6,7 @@ LL |     let t = thread::spawn(|| {</span>
    |
    = help: the trait `std::marker::Sync` is not implemented for `std::sync::mpsc::Receiver&lt;()&gt;`
    = note: required because of the requirements on the impl of `std::marker::Send` for `&amp;std::sync::mpsc::Receiver&lt;()&gt;`
<span class="gd">-   = note: required because it appears within the type `[closure@$DIR/closure-move-sync.rs:6:27: 9:6 recv:&amp;std::sync::mpsc::Receiver&lt;()&gt;]`</span>
<span class="gi">+   = note: required because it appears within the type `(&amp;std::sync::mpsc::Receiver&lt;()&gt;,)`</span>
    = note: required by `std::thread::spawn`

 error[E0277]: `std::sync::mpsc::Sender&lt;()&gt;` cannot be shared between threads safely
<span class="gu">@@ -17,7 +17,7 @@ LL |     thread::spawn(|| tx.send(()).unwrap());</span>
    |
    = help: the trait `std::marker::Sync` is not implemented for `std::sync::mpsc::Sender&lt;()&gt;`
    = note: required because of the requirements on the impl of `std::marker::Send` for `&amp;std::sync::mpsc::Sender&lt;()&gt;`
<span class="gd">-   = note: required because it appears within the type `[closure@$DIR/closure-move-sync.rs:18:19: 18:42 tx:&amp;std::sync::mpsc::Sender&lt;()&gt;]`</span>
<span class="gi">+   = note: required because it appears within the type `(&amp;std::sync::mpsc::Sender&lt;()&gt;,)`</span>
    = note: required by `std::thread::spawn`

 error: aborting due to 2 previous errors
</pre></div>



<a name="165934285"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/189812-t-compiler/wg-rfc-2229/topic/test%20failures/near/165934285" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://rust-lang.github.io/zulip_archive/stream/189812-t-compiler/wg-rfc-2229/topic/test.20failures.html#165934285">(May 17 2019 at 20:34)</a>:</h4>
<p>that's an example</p>



<a name="165934291"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/189812-t-compiler/wg-rfc-2229/topic/test%20failures/near/165934291" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://rust-lang.github.io/zulip_archive/stream/189812-t-compiler/wg-rfc-2229/topic/test.20failures.html#165934291">(May 17 2019 at 20:34)</a>:</h4>
<p>I think what is happening is that the "causal chain" is getting messed up</p>



<a name="165934299"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/189812-t-compiler/wg-rfc-2229/topic/test%20failures/near/165934299" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://rust-lang.github.io/zulip_archive/stream/189812-t-compiler/wg-rfc-2229/topic/test.20failures.html#165934299">(May 17 2019 at 20:34)</a>:</h4>
<p>in particular, before you inserted those booleans, we used to have a chain like:</p>



<a name="165934315"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/189812-t-compiler/wg-rfc-2229/topic/test%20failures/near/165934315" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://rust-lang.github.io/zulip_archive/stream/189812-t-compiler/wg-rfc-2229/topic/test.20failures.html#165934315">(May 17 2019 at 20:35)</a>:</h4>
<ul>
<li>closure type with upvar tuple (U1, U2, .. Un)</li>
<li>upvar tuple type</li>
<li>Ui for some i</li>
</ul>



<a name="165934352"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/189812-t-compiler/wg-rfc-2229/topic/test%20failures/near/165934352" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://rust-lang.github.io/zulip_archive/stream/189812-t-compiler/wg-rfc-2229/topic/test.20failures.html#165934352">(May 17 2019 at 20:35)</a>:</h4>
<p>I think that, at least sometimes, we are now getting</p>
<ul>
<li>upvar tuple type</li>
<li>Ui for some i</li>
</ul>
<p>and losing the closure type</p>



<a name="165934354"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/189812-t-compiler/wg-rfc-2229/topic/test%20failures/near/165934354" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://rust-lang.github.io/zulip_archive/stream/189812-t-compiler/wg-rfc-2229/topic/test.20failures.html#165934354">(May 17 2019 at 20:35)</a>:</h4>
<p>I don't quite understand why</p>



<a name="165934428"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/189812-t-compiler/wg-rfc-2229/topic/test%20failures/near/165934428" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://rust-lang.github.io/zulip_archive/stream/189812-t-compiler/wg-rfc-2229/topic/test.20failures.html#165934428">(May 17 2019 at 20:36)</a>:</h4>
<p>I can maybe poke at a bit more, but if I had to guess, I would guess that some code in <a href="http://select.rs" target="_blank" title="http://select.rs">select.rs</a> is taking the "self type",  idk</p>



<a name="165934462"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/189812-t-compiler/wg-rfc-2229/topic/test%20failures/near/165934462" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://rust-lang.github.io/zulip_archive/stream/189812-t-compiler/wg-rfc-2229/topic/test.20failures.html#165934462">(May 17 2019 at 20:36)</a>:</h4>
<p>er, sorry, building a chain from the self type (which is a tuple)</p>



<a name="165934470"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/189812-t-compiler/wg-rfc-2229/topic/test%20failures/near/165934470" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> blitzerr <a href="https://rust-lang.github.io/zulip_archive/stream/189812-t-compiler/wg-rfc-2229/topic/test.20failures.html#165934470">(May 17 2019 at 20:36)</a>:</h4>
<p>I see.</p>



<a name="165934620"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/189812-t-compiler/wg-rfc-2229/topic/test%20failures/near/165934620" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://rust-lang.github.io/zulip_archive/stream/189812-t-compiler/wg-rfc-2229/topic/test.20failures.html#165934620">(May 17 2019 at 20:38)</a>:</h4>
<p>there is one failure that doesn't fit that template</p>



<a name="165934625"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/189812-t-compiler/wg-rfc-2229/topic/test%20failures/near/165934625" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://rust-lang.github.io/zulip_archive/stream/189812-t-compiler/wg-rfc-2229/topic/test.20failures.html#165934625">(May 17 2019 at 20:38)</a>:</h4>
<div class="codehilite"><pre><span></span>modified   src/test/ui/mismatched_types/issue-36053-2.stderr
<span class="gu">@@ -1,3 +1,11 @@</span>
<span class="gi">+error[E0631]: type mismatch in closure arguments</span>
<span class="gi">+  --&gt; $DIR/issue-36053-2.rs:7:32</span>
<span class="gi">+   |</span>
<span class="gi">+LL |     once::&lt;&amp;str&gt;(&quot;str&quot;).fuse().filter(|a: &amp;str| true).count();</span>
<span class="gi">+   |                                ^^^^^^ -------------- found signature of `for&lt;&#39;r&gt; fn(&amp;&#39;r str) -&gt; _`</span>
<span class="gi">+   |                                |</span>
<span class="gi">+   |                                expected signature of `for&lt;&#39;r&gt; fn(&amp;&#39;r &amp;str) -&gt; _`</span>
<span class="gi">+</span>
 error[E0599]: no method named `count` found for type `std::iter::Filter&lt;std::iter::Fuse&lt;std::iter::Once&lt;&amp;str&gt;&gt;, [closure@$DIR/issue-36053-2.rs:7:39: 7:53]&gt;` in the current scope
   --&gt; $DIR/issue-36053-2.rs:7:55
    |
<span class="gu">@@ -8,14 +16,6 @@ LL |     once::&lt;&amp;str&gt;(&quot;str&quot;).fuse().filter(|a: &amp;str| true).count();</span>
            `&amp;mut std::iter::Filter&lt;std::iter::Fuse&lt;std::iter::Once&lt;&amp;str&gt;&gt;, [closure@$DIR/issue-36053-2.rs:7:39: 7:53]&gt; : std::iter::Iterator`
            `std::iter::Filter&lt;std::iter::Fuse&lt;std::iter::Once&lt;&amp;str&gt;&gt;, [closure@$DIR/issue-36053-2.rs:7:39: 7:53]&gt; : std::iter::Iterator`

<span class="gd">-error[E0631]: type mismatch in closure arguments</span>
<span class="gd">-  --&gt; $DIR/issue-36053-2.rs:7:32</span>
<span class="gd">-   |</span>
<span class="gd">-LL |     once::&lt;&amp;str&gt;(&quot;str&quot;).fuse().filter(|a: &amp;str| true).count();</span>
<span class="gd">-   |                                ^^^^^^ -------------- found signature of `for&lt;&#39;r&gt; fn(&amp;&#39;r str) -&gt; _`</span>
<span class="gd">-   |                                |</span>
<span class="gd">-   |                                expected signature of `for&lt;&#39;r&gt; fn(&amp;&#39;r &amp;str) -&gt; _`</span>
<span class="gd">-</span>
 error: aborting due to 2 previous errors

 Some errors occurred: E0599, E0631.
</pre></div>



<a name="165934631"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/189812-t-compiler/wg-rfc-2229/topic/test%20failures/near/165934631" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://rust-lang.github.io/zulip_archive/stream/189812-t-compiler/wg-rfc-2229/topic/test.20failures.html#165934631">(May 17 2019 at 20:38)</a>:</h4>
<p>no idewhat's going on there</p>



<a name="165934654"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/189812-t-compiler/wg-rfc-2229/topic/test%20failures/near/165934654" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://rust-lang.github.io/zulip_archive/stream/189812-t-compiler/wg-rfc-2229/topic/test.20failures.html#165934654">(May 17 2019 at 20:38)</a>:</h4>
<p>oh, I guess just the <em>ordering</em> of the errors changed</p>



<a name="165934660"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/189812-t-compiler/wg-rfc-2229/topic/test%20failures/near/165934660" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://rust-lang.github.io/zulip_archive/stream/189812-t-compiler/wg-rfc-2229/topic/test.20failures.html#165934660">(May 17 2019 at 20:38)</a>:</h4>
<p>that's probably a non-issue</p>



<a name="165934817"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/189812-t-compiler/wg-rfc-2229/topic/test%20failures/near/165934817" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> blitzerr <a href="https://rust-lang.github.io/zulip_archive/stream/189812-t-compiler/wg-rfc-2229/topic/test.20failures.html#165934817">(May 17 2019 at 20:40)</a>:</h4>
<p>The read and the green looks exactly the same.</p>



<a name="165934819"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/189812-t-compiler/wg-rfc-2229/topic/test%20failures/near/165934819" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> blitzerr <a href="https://rust-lang.github.io/zulip_archive/stream/189812-t-compiler/wg-rfc-2229/topic/test.20failures.html#165934819">(May 17 2019 at 20:40)</a>:</h4>
<p>*red</p>



<a name="165934849"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/189812-t-compiler/wg-rfc-2229/topic/test%20failures/near/165934849" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> blitzerr <a href="https://rust-lang.github.io/zulip_archive/stream/189812-t-compiler/wg-rfc-2229/topic/test.20failures.html#165934849">(May 17 2019 at 20:41)</a>:</h4>
<p>So, looks like we re-ordered the error messages</p>



<a name="165935682"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/189812-t-compiler/wg-rfc-2229/topic/test%20failures/near/165935682" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://rust-lang.github.io/zulip_archive/stream/189812-t-compiler/wg-rfc-2229/topic/test.20failures.html#165935682">(May 17 2019 at 20:51)</a>:</h4>
<p>yeah I think that test is probably fine</p>



<a name="165935684"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/189812-t-compiler/wg-rfc-2229/topic/test%20failures/near/165935684" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://rust-lang.github.io/zulip_archive/stream/189812-t-compiler/wg-rfc-2229/topic/test.20failures.html#165935684">(May 17 2019 at 20:51)</a>:</h4>
<p>so that leaves the other 8</p>



<a name="165935834"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/189812-t-compiler/wg-rfc-2229/topic/test%20failures/near/165935834" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> blitzerr <a href="https://rust-lang.github.io/zulip_archive/stream/189812-t-compiler/wg-rfc-2229/topic/test.20failures.html#165935834">(May 17 2019 at 20:53)</a>:</h4>
<p>Okay, that a great reduction in numbers. Thank a lot</p>



<a name="167321096"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/189812-t-compiler/wg-rfc-2229/topic/test%20failures/near/167321096" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://rust-lang.github.io/zulip_archive/stream/189812-t-compiler/wg-rfc-2229/topic/test.20failures.html#167321096">(Jun 04 2019 at 18:11)</a>:</h4>
<p>so we're down to 8</p>



<a name="167321101"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/189812-t-compiler/wg-rfc-2229/topic/test%20failures/near/167321101" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://rust-lang.github.io/zulip_archive/stream/189812-t-compiler/wg-rfc-2229/topic/test.20failures.html#167321101">(Jun 04 2019 at 18:11)</a>:</h4>
<p>the question is</p>



<a name="167321107"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/189812-t-compiler/wg-rfc-2229/topic/test%20failures/near/167321107" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://rust-lang.github.io/zulip_archive/stream/189812-t-compiler/wg-rfc-2229/topic/test.20failures.html#167321107">(Jun 04 2019 at 18:11)</a>:</h4>
<p>should we try to fix those first</p>



<a name="167321112"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/189812-t-compiler/wg-rfc-2229/topic/test%20failures/near/167321112" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://rust-lang.github.io/zulip_archive/stream/189812-t-compiler/wg-rfc-2229/topic/test.20failures.html#167321112">(Jun 04 2019 at 18:11)</a>:</h4>
<p>or rebase first :)</p>



<a name="167321133"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/189812-t-compiler/wg-rfc-2229/topic/test%20failures/near/167321133" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://rust-lang.github.io/zulip_archive/stream/189812-t-compiler/wg-rfc-2229/topic/test.20failures.html#167321133">(Jun 04 2019 at 18:11)</a>:</h4>
<p>were you able to investigate at all?</p>



<a name="167321208"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/189812-t-compiler/wg-rfc-2229/topic/test%20failures/near/167321208" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://rust-lang.github.io/zulip_archive/stream/189812-t-compiler/wg-rfc-2229/topic/test.20failures.html#167321208">(Jun 04 2019 at 18:12)</a>:</h4>
<p>the errors I am seeing all seem to be that the closure type</p>



<a name="167321230"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/189812-t-compiler/wg-rfc-2229/topic/test%20failures/near/167321230" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://rust-lang.github.io/zulip_archive/stream/189812-t-compiler/wg-rfc-2229/topic/test.20failures.html#167321230">(Jun 04 2019 at 18:12)</a>:</h4>
<p>is replaced with a tuple</p>



<a name="167321246"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/189812-t-compiler/wg-rfc-2229/topic/test%20failures/near/167321246" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://rust-lang.github.io/zulip_archive/stream/189812-t-compiler/wg-rfc-2229/topic/test.20failures.html#167321246">(Jun 04 2019 at 18:12)</a>:</h4>
<div class="codehilite"><pre><span></span>modified   src/test/ui/closures/closure-move-sync.stderr
<span class="gu">@@ -6,7 +6,7 @@ LL |     let t = thread::spawn(|| {</span>
    |
    = help: the trait `std::marker::Sync` is not implemented for `std::sync::mpsc::Receiver&lt;()&gt;`
    = note: required because of the requirements on the impl of `std::marker::Send` for `&amp;std::sync::mpsc::Receiver&lt;()&gt;`
<span class="gd">-   = note: required because it appears within the type `[closure@$DIR/closure-move-sync.rs:6:27: 9:6 recv:&amp;std::sync::mpsc::Receiver&lt;()&gt;]`</span>
<span class="gi">+   = note: required because it appears within the type `(&amp;std::sync::mpsc::Receiver&lt;()&gt;,)`</span>
    = note: required by `std::thread::spawn`

 error[E0277]: `std::sync::mpsc::Sender&lt;()&gt;` cannot be shared between threads safely
<span class="gu">@@ -17,7 +17,7 @@ LL |     thread::spawn(|| tx.send(()).unwrap());</span>
    |
    = help: the trait `std::marker::Sync` is not implemented for `std::sync::mpsc::Sender&lt;()&gt;`
    = note: required because of the requirements on the impl of `std::marker::Send` for `&amp;std::sync::mpsc::Sender&lt;()&gt;`
<span class="gd">-   = note: required because it appears within the type `[closure@$DIR/closure-move-sync.rs:18:19: 18:42 tx:&amp;std::sync::mpsc::Sender&lt;()&gt;]`</span>
<span class="gi">+   = note: required because it appears within the type `(&amp;std::sync::mpsc::Sender&lt;()&gt;,)`</span>
    = note: required by `std::thread::spawn`

 error: aborting due to 2 previous errors
</pre></div>



<a name="167321250"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/189812-t-compiler/wg-rfc-2229/topic/test%20failures/near/167321250" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://rust-lang.github.io/zulip_archive/stream/189812-t-compiler/wg-rfc-2229/topic/test.20failures.html#167321250">(Jun 04 2019 at 18:12)</a>:</h4>
<p>stuff like that</p>



<a name="167321252"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/189812-t-compiler/wg-rfc-2229/topic/test%20failures/near/167321252" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://rust-lang.github.io/zulip_archive/stream/189812-t-compiler/wg-rfc-2229/topic/test.20failures.html#167321252">(Jun 04 2019 at 18:12)</a>:</h4>
<p>seems pretty specific</p>



<a name="167321264"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/189812-t-compiler/wg-rfc-2229/topic/test%20failures/near/167321264" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> blitzerr <a href="https://rust-lang.github.io/zulip_archive/stream/189812-t-compiler/wg-rfc-2229/topic/test.20failures.html#167321264">(Jun 04 2019 at 18:12)</a>:</h4>
<p>Maybe fixing them first might be good idea then we know that the code is perfect based of off one commit.</p>



<a name="167321280"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/189812-t-compiler/wg-rfc-2229/topic/test%20failures/near/167321280" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://rust-lang.github.io/zulip_archive/stream/189812-t-compiler/wg-rfc-2229/topic/test.20failures.html#167321280">(Jun 04 2019 at 18:12)</a>:</h4>
<p>yeah, can't hurt</p>



<a name="167321327"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/189812-t-compiler/wg-rfc-2229/topic/test%20failures/near/167321327" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> blitzerr <a href="https://rust-lang.github.io/zulip_archive/stream/189812-t-compiler/wg-rfc-2229/topic/test.20failures.html#167321327">(Jun 04 2019 at 18:12)</a>:</h4>
<p>Any failures after that are merge related issues.</p>



<a name="167321337"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/189812-t-compiler/wg-rfc-2229/topic/test%20failures/near/167321337" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> blitzerr <a href="https://rust-lang.github.io/zulip_archive/stream/189812-t-compiler/wg-rfc-2229/topic/test.20failures.html#167321337">(Jun 04 2019 at 18:13)</a>:</h4>
<p>My two cents</p>



<a name="167321765"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/189812-t-compiler/wg-rfc-2229/topic/test%20failures/near/167321765" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://rust-lang.github.io/zulip_archive/stream/189812-t-compiler/wg-rfc-2229/topic/test.20failures.html#167321765">(Jun 04 2019 at 18:16)</a>:</h4>
<p>ok well I inserted some debug!</p>



<a name="167321770"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/189812-t-compiler/wg-rfc-2229/topic/test%20failures/near/167321770" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://rust-lang.github.io/zulip_archive/stream/189812-t-compiler/wg-rfc-2229/topic/test.20failures.html#167321770">(Jun 04 2019 at 18:16)</a>:</h4>
<p>I'm going to try and take a look at this in the background as I do other things</p>



<a name="167321853"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/189812-t-compiler/wg-rfc-2229/topic/test%20failures/near/167321853" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> blitzerr <a href="https://rust-lang.github.io/zulip_archive/stream/189812-t-compiler/wg-rfc-2229/topic/test.20failures.html#167321853">(Jun 04 2019 at 18:17)</a>:</h4>
<p>So assuming that merge is all that is left, which I plan to finish this week if we get all the tests fixed, what should be the next steps ?</p>



<a name="167322648"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/189812-t-compiler/wg-rfc-2229/topic/test%20failures/near/167322648" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://rust-lang.github.io/zulip_archive/stream/189812-t-compiler/wg-rfc-2229/topic/test.20failures.html#167322648">(Jun 04 2019 at 18:24)</a>:</h4>
<p>not sure, let's re-evaluate then</p>



<a name="167322674"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/189812-t-compiler/wg-rfc-2229/topic/test%20failures/near/167322674" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://rust-lang.github.io/zulip_archive/stream/189812-t-compiler/wg-rfc-2229/topic/test.20failures.html#167322674">(Jun 04 2019 at 18:25)</a>:</h4>
<p>I think the freevars refactorings are still needed</p>



<a name="167322681"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/189812-t-compiler/wg-rfc-2229/topic/test%20failures/near/167322681" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://rust-lang.github.io/zulip_archive/stream/189812-t-compiler/wg-rfc-2229/topic/test.20failures.html#167322681">(Jun 04 2019 at 18:25)</a>:</h4>
<p>I haven't quite figured out the impact of <span class="user-mention" data-user-id="119009">@eddyb</span>'s changes though</p>



<a name="167322745"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/189812-t-compiler/wg-rfc-2229/topic/test%20failures/near/167322745" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> blitzerr <a href="https://rust-lang.github.io/zulip_archive/stream/189812-t-compiler/wg-rfc-2229/topic/test.20failures.html#167322745">(Jun 04 2019 at 18:25)</a>:</h4>
<p><span class="user-mention" data-user-id="116773">@csmoe</span>  was working on that.</p>



<a name="167323050"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/189812-t-compiler/wg-rfc-2229/topic/test%20failures/near/167323050" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://rust-lang.github.io/zulip_archive/stream/189812-t-compiler/wg-rfc-2229/topic/test.20failures.html#167323050">(Jun 04 2019 at 18:28)</a>:</h4>
<p>well I think I see the bug, basically the change I suggested is kind of flawed</p>



<a name="167323144"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/189812-t-compiler/wg-rfc-2229/topic/test%20failures/near/167323144" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://rust-lang.github.io/zulip_archive/stream/189812-t-compiler/wg-rfc-2229/topic/test.20failures.html#167323144">(Jun 04 2019 at 18:29)</a>:</h4>
<p>specifically this idea:</p>
<div class="codehilite"><pre><span></span><span class="w">            </span><span class="kd">let</span><span class="w"> </span><span class="n">cause</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="o">!</span><span class="n">is_closure_tuple</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">                </span><span class="n">obligation</span><span class="p">.</span><span class="n">derived_cause</span><span class="p">(</span><span class="n">BuiltinDerivedObligation</span><span class="p">)</span><span class="w"></span>
<span class="w">            </span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">                </span><span class="n">obligation</span><span class="p">.</span><span class="n">cause</span><span class="p">.</span><span class="n">clone</span><span class="p">()</span><span class="w"></span>
<span class="w">            </span><span class="p">};</span><span class="w"></span>
</pre></div>



<a name="167323159"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/189812-t-compiler/wg-rfc-2229/topic/test%20failures/near/167323159" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://rust-lang.github.io/zulip_archive/stream/189812-t-compiler/wg-rfc-2229/topic/test.20failures.html#167323159">(Jun 04 2019 at 18:30)</a>:</h4>
<p>doesn't work out because of what <code>derived_cause</code> does</p>



<a name="167323252"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/189812-t-compiler/wg-rfc-2229/topic/test%20failures/near/167323252" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://rust-lang.github.io/zulip_archive/stream/189812-t-compiler/wg-rfc-2229/topic/test.20failures.html#167323252">(Jun 04 2019 at 18:30)</a>:</h4>
<p>the idea was that we have a complete chain that looks like</p>
<ul>
<li>closure</li>
<li>upvar tuple</li>
<li>upvar type</li>
</ul>



<a name="167323261"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/189812-t-compiler/wg-rfc-2229/topic/test%20failures/near/167323261" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://rust-lang.github.io/zulip_archive/stream/189812-t-compiler/wg-rfc-2229/topic/test.20failures.html#167323261">(Jun 04 2019 at 18:30)</a>:</h4>
<p>and we want to remove the "upvar tuple" from the chain</p>



<a name="167323307"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/189812-t-compiler/wg-rfc-2229/topic/test%20failures/near/167323307" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://rust-lang.github.io/zulip_archive/stream/189812-t-compiler/wg-rfc-2229/topic/test.20failures.html#167323307">(Jun 04 2019 at 18:31)</a>:</h4>
<p>ah hmm</p>



<a name="167323454"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/189812-t-compiler/wg-rfc-2229/topic/test%20failures/near/167323454" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://rust-lang.github.io/zulip_archive/stream/189812-t-compiler/wg-rfc-2229/topic/test.20failures.html#167323454">(Jun 04 2019 at 18:32)</a>:</h4>
<p>so basically if you walk through the fix I suggested it winds up creating the wrong chain</p>



<a name="167323468"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/189812-t-compiler/wg-rfc-2229/topic/test%20failures/near/167323468" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://rust-lang.github.io/zulip_archive/stream/189812-t-compiler/wg-rfc-2229/topic/test.20failures.html#167323468">(Jun 04 2019 at 18:32)</a>:</h4>
<p>I think a better fix might be something like this:</p>



<a name="167325036"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/189812-t-compiler/wg-rfc-2229/topic/test%20failures/near/167325036" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://rust-lang.github.io/zulip_archive/stream/189812-t-compiler/wg-rfc-2229/topic/test.20failures.html#167325036">(Jun 04 2019 at 18:49)</a>:</h4>
<p>(sorry, had to do a quick meeting)</p>



<a name="167325048"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/189812-t-compiler/wg-rfc-2229/topic/test%20failures/near/167325048" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://rust-lang.github.io/zulip_archive/stream/189812-t-compiler/wg-rfc-2229/topic/test.20failures.html#167325048">(Jun 04 2019 at 18:49)</a>:</h4>
<p>introduce a new variant <code>ObligationCauseCode::HiddenDerivedObligation</code></p>



<a name="167325070"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/189812-t-compiler/wg-rfc-2229/topic/test%20failures/near/167325070" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://rust-lang.github.io/zulip_archive/stream/189812-t-compiler/wg-rfc-2229/topic/test.20failures.html#167325070">(Jun 04 2019 at 18:49)</a>:</h4>
<p>and then have the code above be like</p>
<div class="codehilite"><pre><span></span><span class="w"> </span><span class="kd">let</span><span class="w"> </span><span class="n">cause</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="o">!</span><span class="n">is_closure_tuple</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">                </span><span class="n">obligation</span><span class="p">.</span><span class="n">derived_cause</span><span class="p">(</span><span class="n">BuiltinDerivedObligation</span><span class="p">)</span><span class="w"></span>
<span class="w">            </span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">                </span><span class="n">obligation</span><span class="p">.</span><span class="n">derived_cause</span><span class="p">(</span><span class="n">HiddenDerivedObligation</span><span class="p">)</span><span class="w"></span>
<span class="w">            </span><span class="p">};</span><span class="w"></span>
</pre></div>



<a name="167325219"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/189812-t-compiler/wg-rfc-2229/topic/test%20failures/near/167325219" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://rust-lang.github.io/zulip_archive/stream/189812-t-compiler/wg-rfc-2229/topic/test.20failures.html#167325219">(Jun 04 2019 at 18:51)</a>:</h4>
<p>and then modify <a href="https://github.com/rust-lang/rust/blob/acda261de83475cf6cbc607d570153bb864ee7be/src/librustc/traits/error_reporting.rs#L1622-L1635" target="_blank" title="https://github.com/rust-lang/rust/blob/acda261de83475cf6cbc607d570153bb864ee7be/src/librustc/traits/error_reporting.rs#L1622-L1635">this code here</a> to make a <code>HiddenDerivedObligation</code> just recurse to its parents and print nothing</p>



<a name="167325241"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/189812-t-compiler/wg-rfc-2229/topic/test%20failures/near/167325241" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://rust-lang.github.io/zulip_archive/stream/189812-t-compiler/wg-rfc-2229/topic/test.20failures.html#167325241">(Jun 04 2019 at 18:51)</a>:</h4>
<p><span class="user-mention" data-user-id="128294">@blitzerr</span> does that <span aria-label="point up" class="emoji emoji-1f446" role="img" title="point up">:point_up:</span> look like something you'd be game to try?</p>



<a name="167329069"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/189812-t-compiler/wg-rfc-2229/topic/test%20failures/near/167329069" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> blitzerr <a href="https://rust-lang.github.io/zulip_archive/stream/189812-t-compiler/wg-rfc-2229/topic/test.20failures.html#167329069">(Jun 04 2019 at 19:37)</a>:</h4>
<p>Sounds good <span class="user-mention" data-user-id="116009">@nikomatsakis</span> . Will give that a shot. Thanks for looking into it and suggesting the fix.</p>



<a name="167667325"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/189812-t-compiler/wg-rfc-2229/topic/test%20failures/near/167667325" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> blitzerr <a href="https://rust-lang.github.io/zulip_archive/stream/189812-t-compiler/wg-rfc-2229/topic/test.20failures.html#167667325">(Jun 08 2019 at 20:55)</a>:</h4>
<p><span class="user-mention" data-user-id="116009">@nikomatsakis</span> <br>
I made the change you <a href="https://github.com/blitzerr/rust/commit/d728f1f1584fe933dd6eb8f95bcb95729e736478#diff-0e12890ad498e250783f40f88a8b8ec6R1562" target="_blank" title="https://github.com/blitzerr/rust/commit/d728f1f1584fe933dd6eb8f95bcb95729e736478#diff-0e12890ad498e250783f40f88a8b8ec6R1562">suggested</a>. But the problem is not solved.</p>



<a name="167667539"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/189812-t-compiler/wg-rfc-2229/topic/test%20failures/near/167667539" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> blitzerr <a href="https://rust-lang.github.io/zulip_archive/stream/189812-t-compiler/wg-rfc-2229/topic/test.20failures.html#167667539">(Jun 08 2019 at 21:00)</a>:</h4>
<p>Changes are <a href="https://github.com/blitzerr/rust/commits/upvar-tys-squashed" target="_blank" title="https://github.com/blitzerr/rust/commits/upvar-tys-squashed">here</a>. What you said makes complete sense but recursing there is not giving us what we want.  It still generates the note as stated by <a href="https://github.com/blitzerr/rust/commit/d728f1f1584fe933dd6eb8f95bcb95729e736478#diff-0e12890ad498e250783f40f88a8b8ec6R1551" target="_blank" title="https://github.com/blitzerr/rust/commit/d728f1f1584fe933dd6eb8f95bcb95729e736478#diff-0e12890ad498e250783f40f88a8b8ec6R1551">this line</a>. Would if make sense to check for type <a href="https://github.com/blitzerr/rust/commit/d728f1f1584fe933dd6eb8f95bcb95729e736478#diff-0e12890ad498e250783f40f88a8b8ec6L1550" target="_blank" title="https://github.com/blitzerr/rust/commit/d728f1f1584fe933dd6eb8f95bcb95729e736478#diff-0e12890ad498e250783f40f88a8b8ec6L1550">here</a> and then skip the err.note if it is upvar_tuple ? Its definitely not elegant.</p>



<a name="167798197"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/189812-t-compiler/wg-rfc-2229/topic/test%20failures/near/167798197" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://rust-lang.github.io/zulip_archive/stream/189812-t-compiler/wg-rfc-2229/topic/test.20failures.html#167798197">(Jun 10 2019 at 21:28)</a>:</h4>
<p><span class="user-mention" data-user-id="128294">@blitzerr</span> I think you have to modify <a href="https://github.com/blitzerr/rust/blob/d728f1f1584fe933dd6eb8f95bcb95729e736478/src/librustc/traits/select.rs#L2832" target="_blank" title="https://github.com/blitzerr/rust/blob/d728f1f1584fe933dd6eb8f95bcb95729e736478/src/librustc/traits/select.rs#L2832">these lines</a> in the same way. From:</p>
<div class="codehilite"><pre><span></span><span class="w">        </span><span class="kd">let</span><span class="w"> </span><span class="n">cause</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="o">!</span><span class="n">is_upvar_tuple_ty</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">            </span><span class="n">obligation</span><span class="p">.</span><span class="n">derived_cause</span><span class="p">(</span><span class="n">BuiltinDerivedObligation</span><span class="p">)</span><span class="w"></span>
<span class="w">        </span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">            </span><span class="n">obligation</span><span class="p">.</span><span class="n">cause</span><span class="p">.</span><span class="n">clone</span><span class="p">()</span><span class="w"></span>
<span class="p">};</span><span class="w"></span>
</pre></div>


<p>to</p>
<div class="codehilite"><pre><span></span><span class="w">        </span><span class="kd">let</span><span class="w"> </span><span class="n">cause</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="o">!</span><span class="n">is_upvar_tuple_ty</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">            </span><span class="n">obligation</span><span class="p">.</span><span class="n">derived_cause</span><span class="p">(</span><span class="n">BuiltinDerivedObligation</span><span class="p">)</span><span class="w"></span>
<span class="w">        </span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">            </span><span class="n">obligation</span><span class="p">.</span><span class="n">derived_cause</span><span class="p">(</span><span class="n">HiddenDerivedObligation</span><span class="p">)</span><span class="w"></span>
<span class="p">};</span><span class="w"></span>
</pre></div>


<p>also, we should probably rename the <code>is_upvar_tupel_ty</code> etc to <code>hide_derived_obligation</code> or something</p>



<a name="167815069"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/189812-t-compiler/wg-rfc-2229/topic/test%20failures/near/167815069" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> blitzerr <a href="https://rust-lang.github.io/zulip_archive/stream/189812-t-compiler/wg-rfc-2229/topic/test.20failures.html#167815069">(Jun 11 2019 at 03:08)</a>:</h4>
<div class="codehilite"><pre><span></span><span class="o">----</span><span class="w"> </span><span class="p">[</span><span class="n">ui</span><span class="p">]</span><span class="w"> </span><span class="n">ui</span><span class="o">/</span><span class="n">closures</span><span class="o">/</span><span class="n">closure</span><span class="o">-</span><span class="k">move</span><span class="o">-</span><span class="n">sync</span><span class="p">.</span><span class="n">rs</span><span class="w"> </span><span class="n">stdout</span><span class="w"> </span><span class="o">----</span><span class="w"></span>
<span class="n">diff</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">stderr</span>:

<span class="mi">6</span><span class="w">      </span><span class="o">|</span><span class="w"></span>
<span class="mi">7</span><span class="w">      </span><span class="o">=</span><span class="w"> </span><span class="n">help</span>: <span class="nc">the</span><span class="w"> </span><span class="k">trait</span><span class="w"> </span><span class="err">`</span><span class="n">std</span>::<span class="n">marker</span>::<span class="nb">Sync</span><span class="err">`</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">not</span><span class="w"> </span><span class="n">implemented</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="err">`</span><span class="n">std</span>::<span class="n">sync</span>::<span class="n">mpsc</span>::<span class="n">Receiver</span><span class="o">&lt;</span><span class="p">()</span><span class="o">&gt;</span><span class="err">`</span><span class="w"></span>
<span class="mi">8</span><span class="w">      </span><span class="o">=</span><span class="w"> </span><span class="n">note</span>: <span class="nc">required</span><span class="w"> </span><span class="n">because</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">requirements</span><span class="w"> </span><span class="n">on</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="k">impl</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="err">`</span><span class="n">std</span>::<span class="n">marker</span>::<span class="nb">Send</span><span class="err">`</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="err">`</span><span class="o">&amp;</span><span class="n">std</span>::<span class="n">sync</span>::<span class="n">mpsc</span>::<span class="n">Receiver</span><span class="o">&lt;</span><span class="p">()</span><span class="o">&gt;</span><span class="err">`</span><span class="w"></span>
<span class="o">-</span><span class="w">      </span><span class="o">=</span><span class="w"> </span><span class="n">note</span>: <span class="nc">required</span><span class="w"> </span><span class="n">because</span><span class="w"> </span><span class="n">it</span><span class="w"> </span><span class="n">appears</span><span class="w"> </span><span class="n">within</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="k">type</span> <span class="err">`</span><span class="p">[</span><span class="n">closure</span><span class="o">@</span><span class="cp">$DIR</span><span class="o">/</span><span class="n">closure</span><span class="o">-</span><span class="k">move</span><span class="o">-</span><span class="n">sync</span><span class="p">.</span><span class="n">rs</span>:<span class="mi">6</span>:<span class="mi">27</span>: <span class="mi">9</span>:<span class="mi">6</span><span class="w"> </span><span class="n">recv</span>:<span class="kp">&amp;</span><span class="nc">std</span>::<span class="n">sync</span>::<span class="n">mpsc</span>::<span class="n">Receiver</span><span class="o">&lt;</span><span class="p">()</span><span class="o">&gt;</span><span class="p">]</span><span class="err">`</span><span class="w"></span>
<span class="o">+</span><span class="w">      </span><span class="o">=</span><span class="w"> </span><span class="n">note</span>: <span class="nc">required</span><span class="w"> </span><span class="n">because</span><span class="w"> </span><span class="n">it</span><span class="w"> </span><span class="n">appears</span><span class="w"> </span><span class="n">within</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="k">type</span> <span class="err">`</span><span class="p">(</span><span class="o">&amp;</span><span class="n">std</span>::<span class="n">sync</span>::<span class="n">mpsc</span>::<span class="n">Receiver</span><span class="o">&lt;</span><span class="p">()</span><span class="o">&gt;</span><span class="p">,)</span><span class="err">`</span><span class="w"></span>
<span class="mi">10</span><span class="w">     </span><span class="o">=</span><span class="w"> </span><span class="n">note</span>: <span class="nc">required</span><span class="w"> </span><span class="n">by</span><span class="w"> </span><span class="err">`</span><span class="n">std</span>::<span class="n">thread</span>::<span class="n">spawn</span><span class="err">`</span><span class="w"></span>
<span class="mi">11</span><span class="w"></span>
<span class="mi">12</span><span class="w">  </span><span class="n">error</span><span class="p">[</span><span class="n">E0277</span><span class="p">]</span>: <span class="err">`</span><span class="n">std</span>::<span class="n">sync</span>::<span class="n">mpsc</span>::<span class="n">Sender</span><span class="o">&lt;</span><span class="p">()</span><span class="o">&gt;</span><span class="err">`</span><span class="w"> </span><span class="n">cannot</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">shared</span><span class="w"> </span><span class="n">between</span><span class="w"> </span><span class="n">threads</span><span class="w"> </span><span class="n">safely</span><span class="w"></span>

<span class="mi">17</span><span class="w">     </span><span class="o">|</span><span class="w"></span>
<span class="mi">18</span><span class="w">     </span><span class="o">=</span><span class="w"> </span><span class="n">help</span>: <span class="nc">the</span><span class="w"> </span><span class="k">trait</span><span class="w"> </span><span class="err">`</span><span class="n">std</span>::<span class="n">marker</span>::<span class="nb">Sync</span><span class="err">`</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">not</span><span class="w"> </span><span class="n">implemented</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="err">`</span><span class="n">std</span>::<span class="n">sync</span>::<span class="n">mpsc</span>::<span class="n">Sender</span><span class="o">&lt;</span><span class="p">()</span><span class="o">&gt;</span><span class="err">`</span><span class="w"></span>
<span class="mi">19</span><span class="w">     </span><span class="o">=</span><span class="w"> </span><span class="n">note</span>: <span class="nc">required</span><span class="w"> </span><span class="n">because</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">requirements</span><span class="w"> </span><span class="n">on</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="k">impl</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="err">`</span><span class="n">std</span>::<span class="n">marker</span>::<span class="nb">Send</span><span class="err">`</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="err">`</span><span class="o">&amp;</span><span class="n">std</span>::<span class="n">sync</span>::<span class="n">mpsc</span>::<span class="n">Sender</span><span class="o">&lt;</span><span class="p">()</span><span class="o">&gt;</span><span class="err">`</span><span class="w"></span>
<span class="o">-</span><span class="w">      </span><span class="o">=</span><span class="w"> </span><span class="n">note</span>: <span class="nc">required</span><span class="w"> </span><span class="n">because</span><span class="w"> </span><span class="n">it</span><span class="w"> </span><span class="n">appears</span><span class="w"> </span><span class="n">within</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="k">type</span> <span class="err">`</span><span class="p">[</span><span class="n">closure</span><span class="o">@</span><span class="cp">$DIR</span><span class="o">/</span><span class="n">closure</span><span class="o">-</span><span class="k">move</span><span class="o">-</span><span class="n">sync</span><span class="p">.</span><span class="n">rs</span>:<span class="mi">18</span>:<span class="mi">19</span>: <span class="mi">18</span>:<span class="mi">42</span><span class="w"> </span><span class="n">tx</span>:<span class="kp">&amp;</span><span class="nc">std</span>::<span class="n">sync</span>::<span class="n">mpsc</span>::<span class="n">Sender</span><span class="o">&lt;</span><span class="p">()</span><span class="o">&gt;</span><span class="p">]</span><span class="err">`</span><span class="w"></span>
<span class="o">+</span><span class="w">      </span><span class="o">=</span><span class="w"> </span><span class="n">note</span>: <span class="nc">required</span><span class="w"> </span><span class="n">because</span><span class="w"> </span><span class="n">it</span><span class="w"> </span><span class="n">appears</span><span class="w"> </span><span class="n">within</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="k">type</span> <span class="err">`</span><span class="p">(</span><span class="o">&amp;</span><span class="n">std</span>::<span class="n">sync</span>::<span class="n">mpsc</span>::<span class="n">Sender</span><span class="o">&lt;</span><span class="p">()</span><span class="o">&gt;</span><span class="p">,)</span><span class="err">`</span><span class="w"></span>
<span class="mi">21</span><span class="w">     </span><span class="o">=</span><span class="w"> </span><span class="n">note</span>: <span class="nc">required</span><span class="w"> </span><span class="n">by</span><span class="w"> </span><span class="err">`</span><span class="n">std</span>::<span class="n">thread</span>::<span class="n">spawn</span><span class="err">`</span><span class="w"></span>
<span class="mi">22</span><span class="w"></span>
<span class="mi">23</span><span class="w">  </span><span class="n">error</span>: <span class="nc">aborting</span><span class="w"> </span><span class="n">due</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="mi">2</span><span class="w"> </span><span class="n">previous</span><span class="w"> </span><span class="n">errors</span><span class="w"></span>
</pre></div>



<a name="167815088"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/189812-t-compiler/wg-rfc-2229/topic/test%20failures/near/167815088" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> blitzerr <a href="https://rust-lang.github.io/zulip_archive/stream/189812-t-compiler/wg-rfc-2229/topic/test.20failures.html#167815088">(Jun 11 2019 at 03:09)</a>:</h4>
<div class="codehilite"><pre><span></span><span class="o">---</span><span class="w"> </span><span class="n">a</span><span class="o">/</span><span class="n">src</span><span class="o">/</span><span class="n">librustc</span><span class="o">/</span><span class="n">traits</span><span class="o">/</span><span class="n">select</span><span class="p">.</span><span class="n">rs</span><span class="w"></span>
<span class="o">+++</span><span class="w"> </span><span class="n">b</span><span class="o">/</span><span class="n">src</span><span class="o">/</span><span class="n">librustc</span><span class="o">/</span><span class="n">traits</span><span class="o">/</span><span class="n">select</span><span class="p">.</span><span class="n">rs</span><span class="w"></span>
<span class="o">@@</span><span class="w"> </span><span class="o">-</span><span class="mi">2829</span><span class="p">,</span><span class="mi">10</span><span class="w"> </span><span class="o">+</span><span class="mi">2829</span><span class="p">,</span><span class="mi">10</span><span class="w"> </span><span class="o">@@</span><span class="w"> </span><span class="k">impl</span><span class="o">&lt;</span><span class="na">&#39;cx</span><span class="p">,</span><span class="w"> </span><span class="na">&#39;gcx</span><span class="p">,</span><span class="w"> </span><span class="na">&#39;tcx</span><span class="o">&gt;</span><span class="w"> </span><span class="n">SelectionContext</span><span class="o">&lt;</span><span class="na">&#39;cx</span><span class="p">,</span><span class="w"> </span><span class="na">&#39;gcx</span><span class="p">,</span><span class="w"> </span><span class="na">&#39;tcx</span><span class="o">&gt;</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">     </span><span class="p">)</span><span class="w"> </span>-&gt; <span class="nc">VtableAutoImplData</span><span class="o">&lt;</span><span class="n">PredicateObligation</span><span class="o">&lt;</span><span class="na">&#39;tcx</span><span class="o">&gt;&gt;</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">         </span><span class="n">debug</span><span class="o">!</span><span class="p">(</span><span class="s">&quot;vtable_auto_impl: nested={:?}&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">nested</span><span class="p">);</span><span class="w"></span>

<span class="o">-</span><span class="w">        </span><span class="kd">let</span><span class="w"> </span><span class="n">cause</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="o">!</span><span class="n">is_upvar_tuple_ty</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="o">-</span><span class="w">            </span><span class="n">obligation</span><span class="p">.</span><span class="n">derived_cause</span><span class="p">(</span><span class="n">BuiltinDerivedObligation</span><span class="p">)</span><span class="w"></span>
<span class="o">+</span><span class="w">        </span><span class="kd">let</span><span class="w"> </span><span class="n">cause</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">is_upvar_tuple_ty</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="o">+</span><span class="w">            </span><span class="n">obligation</span><span class="p">.</span><span class="n">derived_cause</span><span class="p">(</span><span class="n">HiddenDerivedObligation</span><span class="p">)</span><span class="w"></span>
<span class="w">         </span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="o">-</span><span class="w">            </span><span class="n">obligation</span><span class="p">.</span><span class="n">cause</span><span class="p">.</span><span class="n">clone</span><span class="p">()</span><span class="w"></span>
<span class="o">+</span><span class="w">            </span><span class="n">obligation</span><span class="p">.</span><span class="n">derived_cause</span><span class="p">(</span><span class="n">BuiltinDerivedObligation</span><span class="p">)</span><span class="w"></span>
<span class="w">         </span><span class="p">};</span><span class="w"></span>
<span class="w">         </span><span class="kd">let</span><span class="w"> </span><span class="k">mut</span><span class="w"> </span><span class="n">obligations</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="bp">self</span><span class="p">.</span><span class="n">collect_predicates_for_types</span><span class="p">(</span><span class="w"></span>
<span class="w">             </span><span class="n">obligation</span><span class="p">.</span><span class="n">param_env</span><span class="p">,</span><span class="w"></span>
</pre></div>



<a name="167815617"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/189812-t-compiler/wg-rfc-2229/topic/test%20failures/near/167815617" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> blitzerr <a href="https://rust-lang.github.io/zulip_archive/stream/189812-t-compiler/wg-rfc-2229/topic/test.20failures.html#167815617">(Jun 11 2019 at 03:20)</a>:</h4>
<p><span class="user-mention" data-user-id="116009">@nikomatsakis</span>  Unfortunately it does not fixes it.</p>



<a name="167872474"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/189812-t-compiler/wg-rfc-2229/topic/test%20failures/near/167872474" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://rust-lang.github.io/zulip_archive/stream/189812-t-compiler/wg-rfc-2229/topic/test.20failures.html#167872474">(Jun 11 2019 at 17:42)</a>:</h4>
<p><span class="user-mention" data-user-id="128294">@blitzerr</span> is this pushed to your branch?</p>



<a name="167872939"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/189812-t-compiler/wg-rfc-2229/topic/test%20failures/near/167872939" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> blitzerr <a href="https://rust-lang.github.io/zulip_archive/stream/189812-t-compiler/wg-rfc-2229/topic/test.20failures.html#167872939">(Jun 11 2019 at 17:48)</a>:</h4>
<p><span class="user-mention" data-user-id="116009">@nikomatsakis</span>  This last bit of change that you suggested yesterday is not pushed to my branch.</p>



<a name="167872966"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/189812-t-compiler/wg-rfc-2229/topic/test%20failures/near/167872966" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://rust-lang.github.io/zulip_archive/stream/189812-t-compiler/wg-rfc-2229/topic/test.20failures.html#167872966">(Jun 11 2019 at 17:49)</a>:</h4>
<p>can you push it?</p>



<a name="167872967"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/189812-t-compiler/wg-rfc-2229/topic/test%20failures/near/167872967" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> blitzerr <a href="https://rust-lang.github.io/zulip_archive/stream/189812-t-compiler/wg-rfc-2229/topic/test.20failures.html#167872967">(Jun 11 2019 at 17:49)</a>:</h4>
<p>But the things that I did over the weekend is.</p>



<a name="167873008"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/189812-t-compiler/wg-rfc-2229/topic/test%20failures/near/167873008" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> blitzerr <a href="https://rust-lang.github.io/zulip_archive/stream/189812-t-compiler/wg-rfc-2229/topic/test.20failures.html#167873008">(Jun 11 2019 at 17:50)</a>:</h4>
<p>Give me a few minutes. I will push it</p>



<a name="167874095"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/189812-t-compiler/wg-rfc-2229/topic/test%20failures/near/167874095" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> blitzerr <a href="https://rust-lang.github.io/zulip_archive/stream/189812-t-compiler/wg-rfc-2229/topic/test.20failures.html#167874095">(Jun 11 2019 at 18:01)</a>:</h4>
<p><span class="user-mention" data-user-id="116009">@nikomatsakis</span>  Its pushed to branch <code>upvar-tys-squashed</code></p>



<a name="167874221"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/189812-t-compiler/wg-rfc-2229/topic/test%20failures/near/167874221" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> blitzerr <a href="https://rust-lang.github.io/zulip_archive/stream/189812-t-compiler/wg-rfc-2229/topic/test.20failures.html#167874221">(Jun 11 2019 at 18:02)</a>:</h4>
<p><a href="https://github.com/blitzerr/rust/commits/upvar-tys-squashed" target="_blank" title="https://github.com/blitzerr/rust/commits/upvar-tys-squashed">https://github.com/blitzerr/rust/commits/upvar-tys-squashed</a></p>



<a name="167874508"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/189812-t-compiler/wg-rfc-2229/topic/test%20failures/near/167874508" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://rust-lang.github.io/zulip_archive/stream/189812-t-compiler/wg-rfc-2229/topic/test.20failures.html#167874508">(Jun 11 2019 at 18:05)</a>:</h4>
<p>ok</p>



<a name="167874547"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/189812-t-compiler/wg-rfc-2229/topic/test%20failures/near/167874547" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://rust-lang.github.io/zulip_archive/stream/189812-t-compiler/wg-rfc-2229/topic/test.20failures.html#167874547">(Jun 11 2019 at 18:05)</a>:</h4>
<p>I'm starting a build now</p>



<a name="167905119"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/189812-t-compiler/wg-rfc-2229/topic/test%20failures/near/167905119" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> blitzerr <a href="https://rust-lang.github.io/zulip_archive/stream/189812-t-compiler/wg-rfc-2229/topic/test.20failures.html#167905119">(Jun 12 2019 at 01:00)</a>:</h4>
<p><span class="user-mention" data-user-id="116009">@nikomatsakis</span>  how did it go ?</p>



<a name="167949879"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/189812-t-compiler/wg-rfc-2229/topic/test%20failures/near/167949879" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://rust-lang.github.io/zulip_archive/stream/189812-t-compiler/wg-rfc-2229/topic/test.20failures.html#167949879">(Jun 12 2019 at 14:03)</a>:</h4>
<p>I reproduced your errors but didn't get a chance to look more deeply yet</p>



<a name="170501264"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/189812-t-compiler/wg-rfc-2229/topic/test%20failures/near/170501264" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://rust-lang.github.io/zulip_archive/stream/189812-t-compiler/wg-rfc-2229/topic/test.20failures.html#170501264">(Jul 10 2019 at 00:12)</a>:</h4>
<p>did a little digging</p>



<a name="170501269"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/189812-t-compiler/wg-rfc-2229/topic/test%20failures/near/170501269" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://rust-lang.github.io/zulip_archive/stream/189812-t-compiler/wg-rfc-2229/topic/test.20failures.html#170501269">(Jul 10 2019 at 00:12)</a>:</h4>
<p><em>somehow</em> the cause is "off by one"</p>



<a name="170501299"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/189812-t-compiler/wg-rfc-2229/topic/test%20failures/near/170501299" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://rust-lang.github.io/zulip_archive/stream/189812-t-compiler/wg-rfc-2229/topic/test.20failures.html#170501299">(Jul 10 2019 at 00:13)</a>:</h4>
<p>I see e.g. that the obligation causes are like:</p>
<ul>
<li>cause_code=BuiltinDerivedObligation(DerivedObligationCause { parent_trait_ref: Binder(&lt;(&amp;std::sync::mpsc::Sender&lt;()&gt;,) as std::marker::Send&gt;),</li>
<li>cause_code=HiddenDerivedObligation(DerivedObligationCause { parent_trait_ref: Binder(&lt;[closure@closure-move-sync.rs:18:19: 18:42 tx:_] as std::marker::Send&gt;)</li>
<li>cause_code=ItemObligation(DefId(1/0:340 ~ std[7eac]::thread[0]::spawn[0]))</li>
</ul>



<a name="170501305"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/189812-t-compiler/wg-rfc-2229/topic/test%20failures/near/170501305" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://rust-lang.github.io/zulip_archive/stream/189812-t-compiler/wg-rfc-2229/topic/test.20failures.html#170501305">(Jul 10 2019 at 00:13)</a>:</h4>
<p>the hidden one should be the <em>tuple</em></p>



<a name="170526229"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/189812-t-compiler/wg-rfc-2229/topic/test%20failures/near/170526229" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://rust-lang.github.io/zulip_archive/stream/189812-t-compiler/wg-rfc-2229/topic/test.20failures.html#170526229">(Jul 10 2019 at 09:35)</a>:</h4>
<p>wait, no, that's wrong. The problem is more in the <code>note_obligation_cause_code</code> --</p>



<a name="170526339"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/189812-t-compiler/wg-rfc-2229/topic/test%20failures/near/170526339" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://rust-lang.github.io/zulip_archive/stream/189812-t-compiler/wg-rfc-2229/topic/test.20failures.html#170526339">(Jul 10 2019 at 09:37)</a>:</h4>
<p>when it prints out the (e.g.) "builtin derived obligation", it is printing the <em>self type</em> from the <em>parent</em></p>



<a name="170526345"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/189812-t-compiler/wg-rfc-2229/topic/test%20failures/near/170526345" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://rust-lang.github.io/zulip_archive/stream/189812-t-compiler/wg-rfc-2229/topic/test.20failures.html#170526345">(Jul 10 2019 at 09:37)</a>:</h4>
<p>but that's the one we want to <em>skip</em></p>



<a name="170526537"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/189812-t-compiler/wg-rfc-2229/topic/test%20failures/near/170526537" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://rust-lang.github.io/zulip_archive/stream/189812-t-compiler/wg-rfc-2229/topic/test.20failures.html#170526537">(Jul 10 2019 at 09:40)</a>:</h4>
<p>so <span class="user-mention" data-user-id="128294">@blitzerr</span> what needs to happen is that in <a href="https://github.com/rust-lang/rust/blob/0324a2b309cd66cb7bd4a156bd0b84cb136e254f/src/librustc/traits/error_reporting.rs#L1625-L1629" target="_blank" title="https://github.com/rust-lang/rust/blob/0324a2b309cd66cb7bd4a156bd0b84cb136e254f/src/librustc/traits/error_reporting.rs#L1625-L1629">roughly this code here</a>, we need to not necessarily print the type from the <code>parent_trait_ref</code> -- we need to look at the <code>parent_code</code> and, if it is a <code>HiddenDerivedObligation</code>, then we need to iterate to <em>its</em> parent</p>



<a name="170543056"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/189812-t-compiler/wg-rfc-2229/topic/test%20failures/near/170543056" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> blitzerr <a href="https://rust-lang.github.io/zulip_archive/stream/189812-t-compiler/wg-rfc-2229/topic/test.20failures.html#170543056">(Jul 10 2019 at 13:52)</a>:</h4>
<p>Thanks a lot <span class="user-mention" data-user-id="116009">@nikomatsakis</span> . I will give this a shot.</p>



<a name="170565024"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/189812-t-compiler/wg-rfc-2229/topic/test%20failures/near/170565024" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://rust-lang.github.io/zulip_archive/stream/189812-t-compiler/wg-rfc-2229/topic/test.20failures.html#170565024">(Jul 10 2019 at 18:09)</a>:</h4>
<p>Cool :)</p>



<a name="171006488"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/189812-t-compiler/wg-rfc-2229/topic/test%20failures/near/171006488" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> blitzerr <a href="https://rust-lang.github.io/zulip_archive/stream/189812-t-compiler/wg-rfc-2229/topic/test.20failures.html#171006488">(Jul 16 2019 at 17:08)</a>:</h4>
<p><span class="user-mention" data-user-id="116009">@nikomatsakis</span>  <span aria-label="point up" class="emoji emoji-1f446" role="img" title="point up">:point_up:</span></p>



<a name="171702755"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/189812-t-compiler/wg-rfc-2229/topic/test%20failures/near/171702755" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://rust-lang.github.io/zulip_archive/stream/189812-t-compiler/wg-rfc-2229/topic/test.20failures.html#171702755">(Jul 25 2019 at 15:48)</a>:</h4>
<p><span class="user-mention" data-user-id="128294">@blitzerr</span> did it work? :)</p>



<a name="171901266"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/189812-t-compiler/wg-rfc-2229/topic/test%20failures/near/171901266" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> blitzerr <a href="https://rust-lang.github.io/zulip_archive/stream/189812-t-compiler/wg-rfc-2229/topic/test.20failures.html#171901266">(Jul 28 2019 at 19:36)</a>:</h4>
<p>Sorry for the delay, <span class="user-mention" data-user-id="116009">@nikomatsakis</span> . Unfortunately it didn't</p>



<a name="171901273"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/189812-t-compiler/wg-rfc-2229/topic/test%20failures/near/171901273" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> blitzerr <a href="https://rust-lang.github.io/zulip_archive/stream/189812-t-compiler/wg-rfc-2229/topic/test.20failures.html#171901273">(Jul 28 2019 at 19:36)</a>:</h4>
<div class="codehilite"><pre><span></span><span class="w">           </span><span class="n">ObligationCauseCode</span>::<span class="n">BuiltinDerivedObligation</span><span class="p">(</span><span class="k">ref</span><span class="w"> </span><span class="n">data</span><span class="p">)</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">                </span><span class="k">if</span><span class="w"> </span><span class="kd">let</span><span class="w"> </span><span class="n">ObligationCauseCode</span>::<span class="n">HiddenDerivedObligation</span><span class="p">(</span><span class="k">ref</span><span class="w"> </span><span class="n">idata</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">*</span><span class="n">data</span><span class="p">.</span><span class="n">parent_code</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">                    </span><span class="n">err</span><span class="p">.</span><span class="n">note</span><span class="p">(</span><span class="s">&quot;Test Note: Found hidden type. So skipping ..&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">                    </span><span class="kd">let</span><span class="w"> </span><span class="n">parent_trait_ref</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="bp">self</span><span class="p">.</span><span class="n">resolve_type_vars_if_possible</span><span class="p">(</span><span class="o">&amp;</span><span class="n">idata</span><span class="p">.</span><span class="n">parent_trait_ref</span><span class="p">);</span><span class="w"></span>
<span class="w">                    </span><span class="kd">let</span><span class="w"> </span><span class="n">parent_predicate</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">parent_trait_ref</span><span class="p">.</span><span class="n">to_predicate</span><span class="p">();</span><span class="w"></span>
<span class="w">                    </span><span class="bp">self</span><span class="p">.</span><span class="n">note_obligation_cause_code</span><span class="p">(</span><span class="n">err</span><span class="p">,</span><span class="w"></span>
<span class="w">                                                    </span><span class="o">&amp;</span><span class="n">parent_predicate</span><span class="p">,</span><span class="w"></span>
<span class="w">                                                    </span><span class="o">&amp;</span><span class="n">idata</span><span class="p">.</span><span class="n">parent_code</span><span class="p">,</span><span class="w"></span>
<span class="w">                                                    </span><span class="n">obligated_types</span><span class="p">);</span><span class="w"></span>

<span class="w">                </span><span class="p">}</span><span class="w"></span>
<span class="w">                </span><span class="kd">let</span><span class="w"> </span><span class="n">parent_trait_ref</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="bp">self</span><span class="p">.</span><span class="n">resolve_type_vars_if_possible</span><span class="p">(</span><span class="o">&amp;</span><span class="n">data</span><span class="p">.</span><span class="n">parent_trait_ref</span><span class="p">);</span><span class="w"></span>
<span class="w">                </span><span class="kd">let</span><span class="w"> </span><span class="n">parent_predicate</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">parent_trait_ref</span><span class="p">.</span><span class="n">to_predicate</span><span class="p">();</span><span class="w"></span>
<span class="w">                </span><span class="kd">let</span><span class="w"> </span><span class="n">ty</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">parent_trait_ref</span><span class="p">.</span><span class="n">skip_binder</span><span class="p">().</span><span class="n">self_ty</span><span class="p">();</span><span class="w"></span>
<span class="w">                </span><span class="n">err</span><span class="p">.</span><span class="n">note</span><span class="p">(</span><span class="o">&amp;</span><span class="n">format</span><span class="o">!</span><span class="p">(</span><span class="s">&quot;required because it appears within the type `{}`&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">ty</span><span class="p">));</span><span class="w"></span>
<span class="w">                </span><span class="n">obligated_types</span><span class="p">.</span><span class="n">push</span><span class="p">(</span><span class="n">ty</span><span class="p">);</span><span class="w"></span>

<span class="w">                </span><span class="k">if</span><span class="w"> </span><span class="o">!</span><span class="bp">self</span><span class="p">.</span><span class="n">is_recursive_obligation</span><span class="p">(</span><span class="n">obligated_types</span><span class="p">,</span><span class="w"> </span><span class="o">&amp;</span><span class="n">data</span><span class="p">.</span><span class="n">parent_code</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">                    </span><span class="bp">self</span><span class="p">.</span><span class="n">note_obligation_cause_code</span><span class="p">(</span><span class="n">err</span><span class="p">,</span><span class="w"></span>
<span class="w">                                                    </span><span class="o">&amp;</span><span class="n">parent_predicate</span><span class="p">,</span><span class="w"></span>
<span class="w">                                                    </span><span class="o">&amp;</span><span class="n">data</span><span class="p">.</span><span class="n">parent_code</span><span class="p">,</span><span class="w"></span>
<span class="w">                                                    </span><span class="n">obligated_types</span><span class="p">);</span><span class="w"></span>
<span class="w">                </span><span class="p">}</span><span class="w"></span>
<span class="w">            </span><span class="p">}</span><span class="w"></span>
<span class="w">            </span><span class="n">ObligationCauseCode</span>::<span class="n">HiddenDerivedObligation</span><span class="p">(</span><span class="k">ref</span><span class="w"> </span><span class="n">data</span><span class="p">)</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">                </span><span class="k">if</span><span class="w"> </span><span class="kd">let</span><span class="w"> </span><span class="n">ObligationCauseCode</span>::<span class="n">HiddenDerivedObligation</span><span class="p">(</span><span class="k">ref</span><span class="w"> </span><span class="n">idata</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">*</span><span class="n">data</span><span class="p">.</span><span class="n">parent_code</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">                    </span><span class="n">err</span><span class="p">.</span><span class="n">note</span><span class="p">(</span><span class="s">&quot;Test Note: ObligationCauseCode::HiddenDerivedObligation ..&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">                    </span><span class="kd">let</span><span class="w"> </span><span class="n">parent_trait_ref</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="bp">self</span><span class="p">.</span><span class="n">resolve_type_vars_if_possible</span><span class="p">(</span><span class="o">&amp;</span><span class="n">idata</span><span class="p">.</span><span class="n">parent_trait_ref</span><span class="p">);</span><span class="w"></span>
<span class="w">                    </span><span class="kd">let</span><span class="w"> </span><span class="n">parent_predicate</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">parent_trait_ref</span><span class="p">.</span><span class="n">to_predicate</span><span class="p">();</span><span class="w"></span>
<span class="w">                    </span><span class="bp">self</span><span class="p">.</span><span class="n">note_obligation_cause_code</span><span class="p">(</span><span class="n">err</span><span class="p">,</span><span class="w"></span>
<span class="w">                                                    </span><span class="o">&amp;</span><span class="n">parent_predicate</span><span class="p">,</span><span class="w"></span>
<span class="w">                                                    </span><span class="o">&amp;</span><span class="n">idata</span><span class="p">.</span><span class="n">parent_code</span><span class="p">,</span><span class="w"></span>
<span class="w">                                                    </span><span class="n">obligated_types</span><span class="p">);</span><span class="w"></span>

<span class="w">                </span><span class="p">}</span><span class="w"></span>
<span class="w">            </span><span class="p">}</span><span class="w"></span>
</pre></div>



<a name="171901284"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/189812-t-compiler/wg-rfc-2229/topic/test%20failures/near/171901284" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> blitzerr <a href="https://rust-lang.github.io/zulip_archive/stream/189812-t-compiler/wg-rfc-2229/topic/test.20failures.html#171901284">(Jul 28 2019 at 19:37)</a>:</h4>
<p>That's the change I made in <code> fn note_obligation_cause_code</code>.</p>



<a name="171901290"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/189812-t-compiler/wg-rfc-2229/topic/test%20failures/near/171901290" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> blitzerr <a href="https://rust-lang.github.io/zulip_archive/stream/189812-t-compiler/wg-rfc-2229/topic/test.20failures.html#171901290">(Jul 28 2019 at 19:37)</a>:</h4>
<p>The output after the <code>test err.notes</code> are:</p>



<a name="171901291"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/189812-t-compiler/wg-rfc-2229/topic/test%20failures/near/171901291" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> blitzerr <a href="https://rust-lang.github.io/zulip_archive/stream/189812-t-compiler/wg-rfc-2229/topic/test.20failures.html#171901291">(Jul 28 2019 at 19:37)</a>:</h4>
<div class="codehilite"><pre><span></span>
</pre></div>



<a name="172061791"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/189812-t-compiler/wg-rfc-2229/topic/test%20failures/near/172061791" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> blitzerr <a href="https://rust-lang.github.io/zulip_archive/stream/189812-t-compiler/wg-rfc-2229/topic/test.20failures.html#172061791">(Jul 30 2019 at 18:08)</a>:</h4>
<p><span class="user-mention" data-user-id="116009">@nikomatsakis</span>  <span aria-label="wave" class="emoji emoji-1f44b" role="img" title="wave">:wave:</span></p>



<a name="174254493"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/189812-t-compiler/wg-rfc-2229/topic/test%20failures/near/174254493" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://rust-lang.github.io/zulip_archive/stream/189812-t-compiler/wg-rfc-2229/topic/test.20failures.html#174254493">(Aug 27 2019 at 18:11)</a>:</h4>
<blockquote>
<p>Sorry for the delay, <span class="user-mention silent" data-user-id="116009">nikomatsakis</span> . Unfortunately it didn't</p>
</blockquote>
<p>I see <span class="user-mention" data-user-id="128294">@blitzerr</span> that this didn't work, eh? Did you push the changes by any chance?</p>



<a name="174254513"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/189812-t-compiler/wg-rfc-2229/topic/test%20failures/near/174254513" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> blitzerr <a href="https://rust-lang.github.io/zulip_archive/stream/189812-t-compiler/wg-rfc-2229/topic/test.20failures.html#174254513">(Aug 27 2019 at 18:11)</a>:</h4>
<p>hi <span class="user-mention" data-user-id="116009">@nikomatsakis</span></p>



<a name="174254528"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/189812-t-compiler/wg-rfc-2229/topic/test%20failures/near/174254528" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> blitzerr <a href="https://rust-lang.github.io/zulip_archive/stream/189812-t-compiler/wg-rfc-2229/topic/test.20failures.html#174254528">(Aug 27 2019 at 18:11)</a>:</h4>
<p>The changes are pushed</p>



<a name="174254663"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/189812-t-compiler/wg-rfc-2229/topic/test%20failures/near/174254663" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> blitzerr <a href="https://rust-lang.github.io/zulip_archive/stream/189812-t-compiler/wg-rfc-2229/topic/test.20failures.html#174254663">(Aug 27 2019 at 18:13)</a>:</h4>
<p><span class="user-mention" data-user-id="116009">@nikomatsakis</span>  Please find them here : <a href="https://github.com/blitzerr/rust/commit/2af330a80b5fce8dd0761cae6bf041c445c783e0" target="_blank" title="https://github.com/blitzerr/rust/commit/2af330a80b5fce8dd0761cae6bf041c445c783e0">https://github.com/blitzerr/rust/commit/2af330a80b5fce8dd0761cae6bf041c445c783e0</a></p>



<a name="174254666"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/189812-t-compiler/wg-rfc-2229/topic/test%20failures/near/174254666" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://rust-lang.github.io/zulip_archive/stream/189812-t-compiler/wg-rfc-2229/topic/test.20failures.html#174254666">(Aug 27 2019 at 18:13)</a>:</h4>
<p>ok, I'm running locally :)</p>



<a name="174256601"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/189812-t-compiler/wg-rfc-2229/topic/test%20failures/near/174256601" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://rust-lang.github.io/zulip_archive/stream/189812-t-compiler/wg-rfc-2229/topic/test.20failures.html#174256601">(Aug 27 2019 at 18:35)</a>:</h4>
<p><span class="user-mention" data-user-id="128294">@blitzerr</span> so I see a lot of tests with a new note:</p>
<div class="codehilite"><pre><span></span>+   = note: ExprAssignable + MatchExpr etc.
</pre></div>



<a name="174256702"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/189812-t-compiler/wg-rfc-2229/topic/test%20failures/near/174256702" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://rust-lang.github.io/zulip_archive/stream/189812-t-compiler/wg-rfc-2229/topic/test.20failures.html#174256702">(Aug 27 2019 at 18:36)</a>:</h4>
<p>ugh but also some other discrepancies</p>



<a name="174256706"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/189812-t-compiler/wg-rfc-2229/topic/test%20failures/near/174256706" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://rust-lang.github.io/zulip_archive/stream/189812-t-compiler/wg-rfc-2229/topic/test.20failures.html#174256706">(Aug 27 2019 at 18:36)</a>:</h4>
<p>man this so annoying</p>



<a name="174256744"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/189812-t-compiler/wg-rfc-2229/topic/test%20failures/near/174256744" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> blitzerr <a href="https://rust-lang.github.io/zulip_archive/stream/189812-t-compiler/wg-rfc-2229/topic/test.20failures.html#174256744">(Aug 27 2019 at 18:36)</a>:</h4>
<p>My RUSTC_LOG was not working so I added test logs to <code>err.note("</code></p>



<a name="174256762"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/189812-t-compiler/wg-rfc-2229/topic/test%20failures/near/174256762" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://rust-lang.github.io/zulip_archive/stream/189812-t-compiler/wg-rfc-2229/topic/test.20failures.html#174256762">(Aug 27 2019 at 18:37)</a>:</h4>
<p>ok yes I see that</p>



<a name="174256764"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/189812-t-compiler/wg-rfc-2229/topic/test%20failures/near/174256764" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> blitzerr <a href="https://rust-lang.github.io/zulip_archive/stream/189812-t-compiler/wg-rfc-2229/topic/test.20failures.html#174256764">(Aug 27 2019 at 18:37)</a>:</h4>
<p>To track the control flow. Sorry about that.</p>



<a name="174256766"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/189812-t-compiler/wg-rfc-2229/topic/test%20failures/near/174256766" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://rust-lang.github.io/zulip_archive/stream/189812-t-compiler/wg-rfc-2229/topic/test.20failures.html#174256766">(Aug 27 2019 at 18:37)</a>:</h4>
<p>I think it's <code>RUST_LOG</code></p>



<a name="174256769"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/189812-t-compiler/wg-rfc-2229/topic/test%20failures/near/174256769" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://rust-lang.github.io/zulip_archive/stream/189812-t-compiler/wg-rfc-2229/topic/test.20failures.html#174256769">(Aug 27 2019 at 18:37)</a>:</h4>
<p>since your branch is so old</p>



<a name="174256800"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/189812-t-compiler/wg-rfc-2229/topic/test%20failures/near/174256800" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://rust-lang.github.io/zulip_archive/stream/189812-t-compiler/wg-rfc-2229/topic/test.20failures.html#174256800">(Aug 27 2019 at 18:37)</a>:</h4>
<p>in any case, i'm removing those and re-running :)</p>



<a name="174257343"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/189812-t-compiler/wg-rfc-2229/topic/test%20failures/near/174257343" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> blitzerr <a href="https://rust-lang.github.io/zulip_archive/stream/189812-t-compiler/wg-rfc-2229/topic/test.20failures.html#174257343">(Aug 27 2019 at 18:42)</a>:</h4>
<p>The latest failed tests are tracked <a href="https://paper.dropbox.com/doc/UI-tests-failing--AjqkMY48CYSmyR0Tt_9mopdkAg-X96kJW6agXuvx36GPxmcg" target="_blank" title="https://paper.dropbox.com/doc/UI-tests-failing--AjqkMY48CYSmyR0Tt_9mopdkAg-X96kJW6agXuvx36GPxmcg">here</a></p>



<a name="174257350"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/189812-t-compiler/wg-rfc-2229/topic/test%20failures/near/174257350" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> blitzerr <a href="https://rust-lang.github.io/zulip_archive/stream/189812-t-compiler/wg-rfc-2229/topic/test.20failures.html#174257350">(Aug 27 2019 at 18:42)</a>:</h4>
<p><span class="user-mention" data-user-id="116009">@nikomatsakis</span>  <span aria-label="point of information" class="emoji emoji-261d" role="img" title="point of information">:point_of_information:</span></p>



<a name="174257411"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/189812-t-compiler/wg-rfc-2229/topic/test%20failures/near/174257411" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> blitzerr <a href="https://rust-lang.github.io/zulip_archive/stream/189812-t-compiler/wg-rfc-2229/topic/test.20failures.html#174257411">(Aug 27 2019 at 18:43)</a>:</h4>
<p>The way I was looking at it is to get it to just print </p>
<div class="codehilite"><pre><span></span>-           = note: required because it appears within the type `[closure@$DIR/closure-move-sync.rs:6:27: 9:6 recv:&amp;std::sync::mpsc::Receiver&lt;()&gt;]```
somehow
</pre></div>



<a name="174257505"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/189812-t-compiler/wg-rfc-2229/topic/test%20failures/near/174257505" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> blitzerr <a href="https://rust-lang.github.io/zulip_archive/stream/189812-t-compiler/wg-rfc-2229/topic/test.20failures.html#174257505">(Aug 27 2019 at 18:44)</a>:</h4>
<p>In the latest one:</p>
<div class="codehilite"><pre><span></span>+           = note: required because it appears within the type `(&amp;std::sync::mpsc::Receiver&lt;()&gt;,)`
</pre></div>


<p>this is gone</p>



<a name="174366950"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/189812-t-compiler/wg-rfc-2229/topic/test%20failures/near/174366950" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> blitzerr <a href="https://rust-lang.github.io/zulip_archive/stream/189812-t-compiler/wg-rfc-2229/topic/test.20failures.html#174366950">(Aug 28 2019 at 14:21)</a>:</h4>
<p><span class="user-mention" data-user-id="116009">@nikomatsakis</span> all fixed now ? <span aria-label="slight smile" class="emoji emoji-1f642" role="img" title="slight smile">:slight_smile:</span></p>



<a name="175539091"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/189812-t-compiler/wg-rfc-2229/topic/test%20failures/near/175539091" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> blitzerr <a href="https://rust-lang.github.io/zulip_archive/stream/189812-t-compiler/wg-rfc-2229/topic/test.20failures.html#175539091">(Sep 12 2019 at 15:17)</a>:</h4>
<p><span class="user-mention" data-user-id="116009">@nikomatsakis</span> <br>
Following up from today's compiler meeting, you suggest that we merge to the latest master and then fix things - was that you thinking out loud or you wanted me to try that. The issue is that the merge will bring in new issues and we won't know whether the cause is the refactoring or the merging.<br>
What do you think ?</p>



<a name="175569655"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/189812-t-compiler/wg-rfc-2229/topic/test%20failures/near/175569655" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://rust-lang.github.io/zulip_archive/stream/189812-t-compiler/wg-rfc-2229/topic/test.20failures.html#175569655">(Sep 12 2019 at 20:46)</a>:</h4>
<p><span class="user-mention" data-user-id="128294">@blitzerr</span> well I don't think we should <em>literally</em> merge</p>



<a name="175569668"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/189812-t-compiler/wg-rfc-2229/topic/test%20failures/near/175569668" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://rust-lang.github.io/zulip_archive/stream/189812-t-compiler/wg-rfc-2229/topic/test.20failures.html#175569668">(Sep 12 2019 at 20:46)</a>:</h4>
<p>However, I do think we've lost a lot of momentum over these test failures and ultimately I don't think they're that big of a deal</p>



<a name="175569677"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/189812-t-compiler/wg-rfc-2229/topic/test%20failures/near/175569677" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://rust-lang.github.io/zulip_archive/stream/189812-t-compiler/wg-rfc-2229/topic/test.20failures.html#175569677">(Sep 12 2019 at 20:46)</a>:</h4>
<p>So I think what I would recommend is to take the PR and try to "rebase" the key commits over to master</p>



<a name="175569682"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/189812-t-compiler/wg-rfc-2229/topic/test%20failures/near/175569682" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://rust-lang.github.io/zulip_archive/stream/189812-t-compiler/wg-rfc-2229/topic/test.20failures.html#175569682">(Sep 12 2019 at 20:46)</a>:</h4>
<p>effectively, re-implement</p>



<a name="175569735"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/189812-t-compiler/wg-rfc-2229/topic/test%20failures/near/175569735" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://rust-lang.github.io/zulip_archive/stream/189812-t-compiler/wg-rfc-2229/topic/test.20failures.html#175569735">(Sep 12 2019 at 20:47)</a>:</h4>
<p>I guess I have to review the diff / history to see what that means exactly</p>



<a name="175569748"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/189812-t-compiler/wg-rfc-2229/topic/test%20failures/near/175569748" class="zl"><img src="https://rust-lang.github.io/zulip_archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://rust-lang.github.io/zulip_archive/stream/189812-t-compiler/wg-rfc-2229/topic/test.20failures.html#175569748">(Sep 12 2019 at 20:47)</a>:</h4>
<p>but at this point it seems like the right approach to me</p>



<hr><p>Last updated: Aug 07 2021 at 22:04 UTC</p>
</html>