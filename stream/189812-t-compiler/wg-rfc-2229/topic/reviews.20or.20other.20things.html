<html>
<head><meta charset="utf-8"><title>reviews or other things · t-compiler/wg-rfc-2229 · Zulip Chat Archive</title></head>
<h2>Stream: <a href="https://zulip-archive.rust-lang.org/stream/189812-t-compiler/wg-rfc-2229/index.html">t-compiler/wg-rfc-2229</a></h2>
<h3>Topic: <a href="https://zulip-archive.rust-lang.org/stream/189812-t-compiler/wg-rfc-2229/topic/reviews.20or.20other.20things.html">reviews or other things</a></h3>

<hr>

<base href="https://rust-lang.zulipchat.com">

<head><link href="https://zulip-archive.rust-lang.org/style.css" rel="stylesheet"></head>

<a name="221224859"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/189812-t-compiler/wg-rfc-2229/topic/reviews%20or%20other%20things/near/221224859" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/189812-t-compiler/wg-rfc-2229/topic/reviews.20or.20other.20things.html#221224859">(Dec 30 2020 at 16:30)</a>:</h4>
<p>PS, <span class="user-mention" data-user-id="281950">@Aman Arora</span>, let me know if there are reviews and things I can do to help -- I'm largely AFK this week. but if you point me at stuff I can try to make time.</p>



<a name="221251164"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/189812-t-compiler/wg-rfc-2229/topic/reviews%20or%20other%20things/near/221251164" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Aman Arora <a href="https://zulip-archive.rust-lang.org/stream/189812-t-compiler/wg-rfc-2229/topic/reviews.20or.20other.20things.html#221251164">(Dec 30 2020 at 22:12)</a>:</h4>
<p>1) So I had updated the PR for mutability, but we still need to not use the hack. I wasn't able to figure that out.  <a href="https://github.com/rust-lang/rust/pull/80092">https://github.com/rust-lang/rust/pull/80092</a></p>
<p>There was a merged conflict because of some change last night, I'll try push a fixup today.<br>
2) We'll be creating a PR for the first pass of migrations and for  precise diagnostics when reporting Closure type today, so I'll send them here, Iet me know if u want me to @-ping you</p>
<p>3) So needs_drop is implemented as a query and if I understand correctly if I add another query for figuring out non standard drops, we would probably end up storing results somewhere. <br>
4) I implemented the precision path pass for mgirations I think  our non_standard_needs_drop would need support Drop implemented for ty and ty needs drop.</p>
<p>Eg:</p>
<div class="codehilite" data-code-language="Rust"><pre><span></span><code><span class="k">struct</span> <span class="nc">A</span><span class="p">;</span><span class="w"></span>
<span class="k">impl</span><span class="w"> </span><span class="nb">Drop</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">A</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="o">..</span><span class="p">.</span><span class="w"> </span><span class="p">}</span><span class="w"></span>

<span class="k">struct</span> <span class="nc">B</span><span class="p">;</span><span class="w"></span>

<span class="k">struct</span> <span class="nc">C</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="n">a</span>: <span class="nc">A</span><span class="p">,</span><span class="w"> </span><span class="n">b</span>: <span class="nc">B</span><span class="w"> </span><span class="p">};</span><span class="w"></span>

<span class="k">impl</span><span class="w"> </span><span class="nb">Drop</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">C</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="o">..</span><span class="p">.</span><span class="w"> </span><span class="p">}</span><span class="w"></span>

<span class="k">fn</span> <span class="nf">f</span><span class="p">(</span><span class="n">c</span>: <span class="nc">C</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="kd">let</span><span class="w"> </span><span class="n">closure</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">      </span><span class="c1">// move c.a;</span>
<span class="w">    </span><span class="p">};</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>
</code></pre></div>
<p>Now here when we do the precise path we see that the only type within <code>c</code> that implements Drop has been captured but C still implemnets drop itself and then </p>
<p>a)  That would run at a different time now<br>
b) Assuming this class exists for use with closures, depending on how /what expectations the Drops are written,  there might be difference in behavior.</p>



<a name="221416405"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/189812-t-compiler/wg-rfc-2229/topic/reviews%20or%20other%20things/near/221416405" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Aman Arora <a href="https://zulip-archive.rust-lang.org/stream/189812-t-compiler/wg-rfc-2229/topic/reviews.20or.20other.20things.html#221416405">(Jan 02 2021 at 20:42)</a>:</h4>
<p><a href="https://github.com/rust-lang/rust/pull/80629">https://github.com/rust-lang/rust/pull/80629</a></p>



<a name="221429484"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/189812-t-compiler/wg-rfc-2229/topic/reviews%20or%20other%20things/near/221429484" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> rocksand <a href="https://zulip-archive.rust-lang.org/stream/189812-t-compiler/wg-rfc-2229/topic/reviews.20or.20other.20things.html#221429484">(Jan 03 2021 at 02:33)</a>:</h4>
<p>I added this PR (<a href="https://github.com/rust-lang/rust/pull/80635">https://github.com/rust-lang/rust/pull/80635</a>) which allows us to show precise path in diagnostics message related to closure kind selection decision</p>



<a name="221756829"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/189812-t-compiler/wg-rfc-2229/topic/reviews%20or%20other%20things/near/221756829" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Aman Arora <a href="https://zulip-archive.rust-lang.org/stream/189812-t-compiler/wg-rfc-2229/topic/reviews.20or.20other.20things.html#221756829">(Jan 06 2021 at 11:26)</a>:</h4>
<p><span class="user-mention silent" data-user-id="281950">Aman Arora</span> <a href="#narrow/stream/189812-t-compiler.2Fwg-rfc-2229/topic/reviews.20or.20other.20things/near/221251164">said</a>:</p>
<blockquote>
<p>3) So needs_drop is implemented as a query and if I understand correctly if I add another query for figuring out non standard drops, we would probably end up storing results somewhere. <br>
</p>
</blockquote>
<p>I gave some more thought on insignificant dtors. <br>
Say we have <code>struct Foo&lt;T&gt;{ v: Vec&lt;T&gt;, s: String }</code> and <code>foo: F</code>. Now say the closure only needs to capture <code>foo.s</code>. We see that <code>foo.v</code> is defined in stdlib and therefore we would've marked the dtor as insignificant. </p>
<p>What happens <code>T</code> implements <code>Drop</code>. Then the dtor of foo.v becomes somewhat significant because it will be triggered when <code>foo.v</code> is dropped.</p>
<p>So one way around this _might_ be if this is an insignificant dtor we look at the substs for this type and see if any of the Generic Args have a significant dtor</p>
<blockquote>
<p>4) I implemented the precision path pass for mgirations I think  our non_standard_needs_drop would need support Drop implemented for ty and ty needs drop.</p>
</blockquote>
<p>I fixed this. I got help from @_Léo Lanteri Thauvin|255061. I just check for if a drop is implemented for ty and if so is it fully captured.</p>



<a name="221927228"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/189812-t-compiler/wg-rfc-2229/topic/reviews%20or%20other%20things/near/221927228" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tyson Nottingham <a href="https://zulip-archive.rust-lang.org/stream/189812-t-compiler/wg-rfc-2229/topic/reviews.20or.20other.20things.html#221927228">(Jan 07 2021 at 10:44)</a>:</h4>
<p>This might be fringe, but I was imagining a case where drop order changing with only std types would have a very observable effect.</p>
<div class="codehilite"><pre><span></span><code>use std::fs::File;
use std::io::{BufWriter, Write};

struct Foo {
    bw1: BufWriter&lt;File&gt;,
    bw2: BufWriter&lt;File&gt;,
}

fn main() {
    let file1 = File::create(&quot;foo.bin&quot;).unwrap();
    let file2 = File::create(&quot;foo.bin&quot;).unwrap();

    let mut foo = Foo {
        bw1: BufWriter::new(file1),
        bw2: BufWriter::new(file2),
    };

    foo.bw1.write_all(&amp;[0]).unwrap();
    foo.bw2.write_all(&amp;[1]).unwrap();

    let _c = move || {
        println!(&quot;{}&quot;, foo.bw2.capacity());
    };
}
</code></pre></div>
<p>If I understand correctly, the file contents would be <code>1</code> without RFC-2229 and <code>0</code> with RFC-2229.</p>
<p>Not suggesting drop order shouldn't change. Just showing that a type being in std isn't enough to say that its drop isn't significant. But you probably already know that. Have an extra example in that case. <span aria-label="smile" class="emoji emoji-1f642" role="img" title="smile">:smile:</span></p>



<a name="221933085"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/189812-t-compiler/wg-rfc-2229/topic/reviews%20or%20other%20things/near/221933085" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Aman Arora <a href="https://zulip-archive.rust-lang.org/stream/189812-t-compiler/wg-rfc-2229/topic/reviews.20or.20other.20things.html#221933085">(Jan 07 2021 at 11:54)</a>:</h4>
<p>thank you for bringing this up, I personally hadn't thought of this. I'll take this into account and discuss it with the rest of the working-group. I'll try to remember to update you about the decision we make. <span aria-label="smile" class="emoji emoji-1f642" role="img" title="smile">:smile:</span></p>



<a name="222089518"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/189812-t-compiler/wg-rfc-2229/topic/reviews%20or%20other%20things/near/222089518" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Aman Arora <a href="https://zulip-archive.rust-lang.org/stream/189812-t-compiler/wg-rfc-2229/topic/reviews.20or.20other.20things.html#222089518">(Jan 08 2021 at 16:03)</a>:</h4>
<p><span class="user-mention" data-user-id="116009">@nikomatsakis</span> ready when you are. We are waiting to be let in</p>



<a name="222094803"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/189812-t-compiler/wg-rfc-2229/topic/reviews%20or%20other%20things/near/222094803" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Aman Arora <a href="https://zulip-archive.rust-lang.org/stream/189812-t-compiler/wg-rfc-2229/topic/reviews.20or.20other.20things.html#222094803">(Jan 08 2021 at 16:44)</a>:</h4>
<p><span class="user-mention silent" data-user-id="306073">Tyson Nottingham</span> <a href="#narrow/stream/189812-t-compiler.2Fwg-rfc-2229/topic/reviews.20or.20other.20things/near/221927228">said</a>:</p>
<blockquote>
<p>This might be fringe, but I was imagining a case where drop order changing with only std types would have a very observable effect.</p>
<div class="codehilite"><pre><span></span><code>use std::fs::File;
use std::io::{BufWriter, Write};

struct Foo {
    bw1: BufWriter&lt;File&gt;,
    bw2: BufWriter&lt;File&gt;,
}

fn main() {
    let file1 = File::create(&quot;foo.bin&quot;).unwrap();
    let file2 = File::create(&quot;foo.bin&quot;).unwrap();

    let mut foo = Foo {
        bw1: BufWriter::new(file1),
        bw2: BufWriter::new(file2),
    };

    foo.bw1.write_all(&amp;[0]).unwrap();
    foo.bw2.write_all(&amp;[1]).unwrap();

    let _c = move || {
        println!(&quot;{}&quot;, foo.bw2.capacity());
    };
}
</code></pre></div>
<p>If I understand correctly, the file contents would be <code>1</code> without RFC-2229 and <code>0</code> with RFC-2229.</p>
<p>Not suggesting drop order shouldn't change. Just showing that a type being in std isn't enough to say that its drop isn't significant. But you probably already know that. Have an extra example in that case. <span aria-label="smile" class="emoji emoji-1f642" role="img" title="smile">:smile:</span></p>
</blockquote>
<p>So the issue really was that I misunderstood if we wanted to label all types as having a significant destructor. We plan on only doing so for only some types in the stdlib. We'll essentially run the lint and select types that only clean up memory and whose change in Drop order won't have any effects on user code.</p>



<a name="222451043"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/189812-t-compiler/wg-rfc-2229/topic/reviews%20or%20other%20things/near/222451043" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Aman Arora <a href="https://zulip-archive.rust-lang.org/stream/189812-t-compiler/wg-rfc-2229/topic/reviews.20or.20other.20things.html#222451043">(Jan 12 2021 at 15:56)</a>:</h4>
<p><span class="user-mention" data-user-id="116009">@nikomatsakis</span> I forgot to link the PRs:</p>
<ul>
<li>First pass for lint: <a href="https://github.com/rust-lang/rust/pull/80629">https://github.com/rust-lang/rust/pull/80629</a></li>
<li>Improve diagnostics when closure doesn't meet trait bound: <a href="https://github.com/rust-lang/rust/pull/80635">https://github.com/rust-lang/rust/pull/80635</a></li>
</ul>
<p>Also if u can give me an idea of your availability for sync meetings?</p>



<a name="222485606"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/189812-t-compiler/wg-rfc-2229/topic/reviews%20or%20other%20things/near/222485606" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Aman Arora <a href="https://zulip-archive.rust-lang.org/stream/189812-t-compiler/wg-rfc-2229/topic/reviews.20or.20other.20things.html#222485606">(Jan 12 2021 at 19:55)</a>:</h4>
<p>Fix mutability/move closures: <a href="https://github.com/rust-lang/rust/pull/80092">https://github.com/rust-lang/rust/pull/80092</a></p>



<a name="222485672"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/189812-t-compiler/wg-rfc-2229/topic/reviews%20or%20other%20things/near/222485672" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Aman Arora <a href="https://zulip-archive.rust-lang.org/stream/189812-t-compiler/wg-rfc-2229/topic/reviews.20or.20other.20things.html#222485672">(Jan 12 2021 at 19:55)</a>:</h4>
<p>Also let me know if u want me to ping you on github for these</p>



<a name="222975403"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/189812-t-compiler/wg-rfc-2229/topic/reviews%20or%20other%20things/near/222975403" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/189812-t-compiler/wg-rfc-2229/topic/reviews.20or.20other.20things.html#222975403">(Jan 16 2021 at 11:08)</a>:</h4>
<p><span class="user-mention" data-user-id="281950">@Aman Arora</span> I left a comment on <a href="https://github.com/rust-lang/rust/issues/80629">#80629</a></p>



<a name="222975406"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/189812-t-compiler/wg-rfc-2229/topic/reviews%20or%20other%20things/near/222975406" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/189812-t-compiler/wg-rfc-2229/topic/reviews.20or.20other.20things.html#222975406">(Jan 16 2021 at 11:08)</a>:</h4>
<p>I have some thoughts on test cases, but I'm going to move to a distinct topic</p>



<a name="223321478"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/189812-t-compiler/wg-rfc-2229/topic/reviews%20or%20other%20things/near/223321478" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Aman Arora <a href="https://zulip-archive.rust-lang.org/stream/189812-t-compiler/wg-rfc-2229/topic/reviews.20or.20other.20things.html#223321478">(Jan 20 2021 at 01:33)</a>:</h4>
<p><span class="user-mention silent" data-user-id="116009">nikomatsakis</span> <a href="#narrow/stream/189812-t-compiler.2Fwg-rfc-2229/topic/reviews.20or.20other.20things/near/222975403">said</a>:</p>
<blockquote>
<p><span class="user-mention silent" data-user-id="281950">Aman Arora</span> I left a comment on <a href="https://github.com/rust-lang/rust/issues/80629">#80629</a></p>
</blockquote>
<p>Sorry for the delay, this has been updated</p>



<a name="223323747"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/189812-t-compiler/wg-rfc-2229/topic/reviews%20or%20other%20things/near/223323747" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Aman Arora <a href="https://zulip-archive.rust-lang.org/stream/189812-t-compiler/wg-rfc-2229/topic/reviews.20or.20other.20things.html#223323747">(Jan 20 2021 at 02:08)</a>:</h4>
<p>Chris created a PR for the initial set of diagnostics in the borrow checker: <a href="https://github.com/rust-lang/rust/pull/81062">https://github.com/rust-lang/rust/pull/81062</a></p>



<a name="223878820"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/189812-t-compiler/wg-rfc-2229/topic/reviews%20or%20other%20things/near/223878820" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/189812-t-compiler/wg-rfc-2229/topic/reviews.20or.20other.20things.html#223878820">(Jan 25 2021 at 10:33)</a>:</h4>
<p><span class="user-mention" data-user-id="281950">@Aman Arora</span>, you asked:</p>
<blockquote>
<p>Should I update the lint PR right now or leave it until we decide on a concrete migration macro? <a href="https://github.com/rust-lang/rust/issues/80629">#80629</a></p>
</blockquote>
<p>I think we should update it to generate <code>drop((&amp;x, .., &amp;z))</code> and consider adding a macro later.</p>
<blockquote>
<p>I should remove the ByValue capture parts from <a href="https://github.com/rust-lang/rust/issues/80092">#80092</a></p>
</blockquote>
<p>I'm not sure what the question is :)</p>



<a name="223883317"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/189812-t-compiler/wg-rfc-2229/topic/reviews%20or%20other%20things/near/223883317" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/189812-t-compiler/wg-rfc-2229/topic/reviews.20or.20other.20things.html#223883317">(Jan 25 2021 at 11:23)</a>:</h4>
<p>Also, I left reviews on the two PRs cited. I'll take a look at <a href="https://github.com/rust-lang/rust/issues/80629">#80629</a> and <a href="https://github.com/rust-lang/rust/issues/80092">#80092</a> later on</p>



<a name="223920416"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/189812-t-compiler/wg-rfc-2229/topic/reviews%20or%20other%20things/near/223920416" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Aman Arora <a href="https://zulip-archive.rust-lang.org/stream/189812-t-compiler/wg-rfc-2229/topic/reviews.20or.20other.20things.html#223920416">(Jan 25 2021 at 16:17)</a>:</h4>
<p>80092 implements the old by move capture strategy</p>



<a name="223920445"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/189812-t-compiler/wg-rfc-2229/topic/reviews%20or%20other%20things/near/223920445" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Aman Arora <a href="https://zulip-archive.rust-lang.org/stream/189812-t-compiler/wg-rfc-2229/topic/reviews.20or.20other.20things.html#223920445">(Jan 25 2021 at 16:17)</a>:</h4>
<p>To not capture detefs</p>



<a name="224016893"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/189812-t-compiler/wg-rfc-2229/topic/reviews%20or%20other%20things/near/224016893" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Aman Arora <a href="https://zulip-archive.rust-lang.org/stream/189812-t-compiler/wg-rfc-2229/topic/reviews.20or.20other.20things.html#224016893">(Jan 26 2021 at 09:51)</a>:</h4>
<p><span class="user-mention" data-user-id="116009">@nikomatsakis</span>  updated the old PR</p>



<a name="224017014"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/189812-t-compiler/wg-rfc-2229/topic/reviews%20or%20other%20things/near/224017014" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Aman Arora <a href="https://zulip-archive.rust-lang.org/stream/189812-t-compiler/wg-rfc-2229/topic/reviews.20or.20other.20things.html#224017014">(Jan 26 2021 at 09:52)</a>:</h4>
<p>I was thinking I should probably remove the part from <a href="https://github.com/rust-lang/rust/issues/80092">#80092</a> that implements removing the derefs in case of by value capture before it goes in and then we implement reborrow directly</p>



<a name="224536565"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/189812-t-compiler/wg-rfc-2229/topic/reviews%20or%20other%20things/near/224536565" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Aman Arora <a href="https://zulip-archive.rust-lang.org/stream/189812-t-compiler/wg-rfc-2229/topic/reviews.20or.20other.20things.html#224536565">(Jan 29 2021 at 21:32)</a>:</h4>
<p><span class="user-mention" data-user-id="116009">@nikomatsakis</span> there was a merge conflict can u r+ this again: <a href="https://github.com/rust-lang/rust/pull/80629">https://github.com/rust-lang/rust/pull/80629</a>?</p>



<a name="227857702"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/189812-t-compiler/wg-rfc-2229/topic/reviews%20or%20other%20things/near/227857702" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> rocksand <a href="https://zulip-archive.rust-lang.org/stream/189812-t-compiler/wg-rfc-2229/topic/reviews.20or.20other.20things.html#227857702">(Feb 25 2021 at 23:33)</a>:</h4>
<p><span class="user-mention" data-user-id="116009">@nikomatsakis</span> I have the PR for handling patterns ready to be reviewed: <a href="https://github.com/rust-lang/rust/pull/82536">https://github.com/rust-lang/rust/pull/82536</a></p>



<a name="227944104"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/189812-t-compiler/wg-rfc-2229/topic/reviews%20or%20other%20things/near/227944104" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/189812-t-compiler/wg-rfc-2229/topic/reviews.20or.20other.20things.html#227944104">(Feb 26 2021 at 15:33)</a>:</h4>
<p><span class="user-mention" data-user-id="307184">@rocksand</span> <span aria-label="tada" class="emoji emoji-1f389" role="img" title="tada">:tada:</span></p>



<a name="228283207"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/189812-t-compiler/wg-rfc-2229/topic/reviews%20or%20other%20things/near/228283207" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/189812-t-compiler/wg-rfc-2229/topic/reviews.20or.20other.20things.html#228283207">(Mar 01 2021 at 18:37)</a>:</h4>
<p><span class="user-mention" data-user-id="307184">@rocksand</span> just so you know, I've been reading the PR slowly</p>



<a name="228667928"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/189812-t-compiler/wg-rfc-2229/topic/reviews%20or%20other%20things/near/228667928" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Aman Arora <a href="https://zulip-archive.rust-lang.org/stream/189812-t-compiler/wg-rfc-2229/topic/reviews.20or.20other.20things.html#228667928">(Mar 03 2021 at 21:04)</a>:</h4>
<p><span class="user-mention" data-user-id="116009">@nikomatsakis</span>  are you joining the sync?</p>



<a name="228667950"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/189812-t-compiler/wg-rfc-2229/topic/reviews%20or%20other%20things/near/228667950" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/189812-t-compiler/wg-rfc-2229/topic/reviews.20or.20other.20things.html#228667950">(Mar 03 2021 at 21:04)</a>:</h4>
<p><span class="user-mention" data-user-id="281950">@Aman Arora</span> I am</p>



<a name="228903743"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/189812-t-compiler/wg-rfc-2229/topic/reviews%20or%20other%20things/near/228903743" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> rocksand <a href="https://zulip-archive.rust-lang.org/stream/189812-t-compiler/wg-rfc-2229/topic/reviews.20or.20other.20things.html#228903743">(Mar 05 2021 at 06:21)</a>:</h4>
<p><span class="user-mention" data-user-id="116009">@nikomatsakis</span> I finally had some time to address all the comments you left on my PR</p>



<a name="229010715"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/189812-t-compiler/wg-rfc-2229/topic/reviews%20or%20other%20things/near/229010715" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Aman Arora <a href="https://zulip-archive.rust-lang.org/stream/189812-t-compiler/wg-rfc-2229/topic/reviews.20or.20other.20things.html#229010715">(Mar 05 2021 at 19:28)</a>:</h4>
<p><span class="user-mention" data-user-id="116009">@nikomatsakis</span>  can you upload the sync video?</p>



<a name="229011768"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/189812-t-compiler/wg-rfc-2229/topic/reviews%20or%20other%20things/near/229011768" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/189812-t-compiler/wg-rfc-2229/topic/reviews.20or.20other.20things.html#229011768">(Mar 05 2021 at 19:35)</a>:</h4>
<p>yes</p>



<a name="229011779"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/189812-t-compiler/wg-rfc-2229/topic/reviews%20or%20other%20things/near/229011779" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/189812-t-compiler/wg-rfc-2229/topic/reviews.20or.20other.20things.html#229011779">(Mar 05 2021 at 19:35)</a>:</h4>
<p><span class="user-mention" data-user-id="307184">@rocksand</span> I will try to review today!</p>



<a name="229220410"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/189812-t-compiler/wg-rfc-2229/topic/reviews%20or%20other%20things/near/229220410" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Aman Arora <a href="https://zulip-archive.rust-lang.org/stream/189812-t-compiler/wg-rfc-2229/topic/reviews.20or.20other.20things.html#229220410">(Mar 07 2021 at 21:47)</a>:</h4>
<p><a href="https://github.com/rust-lang/rust/pull/82878">https://github.com/rust-lang/rust/pull/82878</a><br>
PR for repr packed</p>



<a name="229314436"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/189812-t-compiler/wg-rfc-2229/topic/reviews%20or%20other%20things/near/229314436" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/189812-t-compiler/wg-rfc-2229/topic/reviews.20or.20other.20things.html#229314436">(Mar 08 2021 at 15:15)</a>:</h4>
<p><span class="user-mention silent" data-user-id="116009">nikomatsakis</span> <a href="#narrow/stream/189812-t-compiler.2Fwg-rfc-2229/topic/reviews.20or.20other.20things/near/229011779">said</a>:</p>
<blockquote>
<p><span class="user-mention silent" data-user-id="307184">rocksand</span> I will try to review today!</p>
</blockquote>
<p>reviewed</p>



<a name="229395234"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/189812-t-compiler/wg-rfc-2229/topic/reviews%20or%20other%20things/near/229395234" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> rocksand <a href="https://zulip-archive.rust-lang.org/stream/189812-t-compiler/wg-rfc-2229/topic/reviews.20or.20other.20things.html#229395234">(Mar 08 2021 at 23:26)</a>:</h4>
<p>Thanks, I addressed all of your comments</p>



<a name="229553087"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/189812-t-compiler/wg-rfc-2229/topic/reviews%20or%20other%20things/near/229553087" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jennifer Wills <a href="https://zulip-archive.rust-lang.org/stream/189812-t-compiler/wg-rfc-2229/topic/reviews.20or.20other.20things.html#229553087">(Mar 09 2021 at 21:01)</a>:</h4>
<p>Pr for getting rid of old data structures <br>
<a href="https://github.com/rust-lang/rust/pull/82951">https://github.com/rust-lang/rust/pull/82951</a></p>



<a name="229553500"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/189812-t-compiler/wg-rfc-2229/topic/reviews%20or%20other%20things/near/229553500" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/189812-t-compiler/wg-rfc-2229/topic/reviews.20or.20other.20things.html#229553500">(Mar 09 2021 at 21:03)</a>:</h4>
<p>nice!</p>



<a name="229744179"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/189812-t-compiler/wg-rfc-2229/topic/reviews%20or%20other%20things/near/229744179" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Aman Arora <a href="https://zulip-archive.rust-lang.org/stream/189812-t-compiler/wg-rfc-2229/topic/reviews.20or.20other.20things.html#229744179">(Mar 10 2021 at 21:04)</a>:</h4>
<p><span class="user-mention" data-user-id="116009">@nikomatsakis</span>  are we doing a sync today, the meeting doesn't seem to be on my calendar</p>



<a name="229857065"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/189812-t-compiler/wg-rfc-2229/topic/reviews%20or%20other%20things/near/229857065" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/189812-t-compiler/wg-rfc-2229/topic/reviews.20or.20other.20things.html#229857065">(Mar 11 2021 at 14:30)</a>:</h4>
<p><span class="user-mention" data-user-id="281950">@Aman Arora</span> hmmm</p>



<a name="229857083"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/189812-t-compiler/wg-rfc-2229/topic/reviews%20or%20other%20things/near/229857083" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/189812-t-compiler/wg-rfc-2229/topic/reviews.20or.20other.20things.html#229857083">(Mar 11 2021 at 14:30)</a>:</h4>
<p>what time?</p>



<a name="229857091"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/189812-t-compiler/wg-rfc-2229/topic/reviews%20or%20other%20things/near/229857091" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/189812-t-compiler/wg-rfc-2229/topic/reviews.20or.20other.20things.html#229857091">(Mar 11 2021 at 14:30)</a>:</h4>
<p>I have availability</p>



<a name="229858757"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/189812-t-compiler/wg-rfc-2229/topic/reviews%20or%20other%20things/near/229858757" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/189812-t-compiler/wg-rfc-2229/topic/reviews.20or.20other.20things.html#229858757">(Mar 11 2021 at 14:40)</a>:</h4>
<p>would <time datetime="2021-03-11T21:00:00Z">2021-03-11T16:00:00-05:00</time> work?</p>



<a name="229883614"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/189812-t-compiler/wg-rfc-2229/topic/reviews%20or%20other%20things/near/229883614" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> rocksand <a href="https://zulip-archive.rust-lang.org/stream/189812-t-compiler/wg-rfc-2229/topic/reviews.20or.20other.20things.html#229883614">(Mar 11 2021 at 16:50)</a>:</h4>
<p>Works for me</p>



<a name="229884232"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/189812-t-compiler/wg-rfc-2229/topic/reviews%20or%20other%20things/near/229884232" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Aman Arora <a href="https://zulip-archive.rust-lang.org/stream/189812-t-compiler/wg-rfc-2229/topic/reviews.20or.20other.20things.html#229884232">(Mar 11 2021 at 16:53)</a>:</h4>
<p>I don't think I'll be able to make it</p>



<a name="229893562"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/189812-t-compiler/wg-rfc-2229/topic/reviews%20or%20other%20things/near/229893562" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/189812-t-compiler/wg-rfc-2229/topic/reviews.20or.20other.20things.html#229893562">(Mar 11 2021 at 17:41)</a>:</h4>
<p><span class="user-mention" data-user-id="281950">@Aman Arora</span> <span class="user-mention" data-user-id="307184">@rocksand</span> I could also do <time datetime="2021-03-11T18:30:00Z">2021-03-11T13:30:00-05:00</time></p>



<a name="229893588"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/189812-t-compiler/wg-rfc-2229/topic/reviews%20or%20other%20things/near/229893588" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/189812-t-compiler/wg-rfc-2229/topic/reviews.20or.20other.20things.html#229893588">(Mar 11 2021 at 17:41)</a>:</h4>
<p>but only for 30 min</p>



<a name="229893628"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/189812-t-compiler/wg-rfc-2229/topic/reviews%20or%20other%20things/near/229893628" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/189812-t-compiler/wg-rfc-2229/topic/reviews.20or.20other.20things.html#229893628">(Mar 11 2021 at 17:41)</a>:</h4>
<p>actually i'm fairly flexible, 14:30pm would also be ok (we share a timezone, don't we?)</p>



<a name="229901224"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/189812-t-compiler/wg-rfc-2229/topic/reviews%20or%20other%20things/near/229901224" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> rocksand <a href="https://zulip-archive.rust-lang.org/stream/189812-t-compiler/wg-rfc-2229/topic/reviews.20or.20other.20things.html#229901224">(Mar 11 2021 at 18:29)</a>:</h4>
<p>Anytime works for me. Yes, I believe we are in the same timezone. Aman and I are in EST</p>



<a name="229902083"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/189812-t-compiler/wg-rfc-2229/topic/reviews%20or%20other%20things/near/229902083" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Aman Arora <a href="https://zulip-archive.rust-lang.org/stream/189812-t-compiler/wg-rfc-2229/topic/reviews.20or.20other.20things.html#229902083">(Mar 11 2021 at 18:34)</a>:</h4>
<p>Those can work for me (woops I had forgot to hit send)</p>



<a name="229903214"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/189812-t-compiler/wg-rfc-2229/topic/reviews%20or%20other%20things/near/229903214" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Aman Arora <a href="https://zulip-archive.rust-lang.org/stream/189812-t-compiler/wg-rfc-2229/topic/reviews.20or.20other.20things.html#229903214">(Mar 11 2021 at 18:40)</a>:</h4>
<p>Let's meet at 2:30, since it's late for 1:30</p>



<a name="229911480"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/189812-t-compiler/wg-rfc-2229/topic/reviews%20or%20other%20things/near/229911480" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Aman Arora <a href="https://zulip-archive.rust-lang.org/stream/189812-t-compiler/wg-rfc-2229/topic/reviews.20or.20other.20things.html#229911480">(Mar 11 2021 at 19:33)</a>:</h4>
<p><span class="user-mention" data-user-id="116009">@nikomatsakis</span>  are you avaiable?</p>



<a name="229911528"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/189812-t-compiler/wg-rfc-2229/topic/reviews%20or%20other%20things/near/229911528" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/189812-t-compiler/wg-rfc-2229/topic/reviews.20or.20other.20things.html#229911528">(Mar 11 2021 at 19:33)</a>:</h4>
<p><span class="user-mention" data-user-id="281950">@Aman Arora</span> yeah gimme a second</p>



<a name="229911712"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/189812-t-compiler/wg-rfc-2229/topic/reviews%20or%20other%20things/near/229911712" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/189812-t-compiler/wg-rfc-2229/topic/reviews.20or.20other.20things.html#229911712">(Mar 11 2021 at 19:34)</a>:</h4>
<p>zoom?</p>



<a name="229911742"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/189812-t-compiler/wg-rfc-2229/topic/reviews%20or%20other%20things/near/229911742" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Aman Arora <a href="https://zulip-archive.rust-lang.org/stream/189812-t-compiler/wg-rfc-2229/topic/reviews.20or.20other.20things.html#229911742">(Mar 11 2021 at 19:34)</a>:</h4>
<p>yea, can you send a link?</p>



<a name="231362855"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/189812-t-compiler/wg-rfc-2229/topic/reviews%20or%20other%20things/near/231362855" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Aman Arora <a href="https://zulip-archive.rust-lang.org/stream/189812-t-compiler/wg-rfc-2229/topic/reviews.20or.20other.20things.html#231362855">(Mar 22 2021 at 18:41)</a>:</h4>
<p><span class="user-mention" data-user-id="116009">@nikomatsakis</span>  I open a PR last night for the bug that was filed last week: <a href="https://github.com/rust-lang/rust/pull/83364">https://github.com/rust-lang/rust/pull/83364</a></p>



<a name="231647311"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/189812-t-compiler/wg-rfc-2229/topic/reviews%20or%20other%20things/near/231647311" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/189812-t-compiler/wg-rfc-2229/topic/reviews.20or.20other.20things.html#231647311">(Mar 24 2021 at 14:53)</a>:</h4>
<p>r+'d</p>



<a name="232113892"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/189812-t-compiler/wg-rfc-2229/topic/reviews%20or%20other%20things/near/232113892" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> rocksand <a href="https://zulip-archive.rust-lang.org/stream/189812-t-compiler/wg-rfc-2229/topic/reviews.20or.20other.20things.html#232113892">(Mar 27 2021 at 19:52)</a>:</h4>
<p><span class="user-mention" data-user-id="116009">@nikomatsakis</span> I had to do a find and repace search to fix some of the failing tests (some tests are architecture dependent) and I ended up also modifying some tests that output to <code>.html</code> files. I am not very familiar with those tests so I just wanted to double check with you on whether I should be modifying those files or not. This is one of the html file I modified for instance: <a href="https://github.com/rust-lang/rust/blob/f0254759ca020673823fa39f07b0558f43ee27a2/src/test/run-make-fulldeps/coverage-spanview/expected_mir_dump.closure/closure.main-%7Bclosure%231%7D.-------.InstrumentCoverage.0.html">https://github.com/rust-lang/rust/blob/f0254759ca020673823fa39f07b0558f43ee27a2/src/test/run-make-fulldeps/coverage-spanview/expected_mir_dump.closure/closure.main-%7Bclosure%231%7D.-------.InstrumentCoverage.0.html</a></p>



<a name="232196560"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/189812-t-compiler/wg-rfc-2229/topic/reviews%20or%20other%20things/near/232196560" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/189812-t-compiler/wg-rfc-2229/topic/reviews.20or.20other.20things.html#232196560">(Mar 28 2021 at 22:04)</a>:</h4>
<p>I'm not really familiar with that file tbh</p>



<a name="232196561"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/189812-t-compiler/wg-rfc-2229/topic/reviews%20or%20other%20things/near/232196561" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/189812-t-compiler/wg-rfc-2229/topic/reviews.20or.20other.20things.html#232196561">(Mar 28 2021 at 22:04)</a>:</h4>
<p>hmm</p>



<a name="232196630"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/189812-t-compiler/wg-rfc-2229/topic/reviews%20or%20other%20things/near/232196630" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/189812-t-compiler/wg-rfc-2229/topic/reviews.20or.20other.20things.html#232196630">(Mar 28 2021 at 22:05)</a>:</h4>
<p><a href="https://htmlpreview.github.io/?https://github.com/rust-lang/rust/blob/f0254759ca020673823fa39f07b0558f43ee27a2/src/test/run-make-fulldeps/coverage-spanview/expected_mir_dump.closure/closure.main-{closure%231}.-------.InstrumentCoverage.0.html">here is the rendered form</a></p>



<a name="232462935"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/189812-t-compiler/wg-rfc-2229/topic/reviews%20or%20other%20things/near/232462935" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> rocksand <a href="https://zulip-archive.rust-lang.org/stream/189812-t-compiler/wg-rfc-2229/topic/reviews.20or.20other.20things.html#232462935">(Mar 30 2021 at 17:15)</a>:</h4>
<p><span class="user-mention" data-user-id="116009">@nikomatsakis</span>  I addressed the comments you left on my PR. Let me know if I can go ahead and approve it <a href="https://github.com/rust-lang/rust/pull/83521">https://github.com/rust-lang/rust/pull/83521</a></p>



<a name="232626841"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/189812-t-compiler/wg-rfc-2229/topic/reviews%20or%20other%20things/near/232626841" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/189812-t-compiler/wg-rfc-2229/topic/reviews.20or.20other.20things.html#232626841">(Mar 31 2021 at 16:57)</a>:</h4>
<p><span class="user-mention" data-user-id="307184">@rocksand</span> awesome</p>



<a name="232823856"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/189812-t-compiler/wg-rfc-2229/topic/reviews%20or%20other%20things/near/232823856" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Aman Arora <a href="https://zulip-archive.rust-lang.org/stream/189812-t-compiler/wg-rfc-2229/topic/reviews.20or.20other.20things.html#232823856">(Apr 01 2021 at 20:56)</a>:</h4>
<p>rustfix migrations: <a href="https://github.com/rust-lang/rust/pull/83757">https://github.com/rust-lang/rust/pull/83757</a></p>



<a name="232830246"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/189812-t-compiler/wg-rfc-2229/topic/reviews%20or%20other%20things/near/232830246" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/189812-t-compiler/wg-rfc-2229/topic/reviews.20or.20other.20things.html#232830246">(Apr 01 2021 at 21:52)</a>:</h4>
<p><span class="user-mention" data-user-id="281950">@Aman Arora</span> very nice</p>



<a name="232830350"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/189812-t-compiler/wg-rfc-2229/topic/reviews%20or%20other%20things/near/232830350" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/189812-t-compiler/wg-rfc-2229/topic/reviews.20or.20other.20things.html#232830350">(Apr 01 2021 at 21:53)</a>:</h4>
<p><span class="user-mention" data-user-id="281950">@Aman Arora</span> have we tested the rustfmt output?</p>



<a name="232830495"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/189812-t-compiler/wg-rfc-2229/topic/reviews%20or%20other%20things/near/232830495" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Aman Arora <a href="https://zulip-archive.rust-lang.org/stream/189812-t-compiler/wg-rfc-2229/topic/reviews.20or.20other.20things.html#232830495">(Apr 01 2021 at 21:54)</a>:</h4>
<p>I forgot, doing it now</p>



<a name="232831660"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/189812-t-compiler/wg-rfc-2229/topic/reviews%20or%20other%20things/near/232831660" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Aman Arora <a href="https://zulip-archive.rust-lang.org/stream/189812-t-compiler/wg-rfc-2229/topic/reviews.20or.20other.20things.html#232831660">(Apr 01 2021 at 22:05)</a>:</h4>
<p>It doesn't <span aria-label="frown" class="emoji emoji-1f641" role="img" title="frown">:frown:</span><br>
Adding some extra logic, shouldn't be rust</p>
<p>This is what is looks like after fmt right now</p>
<div class="codehilite" data-code-language="Rust"><pre><span></span><code><span class="k">fn</span> <span class="nf">test7_drop_non_drop_aggregate_need_migration</span><span class="p">()</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="kd">let</span><span class="w"> </span><span class="n">t</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="nb">String</span>::<span class="n">new</span><span class="p">(),</span><span class="w"> </span><span class="nb">String</span>::<span class="n">new</span><span class="p">(),</span><span class="w"> </span><span class="mi">0</span><span class="k">i32</span><span class="p">);</span><span class="w"></span>

<span class="w">    </span><span class="kd">let</span><span class="w"> </span><span class="n">c</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">        </span><span class="kd">let</span><span class="w"> </span><span class="n">_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">&amp;</span><span class="n">t</span><span class="p">;</span><span class="w"></span>
<span class="w">        </span><span class="p">{</span><span class="w"></span>
<span class="w">            </span><span class="c1">//~^ ERROR: drop order affected for closure because of `capture_disjoint_fields`</span>
<span class="w">            </span><span class="c1">//~| HELP: `let _ = &amp;t` causes `t` to be fully captured</span>
<span class="w">            </span><span class="kd">let</span><span class="w"> </span><span class="n">_t</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">t</span><span class="p">.</span><span class="mi">0</span><span class="p">;</span><span class="w"></span>
<span class="w">        </span><span class="p">}</span><span class="w"></span>
<span class="w">    </span><span class="p">};</span><span class="w"></span>

<span class="w">    </span><span class="n">c</span><span class="p">();</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>
</code></pre></div>



<a name="232837699"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/189812-t-compiler/wg-rfc-2229/topic/reviews%20or%20other%20things/near/232837699" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Aman Arora <a href="https://zulip-archive.rust-lang.org/stream/189812-t-compiler/wg-rfc-2229/topic/reviews.20or.20other.20things.html#232837699">(Apr 01 2021 at 23:08)</a>:</h4>
<p>i got to work, I'll update the PR by tomorrow morning</p>



<a name="232848926"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/189812-t-compiler/wg-rfc-2229/topic/reviews%20or%20other%20things/near/232848926" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Aman Arora <a href="https://zulip-archive.rust-lang.org/stream/189812-t-compiler/wg-rfc-2229/topic/reviews.20or.20other.20things.html#232848926">(Apr 02 2021 at 01:33)</a>:</h4>
<p>Updated PR with the block fix and your suggestion for the new wording as well</p>



<a name="232948307"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/189812-t-compiler/wg-rfc-2229/topic/reviews%20or%20other%20things/near/232948307" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/189812-t-compiler/wg-rfc-2229/topic/reviews.20or.20other.20things.html#232948307">(Apr 02 2021 at 20:33)</a>:</h4>
<p><span class="user-mention" data-user-id="281950">@Aman Arora</span> r+'d</p>



<a name="232948394"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/189812-t-compiler/wg-rfc-2229/topic/reviews%20or%20other%20things/near/232948394" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Aman Arora <a href="https://zulip-archive.rust-lang.org/stream/189812-t-compiler/wg-rfc-2229/topic/reviews.20or.20other.20things.html#232948394">(Apr 02 2021 at 20:34)</a>:</h4>
<p>Thanks!</p>



<a name="236767826"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/189812-t-compiler/wg-rfc-2229/topic/reviews%20or%20other%20things/near/236767826" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> rocksand <a href="https://zulip-archive.rust-lang.org/stream/189812-t-compiler/wg-rfc-2229/topic/reviews.20or.20other.20things.html#236767826">(Apr 30 2021 at 00:24)</a>:</h4>
<p><span class="user-mention" data-user-id="116009">@nikomatsakis</span>  The auto traits and clone trait migrations PR is now up: <a href="https://github.com/rust-lang/rust/pull/84730">https://github.com/rust-lang/rust/pull/84730</a></p>



<a name="236770234"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/189812-t-compiler/wg-rfc-2229/topic/reviews%20or%20other%20things/near/236770234" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Aman Arora <a href="https://zulip-archive.rust-lang.org/stream/189812-t-compiler/wg-rfc-2229/topic/reviews.20or.20other.20things.html#236770234">(Apr 30 2021 at 00:58)</a>:</h4>
<p>First draft for the blog: <a href="https://hackmd.io/g0odgclDSaODOvBSZntltg">https://hackmd.io/g0odgclDSaODOvBSZntltg</a></p>



<a name="236831818"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/189812-t-compiler/wg-rfc-2229/topic/reviews%20or%20other%20things/near/236831818" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/189812-t-compiler/wg-rfc-2229/topic/reviews.20or.20other.20things.html#236831818">(Apr 30 2021 at 13:14)</a>:</h4>
<p><span class="user-mention" data-user-id="307184">@rocksand</span> very nice!</p>



<a name="240338374"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/189812-t-compiler/wg-rfc-2229/topic/reviews%20or%20other%20things/near/240338374" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> rocksand <a href="https://zulip-archive.rust-lang.org/stream/189812-t-compiler/wg-rfc-2229/topic/reviews.20or.20other.20things.html#240338374">(May 26 2021 at 15:00)</a>:</h4>
<p><span class="user-mention" data-user-id="116009">@nikomatsakis</span>  I have the fix for issue 85435 up for review (<a href="https://github.com/rust-lang/rust/pull/85724">https://github.com/rust-lang/rust/pull/85724</a>). I still need to wait for PR <a href="https://github.com/rust-lang/rust/pull/85564">https://github.com/rust-lang/rust/pull/85564</a> to merge into master before I can remove the readded feature gate though</p>



<a name="240346364"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/189812-t-compiler/wg-rfc-2229/topic/reviews%20or%20other%20things/near/240346364" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/189812-t-compiler/wg-rfc-2229/topic/reviews.20or.20other.20things.html#240346364">(May 26 2021 at 15:49)</a>:</h4>
<p>I'm a bit confused <span class="user-mention" data-user-id="307184">@rocksand</span></p>



<a name="240346416"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/189812-t-compiler/wg-rfc-2229/topic/reviews%20or%20other%20things/near/240346416" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/189812-t-compiler/wg-rfc-2229/topic/reviews.20or.20other.20things.html#240346416">(May 26 2021 at 15:49)</a>:</h4>
<p>The PR looks ok, but it sounds like there is another underlying bug?</p>



<a name="243206691"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/189812-t-compiler/wg-rfc-2229/topic/reviews%20or%20other%20things/near/243206691" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Aman Arora <a href="https://zulip-archive.rust-lang.org/stream/189812-t-compiler/wg-rfc-2229/topic/reviews.20or.20other.20things.html#243206691">(Jun 18 2021 at 20:45)</a>:</h4>
<p><a href="https://github.com/rust-lang/rust/pull/86445/files">https://github.com/rust-lang/rust/pull/86445/files</a><br>
<span class="user-mention" data-user-id="116009">@nikomatsakis</span>  box fix pr</p>



<a name="243394351"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/189812-t-compiler/wg-rfc-2229/topic/reviews%20or%20other%20things/near/243394351" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/189812-t-compiler/wg-rfc-2229/topic/reviews.20or.20other.20things.html#243394351">(Jun 21 2021 at 14:54)</a>:</h4>
<p><span class="user-mention" data-user-id="281950">@Aman Arora</span> I left a review, I have a few questions</p>



<a name="243476563"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/189812-t-compiler/wg-rfc-2229/topic/reviews%20or%20other%20things/near/243476563" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Aman Arora <a href="https://zulip-archive.rust-lang.org/stream/189812-t-compiler/wg-rfc-2229/topic/reviews.20or.20other.20things.html#243476563">(Jun 22 2021 at 06:31)</a>:</h4>
<p>updated the PR</p>



<a name="244942765"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/189812-t-compiler/wg-rfc-2229/topic/reviews%20or%20other%20things/near/244942765" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> rocksand <a href="https://zulip-archive.rust-lang.org/stream/189812-t-compiler/wg-rfc-2229/topic/reviews.20or.20other.20things.html#244942765">(Jul 05 2021 at 14:30)</a>:</h4>
<p><span class="user-mention" data-user-id="116009">@nikomatsakis</span>  The auto traits migration fix is up for review <a href="https://github.com/rust-lang/rust/pull/86869">https://github.com/rust-lang/rust/pull/86869</a></p>



<a name="244969406"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/189812-t-compiler/wg-rfc-2229/topic/reviews%20or%20other%20things/near/244969406" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Aman Arora <a href="https://zulip-archive.rust-lang.org/stream/189812-t-compiler/wg-rfc-2229/topic/reviews.20or.20other.20things.html#244969406">(Jul 05 2021 at 19:58)</a>:</h4>
<p>FYI I have two open PRs that still needing review:</p>
<p>1)  I realized that the profile closures flag doesn't work as expected if the feature is enabled. I have created a fixup PR here: <a href="https://github.com/rust-lang/rust/pull/86818">https://github.com/rust-lang/rust/pull/86818</a>.</p>
<p>Do you think we should talk about this flag and optimization someone can make based on the profile in the edition guide? I have what i was thinking written down here: <a href="https://github.com/rust-lang/edition-guide/pull/246#discussion_r663139817">https://github.com/rust-lang/edition-guide/pull/246#discussion_r663139817</a></p>
<p>2) PR for the optimization: <a href="https://github.com/rust-lang/rust/pull/86701">https://github.com/rust-lang/rust/pull/86701</a></p>



<a name="244969426"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/189812-t-compiler/wg-rfc-2229/topic/reviews%20or%20other%20things/near/244969426" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Aman Arora <a href="https://zulip-archive.rust-lang.org/stream/189812-t-compiler/wg-rfc-2229/topic/reviews.20or.20other.20things.html#244969426">(Jul 05 2021 at 19:58)</a>:</h4>
<p>Also for the lang team update, what all should we let them know outside of optimizaiton and -Zprofile-closures</p>



<a name="244974212"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/189812-t-compiler/wg-rfc-2229/topic/reviews%20or%20other%20things/near/244974212" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/189812-t-compiler/wg-rfc-2229/topic/reviews.20or.20other.20things.html#244974212">(Jul 05 2021 at 21:04)</a>:</h4>
<p>I'll take a look at <a href="https://github.com/rust-lang/rust/issues/86701">#86701</a></p>



<a name="244974725"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/189812-t-compiler/wg-rfc-2229/topic/reviews%20or%20other%20things/near/244974725" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/189812-t-compiler/wg-rfc-2229/topic/reviews.20or.20other.20things.html#244974725">(Jul 05 2021 at 21:12)</a>:</h4>
<p><span class="user-mention" data-user-id="281950">@Aman Arora</span> left a few nits with some comments.</p>



<a name="245376082"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/189812-t-compiler/wg-rfc-2229/topic/reviews%20or%20other%20things/near/245376082" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> rocksand <a href="https://zulip-archive.rust-lang.org/stream/189812-t-compiler/wg-rfc-2229/topic/reviews.20or.20other.20things.html#245376082">(Jul 08 2021 at 21:41)</a>:</h4>
<p><span class="user-mention" data-user-id="116009">@nikomatsakis</span>  The migration lint improvement PR is up for review: <a href="https://github.com/rust-lang/rust/pull/86965">https://github.com/rust-lang/rust/pull/86965</a></p>



<a name="245422619"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/189812-t-compiler/wg-rfc-2229/topic/reviews%20or%20other%20things/near/245422619" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/189812-t-compiler/wg-rfc-2229/topic/reviews.20or.20other.20things.html#245422619">(Jul 09 2021 at 09:46)</a>:</h4>
<p><span class="user-mention" data-user-id="307184">@rocksand</span> r+, looks great!</p>



<a name="245619016"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/189812-t-compiler/wg-rfc-2229/topic/reviews%20or%20other%20things/near/245619016" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Aman Arora <a href="https://zulip-archive.rust-lang.org/stream/189812-t-compiler/wg-rfc-2229/topic/reviews.20or.20other.20things.html#245619016">(Jul 11 2021 at 17:57)</a>:</h4>
<p>I probably won't be available this week</p>



<a name="245735506"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/189812-t-compiler/wg-rfc-2229/topic/reviews%20or%20other%20things/near/245735506" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/189812-t-compiler/wg-rfc-2229/topic/reviews.20or.20other.20things.html#245735506">(Jul 12 2021 at 19:25)</a>:</h4>
<p>OK, let's cancel the meeting</p>



<a name="245735525"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/189812-t-compiler/wg-rfc-2229/topic/reviews%20or%20other%20things/near/245735525" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/189812-t-compiler/wg-rfc-2229/topic/reviews.20or.20other.20things.html#245735525">(Jul 12 2021 at 19:25)</a>:</h4>
<p>We're in good shape from what I can tell</p>



<a name="245736073"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/189812-t-compiler/wg-rfc-2229/topic/reviews%20or%20other%20things/near/245736073" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Aman Arora <a href="https://zulip-archive.rust-lang.org/stream/189812-t-compiler/wg-rfc-2229/topic/reviews.20or.20other.20things.html#245736073">(Jul 12 2021 at 19:29)</a>:</h4>
<p>So <span class="user-mention" data-user-id="282558">@Dhruv Jauhar</span> started looking into insignificant destructors. There are some places within the compiler that'd require migration. Is there way to automatically apply the lint suggest to the entire compiler automatically, just to get an idea of what's affected?</p>



<a name="245736136"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/189812-t-compiler/wg-rfc-2229/topic/reviews%20or%20other%20things/near/245736136" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Aman Arora <a href="https://zulip-archive.rust-lang.org/stream/189812-t-compiler/wg-rfc-2229/topic/reviews.20or.20other.20things.html#245736136">(Jul 12 2021 at 19:29)</a>:</h4>
<p>Right now the compile would stop at the crate that requires migration</p>



<a name="245744821"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/189812-t-compiler/wg-rfc-2229/topic/reviews%20or%20other%20things/near/245744821" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/189812-t-compiler/wg-rfc-2229/topic/reviews.20or.20other.20things.html#245744821">(Jul 12 2021 at 20:37)</a>:</h4>
<p><span class="user-mention" data-user-id="281950">@Aman Arora</span> I don't know if there's a way to migrate all the crates; <span class="user-mention" data-user-id="120518">@Eric Huss</span> might know</p>



<a name="245754312"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/189812-t-compiler/wg-rfc-2229/topic/reviews%20or%20other%20things/near/245754312" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Eric Huss <a href="https://zulip-archive.rust-lang.org/stream/189812-t-compiler/wg-rfc-2229/topic/reviews.20or.20other.20things.html#245754312">(Jul 12 2021 at 21:44)</a>:</h4>
<p>I'm not sure what is being asked. If you want to try to run <code>cargo fix</code> on rustc itself to test-drive some fixes, it's a little awkward right now (<code>./x.py test</code> is kinda broken). You can probably run something like this:</p>
<div class="codehilite"><pre><span></span><code>RUSTFLAGS_NOT_BOOTSTRAP=&quot;-Wrust_2021_incompatible_closure_captures&quot; CARGOFLAGS_NOT_BOOTSTRAP=&quot;--lib&quot; ./x.py fix  --stage=1
</code></pre></div>



<a name="245754397"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/189812-t-compiler/wg-rfc-2229/topic/reviews%20or%20other%20things/near/245754397" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Aman Arora <a href="https://zulip-archive.rust-lang.org/stream/189812-t-compiler/wg-rfc-2229/topic/reviews.20or.20other.20things.html#245754397">(Jul 12 2021 at 21:45)</a>:</h4>
<p>Thank you! </p>
<p>cc <span class="user-mention" data-user-id="282466">@Dhruv Jauhar</span></p>



<a name="246116200"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/189812-t-compiler/wg-rfc-2229/topic/reviews%20or%20other%20things/near/246116200" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> rocksand <a href="https://zulip-archive.rust-lang.org/stream/189812-t-compiler/wg-rfc-2229/topic/reviews.20or.20other.20things.html#246116200">(Jul 15 2021 at 16:04)</a>:</h4>
<p><span class="user-mention" data-user-id="116009">@nikomatsakis</span>  Someone found an ICE in pattern matching when the feature is enabled. I have opened up a PR to fix the issue <a href="https://github.com/rust-lang/rust/pull/87161">https://github.com/rust-lang/rust/pull/87161</a></p>



<a name="246147304"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/189812-t-compiler/wg-rfc-2229/topic/reviews%20or%20other%20things/near/246147304" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Aman Arora <a href="https://zulip-archive.rust-lang.org/stream/189812-t-compiler/wg-rfc-2229/topic/reviews.20or.20other.20things.html#246147304">(Jul 15 2021 at 19:58)</a>:</h4>
<p><span class="user-mention" data-user-id="116009">@nikomatsakis</span> <span class="user-mention" data-user-id="307184">@rocksand</span>  is there a time before noon that works as a meeting time?</p>



<a name="246147345"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/189812-t-compiler/wg-rfc-2229/topic/reviews%20or%20other%20things/near/246147345" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Aman Arora <a href="https://zulip-archive.rust-lang.org/stream/189812-t-compiler/wg-rfc-2229/topic/reviews.20or.20other.20things.html#246147345">(Jul 15 2021 at 19:58)</a>:</h4>
<p>Might be hard for me to meet at the current meeting time</p>



<a name="246148662"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/189812-t-compiler/wg-rfc-2229/topic/reviews%20or%20other%20things/near/246148662" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> rocksand <a href="https://zulip-archive.rust-lang.org/stream/189812-t-compiler/wg-rfc-2229/topic/reviews.20or.20other.20things.html#246148662">(Jul 15 2021 at 20:08)</a>:</h4>
<p>Any day works for me</p>



<a name="246160194"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/189812-t-compiler/wg-rfc-2229/topic/reviews%20or%20other%20things/near/246160194" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/189812-t-compiler/wg-rfc-2229/topic/reviews.20or.20other.20things.html#246160194">(Jul 15 2021 at 21:40)</a>:</h4>
<p>hmm</p>



<a name="246160209"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/189812-t-compiler/wg-rfc-2229/topic/reviews%20or%20other%20things/near/246160209" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/189812-t-compiler/wg-rfc-2229/topic/reviews.20or.20other.20things.html#246160209">(Jul 15 2021 at 21:40)</a>:</h4>
<p><span class="user-mention" data-user-id="281950">@Aman Arora</span> do you mean East Coast time?</p>



<a name="246160246"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/189812-t-compiler/wg-rfc-2229/topic/reviews%20or%20other%20things/near/246160246" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Aman Arora <a href="https://zulip-archive.rust-lang.org/stream/189812-t-compiler/wg-rfc-2229/topic/reviews.20or.20other.20things.html#246160246">(Jul 15 2021 at 21:40)</a>:</h4>
<p>Yes noon east coast time</p>



<a name="246160280"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/189812-t-compiler/wg-rfc-2229/topic/reviews%20or%20other%20things/near/246160280" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/189812-t-compiler/wg-rfc-2229/topic/reviews.20or.20other.20things.html#246160280">(Jul 15 2021 at 21:41)</a>:</h4>
<p>let me check my calendar</p>



<a name="246160297"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/189812-t-compiler/wg-rfc-2229/topic/reviews%20or%20other%20things/near/246160297" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/189812-t-compiler/wg-rfc-2229/topic/reviews.20or.20other.20things.html#246160297">(Jul 15 2021 at 21:41)</a>:</h4>
<p>I could do 11</p>



<a name="246160299"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/189812-t-compiler/wg-rfc-2229/topic/reviews%20or%20other%20things/near/246160299" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Aman Arora <a href="https://zulip-archive.rust-lang.org/stream/189812-t-compiler/wg-rfc-2229/topic/reviews.20or.20other.20things.html#246160299">(Jul 15 2021 at 21:41)</a>:</h4>
<p>That works for me</p>



<a name="246160363"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/189812-t-compiler/wg-rfc-2229/topic/reviews%20or%20other%20things/near/246160363" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Aman Arora <a href="https://zulip-archive.rust-lang.org/stream/189812-t-compiler/wg-rfc-2229/topic/reviews.20or.20other.20things.html#246160363">(Jul 15 2021 at 21:42)</a>:</h4>
<p>Thank you</p>



<a name="246160367"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/189812-t-compiler/wg-rfc-2229/topic/reviews%20or%20other%20things/near/246160367" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/189812-t-compiler/wg-rfc-2229/topic/reviews.20or.20other.20things.html#246160367">(Jul 15 2021 at 21:42)</a>:</h4>
<p>Ok. I'm going to delete the existing calendar event and create a new one, I think, that has the Zoom URL attached</p>



<a name="246160371"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/189812-t-compiler/wg-rfc-2229/topic/reviews%20or%20other%20things/near/246160371" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/189812-t-compiler/wg-rfc-2229/topic/reviews.20or.20other.20things.html#246160371">(Jul 15 2021 at 21:42)</a>:</h4>
<p>I'll put it on the compiler team calendar, too</p>



<a name="246160379"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/189812-t-compiler/wg-rfc-2229/topic/reviews%20or%20other%20things/near/246160379" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Aman Arora <a href="https://zulip-archive.rust-lang.org/stream/189812-t-compiler/wg-rfc-2229/topic/reviews.20or.20other.20things.html#246160379">(Jul 15 2021 at 21:42)</a>:</h4>
<p>Sounds good</p>



<a name="246160651"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/189812-t-compiler/wg-rfc-2229/topic/reviews%20or%20other%20things/near/246160651" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/189812-t-compiler/wg-rfc-2229/topic/reviews.20or.20other.20things.html#246160651">(Jul 15 2021 at 21:45)</a>:</h4>
<p>I've also deleted Aug 4/11 as I will be on PTO</p>



<a name="246160751"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/189812-t-compiler/wg-rfc-2229/topic/reviews%20or%20other%20things/near/246160751" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Aman Arora <a href="https://zulip-archive.rust-lang.org/stream/189812-t-compiler/wg-rfc-2229/topic/reviews.20or.20other.20things.html#246160751">(Jul 15 2021 at 21:46)</a>:</h4>
<p>Okay</p>



<a name="246160817"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/189812-t-compiler/wg-rfc-2229/topic/reviews%20or%20other%20things/near/246160817" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/189812-t-compiler/wg-rfc-2229/topic/reviews.20or.20other.20things.html#246160817">(Jul 15 2021 at 21:47)</a>:</h4>
<p>btw, we have a weekly time, but just in case, I've created a <a href="https://calendly.com/nikomatsakis/office-hours">office hours</a> system</p>



<a name="246160949"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/189812-t-compiler/wg-rfc-2229/topic/reviews%20or%20other%20things/near/246160949" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Aman Arora <a href="https://zulip-archive.rust-lang.org/stream/189812-t-compiler/wg-rfc-2229/topic/reviews.20or.20other.20things.html#246160949">(Jul 15 2021 at 21:48)</a>:</h4>
<p>Awesome</p>



<a name="246473089"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/189812-t-compiler/wg-rfc-2229/topic/reviews%20or%20other%20things/near/246473089" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> rocksand <a href="https://zulip-archive.rust-lang.org/stream/189812-t-compiler/wg-rfc-2229/topic/reviews.20or.20other.20things.html#246473089">(Jul 19 2021 at 15:50)</a>:</h4>
<p><span class="user-mention" data-user-id="116009">@nikomatsakis</span>  Have you had the chance to take a look at my rust reference PR yet? <a href="https://github.com/rust-lang/reference/pull/1059">https://github.com/rust-lang/reference/pull/1059</a> Also, <span class="user-mention" data-user-id="281950">@Aman Arora</span> and I were wondering if the plan was still to release a blog post about RFC2229</p>



<a name="246473155"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/189812-t-compiler/wg-rfc-2229/topic/reviews%20or%20other%20things/near/246473155" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/189812-t-compiler/wg-rfc-2229/topic/reviews.20or.20other.20things.html#246473155">(Jul 19 2021 at 15:50)</a>:</h4>
<p>No, let me take a look</p>



<a name="246473448"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/189812-t-compiler/wg-rfc-2229/topic/reviews%20or%20other%20things/near/246473448" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/189812-t-compiler/wg-rfc-2229/topic/reviews.20or.20other.20things.html#246473448">(Jul 19 2021 at 15:52)</a>:</h4>
<p><span class="user-mention" data-user-id="307184">@rocksand</span> this looks good; normally we don't land reference PRs until the thing is stabilized. One comment is that it'd be nice to include the "formal algorithm" that we came up with in our last meeting.</p>



<a name="246473505"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/189812-t-compiler/wg-rfc-2229/topic/reviews%20or%20other%20things/near/246473505" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/189812-t-compiler/wg-rfc-2229/topic/reviews.20or.20other.20things.html#246473505">(Jul 19 2021 at 15:53)</a>:</h4>
<p>Left a review.</p>



<a name="246474190"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/189812-t-compiler/wg-rfc-2229/topic/reviews%20or%20other%20things/near/246474190" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> rocksand <a href="https://zulip-archive.rust-lang.org/stream/189812-t-compiler/wg-rfc-2229/topic/reviews.20or.20other.20things.html#246474190">(Jul 19 2021 at 15:58)</a>:</h4>
<p><span class="user-mention silent" data-user-id="116009">nikomatsakis</span> <a href="#narrow/stream/189812-t-compiler.2Fwg-rfc-2229/topic/reviews.20or.20other.20things/near/246473448">said</a>:</p>
<blockquote>
<p><span class="user-mention silent" data-user-id="307184">rocksand</span> this looks good; normally we don't land reference PRs until the thing is stabilized. One comment is that it'd be nice to include the "formal algorithm" that we came up with in our last meeting.</p>
</blockquote>
<p>Good point, I'll add that to the PR</p>



<a name="246560794"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/189812-t-compiler/wg-rfc-2229/topic/reviews%20or%20other%20things/near/246560794" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Aman Arora <a href="https://zulip-archive.rust-lang.org/stream/189812-t-compiler/wg-rfc-2229/topic/reviews.20or.20other.20things.html#246560794">(Jul 20 2021 at 09:05)</a>:</h4>
<p><span class="user-mention silent" data-user-id="116009">nikomatsakis</span> <a href="#narrow/stream/189812-t-compiler.2Fwg-rfc-2229/topic/reviews.20or.20other.20things/near/246473505">said</a>:</p>
<blockquote>
<p>Left a review.</p>
</blockquote>
<p>I have updated the PR. <a href="https://github.com/rust-lang/reference/pull/1059">https://github.com/rust-lang/reference/pull/1059</a></p>
<p>There is a testcase failing because it needs edition 2021 and im not sure how to get around it needing unstable options</p>



<a name="246560946"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/189812-t-compiler/wg-rfc-2229/topic/reviews%20or%20other%20things/near/246560946" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Aman Arora <a href="https://zulip-archive.rust-lang.org/stream/189812-t-compiler/wg-rfc-2229/topic/reviews.20or.20other.20things.html#246560946">(Jul 20 2021 at 09:07)</a>:</h4>
<p>Not sure if it helps review but I added two commits</p>
<ul>
<li>First verbatim copy/paste of the algorithm</li>
<li>Seconds edits that I made on top</li>
</ul>



<a name="247166243"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/189812-t-compiler/wg-rfc-2229/topic/reviews%20or%20other%20things/near/247166243" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Aman Arora <a href="https://zulip-archive.rust-lang.org/stream/189812-t-compiler/wg-rfc-2229/topic/reviews.20or.20other.20things.html#247166243">(Jul 26 2021 at 06:05)</a>:</h4>
<p>Pr for the <a href="https://github.com/rust-lang/rust/issues/87378">#87378</a> <a href="https://github.com/rust-lang/rust/pull/87469">https://github.com/rust-lang/rust/pull/87469</a></p>



<a name="247196931"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/189812-t-compiler/wg-rfc-2229/topic/reviews%20or%20other%20things/near/247196931" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/189812-t-compiler/wg-rfc-2229/topic/reviews.20or.20other.20things.html#247196931">(Jul 26 2021 at 12:48)</a>:</h4>
<p>r+'d</p>



<a name="247607766"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/189812-t-compiler/wg-rfc-2229/topic/reviews%20or%20other%20things/near/247607766" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> rocksand <a href="https://zulip-archive.rust-lang.org/stream/189812-t-compiler/wg-rfc-2229/topic/reviews.20or.20other.20things.html#247607766">(Jul 29 2021 at 16:34)</a>:</h4>
<p><span class="user-mention" data-user-id="116009">@nikomatsakis</span>  I fixed the tidy error on my PR: <a href="https://github.com/rust-lang/rust/pull/87554">https://github.com/rust-lang/rust/pull/87554</a></p>



<a name="247608151"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/189812-t-compiler/wg-rfc-2229/topic/reviews%20or%20other%20things/near/247608151" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> lqd <a href="https://zulip-archive.rust-lang.org/stream/189812-t-compiler/wg-rfc-2229/topic/reviews.20or.20other.20things.html#247608151">(Jul 29 2021 at 16:36)</a>:</h4>
<p>I'll trigger bors</p>



<a name="249485818"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/189812-t-compiler/wg-rfc-2229/topic/reviews%20or%20other%20things/near/249485818" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> rocksand <a href="https://zulip-archive.rust-lang.org/stream/189812-t-compiler/wg-rfc-2229/topic/reviews.20or.20other.20things.html#249485818">(Aug 15 2021 at 01:12)</a>:</h4>
<p><span class="user-mention" data-user-id="116009">@nikomatsakis</span> cc <span class="user-mention" data-user-id="281950">@Aman Arora</span> <br>
There are a few PRs that need review:</p>
<ul>
<li><a href="https://github.com/rust-lang/rust/pull/88039">https://github.com/rust-lang/rust/pull/88039</a> -&gt; fix for <a href="https://github.com/rust-lang/rust/issues/87987">ICE: unwrap on an Err PlaceBuilder</a></li>
<li><a href="https://github.com/rust-lang/rust/pull/87996">https://github.com/rust-lang/rust/pull/87996</a> -&gt; fix for <a href="https://github.com/rust-lang/rust/issues/87988">ICE: error with const in 2021 closure capture</a></li>
</ul>
<p>Also, there are a few things which I think may be worth discussing at our next meeting:</p>
<ul>
<li>Going over <a href="https://github.com/rust-lang/rust/blob/2e61659bd1f3998520abc77f5459c529083a7a3d/compiler/rustc_typeck/src/expr_use_visitor.rs#L243-L289">all the cases that require a match discriminant to be read</a>. A lot of recent ICEs involved this part of the code, so I think it would be nice to double check that we are not missing any other edge cases.</li>
<li><a href="https://github.com/rust-lang/rust/issues/87814">Issue 87814</a> -&gt; I am not sure we have diagnosed the root caused yet</li>
<li><a href="https://github.com/rust-lang/project-rfc-2229/issues/57">Issue 57</a> -&gt; How to handle lint warning inconsistencies with let statement wildcards</li>
</ul>



<a name="249737983"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/189812-t-compiler/wg-rfc-2229/topic/reviews%20or%20other%20things/near/249737983" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Aman Arora <a href="https://zulip-archive.rust-lang.org/stream/189812-t-compiler/wg-rfc-2229/topic/reviews.20or.20other.20things.html#249737983">(Aug 17 2021 at 15:47)</a>:</h4>
<p>I also created a spreadsheet where I went through all public stblib that implements Drop and classified them as sig/insig: <a href="https://docs.google.com/spreadsheets/d/19edb9r5lo2UqMrCOVjV0fwcSdS-R7qvKNL76q7tO8VA/edit?usp=sharing">https://docs.google.com/spreadsheets/d/19edb9r5lo2UqMrCOVjV0fwcSdS-R7qvKNL76q7tO8VA/edit?usp=sharing</a></p>



<a name="249738132"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/189812-t-compiler/wg-rfc-2229/topic/reviews%20or%20other%20things/near/249738132" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Aman Arora <a href="https://zulip-archive.rust-lang.org/stream/189812-t-compiler/wg-rfc-2229/topic/reviews.20or.20other.20things.html#249738132">(Aug 17 2021 at 15:48)</a>:</h4>
<p>Another thing we should go over is all the diffenret kind of patterns and look for any edge cases, couple bugs thtat came around recenely had different uses of patterns  that we hadn't considered before</p>



<a name="250426825"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/189812-t-compiler/wg-rfc-2229/topic/reviews%20or%20other%20things/near/250426825" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Aman Arora <a href="https://zulip-archive.rust-lang.org/stream/189812-t-compiler/wg-rfc-2229/topic/reviews.20or.20other.20things.html#250426825">(Aug 23 2021 at 23:48)</a>:</h4>
<p><span class="user-mention silent" data-user-id="281950">Aman Arora</span> <a href="#narrow/stream/189812-t-compiler.2Fwg-rfc-2229/topic/reviews.20or.20other.20things/near/249737983">said</a>:</p>
<blockquote>
<p>I also created a spreadsheet where I went through all public stblib that implements Drop and classified them as sig/insig: <a href="https://docs.google.com/spreadsheets/d/19edb9r5lo2UqMrCOVjV0fwcSdS-R7qvKNL76q7tO8VA/edit?usp=sharing">https://docs.google.com/spreadsheets/d/19edb9r5lo2UqMrCOVjV0fwcSdS-R7qvKNL76q7tO8VA/edit?usp=sharing</a></p>
</blockquote>
<p><span class="user-mention" data-user-id="116009">@nikomatsakis</span>  we have this pending as well</p>



<a name="253909971"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/189812-t-compiler/wg-rfc-2229/topic/reviews%20or%20other%20things/near/253909971" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Aman Arora <a href="https://zulip-archive.rust-lang.org/stream/189812-t-compiler/wg-rfc-2229/topic/reviews.20or.20other.20things.html#253909971">(Sep 19 2021 at 02:27)</a>:</h4>
<p><span class="user-mention" data-user-id="116122">@simulacrum</span> right insig dtor never got applied. Can you take a look at confirm that this categorization looks alright</p>



<a name="253909974"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/189812-t-compiler/wg-rfc-2229/topic/reviews%20or%20other%20things/near/253909974" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Aman Arora <a href="https://zulip-archive.rust-lang.org/stream/189812-t-compiler/wg-rfc-2229/topic/reviews.20or.20other.20things.html#253909974">(Sep 19 2021 at 02:27)</a>:</h4>
<p>PR should be quick after that</p>



<a name="253910119"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/189812-t-compiler/wg-rfc-2229/topic/reviews%20or%20other%20things/near/253910119" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> simulacrum <a href="https://zulip-archive.rust-lang.org/stream/189812-t-compiler/wg-rfc-2229/topic/reviews.20or.20other.20things.html#253910119">(Sep 19 2021 at 02:30)</a>:</h4>
<p>Hm, I didn't look at the impl, but we properly handle that <code>Vec&lt;MutexGuard&gt;</code> is significant even if Vec is marked, right?</p>



<a name="253910128"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/189812-t-compiler/wg-rfc-2229/topic/reviews%20or%20other%20things/near/253910128" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> simulacrum <a href="https://zulip-archive.rust-lang.org/stream/189812-t-compiler/wg-rfc-2229/topic/reviews.20or.20other.20things.html#253910128">(Sep 19 2021 at 02:30)</a>:</h4>
<p>At a glance all the insignificant types look good to me</p>



<a name="253910166"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/189812-t-compiler/wg-rfc-2229/topic/reviews%20or%20other%20things/near/253910166" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> simulacrum <a href="https://zulip-archive.rust-lang.org/stream/189812-t-compiler/wg-rfc-2229/topic/reviews.20or.20other.20things.html#253910166">(Sep 19 2021 at 02:31)</a>:</h4>
<p>(my guess is that we'll find more as we start migrating, but we can get a PR up and then add to it - I'm hoping to get rustc migrated tomorrow fully, which will get us some good data as well)</p>



<a name="253910407"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/189812-t-compiler/wg-rfc-2229/topic/reviews%20or%20other%20things/near/253910407" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Aman Arora <a href="https://zulip-archive.rust-lang.org/stream/189812-t-compiler/wg-rfc-2229/topic/reviews.20or.20other.20things.html#253910407">(Sep 19 2021 at 02:36)</a>:</h4>
<p>Sure I'll create a PR</p>



<a name="253910439"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/189812-t-compiler/wg-rfc-2229/topic/reviews%20or%20other%20things/near/253910439" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Aman Arora <a href="https://zulip-archive.rust-lang.org/stream/189812-t-compiler/wg-rfc-2229/topic/reviews.20or.20other.20things.html#253910439">(Sep 19 2021 at 02:37)</a>:</h4>
<p>And yes if a type generic but the type param is significant we handle the specialized type as significan</p>



<a name="253916015"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/189812-t-compiler/wg-rfc-2229/topic/reviews%20or%20other%20things/near/253916015" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> simulacrum <a href="https://zulip-archive.rust-lang.org/stream/189812-t-compiler/wg-rfc-2229/topic/reviews.20or.20other.20things.html#253916015">(Sep 19 2021 at 04:18)</a>:</h4>
<p>Great!</p>



<a name="254026229"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/189812-t-compiler/wg-rfc-2229/topic/reviews%20or%20other%20things/near/254026229" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Aman Arora <a href="https://zulip-archive.rust-lang.org/stream/189812-t-compiler/wg-rfc-2229/topic/reviews.20or.20other.20things.html#254026229">(Sep 20 2021 at 10:12)</a>:</h4>
<p>One corner case that i sort of noticed was Hashmap actually uses hashbrown as the underlying map, and doesn't iteself define a Drop impl</p>



<a name="254036049"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/189812-t-compiler/wg-rfc-2229/topic/reviews%20or%20other%20things/near/254036049" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> simulacrum <a href="https://zulip-archive.rust-lang.org/stream/189812-t-compiler/wg-rfc-2229/topic/reviews.20or.20other.20things.html#254036049">(Sep 20 2021 at 11:44)</a>:</h4>
<p>Vec also has RawVec as the actual drop, I think? We should be able to make the same assumption though, and mark Vec/HashMap directly, I think</p>



<a name="254102687"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/189812-t-compiler/wg-rfc-2229/topic/reviews%20or%20other%20things/near/254102687" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Aman Arora <a href="https://zulip-archive.rust-lang.org/stream/189812-t-compiler/wg-rfc-2229/topic/reviews.20or.20other.20things.html#254102687">(Sep 20 2021 at 19:14)</a>:</h4>
<p>My kind of concern here is hashbrown sort of lies outside of stdlib (or atleast that's how I understand it). But other than that I can add an early exit where if Type T needs drop but not a significant drop we exit early.</p>
<p>Right now it will also check any sub feilds so eg in case of Vec both Vec and RawVec drop need to marked insignificant and I kind of like the expliteness of this</p>



<a name="254136292"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/189812-t-compiler/wg-rfc-2229/topic/reviews%20or%20other%20things/near/254136292" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> simulacrum <a href="https://zulip-archive.rust-lang.org/stream/189812-t-compiler/wg-rfc-2229/topic/reviews.20or.20other.20things.html#254136292">(Sep 20 2021 at 23:49)</a>:</h4>
<p>HashMap should never have a significant drop, and in any case, this is just a hint for a particular rustc version, right? If in the future some type <em>does</em> become significant, we can change this, and the only thing that it affects is migration/lint behaviors</p>



<a name="254136323"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/189812-t-compiler/wg-rfc-2229/topic/reviews%20or%20other%20things/near/254136323" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> simulacrum <a href="https://zulip-archive.rust-lang.org/stream/189812-t-compiler/wg-rfc-2229/topic/reviews.20or.20other.20things.html#254136323">(Sep 20 2021 at 23:49)</a>:</h4>
<blockquote>
<p>Right now it will also check any sub feilds so eg in case of Vec both Vec and RawVec drop need to marked insignificant and I kind of like the expliteness of this</p>
</blockquote>
<p>This seems like a bad idea -- e.g., String is definitely insignificant, even though it's fields may not be</p>



<a name="254136373"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/189812-t-compiler/wg-rfc-2229/topic/reviews%20or%20other%20things/near/254136373" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> simulacrum <a href="https://zulip-archive.rust-lang.org/stream/189812-t-compiler/wg-rfc-2229/topic/reviews.20or.20other.20things.html#254136373">(Sep 20 2021 at 23:50)</a>:</h4>
<p>and it'll cause trouble with e.g. hashbrown</p>



<a name="254136429"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/189812-t-compiler/wg-rfc-2229/topic/reviews%20or%20other%20things/near/254136429" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Aman Arora <a href="https://zulip-archive.rust-lang.org/stream/189812-t-compiler/wg-rfc-2229/topic/reviews.20or.20other.20things.html#254136429">(Sep 20 2021 at 23:50)</a>:</h4>
<p>String is just vec&lt;u8&gt; but I'll add early exit in case of insig dtor</p>



<a name="254137680"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/189812-t-compiler/wg-rfc-2229/topic/reviews%20or%20other%20things/near/254137680" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> simulacrum <a href="https://zulip-archive.rust-lang.org/stream/189812-t-compiler/wg-rfc-2229/topic/reviews.20or.20other.20things.html#254137680">(Sep 21 2021 at 00:06)</a>:</h4>
<p>Thanks! Yeah, String is not the best example. I was thinking more of cases where you're e.g. wrapping a mutexguard and you happen to know that this one <em>is</em> insignificant. I could imagine us placing it on the stdout/stderrlocks, for example (though probably not: in practice, those are pretty unlikely to come up and <em>could</em> be important). but some library might have this.</p>
<p>(I partially care about this because I do think that the insignificance may become important for other features down the line)</p>



<a name="254168943"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/189812-t-compiler/wg-rfc-2229/topic/reviews%20or%20other%20things/near/254168943" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Aman Arora <a href="https://zulip-archive.rust-lang.org/stream/189812-t-compiler/wg-rfc-2229/topic/reviews.20or.20other.20things.html#254168943">(Sep 21 2021 at 07:57)</a>:</h4>
<p>Just sort of an update on where I'm at:  I tried implementing this sort of early exit, but it ended up conflicting the part that handles the part where drop becomes significant when provided type parameter has a significant drop. </p>
<p>Basically "SomeStruct&lt;Mutex&gt; is significant" gets handled when we look at the fields of an SomeStruct try analayse the fields and at one point one of the fields uses the type parameter T; and this runs kind of runs recurssively</p>



<a name="254169493"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/189812-t-compiler/wg-rfc-2229/topic/reviews%20or%20other%20things/near/254169493" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Aman Arora <a href="https://zulip-archive.rust-lang.org/stream/189812-t-compiler/wg-rfc-2229/topic/reviews.20or.20other.20things.html#254169493">(Sep 21 2021 at 08:02)</a>:</h4>
<p>Also another thing to discuss would be to move how we annonate insignificant dtors. Right now it's done by looking at the attributes of the drop method in the Drop impl and I like the motivation of keeping it close to the source.</p>
<p>However if we look at HashMap it doesn't iteself define Drop, but uses hashbrown as a field which has the drop impl. So we don't have anything to annonate. I tried adding just an empty Drop impl but that prevents us from moving some fields out. I suggest we annoate the struct </p>
<p>so something like </p>
<div class="codehilite" data-code-language="Rust"><pre><span></span><code><span class="cp">#[rustc_insigificant_dtor]</span><span class="w"></span>
<span class="k">struct</span> <span class="nc">S</span><span class="w"> </span><span class="p">{}</span><span class="w"></span>
</code></pre></div>
<p>I prefer annoating the Drop but I rather have one way of doing it across all types.</p>



<a name="254176495"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/189812-t-compiler/wg-rfc-2229/topic/reviews%20or%20other%20things/near/254176495" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Aman Arora <a href="https://zulip-archive.rust-lang.org/stream/189812-t-compiler/wg-rfc-2229/topic/reviews.20or.20other.20things.html#254176495">(Sep 21 2021 at 09:12)</a>:</h4>
<p>Okay figuring out the first problem wasn't too bad (assuming I did it right). I have created a PR here: <a href="https://github.com/rust-lang/rust/pull/89144">https://github.com/rust-lang/rust/pull/89144</a>. I was getting a random test for reserved prefix failing locally hopefully it's fine on CI</p>



<a name="254181978"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/189812-t-compiler/wg-rfc-2229/topic/reviews%20or%20other%20things/near/254181978" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/189812-t-compiler/wg-rfc-2229/topic/reviews.20or.20other.20things.html#254181978">(Sep 21 2021 at 10:00)</a>:</h4>
<blockquote>
<p>One thing missing from this PR is tagging HashMap as insigificant destructor as that needs some discussion.</p>
</blockquote>
<p><span class="user-mention" data-user-id="281950">@Aman Arora</span> This has to do with the fact that HashMap forwards to HashBrown?</p>



<a name="254226960"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/189812-t-compiler/wg-rfc-2229/topic/reviews%20or%20other%20things/near/254226960" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Aman Arora <a href="https://zulip-archive.rust-lang.org/stream/189812-t-compiler/wg-rfc-2229/topic/reviews.20or.20other.20things.html#254226960">(Sep 21 2021 at 15:31)</a>:</h4>
<p><span class="user-mention" data-user-id="116009">@nikomatsakis</span> yes</p>



<a name="254239279"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/189812-t-compiler/wg-rfc-2229/topic/reviews%20or%20other%20things/near/254239279" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/189812-t-compiler/wg-rfc-2229/topic/reviews.20or.20other.20things.html#254239279">(Sep 21 2021 at 16:45)</a>:</h4>
<p><span class="user-mention" data-user-id="281950">@Aman Arora</span> I don't quite understand your concern</p>



<a name="254239303"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/189812-t-compiler/wg-rfc-2229/topic/reviews%20or%20other%20things/near/254239303" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/189812-t-compiler/wg-rfc-2229/topic/reviews.20or.20other.20things.html#254239303">(Sep 21 2021 at 16:45)</a>:</h4>
<p>is the concern that HashBrown's implementation is outside of our control?</p>



<a name="254239322"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/189812-t-compiler/wg-rfc-2229/topic/reviews%20or%20other%20things/near/254239322" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/189812-t-compiler/wg-rfc-2229/topic/reviews.20or.20other.20things.html#254239322">(Sep 21 2021 at 16:45)</a>:</h4>
<p>We do have a newtype, I assume</p>



<a name="254239506"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/189812-t-compiler/wg-rfc-2229/topic/reviews%20or%20other%20things/near/254239506" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> simulacrum <a href="https://zulip-archive.rust-lang.org/stream/189812-t-compiler/wg-rfc-2229/topic/reviews.20or.20other.20things.html#254239506">(Sep 21 2021 at 16:46)</a>:</h4>
<p>yeah, we do</p>



<a name="254241788"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/189812-t-compiler/wg-rfc-2229/topic/reviews%20or%20other%20things/near/254241788" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/189812-t-compiler/wg-rfc-2229/topic/reviews.20or.20other.20things.html#254241788">(Sep 21 2021 at 17:00)</a>:</h4>
<p>I feel like we can be confident that HashBrown will not introduce side effects into its destructor</p>



<a name="254242024"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/189812-t-compiler/wg-rfc-2229/topic/reviews%20or%20other%20things/near/254242024" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Aman Arora <a href="https://zulip-archive.rust-lang.org/stream/189812-t-compiler/wg-rfc-2229/topic/reviews.20or.20other.20things.html#254242024">(Sep 21 2021 at 17:01)</a>:</h4>
<p>Problem is that we can't annotate hash map, since we don't define a drop impl</p>



<a name="254242406"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/189812-t-compiler/wg-rfc-2229/topic/reviews%20or%20other%20things/near/254242406" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Aman Arora <a href="https://zulip-archive.rust-lang.org/stream/189812-t-compiler/wg-rfc-2229/topic/reviews.20or.20other.20things.html#254242406">(Sep 21 2021 at 17:04)</a>:</h4>
<p>So I was suggesting that we annotate the struct definition with attribute instead of drop impl. (I'd prefer the latter, but rather have all parts of the code do it the same way)</p>



<a name="254242621"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/189812-t-compiler/wg-rfc-2229/topic/reviews%20or%20other%20things/near/254242621" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> simulacrum <a href="https://zulip-archive.rust-lang.org/stream/189812-t-compiler/wg-rfc-2229/topic/reviews.20or.20other.20things.html#254242621">(Sep 21 2021 at 17:04)</a>:</h4>
<p>yeah, probably struct definition is the right thing, even if it's a bit off</p>



<a name="254252002"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/189812-t-compiler/wg-rfc-2229/topic/reviews%20or%20other%20things/near/254252002" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/189812-t-compiler/wg-rfc-2229/topic/reviews.20or.20other.20things.html#254252002">(Sep 21 2021 at 18:08)</a>:</h4>
<p><span class="user-mention" data-user-id="281950">@Aman Arora</span> oh, I see</p>



<a name="254252014"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/189812-t-compiler/wg-rfc-2229/topic/reviews%20or%20other%20things/near/254252014" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/189812-t-compiler/wg-rfc-2229/topic/reviews.20or.20other.20things.html#254252014">(Sep 21 2021 at 18:08)</a>:</h4>
<p>Yes, I agree that makes sense</p>



<a name="254252040"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/189812-t-compiler/wg-rfc-2229/topic/reviews%20or%20other%20things/near/254252040" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/189812-t-compiler/wg-rfc-2229/topic/reviews.20or.20other.20things.html#254252040">(Sep 21 2021 at 18:08)</a>:</h4>
<p>we could of course add a dummy drop impl</p>



<a name="254252046"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/189812-t-compiler/wg-rfc-2229/topic/reviews%20or%20other%20things/near/254252046" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/189812-t-compiler/wg-rfc-2229/topic/reviews.20or.20other.20things.html#254252046">(Sep 21 2021 at 18:08)</a>:</h4>
<p>but that seems silly :)</p>



<a name="254252114"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/189812-t-compiler/wg-rfc-2229/topic/reviews%20or%20other%20things/near/254252114" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Aman Arora <a href="https://zulip-archive.rust-lang.org/stream/189812-t-compiler/wg-rfc-2229/topic/reviews.20or.20other.20things.html#254252114">(Sep 21 2021 at 18:08)</a>:</h4>
<p>I tried that, we run into can't move out of struct</p>



<a name="254252134"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/189812-t-compiler/wg-rfc-2229/topic/reviews%20or%20other%20things/near/254252134" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> simulacrum <a href="https://zulip-archive.rust-lang.org/stream/189812-t-compiler/wg-rfc-2229/topic/reviews.20or.20other.20things.html#254252134">(Sep 21 2021 at 18:09)</a>:</h4>
<p>it'd be a breaking change, yeah</p>



<a name="254252158"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/189812-t-compiler/wg-rfc-2229/topic/reviews%20or%20other%20things/near/254252158" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/189812-t-compiler/wg-rfc-2229/topic/reviews.20or.20other.20things.html#254252158">(Sep 21 2021 at 18:09)</a>:</h4>
<p>well, not a breaking change externally I imagine</p>



<a name="254252185"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/189812-t-compiler/wg-rfc-2229/topic/reviews%20or%20other%20things/near/254252185" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nikomatsakis <a href="https://zulip-archive.rust-lang.org/stream/189812-t-compiler/wg-rfc-2229/topic/reviews.20or.20other.20things.html#254252185">(Sep 21 2021 at 18:09)</a>:</h4>
<p>but anyway, that's fine</p>



<a name="254274722"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/189812-t-compiler/wg-rfc-2229/topic/reviews%20or%20other%20things/near/254274722" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Aman Arora <a href="https://zulip-archive.rust-lang.org/stream/189812-t-compiler/wg-rfc-2229/topic/reviews.20or.20other.20things.html#254274722">(Sep 21 2021 at 20:42)</a>:</h4>
<p>There is also this that we need to handle: <a href="https://github.com/rust-lang/project-rfc-2229/issues/42">https://github.com/rust-lang/project-rfc-2229/issues/42</a></p>



<a name="254338468"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/189812-t-compiler/wg-rfc-2229/topic/reviews%20or%20other%20things/near/254338468" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Aman Arora <a href="https://zulip-archive.rust-lang.org/stream/189812-t-compiler/wg-rfc-2229/topic/reviews.20or.20other.20things.html#254338468">(Sep 22 2021 at 09:19)</a>:</h4>
<p>updated <a href="https://github.com/rust-lang/rust/pull/89144">https://github.com/rust-lang/rust/pull/89144</a></p>



<a name="254954966"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/189812-t-compiler/wg-rfc-2229/topic/reviews%20or%20other%20things/near/254954966" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> rocksand <a href="https://zulip-archive.rust-lang.org/stream/189812-t-compiler/wg-rfc-2229/topic/reviews.20or.20other.20things.html#254954966">(Sep 26 2021 at 19:21)</a>:</h4>
<p><a href="https://github.com/rust-lang/rust/pull/89282">https://github.com/rust-lang/rust/pull/89282</a> Fixes another ICE when attempting to resolve PlaceBuilders</p>



<a name="256691169"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/189812-t-compiler/wg-rfc-2229/topic/reviews%20or%20other%20things/near/256691169" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Aman Arora <a href="https://zulip-archive.rust-lang.org/stream/189812-t-compiler/wg-rfc-2229/topic/reviews.20or.20other.20things.html#256691169">(Oct 08 2021 at 05:37)</a>:</h4>
<p><span class="user-mention" data-user-id="116009">@nikomatsakis</span> There is a PR open for the ICE that was reported recently: <a href="https://github.com/rust-lang/rust/pull/89648">https://github.com/rust-lang/rust/pull/89648</a></p>



<a name="259040232"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/189812-t-compiler/wg-rfc-2229/topic/reviews%20or%20other%20things/near/259040232" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Aman Arora <a href="https://zulip-archive.rust-lang.org/stream/189812-t-compiler/wg-rfc-2229/topic/reviews.20or.20other.20things.html#259040232">(Oct 26 2021 at 01:09)</a>:</h4>
<p><span class="user-mention" data-user-id="116009">@nikomatsakis</span> there's a PR open for the ICE in lint, can you take a look</p>



<a name="259040235"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/189812-t-compiler/wg-rfc-2229/topic/reviews%20or%20other%20things/near/259040235" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Aman Arora <a href="https://zulip-archive.rust-lang.org/stream/189812-t-compiler/wg-rfc-2229/topic/reviews.20or.20other.20things.html#259040235">(Oct 26 2021 at 01:09)</a>:</h4>
<p><a href="https://github.com/rust-lang/rust/pull/90218#issuecomment-951455939">https://github.com/rust-lang/rust/pull/90218#issuecomment-951455939</a></p>



<hr><p>Last updated: Apr 12 2022 at 20:01 UTC</p>
</html>