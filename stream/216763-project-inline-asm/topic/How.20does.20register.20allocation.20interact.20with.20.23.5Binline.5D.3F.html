<html>
<head><meta charset="utf-8"><title>How does register allocation interact with #[inline]? · project-inline-asm · Zulip Chat Archive</title></head>
<h2>Stream: <a href="https://zulip-archive.rust-lang.org/stream/216763-project-inline-asm/index.html">project-inline-asm</a></h2>
<h3>Topic: <a href="https://zulip-archive.rust-lang.org/stream/216763-project-inline-asm/topic/How.20does.20register.20allocation.20interact.20with.20.23.5Binline.5D.3F.html">How does register allocation interact with #[inline]?</a></h3>

<hr>

<base href="https://rust-lang.zulipchat.com">

<head><link href="https://zulip-archive.rust-lang.org/style.css" rel="stylesheet"></head>

<a name="253595114"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/216763-project-inline-asm/topic/How%20does%20register%20allocation%20interact%20with%20%23%5Binline%5D%3F/near/253595114" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lokathor <a href="https://zulip-archive.rust-lang.org/stream/216763-project-inline-asm/topic/How.20does.20register.20allocation.20interact.20with.20.23.5Binline.5D.3F.html#253595114">(Sep 16 2021 at 14:55)</a>:</h4>
<p>If there's an <code>asm!</code> block in an inline function, does each inline of the function get a fresh calculation of what the best register allocation would be?</p>
<p>And if not, do I need to put all my one-liners of inline asm into macros instead so that they expand at the use site and get a chance to pick registers that way?</p>



<a name="253596523"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/216763-project-inline-asm/topic/How%20does%20register%20allocation%20interact%20with%20%23%5Binline%5D%3F/near/253596523" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> bjorn3 <a href="https://zulip-archive.rust-lang.org/stream/216763-project-inline-asm/topic/How.20does.20register.20allocation.20interact.20with.20.23.5Binline.5D.3F.html#253596523">(Sep 16 2021 at 15:04)</a>:</h4>
<p>Yes, register allocation happens after LLVM-ir gets lowered to another internal IR of LLVM. Inlining happens long before this.</p>



<a name="253596674"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/216763-project-inline-asm/topic/How%20does%20register%20allocation%20interact%20with%20%23%5Binline%5D%3F/near/253596674" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> bjorn3 <a href="https://zulip-archive.rust-lang.org/stream/216763-project-inline-asm/topic/How.20does.20register.20allocation.20interact.20with.20.23.5Binline.5D.3F.html#253596674">(Sep 16 2021 at 15:04)</a>:</h4>
<p>Register allocation has to happen after pretty much any optimizations.</p>



<hr><p>Last updated: Apr 12 2022 at 20:01 UTC</p>
</html>