<html>
<head><meta charset="utf-8"><title>Is nightly broken right now? · t-release · Zulip Chat Archive</title></head>
<h2>Stream: <a href="https://zulip-archive.rust-lang.org/stream/241545-t-release/index.html">t-release</a></h2>
<h3>Topic: <a href="https://zulip-archive.rust-lang.org/stream/241545-t-release/topic/Is.20nightly.20broken.20right.20now.3F.html">Is nightly broken right now?</a></h3>

<hr>

<base href="https://rust-lang.zulipchat.com">

<head><link href="https://zulip-archive.rust-lang.org/style.css" rel="stylesheet"></head>

<a name="212065960"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/241545-t-release/topic/Is%20nightly%20broken%20right%20now%3F/near/212065960" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Daniel Silverstone <a href="https://zulip-archive.rust-lang.org/stream/241545-t-release/topic/Is.20nightly.20broken.20right.20now.3F.html#212065960">(Oct 02 2020 at 12:16)</a>:</h4>
<p><a href="https://github.com/rust-lang/rustup/issues/2504">https://github.com/rust-lang/rustup/issues/2504</a> (bad checksum on cargo)</p>



<a name="212067087"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/241545-t-release/topic/Is%20nightly%20broken%20right%20now%3F/near/212067087" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> simulacrum <a href="https://zulip-archive.rust-lang.org/stream/241545-t-release/topic/Is.20nightly.20broken.20right.20now.3F.html#212067087">(Oct 02 2020 at 12:28)</a>:</h4>
<p>cc <span class="user-mention" data-user-id="121055">@Pietro Albini</span> -- I guess maybe related to some of the work you've been doing refactoring?</p>



<a name="212068316"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/241545-t-release/topic/Is%20nightly%20broken%20right%20now%3F/near/212068316" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Pietro Albini <a href="https://zulip-archive.rust-lang.org/stream/241545-t-release/topic/Is.20nightly.20broken.20right.20now.3F.html#212068316">(Oct 02 2020 at 12:40)</a>:</h4>
<p>looking into this</p>



<a name="212068629"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/241545-t-release/topic/Is%20nightly%20broken%20right%20now%3F/near/212068629" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Pietro Albini <a href="https://zulip-archive.rust-lang.org/stream/241545-t-release/topic/Is.20nightly.20broken.20right.20now.3F.html#212068629">(Oct 02 2020 at 12:43)</a>:</h4>
<p>whelp</p>



<a name="212068633"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/241545-t-release/topic/Is%20nightly%20broken%20right%20now%3F/near/212068633" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Pietro Albini <a href="https://zulip-archive.rust-lang.org/stream/241545-t-release/topic/Is.20nightly.20broken.20right.20now.3F.html#212068633">(Oct 02 2020 at 12:44)</a>:</h4>
<p>that's my fault</p>



<a name="212068766"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/241545-t-release/topic/Is%20nightly%20broken%20right%20now%3F/near/212068766" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Pietro Albini <a href="https://zulip-archive.rust-lang.org/stream/241545-t-release/topic/Is.20nightly.20broken.20right.20now.3F.html#212068766">(Oct 02 2020 at 12:44)</a>:</h4>
<p><a href="https://mobile.twitter.com/rustlang/status/1312010667004760065">https://mobile.twitter.com/rustlang/status/1312010667004760065</a></p>
<div class="inline-preview-twitter"><div class="twitter-tweet"><a href="https://mobile.twitter.com/rustlang/status/1312010667004760065"><img class="twitter-avatar" src="https://pbs.twimg.com/profile_images/2392473363/v7txhrjp9pdqrkdtxxp0_normal.png"></a><p>We're aware of issues downloading the nightly toolchain using rustup, and we're working on a fix.</p><span>- Rust Language (@rustlang)</span></div></div>



<a name="212068842"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/241545-t-release/topic/Is%20nightly%20broken%20right%20now%3F/near/212068842" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Pietro Albini <a href="https://zulip-archive.rust-lang.org/stream/241545-t-release/topic/Is.20nightly.20broken.20right.20now.3F.html#212068842">(Oct 02 2020 at 12:45)</a>:</h4>
<p>ok now it's time to figure out how to fix this</p>



<a name="212068983"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/241545-t-release/topic/Is%20nightly%20broken%20right%20now%3F/near/212068983" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Daniel Silverstone <a href="https://zulip-archive.rust-lang.org/stream/241545-t-release/topic/Is.20nightly.20broken.20right.20now.3F.html#212068983">(Oct 02 2020 at 12:46)</a>:</h4>
<p>Bare minimum fix is presumably to swap the manifest for yesterdays?</p>



<a name="212069342"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/241545-t-release/topic/Is%20nightly%20broken%20right%20now%3F/near/212069342" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Pietro Albini <a href="https://zulip-archive.rust-lang.org/stream/241545-t-release/topic/Is.20nightly.20broken.20right.20now.3F.html#212069342">(Oct 02 2020 at 12:49)</a>:</h4>
<p>rolling back the manifest</p>



<a name="212069695"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/241545-t-release/topic/Is%20nightly%20broken%20right%20now%3F/near/212069695" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Pietro Albini <a href="https://zulip-archive.rust-lang.org/stream/241545-t-release/topic/Is.20nightly.20broken.20right.20now.3F.html#212069695">(Oct 02 2020 at 12:52)</a>:</h4>
<p>starting an invalidation</p>



<a name="212070034"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/241545-t-release/topic/Is%20nightly%20broken%20right%20now%3F/near/212070034" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Pietro Albini <a href="https://zulip-archive.rust-lang.org/stream/241545-t-release/topic/Is.20nightly.20broken.20right.20now.3F.html#212070034">(Oct 02 2020 at 12:55)</a>:</h4>
<p>didn't seem to help</p>



<a name="212070195"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/241545-t-release/topic/Is%20nightly%20broken%20right%20now%3F/near/212070195" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Daniel Silverstone <a href="https://zulip-archive.rust-lang.org/stream/241545-t-release/topic/Is.20nightly.20broken.20right.20now.3F.html#212070195">(Oct 02 2020 at 12:56)</a>:</h4>
<p>Oh dear  Do you know <em>why</em> it was broken before?</p>



<a name="212070325"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/241545-t-release/topic/Is%20nightly%20broken%20right%20now%3F/near/212070325" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Pietro Albini <a href="https://zulip-archive.rust-lang.org/stream/241545-t-release/topic/Is.20nightly.20broken.20right.20now.3F.html#212070325">(Oct 02 2020 at 12:57)</a>:</h4>
<p>yeah I know how I broke it</p>



<a name="212070400"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/241545-t-release/topic/Is%20nightly%20broken%20right%20now%3F/near/212070400" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Pietro Albini <a href="https://zulip-archive.rust-lang.org/stream/241545-t-release/topic/Is.20nightly.20broken.20right.20now.3F.html#212070400">(Oct 02 2020 at 12:58)</a>:</h4>
<p>basically I'm working on migrating the release process elsewhere, and mistakenly started a nightly prod build instead of a nightly dev build</p>



<a name="212070401"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/241545-t-release/topic/Is%20nightly%20broken%20right%20now%3F/near/212070401" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Pietro Albini <a href="https://zulip-archive.rust-lang.org/stream/241545-t-release/topic/Is.20nightly.20broken.20right.20now.3F.html#212070401">(Oct 02 2020 at 12:58)</a>:</h4>
<p>and well</p>



<a name="212070406"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/241545-t-release/topic/Is%20nightly%20broken%20right%20now%3F/near/212070406" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Pietro Albini <a href="https://zulip-archive.rust-lang.org/stream/241545-t-release/topic/Is.20nightly.20broken.20right.20now.3F.html#212070406">(Oct 02 2020 at 12:58)</a>:</h4>
<p>I forgot to cancel it</p>



<a name="212070763"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/241545-t-release/topic/Is%20nightly%20broken%20right%20now%3F/near/212070763" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Pietro Albini <a href="https://zulip-archive.rust-lang.org/stream/241545-t-release/topic/Is.20nightly.20broken.20right.20now.3F.html#212070763">(Oct 02 2020 at 13:01)</a>:</h4>
<p>ok this seems to have fixed it</p>



<a name="212070778"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/241545-t-release/topic/Is%20nightly%20broken%20right%20now%3F/near/212070778" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Pietro Albini <a href="https://zulip-archive.rust-lang.org/stream/241545-t-release/topic/Is.20nightly.20broken.20right.20now.3F.html#212070778">(Oct 02 2020 at 13:01)</a>:</h4>
<p>let's have the invalidation be propagated</p>



<a name="212070946"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/241545-t-release/topic/Is%20nightly%20broken%20right%20now%3F/near/212070946" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Pietro Albini <a href="https://zulip-archive.rust-lang.org/stream/241545-t-release/topic/Is.20nightly.20broken.20right.20now.3F.html#212070946">(Oct 02 2020 at 13:03)</a>:</h4>
<p><span class="user-mention" data-user-id="223910">@Daniel Silverstone</span> <span class="user-mention" data-user-id="116122">@simulacrum</span> could you check if it works on your end too now?</p>



<a name="212070964"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/241545-t-release/topic/Is%20nightly%20broken%20right%20now%3F/near/212070964" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> simulacrum <a href="https://zulip-archive.rust-lang.org/stream/241545-t-release/topic/Is.20nightly.20broken.20right.20now.3F.html#212070964">(Oct 02 2020 at 13:03)</a>:</h4>
<p>checking</p>



<a name="212071022"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/241545-t-release/topic/Is%20nightly%20broken%20right%20now%3F/near/212071022" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> simulacrum <a href="https://zulip-archive.rust-lang.org/stream/241545-t-release/topic/Is.20nightly.20broken.20right.20now.3F.html#212071022">(Oct 02 2020 at 13:04)</a>:</h4>
<p>seems to be working</p>



<a name="212071072"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/241545-t-release/topic/Is%20nightly%20broken%20right%20now%3F/near/212071072" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> simulacrum <a href="https://zulip-archive.rust-lang.org/stream/241545-t-release/topic/Is.20nightly.20broken.20right.20now.3F.html#212071072">(Oct 02 2020 at 13:04)</a>:</h4>
<p>yeah update successfully</p>



<a name="212071080"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/241545-t-release/topic/Is%20nightly%20broken%20right%20now%3F/near/212071080" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> simulacrum <a href="https://zulip-archive.rust-lang.org/stream/241545-t-release/topic/Is.20nightly.20broken.20right.20now.3F.html#212071080">(Oct 02 2020 at 13:04)</a>:</h4>
<p><span class="user-mention" data-user-id="121055">@Pietro Albini</span> seems to be fixed</p>



<a name="212071098"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/241545-t-release/topic/Is%20nightly%20broken%20right%20now%3F/near/212071098" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Pietro Albini <a href="https://zulip-archive.rust-lang.org/stream/241545-t-release/topic/Is.20nightly.20broken.20right.20now.3F.html#212071098">(Oct 02 2020 at 13:04)</a>:</h4>
<p><span class="user-mention" data-user-id="116122">@simulacrum</span> <span aria-label="tada" class="emoji emoji-1f389" role="img" title="tada">:tada:</span></p>



<a name="212071116"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/241545-t-release/topic/Is%20nightly%20broken%20right%20now%3F/near/212071116" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Pietro Albini <a href="https://zulip-archive.rust-lang.org/stream/241545-t-release/topic/Is.20nightly.20broken.20right.20now.3F.html#212071116">(Oct 02 2020 at 13:04)</a>:</h4>
<p>let me catch some breath and I'll do a small postmortem</p>



<a name="212071140"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/241545-t-release/topic/Is%20nightly%20broken%20right%20now%3F/near/212071140" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> simulacrum <a href="https://zulip-archive.rust-lang.org/stream/241545-t-release/topic/Is.20nightly.20broken.20right.20now.3F.html#212071140">(Oct 02 2020 at 13:04)</a>:</h4>
<p>would also be good to issue an update on twitter soonish</p>



<a name="212071396"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/241545-t-release/topic/Is%20nightly%20broken%20right%20now%3F/near/212071396" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Pietro Albini <a href="https://zulip-archive.rust-lang.org/stream/241545-t-release/topic/Is.20nightly.20broken.20right.20now.3F.html#212071396">(Oct 02 2020 at 13:07)</a>:</h4>
<p>done</p>



<a name="212072372"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/241545-t-release/topic/Is%20nightly%20broken%20right%20now%3F/near/212072372" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Pietro Albini <a href="https://zulip-archive.rust-lang.org/stream/241545-t-release/topic/Is.20nightly.20broken.20right.20now.3F.html#212072372">(Oct 02 2020 at 13:15)</a>:</h4>
<p>ok, so my understanding of the situation is this:</p>
<ol>
<li>while testing the code to start releases on codebuild, I mistakenly started a nightly build on prod instead of dev -- I had a tab on the dev codebuild pipeline open to cancel builds, but I didn't have a tab open on the stable pipeline so I didn't notice it</li>
<li>since a new nightly release started, promote-release did its thing and overrode every file of today's nightly -- the new nightly was also based on a different commit</li>
<li>there is a "bug" in promote-release that only invalidates the manifests at the top level, and none of the files in <code>/dist/YYYY-MM-DD</code>: this is usually fine, as all the files in a day's directory are supposed to be newly uploaded, but of course it breaks down if two releases are made the same day</li>
</ol>
<p>because of that, people were getting the new manifest (with the new hashes) but were downloading the old cached tarballs, causing the checksum errors</p>



<a name="212072832"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/241545-t-release/topic/Is%20nightly%20broken%20right%20now%3F/near/212072832" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Pietro Albini <a href="https://zulip-archive.rust-lang.org/stream/241545-t-release/topic/Is.20nightly.20broken.20right.20now.3F.html#212072832">(Oct 02 2020 at 13:18)</a>:</h4>
<p>the fix for the error was to simply do a full cloudfront invalidation</p>



<a name="212073205"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/241545-t-release/topic/Is%20nightly%20broken%20right%20now%3F/near/212073205" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Pietro Albini <a href="https://zulip-archive.rust-lang.org/stream/241545-t-release/topic/Is.20nightly.20broken.20right.20now.3F.html#212073205">(Oct 02 2020 at 13:22)</a>:</h4>
<p><span class="user-mention" data-user-id="116122">@simulacrum</span> as a next step, I think we should change promote-release to invalidate the whole <code>/dist/*</code> whenever a release is made</p>



<a name="212073208"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/241545-t-release/topic/Is%20nightly%20broken%20right%20now%3F/near/212073208" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> simulacrum <a href="https://zulip-archive.rust-lang.org/stream/241545-t-release/topic/Is.20nightly.20broken.20right.20now.3F.html#212073208">(Oct 02 2020 at 13:22)</a>:</h4>
<p>hm so at least one thing to note is that we should probably error out (maybe unless some env variable is set) if there is already a nightly, i.e., we're overwriting manifest in the same date</p>



<a name="212073218"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/241545-t-release/topic/Is%20nightly%20broken%20right%20now%3F/near/212073218" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> simulacrum <a href="https://zulip-archive.rust-lang.org/stream/241545-t-release/topic/Is.20nightly.20broken.20right.20now.3F.html#212073218">(Oct 02 2020 at 13:22)</a>:</h4>
<p>that seems really expensive</p>



<a name="212073251"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/241545-t-release/topic/Is%20nightly%20broken%20right%20now%3F/near/212073251" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Pietro Albini <a href="https://zulip-archive.rust-lang.org/stream/241545-t-release/topic/Is.20nightly.20broken.20right.20now.3F.html#212073251">(Oct 02 2020 at 13:22)</a>:</h4>
<p><span class="user-mention" data-user-id="116122">@simulacrum</span> expensive re: aws costs or expensive re: we're destroying all caches?</p>



<a name="212073275"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/241545-t-release/topic/Is%20nightly%20broken%20right%20now%3F/near/212073275" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> simulacrum <a href="https://zulip-archive.rust-lang.org/stream/241545-t-release/topic/Is.20nightly.20broken.20right.20now.3F.html#212073275">(Oct 02 2020 at 13:23)</a>:</h4>
<p>well, both, right? but mostly the later</p>



<a name="212073298"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/241545-t-release/topic/Is%20nightly%20broken%20right%20now%3F/near/212073298" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> simulacrum <a href="https://zulip-archive.rust-lang.org/stream/241545-t-release/topic/Is.20nightly.20broken.20right.20now.3F.html#212073298">(Oct 02 2020 at 13:23)</a>:</h4>
<p>though actually I don't know that there's any $ cost really</p>



<a name="212073326"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/241545-t-release/topic/Is%20nightly%20broken%20right%20now%3F/near/212073326" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> simulacrum <a href="https://zulip-archive.rust-lang.org/stream/241545-t-release/topic/Is.20nightly.20broken.20right.20now.3F.html#212073326">(Oct 02 2020 at 13:23)</a>:</h4>
<p>(AFAIK nothing is doing requests that would get 304s back)</p>



<a name="212073423"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/241545-t-release/topic/Is%20nightly%20broken%20right%20now%3F/near/212073423" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Pietro Albini <a href="https://zulip-archive.rust-lang.org/stream/241545-t-release/topic/Is.20nightly.20broken.20right.20now.3F.html#212073423">(Oct 02 2020 at 13:24)</a>:</h4>
<p><a href="https://docs.aws.amazon.com/AmazonCloudFront/latest/DeveloperGuide/Invalidation.html#PayingForInvalidation">https://docs.aws.amazon.com/AmazonCloudFront/latest/DeveloperGuide/Invalidation.html#PayingForInvalidation</a></p>



<a name="212073451"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/241545-t-release/topic/Is%20nightly%20broken%20right%20now%3F/near/212073451" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Pietro Albini <a href="https://zulip-archive.rust-lang.org/stream/241545-t-release/topic/Is.20nightly.20broken.20right.20now.3F.html#212073451">(Oct 02 2020 at 13:24)</a>:</h4>
<p>so, invalidations are paid, but you pay per invalidation pattern</p>



<a name="212073468"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/241545-t-release/topic/Is%20nightly%20broken%20right%20now%3F/near/212073468" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Pietro Albini <a href="https://zulip-archive.rust-lang.org/stream/241545-t-release/topic/Is.20nightly.20broken.20right.20now.3F.html#212073468">(Oct 02 2020 at 13:24)</a>:</h4>
<p>so you pay the same to invalidate <code>/dist/foo.txt</code> and <code>/dist/*</code></p>



<a name="212073469"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/241545-t-release/topic/Is%20nightly%20broken%20right%20now%3F/near/212073469" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Pietro Albini <a href="https://zulip-archive.rust-lang.org/stream/241545-t-release/topic/Is.20nightly.20broken.20right.20now.3F.html#212073469">(Oct 02 2020 at 13:24)</a>:</h4>
<p>don't ask me why</p>



<a name="212073516"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/241545-t-release/topic/Is%20nightly%20broken%20right%20now%3F/near/212073516" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> simulacrum <a href="https://zulip-archive.rust-lang.org/stream/241545-t-release/topic/Is.20nightly.20broken.20right.20now.3F.html#212073516">(Oct 02 2020 at 13:25)</a>:</h4>
<p>Yeah, though they're really cheap ($0.005/invalidation over 1000/month)</p>



<a name="212073559"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/241545-t-release/topic/Is%20nightly%20broken%20right%20now%3F/near/212073559" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> simulacrum <a href="https://zulip-archive.rust-lang.org/stream/241545-t-release/topic/Is.20nightly.20broken.20right.20now.3F.html#212073559">(Oct 02 2020 at 13:25)</a>:</h4>
<p>but I was more thinking that we'd then redownload from s3, but I think that's free since it's inside aws? not sure</p>



<a name="212073574"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/241545-t-release/topic/Is%20nightly%20broken%20right%20now%3F/near/212073574" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> simulacrum <a href="https://zulip-archive.rust-lang.org/stream/241545-t-release/topic/Is.20nightly.20broken.20right.20now.3F.html#212073574">(Oct 02 2020 at 13:25)</a>:</h4>
<p>probably not free</p>



<a name="212073587"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/241545-t-release/topic/Is%20nightly%20broken%20right%20now%3F/near/212073587" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Pietro Albini <a href="https://zulip-archive.rust-lang.org/stream/241545-t-release/topic/Is.20nightly.20broken.20right.20now.3F.html#212073587">(Oct 02 2020 at 13:25)</a>:</h4>
<p>yeah it's free since we're inside aws</p>



<a name="212073672"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/241545-t-release/topic/Is%20nightly%20broken%20right%20now%3F/near/212073672" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Pietro Albini <a href="https://zulip-archive.rust-lang.org/stream/241545-t-release/topic/Is.20nightly.20broken.20right.20now.3F.html#212073672">(Oct 02 2020 at 13:26)</a>:</h4>
<p>like, we pay per S3 GET request, but that cost is really negligible</p>



<a name="212073694"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/241545-t-release/topic/Is%20nightly%20broken%20right%20now%3F/near/212073694" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> simulacrum <a href="https://zulip-archive.rust-lang.org/stream/241545-t-release/topic/Is.20nightly.20broken.20right.20now.3F.html#212073694">(Oct 02 2020 at 13:26)</a>:</h4>
<p>ah okay:</p>
<blockquote>
<p>If you are using an AWS origin, effective December 1, 2014, data transferred from origin to edge locations (Amazon CloudFront "origin fetches") will be free of charge. This applies to data transfer from all AWS regions to all global CloudFront edge locations. D</p>
</blockquote>



<a name="212073699"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/241545-t-release/topic/Is%20nightly%20broken%20right%20now%3F/near/212073699" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Pietro Albini <a href="https://zulip-archive.rust-lang.org/stream/241545-t-release/topic/Is.20nightly.20broken.20right.20now.3F.html#212073699">(Oct 02 2020 at 13:26)</a>:</h4>
<p>(compared to bandwidth costs, which are free inside aws)</p>



<a name="212073752"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/241545-t-release/topic/Is%20nightly%20broken%20right%20now%3F/near/212073752" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> simulacrum <a href="https://zulip-archive.rust-lang.org/stream/241545-t-release/topic/Is.20nightly.20broken.20right.20now.3F.html#212073752">(Oct 02 2020 at 13:26)</a>:</h4>
<p>okay. I guess it feels horrible to invalidate everything, especially because we'd then not catch things like this which are really bugs</p>



<a name="212073847"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/241545-t-release/topic/Is%20nightly%20broken%20right%20now%3F/near/212073847" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Pietro Albini <a href="https://zulip-archive.rust-lang.org/stream/241545-t-release/topic/Is.20nightly.20broken.20right.20now.3F.html#212073847">(Oct 02 2020 at 13:27)</a>:</h4>
<p>oh adding a safeguard is still something we should do</p>



<a name="212078171"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/241545-t-release/topic/Is%20nightly%20broken%20right%20now%3F/near/212078171" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Pietro Albini <a href="https://zulip-archive.rust-lang.org/stream/241545-t-release/topic/Is.20nightly.20broken.20right.20now.3F.html#212078171">(Oct 02 2020 at 14:00)</a>:</h4>
<p><span class="user-mention" data-user-id="116122">@simulacrum</span> <span class="user-mention" data-user-id="223910">@Daniel Silverstone</span> <a href="https://github.com/rust-lang/rustup/issues/2504#issuecomment-702749774">https://github.com/rust-lang/rustup/issues/2504#issuecomment-702749774</a></p>



<a name="212078762"></a>
<h4><a href="https://rust-lang.zulipchat.com#narrow/stream/241545-t-release/topic/Is%20nightly%20broken%20right%20now%3F/near/212078762" class="zl"><img src="https://zulip-archive.rust-lang.org/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Pietro Albini <a href="https://zulip-archive.rust-lang.org/stream/241545-t-release/topic/Is.20nightly.20broken.20right.20now.3F.html#212078762">(Oct 02 2020 at 14:05)</a>:</h4>
<p>aaand, that's enough pietro changing the release process for this week</p>



<hr><p>Last updated: Apr 12 2022 at 20:01 UTC</p>
</html>