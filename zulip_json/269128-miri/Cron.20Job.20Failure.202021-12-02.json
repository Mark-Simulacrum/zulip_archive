[
    {
        "content": "<p>Dear <span class=\"user-mention\" data-user-id=\"120791\">@RalfJ</span>,</p>\n<p>The standard library test suite is failing under Miri. Would you mind investigating this issue?</p>\n<p>Thanks in advance!<br>\nSincerely,<br>\nThe Miri Cronjobs Bot</p>",
        "id": 263388130,
        "sender_full_name": "miri-test-libstd",
        "timestamp": 1638414437
    },
    {
        "content": "<p>That's this test, probably riming our or overflowing the stack: <a href=\"https://github.com/rust-lang/rust/blob/9f1f42897d0e0ae580f2e49a1b46fad27b60990e/library/core/tests/slice.rs#L2337\">https://github.com/rust-lang/rust/blob/9f1f42897d0e0ae580f2e49a1b46fad27b60990e/library/core/tests/slice.rs#L2337</a><br>\nUnfortunately is is rather obfuscated due to a macro... so far my attempts at turning this into regular Rust have failed. This doesn't build:</p>\n<div class=\"codehilite\" data-code-language=\"Rust\"><pre><span></span><code><span class=\"k\">const</span><span class=\"w\"> </span><span class=\"n\">EMPTY_MAX</span>: <span class=\"kp\">&amp;</span><span class=\"o\">'</span><span class=\"nb\">static</span> <span class=\"p\">[()]</span><span class=\"w\"> </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"o\">&amp;</span><span class=\"p\">[();</span><span class=\"w\"> </span><span class=\"kt\">usize</span>::<span class=\"n\">MAX</span><span class=\"p\">];</span><span class=\"w\"></span>\n\n<span class=\"k\">fn</span> <span class=\"nf\">main</span><span class=\"p\">()</span><span class=\"w\"> </span><span class=\"p\">{</span><span class=\"w\"></span>\n<span class=\"w\">    </span><span class=\"kd\">let</span><span class=\"w\"> </span><span class=\"k\">mut</span><span class=\"w\"> </span><span class=\"n\">slice</span>: <span class=\"kp\">&amp;</span><span class=\"p\">[</span><span class=\"n\">_</span><span class=\"p\">]</span><span class=\"w\"> </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"o\">&amp;</span><span class=\"p\">[();</span><span class=\"w\"> </span><span class=\"kt\">usize</span>::<span class=\"n\">MAX</span><span class=\"p\">];</span><span class=\"w\"></span>\n<span class=\"w\">    </span><span class=\"fm\">assert_eq!</span><span class=\"p\">(</span><span class=\"nb\">Some</span><span class=\"p\">(</span><span class=\"o\">&amp;</span><span class=\"p\">[]</span><span class=\"w\"> </span><span class=\"k\">as</span><span class=\"w\"> </span><span class=\"n\">_</span><span class=\"p\">),</span><span class=\"w\"> </span><span class=\"n\">slice</span><span class=\"p\">.</span><span class=\"n\">take</span><span class=\"p\">(</span><span class=\"kt\">usize</span>::<span class=\"n\">MAX</span><span class=\"o\">..</span><span class=\"p\">));</span><span class=\"w\"></span>\n<span class=\"w\">    </span><span class=\"kd\">let</span><span class=\"w\"> </span><span class=\"n\">remaining</span>: <span class=\"kp\">&amp;</span><span class=\"p\">[</span><span class=\"n\">_</span><span class=\"p\">]</span><span class=\"w\"> </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"n\">EMPTY_MAX</span><span class=\"p\">;</span><span class=\"w\"></span>\n<span class=\"w\">    </span><span class=\"fm\">assert_eq!</span><span class=\"p\">(</span><span class=\"n\">remaining</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"n\">slice</span><span class=\"p\">);</span><span class=\"w\"></span>\n<span class=\"p\">}</span><span class=\"w\"></span>\n</code></pre></div>",
        "id": 263388697,
        "sender_full_name": "RalfJ",
        "timestamp": 1638415316
    },
    {
        "content": "<p>hm, maybe playground doesnt have the new nightly yet, I realized it is not long after midnight UTC</p>",
        "id": 263388893,
        "sender_full_name": "RalfJ",
        "timestamp": 1638415559
    },
    {
        "content": "<p>the PR that added this: <a href=\"https://github.com/rust-lang/rust/pull/88502\">https://github.com/rust-lang/rust/pull/88502</a></p>",
        "id": 263388933,
        "sender_full_name": "RalfJ",
        "timestamp": 1638415569
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"120791\">RalfJ</span> <a href=\"#narrow/stream/269128-miri/topic/Cron.20Job.20Failure.202021-12-02/near/263388893\">said</a>:</p>\n<blockquote>\n<p>hm, maybe playground doesnt have the new nightly yet, I realized it is not long after midnight UTC</p>\n</blockquote>\n<p>yes that's it</p>",
        "id": 263389836,
        "sender_full_name": "RalfJ",
        "timestamp": 1638416727
    },
    {
        "content": "<p>so locally I can see miri diverge in the <code>assert_eq!(remaining, slice);</code>. that's comparing slices of length usize::MAX, probably not too surprising it is slow... but then how can this not take forever on 'real' rustc?</p>",
        "id": 263389896,
        "sender_full_name": "RalfJ",
        "timestamp": 1638416769
    },
    {
        "content": "<p>oh, lol, it does -- in debug mode.^^</p>",
        "id": 263390079,
        "sender_full_name": "RalfJ",
        "timestamp": 1638417055
    },
    {
        "content": "<p><a href=\"https://github.com/rust-lang/rust/pull/91444\">https://github.com/rust-lang/rust/pull/91444</a></p>",
        "id": 263390080,
        "sender_full_name": "RalfJ",
        "timestamp": 1638417056
    }
]