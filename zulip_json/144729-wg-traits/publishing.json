[
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"129457\">@Florian Diebold</span> Hey, As you read from <a href=\"https://github.com/rust-analyzer/rust-analyzer/pull/4405\">this</a> PR, we want to setup auto publishing of rust-analyzer so that other analysis tools can use it. While working on that, I realized that chalk needs to be auto published too since it's a dependency of RA. So, my question is, are there any attempts currently to do that? If not, can we do that?</p>",
        "id": 197803300,
        "sender_full_name": "pksunkara",
        "timestamp": 1589646441
    },
    {
        "content": "<p>Also, looks like <code>chalk</code> already exists on <a href=\"http://crates.io\">crates.io</a>, created by someone else</p>",
        "id": 197803309,
        "sender_full_name": "pksunkara",
        "timestamp": 1589646476
    },
    {
        "content": "<p>that version is not likely to be compatible with the one that RA depends on, though</p>",
        "id": 197803352,
        "sender_full_name": "Florian Diebold",
        "timestamp": 1589646500
    },
    {
        "content": "<p>since chalk breaks the interface RA uses regularly</p>",
        "id": 197803356,
        "sender_full_name": "Florian Diebold",
        "timestamp": 1589646518
    },
    {
        "content": "<p>The one on <a href=\"http://crates.io\">crates.io</a> is not even this chalk. It's a terminal color related library created by someone in 2015</p>",
        "id": 197803366,
        "sender_full_name": "pksunkara",
        "timestamp": 1589646568
    },
    {
        "content": "<p>But yeah, is there any objection to do a weekly release like the one I proposed in that PR?</p>",
        "id": 197803417,
        "sender_full_name": "pksunkara",
        "timestamp": 1589646621
    },
    {
        "content": "<p>hm, I think there is a version of Chalk on <a href=\"http://crates.io\">crates.io</a> though, but I don't really know a lot about it</p>",
        "id": 197803422,
        "sender_full_name": "Florian Diebold",
        "timestamp": 1589646640
    },
    {
        "content": "<p>I'm not really the person to ask</p>",
        "id": 197803428,
        "sender_full_name": "Florian Diebold",
        "timestamp": 1589646647
    },
    {
        "content": "<p>maybe <span class=\"user-mention\" data-user-id=\"232957\">@Jack Huey</span> can help</p>",
        "id": 197803430,
        "sender_full_name": "Florian Diebold",
        "timestamp": 1589646656
    },
    {
        "content": "<p>Also, chalk_rs is a terminal color library, <a href=\"https://crates.io/crates/chalk_rs\">https://crates.io/crates/chalk_rs</a></p>",
        "id": 197803440,
        "sender_full_name": "pksunkara",
        "timestamp": 1589646688
    },
    {
        "content": "<p>Looks like it is this library, <a href=\"https://crates.io/crates/chalk-solve\">https://crates.io/crates/chalk-solve</a></p>",
        "id": 197803507,
        "sender_full_name": "pksunkara",
        "timestamp": 1589646792
    },
    {
        "content": "<p>yeah</p>",
        "id": 197803742,
        "sender_full_name": "Florian Diebold",
        "timestamp": 1589647158
    },
    {
        "content": "<p>See <a href=\"https://rust-lang.github.io/chalk/book/publishing.html\">https://rust-lang.github.io/chalk/book/publishing.html</a> for the list of published crates</p>",
        "id": 197804287,
        "sender_full_name": "Jack Huey",
        "timestamp": 1589647875
    },
    {
        "content": "<p>If we can get \"automatic\" publishing,  that would be fantastic</p>",
        "id": 197804308,
        "sender_full_name": "Jack Huey",
        "timestamp": 1589647904
    },
    {
        "content": "<p>I looked into it a bit but didn't really figure it out</p>",
        "id": 197804356,
        "sender_full_name": "Jack Huey",
        "timestamp": 1589647932
    },
    {
        "content": "<p>I aay \"automatic\" because we don't want actual scheduled releases. But releasing on a tag would be awesome</p>",
        "id": 197804370,
        "sender_full_name": "Jack Huey",
        "timestamp": 1589647970
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"232957\">@Jack Huey</span> I can setup an automatic publishing github action using <a href=\"https://github.com/pksunkara/cargo-workspaces\">https://github.com/pksunkara/cargo-workspaces</a>. Though the <code>-dev</code> wont work.</p>",
        "id": 197804894,
        "sender_full_name": "pksunkara",
        "timestamp": 1589648746
    },
    {
        "content": "<p>But, \"scheduled releases\" is what I need here. Rust Analyzer's development speed is too fast and if we want it to published every week/month/bi-weekly, then we would need chalk to help with that</p>",
        "id": 197804964,
        "sender_full_name": "pksunkara",
        "timestamp": 1589648819
    },
    {
        "content": "<p>I mean, do you need a chalk republish every week? I think ideally we want rust-analyzer to use a published chalk. And it will have to be manual upgrades, since right now the API isn't really stable.</p>",
        "id": 197805069,
        "sender_full_name": "Jack Huey",
        "timestamp": 1589648946
    },
    {
        "content": "<p>I'm not a fan of using a published Chalk, since we upgrade much more frequently than Chalk is currently published</p>",
        "id": 197805223,
        "sender_full_name": "Florian Diebold",
        "timestamp": 1589649194
    },
    {
        "content": "<blockquote>\n<p>since right now the API isn't really stable.</p>\n</blockquote>",
        "id": 197805225,
        "sender_full_name": "pksunkara",
        "timestamp": 1589649206
    },
    {
        "content": "<p>i.e. I would only be ok with using a published Chalk if it actually published quite frequently</p>",
        "id": 197805229,
        "sender_full_name": "Florian Diebold",
        "timestamp": 1589649215
    },
    {
        "content": "<p>Which is the main reason I was proposing weekly publish</p>",
        "id": 197805234,
        "sender_full_name": "pksunkara",
        "timestamp": 1589649217
    },
    {
        "content": "<p>we can just bump the minor version every week</p>",
        "id": 197805240,
        "sender_full_name": "pksunkara",
        "timestamp": 1589649230
    },
    {
        "content": "<p>According to semver, since we are &lt;1.0, minor bump is always breaking change</p>",
        "id": 197805284,
        "sender_full_name": "pksunkara",
        "timestamp": 1589649249
    },
    {
        "content": "<p>So, we don't actually have to care that we are breaking stuff</p>",
        "id": 197805288,
        "sender_full_name": "pksunkara",
        "timestamp": 1589649260
    },
    {
        "content": "<p>until it is much more mature and rust-analyzer and chalk become stable</p>",
        "id": 197805296,
        "sender_full_name": "pksunkara",
        "timestamp": 1589649274
    },
    {
        "content": "<p>Basically, I am trying to get this publishing issue solved because I am building a code analysis based tool which I would want to release. <span class=\"user-mention\" data-user-id=\"116009\">@nikomatsakis</span> did talk about the librarification and I think chalk and rust-analyzer being published on <a href=\"http://crates.io\">crates.io</a> is very important first step.</p>",
        "id": 197805387,
        "sender_full_name": "pksunkara",
        "timestamp": 1589649415
    },
    {
        "content": "<p>Well, bumping chalk could break stuff. So it can't be automatic</p>",
        "id": 197805647,
        "sender_full_name": "Jack Huey",
        "timestamp": 1589649770
    },
    {
        "content": "<p>I don't see why it being automatic would be a problem, whether it's automatic or not we need to manually bump on the rust-analyzer/rustc side after a new Chalk version has been published</p>",
        "id": 197805791,
        "sender_full_name": "Florian Diebold",
        "timestamp": 1589649988
    },
    {
        "content": "<blockquote>\n<p>bumping chalk could break stuff</p>\n</blockquote>\n<p>Can you explain what you mean? If we bump chalk's minor version, anything using chalk won't be broken because <code>cargo</code> adds <code>^</code></p>",
        "id": 197805793,
        "sender_full_name": "pksunkara",
        "timestamp": 1589649994
    },
    {
        "content": "<p>The minor version is still a breaking change as it's &lt; 1.0</p>",
        "id": 197805803,
        "sender_full_name": "Mark Drobnak",
        "timestamp": 1589650027
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"129457\">Florian Diebold</span> <a href=\"#narrow/stream/144729-wg-traits/topic/publishing/near/197805791\">said</a>:</p>\n<blockquote>\n<p>we need to manually bump on the rust-analyzer/rustc side after a new Chalk version has been published</p>\n</blockquote>\n<p>Exactly</p>",
        "id": 197805805,
        "sender_full_name": "pksunkara",
        "timestamp": 1589650031
    },
    {
        "content": "<p>Well, chalk having automatic publishing isn't a problem. It's the upgrading of chalk on rust-analyzer or rustc side that can't be automatic. Again, I'm fine with releasing on tag. (Which <span class=\"user-mention\" data-user-id=\"129457\">@Florian Diebold</span> has the perms to do) But I don't know if we have the activity to justify a regular weekly release. We've talked about this before, but maybe <span class=\"user-mention\" data-user-id=\"116009\">@nikomatsakis</span> can weigh in.</p>",
        "id": 197806820,
        "sender_full_name": "Jack Huey",
        "timestamp": 1589651432
    },
    {
        "content": "<blockquote>\n<p>Again, I'm fine with releasing on tag. (Which @Florian Diebold has the perms to do)</p>\n</blockquote>\n<p>hm, I didn't know that. If I could just trigger a release of Chalk whenever we want to upgrade it in RA, that would be fine, I think.</p>\n<blockquote>\n<p>It's the upgrading of chalk on rust-analyzer or rustc side that can't be automatic.</p>\n</blockquote>\n<p>I don't think it would be in either case. We'd have <code>chalk-solve = \"0.123\"</code>, and upgrade that when we want/need to.</p>",
        "id": 197806943,
        "sender_full_name": "Florian Diebold",
        "timestamp": 1589651604
    },
    {
        "content": "<p>Okay, <span class=\"user-mention\" data-user-id=\"254853\">@pksunkara</span> if you want to make a PR that publishes the chalk crates on github tag, then I'll look it over</p>",
        "id": 197808166,
        "sender_full_name": "Jack Huey",
        "timestamp": 1589653360
    },
    {
        "content": "<p>Thanks, will do</p>",
        "id": 197808174,
        "sender_full_name": "pksunkara",
        "timestamp": 1589653374
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"232957\">@Jack Huey</span> Hey, just to confirm, you want to tag <code>0.123</code> and the action would update the versions in <code>Cargo.toml</code> and publishes them, right?</p>",
        "id": 197837757,
        "sender_full_name": "pksunkara",
        "timestamp": 1589704370
    },
    {
        "content": "<p>My question is, but the <code>Cargo.toml</code>s of the tagged version commit on github will not contain the correct version information. Are we okay with that?</p>",
        "id": 197837771,
        "sender_full_name": "pksunkara",
        "timestamp": 1589704419
    },
    {
        "content": "<p>Oh yeah...ugh that's less than ideal</p>",
        "id": 197859263,
        "sender_full_name": "Jack Huey",
        "timestamp": 1589735964
    },
    {
        "content": "<p>What's the best way to get around this</p>",
        "id": 197859276,
        "sender_full_name": "Jack Huey",
        "timestamp": 1589735984
    },
    {
        "content": "<p>Either we schedule it or we could try this tool, <a href=\"https://www.actionspanel.app/\">https://www.actionspanel.app/</a></p>",
        "id": 197874317,
        "sender_full_name": "pksunkara",
        "timestamp": 1589757056
    },
    {
        "content": "<p>That's neat. Let's see what <span class=\"user-mention\" data-user-id=\"116009\">@nikomatsakis</span> thinks</p>",
        "id": 197884010,
        "sender_full_name": "Jack Huey",
        "timestamp": 1589771059
    },
    {
        "content": "<p>Hmm, I don't have a strong opinion, but I think I personally favor the idea of weekly releases</p>",
        "id": 197971786,
        "sender_full_name": "nikomatsakis",
        "timestamp": 1589824076
    },
    {
        "content": "<p>or releases on some cadence</p>",
        "id": 197971793,
        "sender_full_name": "nikomatsakis",
        "timestamp": 1589824079
    },
    {
        "content": "<p>just because it's less headache for us to think about</p>",
        "id": 197971842,
        "sender_full_name": "nikomatsakis",
        "timestamp": 1589824088
    },
    {
        "content": "<p>\"when it's time for a release\"</p>",
        "id": 197971848,
        "sender_full_name": "nikomatsakis",
        "timestamp": 1589824093
    },
    {
        "content": "<p>at some point I would think that we would want to move to a 1.0 status, and at that point, we would have to have some tooling to know when we've issued breaking changes, or maybe we'd move off of the cadence</p>",
        "id": 197971915,
        "sender_full_name": "nikomatsakis",
        "timestamp": 1589824128
    },
    {
        "content": "<p>Oh, okay then weekly releases are good</p>",
        "id": 197972379,
        "sender_full_name": "Jack Huey",
        "timestamp": 1589824323
    },
    {
        "content": "<p>it would definitely be a \"caveat emptor\" sort of release</p>",
        "id": 197972491,
        "sender_full_name": "nikomatsakis",
        "timestamp": 1589824383
    },
    {
        "content": "<p>but that's ok</p>",
        "id": 197972496,
        "sender_full_name": "nikomatsakis",
        "timestamp": 1589824386
    },
    {
        "content": "<p>yeah, that's fine I think</p>",
        "id": 197972720,
        "sender_full_name": "Jack Huey",
        "timestamp": 1589824481
    },
    {
        "content": "<p>I imagine that this will give rust-analyzer some cadence with which to schedule upgrades? though maybe <span class=\"user-mention\" data-user-id=\"129457\">@Florian Diebold</span> can say if they're prefer something faster</p>",
        "id": 197973009,
        "sender_full_name": "nikomatsakis",
        "timestamp": 1589824619
    },
    {
        "content": "<p>I think weekly would be fine</p>",
        "id": 197973099,
        "sender_full_name": "Florian Diebold",
        "timestamp": 1589824651
    },
    {
        "content": "<p>Thanks guys, I will start on the action code to make a weekly release.</p>",
        "id": 198036838,
        "sender_full_name": "pksunkara",
        "timestamp": 1589877825
    },
    {
        "content": "<p>Here's the PR for setting up the publishing, <a href=\"https://github.com/rust-lang/chalk/pull/461\">https://github.com/rust-lang/chalk/pull/461</a></p>",
        "id": 198170908,
        "sender_full_name": "pksunkara",
        "timestamp": 1589965230
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"232957\">@Jack Huey</span> Hey, setting the tag as <code>dev</code> only without the <code>.0</code> will take some time. I assume you really want it to be like that. Just wanted to let you know</p>",
        "id": 198849991,
        "sender_full_name": "pksunkara",
        "timestamp": 1590555950
    },
    {
        "content": "<p>I don't really care <em>that</em> much</p>",
        "id": 198850046,
        "sender_full_name": "Jack Huey",
        "timestamp": 1590555984
    },
    {
        "content": "<p>I think we're just waiting for <span class=\"user-mention\" data-user-id=\"116009\">@nikomatsakis</span> to add a <a href=\"http://crates.io\">crates.io</a> token</p>",
        "id": 198850048,
        "sender_full_name": "Jack Huey",
        "timestamp": 1590556005
    },
    {
        "content": "<p>Then I'm good to merge</p>",
        "id": 198850049,
        "sender_full_name": "Jack Huey",
        "timestamp": 1590556010
    },
    {
        "content": "<p>Ok, thanks</p>",
        "id": 198850051,
        "sender_full_name": "pksunkara",
        "timestamp": 1590556016
    },
    {
        "content": "<p>This will actually be really nice</p>",
        "id": 198850058,
        "sender_full_name": "Jack Huey",
        "timestamp": 1590556068
    },
    {
        "content": "<p>Thanks :)</p>",
        "id": 198850060,
        "sender_full_name": "Jack Huey",
        "timestamp": 1590556075
    },
    {
        "content": "<p>So what ended up being the problem with making the bot?</p>",
        "id": 198956190,
        "sender_full_name": "Jack Huey",
        "timestamp": 1590615080
    },
    {
        "content": "<p>Anything I can help with?</p>",
        "id": 198984061,
        "sender_full_name": "pksunkara",
        "timestamp": 1590643871
    },
    {
        "content": "<p>OK, so <span class=\"user-mention\" data-user-id=\"121055\">@Pietro Albini</span> created a <code>rust-lang-chalk-publish-bot</code> user</p>",
        "id": 199042972,
        "sender_full_name": "nikomatsakis",
        "timestamp": 1590681939
    },
    {
        "content": "<p>I added it as owner to some chalk crates but I think there are some fresh ones that have never been published</p>",
        "id": 199042998,
        "sender_full_name": "nikomatsakis",
        "timestamp": 1590681955
    },
    {
        "content": "<ul>\n<li>chalk-base (I think we renamed this?)</li>\n<li>chalk-parse (maybe we never expect to publish this?)</li>\n<li>chalk-integration (I guess we never expect to publish this)</li>\n</ul>",
        "id": 199043083,
        "sender_full_name": "nikomatsakis",
        "timestamp": 1590681989
    },
    {
        "content": "<p>Not sure if <span class=\"user-mention\" data-user-id=\"121055\">@Pietro Albini</span> added the token for this already or not</p>",
        "id": 199043124,
        "sender_full_name": "nikomatsakis",
        "timestamp": 1590682013
    },
    {
        "content": "<p>Yeah. Parse and integration we don't publish</p>",
        "id": 199043145,
        "sender_full_name": "Jack Huey",
        "timestamp": 1590682025
    },
    {
        "content": "<p>Base hasn't been published</p>",
        "id": 199043153,
        "sender_full_name": "Jack Huey",
        "timestamp": 1590682031
    },
    {
        "content": "<p>ok so we should do an initial publish and setup the appropriate owners</p>",
        "id": 199043341,
        "sender_full_name": "nikomatsakis",
        "timestamp": 1590682124
    },
    {
        "content": "<p>Yes. Wonder if its worth just doing another round of releases</p>",
        "id": 199043780,
        "sender_full_name": "Jack Huey",
        "timestamp": 1590682342
    },
    {
        "content": "<p>accepted all invitations</p>",
        "id": 199043858,
        "sender_full_name": "Pietro Albini",
        "timestamp": 1590682399
    },
    {
        "content": "<p>this should work now!</p>",
        "id": 199043878,
        "sender_full_name": "Pietro Albini",
        "timestamp": 1590682412
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"232957\">@Jack Huey</span> can you manage the releasing etc?</p>",
        "id": 199045373,
        "sender_full_name": "nikomatsakis",
        "timestamp": 1590683096
    },
    {
        "content": "<p>to fixup chalk-base I mean</p>",
        "id": 199045390,
        "sender_full_name": "nikomatsakis",
        "timestamp": 1590683103
    },
    {
        "content": "<p>Yep</p>",
        "id": 199045708,
        "sender_full_name": "Jack Huey",
        "timestamp": 1590683259
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"116009\">@nikomatsakis</span> can you look at/merge <a href=\"https://github.com/rust-lang/chalk/pull/477\">https://github.com/rust-lang/chalk/pull/477</a> first though</p>",
        "id": 199045822,
        "sender_full_name": "Jack Huey",
        "timestamp": 1590683308
    },
    {
        "content": "<p>Pretty small, but if we're doing an upgrade, I want to upgrade version in rustc and it needs that change</p>",
        "id": 199045886,
        "sender_full_name": "Jack Huey",
        "timestamp": 1590683337
    },
    {
        "content": "<p>done</p>",
        "id": 199046665,
        "sender_full_name": "nikomatsakis",
        "timestamp": 1590683706
    },
    {
        "content": "<p>Now that chalk-engine relies on chalk-ir, can we avoid the need for chalk-base?</p>",
        "id": 199048026,
        "sender_full_name": "Mark Drobnak",
        "timestamp": 1590684381
    },
    {
        "content": "<p>That's...a good question</p>",
        "id": 199048172,
        "sender_full_name": "Jack Huey",
        "timestamp": 1590684471
    },
    {
        "content": "<p>It mostly contains common engine internal types (Floundered) and debugging macros</p>",
        "id": 199048250,
        "sender_full_name": "Mark Drobnak",
        "timestamp": 1590684491
    },
    {
        "content": "<p>Yeah</p>",
        "id": 199048266,
        "sender_full_name": "Jack Huey",
        "timestamp": 1590684498
    },
    {
        "content": "<p>Would anyone (<span class=\"user-mention\" data-user-id=\"116009\">@nikomatsakis</span>) object to me just moving chalk-base into chalk-ir and publishing</p>",
        "id": 199048321,
        "sender_full_name": "Jack Huey",
        "timestamp": 1590684529
    },
    {
        "content": "<p>So not quite what we want in a public API like chalk-ir, so maybe it's fine as an internal dependency?</p>",
        "id": 199048324,
        "sender_full_name": "Mark Drobnak",
        "timestamp": 1590684534
    },
    {
        "content": "<p>I mean,  they get included regardless</p>",
        "id": 199048385,
        "sender_full_name": "Jack Huey",
        "timestamp": 1590684575
    },
    {
        "content": "<p>They do? I mean, are users of chalk-ir currently able to use the types from chalk-base? I don't think so, unless they're re-exported?</p>",
        "id": 199048467,
        "sender_full_name": "Mark Drobnak",
        "timestamp": 1590684605
    },
    {
        "content": "<p>Ah, maybe not</p>",
        "id": 199048573,
        "sender_full_name": "Jack Huey",
        "timestamp": 1590684660
    },
    {
        "content": "<p>Err wait</p>",
        "id": 199048597,
        "sender_full_name": "Jack Huey",
        "timestamp": 1590684675
    },
    {
        "content": "<p>I mean, chalk-ir depends on chalk-base</p>",
        "id": 199048623,
        "sender_full_name": "Jack Huey",
        "timestamp": 1590684692
    },
    {
        "content": "<p>And uses types like <code>NoSolution</code></p>",
        "id": 199048633,
        "sender_full_name": "Jack Huey",
        "timestamp": 1590684700
    },
    {
        "content": "<p>I guess <code>Floundered</code> isn't used in chalk-ir directly</p>",
        "id": 199048725,
        "sender_full_name": "Jack Huey",
        "timestamp": 1590684743
    },
    {
        "content": "<p>Ya, <del>all</del> most of <code>results.rs</code> in chalk-base can be moved</p>",
        "id": 199048748,
        "sender_full_name": "Mark Drobnak",
        "timestamp": 1590684753
    },
    {
        "content": "<p>I think the bot can do the initial publishing this sunday</p>",
        "id": 199050582,
        "sender_full_name": "pksunkara",
        "timestamp": 1590685629
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"232957\">Jack Huey</span> <a href=\"#narrow/stream/144729-wg-traits/topic/publishing/near/199048321\">said</a>:</p>\n<blockquote>\n<p>Would anyone (<span class=\"user-mention silent\" data-user-id=\"116009\">nikomatsakis</span>) object to me just moving chalk-base into chalk-ir and publishing</p>\n</blockquote>\n<p>I have no objection to fewer crates :)</p>",
        "id": 199050636,
        "sender_full_name": "nikomatsakis",
        "timestamp": 1590685652
    },
    {
        "content": "<p>But if you still want to do the initial version, you can publish a 0.0.1 and immediately yank it</p>",
        "id": 199050661,
        "sender_full_name": "pksunkara",
        "timestamp": 1590685662
    },
    {
        "content": "<p>I'm not too concerned about chalk-ir having a narrow set of types just yet</p>",
        "id": 199050779,
        "sender_full_name": "nikomatsakis",
        "timestamp": 1590685691
    },
    {
        "content": "<p>I'm sure that will evolve over time</p>",
        "id": 199050794,
        "sender_full_name": "nikomatsakis",
        "timestamp": 1590685696
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"116009\">nikomatsakis</span> <a href=\"#narrow/stream/144729-wg-traits/topic/publishing/near/199050636\">said</a>:</p>\n<blockquote>\n<p><span class=\"user-mention silent\" data-user-id=\"232957\">Jack Huey</span> <a href=\"#narrow/stream/144729-wg-traits/topic/publishing/near/199048321\">said</a>:</p>\n<blockquote>\n<p>Would anyone (<span class=\"user-mention silent\" data-user-id=\"116009\">nikomatsakis</span>) object to me just moving chalk-base into chalk-ir and publishing</p>\n</blockquote>\n<p>I have no objection to fewer crates :)</p>\n</blockquote>\n<p>I figured hehe</p>",
        "id": 199051281,
        "sender_full_name": "Jack Huey",
        "timestamp": 1590685898
    },
    {
        "content": "<p>I'm getting rid of chalk-base now. So technically don't need to do a release now?</p>",
        "id": 199051397,
        "sender_full_name": "Jack Huey",
        "timestamp": 1590685938
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"116009\">@nikomatsakis</span> Should I still do a release or do we want to just wait until Sunday</p>",
        "id": 199051459,
        "sender_full_name": "Jack Huey",
        "timestamp": 1590685962
    },
    {
        "content": "<p><a href=\"https://github.com/rust-lang/chalk/pull/479\">https://github.com/rust-lang/chalk/pull/479</a> for anyone who wants to take a look (<span class=\"user-mention\" data-user-id=\"116009\">@nikomatsakis</span> or <span class=\"user-mention\" data-user-id=\"218805\">@Mark Drobnak</span>)</p>",
        "id": 199054961,
        "sender_full_name": "Jack Huey",
        "timestamp": 1590687336
    },
    {
        "content": "<p>Okay, so <em>theoretically</em> we can merge the publishing PR now and it should work</p>",
        "id": 199057446,
        "sender_full_name": "Jack Huey",
        "timestamp": 1590688524
    },
    {
        "content": "<p>Before Sunday, someone should update the RELEASES.md for the unreleased changes so far :)</p>",
        "id": 199057573,
        "sender_full_name": "Jack Huey",
        "timestamp": 1590688577
    },
    {
        "content": "<p>PR looks good</p>",
        "id": 199078075,
        "sender_full_name": "nikomatsakis",
        "timestamp": 1590696204
    },
    {
        "content": "<p>Do we have the key setup in github actions etc now?</p>",
        "id": 199078105,
        "sender_full_name": "nikomatsakis",
        "timestamp": 1590696212
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"121055\">Pietro Albini</span> <a href=\"#narrow/stream/144729-wg-traits/topic/publishing/near/199043878\">said</a>:</p>\n<blockquote>\n<p>this should work now!</p>\n</blockquote>\n<p><span aria-label=\"shrug\" class=\"emoji emoji-1f937\" role=\"img\" title=\"shrug\">:shrug:</span>‍♀️</p>",
        "id": 199081446,
        "sender_full_name": "Jack Huey",
        "timestamp": 1590697365
    },
    {
        "content": "<p>I think we can go ahead. I will keep an eye on the Sunday publishing</p>",
        "id": 199086879,
        "sender_full_name": "pksunkara",
        "timestamp": 1590700118
    },
    {
        "content": "<p>If any issues pop up, I will send follow-up PRs</p>",
        "id": 199086910,
        "sender_full_name": "pksunkara",
        "timestamp": 1590700137
    },
    {
        "content": "<p>I see a CARGO_REGISTRY_TOKEN in the repository settings</p>",
        "id": 199087319,
        "sender_full_name": "nikomatsakis",
        "timestamp": 1590700372
    },
    {
        "content": "<p>added 7 hours ago</p>",
        "id": 199087322,
        "sender_full_name": "nikomatsakis",
        "timestamp": 1590700374
    },
    {
        "content": "<p>so .. probably yes!</p>",
        "id": 199087328,
        "sender_full_name": "nikomatsakis",
        "timestamp": 1590700376
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"116009\">@nikomatsakis</span> should we merge then?</p>",
        "id": 199094172,
        "sender_full_name": "Jack Huey",
        "timestamp": 1590704981
    },
    {
        "content": "<p>yes</p>",
        "id": 199131804,
        "sender_full_name": "nikomatsakis",
        "timestamp": 1590744184
    },
    {
        "content": "<p>Merged</p>",
        "id": 199166424,
        "sender_full_name": "Jack Huey",
        "timestamp": 1590764682
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"232957\">@Jack Huey</span> Corrected the small mistake in the publishing script. <a href=\"https://github.com/rust-lang/chalk/pull/482\">https://github.com/rust-lang/chalk/pull/482</a></p>",
        "id": 199291404,
        "sender_full_name": "pksunkara",
        "timestamp": 1590902319
    },
    {
        "content": "<p>Do you think we can merge it today?</p>",
        "id": 199291405,
        "sender_full_name": "pksunkara",
        "timestamp": 1590902326
    },
    {
        "content": "<p>yes</p>",
        "id": 199291542,
        "sender_full_name": "Jack Huey",
        "timestamp": 1590902563
    },
    {
        "content": "<p>Thanks</p>",
        "id": 199291596,
        "sender_full_name": "pksunkara",
        "timestamp": 1590902644
    },
    {
        "content": "<p>It should run the publishing tonight and I will check tomorrow</p>",
        "id": 199291598,
        "sender_full_name": "pksunkara",
        "timestamp": 1590902665
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"232957\">@Jack Huey</span> New morning, new PR. <a href=\"https://github.com/rust-lang/chalk/pull/483\">https://github.com/rust-lang/chalk/pull/483</a>. Also, please delete this tag, <a href=\"https://github.com/rust-lang/chalk/releases/tag/v0.10.1\">https://github.com/rust-lang/chalk/releases/tag/v0.10.1</a></p>",
        "id": 199338277,
        "sender_full_name": "pksunkara",
        "timestamp": 1590989334
    },
    {
        "content": "<p>I explained in the PR what went wrong and how I fixed it</p>",
        "id": 199338283,
        "sender_full_name": "pksunkara",
        "timestamp": 1590989346
    },
    {
        "content": "<p>Let's get it merged today</p>",
        "id": 199338290,
        "sender_full_name": "pksunkara",
        "timestamp": 1590989362
    },
    {
        "content": "<p><a href=\"https://github.com/rust-lang/chalk/pull/484\">https://github.com/rust-lang/chalk/pull/484</a>. Thanks for the catch <span class=\"user-mention\" data-user-id=\"218805\">@Mark Drobnak</span></p>",
        "id": 199378961,
        "sender_full_name": "pksunkara",
        "timestamp": 1591023451
    },
    {
        "content": "<p>bleh ok</p>",
        "id": 199379366,
        "sender_full_name": "Jack Huey",
        "timestamp": 1591023642
    },
    {
        "content": "<p>how sure are we this is correct now</p>",
        "id": 199379449,
        "sender_full_name": "Jack Huey",
        "timestamp": 1591023697
    },
    {
        "content": "<p>I tested this command before, but in the morning while updating, I mistakenly used the alias I generally use locally</p>",
        "id": 199379585,
        "sender_full_name": "pksunkara",
        "timestamp": 1591023768
    },
    {
        "content": "<p>Can you set it to just publish in like an hour?</p>",
        "id": 199379978,
        "sender_full_name": "Jack Huey",
        "timestamp": 1591023961
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"232957\">@Jack Huey</span> Done</p>",
        "id": 199381770,
        "sender_full_name": "pksunkara",
        "timestamp": 1591024762
    },
    {
        "content": "<p>Okay fingers crossed</p>",
        "id": 199381940,
        "sender_full_name": "Jack Huey",
        "timestamp": 1591024843
    },
    {
        "content": "<p>Sometimes, I feel like I shouldn't do programming at all. <span aria-label=\"distraught\" class=\"emoji emoji-1f629\" role=\"img\" title=\"distraught\">:distraught:</span></p>",
        "id": 199389187,
        "sender_full_name": "pksunkara",
        "timestamp": 1591028280
    },
    {
        "content": "<p><a href=\"https://github.com/rust-lang/chalk/pull/485\">https://github.com/rust-lang/chalk/pull/485</a></p>",
        "id": 199389189,
        "sender_full_name": "pksunkara",
        "timestamp": 1591028281
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"232957\">@Jack Huey</span> ^^</p>",
        "id": 199390278,
        "sender_full_name": "pksunkara",
        "timestamp": 1591028812
    },
    {
        "content": "<p>Again bleh</p>",
        "id": 199396256,
        "sender_full_name": "Jack Huey",
        "timestamp": 1591031710
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"254853\">@pksunkara</span> release failed</p>",
        "id": 199404853,
        "sender_full_name": "Jack Huey",
        "timestamp": 1591035871
    },
    {
        "content": "<p>The cargo package verifying is weird. Would love if someone can help me design the workflow.</p>",
        "id": 199404961,
        "sender_full_name": "pksunkara",
        "timestamp": 1591035923
    },
    {
        "content": "<p><code>cargo-workspaces</code> builds the DAG correctly</p>",
        "id": 199404990,
        "sender_full_name": "pksunkara",
        "timestamp": 1591035940
    },
    {
        "content": "<p>It currently verifies all packages first and then publishes them</p>",
        "id": 199405097,
        "sender_full_name": "pksunkara",
        "timestamp": 1591035976
    },
    {
        "content": "<p>But I guess the package which has a dependency (<code>chalk-ir</code> in this case) fails the verification because the dependency (<code>chalk-derive</code> in this case) is not yet published to <a href=\"http://crates.io\">crates.io</a></p>",
        "id": 199405169,
        "sender_full_name": "pksunkara",
        "timestamp": 1591036026
    },
    {
        "content": "<p>We could verify and publish each package individually.</p>",
        "id": 199405267,
        "sender_full_name": "pksunkara",
        "timestamp": 1591036077
    },
    {
        "content": "<p>But what happens when a verification fails in the middle?</p>",
        "id": 199405331,
        "sender_full_name": "pksunkara",
        "timestamp": 1591036094
    },
    {
        "content": "<p>Only some packages would end up being published</p>",
        "id": 199405349,
        "sender_full_name": "pksunkara",
        "timestamp": 1591036107
    },
    {
        "content": "<p>I don't know if there's an alternative</p>",
        "id": 199405704,
        "sender_full_name": "Jack Huey",
        "timestamp": 1591036333
    },
    {
        "content": "<p>Probably not even worth doing verification</p>",
        "id": 199405721,
        "sender_full_name": "Jack Huey",
        "timestamp": 1591036349
    },
    {
        "content": "<p>Even if we don't do verification, the publish will still fail because <a href=\"http://crates.io\">crates.io</a> doesn't seem to update the index fast enough</p>",
        "id": 199422559,
        "sender_full_name": "pksunkara",
        "timestamp": 1591045214
    },
    {
        "content": "<p>An example publish I just tried</p>\n<div class=\"codehilite\"><pre><span></span><code>    Updating crates.io index\n   Packaging reign_derive v0.2.0 (/Users/pksunkara/Coding/pksunkara/reign/reign_derive)\n   Uploading reign_derive v0.2.0 (/Users/pksunkara/Coding/pksunkara/reign/reign_derive)\ninfo published reign_derive\n    Updating crates.io index\n   Packaging reign v0.2.0 (/Users/pksunkara/Coding/pksunkara/reign)\nerror: failed to prepare local package for uploading\n\nCaused by:\n  failed to select a version for the requirement `reign_derive = &quot;^0.2.0&quot;`\n  candidate versions found which didn&#39;t match: 0.1.2\n  location searched: crates.io index\n</code></pre></div>",
        "id": 199422690,
        "sender_full_name": "pksunkara",
        "timestamp": 1591045269
    },
    {
        "content": "<p>I wonder what I can do here to refresh the <a href=\"http://crates.io\">crates.io</a> index for every publish command. Maybe <span class=\"user-mention\" data-user-id=\"121055\">@Pietro Albini</span> can help me here?</p>",
        "id": 199422851,
        "sender_full_name": "pksunkara",
        "timestamp": 1591045327
    },
    {
        "content": "<p>This is something that I saw when publishing: <a href=\"http://rust-lang.github.io/chalk/book/publishing.html\">http://rust-lang.github.io/chalk/book/publishing.html</a></p>",
        "id": 199425735,
        "sender_full_name": "Jack Huey",
        "timestamp": 1591046611
    },
    {
        "content": "<p>So, it seems the issue is due to the \"cycle\" in the DAG due to the dev-dependency? What I've done to solve this is remove the version from the dev-dependency so it's just the path that remains. Not sure if we've already done that though</p>\n<p>Edit: might be talking about the wrong issue</p>",
        "id": 199425746,
        "sender_full_name": "Mark Drobnak",
        "timestamp": 1591046614
    },
    {
        "content": "<blockquote>\n<p>You will probably have to wait a couple seconds between each to let the index update</p>\n</blockquote>",
        "id": 199425755,
        "sender_full_name": "Jack Huey",
        "timestamp": 1591046619
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"218805\">@Mark Drobnak</span> that's not the issue :)</p>",
        "id": 199425850,
        "sender_full_name": "Jack Huey",
        "timestamp": 1591046650
    },
    {
        "content": "<p>Darn, I had such a good solution ;)</p>",
        "id": 199425878,
        "sender_full_name": "Mark Drobnak",
        "timestamp": 1591046665
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"254853\">@pksunkara</span> Honestly, you can just wait 5 seconds between each publish</p>",
        "id": 199425887,
        "sender_full_name": "Jack Huey",
        "timestamp": 1591046671
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"218805\">@Mark Drobnak</span> what was the solution</p>",
        "id": 199425902,
        "sender_full_name": "Jack Huey",
        "timestamp": 1591046682
    },
    {
        "content": "<p>oh</p>",
        "id": 199425926,
        "sender_full_name": "Jack Huey",
        "timestamp": 1591046699
    },
    {
        "content": "<p>you wrote it</p>",
        "id": 199425931,
        "sender_full_name": "Jack Huey",
        "timestamp": 1591046702
    },
    {
        "content": "<p>I can do the wait. That was my first thought too</p>",
        "id": 199426020,
        "sender_full_name": "pksunkara",
        "timestamp": 1591046746
    },
    {
        "content": "<p>But I wanted to ask if anyone knows what the time I should wait for is</p>",
        "id": 199426062,
        "sender_full_name": "pksunkara",
        "timestamp": 1591046762
    },
    {
        "content": "<p>Is it 5s or 1 minute or something else?</p>",
        "id": 199426101,
        "sender_full_name": "pksunkara",
        "timestamp": 1591046775
    },
    {
        "content": "<p>cargo-release seems to have some code for this: <a href=\"https://github.com/sunng87/cargo-release/pull/194\">https://github.com/sunng87/cargo-release/pull/194</a></p>",
        "id": 199426174,
        "sender_full_name": "Mark Drobnak",
        "timestamp": 1591046822
    },
    {
        "content": "<p>I've found that just 5 seconds is enough</p>",
        "id": 199426187,
        "sender_full_name": "Jack Huey",
        "timestamp": 1591046829
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"218805\">@Mark Drobnak</span> Thanks. That PR is helpful</p>",
        "id": 199426298,
        "sender_full_name": "pksunkara",
        "timestamp": 1591046884
    },
    {
        "content": "<p>using the <code>crates-index</code> crate might not be a bad solution either</p>",
        "id": 199426308,
        "sender_full_name": "Jack Huey",
        "timestamp": 1591046889
    },
    {
        "content": "<p>Here's the current method:<br>\n<a href=\"https://github.com/sunng87/cargo-release/blob/109de52c204ac274fe5e6ec07d33cc28737d1db0/src/cargo.rs#L59\">https://github.com/sunng87/cargo-release/blob/109de52c204ac274fe5e6ec07d33cc28737d1db0/src/cargo.rs#L59</a><br>\nAnd how it's used:<br>\n<a href=\"https://github.com/sunng87/cargo-release/blob/a9aa11a521c4a2c1ce4ae4d32bb9731c340e21c9/src/main.rs#L704\">https://github.com/sunng87/cargo-release/blob/a9aa11a521c4a2c1ce4ae4d32bb9731c340e21c9/src/main.rs#L704</a></p>\n<p>They use a timeout of 5 minutes, but check every second.</p>",
        "id": 199426371,
        "sender_full_name": "Mark Drobnak",
        "timestamp": 1591046949
    },
    {
        "content": "<p>the <a href=\"http://crates.io\">crates.io</a> index is updated in a background task</p>",
        "id": 199429001,
        "sender_full_name": "Pietro Albini",
        "timestamp": 1591048613
    },
    {
        "content": "<p>so depending on the background queue it <em>might</em> take a while</p>",
        "id": 199429019,
        "sender_full_name": "Pietro Albini",
        "timestamp": 1591048626
    },
    {
        "content": "<p>if it takes too long I'm paged so let's hope it doesn't do that <span aria-label=\"smiley\" class=\"emoji emoji-1f603\" role=\"img\" title=\"smiley\">:smiley:</span></p>",
        "id": 199429038,
        "sender_full_name": "Pietro Albini",
        "timestamp": 1591048641
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"254853\">@pksunkara</span> are you going to be able to do this today? If not, I am probably going to manually publish</p>",
        "id": 199430655,
        "sender_full_name": "Jack Huey",
        "timestamp": 1591049757
    },
    {
        "content": "<p>Yes, I will do it today</p>",
        "id": 199451457,
        "sender_full_name": "pksunkara",
        "timestamp": 1591075268
    },
    {
        "content": "<p>Done. <a href=\"https://github.com/rust-lang/chalk/pull/486\">https://github.com/rust-lang/chalk/pull/486</a></p>",
        "id": 199458315,
        "sender_full_name": "pksunkara",
        "timestamp": 1591083343
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"232957\">@Jack Huey</span> ^^</p>",
        "id": 199458370,
        "sender_full_name": "pksunkara",
        "timestamp": 1591083370
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"254853\">@pksunkara</span> release was successful but there was a failure in the workflow</p>",
        "id": 199528413,
        "sender_full_name": "Jack Huey",
        "timestamp": 1591120186
    },
    {
        "content": "<p>so no release commit was generated</p>",
        "id": 199528423,
        "sender_full_name": "Jack Huey",
        "timestamp": 1591120193
    },
    {
        "content": "<p>Yeah, because you updated the master branch</p>",
        "id": 199528494,
        "sender_full_name": "pksunkara",
        "timestamp": 1591120207
    },
    {
        "content": "<p>yeah just realized</p>",
        "id": 199528506,
        "sender_full_name": "Jack Huey",
        "timestamp": 1591120213
    },
    {
        "content": "<p>my bad</p>",
        "id": 199528528,
        "sender_full_name": "Jack Huey",
        "timestamp": 1591120228
    },
    {
        "content": "<p>Np</p>",
        "id": 199528534,
        "sender_full_name": "pksunkara",
        "timestamp": 1591120234
    },
    {
        "content": "<p>If you have cargo-workspaces installed, you can fix it</p>",
        "id": 199528581,
        "sender_full_name": "pksunkara",
        "timestamp": 1591120263
    },
    {
        "content": "<p>by running the following command on master</p>",
        "id": 199528588,
        "sender_full_name": "pksunkara",
        "timestamp": 1591120270
    },
    {
        "content": "<p>by running the following command on master</p>",
        "id": 199528594,
        "sender_full_name": "pksunkara",
        "timestamp": 1591120275
    },
    {
        "content": "<p>If you have cargo-workspaces installed, you can fix it</p>",
        "id": 199528595,
        "sender_full_name": "pksunkara",
        "timestamp": 1591120275
    },
    {
        "content": "<p>(I thought github didn't pick up the schedule in time)</p>",
        "id": 199528596,
        "sender_full_name": "Jack Huey",
        "timestamp": 1591120275
    },
    {
        "content": "<p>Actually do you want the versioned commit in the master branch now?</p>",
        "id": 199528701,
        "sender_full_name": "pksunkara",
        "timestamp": 1591120324
    },
    {
        "content": "<p>what do you mean?</p>",
        "id": 199528736,
        "sender_full_name": "Jack Huey",
        "timestamp": 1591120343
    },
    {
        "content": "<p>Or can you just update the whole repo to <code>0.12.0-dev</code> and say good enough?</p>",
        "id": 199528754,
        "sender_full_name": "pksunkara",
        "timestamp": 1591120350
    },
    {
        "content": "<p>Mmm, I think I'm just gonna update to 0.12.0-dev and call it good enough</p>",
        "id": 199528802,
        "sender_full_name": "Jack Huey",
        "timestamp": 1591120376
    },
    {
        "content": "<p>(or is it <code>0.12.0-dev.0</code>?)</p>",
        "id": 199528819,
        "sender_full_name": "Jack Huey",
        "timestamp": 1591120386
    },
    {
        "content": "<p>Yeah, sounds better to me too</p>",
        "id": 199528820,
        "sender_full_name": "pksunkara",
        "timestamp": 1591120386
    },
    {
        "content": "<p>Doesn't matter</p>",
        "id": 199528840,
        "sender_full_name": "pksunkara",
        "timestamp": 1591120394
    },
    {
        "content": "<p>And please change the schedule to <code>0 0 * * 0</code></p>",
        "id": 199528869,
        "sender_full_name": "pksunkara",
        "timestamp": 1591120412
    },
    {
        "content": "<p>mhm</p>",
        "id": 199528910,
        "sender_full_name": "Jack Huey",
        "timestamp": 1591120438
    },
    {
        "content": "<p>I am sorry that it had so many issues. But it should hopefully run smoothly from now on</p>",
        "id": 199529067,
        "sender_full_name": "pksunkara",
        "timestamp": 1591120513
    },
    {
        "content": "<p>Yeah, should be good now :)</p>",
        "id": 199529357,
        "sender_full_name": "Jack Huey",
        "timestamp": 1591120620
    },
    {
        "content": "<p>All in the name of automation :)</p>",
        "id": 199529379,
        "sender_full_name": "Jack Huey",
        "timestamp": 1591120627
    },
    {
        "content": "<p>thanks</p>",
        "id": 199529384,
        "sender_full_name": "Jack Huey",
        "timestamp": 1591120630
    },
    {
        "content": "<p>Thank you for helping me too <span aria-label=\"slight smile\" class=\"emoji emoji-1f642\" role=\"img\" title=\"slight smile\">:slight_smile:</span></p>",
        "id": 199529423,
        "sender_full_name": "pksunkara",
        "timestamp": 1591120651
    },
    {
        "content": "<p>Did you want to help to get bors-ng up?</p>",
        "id": 199529518,
        "sender_full_name": "Jack Huey",
        "timestamp": 1591120685
    },
    {
        "content": "<p>I am afraid I will have similar issues getting it set up. I don't have access to settings and it is always tough to do so</p>",
        "id": 199529573,
        "sender_full_name": "pksunkara",
        "timestamp": 1591120717
    },
    {
        "content": "<p>But I did set it up on <a href=\"https://github.com/clap-rs/clap\">https://github.com/clap-rs/clap</a></p>",
        "id": 199529588,
        "sender_full_name": "pksunkara",
        "timestamp": 1591120727
    },
    {
        "content": "<p>If you need guidance on what to do, I can help</p>",
        "id": 199529608,
        "sender_full_name": "pksunkara",
        "timestamp": 1591120741
    },
    {
        "content": "<p>The <code>bors.toml</code> file should be easier here</p>",
        "id": 199529701,
        "sender_full_name": "pksunkara",
        "timestamp": 1591120783
    },
    {
        "content": "<p>It's a little unfortunate you can't give per-repo admin accesss, for settings</p>",
        "id": 199529730,
        "sender_full_name": "Jack Huey",
        "timestamp": 1591120796
    },
    {
        "content": "<p>You can in github. Just create a new team for just that one member. :D</p>",
        "id": 199529884,
        "sender_full_name": "pksunkara",
        "timestamp": 1591120854
    },
    {
        "content": "<p>oh</p>",
        "id": 199530164,
        "sender_full_name": "Jack Huey",
        "timestamp": 1591120979
    },
    {
        "content": "<p>I didn't know that</p>",
        "id": 199530207,
        "sender_full_name": "Jack Huey",
        "timestamp": 1591120998
    },
    {
        "content": "<p>You would need one CI job that is basically the status of all the other CI jobs in <code>ci.yml</code> and then use it in bors config</p>",
        "id": 199530652,
        "sender_full_name": "pksunkara",
        "timestamp": 1591121220
    },
    {
        "content": "<p>hmm</p>",
        "id": 199530969,
        "sender_full_name": "Jack Huey",
        "timestamp": 1591121385
    },
    {
        "content": "<p>As I said, you can copy this CI job and the config from clap repo (except for the merge blocked labels and cut body after setting). After that's done, you should disallow everyone from merging into master except for bors. Also need to make the bors status check required</p>",
        "id": 199531231,
        "sender_full_name": "pksunkara",
        "timestamp": 1591121521
    },
    {
        "content": "<p>The configs are just a small part of setting this up. Most of the other stuff requires admin access</p>",
        "id": 199531332,
        "sender_full_name": "pksunkara",
        "timestamp": 1591121548
    },
    {
        "content": "<p>btw <span class=\"user-mention\" data-user-id=\"254853\">@pksunkara</span> I was talking to <span class=\"user-mention\" data-user-id=\"121055\">@Pietro Albini</span> and he thought we can just use regular bors, it has its own queue that is indep. from rust-lang/rust, and I think he said that the infra folks can set it up easily enough</p>",
        "id": 199552151,
        "sender_full_name": "nikomatsakis",
        "timestamp": 1591131331
    },
    {
        "content": "<p>What do you mean by regular bors here?</p>",
        "id": 199552551,
        "sender_full_name": "pksunkara",
        "timestamp": 1591131508
    },
    {
        "content": "<p>bors-ng or @bors?</p>",
        "id": 199552570,
        "sender_full_name": "pksunkara",
        "timestamp": 1591131514
    },
    {
        "content": "<p>heh @bors</p>",
        "id": 199554594,
        "sender_full_name": "nikomatsakis",
        "timestamp": 1591132308
    },
    {
        "content": "<p>Then, I think that's the best approach here</p>",
        "id": 199560939,
        "sender_full_name": "pksunkara",
        "timestamp": 1591136410
    },
    {
        "content": "<p>ok, so there are two things that needs to be done on your end before we can enable bors on the repository</p>",
        "id": 199891490,
        "sender_full_name": "Pietro Albini",
        "timestamp": 1591370267
    },
    {
        "content": "<p>first, a PR to the <code>rust-lang/team</code> repository needs to be sent, choosing which people will have access to bors</p>",
        "id": 199891566,
        "sender_full_name": "Pietro Albini",
        "timestamp": 1591370291
    },
    {
        "content": "<p><code>chalk</code> needs to be added to the list of repos <a href=\"https://github.com/rust-lang/team/blob/67c3ad78ff90550caffd1f61b55a19a6e4d95aa1/src/permissions.rs#L170-L186\">in <code>permissions.rs</code></a>, and the <code>bors.chalk.review = true</code> permission needs to be assigned to all the members you want to allow to merge changes</p>",
        "id": 199891753,
        "sender_full_name": "Pietro Albini",
        "timestamp": 1591370374
    },
    {
        "content": "<p>then bors needs a single job to gate on, which is not really possible on github actions</p>",
        "id": 199891882,
        "sender_full_name": "Pietro Albini",
        "timestamp": 1591370414
    },
    {
        "content": "<p>what we've been doing is creating a <code>bors build finished</code> job that depends on all the other jobs in the workflow, like <a href=\"https://github.com/rust-lang/crater/blob/c3f462bdab37a93c24b2b172b90564749e892cbc/.github/workflows/bors.yml#L126-L150\">what I did with crater</a></p>",
        "id": 199891924,
        "sender_full_name": "Pietro Albini",
        "timestamp": 1591370443
    },
    {
        "content": "<p>once those two things are done I can setup bors on infra's end</p>",
        "id": 199891938,
        "sender_full_name": "Pietro Albini",
        "timestamp": 1591370452
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"116009\">@nikomatsakis</span> <span class=\"user-mention\" data-user-id=\"254853\">@pksunkara</span> ^</p>",
        "id": 199891964,
        "sender_full_name": "Pietro Albini",
        "timestamp": 1591370464
    },
    {
        "content": "<p>ok</p>",
        "id": 199896006,
        "sender_full_name": "nikomatsakis",
        "timestamp": 1591372121
    },
    {
        "content": "<p>the permission has to be assigned on the individual level?</p>",
        "id": 199896025,
        "sender_full_name": "nikomatsakis",
        "timestamp": 1591372134
    },
    {
        "content": "<p>or can it be assigned on a \"team\" level, <span class=\"user-mention\" data-user-id=\"121055\">@Pietro Albini</span> ?</p>",
        "id": 199896041,
        "sender_full_name": "nikomatsakis",
        "timestamp": 1591372143
    },
    {
        "content": "<p>it can be assigned to teams</p>",
        "id": 199896059,
        "sender_full_name": "Pietro Albini",
        "timestamp": 1591372155
    },
    {
        "content": "<p>it's the usual</p>\n<div class=\"codehilite\"><pre><span></span><code><span class=\"k\">[permissions]</span>\n<span class=\"n\">bors</span><span class=\"p\">.</span><span class=\"n\">chalk</span><span class=\"p\">.</span><span class=\"n\">review</span> <span class=\"o\">=</span> <span class=\"kc\">true</span>\n</code></pre></div>",
        "id": 199896093,
        "sender_full_name": "Pietro Albini",
        "timestamp": 1591372177
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"254853\">@pksunkara</span> automatic publishing didn't complete (completely) successfully</p>",
        "id": 200036565,
        "sender_full_name": "Jack Huey",
        "timestamp": 1591555195
    },
    {
        "content": "<p>failed during chalk-engine</p>",
        "id": 200036611,
        "sender_full_name": "Jack Huey",
        "timestamp": 1591555219
    },
    {
        "content": "<p><code>failed to select a version for the requirement chalk-ir = \"= 0.12.0\"</code></p>",
        "id": 200036619,
        "sender_full_name": "Jack Huey",
        "timestamp": 1591555236
    },
    {
        "content": "<p>So seems like the fix for registry updates didn't work</p>",
        "id": 200036645,
        "sender_full_name": "Jack Huey",
        "timestamp": 1591555292
    },
    {
        "content": "<p>Wow. <a href=\"http://Crates.io\">Crates.io</a> index did refresh since we saw <code>wait.. and published</code>, but verifying still failed</p>",
        "id": 200036704,
        "sender_full_name": "pksunkara",
        "timestamp": 1591555366
    },
    {
        "content": "<p>interesting</p>",
        "id": 200036733,
        "sender_full_name": "Jack Huey",
        "timestamp": 1591555441
    },
    {
        "content": "<p><code>chalk-ir</code> depended on <code>chalk-derive</code> which worked. You can see the <code>Downloaded chalk-derive v0.12.0</code> part</p>",
        "id": 200036775,
        "sender_full_name": "pksunkara",
        "timestamp": 1591555461
    },
    {
        "content": "<p>But <code>chalk-engine</code> depending on <code>chalk-ir</code> didn't work</p>",
        "id": 200036785,
        "sender_full_name": "pksunkara",
        "timestamp": 1591555475
    },
    {
        "content": "<p>Right</p>",
        "id": 200036793,
        "sender_full_name": "Jack Huey",
        "timestamp": 1591555489
    },
    {
        "content": "<p>Seems racy too me</p>",
        "id": 200036795,
        "sender_full_name": "Jack Huey",
        "timestamp": 1591555494
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"121055\">@Pietro Albini</span> Is it possible that <a href=\"http://crates.io\">crates.io</a> index does not show updates for a later request once it had shown an update for an earlier request?</p>",
        "id": 200036876,
        "sender_full_name": "pksunkara",
        "timestamp": 1591555586
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"232957\">@Jack Huey</span> I will fix this during this week. You might want to update the versions to <code>0.13.0-dev</code> in the repo before next publish</p>",
        "id": 200036970,
        "sender_full_name": "pksunkara",
        "timestamp": 1591555724
    },
    {
        "content": "<p>Yeah, I'll do that</p>",
        "id": 200037001,
        "sender_full_name": "Jack Huey",
        "timestamp": 1591555797
    },
    {
        "content": "<p>I guess some crates aren't getting a <code>0.12.0</code></p>",
        "id": 200037046,
        "sender_full_name": "Jack Huey",
        "timestamp": 1591555809
    },
    {
        "content": "<p>mostly because I don't feel like manually publishing</p>",
        "id": 200037051,
        "sender_full_name": "Jack Huey",
        "timestamp": 1591555819
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"254853\">@pksunkara</span> hmm do you have a log? I'll take a look at it tomorrow</p>",
        "id": 200037053,
        "sender_full_name": "Pietro Albini",
        "timestamp": 1591555821
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"121055\">@Pietro Albini</span> <a href=\"https://github.com/rust-lang/chalk/runs/746123579?check_suite_focus=true\">https://github.com/rust-lang/chalk/runs/746123579?check_suite_focus=true</a></p>",
        "id": 200037067,
        "sender_full_name": "Jack Huey",
        "timestamp": 1591555856
    },
    {
        "content": "<p>specifically</p>\n<blockquote>\n<p>info waiting ...<br>\ninfo published chalk-ir</p>\n</blockquote>",
        "id": 200037081,
        "sender_full_name": "Jack Huey",
        "timestamp": 1591555883
    },
    {
        "content": "<p><a href=\"https://github.com/rust-lang/chalk/runs/746123579?check_suite_focus=true#step:5:75\">https://github.com/rust-lang/chalk/runs/746123579?check_suite_focus=true#step:5:75</a> happens when we find <code>chalk-ir = 0.12.0</code> in crates index.</p>",
        "id": 200037086,
        "sender_full_name": "pksunkara",
        "timestamp": 1591555895
    },
    {
        "content": "<p>But you can see this message after that saying it's not available. <a href=\"https://github.com/rust-lang/chalk/runs/746123579?check_suite_focus=true#step:5:82\">https://github.com/rust-lang/chalk/runs/746123579?check_suite_focus=true#step:5:82</a></p>",
        "id": 200037132,
        "sender_full_name": "pksunkara",
        "timestamp": 1591555934
    },
    {
        "content": "<p>The checking for index related code is here, <a href=\"https://github.com/pksunkara/cargo-workspaces/blob/master/cargo-workspaces/src/utils/cargo.rs#L185\">https://github.com/pksunkara/cargo-workspaces/blob/master/cargo-workspaces/src/utils/cargo.rs#L185</a></p>",
        "id": 200037246,
        "sender_full_name": "pksunkara",
        "timestamp": 1591556109
    },
    {
        "content": "<p>wat</p>",
        "id": 200073551,
        "sender_full_name": "Pietro Albini",
        "timestamp": 1591607571
    },
    {
        "content": "<p>ok, so my current theory is that updating the cargo index with <code>crates-index</code> is not invalidating cargo's caches</p>",
        "id": 200073622,
        "sender_full_name": "Pietro Albini",
        "timestamp": 1591607630
    },
    {
        "content": "<p>cargo caches the contents of the index for chalk-ir, then you update the index without invalidating such caches and finally when you try to publish the dependent cargo loads the stale cache</p>",
        "id": 200073748,
        "sender_full_name": "Pietro Albini",
        "timestamp": 1591607704
    },
    {
        "content": "<p>I'm not familiar enough with cargo's internals to know that for sure</p>",
        "id": 200073776,
        "sender_full_name": "Pietro Albini",
        "timestamp": 1591607726
    },
    {
        "content": "<p>so I'd either ask someone on the cargo team for their opinion, or try using another clone of the index in your code</p>",
        "id": 200073795,
        "sender_full_name": "Pietro Albini",
        "timestamp": 1591607747
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"121055\">@Pietro Albini</span> Thanks. But the <code>cargo</code> commands are being run by calling the binary, so the cache shouldn't be shared between multiple publishes. I don't know anyone from cargo team. Any suggestion on whom to ping?</p>",
        "id": 200166061,
        "sender_full_name": "pksunkara",
        "timestamp": 1591657321
    },
    {
        "content": "<blockquote>\n<p>But the cargo commands are being run by calling the binary, so the cache shouldn't be shared between multiple publishes. </p>\n</blockquote>\n<p>There is a filesystem cache in <code>.cargo/registry/index/{name}/.cache</code>. I'd ask in <code>#cargo</code> on Discord.</p>",
        "id": 200203568,
        "sender_full_name": "Pietro Albini",
        "timestamp": 1591697197
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"232957\">@Jack Huey</span> The cargo team says it shouldn't happen. If the index master is updated, then the cache would be invalidated. <a href=\"https://discord.com/channels/442252698964721669/459149260232065034/719899648470548589\">https://discord.com/channels/442252698964721669/459149260232065034/719899648470548589</a></p>",
        "id": 200277269,
        "sender_full_name": "pksunkara",
        "timestamp": 1591730422
    },
    {
        "content": "<p>Hmm, interesting</p>",
        "id": 200277357,
        "sender_full_name": "Jack Huey",
        "timestamp": 1591730486
    },
    {
        "content": "<p>I think I found the issue, just waiting for some confirmations. <code>crates-index</code> is updating the <code>master</code> ref for the index</p>",
        "id": 200295226,
        "sender_full_name": "pksunkara",
        "timestamp": 1591739251
    },
    {
        "content": "<p>While <code>cargo</code> seems to read the <code>origin/master</code> ref directly</p>",
        "id": 200295252,
        "sender_full_name": "pksunkara",
        "timestamp": 1591739272
    },
    {
        "content": "<p>I can't find the <code>origin</code> remote in the index at all and the modern <code>cargo</code> doesn't need it</p>",
        "id": 200295301,
        "sender_full_name": "pksunkara",
        "timestamp": 1591739286
    },
    {
        "content": "<p>So, I fixed this and tested it. The <code>origin/remote</code> for index is now getting updated</p>",
        "id": 200300242,
        "sender_full_name": "pksunkara",
        "timestamp": 1591742456
    },
    {
        "content": "<p>I'm confused</p>",
        "id": 200301438,
        "sender_full_name": "Jack Huey",
        "timestamp": 1591743245
    },
    {
        "content": "<p>But it should be fixed?</p>",
        "id": 200301443,
        "sender_full_name": "Jack Huey",
        "timestamp": 1591743249
    },
    {
        "content": "<p>Yeah, once I refresh the crates-index and see that the just published crate is added, I would also update the <code>origin/master</code> ref so that <code>cargo</code> invalidates its cache and properly picks up the published crate</p>",
        "id": 200398984,
        "sender_full_name": "pksunkara",
        "timestamp": 1591784466
    },
    {
        "content": "<p>And that's what <a href=\"https://github.com/pksunkara/cargo-workspaces/commit/99598a1397fde6575bda6ef4efc9575f0df4c7a8\">this</a> commit does</p>",
        "id": 200399039,
        "sender_full_name": "pksunkara",
        "timestamp": 1591784510
    },
    {
        "content": "<p>Okay does any in <span class=\"user-group-mention\" data-user-group-id=\"692\">@WG-traits</span> want to make a commit to update all the crates to <code>0.13.0-dev.0</code>? Maybe <span class=\"user-mention\" data-user-id=\"116009\">@nikomatsakis</span> I'm not sure if I'll have time today, but would rather it not slip through the cracks before next release.</p>",
        "id": 200706793,
        "sender_full_name": "Jack Huey",
        "timestamp": 1591986433
    },
    {
        "content": "<p>I can try to do that <span class=\"user-mention\" data-user-id=\"232957\">@Jack Huey</span> -- I'm not 100% sure <em>why</em> it needs to be done, but maybe if I read back in this topic I would know why :)</p>",
        "id": 200716327,
        "sender_full_name": "nikomatsakis",
        "timestamp": 1591991180
    },
    {
        "content": "<p>TLDR: publishing failed last week, but to publish, we drop the <code>.dev.0</code> suffix. So, if it's not changed, it'll try to publish <code>0.12</code>, which some crates were successfully published and others failed</p>",
        "id": 200716459,
        "sender_full_name": "Jack Huey",
        "timestamp": 1591991272
    },
    {
        "content": "<p>Ok, I'm pushing up a branch with  the new versions</p>",
        "id": 200727974,
        "sender_full_name": "nikomatsakis",
        "timestamp": 1591998323
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"232957\">@Jack Huey</span> <a href=\"https://github.com/rust-lang/chalk/pull/522\">https://github.com/rust-lang/chalk/pull/522</a></p>",
        "id": 200728406,
        "sender_full_name": "nikomatsakis",
        "timestamp": 1591998698
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"232957\">@Jack Huey</span> Woo! It should be okay from now. Just ping me here if you ever have issues with it later</p>",
        "id": 200802797,
        "sender_full_name": "pksunkara",
        "timestamp": 1592116018
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"254853\">@pksunkara</span> fantastic! Thanks for getting this set up :)</p>",
        "id": 200828478,
        "sender_full_name": "Jack Huey",
        "timestamp": 1592160488
    },
    {
        "content": "<p>can we trigger a release easily now? we'd like to update in RA, but it's blocked on <a href=\"https://github.com/rust-lang-nursery/chalk/issues/541\">chalk#541</a>. Of course it <em>could</em> wait a week, but it'd be nice</p>",
        "id": 201823080,
        "sender_full_name": "Florian Diebold",
        "timestamp": 1592987623
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"129457\">@Florian Diebold</span> so you can't trigger a github action manually</p>",
        "id": 201852811,
        "sender_full_name": "Jack Huey",
        "timestamp": 1593008305
    },
    {
        "content": "<p>So, we either would have to publish manually, or change the schedule on master to publish now, then change back after</p>",
        "id": 201852870,
        "sender_full_name": "Jack Huey",
        "timestamp": 1593008342
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"133169\">@matklad</span> I've always wondered, how do you manually trigger the RA releases?</p>",
        "id": 201853075,
        "sender_full_name": "Laurențiu",
        "timestamp": 1593008423
    },
    {
        "content": "<p>Publishing is triggered on pushes to the <code>release</code> branch, so I just push the release</p>",
        "id": 201853626,
        "sender_full_name": "matklad",
        "timestamp": 1593008657
    },
    {
        "content": "<p>There's also the specific hook to trigger github actions through the github api, but the workflow has to be set up for it. Maybe it might be work setting that up as a secondary trigger</p>",
        "id": 201853658,
        "sender_full_name": "Jack Huey",
        "timestamp": 1593008669
    },
    {
        "content": "<p>Ooh, a release branch wouldn't be terrible</p>",
        "id": 201853710,
        "sender_full_name": "Jack Huey",
        "timestamp": 1593008691
    },
    {
        "content": "<blockquote>\n<p>As minor version bumps</p>\n</blockquote>\n<p>Do you plan to bump the actual version of Cargo.toml? For auto-publishing, I think it might make sense to use build number as a version.</p>",
        "id": 201854399,
        "sender_full_name": "matklad",
        "timestamp": 1593008978
    },
    {
        "content": "<p>Yeah, the actual minor versions are getting bumped</p>",
        "id": 201854491,
        "sender_full_name": "Jack Huey",
        "timestamp": 1593009008
    },
    {
        "content": "<p>This is all pre 1.0.0, which I think is fine</p>",
        "id": 201854533,
        "sender_full_name": "Jack Huey",
        "timestamp": 1593009026
    },
    {
        "content": "<p>I think once we hit 1.0.0, I would be more inclined to switch to manual releases</p>",
        "id": 201854664,
        "sender_full_name": "Jack Huey",
        "timestamp": 1593009072
    },
    {
        "content": "<p>It's just that development is moving pretty quick right now.</p>",
        "id": 201854764,
        "sender_full_name": "Jack Huey",
        "timestamp": 1593009116
    },
    {
        "content": "<p>I would imagine the \"end state\" would be that both Chalk and RA get stable releases in sync with rustc?</p>",
        "id": 201854770,
        "sender_full_name": "Florian Diebold",
        "timestamp": 1593009120
    },
    {
        "content": "<p>Indeed</p>",
        "id": 201854829,
        "sender_full_name": "Jack Huey",
        "timestamp": 1593009130
    },
    {
        "content": "<p>Well, in sync</p>",
        "id": 201854869,
        "sender_full_name": "Jack Huey",
        "timestamp": 1593009147
    },
    {
        "content": "<p>Or</p>",
        "id": 201854871,
        "sender_full_name": "Jack Huey",
        "timestamp": 1593009149
    },
    {
        "content": "<p>not sure how nightlies would fit into that though</p>",
        "id": 201854874,
        "sender_full_name": "Florian Diebold",
        "timestamp": 1593009151
    },
    {
        "content": "<p>More often</p>",
        "id": 201854880,
        "sender_full_name": "Jack Huey",
        "timestamp": 1593009155
    },
    {
        "content": "<p>Or less often, I suppose</p>",
        "id": 201854909,
        "sender_full_name": "Jack Huey",
        "timestamp": 1593009165
    },
    {
        "content": "<p>I don't think we can provide semver relases of RA API during the next few years, so optimizing for that seems wrong. </p>\n<p>Not sure about chalk -- would it be feasible to provide semver API \"soon\"?</p>",
        "id": 201854992,
        "sender_full_name": "matklad",
        "timestamp": 1593009200
    },
    {
        "content": "<p>For chalk, I say no</p>",
        "id": 201855113,
        "sender_full_name": "Jack Huey",
        "timestamp": 1593009246
    },
    {
        "content": "<p>We still have more big things being added</p>",
        "id": 201855191,
        "sender_full_name": "Jack Huey",
        "timestamp": 1593009279
    },
    {
        "content": "<p>And refactors being done</p>",
        "id": 201855201,
        "sender_full_name": "Jack Huey",
        "timestamp": 1593009285
    },
    {
        "content": "<p>I would say that we'll be close to semver ready when chalk is ready to be used in rustc without everything not working</p>",
        "id": 201855321,
        "sender_full_name": "Jack Huey",
        "timestamp": 1593009354
    },
    {
        "content": "<p>Going back to <span class=\"user-mention\" data-user-id=\"129457\">@Florian Diebold</span>'s point, I don't necessarily think chalk needs to track rustc. I think actually the opposite, since I think we want chalk to be a \"stable trait solver implementation\"</p>",
        "id": 201855518,
        "sender_full_name": "Jack Huey",
        "timestamp": 1593009449
    },
    {
        "content": "<p>well, it's a side point anyway</p>",
        "id": 201855576,
        "sender_full_name": "Florian Diebold",
        "timestamp": 1593009478
    },
    {
        "content": "<p>But I think this is less known, yeah</p>",
        "id": 201855639,
        "sender_full_name": "Jack Huey",
        "timestamp": 1593009489
    },
    {
        "content": "<p>I agree that I would expect chalk / rustc releases to be relatively \"independent\"</p>",
        "id": 201857514,
        "sender_full_name": "nikomatsakis",
        "timestamp": 1593010279
    },
    {
        "content": "<blockquote>\n<p>why does this need a manual publishing process?</p>\n</blockquote>\n<p><span class=\"user-mention\" data-user-id=\"116009\">@nikomatsakis</span> because you need to review that you don't actually break the semver, and check which part of the version to increment. Well, I suppose, once you have a good coverage of public API by integration tests, you might want to setup continuous publishing, but that is needs even <em>more</em> guaratees than manual publishing. </p>\n<p>I guess what I am trying to say is the property that really matters is \"does it semver\"? If it doesn't automatic publishing is just an elaborate way to pick a specific git hash.</p>",
        "id": 201861956,
        "sender_full_name": "matklad",
        "timestamp": 1593012147
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"133169\">@matklad</span> I would imagine you do that when you land the PR, and you bump the version then</p>",
        "id": 201870435,
        "sender_full_name": "nikomatsakis",
        "timestamp": 1593015949
    },
    {
        "content": "<p>put another way, rustc manages nightly and timed releases ...</p>",
        "id": 201870497,
        "sender_full_name": "nikomatsakis",
        "timestamp": 1593015968
    },
    {
        "content": "<p>...of course our semver is fairly trivial</p>",
        "id": 201870509,
        "sender_full_name": "nikomatsakis",
        "timestamp": 1593015976
    },
    {
        "content": "<p>(I guess people have looked into what the best workflows are here...I'm not sure. But it seems like automated releases + stable semver are not incompatible.)</p>",
        "id": 201870748,
        "sender_full_name": "nikomatsakis",
        "timestamp": 1593016089
    },
    {
        "content": "<p>Automatic publishing in this case is only until people want to start tracking semver stuff</p>",
        "id": 202505026,
        "sender_full_name": "pksunkara",
        "timestamp": 1593557564
    },
    {
        "content": "<p>But yes, the intention behind auto publishing chalk is to pick a specific git hash but in such a way the tools that use this can be published to <a href=\"http://crates.io\">crates.io</a></p>",
        "id": 202505059,
        "sender_full_name": "pksunkara",
        "timestamp": 1593557607
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"232957\">@Jack Huey</span> Some commit broke the crate structure. <a href=\"https://github.com/rust-lang/chalk/runs/861796621?check_suite_focus=true#step:5:279\">https://github.com/rust-lang/chalk/runs/861796621?check_suite_focus=true#step:5:279</a></p>",
        "id": 203635702,
        "sender_full_name": "pksunkara",
        "timestamp": 1594546002
    },
    {
        "content": "<p>I've been idly thinking about this, and I've realized that I have been missing an important reason why publishing is better than direct git repos: for downloading dependencies, <a href=\"http://crates.io\">crates.io</a> has higher availability than GitHub.</p>",
        "id": 203698694,
        "sender_full_name": "matklad",
        "timestamp": 1594635985
    },
    {
        "content": "<p>-ish. Recall that the <a href=\"http://crates.io\">crates.io</a> index is distributed via GitHub.</p>",
        "id": 203737827,
        "sender_full_name": "Jake Goulding",
        "timestamp": 1594658159
    },
    {
        "content": "<p>fyi <span class=\"user-mention\" data-user-id=\"254853\">@pksunkara</span>, regenerated the <a href=\"http://crates.io\">crates.io</a> token for chalk publishing</p>",
        "id": 203878752,
        "sender_full_name": "Pietro Albini",
        "timestamp": 1594756175
    },
    {
        "content": "<p>so it should still work after today's revocation</p>",
        "id": 203878791,
        "sender_full_name": "Pietro Albini",
        "timestamp": 1594756197
    },
    {
        "content": "<p>Wait, what happened?</p>",
        "id": 203887809,
        "sender_full_name": "Jack Huey",
        "timestamp": 1594760525
    },
    {
        "content": "<p>Presumably <a href=\"https://blog.rust-lang.org/2020/07/14/crates-io-security-advisory.html\">this</a></p>",
        "id": 203891368,
        "sender_full_name": "Nathan Whitaker",
        "timestamp": 1594762432
    },
    {
        "content": "<p>ohh</p>",
        "id": 203892403,
        "sender_full_name": "Jack Huey",
        "timestamp": 1594763160
    },
    {
        "content": "<p>Looks like the publishing workflow <a href=\"https://github.com/rust-lang/chalk/actions/runs/174163297\">failed</a>. I <em>suspect</em> it's an issue with the cargo registry token due to the recent revocation, but I'm not entirely positive.</p>",
        "id": 204324766,
        "sender_full_name": "Nathan Whitaker",
        "timestamp": 1595119328
    },
    {
        "content": "<p>Huh weird. \"Unable to auto-detect email address\"</p>",
        "id": 204324828,
        "sender_full_name": "Jack Huey",
        "timestamp": 1595119462
    },
    {
        "content": "<p>Seems like a git thing</p>",
        "id": 204324829,
        "sender_full_name": "Jack Huey",
        "timestamp": 1595119466
    },
    {
        "content": "<p>It's weird it hasn't been a problem before</p>",
        "id": 204324843,
        "sender_full_name": "Jack Huey",
        "timestamp": 1595119524
    },
    {
        "content": "<p>Seems like setting the email for git in the script would fix it</p>",
        "id": 204324848,
        "sender_full_name": "Jack Huey",
        "timestamp": 1595119546
    },
    {
        "content": "<p>Ah yeah looks like it usually sets the email automatically but failed this time <span aria-label=\"thinking\" class=\"emoji emoji-1f914\" role=\"img\" title=\"thinking\">:thinking:</span></p>",
        "id": 204325242,
        "sender_full_name": "Nathan Whitaker",
        "timestamp": 1595120386
    },
    {
        "content": "<p>Heh, I will send a PR updating the things to make it better non-scheduled publishing too <span aria-label=\"slight smile\" class=\"emoji emoji-1f642\" role=\"img\" title=\"slight smile\">:slight_smile:</span></p>",
        "id": 204343367,
        "sender_full_name": "pksunkara",
        "timestamp": 1595155360
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"232957\">@Jack Huey</span> <span class=\"user-mention\" data-user-id=\"230601\">@Nathan Whitaker</span> <a href=\"https://github.com/rust-lang/chalk/pull/578\">https://github.com/rust-lang/chalk/pull/578</a></p>",
        "id": 204547583,
        "sender_full_name": "pksunkara",
        "timestamp": 1595338454
    },
    {
        "content": "<p>Now, when rust-analyzer needs chalk to be published, it can be easily done. And no more changing the workflows too when publishes fail</p>",
        "id": 204547634,
        "sender_full_name": "pksunkara",
        "timestamp": 1595338491
    },
    {
        "content": "<p>Hey <span class=\"user-mention\" data-user-id=\"121055\">@Pietro Albini</span>,  the steps on our end for setting up bors should be done now. Whenever you have free time, I think now all that's left is for bors to be setup on infra's end :)</p>",
        "id": 204865434,
        "sender_full_name": "Nathan Whitaker",
        "timestamp": 1595547442
    },
    {
        "content": "<p>once <a href=\"https://travis-ci.com/github/rust-lang/rust-central-station/builds/177016439\">https://travis-ci.com/github/rust-lang/rust-central-station/builds/177016439</a> I'll deploy the changes :)</p>",
        "id": 204902159,
        "sender_full_name": "Pietro Albini",
        "timestamp": 1595587955
    },
    {
        "content": "<p>it should be up now!</p>",
        "id": 204904466,
        "sender_full_name": "Pietro Albini",
        "timestamp": 1595589739
    },
    {
        "content": "<p>What do we actually have to do for bors to work and merge PRs? I tried <code>@bors r+</code> but it didn't work</p>",
        "id": 204957984,
        "sender_full_name": "Jack Huey",
        "timestamp": 1595619673
    },
    {
        "content": "<p>Maybe bors also needs R/W access to the chalk repo on Github? (i.e. <a href=\"https://github.com/orgs/rust-lang/teams/bots/repositories\">here</a>)</p>",
        "id": 204958803,
        "sender_full_name": "Nathan Whitaker",
        "timestamp": 1595620150
    },
    {
        "content": "<p>But that's an absolute guess</p>",
        "id": 204958822,
        "sender_full_name": "Nathan Whitaker",
        "timestamp": 1595620161
    },
    {
        "content": "<p>is bors integrated on the repo? you can test by doing <code>@bors ping</code> or <code>bors: ping</code></p>",
        "id": 204960188,
        "sender_full_name": "DPC",
        "timestamp": 1595620926
    },
    {
        "content": "<p>Hmm pinging bors had no effect</p>",
        "id": 204960756,
        "sender_full_name": "Nathan Whitaker",
        "timestamp": 1595621258
    },
    {
        "content": "<p>(Sorry to keep pinging you, but) any ideas <span class=\"user-mention\" data-user-id=\"121055\">@Pietro Albini</span>?</p>",
        "id": 204963643,
        "sender_full_name": "Nathan Whitaker",
        "timestamp": 1595623029
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"230601\">@Nathan Whitaker</span> try again?</p>",
        "id": 204969702,
        "sender_full_name": "Pietro Albini",
        "timestamp": 1595626719
    },
    {
        "content": "<p>gave perms to bors</p>",
        "id": 204969703,
        "sender_full_name": "Pietro Albini",
        "timestamp": 1595626721
    },
    {
        "content": "<p>Yup that fixed it, thanks for the help!</p>",
        "id": 204969895,
        "sender_full_name": "Nathan Whitaker",
        "timestamp": 1595626909
    },
    {
        "content": "<p>&lt;3</p>",
        "id": 204970088,
        "sender_full_name": "Jack Huey",
        "timestamp": 1595627073
    },
    {
        "content": "<p>So, I would consider the automated releases a success and say it's done. Unless I missed something</p>",
        "id": 206529270,
        "sender_full_name": "pksunkara",
        "timestamp": 1597105913
    },
    {
        "content": "<p>Indeed, it is working great! The only thing that I think is left to do (not needed currently) is allowing to specify the version during manual publishing</p>",
        "id": 206630267,
        "sender_full_name": "Jack Huey",
        "timestamp": 1597179407
    },
    {
        "content": "<p>Manual publishing should always be done from command line. I would keep the auto until 1.0 and then we can remove it</p>",
        "id": 206640653,
        "sender_full_name": "pksunkara",
        "timestamp": 1597186403
    },
    {
        "content": "<p>Nevermind, I realise you are talking about this line, <a href=\"https://github.com/rust-lang/chalk/blob/master/.github/workflows/publish.yml#L3\">https://github.com/rust-lang/chalk/blob/master/.github/workflows/publish.yml#L3</a></p>",
        "id": 206695051,
        "sender_full_name": "pksunkara",
        "timestamp": 1597239864
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"254853\">pksunkara</span> <a href=\"#narrow/stream/144729-wg-traits/topic/publishing/near/206640653\">said</a>:</p>\n<blockquote>\n<p>Manual publishing should always be done from command line. I would keep the auto until 1.0 and then we can remove it</p>\n</blockquote>\n<p>I disagree. A big benefit of having the actions set up for publishing is it makes <em>manual</em> publishing seemless <em>too</em>. Nobody has to go and figure out the exact process for publishing.</p>",
        "id": 206728346,
        "sender_full_name": "Jack Huey",
        "timestamp": 1597255062
    },
    {
        "content": "<p>Okay yeah. The comment I wrote on that publish workflow will allow the kind of publish you want. Just need to improve it. I guess it's something for later</p>",
        "id": 206769571,
        "sender_full_name": "pksunkara",
        "timestamp": 1597278372
    },
    {
        "content": "<p>Anyone know what happened here?</p>",
        "id": 216741161,
        "sender_full_name": "pksunkara",
        "timestamp": 1605376150
    },
    {
        "content": "<p><a href=\"https://github.com/rust-lang/chalk/runs/1368992799?check_suite_focus=true\">https://github.com/rust-lang/chalk/runs/1368992799?check_suite_focus=true</a></p>",
        "id": 216741163,
        "sender_full_name": "pksunkara",
        "timestamp": 1605376153
    },
    {
        "content": "<p><a href=\"https://crates.io/crates/chalk-derive\">https://crates.io/crates/chalk-derive</a> is released but the process exited</p>",
        "id": 216741198,
        "sender_full_name": "pksunkara",
        "timestamp": 1605376194
    },
    {
        "content": "<p>When did we add bors?</p>",
        "id": 216741295,
        "sender_full_name": "pksunkara",
        "timestamp": 1605376275
    },
    {
        "content": "<p>No clue what happened here. Bors was added a while ago.</p>",
        "id": 216750930,
        "sender_full_name": "Jack Huey",
        "timestamp": 1605389175
    },
    {
        "content": "<p>This seems potentially spurious given that the prior releases worked fine.</p>",
        "id": 216750935,
        "sender_full_name": "Jack Huey",
        "timestamp": 1605389194
    },
    {
        "content": "<p>This might break the next release because it will try to publish the same version again.</p>",
        "id": 216750945,
        "sender_full_name": "Matthew Jasper",
        "timestamp": 1605389249
    },
    {
        "content": "<p>But...this is probably going to break</p>",
        "id": 216750946,
        "sender_full_name": "Jack Huey",
        "timestamp": 1605389253
    },
    {
        "content": "<p>Oh, beat me</p>",
        "id": 216750948,
        "sender_full_name": "Jack Huey",
        "timestamp": 1605389260
    },
    {
        "content": "<p>Yeah, I will fix version when I get home in a bit</p>",
        "id": 216750987,
        "sender_full_name": "Jack Huey",
        "timestamp": 1605389287
    },
    {
        "content": "<p>Kind of time sensitive since it's going to try to publish tonight.</p>",
        "id": 216750996,
        "sender_full_name": "Jack Huey",
        "timestamp": 1605389325
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"232957\">Jack Huey</span> <a href=\"#narrow/stream/144729-wg-traits/topic/publishing/near/216750935\">said</a>:</p>\n<blockquote>\n<p>This seems potentially spurious given that the prior releases worked fine.</p>\n</blockquote>\n<p><del>It broke because it was merging my PR</del></p>",
        "id": 216751010,
        "sender_full_name": "Léo Lanteri Thauvin",
        "timestamp": 1605389397
    },
    {
        "content": "<p>So if anyone can get to pushing a bump to 0.39.0-dev.0 before I can, feel free.</p>",
        "id": 216751032,
        "sender_full_name": "Jack Huey",
        "timestamp": 1605389404
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"232957\">Jack Huey</span> <a href=\"#narrow/stream/144729-wg-traits/topic/publishing/near/216751032\">said</a>:</p>\n<blockquote>\n<p>So if anyone can get to pushing a bump to 0.39.0-dev.0 before I can, feel free.</p>\n</blockquote>\n<p>It's just modifying the <code>Cargo.toml</code> file? Can do :D</p>",
        "id": 216751059,
        "sender_full_name": "Léo Lanteri Thauvin",
        "timestamp": 1605389425
    },
    {
        "content": "<p>Every Cargo.toml</p>",
        "id": 216751061,
        "sender_full_name": "Jack Huey",
        "timestamp": 1605389437
    },
    {
        "content": "<p>Basically, just search for 0.38.0-dev.0 and replace with 0.39.0-dev.0</p>",
        "id": 216751073,
        "sender_full_name": "Jack Huey",
        "timestamp": 1605389472
    },
    {
        "content": "<p>It should look similar to <a href=\"https://github.com/rust-lang/chalk/commit/65daa08f07fcea1314c0bffd731e1fef1b76d619\">https://github.com/rust-lang/chalk/commit/65daa08f07fcea1314c0bffd731e1fef1b76d619</a></p>",
        "id": 216751163,
        "sender_full_name": "Jack Huey",
        "timestamp": 1605389556
    },
    {
        "content": "<p>So 38 changes, which is what I'm getting with a basic find and replace, so that's good</p>",
        "id": 216751320,
        "sender_full_name": "Léo Lanteri Thauvin",
        "timestamp": 1605389744
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"232957\">@Jack Huey</span> <a href=\"https://github.com/rust-lang/chalk/issues/653\">chalk#653</a></p>",
        "id": 216751513,
        "sender_full_name": "Léo Lanteri Thauvin",
        "timestamp": 1605389933
    },
    {
        "content": "<p>Thanks :)</p>",
        "id": 216751596,
        "sender_full_name": "Jack Huey",
        "timestamp": 1605390005
    },
    {
        "content": "<p>If there is a problem tonight with the auto-publish, I will look into it more tomorrow</p>",
        "id": 216751607,
        "sender_full_name": "Jack Huey",
        "timestamp": 1605390030
    },
    {
        "content": "<p>Side note, there's a problem in the book</p>",
        "id": 216751632,
        "sender_full_name": "Léo Lanteri Thauvin",
        "timestamp": 1605390066
    },
    {
        "content": "<p>Linkcheck fails on <a href=\"https://mozilla.hosted.panopto.com/rust-meetup-march-2017/\">https://mozilla.hosted.panopto.com/rust-meetup-march-2017/</a> which returns a 403 Forbidden error</p>",
        "id": 216751652,
        "sender_full_name": "Léo Lanteri Thauvin",
        "timestamp": 1605390092
    },
    {
        "content": "<p>I noticed that. I had hoped that it was temporary. Guess not.</p>",
        "id": 216752433,
        "sender_full_name": "Jack Huey",
        "timestamp": 1605390891
    },
    {
        "content": "<p>That shouldn't affect publishing. But yeah, should be a simple fix.</p>",
        "id": 216752461,
        "sender_full_name": "Jack Huey",
        "timestamp": 1605390925
    },
    {
        "content": "<p>I was wondering if we changed any github branch protection setting after we added bors. The action pushes some commits to master after publishing is finished.</p>",
        "id": 216764118,
        "sender_full_name": "pksunkara",
        "timestamp": 1605407270
    }
]