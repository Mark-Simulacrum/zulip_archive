[
    {
        "content": "<p><a href=\"https://github.com/rust-lang/rust/blob/master/library/core/src/fmt/num.rs#L249-L264\">https://github.com/rust-lang/rust/blob/master/library/core/src/fmt/num.rs#L249-L264</a></p>\n<p>Edited itoa crate is about 10% faster than itoa 0.4.8 in a local micro bench.</p>\n<p><a href=\"https://play.rust-lang.org/?version=nightly&amp;mode=debug&amp;edition=2018&amp;gist=d9d5f7345ea2609ad7ce053b05cbfc3e\">https://play.rust-lang.org/?version=nightly&amp;mode=debug&amp;edition=2018&amp;gist=d9d5f7345ea2609ad7ce053b05cbfc3e</a></p>",
        "id": 250420557,
        "sender_full_name": "Bot+",
        "timestamp": 1629757806
    },
    {
        "content": "<p>Wait, itoa was pulled into stdlib?</p>",
        "id": 250422983,
        "sender_full_name": "Jacob Pratt",
        "timestamp": 1629759616
    },
    {
        "content": "<p>the worlds smallest nit: <a href=\"https://github.com/rust-lang/rust/blob/master/library/core/src/fmt/num.rs#L203\">https://github.com/rust-lang/rust/blob/master/library/core/src/fmt/num.rs#L203</a> should use <code>[u8; 200]</code> (not <code>&amp;[u8; 200]</code>) to avoid an extra relocation</p>",
        "id": 250428669,
        "sender_full_name": "Thom Chiovoloni",
        "timestamp": 1629763999
    },
    {
        "content": "<p>I guess change <code>static</code> to <code>const</code> would do the same trick.</p>",
        "id": 250428798,
        "sender_full_name": "Gary Guo",
        "timestamp": 1629764136
    },
    {
        "content": "<p>it might yeah. i'd still suggest making the deref explicit, but const has more leeway here so maybe it can figure it out and not require a reloc for the pointer to the data in addition to the data.</p>",
        "id": 250429011,
        "sender_full_name": "Thom Chiovoloni",
        "timestamp": 1629764390
    },
    {
        "content": "<p>Well, <code>const</code> is generally preferred to <code>static</code> because they don't need an unique address. <a href=\"https://godbolt.org/z/eKG9j4n5G\">https://godbolt.org/z/eKG9j4n5G</a></p>\n<p>Having said that, I don't think there'll be multiple copies of this string so it wouldn't matter.</p>",
        "id": 250429452,
        "sender_full_name": "Gary Guo",
        "timestamp": 1629764820
    },
    {
        "content": "<p>well, the multiple copies isn't what i'm referring to, its the two relocations (one for the pointer to the data, and one for the data itself). only one of those is needed. this won't show up in godbolt, though. that said, yeah, in general const is better, i agree.</p>",
        "id": 250430304,
        "sender_full_name": "Thom Chiovoloni",
        "timestamp": 1629765623
    },
    {
        "content": "<p>i think you can still have the same problem here i'm talking about with const, but i'm not positive. anyway, its a super minor complaint. it makes like, 8b/16b of difference in the binary size, and a bit of perf when during loading as well as accessing.</p>",
        "id": 250430336,
        "sender_full_name": "Thom Chiovoloni",
        "timestamp": 1629765672
    },
    {
        "content": "<p><code>const</code> won't have the additional deref. It's a value and doesn't have an address.</p>\n<p><a href=\"https://godbolt.org/z/Gr9fc7vjG\">https://godbolt.org/z/Gr9fc7vjG</a>  This example shows that all 3 functions are exactly the same so they are merged.  Actually there isn't a runtime overhead of the current approach.</p>",
        "id": 250430921,
        "sender_full_name": "Gary Guo",
        "timestamp": 1629766252
    },
    {
        "content": "<p>ah, nice, okay</p>",
        "id": 250430964,
        "sender_full_name": "Thom Chiovoloni",
        "timestamp": 1629766291
    },
    {
        "content": "<p>okay, so using const instead would also fix this.</p>",
        "id": 250430988,
        "sender_full_name": "Thom Chiovoloni",
        "timestamp": 1629766319
    }
]