[
    {
        "content": "<div class=\"codehilite\"><pre><span></span><code>trait Read {\n    fn remaining_hint(&amp;self) -&gt; Option&lt;u64&gt; { None }\n}\n</code></pre></div>\n<p>What do you think about adding a way for readers to hint how much data they have remaining? Many readers don't know this, but some like <code>&amp;[u8]</code> and <code>File</code> do. This could let <code>read_to_end</code> and <code>read_to_string</code> optimize their buffer resizing. It might also help <code>BufReader</code> (maybe? I haven't thought that through yet...).</p>",
        "id": 257742453,
        "sender_full_name": "John Kugelman",
        "timestamp": 1634322127
    },
    {
        "content": "<p>I say \"hint\" because it could obviously change... TOCTOU and all.</p>",
        "id": 257742549,
        "sender_full_name": "John Kugelman",
        "timestamp": 1634322170
    },
    {
        "content": "<p>There already is an internal <code>SizeHint</code> trait that does something similar, it's used to produce the size_hint for the Bytes iterator.</p>",
        "id": 257743114,
        "sender_full_name": "The 8472",
        "timestamp": 1634322392
    },
    {
        "content": "<p>I didn't know about that. I grepped through the codebase and <code>SizeHint</code> is implemented on a remarkable number of types. I didn't see any other uses of it other than <code>Bytes::size_hint</code>, though. How curious.</p>",
        "id": 257780535,
        "sender_full_name": "John Kugelman",
        "timestamp": 1634340413
    },
    {
        "content": "<p>A trait method would have a couple of nice features:</p>\n<ol>\n<li>It could be implemented on custom readers outside of <code>std</code>. <code>SizeHint</code>, being private, is limited to standard readers.</li>\n<li><code>SizeHint</code> is only available on generic <code>R: Read</code> but not as a trait method on <code>&amp;dyn Read</code>.</li>\n</ol>",
        "id": 257780812,
        "sender_full_name": "John Kugelman",
        "timestamp": 1634340608
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"336609\">erikdesjardins</span> has marked this topic as resolved.</p>",
        "id": 257839546,
        "sender_full_name": "Notification Bot",
        "timestamp": 1634398103
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"336609\">erikdesjardins</span> has marked this topic as unresolved.</p>",
        "id": 257839553,
        "sender_full_name": "Notification Bot",
        "timestamp": 1634398109
    },
    {
        "content": "<p>ugh zulip why is that button there, sorry</p>",
        "id": 257839570,
        "sender_full_name": "erikdesjardins",
        "timestamp": 1634398127
    }
]