[
    {
        "content": "<p><span aria-label=\"wave\" class=\"emoji emoji-1f44b\" role=\"img\" title=\"wave\">:wave:</span> I pinged on <a href=\"https://github.com/rust-lang/rust/pull/87073\">https://github.com/rust-lang/rust/pull/87073</a> but never got a response - is it ok to duplicate the entire ~1000 line file of <a href=\"http://primitive_docs.rs\">primitive_docs.rs</a> in core? I added a tidy check to make sure it's kept in sync with the version in std, but it is an extra step every time you need to modify it.</p>",
        "id": 252557609,
        "sender_full_name": "Joshua Nelson",
        "timestamp": 1631150599
    },
    {
        "content": "<p>If it's literally the same, can you <code>#[path]</code> it?</p>",
        "id": 252565253,
        "sender_full_name": "cuviper",
        "timestamp": 1631157243
    },
    {
        "content": "<p>no, unfortunately - <code>include_str!</code> works relative to the file itself, not the rust module</p>",
        "id": 252565419,
        "sender_full_name": "Joshua Nelson",
        "timestamp": 1631157404
    },
    {
        "content": "<p>see <a href=\"#narrow/stream/122651-general/topic/Who.20should.20review.20changes.20to.20linkchecker.3F/near/249939598\">https://rust-lang.zulipchat.com/#narrow/stream/122651-general/topic/Who.20should.20review.20changes.20to.20linkchecker.3F/near/249939598</a></p>",
        "id": 252565437,
        "sender_full_name": "Joshua Nelson",
        "timestamp": 1631157423
    },
    {
        "content": "<p>(I approved <a href=\"https://github.com/rust-lang/rust/pull/87073\">https://github.com/rust-lang/rust/pull/87073</a> for now, but happy to make changes in follow ups - I just really want to get it merged so it can unblock other rustdoc PRs)</p>",
        "id": 252565754,
        "sender_full_name": "Joshua Nelson",
        "timestamp": 1631157731
    },
    {
        "content": "<blockquote>\n<p>is it ok to duplicate the entire ~1000 line file of <a href=\"http://primitive_docs.rs\">primitive_docs.rs</a> in core?</p>\n</blockquote>\n<p>every time we've had duplication in the standard library, only one of the copies ended up being maintained.</p>",
        "id": 252577022,
        "sender_full_name": "Mara",
        "timestamp": 1631168770
    },
    {
        "content": "<p>but with the tidy check here that's not a risk</p>",
        "id": 252578010,
        "sender_full_name": "Mara",
        "timestamp": 1631169537
    },
    {
        "content": "<p>why not check a symlink into git?</p>",
        "id": 252596818,
        "sender_full_name": "The 8472",
        "timestamp": 1631179907
    },
    {
        "content": "<p>Before windows 10 symlinks could only be created by administrators. Even on windows 10 you need to enable developer mode first. <a href=\"https://blogs.windows.com/windowsdeveloper/2016/12/02/symlinks-windows-10/\">https://blogs.windows.com/windowsdeveloper/2016/12/02/symlinks-windows-10/</a></p>",
        "id": 252599687,
        "sender_full_name": "bjorn3",
        "timestamp": 1631181406
    },
    {
        "content": "<p>afaik git has workarounds for non-symlink enabled windows. and I assume most developers would have developer mode enabled anyway</p>",
        "id": 252603638,
        "sender_full_name": "The 8472",
        "timestamp": 1631183527
    },
    {
        "content": "<blockquote>\n<blockquote>\n<p>is it ok to duplicate the entire ~1000 line file of <a href=\"http://primitive_docs.rs\">primitive_docs.rs</a> in core?</p>\n</blockquote>\n</blockquote>\n<blockquote>\n<p>every time we've had duplication in the standard library, only one of the copies ended up being maintained.</p>\n</blockquote>\n<p>Yeah the tidy check has already fired like 5 times just for my own changes <span aria-label=\"laughing\" class=\"emoji emoji-1f606\" role=\"img\" title=\"laughing\">:laughing:</span> it was a great call by <span class=\"user-mention\" data-user-id=\"116122\">@simulacrum</span></p>",
        "id": 252613642,
        "sender_full_name": "Joshua Nelson",
        "timestamp": 1631189243
    },
    {
        "content": "<p>Lol well you have a little more time if you want to block this, CI keeps failing</p>",
        "id": 252613986,
        "sender_full_name": "Joshua Nelson",
        "timestamp": 1631189386
    },
    {
        "content": "<p>or maybe a <a href=\"http://build.rs\">build.rs</a> in std that copies it in from core?</p>",
        "id": 252616200,
        "sender_full_name": "The 8472",
        "timestamp": 1631190373
    },
    {
        "content": "<p>not sure if that's more or less hacky <span aria-label=\"laughing\" class=\"emoji emoji-1f606\" role=\"img\" title=\"laughing\">:laughing:</span> but t-libs are the one's who'll have to maintain it so I'll let you decide</p>",
        "id": 252616346,
        "sender_full_name": "Joshua Nelson",
        "timestamp": 1631190456
    },
    {
        "content": "<p>(personally I want to just use CARGO_PKG_NAME but <span class=\"user-mention silent\" data-user-id=\"116122\">simulacrum</span> asked me not to)</p>",
        "id": 252616380,
        "sender_full_name": "Joshua Nelson",
        "timestamp": 1631190475
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"133247\">bjorn3</span> <a href=\"#narrow/stream/219381-t-libs/topic/heads-up.3A.20is.20it.20ok.20to.20duplicate.20.60primitive_docs.2Ers.60.20in.20core.3F/near/252599687\">said</a>:</p>\n<blockquote>\n<p>Before windows 10 symlinks could only be created by administrators. Even on windows 10 you need to enable developer mode first. <a href=\"https://blogs.windows.com/windowsdeveloper/2016/12/02/symlinks-windows-10/\">https://blogs.windows.com/windowsdeveloper/2016/12/02/symlinks-windows-10/</a></p>\n</blockquote>\n<p>I would be fine with symlinks, but I don't have a way to test on windows</p>",
        "id": 252616783,
        "sender_full_name": "Joshua Nelson",
        "timestamp": 1631190645
    },
    {
        "content": "<p>I guess mingw-check should probably test this case</p>",
        "id": 252616807,
        "sender_full_name": "Joshua Nelson",
        "timestamp": 1631190657
    },
    {
        "content": "<p>Anecdotal Evidence: I use my PC for programming all the time, and have never bothered to enable windows development mode. It's mostly just for developing Windows apps based on the Windows developer docs.<br>\nI'd prefer avoiding requiring something like that to make Rust work nicely, Windows already often feels like a second-class environment, and it would be nice if rustc didn't make that worse.</p>",
        "id": 252637232,
        "sender_full_name": "CraftSpider",
        "timestamp": 1631198392
    },
    {
        "content": "<p>Is it not possible to pub use the core version in std?</p>",
        "id": 252661454,
        "sender_full_name": "Josh Triplett",
        "timestamp": 1631207555
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"239881\">@Josh Triplett</span> the reason these are different is so that std can use intra-doc links, which don't break on re-exports. Core can't use intra-doc links because alloc and std use lang_items to define <code>impl</code>s on primitives.</p>",
        "id": 252674125,
        "sender_full_name": "Joshua Nelson",
        "timestamp": 1631212615
    },
    {
        "content": "<p>changing std not to override the docs from core would be a regression and add a bunch more broken links</p>",
        "id": 252674234,
        "sender_full_name": "Joshua Nelson",
        "timestamp": 1631212660
    },
    {
        "content": "<p>(note that <code>pub use</code> isn't really relevant here - <code>doc(primitive)</code> doesn't have anything to do with public items)</p>",
        "id": 252674440,
        "sender_full_name": "Joshua Nelson",
        "timestamp": 1631212718
    }
]