[
    {
        "content": "<p>Is there a way (outside of using RUSTFLAGS) to set custom <code>cfg</code> values when running <code>cargo clippy</code>?</p>",
        "id": 276725023,
        "sender_full_name": "Jake Goulding",
        "timestamp": 1648299712
    },
    {
        "content": "<p>The interface should be the same as <code>cargo check</code>. I though there were cargo command line flags for setting cfgs?</p>",
        "id": 276726385,
        "sender_full_name": "oli",
        "timestamp": 1648301610
    },
    {
        "content": "<p>Yeah, I got excited by <code>cargo check</code>'s </p>\n<div class=\"codehilite\" data-code-language=\"Text only\"><pre><span></span><code>--config &lt;KEY=VALUE&gt;        Override a configuration value (unstable)\n</code></pre></div>\n<p>but that's</p>\n<blockquote>\n<p>to make it easier to use Cargo config settings.</p>\n</blockquote>",
        "id": 276728645,
        "sender_full_name": "Jake Goulding",
        "timestamp": 1648304772
    },
    {
        "content": "<p>I can use <code>cargo rustc</code> to pass in a cfg value, but I don't know how to mash <code>cargo check</code> / <code>cargo clippy</code> with <code>cargo rustc</code>.</p>",
        "id": 276728679,
        "sender_full_name": "Jake Goulding",
        "timestamp": 1648304863
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"116155\">@Jake Goulding</span> does <code>cargo clippy --no-deps</code> do what you want?</p>",
        "id": 276761176,
        "sender_full_name": "Joshua Nelson",
        "timestamp": 1648351390
    },
    {
        "content": "<p><code>cargo clippy --no-deps -v -- --cfg x -vv</code> gives</p>\n<div class=\"codehilite\" data-code-language=\"Rust\"><pre><span></span><code><span class=\"n\">error</span>: <span class=\"nb\">Option</span> <span class=\"o\">'</span><span class=\"na\">verbose</span><span class=\"o\">'</span> <span class=\"nc\">given</span><span class=\"w\"> </span><span class=\"n\">more</span><span class=\"w\"> </span><span class=\"n\">than</span><span class=\"w\"> </span><span class=\"n\">once</span><span class=\"w\"></span>\n</code></pre></div>\n<p>so presumably the options are getting passed somehow. not sure how, they don't show up in the command line <code>-v</code> prints</p>",
        "id": 276761276,
        "sender_full_name": "Joshua Nelson",
        "timestamp": 1648351507
    },
    {
        "content": "<p>clippy-driver does some magic I think</p>",
        "id": 276761465,
        "sender_full_name": "Joshua Nelson",
        "timestamp": 1648351770
    },
    {
        "content": "<p>Odd, yes. <code>cargo clippy -- --cfg 'revision=\"1\"'</code> works, <code>cargo check -- --cfg 'revision=\"1\"'</code> does not.</p>",
        "id": 276789747,
        "sender_full_name": "Jake Goulding",
        "timestamp": 1648389498
    },
    {
        "content": "<p>cool, yeah <code>cargo clippy</code> is not actually a built-in cargo subcommand, clippy installs it when you add the clippy component with rustup</p>",
        "id": 276790653,
        "sender_full_name": "Joshua Nelson",
        "timestamp": 1648390696
    },
    {
        "content": "<p>(if it were a built-in command, the equivalent to <code>cargo rustc</code> would probably be <code>cargo clippy-driver</code>)</p>",
        "id": 276790691,
        "sender_full_name": "Joshua Nelson",
        "timestamp": 1648390771
    },
    {
        "content": "<p>So is this supported or just a hole in the current implementation?</p>",
        "id": 276795827,
        "sender_full_name": "Jake Goulding",
        "timestamp": 1648398180
    },
    {
        "content": "<p>So everything after the <code>--</code> in <code>cargo clippy</code>  gets passed to <code>clippy-driver</code> and everything <code>clippy-driver</code> doesn't know what to do about it gets further passed on to <code>rustc</code>. <code>--cfg</code> is one such flag <code>clippy-driver</code> doesn't know what to do with, so this is passed to <code>rustc</code>. You should see that reappearing when running <code>cargo clippy -v -- --cfg ...</code></p>",
        "id": 276855057,
        "sender_full_name": "flip1995",
        "timestamp": 1648464646
    }
]