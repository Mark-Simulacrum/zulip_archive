[
    {
        "content": "<p>I have a dev container in which i install rust from rustup</p>\n<p>I have the problem that trying to compile a crate with it, e.g., using <code>docker run -v $(pwd):/src -w /src -u $(id -u):$(id -g) $IMAGE bash -c \"cargo build\"</code> errors with: </p>\n<div class=\"codehilite\"><pre><span></span><code>failed to create temporary file &#39;/usr/local/cargo/registry/index/.../.git/objects/pack/...&#39;: Permission denied; class=Os (2)\n</code></pre></div>",
        "id": 251731337,
        "sender_full_name": "hannahE2",
        "timestamp": 1630595519
    },
    {
        "content": "<p>My <code>CARGO_HOME</code> is set in the container to <code>/usr/local/cargo</code></p>",
        "id": 251731460,
        "sender_full_name": "hannahE2",
        "timestamp": 1630595560
    },
    {
        "content": "<p>and I do give it <code>chmod a+rwx $CARGO_HOME</code> during the container build</p>",
        "id": 251731507,
        "sender_full_name": "hannahE2",
        "timestamp": 1630595578
    },
    {
        "content": "<p>Why do you set <code>CARGO_HOME</code> to <code>/usr/local/cargo</code> instead of the default <code>~/.cargo</code>?</p>",
        "id": 251734892,
        "sender_full_name": "bjorn3",
        "timestamp": 1630596933
    },
    {
        "content": "<p>That's what the official rust docker containers do <span aria-label=\"shrug\" class=\"emoji emoji-1f937\" role=\"img\" title=\"shrug\">:shrug:</span></p>",
        "id": 251735076,
        "sender_full_name": "hannahE2",
        "timestamp": 1630596993
    },
    {
        "content": "<p>I guess they assume that they run as root. You are setting a different user. Maybe you could use user namespaces instead?</p>",
        "id": 251735225,
        "sender_full_name": "bjorn3",
        "timestamp": 1630597050
    },
    {
        "content": "<p>Thanks, i'll give that a try!</p>",
        "id": 251735370,
        "sender_full_name": "hannahE2",
        "timestamp": 1630597098
    }
]