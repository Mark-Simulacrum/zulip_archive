[
    {
        "content": "<p>If I have the following setup in my Cargo.toml file:</p>\n<div class=\"codehilite\" data-code-language=\"TOML\"><pre><span></span><code><span class=\"k\">[features]</span>\n<span class=\"n\">feature_a</span> <span class=\"o\">=</span> <span class=\"p\">[]</span>\n<span class=\"n\">feature_b</span> <span class=\"o\">=</span> <span class=\"p\">[]</span>\n\n<span class=\"n\">combined_a</span> <span class=\"o\">=</span> <span class=\"p\">[</span><span class=\"s\">\"feature_a\"</span><span class=\"p\">,</span> <span class=\"s\">\"some_dependency\"</span><span class=\"p\">]</span>\n<span class=\"n\">combined_b</span> <span class=\"o\">=</span> <span class=\"p\">[</span><span class=\"s\">\"feature_b\"</span><span class=\"p\">,</span> <span class=\"s\">\"some_other_dependency\"</span><span class=\"p\">]</span>\n\n<span class=\"k\">[dependencies]</span>\n<span class=\"n\">some_dependency</span> <span class=\"o\">=</span> <span class=\"s\">\"version 1.0\"</span>\n<span class=\"n\">some_other_dependency</span> <span class=\"o\">=</span> <span class=\"s\">\"version 1.0\"</span>\n</code></pre></div>\n<p>and then if I run the application with <code>--features combined_a</code> then <code>#[cfg(feature = \"feature_a\")] </code> does not get picked up in my source code, only <code>#[cfg(feature = \"combined_a\")]</code>.<br>\nIs there some way to let my source code know that it should recognize that when <code>combined_a</code> is used, cfg's for feature_a should be recognized as well?</p>",
        "id": 266477431,
        "sender_full_name": "rodzilla",
        "timestamp": 1640920054
    },
    {
        "content": "<p>A depended-on feature <em>should</em> get enabled like that. Investigating...</p>",
        "id": 266479633,
        "sender_full_name": "Josh Triplett",
        "timestamp": 1640923446
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"463151\">@rodzilla</span> I just wrote a quick test crate and confirmed that <code>cargo run --features combined_a</code> does enable an item with attribute <code>#[cfg(feature = \"feature_a\")]</code>.</p>",
        "id": 266479733,
        "sender_full_name": "Josh Triplett",
        "timestamp": 1640923661
    },
    {
        "content": "<p>Cargo.toml:</p>\n<div class=\"codehilite\" data-code-language=\"TOML\"><pre><span></span><code><span class=\"k\">[package]</span>\n<span class=\"n\">name</span> <span class=\"o\">=</span> <span class=\"s\">\"foo\"</span>\n<span class=\"n\">version</span> <span class=\"o\">=</span> <span class=\"s\">\"0.1.0\"</span>\n<span class=\"n\">edition</span> <span class=\"o\">=</span> <span class=\"s\">\"2021\"</span>\n\n<span class=\"k\">[dependencies]</span>\n<span class=\"n\">some_dependency</span> <span class=\"o\">=</span> <span class=\"p\">{</span> <span class=\"n\">package</span> <span class=\"o\">=</span> <span class=\"s\">\"anyhow\"</span><span class=\"p\">,</span> <span class=\"n\">version</span> <span class=\"o\">=</span> <span class=\"s\">\"*\"</span><span class=\"p\">,</span> <span class=\"n\">optional</span> <span class=\"o\">=</span> <span class=\"n\">true</span> <span class=\"p\">}</span>\n\n<span class=\"k\">[features]</span>\n<span class=\"n\">feature_a</span> <span class=\"o\">=</span> <span class=\"p\">[]</span>\n<span class=\"n\">feature_b</span> <span class=\"o\">=</span> <span class=\"p\">[]</span>\n\n<span class=\"n\">combined_a</span> <span class=\"o\">=</span> <span class=\"p\">[</span><span class=\"s\">\"feature_a\"</span><span class=\"p\">,</span> <span class=\"s\">\"some_dependency\"</span><span class=\"p\">]</span>\n</code></pre></div>\n<p>src/main.rs:</p>\n<div class=\"codehilite\" data-code-language=\"Rust\"><pre><span></span><code><span class=\"cp\">#[cfg(feature = </span><span class=\"s\">\"feature_a\"</span><span class=\"cp\">)]</span><span class=\"w\"></span>\n<span class=\"k\">fn</span> <span class=\"nf\">func</span><span class=\"p\">()</span><span class=\"w\"> </span><span class=\"p\">{</span><span class=\"w\"></span>\n<span class=\"w\">    </span><span class=\"fm\">println!</span><span class=\"p\">(</span><span class=\"s\">\"feature_a is enabled\"</span><span class=\"p\">);</span><span class=\"w\"></span>\n<span class=\"p\">}</span><span class=\"w\"></span>\n\n<span class=\"cp\">#[cfg(not(feature = </span><span class=\"s\">\"feature_a\"</span><span class=\"cp\">))]</span><span class=\"w\"></span>\n<span class=\"k\">fn</span> <span class=\"nf\">func</span><span class=\"p\">()</span><span class=\"w\"> </span><span class=\"p\">{</span><span class=\"w\"></span>\n<span class=\"w\">    </span><span class=\"fm\">println!</span><span class=\"p\">(</span><span class=\"s\">\"feature_a is not enabled\"</span><span class=\"p\">);</span><span class=\"w\"></span>\n<span class=\"p\">}</span><span class=\"w\"></span>\n\n<span class=\"k\">fn</span> <span class=\"nf\">main</span><span class=\"p\">()</span><span class=\"w\"> </span><span class=\"p\">{</span><span class=\"w\"></span>\n<span class=\"w\">    </span><span class=\"n\">func</span><span class=\"p\">();</span><span class=\"w\"></span>\n<span class=\"p\">}</span><span class=\"w\"></span>\n</code></pre></div>",
        "id": 266479787,
        "sender_full_name": "Josh Triplett",
        "timestamp": 1640923707
    },
    {
        "content": "<div class=\"codehilite\"><pre><span></span><code>$ cargo run\n    Updating crates.io index\n   Compiling foo v0.1.0 (/tmp/foo)\n    Finished dev [unoptimized + debuginfo] target(s) in 2.94s\n     Running `target/debug/foo`\nfeature_a is not enabled\n$ cargo run --features combined_a\n  Downloaded anyhow v1.0.52\n  Downloaded 1 crate (44.2 KB) in 0.29s\n   Compiling anyhow v1.0.52\n   Compiling foo v0.1.0 (/tmp/foo)\n    Finished dev [unoptimized + debuginfo] target(s) in 1.03s\n     Running `target/debug/foo`\nfeature_a is enabled\n</code></pre></div>",
        "id": 266479795,
        "sender_full_name": "Josh Triplett",
        "timestamp": 1640923740
    },
    {
        "content": "<p>Well wtf. Clearly I’ve screwed up somewhere. Thanks for confirming that <span class=\"user-mention\" data-user-id=\"239881\">@Josh Triplett</span> <br>\nI’ll go hunt down what I’m doing wrong and report back to the group what silliness ensued on my behalf.  Thanks again!</p>",
        "id": 266481011,
        "sender_full_name": "rodzilla",
        "timestamp": 1640925613
    }
]