[
    {
        "content": "<p>Hello! i wanted to ask about an API design decision.</p>\n<p>I wrote a safe wrapper for the CUDA Driver API as part of a larger project, but i am running into this mild annoyance. CUDA has the concept of contexts, contexts are basically CPU processes. You must make a new context before you can do anything using cuda. However, the contexts are implicitly bound to an OS thread, and you can make multiple contexts and bind each one to a thread, allowing you to write multi-gpu code fairly easily. </p>\n<p>This is great, but it means contexts dont really have many useful methods, so they often go \"unused\". But in reality, they are not unused, they must be held for the duration of the use of CUDA, otherwise cuda yields an error. But rustc complains if you hold this context in a struct, such as </p>\n<div class=\"codehilite\" data-code-language=\"Rust\"><pre><span></span><code><span class=\"k\">struct</span> <span class=\"nc\">CudaRenderer</span><span class=\"w\"> </span><span class=\"p\">{</span><span class=\"w\"></span>\n<span class=\"w\">    </span><span class=\"n\">stream</span>: <span class=\"nc\">Stream</span><span class=\"p\">,</span><span class=\"w\"></span>\n<span class=\"w\">    </span><span class=\"n\">context</span>: <span class=\"nc\">Context</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"c1\">// unused field</span>\n<span class=\"p\">}</span><span class=\"w\"></span>\n</code></pre></div>\n<p>So should i just accept that users will need to suppress the lint? Is there some way of telling rustc that this struct is fine going unused because its basically a \"keep alive\" flag?</p>",
        "id": 258595057,
        "sender_full_name": "Riccardo D'Ambrosio",
        "timestamp": 1634840983
    },
    {
        "content": "<p>I can't implicitly keep it alive because i would like to allow users to retain the control since it is important in \"serious\" applications</p>",
        "id": 258595659,
        "sender_full_name": "Riccardo D'Ambrosio",
        "timestamp": 1634841207
    },
    {
        "content": "<p>because its sometimes useful to drop cuda structs if you are done using it to save cpu/gpu memory</p>",
        "id": 258595814,
        "sender_full_name": "Riccardo D'Ambrosio",
        "timestamp": 1634841257
    },
    {
        "content": "<p>You can use <code>_context</code> instead of <code>context</code> as name.</p>",
        "id": 258602305,
        "sender_full_name": "bjorn3",
        "timestamp": 1634844097
    }
]