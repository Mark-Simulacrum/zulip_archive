[
    {
        "content": "<p>I tried to run a locally build crate on a different machine today and got something fishy:<br>\nIt goes from allocating a Vec with a capacity of 64 elements to allocating a RawVec with 0x400000000000000 bytes.</p>\n<div class=\"codehilite\"><pre><span></span><code>#6  0x0000555556960667 in alloc::alloc::handle_alloc_error () at library/alloc/src/alloc.rs:367\n#7  0x00005555568b3185 in alloc::raw_vec::RawVec&lt;T,A&gt;::allocate_in (capacity=288230376151711744, init=alloc::raw_vec::AllocInit::Uninitialized, alloc=...)\n    at /rustc/59eed8a2aac0230a8b53e89d4e99d55912ba6b35/library/alloc/src/raw_vec.rs:209\n#8  0x00005555568b677d in alloc::raw_vec::RawVec&lt;T,A&gt;::with_capacity_in (capacity=288230376151711744, alloc=...)\n    at /rustc/59eed8a2aac0230a8b53e89d4e99d55912ba6b35/library/alloc/src/raw_vec.rs:143\n#9  0x00005555568af5b1 in alloc::collections::vec_deque::VecDeque&lt;T,A&gt;::with_capacity_in (capacity=64, alloc=...)\n    at /rustc/59eed8a2aac0230a8b53e89d4e99d55912ba6b35/library/alloc/src/collections/vec_deque/mod.rs:529\n#10 0x00005555568aeeb7 in alloc::collections::vec_deque::VecDeque&lt;T&gt;::with_capacity (capacity=64)\n    at /rustc/59eed8a2aac0230a8b53e89d4e99d55912ba6b35/library/alloc/src/collections/vec_deque/mod.rs:494\n#11 0x000055555686f090 in tokio::runtime::basic_scheduler::BasicScheduler&lt;P&gt;::new (park=...)\n    at /home/sebk/.cargo/registry/src/github.com-1ecc6299db9ec823/tokio-0.2.25/src/runtime/basic_scheduler.rs:93\n#12 0x0000555556872424 in tokio::runtime::builder::Builder::build_basic_runtime (self=0x7fffffffd3b8)\n    at /home/sebk/.cargo/registry/src/github.com-1ecc6299db9ec823/tokio-0.2.25/src/runtime/builder.rs:428\n</code></pre></div>",
        "id": 261641977,
        "sender_full_name": "Sebastian Köln",
        "timestamp": 1637070291
    },
    {
        "content": "<p>Build machine is Ubuntu 18 with an i7-4810MQ, target-cpu is ivybridge (sandybridge fails with the same error).<br>\nTarget machine is a xenon E5-2650 v2.</p>",
        "id": 261642304,
        "sender_full_name": "Sebastian Köln",
        "timestamp": 1637070444
    },
    {
        "content": "<p>It runs fine locally.</p>",
        "id": 261642344,
        "sender_full_name": "Sebastian Köln",
        "timestamp": 1637070462
    },
    {
        "content": "<p>Can you share the crate that you are building?</p>",
        "id": 261642872,
        "sender_full_name": "fee1-dead",
        "timestamp": 1637070661
    },
    {
        "content": "<p>I can try to remove the code that isn't public.</p>",
        "id": 261642960,
        "sender_full_name": "Sebastian Köln",
        "timestamp": 1637070695
    },
    {
        "content": "<p>I could reproduce it with a 4 line <a href=\"http://main.rs\">main.rs</a>. I will try to remove more dependencies when I have fiber connection back.</p>",
        "id": 261644557,
        "sender_full_name": "Sebastian Köln",
        "timestamp": 1637071348
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"361356\">@fee1-dead</span> <a href=\"https://github.com/s3bk/bugz\">https://github.com/s3bk/bugz</a></p>",
        "id": 261654495,
        "sender_full_name": "Sebastian Köln",
        "timestamp": 1637075357
    },
    {
        "content": "<p>okay, I may have messed up the rustflags and had target-cpu=native enable (as well)</p>",
        "id": 261658627,
        "sender_full_name": "Sebastian Köln",
        "timestamp": 1637076845
    }
]