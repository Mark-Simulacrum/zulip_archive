[
    {
        "content": "<blockquote>\n<p>Distros are the ones providing the toolchain</p>\n</blockquote>\n<p>I'm confused - where in the build process are you introducing RUSTC_BOOTSTRAP? If the distro has to provide it, that's fine, my objection is to the kernel taking a toolchain the distro <em>thinks</em> is stable and making it unstable.</p>",
        "id": 264689329,
        "sender_full_name": "Joshua Nelson",
        "timestamp": 1639392817
    },
    {
        "content": "<p>It's done in a <code>Makefile</code>, but presumably nothing would prevent adding a <code>CONFIG_THIS_RUST_IS_1_57_PINKY_PROMISE</code> that needs to be set in order to enable the code. But keep in mind that building the kernel with a too-new GCC can fail just as well.</p>",
        "id": 264689882,
        "sender_full_name": "Laurențiu",
        "timestamp": 1639393115
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"125250\">Wesley Wiser</span> <a href=\"#narrow/stream/122651-general/topic/News.3A.20Rust.20as.202nd.20language.20for.20the.20Linux.20kernel/near/264688166\">said</a>:</p>\n<blockquote>\n<p>Nightlies don't get crater runs and they don't get targeted backports.</p>\n</blockquote>\n<p>And a stable version could get a backport that breaks unstable functionality. <span aria-label=\"upside down\" class=\"emoji emoji-1f643\" role=\"img\" title=\"upside down\">:upside_down:</span></p>",
        "id": 264733591,
        "sender_full_name": "Jake Goulding",
        "timestamp": 1639413688
    },
    {
        "content": "<p>We use <code>RUSTC_BOOTSTRAP</code> mainly for a modified version of <code>alloc</code>, plus a custom smart pointer. I think all features we use in rust-for-linux are used in the std. Thus I am not worried about a broken unstable functionality.</p>",
        "id": 264746513,
        "sender_full_name": "Gary Guo",
        "timestamp": 1639418659
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"382653\">ojeda</span> <a href=\"#narrow/stream/122651-general/topic/News.3A.20Rust.20as.202nd.20language.20for.20the.20Linux.20kernel/near/264677908\">said</a>:</p>\n<blockquote>\n<p><span class=\"user-mention silent\" data-user-id=\"138448\">cuviper</span> <a href=\"#narrow/stream/122651-general/topic/News.3A.20Progress.20in.20Rust.20as.202nd.20language.20for.20the.20Linux.20kernel/near/264253840\">said</a>:</p>\n<blockquote>\n<p>That's understandable! However, you're asking that tool to learn new tricks, so <em>someone</em> has to do the work. Until that happens, nightly is the right way to use experimental stuff.</p>\n</blockquote>\n<p>No, it is not \"the right way\", sorry. A stable release is better for our purposes than any given nightly.</p>\n</blockquote>\n<p>I feel like what might be some of the confusion is that stable with bootstrap on shouldn't really be considered \"stable\", it's more like a weird nightly in some ways.</p>",
        "id": 264763450,
        "sender_full_name": "Benjamin Brittain",
        "timestamp": 1639426440
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"273789\">Benjamin Brittain</span> <a href=\"#narrow/stream/122651-general/topic/News.3A.20Rust.20as.202nd.20language.20for.20the.20Linux.20kernel/near/264763450\">said</a>:</p>\n<blockquote>\n<p>I feel like what might be some of the confusion is that stable with bootstrap on shouldn't really be considered \"stable\", it's more like a weird nightly in some ways.</p>\n</blockquote>\n<p>That might be because \"stable\" can mean two things:</p>\n<ul>\n<li>the APIs and interfaces will never change</li>\n<li>it won't eat your cat</li>\n</ul>\n<p>For Rust-in-Linux the former is less important than in most Rust crates.</p>",
        "id": 264764205,
        "sender_full_name": "Laurențiu",
        "timestamp": 1639426770
    },
    {
        "content": "<p>What's to say the unstable features aren't broken in some weird edge case on a stable release?</p>",
        "id": 264764388,
        "sender_full_name": "Connor Horman",
        "timestamp": 1639426832
    },
    {
        "content": "<p>There is no guarantees it won't eat your cat though either. In some ways it could be more likely since it's actually a much less tested configuration</p>",
        "id": 264764419,
        "sender_full_name": "Benjamin Brittain",
        "timestamp": 1639426843
    },
    {
        "content": "<p>It's not much less tested than a nightly</p>",
        "id": 264764458,
        "sender_full_name": "Laurențiu",
        "timestamp": 1639426861
    },
    {
        "content": "<p>add building linux to crater?</p>",
        "id": 264764505,
        "sender_full_name": "Jacob Lifshay",
        "timestamp": 1639426884
    },
    {
        "content": "<p>It's only used by one thing, <code>rustc</code>. So, yeah it is a lot less tested in practice.</p>",
        "id": 264764541,
        "sender_full_name": "Benjamin Brittain",
        "timestamp": 1639426897
    },
    {
        "content": "<p>lemme see if I can find the errors Mozilla ran into when they used to do this too</p>",
        "id": 264764583,
        "sender_full_name": "Benjamin Brittain",
        "timestamp": 1639426918
    },
    {
        "content": "<p><code>RUSTC_BOOTSTRAP</code> is used for the nightly. But the stable compiler itself is very well tested.</p>",
        "id": 264764672,
        "sender_full_name": "Laurențiu",
        "timestamp": 1639426940
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"273789\">Benjamin Brittain</span> <a href=\"#narrow/stream/122651-general/topic/News.3A.20Rust.20as.202nd.20language.20for.20the.20Linux.20kernel/near/264764541\">said</a>:</p>\n<blockquote>\n<p>It's only used by one thing, <code>rustc</code>. So, yeah it is a lot less tested in practice.</p>\n</blockquote>\n<p>Well, it's <em>supposed</em> to be only used by <code>rustc</code>.</p>",
        "id": 264764678,
        "sender_full_name": "Connor Horman",
        "timestamp": 1639426942
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"203546\">Laurențiu</span> <a href=\"#narrow/stream/122651-general/topic/News.3A.20Rust.20as.202nd.20language.20for.20the.20Linux.20kernel/near/264764672\">said</a>:</p>\n<blockquote>\n<p><code>RUSTC_BOOTSTRAP</code> is used for the nightly. But the stable compiler itself is very well tested.</p>\n</blockquote>\n<p>The compile behaving as expected is indeed tested, the features being tested as independent features less so.</p>",
        "id": 264764892,
        "sender_full_name": "Benjamin Brittain",
        "timestamp": 1639427024
    },
    {
        "content": "<p>but as long as this is communicated and understood, yolo I guess</p>",
        "id": 264764984,
        "sender_full_name": "Benjamin Brittain",
        "timestamp": 1639427052
    },
    {
        "content": "<p>It is indeed unlikely to bite Linux, it just seems like an odd choice</p>",
        "id": 264765027,
        "sender_full_name": "Benjamin Brittain",
        "timestamp": 1639427071
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"273789\">Benjamin Brittain</span> <a href=\"#narrow/stream/122651-general/topic/News.3A.20Rust.20as.202nd.20language.20for.20the.20Linux.20kernel/near/264764892\">said</a>:</p>\n<blockquote>\n<p>The compile behaving as expected is indeed tested, the features being tested as independent features less so.</p>\n</blockquote>\n<p>Sure, but overall that's not worse than using a nightly compiler.</p>",
        "id": 264765143,
        "sender_full_name": "Laurențiu",
        "timestamp": 1639427119
    },
    {
        "content": "<p><em>yes it is</em>. nightly is tested with those features enabled, stable is not tested with those features enabled</p>",
        "id": 264765294,
        "sender_full_name": "Benjamin Brittain",
        "timestamp": 1639427180
    },
    {
        "content": "<p>Stable <em>was</em> tested with those features enabled when it was a nightly.</p>",
        "id": 264765503,
        "sender_full_name": "Laurențiu",
        "timestamp": 1639427296
    },
    {
        "content": "<p>Nightlys get considerable use from the community, with and without features being enabled. I'd find it likely that any arbitrary nightly  has a better chance of having issues with features being discovered and fixed, than beta or stable.</p>",
        "id": 264765511,
        "sender_full_name": "Connor Horman",
        "timestamp": 1639427301
    },
    {
        "content": "<p>Nightlies are used, but one specific nightly isn't. If I pick a random one from the last two months, there's almost zero chance it has a significant amount of users</p>",
        "id": 264765639,
        "sender_full_name": "Laurențiu",
        "timestamp": 1639427372
    },
    {
        "content": "<p>And I've used nightly for a long time. Specific versions might be fine, but I wouldn't say \"nightly is well-tested, don't worry, it's fine to use it in the kernel\".</p>",
        "id": 264765947,
        "sender_full_name": "Laurențiu",
        "timestamp": 1639427479
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"203546\">Laurențiu</span> <a href=\"#narrow/stream/122651-general/topic/News.3A.20Rust.20as.202nd.20language.20for.20the.20Linux.20kernel/near/264765503\">said</a>:</p>\n<blockquote>\n<p>Stable <em>was</em> tested with those features enabled when it was a nightly.</p>\n</blockquote>\n<p>There is some distance between a stable and nightly. All the beta-backports.</p>",
        "id": 264766054,
        "sender_full_name": "The 8472",
        "timestamp": 1639427530
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"203546\">Laurențiu</span> <a href=\"#narrow/stream/122651-general/topic/News.3A.20Rust.20as.202nd.20language.20for.20the.20Linux.20kernel/near/264765503\">said</a>:</p>\n<blockquote>\n<p>Stable <em>was</em> tested with those features enabled when it was a nightly.</p>\n</blockquote>\n<p>sorta, but also not because regressions are the most likely thing to be backported during the release train and they are most likely to fix things that interact with features</p>",
        "id": 264766075,
        "sender_full_name": "Benjamin Brittain",
        "timestamp": 1639427550
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"330154\">The 8472</span> <a href=\"#narrow/stream/122651-general/topic/News.3A.20Rust.20as.202nd.20language.20for.20the.20Linux.20kernel/near/264766054\">said</a>:</p>\n<blockquote>\n<p>There is some distance between a stable and nightly. All the beta-backports.</p>\n</blockquote>\n<p>Of course, but a pinned nightly won't get any backports either. Stable should be (ahem) strictly more stable.</p>",
        "id": 264766140,
        "sender_full_name": "Laurențiu",
        "timestamp": 1639427593
    },
    {
        "content": "<p>but stable != stable + <em>unstable features</em></p>",
        "id": 264766174,
        "sender_full_name": "Benjamin Brittain",
        "timestamp": 1639427619
    },
    {
        "content": "<p>It seems unlikely that a nightly-only feature gets broken by a beta-backport. It's more likely to encounter problems in a random nightly. And, as mentioned before, there are other advantages to using stable, like easier packaging.</p>",
        "id": 264766371,
        "sender_full_name": "Laurențiu",
        "timestamp": 1639427730
    },
    {
        "content": "<p>And the packagers will know what they're doing. It's not a random crate off GitHub setting RUSTC_BOOTSTRAP in a build script</p>",
        "id": 264766791,
        "sender_full_name": "Laurențiu",
        "timestamp": 1639427968
    },
    {
        "content": "<p>I doubt that stable would recieve too many backports for regressions of unstable features (unless they were unstable features used by the stdlib and actually affected it).</p>",
        "id": 264766991,
        "sender_full_name": "Connor Horman",
        "timestamp": 1639428069
    },
    {
        "content": "<p>If that happens, the kernel and/or distro maintainers can upgrade to a newer compiler. Same as if it was using nightly.</p>",
        "id": 264767298,
        "sender_full_name": "Laurențiu",
        "timestamp": 1639428230
    },
    {
        "content": "<p>you mean upgrade to a... nightly? or a stable with custom patches? where on the release train are you imagining this being?</p>",
        "id": 264767630,
        "sender_full_name": "Benjamin Brittain",
        "timestamp": 1639428385
    },
    {
        "content": "<p>to clarify, I do think this is <em>very unlikely</em></p>",
        "id": 264767708,
        "sender_full_name": "Benjamin Brittain",
        "timestamp": 1639428433
    },
    {
        "content": "<p>but worth calling out the reasoning clearly somewhere with making it very clear this is an unsupported configuration</p>",
        "id": 264767784,
        "sender_full_name": "Benjamin Brittain",
        "timestamp": 1639428465
    },
    {
        "content": "<p>Upgrade to whichever version works for upstream and/or distros, just as if it was using nightly from the start. And yeah, not only it's unlikely to happen, but:</p>\n<ul>\n<li>this will only matter in a couple of years</li>\n<li>some unstable features will be stabilized by then</li>\n<li>I doubt that the kernel will start  requiring new unstable features on a regular basis</li>\n<li>some of the ones that are currently used can already be removed (if, say, rustc drops them)</li>\n</ul>",
        "id": 264767969,
        "sender_full_name": "Laurențiu",
        "timestamp": 1639428562
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"273789\">Benjamin Brittain</span> <a href=\"#narrow/stream/122651-general/topic/News.3A.20Rust.20as.202nd.20language.20for.20the.20Linux.20kernel/near/264767784\">said</a>:</p>\n<blockquote>\n<p>but worth calling out the reasoning clearly somewhere with making it very clear this is an unsupported configuration</p>\n</blockquote>\n<p>nightlies are unsupported too</p>",
        "id": 264767984,
        "sender_full_name": "Laurențiu",
        "timestamp": 1639428574
    },
    {
        "content": "<p>nightlies get built in the test infrastructure/crater, so they are supported to some degree</p>",
        "id": 264768078,
        "sender_full_name": "Benjamin Brittain",
        "timestamp": 1639428613
    },
    {
        "content": "<p>It seems, based on this thread, like there might be an issue more of terminology than of approach. It's certainly true that stable is not any more likely to have stable nightly features than nightly is, and possibly even <em>less</em>. But we do often suggest to people who are using nightly features that they pin a nightly version. And if you're going to pin a nightly version, \"same as the last stable\" seems like as good an approach as any.</p>\n<p>It seems like the <em>primary</em> point in dispute in this thread is that the Linux kernel may be presenting \"stable using nightly features\" as though it is in any way <em>more</em> stable regarding those features than nightly is. I don't have the impression that there'd be as much of a concern if it were made abundantly clear that this is still no more stable than nightly is.</p>",
        "id": 264779661,
        "sender_full_name": "Josh Triplett",
        "timestamp": 1639434269
    },
    {
        "content": "<p>See also: <a href=\"#narrow/stream/122651-general/topic/versioned.20.2F.20pinned.20nightly/near/264145560\">https://rust-lang.zulipchat.com/#narrow/stream/122651-general/topic/versioned.20.2F.20pinned.20nightly/near/264145560</a></p>\n<p><span class=\"user-mention silent\" data-user-id=\"232018\">Daniel Henry-Mantilla</span> <a href=\"#narrow/stream/122651-general/topic/versioned.20.2F.20pinned.20nightly/near/264145560\">said</a>:</p>\n<blockquote>\n<h3>How to achieve a versioned <code>nightly</code> as of today</h3>\n<p>The only way, AFAIK, is to use a versioned <code>stable</code> approach, and then use <code>RUSTC_BOOTSTRAP=1</code> to imbue it with nightly / experimental capabilities. Again, seeing this as \"stable\" is a misnomer:</p>\n<ul>\n<li><code>rust-toolchain</code></li>\n</ul>\n<div class=\"codehilite\" data-code-language=\"TOML\"><pre><span></span><code><span class=\"mf\">1.57.0</span>\n</code></pre></div>\n<ul>\n<li><code>.cargo/config</code></li>\n</ul>\n<div class=\"codehilite\" data-code-language=\"TOML\"><pre><span></span><code><span class=\"k\">[env]</span>\n<span class=\"n\">RUSTC_BOOTSTRAP</span> <span class=\"o\">=</span> <span class=\"s\">\"1\"</span>\n</code></pre></div>\n<p>so as to achieve the semantics of:</p>\n<div class=\"codehilite\" data-code-language=\"Rust\"><pre><span></span><code><span class=\"p\">[</span><span class=\"n\">rust</span><span class=\"o\">-</span><span class=\"n\">toolchain</span><span class=\"p\">]</span><span class=\"w\"></span>\n<span class=\"n\">channel</span><span class=\"w\"> </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"s\">\"nightly-1.57.0\"</span><span class=\"w\"></span>\n</code></pre></div>\n<p>And now: if <code>RUSTC_BOOTSTRAP</code> is so frowned upon, shouldn't there then be a proper alternative / way to achieve <code>nightly</code> versioning?</p>\n</blockquote>\n<p><span class=\"user-mention silent\" data-user-id=\"232545\">Joshua Nelson</span> <a href=\"#narrow/stream/122651-general/topic/versioned.20.2F.20pinned.20nightly/near/264161767\">said</a>:</p>\n<blockquote>\n<p>This is <span class=\"user-mention silent\" data-user-id=\"119009\">eddyb</span>'s suggestion of having two compilers built from the same commit (one stable and one allowing unstable features) and letting distros choose which they want to package.</p>\n</blockquote>",
        "id": 264885216,
        "sender_full_name": "Daniel Henry-Mantilla",
        "timestamp": 1639499798
    }
]