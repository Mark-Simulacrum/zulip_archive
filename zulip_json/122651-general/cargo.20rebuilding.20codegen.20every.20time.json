[
    {
        "content": "<p>Im having a weird issue that im not sure how to solve, maybe someone who is a build script god could help. My CUDA codegen has a build script for doing build scripty things like building an llvm shim, as well as downloading prebuilt llvm on windows. The issue is for some reason cargo rebuilds the entire codegen and the entire kernel crate on miniscule changes, which is annoying and slow. I tried removing <code>rerun-if</code> commands in both <a href=\"https://github.com/Rust-GPU/Rust-CUDA/tree/master/crates/rustc_codegen_nvvm\">rustc_codegen_nvvm</a> and <a href=\"https://github.com/Rust-GPU/Rust-CUDA/blob/master/crates/cuda_builder/src/lib.rs\">cuda_builder</a> but for some reason that did nothing. Making a change like adding a space to <a href=\"https://github.com/Rust-GPU/Rust-CUDA/tree/master/examples/cuda/gpu/path_tracer_gpu\">path_tracer_gpu</a> then building <a href=\"https://github.com/Rust-GPU/Rust-CUDA/tree/master/examples/cuda/cpu/path_tracer\">path_tracer</a> causes the entire codegen to be rebuilt again. Not just the codegen, but the builder too.</p>",
        "id": 266969512,
        "sender_full_name": "Riccardo D'Ambrosio",
        "timestamp": 1641406177
    },
    {
        "content": "<p>Maybe the problem is that <code>path_tracer </code>relies on <code>path_tracer_gpu</code> as a normal dep (for  cpu rendering), so cargo sees it changed so now it rebuilds path_tracer and therefore its <a href=\"http://build.rs\">build.rs</a>? that would not explain why it is rebuilding the codegen</p>",
        "id": 266969695,
        "sender_full_name": "Riccardo D'Ambrosio",
        "timestamp": 1641406250
    },
    {
        "content": "<p>cc <span class=\"user-mention\" data-user-id=\"330900\">@Ashley Hauck</span> rust-gpu uses something similar (i took inspiration from rust-gpu after all <span aria-label=\"stuck out tongue\" class=\"emoji emoji-1f61b\" role=\"img\" title=\"stuck out tongue\">:stuck_out_tongue:</span>), have you encountered this issue before?</p>",
        "id": 266970488,
        "sender_full_name": "Riccardo D'Ambrosio",
        "timestamp": 1641406665
    },
    {
        "content": "<p><a href=\"#narrow/stream/122651-general/topic/.E2.9C.94.20cargo.20explain.20reason.20for.20running.20build.2Ers.20again.3F\">https://rust-lang.zulipchat.com/#narrow/stream/122651-general/topic/.E2.9C.94.20cargo.20explain.20reason.20for.20running.20build.2Ers.20again.3F</a></p>",
        "id": 266971048,
        "sender_full_name": "Joshua Nelson",
        "timestamp": 1641406941
    },
    {
        "content": "<p>i JUST said in discord \"i wish we had a way for cargo to tell me why its rebuilding\"</p>",
        "id": 266971210,
        "sender_full_name": "Riccardo D'Ambrosio",
        "timestamp": 1641407040
    },
    {
        "content": "<p>thanks <span aria-label=\"heart\" class=\"emoji emoji-2764\" role=\"img\" title=\"heart\">:heart:</span></p>",
        "id": 266971257,
        "sender_full_name": "Riccardo D'Ambrosio",
        "timestamp": 1641407047
    },
    {
        "content": "<p>I wonder if it would be useful to have an command-line option that automatically applies the correct env var</p>",
        "id": 266976387,
        "sender_full_name": "Aaron Hill",
        "timestamp": 1641409428
    },
    {
        "content": "<p>I think its fairly common to want this information</p>",
        "id": 266976549,
        "sender_full_name": "Aaron Hill",
        "timestamp": 1641409505
    },
    {
        "content": "<p>I think just documenting it somewhere would be nice</p>",
        "id": 266992318,
        "sender_full_name": "Joshua Nelson",
        "timestamp": 1641417470
    }
]