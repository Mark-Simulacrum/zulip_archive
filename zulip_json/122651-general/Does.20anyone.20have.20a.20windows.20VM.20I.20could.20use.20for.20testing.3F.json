[
    {
        "content": "<p><a href=\"https://github.com/rust-lang/rust/pull/87073\">https://github.com/rust-lang/rust/pull/87073</a> has been repeatedly failing only on windows, and I don't have a way to test it locally. Does anyone have a VM they don't mind me having access to? It doesn't have to be super fast, it's just that my laptop only has 8 GB RAM which is not nearly enough to build rustc while also running a VM.</p>",
        "id": 252915289,
        "sender_full_name": "Joshua Nelson",
        "timestamp": 1631372870
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"232545\">@Joshua Nelson</span> I don't have a VM for you to use, but I might suggest using <code>// no-prefer-dynamic</code></p>",
        "id": 252916987,
        "sender_full_name": "Eric Huss",
        "timestamp": 1631374530
    },
    {
        "content": "<p>By default, dependencies are built as dylibs</p>",
        "id": 252916993,
        "sender_full_name": "Eric Huss",
        "timestamp": 1631374538
    },
    {
        "content": "<p>And I don't think that works well with <code>#![no_std]</code></p>",
        "id": 252917007,
        "sender_full_name": "Eric Huss",
        "timestamp": 1631374559
    },
    {
        "content": "<p>Right, that was the next thing I was going to try. I wanted a way to test it without having to wait for the bors queue again</p>",
        "id": 252917035,
        "sender_full_name": "Joshua Nelson",
        "timestamp": 1631374563
    },
    {
        "content": "<p>Ah.  I can test it locally if you want, I have a pretty fast machine.</p>",
        "id": 252917071,
        "sender_full_name": "Eric Huss",
        "timestamp": 1631374598
    },
    {
        "content": "<p>modifying the CI script to run the windows tests might work.</p>",
        "id": 252917094,
        "sender_full_name": "The 8472",
        "timestamp": 1631374624
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"120518\">@Eric Huss</span> that would be great, thank you!</p>",
        "id": 252917183,
        "sender_full_name": "Joshua Nelson",
        "timestamp": 1631374691
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"330154\">@The 8472</span> do you happen to know how to do that?src/ci is pretty intimidating <span aria-label=\"sweat smile\" class=\"emoji emoji-1f605\" role=\"img\" title=\"sweat smile\">:sweat_smile:</span></p>",
        "id": 252917206,
        "sender_full_name": "Joshua Nelson",
        "timestamp": 1631374720
    },
    {
        "content": "<p>It's <code>src/ci/github/ci.yml</code> and copy the job from the <code>auto</code> section to the <code>pr</code> section. <a href=\"https://github.com/rust-lang/rust/blob/master/src/ci/github-actions/ci.yml#L279-L299\">https://github.com/rust-lang/rust/blob/master/src/ci/github-actions/ci.yml#L279-L299</a><br>\nAnd then run <code>./x.py run src/tools/expand-yaml-anchors</code> and push the generated <code>.github/workflows/ci.yml</code></p>",
        "id": 252917423,
        "sender_full_name": "The 8472",
        "timestamp": 1631374949
    },
    {
        "content": "<p>I know this works for running other linux CI jobs that don't normally run in PRs. I'm not 100% sure if this works for windows ones.</p>",
        "id": 252917680,
        "sender_full_name": "The 8472",
        "timestamp": 1631375194
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"232545\">@Joshua Nelson</span> Adding this to <code>auxiliary/issue-15318.rs</code> worked for me:</p>\n<div class=\"codehilite\" data-code-language=\"Rust\"><pre><span></span><code><span class=\"c1\">// no-prefer-dynamic</span>\n<span class=\"cp\">#![crate_type = </span><span class=\"s\">\"rlib\"</span><span class=\"cp\">]</span><span class=\"w\"></span>\n</code></pre></div>\n<p>And yea, you can also add windows/macos jobs to the PR section, it doesn't matter there.</p>",
        "id": 252919076,
        "sender_full_name": "Eric Huss",
        "timestamp": 1631376674
    },
    {
        "content": "<p>Thanks for checking! isn't rlib the default?</p>",
        "id": 252919091,
        "sender_full_name": "Joshua Nelson",
        "timestamp": 1631376697
    },
    {
        "content": "<p>No, bin is the default.</p>",
        "id": 252919149,
        "sender_full_name": "Eric Huss",
        "timestamp": 1631376743
    },
    {
        "content": "<p>(with <code>no-prefer-dynamic</code>)</p>",
        "id": 252919157,
        "sender_full_name": "Eric Huss",
        "timestamp": 1631376755
    }
]