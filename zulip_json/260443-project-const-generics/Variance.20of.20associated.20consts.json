[
    {
        "content": "<p>Hi,  I'm Dominik.<br>\nI have been looking into issues with using associated constants as const generics (<a href=\"https://github.com/rust-lang/rust/issues/60551\">#60551</a>). One of those issues is that using a type parameter only for its associated constant will trigger error E0392 <em>\"parameter <code>T</code> is never used\"</em> (<a href=\"https://github.com/rust-lang/rust/issues/80977\">#80977</a>).<br>\nHere is a short example:</p>\n<div class=\"codehilite\" data-code-language=\"Rust\"><pre><span></span><code><span class=\"k\">pub</span><span class=\"w\"> </span><span class=\"k\">trait</span><span class=\"w\"> </span><span class=\"n\">Foo</span><span class=\"w\"> </span><span class=\"p\">{</span><span class=\"w\"></span>\n<span class=\"w\">    </span><span class=\"k\">const</span><span class=\"w\"> </span><span class=\"n\">N</span>: <span class=\"kt\">usize</span><span class=\"p\">;</span><span class=\"w\"></span>\n<span class=\"p\">}</span><span class=\"w\"></span>\n\n<span class=\"k\">struct</span> <span class=\"nc\">Bar</span><span class=\"o\">&lt;</span><span class=\"n\">T</span>: <span class=\"nc\">Foo</span><span class=\"o\">&gt;</span><span class=\"p\">([</span><span class=\"kt\">u8</span><span class=\"p\">;</span><span class=\"w\"> </span><span class=\"n\">T</span>::<span class=\"n\">N</span><span class=\"p\">])</span><span class=\"w\"></span>\n<span class=\"k\">where</span><span class=\"w\"> </span><span class=\"p\">[();</span><span class=\"w\"> </span><span class=\"n\">T</span>::<span class=\"n\">N</span><span class=\"p\">]</span>:<span class=\"p\">;</span><span class=\"w\"></span>\n</code></pre></div>\n<p>(<a href=\"https://play.rust-lang.org/?version=nightly&amp;mode=debug&amp;edition=2015&amp;gist=b51a272853f75925e72efc1597478aa5\">playgound</a>)</p>\n<p>I was able to prevent the error by adding variance constraints for the substs of unevaluated constants (<a href=\"https://github.com/voidc/rust/commit/8b141a24d05c86b4c074715803f0c29783f8f9bc\">commit</a>). However, I'm quite new to rustc and unsure whether this is the right approach. It would be great to hear your opinions on this matter!</p>",
        "id": 256705635,
        "sender_full_name": "Dominik Stolz",
        "timestamp": 1633681722
    },
    {
        "content": "<p>Originally, variance constraints were added for consts (<a href=\"https://github.com/voidc/rust/commit/f7f60eef500cbba168bec1034a087a6feb625982\">commit</a>) but then reverted later (<a href=\"https://github.com/voidc/rust/commit/15033a9ba74fbe585f5571cd82a1241cc2e865c2\">commit</a>) to resolve <a href=\"https://github.com/rust-lang/rust/issues/60047\">#60047</a>. However, in the old implementation constraints were added for const params while the new implementation adds constraints for the substs of unevaluated consts.</p>",
        "id": 256732587,
        "sender_full_name": "Dominik Stolz",
        "timestamp": 1633696482
    },
    {
        "content": "<p>This does not seem like a const generics issue imo</p>",
        "id": 256817699,
        "sender_full_name": "Boxy [she/her]",
        "timestamp": 1633734094
    },
    {
        "content": "<p>you would get the same thing even with an associated type wouldn't you?</p>",
        "id": 256817716,
        "sender_full_name": "Boxy [she/her]",
        "timestamp": 1633734110
    },
    {
        "content": "<p>oh it seems not :O</p>",
        "id": 256817849,
        "sender_full_name": "Boxy [she/her]",
        "timestamp": 1633734187
    },
    {
        "content": "<p>Does anyone have comments on this or would it be better to just open a (draft) PR and get feedback there?</p>",
        "id": 257242205,
        "sender_full_name": "Dominik Stolz",
        "timestamp": 1634060247
    },
    {
        "content": "<p>It'll be better to open a draft PR for feedback. You can use <code>r? @ghost</code> to prevent a reviewer from being assigned while you're still working on it.</p>",
        "id": 257251391,
        "sender_full_name": "Gary Guo",
        "timestamp": 1634063951
    },
    {
        "content": "<p>Okay, I opened <a href=\"https://github.com/rust-lang/rust/pull/89829\">#89829</a>.</p>",
        "id": 257270413,
        "sender_full_name": "Dominik Stolz",
        "timestamp": 1634071946
    }
]