[
    {
        "content": "<p>Been wondering a few things about Rustdoc's static frontend files.</p>\n<ol>\n<li>\n<p>What are the standards around JS features that are allowed? For example, are classes considered ok? Is there a specific set of browser targets that must be supported?</p>\n</li>\n<li>\n<p>What is the reason why Rustdoc doesn't use any modern frontend tooling at build time? For instance, using Sass instead of CSS, or using Typescript instead of Javascript. Is it just because it wasn't initially designed with these in mind, or because y'all want to avoid making the rustdoc build process more complex, or something else? It makes sense that Rustdoc users shouldn't have to install these tools to use Rustdoc. But I do think the Rustdoc codebase quality could be improved by adopting these tools.</p>\n</li>\n</ol>",
        "id": 271770683,
        "sender_full_name": "Will Crichton",
        "timestamp": 1644793435
    },
    {
        "content": "<blockquote>\n<p>What are the standards around JS features that are allowed? For example, are classes considered ok? Is there a specific set of browser targets that must be supported?</p>\n</blockquote>\n<p><a href=\"https://rust-lang.github.io/rfcs/1985-tiered-browser-support.html\">https://rust-lang.github.io/rfcs/1985-tiered-browser-support.html</a></p>\n<blockquote>\n<p>Goal: Ensure functionality of our web content for 80% of users.<br>\nlast 2 Chrome versions<br>\nlast 1 Firefox version<br>\nFirefox ESR<br>\nlast 1 Safari version<br>\nlast 1 iOS version<br>\nlast 1 Edge version<br>\nlast 1 UCAndroid version</p>\n</blockquote>\n<p>ES6 features are okay now, but we haven't updated a lot of our idioms. Classes should be fine. Keep in mind that each feature we use needs to be learned by each of our frontend engineers. :-)</p>\n<p>I'm slightly negative on adding Sass and Typescript mainly for reasons of not wanting to add layers of complexity. (Though I will grant that I haven't learned either of those tools, so naturally they seem like excess complexity to me :-D)</p>",
        "id": 271772578,
        "sender_full_name": "jsha",
        "timestamp": 1644795983
    },
    {
        "content": "<p>FWIW, one of the main reasons I've historically pushed back against tooling like Sass or Typescript is the relatively high cost of ensuring that tooling is installed if you're e.g. hacking away at std docs, or if we pre-compile ensuring that rustdoc developers at least have it. My (albeit historical, 5-6 years ago) experience with these tools is that they're not the most streamlined to obtain, at least if your primary environment is Rust and you're not interfacing with those tools already.</p>",
        "id": 271772745,
        "sender_full_name": "simulacrum",
        "timestamp": 1644796256
    },
    {
        "content": "<blockquote>\n<p>I'm slightly negative on adding Sass and Typescript mainly for reasons of not wanting to add layers of complexity. (Though I will grant that I haven't learned either of those tools, so naturally they seem like excess complexity to me :-D)</p>\n</blockquote>\n<p>That makes sense. Sass I think would be a very high ROI addition. In my experience,  variables and nested rules help reduce a lot of CSS boilerplate. Typescript maybe less so since the codebase isn't that large. IMO React would be a much more valuable investment, since there's a lot of view-model conflation and manual HTML construction in the codebase. But that would be a pretty big rewrite.</p>\n<blockquote>\n<p>My (albeit historical, 5-6 years ago) experience with these tools is that they're not the most streamlined to obtain, at least if your primary environment is Rust and you're not interfacing with those tools already.</p>\n</blockquote>\n<p>I don't think this is as big an issue today. We already require Rustdoc devs to install eslint via npm. Sass, typescript, react, etc. are all easily installable through npm as well.</p>",
        "id": 271773028,
        "sender_full_name": "Will Crichton",
        "timestamp": 1644796692
    },
    {
        "content": "<p>Is eslint required? It was my impression that the rules we enabled there were pretty minimal, largely focused on the compat (tiered browser support)</p>",
        "id": 271773059,
        "sender_full_name": "simulacrum",
        "timestamp": 1644796770
    },
    {
        "content": "<p>eslint is also a little towards the pre-compiled bit I referenced, where if you're not editing rustdoc JS in a significant way, you don't need it. But presumably Sass and Typescript wouldn't necessarily fall under the same boat, since they're effectively compilers, right?</p>",
        "id": 271773166,
        "sender_full_name": "simulacrum",
        "timestamp": 1644796829
    },
    {
        "content": "<p>Eslint is required for testing, since <code>./x.py test tidy</code> runs it. You're right in that it's not in the compilation pipeline like Sass/Typescript would be.</p>",
        "id": 271773308,
        "sender_full_name": "Will Crichton",
        "timestamp": 1644797036
    },
    {
        "content": "<p>it does?</p>",
        "id": 271773465,
        "sender_full_name": "simulacrum",
        "timestamp": 1644797232
    },
    {
        "content": "<p>I don't have it installed and tidy seems to run just fine for me</p>",
        "id": 271773480,
        "sender_full_name": "simulacrum",
        "timestamp": 1644797275
    },
    {
        "content": "<p>AFAICT, x.py never references it -- CI checks it, but that's all</p>",
        "id": 271773530,
        "sender_full_name": "simulacrum",
        "timestamp": 1644797308
    },
    {
        "content": "<p>Oh you're right, for some reason I thought it was part of the toolchain. But I think that's just my local customizations so I don't forget to lint. It would be nice for tidy to run eslint if it exists, certainly!</p>",
        "id": 271774882,
        "sender_full_name": "Will Crichton",
        "timestamp": 1644799160
    },
    {
        "content": "<p>Regardless, eslint is <em>effectively</em> required for rustdoc devs if you want your code to pass CI.</p>",
        "id": 271774953,
        "sender_full_name": "Will Crichton",
        "timestamp": 1644799235
    },
    {
        "content": "<p>Well, or local modifications - and just running past CI. I suspect many simple JS edits wouldn't need to install it, whereas with typescript we'd either need to keep the compiled code checked in or force anyone generating docs locally to have that toolchain.</p>",
        "id": 271775826,
        "sender_full_name": "simulacrum",
        "timestamp": 1644800452
    },
    {
        "content": "<p>It's also why I don't want typescript and sass. Additional tools that could be tricky to install (windows, looking at you). The benefit isn't bigger than the disadvantages imo.</p>",
        "id": 271805635,
        "sender_full_name": "GuillaumeGomez",
        "timestamp": 1644833183
    },
    {
        "content": "<blockquote>\n<p>In my experience, variables and nested rules help reduce a lot of CSS boilerplate.</p>\n</blockquote>\n<p>CSS has variables now though. Together with <code>rem</code>, <code>matches</code> and <code>unset</code> that reduces the need for CSS templating languages compared to the past.</p>",
        "id": 271807121,
        "sender_full_name": "The 8472",
        "timestamp": 1644834059
    },
    {
        "content": "<p>I've been planning to use HTML vars for a while (for the themes for example). It's in my todo list. :)</p>",
        "id": 271820507,
        "sender_full_name": "GuillaumeGomez",
        "timestamp": 1644842575
    }
]