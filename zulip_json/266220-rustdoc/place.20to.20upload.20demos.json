[
    {
        "content": "<p>I've found it very useful to be able to upload demos of PRs I'm working on. Would other rustdoc team members find it useful if I ran a small server with room for y'all to upload similar demos?</p>",
        "id": 258847040,
        "sender_full_name": "jsha",
        "timestamp": 1635029839
    },
    {
        "content": "<p>I don't make PRs often enough for it to be useful to me :( but it seems like a good idea in general</p>",
        "id": 258847102,
        "sender_full_name": "Joshua Nelson",
        "timestamp": 1635029980
    },
    {
        "content": "<p>at least in theory it shouldn't be that hard for us to convert try build artifacts into a browsable doc.rust-lang.org-like website, but it definitely needs some engineering investment.</p>",
        "id": 258847274,
        "sender_full_name": "simulacrum",
        "timestamp": 1635030149
    },
    {
        "content": "<p>I would find it very useful as well!</p>",
        "id": 258849479,
        "sender_full_name": "GuillaumeGomez",
        "timestamp": 1635034076
    },
    {
        "content": "<p>I've tended to stick to the rustdoc \"backend\" (i.e., not the UI), but given that I'm getting a bit more involved with the frontend, having a way to upload demos would be useful. <span class=\"user-mention silent\" data-user-id=\"116122\">simulacrum</span>'s idea sounds useful and would take out the manual labor and local build time involved in setting up and updating the demo yourself. Though if you're iterating on the UI, having to continuously rerun <code>try</code> sounds like it could be frustrating since it takes a while.</p>",
        "id": 258851638,
        "sender_full_name": "Noah Lev",
        "timestamp": 1635037853
    },
    {
        "content": "<p>Yeah, try's not ideal, but it's a start. Once the logic is there making it faster is an orthogonal problem (with potentially easy solutions, like a dedicated docs-try or w/e builder)</p>",
        "id": 258851654,
        "sender_full_name": "simulacrum",
        "timestamp": 1635037918
    },
    {
        "content": "<p>Isn't try just slow because it's building a full stage2 compiler and tools?</p>",
        "id": 258851780,
        "sender_full_name": "Noah Lev",
        "timestamp": 1635038107
    },
    {
        "content": "<p>(I don't know much about the try infra, so correct me if I'm wrong.)</p>",
        "id": 258851791,
        "sender_full_name": "Noah Lev",
        "timestamp": 1635038127
    },
    {
        "content": "<p>yeah, essentially</p>",
        "id": 258851853,
        "sender_full_name": "simulacrum",
        "timestamp": 1635038180
    },
    {
        "content": "<p>these days it's also PGO for rustc + LLVM which is another couple rebuilds that aren't strictly necessary</p>",
        "id": 258851856,
        "sender_full_name": "simulacrum",
        "timestamp": 1635038196
    },
    {
        "content": "<p>for docs-only we could be much faster</p>",
        "id": 258851859,
        "sender_full_name": "simulacrum",
        "timestamp": 1635038201
    },
    {
        "content": "<p>Ah, I see what you mean. I thought you meant extra hardware, not just another container</p>",
        "id": 258851953,
        "sender_full_name": "Noah Lev",
        "timestamp": 1635038362
    },
    {
        "content": "<p>And we could potentially use download-rustc too to make it faster</p>",
        "id": 258851956,
        "sender_full_name": "Noah Lev",
        "timestamp": 1635038372
    },
    {
        "content": "<p>So altogether it could be ~5 or so minutes</p>",
        "id": 258851960,
        "sender_full_name": "Noah Lev",
        "timestamp": 1635038384
    },
    {
        "content": "<p>(We'd use <code>download-rustc = \"if-unchanged\"</code> so it'd still work if you changed rustc)</p>",
        "id": 258851978,
        "sender_full_name": "Noah Lev",
        "timestamp": 1635038402
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"210316\">GuillaumeGomez</span> <a href=\"#narrow/stream/266220-rustdoc/topic/place.20to.20upload.20demos/near/258849479\">said</a>:</p>\n<blockquote>\n<p>I would find it very useful as well!</p>\n</blockquote>\n<p>Alright, I've set up a server at <a href=\"https://rustdoc.crud.net/GuillaumeGomez/\">https://rustdoc.crud.net/GuillaumeGomez/</a>. You should be able to do: <code>rsync -avu build/x86_64-unknown-linux-gnu/doc guillaumegomez@rustdoc.crud.net:/var/www/html/GuillaumeGomez/example-branch/</code>, and it will show up at <a href=\"https://rustdoc.crud.net/GuillaumeGomez/\">https://rustdoc.crud.net/GuillaumeGomez/</a>. I've preloaded .ssh/authorized_keys with your pubkeys from <a href=\"https://github.com/GuillaumeGomez.keys\">https://github.com/GuillaumeGomez.keys</a>; feel free to change that if you want different keys.</p>",
        "id": 258913561,
        "sender_full_name": "jsha",
        "timestamp": 1635132770
    },
    {
        "content": "<p>Here's an adaptation simple script I use to sync the std docs for the current branch to a directory with the same branch name:</p>\n<div class=\"codehilite\"><pre><span></span><code><span class=\"ch\">#!/bin/bash</span>\n<span class=\"nb\">set</span> -feuo pipefail\n\n<span class=\"nv\">BRANCH</span><span class=\"o\">=</span><span class=\"k\">$(</span>git branch --show-current<span class=\"k\">)</span>\n./x.py doc --stage <span class=\"m\">2</span> library/std\nrsync -avuz  --delete build/x86_64-unknown-linux-gnu/doc/ <span class=\"s2\">&quot;rustdoc.crud.net:/var/www/html/GuillaumeGomez/</span><span class=\"si\">${</span><span class=\"nv\">BRANCH</span><span class=\"si\">}</span><span class=\"s2\">/&quot;</span>\n</code></pre></div>\n<p>Note: please use for short-term hosting of demos; I'd like to be able to rebuild or take down the server without worry about long-term hosted content.</p>",
        "id": 258913635,
        "sender_full_name": "jsha",
        "timestamp": 1635132899
    },
    {
        "content": "<p>Nice thanks! I'll put that somewhere to not forget.</p>",
        "id": 258927694,
        "sender_full_name": "GuillaumeGomez",
        "timestamp": 1635149127
    }
]