[
    {
        "content": "<p>Currently, rustdoc doesn't have a lot of test coverage, but it does have a lot of edge cases. It'd be good to have more test coverage so we can improve the code with less fear of introducing bugs.</p>\n<p>What do you think about creating <code>E-easy</code> + <code>E-mentor</code> issues focused on writing more tests? We'd need to give instructions on what kinds of tests to write (e.g., testing doc-comment indentation, or re-exports), and then ask people to come up with wonky code that exercises rustdoc's edge cases.</p>",
        "id": 262189671,
        "sender_full_name": "Noah Lev",
        "timestamp": 1637423041
    },
    {
        "content": "<p>It would be nice to test exactly how inlining works too</p>",
        "id": 262189736,
        "sender_full_name": "Joshua Nelson",
        "timestamp": 1637423122
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"232545\">Joshua Nelson</span> <a href=\"#narrow/stream/266220-rustdoc/topic/more.20test.20coverage/near/262189736\">said</a>:</p>\n<blockquote>\n<p>It would be nice to test exactly how inlining works too</p>\n</blockquote>\n<p>Yep, I agree; that's what I was referring to when I said re-exports.</p>",
        "id": 262189930,
        "sender_full_name": "Noah Lev",
        "timestamp": 1637423410
    },
    {
        "content": "<p>It's definitely a good idea to write down in detail what tests need to get written, ideally in enough detail that it could be considered easy. I think writing tests is often not a good beginner task though, since so much of the process is asking oneself \"is this broken, or do I just misunderstand the code?\"</p>\n<p>Also writing tests and having a good experience requires having a tight loop- like knowing how to run just one test, and not rebuild the compiler all the time, and so on. Before we invite beginners to write tests, we should make sure our first-time setup documentation lays out the tight loop for our tests.</p>",
        "id": 262196771,
        "sender_full_name": "jsha",
        "timestamp": 1637432033
    },
    {
        "content": "<p>We could add specialized docs to the issue to help with the \"tight loop\" part. That way, people don't have to try to apply general docs to the specific scenario.</p>",
        "id": 262198233,
        "sender_full_name": "Noah Lev",
        "timestamp": 1637433757
    },
    {
        "content": "<blockquote>\n<p>I think writing tests is often not a good beginner task though, since so much of the process is asking oneself \"is this broken, or do I just misunderstand the code?\"</p>\n</blockquote>\n<p>I do think that writing tests can be hard for beginners, but we can say that you don't need to make sure the behavior is correct. During review we can check if the behavior makes sense. The hard part is coming up with test cases, so I'm happy to check the behavior myself.</p>",
        "id": 262198257,
        "sender_full_name": "Noah Lev",
        "timestamp": 1637433823
    },
    {
        "content": "<p>Totally agree. Since a year or so, we have been adding/updating tests for new features and bug fixes. Adding even more tests will only improve it overall.</p>",
        "id": 262201951,
        "sender_full_name": "GuillaumeGomez",
        "timestamp": 1637438847
    },
    {
        "content": "<p>Great, I opened an <code>E-easy</code> + <code>E-mentor</code> issue! <a href=\"https://github.com/rust-lang/rust/issues/91113\">#91113</a></p>",
        "id": 262257342,
        "sender_full_name": "Noah Lev",
        "timestamp": 1637524503
    },
    {
        "content": "<p>Please add to the \"What to test\" list if you have ideas :)</p>",
        "id": 262257357,
        "sender_full_name": "Noah Lev",
        "timestamp": 1637524527
    },
    {
        "content": "<p>Hi, I just claimed that issue (although just noticed it's a tracking issue, not sure if it makes sense to claim it). I'm very new to rustdoc but looking to get more involved. Not sure if I'm missing something obvious, but I've tried garbling some <code>@has</code> comments, and running <code>./x.py test src/test/rustdoc</code>, and the tests are still passing (it's also only running 4 tests, ignoring 480). Any idea what I'm doing wrong?</p>",
        "id": 262303311,
        "sender_full_name": "Cameron M",
        "timestamp": 1637578008
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"450601\">@Cameron M</span> it's probably rerunning only the tests you've changed.</p>\n<p>As for why they aren't failing, that probably just means the test never worked in the first place <span aria-label=\"sweat smile\" class=\"emoji emoji-1f605\" role=\"img\" title=\"sweat smile\">:sweat_smile:</span> unless this is a <code>@!has</code> directive in which case it doesn't make sense to modify it randomly</p>",
        "id": 262303748,
        "sender_full_name": "Joshua Nelson",
        "timestamp": 1637578314
    },
    {
        "content": "<p>Unassigned you on the issue with an explanation why</p>",
        "id": 262303915,
        "sender_full_name": "Joshua Nelson",
        "timestamp": 1637578428
    },
    {
        "content": "<p>Ah, the test I was modifying was in <code>src/test/rustdoc-json</code> <span aria-label=\"face palm\" class=\"emoji emoji-1f926\" role=\"img\" title=\"face palm\">:face_palm:</span> . Just checking I've got the right idea with this issue, we're just trying to increase test coverage to pin down the current behaaviour, rather than writing tests to match a spec/RFC?</p>",
        "id": 262306028,
        "sender_full_name": "Cameron M",
        "timestamp": 1637579860
    },
    {
        "content": "<p>Correct, in a lot of cases we're not even sure what rustdoc does <em>currently</em> and knowing that is a prerequisite to changing it</p>",
        "id": 262307047,
        "sender_full_name": "Joshua Nelson",
        "timestamp": 1637580591
    },
    {
        "content": "<p>And I'd suggest not worrying about the JSON output too much for now, it's both unstable and known to be buggy</p>",
        "id": 262307146,
        "sender_full_name": "Joshua Nelson",
        "timestamp": 1637580646
    },
    {
        "content": "<p>src/test/rustdoc is a good place to play around with :)</p>",
        "id": 262307176,
        "sender_full_name": "Joshua Nelson",
        "timestamp": 1637580670
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"232545\">Joshua Nelson</span> <a href=\"#narrow/stream/266220-rustdoc/topic/more.20test.20coverage/near/262307146\">said</a>:</p>\n<blockquote>\n<p>And I'd suggest not worrying about the JSON output too much for now, it's both unstable and known to be buggy</p>\n</blockquote>\n<p>We're back to a few years ago haha</p>",
        "id": 262316004,
        "sender_full_name": "GuillaumeGomez",
        "timestamp": 1637586500
    },
    {
        "content": "<p>We could also consider posting about this in This Week in Rust to get more volunteers? Though that might overwhelm our review capacity...</p>",
        "id": 262639032,
        "sender_full_name": "Noah Lev",
        "timestamp": 1637787138
    },
    {
        "content": "<p>Perhaps it's best to start small</p>",
        "id": 262639049,
        "sender_full_name": "Noah Lev",
        "timestamp": 1637787149
    },
    {
        "content": "<p>Maybe even open a tracking issue where we could list areas needing tests and explaining how to add them.</p>",
        "id": 262643148,
        "sender_full_name": "GuillaumeGomez",
        "timestamp": 1637789914
    },
    {
        "content": "<p>we already have a tracking issue</p>",
        "id": 262643318,
        "sender_full_name": "Joshua Nelson",
        "timestamp": 1637790031
    },
    {
        "content": "<p>we need to fill it out with the places with tests</p>",
        "id": 262643336,
        "sender_full_name": "Joshua Nelson",
        "timestamp": 1637790053
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"210316\">GuillaumeGomez</span> <a href=\"#narrow/stream/266220-rustdoc/topic/more.20test.20coverage/near/262643148\">said</a>:</p>\n<blockquote>\n<p>Maybe even open a tracking issue where we could list areas needing tests and explaining how to add them.</p>\n</blockquote>\n<p>It's this one: <a href=\"https://github.com/rust-lang/rust/issues/91113\">#91113</a></p>",
        "id": 262643509,
        "sender_full_name": "Noah Lev",
        "timestamp": 1637790157
    },
    {
        "content": "<p>And now that I see it I remember it. Grandpa Guillaume will go to bed very soon I guess...</p>",
        "id": 262643947,
        "sender_full_name": "GuillaumeGomez",
        "timestamp": 1637790472
    }
]