[
    {
        "content": "<p>(Migrating discussion from <a href=\"https://github.com/rust-lang/rust/issues/88791\">#88791</a>)</p>\n<p>I'd like to finalize the UI design for the scraped examples feature. Here are a few crates currently using it:</p>\n<ul>\n<li><a href=\"https://docs.rs/save/0.6.0-dev.1/save/cli/fn.init.html\">save</a></li>\n<li><a href=\"https://docs.rs/panda-re/0.26.0/panda/struct.Callback.html#method.new\">panda-re</a></li>\n<li><a href=\"https://docs.rs/with_lock/0.4.2/with_lock/struct.MutexCell.html\">with_lock</a></li>\n</ul>\n<p>Based on the discussion in the thread, we have decided to highlight only function names and not the full call expression. It is unresolved whether to add further visual cues to distinguish the scraped examples block from the user-written documentation above it (cc <span class=\"user-mention\" data-user-id=\"307537\">@Noah Lev</span> and <span class=\"user-mention\" data-user-id=\"315412\">@jsha</span>).</p>",
        "id": 269196385,
        "sender_full_name": "Will Crichton",
        "timestamp": 1643073911
    },
    {
        "content": "<p>Thanks for starting the thread! <span class=\"user-mention\" data-user-id=\"307537\">@Noah Lev</span> what are your thoughts on why the scraped examples block should be visually distinct?</p>",
        "id": 269197513,
        "sender_full_name": "jsha",
        "timestamp": 1643074859
    },
    {
        "content": "<p>also, I notice the scraped examples have line numbers by default, while doccomment examples do not. Was that intentional? I've been assuming it was meant as a contextual hint that there might be more lines not visible, but I figured I should ask rather than assume.</p>",
        "id": 269198654,
        "sender_full_name": "jsha",
        "timestamp": 1643075624
    },
    {
        "content": "<p>I intentionally included line numbers in the scraped examples, since they correspond to real files. If the user opened up the file in a separate viewer, like Github or VSCode, it's helpful so they can quickly find the line range. </p>\n<p>As to why doc-comment examples do not have line numbers, not sure.</p>",
        "id": 269198729,
        "sender_full_name": "Will Crichton",
        "timestamp": 1643075713
    },
    {
        "content": "<p>for the doccomment examples, I suspect it would just be distracting and redundant to see the numbers 1,2,3,4 over and over again. So many doccomments are so short they don't really need the line numbers.</p>",
        "id": 269198925,
        "sender_full_name": "jsha",
        "timestamp": 1643075935
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"315412\">jsha</span> <a href=\"#narrow/stream/266220-rustdoc/topic/UI.20design.20for.20scraped.20examples/near/269197513\">said</a>:</p>\n<blockquote>\n<p>Thanks for starting the thread! <span class=\"user-mention silent\" data-user-id=\"307537\">Noah Lev</span> what are your thoughts on why the scraped examples block should be visually distinct?</p>\n</blockquote>\n<p><span class=\"user-mention\" data-user-id=\"315412\">@jsha</span> see <a href=\"https://github.com/rust-lang/rust/issues/88791#issuecomment-1020723808\">https://github.com/rust-lang/rust/issues/88791#issuecomment-1020723808</a></p>",
        "id": 269199274,
        "sender_full_name": "Noah Lev",
        "timestamp": 1643076113
    },
    {
        "content": "<p>Got it. So, prior to Option 1/2/3, we have at least 2 visual distinguishers on scraped examples:</p>\n<ul>\n<li>Line numbers</li>\n<li>The file name at the top of the example</li>\n</ul>\n<p>And that's in addition to the heading name \"Examples found in the repository.\" Do you think those distinguishers are insufficient?</p>",
        "id": 269199629,
        "sender_full_name": "jsha",
        "timestamp": 1643076287
    },
    {
        "content": "<p>I just think it looks weird to render the heading \"Examples found in the repository\" the exact same way as a user-written heading.</p>",
        "id": 269199750,
        "sender_full_name": "Noah Lev",
        "timestamp": 1643076412
    },
    {
        "content": "<p>I don't have a great rational reason, other than it just looks off to me</p>",
        "id": 269199760,
        "sender_full_name": "Noah Lev",
        "timestamp": 1643076428
    },
    {
        "content": "<p>ah, yeah - I see what you mean. It kind of \"breaks the fourth wall\" by mixing in rustdoc-generated UI with documentation author-generated UI. I feel like there are some other places we've run into that tricky issue.</p>",
        "id": 269200024,
        "sender_full_name": "jsha",
        "timestamp": 1643076714
    },
    {
        "content": "<p>But also, putting the example code in a box doesn't really resolve the fourth wall issue. The heading is still the same; and the contents could all have been written by the doc author.</p>",
        "id": 269200087,
        "sender_full_name": "jsha",
        "timestamp": 1643076744
    },
    {
        "content": "<p>ack, sorry, I have to bounce for dinner for a bit. <span class=\"user-mention\" data-user-id=\"307537\">@Noah Lev</span> would you be willing to try and proceed with the headings looking like they are now?</p>\n<p>(I'll check back in a bit later this evening)</p>",
        "id": 269200199,
        "sender_full_name": "jsha",
        "timestamp": 1643076862
    },
    {
        "content": "<p>Hmm, I'm not sure I'd want to turn the feature on by default with the headings this way. I could be convinced of it, but I would like to improve that aspect of the UI a bit before we stabilize/enable by default.</p>",
        "id": 269200485,
        "sender_full_name": "Noah Lev",
        "timestamp": 1643077146
    },
    {
        "content": "<p>Btw, once we get this question resolved, it would be good to merge <a href=\"https://github.com/rust-lang/rust/pull/93217\">#93217</a>. Guillaume is on holiday so another reviewer would be appreciated.</p>",
        "id": 269201346,
        "sender_full_name": "Will Crichton",
        "timestamp": 1643077878
    },
    {
        "content": "<p>Ah, really? I didn't realize Guillaume was on holiday.</p>",
        "id": 269202742,
        "sender_full_name": "Noah Lev",
        "timestamp": 1643079160
    },
    {
        "content": "<p>I'll see if I can review it a bit, though I'm not sure how much time I'll have. I'll assign myself temporarily to remind myself.</p>",
        "id": 269202848,
        "sender_full_name": "Noah Lev",
        "timestamp": 1643079247
    },
    {
        "content": "<p>I figured out where we ran into this before: <a href=\"https://github.com/rust-lang/rust/pull/90089#issuecomment-949960639\">https://github.com/rust-lang/rust/pull/90089#issuecomment-949960639</a></p>\n<p>For display of variant fields on enums, rustdoc generates a <code>Fields</code> heading. Based on feedback I went back and forth a little putting the <code>Fields</code> heading (and what came below it) either at the bottom of the docblock or the top.</p>\n<p>We wound up deciding on the top, I think, because that made it look a little more like rustdoc-generated text. Alas we don't have that option here; the examples should definitely go at the bottom.</p>",
        "id": 269209080,
        "sender_full_name": "jsha",
        "timestamp": 1643085486
    },
    {
        "content": "<p>a followup question from the issue:</p>\n<blockquote>\n<p>if someone sees an example that shouldn't show up (for whatever) reason, they may go look to edit the source, but get confused by not seeing the example there.</p>\n</blockquote>\n<p>Your concern here is about the documentation author, not the reader, right? My concern is for the reader. Specifically, the more distinguishers we layer on, the more the reader will stop and think \"this example is really different from that other example in some important way. I need to figure out what that difference is.\" But really, from the reader's point of view, an example is an example. They both use the same syntax highlighting; they both use the same grey background; they both indicate how to use a thing. The fact that one example was written in the examples/ directory and one was written in doccomments is mostly immaterial to the reader, and we shouldn't make it one of the highest priority pieces of information we show them.</p>",
        "id": 269209803,
        "sender_full_name": "jsha",
        "timestamp": 1643086602
    },
    {
        "content": "<p>Also, Options 2 and 3 would repeat the problems from <a href=\"https://github.com/rust-lang/rust/issues/90824\">https://github.com/rust-lang/rust/issues/90824</a> that I fixed in <a href=\"https://github.com/rust-lang/rust/issues/90089\">#90089</a>. They might look okay in isolation but in the context of the page they will produce virtual section separations where there aren't meant to be.</p>",
        "id": 269209869,
        "sender_full_name": "jsha",
        "timestamp": 1643086697
    },
    {
        "content": "<p>Yup, I try to keep up with reviews but not as fast as usual. ^^'</p>",
        "id": 269237309,
        "sender_full_name": "GuillaumeGomez",
        "timestamp": 1643106804
    },
    {
        "content": "<blockquote>\n<p>Your concern here is about the documentation author, not the reader, right? My concern is for the reader. </p>\n</blockquote>\n<p>With open source software, users of a library may end up editing the library's docs. For example, if I'm reading the standard library's docs, and I notice a typo, I'll go and open a PR.</p>",
        "id": 269308440,
        "sender_full_name": "Noah Lev",
        "timestamp": 1643138126
    },
    {
        "content": "<p>Proposal: what if we added a question mark box beside each \"found in repository\" header (sketch below). If the user clicks the question mark, it will pop up a tooltip or modal that explains how this feature works, and that this section is automatically generated by Rustdoc.</p>\n<p><a href=\"/user_uploads/4715/CbKGNcYgPQXq9AMPfyxoDRv8/proposal.jpg\">proposal.jpg</a></p>\n<div class=\"message_inline_image\"><a href=\"/user_uploads/4715/CbKGNcYgPQXq9AMPfyxoDRv8/proposal.jpg\" title=\"proposal.jpg\"><img src=\"/user_uploads/4715/CbKGNcYgPQXq9AMPfyxoDRv8/proposal.jpg\"></a></div>",
        "id": 269469003,
        "sender_full_name": "Will Crichton",
        "timestamp": 1643225769
    },
    {
        "content": "<p>I like the idea of an icon or a tooltip a lot better than the borders or horizontal lines. And that would be a reliable way to distinguish from regular Markdown, since the Markdown would never have such an icon (it's technically possible but they'd have to go out of their way)</p>",
        "id": 269469339,
        "sender_full_name": "jsha",
        "timestamp": 1643225914
    },
    {
        "content": "<p>That seems like a good idea, though I think we might want to tweak the icon appearance a little to remove the border.</p>",
        "id": 269483061,
        "sender_full_name": "Noah Lev",
        "timestamp": 1643231571
    },
    {
        "content": "<p>Another UI comment: It's always bothered me that clicking more examples shows the examples with an indent and left border. Can it be changed so the other examples are shown the same as the first?</p>",
        "id": 269483573,
        "sender_full_name": "Noah Lev",
        "timestamp": 1643231802
    },
    {
        "content": "<p>One nice part of the left border is that the entire thing is clickable to hide the expanded section. I can get rid of it if you think that aspect isn't worth it though.</p>",
        "id": 269484465,
        "sender_full_name": "Will Crichton",
        "timestamp": 1643232183
    },
    {
        "content": "<p>I think you could still have the left border without the indent though?</p>",
        "id": 269484692,
        "sender_full_name": "Noah Lev",
        "timestamp": 1643232273
    },
    {
        "content": "<p><a href=\"/user_uploads/4715/IhWuwkMA2tA9S_uB79Y-HJLu/Screen-Shot-2022-01-26-at-2.11.38-PM.png\">Screen-Shot-2022-01-26-at-2.11.38-PM.png</a> </p>\n<div class=\"message_inline_image\"><a href=\"/user_uploads/4715/IhWuwkMA2tA9S_uB79Y-HJLu/Screen-Shot-2022-01-26-at-2.11.38-PM.png\" title=\"Screen-Shot-2022-01-26-at-2.11.38-PM.png\"><img src=\"/user_uploads/4715/IhWuwkMA2tA9S_uB79Y-HJLu/Screen-Shot-2022-01-26-at-2.11.38-PM.png\"></a></div><p>Like this?</p>",
        "id": 269490609,
        "sender_full_name": "Will Crichton",
        "timestamp": 1643235131
    },
    {
        "content": "<p>Yeah, but move it even farther left so the filenames line up perfectly.</p>",
        "id": 269492469,
        "sender_full_name": "Noah Lev",
        "timestamp": 1643236005
    },
    {
        "content": "<p>Like this:</p>\n<p><a href=\"/user_uploads/4715/bcnOh0vG-gI0M4HeAjZqoiij/image.png\">image.png</a></p>\n<div class=\"message_inline_image\"><a href=\"/user_uploads/4715/bcnOh0vG-gI0M4HeAjZqoiij/image.png\" title=\"image.png\"><img src=\"/user_uploads/4715/bcnOh0vG-gI0M4HeAjZqoiij/image.png\"></a></div>",
        "id": 269492679,
        "sender_full_name": "Noah Lev",
        "timestamp": 1643236128
    },
    {
        "content": "<p>(and of course, adjusting the code block width so it matches as well)</p>",
        "id": 269492729,
        "sender_full_name": "Noah Lev",
        "timestamp": 1643236159
    },
    {
        "content": "<p>Is it ok if the [+] and [-] buttons move around like this?</p>\n<p><a href=\"/user_uploads/4715/hR0bPuQWon3LQ8tOjK-4MEGS/moving.mp4\">moving.mp4</a></p>",
        "id": 269500613,
        "sender_full_name": "Will Crichton",
        "timestamp": 1643240901
    },
    {
        "content": "<p>Also, is there a preference for how I should display the help text when users click the question mark button? Options:</p>\n<ul>\n<li>I could bring up a modal like global help button. The disadvantage is that this requires changing a fair amount of code, building the modal, etc.</li>\n<li>I could insert the help text directly beneath the scraped examples section header. The disadvantage is that this is inconsistent with the global help button.</li>\n</ul>",
        "id": 269503371,
        "sender_full_name": "Will Crichton",
        "timestamp": 1643242554
    },
    {
        "content": "<p>I think it should link to a page explaining the feature; not necessarily one inside the generated HTML. For instance it could be on <a href=\"http://doc.rust-lang.org\">doc.rust-lang.org</a></p>\n<p>For the moving buttons - it would be better if they didn't. By the way - what about making \"more examples\" go to a separate page too? I know one of the concerns about the RFC was that it would blow up page sizes, particularly if lots of examples are found. Going to a separate page would limit that. It would also reduce our reliance of <code>[-]</code> / <code>[+]</code> expansions.</p>",
        "id": 269512155,
        "sender_full_name": "jsha",
        "timestamp": 1643245456
    },
    {
        "content": "<p>That's a good idea. I can add a page to the Rustdoc book explaining the feature.</p>\n<p>I don't think we should move the additional examples to a separate page. It's good to keep information in context, and if you're looking at an example of a function, the documentation of the function should be just above, not in another tab.</p>",
        "id": 269607685,
        "sender_full_name": "Will Crichton",
        "timestamp": 1643304674
    },
    {
        "content": "<blockquote>\n<p>That's a good idea. I can add a page to the Rustdoc book explaining the feature.</p>\n</blockquote>\n<p>I thought it was already the case actually. Oh well, please add it in the unstable section for the moment and when we stabilize it, you'll move it to the \"stable\" section (or maybe create a whole chapter for it?).</p>",
        "id": 269625134,
        "sender_full_name": "GuillaumeGomez",
        "timestamp": 1643311892
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"210316\">GuillaumeGomez</span> <a href=\"#narrow/stream/266220-rustdoc/topic/UI.20design.20for.20scraped.20examples/near/269625134\">said</a>:</p>\n<blockquote>\n<p>I thought it was already the case actually. Oh well, please add it in the unstable section for the moment and when we stabilize it, you'll move it to the \"stable\" section (or maybe create a whole chapter for it?).</p>\n</blockquote>\n<p>It is currently in the book: <a href=\"https://doc.rust-lang.org/stable/rustdoc/unstable-features.html#--with-examples-include-examples-of-uses-of-items-as-documentation\">https://doc.rust-lang.org/stable/rustdoc/unstable-features.html#--with-examples-include-examples-of-uses-of-items-as-documentation</a></p>\n<p>But it's written as a technical reference, not as a quick explainer for the uninitiated. This feature probably deserves a standalone page that provides both a high-level explanation and the low-level details.</p>",
        "id": 269631911,
        "sender_full_name": "Will Crichton",
        "timestamp": 1643314785
    },
    {
        "content": "<p>so a new chapter. If you're motivated to write it, please do! :)</p>",
        "id": 269632162,
        "sender_full_name": "GuillaumeGomez",
        "timestamp": 1643314918
    },
    {
        "content": "<blockquote>\n<p>I don't think we should move the additional examples to a separate page. It's good to keep information in context, and if you're looking at an example of a function, the documentation of the function should be just above, not in another tab.</p>\n</blockquote>\n<p>I agree that we should keep the information on the same page.</p>",
        "id": 269637716,
        "sender_full_name": "Noah Lev",
        "timestamp": 1643317490
    },
    {
        "content": "<p>Does this mockup address all concerns about positioning of the \"more examples\" section?</p>\n<p><a href=\"/user_uploads/4715/lS8DSt6kY_HMDhhz7kM_7sT1/closed.jpg\">closed.jpg</a> </p>\n<div class=\"message_inline_image\"><a href=\"/user_uploads/4715/lS8DSt6kY_HMDhhz7kM_7sT1/closed.jpg\" title=\"closed.jpg\"><img src=\"/user_uploads/4715/lS8DSt6kY_HMDhhz7kM_7sT1/closed.jpg\"></a></div><p><a href=\"/user_uploads/4715/FUdlMgvTae2Y_fTxg_UW00Xb/opened.jpg\">opened.jpg</a></p>\n<div class=\"message_inline_image\"><a href=\"/user_uploads/4715/FUdlMgvTae2Y_fTxg_UW00Xb/opened.jpg\" title=\"opened.jpg\"><img src=\"/user_uploads/4715/FUdlMgvTae2Y_fTxg_UW00Xb/opened.jpg\"></a></div>",
        "id": 269637937,
        "sender_full_name": "Will Crichton",
        "timestamp": 1643317571
    },
    {
        "content": "<p>The positioning looks good to me, thanks!</p>",
        "id": 269638268,
        "sender_full_name": "Noah Lev",
        "timestamp": 1643317711
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"315412\">@jsha</span> <span class=\"user-mention\" data-user-id=\"307537\">@Noah Lev</span> I have implemented this mockup and the help link. Live demo: <a href=\"https://willcrichton.net/example-analyzer/warp/trait.Filter.html#method.and\">https://willcrichton.net/example-analyzer/warp/trait.Filter.html#method.and</a></p>\n<p>New commits to the PR here: <a href=\"https://github.com/rust-lang/rust/pull/93217\">https://github.com/rust-lang/rust/pull/93217</a></p>",
        "id": 269666482,
        "sender_full_name": "Will Crichton",
        "timestamp": 1643331659
    },
    {
        "content": "<p>Looks good, except the icon looks a bit too light and square to me. What about this?</p>\n<p><a href=\"/user_uploads/4715/itRK6h8nQ4dF7kyhzqX_pJd_/image.png\">image.png</a> </p>\n<div class=\"message_inline_image\"><a href=\"/user_uploads/4715/itRK6h8nQ4dF7kyhzqX_pJd_/image.png\" title=\"image.png\"><img src=\"/user_uploads/4715/itRK6h8nQ4dF7kyhzqX_pJd_/image.png\"></a></div><div class=\"codehilite\" data-code-language=\"CSS\"><pre><span></span><code><span class=\"p\">{</span><span class=\"w\"></span>\n<span class=\"w\">  </span><span class=\"k\">border-color</span><span class=\"p\">:</span><span class=\"w\"> </span><span class=\"mh\">#555</span><span class=\"p\">;</span><span class=\"w\"></span>\n<span class=\"w\">  </span><span class=\"k\">color</span><span class=\"p\">:</span><span class=\"w\"> </span><span class=\"mh\">#333</span><span class=\"p\">;</span><span class=\"w\"></span>\n<span class=\"w\">  </span><span class=\"k\">border-radius</span><span class=\"p\">:</span><span class=\"w\"> </span><span class=\"mi\">50</span><span class=\"kt\">px</span><span class=\"p\">;</span><span class=\"w\"></span>\n<span class=\"p\">}</span><span class=\"w\"></span>\n</code></pre></div>",
        "id": 269667524,
        "sender_full_name": "Noah Lev",
        "timestamp": 1643332329
    },
    {
        "content": "<p>looks good to me!</p>",
        "id": 269675194,
        "sender_full_name": "jsha",
        "timestamp": 1643335646
    },
    {
        "content": "<p>Ok added the circle.</p>\n<p>Btw is there a convention for <code>target=\"_blank\"</code> on anchors? Right now the help link has <code>_blank</code>, while the source code links do not.</p>",
        "id": 269679706,
        "sender_full_name": "Will Crichton",
        "timestamp": 1643338358
    },
    {
        "content": "<p>Why does the help button brings btw? (except more weight on the page)</p>",
        "id": 269705281,
        "sender_full_name": "GuillaumeGomez",
        "timestamp": 1643360432
    },
    {
        "content": "<p>I'd prefer not to use target=_blank. I think our target audience largely knows how to middle-click / cmd-click to open in a new tab if that's the behavior they want</p>",
        "id": 269720182,
        "sender_full_name": "jsha",
        "timestamp": 1643368612
    },
    {
        "content": "<p>I'd actually prefer <code>target=\"_blank\"</code> I think. If you're reading docs and then you click the source link, it's very possible that you don't intend to go back to the previous page. On the other hand, if you're reading docs and then you click the scrape-examples help button, it's very unlikely that you don't want to keep reading the previous page.</p>",
        "id": 269804555,
        "sender_full_name": "Noah Lev",
        "timestamp": 1643405041
    },
    {
        "content": "<p>^ that was my intuition for doing so. It's a little more consistent with the other help button, which gives you a modal and doesn't change the page. I think it's not obvious that the question mark is an anchor from its appearance.</p>",
        "id": 269830572,
        "sender_full_name": "Will Crichton",
        "timestamp": 1643422626
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"210316\">GuillaumeGomez</span> <a href=\"#narrow/stream/266220-rustdoc/topic/UI.20design.20for.20scraped.20examples/near/269705281\">said</a>:</p>\n<blockquote>\n<p>Why does the help button brings btw? (except more weight on the page)</p>\n</blockquote>\n<p>I'm not sure I understand the phrasing of your question.</p>",
        "id": 269830765,
        "sender_full_name": "Will Crichton",
        "timestamp": 1643422805
    },
    {
        "content": "<p>I was wondering why it was necessary. It's quite obvious what these examples are, no?</p>",
        "id": 269850139,
        "sender_full_name": "GuillaumeGomez",
        "timestamp": 1643446018
    },
    {
        "content": "<p>Not really. It's obvious to us because we've been working on this feature, but I don't think it's obvious to people who haven't encountered it before.</p>",
        "id": 269885882,
        "sender_full_name": "Noah Lev",
        "timestamp": 1643487118
    },
    {
        "content": "<p>It's quite different from rustdoc's existing features.</p>",
        "id": 269885925,
        "sender_full_name": "Noah Lev",
        "timestamp": 1643487125
    },
    {
        "content": "<p>Personally I still feel these are _more_ than distinctive enough. From a reader's perspective all they really care about is:</p>\n<ul>\n<li>this is some code that shows them how to use a thing</li>\n<li>there may be additional lines of context off-screen (this is unique to scraped examples)</li>\n</ul>",
        "id": 269898780,
        "sender_full_name": "jsha",
        "timestamp": 1643503135
    }
]