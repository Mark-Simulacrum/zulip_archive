[
    {
        "content": "<p>I spent more of my afternoon on this than I'd like to admit <span aria-label=\"sweat smile\" class=\"emoji emoji-1f605\" role=\"img\" title=\"sweat smile\">:sweat_smile:</span> I wrote up some ideas on how checking lints for doctests should work and integrate with cargo on <a href=\"https://github.com/rust-lang/cargo/issues/10025#issuecomment-980181784\">https://github.com/rust-lang/cargo/issues/10025#issuecomment-980181784</a> and <a href=\"https://github.com/rust-lang/rust/issues/56232#issuecomment-980419827\">https://github.com/rust-lang/rust/issues/56232#issuecomment-980419827</a>. I also opened <a href=\"https://github.com/rust-lang/rust/pull/91259\">https://github.com/rust-lang/rust/pull/91259</a> removing <code>--display-doctest-warnings</code> which is related (although I didn't start an FCP since it's only an unstable option and the alternatives seem pretty clearly an improvement to me).</p>\n<p>I have two questions:</p>\n<ol>\n<li>Does my writeup in the \"Oh rust doctest lints, where art Ã¾ou?\" issue seem reasonable? If not, do you have suggestions for improving it?</li>\n<li>Do you think this is large enough for an RFC?</li>\n</ol>",
        "id": 262833273,
        "sender_full_name": "Joshua Nelson",
        "timestamp": 1637959019
    },
    {
        "content": "<p>I read it very quickly and didn't see anything crazy. I'll try to take another look in the next days more in depth to try to see how big it'll be.</p>",
        "id": 262833403,
        "sender_full_name": "GuillaumeGomez",
        "timestamp": 1637959148
    },
    {
        "content": "<p>I think the rustdoc side shouldn't be <em>too</em> difficult, we're basically taking the existing code in <code>doctest.rs</code> and running the test-runner directly instead of going through libtest</p>",
        "id": 262833478,
        "sender_full_name": "Joshua Nelson",
        "timestamp": 1637959218
    },
    {
        "content": "<p>I'm mostly worried about getting the user interface right</p>",
        "id": 262833482,
        "sender_full_name": "Joshua Nelson",
        "timestamp": 1637959227
    },
    {
        "content": "<p>Funnily enough, I had the opposite in mind haha</p>",
        "id": 262833628,
        "sender_full_name": "GuillaumeGomez",
        "timestamp": 1637959428
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"232545\">Joshua Nelson</span> <a href=\"#narrow/stream/266220-rustdoc/topic/doctest.20lints/near/262833482\">said</a>:</p>\n<blockquote>\n<p>I'm mostly worried about getting the user interface right</p>\n</blockquote>\n<p>Yeah, my main concern is this all feels really complicated <span aria-label=\"sweat smile\" class=\"emoji emoji-1f605\" role=\"img\" title=\"sweat smile\">:sweat_smile:</span> </p>\n<p>And this is as someone who's knowledgeable about rustdoc's edge cases; I imagine it'd feel even more complicated for users.</p>",
        "id": 262833744,
        "sender_full_name": "Noah Lev",
        "timestamp": 1637959551
    },
    {
        "content": "<p>I wonder if there's a way for us to solve these problems in a more unified way.</p>",
        "id": 262833789,
        "sender_full_name": "Noah Lev",
        "timestamp": 1637959568
    },
    {
        "content": "<p>hmm, so I think the cargo interface is pretty clear, other than whether to call it <code>check --doc</code> or split it into <code>check --doctest</code>. I just don't want to have multiple ways to do the same thing.</p>",
        "id": 262833883,
        "sender_full_name": "Joshua Nelson",
        "timestamp": 1637959690
    },
    {
        "content": "<p>I don't expect people to use rustdoc on its own for this</p>",
        "id": 262833902,
        "sender_full_name": "Joshua Nelson",
        "timestamp": 1637959716
    },
    {
        "content": "<p>what do you mean by more unified?</p>",
        "id": 262833910,
        "sender_full_name": "Joshua Nelson",
        "timestamp": 1637959737
    },
    {
        "content": "<p>Well, AIUI, these are currently being proposed: <code>check --doc</code>, <code>check --doctest</code>, <code>clippy --doc[test]</code>. At least some of these would be included as part of <code>--all-targets</code>. It just feels like a lot of flags to keep track of.</p>",
        "id": 262834052,
        "sender_full_name": "Noah Lev",
        "timestamp": 1637959916
    },
    {
        "content": "<p>I thought I saw other flags being proposed as well, but perhaps I'm just thinking of the implementation flags.</p>",
        "id": 262834122,
        "sender_full_name": "Noah Lev",
        "timestamp": 1637959975
    },
    {
        "content": "<p>There's also the existing <code>test --doc</code> ... which would be inconsistent with <code>check --doctest</code>!</p>",
        "id": 262834153,
        "sender_full_name": "Noah Lev",
        "timestamp": 1637960018
    },
    {
        "content": "<blockquote>\n<p>clippy --doc[test]</p>\n</blockquote>\n<p>I'm only suggesting <code>clippy --doc</code>, which would run on doctests. It doesn't make sense to check documentation itself with clippy.</p>\n<p>Sure, I would be ok with condensing <code>check --doc</code> and <code>check --doctest</code> into a single command if you think it's simpler. We should probably get feedback from T-cargo about this.</p>",
        "id": 262834159,
        "sender_full_name": "Joshua Nelson",
        "timestamp": 1637960023
    },
    {
        "content": "<p>Yeah, I mean, I see the advantages of either approach. It just feels like a lot to keep track of.</p>",
        "id": 262834213,
        "sender_full_name": "Noah Lev",
        "timestamp": 1637960058
    },
    {
        "content": "<blockquote>\n<p>It just feels like a lot of flags to keep track of.</p>\n</blockquote>\n<p>hmm, I don't think this is a big deal though? you the user only have to remember the flags you want to use, and if you're confused you can say <code>--all-targets</code> to mean everything</p>",
        "id": 262834221,
        "sender_full_name": "Joshua Nelson",
        "timestamp": 1637960078
    },
    {
        "content": "<p>cc <span class=\"user-group-mention\" data-user-group-id=\"3139\">@T-cargo</span>, we're trying to imagine what the user interface for doctest lints should look like</p>",
        "id": 262834252,
        "sender_full_name": "Joshua Nelson",
        "timestamp": 1637960127
    },
    {
        "content": "<p>the most important thing I think is to make sure they're consistent with other cargo commands</p>",
        "id": 262834263,
        "sender_full_name": "Joshua Nelson",
        "timestamp": 1637960160
    }
]