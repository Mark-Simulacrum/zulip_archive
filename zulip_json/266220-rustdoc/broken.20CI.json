[
    {
        "content": "<p>FYI, CI was broken by a recently merged PR of mine. It seems to only affect rustdoc PRs AFAICT? Anyhow I have a PR up with a fix: <a href=\"https://github.com/rust-lang/rust/pull/91171\">https://github.com/rust-lang/rust/pull/91171</a></p>",
        "id": 262561959,
        "sender_full_name": "jsha",
        "timestamp": 1637744898
    },
    {
        "content": "<p>This is strange, how could it pass CI before? :-/</p>",
        "id": 262568823,
        "sender_full_name": "GuillaumeGomez",
        "timestamp": 1637748894
    },
    {
        "content": "<p>hmm, I worry that the tools tests are <em>only</em> running in PR CI and not bors</p>",
        "id": 262604506,
        "sender_full_name": "Joshua Nelson",
        "timestamp": 1637768481
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"210316\">@GuillaumeGomez</span> you added those originally, right? the <code>gnu-tools</code> job?</p>",
        "id": 262604550,
        "sender_full_name": "Joshua Nelson",
        "timestamp": 1637768513
    },
    {
        "content": "<p>but that wouldn't make sense why they then failed later ...</p>",
        "id": 262604614,
        "sender_full_name": "Joshua Nelson",
        "timestamp": 1637768529
    },
    {
        "content": "<p>Yes I did, but even the fact that they passed in the CI is concerning</p>",
        "id": 262611448,
        "sender_full_name": "GuillaumeGomez",
        "timestamp": 1637771653
    },
    {
        "content": "<p>I checked and they ran in the CI even before when run with r+</p>",
        "id": 262611495,
        "sender_full_name": "GuillaumeGomez",
        "timestamp": 1637771675
    },
    {
        "content": "<p>oof, that makes me worry that the GOML test runner has a bug somewhere</p>",
        "id": 262612437,
        "sender_full_name": "Joshua Nelson",
        "timestamp": 1637772087
    },
    {
        "content": "<p>Very likely, I'm investigating it</p>",
        "id": 262612513,
        "sender_full_name": "GuillaumeGomez",
        "timestamp": 1637772117
    },
    {
        "content": "<p>I added another check today about text colors to prevent <a href=\"https://github.com/rust-lang/rust/pull/91179#discussion_r756023009\">this</a></p>",
        "id": 262612621,
        "sender_full_name": "GuillaumeGomez",
        "timestamp": 1637772150
    },
    {
        "content": "<p>I'll send a PR to update the browser-ui-test version we use in the CI</p>",
        "id": 262612668,
        "sender_full_name": "GuillaumeGomez",
        "timestamp": 1637772175
    },
    {
        "content": "<p>interestingly enough, I trigger this bug 100% locally</p>",
        "id": 262612850,
        "sender_full_name": "GuillaumeGomez",
        "timestamp": 1637772254
    },
    {
        "content": "<p>Anyway, I opened <a href=\"https://github.com/rust-lang/rust/pull/91181\">https://github.com/rust-lang/rust/pull/91181</a>. It'll already prevent issues we recently encountered.</p>",
        "id": 262615758,
        "sender_full_name": "GuillaumeGomez",
        "timestamp": 1637773499
    },
    {
        "content": "<p>For the rest, I'll continue my investigations.</p>",
        "id": 262615786,
        "sender_full_name": "GuillaumeGomez",
        "timestamp": 1637773512
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"232545\">Joshua Nelson</span> <a href=\"#narrow/stream/266220-rustdoc/topic/broken.20CI/near/262604550\">said</a>:</p>\n<blockquote>\n<p><span class=\"user-mention silent\" data-user-id=\"210316\">GuillaumeGomez</span> you added those originally, right? the <code>gnu-tools</code> job?</p>\n</blockquote>\n<p>gnu-tools only runs tests if subtrees/submodules were changed, e.g. <a href=\"https://github.com/rust-lang/rust/runs/4315888779?check_suite_focus=true\">https://github.com/rust-lang/rust/runs/4315888779?check_suite_focus=true</a></p>",
        "id": 262625387,
        "sender_full_name": "Noah Lev",
        "timestamp": 1637778660
    },
    {
        "content": "<p>So I don't think it'd run on rustdoc PRs.</p>",
        "id": 262625739,
        "sender_full_name": "Noah Lev",
        "timestamp": 1637778852
    },
    {
        "content": "<p>It was updated recently to run on changes to librustdoc too; I don't have a link offhand</p>",
        "id": 262626923,
        "sender_full_name": "Joshua Nelson",
        "timestamp": 1637779570
    },
    {
        "content": "<p>The CI run I linked to is from today, so it doesn't look that way?</p>",
        "id": 262630090,
        "sender_full_name": "Noah Lev",
        "timestamp": 1637781309
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"307537\">@Noah Lev</span> <a href=\"https://github.com/rust-lang/rust/issues/91185\">#91185</a> doesn't appear to touch librustdoc. It seems like it is working as expected?</p>",
        "id": 262631742,
        "sender_full_name": "Eric Huss",
        "timestamp": 1637782418
    },
    {
        "content": "<p>You are correct it doesn't touch rustdoc. The thing that confused me is the CI message doesn't make it sound like it checked rustdoc:</p>\n<div class=\"codehilite\"><pre><span></span><code>Not executing this job since no submodules nor subtrees were updated\n</code></pre></div>\n<p>But looking at the <code>should-skip-this.sh</code> code, it does look correct.</p>",
        "id": 262632470,
        "sender_full_name": "Noah Lev",
        "timestamp": 1637782818
    },
    {
        "content": "<p>I've always wondered why there's gnu-tools and gnu-llvm-12. Why are they separate?</p>",
        "id": 262632507,
        "sender_full_name": "Noah Lev",
        "timestamp": 1637782848
    },
    {
        "content": "<p>I'm not sure I understand the question, those jobs do completely different things.  <code>gnu-tools</code> runs tests for various submodules, rustfmt, and clippy, and publishes the toolstate status.</p>\n<p><code>gnu-llvm-12</code> runs some compiler tests using an older version of LLVM than is normally used.</p>",
        "id": 262632946,
        "sender_full_name": "Eric Huss",
        "timestamp": 1637783137
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"120518\">Eric Huss</span> <a href=\"#narrow/stream/266220-rustdoc/topic/broken.20CI/near/262632946\">said</a>:</p>\n<blockquote>\n<p>I'm not sure I understand the question, those jobs do completely different things.  <code>gnu-tools</code> runs tests for various submodules, rustfmt, and clippy, and publishes the toolstate status.</p>\n<p><code>gnu-llvm-12</code> runs some compiler tests using an older version of LLVM than is normally used.</p>\n</blockquote>\n<p>Then why does gnu-tools run for rustdoc if it only deals with toolstate? And why is an old version of LLVM used for x86_64-gnu, given that the only other job is for MingW?</p>",
        "id": 262633549,
        "sender_full_name": "Noah Lev",
        "timestamp": 1637783526
    },
    {
        "content": "<p>I think rustdoc tests are done in <code>gnu-tools</code> just for convenience (it is already checking for git changes, which requires fetching more history from github, and it doesn't fit very well in the other jobs).</p>\n<p>As for why PRs use an older LLVM like <code>gnu-llvm-12</code>, I can only guess is to keep the build times down by avoiding building llvm, and that image conveniently has llvm available, and is fast.</p>",
        "id": 262649843,
        "sender_full_name": "Eric Huss",
        "timestamp": 1637795190
    },
    {
        "content": "<p>Hmm, I guess I just would assume that rustdoc tests would be run at the same time as rustc tests since rustdoc is pretty much just a layer on top of rustc.</p>",
        "id": 262649959,
        "sender_full_name": "Noah Lev",
        "timestamp": 1637795317
    }
]