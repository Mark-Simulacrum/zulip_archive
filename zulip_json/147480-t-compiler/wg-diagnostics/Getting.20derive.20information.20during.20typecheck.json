[
    {
        "content": "<p>I'm working on improving typecheck diagnostics. I need to check if a type has <code>#[derive(...)]</code> on it. However <code>tcx.get_attrs(def_id)</code>doesn't help since <code>derive</code> attributes are previously removed while macro expansion in <a href=\"https://github.com/rust-lang/rust/blob/08a0307b32ec5af243880056d7cf524f2eff8d69/compiler/rustc_expand/src/expand.rs#L1055\"><code>take_first_attr</code></a> function.</p>\n<p>What would be the right way to preserve this information? Or is there another way to check for <code>derive</code> attributes?</p>\n<p>cc <span class=\"user-mention\" data-user-id=\"119031\">@Esteban Küber</span>, we've discussed this a little yesterday.</p>",
        "id": 255368402,
        "sender_full_name": "Waffle Lapkin",
        "timestamp": 1632907817
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"273349\">@Waffle Lapkin</span> I looked a little bit into this, we are dropping these off after expansion. It'd be nice to change it but it is very low priority. I would ask <span class=\"user-mention\" data-user-id=\"125294\">@Aaron Hill</span> to help, as he's been working a lot on how we handle attributes and might know if there are any drawbacks from including the <code>derive</code> attributes in the hir.</p>",
        "id": 255397478,
        "sender_full_name": "Esteban Küber",
        "timestamp": 1632921771
    },
    {
        "content": "<p>Hey, <span class=\"user-mention\" data-user-id=\"125294\">@Aaron Hill</span> if you have time, can you look into this?</p>",
        "id": 257586728,
        "sender_full_name": "Waffle Lapkin",
        "timestamp": 1634237822
    },
    {
        "content": "<p>There isn't currently a good solution to this - I ran into a similar problem with <code>#[cfg]</code></p>",
        "id": 257846297,
        "sender_full_name": "Aaron Hill",
        "timestamp": 1634404303
    },
    {
        "content": "<p>See <a href=\"https://github.com/rust-lang/rust/pull/84110#issuecomment-820571061\">https://github.com/rust-lang/rust/pull/84110#issuecomment-820571061</a></p>",
        "id": 257846310,
        "sender_full_name": "Aaron Hill",
        "timestamp": 1634404322
    }
]