[
    {
        "content": "<p>Do people think it would be reasonable to stabilize <code>-Z terminal-width</code>? It only a small thing. It's not had any changes in a while, although <a href=\"https://github.com/rust-lang/rust/issues/95432\">#95432</a> was recently filed. I have a <a href=\"https://github.com/davidtwco/rust/tree/terminal-width-stabilization\">branch making the stabilization</a> and can open a PR if we think it's worth doing.</p>",
        "id": 277576963,
        "sender_full_name": "davidtwco",
        "timestamp": 1648963599
    },
    {
        "content": "<p>I can't find any prior discussion on it beyond the impl PRs linked in the tracking issue: <a href=\"https://github.com/rust-lang/rust/issues/84673\">https://github.com/rust-lang/rust/issues/84673</a></p>",
        "id": 277582246,
        "sender_full_name": "oli",
        "timestamp": 1648966724
    },
    {
        "content": "<p>I think we should at least try to figure out whether the information can be deduced from env vars like we do with terminal colors</p>",
        "id": 277582331,
        "sender_full_name": "oli",
        "timestamp": 1648966785
    },
    {
        "content": "<p>We'll still need a flag to explicitly turn it off and on like colors. That flag should be as similar to the color flags as possible I think just to be consistent</p>",
        "id": 277582504,
        "sender_full_name": "oli",
        "timestamp": 1648966881
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"124288\">oli</span> <a href=\"#narrow/stream/147480-t-compiler.2Fwg-diagnostics/topic/terminal.20width.20stabilization/near/277582331\">said</a>:</p>\n<blockquote>\n<p>I think we should at least try to figure out whether the information can be deduced from env vars like we do with terminal colors</p>\n</blockquote>\n<p>There are no environment variables for this, as far as I can gather, some shells will make fake <code>COLUMNS</code>/<code>LINES</code> variables but don't expose them to things that are running (because the shell wouldn't be able to update the environment variables during the process were the terminal to be resized). rustc already does terminal width detection, this flag is primarily for use by users who want to arbitrarily limit the terminal width more, or - more frequently - for build tools which invoke rustc and therefore prevent rustc from detecting the terminal width itself.</p>",
        "id": 277586205,
        "sender_full_name": "davidtwco",
        "timestamp": 1648968974
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"124288\">oli</span> <a href=\"#narrow/stream/147480-t-compiler.2Fwg-diagnostics/topic/terminal.20width.20stabilization/near/277582504\">said</a>:</p>\n<blockquote>\n<p>We'll still need a flag to explicitly turn it off and on like colors. That flag should be as similar to the color flags as possible I think just to be consistent</p>\n</blockquote>\n<p>The flag is off by default, if you don't pass it a value then rustc will attempt to autodetect the terminal width or provide a sane default if it can't. If you provide the flag then you're providing a terminal width for rustc to use.</p>",
        "id": 277586325,
        "sender_full_name": "davidtwco",
        "timestamp": 1648969048
    },
    {
        "content": "<p>OK, makes sense</p>",
        "id": 277589305,
        "sender_full_name": "oli",
        "timestamp": 1648970679
    },
    {
        "content": "<p>In that case, with this info in a stabilization PR, I think nothing speaks against it</p>",
        "id": 277589337,
        "sender_full_name": "oli",
        "timestamp": 1648970697
    },
    {
        "content": "<p>The main reason for it is so that cargo could pass that info through to rustc, because in that case the detection doesn't work</p>",
        "id": 277668755,
        "sender_full_name": "Esteban KÃ¼ber",
        "timestamp": 1649030629
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"124288\">oli</span> <a href=\"#narrow/stream/147480-t-compiler.2Fwg-diagnostics/topic/terminal.20width.20stabilization/near/277589337\">said</a>:</p>\n<blockquote>\n<p>In that case, with this info in a stabilization PR, I think nothing speaks against it</p>\n</blockquote>\n<p>It's been a while since I've stabilized anything, but I think I did it right (?): <a href=\"https://github.com/rust-lang/rust/issues/84673#issuecomment-1087141656\">https://github.com/rust-lang/rust/issues/84673#issuecomment-1087141656</a></p>",
        "id": 277684724,
        "sender_full_name": "davidtwco",
        "timestamp": 1649051353
    }
]