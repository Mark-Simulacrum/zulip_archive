[
    {
        "content": "<p>Can some explain to me what <a href=\"https://github.com/rust-lang/rust/pull/89278\">https://github.com/rust-lang/rust/pull/89278</a> is doing? The PR was closed in favor of two other PRs to control the perf regressions (<a href=\"https://github.com/rust-lang/rust/issues/93301\">#93301</a> and <a href=\"https://github.com/rust-lang/rust/issues/93373\">#93373</a>), and the perf impact was limited in those sub PRs, but I couldn't find an explanation of why the change was necessary in the first place. cc <span class=\"user-mention\" data-user-id=\"116266\">@Santiago Pastorino</span></p>",
        "id": 270382662,
        "sender_full_name": "rylev",
        "timestamp": 1643808394
    },
    {
        "content": "<p>hi <span class=\"user-mention\" data-user-id=\"224872\">@rylev</span></p>",
        "id": 270382734,
        "sender_full_name": "Santiago Pastorino",
        "timestamp": 1643808439
    },
    {
        "content": "<p>we've started taking pieces of that code in new PRs to see how much we could lower the perf regressions</p>",
        "id": 270382853,
        "sender_full_name": "Santiago Pastorino",
        "timestamp": 1643808487
    },
    {
        "content": "<p>the change is needed to be able to make AST -&gt; HIR lowering incremental</p>",
        "id": 270382963,
        "sender_full_name": "Santiago Pastorino",
        "timestamp": 1643808544
    },
    {
        "content": "<p>and it served me to make some refactors on RPITs that are needed to support RPITIT and at the end async fns in traits</p>",
        "id": 270383009,
        "sender_full_name": "Santiago Pastorino",
        "timestamp": 1643808570
    },
    {
        "content": "<p>but the original motivation is to support incremental AST -&gt; HIR lowering</p>",
        "id": 270383036,
        "sender_full_name": "Santiago Pastorino",
        "timestamp": 1643808587
    },
    {
        "content": "<p><a href=\"https://github.com/rust-lang/rust/issues/88186\">#88186</a></p>",
        "id": 270383104,
        "sender_full_name": "Santiago Pastorino",
        "timestamp": 1643808615
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"116266\">Santiago Pastorino</span> <a href=\"#narrow/stream/247081-t-compiler.2Fperformance/topic/Perf.20of.20.2389278/near/270382853\">said</a>:</p>\n<blockquote>\n<p>we've started taking pieces of that code in new PRs to see how much we could lower the perf regressions</p>\n</blockquote>\n<p>Yep totally get that - and I see that the total regression was minimized which is great <span aria-label=\"tada\" class=\"emoji emoji-1f389\" role=\"img\" title=\"tada\">:tada:</span>, but there is still a regression, and I didn't see any written justification for why a regression is still acceptable in this case</p>\n<p>It would be awesome for you to just write this in the PR with the largest regression (<a href=\"https://github.com/rust-lang/rust/pull/93373\">https://github.com/rust-lang/rust/pull/93373</a>) and then add the perf-regression-triaged label.</p>",
        "id": 270383132,
        "sender_full_name": "rylev",
        "timestamp": 1643808631
    },
    {
        "content": "<p>I think <span class=\"user-mention\" data-user-id=\"124288\">@oli</span> did write something somewhere ... <span aria-label=\"thinking\" class=\"emoji emoji-1f914\" role=\"img\" title=\"thinking\">:thinking:</span></p>",
        "id": 270383182,
        "sender_full_name": "Santiago Pastorino",
        "timestamp": 1643808660
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"116266\">Santiago Pastorino</span> <a href=\"#narrow/stream/247081-t-compiler.2Fperformance/topic/Perf.20of.20.2389278/near/270383182\">said</a>:</p>\n<blockquote>\n<p>I think <span class=\"user-mention silent\" data-user-id=\"124288\">oli</span> did write something somewhere ... <span aria-label=\"thinking\" class=\"emoji emoji-1f914\" role=\"img\" title=\"thinking\">:thinking:</span></p>\n</blockquote>\n<p>Ah I didn't see that. If you could point me to it, I'd love that. Then we just need to add the label.</p>",
        "id": 270383236,
        "sender_full_name": "rylev",
        "timestamp": 1643808681
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"124288\">@oli</span>? I remember you writing some stuff about this and adding <code>perf-regression-triaged</code></p>",
        "id": 270383277,
        "sender_full_name": "Santiago Pastorino",
        "timestamp": 1643808705
    },
    {
        "content": "<p>but now I don't see that in the mentioned PR, maybe was in another one? <span aria-label=\"thinking\" class=\"emoji emoji-1f914\" role=\"img\" title=\"thinking\">:thinking:</span></p>",
        "id": 270383303,
        "sender_full_name": "Santiago Pastorino",
        "timestamp": 1643808721
    },
    {
        "content": "<p>We might want to add a @rust-timer justify command that attaches a link to that comment to the PR's comparison pages (easiest is just all of them, or latest, whatever)</p>",
        "id": 270383345,
        "sender_full_name": "simulacrum",
        "timestamp": 1643808726
    },
    {
        "content": "<p>I only wrote a comment in the one PR, but both of them remove a global untracked-by-incremental map that exists in TyCtxt. Such data frequently causes ICEs, and while we have not yet been able to observe any ICEs with these two cases, the very fact that they exist makes splitting up ast-&gt;hir lowering into queries impossible. The hope is that splitting lowering into queries will give us back more than we lost</p>",
        "id": 270384332,
        "sender_full_name": "oli",
        "timestamp": 1643809133
    },
    {
        "content": "<p>OK I made note of this in one of the PRs and added the triage label: <a href=\"https://github.com/rust-lang/rust/pull/93373#issuecomment-1027962065\">https://github.com/rust-lang/rust/pull/93373#issuecomment-1027962065</a></p>",
        "id": 270386395,
        "sender_full_name": "rylev",
        "timestamp": 1643809968
    },
    {
        "content": "<p>Thanks y'all!</p>",
        "id": 270386410,
        "sender_full_name": "rylev",
        "timestamp": 1643809977
    }
]