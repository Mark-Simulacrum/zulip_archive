[
    {
        "content": "<p>How do I compare two rlibs produced by different versions of the compiler? I have a compiler change that causes the binary size to increase and I want to find out where the increase occurs.</p>",
        "id": 259437048,
        "sender_full_name": "Cameron Steffen",
        "timestamp": 1635447926
    },
    {
        "content": "<p>rlibs are regular static archives, so you can use binutils on them</p>",
        "id": 259440704,
        "sender_full_name": "cuviper",
        "timestamp": 1635449754
    },
    {
        "content": "<p>like <code>ar tv foo.rlib</code> to get a verbose list of contents</p>",
        "id": 259440789,
        "sender_full_name": "cuviper",
        "timestamp": 1635449776
    },
    {
        "content": "<p>I discovered <code>objdump -d</code> but it's too verbose to make sense of the diff. Is there a way to get just instruction counts per function?</p>",
        "id": 259441122,
        "sender_full_name": "Cameron Steffen",
        "timestamp": 1635449962
    },
    {
        "content": "<p><code>nm --size-sort -r foo.rlib</code> will give sizes in bytes, although it may only include exported symbols</p>",
        "id": 259463619,
        "sender_full_name": "erikdesjardins",
        "timestamp": 1635462236
    },
    {
        "content": "<p>i don't know of an easy way to get instruction count; you could hack it together with <code>objdump -d | awk 'count lines after each header - left as an exercise for the reader'</code><br>\nbut i don't think instruction count is quite what you want if you're concerned about binary size</p>",
        "id": 259463666,
        "sender_full_name": "erikdesjardins",
        "timestamp": 1635462249
    },
    {
        "content": "<p>see also <a href=\"https://github.com/RazrFalcon/cargo-bloat\">https://github.com/RazrFalcon/cargo-bloat</a>, but</p>\n<blockquote>\n<p>only 'bin', 'dylib' and 'cdylib' crate types are supported.</p>\n</blockquote>",
        "id": 259464021,
        "sender_full_name": "cuviper",
        "timestamp": 1635462507
    },
    {
        "content": "<p>seems like it should be possible to do the same for <code>rlib</code> objects though</p>",
        "id": 259464039,
        "sender_full_name": "cuviper",
        "timestamp": 1635462526
    },
    {
        "content": "<p>Thanks for the tips. Another question - is it possible to get a MIR dump of an entire crate?</p>",
        "id": 259532017,
        "sender_full_name": "Cameron Steffen",
        "timestamp": 1635517617
    },
    {
        "content": "<p>--emit=mir should work</p>",
        "id": 259532984,
        "sender_full_name": "simulacrum",
        "timestamp": 1635518045
    }
]