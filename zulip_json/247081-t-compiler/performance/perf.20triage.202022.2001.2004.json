[
    {
        "content": "<p>starting triage for this week</p>",
        "id": 266848036,
        "sender_full_name": "pnkfelix",
        "timestamp": 1641322293
    },
    {
        "content": "<h2>Regressions</h2>\n<p>Just one flagged this week:</p>\n<p>rustc_metadata: Merge items from <code>extern</code> blocks into their parent modules during metadata encoding rather than during metadata decoding <a href=\"https://github.com/rust-lang/rust/issues/92153\">#92153</a></p>\n<ul>\n<li>Small regression in <a href=\"https://perf.rust-lang.org/compare.html?start=e91ad5fc62bdee4a29c18baa5fad2ca42fc91bf4&amp;end=442248d6bcc00693922941eb5a9f241e0e9da2c0&amp;stat=instructions:u\">instruction counts</a> (up to 1.2% on <code>incr-unchanged</code> builds of <code>deeply-nested-closures</code>)</li>\n</ul>",
        "id": 266850175,
        "sender_full_name": "pnkfelix",
        "timestamp": 1641323446
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"123856\">@Vadim Petrochenkov</span> has already <a href=\"https://github.com/rust-lang/rust/pull/92153#issuecomment-1002421591\">commented</a> saying that the results do not make sense: They are entirely different from the <a href=\"https://github.com/rust-lang/rust/pull/92153#issuecomment-1001997963\">previous rust-timer run</a> (which just noted small improvements in instruction counts on<code>externs</code> and <code>deeply-nested-async</code> variants)</p>",
        "id": 266850386,
        "sender_full_name": "pnkfelix",
        "timestamp": 1641323585
    },
    {
        "content": "<p>I do note that <em>all</em> of the flagged regressions <a href=\"https://perf.rust-lang.org/compare.html?start=e91ad5fc62bdee4a29c18baa5fad2ca42fc91bf4&amp;end=442248d6bcc00693922941eb5a9f241e0e9da2c0\">here</a> have the “?” on their %change column. My understanding is that the “?” still has some meaning, though it is distinct (and perhaps less trustworthy?) than the Significance Factor value...</p>",
        "id": 266850598,
        "sender_full_name": "pnkfelix",
        "timestamp": 1641323711
    },
    {
        "content": "<h2>Improvements</h2>",
        "id": 266852667,
        "sender_full_name": "pnkfelix",
        "timestamp": 1641324883
    },
    {
        "content": "<ol>\n<li>rustdoc: Remove <code>String</code> allocation in iteration in <code>print_generic_bounds</code> <a href=\"https://github.com/rust-lang/rust/issues/92283\">#92283</a></li>\n</ol>\n<ul>\n<li>Moderate improvement in <a href=\"https://perf.rust-lang.org/compare.html?start=7ae550842635dce84811198446fe87e830de500b&amp;end=8e05bb527c5f00549ea6bc21352638200bceb1a5&amp;stat=instructions:u\">instruction counts</a> (up to -1.3% on <code>full</code> builds of <code>futures</code>)</li>\n</ul>",
        "id": 266852678,
        "sender_full_name": "pnkfelix",
        "timestamp": 1641324890
    },
    {
        "content": "<p>Is it just me, or should these summaries include when the improvement is a rustdoc improvement?</p>",
        "id": 266852707,
        "sender_full_name": "pnkfelix",
        "timestamp": 1641324907
    },
    {
        "content": "<p>(maybe it just a matter of including the “profile” for the benchmark?)</p>",
        "id": 266852730,
        "sender_full_name": "pnkfelix",
        "timestamp": 1641324920
    },
    {
        "content": "<ol start=\"2\">\n<li>Reverts <a href=\"https://github.com/rust-lang/rust/issues/92135\">#92135</a> because perf regression <a href=\"https://github.com/rust-lang/rust/issues/92291\">#92291</a></li>\n</ol>\n<ul>\n<li>Large improvement in <a href=\"https://perf.rust-lang.org/compare.html?start=8e05bb527c5f00549ea6bc21352638200bceb1a5&amp;end=b70cc6422c141191aeb33f5ab6faba992118812b&amp;stat=instructions:u\">instruction counts</a> (up to -4.2% on <code>full</code> builds of <code>keccak</code>)</li>\n<li>This did indeed recover the performance lost in the regression.</li>\n</ul>",
        "id": 266852944,
        "sender_full_name": "pnkfelix",
        "timestamp": 1641325049
    },
    {
        "content": "<ol start=\"3\">\n<li>rustc_metadata: Encode list of all crate's traits into metadata <a href=\"https://github.com/rust-lang/rust/issues/92244\">#92244</a></li>\n</ol>\n<ul>\n<li>Very large improvement in <a href=\"https://perf.rust-lang.org/compare.html?start=df96fb166f59431e3de443835e50d5b8a7a4adb0&amp;end=78fd0f633faaa5b6dd254fc1456735f63a1b1238&amp;stat=instructions:u\">instruction counts</a> (up to -17.1% on <code>full</code> builds of <code>webrender</code>)</li>\n</ul>",
        "id": 266853034,
        "sender_full_name": "pnkfelix",
        "timestamp": 1641325090
    },
    {
        "content": "<p>same as in 1. above: This was a rustdoc specific improvement.</p>",
        "id": 266853249,
        "sender_full_name": "pnkfelix",
        "timestamp": 1641325225
    },
    {
        "content": "<ol start=\"4\">\n<li>Import <code>SourceFile</code>s from crate before decoding foreign <code>Span</code> <a href=\"https://github.com/rust-lang/rust/issues/92175\">#92175</a></li>\n</ol>\n<ul>\n<li>Very large improvement in <a href=\"https://perf.rust-lang.org/compare.html?start=8ed935e92dfb09ae388344b12284bf5110cf9265&amp;end=984a6bf9c11b7356f696c685a145d7136fff051c&amp;stat=instructions:u\">instruction counts</a> (up to -14.5% on <code>incr-full</code> builds of <code>webrender-wrench</code>)</li>\n</ul>",
        "id": 266853442,
        "sender_full_name": "pnkfelix",
        "timestamp": 1641325324
    },
    {
        "content": "<p>Reading the dialogue on that PR <a href=\"https://github.com/rust-lang/rust/issues/92175\">#92175</a> makes me happy: The motivation was a bug fix, and the original version would have yielded mixed performance results. This one was just good. (Admittedly, only to a single benchmark, webrender-wrench check, but still…)</p>",
        "id": 266853564,
        "sender_full_name": "pnkfelix",
        "timestamp": 1641325411
    },
    {
        "content": "<h2>Mixed</h2>",
        "id": 266853906,
        "sender_full_name": "pnkfelix",
        "timestamp": 1641325580
    },
    {
        "content": "<p>Just one flagged this week:</p>",
        "id": 266853924,
        "sender_full_name": "pnkfelix",
        "timestamp": 1641325599
    },
    {
        "content": "<p>Mark drop calls in landing pads <code>cold</code> instead of <code>noinline</code> <a href=\"https://github.com/rust-lang/rust/issues/92419\">#92419</a></p>\n<ul>\n<li>Very large improvement in <a href=\"https://perf.rust-lang.org/compare.html?start=028c6f1454787c068ff5117e9000a1de4fd98374&amp;end=4f49627c6fe2a32d1fed6310466bb0e1c535c0c0&amp;stat=instructions:u\">instruction counts</a> (up to -8.2% on <code>full</code> builds of <code>issue-46449</code>)</li>\n<li>Moderate regression in <a href=\"https://perf.rust-lang.org/compare.html?start=028c6f1454787c068ff5117e9000a1de4fd98374&amp;end=4f49627c6fe2a32d1fed6310466bb0e1c535c0c0&amp;stat=instructions:u\">instruction counts</a> (up to 1.5% on <code>incr-full</code> builds of <code>ripgrep</code>)</li>\n</ul>",
        "id": 266853926,
        "sender_full_name": "pnkfelix",
        "timestamp": 1641325599
    },
    {
        "content": "<h2>Probably changed</h2>",
        "id": 266854587,
        "sender_full_name": "pnkfelix",
        "timestamp": 1641325965
    },
    {
        "content": "<ol>\n<li>Rollup of 7 pull requests <a href=\"https://github.com/rust-lang/rust/issues/92352\">#92352</a></li>\n</ol>\n<ul>\n<li>Moderate regression in <a href=\"https://perf.rust-lang.org/compare.html?start=442248d6bcc00693922941eb5a9f241e0e9da2c0&amp;end=83b15bfe1c15f325bc186ebfe3691b729ed59f2b&amp;stat=instructions:u\">instruction counts</a> (up to 1.1% on <code>incr-unchanged</code> builds of <code>deeply-nested-async</code>)</li>\n</ul>",
        "id": 266854608,
        "sender_full_name": "pnkfelix",
        "timestamp": 1641325975
    },
    {
        "content": "<p>This only affected <code>deeply-nested-async</code> {check, debug, opt}, all marked with “?”. I think we can discard it.</p>",
        "id": 266854804,
        "sender_full_name": "pnkfelix",
        "timestamp": 1641326057
    },
    {
        "content": "<ol start=\"2\">\n<li>rustdoc: Remove <code>collect</code> call in <code>clean::Generics::print</code> <a href=\"https://github.com/rust-lang/rust/issues/92269\">#92269</a></li>\n</ol>\n<ul>\n<li>Moderate improvement in <a href=\"https://perf.rust-lang.org/compare.html?start=83b15bfe1c15f325bc186ebfe3691b729ed59f2b&amp;end=7ae550842635dce84811198446fe87e830de500b&amp;stat=instructions:u\">instruction counts</a> (up to -1.1% on <code>incr-unchanged</code> builds of <code>deeply-nested-async</code>)</li>\n</ul>",
        "id": 266854853,
        "sender_full_name": "pnkfelix",
        "timestamp": 1641326083
    },
    {
        "content": "<p>Same: This only affected <code>deeply-nested-async</code> {check, debug, opt}, all marked with “?”. I think we can discard it.</p>",
        "id": 266854934,
        "sender_full_name": "pnkfelix",
        "timestamp": 1641326126
    },
    {
        "content": "<ol start=\"3\">\n<li>Store liveness in interval sets for region inference <a href=\"https://github.com/rust-lang/rust/issues/90637\">#90637</a></li>\n</ol>\n<ul>\n<li>Small improvement in <a href=\"https://perf.rust-lang.org/compare.html?start=984a6bf9c11b7356f696c685a145d7136fff051c&amp;end=cfa3fe5af339e724209b25715282adae0c61628f&amp;stat=instructions:u\">instruction counts</a> (up to -0.6% on <code>full</code> builds of <code>cranelift-codegen</code>)</li>\n<li>Moderate regression in <a href=\"https://perf.rust-lang.org/compare.html?start=984a6bf9c11b7356f696c685a145d7136fff051c&amp;end=cfa3fe5af339e724209b25715282adae0c61628f&amp;stat=instructions:u\">instruction counts</a> (up to 1.1% on <code>full</code> builds of <code>issue-58319</code>)</li>\n</ul>",
        "id": 266855122,
        "sender_full_name": "pnkfelix",
        "timestamp": 1641326201
    },
    {
        "content": "<p>Aside: The motivation in the PR description is reducing memory usage. The report says: <br>\ncranelift-codegen check     full    -6.49%?     1.10x<br>\ndiesel check    incr-full   1.55%?  1.25x</p>",
        "id": 266855222,
        "sender_full_name": "pnkfelix",
        "timestamp": 1641326265
    },
    {
        "content": "<p>And for bootstrap itself: total     A: 736.496  B: 735.001  Total: -1.5<br>\n(-0.203%)</p>",
        "id": 266855290,
        "sender_full_name": "pnkfelix",
        "timestamp": 1641326284
    },
    {
        "content": "<p>Anyway the results are in line with what the PR predicted (which were Mixed at that time) and deemed acceptable.</p>",
        "id": 266855459,
        "sender_full_name": "pnkfelix",
        "timestamp": 1641326397
    },
    {
        "content": "<p>discarding it from the triage report.</p>",
        "id": 266855569,
        "sender_full_name": "pnkfelix",
        "timestamp": 1641326425
    },
    {
        "content": "<ol start=\"4\">\n<li>Add Attribute::meta_kind <a href=\"https://github.com/rust-lang/rust/issues/92294\">#92294</a></li>\n</ol>\n<ul>\n<li>Small improvement in <a href=\"https://perf.rust-lang.org/compare.html?start=4d2e0fd96ccbb9ade41f1a3f07b14b7437f8e4ef&amp;end=c9cf9c65072a35585f9521ab95044f32d5fcb9ec&amp;stat=instructions:u\">instruction counts</a> (up to -0.8% on <code>full</code> builds of <code>helloworld</code>)</li>\n</ul>",
        "id": 266855704,
        "sender_full_name": "pnkfelix",
        "timestamp": 1641326492
    },
    {
        "content": "<p>just very small improvements to rustdoc</p>",
        "id": 266855720,
        "sender_full_name": "pnkfelix",
        "timestamp": 1641326506
    },
    {
        "content": "<p>though I’m not sure why its flagged as “probably changed” and not outright “improvement\"</p>",
        "id": 266855779,
        "sender_full_name": "pnkfelix",
        "timestamp": 1641326528
    },
    {
        "content": "<p>I’ll file an issue for that.</p>",
        "id": 266855782,
        "sender_full_name": "pnkfelix",
        "timestamp": 1641326531
    },
    {
        "content": "<p>Put up PR with triage report for this week: <a href=\"https://github.com/rust-lang/rustc-perf/pull/1136\">https://github.com/rust-lang/rustc-perf/pull/1136</a></p>",
        "id": 266856877,
        "sender_full_name": "pnkfelix",
        "timestamp": 1641327176
    },
    {
        "content": "<p>oh still need to update TWIR</p>",
        "id": 266950921,
        "sender_full_name": "pnkfelix",
        "timestamp": 1641397375
    },
    {
        "content": "<p>TWIR PR: <a href=\"https://github.com/rust-lang/this-week-in-rust/pull/2770\">https://github.com/rust-lang/this-week-in-rust/pull/2770</a></p>",
        "id": 266951234,
        "sender_full_name": "pnkfelix",
        "timestamp": 1641397542
    }
]