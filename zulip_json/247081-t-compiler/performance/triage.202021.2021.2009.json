[
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"116122\">@simulacrum</span> I'm starting triage and it looks like we have some missing commits. The triage report's last commit is from Friday: <a href=\"https://github.com/rust-lang/rust/commit/78a46efff06558674b51c10d8d81758285746ab5\">78a46efff06558674b51c10d8d81758285746ab5</a></p>",
        "id": 254191839,
        "sender_full_name": "rylev",
        "timestamp": 1632223972
    },
    {
        "content": "<p>Gah, haven't checked on that in a bit</p>",
        "id": 254191863,
        "sender_full_name": "simulacrum",
        "timestamp": 1632223991
    },
    {
        "content": "<p>Will do so shortly</p>",
        "id": 254191874,
        "sender_full_name": "simulacrum",
        "timestamp": 1632223997
    },
    {
        "content": "<p>Thanks!</p>",
        "id": 254191882,
        "sender_full_name": "rylev",
        "timestamp": 1632224003
    },
    {
        "content": "<p>looks like just the one, queueing</p>",
        "id": 254192452,
        "sender_full_name": "simulacrum",
        "timestamp": 1632224320
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"224872\">@rylev</span> alright, probably 2.5 hours until that gets benchmarked</p>",
        "id": 254192617,
        "sender_full_name": "simulacrum",
        "timestamp": 1632224415
    },
    {
        "content": "<p>Hi <span class=\"user-mention\" data-user-id=\"224872\">@rylev</span> , I think I have my schedule mixed up; don’t I have triage this week?</p>",
        "id": 254206025,
        "sender_full_name": "pnkfelix",
        "timestamp": 1632230708
    },
    {
        "content": "<p>at the very least, I’ll want to fix my recurrent calendar event</p>",
        "id": 254206058,
        "sender_full_name": "pnkfelix",
        "timestamp": 1632230723
    },
    {
        "content": "<p>Hmm, yes, I did triage back on 2021-09-07. My calendar event must be busted.</p>",
        "id": 254206235,
        "sender_full_name": "pnkfelix",
        "timestamp": 1632230797
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"116083\">@pnkfelix</span> Ah my calendar is also busted? I think there might be some confusion because we switched one week</p>",
        "id": 254206499,
        "sender_full_name": "rylev",
        "timestamp": 1632230904
    },
    {
        "content": "<p>Oh I think I know what happend: Didn’t I have someone cover for me back on 2021-08-31? And thus I swapped with someone so that I did 2021-09-07 instead?</p>",
        "id": 254206504,
        "sender_full_name": "pnkfelix",
        "timestamp": 1632230905
    },
    {
        "content": "<p>So arguably I <em>should</em> do triage today. But If you’ve already started, then I can do it a different week</p>",
        "id": 254206554,
        "sender_full_name": "pnkfelix",
        "timestamp": 1632230925
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"116083\">@pnkfelix</span> I've not started (other than doing some small comparisons between running with calcNewSig on and off. Let's get back to the regular schedule. You do this week, and I'm back next week</p>",
        "id": 254206673,
        "sender_full_name": "rylev",
        "timestamp": 1632230986
    },
    {
        "content": "<p>Great thanks!</p>",
        "id": 254206790,
        "sender_full_name": "pnkfelix",
        "timestamp": 1632231012
    },
    {
        "content": "<p>Interestingly <a href=\"https://perf.rust-lang.org/compare.html?start=e4828d5b7f745a9e867a9b0cc7f080f287bcf55d&amp;end=e36621057d9f497c822eb800934b5933c10510cf&amp;stat=instructions:u&amp;calcNewSig=true\">this</a> comparison shows as a regression with calcNewSig=false and only as a \"probably relevant\" with calcNewSig=true. This looks it's because there are many regressions in noisy test cases, but the one test case that shows large regressions (diesel doc full) is only classified as a medium size change.</p>",
        "id": 254207973,
        "sender_full_name": "rylev",
        "timestamp": 1632231504
    },
    {
        "content": "<p>This seems wrong. a 1.9% change that is 23.1 times bigger than the significance threshold does not strike me as a \"medium sized\" change.</p>",
        "id": 254208096,
        "sender_full_name": "rylev",
        "timestamp": 1632231561
    },
    {
        "content": "<p>The thresholds for magnitude are pretty arbitrary so perhaps they need adjusting...</p>",
        "id": 254208250,
        "sender_full_name": "rylev",
        "timestamp": 1632231616
    },
    {
        "content": "<p>OTOH, the change doesn't show up in cycles at all - <a href=\"https://perf.rust-lang.org/compare.html?calcNewSig=true&amp;start=e4828d5b7f745a9e867a9b0cc7f080f287bcf55d&amp;end=e36621057d9f497c822eb800934b5933c10510cf&amp;stat=cycles:u\">https://perf.rust-lang.org/compare.html?calcNewSig=true&amp;start=e4828d5b7f745a9e867a9b0cc7f080f287bcf55d&amp;end=e36621057d9f497c822eb800934b5933c10510cf&amp;stat=cycles:u</a> -- indeed, diesel-doc <em>improves</em> though not significantly there.</p>",
        "id": 254208324,
        "sender_full_name": "simulacrum",
        "timestamp": 1632231647
    },
    {
        "content": "<p>(this reminds me that we should talk more about cycles once <code>calcNewSig</code> becomes the default. I imagine we might be able to take more advantage of it since we can handle noise better)</p>",
        "id": 254208540,
        "sender_full_name": "rylev",
        "timestamp": 1632231736
    },
    {
        "content": "<p>Yeah, it's possible. :)</p>",
        "id": 254208657,
        "sender_full_name": "simulacrum",
        "timestamp": 1632231788
    },
    {
        "content": "<p>We might want to turn on calcNewSig when we merge <a href=\"https://github.com/rust-lang/rustc-perf/pull/1023\">https://github.com/rust-lang/rustc-perf/pull/1023</a></p>",
        "id": 254208895,
        "sender_full_name": "rylev",
        "timestamp": 1632231874
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"116122\">@simulacrum</span> I'd like to help with going through untriaged perf regressions. Is there some way we can coordinate on who is looking into which one so we don't run into any race conditions <span aria-label=\"blush\" class=\"emoji emoji-1f60a\" role=\"img\" title=\"blush\">:blush:</span></p>",
        "id": 254242855,
        "sender_full_name": "rylev",
        "timestamp": 1632243978
    },
    {
        "content": "<p><a href=\"https://github.com/rust-lang/rust/pulls?q=is%3Apr+is%3Amerged+label%3Aperf-regression+-label%3Aperf-regression-triaged+sort%3Aupdated-asc\">https://github.com/rust-lang/rust/pulls?q=is%3Apr+is%3Amerged+label%3Aperf-regression+-label%3Aperf-regression-triaged+sort%3Aupdated-asc</a> is my list, working from the top</p>",
        "id": 254242897,
        "sender_full_name": "simulacrum",
        "timestamp": 1632243996
    },
    {
        "content": "<p>so you could work from the bottom :)</p>",
        "id": 254242919,
        "sender_full_name": "simulacrum",
        "timestamp": 1632244005
    },
    {
        "content": "<p>Okay I’m finally getting chance to start triage process</p>",
        "id": 254254871,
        "sender_full_name": "pnkfelix",
        "timestamp": 1632248837
    },
    {
        "content": "<p>The good news is that the missing commit has processed by now :)</p>",
        "id": 254255666,
        "sender_full_name": "simulacrum",
        "timestamp": 1632249142
    },
    {
        "content": "<p>I’m very happy to see that the “Probably Changed” section has only two entries. That’s a <em>massive</em> improvement over last time I did triage.</p>",
        "id": 254255736,
        "sender_full_name": "pnkfelix",
        "timestamp": 1632249177
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"116122\">@simulacrum</span> the significance calculation changes, do those also affect the <code>@rust-timer</code> github bot ? I’m trying to understand why <a href=\"https://github.com/rust-lang/rust/issues/88719\">#88719</a> was flagged as a performance regression in the auto-generated triage report, while rust-timer simultaneously posted to that PR saying “did not return any relevant changes.”</p>\n<p>Specifically, the auto-generated triage report says:</p>\n<blockquote>\n<p>Point at argument instead of call for their obligations <a href=\"https://github.com/rust-lang/rust/issues/88719\">#88719</a><br>\n- Large regression in <a href=\"https://perf.rust-lang.org/compare.html?start=e4828d5b7f745a9e867a9b0cc7f080f287bcf55d&amp;end=e36621057d9f497c822eb800934b5933c10510cf&amp;stat=instructions:u\">instruction counts</a> (up to 1.9% on <code>full </code> builds of <code>diesel</code>)</p>\n</blockquote>",
        "id": 254257937,
        "sender_full_name": "pnkfelix",
        "timestamp": 1632250075
    },
    {
        "content": "<p>Yes, I think they do</p>",
        "id": 254258064,
        "sender_full_name": "simulacrum",
        "timestamp": 1632250110
    },
    {
        "content": "<p>this particular one was (briefly) discussed earlier today in this topic <a href=\"#narrow/stream/247081-t-compiler.2Fperformance/topic/triage.202021.2021.2009/near/254207973\">https://rust-lang.zulipchat.com/#narrow/stream/247081-t-compiler.2Fperformance/topic/triage.202021.2021.2009/near/254207973</a></p>",
        "id": 254258126,
        "sender_full_name": "simulacrum",
        "timestamp": 1632250135
    },
    {
        "content": "<p>oh sorry, I should have reviewed that more carefully</p>",
        "id": 254258168,
        "sender_full_name": "pnkfelix",
        "timestamp": 1632250153
    },
    {
        "content": "<p>I'm not actually sure why we posted there were no relevant changes</p>",
        "id": 254258358,
        "sender_full_name": "simulacrum",
        "timestamp": 1632250229
    },
    {
        "content": "<p>So wait, what was the end takeaway?</p>",
        "id": 254258363,
        "sender_full_name": "pnkfelix",
        "timestamp": 1632250231
    },
    {
        "content": "<p>I think that might have been a bug</p>",
        "id": 254258383,
        "sender_full_name": "simulacrum",
        "timestamp": 1632250240
    },
    {
        "content": "<p>It seemed like <span class=\"user-mention\" data-user-id=\"224872\">@rylev</span> was arguing above that this should be treated as significant, even though its only a 1.9% change?</p>",
        "id": 254258435,
        "sender_full_name": "pnkfelix",
        "timestamp": 1632250261
    },
    {
        "content": "<p>1.9% is pretty large</p>",
        "id": 254258461,
        "sender_full_name": "simulacrum",
        "timestamp": 1632250270
    },
    {
        "content": "<p>so your thinking is that rust-timer maybe just messed up its comment?</p>",
        "id": 254258565,
        "sender_full_name": "pnkfelix",
        "timestamp": 1632250319
    },
    {
        "content": "<p>We've not yet enabled the new significance by default though</p>",
        "id": 254258574,
        "sender_full_name": "simulacrum",
        "timestamp": 1632250320
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"116083\">pnkfelix</span> <a href=\"#narrow/stream/247081-t-compiler.2Fperformance/topic/triage.202021.2021.2009/near/254258565\">said</a>:</p>\n<blockquote>\n<p>so your thinking is that rust-timer maybe just messed up its comment?</p>\n</blockquote>\n<p>yes</p>",
        "id": 254258623,
        "sender_full_name": "simulacrum",
        "timestamp": 1632250325
    },
    {
        "content": "<p>hmm</p>",
        "id": 254258625,
        "sender_full_name": "pnkfelix",
        "timestamp": 1632250326
    },
    {
        "content": "<p>but you also pointed out that the cycles:u metric showed no significant change for diesel-doc, right?</p>",
        "id": 254258786,
        "sender_full_name": "pnkfelix",
        "timestamp": 1632250392
    },
    {
        "content": "<p>yeah, it's not clear exactly what's going on here -- it's possible it's not a real regression</p>",
        "id": 254258833,
        "sender_full_name": "simulacrum",
        "timestamp": 1632250418
    },
    {
        "content": "<p>I think the comment was posted before <a href=\"https://github.com/rust-lang/rustc-perf/pull/1011\">https://github.com/rust-lang/rustc-perf/pull/1011</a>, so it didn't consider doc builds</p>\n<p>(yes, this is correct)</p>",
        "id": 254258937,
        "sender_full_name": "simulacrum",
        "timestamp": 1632250450
    },
    {
        "content": "<p>the other ones <em>might</em> be below our significance threshold for comments, I'm not sure</p>",
        "id": 254258978,
        "sender_full_name": "simulacrum",
        "timestamp": 1632250474
    },
    {
        "content": "<p>oh hmm. Okay.</p>",
        "id": 254258981,
        "sender_full_name": "pnkfelix",
        "timestamp": 1632250475
    },
    {
        "content": "<p>should i … file a bug on rust-lang/rustc-perf about this, in terms of the whole oddity that arose?</p>",
        "id": 254259152,
        "sender_full_name": "pnkfelix",
        "timestamp": 1632250558
    },
    {
        "content": "<p>or should we just wait and see if other similar oddities crop up in the future?</p>",
        "id": 254259212,
        "sender_full_name": "pnkfelix",
        "timestamp": 1632250572
    },
    {
        "content": "<p>I think we don't need a bug at this point</p>",
        "id": 254259231,
        "sender_full_name": "simulacrum",
        "timestamp": 1632250585
    },
    {
        "content": "<p>a bug here doesn’t seem terribly actionable to me.</p>",
        "id": 254259232,
        "sender_full_name": "pnkfelix",
        "timestamp": 1632250586
    },
    {
        "content": "<p>more just a way to try to raise awareness. but the only people who probably care are already in this channel, I think.</p>",
        "id": 254259273,
        "sender_full_name": "pnkfelix",
        "timestamp": 1632250608
    },
    {
        "content": "<p>I would like to get us to a point across all Rust infra where these comments are easier to tie to logs on the backend, but for now, doesn't seem worth a file</p>",
        "id": 254259291,
        "sender_full_name": "simulacrum",
        "timestamp": 1632250616
    },
    {
        "content": "<p>PR comments have a lower threshold for what is considered a relevant change than the triage report</p>",
        "id": 254259934,
        "sender_full_name": "rylev",
        "timestamp": 1632250871
    },
    {
        "content": "<p>We post anything that is \"probably relevant\" or above in PRs and only things that \"definitely relevant\" in the triage report.</p>",
        "id": 254259995,
        "sender_full_name": "rylev",
        "timestamp": 1632250899
    },
    {
        "content": "<p>okay. but I’m still confused, I guess, about the mismatch of what is identified</p>",
        "id": 254260459,
        "sender_full_name": "pnkfelix",
        "timestamp": 1632251087
    },
    {
        "content": "<p>consider e.g. </p>\n<blockquote>\n<p>Avoid unnecessary formatting when trace log level is disabled <a href=\"https://github.com/rust-lang/rust/issues/88934\">#88934</a><br>\n- Moderate improvement in <a href=\"https://perf.rust-lang.org/compare.html?start=78a46efff06558674b51c10d8d81758285746ab5&amp;end=38e576423dc56a006ccf0b72e106f09bdea6efc2&amp;stat=instructions:u\">instruction counts</a> (up to -1.0% on <code>incr-full</code> builds of <code>derive</code>)</p>\n</blockquote>",
        "id": 254260515,
        "sender_full_name": "pnkfelix",
        "timestamp": 1632251122
    },
    {
        "content": "<p>while <code>@rust-timer</code> <a href=\"https://github.com/rust-lang/rust/pull/88934#issuecomment-924039469\">here writes</a>: </p>\n<blockquote>\n<p>Finished benchmarking commit (<a href=\"https://github.com/rust-lang/rust/commit/38e576423dc56a006ccf0b72e106f09bdea6efc2\">38e5764</a>): <a href=\"https://perf.rust-lang.org/compare.html?start=78a46efff06558674b51c10d8d81758285746ab5&amp;end=38e576423dc56a006ccf0b72e106f09bdea6efc2\">comparison url</a>.</p>\n<p><strong>Summary</strong>: This change led to very small relevant improvements <span aria-label=\"tada\" class=\"emoji emoji-1f389\" role=\"img\" title=\"tada\">:tada:</span> in compiler performance.</p>\n<p>* Very small improvement in instruction counts (up to -1.1% on <code>incr-patched: println</code> builds of <code>coercions</code>)</p>\n</blockquote>",
        "id": 254260580,
        "sender_full_name": "pnkfelix",
        "timestamp": 1632251157
    },
    {
        "content": "<p>both the links go to the same place. So what’s changed? The rust-timer comment is from 5 hours ago</p>",
        "id": 254260813,
        "sender_full_name": "pnkfelix",
        "timestamp": 1632251269
    },
    {
        "content": "<p>I think <span class=\"user-mention\" data-user-id=\"224872\">@rylev</span> changed the magnitudes which signal particular changes just now</p>",
        "id": 254260915,
        "sender_full_name": "simulacrum",
        "timestamp": 1632251305
    },
    {
        "content": "<p>I see, so it really was a very recent change and my copy of the report inherited it</p>",
        "id": 254260953,
        "sender_full_name": "pnkfelix",
        "timestamp": 1632251329
    },
    {
        "content": "<p><a href=\"https://github.com/rust-lang/rustc-perf/pull/1023/files#diff-0e6e573d342626493753fe5549c06201f15bbd557077eea8902b32b734154eaaR866-R870\">https://github.com/rust-lang/rustc-perf/pull/1023/files#diff-0e6e573d342626493753fe5549c06201f15bbd557077eea8902b32b734154eaaR866-R870</a></p>",
        "id": 254260979,
        "sender_full_name": "simulacrum",
        "timestamp": 1632251342
    },
    {
        "content": "<p>okay. I’ll keep plunging ahead</p>",
        "id": 254261090,
        "sender_full_name": "pnkfelix",
        "timestamp": 1632251396
    },
    {
        "content": "<p>I feel like we always happen to merge changes as you're doing triage :)</p>",
        "id": 254261410,
        "sender_full_name": "simulacrum",
        "timestamp": 1632251535
    },
    {
        "content": "<p>Its <del>a good</del> an effective way to keep me aware of the work going on over here. :)</p>",
        "id": 254261711,
        "sender_full_name": "pnkfelix",
        "timestamp": 1632251657
    },
    {
        "content": "<p>Hey, by the way: If a PR “A” in the autogenerated report injected a regression that has already been addressed by a follow-up PR “B\": Do we keep the PR “A” in the report and just add a note saying it was addressed by “B”? Or do we remove it from the report entirely? (I can arguments on both sides here.)</p>",
        "id": 254262441,
        "sender_full_name": "pnkfelix",
        "timestamp": 1632251973
    },
    {
        "content": "<p>I’m currently inclined to remove the entry from the report, at least in the case where “B” has landed.</p>",
        "id": 254262480,
        "sender_full_name": "pnkfelix",
        "timestamp": 1632251986
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"116122\">simulacrum</span> <a href=\"#narrow/stream/247081-t-compiler.2Fperformance/topic/triage.202021.2021.2009/near/254261410\">said</a>:</p>\n<blockquote>\n<p>I feel like we always happen to merge changes as you're doing triage :)</p>\n</blockquote>\n<p>Sorry for this! Maybe we should try to slow down the changes on Tuesdays <span aria-label=\"wink\" class=\"emoji emoji-1f609\" role=\"img\" title=\"wink\">:wink:</span></p>",
        "id": 254264865,
        "sender_full_name": "rylev",
        "timestamp": 1632252943
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"116083\">pnkfelix</span> <a href=\"#narrow/stream/247081-t-compiler.2Fperformance/topic/triage.202021.2021.2009/near/254262480\">said</a>:</p>\n<blockquote>\n<p>I’m currently inclined to remove the entry from the report, at least in the case where “B” has landed.</p>\n</blockquote>\n<p>In the case where B landed already I would remove it from the report. It's essentially a noop</p>",
        "id": 254265057,
        "sender_full_name": "rylev",
        "timestamp": 1632252975
    },
    {
        "content": "<p>Of course, sometimes the performance change isn't <em>fully</em> addressed in which case it might make sense to keep them around</p>",
        "id": 254265145,
        "sender_full_name": "rylev",
        "timestamp": 1632253005
    },
    {
        "content": "<p>okay, triage PR is up: <a href=\"https://github.com/rust-lang/rustc-perf/pull/1026\">https://github.com/rust-lang/rustc-perf/pull/1026</a></p>",
        "id": 254283811,
        "sender_full_name": "pnkfelix",
        "timestamp": 1632261024
    },
    {
        "content": "<p>let me go update TWIR</p>",
        "id": 254283819,
        "sender_full_name": "pnkfelix",
        "timestamp": 1632261029
    },
    {
        "content": "<p>wait, is the TWIR draft not up yet? Did I actually … get this done before TWIR is drafted for once …?</p>",
        "id": 254283967,
        "sender_full_name": "pnkfelix",
        "timestamp": 1632261110
    },
    {
        "content": "<p>whelp, gotta go; I’ll come to this later.</p>",
        "id": 254284038,
        "sender_full_name": "pnkfelix",
        "timestamp": 1632261135
    },
    {
        "content": "<p>Thanks for the help, <span class=\"user-mention\" data-user-id=\"116122\">@simulacrum</span> and <span class=\"user-mention\" data-user-id=\"224872\">@rylev</span> !</p>",
        "id": 254284060,
        "sender_full_name": "pnkfelix",
        "timestamp": 1632261149
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"116083\">pnkfelix</span> <a href=\"#narrow/stream/247081-t-compiler.2Fperformance/topic/triage.202021.2021.2009/near/254283967\">said</a>:</p>\n<blockquote>\n<p>wait, is the TWIR draft not up yet? Did I actually … get this done before TWIR is drafted for once …?</p>\n</blockquote>\n<p>no, no; just need to look in the right folder. :)</p>",
        "id": 254293056,
        "sender_full_name": "pnkfelix",
        "timestamp": 1632266710
    }
]