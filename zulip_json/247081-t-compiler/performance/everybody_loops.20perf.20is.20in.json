[
    {
        "content": "<p>Compilers hate them! <a href=\"https://perf.rust-lang.org/compare.html?start=d9e8d6290745a65025a3e082aea72fbe372292c6&amp;end=97f1e6ff90848792722f9636e4a11368bb3b14c2\">https://perf.rust-lang.org/compare.html?start=d9e8d6290745a65025a3e082aea72fbe372292c6&amp;end=97f1e6ff90848792722f9636e4a11368bb3b14c2</a></p>",
        "id": 204037612,
        "sender_full_name": "Joshua Nelson",
        "timestamp": 1594866044
    },
    {
        "content": "<p>cc <span class=\"user-mention\" data-user-id=\"119009\">@eddyb</span> <span aria-label=\"slight smile\" class=\"emoji emoji-1f642\" role=\"img\" title=\"slight smile\">:slight_smile:</span></p>",
        "id": 204037709,
        "sender_full_name": "Joshua Nelson",
        "timestamp": 1594866129
    },
    {
        "content": "<p>amazing</p>",
        "id": 204037719,
        "sender_full_name": "eddyb",
        "timestamp": 1594866150
    },
    {
        "content": "<p>this seems acceptable, I think</p>",
        "id": 204037732,
        "sender_full_name": "eddyb",
        "timestamp": 1594866167
    },
    {
        "content": "<p>also <span class=\"user-mention\" data-user-id=\"116122\">@simulacrum</span> you should probably change Doc runs to only do one of the three run-kinds, rustdoc doesn't believe in incremental</p>",
        "id": 204037743,
        "sender_full_name": "Joshua Nelson",
        "timestamp": 1594866188
    },
    {
        "content": "<p>some of these I guess are from stuff you haven't turned off, although I don't know for sure what</p>",
        "id": 204037769,
        "sender_full_name": "eddyb",
        "timestamp": 1594866221
    },
    {
        "content": "<p>the -62% is unbelievable lol</p>",
        "id": 204037771,
        "sender_full_name": "Joshua Nelson",
        "timestamp": 1594866226
    },
    {
        "content": "<p>Hm yeah that's probably a good call</p>",
        "id": 204037772,
        "sender_full_name": "simulacrum",
        "timestamp": 1594866227
    },
    {
        "content": "<p><code>-Z self-profile</code> for <code>rustdoc</code> would be nice tho</p>",
        "id": 204037822,
        "sender_full_name": "eddyb",
        "timestamp": 1594866244
    },
    {
        "content": "<p>yeah I don't know where the +15% is coming from</p>",
        "id": 204037825,
        "sender_full_name": "Joshua Nelson",
        "timestamp": 1594866247
    },
    {
        "content": "<p>to see what actually <em>is</em> running</p>",
        "id": 204037827,
        "sender_full_name": "eddyb",
        "timestamp": 1594866249
    },
    {
        "content": "<p>Support in perf just needs rustdoc to do it and would be great</p>",
        "id": 204037844,
        "sender_full_name": "simulacrum",
        "timestamp": 1594866277
    },
    {
        "content": "<p>I think it just needs to pass the flag to <code>rustc</code></p>",
        "id": 204037857,
        "sender_full_name": "eddyb",
        "timestamp": 1594866300
    },
    {
        "content": "<p>which might already happen</p>",
        "id": 204037863,
        "sender_full_name": "eddyb",
        "timestamp": 1594866306
    },
    {
        "content": "<p>where does rustc do it? shouldn't be too hard to add in rustdoc</p>",
        "id": 204037864,
        "sender_full_name": "Joshua Nelson",
        "timestamp": 1594866307
    },
    {
        "content": "<p>just try passing it</p>",
        "id": 204037886,
        "sender_full_name": "eddyb",
        "timestamp": 1594866326
    },
    {
        "content": "<p><code>-Z treat-err-as-bug</code> worked so I don't see why other flags wouldn't</p>",
        "id": 204037890,
        "sender_full_name": "eddyb",
        "timestamp": 1594866340
    },
    {
        "content": "<p>no errors but also no output <span aria-label=\"thinking\" class=\"emoji emoji-1f914\" role=\"img\" title=\"thinking\">:thinking:</span></p>",
        "id": 204037907,
        "sender_full_name": "Joshua Nelson",
        "timestamp": 1594866356
    },
    {
        "content": "<p>oh it's in .events</p>",
        "id": 204037948,
        "sender_full_name": "Joshua Nelson",
        "timestamp": 1594866365
    },
    {
        "content": "<p>if it made the files that's confirmation</p>",
        "id": 204037958,
        "sender_full_name": "eddyb",
        "timestamp": 1594866374
    },
    {
        "content": "<p>remind me the command to look at the binary file?</p>",
        "id": 204037963,
        "sender_full_name": "Joshua Nelson",
        "timestamp": 1594866381
    },
    {
        "content": "<p>the fun thing about these scales is the noise is drowned out <a href=\"https://perf.rust-lang.org/compare.html?start=d9e8d6290745a65025a3e082aea72fbe372292c6&amp;end=97f1e6ff90848792722f9636e4a11368bb3b14c2&amp;stat=wall-time\">https://perf.rust-lang.org/compare.html?start=d9e8d6290745a65025a3e082aea72fbe372292c6&amp;end=97f1e6ff90848792722f9636e4a11368bb3b14c2&amp;stat=wall-time</a></p>",
        "id": 204037968,
        "sender_full_name": "eddyb",
        "timestamp": 1594866389
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"232545\">@Joshua Nelson</span> <code>summarize</code></p>",
        "id": 204037971,
        "sender_full_name": "eddyb",
        "timestamp": 1594866394
    },
    {
        "content": "<p>top three for a trivial program are</p>\n<div class=\"codehilite\"><pre><span></span><code>+---------------------------------+-----------+-----------------+----------+------------+\n| metadata_decode_entry           | 337.48ms  | 31.731          | 403.13ms | 240303     |\n+---------------------------------+-----------+-----------------+----------+------------+\n| &lt;unknown&gt;                       | 236.37ms  | 22.225          | 1.71s    | 251354     |\n+---------------------------------+-----------+-----------------+----------+------------+\n| metadata_register_crate         | 56.59ms   | 5.321           | 86.71ms  | 14         |\n</code></pre></div>",
        "id": 204038016,
        "sender_full_name": "Joshua Nelson",
        "timestamp": 1594866469
    },
    {
        "content": "<p>lol what is '&lt;unknown&gt;'</p>",
        "id": 204038020,
        "sender_full_name": "Joshua Nelson",
        "timestamp": 1594866474
    },
    {
        "content": "<p>let me try on cargo, it's one of the ones that regressed</p>",
        "id": 204038069,
        "sender_full_name": "Joshua Nelson",
        "timestamp": 1594866506
    },
    {
        "content": "<p>ugh have to rebuild rustdoc <span aria-label=\"face palm\" class=\"emoji emoji-1f926\" role=\"img\" title=\"face palm\">:face_palm:</span> I'll get the numbers from master in the meantime</p>",
        "id": 204038197,
        "sender_full_name": "Joshua Nelson",
        "timestamp": 1594866606
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"232545\">@Joshua Nelson</span> once you get two sets, <code>summarize diff</code> exists</p>",
        "id": 204038238,
        "sender_full_name": "eddyb",
        "timestamp": 1594866691
    },
    {
        "content": "<p>on master the top ones for cargo are</p>\n<div class=\"codehilite\"><pre><span></span><code>| &lt;unknown&gt;                       | 2.35s     | 27.137          | 7.07s    | 824225     |\n+---------------------------------+-----------+-----------------+----------+------------+\n| expand_crate                    | 2.01s     | 23.161          | 2.11s    | 1          |\n+---------------------------------+-----------+-----------------+----------+------------+\n| metadata_decode_entry           | 509.62ms  | 5.874           | 546.76ms | 530639     |\n</code></pre></div>",
        "id": 204038311,
        "sender_full_name": "Joshua Nelson",
        "timestamp": 1594866776
    },
    {
        "content": "<p>what I'm seeing is that rustdoc isn't very good at timing itself <span aria-label=\"face palm\" class=\"emoji emoji-1f926\" role=\"img\" title=\"face palm\">:face_palm:</span></p>",
        "id": 204038316,
        "sender_full_name": "Joshua Nelson",
        "timestamp": 1594866786
    },
    {
        "content": "<p>/me stares</p>",
        "id": 204038317,
        "sender_full_name": "eddyb",
        "timestamp": 1594866787
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"232545\">@Joshua Nelson</span> oh I'm dumb. that's rustdoc</p>",
        "id": 204038323,
        "sender_full_name": "eddyb",
        "timestamp": 1594866809
    },
    {
        "content": "<p>since it doesn't label itself</p>",
        "id": 204038334,
        "sender_full_name": "eddyb",
        "timestamp": 1594866820
    },
    {
        "content": "<p><code>tcx.sess.time(\"rustdoc\", || ...)</code> should be enough</p>",
        "id": 204038381,
        "sender_full_name": "eddyb",
        "timestamp": 1594866852
    },
    {
        "content": "<p>if you want to label it</p>",
        "id": 204038383,
        "sender_full_name": "eddyb",
        "timestamp": 1594866856
    },
    {
        "content": "<p>I'm surprised it spends so much time not in rustc ... maybe <code>clean</code> is expensive? or generating the HTML?</p>",
        "id": 204038385,
        "sender_full_name": "Joshua Nelson",
        "timestamp": 1594866859
    },
    {
        "content": "<p>you could find out if you split those into multiple <code>.time</code> :P</p>",
        "id": 204038390,
        "sender_full_name": "eddyb",
        "timestamp": 1594866880
    },
    {
        "content": "<p><code>clean</code> might be wasteful. among other things it turns <code>Symbol</code> into <code>String</code> which is neither necessary nor cheap</p>",
        "id": 204038411,
        "sender_full_name": "eddyb",
        "timestamp": 1594866923
    },
    {
        "content": "<p>this looks useful</p>\n<div class=\"codehilite\"><pre><span></span><code><span class=\"w\">                    </span><span class=\"k\">if</span><span class=\"w\"> </span><span class=\"n\">run</span><span class=\"w\"> </span><span class=\"p\">{</span><span class=\"w\"></span>\n<span class=\"w\">                        </span><span class=\"n\">debug</span><span class=\"o\">!</span><span class=\"p\">(</span><span class=\"s\">&quot;running pass {}&quot;</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"n\">p</span><span class=\"p\">.</span><span class=\"n\">pass</span><span class=\"p\">.</span><span class=\"n\">name</span><span class=\"p\">);</span><span class=\"w\"></span>\n<span class=\"w\">                        </span><span class=\"n\">ctxt</span><span class=\"p\">.</span><span class=\"n\">tcx</span><span class=\"p\">.</span><span class=\"n\">sess</span><span class=\"p\">.</span><span class=\"n\">time</span><span class=\"p\">(</span><span class=\"n\">p</span><span class=\"p\">.</span><span class=\"n\">pass</span><span class=\"p\">.</span><span class=\"n\">name</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"o\">||</span><span class=\"w\"> </span><span class=\"p\">{</span><span class=\"w\"></span>\n<span class=\"w\">                            </span><span class=\"n\">krate</span><span class=\"w\"> </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"p\">(</span><span class=\"n\">p</span><span class=\"p\">.</span><span class=\"n\">pass</span><span class=\"p\">.</span><span class=\"n\">run</span><span class=\"p\">)(</span><span class=\"n\">krate</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"o\">&amp;</span><span class=\"n\">ctxt</span><span class=\"p\">);</span><span class=\"w\"></span>\n<span class=\"w\">                        </span><span class=\"p\">}</span><span class=\"w\"></span>\n<span class=\"w\">                    </span><span class=\"p\">}</span><span class=\"w\"></span>\n</code></pre></div>",
        "id": 204038483,
        "sender_full_name": "Joshua Nelson",
        "timestamp": 1594867001
    },
    {
        "content": "<p>what happens if I call <code>.time()</code> and then some of the code I call calls <code>time()</code> again?</p>",
        "id": 204038494,
        "sender_full_name": "Joshua Nelson",
        "timestamp": 1594867018
    },
    {
        "content": "<p>it's fine</p>",
        "id": 204038496,
        "sender_full_name": "eddyb",
        "timestamp": 1594867024
    },
    {
        "content": "<p>note the columns in the table, there's \"total time\" and \"self time\"</p>",
        "id": 204038509,
        "sender_full_name": "eddyb",
        "timestamp": 1594867054
    },
    {
        "content": "<p>ahhh nice</p>",
        "id": 204038514,
        "sender_full_name": "Joshua Nelson",
        "timestamp": 1594867065
    },
    {
        "content": "<p>\"self time\" being \"total time\" minus the total time of anything nested</p>",
        "id": 204038525,
        "sender_full_name": "eddyb",
        "timestamp": 1594867069
    },
    {
        "content": "<p>lol rustdoc recognizes everything except -Z help</p>",
        "id": 204038579,
        "sender_full_name": "Joshua Nelson",
        "timestamp": 1594867097
    },
    {
        "content": "<p>amazing</p>",
        "id": 204038582,
        "sender_full_name": "eddyb",
        "timestamp": 1594867102
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"232545\">@Joshua Nelson</span> wait why not <code>rustup-install-toolchain-master</code> or w/e the two builds that the perf run used?</p>",
        "id": 204038698,
        "sender_full_name": "eddyb",
        "timestamp": 1594867253
    },
    {
        "content": "<p>that way we can get <em>exactly</em> the missing data</p>",
        "id": 204038699,
        "sender_full_name": "eddyb",
        "timestamp": 1594867259
    },
    {
        "content": "<p>... I forgot that was a thing</p>",
        "id": 204038705,
        "sender_full_name": "Joshua Nelson",
        "timestamp": 1594867265
    },
    {
        "content": "<p>heh</p>",
        "id": 204038707,
        "sender_full_name": "eddyb",
        "timestamp": 1594867275
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"116122\">@simulacrum</span> <code>/detailed-query.html</code> is giving me 502 bad gateway in a popup</p>",
        "id": 204038827,
        "sender_full_name": "Joshua Nelson",
        "timestamp": 1594867426
    },
    {
        "content": "<p><a href=\"https://perf.rust-lang.org/detailed-query.html?commit=97f1e6ff90848792722f9636e4a11368bb3b14c2&amp;base_commit=d9e8d6290745a65025a3e082aea72fbe372292c6&amp;benchmark=deep-vector-doc&amp;run_name=full\">https://perf.rust-lang.org/detailed-query.html?commit=97f1e6ff90848792722f9636e4a11368bb3b14c2&amp;base_commit=d9e8d6290745a65025a3e082aea72fbe372292c6&amp;benchmark=deep-vector-doc&amp;run_name=full</a></p>",
        "id": 204038834,
        "sender_full_name": "Joshua Nelson",
        "timestamp": 1594867435
    },
    {
        "content": "<p>I assume that's just missing data</p>",
        "id": 204038837,
        "sender_full_name": "eddyb",
        "timestamp": 1594867439
    },
    {
        "content": "<p>and the wrong error code =))</p>",
        "id": 204038888,
        "sender_full_name": "eddyb",
        "timestamp": 1594867447
    },
    {
        "content": "<p>ok wow that was so much faster lol</p>",
        "id": 204038927,
        "sender_full_name": "Joshua Nelson",
        "timestamp": 1594867533
    },
    {
        "content": "<div class=\"codehilite\"><pre><span></span><code>+---------------------------------+-----------+-----------------+----------+------------+\n| Item                            | Self time | % of total time | Time     | Item count |\n+---------------------------------+-----------+-----------------+----------+------------+\n| &lt;unknown&gt;                       | 1.21s     | 29.525          | 3.75s    | 824339     |\n+---------------------------------+-----------+-----------------+----------+------------+\n| expand_crate                    | 841.70ms  | 20.538          | 888.88ms | 1          |\n+---------------------------------+-----------+-----------------+----------+------------+\n| metadata_decode_entry           | 256.55ms  | 6.260           | 278.78ms | 530750     |\n</code></pre></div>\n\n\n<p>this is the master it compared to</p>",
        "id": 204038987,
        "sender_full_name": "Joshua Nelson",
        "timestamp": 1594867602
    },
    {
        "content": "<p>can you include the table heading?</p>",
        "id": 204038990,
        "sender_full_name": "eddyb",
        "timestamp": 1594867621
    },
    {
        "content": "<p>also, is this <code>summarize diff</code>?</p>",
        "id": 204039002,
        "sender_full_name": "eddyb",
        "timestamp": 1594867650
    },
    {
        "content": "<p>this is <code>summarize summarize</code></p>",
        "id": 204039007,
        "sender_full_name": "Joshua Nelson",
        "timestamp": 1594867659
    },
    {
        "content": "<p>will send a diff once I have one</p>",
        "id": 204039019,
        "sender_full_name": "Joshua Nelson",
        "timestamp": 1594867676
    },
    {
        "content": "<p>you want the compare mode for sanity reasons</p>",
        "id": 204039021,
        "sender_full_name": "eddyb",
        "timestamp": 1594867678
    },
    {
        "content": "<p>hmm my numbers are not matching perf.rlo at all</p>",
        "id": 204039091,
        "sender_full_name": "Joshua Nelson",
        "timestamp": 1594867739
    },
    {
        "content": "<p>it says it took almost exactly 4 seconds for both</p>",
        "id": 204039096,
        "sender_full_name": "Joshua Nelson",
        "timestamp": 1594867748
    },
    {
        "content": "<div class=\"codehilite\"><pre><span></span><code>(-bash@build-server) ~/src/cargo ▶️ summarize diff master_perf/unknown-crate-5176.events everybody_loops/unknown-crate-8085.events\n +---------------------------------+---------------+------------------+---------------+-------------+------------+------------+--------------+-----------------------+\n| Item                            | Self Time     | Self Time Change | Time          | Time Change | Item count | Cache hits | Blocked time | Incremental load time |\n+---------------------------------+---------------+------------------+---------------+-------------+------------+------------+--------------+-----------------------+\n| &lt;unknown&gt;                       | -363.93668ms  | -30.08%          | -1.326167095s | -35.38%     | -66001     | +0         | +0ns         | +0ns                  |\n+---------------------------------+---------------+------------------+---------------+-------------+------------+------------+--------------+-----------------------+\n| resolve_crate                   | +161.222999ms | +222.66%         | +161.765543ms | +218.32%    | +0         | +0         | +0ns         | +0ns                  |\n+---------------------------------+---------------+------------------+---------------+-------------+------------+------------+--------------+-----------------------+\n| hir_lowering                    | +109.586203ms | +295.67%         | +109.586203ms | +295.67%    | +0         | +0         | +0ns         | +0ns                  |\n</code></pre></div>",
        "id": 204039101,
        "sender_full_name": "Joshua Nelson",
        "timestamp": 1594867780
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"232545\">@Joshua Nelson</span> oh run them multiple times, you might be seeing file caching effects</p>",
        "id": 204039147,
        "sender_full_name": "eddyb",
        "timestamp": 1594867817
    },
    {
        "content": "<p>also, grab the top 10 or so</p>",
        "id": 204039166,
        "sender_full_name": "eddyb",
        "timestamp": 1594867830
    },
    {
        "content": "<p>both <code>resolve_crate</code> and <code>hir_lowering</code> make sense. the <code>&lt;unknown&gt;</code> should largely remain unchanged AFAIK</p>",
        "id": 204039177,
        "sender_full_name": "eddyb",
        "timestamp": 1594867853
    },
    {
        "content": "<p>still only shows 10ms difference</p>\n<div class=\"codehilite\"><pre><span></span><code>(-bash@build-server) ~/src/cargo ▶️ summarize diff master_perf/unknown-crate-11799.events everybody_loops/unknown-crate-8601.events\n+---------------------------------+---------------+------------------+---------------+-------------+------------+------------+--------------+-----------------------+\n| Item                            | Self Time     | Self Time Change | Time          | Time Change | Item count | Cache hits | Blocked time | Incremental load time |\n+---------------------------------+---------------+------------------+---------------+-------------+------------+------------+--------------+-----------------------+\n| &lt;unknown&gt;                       | -368.126753ms | -30.12%          | -1.332377885s | -35.29%     | -66001     | +0         | +0ns         | +0ns                  |\n+---------------------------------+---------------+------------------+---------------+-------------+------------+------------+--------------+-----------------------+\n| resolve_crate                   | +166.668739ms | +225.35%         | +167.188961ms | +220.98%    | +0         | +0         | +0ns         | +0ns                  |\n+---------------------------------+---------------+------------------+---------------+-------------+------------+------------+--------------+-----------------------+\n| hir_lowering                    | +109.982559ms | +291.43%         | +109.982559ms | +291.43%    | +0         | +0         | +0ns         | +0ns                  |\n+---------------------------------+---------------+------------------+---------------+-------------+------------+------------+--------------+-----------------------+\n| build_hir_map                   | +69.766132ms  | +323.68%         | +69.766132ms  | +323.68%    | +0         | +0         | +0ns         | +0ns                  |\n+---------------------------------+---------------+------------------+---------------+-------------+------------+------------+--------------+-----------------------+\n| configure_and_expand            | -33.141565ms  | -99.76%          | +143.123542ms | +14.77%     | +0         | +0         | +0ns         | +0ns                  |\n+---------------------------------+---------------+------------------+---------------+-------------+------------+------------+--------------+-----------------------+\n| early_lint_checks               | +20.245762ms  | +277.58%         | +20.245762ms  | +277.58%    | +0         | +0         | +0ns         | +0ns                  |\n+---------------------------------+---------------+------------------+---------------+-------------+------------+------------+--------------+-----------------------+\n| complete_gated_feature_checking | +10.659805ms  | +247.34%         | +10.659805ms  | +247.34%    | +0         | +0         | +0ns         | +0ns                  |\n+---------------------------------+---------------+------------------+---------------+-------------+------------+------------+--------------+-----------------------+\n| death_checking                  | -10.272364ms  | -100.00%         | -11.970467ms  | -100.00%    | -1         | +0         | -0ns         | -0ns                  |\n+---------------------------------+---------------+------------------+---------------+-------------+------------+------------+--------------+-----------------------+\n| free_global_ctxt                | +9.536383ms   | +22.32%          | +9.536383ms   | +22.32%     | +0         | +0         | +0ns         | +0ns                  |\n+---------------------------------+---------------+------------------+---------------+-------------+------------+------------+--------------+-----------------------+\n| expand_crate                    | -7.918964ms   | -0.98%           | -6.910984ms   | -0.81%      | +0         | +0         | +0ns         | +0ns                  |\n+---------------------------------+---------------+------------------+---------------+-------------+------------+------------+--------------+-----------------------+\n</code></pre></div>",
        "id": 204039260,
        "sender_full_name": "Joshua Nelson",
        "timestamp": 1594867963
    },
    {
        "content": "<p>I ran both three times in a row then used the last</p>",
        "id": 204039288,
        "sender_full_name": "Joshua Nelson",
        "timestamp": 1594867988
    },
    {
        "content": "<p>not particularly scientific but should have been enough to have <em>roughly</em> the same as perf.rlo <span aria-label=\"confused\" class=\"emoji emoji-1f615\" role=\"img\" title=\"confused\">:confused:</span></p>",
        "id": 204039297,
        "sender_full_name": "Joshua Nelson",
        "timestamp": 1594868009
    },
    {
        "content": "<p>let me try recompiling so we can break up the <code>&lt;unknown&gt;</code> a little</p>",
        "id": 204039316,
        "sender_full_name": "Joshua Nelson",
        "timestamp": 1594868042
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"232545\">@Joshua Nelson</span> anyway all of this makes sense, it's not throwing away function bodies, so some boring stuff still r uns</p>",
        "id": 204039687,
        "sender_full_name": "eddyb",
        "timestamp": 1594868475
    },
    {
        "content": "<p>also what is <code>death_checking</code>? idk seems morbid</p>",
        "id": 204039691,
        "sender_full_name": "eddyb",
        "timestamp": 1594868490
    },
    {
        "content": "<p>lol I wondered too</p>",
        "id": 204039693,
        "sender_full_name": "Joshua Nelson",
        "timestamp": 1594868498
    },
    {
        "content": "<p>maybe liveness analysis?</p>",
        "id": 204039694,
        "sender_full_name": "Joshua Nelson",
        "timestamp": 1594868504
    },
    {
        "content": "<p>doubtful, that's still called liveness</p>",
        "id": 204039713,
        "sender_full_name": "eddyb",
        "timestamp": 1594868522
    },
    {
        "content": "<p>ugh rustc doesn't understand it's not the same crate every time</p>\n<div class=\"codehilite\"><pre><span></span><code><span class=\"n\">error</span><span class=\"p\">[</span><span class=\"n\">E0382</span><span class=\"p\">]</span>: <span class=\"nc\">use</span><span class=\"w\"> </span><span class=\"n\">of</span><span class=\"w\"> </span><span class=\"n\">moved</span><span class=\"w\"> </span><span class=\"n\">value</span>: <span class=\"err\">`</span><span class=\"n\">krate</span><span class=\"err\">`</span><span class=\"w\"></span>\n<span class=\"w\">   </span><span class=\"o\">-</span>-&gt; <span class=\"nc\">src</span><span class=\"o\">/</span><span class=\"n\">librustdoc</span><span class=\"o\">/</span><span class=\"n\">core</span><span class=\"p\">.</span><span class=\"n\">rs</span>:<span class=\"mi\">601</span>:<span class=\"mi\">57</span><span class=\"w\"></span>\n<span class=\"w\">    </span><span class=\"o\">|</span><span class=\"w\"></span>\n<span class=\"mi\">502</span><span class=\"w\"> </span><span class=\"o\">|</span><span class=\"w\">                 </span><span class=\"kd\">let</span><span class=\"w\"> </span><span class=\"k\">mut</span><span class=\"w\"> </span><span class=\"n\">krate</span><span class=\"w\"> </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"n\">clean</span>::<span class=\"n\">krate</span><span class=\"p\">(</span><span class=\"o\">&amp;</span><span class=\"k\">mut</span><span class=\"w\"> </span><span class=\"n\">ctxt</span><span class=\"p\">);</span><span class=\"w\"></span>\n<span class=\"w\">    </span><span class=\"o\">|</span><span class=\"w\">                     </span><span class=\"o\">---------</span><span class=\"w\"> </span><span class=\"k\">move</span><span class=\"w\"> </span><span class=\"n\">occurs</span><span class=\"w\"> </span><span class=\"n\">because</span><span class=\"w\"> </span><span class=\"err\">`</span><span class=\"n\">krate</span><span class=\"err\">`</span><span class=\"w\"> </span><span class=\"n\">has</span><span class=\"w\"> </span><span class=\"k\">type</span> <span class=\"err\">`</span><span class=\"n\">clean</span>::<span class=\"n\">types</span>::<span class=\"n\">Crate</span><span class=\"err\">`</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"n\">which</span><span class=\"w\"> </span><span class=\"n\">does</span><span class=\"w\"> </span><span class=\"n\">not</span><span class=\"w\"> </span><span class=\"n\">implement</span><span class=\"w\"> </span><span class=\"n\">the</span><span class=\"w\"> </span><span class=\"err\">`</span><span class=\"nb\">Copy</span><span class=\"err\">`</span><span class=\"w\"> </span><span class=\"k\">trait</span><span class=\"w\"></span>\n<span class=\"o\">..</span><span class=\"p\">.</span><span class=\"w\"></span>\n<span class=\"mi\">601</span><span class=\"w\"> </span><span class=\"o\">|</span><span class=\"w\">                         </span><span class=\"n\">ctxt</span><span class=\"p\">.</span><span class=\"n\">tcx</span><span class=\"p\">.</span><span class=\"n\">sess</span><span class=\"p\">.</span><span class=\"n\">time</span><span class=\"p\">(</span><span class=\"n\">p</span><span class=\"p\">.</span><span class=\"n\">pass</span><span class=\"p\">.</span><span class=\"n\">name</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"o\">||</span><span class=\"w\"> </span><span class=\"p\">{</span><span class=\"w\"></span>\n<span class=\"w\">    </span><span class=\"o\">|</span><span class=\"w\">                                                         </span><span class=\"o\">^^</span><span class=\"w\"> </span><span class=\"n\">value</span><span class=\"w\"> </span><span class=\"n\">moved</span><span class=\"w\"> </span><span class=\"n\">into</span><span class=\"w\"> </span><span class=\"n\">closure</span><span class=\"w\"> </span><span class=\"n\">here</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"k\">in</span><span class=\"w\"> </span><span class=\"n\">previous</span><span class=\"w\"> </span><span class=\"n\">iteration</span><span class=\"w\"> </span><span class=\"n\">of</span><span class=\"w\"> </span><span class=\"k\">loop</span><span class=\"w\"></span>\n<span class=\"mi\">602</span><span class=\"w\"> </span><span class=\"o\">|</span><span class=\"w\">                             </span><span class=\"n\">krate</span><span class=\"w\"> </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"p\">(</span><span class=\"n\">p</span><span class=\"p\">.</span><span class=\"n\">pass</span><span class=\"p\">.</span><span class=\"n\">run</span><span class=\"p\">)(</span><span class=\"n\">krate</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"o\">&amp;</span><span class=\"n\">ctxt</span><span class=\"p\">);</span><span class=\"w\"></span>\n<span class=\"w\">    </span><span class=\"o\">|</span><span class=\"w\">                                                  </span><span class=\"o\">-----</span><span class=\"w\"> </span><span class=\"k\">use</span><span class=\"w\"> </span><span class=\"n\">occurs</span><span class=\"w\"> </span><span class=\"n\">due</span><span class=\"w\"> </span><span class=\"n\">to</span><span class=\"w\"> </span><span class=\"k\">use</span><span class=\"w\"> </span><span class=\"k\">in</span><span class=\"w\"> </span><span class=\"n\">closure</span><span class=\"w\"></span>\n</code></pre></div>",
        "id": 204039776,
        "sender_full_name": "Joshua Nelson",
        "timestamp": 1594868592
    },
    {
        "content": "<p>here we go, I can do <code>krate = time(...)</code></p>",
        "id": 204039872,
        "sender_full_name": "Joshua Nelson",
        "timestamp": 1594868706
    },
    {
        "content": "<p>lol</p>",
        "id": 204040027,
        "sender_full_name": "eddyb",
        "timestamp": 1594868888
    },
    {
        "content": "<p>well that's certainly not what I expected</p>\n<div class=\"codehilite\"><pre><span></span><code>(-bash@build-server) ~/src/cargo ▶️ summarize summarize everybody_loops_subdivided/unknown-crate-21132.events\n+---------------------------------+-----------+-----------------+----------+------------+\n| Item                            | Self time | % of total time | Time     | Item count |\n+---------------------------------+-----------+-----------------+----------+------------+\n| collect-trait-impls             | 2.10s     | 33.735          | 2.91s    | 1          |\n+---------------------------------+-----------+-----------------+----------+------------+\n| &lt;unknown&gt;                       | 1.40s     | 22.421          | 3.66s    | 758415     |\n+---------------------------------+-----------+-----------------+----------+------------+\n| expand_crate                    | 1.24s     | 19.961          | 1.30s    | 1          |\n+---------------------------------+-----------+-----------------+----------+------------+\n| metadata_decode_entry           | 353.08ms  | 5.673           | 380.60ms | 529337     |\n+---------------------------------+-----------+-----------------+----------+------------+\n| resolve_crate                   | 327.94ms  | 5.269           | 330.98ms | 1          |\n+---------------------------------+-----------+-----------------+----------+------------+\n| hir_lowering                    | 192.81ms  | 3.098           | 192.81ms | 1          |\n+---------------------------------+-----------+-----------------+----------+------------+\n| build_hir_map                   | 115.09ms  | 1.849           | 115.09ms | 1          |\n+---------------------------------+-----------+-----------------+----------+------------+\n| free_global_ctxt                | 53.78ms   | 0.864           | 53.78ms  | 1          |\n+---------------------------------+-----------+-----------------+----------+------------+\n| metadata_register_crate         | 50.82ms   | 0.817           | 75.97ms  | 109        |\n+---------------------------------+-----------+-----------------+----------+------------+\n</code></pre></div>",
        "id": 204040044,
        "sender_full_name": "Joshua Nelson",
        "timestamp": 1594868926
    },
    {
        "content": "<p>collect-trait-impls ??</p>",
        "id": 204040047,
        "sender_full_name": "Joshua Nelson",
        "timestamp": 1594868936
    },
    {
        "content": "<p>that's a rustdoc thing right?</p>",
        "id": 204040052,
        "sender_full_name": "eddyb",
        "timestamp": 1594868942
    },
    {
        "content": "<p>it's a pass, yeah</p>",
        "id": 204040055,
        "sender_full_name": "Joshua Nelson",
        "timestamp": 1594868947
    },
    {
        "content": "<p>not actually sure what it does</p>",
        "id": 204040072,
        "sender_full_name": "Joshua Nelson",
        "timestamp": 1594868958
    },
    {
        "content": "<p>makes sense, rustc isn't exactly slow :P</p>",
        "id": 204040073,
        "sender_full_name": "eddyb",
        "timestamp": 1594868961
    },
    {
        "content": "<p>those are fighting words <span aria-label=\"very angry\" class=\"emoji emoji-1f621\" role=\"img\" title=\"very angry\">:very_angry:</span></p>",
        "id": 204040077,
        "sender_full_name": "Joshua Nelson",
        "timestamp": 1594868986
    },
    {
        "content": "<p><code>description: \"retrieves trait impls for items in the crate\"</code></p>",
        "id": 204040123,
        "sender_full_name": "Joshua Nelson",
        "timestamp": 1594869006
    },
    {
        "content": "<p>welcome to \"eddyb dislikes a lot of things about rustdoc but doesn't have the bandwidth to refactor them\"</p>",
        "id": 204040130,
        "sender_full_name": "eddyb",
        "timestamp": 1594869018
    },
    {
        "content": "<p>Hm 502 errors sounds like probably perf is missing some branch somewhere and is panicking as a result. I'll try and debug it later, please file an issue</p>",
        "id": 204040132,
        "sender_full_name": "simulacrum",
        "timestamp": 1594869021
    },
    {
        "content": "<p>I once promised <span class=\"user-mention\" data-user-id=\"210316\">@GuillaumeGomez</span> I would try to help out but I don't think I did much :(</p>",
        "id": 204040146,
        "sender_full_name": "eddyb",
        "timestamp": 1594869045
    },
    {
        "content": "<p>aha, I might have found why <a href=\"https://github.com/rust-lang/rust/pull/73101#discussion_r453274499\">https://github.com/rust-lang/rust/pull/73101#discussion_r453274499</a> is broken though</p>",
        "id": 204040267,
        "sender_full_name": "Joshua Nelson",
        "timestamp": 1594869227
    },
    {
        "content": "<p>or at least the relevant code, it's <code>inline::build_impl</code></p>",
        "id": 204040274,
        "sender_full_name": "Joshua Nelson",
        "timestamp": 1594869237
    },
    {
        "content": "<p>ugh <code>clean</code> makes things so confusing</p>",
        "id": 204040331,
        "sender_full_name": "Joshua Nelson",
        "timestamp": 1594869288
    },
    {
        "content": "<p>anyway it looks like we can just land your PR, it's slower but not by much. unless you want to wait for <a href=\"http://perf.rust-lang.org\">perf.rust-lang.org</a> to get the query details</p>",
        "id": 204040540,
        "sender_full_name": "eddyb",
        "timestamp": 1594869527
    },
    {
        "content": "<p>oh you mean adding <code>sess.time()</code>? nah I don't think we need to block on that</p>",
        "id": 204040575,
        "sender_full_name": "Joshua Nelson",
        "timestamp": 1594869597
    },
    {
        "content": "<p>how expensive is <code>sess.time()</code>? Can I add it basically every other line?</p>",
        "id": 204040659,
        "sender_full_name": "Joshua Nelson",
        "timestamp": 1594869691
    },
    {
        "content": "<p>interesting, the time is _not_ being spent in the traits belonging to cargo</p>",
        "id": 204040720,
        "sender_full_name": "Joshua Nelson",
        "timestamp": 1594869756
    },
    {
        "content": "<p>maybe it's std traits?</p>",
        "id": 204040722,
        "sender_full_name": "Joshua Nelson",
        "timestamp": 1594869759
    },
    {
        "content": "<p>no I mean the 502</p>",
        "id": 204040724,
        "sender_full_name": "eddyb",
        "timestamp": 1594869765
    },
    {
        "content": "<div class=\"codehilite\"><pre><span></span><code>(-bash@build-server) ~/src/cargo ▶️ summarize summarize everybody_loops_subdivided/unknown-crate-22566.events\n+---------------------------------+-----------+-----------------+----------+------------+\n| Item                            | Self time | % of total time | Time     | Item count |\n+---------------------------------+-----------+-----------------+----------+------------+\n| collect-trait-impls             | 2.09s     | 33.453          | 2.95s    | 1          |\n+---------------------------------+-----------+-----------------+----------+------------+\n| &lt;unknown&gt;                       | 1.41s     | 22.549          | 3.69s    | 758415     |\n+---------------------------------+-----------+-----------------+----------+------------+\n| expand_crate                    | 1.22s     | 19.550          | 1.28s    | 1          |\n+---------------------------------+-----------+-----------------+----------+------------+\n| metadata_decode_entry           | 354.78ms  | 5.678           | 382.28ms | 529337     |\n+---------------------------------+-----------+-----------------+----------+------------+\n| resolve_crate                   | 328.40ms  | 5.256           | 331.45ms | 1          |\n+---------------------------------+-----------+-----------------+----------+------------+\n| hir_lowering                    | 192.94ms  | 3.088           | 192.94ms | 1          |\n+---------------------------------+-----------+-----------------+----------+------------+\n| build_hir_map                   | 114.64ms  | 1.835           | 114.64ms | 1          |\n+---------------------------------+-----------+-----------------+----------+------------+\n| free_global_ctxt                | 53.93ms   | 0.863           | 53.93ms  | 1          |\n+---------------------------------+-----------+-----------------+----------+------------+\n| metadata_register_crate         | 50.56ms   | 0.809           | 75.36ms  | 109        |\n+---------------------------------+-----------+-----------------+----------+------------+\n| build trait impl                | 42.45ms   | 0.679           | 43.90ms  | 30665      |\n</code></pre></div>",
        "id": 204040726,
        "sender_full_name": "Joshua Nelson",
        "timestamp": 1594869773
    },
    {
        "content": "<p>ah ok</p>",
        "id": 204040729,
        "sender_full_name": "Joshua Nelson",
        "timestamp": 1594869785
    },
    {
        "content": "<p>adding random .time() is so much fun lmao</p>",
        "id": 204040804,
        "sender_full_name": "Joshua Nelson",
        "timestamp": 1594869899
    },
    {
        "content": "<p>let me time the new visitor too, <code>EmitIgnoredResolutionErrors</code></p>",
        "id": 204040817,
        "sender_full_name": "Joshua Nelson",
        "timestamp": 1594869931
    },
    {
        "content": "<p>ok yeah most of the time in cargo is going to external traits</p>\n<div class=\"codehilite\"><pre><span></span><code>(-bash@build-server) ~/src/cargo ▶️ summarize summarize everybody_loops_subdivided/unknown-crate-24013.events\n+---------------------------------+-----------+-----------------+----------+------------+\n| Item                            | Self time | % of total time | Time     | Item count |\n+---------------------------------+-----------+-----------------+----------+------------+\n| &lt;unknown&gt;                       | 1.49s     | 22.653          | 3.88s    | 758415     |\n+---------------------------------+-----------+-----------------+----------+------------+\n| collect-trait-impls             | 1.41s     | 21.457          | 3.09s    | 1          |\n+---------------------------------+-----------+-----------------+----------+------------+\n| expand_crate                    | 1.29s     | 19.701          | 1.36s    | 1          |\n+---------------------------------+-----------+-----------------+----------+------------+\n| build extern trait impl         | 784.21ms  | 11.949          | 1.18s    | 19520      |\n+---------------------------------+-----------+-----------------+----------+------------+\n| metadata_decode_entry           | 370.51ms  | 5.645           | 399.48ms | 529337     |\n+---------------------------------+-----------+-----------------+----------+------------+\n| resolve_crate                   | 340.93ms  | 5.195           | 344.21ms | 1          |\n+---------------------------------+-----------+-----------------+----------+------------+\n| hir_lowering                    | 199.77ms  | 3.044           | 199.77ms | 1          |\n+---------------------------------+-----------+-----------------+----------+------------+\n| build_hir_map                   | 120.69ms  | 1.839           | 120.69ms | 1          |\n+---------------------------------+-----------+-----------------+----------+------------+\n| free_global_ctxt                | 56.27ms   | 0.857           | 56.27ms  | 1          |\n+---------------------------------+-----------+-----------------+----------+------------+\n| metadata_register_crate         | 52.91ms   | 0.806           | 78.69ms  | 109        |\n+---------------------------------+-----------+-----------------+----------+------------+\n| build local trait impl          | 44.71ms   | 0.681           | 46.33ms  | 30665      |\n+---------------------------------+-----------+-----------------+----------+------------+\n</code></pre></div>",
        "id": 204040884,
        "sender_full_name": "Joshua Nelson",
        "timestamp": 1594869998
    },
    {
        "content": "<p>that &lt;unknown&gt; is bugging me</p>",
        "id": 204040888,
        "sender_full_name": "Joshua Nelson",
        "timestamp": 1594870010
    },
    {
        "content": "<p>ok nice, basically nothing <span aria-label=\"tada\" class=\"emoji emoji-1f389\" role=\"img\" title=\"tada\">:tada:</span> </p>\n<div class=\"codehilite\"><pre><span></span><code>| emit ignored resolution errors  | 132.16µs  | 0.002           | 132.16µs | 227        |\n</code></pre></div>",
        "id": 204041012,
        "sender_full_name": "Joshua Nelson",
        "timestamp": 1594870189
    },
    {
        "content": "<p>not surprised</p>",
        "id": 204042196,
        "sender_full_name": "eddyb",
        "timestamp": 1594871696
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"232545\">@Joshua Nelson</span> just wrap everything rustdoc does in <code>time(\"rustdoc\"</code></p>",
        "id": 204042212,
        "sender_full_name": "eddyb",
        "timestamp": 1594871712
    },
    {
        "content": "<p>like, everything that has a <code>tcx</code> in scope</p>",
        "id": 204042221,
        "sender_full_name": "eddyb",
        "timestamp": 1594871738
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"119009\">@eddyb</span> Well, it's fine. The point is mostly to make it work and you helped me and other rustdoc people a lot. Perf is considered secondary for the moment in there. :)</p>",
        "id": 204054563,
        "sender_full_name": "GuillaumeGomez",
        "timestamp": 1594885676
    },
    {
        "content": "<p>Whatever the <code>&lt;unknown&gt;</code> thing is, it's getting run <em>a lot</em> (<code>758415</code> times) which makes me think it isn't the outer \"rustdoc\" executable.</p>",
        "id": 204076324,
        "sender_full_name": "Wesley Wiser",
        "timestamp": 1594902859
    },
    {
        "content": "<p>It almost feels like it's a query or something that isn't being instrumented but I don't see how that could happen.</p>",
        "id": 204076422,
        "sender_full_name": "Wesley Wiser",
        "timestamp": 1594902902
    },
    {
        "content": "<p>hmm</p>",
        "id": 204076547,
        "sender_full_name": "eddyb",
        "timestamp": 1594902994
    },
    {
        "content": "<p>that part is weird, but also I don't see how it could happen</p>",
        "id": 204076597,
        "sender_full_name": "eddyb",
        "timestamp": 1594903028
    },
    {
        "content": "<p>maybe something passes an empty string somewhere and that gets interpreted as <code>&lt;unknown&gt;</code></p>",
        "id": 204076611,
        "sender_full_name": "eddyb",
        "timestamp": 1594903039
    },
    {
        "content": "<p>Hmm</p>",
        "id": 204076638,
        "sender_full_name": "Wesley Wiser",
        "timestamp": 1594903063
    },
    {
        "content": "<p>It's a good thought but I just can't see how it would happen</p>",
        "id": 204076672,
        "sender_full_name": "Wesley Wiser",
        "timestamp": 1594903083
    },
    {
        "content": "<p>still, labeling the scope of the <code>TyCtxt</code> (or the whole time <code>Session</code> is alive, as probably the better thing to do) shooould allow e.g. using <code>crox</code> to see what's going on</p>",
        "id": 204076701,
        "sender_full_name": "eddyb",
        "timestamp": 1594903090
    },
    {
        "content": "<p>actually, hang on</p>",
        "id": 204076703,
        "sender_full_name": "eddyb",
        "timestamp": 1594903094
    },
    {
        "content": "<p>can we introduce an assert for non-unknown strings? I guess probably no?</p>",
        "id": 204076712,
        "sender_full_name": "simulacrum",
        "timestamp": 1594903101
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"232545\">@Joshua Nelson</span> just use <code>crox</code> lol</p>",
        "id": 204076713,
        "sender_full_name": "eddyb",
        "timestamp": 1594903101
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"125250\">@Wesley Wiser</span> I mean something silly like <code>rustdoc</code> using <code>time(</code> (prior to any of this) but getting the string from somewhere where it's empty sometimes</p>",
        "id": 204076761,
        "sender_full_name": "eddyb",
        "timestamp": 1594903135
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"116122\">simulacrum</span> <a href=\"#narrow/stream/247081-t-compiler.2Fperformance/topic/everybody_loops.20perf.20is.20in/near/204076712\">said</a>:</p>\n<blockquote>\n<p>can we introduce an assert for non-unknown strings? I guess probably no?</p>\n</blockquote>\n<p>We could perhaps have a debugging flag that would enable that behavior.</p>",
        "id": 204076766,
        "sender_full_name": "Wesley Wiser",
        "timestamp": 1594903139
    },
    {
        "content": "<p>Right</p>",
        "id": 204076799,
        "sender_full_name": "Wesley Wiser",
        "timestamp": 1594903166
    },
    {
        "content": "<p>But then I think the count would only be like 1 right?</p>",
        "id": 204076810,
        "sender_full_name": "Wesley Wiser",
        "timestamp": 1594903176
    },
    {
        "content": "<p>from what <span class=\"user-mention\" data-user-id=\"232545\">@Joshua Nelson</span> was pasting I think <code>rustdoc</code> already tracks per-pass times? (in the sense of \"rustdoc pass\"). and each pass has a name</p>",
        "id": 204076815,
        "sender_full_name": "eddyb",
        "timestamp": 1594903178
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"125250\">@Wesley Wiser</span> not if it's done deep inside something else</p>",
        "id": 204076826,
        "sender_full_name": "eddyb",
        "timestamp": 1594903187
    },
    {
        "content": "<p>Fair enough</p>",
        "id": 204076839,
        "sender_full_name": "Wesley Wiser",
        "timestamp": 1594903195
    },
    {
        "content": "<p>I know nothing about rustdoc <span aria-label=\"laughing\" class=\"emoji emoji-1f606\" role=\"img\" title=\"laughing\">:laughing:</span></p>",
        "id": 204076896,
        "sender_full_name": "Wesley Wiser",
        "timestamp": 1594903208
    },
    {
        "content": "<p>anyway use <code>crox</code> then look at it :P</p>",
        "id": 204076900,
        "sender_full_name": "eddyb",
        "timestamp": 1594903211
    },
    {
        "content": "<p>should be easy to spot given how much cumulative time it takes</p>",
        "id": 204076931,
        "sender_full_name": "eddyb",
        "timestamp": 1594903232
    },
    {
        "content": "<p>I keep forgetting how useful the visual intuition is</p>",
        "id": 204076940,
        "sender_full_name": "eddyb",
        "timestamp": 1594903239
    },
    {
        "content": "<p>just wish I could e.g. color some stuff dynamically, to see it better</p>",
        "id": 204076955,
        "sender_full_name": "eddyb",
        "timestamp": 1594903248
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"119009\">eddyb</span> <a href=\"#narrow/stream/247081-t-compiler.2Fperformance/topic/everybody_loops.20perf.20is.20in/near/204076815\">said</a>:</p>\n<blockquote>\n<p>from what <span class=\"user-mention silent\" data-user-id=\"232545\">Joshua Nelson</span> was pasting I think <code>rustdoc</code> already tracks per-pass times? (in the sense of \"rustdoc pass\"). and each pass has a name</p>\n</blockquote>\n<p>no, sorry, I just added that</p>",
        "id": 204077875,
        "sender_full_name": "Joshua Nelson",
        "timestamp": 1594903769
    },
    {
        "content": "<p>forgot to push my changes, let me finish <a href=\"http://docs.rs\">docs.rs</a> things</p>",
        "id": 204077889,
        "sender_full_name": "Joshua Nelson",
        "timestamp": 1594903777
    },
    {
        "content": "<p>oh</p>",
        "id": 204077899,
        "sender_full_name": "eddyb",
        "timestamp": 1594903781
    },
    {
        "content": "<p>it looked like you found it, oops</p>",
        "id": 204077926,
        "sender_full_name": "eddyb",
        "timestamp": 1594903793
    },
    {
        "content": "<p>each pass does have a name though which makes things easier</p>",
        "id": 204077932,
        "sender_full_name": "Joshua Nelson",
        "timestamp": 1594903797
    },
    {
        "content": "<p>can you check if any are empty?</p>",
        "id": 204077985,
        "sender_full_name": "eddyb",
        "timestamp": 1594903807
    },
    {
        "content": "<p>not right now but it would be somewhere near <code>librustdoc/passes/mod.rs</code></p>",
        "id": 204078024,
        "sender_full_name": "Joshua Nelson",
        "timestamp": 1594903839
    },
    {
        "content": "<p>all of them look to be non-empty to me</p>",
        "id": 204079164,
        "sender_full_name": "Joshua Nelson",
        "timestamp": 1594904436
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"119009\">@eddyb</span> do you want timing info in everybody_loops or a follow-up PR?</p>",
        "id": 204079490,
        "sender_full_name": "Joshua Nelson",
        "timestamp": 1594904590
    },
    {
        "content": "<p>since we plan to merge either way</p>",
        "id": 204079497,
        "sender_full_name": "Joshua Nelson",
        "timestamp": 1594904595
    },
    {
        "content": "<p>oh you can just merge the PR</p>",
        "id": 204079572,
        "sender_full_name": "eddyb",
        "timestamp": 1594904635
    },
    {
        "content": "<p>let me get rid of lazy_Static first</p>",
        "id": 204079633,
        "sender_full_name": "Joshua Nelson",
        "timestamp": 1594904648
    },
    {
        "content": "<p>ok done :)</p>",
        "id": 204079687,
        "sender_full_name": "Joshua Nelson",
        "timestamp": 1594904682
    },
    {
        "content": "<p>oh wait I think <span class=\"user-mention\" data-user-id=\"210316\">@GuillaumeGomez</span> wanted to wait for ollie</p>",
        "id": 204079765,
        "sender_full_name": "Joshua Nelson",
        "timestamp": 1594904726
    },
    {
        "content": "<p>Try pinging them again. They were around yesterday. :)</p>",
        "id": 204079889,
        "sender_full_name": "GuillaumeGomez",
        "timestamp": 1594904793
    },
    {
        "content": "<p>And more generally, if you can, use <code>once_cell</code> instead of <code>lazy_static</code></p>",
        "id": 204079990,
        "sender_full_name": "GuillaumeGomez",
        "timestamp": 1594904848
    },
    {
        "content": "<p>yes, I ended up using once_cell in rustc_interface instead of rustdoc</p>",
        "id": 204080132,
        "sender_full_name": "Joshua Nelson",
        "timestamp": 1594904919
    },
    {
        "content": "<p>ok I pinged them :)</p>",
        "id": 204080540,
        "sender_full_name": "Joshua Nelson",
        "timestamp": 1594905103
    }
]