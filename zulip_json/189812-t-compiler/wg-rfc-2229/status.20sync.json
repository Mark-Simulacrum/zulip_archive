[
    {
        "content": "<p>Hey <span class=\"user-group-mention\" data-user-group-id=\"1175\">@WG-rfc-2229</span> -- sorry that I've been missing meetings lately. Things have been quite busy at work. I'd kind of like to get a dump of where you all are at and how I can help.</p>",
        "id": 240606825,
        "sender_full_name": "nikomatsakis",
        "timestamp": 1622209988
    },
    {
        "content": "<p>I think that <span class=\"user-mention\" data-user-id=\"281950\">@Aman Arora</span>, you're kind of stuck figuring out how to gather more data about the sizes of closures?</p>",
        "id": 240606867,
        "sender_full_name": "nikomatsakis",
        "timestamp": 1622210011
    },
    {
        "content": "<p>Yes, I'd like some help figuring out how the deal with generics and an error that I'm seeing while trying to compute the size.</p>\n<p>At least how I understand it, I'd have to change quite a bit of how the data is pipelined across to make generics work</p>",
        "id": 240633677,
        "sender_full_name": "Aman Arora",
        "timestamp": 1622221901
    },
    {
        "content": "<p>bother</p>",
        "id": 240635941,
        "sender_full_name": "nikomatsakis",
        "timestamp": 1622222929
    },
    {
        "content": "<p>I have done a lot of work since our last sync apart from PR  85724</p>",
        "id": 240642572,
        "sender_full_name": "rocksand",
        "timestamp": 1622226156
    },
    {
        "content": "<p>However, I was wondering whether some of the blog post content should be moved to the rust-reference or the edition-guide or both? I saw that you tagged us on a edition-guide issues, but I also remember you mentioning the edition-guide a few weeks ago</p>",
        "id": 240642792,
        "sender_full_name": "rocksand",
        "timestamp": 1622226267
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"116009\">@nikomatsakis</span>  should be reschedule our meeting time if some other times works better?</p>",
        "id": 241074760,
        "sender_full_name": "Aman Arora",
        "timestamp": 1622581147
    },
    {
        "content": "<p>I think this week it works ok</p>",
        "id": 241075466,
        "sender_full_name": "nikomatsakis",
        "timestamp": 1622581487
    },
    {
        "content": "<p>next week I'm pretty busy but can find a time if needd</p>",
        "id": 241075483,
        "sender_full_name": "nikomatsakis",
        "timestamp": 1622581498
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"307184\">@rocksand</span> is there a need for a test on <a href=\"https://github.com/rust-lang/rust/issues/85724\">#85724</a> ?</p>",
        "id": 241075730,
        "sender_full_name": "nikomatsakis",
        "timestamp": 1622581624
    },
    {
        "content": "<p>or did <a href=\"https://github.com/rust-lang/rust/pull/82536/\">https://github.com/rust-lang/rust/pull/82536/</a> already add it?</p>",
        "id": 241075738,
        "sender_full_name": "nikomatsakis",
        "timestamp": 1622581630
    },
    {
        "content": "<p>er, <a href=\"https://github.com/rust-lang/rust/pull/85564\">https://github.com/rust-lang/rust/pull/85564</a></p>",
        "id": 241075975,
        "sender_full_name": "nikomatsakis",
        "timestamp": 1622581736
    },
    {
        "content": "<p>OK, I see it does have a regression test</p>",
        "id": 241076003,
        "sender_full_name": "nikomatsakis",
        "timestamp": 1622581750
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"116009\">@nikomatsakis</span>  Yes, <a href=\"https://github.com/rust-lang/rust/issues/82536\">#82536</a> already added it, but if you think there needs more test cases let me know</p>",
        "id": 241076231,
        "sender_full_name": "rocksand",
        "timestamp": 1622581873
    },
    {
        "content": "<p>nvm, I just saw you approved it</p>",
        "id": 241076263,
        "sender_full_name": "rocksand",
        "timestamp": 1622581894
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"307184\">rocksand</span> <a href=\"#narrow/stream/189812-t-compiler.2Fwg-rfc-2229/topic/status.20sync/near/240642792\">said</a>:</p>\n<blockquote>\n<p>However, I was wondering whether some of the blog post content should be moved to the rust-reference or the edition-guide or both? I saw that you tagged us on a edition-guide issues, but I also remember you mentioning the edition-guide a few weeks ago</p>\n</blockquote>\n<p><span class=\"user-mention\" data-user-id=\"116009\">@nikomatsakis</span>  Also, I was still wondering what I should be adding to the edition-guide versus the rust reference...</p>",
        "id": 241076440,
        "sender_full_name": "rocksand",
        "timestamp": 1622581978
    },
    {
        "content": "<p>Ah yes</p>",
        "id": 241077272,
        "sender_full_name": "nikomatsakis",
        "timestamp": 1622582311
    },
    {
        "content": "<p>It's possible that some material should go both places</p>",
        "id": 241077287,
        "sender_full_name": "nikomatsakis",
        "timestamp": 1622582318
    },
    {
        "content": "<p>The edition guide should contain:</p>",
        "id": 241077306,
        "sender_full_name": "nikomatsakis",
        "timestamp": 1622582327
    },
    {
        "content": "<ul>\n<li>high level overview of the feature (already there, I think)</li>\n</ul>",
        "id": 241077319,
        "sender_full_name": "nikomatsakis",
        "timestamp": 1622582333
    },
    {
        "content": "<ul>\n<li>going over each of the migration scenarios, explaining what is happening</li>\n</ul>",
        "id": 241077406,
        "sender_full_name": "nikomatsakis",
        "timestamp": 1622582385
    },
    {
        "content": "<p>The reference may also include the second set of information</p>",
        "id": 241078018,
        "sender_full_name": "nikomatsakis",
        "timestamp": 1622582745
    },
    {
        "content": "<p>That seems like \"part of the language spec\" to my mind</p>",
        "id": 241078021,
        "sender_full_name": "nikomatsakis",
        "timestamp": 1622582756
    },
    {
        "content": "<p>(\"what migration lints apply\")</p>",
        "id": 241078023,
        "sender_full_name": "nikomatsakis",
        "timestamp": 1622582761
    },
    {
        "content": "<p>but I would prioritize putting it in the edition guide</p>",
        "id": 241078070,
        "sender_full_name": "nikomatsakis",
        "timestamp": 1622582772
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"116009\">@nikomatsakis</span>  are we doing zoom or zulip aysnc?</p>",
        "id": 241311784,
        "sender_full_name": "Aman Arora",
        "timestamp": 1622664051
    },
    {
        "content": "<p><a href=\"https://hackmd.io/NzREH22HTFq1kefIFG0XSw?both\">https://hackmd.io/NzREH22HTFq1kefIFG0XSw?both</a></p>",
        "id": 241312077,
        "sender_full_name": "Aman Arora",
        "timestamp": 1622664183
    },
    {
        "content": "<p>Insignficant annotation:</p>\n<ul>\n<li>Do collections because they are mostly freeing memory</li>\n<li>Run lint on compiler</li>\n<li>Go through all Drop impl in stdlib</li>\n<li>drain/into_iter will possibly free memory</li>\n<li>Possibly ping T-LIBS</li>\n</ul>",
        "id": 241313465,
        "sender_full_name": "Aman Arora",
        "timestamp": 1622664866
    },
    {
        "content": "<p>Size optimization:</p>\n<ul>\n<li>Remove trailing derefs if the trailing derefs are on a dyn type</li>\n</ul>",
        "id": 241315052,
        "sender_full_name": "Aman Arora",
        "timestamp": 1622665640
    },
    {
        "content": "<p>So just the profile from <code>x build -i --stage 2</code> is here: <a href=\"https://docs.google.com/spreadsheets/d/1zNWWvTQ9kd0TDraNY_55HFDbHMaBl1NZn8chi30_M4g/edit#gid=845050938\">https://docs.google.com/spreadsheets/d/1zNWWvTQ9kd0TDraNY_55HFDbHMaBl1NZn8chi30_M4g/edit#gid=845050938</a></p>",
        "id": 241508803,
        "sender_full_name": "Aman Arora",
        "timestamp": 1622797811
    },
    {
        "content": "<p>There are two sheets in this one is data the other is a chart with % change</p>",
        "id": 241508834,
        "sender_full_name": "Aman Arora",
        "timestamp": 1622797835
    },
    {
        "content": "<p>actually now that im going though the data, there are some duplicates</p>",
        "id": 241509299,
        "sender_full_name": "Aman Arora",
        "timestamp": 1622798137
    },
    {
        "content": "<p>Is there a reason that we'd call the crete fn_mono_item on the same closure 3 times in a row?</p>",
        "id": 241509456,
        "sender_full_name": "Aman Arora",
        "timestamp": 1622798217
    },
    {
        "content": "<p>eg: this one <a href=\"https://github.com/rust-lang/rust/blob/master/compiler/rustc_expand/src/mbe/macro_rules.rs#L374-L384\">https://github.com/rust-lang/rust/blob/master/compiler/rustc_expand/src/mbe/macro_rules.rs#L374-L384</a></p>",
        "id": 241509643,
        "sender_full_name": "Aman Arora",
        "timestamp": 1622798320
    },
    {
        "content": "<p>or why it's be called 30+ times</p>",
        "id": 241509807,
        "sender_full_name": "Aman Arora",
        "timestamp": 1622798416
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"281950\">Aman Arora</span> <a href=\"#narrow/stream/189812-t-compiler.2Fwg-rfc-2229/topic/status.20sync/near/241509807\">said</a>:</p>\n<blockquote>\n<p>or why it's be called 30+ times</p>\n</blockquote>\n<p>this is because it's in a macro<br>\n<a href=\"https://github.com/rust-lang/rust/blob/master/compiler/rustc_builtin_macros/src/lib.rs#L53-L55\">https://github.com/rust-lang/rust/blob/master/compiler/rustc_builtin_macros/src/lib.rs#L53-L55</a></p>",
        "id": 241510009,
        "sender_full_name": "Aman Arora",
        "timestamp": 1622798535
    },
    {
        "content": "<p>it's certainly worth noting that the number of times we see a closure here doesn't correspond to the number of times it's <em>instantiated</em></p>",
        "id": 241534064,
        "sender_full_name": "nikomatsakis",
        "timestamp": 1622813120
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"281950\">Aman Arora</span> <a href=\"#narrow/stream/189812-t-compiler.2Fwg-rfc-2229/topic/status.20sync/near/241508803\">said</a>:</p>\n<blockquote>\n<p>So just the profile from <code>x build -i --stage 2</code> is here: <a href=\"https://docs.google.com/spreadsheets/d/1zNWWvTQ9kd0TDraNY_55HFDbHMaBl1NZn8chi30_M4g/edit#gid=845050938\">https://docs.google.com/spreadsheets/d/1zNWWvTQ9kd0TDraNY_55HFDbHMaBl1NZn8chi30_M4g/edit#gid=845050938</a></p>\n</blockquote>\n<p>I don't have access to this...can you grant to <code>rust@nikomatsakis.com</code> ?</p>",
        "id": 241534109,
        "sender_full_name": "nikomatsakis",
        "timestamp": 1622813144
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"116009\">@nikomatsakis</span>  this should be public now</p>",
        "id": 241571506,
        "sender_full_name": "Aman Arora",
        "timestamp": 1622829247
    },
    {
        "content": "<div class=\"codehilite\" data-code-language=\"Rust\"><pre><span></span><code><span class=\"k\">fn</span> <span class=\"nf\">f</span><span class=\"o\">&lt;</span><span class=\"n\">T</span><span class=\"o\">&gt;</span><span class=\"p\">(</span><span class=\"n\">t</span>: <span class=\"nc\">T</span><span class=\"p\">)</span><span class=\"w\"> </span><span class=\"p\">{</span><span class=\"w\"></span>\n<span class=\"w\">    </span><span class=\"kd\">let</span><span class=\"w\"> </span><span class=\"n\">c</span><span class=\"w\"> </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"o\">||</span><span class=\"w\"> </span><span class=\"n\">t</span><span class=\"p\">;</span><span class=\"w\"></span>\n<span class=\"p\">}</span><span class=\"w\"></span>\n</code></pre></div>\n<p>From what I understand for all <code>T</code> used to parameterize <code>f</code>, c will have the same def_id, right?</p>",
        "id": 241571743,
        "sender_full_name": "Aman Arora",
        "timestamp": 1622829365
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"281950\">@Aman Arora</span> yes</p>",
        "id": 241575211,
        "sender_full_name": "nikomatsakis",
        "timestamp": 1622831176
    },
    {
        "content": "<p>what is this charting?</p>",
        "id": 241575315,
        "sender_full_name": "nikomatsakis",
        "timestamp": 1622831247
    },
    {
        "content": "<p>I was trying to sort by change</p>",
        "id": 241575318,
        "sender_full_name": "nikomatsakis",
        "timestamp": 1622831251
    },
    {
        "content": "<p>I'm trying to figure out how to reduce this into a useful number :)</p>",
        "id": 241575341,
        "sender_full_name": "nikomatsakis",
        "timestamp": 1622831259
    },
    {
        "content": "<p>7024    120 Real(Named(\"compiler/rustc_interface/src/passes.rs\")) \"Some(LineInfo { line_index: 115  start_col: CharPos(48)  end_col: CharPos(74) }) Some(LineInfo { line_index: 139 start_col: CharPos(0)   end_col: CharPos(5) })\"     -6904   -98.29157175</p>",
        "id": 241575357,
        "sender_full_name": "nikomatsakis",
        "timestamp": 1622831266
    },
    {
        "content": "<p>The chart is %change</p>",
        "id": 241575360,
        "sender_full_name": "Aman Arora",
        "timestamp": 1622831267
    },
    {
        "content": "<p>that's kind of amazing :)</p>",
        "id": 241575364,
        "sender_full_name": "nikomatsakis",
        "timestamp": 1622831269
    },
    {
        "content": "<p>I want to have a figure like \"N% of closures stayed the same size or got smaller\"</p>",
        "id": 241575434,
        "sender_full_name": "nikomatsakis",
        "timestamp": 1622831288
    },
    {
        "content": "<p>okay one sec</p>",
        "id": 241575451,
        "sender_full_name": "Aman Arora",
        "timestamp": 1622831301
    },
    {
        "content": "<p>it looks like 20425 stayed the same</p>",
        "id": 241575487,
        "sender_full_name": "nikomatsakis",
        "timestamp": 1622831321
    },
    {
        "content": "<p>out of 21261</p>",
        "id": 241575494,
        "sender_full_name": "nikomatsakis",
        "timestamp": 1622831325
    },
    {
        "content": "<p>96%</p>",
        "id": 241575525,
        "sender_full_name": "nikomatsakis",
        "timestamp": 1622831343
    },
    {
        "content": "<p>Average is 0.03 bytes growth</p>",
        "id": 241575560,
        "sender_full_name": "nikomatsakis",
        "timestamp": 1622831366
    },
    {
        "content": "<p>the average growth <em>if things grow</em> is 9 bytes</p>",
        "id": 241575637,
        "sender_full_name": "nikomatsakis",
        "timestamp": 1622831403
    },
    {
        "content": "<p>132 grew by more than 8 bytes</p>",
        "id": 241575679,
        "sender_full_name": "nikomatsakis",
        "timestamp": 1622831430
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"116009\">nikomatsakis</span> <a href=\"#narrow/stream/189812-t-compiler.2Fwg-rfc-2229/topic/status.20sync/near/241575494\">said</a>:</p>\n<blockquote>\n<p>out of 21261</p>\n</blockquote>\n<p>Weirdly enough the chart gices a different impression</p>",
        "id": 241575759,
        "sender_full_name": "Aman Arora",
        "timestamp": 1622831475
    },
    {
        "content": "<p>yes the chart is kind of misleading I think</p>",
        "id": 241575789,
        "sender_full_name": "nikomatsakis",
        "timestamp": 1622831495
    },
    {
        "content": "<p>I'm trying to figure out how to make a historgram</p>",
        "id": 241575877,
        "sender_full_name": "nikomatsakis",
        "timestamp": 1622831524
    },
    {
        "content": "<p>I can try one min</p>",
        "id": 241575913,
        "sender_full_name": "Aman Arora",
        "timestamp": 1622831543
    },
    {
        "content": "<p>from column I</p>",
        "id": 241575939,
        "sender_full_name": "nikomatsakis",
        "timestamp": 1622831554
    },
    {
        "content": "<p>I think what i <em>really</em> want to see though</p>",
        "id": 241575957,
        "sender_full_name": "nikomatsakis",
        "timestamp": 1622831563
    },
    {
        "content": "<p>\"is an additive histogram\"... e.g., \"how many are this size or smaller\"?</p>",
        "id": 241575992,
        "sender_full_name": "nikomatsakis",
        "timestamp": 1622831582
    },
    {
        "content": "<p>not sure though :)</p>",
        "id": 241576000,
        "sender_full_name": "nikomatsakis",
        "timestamp": 1622831585
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"281950\">@Aman Arora</span> I think part of why the chart looks bad is the %change</p>",
        "id": 241576036,
        "sender_full_name": "nikomatsakis",
        "timestamp": 1622831603
    },
    {
        "content": "<p>although the average % is only 3%</p>",
        "id": 241576060,
        "sender_full_name": "nikomatsakis",
        "timestamp": 1622831617
    },
    {
        "content": "<p>but things like 8 bytes growth from an 8 byte closure...</p>",
        "id": 241576089,
        "sender_full_name": "nikomatsakis",
        "timestamp": 1622831628
    },
    {
        "content": "<p>but when you look at the average size of a closure before and after you get:</p>",
        "id": 241576181,
        "sender_full_name": "nikomatsakis",
        "timestamp": 1622831660
    },
    {
        "content": "<ul>\n<li>Before: 12.24 bytes</li>\n</ul>",
        "id": 241576197,
        "sender_full_name": "nikomatsakis",
        "timestamp": 1622831671
    },
    {
        "content": "<ul>\n<li>After: 12.28 bytes</li>\n</ul>",
        "id": 241576203,
        "sender_full_name": "nikomatsakis",
        "timestamp": 1622831679
    },
    {
        "content": "<p>the worst case is \"grew by 120 bytes\"</p>",
        "id": 241576227,
        "sender_full_name": "nikomatsakis",
        "timestamp": 1622831691
    },
    {
        "content": "<p>but the best case is 'got smaller by 6904 bytes\" lol</p>",
        "id": 241576250,
        "sender_full_name": "nikomatsakis",
        "timestamp": 1622831709
    },
    {
        "content": "<p>SO there are two closures which are 2000bytes + in size that were barely affected</p>",
        "id": 241576265,
        "sender_full_name": "Aman Arora",
        "timestamp": 1622831716
    },
    {
        "content": "<p>I'm wondering what impact does that have on these averages</p>",
        "id": 241576292,
        "sender_full_name": "Aman Arora",
        "timestamp": 1622831732
    },
    {
        "content": "<p>They are near the bottom from rustdoc i have highlighted them in orange</p>",
        "id": 241576326,
        "sender_full_name": "Aman Arora",
        "timestamp": 1622831751
    },
    {
        "content": "<p>you could make an average from \"Small closures\" (&lt;16 btes) etc?</p>",
        "id": 241576407,
        "sender_full_name": "nikomatsakis",
        "timestamp": 1622831772
    },
    {
        "content": "<p>can you give <a href=\"mailto:rust@nikomatsakis.com\">rust@nikomatsakis.com</a> full editing rights?</p>",
        "id": 241576455,
        "sender_full_name": "nikomatsakis",
        "timestamp": 1622831806
    },
    {
        "content": "<p>i can add a filter</p>",
        "id": 241576459,
        "sender_full_name": "Aman Arora",
        "timestamp": 1622831807
    },
    {
        "content": "<p>or maybe I'll download into excel</p>",
        "id": 241576462,
        "sender_full_name": "nikomatsakis",
        "timestamp": 1622831809
    },
    {
        "content": "<p>yes, one sec</p>",
        "id": 241576516,
        "sender_full_name": "Aman Arora",
        "timestamp": 1622831830
    },
    {
        "content": "<p>you should have the edit rights now</p>",
        "id": 241576658,
        "sender_full_name": "Aman Arora",
        "timestamp": 1622831886
    },
    {
        "content": "<p>So I have added a column with number 16 on it, it is change if the original closure size &lt;= 16</p>",
        "id": 241576936,
        "sender_full_name": "Aman Arora",
        "timestamp": 1622832035
    },
    {
        "content": "<p>you can change 16 to whatever number, highlight the data and in the bottom good drive shows Sum/aggregate information</p>",
        "id": 241576977,
        "sender_full_name": "Aman Arora",
        "timestamp": 1622832058
    },
    {
        "content": "<p>for 16 bytes avg change is 0.26</p>",
        "id": 241577004,
        "sender_full_name": "Aman Arora",
        "timestamp": 1622832074
    },
    {
        "content": "<p>for considering closures upto 64 byes, avg change is 0.37</p>",
        "id": 241577067,
        "sender_full_name": "Aman Arora",
        "timestamp": 1622832107
    },
    {
        "content": "<p>and the change is 0.36 bytes even if I increase the number to 256</p>",
        "id": 241577155,
        "sender_full_name": "Aman Arora",
        "timestamp": 1622832135
    },
    {
        "content": "<p>I made some interesting charts here locally</p>",
        "id": 241577359,
        "sender_full_name": "nikomatsakis",
        "timestamp": 1622832252
    },
    {
        "content": "<p>let me show you</p>",
        "id": 241577365,
        "sender_full_name": "nikomatsakis",
        "timestamp": 1622832254
    },
    {
        "content": "<p>ok take a look at the Growth by closure size tab</p>",
        "id": 241577514,
        "sender_full_name": "nikomatsakis",
        "timestamp": 1622832346
    },
    {
        "content": "<p>Avg growth isn't bad at all</p>",
        "id": 241577666,
        "sender_full_name": "Aman Arora",
        "timestamp": 1622832411
    },
    {
        "content": "<p>nope</p>",
        "id": 241577757,
        "sender_full_name": "nikomatsakis",
        "timestamp": 1622832471
    },
    {
        "content": "<p>to me these stats look ... fine</p>",
        "id": 241577766,
        "sender_full_name": "nikomatsakis",
        "timestamp": 1622832477
    },
    {
        "content": "<p>I think it still might be good idea to collect some information from outside the compiler</p>",
        "id": 241577956,
        "sender_full_name": "Aman Arora",
        "timestamp": 1622832585
    },
    {
        "content": "<p>I'll run cargo again</p>",
        "id": 241577967,
        "sender_full_name": "Aman Arora",
        "timestamp": 1622832593
    },
    {
        "content": "<p>And we should probably discuss what kind of artifact we should be generating, if say -Zprofile-closure-size is passed to the compiler</p>",
        "id": 241578066,
        "sender_full_name": "Aman Arora",
        "timestamp": 1622832635
    },
    {
        "content": "<p>because right now i just println!() the relevant information</p>",
        "id": 241578093,
        "sender_full_name": "Aman Arora",
        "timestamp": 1622832649
    },
    {
        "content": "<p>I think <code>println!</code> is...probalby ok :)</p>",
        "id": 241578374,
        "sender_full_name": "nikomatsakis",
        "timestamp": 1622832800
    },
    {
        "content": "<p>dumping to a file is prob a bit better</p>",
        "id": 241578386,
        "sender_full_name": "nikomatsakis",
        "timestamp": 1622832805
    },
    {
        "content": "<p>but yes gathering more data is always good</p>",
        "id": 241578409,
        "sender_full_name": "nikomatsakis",
        "timestamp": 1622832820
    },
    {
        "content": "<p>Yes, I was thinking taking hints from -Zself-profile or how measureme works</p>",
        "id": 241578418,
        "sender_full_name": "Aman Arora",
        "timestamp": 1622832825
    },
    {
        "content": "<p>and we should be able to clone the spreadsheet to get a similar analysis</p>",
        "id": 241578421,
        "sender_full_name": "nikomatsakis",
        "timestamp": 1622832826
    },
    {
        "content": "<p>Yes, I also don't think based on the data we have we should be adding optimization overhead to the compiler just yet</p>",
        "id": 241578520,
        "sender_full_name": "Aman Arora",
        "timestamp": 1622832867
    },
    {
        "content": "<p>it would be interesting to look at some of the cases that grew by a lot =</p>",
        "id": 241578555,
        "sender_full_name": "nikomatsakis",
        "timestamp": 1622832888
    },
    {
        "content": "<p>Yes, I'll take time and look at the &gt;=200% cases. I'm also interested to see the 2k byte closures in rustdoc</p>",
        "id": 241578624,
        "sender_full_name": "Aman Arora",
        "timestamp": 1622832928
    },
    {
        "content": "<p>Though optimizing that's outside of 2229</p>",
        "id": 241578648,
        "sender_full_name": "Aman Arora",
        "timestamp": 1622832945
    },
    {
        "content": "<p>yes</p>",
        "id": 241578718,
        "sender_full_name": "nikomatsakis",
        "timestamp": 1622832964
    },
    {
        "content": "<p>So there is somewhat a privacy concern because when any pkg from the cargo, it dumps the home folder and therefore user's userid. </p>\n<p>eg: Real(Named(\"/users/a52arora/.cargo/registry/src/github.com-1ecc6299db9ec823/miniz_oxide-0.4.0/src/deflate/core.rs\")) \"Some(LineInfo { line_index: 1075</p>",
        "id": 241649875,
        "sender_full_name": "Aman Arora",
        "timestamp": 1622917564
    },
    {
        "content": "<p>That's a good callout -- we can either make folks aware of that or try to anonymize the data somehow</p>",
        "id": 242036723,
        "sender_full_name": "nikomatsakis",
        "timestamp": 1623230061
    },
    {
        "content": "<p>if we have them upload the data via a google form, we could promise not to release the details</p>",
        "id": 242036743,
        "sender_full_name": "nikomatsakis",
        "timestamp": 1623230076
    },
    {
        "content": "<p>btw, <span class=\"user-mention\" data-user-id=\"281950\">@Aman Arora</span> / <span class=\"user-mention\" data-user-id=\"307184\">@rocksand</span>, I can't make a meeting today</p>",
        "id": 242036770,
        "sender_full_name": "nikomatsakis",
        "timestamp": 1623230100
    },
    {
        "content": "<p>I was thinking something like -Zprofile-closures=nocollect</p>",
        "id": 242037014,
        "sender_full_name": "Aman Arora",
        "timestamp": 1623230241
    },
    {
        "content": "<p>I went through couple of the increase in closure size, all of them come from the fact that certain parts of a strict are captured individually now</p>",
        "id": 242037344,
        "sender_full_name": "Aman Arora",
        "timestamp": 1623230425
    },
    {
        "content": "<p>Most of these cases had the closure only capture some and not all of the fields</p>",
        "id": 242037441,
        "sender_full_name": "Aman Arora",
        "timestamp": 1623230492
    },
    {
        "content": "<p>So the optimization we had discussed wouldn't quite work</p>",
        "id": 242037455,
        "sender_full_name": "Aman Arora",
        "timestamp": 1623230504
    },
    {
        "content": "<p>One interesting possibility though is if we have an immutable ref, then any precise path starting at that would also be an immutable ref and therefore we should be able to capture that ref on its own</p>",
        "id": 242037584,
        "sender_full_name": "Aman Arora",
        "timestamp": 1623230568
    },
    {
        "content": "<p>This can be especially useful when we consider methods on a struct and &amp;self is partially my captured by the closure</p>",
        "id": 242037658,
        "sender_full_name": "Aman Arora",
        "timestamp": 1623230617
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"116009\">nikomatsakis</span> <a href=\"#narrow/stream/189812-t-compiler.2Fwg-rfc-2229/topic/status.20sync/near/242036743\">said</a>:</p>\n<blockquote>\n<p>if we have them upload the data via a google form, we could promise not to release the details</p>\n</blockquote>\n<p>Not sure how this will work tbh</p>",
        "id": 242039489,
        "sender_full_name": "Aman Arora",
        "timestamp": 1623231681
    },
    {
        "content": "<p>I was expcting them to upload a csv somewhere, but not sure where</p>",
        "id": 242040138,
        "sender_full_name": "Aman Arora",
        "timestamp": 1623232086
    }
]