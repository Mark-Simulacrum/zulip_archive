[
    {
        "content": "<p>Hi <span class=\"user-mention\" data-user-id=\"121055\">@Pietro Albini</span> <span class=\"user-mention\" data-user-id=\"116122\">@simulacrum</span> I have a question about the website \"<a href=\"http://doc.rust-lang.org/std\">doc.rust-lang.org/std</a>\": how are the static assets deployed?<br>\nI'd like to understand the workflow that generates and deploy those files on the CDN. I was thinking about adding a small feature to the rust documentation (feature open to discussion, of course), a <a href=\"#narrow/stream/266220-rustdoc/topic/Adding.20API.20for.20OpenSearch\">custom search</a></p>\n<p>(I guess this is more a <code>T-infra</code> question, but I believe that stream is not public)</p>",
        "id": 227914246,
        "sender_full_name": "apiraino",
        "timestamp": 1614338853
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"250987\">@apiraino</span> <code>t-infra</code> is public. <a href=\"#narrow/stream/242791-t-infra\">https://rust-lang.zulipchat.com/#narrow/stream/242791-t-infra</a></p>",
        "id": 227914592,
        "sender_full_name": "XAMPPRocky",
        "timestamp": 1614339038
    },
    {
        "content": "<p>oh that's funny. I couldn't filter it from the zulip stream search :)<br>\nthanks</p>",
        "id": 227915206,
        "sender_full_name": "apiraino",
        "timestamp": 1614339409
    },
    {
        "content": "<p>This topic was moved here from <a class=\"stream-topic\" data-stream-id=\"241545\" href=\"/#narrow/stream/241545-t-release/topic/Question.20about.20.22doc.2Erust-lang.2Eorg.2Fstd.22\">#t-release &gt; Question about \"doc.rust-lang.org/std\"</a> by <span class=\"user-mention silent\" data-user-id=\"121055\">Pietro Albini</span></p>",
        "id": 227915410,
        "sender_full_name": "Notification Bot",
        "timestamp": 1614339536
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"250987\">@apiraino</span> the deployment is a <code>tar xf</code> followed by a <code>aws s3 cp --recursive</code> of the <code>rust-docs</code> tarball</p>",
        "id": 227915450,
        "sender_full_name": "Pietro Albini",
        "timestamp": 1614339576
    },
    {
        "content": "<p>so if you change the contents of the tarball to include what you want they'll get deployed</p>",
        "id": 227915474,
        "sender_full_name": "Pietro Albini",
        "timestamp": 1614339598
    },
    {
        "content": "<p>ah thanks <span class=\"user-mention\" data-user-id=\"121055\">@Pietro Albini</span>, now <a href=\"https://static.rust-lang.org/dist/2021-02-26\">I see the tarballs</a>. How are the assets of <a href=\"http://doc.rust-lang.org\">doc.rust-lang.org</a> generated? How is that tarball generated? By the nightly CD run, right?</p>",
        "id": 227915907,
        "sender_full_name": "apiraino",
        "timestamp": 1614339809
    },
    {
        "content": "<p>in general the release process is a glorified copy/paste</p>",
        "id": 227915940,
        "sender_full_name": "Pietro Albini",
        "timestamp": 1614339836
    },
    {
        "content": "<p>the tarballs are generated by rust-lang/rust's bors CI</p>",
        "id": 227916005,
        "sender_full_name": "Pietro Albini",
        "timestamp": 1614339854
    },
    {
        "content": "<p>and all the tarballs for all the commits are uploaded to <a href=\"http://ci-artifacts.rust-lang.org/rustc-builds/{hash}\">ci-artifacts.rust-lang.org/rustc-builds/{hash}</a></p>",
        "id": 227916042,
        "sender_full_name": "Pietro Albini",
        "timestamp": 1614339878
    },
    {
        "content": "<p>so IIUC if I wanted to add a new static asset <em>and</em> a parameter when running the rustdoc generation that should be the place</p>",
        "id": 227916046,
        "sender_full_name": "apiraino",
        "timestamp": 1614339878
    },
    {
        "content": "<p>then the release process grabs the last commit available on <a href=\"http://ci-artifacts.rust-lang.org\">ci-artifacts.rust-lang.org</a>, signs it and uploads it to <a href=\"http://static.rust-lang.org\">static.rust-lang.org</a></p>",
        "id": 227916083,
        "sender_full_name": "Pietro Albini",
        "timestamp": 1614339906
    },
    {
        "content": "<p>so you need to tweak stuff in the rust-lang/rust repo</p>",
        "id": 227916111,
        "sender_full_name": "Pietro Albini",
        "timestamp": 1614339919
    },
    {
        "content": "<p>(exactly where depends on what you wanna change)</p>",
        "id": 227916118,
        "sender_full_name": "Pietro Albini",
        "timestamp": 1614339925
    },
    {
        "content": "<p>I see. thanks a lot for the overview. I'll check more closely the bits that you  mentioned and be back with more questions :)</p>",
        "id": 227916243,
        "sender_full_name": "apiraino",
        "timestamp": 1614339990
    },
    {
        "content": "<p>just to be clear the idea was to add two static files to the root of <a href=\"http://doc.rust-lang.org\">doc.rust-lang.org</a> and patch the <code>index.html</code> of the rustdoc documentation and I wanted to figure out 1) the process to do that and 2) submit a patch for evaluation</p>",
        "id": 227916346,
        "sender_full_name": "apiraino",
        "timestamp": 1614340067
    }
]