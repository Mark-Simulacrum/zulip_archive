[
    {
        "content": "<p>Vivian and I are a bit sick today, so Iâ€™ll be slow to respond.</p>",
        "id": 258988203,
        "sender_full_name": "Jake Goulding",
        "timestamp": 1635180987
    },
    {
        "content": "<p><span class=\"user-group-mention\" data-user-group-id=\"2943\">@T-infra</span> T--2min</p>",
        "id": 258988438,
        "sender_full_name": "Pietro Albini",
        "timestamp": 1635181128
    },
    {
        "content": "<p><span class=\"user-group-mention\" data-user-group-id=\"2943\">@T-infra</span> meeting time!</p>",
        "id": 258988711,
        "sender_full_name": "Pietro Albini",
        "timestamp": 1635181213
    },
    {
        "content": "<p>o/</p>",
        "id": 258988877,
        "sender_full_name": "simulacrum",
        "timestamp": 1635181288
    },
    {
        "content": "<p>let's start!</p>",
        "id": 258989124,
        "sender_full_name": "Pietro Albini",
        "timestamp": 1635181389
    },
    {
        "content": "<p>there are no issues for us to look at</p>",
        "id": 258989136,
        "sender_full_name": "Pietro Albini",
        "timestamp": 1635181396
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"116122\">@simulacrum</span> \"Delete azure pipelines pipelines associated with rust-lang/rust?\"</p>",
        "id": 258989158,
        "sender_full_name": "Pietro Albini",
        "timestamp": 1635181407
    },
    {
        "content": "<p>Yeah</p>",
        "id": 258989233,
        "sender_full_name": "simulacrum",
        "timestamp": 1635181442
    },
    {
        "content": "<p>seems fine to me</p>",
        "id": 258989287,
        "sender_full_name": "Pietro Albini",
        "timestamp": 1635181447
    },
    {
        "content": "<p>Ok, I can go ahead and do it</p>",
        "id": 258989387,
        "sender_full_name": "simulacrum",
        "timestamp": 1635181478
    },
    {
        "content": "<p><span aria-label=\"thumbs up\" class=\"emoji emoji-1f44d\" role=\"img\" title=\"thumbs up\">:thumbs_up:</span>.</p>",
        "id": 258989406,
        "sender_full_name": "Pietro Albini",
        "timestamp": 1635181484
    },
    {
        "content": "<p>ok, moving onto the next topic</p>",
        "id": 258989467,
        "sender_full_name": "Pietro Albini",
        "timestamp": 1635181509
    },
    {
        "content": "<blockquote>\n<p>sccache maintenance strategy</p>\n</blockquote>\n<p><span class=\"user-mention\" data-user-id=\"116122\">@simulacrum</span> too</p>",
        "id": 258989486,
        "sender_full_name": "Pietro Albini",
        "timestamp": 1635181519
    },
    {
        "content": "<p>Yeah</p>",
        "id": 258989523,
        "sender_full_name": "simulacrum",
        "timestamp": 1635181536
    },
    {
        "content": "<p>So I think there's a link in the doc</p>",
        "id": 258989546,
        "sender_full_name": "simulacrum",
        "timestamp": 1635181546
    },
    {
        "content": "<p><a href=\"https://github.com/mozilla/sccache/pull/952\">https://github.com/mozilla/sccache/pull/952</a></p>",
        "id": 258989621,
        "sender_full_name": "Pietro Albini",
        "timestamp": 1635181566
    },
    {
        "content": "<p>But I noted sccache is pretty loosely maintained, and while it's not an immediate problem, it is already causing our CI to be longer then necessary</p>",
        "id": 258989637,
        "sender_full_name": "simulacrum",
        "timestamp": 1635181572
    },
    {
        "content": "<p>hmm, what are we using sccache for?</p>",
        "id": 258989721,
        "sender_full_name": "Pietro Albini",
        "timestamp": 1635181616
    },
    {
        "content": "<p>(particularly on our pgo'd Linux dist builder, which is building at least one llvm that could otherwise be cached)</p>",
        "id": 258989722,
        "sender_full_name": "simulacrum",
        "timestamp": 1635181616
    },
    {
        "content": "<p>sccache is caching all C/C++ compiler invocations currently across our builders, primarily useful for LLVM</p>",
        "id": 258989791,
        "sender_full_name": "simulacrum",
        "timestamp": 1635181652
    },
    {
        "content": "<p>ok so it's still LLVM-only</p>",
        "id": 258989855,
        "sender_full_name": "Pietro Albini",
        "timestamp": 1635181678
    },
    {
        "content": "<p>hmm</p>",
        "id": 258989858,
        "sender_full_name": "Pietro Albini",
        "timestamp": 1635181679
    },
    {
        "content": "<p>(we pass a debuginfo remap flag which includes the rustc hash for other builds beyond llvm, so it's always a cache miss there unless you retry a build)</p>",
        "id": 258989933,
        "sender_full_name": "simulacrum",
        "timestamp": 1635181700
    },
    {
        "content": "<p>Commit hash that is</p>",
        "id": 258989954,
        "sender_full_name": "simulacrum",
        "timestamp": 1635181712
    },
    {
        "content": "<p>I'd like to suggest we basically have our own copy of upstream for our own usage</p>",
        "id": 258990107,
        "sender_full_name": "simulacrum",
        "timestamp": 1635181779
    },
    {
        "content": "<p>(and probably merge work into it given upstream slowness)</p>",
        "id": 258990137,
        "sender_full_name": "simulacrum",
        "timestamp": 1635181794
    },
    {
        "content": "<p>I'm wondering if it makes sense to use sccache at all for what we need to do: we only need a cache of the full LLVM, and whenever LLVM changes all of it changes, not just some object files</p>",
        "id": 258990209,
        "sender_full_name": "Pietro Albini",
        "timestamp": 1635181813
    },
    {
        "content": "<p>at work we had fairly good success just tarballing <code>build/$target/llvm</code></p>",
        "id": 258990282,
        "sender_full_name": "Pietro Albini",
        "timestamp": 1635181860
    },
    {
        "content": "<p>I'd prefer to avoid more complex shifts like that - we end up needing to basically do much of the same work sccache does for us just on a different granularity, imo, if we want a good solution</p>",
        "id": 258990316,
        "sender_full_name": "simulacrum",
        "timestamp": 1635181872
    },
    {
        "content": "<p>o/</p>",
        "id": 258990531,
        "sender_full_name": "Aidan Hobson Sayers",
        "timestamp": 1635181956
    },
    {
        "content": "<p>I know there's an sccache fork, cachepot</p>",
        "id": 258990646,
        "sender_full_name": "Aidan Hobson Sayers",
        "timestamp": 1635182010
    },
    {
        "content": "<p><a href=\"https://github.com/paritytech/cachepot\">https://github.com/paritytech/cachepot</a></p>",
        "id": 258990677,
        "sender_full_name": "Aidan Hobson Sayers",
        "timestamp": 1635182032
    },
    {
        "content": "<p>Do you know if it supports -fprofile-gen and use flags for clang?</p>",
        "id": 258990877,
        "sender_full_name": "simulacrum",
        "timestamp": 1635182101
    },
    {
        "content": "<p>I'm not opposed to switching to this and/or trying to upstream our work here</p>",
        "id": 258991049,
        "sender_full_name": "simulacrum",
        "timestamp": 1635182178
    },
    {
        "content": "<p>(well, mw's patch adding the PGO support, in particular)</p>",
        "id": 258991081,
        "sender_full_name": "simulacrum",
        "timestamp": 1635182200
    },
    {
        "content": "<p>if we can switch to it that'd be fine, but I'm really wary of maintaining our own sccache fork</p>",
        "id": 258991099,
        "sender_full_name": "Pietro Albini",
        "timestamp": 1635182212
    },
    {
        "content": "<p>if we're considering going down that route I'd vastly prefer just tarballing the build directory</p>",
        "id": 258991125,
        "sender_full_name": "Pietro Albini",
        "timestamp": 1635182232
    },
    {
        "content": "<p>Hm, it seems like the fork maintenance is basically no worse than not doing so (given the lack of maintenance upstream), so I'm a bit confused by that</p>",
        "id": 258991285,
        "sender_full_name": "simulacrum",
        "timestamp": 1635182296
    },
    {
        "content": "<p>And tarballing seems pretty painful to get right comparatively</p>",
        "id": 258991339,
        "sender_full_name": "simulacrum",
        "timestamp": 1635182319
    },
    {
        "content": "<p>But I'm okay investing in tarballing if we prefer that</p>",
        "id": 258991481,
        "sender_full_name": "simulacrum",
        "timestamp": 1635182379
    },
    {
        "content": "<p>I think it's probably about the same effort to get right from a standing start, it's just that sccache already exists and does flag hashing etc already</p>",
        "id": 258991593,
        "sender_full_name": "Aidan Hobson Sayers",
        "timestamp": 1635182413
    },
    {
        "content": "<p>we'd need to roll our own of that, which isn't huge but is a thing</p>",
        "id": 258991643,
        "sender_full_name": "Aidan Hobson Sayers",
        "timestamp": 1635182439
    },
    {
        "content": "<p>Well, our cache key would probably be closer to ./configure argumenta</p>",
        "id": 258991696,
        "sender_full_name": "simulacrum",
        "timestamp": 1635182470
    },
    {
        "content": "<p>(for tarballing I can probably upstream what we did at work (need to check), even though it's not extremely granular -- to detect flag changes we just hash src/bootstrap, config.toml and src/version as a whole)</p>",
        "id": 258991706,
        "sender_full_name": "Pietro Albini",
        "timestamp": 1635182472
    },
    {
        "content": "<p>I think we should first sync up with the people from cachepot</p>",
        "id": 258991788,
        "sender_full_name": "Pietro Albini",
        "timestamp": 1635182513
    },
    {
        "content": "<p>then think about other solutions if that doesn't go forward</p>",
        "id": 258991843,
        "sender_full_name": "Pietro Albini",
        "timestamp": 1635182524
    },
    {
        "content": "<p>I'm happy to file an issue there and see if they'd consider taking the PGO patch</p>",
        "id": 258991871,
        "sender_full_name": "simulacrum",
        "timestamp": 1635182539
    },
    {
        "content": "<p>It's pretty small, tbh</p>",
        "id": 258991904,
        "sender_full_name": "simulacrum",
        "timestamp": 1635182551
    },
    {
        "content": "<p><span aria-label=\"thumbs up\" class=\"emoji emoji-1f44d\" role=\"img\" title=\"thumbs up\">:thumbs_up:</span> .</p>",
        "id": 258991966,
        "sender_full_name": "Pietro Albini",
        "timestamp": 1635182577
    },
    {
        "content": "<p>I'd also ask the more general question about their maintenance policy - are they wanting it to be a community project, or is it primarily for their internal use?</p>",
        "id": 258992000,
        "sender_full_name": "Aidan Hobson Sayers",
        "timestamp": 1635182596
    },
    {
        "content": "<p>I admit I'm still not evaluating the tradeoff the same way you are so I'm a little confused there. But it's not important we immediately resolve that.</p>",
        "id": 258992038,
        "sender_full_name": "simulacrum",
        "timestamp": 1635182616
    },
    {
        "content": "<p>(fwiw, I think sccache style caching for rustc itself is also viable for stage0 compilations which are a good chunk of time on CI)</p>",
        "id": 258992222,
        "sender_full_name": "simulacrum",
        "timestamp": 1635182688
    },
    {
        "content": "<p>And tarballing there seems more annoying</p>",
        "id": 258992246,
        "sender_full_name": "simulacrum",
        "timestamp": 1635182702
    },
    {
        "content": "<p>Which is part of why I'd rather stick to sccache if we can.</p>",
        "id": 258992294,
        "sender_full_name": "simulacrum",
        "timestamp": 1635182723
    },
    {
        "content": "<p>Anyway, that's it for me on this topic</p>",
        "id": 258992357,
        "sender_full_name": "simulacrum",
        "timestamp": 1635182754
    },
    {
        "content": "<p>ok then!</p>",
        "id": 258992448,
        "sender_full_name": "Pietro Albini",
        "timestamp": 1635182777
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"261224\">@triagebot</span> end-meeting</p>",
        "id": 258992458,
        "sender_full_name": "Pietro Albini",
        "timestamp": 1635182783
    },
    {
        "content": "<p>Does anyone have something to bring up?<br>\nReact with <span aria-label=\"working on it\" class=\"emoji emoji-1f6e0\" role=\"img\" title=\"working on it\">:working_on_it:</span> if you have something to say.<br>\nReact with <span aria-label=\"all good\" class=\"emoji emoji-2705\" role=\"img\" title=\"all good\">:all_good:</span> if you're ready to end the meeting.</p>",
        "id": 258992461,
        "sender_full_name": "triagebot",
        "timestamp": 1635182784
    },
    {
        "content": "<p>ok then, have a good day everyone!</p>",
        "id": 258992762,
        "sender_full_name": "Pietro Albini",
        "timestamp": 1635182936
    },
    {
        "content": "<p>\\o</p>",
        "id": 258992765,
        "sender_full_name": "Pietro Albini",
        "timestamp": 1635182937
    },
    {
        "content": "<p>\\o</p>",
        "id": 258992804,
        "sender_full_name": "simulacrum",
        "timestamp": 1635182953
    },
    {
        "content": "<p>\\o</p>",
        "id": 258992989,
        "sender_full_name": "Aidan Hobson Sayers",
        "timestamp": 1635183013
    }
]