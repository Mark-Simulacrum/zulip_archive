[
    {
        "content": "<p>Not much from me today</p>",
        "id": 272719581,
        "sender_full_name": "Jake Goulding",
        "timestamp": 1645466514
    },
    {
        "content": "<p>Just gonna bang on the ansible thing</p>",
        "id": 272719607,
        "sender_full_name": "Jake Goulding",
        "timestamp": 1645466528
    },
    {
        "content": "<p><span class=\"user-group-mention\" data-user-group-id=\"2943\">@T-infra</span> (late) meeting time!</p>",
        "id": 272719818,
        "sender_full_name": "Pietro Albini",
        "timestamp": 1645466689
    },
    {
        "content": "<p>o/</p>",
        "id": 272719820,
        "sender_full_name": "Pietro Albini",
        "timestamp": 1645466690
    },
    {
        "content": "<p>o/</p>",
        "id": 272719866,
        "sender_full_name": "Aidan Hobson Sayers",
        "timestamp": 1645466720
    },
    {
        "content": "<p>o/</p>",
        "id": 272719885,
        "sender_full_name": "simulacrum",
        "timestamp": 1645466744
    },
    {
        "content": "<p>ok so let's start</p>",
        "id": 272719957,
        "sender_full_name": "Pietro Albini",
        "timestamp": 1645466767
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"116122\">@simulacrum</span> with <a href=\"https://github.com/rust-lang/infra-team/issues/45\">https://github.com/rust-lang/infra-team/issues/45</a></p>",
        "id": 272719965,
        "sender_full_name": "Pietro Albini",
        "timestamp": 1645466774
    },
    {
        "content": "<p>last comment there contains my proposal</p>",
        "id": 272719991,
        "sender_full_name": "simulacrum",
        "timestamp": 1645466793
    },
    {
        "content": "<p>sounds good to me, thoughts <span class=\"user-mention\" data-user-id=\"117568\">@Aidan Hobson Sayers</span> <span class=\"user-mention\" data-user-id=\"116155\">@Jake Goulding</span>?</p>",
        "id": 272720072,
        "sender_full_name": "Pietro Albini",
        "timestamp": 1645466845
    },
    {
        "content": "<p>I guess most of the time the chances are the answer is no?</p>",
        "id": 272720169,
        "sender_full_name": "Aidan Hobson Sayers",
        "timestamp": 1645466901
    },
    {
        "content": "<p>new process seems fine - it doesn't strictly improve things, but it's not any worse either</p>",
        "id": 272720194,
        "sender_full_name": "Aidan Hobson Sayers",
        "timestamp": 1645466919
    },
    {
        "content": "<p>(improve things for the people asking - it certainly clears up old issues)</p>",
        "id": 272720206,
        "sender_full_name": "Aidan Hobson Sayers",
        "timestamp": 1645466937
    },
    {
        "content": "<p>I mean I don't think we have the 60 builders cap anymore on the CI side</p>",
        "id": 272720210,
        "sender_full_name": "Pietro Albini",
        "timestamp": 1645466940
    },
    {
        "content": "<p>the only blocker would probably be how easy it is to setup CI for that platforms</p>",
        "id": 272720231,
        "sender_full_name": "Pietro Albini",
        "timestamp": 1645466963
    },
    {
        "content": "<p>the cap is largely not there, yeah, and in many cases the infra answer is roughly 'yes' these days</p>",
        "id": 272720245,
        "sender_full_name": "simulacrum",
        "timestamp": 1645466975
    },
    {
        "content": "<p>most of the more onerous requirements nowadays are on the compiler/libs side</p>",
        "id": 272720262,
        "sender_full_name": "Pietro Albini",
        "timestamp": 1645466987
    },
    {
        "content": "<p>ok, sounds good then</p>",
        "id": 272720388,
        "sender_full_name": "Aidan Hobson Sayers",
        "timestamp": 1645467070
    },
    {
        "content": "<p>if jake is not around now we can wait for his comments async, otherwise this seems to be good to go <span class=\"user-mention\" data-user-id=\"116122\">@simulacrum</span></p>",
        "id": 272720428,
        "sender_full_name": "Pietro Albini",
        "timestamp": 1645467103
    },
    {
        "content": "<p>next up is the playground</p>",
        "id": 272720441,
        "sender_full_name": "Pietro Albini",
        "timestamp": 1645467115
    },
    {
        "content": "<p>there is a ci creds error, but other than that the new instance seems to be deployed without too much trouble</p>",
        "id": 272720498,
        "sender_full_name": "Pietro Albini",
        "timestamp": 1645467142
    },
    {
        "content": "<p>with that we should be ready to go to bump the specs soon, and looking at the timeouts there seems to be a need for that</p>",
        "id": 272720607,
        "sender_full_name": "Pietro Albini",
        "timestamp": 1645467236
    },
    {
        "content": "<p><a href=\"/user_uploads/4715/AnNEyq_3a428dhPTqhbv3Irl/Screenshot-from-2022-02-21-19-14-07.png\">Screenshot-from-2022-02-21-19-14-07.png</a> today's loadavg</p>\n<div class=\"message_inline_image\"><a href=\"/user_uploads/4715/AnNEyq_3a428dhPTqhbv3Irl/Screenshot-from-2022-02-21-19-14-07.png\" title=\"Screenshot-from-2022-02-21-19-14-07.png\"><img src=\"/user_uploads/4715/AnNEyq_3a428dhPTqhbv3Irl/Screenshot-from-2022-02-21-19-14-07.png\"></a></div>",
        "id": 272720660,
        "sender_full_name": "Pietro Albini",
        "timestamp": 1645467259
    },
    {
        "content": "<p>well, the new machine already probably is spec'd better?</p>",
        "id": 272720665,
        "sender_full_name": "simulacrum",
        "timestamp": 1645467262
    },
    {
        "content": "<p>I doubt it it's a nano instance</p>",
        "id": 272720677,
        "sender_full_name": "Pietro Albini",
        "timestamp": 1645467273
    },
    {
        "content": "<p>it's a faster CPU though, the core count is the same and memory is less, but I think memory usage wasn't the problem previously</p>",
        "id": 272720714,
        "sender_full_name": "simulacrum",
        "timestamp": 1645467307
    },
    {
        "content": "<p>honestly I was tempted to go with a compute-optimized instance</p>",
        "id": 272720760,
        "sender_full_name": "Pietro Albini",
        "timestamp": 1645467343
    },
    {
        "content": "<blockquote>\n<p>2.3 GHz Intel Xeon® E5-2686 v4 (Broadwell) processors or 2.4 GHz Intel Xeon® E5-2676 v3 (Haswell) processors</p>\n</blockquote>\n<p>to</p>\n<blockquote>\n<p>AMD EPYC 7000 series processors with an all core turbo clock speed of 2.5 GHz</p>\n</blockquote>",
        "id": 272720763,
        "sender_full_name": "simulacrum",
        "timestamp": 1645467345
    },
    {
        "content": "<p>anyway, I figure we should migrate to this, and now that we have ansible it'll presumably be easier to migrate to other instance types over time</p>",
        "id": 272720836,
        "sender_full_name": "simulacrum",
        "timestamp": 1645467388
    },
    {
        "content": "<p>we just need a 24-48 hour overlap period since DNS takes time to propogate</p>",
        "id": 272720856,
        "sender_full_name": "simulacrum",
        "timestamp": 1645467404
    },
    {
        "content": "<p>I wonder... can we stick the playground behind an application load balancer?</p>",
        "id": 272720907,
        "sender_full_name": "Pietro Albini",
        "timestamp": 1645467456
    },
    {
        "content": "<p>that way we can add/remove/change instances without waiting for dns to propagate</p>",
        "id": 272720923,
        "sender_full_name": "Pietro Albini",
        "timestamp": 1645467469
    },
    {
        "content": "<p>I would prefer to avoid horizontally scaling until we really need to</p>",
        "id": 272720924,
        "sender_full_name": "simulacrum",
        "timestamp": 1645467470
    },
    {
        "content": "<p>but otherwise, sure, seems ok</p>",
        "id": 272720959,
        "sender_full_name": "simulacrum",
        "timestamp": 1645467482
    },
    {
        "content": "<p><span aria-label=\"100\" class=\"emoji emoji-1f4af\" role=\"img\" title=\"100\">:100:</span>, but it also helps with switching instances without dealing with dns</p>",
        "id": 272720980,
        "sender_full_name": "Pietro Albini",
        "timestamp": 1645467491
    },
    {
        "content": "<p>(cloudfront may be an easier lift there, since I think that propagates more quickly)</p>",
        "id": 272720985,
        "sender_full_name": "simulacrum",
        "timestamp": 1645467498
    },
    {
        "content": "<p>alb switch should be practically instantaneous</p>",
        "id": 272720994,
        "sender_full_name": "Pietro Albini",
        "timestamp": 1645467512
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"116122\">simulacrum</span> <a href=\"#narrow/stream/242791-t-infra/topic/meeting.202022-02-21/near/272720924\">said</a>:</p>\n<blockquote>\n<p>I would prefer to avoid horizontally scaling until we really need to</p>\n</blockquote>\n<p>we have a <em>long</em> way until horizontal scalability becomes a necessity</p>",
        "id": 272721012,
        "sender_full_name": "Pietro Albini",
        "timestamp": 1645467526
    },
    {
        "content": "<p>I’ve wondered about horizontal from a cost perspective though</p>",
        "id": 272721039,
        "sender_full_name": "Jake Goulding",
        "timestamp": 1645467550
    },
    {
        "content": "<p>Like, my instance is a nano and it’s ok</p>",
        "id": 272721056,
        "sender_full_name": "Jake Goulding",
        "timestamp": 1645467567
    },
    {
        "content": "<p>10 nanos horizontally..?</p>",
        "id": 272721074,
        "sender_full_name": "Jake Goulding",
        "timestamp": 1645467591
    },
    {
        "content": "<p>that has practically the same cost as a 10x bigger instance on aws</p>",
        "id": 272721137,
        "sender_full_name": "Pietro Albini",
        "timestamp": 1645467611
    },
    {
        "content": "<p>(thankfully <span aria-label=\"sweat smile\" class=\"emoji emoji-1f605\" role=\"img\" title=\"sweat smile\">:sweat_smile:</span>)</p>",
        "id": 272721148,
        "sender_full_name": "Pietro Albini",
        "timestamp": 1645467623
    },
    {
        "content": "<p>yeah, there's no real advantage and a big disadvantage in terms of overhead</p>",
        "id": 272721151,
        "sender_full_name": "simulacrum",
        "timestamp": 1645467626
    },
    {
        "content": "<p>I think if nano doesn't work out a c6a probably makes sense, though there's I think some availability issues (not yet in our default region)</p>",
        "id": 272721211,
        "sender_full_name": "simulacrum",
        "timestamp": 1645467691
    },
    {
        "content": "<p>yeah in our region there's c5a</p>",
        "id": 272721242,
        "sender_full_name": "Pietro Albini",
        "timestamp": 1645467710
    },
    {
        "content": "<p>tbh I'd go straight for that one, it's not like they cost that much compared to the rest of the aws bill</p>",
        "id": 272721293,
        "sender_full_name": "Pietro Albini",
        "timestamp": 1645467727
    },
    {
        "content": "<p>(for playground it may not actually matter which region we are in, FWIW)</p>",
        "id": 272721297,
        "sender_full_name": "simulacrum",
        "timestamp": 1645467728
    },
    {
        "content": "<p>(true but it's also more complexity in the console and terraform <span aria-label=\"sweat smile\" class=\"emoji emoji-1f605\" role=\"img\" title=\"sweat smile\">:sweat_smile:</span>)</p>",
        "id": 272721308,
        "sender_full_name": "Pietro Albini",
        "timestamp": 1645467743
    },
    {
        "content": "<p>c5a is not really much better than t3a, they might actually be the same cpus (just burstable or not), right?</p>",
        "id": 272721357,
        "sender_full_name": "simulacrum",
        "timestamp": 1645467798
    },
    {
        "content": "<p>I think they're actually more powerful</p>",
        "id": 272721376,
        "sender_full_name": "Pietro Albini",
        "timestamp": 1645467822
    },
    {
        "content": "<blockquote>\n<p>2nd generation AMD EPYC 7002 series processors running at frequencies up to 3.3 GHz</p>\n</blockquote>",
        "id": 272721447,
        "sender_full_name": "Pietro Albini",
        "timestamp": 1645467855
    },
    {
        "content": "<p>oh, right, t3a is first-gen ryzen I guess</p>",
        "id": 272721474,
        "sender_full_name": "simulacrum",
        "timestamp": 1645467887
    },
    {
        "content": "<p>I have no objections to going straight for c5a.large ($0.095/hr) vs. t3a ($0.0056/hr)</p>",
        "id": 272721529,
        "sender_full_name": "simulacrum",
        "timestamp": 1645467933
    },
    {
        "content": "<p>sounds good</p>",
        "id": 272721609,
        "sender_full_name": "Pietro Albini",
        "timestamp": 1645467966
    },
    {
        "content": "<p>I guess once <span class=\"user-mention\" data-user-id=\"116155\">@Jake Goulding</span> finishes debugging what's wrong we can go ahead and do the switch</p>",
        "id": 272721657,
        "sender_full_name": "Pietro Albini",
        "timestamp": 1645467990
    },
    {
        "content": "<p>well forgot to close the meeting <span aria-label=\"sweat smile\" class=\"emoji emoji-1f605\" role=\"img\" title=\"sweat smile\">:sweat_smile:</span></p>",
        "id": 272722250,
        "sender_full_name": "Pietro Albini",
        "timestamp": 1645468473
    },
    {
        "content": "<p>have a good week everyone</p>",
        "id": 272722256,
        "sender_full_name": "Pietro Albini",
        "timestamp": 1645468478
    },
    {
        "content": "<p><span aria-label=\"wave\" class=\"emoji emoji-1f44b\" role=\"img\" title=\"wave\">:wave:</span>.</p>",
        "id": 272722260,
        "sender_full_name": "Pietro Albini",
        "timestamp": 1645468479
    },
    {
        "content": "<p>\\o</p>",
        "id": 272722316,
        "sender_full_name": "simulacrum",
        "timestamp": 1645468547
    }
]