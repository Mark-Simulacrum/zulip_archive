[
    {
        "content": "<p>The rustlang/rust:nightly Docker image was previously built by Docker Hub's automated build system, but that is no longer available on their default free tier. It seems like Docker does have some kind of open source program we can potentially use to gain access to it again, or we can instead create a service account and publish from GitHub Actions. <span class=\"user-mention\" data-user-id=\"116122\">@simulacrum</span> do you have a preference here?</p>",
        "id": 248778853,
        "sender_full_name": "Steven Fackler",
        "timestamp": 1628441552
    },
    {
        "content": "<p>Generally speaking I think I would lean towards GHA, and we might consider using github's native registry -- that should be simpler credential wise. But if we want to maintain the <a href=\"http://docker.io\">docker.io</a> version shouldn't be a big deal to arrange for the right credentials</p>",
        "id": 248778879,
        "sender_full_name": "simulacrum",
        "timestamp": 1628441610
    },
    {
        "content": "<p>Yeah according to their docs we'd basically just make a new user and add it to the rustlang team. Do you have a preference on the email address to use? <a href=\"mailto:infra@rust-lang.org\">infra@rust-lang.org</a> or something? <a href=\"https://docs.docker.com/docker-hub/service-accounts/#creating-a-new-service-account\">https://docs.docker.com/docker-hub/service-accounts/#creating-a-new-service-account</a></p>",
        "id": 248778931,
        "sender_full_name": "Steven Fackler",
        "timestamp": 1628441666
    },
    {
        "content": "<p>Definitely up to publish to github's registry as well, but I do think we'll want to keep publishing to docker hub</p>",
        "id": 248778940,
        "sender_full_name": "Steven Fackler",
        "timestamp": 1628441700
    },
    {
        "content": "<p>hm</p>",
        "id": 248778958,
        "sender_full_name": "simulacrum",
        "timestamp": 1628441724
    },
    {
        "content": "<p>Could you file an issue on rust-lang/infra-team? I'd like to make sure the credentials end up in our 1pass so can create the account, likely not right this minute though</p>",
        "id": 248778974,
        "sender_full_name": "simulacrum",
        "timestamp": 1628441751
    },
    {
        "content": "<p>Will do!</p>",
        "id": 248779016,
        "sender_full_name": "Steven Fackler",
        "timestamp": 1628441765
    },
    {
        "content": "<p>I'll get the images publishing to the github registry in the meantime since I don't think that should need any extra creds</p>",
        "id": 248779030,
        "sender_full_name": "Steven Fackler",
        "timestamp": 1628441804
    },
    {
        "content": "<p><a href=\"https://github.com/rust-lang/infra-team/issues/48\">https://github.com/rust-lang/infra-team/issues/48</a></p>",
        "id": 248779061,
        "sender_full_name": "Steven Fackler",
        "timestamp": 1628441882
    },
    {
        "content": "<p>seems good</p>",
        "id": 248779101,
        "sender_full_name": "simulacrum",
        "timestamp": 1628441893
    },
    {
        "content": "<p>Oh, it actually seems like we need a GitHub account to publish to their registry as well. Do we already have a GH service account with the correct rights?</p>",
        "id": 248779124,
        "sender_full_name": "Steven Fackler",
        "timestamp": 1628441949
    },
    {
        "content": "<p><a href=\"https://docs.github.com/en/actions/guides/publishing-docker-images#publishing-images-to-github-packages\">https://docs.github.com/en/actions/guides/publishing-docker-images#publishing-images-to-github-packages</a></p>",
        "id": 248779128,
        "sender_full_name": "Steven Fackler",
        "timestamp": 1628441958
    },
    {
        "content": "<p>It looks like you can do the <a href=\"http://github.actor\">github.actor</a> thing?</p>",
        "id": 248780771,
        "sender_full_name": "simulacrum",
        "timestamp": 1628444657
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"243558\">@Steven Fackler</span> <a href=\"https://github.com/rust-lang/crates-build-env/blob/master/.github/workflows/main.yml\">https://github.com/rust-lang/crates-build-env/blob/master/.github/workflows/main.yml</a> could be an example</p>",
        "id": 248780777,
        "sender_full_name": "simulacrum",
        "timestamp": 1628444701
    },
    {
        "content": "<p>Ah! I didn't realize secrets.GITHUB_TOKEN was provided automatically from the environment</p>",
        "id": 248780810,
        "sender_full_name": "Steven Fackler",
        "timestamp": 1628444748
    },
    {
        "content": "<p>yep, it's automatically configured for all github action runs</p>",
        "id": 248780871,
        "sender_full_name": "simulacrum",
        "timestamp": 1628444765
    },
    {
        "content": "<p>woot <a href=\"https://github.com/rust-lang/docker-rust-nightly/pkgs/container/rust\">https://github.com/rust-lang/docker-rust-nightly/pkgs/container/rust</a></p>",
        "id": 248781172,
        "sender_full_name": "Steven Fackler",
        "timestamp": 1628445257
    }
]