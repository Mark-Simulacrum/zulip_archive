[
    {
        "content": "<p>Why do PRs targeting different branches share the same bors queue? E.g., beta backports are behind a bunch of PRs in the queue (there are even more that are not shown in the image):</p>\n<p><a href=\"/user_uploads/4715/dyUMTaocnc1Xgwk0RETHz4xL/image.png\">image.png</a> </p>\n<div class=\"message_inline_image\"><a href=\"/user_uploads/4715/dyUMTaocnc1Xgwk0RETHz4xL/image.png\" title=\"image.png\"><img src=\"/user_uploads/4715/dyUMTaocnc1Xgwk0RETHz4xL/image.png\"></a></div><p>Why is this? Is this just a limitation of bors?</p>",
        "id": 267139564,
        "sender_full_name": "Noah Lev",
        "timestamp": 1641518735
    },
    {
        "content": "<p>they are sharing the same pool of hardware to run the tests. At least for rust-lang/rust, I don't think there is enough capacity to do it in parallel.</p>",
        "id": 267139715,
        "sender_full_name": "Eric Huss",
        "timestamp": 1641518879
    },
    {
        "content": "<p>Hmm, I see. Does bors support parallel queues or no?</p>",
        "id": 267144259,
        "sender_full_name": "Noah Lev",
        "timestamp": 1641522915
    },
    {
        "content": "<p>I don't think so</p>",
        "id": 267144387,
        "sender_full_name": "Aaron Hill",
        "timestamp": 1641523018
    },
    {
        "content": "<p>and beta builds are quite infrequent, so I think a much better use of any spare capacity would be 'speculative' builds</p>",
        "id": 267144437,
        "sender_full_name": "Aaron Hill",
        "timestamp": 1641523080
    },
    {
        "content": "<p>that is, we start building the next item on the queue on the assumption that the current one is going to pass</p>",
        "id": 267144508,
        "sender_full_name": "Aaron Hill",
        "timestamp": 1641523121
    },
    {
        "content": "<p>Or if we don't have <em>that</em> much capacity, then start doing more (reproducible build tests, debug assertions, etc)</p>",
        "id": 267144565,
        "sender_full_name": "Aaron Hill",
        "timestamp": 1641523197
    },
    {
        "content": "<p>apple builders are the bottleneck, they take 3 hours</p>",
        "id": 267145235,
        "sender_full_name": "The 8472",
        "timestamp": 1641523850
    },
    {
        "content": "<p>and when caches get invalidated they take more than the timeout, partially populate the caches and then the next run passes</p>",
        "id": 267145273,
        "sender_full_name": "The 8472",
        "timestamp": 1641523903
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"330154\">@The 8472</span> Do we know why they take longer than other branches? We've had a bunch of timeouts from those runners before too</p>",
        "id": 267212272,
        "sender_full_name": "Patrick Poitras",
        "timestamp": 1641574268
    },
    {
        "content": "<p>they have half the cores</p>",
        "id": 267213566,
        "sender_full_name": "Pietro Albini",
        "timestamp": 1641574863
    },
    {
        "content": "<p>and github actions doesn't have more powerful runners available</p>",
        "id": 267213591,
        "sender_full_name": "Pietro Albini",
        "timestamp": 1641574876
    },
    {
        "content": "<p>GitHub has some way to use custom hardware, right? Is there any way T-infra could get better Mac runners and hook them up to GHA? (I'm sure it'd be a lot of work, so I fully understand if the answer is \"no\".)</p>",
        "id": 267233554,
        "sender_full_name": "Noah Lev",
        "timestamp": 1641584566
    },
    {
        "content": "<p>\"way\" - yes. \"interest\" - no</p>",
        "id": 267233769,
        "sender_full_name": "Jake Goulding",
        "timestamp": 1641584699
    },
    {
        "content": "<p>See also...</p>\n<ul>\n<li>##<strong>t-infra&gt;M1 macs for macOS runners</strong></li>\n</ul>",
        "id": 267233976,
        "sender_full_name": "Jake Goulding",
        "timestamp": 1641584803
    },
    {
        "content": "<p>Are build times for the CI tracked anywhere?</p>",
        "id": 267241726,
        "sender_full_name": "Patrick Poitras",
        "timestamp": 1641588920
    },
    {
        "content": "<p>See this recent comment <a href=\"https://github.com/rust-lang/rust/pull/92622#issuecomment-1006982237\">https://github.com/rust-lang/rust/pull/92622#issuecomment-1006982237</a></p>",
        "id": 267243926,
        "sender_full_name": "Jake Goulding",
        "timestamp": 1641590211
    }
]