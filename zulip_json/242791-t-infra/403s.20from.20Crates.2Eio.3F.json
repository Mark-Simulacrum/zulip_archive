[
    {
        "content": "<p>PR <a href=\"https://github.com/rust-lang/rust/issues/85158\">#85158</a> just got this: &lt;<a href=\"https://pipelines.actions.githubusercontent.com/DhU3eyB11Ei4viT99vzh0CpKzg7REqx1Nup2tB9LzmxBcoHdbh/_apis/pipelines/1/runs/16541/signedlogcontent/51?urlExpires=2022-03-26T17%3A41%3A50.8247953Z&amp;urlSigningMethod=HMACV1&amp;urlSignature=9VsZ3ouXJd8N0zDS3z5YN7mxK1%2FNV1sEMyUPiA%2BrjuU%3D\">https://pipelines.actions.githubusercontent.com/DhU3eyB11Ei4viT99vzh0CpKzg7REqx1Nup2tB9LzmxBcoHdbh/_apis/pipelines/1/runs/16541/signedlogcontent/51?urlExpires=2022-03-26T17%3A41%3A50.8247953Z&amp;urlSigningMethod=HMACV1&amp;urlSignature=9VsZ3ouXJd8N0zDS3z5YN7mxK1%2FNV1sEMyUPiA%2BrjuU%3D</a>&gt;</p>\n<div class=\"codehilite\" data-code-language=\"Rust\"><pre><span></span><code><span class=\"mi\">2022</span><span class=\"o\">-</span><span class=\"mi\">03</span><span class=\"o\">-</span><span class=\"mi\">26</span><span class=\"n\">T17</span>:<span class=\"mi\">28</span>:<span class=\"mf\">43.6416573</span><span class=\"n\">Z</span><span class=\"w\"> </span><span class=\"n\">Building</span><span class=\"w\"> </span><span class=\"n\">stage0</span><span class=\"w\"> </span><span class=\"n\">tool</span><span class=\"w\"> </span><span class=\"n\">rustbook</span><span class=\"w\"> </span><span class=\"p\">(</span><span class=\"n\">x86_64</span><span class=\"o\">-</span><span class=\"n\">unknown</span><span class=\"o\">-</span><span class=\"n\">linux</span><span class=\"o\">-</span><span class=\"n\">gnu</span><span class=\"p\">)</span><span class=\"w\"></span>\n<span class=\"mi\">2022</span><span class=\"o\">-</span><span class=\"mi\">03</span><span class=\"o\">-</span><span class=\"mi\">26</span><span class=\"n\">T17</span>:<span class=\"mi\">28</span>:<span class=\"mf\">43.8238201</span><span class=\"n\">Z</span><span class=\"w\"> </span><span class=\"err\"></span><span class=\"p\">[</span><span class=\"mi\">0</span><span class=\"n\">m</span><span class=\"err\"></span><span class=\"p\">[</span><span class=\"mi\">0</span><span class=\"n\">m</span><span class=\"err\"></span><span class=\"p\">[</span><span class=\"mi\">1</span><span class=\"n\">m</span><span class=\"err\"></span><span class=\"p\">[</span><span class=\"mi\">32</span><span class=\"n\">m</span><span class=\"w\"> </span><span class=\"n\">Downloading</span><span class=\"err\"></span><span class=\"p\">[</span><span class=\"mi\">0</span><span class=\"n\">m</span><span class=\"w\"> </span><span class=\"n\">crates</span><span class=\"w\"> </span><span class=\"o\">..</span><span class=\"p\">.</span><span class=\"w\"></span>\n<span class=\"mi\">2022</span><span class=\"o\">-</span><span class=\"mi\">03</span><span class=\"o\">-</span><span class=\"mi\">26</span><span class=\"n\">T17</span>:<span class=\"mi\">28</span>:<span class=\"mf\">44.0241262</span><span class=\"n\">Z</span><span class=\"w\"> </span><span class=\"err\"></span><span class=\"p\">[</span><span class=\"mi\">0</span><span class=\"n\">m</span><span class=\"err\"></span><span class=\"p\">[</span><span class=\"mi\">0</span><span class=\"n\">m</span><span class=\"err\"></span><span class=\"p\">[</span><span class=\"mi\">1</span><span class=\"n\">m</span><span class=\"err\"></span><span class=\"p\">[</span><span class=\"mi\">31</span><span class=\"n\">merror</span><span class=\"err\"></span><span class=\"p\">[</span><span class=\"mi\">0</span><span class=\"n\">m</span><span class=\"err\"></span><span class=\"p\">[</span><span class=\"mi\">1</span><span class=\"n\">m</span>:<span class=\"err\"></span><span class=\"p\">[</span><span class=\"mi\">0</span><span class=\"n\">m</span><span class=\"w\"> </span><span class=\"n\">failed</span><span class=\"w\"> </span><span class=\"n\">to</span><span class=\"w\"> </span><span class=\"n\">download</span><span class=\"w\"> </span><span class=\"n\">from</span><span class=\"w\"> </span><span class=\"err\">`</span><span class=\"n\">https</span>:<span class=\"c1\">//crates.io/api/v1/crates/cfg-if/0.1.10/download`</span>\n<span class=\"mi\">2022</span><span class=\"o\">-</span><span class=\"mi\">03</span><span class=\"o\">-</span><span class=\"mi\">26</span><span class=\"n\">T17</span>:<span class=\"mi\">28</span>:<span class=\"mf\">44.0241927</span><span class=\"n\">Z</span><span class=\"w\"></span>\n<span class=\"mi\">2022</span><span class=\"o\">-</span><span class=\"mi\">03</span><span class=\"o\">-</span><span class=\"mi\">26</span><span class=\"n\">T17</span>:<span class=\"mi\">28</span>:<span class=\"mf\">44.0242136</span><span class=\"n\">Z</span><span class=\"w\"> </span><span class=\"n\">Caused</span><span class=\"w\"> </span><span class=\"n\">by</span>:\n<span class=\"mi\">2022</span><span class=\"o\">-</span><span class=\"mi\">03</span><span class=\"o\">-</span><span class=\"mi\">26</span><span class=\"n\">T17</span>:<span class=\"mi\">28</span>:<span class=\"mf\">44.0243190</span><span class=\"n\">Z</span><span class=\"w\">   </span><span class=\"n\">failed</span><span class=\"w\"> </span><span class=\"n\">to</span><span class=\"w\"> </span><span class=\"n\">get</span><span class=\"w\"> </span><span class=\"mi\">200</span><span class=\"w\"> </span><span class=\"n\">response</span><span class=\"w\"> </span><span class=\"n\">from</span><span class=\"w\"> </span><span class=\"err\">`</span><span class=\"n\">https</span>:<span class=\"c1\">//crates.io/api/v1/crates/cfg-if/0.1.10/download`, got 403</span>\n<span class=\"mi\">2022</span><span class=\"o\">-</span><span class=\"mi\">03</span><span class=\"o\">-</span><span class=\"mi\">26</span><span class=\"n\">T17</span>:<span class=\"mi\">28</span>:<span class=\"mf\">44.0272995</span><span class=\"n\">Z</span><span class=\"w\"> </span><span class=\"n\">Build</span><span class=\"w\"> </span><span class=\"n\">completed</span><span class=\"w\"> </span><span class=\"n\">unsuccessfully</span><span class=\"w\"> </span><span class=\"k\">in</span><span class=\"w\"> </span><span class=\"mi\">0</span>:<span class=\"mi\">00</span>:<span class=\"mi\">18</span><span class=\"w\"></span>\n</code></pre></div>\n<p>The bors queue was suspiciously empty, so makes me wonder if there could be a broader issue.</p>",
        "id": 276737323,
        "sender_full_name": "scottmcm",
        "timestamp": 1648316812
    },
    {
        "content": "<p>yeh a few other prs failed as well</p>",
        "id": 276741109,
        "sender_full_name": "DPC",
        "timestamp": 1648322139
    },
    {
        "content": "<p>though queue being empty is unrelated</p>",
        "id": 276741118,
        "sender_full_name": "DPC",
        "timestamp": 1648322150
    },
    {
        "content": "<p><a href=\"https://github.com/rust-lang/rust/pull/95338\">https://github.com/rust-lang/rust/pull/95338</a> is another example</p>",
        "id": 276741184,
        "sender_full_name": "DPC",
        "timestamp": 1648322200
    },
    {
        "content": "<p>okay closing the tree till we resolve it</p>",
        "id": 276741259,
        "sender_full_name": "DPC",
        "timestamp": 1648322321
    },
    {
        "content": "<p>(cross posted in <a class=\"stream\" data-stream-id=\"318791\" href=\"/#narrow/stream/318791-t-crates-io\">#t-crates-io</a> )</p>",
        "id": 276741383,
        "sender_full_name": "DPC",
        "timestamp": 1648322518
    },
    {
        "content": "<p>This should be resolved. I've unblocked the IP address that appears to be the issue and have opened a PR to update our list of CloudFront IP addresses: <a href=\"https://github.com/rust-lang/crates.io/pull/4672\">https://github.com/rust-lang/crates.io/pull/4672</a></p>",
        "id": 276742452,
        "sender_full_name": "Justin Geibel",
        "timestamp": 1648324072
    },
    {
        "content": "<p>Thanks!  I restarted one of the PRs</p>",
        "id": 276742527,
        "sender_full_name": "Eric Huss",
        "timestamp": 1648324198
    },
    {
        "content": "<p>looks like it failed</p>",
        "id": 276743672,
        "sender_full_name": "DPC",
        "timestamp": 1648325703
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"120823\">@DPC</span> looks like a stale test</p>",
        "id": 276743745,
        "sender_full_name": "Eric Huss",
        "timestamp": 1648325797
    },
    {
        "content": "<p>I'll retry another</p>",
        "id": 276743748,
        "sender_full_name": "Eric Huss",
        "timestamp": 1648325800
    },
    {
        "content": "<p>yeh</p>",
        "id": 276743749,
        "sender_full_name": "DPC",
        "timestamp": 1648325801
    },
    {
        "content": "<p>was just checking</p>",
        "id": 276743751,
        "sender_full_name": "DPC",
        "timestamp": 1648325805
    },
    {
        "content": "<p>ok</p>",
        "id": 276743752,
        "sender_full_name": "DPC",
        "timestamp": 1648325805
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"257369\">@Justin Geibel</span> the error still shows up <a href=\"https://github.com/rust-lang/rust/pull/95274#issuecomment-1079781258\">https://github.com/rust-lang/rust/pull/95274#issuecomment-1079781258</a></p>",
        "id": 276749275,
        "sender_full_name": "DPC",
        "timestamp": 1648333672
    },
    {
        "content": "<p>Any idea on what IP address (or range) the cargo requests could be coming from?</p>",
        "id": 276749493,
        "sender_full_name": "Justin Geibel",
        "timestamp": 1648333934
    },
    {
        "content": "<p>I don't think our logs include the IP address from GitHub Actions.</p>",
        "id": 276749626,
        "sender_full_name": "Eric Huss",
        "timestamp": 1648334157
    },
    {
        "content": "<p>This command will return the list of all IP ranges, but it is pretty long:</p>\n<p><code>curl   -H \"Accept: application/vnd.github.v3+json\"   https://api.github.com/meta | jq .actions</code></p>",
        "id": 276749759,
        "sender_full_name": "Eric Huss",
        "timestamp": 1648334295
    },
    {
        "content": "<p>Yeah, I couldn't find it in the logs either. Here is what our 403 responses look like in our server logs:<br>\n<a href=\"/user_uploads/4715/_l8FLE13ogX0wKUaxTBfR5f5/image.png\">image.png</a></p>\n<div class=\"message_inline_image\"><a href=\"/user_uploads/4715/_l8FLE13ogX0wKUaxTBfR5f5/image.png\" title=\"image.png\"><img src=\"/user_uploads/4715/_l8FLE13ogX0wKUaxTBfR5f5/image.png\"></a></div>",
        "id": 276749760,
        "sender_full_name": "Justin Geibel",
        "timestamp": 1648334297
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"257369\">@Justin Geibel</span>  Would it help if cargo included the IP address in the error?</p>\n<p>Similarly, are there any particular headers that might be useful?</p>",
        "id": 276749785,
        "sender_full_name": "Eric Huss",
        "timestamp": 1648334361
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"120823\">@DPC</span> I think you are looking at an old log.</p>",
        "id": 276749857,
        "sender_full_name": "Eric Huss",
        "timestamp": 1648334458
    },
    {
        "content": "<p>We currently only have blocking on IP address or user agent. And in most cases the IP address may be internal behind NAT so I'm not sure it would help in most cases.</p>",
        "id": 276749862,
        "sender_full_name": "Justin Geibel",
        "timestamp": 1648334463
    },
    {
        "content": "<p>The build is still running.</p>",
        "id": 276749865,
        "sender_full_name": "Eric Huss",
        "timestamp": 1648334465
    },
    {
        "content": "<p>I don't think it is currently failing.</p>",
        "id": 276749871,
        "sender_full_name": "Eric Huss",
        "timestamp": 1648334471
    },
    {
        "content": "<p>Yea, NAT would make it not too helpful.</p>\n<p>In the past, I've wanted the destination IP, as there was some weird caching problem that was causing a problem, but I never got around to it.</p>",
        "id": 276749969,
        "sender_full_name": "Eric Huss",
        "timestamp": 1648334602
    },
    {
        "content": "<p>ah ok fine <span aria-label=\"stuck out tongue\" class=\"emoji emoji-1f61b\" role=\"img\" title=\"stuck out tongue\">:stuck_out_tongue:</span></p>",
        "id": 276750582,
        "sender_full_name": "DPC",
        "timestamp": 1648335492
    },
    {
        "content": "<p>i think it was just the log that got delayed</p>",
        "id": 276750594,
        "sender_full_name": "DPC",
        "timestamp": 1648335521
    },
    {
        "content": "<p>the pr is merged, opening the tree</p>",
        "id": 276750640,
        "sender_full_name": "DPC",
        "timestamp": 1648335598
    },
    {
        "content": "<p>Apologies, that was my fault. There's someone spamming their crates' download URLs to inflate their download numbers, and I'm trying to be aggressive about blocking them to get them to stop. I'm wondering if they're now trying to use github actions to do that....</p>",
        "id": 276753202,
        "sender_full_name": "Carol (Nichols || Goulding)",
        "timestamp": 1648339040
    },
    {
        "content": "<p>I'm wondering if this is crater downloading these crates, which now have a large number of recent downloads (we're excluding the crates manually from the <a href=\"http://crates.io\">crates.io</a> homepage assuming that's what the spammer wants). Crater should not be placing high priority on these crates as their importance is artificially inflated, and it would help me find spam requests earlier if there were fewer downloads of these crates :P May I send a PR to crater to add the crates to the blocklist?</p>",
        "id": 276754074,
        "sender_full_name": "Carol (Nichols || Goulding)",
        "timestamp": 1648340327
    },
    {
        "content": "<p>If you have the IP addresses, I can check them against the crater IPs</p>",
        "id": 276754142,
        "sender_full_name": "simulacrum",
        "timestamp": 1648340408
    },
    {
        "content": "<p>(though 2/4 machines change IPs nightly, probably)</p>",
        "id": 276754146,
        "sender_full_name": "simulacrum",
        "timestamp": 1648340420
    },
    {
        "content": "<p>15.158.2.106</p>",
        "id": 276754164,
        "sender_full_name": "Carol (Nichols || Goulding)",
        "timestamp": 1648340465
    },
    {
        "content": "<p>no, that's not a crater IP.</p>",
        "id": 276754609,
        "sender_full_name": "simulacrum",
        "timestamp": 1648341187
    },
    {
        "content": "<p>interesting.</p>",
        "id": 276754679,
        "sender_full_name": "Carol (Nichols || Goulding)",
        "timestamp": 1648341320
    },
    {
        "content": "<p>(and, in any case, crater should really download a given crate just 2ish times every few days)</p>",
        "id": 276756345,
        "sender_full_name": "simulacrum",
        "timestamp": 1648344218
    },
    {
        "content": "<p>it's probably better to hide download stats for that crate(s) altogether rather than playing whack-a-mole</p>",
        "id": 276800785,
        "sender_full_name": "Pietro Albini",
        "timestamp": 1648405391
    }
]