[
    {
        "content": "<p>I have been testing  a butchered Rust CI using a modified GHA Runner locally and want to share some observations in the hope that they are useful:</p>\n<ul>\n<li>It will likely be quite some time before there is official support in the GHA Runner for Macos ARM64, because they currently target .NET Core 3.1 and Macos ARM64 will only be supported in .NET 6.0, which is currently in preview.</li>\n<li>My patchset for the GHA runner is here: <a href=\"https://github.com/hkratz/gha-runner-osx-arm64/pull/2\">https://github.com/hkratz/gha-runner-osx-arm64/pull/2</a></li>\n<li><code>x.py --stage 2 test</code> takes about 35 min. on my Macbook Air 8GB in the background while I do other light-weight stuff (w/ local sccache), see e.g. <a href=\"https://github.com/rusticstuff/rust/runs/3378970791?check_suite_focus=true\">https://github.com/rusticstuff/rust/runs/3378970791?check_suite_focus=true</a></li>\n<li>Haven't tested if running the x86_64 build and tests is faster with Rosetta than current GHA runs on GH VMs.</li>\n<li>Bugs found so far through the CI: the sanitizers are not working properly on Macos ARM64 (issues <a href=\"https://github.com/rust-lang/rust/issues/88131\">#88131</a> and <a href=\"https://github.com/rust-lang/rust/issues/88132\">#88132</a>).</li>\n<li>Macos <code>/usr/bin/tidy</code> is ancient. ;-)</li>\n</ul>",
        "id": 250081870,
        "sender_full_name": "Hans Kratz",
        "timestamp": 1629439876
    },
    {
        "content": "<blockquote>\n<p>Macos /usr/bin/tidy is ancient. ;-)</p>\n</blockquote>\n<p>you mean for rustdoc tests? it shouldn't be strictly necessary for tests, I don't think it's installed at all on linux</p>",
        "id": 250140499,
        "sender_full_name": "Joshua Nelson",
        "timestamp": 1629476822
    },
    {
        "content": "<p>As far as I can see it is run as part of <code>HtmlCheck</code>step if <code>tidy --version</code> completes with a zero exit code: <a href=\"https://github.com/rust-lang/rust/blob/ad1eaffc7e24f497e969c47f400ad20ae383f9aa/src/bootstrap/test.rs#L164\">https://github.com/rust-lang/rust/blob/ad1eaffc7e24f497e969c47f400ad20ae383f9aa/src/bootstrap/test.rs#L164</a>  The homebrew version works fine though.</p>",
        "id": 250157601,
        "sender_full_name": "Hans Kratz",
        "timestamp": 1629485352
    },
    {
        "content": "<p>Oh I see, you had an old version installed already</p>",
        "id": 250172347,
        "sender_full_name": "Joshua Nelson",
        "timestamp": 1629493465
    }
]