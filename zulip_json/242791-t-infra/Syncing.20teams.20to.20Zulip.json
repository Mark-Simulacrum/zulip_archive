[
    {
        "content": "<p>Just as an FYI: I have a <a href=\"https://github.com/rust-lang/sync-team/pull/3\">PR open on <code>sync-team</code></a> for syncing top level teams as Zulip user groups. No rush on a review, but I'm hoping to contribute more in this space.</p>",
        "id": 277275743,
        "sender_full_name": "rylev",
        "timestamp": 1648731371
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"121055\">@Pietro Albini</span> I implemented your feedback <a href=\"https://github.com/rust-lang/sync-team/pull/3\">here</a> and <a href=\"https://github.com/rust-lang/team/pull/730\">here</a>. We now have a zulip-groups.json endpoint which uses the team data to build up a definition of all the zulip-groups we want.</p>",
        "id": 277912527,
        "sender_full_name": "rylev",
        "timestamp": 1649178731
    },
    {
        "content": "<p>Should we create a <code>zulip-admins</code> group for people with Zulip administrator permission, to avoid the current manual management of that permission?</p>",
        "id": 277923441,
        "sender_full_name": "Josh Triplett",
        "timestamp": 1649183295
    },
    {
        "content": "<p>Yea in general, I'd really love to get <em>all</em> admin capabilities to be controlled through the teams repo. I'm not sure how access can be controlled through the Zulip API though so we'll need to investigate that first.</p>",
        "id": 277924932,
        "sender_full_name": "rylev",
        "timestamp": 1649183791
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"239881\">@Josh Triplett</span> what do you need admin perms for?</p>",
        "id": 277929955,
        "sender_full_name": "Pietro Albini",
        "timestamp": 1649185892
    },
    {
        "content": "<p>in a \"can we move that need over to the team repo\" way</p>",
        "id": 277930005,
        "sender_full_name": "Pietro Albini",
        "timestamp": 1649185921
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"224872\">@rylev</span> extremely busy with the release, will take a look in the weekend / next week</p>",
        "id": 277930075,
        "sender_full_name": "Pietro Albini",
        "timestamp": 1649185938
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"121055\">Pietro Albini</span> <a href=\"#narrow/stream/242791-t-infra/topic/Syncing.20teams.20to.20Zulip/near/277929955\">said</a>:</p>\n<blockquote>\n<p><span class=\"user-mention silent\" data-user-id=\"239881\">Josh Triplett</span> what do you need admin perms for?</p>\n</blockquote>\n<p>To the best of my knowledge, elevated permissions (possibly not full admin permissions) are required to:</p>\n<ul>\n<li>Create new public streams. We could change this to permit other roles to do this (moderators, or any member), but I don't think we necessarily want to allow any member to make a new stream. And I don't think we want to do this entirely through teams.</li>\n<li>Create new private streams. All of the above applies. And I <em>definitely</em> don't think we want to manage this via teams; we should manage groups via teams and then add groups or individuals to permissions.</li>\n<li>Manage group membership (this should absolutely be via teams).</li>\n<li>Deleting messages (we should make sure there's nothing admins can do that Zulip moderators can't, here, and then just give more people moderator permission so they can handle things when they see them).</li>\n<li>Moving messages between streams (AFAICT admin may be required for full capabilities here; if it's possible to give that permission to moderators we should).</li>\n<li>A few other things, will do some further digging.</li>\n</ul>",
        "id": 277934479,
        "sender_full_name": "Josh Triplett",
        "timestamp": 1649188290
    },
    {
        "content": "<blockquote>\n<p>Create new private streams. All of the above applies. And I definitely don't think we want to manage this via teams; we should manage groups via teams and then add groups or individuals to permissions.</p>\n</blockquote>\n<p>Hmm? My next idea after this would've been to have private streams created through the team repository, with permissions synchronized through it</p>",
        "id": 277934693,
        "sender_full_name": "Pietro Albini",
        "timestamp": 1649188399
    },
    {
        "content": "<p>i.e. you would have something like this on the team repo:</p>\n<div class=\"codehilite\" data-code-language=\"TOML\"><pre><span></span><code><span class=\"k\">[[zulip-stream]]</span><span class=\"w\"></span>\n<span class=\"n\">name</span><span class=\"w\"> </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"s\">\"t-infra/private\"</span><span class=\"w\"></span>\n</code></pre></div>\n<p>and sync-team would make sure the stream is present and all team members are in it</p>",
        "id": 277934827,
        "sender_full_name": "Pietro Albini",
        "timestamp": 1649188461
    },
    {
        "content": "<p>what would your concerns with that approach be?</p>",
        "id": 277934837,
        "sender_full_name": "Pietro Albini",
        "timestamp": 1649188467
    },
    {
        "content": "<p>Sometimes the existence of a stream may be private. Sometimes the membership of a stream may be private.</p>",
        "id": 277934898,
        "sender_full_name": "Josh Triplett",
        "timestamp": 1649188503
    },
    {
        "content": "<p>Also, some streams may not be intended to be determined based on information in teams. Some streams may also have members who are not otherwise in the teams repository.</p>",
        "id": 277934981,
        "sender_full_name": "Josh Triplett",
        "timestamp": 1649188555
    },
    {
        "content": "<p>do you have examples? even sending them in DMs?</p>",
        "id": 277935053,
        "sender_full_name": "Pietro Albini",
        "timestamp": 1649188576
    },
    {
        "content": "<p>My inclination would be to have groups synced via the team repository, and then it's easy to use those groups to manage permissions, for every case that aligns with existing team permissions.</p>",
        "id": 277935086,
        "sender_full_name": "Josh Triplett",
        "timestamp": 1649188597
    },
    {
        "content": "<p>the only one where the existence of those streams has to be private is the wg-security-response/YYYY-MM-DD ones (used for security response)</p>",
        "id": 277935092,
        "sender_full_name": "Pietro Albini",
        "timestamp": 1649188602
    },
    {
        "content": "<p>you can't manage permissions with groups (yet)?</p>",
        "id": 277935113,
        "sender_full_name": "Pietro Albini",
        "timestamp": 1649188613
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"121055\">@Pietro Albini</span> Will try to follow up later.</p>",
        "id": 277935146,
        "sender_full_name": "Josh Triplett",
        "timestamp": 1649188634
    },
    {
        "content": "<p>(just trying to understand what would be the problem <span aria-label=\"smile\" class=\"emoji emoji-1f642\" role=\"img\" title=\"smile\">:smile:</span>)</p>",
        "id": 277935170,
        "sender_full_name": "Pietro Albini",
        "timestamp": 1649188645
    },
    {
        "content": "<p>Security issues would be one case. Moderation issues would be another case.</p>",
        "id": 277935189,
        "sender_full_name": "Josh Triplett",
        "timestamp": 1649188659
    },
    {
        "content": "<p>And I've also occasionally seen people create private streams for 3-5 person random low-threshold collaboration, where they might want to add more people, which isn't ideal via DM.</p>",
        "id": 277935342,
        "sender_full_name": "Josh Triplett",
        "timestamp": 1649188727
    },
    {
        "content": "<p>For some reason I had the impression you could put a group into a permission list for a stream. If you can't, that would be a great feature to add to zulip.</p>",
        "id": 277935433,
        "sender_full_name": "Josh Triplett",
        "timestamp": 1649188764
    },
    {
        "content": "<p>I think a permissions revamp is planned, but right now you can't do that</p>",
        "id": 277935466,
        "sender_full_name": "Pietro Albini",
        "timestamp": 1649188784
    },
    {
        "content": "<p>which is also why I was really interested to synchronize streams with the team repo</p>",
        "id": 277935495,
        "sender_full_name": "Pietro Albini",
        "timestamp": 1649188799
    },
    {
        "content": "<p>That makes more sense now, yeah.</p>",
        "id": 277935901,
        "sender_full_name": "Josh Triplett",
        "timestamp": 1649188938
    },
    {
        "content": "<p>looking at the private streams, right now the only \"secret\" ones are the ones for security response, and tbh it's fine for those to be manually created, but for the rest we should really have sync</p>",
        "id": 277935933,
        "sender_full_name": "Pietro Albini",
        "timestamp": 1649188955
    },
    {
        "content": "<p>To clarify something, I'm not suggesting that we should never consider doing this, or that we shouldn't make it possible to do for some streams. I'm suggesting that we might not want to make a requirement that all streams must use this.</p>",
        "id": 277935961,
        "sender_full_name": "Josh Triplett",
        "timestamp": 1649188968
    },
    {
        "content": "<p>yeah, definitely</p>",
        "id": 277936005,
        "sender_full_name": "Pietro Albini",
        "timestamp": 1649188986
    },
    {
        "content": "<p>For the moment, I would propose that we extend stream creation permission to people with moderator permission, not just admin, and then give out moderator permission reasonably liberally to team members.</p>",
        "id": 277936020,
        "sender_full_name": "Josh Triplett",
        "timestamp": 1649188996
    },
    {
        "content": "<p>is stream creation so frequent that it becomes a bottleneck?</p>",
        "id": 277936066,
        "sender_full_name": "Pietro Albini",
        "timestamp": 1649189022
    },
    {
        "content": "<p>Not a bottleneck, exactly... More like activation energy.</p>",
        "id": 277936541,
        "sender_full_name": "Josh Triplett",
        "timestamp": 1649189232
    },
    {
        "content": "<p>Also, almost any stream that's directly correlated with a working group or team or initiative or similar should absolutely use teams to manage membership and permissions.</p>",
        "id": 277936570,
        "sender_full_name": "Josh Triplett",
        "timestamp": 1649189253
    },
    {
        "content": "<p>reviewed the PRs! thanks again for working on them <span aria-label=\"smile\" class=\"emoji emoji-1f642\" role=\"img\" title=\"smile\">:smile:</span></p>",
        "id": 278416582,
        "sender_full_name": "Pietro Albini",
        "timestamp": 1649519890
    },
    {
        "content": "<p>Comments addressed! I think we're ready to go. The only issue I'm not sure about is if there is still a potential privilege escalation attack vector through emails. Zulip allows singing up through email, GitHub, Twitter, and Gitlab. I'm not sure if all of those sign up paths require a verified email.</p>",
        "id": 278660224,
        "sender_full_name": "rylev",
        "timestamp": 1649750821
    },
    {
        "content": "<p>hmm, I'd expect those only provide verified email addresses?</p>",
        "id": 278663983,
        "sender_full_name": "Pietro Albini",
        "timestamp": 1649753237
    },
    {
        "content": "<p>I pretty sure GitHub and Twitter do. I have no experience with Gitlab, and I'm not sure whether Zulip verifies emails. It wouldn't surprise me if all of them do, I'm just saying I'm not sure.</p>",
        "id": 278664549,
        "sender_full_name": "rylev",
        "timestamp": 1649753563
    },
    {
        "content": "<p>There's apparently also SAML authentication which I don't know a ton about.</p>",
        "id": 278665176,
        "sender_full_name": "rylev",
        "timestamp": 1649753924
    },
    {
        "content": "<p>we don't have SAML configured</p>",
        "id": 278666132,
        "sender_full_name": "Pietro Albini",
        "timestamp": 1649754442
    },
    {
        "content": "<p>Ok. I guess we still “allow” it as an identification method on a high level setting, but if it isn’t configured it won’t work. We might want to disallow it for consistency sake</p>",
        "id": 278666761,
        "sender_full_name": "rylev",
        "timestamp": 1649754836
    },
    {
        "content": "<p>The setting is here: <a href=\"#organization/auth-methods\">https://rust-lang.zulipchat.com/#organization/auth-methods</a></p>",
        "id": 278666893,
        "sender_full_name": "rylev",
        "timestamp": 1649754927
    },
    {
        "content": "<p>disabled, but there's no button to use it anyway</p>",
        "id": 278667876,
        "sender_full_name": "Pietro Albini",
        "timestamp": 1649755543
    }
]