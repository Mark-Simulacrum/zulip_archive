[
    {
        "content": "<p>working on this</p>",
        "id": 256399801,
        "sender_full_name": "simulacrum",
        "timestamp": 1633522210
    },
    {
        "content": "<p>looking for an alternative isl-0.20 tarball we can put on our own infra</p>",
        "id": 256401460,
        "sender_full_name": "simulacrum",
        "timestamp": 1633523011
    },
    {
        "content": "<p>so far no luck</p>",
        "id": 256402399,
        "sender_full_name": "simulacrum",
        "timestamp": 1633523471
    },
    {
        "content": "<p>for that matter I can't even find a chksum file for isl-0.20, the file I found (in our docker containers) only contains isl 0.19</p>",
        "id": 256402522,
        "sender_full_name": "simulacrum",
        "timestamp": 1633523534
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"116122\">@simulacrum</span> do you have a link to a failure?</p>",
        "id": 256402640,
        "sender_full_name": "Pietro Albini",
        "timestamp": 1633523609
    },
    {
        "content": "<p><a href=\"https://github.com/rust-lang/rust/pull/89589#issuecomment-935820372\">https://github.com/rust-lang/rust/pull/89589#issuecomment-935820372</a></p>",
        "id": 256402680,
        "sender_full_name": "simulacrum",
        "timestamp": 1633523629
    },
    {
        "content": "<p>(like, every PR -- I went through and tree closed and retried them all)</p>",
        "id": 256402704,
        "sender_full_name": "simulacrum",
        "timestamp": 1633523638
    },
    {
        "content": "<p>Probably take it from debian?<br>\n<a href=\"https://packages.debian.org/source/buster/isl\">https://packages.debian.org/source/buster/isl</a><br>\n<a href=\"http://deb.debian.org/debian/pool/main/i/isl/isl_0.20.orig.tar.xz\">http://deb.debian.org/debian/pool/main/i/isl/isl_0.20.orig.tar.xz</a></p>",
        "id": 256402710,
        "sender_full_name": "Hans Kratz",
        "timestamp": 1633523641
    },
    {
        "content": "<p>Yeah, that's what I'm going to try, but I have no way of verifying if that tarball will work</p>",
        "id": 256402780,
        "sender_full_name": "simulacrum",
        "timestamp": 1633523662
    },
    {
        "content": "<p>crosstool-ng's checksum file as far as I can tell expects 0.19</p>",
        "id": 256402817,
        "sender_full_name": "simulacrum",
        "timestamp": 1633523688
    },
    {
        "content": "<div class=\"codehilite\"><pre><span></span><code>$ cat usr/local/share/crosstool-ng/packages/isl/0.20/chksum\nmd5 isl-0.19.tar.xz 1ae893020fa078531e6158cb243880a5\nsha1 isl-0.19.tar.xz 3447b208786a81be396912bc160f6c01bd679892\nsha256 isl-0.19.tar.xz 6d6c1aa00e2a6dfc509fa46d9a9dbe93af0c451e196a670577a148feecf6b8a5\nsha512 isl-0.19.tar.xz eeda0405d38f77a18c6e69128948dc29af7e44ce827e9fb538d3844c6e22db3b4126287ca0937d9bee7b528bbab7aad8d3729db36e74864196f57e81943dade4\nmd5 isl-0.19.tar.bz2 7850d46a96e5ea31e34913190895e154\nsha1 isl-0.19.tar.bz2 dba7264419ba995a0f6b4fde135993677f7c85fd\nsha256 isl-0.19.tar.bz2 d59726f34f7852a081fbd3defd1ab2136f174110fc2e0c8d10bb122173fa9ed8\nsha512 isl-0.19.tar.bz2 08f4db964d9e02ec8aa9779378ed76e0ddf1d56f81f87664dbf787555ce496cdc87e836f8a51ae137f45e648c604870cce07ee45919eafb549e404afb8f27083\nmd5 isl-0.19.tar.gz 5a2dc001276a227509b2bab3382e461f\nsha1 isl-0.19.tar.gz db4e0b8d79b14de65ff6d90b446e5d5643bfaeba\nsha256 isl-0.19.tar.gz dc56525cac8581b13c84a26a73d3142008912b7157f89b8d8d7b08f1a8fd1eec\nsha512 isl-0.19.tar.gz 55a37c118ec427273399c20d268911152304a8686453dbf2ce0c45a045509c60a6fc8ffeb2299dce0cdde4506111c8f709d37340f4e136b346cb38d763968e12\n</code></pre></div>",
        "id": 256402829,
        "sender_full_name": "simulacrum",
        "timestamp": 1633523696
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"116122\">@simulacrum</span> tarballs seem to be available in the wayback machine</p>",
        "id": 256403142,
        "sender_full_name": "Pietro Albini",
        "timestamp": 1633523862
    },
    {
        "content": "<p>ah, good call</p>",
        "id": 256403151,
        "sender_full_name": "simulacrum",
        "timestamp": 1633523868
    },
    {
        "content": "<p><a href=\"https://web.archive.org/web/20191228132150/http://isl.gforge.inria.fr/isl-0.20.tar.xz\">https://web.archive.org/web/20191228132150/http://isl.gforge.inria.fr/isl-0.20.tar.xz</a></p>",
        "id": 256403160,
        "sender_full_name": "Pietro Albini",
        "timestamp": 1633523872
    },
    {
        "content": "<p>ok, yeah, that matches debians tarball</p>",
        "id": 256403358,
        "sender_full_name": "simulacrum",
        "timestamp": 1633523959
    },
    {
        "content": "<p><a href=\"https://github.com/rust-lang/rust/pull/89594\">https://github.com/rust-lang/rust/pull/89594</a></p>",
        "id": 256403644,
        "sender_full_name": "simulacrum",
        "timestamp": 1633524080
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"121055\">@Pietro Albini</span> ^</p>",
        "id": 256403660,
        "sender_full_name": "simulacrum",
        "timestamp": 1633524086
    },
    {
        "content": "<p>(haven't tested locally yet)</p>",
        "id": 256403698,
        "sender_full_name": "simulacrum",
        "timestamp": 1633524105
    },
    {
        "content": "<p>r+ p=1000'd it</p>",
        "id": 256403712,
        "sender_full_name": "Pietro Albini",
        "timestamp": 1633524114
    },
    {
        "content": "<p>Oh I probably didn't mark the file as public</p>",
        "id": 256404580,
        "sender_full_name": "simulacrum",
        "timestamp": 1633524507
    },
    {
        "content": "<p>But that can be done while the docker builds</p>",
        "id": 256404600,
        "sender_full_name": "simulacrum",
        "timestamp": 1633524518
    },
    {
        "content": "<p>I'll try to do that in a moment</p>",
        "id": 256404618,
        "sender_full_name": "simulacrum",
        "timestamp": 1633524525
    },
    {
        "content": "<p><a href=\"http://ci-mirrors.rust-lang.org/rustc/isl-0.20.tar.xz\">ci-mirrors.rust-lang.org/rustc/isl-0.20.tar.xz</a> seems to work so I won't touch anything</p>",
        "id": 256405111,
        "sender_full_name": "simulacrum",
        "timestamp": 1633524730
    },
    {
        "content": "<p>I suspect our cloudfront is authorizing or something</p>",
        "id": 256405131,
        "sender_full_name": "simulacrum",
        "timestamp": 1633524739
    },
    {
        "content": "<p>that's the way you're supposed to do it anyway</p>",
        "id": 256405153,
        "sender_full_name": "simulacrum",
        "timestamp": 1633524747
    },
    {
        "content": "<p>gah</p>",
        "id": 256411192,
        "sender_full_name": "simulacrum",
        "timestamp": 1633527042
    },
    {
        "content": "<p>\"download failed\"</p>",
        "id": 256411201,
        "sender_full_name": "simulacrum",
        "timestamp": 1633527045
    },
    {
        "content": "<p>but .... no error logs or anything</p>",
        "id": 256411219,
        "sender_full_name": "simulacrum",
        "timestamp": 1633527050
    },
    {
        "content": "<p>I just don't understand</p>",
        "id": 256411225,
        "sender_full_name": "simulacrum",
        "timestamp": 1633527054
    },
    {
        "content": "<p>will look into it in a bit</p>",
        "id": 256411740,
        "sender_full_name": "Pietro Albini",
        "timestamp": 1633527249
    },
    {
        "content": "<p><a href=\"https://gist.github.com/Mark-Simulacrum/b1fe274110bc7892cbabaab2d7c799ab\">https://gist.github.com/Mark-Simulacrum/b1fe274110bc7892cbabaab2d7c799ab</a> is the scripts/functions file fwiw</p>",
        "id": 256411921,
        "sender_full_name": "simulacrum",
        "timestamp": 1633527331
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"116122\">@simulacrum</span> oh</p>",
        "id": 256412158,
        "sender_full_name": "Pietro Albini",
        "timestamp": 1633527423
    },
    {
        "content": "<p>in the build that failed before, it was trying to download .gz, not .xz</p>",
        "id": 256412186,
        "sender_full_name": "Pietro Albini",
        "timestamp": 1633527434
    },
    {
        "content": "<p>hm but... like .xz is in the list</p>",
        "id": 256412228,
        "sender_full_name": "simulacrum",
        "timestamp": 1633527451
    },
    {
        "content": "<p>and it starts with 2021-10-06T09:45:24.4052350Z [ALL  ]    --2021-10-06 09:43:44--  <a href=\"http://isl.gforge.inria.fr/isl-0.20.tar.xz\">http://isl.gforge.inria.fr/isl-0.20.tar.xz</a></p>",
        "id": 256412271,
        "sender_full_name": "simulacrum",
        "timestamp": 1633527467
    },
    {
        "content": "<p>so it tries to get .tar.xz first</p>",
        "id": 256412283,
        "sender_full_name": "simulacrum",
        "timestamp": 1633527473
    },
    {
        "content": "<p>oh missed that</p>",
        "id": 256412365,
        "sender_full_name": "Pietro Albini",
        "timestamp": 1633527488
    },
    {
        "content": "<p>and https:// downloads worked earlier, so it's probably not that</p>",
        "id": 256412453,
        "sender_full_name": "simulacrum",
        "timestamp": 1633527525
    },
    {
        "content": "<p>so, we're not outputting build.log, which should have more info</p>",
        "id": 256412874,
        "sender_full_name": "Pietro Albini",
        "timestamp": 1633527687
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"116122\">@simulacrum</span> can't really push code right now, could you try outputting that file as part of CI?</p>",
        "id": 256413029,
        "sender_full_name": "Pietro Albini",
        "timestamp": 1633527742
    },
    {
        "content": "<p>hm</p>",
        "id": 256413057,
        "sender_full_name": "simulacrum",
        "timestamp": 1633527754
    },
    {
        "content": "<p>yes</p>",
        "id": 256413155,
        "sender_full_name": "simulacrum",
        "timestamp": 1633527797
    },
    {
        "content": "<p>but our code tries to do that already...?</p>",
        "id": 256413186,
        "sender_full_name": "simulacrum",
        "timestamp": 1633527813
    },
    {
        "content": "<p>that is the build log we're seeing</p>",
        "id": 256413203,
        "sender_full_name": "simulacrum",
        "timestamp": 1633527826
    },
    {
        "content": "<p><a href=\"https://github.com/Mark-Simulacrum/rust/blob/a412880d8f379e0fd72283929a7cfc53f9d6abad/src/ci/docker/host-x86_64/dist-armhf-linux/build-toolchains.sh#L9\">https://github.com/Mark-Simulacrum/rust/blob/a412880d8f379e0fd72283929a7cfc53f9d6abad/src/ci/docker/host-x86_64/dist-armhf-linux/build-toolchains.sh#L9</a></p>",
        "id": 256413235,
        "sender_full_name": "simulacrum",
        "timestamp": 1633527840
    },
    {
        "content": "<p>hmm</p>",
        "id": 256413457,
        "sender_full_name": "Pietro Albini",
        "timestamp": 1633527921
    },
    {
        "content": "<p>oh</p>",
        "id": 256413530,
        "sender_full_name": "simulacrum",
        "timestamp": 1633527953
    },
    {
        "content": "<p>[DEBUG]    Trying '<a href=\"http://isl.gforge.inria.fr/isl-0.20.tar.xz\">http://isl.gforge.inria.fr/isl-0.20.tar.xz</a>'<br>\n[DEBUG]    ==&gt; Executing:  'wget' '--passive-ftp' '--tries=3' '-nc' '--progress=dot:binary' '-T' '10' '-O' '/tmp/build/.build/tarballs/isl-0.20.tar.xz.tmp-dl' '<a href=\"http://isl.gforge.inria.fr/isl-0.20.tar.xz\">http://isl.gforge.inria.fr/isl-0.20.tar.xz</a>'<br>\n[ALL  ]    --2021-10-06 13:45:22--  <a href=\"http://isl.gforge.inria.fr/isl-0.20.tar.xz\">http://isl.gforge.inria.fr/isl-0.20.tar.xz</a><br>\n[ALL  ]    Resolving <a href=\"http://isl.gforge.inria.fr\">isl.gforge.inria.fr</a> (<a href=\"http://isl.gforge.inria.fr\">isl.gforge.inria.fr</a>)... 128.93.193.15<br>\n[ALL  ]    Connecting to <a href=\"http://isl.gforge.inria.fr\">isl.gforge.inria.fr</a> (isl.gforge.inria.fr)|128.93.193.15|:80... failed: Connection timed out.<br>\n[ALL  ]    Retrying.<br>\n[ALL  ]<br>\n[ALL  ]    --2021-10-06 13:45:33--  (try: 2)  <a href=\"http://isl.gforge.inria.fr/isl-0.20.tar.xz\">http://isl.gforge.inria.fr/isl-0.20.tar.xz</a></p>",
        "id": 256413548,
        "sender_full_name": "simulacrum",
        "timestamp": 1633527959
    },
    {
        "content": "<p>I think we're just... not setting it somehow</p>",
        "id": 256413602,
        "sender_full_name": "simulacrum",
        "timestamp": 1633527967
    },
    {
        "content": "<p>that's from a local build</p>",
        "id": 256413708,
        "sender_full_name": "simulacrum",
        "timestamp": 1633528005
    },
    {
        "content": "<p>Package iterator: set mirrors='<a href=\"http://isl.gforge.inria.fr\">http://isl.gforge.inria.fr</a>'</p>",
        "id": 256413733,
        "sender_full_name": "simulacrum",
        "timestamp": 1633528017
    },
    {
        "content": "<p>I'm baffled</p>",
        "id": 256413938,
        "sender_full_name": "simulacrum",
        "timestamp": 1633528097
    },
    {
        "content": "<p>trying to set CT_USE_MIRROR=y</p>",
        "id": 256414028,
        "sender_full_name": "simulacrum",
        "timestamp": 1633528142
    },
    {
        "content": "<p>nope</p>",
        "id": 256414406,
        "sender_full_name": "simulacrum",
        "timestamp": 1633528294
    },
    {
        "content": "<p>hmm, we're not seeing those debug logs in CI though</p>",
        "id": 256414846,
        "sender_full_name": "Pietro Albini",
        "timestamp": 1633528446
    },
    {
        "content": "<p>right, we only log at EXTRA</p>",
        "id": 256414877,
        "sender_full_name": "simulacrum",
        "timestamp": 1633528459
    },
    {
        "content": "<p>I will need to run shortly</p>",
        "id": 256415398,
        "sender_full_name": "simulacrum",
        "timestamp": 1633528648
    },
    {
        "content": "<p>I pushed up what I had (it doesn't work)</p>",
        "id": 256415489,
        "sender_full_name": "simulacrum",
        "timestamp": 1633528678
    },
    {
        "content": "<p>but maybe a starting point for logs at least</p>",
        "id": 256415525,
        "sender_full_name": "simulacrum",
        "timestamp": 1633528682
    },
    {
        "content": "<p>I can't seem to override crosstool-ng's mirror settings</p>",
        "id": 256415568,
        "sender_full_name": "simulacrum",
        "timestamp": 1633528697
    },
    {
        "content": "<p>something else is overriding it from somewhere</p>",
        "id": 256415704,
        "sender_full_name": "simulacrum",
        "timestamp": 1633528753
    },
    {
        "content": "<p>For armhf <code>ct-ng oldconfig</code> fails and creates a new config with the wrong mirror settings:</p>\n<div class=\"codehilite\"><pre><span></span><code>+ ct-ng oldconfig\n  CONF  oldconfig\n\nError in reading or end of file.\n*\n* Restart config...\n</code></pre></div>",
        "id": 256422107,
        "sender_full_name": "Hans Kratz",
        "timestamp": 1633531125
    },
    {
        "content": "<p>hm</p>",
        "id": 256425444,
        "sender_full_name": "simulacrum",
        "timestamp": 1633532361
    },
    {
        "content": "<p>well that seems unfortunate</p>",
        "id": 256425466,
        "sender_full_name": "simulacrum",
        "timestamp": 1633532367
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"116122\">@simulacrum</span>  About to submit a PR building on your earlier one + the armhf <code>ct-ng oldconfig</code>fix.</p>",
        "id": 256425718,
        "sender_full_name": "Hans Kratz",
        "timestamp": 1633532432
    },
    {
        "content": "<p>thanks</p>",
        "id": 256425745,
        "sender_full_name": "simulacrum",
        "timestamp": 1633532442
    },
    {
        "content": "<p>not sure why that's happening, but sounds like you figured it out</p>",
        "id": 256425761,
        "sender_full_name": "simulacrum",
        "timestamp": 1633532450
    },
    {
        "content": "<p>Still something wrong with it, looking into it again.</p>",
        "id": 256427332,
        "sender_full_name": "Hans Kratz",
        "timestamp": 1633533010
    },
    {
        "content": "<p><code>ct-ng oldconfig</code>still just generate a <code>.config</code>file with default values, not sure why.</p>",
        "id": 256429884,
        "sender_full_name": "Hans Kratz",
        "timestamp": 1633533904
    },
    {
        "content": "<p>Why <code>ct-ng oldconfig</code> changes the mirror settings back to the default values is unclear. I am not an expert with crosstools-ng either. As a stop-gap measure I will commit the <code>.config</code> files that <code>ct-ng oldconfig</code> generates for the affected architectures plus the mirror change applied.</p>",
        "id": 256438214,
        "sender_full_name": "Hans Kratz",
        "timestamp": 1633536633
    },
    {
        "content": "<p>hm, seems ok</p>",
        "id": 256438716,
        "sender_full_name": "simulacrum",
        "timestamp": 1633536834
    },
    {
        "content": "<p>feels like ... maybe that was the intent of our existing .config file</p>",
        "id": 256438774,
        "sender_full_name": "simulacrum",
        "timestamp": 1633536846
    },
    {
        "content": "<p><code>ct-ng oldconfig</code>does not work anyway because it is interactive by nature, asking the user to provide the missing values. So... it has never worked as intended.</p>",
        "id": 256439352,
        "sender_full_name": "Hans Kratz",
        "timestamp": 1633537078
    },
    {
        "content": "<p>Trying to build the <code>dist-s390x-linux</code> docker image locally and it seems to be affected as well. This one apparently requires <code>isl-0.14</code>.</p>",
        "id": 256639798,
        "sender_full_name": "Hans Kratz",
        "timestamp": 1633636539
    },
    {
        "content": "<p>hm</p>",
        "id": 256639953,
        "sender_full_name": "simulacrum",
        "timestamp": 1633636594
    },
    {
        "content": "<p>well feel free to give me a link to a binary and I can reupload it to our bucket</p>",
        "id": 256639996,
        "sender_full_name": "simulacrum",
        "timestamp": 1633636617
    },
    {
        "content": "<p>I had thought I grepped when this first broke for all such links but maybe that failed</p>",
        "id": 256640043,
        "sender_full_name": "simulacrum",
        "timestamp": 1633636637
    },
    {
        "content": "<p>The <code>s390x-linux-gnu.config</code> file has no <code>CT_ISL_MIRRORS=\"http://isl.gforge.inria.fr\"</code> line, only <code>CT_ISL_NEEDED=y</code>, <code>CT_ISL=y</code>, <code>CT_ISL_VERSION=\"0.14\"</code> and so on.</p>",
        "id": 256640768,
        "sender_full_name": "Hans Kratz",
        "timestamp": 1633636920
    },
    {
        "content": "<p>Mirroring is needed for isl-0.14.tar.xz, which is available from <a href=\"http://web.archive.org/web/20191228151411/http://isl.gforge.inria.fr/isl-0.14.tar.xz\">http://web.archive.org/web/20191228151411/http://isl.gforge.inria.fr/isl-0.14.tar.xz</a> and <a href=\"https://src.fedoraproject.org/repo/pkgs/isl/isl-0.14.tar.xz/3d6b6a1cddd165fae2af5487c5531b09/isl-0.14.tar.xz\">https://src.fedoraproject.org/repo/pkgs/isl/isl-0.14.tar.xz/3d6b6a1cddd165fae2af5487c5531b09/isl-0.14.tar.xz</a> (files are identical)</p>",
        "id": 256694090,
        "sender_full_name": "Hans Kratz",
        "timestamp": 1633673971
    },
    {
        "content": "<p>From reading <a href=\"https://groups.google.com/g/isl-development/c/JGaMo2VUu_8\">https://groups.google.com/g/isl-development/c/JGaMo2VUu_8</a> it looks like the primary  ISL developer put the tarballs on sourceforge: <a href=\"https://sourceforge.net/projects/libisl/files/\">https://sourceforge.net/projects/libisl/files/</a></p>",
        "id": 256966412,
        "sender_full_name": "Tavian Barnes",
        "timestamp": 1633882732
    }
]