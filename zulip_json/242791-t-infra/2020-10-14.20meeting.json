[
    {
        "content": "<p><span class=\"user-group-mention\" data-user-group-id=\"2943\">@T-infra</span> the meeting will be in 6 minutes!</p>",
        "id": 213291112,
        "sender_full_name": "Pietro Albini",
        "timestamp": 1602683641
    },
    {
        "content": "<p>(trying early pings to see if we can wait a bit less to start <span aria-label=\"smile\" class=\"emoji emoji-1f642\" role=\"img\" title=\"smile\">:smile:</span>)</p>",
        "id": 213291193,
        "sender_full_name": "Pietro Albini",
        "timestamp": 1602683660
    },
    {
        "content": "<p>o/</p>",
        "id": 213291994,
        "sender_full_name": "Jake Goulding",
        "timestamp": 1602684001
    },
    {
        "content": "<p><span class=\"user-group-mention\" data-user-group-id=\"2943\">@T-infra</span> meeting time!</p>",
        "id": 213292048,
        "sender_full_name": "Pietro Albini",
        "timestamp": 1602684006
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"116155\">@Jake Goulding</span> another meeting starting with just you and me? :D</p>",
        "id": 213292534,
        "sender_full_name": "Pietro Albini",
        "timestamp": 1602684223
    },
    {
        "content": "<p>o/</p>",
        "id": 213292681,
        "sender_full_name": "Aidan Hobson Sayers",
        "timestamp": 1602684271
    },
    {
        "content": "<p>let's start!</p>",
        "id": 213292841,
        "sender_full_name": "Pietro Albini",
        "timestamp": 1602684348
    },
    {
        "content": "<p>so, we have four beta-nominated PRs</p>",
        "id": 213292855,
        "sender_full_name": "Pietro Albini",
        "timestamp": 1602684355
    },
    {
        "content": "<p>Always use the Rust version in package names <a href=\"https://github.com/rust-lang/rust/issues/77336\">#77336</a></p>",
        "id": 213292956,
        "sender_full_name": "Pietro Albini",
        "timestamp": 1602684389
    },
    {
        "content": "<p>this fixes an oddity in stable package names, updating all the version numbers in the tarball names to be rust's version</p>",
        "id": 213293007,
        "sender_full_name": "Pietro Albini",
        "timestamp": 1602684417
    },
    {
        "content": "<p>Dist build manifest <a href=\"https://github.com/rust-lang/rust/issues/77762\">#77762</a></p>",
        "id": 213293017,
        "sender_full_name": "Pietro Albini",
        "timestamp": 1602684423
    },
    {
        "content": "<p>this does the last batch of updates to <code>build-manifest</code>, and creates a <code>build-manifest</code> component used by <code>promote-release</code> to avoid recompiling</p>",
        "id": 213293111,
        "sender_full_name": "Pietro Albini",
        "timestamp": 1602684460
    },
    {
        "content": "<p>build-manifest: stop generating numbered channel names except for stable <a href=\"https://github.com/rust-lang/rust/issues/77854\">#77854</a></p>",
        "id": 213293137,
        "sender_full_name": "Pietro Albini",
        "timestamp": 1602684468
    },
    {
        "content": "<p>this fixes a bug in a previously backported PR</p>",
        "id": 213293149,
        "sender_full_name": "Pietro Albini",
        "timestamp": 1602684474
    },
    {
        "content": "<p>bootstrap: set correct path for the build-manifest binary <a href=\"https://github.com/rust-lang/rust/issues/77909\">#77909</a></p>",
        "id": 213293215,
        "sender_full_name": "Pietro Albini",
        "timestamp": 1602684487
    },
    {
        "content": "<p>this fixes a bug in \"dist build manifest\"</p>",
        "id": 213293229,
        "sender_full_name": "Pietro Albini",
        "timestamp": 1602684492
    },
    {
        "content": "<p>overral, all those PRs are changes to <code>build-manifest</code> as part of my improvements to <code>promote-release</code></p>",
        "id": 213293284,
        "sender_full_name": "Pietro Albini",
        "timestamp": 1602684514
    },
    {
        "content": "<p>we're kinda early in the cycle so they're going to get enough testing on beta imo</p>",
        "id": 213293336,
        "sender_full_name": "Pietro Albini",
        "timestamp": 1602684532
    },
    {
        "content": "<p>and this will reduce the amount of time we need to maintain compatibility with the old <code>build-manifest</code></p>",
        "id": 213293376,
        "sender_full_name": "Pietro Albini",
        "timestamp": 1602684550
    },
    {
        "content": "<p>what do y'all think about approving or rejecting the backport?</p>",
        "id": 213293391,
        "sender_full_name": "Pietro Albini",
        "timestamp": 1602684558
    },
    {
        "content": "<p>These are all PRs from you, right?</p>",
        "id": 213293617,
        "sender_full_name": "Jake Goulding",
        "timestamp": 1602684642
    },
    {
        "content": "<p>yes</p>",
        "id": 213293630,
        "sender_full_name": "Pietro Albini",
        "timestamp": 1602684649
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"116155\">@Jake Goulding</span> <span class=\"user-mention\" data-user-id=\"117568\">@Aidan Hobson Sayers</span> let's do green to approve, red to disapprove, wrench to talk more :)</p>",
        "id": 213293895,
        "sender_full_name": "Pietro Albini",
        "timestamp": 1602684746
    },
    {
        "content": "<p>Then since you'll be able to watch / fix / revert them, and it's early, I'm OK with it in general. Do we have good visibility into knowing if any problems arise?</p>",
        "id": 213293944,
        "sender_full_name": "Jake Goulding",
        "timestamp": 1602684766
    },
    {
        "content": "<p>\"beta can't be installed with rustup\"</p>",
        "id": 213293972,
        "sender_full_name": "Pietro Albini",
        "timestamp": 1602684778
    },
    {
        "content": "<p>that's definitely visible <span aria-label=\"laughing\" class=\"emoji emoji-1f606\" role=\"img\" title=\"laughing\">:laughing:</span></p>",
        "id": 213294034,
        "sender_full_name": "Joshua Nelson",
        "timestamp": 1602684804
    },
    {
        "content": "<p>\"thankfully\" breaking the release process is pretty visible <span aria-label=\"laughing\" class=\"emoji emoji-1f606\" role=\"img\" title=\"laughing\">:laughing:</span></p>",
        "id": 213294044,
        "sender_full_name": "Pietro Albini",
        "timestamp": 1602684808
    },
    {
        "content": "<p>ok then!</p>",
        "id": 213294307,
        "sender_full_name": "Pietro Albini",
        "timestamp": 1602684910
    },
    {
        "content": "<p>accepted all backports</p>",
        "id": 213294353,
        "sender_full_name": "Pietro Albini",
        "timestamp": 1602684929
    },
    {
        "content": "<p>moving onto the actual agenda</p>",
        "id": 213294366,
        "sender_full_name": "Pietro Albini",
        "timestamp": 1602684934
    },
    {
        "content": "<blockquote>\n<p>Switch to the new promote-release for everything and retire promote-release on RCS</p>\n</blockquote>",
        "id": 213294387,
        "sender_full_name": "Pietro Albini",
        "timestamp": 1602684943
    },
    {
        "content": "<p>so, the new <code>promote-release</code> has been pushing out nightlies for 6 days on <a href=\"http://dev-static.rust-lang.org\">dev-static.rust-lang.org</a></p>",
        "id": 213294510,
        "sender_full_name": "Pietro Albini",
        "timestamp": 1602684982
    },
    {
        "content": "<p>and last time I checked they were working fine</p>",
        "id": 213294537,
        "sender_full_name": "Pietro Albini",
        "timestamp": 1602684996
    },
    {
        "content": "<p>we also have CI testing that a local release of beta, stable and nightly works before every PR is merged <a href=\"https://github.com/rust-lang/promote-release/actions/runs/302137262\">https://github.com/rust-lang/promote-release/actions/runs/302137262</a></p>",
        "id": 213294649,
        "sender_full_name": "Pietro Albini",
        "timestamp": 1602685054
    },
    {
        "content": "<p>(the \"local release\" job does a local release for that branch, verifies the generated signatures are valid, and tries to install the release with rustup)</p>",
        "id": 213294750,
        "sender_full_name": "Pietro Albini",
        "timestamp": 1602685088
    },
    {
        "content": "<p>I feel pretty confident switching the release process from RCS to it now</p>",
        "id": 213294825,
        "sender_full_name": "Pietro Albini",
        "timestamp": 1602685127
    },
    {
        "content": "<p>(while keeping RCS still up to be able to easily revert to it)</p>",
        "id": 213294863,
        "sender_full_name": "Pietro Albini",
        "timestamp": 1602685146
    },
    {
        "content": "<p>what do y'all think?</p>",
        "id": 213294894,
        "sender_full_name": "Pietro Albini",
        "timestamp": 1602685158
    },
    {
        "content": "<p>Which channels would switching affect?</p>",
        "id": 213295110,
        "sender_full_name": "Jake Goulding",
        "timestamp": 1602685257
    },
    {
        "content": "<p>nightly, beta and the future stable (1.48.0)</p>",
        "id": 213295152,
        "sender_full_name": "Pietro Albini",
        "timestamp": 1602685281
    },
    {
        "content": "<p>before stable we'll put out a pre-release with it</p>",
        "id": 213295174,
        "sender_full_name": "Pietro Albini",
        "timestamp": 1602685295
    },
    {
        "content": "<p>(as we usually do)</p>",
        "id": 213295179,
        "sender_full_name": "Pietro Albini",
        "timestamp": 1602685298
    },
    {
        "content": "<p>I think moving to it is fine, but I would then wait like a whole release cycle before making any breaking changes (eevn if we update RCS)</p>",
        "id": 213295294,
        "sender_full_name": "Aidan Hobson Sayers",
        "timestamp": 1602685350
    },
    {
        "content": "<p>What's a breaking change in this context?</p>",
        "id": 213295325,
        "sender_full_name": "Jake Goulding",
        "timestamp": 1602685367
    },
    {
        "content": "<p>any change that requires an update to RCS in order to make sure it will still work</p>",
        "id": 213295443,
        "sender_full_name": "Aidan Hobson Sayers",
        "timestamp": 1602685438
    },
    {
        "content": "<p>so, the new rust-lang/promote-release codebase already diverged from the one in the RCS repository, and any change we made wouldn't be reflected in RCS</p>",
        "id": 213295632,
        "sender_full_name": "Pietro Albini",
        "timestamp": 1602685503
    },
    {
        "content": "<p>build-manifest in rust-lang/rust is shared between the new and old implementation, but invoked in a different way which toggles the internal behavior</p>",
        "id": 213295843,
        "sender_full_name": "Pietro Albini",
        "timestamp": 1602685570
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"117568\">@Aidan Hobson Sayers</span> so, you'd consider \"breaking change\" removing the legacy code path in build-manifest?</p>",
        "id": 213295919,
        "sender_full_name": "Pietro Albini",
        "timestamp": 1602685598
    },
    {
        "content": "<p>if we are updating RCS to use a new code path, and it's still the thing we're primarily using, that's fine. I'm less ok with doing refactoring on RCS when it isn't the thing we're primarily using</p>",
        "id": 213296234,
        "sender_full_name": "Aidan Hobson Sayers",
        "timestamp": 1602685726
    },
    {
        "content": "<p>hmm ok, makes sense</p>",
        "id": 213296588,
        "sender_full_name": "Pietro Albini",
        "timestamp": 1602685840
    },
    {
        "content": "<p>I think there is only one change we'd need to make that would require changing stuff on RCS</p>",
        "id": 213296670,
        "sender_full_name": "Pietro Albini",
        "timestamp": 1602685878
    },
    {
        "content": "<p>but it's totally impractical to make it on RCS anyway</p>",
        "id": 213296721,
        "sender_full_name": "Pietro Albini",
        "timestamp": 1602685899
    },
    {
        "content": "<p>gotcha</p>",
        "id": 213296912,
        "sender_full_name": "Aidan Hobson Sayers",
        "timestamp": 1602685956
    },
    {
        "content": "<p>that change is, we'd save around 1k$/month if we only stored .xz artifacts on <code>rust-lang-ci2</code> and we then recompressed them to <code>.gz</code> during the release process</p>",
        "id": 213296914,
        "sender_full_name": "Pietro Albini",
        "timestamp": 1602685957
    },
    {
        "content": "<p>but to avoid the release process being unreasonably slow we'd need to bump the core count up a bunch to take advantage of parallelism</p>",
        "id": 213297029,
        "sender_full_name": "Pietro Albini",
        "timestamp": 1602685994
    },
    {
        "content": "<p>with the new process we just change the instance type in CodeBuild, but with RCS we'd have to upgrade the whole instance and keep it on 24/7 at the increased size</p>",
        "id": 213297133,
        "sender_full_name": "Pietro Albini",
        "timestamp": 1602686026
    },
    {
        "content": "<p>but I think we can talk about that when we actually make that change</p>",
        "id": 213297387,
        "sender_full_name": "Pietro Albini",
        "timestamp": 1602686109
    },
    {
        "content": "<p>so, the consensus seems to be, let's make the switch now, let's make sure RCS is not broken after the switch for a while, and let's talk about recompression in the future?</p>",
        "id": 213297508,
        "sender_full_name": "Pietro Albini",
        "timestamp": 1602686149
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"261224\">@triagebot</span> await</p>",
        "id": 213297515,
        "sender_full_name": "Pietro Albini",
        "timestamp": 1602686153
    },
    {
        "content": "<p>Does anyone have something to add on the current topic?<br>\nReact with <span aria-label=\"working on it\" class=\"emoji emoji-1f6e0\" role=\"img\" title=\"working on it\">:working_on_it:</span> if you have something to say.<br>\nReact with <span aria-label=\"all good\" class=\"emoji emoji-2705\" role=\"img\" title=\"all good\">:all_good:</span> if not.</p>",
        "id": 213297519,
        "sender_full_name": "triagebot",
        "timestamp": 1602686154
    },
    {
        "content": "<p>ok! next topic!</p>",
        "id": 213297613,
        "sender_full_name": "Pietro Albini",
        "timestamp": 1602686183
    },
    {
        "content": "<blockquote>\n<p>Moving homu out of RCS</p>\n</blockquote>",
        "id": 213297670,
        "sender_full_name": "Pietro Albini",
        "timestamp": 1602686202
    },
    {
        "content": "<p>that's also mine: with the release process removed from RCS and cancelbot being useless in github actions, the only thing left on RCS is homu</p>",
        "id": 213297776,
        "sender_full_name": "Pietro Albini",
        "timestamp": 1602686233
    },
    {
        "content": "<p>and I think it'd be nice to move it to ECS like the rest of our bots and apps</p>",
        "id": 213297845,
        "sender_full_name": "Pietro Albini",
        "timestamp": 1602686263
    },
    {
        "content": "<p>the notable changes between the current setup and RCS would be:</p>\n<ul>\n<li>the sqlite database would be stored in EFS, which is a network file system -- my understanding is that sqlite is compatible with EFS</li>\n<li>we'd switch the domain from <a href=\"http://buildbot2.rust-lang.org/homu\">buildbot2.rust-lang.org/homu</a> to <a href=\"http://bors.rust-lang.org\">bors.rust-lang.org</a></li>\n</ul>",
        "id": 213298163,
        "sender_full_name": "Pietro Albini",
        "timestamp": 1602686369
    },
    {
        "content": "<p>also I was considering asking github to detach <a href=\"https://github.com/rust-lang/homu\">https://github.com/rust-lang/homu</a> from the servo repository (it's currently a fork of it)</p>",
        "id": 213298222,
        "sender_full_name": "Pietro Albini",
        "timestamp": 1602686400
    },
    {
        "content": "<p>any thoughts?</p>",
        "id": 213298260,
        "sender_full_name": "Pietro Albini",
        "timestamp": 1602686403
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"261224\">@triagebot</span> await</p>",
        "id": 213298845,
        "sender_full_name": "Pietro Albini",
        "timestamp": 1602686586
    },
    {
        "content": "<p>Does anyone have something to add on the current topic?<br>\nReact with <span aria-label=\"working on it\" class=\"emoji emoji-1f6e0\" role=\"img\" title=\"working on it\">:working_on_it:</span> if you have something to say.<br>\nReact with <span aria-label=\"all good\" class=\"emoji emoji-2705\" role=\"img\" title=\"all good\">:all_good:</span> if not.</p>",
        "id": 213298848,
        "sender_full_name": "triagebot",
        "timestamp": 1602686587
    },
    {
        "content": "<p>(if you don't have anything to add, is that a yes or no? <span aria-label=\"smile\" class=\"emoji emoji-1f642\" role=\"img\" title=\"smile\">:smile:</span>)</p>",
        "id": 213298901,
        "sender_full_name": "Pietro Albini",
        "timestamp": 1602686610
    },
    {
        "content": "<p><span aria-label=\"wave\" class=\"emoji emoji-1f44b\" role=\"img\" title=\"wave\">:wave:</span> I am just finished with my exam, have not read scrollback yet though</p>",
        "id": 213299289,
        "sender_full_name": "simulacrum",
        "timestamp": 1602686710
    },
    {
        "content": "<p>the current topic starts at <a href=\"#narrow/stream/242791-t-infra/topic/2020-10-14.20meeting/near/213297670\">https://rust-lang.zulipchat.com/#narrow/stream/242791-t-infra/topic/2020-10-14.20meeting/near/213297670</a></p>",
        "id": 213299362,
        "sender_full_name": "Pietro Albini",
        "timestamp": 1602686733
    },
    {
        "content": "<p>Nothing to add</p>",
        "id": 213299508,
        "sender_full_name": "simulacrum",
        "timestamp": 1602686774
    },
    {
        "content": "<p>Seems good</p>",
        "id": 213299514,
        "sender_full_name": "simulacrum",
        "timestamp": 1602686776
    },
    {
        "content": "<p>ok then</p>",
        "id": 213299609,
        "sender_full_name": "Pietro Albini",
        "timestamp": 1602686810
    },
    {
        "content": "<p>we only have one item left on the agenda, and it's private</p>",
        "id": 213299642,
        "sender_full_name": "Pietro Albini",
        "timestamp": 1602686826
    },
    {
        "content": "<p>so let's switch to the private stream</p>",
        "id": 213299690,
        "sender_full_name": "Pietro Albini",
        "timestamp": 1602686833
    },
    {
        "content": "<p><span aria-label=\"wave\" class=\"emoji emoji-1f44b\" role=\"img\" title=\"wave\">:wave:</span></p>",
        "id": 213299697,
        "sender_full_name": "Pietro Albini",
        "timestamp": 1602686838
    },
    {
        "content": "<p>quick thought on \"we'd switch the domain from <a href=\"http://buildbot2.rust-lang.org/homu\">buildbot2.rust-lang.org/homu</a> to <a href=\"http://bors.rust-lang.org\">bors.rust-lang.org</a>\" - have we fully understood the complexities? every time this came up there was some deep obscure reason this would be hard, and I don't remember it <span aria-label=\"sweat smile\" class=\"emoji emoji-1f605\" role=\"img\" title=\"sweat smile\">:sweat_smile:</span></p>",
        "id": 213301189,
        "sender_full_name": "Aidan Hobson Sayers",
        "timestamp": 1602687476
    },
    {
        "content": "<p>we're serving on both domains right now</p>",
        "id": 213301265,
        "sender_full_name": "simulacrum",
        "timestamp": 1602687510
    },
    {
        "content": "<p>Need to do something so that Google prefers the short one. I always forget the URL and the buildbot2 one is the one that comes up in searches.</p>",
        "id": 213301721,
        "sender_full_name": "Jake Goulding",
        "timestamp": 1602687685
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"116155\">@Jake Goulding</span> I'd expect to have redirects in place</p>",
        "id": 213301803,
        "sender_full_name": "Pietro Albini",
        "timestamp": 1602687713
    }
]