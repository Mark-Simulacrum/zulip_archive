[
    {
        "content": "<p><span class=\"user-group-mention\" data-user-group-id=\"2943\">@T-infra</span> T-7 minutes!</p>",
        "id": 234193033,
        "sender_full_name": "Pietro Albini",
        "timestamp": 1618246418
    },
    {
        "content": "<p>I'm in training again this week; nothing interesting to report, other than I really wish rustfmt was building.</p>",
        "id": 234193873,
        "sender_full_name": "Jake Goulding",
        "timestamp": 1618246755
    },
    {
        "content": "<p><span class=\"user-group-mention\" data-user-group-id=\"2943\">@T-infra</span> meeting time!</p>",
        "id": 234194048,
        "sender_full_name": "Pietro Albini",
        "timestamp": 1618246815
    },
    {
        "content": "<p>o/</p>",
        "id": 234194080,
        "sender_full_name": "kennytm",
        "timestamp": 1618246825
    },
    {
        "content": "<p>o/</p>",
        "id": 234194142,
        "sender_full_name": "simulacrum",
        "timestamp": 1618246847
    },
    {
        "content": "<p>I think it's the first meeting of the month loosely speaking, right?</p>",
        "id": 234194330,
        "sender_full_name": "simulacrum",
        "timestamp": 1618246921
    },
    {
        "content": "<p>we didn't do issue triage last week</p>",
        "id": 234194382,
        "sender_full_name": "simulacrum",
        "timestamp": 1618246926
    },
    {
        "content": "<p>oh right I was going to say \"we have no issues to look at\" but you're right, last week's monday was a holiday in most of the EU and the meeting was... short :)</p>",
        "id": 234194476,
        "sender_full_name": "Pietro Albini",
        "timestamp": 1618246957
    },
    {
        "content": "<p>let's start with those then</p>",
        "id": 234194575,
        "sender_full_name": "Pietro Albini",
        "timestamp": 1618246988
    },
    {
        "content": "<p>Cargotest enhancements <a href=\"https://github.com/rust-lang/rust/issues/70659\">#70659</a></p>",
        "id": 234194631,
        "sender_full_name": "Pietro Albini",
        "timestamp": 1618247007
    },
    {
        "content": "<p>I'd say... let's stop tracking that issue?</p>",
        "id": 234194816,
        "sender_full_name": "Pietro Albini",
        "timestamp": 1618247072
    },
    {
        "content": "<p>o/</p>",
        "id": 234194855,
        "sender_full_name": "Aidan Hobson Sayers",
        "timestamp": 1618247094
    },
    {
        "content": "<p>I wouldn't go as far as closing it, but it's not high priority and there is nobody willing to work on it</p>",
        "id": 234194861,
        "sender_full_name": "Pietro Albini",
        "timestamp": 1618247100
    },
    {
        "content": "<p>hm, in what way?</p>",
        "id": 234194932,
        "sender_full_name": "simulacrum",
        "timestamp": 1618247127
    },
    {
        "content": "<p>like, it's p-medium</p>",
        "id": 234194940,
        "sender_full_name": "simulacrum",
        "timestamp": 1618247130
    },
    {
        "content": "<p>yeah, that was a bad choice of words re-reading that :)</p>",
        "id": 234195002,
        "sender_full_name": "Pietro Albini",
        "timestamp": 1618247150
    },
    {
        "content": "<p>I think we could untag it, I suppose, or lower to p-low</p>",
        "id": 234195003,
        "sender_full_name": "simulacrum",
        "timestamp": 1618247151
    },
    {
        "content": "<p>p-low sounds good - that's implicitly where it is anyway</p>",
        "id": 234195092,
        "sender_full_name": "Aidan Hobson Sayers",
        "timestamp": 1618247177
    },
    {
        "content": "<p>I don't think checking in every month is useful, let's move it to p-low</p>",
        "id": 234195111,
        "sender_full_name": "Pietro Albini",
        "timestamp": 1618247184
    },
    {
        "content": "<p>Re-enable LLVM and debug assertions for slow builders <a href=\"https://github.com/rust-lang/rust/issues/59637\">#59637</a></p>",
        "id": 234195149,
        "sender_full_name": "Pietro Albini",
        "timestamp": 1618247204
    },
    {
        "content": "<p>same as always, our macOS builders aren't fast enough to re-enable this</p>",
        "id": 234195174,
        "sender_full_name": "Pietro Albini",
        "timestamp": 1618247218
    },
    {
        "content": "<p>macOS packages and Windows MSIs are not signed <a href=\"https://github.com/rust-lang/rust/issues/27694\">#27694</a></p>",
        "id": 234195220,
        "sender_full_name": "Pietro Albini",
        "timestamp": 1618247240
    },
    {
        "content": "<p>I think we should keep tracking it - was there some monitoring work going on behind the scenes on this?</p>",
        "id": 234195226,
        "sender_full_name": "simulacrum",
        "timestamp": 1618247243
    },
    {
        "content": "<p>(uh, for 59637)</p>",
        "id": 234195241,
        "sender_full_name": "simulacrum",
        "timestamp": 1618247250
    },
    {
        "content": "<p>IIRC I saw some monitorbot pr</p>",
        "id": 234195248,
        "sender_full_name": "simulacrum",
        "timestamp": 1618247257
    },
    {
        "content": "<p>maybe someday we'll get M1 macs which are apparently significantly faster ;)</p>",
        "id": 234195250,
        "sender_full_name": "Aidan Hobson Sayers",
        "timestamp": 1618247258
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"116122\">simulacrum</span> <a href=\"#narrow/stream/242791-t-infra/topic/meeting.202021-04-12/near/234195226\">said</a>:</p>\n<blockquote>\n<p>I think we should keep tracking it - was there some monitoring work going on behind the scenes on this?</p>\n</blockquote>\n<p>so, we should definitely keep tracking <a href=\"https://github.com/rust-lang/rust/issues/59637\">#59637</a>, mostly as a reminder to re-enable those once CI gets faster</p>",
        "id": 234195364,
        "sender_full_name": "Pietro Albini",
        "timestamp": 1618247297
    },
    {
        "content": "<p>but the monitorbot PR is more about monitoring our self-hosted agents</p>",
        "id": 234195391,
        "sender_full_name": "Pietro Albini",
        "timestamp": 1618247310
    },
    {
        "content": "<p>right, I'm saying - are we tracking that CI gets faster thing yet? I know I've been thinking about some metrics there recently while looking at the crater/perf.rust-lang.org metrics</p>",
        "id": 234195443,
        "sender_full_name": "simulacrum",
        "timestamp": 1618247337
    },
    {
        "content": "<p>I think alex's tool to monitor CI times got broken at some point (possibly due to the gha migration), and that was our only way to have graphs of PR times</p>",
        "id": 234195611,
        "sender_full_name": "Pietro Albini",
        "timestamp": 1618247404
    },
    {
        "content": "<p>ok, that's what I thought</p>",
        "id": 234195793,
        "sender_full_name": "simulacrum",
        "timestamp": 1618247481
    },
    {
        "content": "<p>anyway, we can move on</p>",
        "id": 234195815,
        "sender_full_name": "simulacrum",
        "timestamp": 1618247494
    },
    {
        "content": "<p>the perf improvements I think we need to get before we can re-enable assertions are in the order of half hour/one hour though, and that'd be a big enough change we'd notice without monitoring, especially because it'd likely require getting faster machines</p>",
        "id": 234195862,
        "sender_full_name": "Pietro Albini",
        "timestamp": 1618247519
    },
    {
        "content": "<p>getting monitoring up for PR times eventually would be great</p>",
        "id": 234195929,
        "sender_full_name": "Pietro Albini",
        "timestamp": 1618247534
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"261224\">@triagebot</span> await</p>",
        "id": 234195973,
        "sender_full_name": "Pietro Albini",
        "timestamp": 1618247551
    },
    {
        "content": "<p>Does anyone have something to add on the current topic?<br>\nReact with <span aria-label=\"working on it\" class=\"emoji emoji-1f6e0\" role=\"img\" title=\"working on it\">:working_on_it:</span> if you have something to say.<br>\nReact with <span aria-label=\"all good\" class=\"emoji emoji-2705\" role=\"img\" title=\"all good\">:all_good:</span> if not.</p>",
        "id": 234195976,
        "sender_full_name": "triagebot",
        "timestamp": 1618247552
    },
    {
        "content": "<p>ok! last p-medium issue is \"macOS packages and Windows MSIs are not signed <a href=\"https://github.com/rust-lang/rust/issues/27694\">#27694</a>\"</p>",
        "id": 234196050,
        "sender_full_name": "Pietro Albini",
        "timestamp": 1618247589
    },
    {
        "content": "<p>this feels like an issue that the foundation may be able to help us with</p>",
        "id": 234196134,
        "sender_full_name": "Aidan Hobson Sayers",
        "timestamp": 1618247635
    },
    {
        "content": "<p>there wasn't progress on my end on this, and yeah we should bubble this up to the foundation</p>",
        "id": 234196206,
        "sender_full_name": "Pietro Albini",
        "timestamp": 1618247654
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"261224\">@triagebot</span> await</p>",
        "id": 234196305,
        "sender_full_name": "Pietro Albini",
        "timestamp": 1618247699
    },
    {
        "content": "<p>Does anyone have something to add on the current topic?<br>\nReact with <span aria-label=\"working on it\" class=\"emoji emoji-1f6e0\" role=\"img\" title=\"working on it\">:working_on_it:</span> if you have something to say.<br>\nReact with <span aria-label=\"all good\" class=\"emoji emoji-2705\" role=\"img\" title=\"all good\">:all_good:</span> if not.</p>",
        "id": 234196306,
        "sender_full_name": "triagebot",
        "timestamp": 1618247700
    },
    {
        "content": "<p>ok, I'll work with you on bubbling up/handing over</p>",
        "id": 234196331,
        "sender_full_name": "Aidan Hobson Sayers",
        "timestamp": 1618247712
    },
    {
        "content": "<blockquote>\n<p>I really wish rustfmt was building.</p>\n</blockquote>\n<p><span class=\"user-mention silent\" data-user-id=\"320317\">Caleb Cartwright</span> and I have been working intermittently on turning rustfmt into a subtree</p>",
        "id": 234196354,
        "sender_full_name": "Joshua Nelson",
        "timestamp": 1618247725
    },
    {
        "content": "<p><span aria-label=\"thumbs up\" class=\"emoji emoji-1f44d\" role=\"img\" title=\"thumbs up\">:thumbs_up:</span> I suspect it's a pretty light thing to bubble up, the vast majority of the work IIRC was on the implementation rather than policy/cost side here.</p>",
        "id": 234196382,
        "sender_full_name": "simulacrum",
        "timestamp": 1618247743
    },
    {
        "content": "<p>Unfortunately most of his time is currently being spent on fixing toolstate :( sort of a chicken and egg problem</p>",
        "id": 234196408,
        "sender_full_name": "Joshua Nelson",
        "timestamp": 1618247758
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"116122\">simulacrum</span> <a href=\"#narrow/stream/242791-t-infra/topic/meeting.202021-04-12/near/234196382\">said</a>:</p>\n<blockquote>\n<p><span aria-label=\"thumbs up\" class=\"emoji emoji-1f44d\" role=\"img\" title=\"thumbs up\">:thumbs_up:</span> I suspect it's a pretty light thing to bubble up, the vast majority of the work IIRC was on the implementation rather than policy/cost side here.</p>\n</blockquote>\n<p>yes, but some parts of the impl depend on what certs we buy (especially around windows ones)</p>",
        "id": 234196519,
        "sender_full_name": "Pietro Albini",
        "timestamp": 1618247796
    },
    {
        "content": "<p>anyway, moving on the agenda</p>",
        "id": 234196549,
        "sender_full_name": "Pietro Albini",
        "timestamp": 1618247810
    },
    {
        "content": "<p>the first item there is <a href=\"http://crates.io\">crates.io</a> monitoring</p>",
        "id": 234196609,
        "sender_full_name": "Pietro Albini",
        "timestamp": 1618247830
    },
    {
        "content": "<p><a href=\"https://paper.dropbox.com/doc/crates.io-monitoring--BItvKW0ViHGOuH1jJgNdgh5QAg-JWf5AxfJ1Nbc3lLuNcaTy\">https://paper.dropbox.com/doc/crates.io-monitoring--BItvKW0ViHGOuH1jJgNdgh5QAg-JWf5AxfJ1Nbc3lLuNcaTy</a></p>",
        "id": 234196611,
        "sender_full_name": "Pietro Albini",
        "timestamp": 1618247830
    },
    {
        "content": "<p>the doc there is finished, and I'd love to hear what y'all think</p>",
        "id": 234196649,
        "sender_full_name": "Pietro Albini",
        "timestamp": 1618247851
    },
    {
        "content": "<p>(I still think the \"run prometheus on dynos\" is the best approach)</p>",
        "id": 234196678,
        "sender_full_name": "Pietro Albini",
        "timestamp": 1618247866
    },
    {
        "content": "<p>Yeah, I need to respond to your comments still. I am leaning towards that option as well, but need to do some more thinking and research -- I'll try to leave additional feedback by EOD tomorrow.</p>",
        "id": 234196830,
        "sender_full_name": "simulacrum",
        "timestamp": 1618247922
    },
    {
        "content": "<p>One thing on that actually</p>",
        "id": 234196940,
        "sender_full_name": "simulacrum",
        "timestamp": 1618247981
    },
    {
        "content": "<p>From what I can tell, if we do end up going with the remote write API, we'll require an update to our prometheus server no matter what. Since it seems good to update regardless, and brings us some other improvements (nothing too noteworthy, but nice), should we try to do that sooner rather than later?</p>",
        "id": 234197084,
        "sender_full_name": "simulacrum",
        "timestamp": 1618248034
    },
    {
        "content": "<p>that sounds great, I'll look into it over this week</p>",
        "id": 234197118,
        "sender_full_name": "Pietro Albini",
        "timestamp": 1618248051
    },
    {
        "content": "<p>I think we'll potentially want to not hop ~12 versions in one go, but some research on that is likely necessary :)</p>",
        "id": 234197193,
        "sender_full_name": "simulacrum",
        "timestamp": 1618248079
    },
    {
        "content": "<p>my plan was to test the upgrade on my local copy of the monitoring VM to see how the upgrade goes</p>",
        "id": 234197269,
        "sender_full_name": "Pietro Albini",
        "timestamp": 1618248118
    },
    {
        "content": "<p>Yeah, that sounds like an excellent plan.</p>",
        "id": 234197319,
        "sender_full_name": "simulacrum",
        "timestamp": 1618248128
    },
    {
        "content": "<p><span aria-label=\"thumbs up\" class=\"emoji emoji-1f44d\" role=\"img\" title=\"thumbs up\">:thumbs_up:</span></p>",
        "id": 234197379,
        "sender_full_name": "Pietro Albini",
        "timestamp": 1618248154
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"261224\">@triagebot</span> await</p>",
        "id": 234197384,
        "sender_full_name": "Pietro Albini",
        "timestamp": 1618248160
    },
    {
        "content": "<p>Does anyone have something to add on the current topic?<br>\nReact with <span aria-label=\"working on it\" class=\"emoji emoji-1f6e0\" role=\"img\" title=\"working on it\">:working_on_it:</span> if you have something to say.<br>\nReact with <span aria-label=\"all good\" class=\"emoji emoji-2705\" role=\"img\" title=\"all good\">:all_good:</span> if not.</p>",
        "id": 234197388,
        "sender_full_name": "triagebot",
        "timestamp": 1618248161
    },
    {
        "content": "<p>ok!</p>",
        "id": 234197484,
        "sender_full_name": "Pietro Albini",
        "timestamp": 1618248206
    },
    {
        "content": "<p>any other topics to bring up?</p>",
        "id": 234197507,
        "sender_full_name": "Pietro Albini",
        "timestamp": 1618248215
    },
    {
        "content": "<p>I'm wondering if there is something infra can do to help with subtrees (cc <span class=\"user-mention\" data-user-id=\"232545\">@Joshua Nelson</span>)</p>",
        "id": 234197565,
        "sender_full_name": "Pietro Albini",
        "timestamp": 1618248240
    },
    {
        "content": "<p>I don't think so</p>",
        "id": 234197673,
        "sender_full_name": "simulacrum",
        "timestamp": 1618248274
    },
    {
        "content": "<p>I did have a minor topic (also on monitoring as it so happens)</p>",
        "id": 234197688,
        "sender_full_name": "simulacrum",
        "timestamp": 1618248284
    },
    {
        "content": "<p>(One sec zulip is being buggy)</p>",
        "id": 234197704,
        "sender_full_name": "Joshua Nelson",
        "timestamp": 1618248293
    },
    {
        "content": "<p>but it's mostly just a wish list thing - I was annoyed a bit recently at just having 7 days history</p>",
        "id": 234197739,
        "sender_full_name": "simulacrum",
        "timestamp": 1618248307
    },
    {
        "content": "<p>I don't think so really - there are already instructions for doing syncs in the clippy readme and I don't think it's <em>too</em> complicated other than that</p>",
        "id": 234197812,
        "sender_full_name": "Joshua Nelson",
        "timestamp": 1618248338
    },
    {
        "content": "<p>Other than every tool being different, but like, that's not something you can plan for</p>",
        "id": 234197843,
        "sender_full_name": "Joshua Nelson",
        "timestamp": 1618248356
    },
    {
        "content": "<p>hmm <span class=\"user-mention\" data-user-id=\"116122\">@simulacrum</span>, how much history would you need?</p>",
        "id": 234197958,
        "sender_full_name": "Pietro Albini",
        "timestamp": 1618248385
    },
    {
        "content": "<p>I was thinking we could go to a month or so, it's mostly just that it can be hard to see trends right now</p>",
        "id": 234197997,
        "sender_full_name": "simulacrum",
        "timestamp": 1618248402
    },
    {
        "content": "<p>right now 7 days use roughly 3gb of storage</p>",
        "id": 234198059,
        "sender_full_name": "Pietro Albini",
        "timestamp": 1618248427
    },
    {
        "content": "<p>but ultimately we want something more like a year for that, likely with downsampling, which is pretty annoying to do with prometheus as far as I can tell</p>",
        "id": 234198095,
        "sender_full_name": "simulacrum",
        "timestamp": 1618248443
    },
    {
        "content": "<p>(OTOH, 3gb -&gt; 1 year = ~160 GB, which seems quite small)</p>",
        "id": 234198157,
        "sender_full_name": "simulacrum",
        "timestamp": 1618248476
    },
    {
        "content": "<p>but anyway, as I said, no big deal either way</p>",
        "id": 234198266,
        "sender_full_name": "simulacrum",
        "timestamp": 1618248512
    },
    {
        "content": "<p>switching to a month is trivial, I can do it right after this meeting</p>",
        "id": 234198316,
        "sender_full_name": "Pietro Albini",
        "timestamp": 1618248539
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"116122\">@simulacrum</span> could you look more into prometheus downsampling so we can decide what to store in the long term?</p>",
        "id": 234198506,
        "sender_full_name": "Pietro Albini",
        "timestamp": 1618248612
    },
    {
        "content": "<p>afaik, it's not supported natively</p>",
        "id": 234198522,
        "sender_full_name": "simulacrum",
        "timestamp": 1618248621
    },
    {
        "content": "<p>you have to switch to some other storage backend</p>",
        "id": 234198558,
        "sender_full_name": "simulacrum",
        "timestamp": 1618248635
    },
    {
        "content": "<p>but ultimately the trends thing is more of a 'mark likes longer graphs' not a 'mark has reasons to believe this is helpful'</p>",
        "id": 234198604,
        "sender_full_name": "simulacrum",
        "timestamp": 1618248657
    },
    {
        "content": "<p>who doesn't like longer graphs</p>",
        "id": 234198634,
        "sender_full_name": "Pietro Albini",
        "timestamp": 1618248673
    },
    {
        "content": "<p>I agree that even the ~150gb for a full year does not really make a dent in our infra costs, but my worry with that is it makes adding more metrics a thing we should think about</p>",
        "id": 234198671,
        "sender_full_name": "Pietro Albini",
        "timestamp": 1618248696
    },
    {
        "content": "<p>the other side is that if we look to set up more alerting, a month will help to calibrate the trigger conditions</p>",
        "id": 234198677,
        "sender_full_name": "simulacrum",
        "timestamp": 1618248697
    },
    {
        "content": "<p>but in any case, let's switch to a month and we can do some more thinking in the long run</p>",
        "id": 234198815,
        "sender_full_name": "simulacrum",
        "timestamp": 1618248746
    },
    {
        "content": "<p>yep</p>",
        "id": 234198845,
        "sender_full_name": "Pietro Albini",
        "timestamp": 1618248764
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"261224\">@triagebot</span> end-meeting</p>",
        "id": 234198856,
        "sender_full_name": "Pietro Albini",
        "timestamp": 1618248769
    },
    {
        "content": "<p>Does anyone have something to bring up?<br>\nReact with <span aria-label=\"working on it\" class=\"emoji emoji-1f6e0\" role=\"img\" title=\"working on it\">:working_on_it:</span> if you have something to say.<br>\nReact with <span aria-label=\"all good\" class=\"emoji emoji-2705\" role=\"img\" title=\"all good\">:all_good:</span> if you're ready to end the meeting.</p>",
        "id": 234198859,
        "sender_full_name": "triagebot",
        "timestamp": 1618248769
    },
    {
        "content": "<p>thanks everyone for attending then!</p>",
        "id": 234199025,
        "sender_full_name": "Pietro Albini",
        "timestamp": 1618248835
    },
    {
        "content": "<p>\\o</p>",
        "id": 234199027,
        "sender_full_name": "Pietro Albini",
        "timestamp": 1618248836
    },
    {
        "content": "<p>\\o</p>",
        "id": 234199113,
        "sender_full_name": "Aidan Hobson Sayers",
        "timestamp": 1618248857
    },
    {
        "content": "<p>\\o</p>",
        "id": 234199125,
        "sender_full_name": "kennytm",
        "timestamp": 1618248863
    },
    {
        "content": "<p>\\o</p>",
        "id": 234199133,
        "sender_full_name": "simulacrum",
        "timestamp": 1618248868
    },
    {
        "content": "<p>\\o</p>",
        "id": 234199229,
        "sender_full_name": "Joshua Nelson",
        "timestamp": 1618248916
    }
]