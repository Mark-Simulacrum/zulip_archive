[
    {
        "content": "<p><span class=\"user-group-mention\" data-user-group-id=\"2943\">@T-infra</span> T-3 minutes</p>",
        "id": 216355878,
        "sender_full_name": "Jake Goulding",
        "timestamp": 1605106646
    },
    {
        "content": "<p>o/</p>",
        "id": 216356179,
        "sender_full_name": "Jake Goulding",
        "timestamp": 1605106800
    },
    {
        "content": "<p>o/</p>",
        "id": 216356239,
        "sender_full_name": "simulacrum",
        "timestamp": 1605106810
    },
    {
        "content": "<p><span class=\"user-group-mention\" data-user-group-id=\"2943\">@T-infra</span> meeting time! o/</p>",
        "id": 216356593,
        "sender_full_name": "Pietro Albini",
        "timestamp": 1605106968
    },
    {
        "content": "<p>ok, let's start</p>",
        "id": 216356836,
        "sender_full_name": "Pietro Albini",
        "timestamp": 1605107082
    },
    {
        "content": "<p>we have one P-high issue: <a href=\"https://github.com/rust-lang/rust/issues/78743\">https://github.com/rust-lang/rust/issues/78743</a></p>",
        "id": 216356906,
        "sender_full_name": "Pietro Albini",
        "timestamp": 1605107112
    },
    {
        "content": "<blockquote>\n<p>Spurious failure trying to checkout the repository</p>\n</blockquote>",
        "id": 216356933,
        "sender_full_name": "Pietro Albini",
        "timestamp": 1605107124
    },
    {
        "content": "<p>last week builds on github actions were failing during the \"setup\" stage, because cloning the actions/checkout action failed</p>",
        "id": 216357099,
        "sender_full_name": "Pietro Albini",
        "timestamp": 1605107181
    },
    {
        "content": "<p>after a chat with github support I enabled debug logging for rust-lang-ci/rust, but since then the error disappeared</p>",
        "id": 216357145,
        "sender_full_name": "Pietro Albini",
        "timestamp": 1605107206
    },
    {
        "content": "<p>now, debug logging is kinda annoying, because it messes up github's log viewer</p>",
        "id": 216357232,
        "sender_full_name": "Pietro Albini",
        "timestamp": 1605107259
    },
    {
        "content": "<p>o/</p>",
        "id": 216357265,
        "sender_full_name": "Aidan Hobson Sayers",
        "timestamp": 1605107281
    },
    {
        "content": "<p>for example, when opening a failed build, it will focus on the skipped \"upload artifacts\" instead of the failed \"run the build\" step</p>",
        "id": 216357289,
        "sender_full_name": "Pietro Albini",
        "timestamp": 1605107283
    },
    {
        "content": "<p>enabling or disabling debug logging does not require landing changes</p>",
        "id": 216357338,
        "sender_full_name": "Pietro Albini",
        "timestamp": 1605107299
    },
    {
        "content": "<p>what I propose is we disable debug logging, and then re-enable it as soon as we see that failure again</p>",
        "id": 216357361,
        "sender_full_name": "Pietro Albini",
        "timestamp": 1605107316
    },
    {
        "content": "<p>I still prefer raw logs anyway, but yeah seems good</p>",
        "id": 216357372,
        "sender_full_name": "simulacrum",
        "timestamp": 1605107321
    },
    {
        "content": "<p>what do y'all think?</p>",
        "id": 216357373,
        "sender_full_name": "Pietro Albini",
        "timestamp": 1605107322
    },
    {
        "content": "<p>so I'm clear - we reckon the problem is in github actions, and the debugging is to help us help them?</p>",
        "id": 216357486,
        "sender_full_name": "Aidan Hobson Sayers",
        "timestamp": 1605107390
    },
    {
        "content": "<p>yes</p>",
        "id": 216357504,
        "sender_full_name": "Pietro Albini",
        "timestamp": 1605107397
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"261224\">@triagebot</span> await</p>",
        "id": 216357704,
        "sender_full_name": "Pietro Albini",
        "timestamp": 1605107503
    },
    {
        "content": "<p>Does anyone have something to add on the current topic?<br>\nReact with <span aria-label=\"working on it\" class=\"emoji emoji-1f6e0\" role=\"img\" title=\"working on it\">:working_on_it:</span> if you have something to say.<br>\nReact with <span aria-label=\"all good\" class=\"emoji emoji-2705\" role=\"img\" title=\"all good\">:all_good:</span> if not.</p>",
        "id": 216357707,
        "sender_full_name": "triagebot",
        "timestamp": 1605107504
    },
    {
        "content": "<blockquote>\n<p>does not require landing changes</p>\n</blockquote>\n<p>That seems nice then.</p>",
        "id": 216357717,
        "sender_full_name": "Jake Goulding",
        "timestamp": 1605107513
    },
    {
        "content": "<p><em>Maybe</em> a little blurb somewhere to show how other people can change it if you aren't around?</p>",
        "id": 216357818,
        "sender_full_name": "Jake Goulding",
        "timestamp": 1605107553
    },
    {
        "content": "<p>who is able to do the change?</p>",
        "id": 216357838,
        "sender_full_name": "Aidan Hobson Sayers",
        "timestamp": 1605107568
    },
    {
        "content": "<p><a href=\"https://github.com/orgs/rust-lang-ci/teams/infra\">https://github.com/orgs/rust-lang-ci/teams/infra</a></p>",
        "id": 216357898,
        "sender_full_name": "Pietro Albini",
        "timestamp": 1605107597
    },
    {
        "content": "<p>so everyone but <span class=\"user-mention\" data-user-id=\"117568\">@Aidan Hobson Sayers</span> (you need to accept the invitation to the org)</p>",
        "id": 216357930,
        "sender_full_name": "Pietro Albini",
        "timestamp": 1605107611
    },
    {
        "content": "<p>invitation expired <span aria-label=\"grimacing\" class=\"emoji emoji-1f62c\" role=\"img\" title=\"grimacing\">:grimacing:</span> I've got better at github notifications these days</p>",
        "id": 216358059,
        "sender_full_name": "Aidan Hobson Sayers",
        "timestamp": 1605107658
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"117568\">@Aidan Hobson Sayers</span> sent again</p>",
        "id": 216358196,
        "sender_full_name": "Pietro Albini",
        "timestamp": 1605107733
    },
    {
        "content": "<p>ok then! I'll write instructions on the issue :)</p>",
        "id": 216358228,
        "sender_full_name": "Pietro Albini",
        "timestamp": 1605107747
    },
    {
        "content": "<p>next up is the first item from the agenda</p>",
        "id": 216358326,
        "sender_full_name": "Pietro Albini",
        "timestamp": 1605107778
    },
    {
        "content": "<blockquote>\n<p>monitorbot is live!</p>\n</blockquote>",
        "id": 216358329,
        "sender_full_name": "Pietro Albini",
        "timestamp": 1605107780
    },
    {
        "content": "<p>thanks to <span class=\"user-mention\" data-user-id=\"344082\">@Nelson J Morais</span>'s work, monitorbot is now live, generating graphs of the github rate limits of all our bot accounts</p>",
        "id": 216358384,
        "sender_full_name": "Pietro Albini",
        "timestamp": 1605107804
    },
    {
        "content": "<p>the dashboard is available at <a href=\"https://grafana.rust-lang.org/d/UYXBA3hGz/github\">https://grafana.rust-lang.org/d/UYXBA3hGz/github</a> (infra team members only)</p>",
        "id": 216358412,
        "sender_full_name": "Pietro Albini",
        "timestamp": 1605107819
    },
    {
        "content": "<p>if you feel like something extra should be monitored by it open an issue at <a href=\"https://github.com/rust-lang/monitorbot\">https://github.com/rust-lang/monitorbot</a> :)</p>",
        "id": 216358483,
        "sender_full_name": "Pietro Albini",
        "timestamp": 1605107862
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"261224\">@triagebot</span> await</p>",
        "id": 216358559,
        "sender_full_name": "Pietro Albini",
        "timestamp": 1605107887
    },
    {
        "content": "<p>Does anyone have something to add on the current topic?<br>\nReact with <span aria-label=\"working on it\" class=\"emoji emoji-1f6e0\" role=\"img\" title=\"working on it\">:working_on_it:</span> if you have something to say.<br>\nReact with <span aria-label=\"all good\" class=\"emoji emoji-2705\" role=\"img\" title=\"all good\">:all_good:</span> if not.</p>",
        "id": 216358562,
        "sender_full_name": "triagebot",
        "timestamp": 1605107887
    },
    {
        "content": "<p>shiny</p>",
        "id": 216358577,
        "sender_full_name": "Jake Goulding",
        "timestamp": 1605107893
    },
    {
        "content": "<p>ok then!</p>",
        "id": 216358622,
        "sender_full_name": "Pietro Albini",
        "timestamp": 1605107921
    },
    {
        "content": "<p>next and last item on the agenda is \"Move the website and rfcbot from Heroku to AWS\", from me</p>",
        "id": 216358658,
        "sender_full_name": "Pietro Albini",
        "timestamp": 1605107941
    },
    {
        "content": "<p>both <a href=\"http://www.rust-lang.org\">www.rust-lang.org</a> and <a href=\"http://rfcbot.rs\">rfcbot.rs</a> are currently hosted on heroku</p>",
        "id": 216358710,
        "sender_full_name": "Pietro Albini",
        "timestamp": 1605107967
    },
    {
        "content": "<p>I am strongly in favor of centralizing here</p>",
        "id": 216358724,
        "sender_full_name": "simulacrum",
        "timestamp": 1605107975
    },
    {
        "content": "<p>I feel I developed our ECS environment so that moving stuff on AWS does not regress the maintenability</p>",
        "id": 216358771,
        "sender_full_name": "Pietro Albini",
        "timestamp": 1605108000
    },
    {
        "content": "<p>for example, this was all needed to deploy monitorbot today -- <a href=\"https://github.com/rust-lang/simpleinfra/blob/master/terraform/monitorbot/app.tf\">https://github.com/rust-lang/simpleinfra/blob/master/terraform/monitorbot/app.tf</a></p>",
        "id": 216358850,
        "sender_full_name": "Pietro Albini",
        "timestamp": 1605108017
    },
    {
        "content": "<p>the main concern I think is that we can continue granting people who need it access to logs and redeployment</p>",
        "id": 216358913,
        "sender_full_name": "simulacrum",
        "timestamp": 1605108045
    },
    {
        "content": "<p>but I think ultimately that'll be easier on aws than dealing with moz</p>",
        "id": 216358971,
        "sender_full_name": "simulacrum",
        "timestamp": 1605108075
    },
    {
        "content": "<p>and centralizing everything on AWS allows to share authentication and permissions with the setup we already have, along with the ability to make improvements across all apps</p>",
        "id": 216358981,
        "sender_full_name": "Pietro Albini",
        "timestamp": 1605108079
    },
    {
        "content": "<p>I'm +1 on rfcbot</p>",
        "id": 216359053,
        "sender_full_name": "Aidan Hobson Sayers",
        "timestamp": 1605108112
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"116122\">@simulacrum</span> that's actually way easier, because heroku's ACLs are not granular enough -- for example we can't grant access to the logs without granting the ability to deploy arbitrary code, since both of those are under the \"operate\" perm</p>",
        "id": 216359065,
        "sender_full_name": "Pietro Albini",
        "timestamp": 1605108120
    },
    {
        "content": "<p>right yes</p>",
        "id": 216359153,
        "sender_full_name": "simulacrum",
        "timestamp": 1605108152
    },
    {
        "content": "<p>so, what I propose then is this:</p>\n<p>heroku's rfcbot-rs =&gt; rfcbot on ecs with 1 active instance<br>\nheroku's rust-www-staging =&gt; www-staging on ecs with 1 active instance<br>\nheroku's new-rust-www =&gt; www on ecs with 2 active instances<br>\nheroku's rust-www-try =&gt; not actually needed</p>",
        "id": 216359472,
        "sender_full_name": "Pietro Albini",
        "timestamp": 1605108315
    },
    {
        "content": "<p>losing the opportunity for <code>new-new-</code> smh</p>",
        "id": 216359512,
        "sender_full_name": "Jake Goulding",
        "timestamp": 1605108344
    },
    {
        "content": "<p>namely, the website would be the first service hosted on our ecs cluster to run with more than 1 concurrent instance</p>",
        "id": 216359562,
        "sender_full_name": "Pietro Albini",
        "timestamp": 1605108363
    },
    {
        "content": "<p>I think I'm -1 on the website as something driven by us - instead we should offer the advantages to the website 'team' and they decide</p>",
        "id": 216359605,
        "sender_full_name": "Aidan Hobson Sayers",
        "timestamp": 1605108372
    },
    {
        "content": "<p>if there are multiple instances aws will spread them across availability zones, so if an AZ goes down we don't have downtime on the website, which is public facing (everything else on ECS is internal stuff atm)</p>",
        "id": 216359695,
        "sender_full_name": "Pietro Albini",
        "timestamp": 1605108429
    },
    {
        "content": "<p>I am tempted to say we should put it into 2 different regions, but presumably that has more effort on our side</p>",
        "id": 216359736,
        "sender_full_name": "simulacrum",
        "timestamp": 1605108452
    },
    {
        "content": "<p>(e.g., I can imagine one in Asiaish might be good latency wise)</p>",
        "id": 216359757,
        "sender_full_name": "simulacrum",
        "timestamp": 1605108465
    },
    {
        "content": "<p>I mean for latency we can just stick cloudfront in front of it</p>",
        "id": 216359825,
        "sender_full_name": "Pietro Albini",
        "timestamp": 1605108486
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"117568\">@Aidan Hobson Sayers</span> the website team doesn't manage ops for the website though, even right now</p>",
        "id": 216359845,
        "sender_full_name": "Pietro Albini",
        "timestamp": 1605108492
    },
    {
        "content": "<p>well, and get caching headers right</p>",
        "id": 216359851,
        "sender_full_name": "simulacrum",
        "timestamp": 1605108494
    },
    {
        "content": "<p>but yes</p>",
        "id": 216359856,
        "sender_full_name": "simulacrum",
        "timestamp": 1605108496
    },
    {
        "content": "<p>I don't think we need a HA website tbh, if an az is down half the internet dies and our homepage is probably not top of mind</p>",
        "id": 216359862,
        "sender_full_name": "Aidan Hobson Sayers",
        "timestamp": 1605108498
    },
    {
        "content": "<p>the only service which has ops managed outside the infra team is <a href=\"http://crates.io\">crates.io</a> right now</p>",
        "id": 216359926,
        "sender_full_name": "Pietro Albini",
        "timestamp": 1605108532
    },
    {
        "content": "<p>but if it's a single line then sure</p>",
        "id": 216359949,
        "sender_full_name": "Aidan Hobson Sayers",
        "timestamp": 1605108545
    },
    {
        "content": "<p>Is heroku right now multi-AZ (or the equivalent?)</p>",
        "id": 216359987,
        "sender_full_name": "simulacrum",
        "timestamp": 1605108567
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"117568\">Aidan Hobson Sayers</span> <a href=\"#narrow/stream/242791-t-infra/topic/meeting.202020-11-11/near/216359949\">said</a>:</p>\n<blockquote>\n<p>but if it's a single line then sure</p>\n</blockquote>\n<p>that's just <code>tasks_count = 2</code> instead of <code>tasks_count = 1</code></p>",
        "id": 216360033,
        "sender_full_name": "Pietro Albini",
        "timestamp": 1605108585
    },
    {
        "content": "<p>Yes, Heroku runs in multiple AWS AZs (all in the same region)</p>",
        "id": 216360078,
        "sender_full_name": "Alex Gaynor",
        "timestamp": 1605108602
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"116122\">simulacrum</span> <a href=\"#narrow/stream/242791-t-infra/topic/meeting.202020-11-11/near/216359987\">said</a>:</p>\n<blockquote>\n<p>Is heroku right now multi-AZ (or the equivalent?)</p>\n</blockquote>\n<p>heroku itself is multi-AZ, but we only have a single instance of the website atm</p>",
        "id": 216360174,
        "sender_full_name": "Pietro Albini",
        "timestamp": 1605108630
    },
    {
        "content": "<p>aha, ok</p>",
        "id": 216360224,
        "sender_full_name": "simulacrum",
        "timestamp": 1605108657
    },
    {
        "content": "<p>well either way I'm not against 2 tasks</p>",
        "id": 216360241,
        "sender_full_name": "simulacrum",
        "timestamp": 1605108664
    },
    {
        "content": "<p>I would not want to spend engineering time making that happen though, so if e.g. website has some global lock or w/e then we shouldn't</p>",
        "id": 216360280,
        "sender_full_name": "simulacrum",
        "timestamp": 1605108684
    },
    {
        "content": "<p>(<a href=\"http://crates.io\">crates.io</a> has two dynos on two separate AZs)</p>",
        "id": 216360287,
        "sender_full_name": "Pietro Albini",
        "timestamp": 1605108685
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"116122\">@simulacrum</span> <span aria-label=\"thumbs up\" class=\"emoji emoji-1f44d\" role=\"img\" title=\"thumbs up\">:thumbs_up:</span></p>",
        "id": 216360310,
        "sender_full_name": "Pietro Albini",
        "timestamp": 1605108694
    },
    {
        "content": "<p>tbh the website should just be a static site, but it's a rocket app right now <em>shrugs</em></p>",
        "id": 216360343,
        "sender_full_name": "Pietro Albini",
        "timestamp": 1605108712
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"121055\">Pietro Albini</span> <a href=\"#narrow/stream/242791-t-infra/topic/meeting.202020-11-11/near/216359472\">said</a>:</p>\n<blockquote>\n<p>so, what I propose then is this:</p>\n<p>heroku's rfcbot-rs =&gt; rfcbot on ecs with 1 active instance<br>\nheroku's rust-www-staging =&gt; www-staging on ecs with 1 active instance<br>\nheroku's new-rust-www =&gt; www on ecs with 2 active instances<br>\nheroku's rust-www-try =&gt; not actually needed</p>\n</blockquote>\n<p>ok then, everyone agrees with this? react with <span aria-label=\"check\" class=\"emoji emoji-2705\" role=\"img\" title=\"check\">:check:</span> or <span aria-label=\"cross mark\" class=\"emoji emoji-274c\" role=\"img\" title=\"cross mark\">:cross_mark:</span></p>",
        "id": 216360442,
        "sender_full_name": "Pietro Albini",
        "timestamp": 1605108743
    },
    {
        "content": "<p>Note that rfcbot will need to migrate a db I think too</p>",
        "id": 216360483,
        "sender_full_name": "simulacrum",
        "timestamp": 1605108771
    },
    {
        "content": "<p>(of course I'll migrate staging before the website proper)</p>",
        "id": 216360484,
        "sender_full_name": "Pietro Albini",
        "timestamp": 1605108773
    },
    {
        "content": "<p>right, yeah</p>",
        "id": 216360495,
        "sender_full_name": "Pietro Albini",
        "timestamp": 1605108781
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"121055\">Pietro Albini</span> <a href=\"#narrow/stream/242791-t-infra/topic/meeting.202020-11-11/near/216359845\">said</a>:</p>\n<blockquote>\n<p><span class=\"user-mention silent\" data-user-id=\"117568\">Aidan Hobson Sayers</span> the website team doesn't manage ops for the website though, even right now</p>\n</blockquote>\n<p>hmm, not quite what I'm getting at - it's more of a courtesy thing, that they're the ones building on top and should have their say. it's probably the way of framing, i.e. \"we were thinking of X\" rather than \"we're going to migrate\"</p>",
        "id": 216360539,
        "sender_full_name": "Aidan Hobson Sayers",
        "timestamp": 1605108802
    },
    {
        "content": "<blockquote>\n<p>migrate staging before the website proper</p>\n</blockquote>\n<p>Will you test the <code>=2</code> there as well? Setting back to 1 eventually.</p>",
        "id": 216360547,
        "sender_full_name": "Jake Goulding",
        "timestamp": 1605108805
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"116155\">Jake Goulding</span> <a href=\"#narrow/stream/242791-t-infra/topic/meeting.202020-11-11/near/216360547\">said</a>:</p>\n<blockquote>\n<blockquote>\n<p>migrate staging before the website proper</p>\n</blockquote>\n<p>Will you test the <code>=2</code> there as well? Setting back to 1 eventually.</p>\n</blockquote>\n<p>sure</p>",
        "id": 216360564,
        "sender_full_name": "Pietro Albini",
        "timestamp": 1605108816
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"117568\">Aidan Hobson Sayers</span> <a href=\"#narrow/stream/242791-t-infra/topic/meeting.202020-11-11/near/216360539\">said</a>:</p>\n<blockquote>\n<p><span class=\"user-mention silent\" data-user-id=\"121055\">Pietro Albini</span> <a href=\"#narrow/stream/242791-t-infra/topic/meeting.202020-11-11/near/216359845\">said</a>:</p>\n<blockquote>\n<p><span class=\"user-mention silent\" data-user-id=\"117568\">Aidan Hobson Sayers</span> the website team doesn't manage ops for the website though, even right now</p>\n</blockquote>\n<p>hmm, not quite what I'm getting at - it's more of a courtesy thing, that they're the ones building on top and should have their say. it's probably the way of framing, i.e. \"we were thinking of X\" rather than \"we're going to migrate\"</p>\n</blockquote>\n<p>hmm, ok</p>",
        "id": 216360856,
        "sender_full_name": "Pietro Albini",
        "timestamp": 1605108949
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"117568\">@Aidan Hobson Sayers</span> do you have other concerns? or can you check the checkbox? <span aria-label=\"smile\" class=\"emoji emoji-1f642\" role=\"img\" title=\"smile\">:smile:</span></p>",
        "id": 216361224,
        "sender_full_name": "Pietro Albini",
        "timestamp": 1605109096
    },
    {
        "content": "<p>checked</p>",
        "id": 216361282,
        "sender_full_name": "Aidan Hobson Sayers",
        "timestamp": 1605109133
    },
    {
        "content": "<p>great then!</p>",
        "id": 216361345,
        "sender_full_name": "Pietro Albini",
        "timestamp": 1605109166
    },
    {
        "content": "<p>that's all for the agenda! does anyone have other items to bring up? <span class=\"user-mention\" data-user-id=\"261224\">@triagebot</span> end-meeting</p>",
        "id": 216361369,
        "sender_full_name": "Pietro Albini",
        "timestamp": 1605109181
    },
    {
        "content": "<p>Does anyone have something to bring up?<br>\nReact with <span aria-label=\"working on it\" class=\"emoji emoji-1f6e0\" role=\"img\" title=\"working on it\">:working_on_it:</span> if you have something to say.<br>\nReact with <span aria-label=\"all good\" class=\"emoji emoji-2705\" role=\"img\" title=\"all good\">:all_good:</span> if you're ready to end the meeting.</p>",
        "id": 216361370,
        "sender_full_name": "triagebot",
        "timestamp": 1605109182
    },
    {
        "content": "<p>thanks everyone for attending then!</p>",
        "id": 216361756,
        "sender_full_name": "Pietro Albini",
        "timestamp": 1605109345
    },
    {
        "content": "<p>\\o</p>",
        "id": 216361759,
        "sender_full_name": "Pietro Albini",
        "timestamp": 1605109346
    },
    {
        "content": "<p>\\o</p>",
        "id": 216361811,
        "sender_full_name": "Jake Goulding",
        "timestamp": 1605109371
    },
    {
        "content": "<p>\\o</p>",
        "id": 216361822,
        "sender_full_name": "Aidan Hobson Sayers",
        "timestamp": 1605109376
    },
    {
        "content": "<p>\\o</p>",
        "id": 216361906,
        "sender_full_name": "simulacrum",
        "timestamp": 1605109424
    }
]