[
    {
        "content": "<p>Does anyone know if there would be any concerns with using symbolic links in the rust-lang/rust repository? My concern is that on Windows you have to have Developer Mode enabled for them to work, and git must have <code>core.symlinks</code> set to true.  These are enabled in GitHub Actions, but I'm concerned about developer environments and other distributors.</p>\n<p>Currently there are some symlinks in <code>llvm-project</code> (and a few other unimportant places), but none of them are used by the rust build. So I think if cargo started using them, it would be the first instance where they are required.</p>",
        "id": 277923671,
        "sender_full_name": "Eric Huss",
        "timestamp": 1649183373
    },
    {
        "content": "<p>I think we have had people file windows issues that implied they didn't have developer mode enabled.</p>",
        "id": 277928300,
        "sender_full_name": "The 8472",
        "timestamp": 1649185205
    },
    {
        "content": "<p>And windows 7 is still supported, of sorts.</p>",
        "id": 277928491,
        "sender_full_name": "The 8472",
        "timestamp": 1649185267
    },
    {
        "content": "<p>If we add symlinks I'd at least like some good documentation explaining how to set everything up on Windows. And what to do if people run into issues. Actually it might be useful to have this documentation either way.</p>",
        "id": 277929439,
        "sender_full_name": "Chris Denton",
        "timestamp": 1649185659
    },
    {
        "content": "<blockquote>\n<p>And windows 7 is still supported, of sorts.</p>\n</blockquote>\n<p>Hm, we support Windows 7 as a target but I'm not sure if we support it as a dev environment? I mean, we don't don't support it but...</p>",
        "id": 277929470,
        "sender_full_name": "Chris Denton",
        "timestamp": 1649185672
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"120518\">@Eric Huss</span> could you expand a bit on how you want to use symbolic links? Is this about checking in content to our git repository that is a symbol link (\"any concerns with using symbolic links in the rust-lang/rust repository\")? Or is this about cargo using them somehow (\"if cargo started using them, ...\")?</p>",
        "id": 277935157,
        "sender_full_name": "Wesley Wiser",
        "timestamp": 1649188638
    },
    {
        "content": "<p>In general, I would be less concerned about the former than the later as the number of people contributing to rust-lang/rust is much smaller than the overall number of Rust developers.</p>",
        "id": 277935353,
        "sender_full_name": "Wesley Wiser",
        "timestamp": 1649188735
    },
    {
        "content": "<p>I'm pretty sure Developer Mode can be disabled via Group Policy settings so users in environments with a less-than-friendly IT department (which, frankly, is waaay too many developers) might not have the option to enable it at all.</p>",
        "id": 277935677,
        "sender_full_name": "Wesley Wiser",
        "timestamp": 1649188849
    },
    {
        "content": "<p>Right now it is proposed for cargo's testsuite, checking the symlinks in directly to rust-lang/cargo. We are looking to add \"snapshot\" tests, which include hundreds of cargo projects. Some are identical, so they are added as symlinks to a shared project.  I think this would only affect someone running working on cargo itself or running <code>./x.py test src/tools/cargo</code>.</p>\n<p>I suspect this is unlikely to be an issue for rust-lang/rust distributions. I would be surprised if there is anyone except the rust-lang CI running cargo's test suite on Windows.</p>\n<p>I guess this is probably more of a concern for cargo contributors. I don't have a sense of how likely that would be a problem.  I seem to recall my default <code>core.symlinks</code> was false at some point, which has me a bit worried.  The docs say the current default is true.</p>",
        "id": 277943502,
        "sender_full_name": "Eric Huss",
        "timestamp": 1649192855
    },
    {
        "content": "<p>Do symlinks still require Developer Mode on Windows 11?</p>",
        "id": 277976895,
        "sender_full_name": "Josh Triplett",
        "timestamp": 1649222555
    },
    {
        "content": "<p>Yes, either Developer Mode has to be enabled or the user must have the <code>SeCreateSymbolicLinkPrivilege</code> privilege (which is only given to administrators by default). The reasoning given is that legacy applications may not securely handle symlinks.</p>",
        "id": 277985659,
        "sender_full_name": "Chris Denton",
        "timestamp": 1649230790
    },
    {
        "content": "<p><a href=\"https://github.com/rust-lang/rust/security/advisories/GHSA-r9cc-f5pr-p3j2\">I mean...</a> <span aria-label=\"sweat smile\" class=\"emoji emoji-1f605\" role=\"img\" title=\"sweat smile\">:sweat_smile:</span></p>",
        "id": 277985947,
        "sender_full_name": "Pietro Albini",
        "timestamp": 1649230991
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"260325\">Chris Denton</span> <a href=\"#narrow/stream/242791-t-infra/topic/symbolic.20links/near/277985659\">said</a>:</p>\n<blockquote>\n<p>Yes, either Developer Mode has to be enabled or the user must have the <code>SeCreateSymbolicLinkPrivilege</code> privilege (which is only given to administrators by default). The reasoning given is that legacy applications may not securely handle symlinks.</p>\n</blockquote>\n<p>I don't think that's either confined to windows applications, or even legacy applications.</p>",
        "id": 278007041,
        "sender_full_name": "Connor Horman",
        "timestamp": 1649243030
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"120518\">Eric Huss</span> <a href=\"#narrow/stream/242791-t-infra/topic/symbolic.20links/near/277943502\">said</a>:</p>\n<blockquote>\n<p>Right now it is proposed for cargo's testsuite, checking the symlinks in directly to rust-lang/cargo. We are looking to add \"snapshot\" tests, which include hundreds of cargo projects. Some are identical, so they are added as symlinks to a shared project.  I think this would only affect someone running working on cargo itself or running <code>./x.py test src/tools/cargo</code>.</p>\n</blockquote>\n<p>Makes sense! Large-scale snapshot testing in cargo sounds like a really good idea and the use case fits very well. </p>\n<blockquote>\n<p>I guess this is probably more of a concern for cargo contributors. I don't have a sense of how likely that would be a problem.  I seem to recall my default <code>core.symlinks</code> was false at some point, which has me a bit worried.  The docs say the current default is true.</p>\n</blockquote>\n<p>At least based on a few things I've seen, it sounds like <code>core.symlinks</code> on Windows doesn't force the use of symlinks, it just allows the detection code to run. Ie: <code>core.symlinks = false</code> =&gt; never try to use symlinks, <code>core.symlinks = true</code> =&gt; test to see if symlinks can be used on this filesystem, Windows version, Dev Mode enabled, etc. </p>\n<ul>\n<li><a href=\"https://github.com/desktop/desktop/issues/7083\">https://github.com/desktop/desktop/issues/7083</a></li>\n<li><a href=\"https://stackoverflow.com/questions/58587005/why-does-git-clone-override-global-core-symlinks-on-windows\">https://stackoverflow.com/questions/58587005/why-does-git-clone-override-global-core-symlinks-on-windows</a></li>\n</ul>",
        "id": 278059524,
        "sender_full_name": "Wesley Wiser",
        "timestamp": 1649266667
    },
    {
        "content": "<p>Thanks for the info!  <span class=\"user-mention\" data-user-id=\"424212\">@Ed Page</span> clarified that the snapshot tool will detect if symlinks are not enabled and will follow the file instead, which means this is probably a non-issue.  I think everything should \"just work\" even if they are disabled. Sorry for the noise, I didn't fully understand how it all works.</p>",
        "id": 278060417,
        "sender_full_name": "Eric Huss",
        "timestamp": 1649267080
    },
    {
        "content": "<p>No problem! I learned some new things myself <span aria-label=\"smile\" class=\"emoji emoji-1f642\" role=\"img\" title=\"smile\">:smile:</span></p>",
        "id": 278061001,
        "sender_full_name": "Wesley Wiser",
        "timestamp": 1649267372
    }
]