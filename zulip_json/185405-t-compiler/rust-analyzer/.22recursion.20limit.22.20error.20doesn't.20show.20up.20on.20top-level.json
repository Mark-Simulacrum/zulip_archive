[
    {
        "content": "<p>Is there a reason why \"Reached recursion limit while macro expansion\" error doesn't show up on top level?</p>\n<p><a href=\"/user_uploads/4715/kj3L-36voCVSCswWZT0XePkE/Peek-2022-01-28-02-23.gif\">Peek-2022-01-28-02-23.gif</a></p>\n<div class=\"message_inline_image\"><a href=\"/user_uploads/4715/kj3L-36voCVSCswWZT0XePkE/Peek-2022-01-28-02-23.gif\" title=\"Peek-2022-01-28-02-23.gif\"><img src=\"/user_uploads/4715/kj3L-36voCVSCswWZT0XePkE/Peek-2022-01-28-02-23.gif\"></a></div>",
        "id": 269656730,
        "sender_full_name": "Waffle Lapkin",
        "timestamp": 1643326013
    },
    {
        "content": "<p>We probably lose the diagnostic along the way</p>",
        "id": 269696268,
        "sender_full_name": "Lauren»õiu",
        "timestamp": 1643354841
    },
    {
        "content": "<p>I think the error is emitted by the <code>Expander</code>, so it is missing for macros in item position since those don't use that</p>",
        "id": 269713002,
        "sender_full_name": "Jonas Schievink  [he/him]",
        "timestamp": 1643364571
    },
    {
        "content": "<p>What are they using then?</p>",
        "id": 269757568,
        "sender_full_name": "Waffle Lapkin",
        "timestamp": 1643385457
    },
    {
        "content": "<p>They do their own recursion limit checking</p>",
        "id": 269757762,
        "sender_full_name": "Jonas Schievink  [he/him]",
        "timestamp": 1643385529
    },
    {
        "content": "<p>I mean, what crate/api/etc does RA use for item-position macro expansion?</p>",
        "id": 269761673,
        "sender_full_name": "Waffle Lapkin",
        "timestamp": 1643387146
    },
    {
        "content": "<p>The macro recursion check happens here: <a href=\"https://github.com/rust-analyzer/rust-analyzer/blob/6634eaf13a7e3a2b30f98f6e69af952f2d760df4/crates/hir_def/src/nameres/collector.rs#L1262\">https://github.com/rust-analyzer/rust-analyzer/blob/6634eaf13a7e3a2b30f98f6e69af952f2d760df4/crates/hir_def/src/nameres/collector.rs#L1262</a></p>",
        "id": 269762962,
        "sender_full_name": "Jonas Schievink  [he/him]",
        "timestamp": 1643387664
    }
]