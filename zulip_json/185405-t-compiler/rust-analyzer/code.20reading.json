[
    {
        "content": "<p><a href=\"https://github.com/rust-analyzer/rust-analyzer/blob/master/crates/hir_def/src/item_tree.rs#L328\">https://github.com/rust-analyzer/rust-analyzer/blob/master/crates/hir_def/src/item_tree.rs#L328</a> Why is PhantomData needed here? There is no unused type parameters</p>",
        "id": 264535612,
        "sender_full_name": "zhou fan",
        "timestamp": 1639189711
    },
    {
        "content": "<p>Hm good question, usually this usage informs drop check about ownership. Basically this <code>PhantomData</code> usage implies this type <em>owns</em> an <code>N</code></p>",
        "id": 264535809,
        "sender_full_name": "Lukas Wirth",
        "timestamp": 1639189995
    },
    {
        "content": "<p>But in this case that doesn't seem to be useful/correct? Since an Idx is just, well, an index</p>",
        "id": 264535819,
        "sender_full_name": "Lukas Wirth",
        "timestamp": 1639190018
    },
    {
        "content": "<p>if you are curious about <code>PhantomData</code> usages -&gt; <a href=\"https://doc.rust-lang.org/nomicon/phantom-data.html#phantomdata\">https://doc.rust-lang.org/nomicon/phantom-data.html#phantomdata</a></p>",
        "id": 264535830,
        "sender_full_name": "Lukas Wirth",
        "timestamp": 1639190035
    },
    {
        "content": "<p>Thanks</p>",
        "id": 264536170,
        "sender_full_name": "zhou fan",
        "timestamp": 1639190463
    },
    {
        "content": "<p>Hmm, <code>Idx&lt;T&gt;</code> has a <code>PhantomData&lt;fn() -&gt; T&gt;</code> instead. But I don't think I understand variance in Rust very well..</p>",
        "id": 264548511,
        "sender_full_name": "Laurențiu",
        "timestamp": 1639209175
    },
    {
        "content": "<p><code>fn() -&gt; T</code> is contravariant in <code>T</code> which basically means that you can cast it to a type with a shorter lifetime, but not a longet lifetime.</p>",
        "id": 264548678,
        "sender_full_name": "bjorn3",
        "timestamp": 1639209401
    },
    {
        "content": "<p>So does the one in <code>FileItemTreeId</code> change its variance?</p>",
        "id": 264548913,
        "sender_full_name": "Laurențiu",
        "timestamp": 1639209723
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"133247\">bjorn3</span> <a href=\"#narrow/stream/185405-t-compiler.2Frust-analyzer/topic/code.20reading/near/264548678\">말함</a>:</p>\n<blockquote>\n<p><code>fn() -&gt; T</code> is contravariant in <code>T</code> which basically means that you can cast it to a type with a shorter lifetime, but not a longet lifetime.</p>\n</blockquote>\n<p>you mean covariant right? <code>fn(T)</code> would be contravariant</p>",
        "id": 264556040,
        "sender_full_name": "Lukas Wirth",
        "timestamp": 1639220373
    },
    {
        "content": "<p>So no, the <code>PhantomData</code> in <code>FileItemTreeId</code> doesn't change the variance as its also covariant, it does change drop check a bit tho I don't think there is any value in that here.</p>",
        "id": 264556156,
        "sender_full_name": "Lukas Wirth",
        "timestamp": 1639220436
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"300586\">Lukas Wirth</span> <a href=\"#narrow/stream/185405-t-compiler.2Frust-analyzer/topic/code.20reading/near/264556040\">said</a>:</p>\n<blockquote>\n<p><strong>bjorn3|133247</strong> [말함]</p>\n</blockquote>\n<p>Is that Korean? <span aria-label=\"big smile\" class=\"emoji emoji-1f604\" role=\"img\" title=\"big smile\">:big_smile:</span></p>",
        "id": 264557539,
        "sender_full_name": "Laurențiu",
        "timestamp": 1639222277
    },
    {
        "content": "<p>Right, zulip pastes that in your set language <span aria-label=\"sweat smile\" class=\"emoji emoji-1f605\" role=\"img\" title=\"sweat smile\">:sweat_smile:</span></p>",
        "id": 264557747,
        "sender_full_name": "Lukas Wirth",
        "timestamp": 1639222573
    },
    {
        "content": "<p>Plot twist: you don't actually know Korean but you changed your language settings by mistake and now you have to learn it in order to change then back <span aria-label=\"big smile\" class=\"emoji emoji-1f604\" role=\"img\" title=\"big smile\">:big_smile:</span></p>",
        "id": 264558383,
        "sender_full_name": "Laurențiu",
        "timestamp": 1639223475
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"300586\">Lukas Wirth</span> <a href=\"#narrow/stream/185405-t-compiler.2Frust-analyzer/topic/code.20reading/near/264556040\">said</a>:</p>\n<blockquote>\n<p><span class=\"user-mention silent\" data-user-id=\"133247\">bjorn3</span> <a href=\"#narrow/stream/185405-t-compiler.2Frust-analyzer/topic/code.20reading/near/264548678\">말함</a>:</p>\n<blockquote>\n<p><code>fn() -&gt; T</code> is contravariant in <code>T</code> which basically means that you can cast it to a type with a shorter lifetime, but not a longet lifetime.</p>\n</blockquote>\n<p>you mean covariant right? <code>fn(T)</code> would be contravariant</p>\n</blockquote>\n<p>right, got them mixed up. <a href=\"https://doc.rust-lang.org/stable/nomicon/subtyping.html\">https://doc.rust-lang.org/stable/nomicon/subtyping.html</a></p>",
        "id": 264561062,
        "sender_full_name": "bjorn3",
        "timestamp": 1639226954
    }
]