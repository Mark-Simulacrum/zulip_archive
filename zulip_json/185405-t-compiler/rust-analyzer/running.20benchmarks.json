[
    {
        "content": "<p>I am new to running benchmark using Rust tests. Specifically, I am looking at <code>integrated_completion_benchmark</code>. <br>\nI am using \"Copy Run Command Line\" feature to generate this command and then run it in the integrated terminal of vs code.  I see the following:</p>\n<div class=\"codehilite\"><pre><span></span><code>❯ cargo test --package rust-analyzer --release --lib -- integrated_completion_benchmark --nocapture\n   Compiling rust-analyzer v0.0.0 (D:\\source\\repos\\rust-analyzer\\crates\\rust-analyzer)\n    Finished release [optimized] target(s) in 9.62s\n     Running unittests (target\\release\\deps\\rust_analyzer-05af0a6616716cfb.exe)\n\nrunning 1 test\ntest integrated_benchmarks::integrated_completion_benchmark ... ok\n\ntest result: ok. 1 passed; 0 failed; 0 ignored; 0 measured; 30 filtered out; finished in 0.00s\n</code></pre></div>\n<p>I would have thought I should see some sort of metric/benchmark that is printed. Am I running this command incorrectly? Or should I be looking elsewhere for output?</p>",
        "id": 257216168,
        "sender_full_name": "Mirko Rainer (aka Gary)",
        "timestamp": 1634050419
    },
    {
        "content": "<p>Try setting <code>RUN_SLOW_BENCHES=1</code></p>",
        "id": 257216433,
        "sender_full_name": "Laurențiu",
        "timestamp": 1634050515
    },
    {
        "content": "<p>That worked! Thank you! I see that env var check at the beginning of the test but didn't put it together that this was needed to run it. I'm assuming this is to prevent the benchmarks from being run in a CI/CD scenario? (unless flagged) Is this a common Rust thing or just for this project?</p>",
        "id": 257217070,
        "sender_full_name": "Mirko Rainer (aka Gary)",
        "timestamp": 1634050744
    },
    {
        "content": "<p>Exactly, it's to avoid running it on CI. There's also a <code>RUN_SLOW_TESTS</code>, but those do run on CI, but not locally. It's not really idiomatic in Rust projects, but it's rather pragmatic. Being able to do a <code>cargo test</code> and have it finish in 30s (including the build time, otherwise it's 5s) or so is pretty nice.</p>",
        "id": 257217455,
        "sender_full_name": "Laurențiu",
        "timestamp": 1634050867
    },
    {
        "content": "<p>If you're looking into completion performance, there's also <a href=\"https://github.com/rust-analyzer/rust-analyzer/issues/10369\">https://github.com/rust-analyzer/rust-analyzer/issues/10369</a>, plus some discussion in <a href=\"#narrow/stream/185405-t-compiler.2Frust-analyzer/topic/Steering.20meeting/near/255069770\">https://rust-lang.zulipchat.com/#narrow/stream/185405-t-compiler.2Frust-analyzer/topic/Steering.20meeting/near/255069770</a>.</p>",
        "id": 257218532,
        "sender_full_name": "Laurențiu",
        "timestamp": 1634051251
    },
    {
        "content": "<p>Thanks for the context. Sounds like I could start looking at <code>descend_into_macros</code>.</p>",
        "id": 257219583,
        "sender_full_name": "Mirko Rainer (aka Gary)",
        "timestamp": 1634051668
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"450154\">Mirko Rainer (aka Gary)</span> has marked this topic as resolved.</p>",
        "id": 257228626,
        "sender_full_name": "Notification Bot",
        "timestamp": 1634055023
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"450154\">Mirko Rainer (aka Gary)</span> has marked this topic as unresolved.</p>",
        "id": 257231060,
        "sender_full_name": "Notification Bot",
        "timestamp": 1634055930
    },
    {
        "content": "<p>qq: should I expect benchmarks to be largely the same with each run? i.e. if I change nothing I should have XXms runtime each time. Is there a deviation to be expected?<br>\n(I'm new to benchmark/prf stuffs)</p>",
        "id": 257231202,
        "sender_full_name": "Mirko Rainer (aka Gary)",
        "timestamp": 1634055976
    },
    {
        "content": "<p>I wouldn't be surprised if there was, especially on the first run</p>",
        "id": 257232018,
        "sender_full_name": "Laurențiu",
        "timestamp": 1634056277
    }
]