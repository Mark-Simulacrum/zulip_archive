[
    {
        "content": "<p>Hey, I have been trying to understand this issue: <a href=\"https://github.com/rust-analyzer/rust-analyzer/issues/10481\">https://github.com/rust-analyzer/rust-analyzer/issues/10481</a></p>\n<p>From what I could infer it's originating from here:<br>\n<a href=\"https://github.com/rust-analyzer/rust-analyzer/blob/1f47693e02809c97db61b51247ae4e4d46744c61/crates/hir_ty/src/method_resolution.rs#L732-L781\">https://github.com/rust-analyzer/rust-analyzer/blob/1f47693e02809c97db61b51247ae4e4d46744c61/crates/hir_ty/src/method_resolution.rs#L732-L781</a></p>\n<p>ig currently there is no check at all for trait constraints. I wanted to know if this is correct inference, and if yes, any guidance on how could I get started on fixing it? If no, then what part should I be looking at, and how could I get started on fixing it. Any suggestion would be helpful, thanks!</p>",
        "id": 259485634,
        "sender_full_name": "Fenil Jain",
        "timestamp": 1635486824
    },
    {
        "content": "<p>that's where the methods get listed, yeah. Normally those trait constraints just result in obligations that are checked later during inference: <a href=\"https://github.com/rust-analyzer/rust-analyzer/blob/1f47693e02809c97db61b51247ae4e4d46744c61/crates/hir_ty/src/infer/expr.rs#L1011\">https://github.com/rust-analyzer/rust-analyzer/blob/1f47693e02809c97db61b51247ae4e4d46744c61/crates/hir_ty/src/infer/expr.rs#L1011</a><br>\nI see two ways of fixing this: one would be to check whether the trait bounds may be satisfied during method resolution (in the code you linked); the other would be to add the check only for completion. It depends on what rustc does, I think: if rustc actually does such a preliminary check during method selection, then we should do it as well; otherwise we shouldn't do it, since it may affect method resolution, and instead only add the check during completion.</p>",
        "id": 259562732,
        "sender_full_name": "Florian Diebold",
        "timestamp": 1635530831
    },
    {
        "content": "<p>I haven't read a lot of rustc code, can you point me somewhere to start for this?</p>",
        "id": 260104759,
        "sender_full_name": "Fenil Jain",
        "timestamp": 1635930069
    },
    {
        "content": "<p>I think this is the place: <a href=\"https://github.com/rust-lang/rust/blob/87ec5680c982e665e028cbec9219d7849a9535da/compiler/rustc_typeck/src/check/method/probe.rs#L1439-L1479\">https://github.com/rust-lang/rust/blob/87ec5680c982e665e028cbec9219d7849a9535da/compiler/rustc_typeck/src/check/method/probe.rs#L1439-L1479</a> so yeah, seems rustc checks these clauses while collecting candidates already</p>",
        "id": 260105847,
        "sender_full_name": "Florian Diebold",
        "timestamp": 1635930719
    },
    {
        "content": "<p>Yeah it seems to be doing it here:<br>\n<a href=\"https://github.com/rust-lang/rust/blob/3802025f400af7817ba4874587e6a2df95abd65d/compiler/rustc_typeck/src/check/method/probe.rs#L915\">https://github.com/rust-lang/rust/blob/3802025f400af7817ba4874587e6a2df95abd65d/compiler/rustc_typeck/src/check/method/probe.rs#L915</a></p>",
        "id": 260107485,
        "sender_full_name": "Fenil Jain",
        "timestamp": 1635931731
    },
    {
        "content": "<p>Weird my rust-analyzer is crashing on rustc though I configured the same way as mentioned here:<br>\n<a href=\"https://rustc-dev-guide.rust-lang.org/building/suggested.html#configuring-rust-analyzer-for-rustc\">https://rustc-dev-guide.rust-lang.org/building/suggested.html#configuring-rust-analyzer-for-rustc</a></p>",
        "id": 260107572,
        "sender_full_name": "Fenil Jain",
        "timestamp": 1635931801
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"395075\">Fenil Jain</span> <a href=\"#narrow/stream/185405-t-compiler.2Frust-analyzer/topic/Issue_10481/near/260107572\">said</a>:</p>\n<blockquote>\n<p>Weird my rust-analyzer is crashing on rustc though I configured the same way as mentioned here:<br>\n<a href=\"https://rustc-dev-guide.rust-lang.org/building/suggested.html#configuring-rust-analyzer-for-rustc\">https://rustc-dev-guide.rust-lang.org/building/suggested.html#configuring-rust-analyzer-for-rustc</a></p>\n</blockquote>\n<p>Nvm got this sorted</p>",
        "id": 260139110,
        "sender_full_name": "Fenil Jain",
        "timestamp": 1635948674
    }
]