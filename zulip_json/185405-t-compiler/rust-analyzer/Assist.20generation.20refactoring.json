[
    {
        "content": "<p>Most of our code generation assists manage lots of stuff concerning white spaces and indentaion. Would'nt it be better if the whole process of formatting is done by just a dedicated utility and the burden be lifted  from code generation functions?</p>",
        "id": 249466385,
        "sender_full_name": "Mahdi Faramarzpour",
        "timestamp": 1628956813
    },
    {
        "content": "<p><a href=\"https://github.com/rust-analyzer/rust-analyzer/issues/1665\">Yes</a>.</p>",
        "id": 249466788,
        "sender_full_name": "Florian Diebold",
        "timestamp": 1628957371
    },
    {
        "content": "<p>Note that we have a bit of magical whitespace during editing: <a href=\"https://github.com/rust-analyzer/rust-analyzer/blob/5a60e9106b8dcfae4caa4d8fdb62de078d3c12a9/crates/syntax/src/ted.rs#L150-L207\">https://github.com/rust-analyzer/rust-analyzer/blob/5a60e9106b8dcfae4caa4d8fdb62de078d3c12a9/crates/syntax/src/ted.rs#L150-L207</a></p>",
        "id": 249467454,
        "sender_full_name": "matklad",
        "timestamp": 1628958304
    },
    {
        "content": "<p>Somewhat related, we need to change the way we handle indentation changes at the API level: <a href=\"https://github.com/rust-analyzer/rust-analyzer/issues/9903\">https://github.com/rust-analyzer/rust-analyzer/issues/9903</a></p>",
        "id": 249470635,
        "sender_full_name": "matklad",
        "timestamp": 1628963520
    },
    {
        "content": "<blockquote>\n<p>Somewhat related, we need to change the way we handle indentation changes at the API level: <a href=\"https://github.com/rust-analyzer/rust-analyzer/issues/9903\">https://github.com/rust-analyzer/rust-analyzer/issues/9903</a></p>\n</blockquote>\n<p>Agreed. The main reason I started this topic is the problem of indentation for generating methods.</p>",
        "id": 249494021,
        "sender_full_name": "Mahdi Faramarzpour",
        "timestamp": 1629005064
    },
    {
        "content": "<p><a href=\"https://github.com/rust-analyzer/rust-analyzer/issues/1665\">https://github.com/rust-analyzer/rust-analyzer/issues/1665</a><br>\nBut one thing, shouldn't we also add or remove newlines in our formatter? That would be helpful for the assists.</p>",
        "id": 249520758,
        "sender_full_name": "Mahdi Faramarzpour",
        "timestamp": 1629045167
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"133169\">@matklad</span> what is the reason that pattern-based formatter shall not handle them?</p>",
        "id": 249520915,
        "sender_full_name": "Mahdi Faramarzpour",
        "timestamp": 1629045423
    },
    {
        "content": "<p>We <em>can</em> handle everything inside a single \"reformat\" function. But I think it'd be best to factor reformat into \"first ,reindent, then, fix whitespace\", for two reasons:</p>\n<ul>\n<li>easier to get something useful -- indenting is a smaller subset of the overall formatting</li>\n<li>reindenting is useful on its own:<ul>\n<li>when generating code, it often is enough to re-indent</li>\n<li>indentation logic is needed to define the cursor position when pressing newline, backspace or just using the arrow keys</li>\n</ul>\n</li>\n</ul>",
        "id": 249558669,
        "sender_full_name": "matklad",
        "timestamp": 1629100236
    }
]