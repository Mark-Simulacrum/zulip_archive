[
    {
        "content": "<p>o/ I'm implementing the trait body generation today and tomorrow; figured I might as well open a topic for it (:</p>",
        "id": 248902564,
        "sender_full_name": "Yoshua Wuyts",
        "timestamp": 1628540369
    },
    {
        "content": "<p>I could use some help with something: I'm trying to get a type <code>ast::Adt</code> at this line: <a href=\"https://github.com/rust-analyzer/rust-analyzer/blob/master/crates/ide_assists/src/handlers/add_missing_impl_members.rs#L126\">https://github.com/rust-analyzer/rust-analyzer/blob/master/crates/ide_assists/src/handlers/add_missing_impl_members.rs#L126</a> for the target which we're implementing the trait on</p>",
        "id": 248902648,
        "sender_full_name": "Yoshua Wuyts",
        "timestamp": 1628540403
    },
    {
        "content": "<p>Does anyone have any pointers on how to get that?</p>",
        "id": 248902673,
        "sender_full_name": "Yoshua Wuyts",
        "timestamp": 1628540410
    },
    {
        "content": "<p>probably ping <span class=\"user-mention\" data-user-id=\"300586\">@Lukas Wirth</span></p>",
        "id": 248902738,
        "sender_full_name": "Yoshua Wuyts",
        "timestamp": 1628540441
    },
    {
        "content": "<p>e.g. <code>impl Foo for Bar</code> - I'm trying to get <code>Bar</code> in the shape of <code>ast::Adt</code> -- but getting a bit lost</p>",
        "id": 248902824,
        "sender_full_name": "Yoshua Wuyts",
        "timestamp": 1628540481
    },
    {
        "content": "<div class=\"codehilite\" data-code-language=\"Rust\"><pre><span></span><code><span class=\"kd\">let</span><span class=\"w\"> </span><span class=\"n\">hir_ty</span><span class=\"w\"> </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"n\">sema</span><span class=\"p\">.</span><span class=\"n\">resolve_type</span><span class=\"p\">(</span><span class=\"n\">impl_</span><span class=\"p\">.</span><span class=\"n\">self_ty</span><span class=\"p\">());</span><span class=\"w\"></span>\n<span class=\"kd\">let</span><span class=\"w\"> </span><span class=\"n\">adt_node</span><span class=\"w\"> </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"n\">hir_ty</span><span class=\"p\">.</span><span class=\"n\">source</span><span class=\"p\">(</span><span class=\"n\">db</span><span class=\"p\">);</span><span class=\"w\"></span>\n</code></pre></div>\n<p>something like this should help you out i think?</p>",
        "id": 248903339,
        "sender_full_name": "Lukas Wirth",
        "timestamp": 1628540740
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"300586\">@Lukas Wirth</span> yes, thank you! -- It's not quite working yet (<code>hir::Adt</code> doesn't implement <code>HasSource</code>); but at least it feels like I'm heading in the right direction now!</p>",
        "id": 248907703,
        "sender_full_name": "Yoshua Wuyts",
        "timestamp": 1628542982
    },
    {
        "content": "<p>The variants of <code>hir::Adt</code> should implement <code>HasSource</code></p>",
        "id": 248907776,
        "sender_full_name": "Lukas Wirth",
        "timestamp": 1628543026
    },
    {
        "content": "<p>yep, found them!</p>",
        "id": 248908029,
        "sender_full_name": "Yoshua Wuyts",
        "timestamp": 1628543153
    },
    {
        "content": "<p>just need a way to convert them back to <code>ast::Adt</code> now, hehe</p>",
        "id": 248908079,
        "sender_full_name": "Yoshua Wuyts",
        "timestamp": 1628543165
    },
    {
        "content": "<p>though I guess; that shouldn't be hard!</p>",
        "id": 248908114,
        "sender_full_name": "Yoshua Wuyts",
        "timestamp": 1628543183
    },
    {
        "content": "<p><code>ast::Adt</code> is just an enum of the three adt ast nodes as well</p>",
        "id": 248908147,
        "sender_full_name": "Lukas Wirth",
        "timestamp": 1628543205
    },
    {
        "content": "<p>Pushed my branch to a WIP PR here: <a href=\"https://github.com/rust-analyzer/rust-analyzer/pull/9830\">https://github.com/rust-analyzer/rust-analyzer/pull/9830</a></p>",
        "id": 248910797,
        "sender_full_name": "Yoshua Wuyts",
        "timestamp": 1628544502
    },
    {
        "content": "<p>The test I added is failing; feel like I'm missing something obvious. Going to call it a night for now tho</p>",
        "id": 248910832,
        "sender_full_name": "Yoshua Wuyts",
        "timestamp": 1628544527
    },
    {
        "content": "<p>Did manage to add <code>HasSource for hir::Adt</code>! \\o/</p>",
        "id": 248910877,
        "sender_full_name": "Yoshua Wuyts",
        "timestamp": 1628544554
    },
    {
        "content": "<p>woot, it's working! <code>add_missing_impl_members.rs</code> now also generates trait function bodies!</p>",
        "id": 248952672,
        "sender_full_name": "Yoshua Wuyts",
        "timestamp": 1628584136
    },
    {
        "content": "<p>Now waiting on CI to pass on: <a href=\"https://github.com/rust-analyzer/rust-analyzer/pull/9830\">https://github.com/rust-analyzer/rust-analyzer/pull/9830</a></p>",
        "id": 248952689,
        "sender_full_name": "Yoshua Wuyts",
        "timestamp": 1628584149
    },
    {
        "content": "<p>Next step: default body generation for <code>Hash</code></p>",
        "id": 248952814,
        "sender_full_name": "Yoshua Wuyts",
        "timestamp": 1628584220
    },
    {
        "content": "<p>Traits left to specialize for: <code>PartialEq</code>, <code>PartialOrd</code>, <code>Clone</code>, <code>Hash</code></p>",
        "id": 248952876,
        "sender_full_name": "Yoshua Wuyts",
        "timestamp": 1628584285
    },
    {
        "content": "<p>Traits already specialized: <code>Debug</code>, <code>Default</code></p>",
        "id": 248952908,
        "sender_full_name": "Yoshua Wuyts",
        "timestamp": 1628584321
    },
    {
        "content": "<p>Draft PR for implementing <code>Hash</code>: <a href=\"https://github.com/rust-analyzer/rust-analyzer/pull/9835\">https://github.com/rust-analyzer/rust-analyzer/pull/9835</a>. Depends on the PR which moves the code to <code>utils.rs</code> to be merged first.</p>",
        "id": 248962394,
        "sender_full_name": "Yoshua Wuyts",
        "timestamp": 1628591287
    },
    {
        "content": "<p>Next I think I'll do <code>Clone</code> <span aria-label=\"sparkles\" class=\"emoji emoji-2728\" role=\"img\" title=\"sparkles\">:sparkles:</span> - the implementation should be a mix between <code>Default</code> and <code>Hash</code>.</p>",
        "id": 248962406,
        "sender_full_name": "Yoshua Wuyts",
        "timestamp": 1628591296
    },
    {
        "content": "<p>Is there a function in <code>make.rs</code> to create a pattern in the style of <code>Foo { x, y, z } =&gt;</code> ?</p>",
        "id": 248970111,
        "sender_full_name": "Yoshua Wuyts",
        "timestamp": 1628597418
    },
    {
        "content": "<p>I don't think so, seems good to add it to <code>make::ext</code></p>",
        "id": 248970472,
        "sender_full_name": "matklad",
        "timestamp": 1628597699
    },
    {
        "content": "<p>cool; I'll do that. Seems like the type I'm targeting here is <code>RecordPat</code></p>",
        "id": 248970656,
        "sender_full_name": "Yoshua Wuyts",
        "timestamp": 1628597845
    },
    {
        "content": "<p>oh neat; it seems there is one already for that in make!</p>",
        "id": 248970759,
        "sender_full_name": "Yoshua Wuyts",
        "timestamp": 1628597895
    },
    {
        "content": "<p>PR for <code>clone</code>: <a href=\"https://github.com/rust-analyzer/rust-analyzer/pull/9846\">https://github.com/rust-analyzer/rust-analyzer/pull/9846</a></p>",
        "id": 248976197,
        "sender_full_name": "Yoshua Wuyts",
        "timestamp": 1628600895
    },
    {
        "content": "<p>correctly handling tuple and record enums. That took a few hrs, oops</p>",
        "id": 248976248,
        "sender_full_name": "Yoshua Wuyts",
        "timestamp": 1628600929
    },
    {
        "content": "<p>alright, seems that all that's left now is <code>PartialEq</code> and <code>PartialOrd</code></p>",
        "id": 248976847,
        "sender_full_name": "Yoshua Wuyts",
        "timestamp": 1628601264
    },
    {
        "content": "<p><del>Just as a headsup, try to not mention github handles in the PR description, just do a follow up comment for r?. Bors puts the PR descriptions into the merge commit message and github likes to notify people due to these commits on fork updates and the like <span aria-label=\"grimacing\" class=\"emoji emoji-1f62c\" role=\"img\" title=\"grimacing\">:grimacing:</span> (Though I  think they finally fixed that but I'd rather not challenge that)</del></p>",
        "id": 248977350,
        "sender_full_name": "Lukas Wirth",
        "timestamp": 1628601517
    },
    {
        "content": "<blockquote>\n<p>Bors puts the PR descriptions into the merge commit message</p>\n</blockquote>\n<p>No longer happens since <a href=\"https://github.com/bors-ng/bors-ng/issues/1221\">bors-ng/bors-ng#1221</a></p>",
        "id": 248977678,
        "sender_full_name": "bjorn3",
        "timestamp": 1628601685
    },
    {
        "content": "<p>oh, I didn't know that used to be an issue -- glad it was fixed tho! :D</p>",
        "id": 248979083,
        "sender_full_name": "Yoshua Wuyts",
        "timestamp": 1628602416
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"203546\">@Laurențiu</span> I think the bug in <a href=\"https://github.com/rust-analyzer/rust-analyzer/pull/9846#issuecomment-896043331\">https://github.com/rust-analyzer/rust-analyzer/pull/9846#issuecomment-896043331</a> predates the work I've been doing; I don't think I touched the outer trait generation code. It might be worth checking whether it affects the <code>add_missing_impl_members</code> assist too, and then fixing it wholesale</p>",
        "id": 248981733,
        "sender_full_name": "Yoshua Wuyts",
        "timestamp": 1628603669
    },
    {
        "content": "<p>Yeah, it's a previous bug, I just didn't test it before. Or maybe I did, but forgot about it.</p>",
        "id": 248981900,
        "sender_full_name": "Laurențiu",
        "timestamp": 1628603748
    },
    {
        "content": "<p>PR for <code>PartialEq</code>: <a href=\"https://github.com/rust-analyzer/rust-analyzer/pull/9863\">https://github.com/rust-analyzer/rust-analyzer/pull/9863</a></p>",
        "id": 249145888,
        "sender_full_name": "Yoshua Wuyts",
        "timestamp": 1628705136
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"300586\">@Lukas Wirth</span> any suggestions for what to name the path iter method?</p>",
        "id": 249216936,
        "sender_full_name": "Yoshua Wuyts",
        "timestamp": 1628763187
    },
    {
        "content": "<p>I have <code>make::ext::path_from_parts</code>, but not loving it</p>",
        "id": 249216943,
        "sender_full_name": "Yoshua Wuyts",
        "timestamp": 1628763201
    },
    {
        "content": "<p><code>make::ext::path_idents</code>?</p>",
        "id": 249216960,
        "sender_full_name": "Yoshua Wuyts",
        "timestamp": 1628763219
    },
    {
        "content": "<p>alright, going with <code>path_from_idents</code> -- we can always change it later ^^</p>",
        "id": 249217243,
        "sender_full_name": "Yoshua Wuyts",
        "timestamp": 1628763423
    },
    {
        "content": "<p>ye seems good</p>",
        "id": 249217253,
        "sender_full_name": "Lukas Wirth",
        "timestamp": 1628763434
    },
    {
        "content": "<p>Making a note here that we should update <a href=\"https://github.com/rust-analyzer/rust-analyzer/blob/master/crates/ide_completion/src/completions/trait_impl.rs\">https://github.com/rust-analyzer/rust-analyzer/blob/master/crates/ide_completion/src/completions/trait_impl.rs</a></p>",
        "id": 249347517,
        "sender_full_name": "Yoshua Wuyts",
        "timestamp": 1628853126
    },
    {
        "content": "<p>Fixed the Debug codegen for record/tuple enums: <a href=\"https://github.com/rust-analyzer/rust-analyzer/pull/9924\">https://github.com/rust-analyzer/rust-analyzer/pull/9924</a></p>",
        "id": 249605512,
        "sender_full_name": "Yoshua Wuyts",
        "timestamp": 1629128411
    }
]