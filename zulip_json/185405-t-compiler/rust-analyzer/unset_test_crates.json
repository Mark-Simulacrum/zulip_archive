[
    {
        "content": "<p>Hi everybody, <br>\nI'm trying to wrap my head around how to properly use <code>CargoConfig.unset_test_crates</code> without having to load a project twice (once to obtain the list of crates and once again with the list passed as <code>CargoConfig.unset_test_crates</code>) and was hoping for somebody to give me a hint or something. I basically want to have a <code>--with-tests</code> flag for my CLI tool using rust-analyzer, hence the need. The parameter feels a bit like a chicken vs. egg kind of situation to me.</p>",
        "id": 250040862,
        "sender_full_name": "regexident",
        "timestamp": 1629403042
    },
    {
        "content": "<p>cc <span class=\"user-mention\" data-user-id=\"133169\">@matklad</span> <span class=\"user-mention\" data-user-id=\"211727\">@Jonas Schievink  [he/him]</span></p>",
        "id": 250217574,
        "sender_full_name": "regexident",
        "timestamp": 1629552239
    },
    {
        "content": "<p>the way it is currently used is that the user just puts the names into a setting; presumably they know the crate names. For your use case it's indeed not the best way. It would be possible to change the API to make your case work</p>",
        "id": 250217928,
        "sender_full_name": "Florian Diebold",
        "timestamp": 1629552764
    },
    {
        "content": "<p>Thanks <span class=\"user-mention\" data-user-id=\"129457\">@Florian Diebold</span>!</p>\n<p>I'm thinking of replacing <code>unset_test_crates: Vec&lt;String&gt;</code> with …</p>\n<div class=\"codehilite\" data-code-language=\"Rust\"><pre><span></span><code><span class=\"k\">pub</span><span class=\"w\"> </span><span class=\"k\">enum</span> <span class=\"nc\">UnsetTestCrates</span><span class=\"w\"> </span><span class=\"p\">{</span><span class=\"w\"></span>\n<span class=\"w\">    </span><span class=\"nb\">None</span><span class=\"p\">,</span><span class=\"w\"></span>\n<span class=\"w\">    </span><span class=\"n\">Only</span><span class=\"p\">(</span><span class=\"nb\">Vec</span><span class=\"o\">&lt;</span><span class=\"nb\">String</span><span class=\"o\">&gt;</span><span class=\"p\">),</span><span class=\"w\"></span>\n<span class=\"w\">    </span><span class=\"n\">All</span><span class=\"p\">,</span><span class=\"w\"></span>\n<span class=\"p\">}</span><span class=\"w\"></span>\n</code></pre></div>\n<p>… and changing …</p>\n<div class=\"codehilite\" data-code-language=\"Rust\"><pre><span></span><code><span class=\"k\">pub</span><span class=\"w\"> </span><span class=\"k\">type</span> <span class=\"nc\">CfgOverrides</span><span class=\"w\"> </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"n\">FxHashMap</span><span class=\"o\">&lt;</span><span class=\"nb\">String</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"n\">CfgDiff</span><span class=\"o\">&gt;</span><span class=\"p\">;</span><span class=\"w\"></span>\n</code></pre></div>\n<p>… to something like …</p>\n<div class=\"codehilite\" data-code-language=\"Rust\"><pre><span></span><code><span class=\"k\">pub</span><span class=\"w\"> </span><span class=\"k\">type</span> <span class=\"nc\">CfgOverrides</span><span class=\"w\"> </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"n\">FxHashMap</span><span class=\"o\">&lt;</span><span class=\"nb\">Option</span><span class=\"o\">&lt;</span><span class=\"nb\">String</span><span class=\"o\">&gt;</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"n\">CfgDiff</span><span class=\"o\">&gt;</span><span class=\"p\">;</span><span class=\"w\"></span>\n</code></pre></div>\n<p>… where <code>None</code> represents a wildcard (i.e. \"match any crate\").</p>\n<p>Would this be along the lines of what you're thinking?</p>",
        "id": 250225506,
        "sender_full_name": "regexident",
        "timestamp": 1629563227
    }
]