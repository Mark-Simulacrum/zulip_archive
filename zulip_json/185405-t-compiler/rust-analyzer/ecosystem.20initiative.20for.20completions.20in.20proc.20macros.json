[
    {
        "content": "<p>Getting good completions in proc macros will probably require (or be vastly simpler with) better error recovery in those proc macros. Since getting that will take some time, maybe there needs to be some initiative to inform proc macro authors and get them on board, get support from <code>syn</code> etc.? This could probably even be a shared effort with IntelliJ Rust. Maybe we could provide proc macro authors some tools to more easily test whether their macro is IDE-ready.</p>\n<p>To be honest, I'm not volunteering for this though, I don't think I have the capacity. Just wondering whether it's something we should do / whether there are some easy first steps we could take right now to get the ball rolling...</p>",
        "id": 253087579,
        "sender_full_name": "Florian Diebold",
        "timestamp": 1631539173
    },
    {
        "content": "<p>yeah, this definitely sounds like a good idea!</p>",
        "id": 253089013,
        "sender_full_name": "Jonas Schievink  [he/him]",
        "timestamp": 1631539725
    },
    {
        "content": "<p>Just to get on the same page here, the current approach to parse errors in proc-macros is usually just emitting a <code>compile_error!</code> invocation right? Which means ideally we would want  authors to still emit their proper output where possible alongside the <code>compile_error!</code> invocation if I see that right then?</p>",
        "id": 253103069,
        "sender_full_name": "Lukas Wirth",
        "timestamp": 1631544828
    },
    {
        "content": "<p>Yeah, exactly</p>",
        "id": 253103217,
        "sender_full_name": "Jonas Schievink  [he/him]",
        "timestamp": 1631544865
    },
    {
        "content": "<p>I wrote up some more detail in this forum response: <a href=\"https://users.rust-lang.org/t/how-do-i-make-my-proc-macros-rust-analyzer-friendly/64632/2\">https://users.rust-lang.org/t/how-do-i-make-my-proc-macros-rust-analyzer-friendly/64632/2</a></p>",
        "id": 253103382,
        "sender_full_name": "Jonas Schievink  [he/him]",
        "timestamp": 1631544932
    },
    {
        "content": "<p>as a first step, maybe we could turn that forum response into an .md file in our repo <span aria-label=\"big smile\" class=\"emoji emoji-1f604\" role=\"img\" title=\"big smile\">:big_smile:</span></p>",
        "id": 253142219,
        "sender_full_name": "Florian Diebold",
        "timestamp": 1631559802
    },
    {
        "content": "<p>Would be a great file to have, tips and tricks for IDE friendly library development in general</p>",
        "id": 253157039,
        "sender_full_name": "Lukas Wirth",
        "timestamp": 1631565767
    },
    {
        "content": "<p>dtolnay disagrees with us: <a href=\"https://github.com/dtolnay/async-trait/issues/178\">https://github.com/dtolnay/async-trait/issues/178</a></p>",
        "id": 258931576,
        "sender_full_name": "Florian Diebold",
        "timestamp": 1635151864
    },
    {
        "content": "<p>I do have some doubts about forcing all attribute macros to adapt, but I still don't see a good alternative</p>",
        "id": 258931607,
        "sender_full_name": "Florian Diebold",
        "timestamp": 1635151895
    },
    {
        "content": "<p>only maybe if we could allow proc macros to opt-in to get invalid syntax, and otherwise implement a workaround</p>",
        "id": 258931731,
        "sender_full_name": "Florian Diebold",
        "timestamp": 1635151961
    },
    {
        "content": "<p>Ye I don't see this working in any other way unless we do the opt-in thing. But then again what is the point of that since rustc already passes invalid syntax to proc-macros as you've shown.</p>",
        "id": 258936690,
        "sender_full_name": "Lukas Wirth",
        "timestamp": 1635155107
    }
]