[
    {
        "content": "<p>Stream to discuss <a href=\"https://github.com/rust-analyzer/rust-analyzer/issues/10086\">https://github.com/rust-analyzer/rust-analyzer/issues/10086</a></p>",
        "id": 251245990,
        "sender_full_name": "matklad",
        "timestamp": 1630337000
    },
    {
        "content": "<p>Can we iterate through the <code>salsa</code> database? And why do you say it's small?</p>",
        "id": 251246126,
        "sender_full_name": "Laurențiu",
        "timestamp": 1630337055
    },
    {
        "content": "<blockquote>\n<p>And why do you say it's small?</p>\n</blockquote>\n<p>We only need the inputs, which are the text and crate graph</p>",
        "id": 251246256,
        "sender_full_name": "matklad",
        "timestamp": 1630337110
    },
    {
        "content": "<p>might be pretty useful even just for developer debugging purposes -- you could load RA in gdb with the snapshot and debug. I don't know if it's worth the effort</p>",
        "id": 251246260,
        "sender_full_name": "Florian Diebold",
        "timestamp": 1630337111
    },
    {
        "content": "<p>well, and proc macros, which kill this idea =/</p>",
        "id": 251246296,
        "sender_full_name": "matklad",
        "timestamp": 1630337126
    },
    {
        "content": "<p>^ yeah</p>",
        "id": 251246311,
        "sender_full_name": "Laurențiu",
        "timestamp": 1630337134
    },
    {
        "content": "<p>or at least make this significantly more complicated</p>",
        "id": 251246333,
        "sender_full_name": "matklad",
        "timestamp": 1630337146
    },
    {
        "content": "<p>Urgh, one more thing which macros make fundamentally impossible :(</p>",
        "id": 251246399,
        "sender_full_name": "matklad",
        "timestamp": 1630337165
    },
    {
        "content": "<p>Say we dump everything? (Not to sound like a broken record, but it might have other uses <span aria-label=\"grimacing\" class=\"emoji emoji-1f62c\" role=\"img\" title=\"grimacing\">:grimacing:</span>)</p>",
        "id": 251246466,
        "sender_full_name": "Laurențiu",
        "timestamp": 1630337199
    },
    {
        "content": "<p>That'd be significantly more involved, but possible in theory</p>",
        "id": 251246551,
        "sender_full_name": "matklad",
        "timestamp": 1630337239
    },
    {
        "content": "<p>And mostly unrelated, but a LSP replay log would also be useful. We had a couple of emoji-related issues where that would have helped.</p>",
        "id": 251246716,
        "sender_full_name": "Laurențiu",
        "timestamp": 1630337296
    },
    {
        "content": "<p>I guess we can do that today by picking LSP messages out of the logs.</p>",
        "id": 251246781,
        "sender_full_name": "Laurențiu",
        "timestamp": 1630337323
    },
    {
        "content": "<p>I think this has some interesting interactions with interning, since interning indices are unpredictable because they depend on the order things are interned in. Do we use them in a way that could cause problems here?</p>",
        "id": 251395269,
        "sender_full_name": "Jonas Schievink  [he/him]",
        "timestamp": 1630420458
    },
    {
        "content": "<p>I think this shouldn't be the issue (if we ignore proc macros): we don't mention indices anywhere. We only store the inputs, as well as LSP query that triggers the faileuer. </p>\n<p>That's the intrinsic beauty with this approach -- salsa reconstructs internal state (indicies) just from inputs.</p>",
        "id": 251402850,
        "sender_full_name": "matklad",
        "timestamp": 1630423201
    }
]