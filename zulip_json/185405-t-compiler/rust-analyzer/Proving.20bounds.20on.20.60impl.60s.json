[
    {
        "content": "<p>I'm looking into the inherent method resolution bug <a href=\"https://github.com/rust-analyzer/rust-analyzer/issues/9938\">https://github.com/rust-analyzer/rust-analyzer/issues/9938</a>.</p>\n<p>For that, I'm trying to check if there are any <code>where</code>-clauses on the candidate impl that are known to be false, but I'm running into issues where the <code>inherent_impl_substs</code> don't seem to be correct, which leads to panics.</p>\n<p>For example, in the test <code>infer_argument_autoderef</code>, we end up with:</p>\n<div class=\"codehilite\"><pre><span></span><code>[crates/hir_ty/src/method_resolution.rs:756] &amp;pred = for&lt;type&gt; for&lt;&gt; Implemented(^1.0: TraitId(0))\n[crates/hir_ty/src/method_resolution.rs:756] &amp;substs = [?0 := ^0.0]\n[crates/hir_ty/src/method_resolution.rs:756] &amp;clause = for&lt;&gt; Implemented(^1.0: TraitId(0))\n</code></pre></div>\n<p>This should correspond to <code>impl&lt;T&gt; A&lt;T&gt; { ... }</code>. It seems that these substs replace the bound type <code>T</code> with another bound type that does not exist. I'm not sure why though.</p>",
        "id": 249846484,
        "sender_full_name": "Jonas Schievink  [he/him]",
        "timestamp": 1629292301
    },
    {
        "content": "<p>I think the bound vars in the subst refer to the binders of the <code>Canonical</code> <code>self_ty</code></p>",
        "id": 249848225,
        "sender_full_name": "Florian Diebold",
        "timestamp": 1629293051
    },
    {
        "content": "<p>so they represent inference variables that have been canonicalized</p>",
        "id": 249848267,
        "sender_full_name": "Florian Diebold",
        "timestamp": 1629293070
    },
    {
        "content": "<p>ah</p>",
        "id": 249848300,
        "sender_full_name": "Jonas Schievink  [he/him]",
        "timestamp": 1629293089
    },
    {
        "content": "<p>I was wondering why <code>Canonical</code> would act as a binder, that makes sense</p>",
        "id": 249848512,
        "sender_full_name": "Jonas Schievink  [he/him]",
        "timestamp": 1629293184
    },
    {
        "content": "<p>tbh, it might not be a good idea that method resolution deals with canonicals, maybe it should be refactored to directly work with the inference table instead</p>",
        "id": 249848677,
        "sender_full_name": "Florian Diebold",
        "timestamp": 1629293280
    }
]