[
    {
        "content": "<p>I'm in the process of moving the remaining travis tests to github actions and for some reason the powerpc64 tests are not cooperating (regular powerpc does).  Here's the error:</p>",
        "id": 258119260,
        "sender_full_name": "Caleb Zulawski",
        "timestamp": 1634600536
    },
    {
        "content": "<div class=\"codehilite\"><pre><span></span><code>error: linking with `cc` failed: exit status: 1\n  |\n  = note: &quot;cc&quot; &quot;-m64&quot; &quot;/home/runner/work/portable-simd/portable-simd/target/powerpc64-unknown-linux-gnu/debug/deps/test_helpers-90918dfe596ac073.2bjhrkt9t7ru62po.rcgu.o&quot; &quot;/home/runner/work/portable-simd/portable-simd/target/powerpc64-unknown-linux-gnu/debug/deps/test_helpers-90918dfe596ac073.2p2johd84x6d4tuj.rcgu.o&quot; &quot;/home/runner/work/portable-simd/portable-simd/target/powerpc64-unknown-linux-gnu/debug/deps/test_helpers-90918dfe596ac073.3arsynwrtnnki0ra.rcgu.o&quot; &quot;/home/runner/work/portable-simd/portable-simd/target/powerpc64-unknown-linux-gnu/debug/deps/test_helpers-90918dfe596ac073.3fqp90udbmbf0jvq.rcgu.o&quot; &quot;/home/runner/work/portable-simd/portable-simd/target/powerpc64-unknown-linux-gnu/debug/deps/test_helpers-90918dfe596ac073.3q5ej4n5v6eiy4b9.rcgu.o&quot; &quot;/home/runner/work/portable-simd/portable-simd/target/powerpc64-unknown-linux-gnu/debug/deps/test_helpers-90918dfe596ac073.4wv0xq86wruhp0ht.rcgu.o&quot; &quot;/home/runner/work/portable-simd/portable-simd/target/powerpc64-unknown-linux-gnu/debug/deps/test_helpers-90918dfe596ac073.vkx2h2dsfj6f9hd.rcgu.o&quot; &quot;/home/runner/work/portable-simd/portable-simd/target/powerpc64-unknown-linux-gnu/debug/deps/test_helpers-90918dfe596ac073.3dw84v0si79b76gu.rcgu.o&quot; &quot;-Wl,--as-needed&quot; &quot;-L&quot; &quot;/home/runner/work/portable-simd/portable-simd/target/powerpc64-unknown-linux-gnu/debug/deps&quot; &quot;-L&quot; &quot;/home/runner/work/portable-simd/portable-simd/target/debug/deps&quot; &quot;-L&quot; &quot;/usr/share/rust/.rustup/toolchains/nightly-x86_64-unknown-linux-gnu/lib/rustlib/powerpc64-unknown-linux-gnu/lib&quot; &quot;-Wl,-Bstatic&quot; &quot;/usr/share/rust/.rustup/toolchains/nightly-x86_64-unknown-linux-gnu/lib/rustlib/powerpc64-unknown-linux-gnu/lib/libtest-32b4c329bf2b78c5.rlib&quot; &quot;/usr/share/rust/.rustup/toolchains/nightly-x86_64-unknown-linux-gnu/lib/rustlib/powerpc64-unknown-linux-gnu/lib/libgetopts-cf204a0f572ce6c6.rlib&quot; &quot;/usr/share/rust/.rustup/toolchains/nightly-x86_64-unknown-linux-gnu/lib/rustlib/powerpc64-unknown-linux-gnu/lib/libunicode_width-cbbe57f6da0c8d43.rlib&quot; &quot;/usr/share/rust/.rustup/toolchains/nightly-x86_64-unknown-linux-gnu/lib/rustlib/powerpc64-unknown-linux-gnu/lib/librustc_std_workspace_std-d61c6b80c8473440.rlib&quot; &quot;/home/runner/work/portable-simd/portable-simd/target/powerpc64-unknown-linux-gnu/debug/deps/libproptest-a2f09d286092adfe.rlib&quot; &quot;/home/runner/work/portable-simd/portable-simd/target/powerpc64-unknown-linux-gnu/debug/deps/librand_xorshift-20efce74f333bf48.rlib&quot; &quot;/home/runner/work/portable-simd/portable-simd/target/powerpc64-unknown-linux-gnu/debug/deps/libbyteorder-4c515d6b6855469a.rlib&quot; &quot;/home/runner/work/portable-simd/portable-simd/target/powerpc64-unknown-linux-gnu/debug/deps/libnum_traits-0f48fdc673aa4a58.rlib&quot; &quot;/home/runner/work/portable-simd/portable-simd/target/powerpc64-unknown-linux-gnu/debug/deps/librand-7b5b895618fe68b3.rlib&quot; &quot;/home/runner/work/portable-simd/portable-simd/target/powerpc64-unknown-linux-gnu/debug/deps/librand_chacha-db9cf417b8d7aaf4.rlib&quot; &quot;/home/runner/work/portable-simd/portable-simd/target/powerpc64-unknown-linux-gnu/debug/deps/libppv_lite86-9c9587d34ccac819.rlib&quot; &quot;/home/runner/work/portable-simd/portable-simd/target/powerpc64-unknown-linux-gnu/debug/deps/librand_core-a05dde0a32331e97.rlib&quot; &quot;/home/runner/work/portable-simd/portable-simd/target/powerpc64-unknown-linux-gnu/debug/deps/libbitflags-16e1f8ba4d870a49.rlib&quot; &quot;-Wl,--start-group&quot; &quot;/usr/share/rust/.rustup/toolchains/nightly-x86_64-unknown-linux-gnu/lib/rustlib/powerpc64-unknown-linux-gnu/lib/libstd-aeaa114d56479978.rlib&quot; &quot;/usr/share/rust/.rustup/toolchains/nightly-x86_64-unknown-linux-gnu/lib/rustlib/powerpc64-unknown-linux-gnu/lib/libpanic_unwind-9f24228f1be8b876.rlib&quot; &quot;/usr/share/rust/.rustup/toolchains/nightly-x86_64-unknown-linux-gnu/lib/rustlib/powerpc64-unknown-linux-gnu/lib/libminiz_oxide-d07ccb10564f8f1e.rlib&quot; &quot;/usr/share/rust/.rustup/toolchains/nightly-x86_64-unknown-linux-gnu/lib/rustlib/powerpc64-unknown-linux-gnu/lib/libadler-50d38d4e4cc830d0.rlib&quot; &quot;/usr/share/rust/.rustup/toolchains/nightly-x86_64-unknown-linux-gnu/lib/rustlib/powerpc64-unknown-linux-gnu/lib/libobject-a156baf5fffdf9c1.rlib&quot; &quot;/usr/share/rust/.rustup/toolchains/nightly-x86_64-unknown-linux-gnu/lib/rustlib/powerpc64-unknown-linux-gnu/lib/libmemchr-7764f9cf6c9b5b7c.rlib&quot; &quot;/usr/share/rust/.rustup/toolchains/nightly-x86_64-unknown-linux-gnu/lib/rustlib/powerpc64-unknown-linux-gnu/lib/libaddr2line-8d65623236abcece.rlib&quot; &quot;/usr/share/rust/.rustup/toolchains/nightly-x86_64-unknown-linux-gnu/lib/rustlib/powerpc64-unknown-linux-gnu/lib/libgimli-b00d6233505d31ba.rlib&quot; &quot;/usr/share/rust/.rustup/toolchains/nightly-x86_64-unknown-linux-gnu/lib/rustlib/powerpc64-unknown-linux-gnu/lib/libstd_detect-a97f633f13d4a389.rlib&quot; &quot;/usr/share/rust/.rustup/toolchains/nightly-x86_64-unknown-linux-gnu/lib/rustlib/powerpc64-unknown-linux-gnu/lib/librustc_demangle-3fac89ea750dd396.rlib&quot; &quot;/usr/share/rust/.rustup/toolchains/nightly-x86_64-unknown-linux-gnu/lib/rustlib/powerpc64-unknown-linux-gnu/lib/libhashbrown-4d721f6c902a1e7a.rlib&quot; &quot;/usr/share/rust/.rustup/toolchains/nightly-x86_64-unknown-linux-gnu/lib/rustlib/powerpc64-unknown-linux-gnu/lib/librustc_std_workspace_alloc-d9e673e5ccad56c0.rlib&quot; &quot;/usr/share/rust/.rustup/toolchains/nightly-x86_64-unknown-linux-gnu/lib/rustlib/powerpc64-unknown-linux-gnu/lib/libunwind-bdcfb2c9e30412e4.rlib&quot; &quot;/usr/share/rust/.rustup/toolchains/nightly-x86_64-unknown-linux-gnu/lib/rustlib/powerpc64-unknown-linux-gnu/lib/libcfg_if-a9cb4cc2fd43ee3f.rlib&quot; &quot;/usr/share/rust/.rustup/toolchains/nightly-x86_64-unknown-linux-gnu/lib/rustlib/powerpc64-unknown-linux-gnu/lib/liblibc-626a60263eff6c53.rlib&quot; &quot;/usr/share/rust/.rustup/toolchains/nightly-x86_64-unknown-linux-gnu/lib/rustlib/powerpc64-unknown-linux-gnu/lib/liballoc-656d70675dc1aeea.rlib&quot; &quot;/usr/share/rust/.rustup/toolchains/nightly-x86_64-unknown-linux-gnu/lib/rustlib/powerpc64-unknown-linux-gnu/lib/librustc_std_workspace_core-820519559b52d087.rlib&quot; &quot;/usr/share/rust/.rustup/toolchains/nightly-x86_64-unknown-linux-gnu/lib/rustlib/powerpc64-unknown-linux-gnu/lib/libcore-7fe24c5a8643bd22.rlib&quot; &quot;-Wl,--end-group&quot; &quot;/usr/share/rust/.rustup/toolchains/nightly-x86_64-unknown-linux-gnu/lib/rustlib/powerpc64-unknown-linux-gnu/lib/libcompiler_builtins-ced6ec47a4ce1e72.rlib&quot; &quot;-Wl,-Bdynamic&quot; &quot;-lgcc_s&quot; &quot;-lutil&quot; &quot;-lrt&quot; &quot;-lpthread&quot; &quot;-lm&quot; &quot;-ldl&quot; &quot;-lc&quot; &quot;-Wl,--eh-frame-hdr&quot; &quot;-Wl,-znoexecstack&quot; &quot;-L&quot; &quot;/usr/share/rust/.rustup/toolchains/nightly-x86_64-unknown-linux-gnu/lib/rustlib/powerpc64-unknown-linux-gnu/lib&quot; &quot;-o&quot; &quot;/home/runner/work/portable-simd/portable-simd/target/powerpc64-unknown-linux-gnu/debug/deps/test_helpers-90918dfe596ac073&quot; &quot;-Wl,--gc-sections&quot; &quot;-pie&quot; &quot;-Wl,-zrelro&quot; &quot;-nodefaultlibs&quot;\n  = note: /usr/bin/ld: /home/runner/work/portable-simd/portable-simd/target/powerpc64-unknown-linux-gnu/debug/deps/test_helpers-90918dfe596ac073.2bjhrkt9t7ru62po.rcgu.o: Relocations in generic ELF (EM: 21)\n          /usr/bin/ld: /home/runner/work/portable-simd/portable-simd/target/powerpc64-unknown-linux-gnu/debug/deps/test_helpers-90918dfe596ac073.2bjhrkt9t7ru62po.rcgu.o: Relocations in generic ELF (EM: 21)\n          /usr/bin/ld: /home/runner/work/portable-simd/portable-simd/target/powerpc64-unknown-linux-gnu/debug/deps/test_helpers-90918dfe596ac073.2bjhrkt9t7ru62po.rcgu.o: Relocations in generic ELF (EM: 21)\n          /usr/bin/ld: /home/runner/work/portable-simd/portable-simd/target/powerpc64-unknown-linux-gnu/debug/deps/test_helpers-90918dfe596ac073.2bjhrkt9t7ru62po.rcgu.o: Relocations in generic ELF (EM: 21)\n          /usr/bin/ld: /home/runner/work/portable-simd/portable-simd/target/powerpc64-unknown-linux-gnu/debug/deps/test_helpers-90918dfe596ac073.2bjhrkt9t7ru62po.rcgu.o: Relocations in generic ELF (EM: 21)\n          /usr/bin/ld: /home/runner/work/portable-simd/portable-simd/target/powerpc64-unknown-linux-gnu/debug/deps/test_helpers-90918dfe596ac073.2bjhrkt9t7ru62po.rcgu.o: Relocations in generic ELF (EM: 21)\n          /usr/bin/ld: /home/runner/work/portable-simd/portable-simd/target/powerpc64-unknown-linux-gnu/debug/deps/test_helpers-90918dfe596ac073.2bjhrkt9t7ru62po.rcgu.o: Relocations in generic ELF (EM: 21)\n          /usr/bin/ld: /home/runner/work/portable-simd/portable-simd/target/powerpc64-unknown-linux-gnu/debug/deps/test_helpers-90918dfe596ac073.2bjhrkt9t7ru62po.rcgu.o: Relocations in generic ELF (EM: 21)\n          /usr/bin/ld: /home/runner/work/portable-simd/portable-simd/target/powerpc64-unknown-linux-gnu/debug/deps/test_helpers-90918dfe596ac073.2bjhrkt9t7ru62po.rcgu.o: Relocations in generic ELF (EM: 21)\n          /usr/bin/ld: /home/runner/work/portable-simd/portable-simd/target/powerpc64-unknown-linux-gnu/debug/deps/test_helpers-90918dfe596ac073.2bjhrkt9t7ru62po.rcgu.o: Relocations in generic ELF (EM: 21)\n          /usr/bin/ld: /home/runner/work/portable-simd/portable-simd/target/powerpc64-unknown-linux-gnu/debug/deps/test_helpers-90918dfe596ac073.2bjhrkt9t7ru62po.rcgu.o: Relocations in generic ELF (EM: 21)\n          /usr/bin/ld: /home/runner/work/portable-simd/portable-simd/target/powerpc64-unknown-linux-gnu/debug/deps/test_helpers-90918dfe596ac073.2bjhrkt9t7ru62po.rcgu.o: error adding symbols: file in wrong format\n          collect2: error: ld returned 1 exit status\n</code></pre></div>\n<div class=\"codehilite\"><pre><span></span><code>\n</code></pre></div>",
        "id": 258119312,
        "sender_full_name": "Caleb Zulawski",
        "timestamp": 1634600578
    },
    {
        "content": "<p>hmm, seems likely that something is confusing powerpc64 with powerpc64le or something</p>",
        "id": 258120924,
        "sender_full_name": "Jacob Lifshay",
        "timestamp": 1634601706
    },
    {
        "content": "<p>The dockerfile doesn't seem to be doing anything particularly interesting regarding the c compiler: <a href=\"https://github.com/rust-embedded/cross/blob/master/docker/Dockerfile.powerpc64-unknown-linux-gnu\">https://github.com/rust-embedded/cross/blob/master/docker/Dockerfile.powerpc64-unknown-linux-gnu</a></p>",
        "id": 258121053,
        "sender_full_name": "Caleb Zulawski",
        "timestamp": 1634601788
    },
    {
        "content": "<p><a href=\"https://github.com/rust-embedded/cross/blob/master/docker/Dockerfile.powerpc64le-unknown-linux-gnu\">https://github.com/rust-embedded/cross/blob/master/docker/Dockerfile.powerpc64le-unknown-linux-gnu</a> for le</p>",
        "id": 258121108,
        "sender_full_name": "Caleb Zulawski",
        "timestamp": 1634601839
    },
    {
        "content": "<p>I see on another similar rust-lang issue someone suggesting to use <code>-C linker={target}-gcc</code></p>",
        "id": 258121268,
        "sender_full_name": "Caleb Zulawski",
        "timestamp": 1634601947
    },
    {
        "content": "<p>I feel like cross should automatically specify that, if it doesn't</p>",
        "id": 258121327,
        "sender_full_name": "Caleb Zulawski",
        "timestamp": 1634601966
    },
    {
        "content": "<p>if it's depending on the <code>platforms</code> crate, I adjusted it a while ago to get the correct target, since it wasn't before: <a href=\"https://web.archive.org/web/20201130071507/https://github.com/RustSec/platforms-crate/pull/29\">https://web.archive.org/web/20201130071507/https://github.com/RustSec/platforms-crate/pull/29</a></p>",
        "id": 258121690,
        "sender_full_name": "Jacob Lifshay",
        "timestamp": 1634602233
    },
    {
        "content": "<p>(the github repo was deleted instead of archived)</p>",
        "id": 258121720,
        "sender_full_name": "Jacob Lifshay",
        "timestamp": 1634602256
    },
    {
        "content": "<p>annoying...</p>",
        "id": 258121737,
        "sender_full_name": "Jacob Lifshay",
        "timestamp": 1634602270
    },
    {
        "content": "<p>ah, it's trying to link with <code>cc</code>, not with the linker you set in the env var for ppc64</p>",
        "id": 258122019,
        "sender_full_name": "Jacob Lifshay",
        "timestamp": 1634602451
    },
    {
        "content": "<p><a href=\"https://github.com/rust-embedded/cross/blob/2b2a01220c73ae517129019d436d382412d1928b/docker/Dockerfile.powerpc64-unknown-linux-gnu#L27\">https://github.com/rust-embedded/cross/blob/2b2a01220c73ae517129019d436d382412d1928b/docker/Dockerfile.powerpc64-unknown-linux-gnu#L27</a></p>",
        "id": 258122093,
        "sender_full_name": "Jacob Lifshay",
        "timestamp": 1634602502
    },
    {
        "content": "<p>maybe a bug in cargo where it's not telling rustc to use the correct linker even though you overrode it in the env var?</p>",
        "id": 258122280,
        "sender_full_name": "Jacob Lifshay",
        "timestamp": 1634602646
    },
    {
        "content": "<p>oh you're right, it's literally right there in the dockerfile</p>",
        "id": 258122554,
        "sender_full_name": "Caleb Zulawski",
        "timestamp": 1634602829
    },
    {
        "content": "<p>well I'll try manually setting it to see what happens</p>",
        "id": 258122565,
        "sender_full_name": "Caleb Zulawski",
        "timestamp": 1634602838
    },
    {
        "content": "<p>oh</p>",
        "id": 258123564,
        "sender_full_name": "Caleb Zulawski",
        "timestamp": 1634603610
    },
    {
        "content": "<p><span aria-label=\"face palm\" class=\"emoji emoji-1f926\" role=\"img\" title=\"face palm\">:face_palm:</span></p>",
        "id": 258123572,
        "sender_full_name": "Caleb Zulawski",
        "timestamp": 1634603617
    },
    {
        "content": "<div class=\"codehilite\"><pre><span></span><code>Warning: `cross` does not provide a Docker image for target powerpc64-unknown-linux-gnu, specify a custom image in `Cross.toml`. Falling back to `cargo` on the host.\n</code></pre></div>",
        "id": 258123577,
        "sender_full_name": "Caleb Zulawski",
        "timestamp": 1634603623
    },
    {
        "content": "<p>that's why</p>",
        "id": 258123581,
        "sender_full_name": "Caleb Zulawski",
        "timestamp": 1634603625
    },
    {
        "content": "<p>cross master has ppc64, but not the released version</p>",
        "id": 258123605,
        "sender_full_name": "Caleb Zulawski",
        "timestamp": 1634603642
    },
    {
        "content": "<p>there hasn't been a release in over a year</p>",
        "id": 258123652,
        "sender_full_name": "Caleb Zulawski",
        "timestamp": 1634603656
    },
    {
        "content": "<p>I've been playing around with this a little, just try to to figure out at all what the problem is</p>",
        "id": 259182009,
        "sender_full_name": "Caleb Zulawski",
        "timestamp": 1635296650
    },
    {
        "content": "<p>here's something weird: if I change <code>is_sign_negative</code> to always return false, that test passes :(</p>",
        "id": 259182062,
        "sender_full_name": "Caleb Zulawski",
        "timestamp": 1635296683
    },
    {
        "content": "<p>of course when I run it natively, those tests all fail</p>",
        "id": 259182192,
        "sender_full_name": "Caleb Zulawski",
        "timestamp": 1635296777
    },
    {
        "content": "<p>(with the bad fn implementation)</p>",
        "id": 259182202,
        "sender_full_name": "Caleb Zulawski",
        "timestamp": 1635296786
    },
    {
        "content": "<p>if I change <code>is_sign_negative</code> to do a naive loop, no platform-intrinsics, it still fails</p>",
        "id": 259182268,
        "sender_full_name": "Caleb Zulawski",
        "timestamp": 1635296837
    },
    {
        "content": "<p>I don't actually know that this bug has anything to do with simd, at all?</p>",
        "id": 259182280,
        "sender_full_name": "Caleb Zulawski",
        "timestamp": 1635296850
    },
    {
        "content": "<p>is f32::is_sign_negative broken? does the naive loop work in debug mode?</p>",
        "id": 259182427,
        "sender_full_name": "Jacob Lifshay",
        "timestamp": 1635296983
    },
    {
        "content": "<p>it's completely broken. the test is even broken</p>",
        "id": 259182673,
        "sender_full_name": "Caleb Zulawski",
        "timestamp": 1635297223
    },
    {
        "content": "<p>returning <code>Mask::splat(false)</code> passes</p>",
        "id": 259182716,
        "sender_full_name": "Caleb Zulawski",
        "timestamp": 1635297243
    },
    {
        "content": "<p>worth noting it's consistent, somehow, if you return <code>true</code> it fails</p>",
        "id": 259183068,
        "sender_full_name": "Caleb Zulawski",
        "timestamp": 1635297676
    },
    {
        "content": "<p>from manually inspecting f32::is_sign_negative's generated asm, it looks correct...</p>",
        "id": 259183157,
        "sender_full_name": "Jacob Lifshay",
        "timestamp": 1635297768
    },
    {
        "content": "<p>on ppc64le?</p>",
        "id": 259183173,
        "sender_full_name": "Caleb Zulawski",
        "timestamp": 1635297800
    },
    {
        "content": "<p>yeah I thought so too</p>",
        "id": 259183174,
        "sender_full_name": "Caleb Zulawski",
        "timestamp": 1635297804
    },
    {
        "content": "<p>I think there must be something going on with inlining, maybe</p>",
        "id": 259183185,
        "sender_full_name": "Caleb Zulawski",
        "timestamp": 1635297822
    },
    {
        "content": "<p>maybe vectorization causes it to break...</p>",
        "id": 259183196,
        "sender_full_name": "Jacob Lifshay",
        "timestamp": 1635297840
    },
    {
        "content": "<p>well, it's broken in debug mode too</p>",
        "id": 259183297,
        "sender_full_name": "Caleb Zulawski",
        "timestamp": 1635297942
    },
    {
        "content": "<p>our ppc tests used to pass on travis, so I think our 2 choices are 1) LLVM broke since then, or 2) qemu is broken</p>",
        "id": 259183369,
        "sender_full_name": "Caleb Zulawski",
        "timestamp": 1635298029
    },
    {
        "content": "<p>is it newly llvm13?</p>",
        "id": 259183542,
        "sender_full_name": "Thom Chiovoloni",
        "timestamp": 1635298239
    },
    {
        "content": "<p>i think llvm 13 broke some other ppc stuff (it also seems to have broken riscv32 but i havent filed it yet)</p>",
        "id": 259183559,
        "sender_full_name": "Thom Chiovoloni",
        "timestamp": 1635298269
    },
    {
        "content": "<p>I have access to a power9 server, lemme test on that...</p>",
        "id": 259183562,
        "sender_full_name": "Jacob Lifshay",
        "timestamp": 1635298271
    },
    {
        "content": "<p><code>cargo +nightly test</code> passes for 772bf2090</p>",
        "id": 259183829,
        "sender_full_name": "Jacob Lifshay",
        "timestamp": 1635298566
    },
    {
        "content": "<p>wait, seriously?</p>",
        "id": 259183838,
        "sender_full_name": "Caleb Zulawski",
        "timestamp": 1635298608
    },
    {
        "content": "<p>what is the architecture of power9? ppc64le?</p>",
        "id": 259183841,
        "sender_full_name": "Caleb Zulawski",
        "timestamp": 1635298619
    },
    {
        "content": "<p>yup</p>",
        "id": 259183850,
        "sender_full_name": "Jacob Lifshay",
        "timestamp": 1635298626
    },
    {
        "content": "<p><code>cargo +nightly test --release</code> also passes</p>",
        "id": 259183907,
        "sender_full_name": "Jacob Lifshay",
        "timestamp": 1635298688
    },
    {
        "content": "<p>latest nightly?</p>",
        "id": 259183912,
        "sender_full_name": "Caleb Zulawski",
        "timestamp": 1635298697
    },
    {
        "content": "<p>2021-10-26</p>",
        "id": 259183927,
        "sender_full_name": "Jacob Lifshay",
        "timestamp": 1635298726
    },
    {
        "content": "<p>is there any chance the codegen is different on x86-64 -&gt; ppc vs ppc native?</p>",
        "id": 259183959,
        "sender_full_name": "Caleb Zulawski",
        "timestamp": 1635298768
    },
    {
        "content": "<p>I imagine it would be the same</p>",
        "id": 259183962,
        "sender_full_name": "Caleb Zulawski",
        "timestamp": 1635298777
    },
    {
        "content": "<p>lemme test in qemu on my x86 desktop...</p>",
        "id": 259184024,
        "sender_full_name": "Jacob Lifshay",
        "timestamp": 1635298837
    },
    {
        "content": "<p>fixing my chroot first...</p>",
        "id": 259184666,
        "sender_full_name": "Jacob Lifshay",
        "timestamp": 1635299672
    },
    {
        "content": "<p>oh I just used cross to do it</p>",
        "id": 259184697,
        "sender_full_name": "Caleb Zulawski",
        "timestamp": 1635299730
    },
    {
        "content": "<p>but yeah that's a good test too</p>",
        "id": 259184706,
        "sender_full_name": "Caleb Zulawski",
        "timestamp": 1635299742
    },
    {
        "content": "<p>i'm using qemu from ubuntu 20.04, maybe cross's version is broken</p>",
        "id": 259184754,
        "sender_full_name": "Jacob Lifshay",
        "timestamp": 1635299766
    },
    {
        "content": "<p>well, rustc hung in qemu, had to kill it and restart the build</p>",
        "id": 259187935,
        "sender_full_name": "Jacob Lifshay",
        "timestamp": 1635303853
    },
    {
        "content": "<div class=\"codehilite\"><pre><span></span><code>failures:\n\n---- f64::clamp::lanes_2 stdout ----\nthread &#39;f64::clamp::lanes_2&#39; panicked at &#39;called `Result::unwrap()` on an `Err` value: Fail(Reason(&quot;assertion failed: `(left == right)` \\n  left: `[0.0 (0), 0.0 (0)]`,\\n right: `[0.0 (0), NaN (7fff19e22cf2fc9a)]` at crates/core_simd/tests/f64_ops.rs:5&quot;), ([0.0, NaN], [0.0, 0.0], [0.0, 0.0]))&#39;, /home/jacob/portable-simd/crates/test_helpers/src/lib.rs:118:10\nnote: run with `RUST_BACKTRACE=1` environment variable to display a backtrace\n\n---- f64::clamp::lanes_16 stdout ----\nthread &#39;f64::clamp::lanes_16&#39; panicked at &#39;called `Result::unwrap()` on an `Err` value: Fail(Reason(&quot;assertion failed: `(left == right)` \\n  left: `[0.0 (0), 0.0 (0), 0.0 (0), -0.0 (8000000000000000), 0.0 (0), 0.0 (0), 0.0 (0), 0.0 (0), 0.0 (0), 0.0 (0), 0.0 (0), 0.0 (0), 0.0 (0), 0.0 (0), 0.0 (0), 0.0 (0)]`,\\n right: `[0.0 (0), 0.0 (0), 0.0 (0), -0.0 (8000000000000000), 0.0 (0), 0.0 (0), 0.0 (0), 0.0 (0), 0.0 (0), 0.0 (0), 0.0 (0), 0.0 (0), NaN (ffff8e8e85588d00), 0.0 (0), 0.0 (0), 0.0 (0)]` at crates/core_simd/tests/f64_ops.rs:5&quot;), ([0.0, 0.0, 0.0, -0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, NaN, 0.0, 0.0, 0.0], [0.0, -0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]))&#39;, /home/jacob/portable-simd/crates/test_helpers/src/lib.rs:118:10\n\n---- f64::clamp::lanes_32 stdout ----\nthread &#39;f64::clamp::lanes_32&#39; panicked at &#39;called `Result::unwrap()` on an `Err` value: Fail(Reason(&quot;assertion failed: `(left == right)` \\n  left: `[0.0 (0), 0.0 (0), 0.0 (0), 0.0 (0), 0.0 (0), -0.0 (8000000000000000), 0.0 (0), 0.0 (0), 0.0 (0), 0.0 (0), 0.0 (0), 0.0 (0), 0.0 (0), 0.0 (0), 0.0 (0), 0.0 (0), 0.0 (0), 0.0 (0), 0.0 (0), 0.0 (0), 0.0 (0), 0.0 (0), 0.0 (0), 0.0 (0), 0.0 (0), -0.0 (8000000000000000), 0.0 (0), 0.0 (0), 0.0 (0), 0.0 (0), 0.0 (0), 0.0 (0)]`,\\n right: `[0.0 (0), 0.0 (0), 0.0 (0), 0.0 (0), 0.0 (0), -0.0 (8000000000000000), 0.0 (0), 0.0 (0), 0.0 (0), 0.0 (0), 0.0 (0), 0.0 (0), 0.0 (0), 0.0 (0), 0.0 (0), 0.0 (0), 0.0 (0), 0.0 (0), 0.0 (0), 0.0 (0), 0.0 (0), 0.0 (0), 0.0 (0), 0.0 (0), NaN (7ffe2fb5c5dd420c), -0.0 (8000000000000000), 0.0 (0), 0.0 (0), 0.0 (0), 0.0 (0), 0.0 (0), 0.0 (0)]` at crates/core_simd/tests/f64_ops.rs:5&quot;), ([0.0, 0.0, 0.0, 0.0, 0.0, -0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, NaN, -0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], [0.0, 0.0, 0.0, 0.0, 0.0, -0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]))&#39;, /home/jacob/portable-simd/crates/test_helpers/src/lib.rs:118:10\n\n---- f64::clamp::lanes_8 stdout ----\nthread &#39;f64::clamp::lanes_8&#39; panicked at &#39;called `Result::unwrap()` on an `Err` value: Fail(Reason(&quot;assertion failed: `(left == right)` \\n  left: `[0.0 (0), 0.0 (0), 0.0 (0), 0.0 (0), 0.0 (0), 0.0 (0), 0.0 (0), 0.0 (0)]`,\\n right: `[0.0 (0), 0.0 (0), 0.0 (0), 0.0 (0), 0.0 (0), 0.0 (0), 0.0 (0), NaN (7ffbe3187f86a079)]` at crates/core_simd/tests/f64_ops.rs:5&quot;), ([0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, NaN], [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]))&#39;, /home/jacob/portable-simd/crates/test_helpers/src/lib.rs:118:10\n\n---- f64::clamp::lanes_4 stdout ----\nthread &#39;f64::clamp::lanes_4&#39; panicked at &#39;called `Result::unwrap()` on an `Err` value: Fail(Reason(&quot;assertion failed: `(left == right)` \\n  left: `[0.0 (0), 0.0 (0), 0.0 (0), 0.0 (0)]`,\\n right: `[0.0 (0), 0.0 (0), NaN (fffde7940ed69401), 0.0 (0)]` at crates/core_simd/tests/f64_ops.rs:5&quot;), ([0.0, 0.0, NaN, 0.0], [0.0, 0.0, 0.0, 0.0], [0.0, 0.0, 0.0, 0.0]))&#39;, /home/jacob/portable-simd/crates/test_helpers/src/lib.rs:118:10\n\n\nfailures:\n    f64::clamp::lanes_16\n    f64::clamp::lanes_2\n    f64::clamp::lanes_32\n    f64::clamp::lanes_4\n    f64::clamp::lanes_8\n</code></pre></div>",
        "id": 259187948,
        "sender_full_name": "Jacob Lifshay",
        "timestamp": 1635303888
    },
    {
        "content": "<p>I did see that function spuriously error with cross.</p>",
        "id": 259187963,
        "sender_full_name": "Caleb Zulawski",
        "timestamp": 1635303912
    },
    {
        "content": "<p>Though it's interesting you see different errors than I did</p>",
        "id": 259187974,
        "sender_full_name": "Caleb Zulawski",
        "timestamp": 1635303932
    },
    {
        "content": "<p>qemu-ppc64le version 4.2.1 (Debian 1:4.2-3ubuntu6.18)</p>",
        "id": 259187977,
        "sender_full_name": "Jacob Lifshay",
        "timestamp": 1635303937
    },
    {
        "content": "<p>some of the errors may be caused by my having to kill -9 rustc</p>",
        "id": 259187989,
        "sender_full_name": "Jacob Lifshay",
        "timestamp": 1635303958
    },
    {
        "content": "<p>Very odd but it really seems like this is an issue with qemu</p>",
        "id": 259188130,
        "sender_full_name": "Caleb Zulawski",
        "timestamp": 1635304095
    },
    {
        "content": "<p>so, since it works just fine on a native power9 system, I'd guess the errors are caused by qemu.</p>",
        "id": 259188137,
        "sender_full_name": "Jacob Lifshay",
        "timestamp": 1635304109
    },
    {
        "content": "<p>Yeah, I think you're right</p>",
        "id": 259188149,
        "sender_full_name": "Caleb Zulawski",
        "timestamp": 1635304130
    },
    {
        "content": "<p>we should be able to ask Oregon State University for access to one of their power9 servers, and set up a github actions runner on it...</p>",
        "id": 259188167,
        "sender_full_name": "Jacob Lifshay",
        "timestamp": 1635304171
    },
    {
        "content": "<p>If they would be kind enough to do that, definitely</p>",
        "id": 259188244,
        "sender_full_name": "Caleb Zulawski",
        "timestamp": 1635304231
    },
    {
        "content": "<p><a href=\"https://osuosl.org/communities/\">https://osuosl.org/communities/</a></p>",
        "id": 259188255,
        "sender_full_name": "Jacob Lifshay",
        "timestamp": 1635304245
    },
    {
        "content": "<p>apparently they're already providing the rust project with powerpc vms</p>",
        "id": 259188301,
        "sender_full_name": "Jacob Lifshay",
        "timestamp": 1635304322
    },
    {
        "content": "<p>Aarch64 would be great too</p>",
        "id": 259188343,
        "sender_full_name": "Caleb Zulawski",
        "timestamp": 1635304330
    },
    {
        "content": "<p>apparently github actions doesn't support running on powerpc64le</p>",
        "id": 259188469,
        "sender_full_name": "Jacob Lifshay",
        "timestamp": 1635304467
    },
    {
        "content": "<p><a href=\"https://docs.github.com/en/actions/hosting-your-own-runners/about-self-hosted-runners#architectures\">https://docs.github.com/en/actions/hosting-your-own-runners/about-self-hosted-runners#architectures</a></p>",
        "id": 259188478,
        "sender_full_name": "Jacob Lifshay",
        "timestamp": 1635304479
    },
    {
        "content": "<p><span aria-label=\"face palm\" class=\"emoji emoji-1f926\" role=\"img\" title=\"face palm\">:face_palm:</span></p>",
        "id": 259188480,
        "sender_full_name": "Caleb Zulawski",
        "timestamp": 1635304483
    },
    {
        "content": "<p>gitlab-runner will likely work tho</p>",
        "id": 259188489,
        "sender_full_name": "Jacob Lifshay",
        "timestamp": 1635304498
    },
    {
        "content": "<p>Yeah, I think gitlab runs on anything basically</p>",
        "id": 259188508,
        "sender_full_name": "Caleb Zulawski",
        "timestamp": 1635304519
    },
    {
        "content": "<p>if you have time, could you try to come up with a smallish test-case so we can report a bug to qemu?</p>",
        "id": 259189810,
        "sender_full_name": "Jacob Lifshay",
        "timestamp": 1635306194
    },
    {
        "content": "<p>I was actually trying that and I couldn't really replicate it</p>",
        "id": 259189817,
        "sender_full_name": "Caleb Zulawski",
        "timestamp": 1635306227
    },
    {
        "content": "<p>(or llvm or wherever the bug(s) are)</p>",
        "id": 259189818,
        "sender_full_name": "Jacob Lifshay",
        "timestamp": 1635306228
    },
    {
        "content": "<p>We might just need to strip down the whole thing</p>",
        "id": 259189821,
        "sender_full_name": "Caleb Zulawski",
        "timestamp": 1635306237
    }
]