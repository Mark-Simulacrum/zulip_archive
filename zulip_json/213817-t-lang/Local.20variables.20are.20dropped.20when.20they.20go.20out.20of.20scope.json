[
    {
        "content": "<p>The reference goes into great detail about when local variables have their <a href=\"https://doc.rust-lang.org/reference/destructors.html?highlight=destructors#destructors\"><code>Drop</code> implementations called</a>. However, at the very end of that section, it claims that</p>\n<blockquote>\n<p>Not running destructors in Rust is safe even if it has a type that isn't 'static. std::mem::ManuallyDrop provides a wrapper to prevent a variable or field from being dropped automatically.</p>\n</blockquote>\n<p>The genesis of this statement is the leakpocalypse, but this is misleading for values that are never made available to the user (like locals). See discussion <a href=\"#narrow/stream/131828-t-compiler/topic/Guarantees.20around.20Drop.20.28.2390752.29\">here</a> for why guaranteeing that these values are dropped is important.</p>",
        "id": 261955765,
        "sender_full_name": "Dylan MacKenzie (ecstatic-morse)",
        "timestamp": 1637254540
    },
    {
        "content": "<p>Does <span class=\"user-group-mention\" data-user-group-id=\"1977\">@T-lang</span> agree with this assessment? What kind of process is required to change the language? An MCP? Just a PR? What should we put in its place (if anything)?</p>",
        "id": 261956684,
        "sender_full_name": "Dylan MacKenzie (ecstatic-morse)",
        "timestamp": 1637254824
    },
    {
        "content": "<p>For me, <a href=\"https://github.com/rust-lang/reference/issues/1107\">rust-lang/reference#1107</a> is the answer to the last question.</p>",
        "id": 261959238,
        "sender_full_name": "Dylan MacKenzie (ecstatic-morse)",
        "timestamp": 1637255824
    },
    {
        "content": "<p>Any live local is dropped at the end of the enclosing scope in reverse order of declaration. A local becomes live when it is initialized, and ceases to be live when it is moved out of.</p>",
        "id": 261960834,
        "sender_full_name": "Connor Horman",
        "timestamp": 1637256538
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"118594\">@Dylan MacKenzie (ecstatic-morse)</span> I think it'd be appropriate to clarify the reference to make it clear that under normal circumstances <code>Drop</code> impls will get called, and then explaining the circumstances under which they won't be.</p>",
        "id": 261963481,
        "sender_full_name": "Josh Triplett",
        "timestamp": 1637257622
    },
    {
        "content": "<p>We should cover the common case before covering corner cases.</p>",
        "id": 261963564,
        "sender_full_name": "Josh Triplett",
        "timestamp": 1637257658
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"118594\">@Dylan MacKenzie (ecstatic-morse)</span> agree. We usually use FCP on the PR for minor clarifications of this kind.</p>",
        "id": 261966638,
        "sender_full_name": "nikomatsakis",
        "timestamp": 1637258861
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"118594\">@Dylan MacKenzie (ecstatic-morse)</span> Maybe it can re-use some of the same kind of verbiage that probably exists somewhere for the \"unsafe code can't trust safe code\" stuff -- that's true in general, but if all the code is under your control and you audit it then you can rely on it.  It's just if you're giving it away to other code that you can't rely on these things any more.</p>",
        "id": 262102962,
        "sender_full_name": "scottmcm",
        "timestamp": 1637344354
    },
    {
        "content": "<p><a href=\"https://doc.rust-lang.org/stable/reference/behavior-not-considered-unsafe.html#leaks-of-memory-and-other-resources\">https://doc.rust-lang.org/stable/reference/behavior-not-considered-unsafe.html#leaks-of-memory-and-other-resources</a> Probably this section could be filled out, and the linked to from the destructors chapter.</p>",
        "id": 262165242,
        "sender_full_name": "isHavvy",
        "timestamp": 1637387451
    }
]