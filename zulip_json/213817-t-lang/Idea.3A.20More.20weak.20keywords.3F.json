[
    {
        "content": "<p>It seems \"union\" will be a weak keyword forever, methods and names can be named <code>union</code>, and it can still be used to define unions. This seems a good thing to me. I wonder if \"type\", \"struct\", \"enum\" can also be converted weak keywords? Especially \"type\", i've seem make code bases workaround the limitation by naming it to something non-intuitive.</p>",
        "id": 264105419,
        "sender_full_name": "Charles Lew",
        "timestamp": 1638932357
    },
    {
        "content": "<p>o_O</p>",
        "id": 264109929,
        "sender_full_name": "Josh Triplett",
        "timestamp": 1638936761
    },
    {
        "content": "<p>That's...not a bad idea.</p>",
        "id": 264109935,
        "sender_full_name": "Josh Triplett",
        "timestamp": 1638936774
    },
    {
        "content": "<p>I am a huge fan of this. The whole <code>r#type</code> syntax actually bothers me because it doesn't enable writing out <code>type</code> anywhere, so you may as well just name it something different.</p>",
        "id": 264109963,
        "sender_full_name": "Khionu Sybiern",
        "timestamp": 1638936837
    },
    {
        "content": "<p>TBH, I generally prefer seeing code use a different word anyway (like <code>kind</code>) since it helps saying things out loud when \"type\" means \"actually a type\", not \"sometimes an enum\".</p>\n<p>I'm not convinced it has enough value to bother -- keywords for confident reparse points are, afaik, rather handy for incomplete code handling.</p>",
        "id": 264110579,
        "sender_full_name": "scottmcm",
        "timestamp": 1638937613
    },
    {
        "content": "<p>When interacting with foreign code, or serialization, other non-Rust users uses \"type\" really a lot ...  This is not something critical, it's just i'm a little bit tired of all the <code>rename</code>s or <code>r#type</code>s...</p>",
        "id": 264111863,
        "sender_full_name": "Charles Lew",
        "timestamp": 1638938958
    },
    {
        "content": "<p>I'm not totally convinced we <em>should</em> do it, but it doesn't seem like a bad idea to me, and I can easily see the benefits to doing so.</p>",
        "id": 264111928,
        "sender_full_name": "Josh Triplett",
        "timestamp": 1638939011
    },
    {
        "content": "<p>As for procedural macros using names of fields (e.g. serde) I think there could be a \"global rename\" attribute that renames all fields with the name to another. That way you can write <code>ty</code> and it will be treated as if it was <code>r#type</code>.</p>",
        "id": 264112350,
        "sender_full_name": "fee1-dead",
        "timestamp": 1638939515
    },
    {
        "content": "<p>tbh, the fact that <code>type</code> is a keyword is annoying, especially when writing binary structure layouts, or the rust code representing them. <code>ty</code> is  the closest, but not necessarily immediately intuitive. Neither is <code>kind</code> (especially when <code>kind</code> is actually used as a control field in the layout).</p>",
        "id": 264143591,
        "sender_full_name": "Connor Horman",
        "timestamp": 1638963802
    },
    {
        "content": "<p>I fear this might make code easier to write but harder to read. Take into account that syntax highlighting won’t get this right, and it will be a rarely used feature (outside of compilers, etc), so I think this would be very surprising to find when reading unfamiliar code</p>",
        "id": 264143899,
        "sender_full_name": "Nick Cameron",
        "timestamp": 1638964032
    },
    {
        "content": "<p>In the situtations I've really wanted <code>type</code> because that's what expresses the intent, as I said, I found aliases such as <code>ty</code> or <code>kind</code> uninituitive in determining the meaning of the field (which is important for understanding the kinds of formats I'm writing, if none of the fields express the basic intent, no amount of prose can fix that). I would, imo, call that harder to read or, at least, harder to understand.</p>",
        "id": 264145421,
        "sender_full_name": "Connor Horman",
        "timestamp": 1638965148
    },
    {
        "content": "<p>An example of syntax highlighting confusion:</p>\n<div class=\"codehilite\" data-code-language=\"Rust\"><pre><span></span><code><span class=\"k\">fn</span> <span class=\"nf\">union</span><span class=\"p\">()</span><span class=\"w\"> </span><span class=\"p\">{</span><span class=\"w\"></span>\n<span class=\"w\">    </span><span class=\"k\">union</span> <span class=\"nc\">union</span><span class=\"o\">&lt;'</span><span class=\"na\">union</span><span class=\"o\">&gt;</span><span class=\"w\"> </span><span class=\"p\">{</span><span class=\"w\"> </span><span class=\"k\">union</span>: <span class=\"kp\">&amp;</span><span class=\"o\">'</span><span class=\"na\">union</span> <span class=\"nc\">union</span><span class=\"o\">&lt;'</span><span class=\"na\">union</span><span class=\"o\">&gt;</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"p\">}</span><span class=\"w\"></span>\n<span class=\"p\">}</span><span class=\"w\"></span>\n<span class=\"k\">fn</span> <span class=\"nf\">onion</span><span class=\"p\">()</span><span class=\"w\"> </span><span class=\"p\">{</span><span class=\"w\"></span>\n<span class=\"w\">    </span><span class=\"k\">union</span> <span class=\"nc\">onion</span><span class=\"o\">&lt;'</span><span class=\"na\">onion</span><span class=\"o\">&gt;</span><span class=\"w\"> </span><span class=\"p\">{</span><span class=\"w\"> </span><span class=\"n\">onion</span>: <span class=\"kp\">&amp;</span><span class=\"o\">'</span><span class=\"na\">onion</span> <span class=\"nc\">onion</span><span class=\"o\">&lt;'</span><span class=\"na\">onion</span><span class=\"o\">&gt;</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"p\">}</span><span class=\"w\"></span>\n<span class=\"p\">}</span><span class=\"w\"></span>\n</code></pre></div>",
        "id": 264145955,
        "sender_full_name": "Daniel Henry-Mantilla",
        "timestamp": 1638965540
    },
    {
        "content": "<p>This is a structure I have, expressed in rust syntax (and, in theory, implementable by copying the definition from the document to rust source code):</p>\n<div class=\"codehilite\" data-code-language=\"Rust\"><pre><span></span><code><span class=\"cp\">#[repr(C,align(64))]</span><span class=\"w\"></span>\n<span class=\"k\">pub</span><span class=\"w\"> </span><span class=\"k\">struct</span> <span class=\"nc\">Object</span><span class=\"p\">{</span><span class=\"w\"></span>\n<span class=\"w\">    </span><span class=\"n\">strong_ref</span>: <span class=\"kt\">u32</span><span class=\"p\">,</span><span class=\"w\"></span>\n<span class=\"w\">    </span><span class=\"n\">weak_ref</span>: <span class=\"kt\">u32</span><span class=\"p\">,</span><span class=\"w\"></span>\n<span class=\"w\">    </span><span class=\"n\">streams_size</span>: <span class=\"kt\">u64</span><span class=\"p\">,</span><span class=\"w\"></span>\n<span class=\"w\">    </span><span class=\"n\">streams_ref</span>: <span class=\"kt\">u128</span><span class=\"p\">,</span><span class=\"w\"></span>\n<span class=\"w\">    </span><span class=\"n\">streams_indirection</span>: <span class=\"kt\">u8</span><span class=\"p\">,</span><span class=\"w\"></span>\n<span class=\"w\">    </span><span class=\"n\">reserved33</span>: <span class=\"p\">[</span><span class=\"kt\">u8</span><span class=\"p\">;</span><span class=\"w\"> </span><span class=\"mi\">5</span><span class=\"p\">],</span><span class=\"w\"></span>\n<span class=\"w\">    </span><span class=\"n\">ty</span>: <span class=\"kt\">u16</span><span class=\"p\">,</span><span class=\"w\"></span>\n<span class=\"w\">    </span><span class=\"n\">flags</span>: <span class=\"kt\">u32</span><span class=\"p\">,</span><span class=\"w\"></span>\n<span class=\"w\">    </span><span class=\"n\">reserved44</span>: <span class=\"p\">[</span><span class=\"kt\">u8</span><span class=\"p\">;</span><span class=\"w\"> </span><span class=\"mi\">20</span><span class=\"p\">],</span><span class=\"w\"></span>\n<span class=\"p\">}</span><span class=\"w\"></span>\n</code></pre></div>\n<p>When I'm quickly scanning this definition, I don't immediately connect <code>ty</code>=<code>type</code> (less so with <code>kind</code>, though I haven't found any definitions that use it. Possibly for this exact reason), with the benefit of having written the definition.</p>",
        "id": 264146020,
        "sender_full_name": "Connor Horman",
        "timestamp": 1638965596
    },
    {
        "content": "<p>(and the alternative is <code>type_</code>, which even though I personally prefer it (I use <code>name_</code> a lot in proc-macro code), is not great either (and the worst of all: <code>r#type</code>))</p>",
        "id": 264146233,
        "sender_full_name": "Daniel Henry-Mantilla",
        "timestamp": 1638965747
    },
    {
        "content": "<p>Also, I could see wanting to use <code>struct { x: 10 }</code> for anonymous structs or inferred literals or something, so I wouldn't want to un-reserve it (or <code>enum</code>, for similar reasons).</p>",
        "id": 264422151,
        "sender_full_name": "scottmcm",
        "timestamp": 1639129017
    },
    {
        "content": "<p>Fair, but will that introduce grammar ambiguousity with field and method names?</p>",
        "id": 264444272,
        "sender_full_name": "Charles Lew",
        "timestamp": 1639141875
    },
    {
        "content": "<p>It can with identifier patterns and also destructuring patterns</p>",
        "id": 264448449,
        "sender_full_name": "Connor Horman",
        "timestamp": 1639143809
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"116458\">Charles Lew</span> <a href=\"#narrow/stream/213817-t-lang/topic/Idea.3A.20More.20weak.20keywords.3F/near/264444272\">said</a>:</p>\n<blockquote>\n<p>Fair, but will that introduce grammar ambiguousity with field and method names?</p>\n</blockquote>\n<div class=\"codehilite\" data-code-language=\"Rust\"><pre><span></span><code><span class=\"k\">struct</span> <span class=\"nc\">struct</span><span class=\"w\"> </span><span class=\"p\">{</span><span class=\"w\"> </span><span class=\"n\">x</span>: <span class=\"kt\">i32</span> <span class=\"p\">};</span><span class=\"w\"></span>\n<span class=\"kd\">let</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"mi\">4</span><span class=\"p\">;</span><span class=\"w\"></span>\n<span class=\"kd\">let</span><span class=\"w\"> </span><span class=\"k\">struct</span>: <span class=\"nc\">struct</span><span class=\"w\"> </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"k\">struct</span> <span class=\"p\">{</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"p\">};</span><span class=\"w\"></span>\n</code></pre></div>\n<p>Related: <a href=\"https://github.com/rust-lang/rust/blob/master/src/test/ui/weird-exprs.rs#L115\">https://github.com/rust-lang/rust/blob/master/src/test/ui/weird-exprs.rs#L115</a></p>",
        "id": 264500593,
        "sender_full_name": "scottmcm",
        "timestamp": 1639166591
    },
    {
        "content": "<p>One could just (contextually) make <code>struct</code> (and <code>enum</code>) also be a keyword in the context of a <em><a href=\"https://doc.rust-lang.org/stable/reference/expressions/struct-expr.html\">StructExprStruct</a></em> or <em><a href=\"https://doc.rust-lang.org/stable/reference/patterns.html#struct-patterns\">StructPattern</a></em> though, right? This would keep <code>struct { … }</code> and <code>enum { … }</code> reserved in expressions and patterns. I.e. if you want to construct your struct named <code>struct</code>, you’ll have to write <code>r#struct { x }</code>. Lower-case names for structs are discouraged anyways, so making <code>struct</code> as a struct-name annoying to use is not really a bad thing.</p>",
        "id": 264507268,
        "sender_full_name": "Frank Steffahn",
        "timestamp": 1639169978
    },
    {
        "content": "<p>Thanks!  I remembered union was introduced before <code>r#</code> become a thing.</p>\n<blockquote>\n<p><code>\nfn union() {\n    union union&lt;'union&gt; { union: &amp;'union union&lt;'union&gt;, }\n}\n</code></p>\n</blockquote>\n<p>From my personal opinion, i think it's just better to only permit people to write:</p>\n<div class=\"codehilite\" data-code-language=\"Rust\"><pre><span></span><code><span class=\"k\">fn</span> <span class=\"nf\">union</span><span class=\"p\">()</span><span class=\"w\"> </span><span class=\"p\">{</span><span class=\"w\"></span>\n<span class=\"w\">    </span><span class=\"k\">union</span> <span class=\"nc\">r</span>#<span class=\"k\">union</span><span class=\"o\">&lt;'</span><span class=\"na\">r</span>#<span class=\"k\">union</span><span class=\"o\">&gt;</span><span class=\"w\"> </span><span class=\"p\">{</span><span class=\"w\"> </span><span class=\"k\">union</span>: <span class=\"kp\">&amp;</span><span class=\"o\">'</span><span class=\"na\">r</span>#<span class=\"k\">union</span> <span class=\"nc\">r</span>#<span class=\"k\">union</span><span class=\"o\">&lt;'</span><span class=\"na\">r</span>#<span class=\"k\">union</span><span class=\"o\">&gt;</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"p\">}</span><span class=\"w\"></span>\n<span class=\"p\">}</span><span class=\"w\"></span>\n</code></pre></div>\n<p>In that example... On the other hand, <code>'r#union</code> is currently not allowed and i really wish this syntax be allow though...</p>",
        "id": 264550973,
        "sender_full_name": "Charles Lew",
        "timestamp": 1639212879
    },
    {
        "content": "<p>What about <code>in</code>? It's useful especially as a function parameter name, as an abbreviation of \"input\" (eg. input stream) and complementary of \"out\" for \"output\".</p>",
        "id": 265413991,
        "sender_full_name": "Johannes Dahlström",
        "timestamp": 1639827759
    },
    {
        "content": "<p>There is a potential use case for <code>'in</code> as a special lifetime that outlives all input lifetimes:</p>\n<div class=\"codehilite\" data-code-language=\"Rust\"><pre><span></span><code><span class=\"k\">fn</span> <span class=\"nf\">foo</span><span class=\"p\">(</span><span class=\"n\">x</span>: <span class=\"kp\">&amp;</span><span class=\"kt\">str</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"n\">y</span>: <span class=\"kp\">&amp;</span><span class=\"kt\">str</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"n\">z</span>: <span class=\"kt\">bool</span><span class=\"p\">)</span><span class=\"w\"> </span>-&gt; <span class=\"kp\">&amp;</span><span class=\"o\">'</span><span class=\"na\">in</span> <span class=\"kt\">str</span> <span class=\"p\">{</span><span class=\"w\"></span>\n<span class=\"w\">    </span><span class=\"k\">if</span><span class=\"w\"> </span><span class=\"n\">z</span><span class=\"w\"> </span><span class=\"p\">{</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"p\">}</span><span class=\"w\"> </span><span class=\"k\">else</span><span class=\"w\"> </span><span class=\"p\">{</span><span class=\"w\"> </span><span class=\"n\">y</span><span class=\"w\"> </span><span class=\"p\">}</span><span class=\"w\"></span>\n<span class=\"p\">}</span><span class=\"w\"></span>\n\n<span class=\"k\">fn</span> <span class=\"nf\">bar</span><span class=\"p\">(</span><span class=\"n\">x</span>: <span class=\"kp\">&amp;</span><span class=\"kt\">str</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"n\">y</span>: <span class=\"kp\">&amp;</span><span class=\"kt\">str</span><span class=\"p\">)</span><span class=\"w\"> </span>-&gt; <span class=\"nc\">impl</span><span class=\"w\"> </span><span class=\"n\">Future</span><span class=\"o\">&lt;</span><span class=\"n\">Output</span><span class=\"w\"> </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"p\">()</span><span class=\"o\">&gt;</span><span class=\"w\"> </span><span class=\"o\">+</span><span class=\"w\"> </span><span class=\"o\">'</span><span class=\"na\">in</span><span class=\"w\"> </span><span class=\"p\">{</span><span class=\"w\"> </span><span class=\"o\">..</span><span class=\"p\">.</span><span class=\"w\"> </span><span class=\"p\">}</span><span class=\"w\"></span>\n</code></pre></div>",
        "id": 265431268,
        "sender_full_name": "Ibraheem Ahmed",
        "timestamp": 1639850275
    },
    {
        "content": "<p><code>in</code> is actually used by <code>asm!</code>, though morally a macro just accepts a pile of tokens so you could argue it's still not a positional keyword.</p>",
        "id": 265435667,
        "sender_full_name": "Lokathor",
        "timestamp": 1639853504
    },
    {
        "content": "<p>Yeah, you can pass <code>struct</code> as an <code>ident</code> to a <code>macro_rules</code> macro, so at token level things are all weird.</p>",
        "id": 265445171,
        "sender_full_name": "scottmcm",
        "timestamp": 1639863674
    }
]