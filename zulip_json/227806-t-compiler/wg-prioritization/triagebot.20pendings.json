[
    {
        "content": "<p>yesterday I was commenting <span class=\"user-mention\" data-user-id=\"255061\">@LeSeulArtichaut</span> that would be great to fire prioritization when we add <code>regression-from-stable-to-beta</code> and <code>regression-from-stable-to-nightly</code> labels to issues</p>",
        "id": 197572991,
        "sender_full_name": "Santiago Pastorino",
        "timestamp": 1589470413
    },
    {
        "content": "<p>we ended also talking that prioritization was fired twice when someone runs the command because it also add the label and that re-fires the thing</p>",
        "id": 197573108,
        "sender_full_name": "Santiago Pastorino",
        "timestamp": 1589470448
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"116122\">@simulacrum</span> what code is executed when a github label is added?</p>",
        "id": 197573165,
        "sender_full_name": "Santiago Pastorino",
        "timestamp": 1589470476
    },
    {
        "content": "<p>not sure what you're asking</p>",
        "id": 197573192,
        "sender_full_name": "simulacrum",
        "timestamp": 1589470489
    },
    {
        "content": "<p>like, a lot of code? :)</p>",
        "id": 197573209,
        "sender_full_name": "simulacrum",
        "timestamp": 1589470498
    },
    {
        "content": "<p>I'm not sure how things are connected here, does Github fires a post to us somewhere?</p>",
        "id": 197573214,
        "sender_full_name": "Santiago Pastorino",
        "timestamp": 1589470501
    },
    {
        "content": "<p>yeah</p>",
        "id": 197573222,
        "sender_full_name": "simulacrum",
        "timestamp": 1589470504
    },
    {
        "content": "<p>where does that land?</p>",
        "id": 197573247,
        "sender_full_name": "Santiago Pastorino",
        "timestamp": 1589470514
    },
    {
        "content": "<p>triagebot will get a webhook post</p>",
        "id": 197573248,
        "sender_full_name": "simulacrum",
        "timestamp": 1589470514
    },
    {
        "content": "<p>in triagebot?</p>",
        "id": 197573258,
        "sender_full_name": "Santiago Pastorino",
        "timestamp": 1589470518
    },
    {
        "content": "<p>ok</p>",
        "id": 197573263,
        "sender_full_name": "Santiago Pastorino",
        "timestamp": 1589470519
    },
    {
        "content": "<p>I looked at the code earlier</p>",
        "id": 197573267,
        "sender_full_name": "Léo Lanteri Thauvin",
        "timestamp": 1589470519
    },
    {
        "content": "<p>We fire the prioritize command when the <code>I-prioritize</code> label is added</p>",
        "id": 197573302,
        "sender_full_name": "Léo Lanteri Thauvin",
        "timestamp": 1589470537
    },
    {
        "content": "<p>Which means, as the prioritize command adds the label, the command is fired twice</p>",
        "id": 197573339,
        "sender_full_name": "Léo Lanteri Thauvin",
        "timestamp": 1589470556
    },
    {
        "content": "<p>yep</p>",
        "id": 197573420,
        "sender_full_name": "Santiago Pastorino",
        "timestamp": 1589470565
    },
    {
        "content": "<p>One solution is to not create the Zulip thread/message when <code>@rustbot prioritize</code> is used, and delay it when the label is added</p>",
        "id": 197573548,
        "sender_full_name": "Léo Lanteri Thauvin",
        "timestamp": 1589470618
    },
    {
        "content": "<p>we should be able to ignore the label if it's added by the bot</p>",
        "id": 197573673,
        "sender_full_name": "simulacrum",
        "timestamp": 1589470674
    },
    {
        "content": "<p>Oh right, we recieve it along with the webhook event</p>",
        "id": 197573767,
        "sender_full_name": "Léo Lanteri Thauvin",
        "timestamp": 1589470706
    },
    {
        "content": "<p>can't we make the prioritization process start only when the label is added?</p>",
        "id": 197573779,
        "sender_full_name": "Santiago Pastorino",
        "timestamp": 1589470714
    },
    {
        "content": "<p>and make the command just add that label</p>",
        "id": 197573792,
        "sender_full_name": "Santiago Pastorino",
        "timestamp": 1589470723
    },
    {
        "content": "<p>The problem is</p>",
        "id": 197573799,
        "sender_full_name": "Léo Lanteri Thauvin",
        "timestamp": 1589470731
    },
    {
        "content": "<p>If we ignore when the bot adds the label, then we won't create the Zulip post when people use the <code>@rustbot modify labels</code> command</p>",
        "id": 197573867,
        "sender_full_name": "Léo Lanteri Thauvin",
        "timestamp": 1589470763
    },
    {
        "content": "<p>yeah seems fine to just trigger zulip on the label and not the command</p>",
        "id": 197573909,
        "sender_full_name": "simulacrum",
        "timestamp": 1589470781
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"116266\">Santiago Pastorino</span> <a href=\"#narrow/stream/227806-t-compiler.2Fwg-prioritization/topic/triagebot.20pendings/near/197573779\">said</a>:</p>\n<blockquote>\n<p>can't we make the prioritization process start only when the label is added?</p>\n</blockquote>\n<p>That's what I proposed</p>",
        "id": 197573918,
        "sender_full_name": "Léo Lanteri Thauvin",
        "timestamp": 1589470784
    },
    {
        "content": "<p>Alright I can do that then</p>",
        "id": 197573950,
        "sender_full_name": "Léo Lanteri Thauvin",
        "timestamp": 1589470801
    },
    {
        "content": "<p><em>Quickly</em></p>",
        "id": 197573998,
        "sender_full_name": "Léo Lanteri Thauvin",
        "timestamp": 1589470806
    },
    {
        "content": "<p><span aria-label=\"+1\" class=\"emoji emoji-1f44d\" role=\"img\" title=\"+1\">:+1:</span></p>",
        "id": 197574089,
        "sender_full_name": "Santiago Pastorino",
        "timestamp": 1589470854
    },
    {
        "content": "<p>I was wondering also ...</p>",
        "id": 197574106,
        "sender_full_name": "Santiago Pastorino",
        "timestamp": 1589470861
    },
    {
        "content": "<div class=\"codehilite\"><pre><span></span><code><span class=\"k\">if</span><span class=\"w\"> </span><span class=\"kd\">let</span><span class=\"w\"> </span><span class=\"nb\">Some</span><span class=\"p\">(</span><span class=\"n\">Token</span>::<span class=\"n\">Word</span><span class=\"p\">(</span><span class=\"s\">&quot;prioritize&quot;</span><span class=\"p\">))</span><span class=\"w\"> </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"n\">input</span><span class=\"p\">.</span><span class=\"n\">peek_token</span><span class=\"p\">()</span><span class=\"o\">?</span><span class=\"w\"> </span><span class=\"p\">{</span><span class=\"w\"></span>\n</code></pre></div>",
        "id": 197574122,
        "sender_full_name": "Santiago Pastorino",
        "timestamp": 1589470869
    },
    {
        "content": "<p>are we checking that the label contains <code>prioritize</code>?</p>",
        "id": 197574167,
        "sender_full_name": "Santiago Pastorino",
        "timestamp": 1589470885
    },
    {
        "content": "<p>That's for the command I guess</p>",
        "id": 197574187,
        "sender_full_name": "Léo Lanteri Thauvin",
        "timestamp": 1589470893
    },
    {
        "content": "<p>that's the parser, not the label</p>",
        "id": 197574206,
        "sender_full_name": "simulacrum",
        "timestamp": 1589470903
    },
    {
        "content": "<p>I just naively run <code>rg \"I-prioritize\"</code> and didn't find anything</p>",
        "id": 197574209,
        "sender_full_name": "Santiago Pastorino",
        "timestamp": 1589470903
    },
    {
        "content": "<p>The <code>@rustbot prioritize</code> command, I mean</p>",
        "id": 197574218,
        "sender_full_name": "Léo Lanteri Thauvin",
        "timestamp": 1589470906
    },
    {
        "content": "<p>ahh right</p>",
        "id": 197574242,
        "sender_full_name": "Santiago Pastorino",
        "timestamp": 1589470917
    },
    {
        "content": "<p>The label is stored in <code>triagebot.toml</code> file</p>",
        "id": 197574276,
        "sender_full_name": "Léo Lanteri Thauvin",
        "timestamp": 1589470922
    },
    {
        "content": "<p>the label is configured in triagebot.toml in rust-lang/rust</p>",
        "id": 197574286,
        "sender_full_name": "simulacrum",
        "timestamp": 1589470923
    },
    {
        "content": "<p>On the repo</p>",
        "id": 197574305,
        "sender_full_name": "Léo Lanteri Thauvin",
        "timestamp": 1589470926
    },
    {
        "content": "<p>ohh I see</p>",
        "id": 197574331,
        "sender_full_name": "Santiago Pastorino",
        "timestamp": 1589470933
    },
    {
        "content": "<p>So if we want to prioritize when certain labels are added we should do that in the <code>triagebot.toml</code> too, right?</p>",
        "id": 197574418,
        "sender_full_name": "Léo Lanteri Thauvin",
        "timestamp": 1589470967
    },
    {
        "content": "<p>I guess we may want something like</p>",
        "id": 197574470,
        "sender_full_name": "Santiago Pastorino",
        "timestamp": 1589470988
    },
    {
        "content": "<p>We could have a <code>prioritize-on</code> field for example</p>",
        "id": 197574485,
        "sender_full_name": "Léo Lanteri Thauvin",
        "timestamp": 1589470992
    },
    {
        "content": "<div class=\"codehilite\"><pre><span></span><code>[prioritize]\nlabel = [&quot;I-prioritize&quot;, &quot;regression-from-stable-to-beta&quot;, &quot;regression-from-stable-to-nightly&quot;]\nzulip_stream = 227806\n</code></pre></div>",
        "id": 197574569,
        "sender_full_name": "Santiago Pastorino",
        "timestamp": 1589471031
    },
    {
        "content": "<p>maybe?</p>",
        "id": 197574586,
        "sender_full_name": "Santiago Pastorino",
        "timestamp": 1589471037
    },
    {
        "content": "<p>instead of what we have which is ...</p>",
        "id": 197574670,
        "sender_full_name": "Santiago Pastorino",
        "timestamp": 1589471057
    },
    {
        "content": "<p>The <code>label</code> field here is the label we assign when we use the prioritize command</p>",
        "id": 197574682,
        "sender_full_name": "Léo Lanteri Thauvin",
        "timestamp": 1589471062
    },
    {
        "content": "<p>ahh :)</p>",
        "id": 197574713,
        "sender_full_name": "Santiago Pastorino",
        "timestamp": 1589471076
    },
    {
        "content": "<p>And also the label the bot reacts to when added to create the Zulip topic</p>",
        "id": 197574723,
        "sender_full_name": "Léo Lanteri Thauvin",
        "timestamp": 1589471080
    },
    {
        "content": "<p>We can have a separate list of course</p>",
        "id": 197574747,
        "sender_full_name": "Léo Lanteri Thauvin",
        "timestamp": 1589471094
    },
    {
        "content": "<p>yeah then what you've said, prioritize-on</p>",
        "id": 197574779,
        "sender_full_name": "Santiago Pastorino",
        "timestamp": 1589471109
    },
    {
        "content": "<p>What would you prefer? Adding <code>I-prioritize</code> when regression are found?</p>",
        "id": 197574815,
        "sender_full_name": "Léo Lanteri Thauvin",
        "timestamp": 1589471133
    },
    {
        "content": "<p>Or sending a message without adding <code>I-prioritize</code>?</p>",
        "id": 197574848,
        "sender_full_name": "Léo Lanteri Thauvin",
        "timestamp": 1589471148
    },
    {
        "content": "<p>it's the same</p>",
        "id": 197574885,
        "sender_full_name": "Santiago Pastorino",
        "timestamp": 1589471161
    },
    {
        "content": "<p>maybe better and easier to add <code>I-prioritize</code></p>",
        "id": 197574947,
        "sender_full_name": "Santiago Pastorino",
        "timestamp": 1589471171
    },
    {
        "content": "<p>Personally I prefer the first solution, because it shows that we have a discussion running</p>",
        "id": 197574966,
        "sender_full_name": "Léo Lanteri Thauvin",
        "timestamp": 1589471177
    },
    {
        "content": "<p>And when we're done then we can remove it</p>",
        "id": 197575001,
        "sender_full_name": "Léo Lanteri Thauvin",
        "timestamp": 1589471196
    },
    {
        "content": "<p>yeah, agree, let's add <code>I-prioritize</code></p>",
        "id": 197575003,
        "sender_full_name": "Santiago Pastorino",
        "timestamp": 1589471197
    },
    {
        "content": "<p>definitely</p>",
        "id": 197575026,
        "sender_full_name": "Santiago Pastorino",
        "timestamp": 1589471204
    },
    {
        "content": "<p>are you doing this or should I?</p>",
        "id": 197575045,
        "sender_full_name": "Santiago Pastorino",
        "timestamp": 1589471214
    },
    {
        "content": "<p>I don't know</p>",
        "id": 197575060,
        "sender_full_name": "Léo Lanteri Thauvin",
        "timestamp": 1589471223
    },
    {
        "content": "<p>I'll be fixing the bug with the command first I think</p>",
        "id": 197575073,
        "sender_full_name": "Léo Lanteri Thauvin",
        "timestamp": 1589471233
    },
    {
        "content": "<p><span aria-label=\"+1\" class=\"emoji emoji-1f44d\" role=\"img\" title=\"+1\">:+1:</span></p>",
        "id": 197575092,
        "sender_full_name": "Santiago Pastorino",
        "timestamp": 1589471241
    },
    {
        "content": "<p>Because then we'll have a clean code for implementing that new feature</p>",
        "id": 197575100,
        "sender_full_name": "Léo Lanteri Thauvin",
        "timestamp": 1589471247
    },
    {
        "content": "<p>ok, let me know when you finish</p>",
        "id": 197575131,
        "sender_full_name": "Santiago Pastorino",
        "timestamp": 1589471266
    },
    {
        "content": "<p>I'll send a link to the PR as soon as I'm done</p>",
        "id": 197575193,
        "sender_full_name": "Léo Lanteri Thauvin",
        "timestamp": 1589471284
    },
    {
        "content": "<p><span aria-label=\"+1\" class=\"emoji emoji-1f44d\" role=\"img\" title=\"+1\">:+1:</span>, great, thanks</p>",
        "id": 197575203,
        "sender_full_name": "Santiago Pastorino",
        "timestamp": 1589471292
    },
    {
        "content": "<p>I'll also ping <span class=\"user-mention silent\" data-user-id=\"116122\">simulacrum</span> <span aria-label=\"innocent\" class=\"emoji emoji-1f607\" role=\"img\" title=\"innocent\">:innocent:</span></p>",
        "id": 197575208,
        "sender_full_name": "Léo Lanteri Thauvin",
        "timestamp": 1589471295
    },
    {
        "content": "<p>:)</p>",
        "id": 197575537,
        "sender_full_name": "Santiago Pastorino",
        "timestamp": 1589471433
    },
    {
        "content": "<div class=\"codehilite\"><pre><span></span><code>[santiago@galago triagebot (master)]$ git diff\ndiff --git a/src/handlers/relabel.rs b/src/handlers/relabel.rs\nindex 9a889a5..e6c8a56 100644\n--- a/src/handlers/relabel.rs\n+++ b/src/handlers/relabel.rs\n@@ -105,6 +105,15 @@ async fn handle_input(\n                     issue_labels.push(github::Label {\n                         name: label.to_string(),\n                     });\n+                    if label.as_str() == &quot;regression-from-stable-to-beta&quot;\n+                        || label.as_str() == &quot;regression-from-stable-to-nightly&quot;\n+                    {\n+                        if !issue_labels.iter().any(|l| l.name == &quot;I-prioritize&quot;) {\n+                            issue_labels.push(github::Label {\n+                                name: &quot;I-prioritize&quot;.to_string(),\n+                            });\n+                        }\n+                    }\n                 }\n             }\n             LabelDelta::Remove(label) =&gt; {\n</code></pre></div>",
        "id": 197576068,
        "sender_full_name": "Santiago Pastorino",
        "timestamp": 1589471651
    },
    {
        "content": "<p>done</p>",
        "id": 197576072,
        "sender_full_name": "Santiago Pastorino",
        "timestamp": 1589471652
    },
    {
        "content": "<p><span aria-label=\"joy\" class=\"emoji emoji-1f602\" role=\"img\" title=\"joy\">:joy:</span></p>",
        "id": 197576085,
        "sender_full_name": "Santiago Pastorino",
        "timestamp": 1589471657
    },
    {
        "content": "<p>:D</p>",
        "id": 197576123,
        "sender_full_name": "Léo Lanteri Thauvin",
        "timestamp": 1589471672
    },
    {
        "content": "<p>No, no, that's not right</p>",
        "id": 197576243,
        "sender_full_name": "simulacrum",
        "timestamp": 1589471721
    },
    {
        "content": "<p>we don't want that as part of relabeling</p>",
        "id": 197576261,
        "sender_full_name": "simulacrum",
        "timestamp": 1589471728
    },
    {
        "content": "<p>because you want it to happen when someone adds the label through github ui</p>",
        "id": 197576296,
        "sender_full_name": "simulacrum",
        "timestamp": 1589471747
    },
    {
        "content": "<p>so you'll want to do it in the prioritization handler</p>",
        "id": 197576316,
        "sender_full_name": "simulacrum",
        "timestamp": 1589471755
    },
    {
        "content": "<p><em>Also it's the first time I use rust-analyser outside of rustc</em></p>",
        "id": 197576456,
        "sender_full_name": "Léo Lanteri Thauvin",
        "timestamp": 1589471796
    },
    {
        "content": "<p><em>It's amazing</em> <span aria-label=\"eyes\" class=\"emoji emoji-1f440\" role=\"img\" title=\"eyes\">:eyes:</span></p>",
        "id": 197576478,
        "sender_full_name": "Léo Lanteri Thauvin",
        "timestamp": 1589471809
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"116122\">simulacrum</span> <a href=\"#narrow/stream/227806-t-compiler.2Fwg-prioritization/topic/triagebot.20pendings/near/197576296\">said</a>:</p>\n<blockquote>\n<p>because you want it to happen when someone adds the label through github ui</p>\n</blockquote>\n<p>maybe I got wrong what relabel is</p>",
        "id": 197576526,
        "sender_full_name": "Santiago Pastorino",
        "timestamp": 1589471832
    },
    {
        "content": "<p>but yeah, we want to do it once any of those labels are added</p>",
        "id": 197576550,
        "sender_full_name": "Santiago Pastorino",
        "timestamp": 1589471844
    },
    {
        "content": "<p>not only through github ui</p>",
        "id": 197576563,
        "sender_full_name": "Santiago Pastorino",
        "timestamp": 1589471849
    },
    {
        "content": "<p>Look at src/handlers/prioritize.rs line 34 xD</p>",
        "id": 197576574,
        "sender_full_name": "Léo Lanteri Thauvin",
        "timestamp": 1589471854
    },
    {
        "content": "<p>Currently we have:</p>\n<div class=\"codehilite\"><pre><span></span><code><span class=\"w\">                    </span><span class=\"k\">if</span><span class=\"w\"> </span><span class=\"n\">e</span><span class=\"p\">.</span><span class=\"n\">label</span><span class=\"p\">.</span><span class=\"n\">as_ref</span><span class=\"p\">().</span><span class=\"n\">expect</span><span class=\"p\">(</span><span class=\"s\">&quot;label&quot;</span><span class=\"p\">).</span><span class=\"n\">name</span><span class=\"w\"> </span><span class=\"o\">==</span><span class=\"w\"> </span><span class=\"n\">config</span><span class=\"p\">.</span><span class=\"n\">label</span><span class=\"w\"> </span><span class=\"p\">{</span><span class=\"w\"></span>\n<span class=\"w\">                        </span><span class=\"c1\">// We need to take the exact same action in this case.</span>\n<span class=\"w\">                        </span><span class=\"k\">return</span><span class=\"w\"> </span><span class=\"nb\">Ok</span><span class=\"p\">(</span><span class=\"nb\">Some</span><span class=\"p\">(</span><span class=\"n\">Prioritize</span>::<span class=\"n\">Start</span><span class=\"p\">));</span><span class=\"w\"></span>\n<span class=\"w\">                    </span><span class=\"p\">}</span><span class=\"w\"></span>\n</code></pre></div>",
        "id": 197576619,
        "sender_full_name": "Léo Lanteri Thauvin",
        "timestamp": 1589471877
    },
    {
        "content": "<p><span aria-label=\"+1\" class=\"emoji emoji-1f44d\" role=\"img\" title=\"+1\">:+1:</span></p>",
        "id": 197576624,
        "sender_full_name": "Santiago Pastorino",
        "timestamp": 1589471880
    },
    {
        "content": "<p>I was kind of kidding and playing a bit</p>",
        "id": 197576675,
        "sender_full_name": "Santiago Pastorino",
        "timestamp": 1589471888
    },
    {
        "content": "<p>but maybe I should just implement this :)</p>",
        "id": 197576688,
        "sender_full_name": "Santiago Pastorino",
        "timestamp": 1589471894
    },
    {
        "content": "<p>So IIUC we fire a prioritize command if the label matches the label in the config</p>",
        "id": 197576723,
        "sender_full_name": "Léo Lanteri Thauvin",
        "timestamp": 1589471908
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"116266\">Santiago Pastorino</span> <a href=\"#narrow/stream/227806-t-compiler.2Fwg-prioritization/topic/triagebot.20pendings/near/197576675\">said</a>:</p>\n<blockquote>\n<p>I was kind of kidding and playing a bit</p>\n</blockquote>\n<p>Don't worry I got it <span aria-label=\"laughing\" class=\"emoji emoji-1f606\" role=\"img\" title=\"laughing\">:laughing:</span></p>",
        "id": 197576765,
        "sender_full_name": "Léo Lanteri Thauvin",
        "timestamp": 1589471925
    },
    {
        "content": "<p>anyway kidding about hard coding the things</p>",
        "id": 197576839,
        "sender_full_name": "Santiago Pastorino",
        "timestamp": 1589471959
    },
    {
        "content": "<p>but now that I see prioritize handler it's more clear</p>",
        "id": 197576846,
        "sender_full_name": "Santiago Pastorino",
        "timestamp": 1589471969
    },
    {
        "content": "<p><span aria-label=\"+1\" class=\"emoji emoji-1f44d\" role=\"img\" title=\"+1\">:+1:</span></p>",
        "id": 197576861,
        "sender_full_name": "Léo Lanteri Thauvin",
        "timestamp": 1589471976
    },
    {
        "content": "<p><a href=\"https://github.com/rust-lang/rust/issues/72200\">#72200</a></p>",
        "id": 197577719,
        "sender_full_name": "Santiago Pastorino",
        "timestamp": 1589472315
    },
    {
        "content": "<p><em>Damn you're quick</em> x)</p>",
        "id": 197577788,
        "sender_full_name": "Léo Lanteri Thauvin",
        "timestamp": 1589472345
    },
    {
        "content": "<p>Not sure we want to include <code>I-prioritize</code> in the list though</p>",
        "id": 197577884,
        "sender_full_name": "Léo Lanteri Thauvin",
        "timestamp": 1589472367
    },
    {
        "content": "<p>Because the behaviour will be to add <code>I-prioritize</code> whenever those are added</p>",
        "id": 197577936,
        "sender_full_name": "Léo Lanteri Thauvin",
        "timestamp": 1589472387
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"116266\">@Santiago Pastorino</span></p>",
        "id": 197577963,
        "sender_full_name": "Léo Lanteri Thauvin",
        "timestamp": 1589472396
    },
    {
        "content": "<p>you're right</p>",
        "id": 197578014,
        "sender_full_name": "Santiago Pastorino",
        "timestamp": 1589472425
    },
    {
        "content": "<p>maybe with this idea the name is not great</p>",
        "id": 197578066,
        "sender_full_name": "Santiago Pastorino",
        "timestamp": 1589472452
    },
    {
        "content": "<p>also_prioritize_on</p>",
        "id": 197578085,
        "sender_full_name": "Santiago Pastorino",
        "timestamp": 1589472459
    },
    {
        "content": "<p>well it's fine as is I guess :)</p>",
        "id": 197578103,
        "sender_full_name": "Santiago Pastorino",
        "timestamp": 1589472467
    },
    {
        "content": "<p>I also think so</p>",
        "id": 197578107,
        "sender_full_name": "Léo Lanteri Thauvin",
        "timestamp": 1589472467
    },
    {
        "content": "<p>When I threw it I was about to say <em>please send help for a better name</em></p>",
        "id": 197578208,
        "sender_full_name": "Léo Lanteri Thauvin",
        "timestamp": 1589472491
    },
    {
        "content": "<p>but I think it's ok</p>",
        "id": 197578319,
        "sender_full_name": "Santiago Pastorino",
        "timestamp": 1589472535
    },
    {
        "content": "<p>because clearly <code>I-prioritize</code> is a request for prioritization</p>",
        "id": 197578343,
        "sender_full_name": "Santiago Pastorino",
        "timestamp": 1589472548
    },
    {
        "content": "<p>fixed the PR</p>",
        "id": 197578368,
        "sender_full_name": "Santiago Pastorino",
        "timestamp": 1589472554
    },
    {
        "content": "<p><span aria-label=\"+1\" class=\"emoji emoji-1f44d\" role=\"img\" title=\"+1\">:+1:</span></p>",
        "id": 197578377,
        "sender_full_name": "Léo Lanteri Thauvin",
        "timestamp": 1589472560
    },
    {
        "content": "<p>polishing a bit the other part</p>",
        "id": 197578385,
        "sender_full_name": "Santiago Pastorino",
        "timestamp": 1589472563
    },
    {
        "content": "<p>I think it's just</p>",
        "id": 197578864,
        "sender_full_name": "Santiago Pastorino",
        "timestamp": 1589472747
    },
    {
        "content": "<div class=\"codehilite\"><pre><span></span><code>diff --git a/src/config.rs b/src/config.rs\nindex 0c6f5f2..550dff0 100644\n--- a/src/config.rs\n+++ b/src/config.rs\n@@ -78,6 +78,7 @@ pub(crate) struct RelabelConfig {\n #[derive(PartialEq, Eq, Debug, serde::Deserialize)]\n pub(crate) struct PrioritizeConfig {\n     pub(crate) label: String,\n+    pub(crate) prioritize_on: Vec&lt;String&gt;,\n     pub(crate) zulip_stream: u64,\n }\n\ndiff --git a/src/handlers/prioritize.rs b/src/handlers/prioritize.rs\nindex f965422..21a735b 100644\n--- a/src/handlers/prioritize.rs\n+++ b/src/handlers/prioritize.rs\n@@ -34,7 +34,11 @@ impl Handler for PrioritizeHandler {\n         if let Event::Issue(e) = event {\n             if e.action == github::IssuesAction::Labeled {\n                 if let Some(config) = config {\n-                    if e.label.as_ref().expect(&quot;label&quot;).name == config.label {\n+                    if config\n+                        .prioritize_on\n+                        .iter()\n+                        .any(|l| l == &amp;e.label.as_ref().expect(&quot;label&quot;).name)\n+                    {\n                         // We need to take the exact same action in this case.\n                         return Ok(Some(Prioritize::Start));\n                     }\n</code></pre></div>",
        "id": 197578869,
        "sender_full_name": "Santiago Pastorino",
        "timestamp": 1589472750
    },
    {
        "content": "<p>we don't want to do anything when the label is removed</p>",
        "id": 197578900,
        "sender_full_name": "Santiago Pastorino",
        "timestamp": 1589472765
    },
    {
        "content": "<p>to remove the request from prioritization is removing <code>I-prioritize</code>, nothing should happen if regression related labels are removed</p>",
        "id": 197578967,
        "sender_full_name": "Santiago Pastorino",
        "timestamp": 1589472796
    },
    {
        "content": "<p>opened too <a href=\"https://github.com/rust-lang/triagebot/issues/542\">triagebot#542</a></p>",
        "id": 197579381,
        "sender_full_name": "Santiago Pastorino",
        "timestamp": 1589472951
    },
    {
        "content": "<blockquote>\n<p>Hm, probably stable-to-stable too?</p>\n</blockquote>\n<p>Do we want to prioritize on stable regressions</p>",
        "id": 197580084,
        "sender_full_name": "Léo Lanteri Thauvin",
        "timestamp": 1589473215
    },
    {
        "content": "<p>I also think we should</p>",
        "id": 197580114,
        "sender_full_name": "Léo Lanteri Thauvin",
        "timestamp": 1589473229
    },
    {
        "content": "<p>commented, I think we should yeah</p>",
        "id": 197580167,
        "sender_full_name": "Santiago Pastorino",
        "timestamp": 1589473258
    },
    {
        "content": "<p>there are 22 unprioritized regressions right now</p>",
        "id": 197580182,
        "sender_full_name": "Santiago Pastorino",
        "timestamp": 1589473269
    },
    {
        "content": "<p>Oh also <span class=\"user-mention\" data-user-id=\"116266\">@Santiago Pastorino</span>, should we prioritize even if the issue is already prioritized?</p>",
        "id": 197580183,
        "sender_full_name": "Léo Lanteri Thauvin",
        "timestamp": 1589473269
    },
    {
        "content": "<p>you're right, we should not request prioritization if it's <code>P-*</code> already</p>",
        "id": 197580327,
        "sender_full_name": "Santiago Pastorino",
        "timestamp": 1589473325
    },
    {
        "content": "<p>So maybe add (another) field in config</p>",
        "id": 197580368,
        "sender_full_name": "Léo Lanteri Thauvin",
        "timestamp": 1589473344
    },
    {
        "content": "<p>hehe <span aria-label=\"+1\" class=\"emoji emoji-1f44d\" role=\"img\" title=\"+1\">:+1:</span></p>",
        "id": 197580381,
        "sender_full_name": "Santiago Pastorino",
        "timestamp": 1589473350
    },
    {
        "content": "<p>To describe what a priority is</p>",
        "id": 197580387,
        "sender_full_name": "Léo Lanteri Thauvin",
        "timestamp": 1589473351
    },
    {
        "content": "<p>I guess we can reuse code from the relabel command</p>",
        "id": 197580411,
        "sender_full_name": "Léo Lanteri Thauvin",
        "timestamp": 1589473364
    },
    {
        "content": "<p>Which accepted those blob patterns (not sure what there're called)</p>",
        "id": 197580471,
        "sender_full_name": "Léo Lanteri Thauvin",
        "timestamp": 1589473394
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"255061\">LeSeulArtichaut</span> <a href=\"#narrow/stream/227806-t-compiler.2Fwg-prioritization/topic/triagebot.20pendings/near/197580411\">said</a>:</p>\n<blockquote>\n<p>I guess we can reuse code from the relabel command</p>\n</blockquote>\n<p>what do you mean?</p>",
        "id": 197580533,
        "sender_full_name": "Santiago Pastorino",
        "timestamp": 1589473428
    },
    {
        "content": "<p>In the configuration for the relabel command, triagebot accepts those patterns</p>",
        "id": 197580638,
        "sender_full_name": "Léo Lanteri Thauvin",
        "timestamp": 1589473456
    },
    {
        "content": "<p>also added a new attribute to <a href=\"https://github.com/rust-lang/rust/issues/72200\">#72200</a></p>",
        "id": 197580653,
        "sender_full_name": "Santiago Pastorino",
        "timestamp": 1589473469
    },
    {
        "content": "<p>So you should be able to reuse code from there</p>",
        "id": 197580656,
        "sender_full_name": "Léo Lanteri Thauvin",
        "timestamp": 1589473470
    },
    {
        "content": "<p>Having <code>P-*</code> in the config would be more convenient</p>",
        "id": 197580768,
        "sender_full_name": "Léo Lanteri Thauvin",
        "timestamp": 1589473505
    },
    {
        "content": "<p>But that's a detail anyway :P</p>",
        "id": 197580784,
        "sender_full_name": "Léo Lanteri Thauvin",
        "timestamp": 1589473511
    },
    {
        "content": "<p>so yeah, I thought about that but I was worried a bit that we may have <code>P-something-not-priority</code></p>",
        "id": 197580851,
        "sender_full_name": "Santiago Pastorino",
        "timestamp": 1589473535
    },
    {
        "content": "<p>at some point I thought we were going to call <code>I-prioritize</code> <code>P-prioritize</code></p>",
        "id": 197580881,
        "sender_full_name": "Santiago Pastorino",
        "timestamp": 1589473551
    },
    {
        "content": "<p>but yeah, what I'm saying probably doesn't make sense</p>",
        "id": 197580943,
        "sender_full_name": "Santiago Pastorino",
        "timestamp": 1589473564
    },
    {
        "content": "<p>:)</p>",
        "id": 197580944,
        "sender_full_name": "Santiago Pastorino",
        "timestamp": 1589473565
    },
    {
        "content": "<p>will do a pattern</p>",
        "id": 197580953,
        "sender_full_name": "Santiago Pastorino",
        "timestamp": 1589473571
    },
    {
        "content": "<p>Right, we might no have the <code>P-</code> prefix monopoly forever :D</p>",
        "id": 197580998,
        "sender_full_name": "Léo Lanteri Thauvin",
        "timestamp": 1589473594
    },
    {
        "content": "<p>pushed with the pattern</p>",
        "id": 197581103,
        "sender_full_name": "Santiago Pastorino",
        "timestamp": 1589473641
    },
    {
        "content": "<p><code>priorities_pattern = \"P-*\"</code></p>",
        "id": 197581115,
        "sender_full_name": "Santiago Pastorino",
        "timestamp": 1589473647
    },
    {
        "content": "<p>will fix triagebot code after lunch</p>",
        "id": 197581165,
        "sender_full_name": "Santiago Pastorino",
        "timestamp": 1589473666
    },
    {
        "content": "<p>Fun fact: if you type <code>@spastorino</code> on GitHub the UI suggests you <code>@rust-lang/cargo-taggers</code> <span aria-label=\"big smile\" class=\"emoji emoji-1f604\" role=\"img\" title=\"big smile\">:big_smile:</span></p>",
        "id": 197581427,
        "sender_full_name": "Léo Lanteri Thauvin",
        "timestamp": 1589473765
    },
    {
        "content": "<p>Opened <a href=\"https://github.com/rust-lang/triagebot/issues/543\">triagebot#543</a></p>",
        "id": 197582266,
        "sender_full_name": "Léo Lanteri Thauvin",
        "timestamp": 1589474150
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"116122\">@simulacrum</span> Do you have time to review this one? It should hopefully be pretty quick <span aria-label=\"big smile\" class=\"emoji emoji-1f604\" role=\"img\" title=\"big smile\">:big_smile:</span></p>",
        "id": 197582428,
        "sender_full_name": "Léo Lanteri Thauvin",
        "timestamp": 1589474216
    },
    {
        "content": "<p>yeah I can take a look</p>",
        "id": 197584983,
        "sender_full_name": "simulacrum",
        "timestamp": 1589475301
    },
    {
        "content": "<p>Thanks <span aria-label=\"+1\" class=\"emoji emoji-1f44d\" role=\"img\" title=\"+1\">:+1:</span></p>",
        "id": 197585003,
        "sender_full_name": "Léo Lanteri Thauvin",
        "timestamp": 1589475308
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"255061\">LeSeulArtichaut</span> <a href=\"#narrow/stream/227806-t-compiler.2Fwg-prioritization/topic/triagebot.20pendings/near/197581427\">said</a>:</p>\n<blockquote>\n<p>Fun fact: if you type <code>@spastorino</code> on GitHub the UI suggests you <code>@rust-lang/cargo-taggers</code> <span aria-label=\"big smile\" class=\"emoji emoji-1f604\" role=\"img\" title=\"big smile\">:big_smile:</span></p>\n</blockquote>\n<p>WAT?</p>",
        "id": 197586367,
        "sender_full_name": "Santiago Pastorino",
        "timestamp": 1589475857
    },
    {
        "content": "<p>hahahaha</p>",
        "id": 197586375,
        "sender_full_name": "Santiago Pastorino",
        "timestamp": 1589475859
    },
    {
        "content": "<p><span aria-label=\"shrug\" class=\"emoji emoji-1f937\" role=\"img\" title=\"shrug\">:shrug:</span></p>",
        "id": 197586416,
        "sender_full_name": "Léo Lanteri Thauvin",
        "timestamp": 1589475866
    },
    {
        "content": "<p><em>Is that a coincidence? I don't think so...</em> <span aria-label=\"eyes\" class=\"emoji emoji-1f440\" role=\"img\" title=\"eyes\">:eyes:</span></p>",
        "id": 197586464,
        "sender_full_name": "Léo Lanteri Thauvin",
        "timestamp": 1589475886
    },
    {
        "content": "<p><a href=\"https://github.com/rust-lang/triagebot/issues/543\">triagebot#543</a> just landed (thanks again <span class=\"user-mention\" data-user-id=\"116122\">@simulacrum</span>!)<br>\n<span class=\"user-mention\" data-user-id=\"116266\">@Santiago Pastorino</span> I think you'll want to rebase your PR onto master now. To make triagebot add the <code>I-prioritize</code> label, you'll now want to return <code>Prioritize::Label</code> instead of <code>Prioritize::Start</code>.</p>",
        "id": 197587394,
        "sender_full_name": "Léo Lanteri Thauvin",
        "timestamp": 1589476255
    },
    {
        "content": "<p>yeah, just got back</p>",
        "id": 197588542,
        "sender_full_name": "Santiago Pastorino",
        "timestamp": 1589476759
    },
    {
        "content": "<p>done and force pushed with the proper fixes</p>",
        "id": 197588558,
        "sender_full_name": "Santiago Pastorino",
        "timestamp": 1589476767
    },
    {
        "content": "<p>ahh let me mark the fields with serde(default)</p>",
        "id": 197588731,
        "sender_full_name": "Santiago Pastorino",
        "timestamp": 1589476839
    },
    {
        "content": "<p>ok, done</p>",
        "id": 197588848,
        "sender_full_name": "Santiago Pastorino",
        "timestamp": 1589476903
    },
    {
        "content": "<p><a href=\"https://github.com/rust-lang/rust/issues/72200\">#72200</a> and <a href=\"https://github.com/rust-lang/triagebot/issues/542\">triagebot#542</a> should be both ready</p>",
        "id": 197588926,
        "sender_full_name": "Santiago Pastorino",
        "timestamp": 1589476933
    },
    {
        "content": "<p>hold on what I did is wrong</p>",
        "id": 197591540,
        "sender_full_name": "Santiago Pastorino",
        "timestamp": 1589478159
    },
    {
        "content": "<p>wasn't paying attention</p>",
        "id": 197591546,
        "sender_full_name": "Santiago Pastorino",
        "timestamp": 1589478164
    },
    {
        "content": "<p><span aria-label=\"innocent\" class=\"emoji emoji-1f607\" role=\"img\" title=\"innocent\">:innocent:</span></p>",
        "id": 197591556,
        "sender_full_name": "Léo Lanteri Thauvin",
        "timestamp": 1589478167
    },
    {
        "content": "<p>By the way if someone has to prioritize an issue, I would be grateful if someone tests using <code>@rustbot prioritize</code></p>",
        "id": 197591898,
        "sender_full_name": "Léo Lanteri Thauvin",
        "timestamp": 1589478343
    },
    {
        "content": "<p><span aria-label=\"+1\" class=\"emoji emoji-1f44d\" role=\"img\" title=\"+1\">:+1:</span></p>",
        "id": 197592505,
        "sender_full_name": "Santiago Pastorino",
        "timestamp": 1589478603
    },
    {
        "content": "<p>pushed</p>",
        "id": 197592514,
        "sender_full_name": "Santiago Pastorino",
        "timestamp": 1589478605
    },
    {
        "content": "<p>now yes</p>",
        "id": 197592516,
        "sender_full_name": "Santiago Pastorino",
        "timestamp": 1589478607
    },
    {
        "content": "<p>\"should\" be ready</p>",
        "id": 197592538,
        "sender_full_name": "Santiago Pastorino",
        "timestamp": 1589478616
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"255061\">@LeSeulArtichaut</span> about <a href=\"https://github.com/rust-lang/triagebot/pull/542/files#r425313569\">https://github.com/rust-lang/triagebot/pull/542/files#r425313569</a>, I like your name better but do you think would be better using a <code>Vec&lt;String&gt;</code> here?</p>",
        "id": 197592716,
        "sender_full_name": "Santiago Pastorino",
        "timestamp": 1589478710
    },
    {
        "content": "<p>I guess we won't have really complex patterns to find labels</p>",
        "id": 197592779,
        "sender_full_name": "Santiago Pastorino",
        "timestamp": 1589478728
    },
    {
        "content": "<p>I think it would be consistent with the relabel command</p>",
        "id": 197592781,
        "sender_full_name": "Léo Lanteri Thauvin",
        "timestamp": 1589478728
    },
    {
        "content": "<p>That's a nitpick, really</p>",
        "id": 197592802,
        "sender_full_name": "Léo Lanteri Thauvin",
        "timestamp": 1589478740
    },
    {
        "content": "<p>yeah but I'm not even reusing the code because it's just using glob in my case</p>",
        "id": 197592836,
        "sender_full_name": "Santiago Pastorino",
        "timestamp": 1589478763
    },
    {
        "content": "<p>renamed it</p>",
        "id": 197593105,
        "sender_full_name": "Santiago Pastorino",
        "timestamp": 1589478871
    },
    {
        "content": "<p>However I still think the logic is wrong...</p>",
        "id": 197593171,
        "sender_full_name": "Léo Lanteri Thauvin",
        "timestamp": 1589478897
    },
    {
        "content": "<p>We still need to have this part of the code:</p>\n<div class=\"codehilite\"><pre><span></span><code><span class=\"k\">if</span><span class=\"w\"> </span><span class=\"n\">e</span><span class=\"p\">.</span><span class=\"n\">label</span><span class=\"p\">.</span><span class=\"n\">as_ref</span><span class=\"p\">().</span><span class=\"n\">expect</span><span class=\"p\">(</span><span class=\"s\">&quot;label&quot;</span><span class=\"p\">).</span><span class=\"n\">name</span><span class=\"w\"> </span><span class=\"o\">==</span><span class=\"w\"> </span><span class=\"n\">config</span><span class=\"p\">.</span><span class=\"n\">label</span><span class=\"w\"> </span><span class=\"p\">{</span><span class=\"w\"></span>\n<span class=\"w\">    </span><span class=\"c1\">// We need to take the exact same action in this case.</span>\n<span class=\"w\">     </span><span class=\"k\">return</span><span class=\"w\"> </span><span class=\"nb\">Ok</span><span class=\"p\">(</span><span class=\"nb\">Some</span><span class=\"p\">(</span><span class=\"n\">Prioritize</span>::<span class=\"n\">Start</span><span class=\"p\">));</span><span class=\"w\"></span>\n<span class=\"p\">}</span><span class=\"w\"></span>\n</code></pre></div>\n\n\n<p>Because I rely on it to start the Zulip thread</p>",
        "id": 197593264,
        "sender_full_name": "Léo Lanteri Thauvin",
        "timestamp": 1589478938
    },
    {
        "content": "<p>I think we want to keep it, and append your code</p>",
        "id": 197593539,
        "sender_full_name": "Léo Lanteri Thauvin",
        "timestamp": 1589479019
    },
    {
        "content": "<p>Also return <code>Prioritize::Label</code> in this case</p>",
        "id": 197594038,
        "sender_full_name": "Léo Lanteri Thauvin",
        "timestamp": 1589479234
    },
    {
        "content": "<p>Oh, I amended my commit to add documentation to the variants of <code>Prioritize</code> but I didn't push it <span aria-label=\"face palm\" class=\"emoji emoji-1f926\" role=\"img\" title=\"face palm\">:face_palm:</span></p>",
        "id": 197594193,
        "sender_full_name": "Léo Lanteri Thauvin",
        "timestamp": 1589479305
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"255061\">@LeSeulArtichaut</span> it should be ok now</p>",
        "id": 197594737,
        "sender_full_name": "Santiago Pastorino",
        "timestamp": 1589479515
    },
    {
        "content": "<p>Just a last question: why do we need to call <code>.to_owned()</code> on the issue labels if we only iterate through them?</p>",
        "id": 197594901,
        "sender_full_name": "Léo Lanteri Thauvin",
        "timestamp": 1589479584
    },
    {
        "content": "<p>because it's wrong :)</p>",
        "id": 197595058,
        "sender_full_name": "Santiago Pastorino",
        "timestamp": 1589479660
    },
    {
        "content": "<p>was copy + paste</p>",
        "id": 197595070,
        "sender_full_name": "Santiago Pastorino",
        "timestamp": 1589479667
    },
    {
        "content": "<p><em>I can't blame you, we all do the same</em> <span aria-label=\"innocent\" class=\"emoji emoji-1f607\" role=\"img\" title=\"innocent\">:innocent:</span></p>",
        "id": 197595133,
        "sender_full_name": "Léo Lanteri Thauvin",
        "timestamp": 1589479686
    },
    {
        "content": "<p>last thing</p>",
        "id": 197596179,
        "sender_full_name": "Santiago Pastorino",
        "timestamp": 1589480179
    },
    {
        "content": "<p>going to change this</p>",
        "id": 197596185,
        "sender_full_name": "Santiago Pastorino",
        "timestamp": 1589480182
    },
    {
        "content": "<div class=\"codehilite\"><pre><span></span><code>-                            if !issue_labels.iter().any(|l| glob.matches(&amp;l.name))\n+                            if issue_labels.iter().all(|l| !glob.matches(&amp;l.name))\n</code></pre></div>",
        "id": 197596193,
        "sender_full_name": "Santiago Pastorino",
        "timestamp": 1589480185
    },
    {
        "content": "<p>:P</p>",
        "id": 197596197,
        "sender_full_name": "Santiago Pastorino",
        "timestamp": 1589480187
    },
    {
        "content": "<p>!any seems silly</p>",
        "id": 197596239,
        "sender_full_name": "Santiago Pastorino",
        "timestamp": 1589480207
    },
    {
        "content": "<p><span aria-label=\"heart\" class=\"emoji emoji-2764\" role=\"img\" title=\"heart\">:heart:</span>  <a href=\"https://github.com/rust-lang/rust/pull/71891\">https://github.com/rust-lang/rust/pull/71891</a></p>",
        "id": 197613473,
        "sender_full_name": "lcnr",
        "timestamp": 1589488168
    },
    {
        "content": "<p>^ realised that it's actually not exactly the same <span aria-label=\"shrug\" class=\"emoji emoji-1f937\" role=\"img\" title=\"shrug\">:shrug:</span></p>",
        "id": 197613986,
        "sender_full_name": "lcnr",
        "timestamp": 1589488399
    },
    {
        "content": "<p>oh wow</p>",
        "id": 197617577,
        "sender_full_name": "Santiago Pastorino",
        "timestamp": 1589490108
    },
    {
        "content": "<div class=\"codehilite\"><pre><span></span><code><span class=\"k\">if</span><span class=\"w\"> </span><span class=\"o\">!</span><span class=\"n\">associated_types</span><span class=\"p\">.</span><span class=\"n\">values</span><span class=\"p\">().</span><span class=\"n\">any</span><span class=\"p\">(</span><span class=\"o\">|</span><span class=\"n\">v</span><span class=\"o\">|</span><span class=\"w\"> </span><span class=\"o\">!</span><span class=\"n\">v</span><span class=\"p\">.</span><span class=\"n\">is_empty</span><span class=\"p\">())</span><span class=\"w\"> </span><span class=\"p\">{</span><span class=\"w\"></span>\n</code></pre></div>",
        "id": 197617581,
        "sender_full_name": "Santiago Pastorino",
        "timestamp": 1589490112
    },
    {
        "content": "<p>:S</p>",
        "id": 197617586,
        "sender_full_name": "Santiago Pastorino",
        "timestamp": 1589490115
    },
    {
        "content": "<p>it's like triple negation :)</p>",
        "id": 197617735,
        "sender_full_name": "Santiago Pastorino",
        "timestamp": 1589490176
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"255061\">@LeSeulArtichaut</span> <span class=\"user-mention\" data-user-id=\"116122\">@simulacrum</span> thoughts about this ...</p>",
        "id": 198209902,
        "sender_full_name": "Santiago Pastorino",
        "timestamp": 1589986434
    },
    {
        "content": "<div class=\"codehilite\"><pre><span></span><code>diff --git a/src/config.rs b/src/config.rs\nindex cf73536..f4a91ee 100644\n--- a/src/config.rs\n+++ b/src/config.rs\n@@ -82,6 +82,8 @@ pub(crate) struct PrioritizeConfig {\n     pub(crate) prioritize_on: Vec&lt;String&gt;,\n     #[serde(default)]\n     pub(crate) priority_labels: String,\n+    #[serde(default)]\n+    pub(crate) exclude_labels: Vec&lt;String&gt;,\n     pub(crate) zulip_stream: u64,\n }\n\ndiff --git a/src/handlers/prioritize.rs b/src/handlers/prioritize.rs\nindex 389c41b..74b3832 100644\n--- a/src/handlers/prioritize.rs\n+++ b/src/handlers/prioritize.rs\n@@ -44,8 +44,13 @@ impl Handler for PrioritizeHandler {\n                                 let issue_labels = event.issue().unwrap().labels();\n                                 let label_name = &amp;e.label.as_ref().expect(&quot;label&quot;).name;\n\n-                                if issue_labels.iter().all(|l| !glob.matches(&amp;l.name))\n-                                    &amp;&amp; config.prioritize_on.iter().any(|l| l == label_name)\n+                                if issue_labels.iter().all(|l| {\n+                                    !glob.matches(&amp;l.name)\n+                                        &amp;&amp; config\n+                                            .exclude_labels\n+                                            .iter()\n+                                            .all(|label_name| *label_name != l.name)\n+                                }) &amp;&amp; config.prioritize_on.iter().any(|l| l == label_name)\n                                 {\n                                     return Ok(Some(Prioritize::Label));\n                                 }\n</code></pre></div>",
        "id": 198209954,
        "sender_full_name": "Santiago Pastorino",
        "timestamp": 1589986444
    },
    {
        "content": "<p>this and ...</p>",
        "id": 198209965,
        "sender_full_name": "Santiago Pastorino",
        "timestamp": 1589986449
    },
    {
        "content": "<p>I don't have time right this moment to read and understand diffs I'm afraid</p>",
        "id": 198209989,
        "sender_full_name": "simulacrum",
        "timestamp": 1589986462
    },
    {
        "content": "<div class=\"codehilite\"><pre><span></span><code>diff --git a/triagebot.toml b/triagebot.toml\nindex 2210a8ff8e6..1ee2aefef3f 100644\n--- a/triagebot.toml\n+++ b/triagebot.toml\n@@ -38,4 +38,5 @@ label = &quot;ICEBreaker-Cleanup-Crew&quot;\n label = &quot;I-prioritize&quot;\n prioritize_on = [&quot;regression-from-stable-to-stable&quot;, &quot;regression-from-stable-to-beta&quot;, &quot;regression-from-stable-to-nightly&quot;]\n priority_labels = &quot;P-*&quot;\n+exclude_labels = [&quot;T-infra&quot;, &quot;T-release&quot;, &quot;T-rustdoc&quot;]\n zulip_stream = 227806\n</code></pre></div>",
        "id": 198210004,
        "sender_full_name": "Santiago Pastorino",
        "timestamp": 1589986470
    },
    {
        "content": "<p>The TOML format seems good</p>",
        "id": 198210061,
        "sender_full_name": "Léo Lanteri Thauvin",
        "timestamp": 1589986493
    },
    {
        "content": "<p>Reading the logic...</p>",
        "id": 198210075,
        "sender_full_name": "Léo Lanteri Thauvin",
        "timestamp": 1589986500
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"116122\">@simulacrum</span> short summary is ... on regressions skip if the issue is labelled with [\"T-infra\", \"T-release\", \"T-rustdoc\"]</p>",
        "id": 198210084,
        "sender_full_name": "Santiago Pastorino",
        "timestamp": 1589986503
    },
    {
        "content": "<p>if you agree with the idea I just send a PR and we can all check the diff there at some point async</p>",
        "id": 198210154,
        "sender_full_name": "Santiago Pastorino",
        "timestamp": 1589986530
    },
    {
        "content": "<p>hm I guess, though in practice I think we currently do rely on compiler pings to some extent</p>",
        "id": 198210193,
        "sender_full_name": "simulacrum",
        "timestamp": 1589986543
    },
    {
        "content": "<p>but seems fine</p>",
        "id": 198210207,
        "sender_full_name": "simulacrum",
        "timestamp": 1589986548
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"116266\">@Santiago Pastorino</span> I think we should merge the priorities and  exclude labels</p>",
        "id": 198210226,
        "sender_full_name": "Léo Lanteri Thauvin",
        "timestamp": 1589986557
    },
    {
        "content": "<p>into a pattern</p>",
        "id": 198210301,
        "sender_full_name": "Santiago Pastorino",
        "timestamp": 1589986575
    },
    {
        "content": "<p>yeah, makes sense I guess :)</p>",
        "id": 198210332,
        "sender_full_name": "Santiago Pastorino",
        "timestamp": 1589986591
    },
    {
        "content": "<p>A list of pattern I'd say</p>",
        "id": 198210333,
        "sender_full_name": "Léo Lanteri Thauvin",
        "timestamp": 1589986591
    },
    {
        "content": "<p>yep</p>",
        "id": 198210347,
        "sender_full_name": "Santiago Pastorino",
        "timestamp": 1589986597
    },
    {
        "content": "<p>So you'd have:</p>\n<div class=\"codehilite\"><pre><span></span><code><span class=\"n\">exclude_labels</span> <span class=\"o\">=</span> <span class=\"k\">[&quot;P-*&quot;, &quot;T-infra&quot;, &quot;T-release&quot;, &quot;T-rustdoc&quot;]</span>\n</code></pre></div>",
        "id": 198210417,
        "sender_full_name": "Léo Lanteri Thauvin",
        "timestamp": 1589986626
    },
    {
        "content": "<p>Which IMO is cleaner :D</p>",
        "id": 198210428,
        "sender_full_name": "Léo Lanteri Thauvin",
        "timestamp": 1589986632
    },
    {
        "content": "<p>Also I think we'll need to update the documentation for the feature</p>",
        "id": 198210479,
        "sender_full_name": "Léo Lanteri Thauvin",
        "timestamp": 1589986653
    },
    {
        "content": "<p>In the triagebot wiki</p>",
        "id": 198210489,
        "sender_full_name": "Léo Lanteri Thauvin",
        "timestamp": 1589986657
    },
    {
        "content": "<p>But that's a nit <span aria-label=\"slight smile\" class=\"emoji emoji-1f642\" role=\"img\" title=\"slight smile\">:slight_smile:</span></p>",
        "id": 198210511,
        "sender_full_name": "Léo Lanteri Thauvin",
        "timestamp": 1589986669
    },
    {
        "content": "<p>yeah agreed</p>",
        "id": 198210807,
        "sender_full_name": "Santiago Pastorino",
        "timestamp": 1589986777
    },
    {
        "content": "<p>I've done exactly that</p>",
        "id": 198210830,
        "sender_full_name": "Santiago Pastorino",
        "timestamp": 1589986788
    },
    {
        "content": "<p><span aria-label=\"+1\" class=\"emoji emoji-1f44d\" role=\"img\" title=\"+1\">:+1:</span></p>",
        "id": 198210838,
        "sender_full_name": "Léo Lanteri Thauvin",
        "timestamp": 1589986795
    },
    {
        "content": "<p>was trying to see if you both would notice this to take a short cut <span aria-label=\"joy\" class=\"emoji emoji-1f602\" role=\"img\" title=\"joy\">:joy:</span></p>",
        "id": 198210917,
        "sender_full_name": "Santiago Pastorino",
        "timestamp": 1589986812
    },
    {
        "content": "<p>So this was a test? xD</p>",
        "id": 198210966,
        "sender_full_name": "Léo Lanteri Thauvin",
        "timestamp": 1589986836
    },
    {
        "content": "<p>:P</p>",
        "id": 198210993,
        "sender_full_name": "Santiago Pastorino",
        "timestamp": 1589986850
    },
    {
        "content": "<p>kidding kidding :)</p>",
        "id": 198211011,
        "sender_full_name": "Santiago Pastorino",
        "timestamp": 1589986859
    },
    {
        "content": "<p>sending PRs</p>",
        "id": 198213426,
        "sender_full_name": "Santiago Pastorino",
        "timestamp": 1589987821
    },
    {
        "content": "<p>first <a href=\"https://github.com/rust-lang/rust/issues/72385\">#72385</a></p>",
        "id": 198213438,
        "sender_full_name": "Santiago Pastorino",
        "timestamp": 1589987825
    },
    {
        "content": "<p>and</p>",
        "id": 198213887,
        "sender_full_name": "Santiago Pastorino",
        "timestamp": 1589987999
    },
    {
        "content": "<p><a href=\"https://github.com/rust-lang/triagebot/issues/561\">triagebot#561</a></p>",
        "id": 198213920,
        "sender_full_name": "Santiago Pastorino",
        "timestamp": 1589988002
    },
    {
        "content": "<p>Let's <del>make you rewrite everything</del> review your code :D</p>",
        "id": 198214072,
        "sender_full_name": "Léo Lanteri Thauvin",
        "timestamp": 1589988063
    },
    {
        "content": "<p>well I'm already changing a conditional which is doing repeated work :)</p>",
        "id": 198214125,
        "sender_full_name": "Santiago Pastorino",
        "timestamp": 1589988085
    },
    {
        "content": "<p>pushed and well we may prefer to extract some methods there</p>",
        "id": 198214475,
        "sender_full_name": "Santiago Pastorino",
        "timestamp": 1589988235
    },
    {
        "content": "<div class=\"codehilite\"><pre><span></span><code><span class=\"p\">.</span><span class=\"n\">all</span><span class=\"p\">(</span><span class=\"o\">|</span><span class=\"n\">l</span><span class=\"o\">|</span><span class=\"w\"> </span><span class=\"o\">!</span><span class=\"n\">glob</span><span class=\"p\">.</span><span class=\"n\">matches</span><span class=\"p\">(</span><span class=\"o\">&amp;</span><span class=\"n\">l</span><span class=\"p\">.</span><span class=\"n\">name</span><span class=\"p\">))</span><span class=\"w\"></span>\n</code></pre></div>\n\n\n<p>Again? x)</p>",
        "id": 198214705,
        "sender_full_name": "Léo Lanteri Thauvin",
        "timestamp": 1589988310
    },
    {
        "content": "<p>lol</p>",
        "id": 198214793,
        "sender_full_name": "Santiago Pastorino",
        "timestamp": 1589988345
    },
    {
        "content": "<p>well to me the problem is any</p>",
        "id": 198214834,
        "sender_full_name": "Santiago Pastorino",
        "timestamp": 1589988361
    },
    {
        "content": "<p>that means all are different</p>",
        "id": 198214885,
        "sender_full_name": "Santiago Pastorino",
        "timestamp": 1589988367
    },
    {
        "content": "<p>that would be !any</p>",
        "id": 198214927,
        "sender_full_name": "Santiago Pastorino",
        "timestamp": 1589988382
    },
    {
        "content": "<p>I think I prefer all(not(something) than not(any(something))</p>",
        "id": 198214969,
        "sender_full_name": "Santiago Pastorino",
        "timestamp": 1589988404
    },
    {
        "content": "<p>the problem to me is using not(any(not(something))) or stuff like that</p>",
        "id": 198215018,
        "sender_full_name": "Santiago Pastorino",
        "timestamp": 1589988426
    },
    {
        "content": "<p>I'm not the one maintaining the codebase, I'll leave reviewing the code quality to <span class=\"user-mention silent\" data-user-id=\"116122\">simulacrum</span> <span aria-label=\"innocent\" class=\"emoji emoji-1f607\" role=\"img\" title=\"innocent\">:innocent:</span></p>",
        "id": 198215076,
        "sender_full_name": "Léo Lanteri Thauvin",
        "timestamp": 1589988442
    },
    {
        "content": "<p>my rule is kind of use any if it's straight, anyway this case may be better done with just 2 loops</p>",
        "id": 198215100,
        "sender_full_name": "Santiago Pastorino",
        "timestamp": 1589988450
    },
    {
        "content": "<p>let me do it that way</p>",
        "id": 198215112,
        "sender_full_name": "Santiago Pastorino",
        "timestamp": 1589988454
    },
    {
        "content": "<p>Well I think we should always write code so it sounds good to us humans, right?</p>",
        "id": 198215245,
        "sender_full_name": "Léo Lanteri Thauvin",
        "timestamp": 1589988492
    },
    {
        "content": "<p>Anyway</p>",
        "id": 198215323,
        "sender_full_name": "Léo Lanteri Thauvin",
        "timestamp": 1589988523
    },
    {
        "content": "<div class=\"codehilite\"><pre><span></span><code><span class=\"w\">                        </span><span class=\"k\">if</span><span class=\"w\"> </span><span class=\"n\">config</span><span class=\"p\">.</span><span class=\"n\">prioritize_on</span><span class=\"p\">.</span><span class=\"n\">iter</span><span class=\"p\">().</span><span class=\"n\">any</span><span class=\"p\">(</span><span class=\"o\">|</span><span class=\"n\">l</span><span class=\"o\">|</span><span class=\"w\"> </span><span class=\"n\">l</span><span class=\"w\"> </span><span class=\"o\">==</span><span class=\"w\"> </span><span class=\"n\">label_name</span><span class=\"p\">)</span><span class=\"w\"> </span><span class=\"p\">{</span><span class=\"w\"></span>\n<span class=\"w\">                            </span><span class=\"kd\">let</span><span class=\"w\"> </span><span class=\"k\">mut</span><span class=\"w\"> </span><span class=\"n\">prioritize</span><span class=\"w\"> </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"kc\">false</span><span class=\"p\">;</span><span class=\"w\"></span>\n\n<span class=\"w\">                            </span><span class=\"k\">for</span><span class=\"w\"> </span><span class=\"n\">label</span><span class=\"w\"> </span><span class=\"k\">in</span><span class=\"w\"> </span><span class=\"n\">event</span><span class=\"p\">.</span><span class=\"n\">issue</span><span class=\"p\">().</span><span class=\"n\">unwrap</span><span class=\"p\">().</span><span class=\"n\">labels</span><span class=\"p\">()</span><span class=\"w\"> </span><span class=\"p\">{</span><span class=\"w\"></span>\n<span class=\"w\">                                </span><span class=\"k\">for</span><span class=\"w\"> </span><span class=\"n\">exclude_label</span><span class=\"w\"> </span><span class=\"k\">in</span><span class=\"w\"> </span><span class=\"o\">&amp;</span><span class=\"n\">config</span><span class=\"p\">.</span><span class=\"n\">exclude_labels</span><span class=\"w\"> </span><span class=\"p\">{</span><span class=\"w\"></span>\n<span class=\"w\">                                    </span><span class=\"k\">match</span><span class=\"w\"> </span><span class=\"n\">glob</span>::<span class=\"n\">Pattern</span>::<span class=\"n\">new</span><span class=\"p\">(</span><span class=\"n\">exclude_label</span><span class=\"p\">)</span><span class=\"w\"> </span><span class=\"p\">{</span><span class=\"w\"></span>\n<span class=\"w\">                                        </span><span class=\"nb\">Ok</span><span class=\"p\">(</span><span class=\"n\">exclude_glob</span><span class=\"p\">)</span><span class=\"w\"> </span><span class=\"o\">=&gt;</span><span class=\"w\"> </span><span class=\"p\">{</span><span class=\"w\"></span>\n<span class=\"w\">                                            </span><span class=\"n\">prioritize</span><span class=\"w\"> </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"o\">!</span><span class=\"n\">exclude_glob</span><span class=\"p\">.</span><span class=\"n\">matches</span><span class=\"p\">(</span><span class=\"o\">&amp;</span><span class=\"n\">label</span><span class=\"p\">.</span><span class=\"n\">name</span><span class=\"p\">);</span><span class=\"w\"></span>\n<span class=\"w\">                                        </span><span class=\"p\">}</span><span class=\"w\"></span>\n<span class=\"w\">                                        </span><span class=\"nb\">Err</span><span class=\"p\">(</span><span class=\"n\">error</span><span class=\"p\">)</span><span class=\"w\"> </span><span class=\"o\">=&gt;</span><span class=\"w\"> </span><span class=\"p\">{</span><span class=\"w\"></span>\n<span class=\"w\">                                            </span><span class=\"n\">log</span>::<span class=\"n\">error</span><span class=\"o\">!</span><span class=\"p\">(</span><span class=\"s\">&quot;Invalid glob pattern: {}&quot;</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"n\">error</span><span class=\"p\">);</span><span class=\"w\"></span>\n<span class=\"w\">                                        </span><span class=\"p\">}</span><span class=\"w\"></span>\n<span class=\"w\">                                    </span><span class=\"p\">}</span><span class=\"w\"></span>\n\n<span class=\"w\">                                    </span><span class=\"k\">if</span><span class=\"w\"> </span><span class=\"o\">!</span><span class=\"n\">prioritize</span><span class=\"w\"> </span><span class=\"p\">{</span><span class=\"w\"></span>\n<span class=\"w\">                                        </span><span class=\"k\">break</span><span class=\"p\">;</span><span class=\"w\"></span>\n<span class=\"w\">                                    </span><span class=\"p\">}</span><span class=\"w\"></span>\n<span class=\"w\">                                </span><span class=\"p\">}</span><span class=\"w\"></span>\n<span class=\"w\">                            </span><span class=\"p\">}</span><span class=\"w\"></span>\n\n<span class=\"w\">                            </span><span class=\"k\">if</span><span class=\"w\"> </span><span class=\"n\">prioritize</span><span class=\"w\"> </span><span class=\"p\">{</span><span class=\"w\"></span>\n<span class=\"w\">                                </span><span class=\"k\">return</span><span class=\"w\"> </span><span class=\"nb\">Ok</span><span class=\"p\">(</span><span class=\"nb\">Some</span><span class=\"p\">(</span><span class=\"n\">Prioritize</span>::<span class=\"n\">Label</span><span class=\"p\">));</span><span class=\"w\"></span>\n<span class=\"w\">                            </span><span class=\"p\">}</span><span class=\"w\"></span>\n<span class=\"w\">                        </span><span class=\"p\">}</span><span class=\"w\"></span>\n</code></pre></div>\n\n\n<div class=\"codehilite\"><pre><span></span><code>\n</code></pre></div>",
        "id": 198216248,
        "sender_full_name": "Santiago Pastorino",
        "timestamp": 1589988905
    },
    {
        "content": "<p>that more imperative way may be easier to read</p>",
        "id": 198216275,
        "sender_full_name": "Santiago Pastorino",
        "timestamp": 1589988923
    },
    {
        "content": "<p>Either that or leaving comments (you know, those lines with <code>//</code> <span aria-label=\"laughing\" class=\"emoji emoji-1f606\" role=\"img\" title=\"laughing\">:laughing:</span>)<br>\nEDIT: or both? x)</p>",
        "id": 198220032,
        "sender_full_name": "Léo Lanteri Thauvin",
        "timestamp": 1589990596
    },
    {
        "content": "<p>adding comments is for the weak <span aria-label=\"joy\" class=\"emoji emoji-1f602\" role=\"img\" title=\"joy\">:joy:</span>, I hope <span class=\"user-mention silent\" data-user-id=\"116009\">nikomatsakis</span> is not reading this <span aria-label=\"slight smile\" class=\"emoji emoji-1f642\" role=\"img\" title=\"slight smile\">:slight_smile:</span></p>",
        "id": 198225158,
        "sender_full_name": "Santiago Pastorino",
        "timestamp": 1589992979
    },
    {
        "content": "<p>srsly, agree :)</p>",
        "id": 198225206,
        "sender_full_name": "Santiago Pastorino",
        "timestamp": 1589993004
    },
    {
        "content": "<blockquote>\n<p>just make the code self explanatory</p>\n</blockquote>",
        "id": 198225271,
        "sender_full_name": "lcnr",
        "timestamp": 1589993038
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"216206\">@lcnr</span> :), well this code is not particularly hard</p>",
        "id": 198225358,
        "sender_full_name": "Santiago Pastorino",
        "timestamp": 1589993057
    },
    {
        "content": "<p>I can extract a function <code>needs_prioritization</code> or something and would be way more readable but I'm not sure if all this is worth investing a lot of time :)</p>",
        "id": 198225505,
        "sender_full_name": "Santiago Pastorino",
        "timestamp": 1589993151
    },
    {
        "content": "<p><span aria-label=\"laughing\" class=\"emoji emoji-1f606\" role=\"img\" title=\"laughing\">:laughing:</span> Not saying it's needed here</p>",
        "id": 198225610,
        "sender_full_name": "lcnr",
        "timestamp": 1589993194
    },
    {
        "content": "<p>:)</p>",
        "id": 198227451,
        "sender_full_name": "Santiago Pastorino",
        "timestamp": 1589994066
    },
    {
        "content": "<p>added a comment anyway</p>",
        "id": 198227866,
        "sender_full_name": "Santiago Pastorino",
        "timestamp": 1589994240
    },
    {
        "content": "<p>Hey <code>@nikomatsakis</code>, please check 8 comments above x)</p>",
        "id": 198234485,
        "sender_full_name": "Léo Lanteri Thauvin",
        "timestamp": 1589997462
    }
]