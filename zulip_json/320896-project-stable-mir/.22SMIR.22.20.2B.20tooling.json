[
    {
        "content": "<p>First off, I demand that we call stable MIR \"SMIR\" (pronounced \"smear\").</p>",
        "id": 278559351,
        "sender_full_name": "nikomatsakis",
        "timestamp": 1649686411
    },
    {
        "content": "<p>But also--- we talked a fair about about how SMIR + verification tooling could fit together</p>",
        "id": 278572032,
        "sender_full_name": "nikomatsakis",
        "timestamp": 1649691223
    },
    {
        "content": "<p>and also the \"division of responsibilities\" between the core compiler team and the tool maintainers</p>",
        "id": 278572097,
        "sender_full_name": "nikomatsakis",
        "timestamp": 1649691243
    },
    {
        "content": "<p>our idea was basically that it makes sense to have a lib, I'm calling it tool-lib for now but it needs a snazzier name, that contains common code and provides a nicer interface to SMIR and the compiler</p>",
        "id": 278572154,
        "sender_full_name": "nikomatsakis",
        "timestamp": 1649691273
    },
    {
        "content": "<p>so the core compiler team would (mostly) maintain the translation from MIR to SMIR</p>",
        "id": 278572184,
        "sender_full_name": "nikomatsakis",
        "timestamp": 1649691286
    },
    {
        "content": "<p>but there'd be a sepaarate subteam maintaining this tools-lib</p>",
        "id": 278572196,
        "sender_full_name": "nikomatsakis",
        "timestamp": 1649691293
    },
    {
        "content": "<p>(and perhaps managing some of the trickier transitions)</p>",
        "id": 278572221,
        "sender_full_name": "nikomatsakis",
        "timestamp": 1649691303
    },
    {
        "content": "<p>I tried to summarize the idea in a HackMD document: <a href=\"https://hackmd.io/jhtHKTXpRJ-D2WH7alJITw?view\">https://hackmd.io/jhtHKTXpRJ-D2WH7alJITw?view</a></p>",
        "id": 278610565,
        "sender_full_name": "Vytautas Astrauskas [he/him]",
        "timestamp": 1649708267
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"312719\">@Xavier Denis</span> <span class=\"user-mention\" data-user-id=\"116852\">@Andrea Lattuada</span> Could you please double-check that I did not write nonsense and that I did not forget anything?</p>",
        "id": 278610688,
        "sender_full_name": "Vytautas Astrauskas [he/him]",
        "timestamp": 1649708310
    },
    {
        "content": "<p>It seems good and complete to me</p>",
        "id": 278622488,
        "sender_full_name": "Xavier Denis",
        "timestamp": 1649714255
    },
    {
        "content": "<p>The only nit I would make is that in your diagram borrowck etc should be above tool lib and have arrows into and out of the compiler box</p>",
        "id": 278622569,
        "sender_full_name": "Xavier Denis",
        "timestamp": 1649714297
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"116109\">Vytautas Astrauskas [he/him]</span> <a href=\"#narrow/stream/320896-project-stable-mir/topic/.22SMIR.22.20.2B.20tooling/near/278610565\">said</a>:</p>\n<blockquote>\n<p>I tried to summarize the idea in a HackMD document: <a href=\"https://hackmd.io/jhtHKTXpRJ-D2WH7alJITw?view\">https://hackmd.io/jhtHKTXpRJ-D2WH7alJITw?view</a></p>\n</blockquote>\n<p>That's awesome! Thanks for capturing this. I added a few comments to the document.</p>",
        "id": 278628689,
        "sender_full_name": "Celina V.",
        "timestamp": 1649718388
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"312719\">Xavier Denis</span> <a href=\"#narrow/stream/320896-project-stable-mir/topic/.22SMIR.22.20.2B.20tooling/near/278622569\">said</a>:</p>\n<blockquote>\n<p>The only nit I would make is that in your diagram borrowck etc should be above tool lib and have arrows into and out of the compiler box</p>\n</blockquote>\n<p>Do you mean that borrowck should be part of the compiler?</p>",
        "id": 278670980,
        "sender_full_name": "Vytautas Astrauskas [he/him]",
        "timestamp": 1649757440
    },
    {
        "content": "<p>borrowck is definitely part of the compiler</p>",
        "id": 278686241,
        "sender_full_name": "pnkfelix",
        "timestamp": 1649767147
    },
    {
        "content": "<p>One of the open questions is about how to handle the different use cases here: Some people are going to want to produce SMIR <em>without</em> performing borrowck on it, and hand it off to the compiler to do the dirty work of lifetime inference and borrowck. But, most of our initial group of users, we expect, are going to want SMIR to, at least potentially, <em>carry</em> the borrowck info so that they can reference it in their own analyses.</p>",
        "id": 278686459,
        "sender_full_name": "pnkfelix",
        "timestamp": 1649767252
    },
    {
        "content": "<p>So the implication is that, in the long term, you will have some people producing SMIR and feeding it into the compiler to be borrowck'ed. But most other people will be consuming SMIR that comes out of the compiler, with borrowck info attached.</p>",
        "id": 278686547,
        "sender_full_name": "pnkfelix",
        "timestamp": 1649767302
    },
    {
        "content": "<p>That's probably why <span class=\"user-mention\" data-user-id=\"312719\">@Xavier Denis</span> was saying that there should be arrows into and out of the compiler box</p>",
        "id": 278686579,
        "sender_full_name": "pnkfelix",
        "timestamp": 1649767319
    },
    {
        "content": "<p>indeed</p>",
        "id": 278703255,
        "sender_full_name": "Xavier Denis",
        "timestamp": 1649774856
    },
    {
        "content": "<p>and another point: this diagram is implying that the librarified borrowck can run on both the internal rep of the compiler and SMIR</p>",
        "id": 278703309,
        "sender_full_name": "Xavier Denis",
        "timestamp": 1649774880
    },
    {
        "content": "<p>which is a strong claim to make</p>",
        "id": 278703392,
        "sender_full_name": "Xavier Denis",
        "timestamp": 1649774901
    },
    {
        "content": "<p>What we should have is probably just arrows connecting borrowck and internal MIR, at least for now. Maybe at some point in the future there will be a borrowck that operates on SMIR, but I don't think anyone is looking to invest in that in the short term.</p>",
        "id": 278703589,
        "sender_full_name": "pnkfelix",
        "timestamp": 1649775002
    },
    {
        "content": "<p>exactly, that's what I would expect</p>",
        "id": 278709244,
        "sender_full_name": "Xavier Denis",
        "timestamp": 1649777162
    },
    {
        "content": "<p>however, I would also expect that that information is embedded in the syntax of SMIR for tools like prusti to use it</p>",
        "id": 278709306,
        "sender_full_name": "Xavier Denis",
        "timestamp": 1649777187
    },
    {
        "content": "<p>incidentally: this means that SMIR should include a separate dataflow system as I think that liveness / initialization / points-to are common and shared analyses</p>",
        "id": 278709364,
        "sender_full_name": "Xavier Denis",
        "timestamp": 1649777218
    },
    {
        "content": "<p>cc <span class=\"user-mention\" data-user-id=\"265377\">@Will Crichton</span></p>",
        "id": 278709379,
        "sender_full_name": "Xavier Denis",
        "timestamp": 1649777229
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"312719\">Xavier Denis</span> <a href=\"#narrow/stream/320896-project-stable-mir/topic/.22SMIR.22.20.2B.20tooling/near/278703309\">said</a>:</p>\n<blockquote>\n<p>and another point: this diagram is implying that the librarified borrowck can run on both the internal rep of the compiler and SMIR</p>\n</blockquote>\n<p>But you do need this to be the case for trait checking, or do I misunderstand something?</p>",
        "id": 278712728,
        "sender_full_name": "Vytautas Astrauskas [he/him]",
        "timestamp": 1649778799
    },
    {
        "content": "<p>Well depends how opaque Smir is</p>",
        "id": 278716620,
        "sender_full_name": "Xavier Denis",
        "timestamp": 1649780520
    },
    {
        "content": "<p>Itâ€™s true that until this is the case I cannot realistically consider using it</p>",
        "id": 278716711,
        "sender_full_name": "Xavier Denis",
        "timestamp": 1649780548
    },
    {
        "content": "<p>But chalk is further along librarification than borrowck is</p>",
        "id": 278716747,
        "sender_full_name": "Xavier Denis",
        "timestamp": 1649780573
    },
    {
        "content": "<p>So that might be a more realistic goal in the medium term</p>",
        "id": 278716774,
        "sender_full_name": "Xavier Denis",
        "timestamp": 1649780589
    }
]