[
    {
        "content": "<p><a href=\"https://github.com/rust-lang/rust/issues/66159#issuecomment-550530324\">https://github.com/rust-lang/rust/issues/66159#issuecomment-550530324</a> popped up again in <a href=\"https://github.com/rust-lang/rust/pull/75176\">https://github.com/rust-lang/rust/pull/75176</a>:</p>\n<blockquote>\n<p>My gut feeling is that we probably need to stop capturing/cloning the resolver as we do here: <a href=\"https://github.com/rust-lang/rust/blob/master/src/librustdoc/core.rs#L346\">https://github.com/rust-lang/rust/blob/master/src/librustdoc/core.rs#L346</a> and instead try and find a resolver as part of the closure here: <a href=\"https://github.com/rust-lang/rust/blob/master/src/librustdoc/core.rs#L354\">https://github.com/rust-lang/rust/blob/master/src/librustdoc/core.rs#L354</a></p>\n<p>Of course, it looks like a <code>TyCtxt</code> has an immutable copy of the resolver's outputs, and no access to the resolver itself, urgh, and we have no easy way to inject changes into the context at this point.</p>\n</blockquote>\n<p>Is it feasible to store the resolver itself into the TyCtxt? I <a href=\"https://github.com/rust-lang/rust/compare/master...jyn514:no-clone?expand=1#diff-0de644786a2f1fd88c7d7f44bc3fa4bbR453\">tried calculating them separately</a> but it panicked with</p>\n<div class=\"codehilite\"><pre><span></span><code>thread &#39;rustc&#39; panicked at &#39;attempt to read from stolen value&#39;, /home/joshua/rustc/src/librustc_middle/ty/steal.rs:42:15\n</code></pre></div>",
        "id": 206891579,
        "sender_full_name": "Joshua Nelson",
        "timestamp": 1597370316
    }
]