[
    {
        "content": "<p>Hi <span class=\"user-group-mention\" data-user-group-id=\"897\">@T-compiler/meeting</span>! In about 30 minutes, we'll have our design meeting for this week. The theme is </p>\n<h1>Roadmap 2020</h1>\n<p>In some <a href=\"#narrow/stream/131828-t-compiler/topic/roadmap.20pre-discussion\" title=\"#narrow/stream/131828-t-compiler/topic/roadmap.20pre-discussion\">pre-discussion</a>, <span class=\"user-mention\" data-user-id=\"116083\">@pnkfelix</span> and I decided that the best place to start would be to focus on enumerating the <strong>biggest challenges</strong> that we see for rustc and the compiler team at this moment. These challenges can be technical but also organizational. </p>\n<p>We started a <a href=\"https://hackmd.io/JNRvANhJSwm6Zggq7CY0Vw\" target=\"_blank\" title=\"https://hackmd.io/JNRvANhJSwm6Zggq7CY0Vw\">hackmd document</a> that we will use to collect notes. We've seeded the document with <a href=\"https://hackmd.io/JNRvANhJSwm6Zggq7CY0Vw?view#Big-challenges-for-rustc-and-compiler-team\" target=\"_blank\" title=\"https://hackmd.io/JNRvANhJSwm6Zggq7CY0Vw?view#Big-challenges-for-rustc-and-compiler-team\">our initial thoughts on the biggest challenges</a>, but we'd like feedback from y'all. </p>\n<p>So, please: </p>\n<ul>\n<li>check out the <a href=\"https://hackmd.io/JNRvANhJSwm6Zggq7CY0Vw?view#Big-challenges-for-rustc-and-compiler-team\" target=\"_blank\" title=\"https://hackmd.io/JNRvANhJSwm6Zggq7CY0Vw?view#Big-challenges-for-rustc-and-compiler-team\">list of challenges</a></li>\n<li><a href=\"https://poll.ly/#/P76nbdyb\" target=\"_blank\" title=\"https://poll.ly/#/P76nbdyb\">vote</a> for the ones that you think are most urgent</li>\n<li>feel free to add your own items to the poll and (ideally) to the hackmd doc (where you can elaborate a ibt more)</li>\n</ul>\n<p>You can do this now, but we'll also spend a bit of time in the beginning of the meeting.</p>",
        "id": 177338334,
        "sender_full_name": "nikomatsakis",
        "timestamp": 1570195638
    },
    {
        "content": "<p>should we provide guidance as to how many votes people should use? I guess if someone <em>really</em> cares about sometnign they could make dummy accounts to vote more than once on an item</p>",
        "id": 177338728,
        "sender_full_name": "pnkfelix",
        "timestamp": 1570195922
    },
    {
        "content": "<p>/me frantically searches for their Tor scripts</p>",
        "id": 177338796,
        "sender_full_name": "eddyb",
        "timestamp": 1570195972
    },
    {
        "content": "<p>I had intended for it to be \"approval voting\" -- vote for as many as you like, once per item</p>",
        "id": 177341081,
        "sender_full_name": "nikomatsakis",
        "timestamp": 1570197562
    },
    {
        "content": "<p>but...</p>",
        "id": 177341087,
        "sender_full_name": "nikomatsakis",
        "timestamp": 1570197566
    },
    {
        "content": "<p>approval voting is probably fine</p>",
        "id": 177341297,
        "sender_full_name": "pnkfelix",
        "timestamp": 1570197713
    },
    {
        "content": "<p>I was vaguely wondering if we should encourage to vote for e.g. <em>half</em> of the topics</p>",
        "id": 177341361,
        "sender_full_name": "pnkfelix",
        "timestamp": 1570197734
    },
    {
        "content": "<p>(or \"at most half\")</p>",
        "id": 177341364,
        "sender_full_name": "pnkfelix",
        "timestamp": 1570197736
    },
    {
        "content": "<p>hi <span class=\"user-group-mention\" data-user-group-id=\"897\">@T-compiler/meeting</span>! It's 10:03am (at least here in Boston...) and that means it's time for....</p>\n<h1>Roadmap 2020 design meeting</h1>",
        "id": 177341432,
        "sender_full_name": "nikomatsakis",
        "timestamp": 1570197810
    },
    {
        "content": "<p>To start, let's have some </p>\n<h1>announcements</h1>",
        "id": 177341455,
        "sender_full_name": "nikomatsakis",
        "timestamp": 1570197840
    },
    {
        "content": "<p>the first \"announcement\" is about this meeting -- the plan for today (if you missed it) is to discuss <em>challenges</em>, and I have some <a href=\"#narrow/stream/131828-t-compiler/topic/design.20meeting.202019-10-04/near/177338334\" title=\"#narrow/stream/131828-t-compiler/topic/design.20meeting.202019-10-04/near/177338334\">notes above</a></p>",
        "id": 177341522,
        "sender_full_name": "nikomatsakis",
        "timestamp": 1570197873
    },
    {
        "content": "<p>in particular, people should be reading the <a href=\"https://hackmd.io/JNRvANhJSwm6Zggq7CY0Vw?view#Big-challenges-for-rustc-and-compiler-team\" target=\"_blank\" title=\"https://hackmd.io/JNRvANhJSwm6Zggq7CY0Vw?view#Big-challenges-for-rustc-and-compiler-team\">list of challenges</a> and <a href=\"https://poll.ly/#/P76nbdyb\" target=\"_blank\" title=\"https://poll.ly/#/P76nbdyb\">voting</a> -- feel free to add your own ideas!</p>",
        "id": 177341568,
        "sender_full_name": "nikomatsakis",
        "timestamp": 1570197909
    },
    {
        "content": "<p>(if you add your own ideas, make sure to put it on the voting page!)</p>",
        "id": 177341620,
        "sender_full_name": "pnkfelix",
        "timestamp": 1570197937
    },
    {
        "content": "<p>yep</p>",
        "id": 177341706,
        "sender_full_name": "nikomatsakis",
        "timestamp": 1570197975
    },
    {
        "content": "<p>the plan is to kind of use the votes to guide more detailed discussion, I thnk</p>",
        "id": 177341717,
        "sender_full_name": "nikomatsakis",
        "timestamp": 1570197989
    },
    {
        "content": "<p>ok, how are folks doing?</p>",
        "id": 177341928,
        "sender_full_name": "nikomatsakis",
        "timestamp": 1570198198
    },
    {
        "content": "<p>I may be the only one that added an item</p>",
        "id": 177341981,
        "sender_full_name": "pnkfelix",
        "timestamp": 1570198212
    },
    {
        "content": "<p>I see <span class=\"user-mention\" data-user-id=\"116083\">@pnkfelix</span> added \"paying for labor\" to the list (fyi)</p>",
        "id": 177341983,
        "sender_full_name": "nikomatsakis",
        "timestamp": 1570198213
    },
    {
        "content": "<p>/me almost spelled that \"labour\" -- what has become of me.</p>",
        "id": 177341992,
        "sender_full_name": "nikomatsakis",
        "timestamp": 1570198230
    },
    {
        "content": "<p>(and its arguably an item that belongs somewhere other than this meeting. i.e. this is not an issue for \"just\" 2020/2021)</p>",
        "id": 177342002,
        "sender_full_name": "pnkfelix",
        "timestamp": 1570198246
    },
    {
        "content": "<p>too much time spent reading about brexit or something</p>",
        "id": 177342004,
        "sender_full_name": "nikomatsakis",
        "timestamp": 1570198248
    },
    {
        "content": "<p>yeah, my sense is that it's not really something that belongs on the <em>compiler team roadmap</em> per se, but I'm always interested to hear about it, and I think it could inform other roadmaps</p>",
        "id": 177342041,
        "sender_full_name": "nikomatsakis",
        "timestamp": 1570198271
    },
    {
        "content": "<p>I think its a topic that we sometimes shy away from discussing</p>",
        "id": 177342067,
        "sender_full_name": "pnkfelix",
        "timestamp": 1570198299
    },
    {
        "content": "<p>and yet it seems vitally important ...</p>",
        "id": 177342079,
        "sender_full_name": "pnkfelix",
        "timestamp": 1570198309
    },
    {
        "content": "<p>(also, I want to repeat that people who <em>are</em> interested in contracting or in issuing contracts should contact me privately; I'm trying to get a better sense of what people are looking for and how we can try to connect people who want to issue contracts)</p>",
        "id": 177342081,
        "sender_full_name": "nikomatsakis",
        "timestamp": 1570198312
    },
    {
        "content": "<p>It would be nice to have more people working full time on the compiler</p>",
        "id": 177342115,
        "sender_full_name": "Esteban Küber",
        "timestamp": 1570198323
    },
    {
        "content": "<p>yeah</p>",
        "id": 177342164,
        "sender_full_name": "nikomatsakis",
        "timestamp": 1570198352
    },
    {
        "content": "<blockquote>\n<p>yeah, my sense is that it's not really something that belongs on the <em>compiler team roadmap</em> per se, but I'm always interested to hear about it, and I think it could inform other roadmaps</p>\n</blockquote>\n<p>to be clear this doesn't mean don't vote for it :)</p>",
        "id": 177342168,
        "sender_full_name": "nikomatsakis",
        "timestamp": 1570198358
    },
    {
        "content": "<p>ok let's get started</p>",
        "id": 177342177,
        "sender_full_name": "nikomatsakis",
        "timestamp": 1570198369
    },
    {
        "content": "<p>heh I like these votes</p>",
        "id": 177342197,
        "sender_full_name": "pnkfelix",
        "timestamp": 1570198385
    },
    {
        "content": "<p>the number one item in terms of problems by far is</p>\n<h1>compilation times remain stubbornly high</h1>",
        "id": 177342209,
        "sender_full_name": "nikomatsakis",
        "timestamp": 1570198397
    },
    {
        "content": "<p>(deleted)</p>",
        "id": 177342220,
        "sender_full_name": "pnkfelix",
        "timestamp": 1570198406
    },
    {
        "content": "<p>in the hackmd doc, I wrote the following</p>\n<ul>\n<li>many companies have huge codebases and compilation time can be an existential crisis</li>\n<li>\n<p>we feel this ourselves with bootstrapping<br>\n    * band-aids like \"factor librustc into finer grain crates\" might work; cannot be \"official answer\"</p>\n</li>\n<li>\n<p>incremental has helped but it's not like a 1-line change is 'instantaneous'</p>\n</li>\n<li>this bullet is talking about the time it takes to \"run tests\" and do full builds; it does NOT refer to the \"instantaneous feedback\" for things like completion, which falls under IDE</li>\n</ul>",
        "id": 177342228,
        "sender_full_name": "nikomatsakis",
        "timestamp": 1570198414
    },
    {
        "content": "<p>(well, I wrote some of that)</p>",
        "id": 177342253,
        "sender_full_name": "nikomatsakis",
        "timestamp": 1570198434
    },
    {
        "content": "<p>I wanted to add something around team growth, maybe it's a bit late already ...</p>",
        "id": 177342302,
        "sender_full_name": "Santiago Pastorino",
        "timestamp": 1570198446
    },
    {
        "content": "<p>ps I'm going to try and keep the <a href=\"https://hackmd.io/JNRvANhJSwm6Zggq7CY0Vw?edit\" target=\"_blank\" title=\"https://hackmd.io/JNRvANhJSwm6Zggq7CY0Vw?edit\">hackmd</a> up to date as we  go</p>",
        "id": 177342306,
        "sender_full_name": "nikomatsakis",
        "timestamp": 1570198449
    },
    {
        "content": "<blockquote>\n<p>I wanted to add something around team growth, maybe it's a bit late already ...</p>\n</blockquote>\n<p>go ahead and finish</p>",
        "id": 177342318,
        "sender_full_name": "nikomatsakis",
        "timestamp": 1570198463
    },
    {
        "content": "<p>the main question is -- I guess two-fold --</p>",
        "id": 177342324,
        "sender_full_name": "nikomatsakis",
        "timestamp": 1570198468
    },
    {
        "content": "<p>is there more to say about compilation time as a <em>problem</em> and do we want to kind of discuss some of what might be done to try and <em>address it</em>?</p>",
        "id": 177342345,
        "sender_full_name": "nikomatsakis",
        "timestamp": 1570198488
    },
    {
        "content": "<p>small note: incremental isn't all the way back to parsing, that could have a nice effect in theory, especially with pipelining and everything else<br>\nbut this is a significant thing to tackle and will likely not happen without coordination</p>",
        "id": 177342392,
        "sender_full_name": "eddyb",
        "timestamp": 1570198531
    },
    {
        "content": "<p>One thing that I think we never really successfully did</p>",
        "id": 177342412,
        "sender_full_name": "nikomatsakis",
        "timestamp": 1570198553
    },
    {
        "content": "<blockquote>\n<p>is there more to say about compilation time as a <em>problem</em> and do we want to kind of discuss some of what might be done to try and <em>address it</em>?</p>\n</blockquote>\n<p>is it worth differentiating bootstrap time from overall compile times ?</p>",
        "id": 177342415,
        "sender_full_name": "pnkfelix",
        "timestamp": 1570198557
    },
    {
        "content": "<p>obviously fixing the latter has a very broad effect</p>",
        "id": 177342465,
        "sender_full_name": "pnkfelix",
        "timestamp": 1570198568
    },
    {
        "content": "<p>is to establish clear benchmark(s) that we think is meaningful that we can measure and optimize for</p>",
        "id": 177342477,
        "sender_full_name": "nikomatsakis",
        "timestamp": 1570198574
    },
    {
        "content": "<blockquote>\n<p>I wanted to add something around team growth, maybe it's a bit late already ...</p>\n</blockquote>\n<p>added it and added to the voting board</p>",
        "id": 177342479,
        "sender_full_name": "Santiago Pastorino",
        "timestamp": 1570198575
    },
    {
        "content": "<blockquote>\n<p>is it worth differentiating bootstrap time from overall compile times ?</p>\n</blockquote>\n<p>yeah, let's talk about that a bit actually, I think that's a good question</p>",
        "id": 177342495,
        "sender_full_name": "nikomatsakis",
        "timestamp": 1570198589
    },
    {
        "content": "<p>but focusing on the former (bootstrap times) may yield better return in short- medium- term</p>",
        "id": 177342507,
        "sender_full_name": "pnkfelix",
        "timestamp": 1570198597
    },
    {
        "content": "<blockquote>\n<p>is to establish clear benchmark(s) that we think is meaningful that we can measure and optimize for</p>\n</blockquote>\n<p>getting a deja-vu, as if this has been said every year for the past 3-4 years</p>",
        "id": 177342527,
        "sender_full_name": "eddyb",
        "timestamp": 1570198615
    },
    {
        "content": "<p>exactly :P</p>",
        "id": 177342536,
        "sender_full_name": "nikomatsakis",
        "timestamp": 1570198621
    },
    {
        "content": "<p>we definitely have a set of benchmarks. dunno if its a <em>good</em> set</p>",
        "id": 177342583,
        "sender_full_name": "pnkfelix",
        "timestamp": 1570198652
    },
    {
        "content": "<p>but people use perf.rlo</p>",
        "id": 177342590,
        "sender_full_name": "pnkfelix",
        "timestamp": 1570198660
    },
    {
        "content": "<p>I do think that setting a strict goal of \"make the compiler itself bootstrap faster\" may be reasonable. It's likely to help other big projects out there, and it'll help us go faster too.</p>",
        "id": 177342591,
        "sender_full_name": "simulacrum",
        "timestamp": 1570198662
    },
    {
        "content": "<p>yeah, I think we've made great progress in the sense that perf.rlo has become much better</p>",
        "id": 177342654,
        "sender_full_name": "nikomatsakis",
        "timestamp": 1570198684
    },
    {
        "content": "<p>I thnk what i'm advocating for is picking specific crates/scenarios (maybe from that list!) and saying \"let's do that\" -- but indeed maybe bootstrapping is the right one to start with</p>",
        "id": 177342679,
        "sender_full_name": "nikomatsakis",
        "timestamp": 1570198712
    },
    {
        "content": "<p>I know that there's been a lot of attention paid to <em>CI</em> specifically and where time is spent</p>",
        "id": 177342699,
        "sender_full_name": "nikomatsakis",
        "timestamp": 1570198731
    },
    {
        "content": "<p>I feel like building rustc incrementally still feels prety slow a ot of the time, even if you use <code>--keep-stage</code></p>",
        "id": 177342740,
        "sender_full_name": "nikomatsakis",
        "timestamp": 1570198747
    },
    {
        "content": "<p>and of course that is tricky and confusing</p>",
        "id": 177342747,
        "sender_full_name": "nikomatsakis",
        "timestamp": 1570198752
    },
    {
        "content": "<p>so my first question would be something like \"incremental bootstrap most of all?\" (distinct from CI) and \"maybe find a way to make a (95%?) reliable, automatic keep-stage?\"</p>",
        "id": 177342778,
        "sender_full_name": "nikomatsakis",
        "timestamp": 1570198788
    },
    {
        "content": "<p>I personally think that my priorities would be:</p>\n<ol>\n<li>non incremental bootstrap</li>\n<li>incremental bootstrap</li>\n<li>keep stage improvements</li>\n</ol>",
        "id": 177342897,
        "sender_full_name": "simulacrum",
        "timestamp": 1570198841
    },
    {
        "content": "<p>interesting</p>",
        "id": 177342938,
        "sender_full_name": "nikomatsakis",
        "timestamp": 1570198867
    },
    {
        "content": "<p>in that order primarily because we're already really pretty fast at a check build on the compiler. codegen/LLVM time improvements are where we need to make the most improvement, largely, and that is shared between non-incr/incr</p>",
        "id": 177342968,
        "sender_full_name": "simulacrum",
        "timestamp": 1570198894
    },
    {
        "content": "<p>well, that depends</p>",
        "id": 177342993,
        "sender_full_name": "nikomatsakis",
        "timestamp": 1570198913
    },
    {
        "content": "<p>but that's interesting</p>",
        "id": 177343000,
        "sender_full_name": "nikomatsakis",
        "timestamp": 1570198921
    },
    {
        "content": "<p>(i.e., it's plausible that better codegen-unit distribution could help)</p>",
        "id": 177343045,
        "sender_full_name": "nikomatsakis",
        "timestamp": 1570198931
    },
    {
        "content": "<p>I know that e.g. <span class=\"user-mention\" data-user-id=\"120518\">@Eric Huss</span> has done some cool work on visualizing bootstrap/CI times, are those easily accessible?</p>",
        "id": 177343053,
        "sender_full_name": "nikomatsakis",
        "timestamp": 1570198939
    },
    {
        "content": "<p><a href=\"https://mark.rousskov.org/parallel-compiler-data/master/rustc-compiler-opt-timing.html\" target=\"_blank\" title=\"https://mark.rousskov.org/parallel-compiler-data/master/rustc-compiler-opt-timing.html\">https://mark.rousskov.org/parallel-compiler-data/master/rustc-compiler-opt-timing.html</a></p>",
        "id": 177343059,
        "sender_full_name": "simulacrum",
        "timestamp": 1570198944
    },
    {
        "content": "<p>anyway, we don't want to go in too deep technically probably</p>",
        "id": 177343060,
        "sender_full_name": "nikomatsakis",
        "timestamp": 1570198947
    },
    {
        "content": "<p>Maybe a good idea would be: come up with some concrete-ish goal (sounds like we have a candidate -- improve LLVM time around rustc bootstrap) and identify if there are any measurements needed to validate or guide that.</p>",
        "id": 177343143,
        "sender_full_name": "nikomatsakis",
        "timestamp": 1570199013
    },
    {
        "content": "<p>that editing a comment has the same effect as modifying a function wrt forcing recompilation is regularly a frustration — incremental still isn't fine-grained enough</p>",
        "id": 177343147,
        "sender_full_name": "varkor",
        "timestamp": 1570199016
    },
    {
        "content": "<p>that's where moving incremental all the way back to parsing would solve, I think</p>",
        "id": 177343260,
        "sender_full_name": "eddyb",
        "timestamp": 1570199087
    },
    {
        "content": "<p>do you think?</p>",
        "id": 177343281,
        "sender_full_name": "nikomatsakis",
        "timestamp": 1570199101
    },
    {
        "content": "<p>(tracked by <a href=\"https://github.com/rust-lang/rust/issues/47389\" target=\"_blank\" title=\"https://github.com/rust-lang/rust/issues/47389\">#47389</a>)</p>",
        "id": 177343292,
        "sender_full_name": "varkor",
        "timestamp": 1570199104
    },
    {
        "content": "<p>That's true -- in some sense, if we were better at incremental, then we could avoid codegen time. Right now even a \"comment edit\" means we re-codegen things I believe</p>",
        "id": 177343307,
        "sender_full_name": "simulacrum",
        "timestamp": 1570199111
    },
    {
        "content": "<p>it seems like <code>x.py build -i</code> <em>still</em> takes more time <code>x.py check</code></p>",
        "id": 177343310,
        "sender_full_name": "nikomatsakis",
        "timestamp": 1570199114
    },
    {
        "content": "<p>when all you've done is modify a comment</p>",
        "id": 177343320,
        "sender_full_name": "nikomatsakis",
        "timestamp": 1570199119
    },
    {
        "content": "<p>and I feel like that shouldn't be</p>",
        "id": 177343323,
        "sender_full_name": "nikomatsakis",
        "timestamp": 1570199122
    },
    {
        "content": "<p>but maybe that's not true</p>",
        "id": 177343330,
        "sender_full_name": "nikomatsakis",
        "timestamp": 1570199126
    },
    {
        "content": "<blockquote>\n<p>That's true -- in some sense, if we were better at incremental, then we could avoid codegen time. Right now even a \"comment edit\" means we re-codegen things I believe</p>\n</blockquote>\n<p>it <em>shouldn't</em> be true -- well, modulo spans, that may be part of it</p>",
        "id": 177343338,
        "sender_full_name": "nikomatsakis",
        "timestamp": 1570199140
    },
    {
        "content": "<p>Yeah this is \"buggy\" for the most part, not correct -- but I believe it is the state of the world today :)</p>",
        "id": 177343409,
        "sender_full_name": "simulacrum",
        "timestamp": 1570199179
    },
    {
        "content": "<p>still, it seems like what I can extract from this is maybe a few things</p>\n<ul>\n<li>bootstrap is worth focusing on</li>\n<li>\n<p>codegen time is a big deal<br>\n    * measurements suggest librustc is long pole in the tent, also</p>\n</li>\n<li>\n<p>incremental could be improved, e.g. measure/improve the \"edit comment\" use case</p>\n</li>\n</ul>",
        "id": 177343427,
        "sender_full_name": "nikomatsakis",
        "timestamp": 1570199198
    },
    {
        "content": "<p>should we turn to the next topic?</p>",
        "id": 177343477,
        "sender_full_name": "nikomatsakis",
        "timestamp": 1570199235
    },
    {
        "content": "<p>I guess it's two-part:</p>\n<ol>\n<li>don't do any work past the HIR when only a comment changed (targeted Span improvements may help)</li>\n<li>move incremental back so you don't need to spend entire seconds getting to HIR</li>\n</ol>",
        "id": 177343491,
        "sender_full_name": "eddyb",
        "timestamp": 1570199247
    },
    {
        "content": "<p>(Zulip really hates me right now, the lag is unbearable)</p>",
        "id": 177343529,
        "sender_full_name": "eddyb",
        "timestamp": 1570199271
    },
    {
        "content": "<p>next most voted was</p>\n<blockquote>\n<p>tech debt around the trait system</p>\n</blockquote>\n<p>and the text from the hackmd is</p>\n<blockquote>\n<ul>\n<li>\n<p>tech debt around the trait system</p>\n<ul>\n<li>blocking a lot of lang team progress (async fn in traits, GATs, specialization)</li>\n<li>\n<p>\"lazy normalization\"</p>\n<ul>\n<li>also maybe blocking const generics work</li>\n<li>also support for higher-ranked lifetimes etc remains a common place where you can hit ICEs that have no real fix</li>\n</ul>\n</li>\n<li>\n<p>possibly performance impact</p>\n</li>\n</ul>\n</li>\n</ul>\n</blockquote>",
        "id": 177343637,
        "sender_full_name": "nikomatsakis",
        "timestamp": 1570199311
    },
    {
        "content": "<p>(side note: does anyone know if there is a bug filed with zulip about their handling of bullet lists?! it seems to have regressed significantly...)</p>",
        "id": 177343673,
        "sender_full_name": "nikomatsakis",
        "timestamp": 1570199342
    },
    {
        "content": "<p>I think what might be helpful here would be to discuss this in more specific terms -- have I called out the right real goals, for example?</p>",
        "id": 177343728,
        "sender_full_name": "nikomatsakis",
        "timestamp": 1570199383
    },
    {
        "content": "<p>(It'd probably be good to prioritize somewhat within those, as well)</p>",
        "id": 177343750,
        "sender_full_name": "nikomatsakis",
        "timestamp": 1570199400
    },
    {
        "content": "<p>lazy norm also blocks any interesting usage of type/const parameters in const expressions inside types (e.g. <code>[u8; size_of::&lt;T&gt;()]</code> or <code>Foo&lt;{N + 1}&gt;</code>)<br>\n(note that this is <em>not</em> limited to const-generics, it includes things that work on stable when you have a concrete type instead of a type parameter!)</p>",
        "id": 177343947,
        "sender_full_name": "eddyb",
        "timestamp": 1570199514
    },
    {
        "content": "<p>So we could talk a bit about what's the problem there. We've made .. relatively little progress on this this year, though we have made some. I think a lot of that is because my time has been limited. This remains true, though in the last few weeks I've managed to block out bigger chunks of time.</p>",
        "id": 177344072,
        "sender_full_name": "nikomatsakis",
        "timestamp": 1570199576
    },
    {
        "content": "<p>It's also because there's just a lot to organize and it's hard to get traction</p>",
        "id": 177344080,
        "sender_full_name": "nikomatsakis",
        "timestamp": 1570199584
    },
    {
        "content": "<p>There's no want of folks interested</p>",
        "id": 177344086,
        "sender_full_name": "nikomatsakis",
        "timestamp": 1570199590
    },
    {
        "content": "<p>lazy norm, If i understand correctly, would also address the problem that right now we have various random iCE's that arise because we're missing <code>normalize()</code> calls at \"just the right places\"</p>",
        "id": 177344088,
        "sender_full_name": "pnkfelix",
        "timestamp": 1570199592
    },
    {
        "content": "<p>I think a lot of the problems from rustc recur in a microcosm</p>",
        "id": 177344097,
        "sender_full_name": "nikomatsakis",
        "timestamp": 1570199597
    },
    {
        "content": "<blockquote>\n<p>lazy norm, If i understand correctly, would also address the problem that right now we have various random iCE's that arise because we're missing <code>normalize()</code> calls at \"just the right places\"</p>\n</blockquote>\n<p>yes, that's a goal</p>",
        "id": 177344105,
        "sender_full_name": "nikomatsakis",
        "timestamp": 1570199604
    },
    {
        "content": "<blockquote>\n<p>I think a lot of the problems from rustc recur in a microcosm</p>\n</blockquote>\n<p>specifically, laying out designs and getting feedback</p>",
        "id": 177344112,
        "sender_full_name": "nikomatsakis",
        "timestamp": 1570199615
    },
    {
        "content": "<p>I had blocked out time today to try and setup (e.g.) a recurring \"design meeting\" where we focus on <em>some topic</em> each week and dig in deep</p>",
        "id": 177344179,
        "sender_full_name": "nikomatsakis",
        "timestamp": 1570199643
    },
    {
        "content": "<p>anyway, maybe going a bit deep for roadmap discussion :)</p>",
        "id": 177344206,
        "sender_full_name": "nikomatsakis",
        "timestamp": 1570199652
    },
    {
        "content": "<p>I'm just braindumping</p>",
        "id": 177344210,
        "sender_full_name": "nikomatsakis",
        "timestamp": 1570199655
    },
    {
        "content": "<p>one thing I will say is that iterating with rust-analyzer has been good and exposed various weaknesses</p>",
        "id": 177344261,
        "sender_full_name": "nikomatsakis",
        "timestamp": 1570199717
    },
    {
        "content": "<p>but one of the hard things to balance is \"incremental progress on existing system\" and \"chalk\"</p>",
        "id": 177344279,
        "sender_full_name": "nikomatsakis",
        "timestamp": 1570199732
    },
    {
        "content": "<p>should we plan to discuss, in some future meeting, whether we want to focus on swapping in a new trait subsystem (chalk) or try to ...</p>",
        "id": 177344286,
        "sender_full_name": "pnkfelix",
        "timestamp": 1570199739
    },
    {
        "content": "<p>okay yeah you just summarized it</p>",
        "id": 177344295,
        "sender_full_name": "pnkfelix",
        "timestamp": 1570199750
    },
    {
        "content": "<p>the last time the wg-traits went deep on that topic, we concluded that it would be hard to upgade existing system to realy solve e.g. gats</p>",
        "id": 177344364,
        "sender_full_name": "nikomatsakis",
        "timestamp": 1570199772
    },
    {
        "content": "<p>however, I think that for lazy norm it is plausible (and I was planning to put time into exploring that today)</p>",
        "id": 177344384,
        "sender_full_name": "nikomatsakis",
        "timestamp": 1570199790
    },
    {
        "content": "<p>thinking back on NLL, we got a lot of leverage from moving to MIR-borrowck. But even there, we did <em>not</em> go whole hog on trying to swap in polonius</p>",
        "id": 177344389,
        "sender_full_name": "pnkfelix",
        "timestamp": 1570199797
    },
    {
        "content": "<p>So I don't actually know what that analogy tells us</p>",
        "id": 177344418,
        "sender_full_name": "pnkfelix",
        "timestamp": 1570199813
    },
    {
        "content": "<p>How <em>long</em>, or how much man power, would you say have invested in trying to upgrade existing system?</p>",
        "id": 177344520,
        "sender_full_name": "pnkfelix",
        "timestamp": 1570199887
    },
    {
        "content": "<p>ok I don't feel like \"new information\" is coming to light here, next topic? :)</p>",
        "id": 177344522,
        "sender_full_name": "nikomatsakis",
        "timestamp": 1570199887
    },
    {
        "content": "<p>(let me know if I'm rail-roading...)</p>",
        "id": 177344546,
        "sender_full_name": "nikomatsakis",
        "timestamp": 1570199906
    },
    {
        "content": "<p>Well wait, I don't know what we've concluded from this. Is it just that we all agree that this is a challenge?</p>",
        "id": 177344549,
        "sender_full_name": "pnkfelix",
        "timestamp": 1570199909
    },
    {
        "content": "<p>heh indeed I don't think we concluded much</p>",
        "id": 177344585,
        "sender_full_name": "nikomatsakis",
        "timestamp": 1570199927
    },
    {
        "content": "<p>well ok so</p>",
        "id": 177344620,
        "sender_full_name": "nikomatsakis",
        "timestamp": 1570199960
    },
    {
        "content": "<p>I think a good goal for the year for traits would be</p>",
        "id": 177344629,
        "sender_full_name": "nikomatsakis",
        "timestamp": 1570199968
    },
    {
        "content": "<p>sorry, let me rephrase that</p>",
        "id": 177344638,
        "sender_full_name": "nikomatsakis",
        "timestamp": 1570199976
    },
    {
        "content": "<p>if the answer is just: \"we should have a follow-up meeting to discuss traits challenges\", I'm okay with that conclusion</p>",
        "id": 177344654,
        "sender_full_name": "pnkfelix",
        "timestamp": 1570199988
    },
    {
        "content": "<p>I think a good <em>immediate</em> goal would be to kind of decide the extent to which we will go \"all in\" on chalk next year -- and what we will try to solve on existing system first</p>",
        "id": 177344720,
        "sender_full_name": "nikomatsakis",
        "timestamp": 1570200007
    },
    {
        "content": "<p>and I think we should make <em>that</em> exploration our main immediate goal, and try to propose a more concrete plan in (say) a month or so, which might indeed make it onto the roadmap</p>",
        "id": 177344784,
        "sender_full_name": "nikomatsakis",
        "timestamp": 1570200040
    },
    {
        "content": "<p>or just be useful :)</p>",
        "id": 177344796,
        "sender_full_name": "nikomatsakis",
        "timestamp": 1570200045
    },
    {
        "content": "<p>we have gained some new data in this regard (thanks e.g. to r-a exploration but also a few other things)</p>",
        "id": 177344836,
        "sender_full_name": "nikomatsakis",
        "timestamp": 1570200080
    },
    {
        "content": "<p><del>I'm not sure even sure lazy normalization for type-level constant expressions is that tied to traits, tbh</del></p>\n<p><em>nevermind</em> the problem is lazy normalization for everything is needed to break cycles that happen to affect constant expressions in particular, my memory is just bad</p>",
        "id": 177344973,
        "sender_full_name": "eddyb",
        "timestamp": 1570200144
    },
    {
        "content": "<p>(deleted)</p>",
        "id": 177345023,
        "sender_full_name": "eddyb",
        "timestamp": 1570200178
    },
    {
        "content": "<p>let's move to another thing, but I think I agree</p>",
        "id": 177345095,
        "sender_full_name": "nikomatsakis",
        "timestamp": 1570200214
    },
    {
        "content": "<p>or at least I think that we can make progress around there :)</p>",
        "id": 177345115,
        "sender_full_name": "nikomatsakis",
        "timestamp": 1570200225
    },
    {
        "content": "<p>next most voted:</p>\n<ul>\n<li>paying for labor\n*</li>\n</ul>",
        "id": 177345220,
        "sender_full_name": "nikomatsakis",
        "timestamp": 1570200260
    },
    {
        "content": "<ul>\n<li>paying for labor<br>\n    * we rely on volunteers for vast majority of coding effort<br>\n    * some of this is coding done while \"on the clock\" for some boss, with that boss's blessing<br>\n    * (there are also contract laborers, financed by companies with specific needs)<br>\n    * is this model of compensation going to suffice going forward?</li>\n</ul>",
        "id": 177345286,
        "sender_full_name": "nikomatsakis",
        "timestamp": 1570200299
    },
    {
        "content": "<p>I'd be curious to hear what \"upvoters\" were expressing, because I could see many things to talk about here</p>",
        "id": 177345331,
        "sender_full_name": "nikomatsakis",
        "timestamp": 1570200326
    },
    {
        "content": "<blockquote>\n<p>if the answer is just: \"we should have a follow-up meeting to discuss traits challenges\", I'm okay with that conclusion</p>\n</blockquote>\n<p>I wrote this btw as the 'traits conclusion'</p>\n<ul>\n<li>conclusion:<br>\n    * we need most of all a clear roadmap here, and that should be an immediate focus<br>\n    * good to try and separate out lazy normalization from other goals</li>\n</ul>",
        "id": 177345455,
        "sender_full_name": "nikomatsakis",
        "timestamp": 1570200380
    },
    {
        "content": "<p>i posed the \"pay for labor\" topic because it strikes me as a potential existential threat. nrc quipped years ago that (paraphrasing) we'll be fine without more compiler developers, but without users Rust is dead in the water.</p>",
        "id": 177345489,
        "sender_full_name": "pnkfelix",
        "timestamp": 1570200405
    },
    {
        "content": "<p>I believed that at the time. But I think now we have more users.</p>",
        "id": 177345507,
        "sender_full_name": "pnkfelix",
        "timestamp": 1570200420
    },
    {
        "content": "<p>I guess I can give my current perspective</p>",
        "id": 177345518,
        "sender_full_name": "nikomatsakis",
        "timestamp": 1570200428
    },
    {
        "content": "<p>So much paradoxes here.<br>\n- Full-time employed people often work for sprint goals and reports rather than quality.<br>\n- Some people that are supposed to be full-time employed appear and do something like once a month and busy with something unobservable the rest of the time.</p>",
        "id": 177345592,
        "sender_full_name": "Vadim Petrochenkov",
        "timestamp": 1570200474
    },
    {
        "content": "<p>I think we may well make progress on some sort of foundation, but I don't think it will hire a lot of compiler devs. I think the situation we really want is to have more companies doing funding in more diverse ways.</p>",
        "id": 177345666,
        "sender_full_name": "nikomatsakis",
        "timestamp": 1570200492
    },
    {
        "content": "<p>One thing I've been thinking a lot about</p>",
        "id": 177345697,
        "sender_full_name": "nikomatsakis",
        "timestamp": 1570200513
    },
    {
        "content": "<p>is how we as a team can help to connect people with grants/contracting and make it easy for people to get grants or contracts</p>",
        "id": 177345717,
        "sender_full_name": "nikomatsakis",
        "timestamp": 1570200525
    },
    {
        "content": "<p>so as an example, I've wondered if</p>",
        "id": 177345725,
        "sender_full_name": "nikomatsakis",
        "timestamp": 1570200529
    },
    {
        "content": "<p>when we come up with projects</p>",
        "id": 177345731,
        "sender_full_name": "nikomatsakis",
        "timestamp": 1570200532
    },
    {
        "content": "<blockquote>\n<p>- Some people that are supposed to be full-time employed appear and do something like once a month and busy with something unobservable the rest of the time.</p>\n</blockquote>\n<p>sounds like something that keeps happening to me and I did want to bring up a related thing</p>",
        "id": 177345764,
        "sender_full_name": "eddyb",
        "timestamp": 1570200552
    },
    {
        "content": "<p>if we can describe the steps needed, that could help people develop a grant application to work on it, etc. But that's also kind of a lot of work (but also very similar to the work of mentoring, so...)</p>",
        "id": 177345835,
        "sender_full_name": "nikomatsakis",
        "timestamp": 1570200591
    },
    {
        "content": "<p>/me stops</p>",
        "id": 177345845,
        "sender_full_name": "nikomatsakis",
        "timestamp": 1570200599
    },
    {
        "content": "<blockquote>\n<p>Full-time employed people often work for sprint goals and reports rather than quality.</p>\n</blockquote>\n<p><span class=\"user-mention\" data-user-id=\"123856\">@Vadim Petrochenkov</span> are you saying here that it would be a bad idea to try to figure out compensation systems, because it would open up people trying to game the system to get the money?</p>",
        "id": 177346048,
        "sender_full_name": "pnkfelix",
        "timestamp": 1570200691
    },
    {
        "content": "<p>due to the haphazard work distribution, I can end up trying to do up to a dozen things at a time and humans aren't known for their excellent multitasking skills</p>",
        "id": 177346074,
        "sender_full_name": "eddyb",
        "timestamp": 1570200703
    },
    {
        "content": "<p>I've noticed I do much better on single shorter-term focused projects, but even then there's some amount of getting dragged into a different part of rustc instead of focusing on the contract</p>",
        "id": 177346167,
        "sender_full_name": "eddyb",
        "timestamp": 1570200739
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"123856\">@Vadim Petrochenkov</span> or was that more a general statement about the kinds of work you see (either here or across FOSS) when comparing paid- vs volunteer effort ?</p>",
        "id": 177346205,
        "sender_full_name": "pnkfelix",
        "timestamp": 1570200771
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"116083\">@pnkfelix</span> <br>\nNah, it's more that people are overloaded and often have to do what they <em>have to</em> rather than want to.</p>",
        "id": 177346225,
        "sender_full_name": "Vadim Petrochenkov",
        "timestamp": 1570200781
    },
    {
        "content": "<p>Taking shortcuts and decreasing the quality.</p>",
        "id": 177346261,
        "sender_full_name": "Vadim Petrochenkov",
        "timestamp": 1570200808
    },
    {
        "content": "<p>I have no idea what the solution is but I feel like the resources available would be more effectively used if we planned for it better. I guess I'm just rambling here</p>",
        "id": 177346301,
        "sender_full_name": "eddyb",
        "timestamp": 1570200831
    },
    {
        "content": "<p>doesn't that also depends on the goals you may have in a contract?</p>",
        "id": 177346309,
        "sender_full_name": "Santiago Pastorino",
        "timestamp": 1570200834
    },
    {
        "content": "<p>i see, the \"have to\" there is as in, what's good for the employee rather than what's good for the project itself.</p>",
        "id": 177346310,
        "sender_full_name": "pnkfelix",
        "timestamp": 1570200834
    },
    {
        "content": "<blockquote>\n<p>due to the haphazard work distribution, I can end up trying to do up to a dozen things at a time and humans aren't known for their excellent multitasking skills</p>\n</blockquote>\n<p>yes this</p>",
        "id": 177346363,
        "sender_full_name": "nikomatsakis",
        "timestamp": 1570200845
    },
    {
        "content": "<p>(These are the reasons why I'm personally afraid that if I turn the hobby into a job and start contracting I immediately lose all the motivation and productivity and leave the project soon.)</p>",
        "id": 177346422,
        "sender_full_name": "Vadim Petrochenkov",
        "timestamp": 1570200889
    },
    {
        "content": "<p>OK, well, we're coming in at 55 minutes</p>",
        "id": 177346476,
        "sender_full_name": "nikomatsakis",
        "timestamp": 1570200923
    },
    {
        "content": "<blockquote>\n<p>(These are the reasons why I'm personally afraid that if I turn the hobby into a job and start contracting I immediately lose all the motivation and productivity and leave the project soon.)</p>\n</blockquote>\n<p>I feel completely the opposite tbh, if I can turn a hobby into my day to day job I'd feel realization</p>",
        "id": 177346544,
        "sender_full_name": "Santiago Pastorino",
        "timestamp": 1570200962
    },
    {
        "content": "<p>I voted for it because I would jump at the opportunity to work on rustc full time (though, if such a position existed, there are far more qualified people that should get it first), but nothing like that exists. Contracting doesn't appeal as much to me as full-time employment.</p>",
        "id": 177346595,
        "sender_full_name": "davidtwco",
        "timestamp": 1570200968
    },
    {
        "content": "<p>Yeah, that makes sense.</p>",
        "id": 177346711,
        "sender_full_name": "nikomatsakis",
        "timestamp": 1570201045
    },
    {
        "content": "<p>tbqh, Rust hasn't gotten much <em>specific</em> from me being paid, with some small exceptions (like the Rust 2018 crunch) - to the extent that it would be more honest to have the contract say \"do things around rustc for one more year\"</p>",
        "id": 177346722,
        "sender_full_name": "eddyb",
        "timestamp": 1570201052
    },
    {
        "content": "<p>so we should maybe try to figure out, about goals (wrt contracting):</p>\n<ul>\n<li>how much do they actually work?</li>\n<li>where/why don't they?</li>\n</ul>",
        "id": 177346815,
        "sender_full_name": "eddyb",
        "timestamp": 1570201089
    },
    {
        "content": "<p>are there some conclusions we can draw from this? :)</p>",
        "id": 177346820,
        "sender_full_name": "nikomatsakis",
        "timestamp": 1570201092
    },
    {
        "content": "<p>well: Is paying for labor a challenge we need to worry about in <em>short term</em> (as in, next year, or even next two years)</p>",
        "id": 177346871,
        "sender_full_name": "pnkfelix",
        "timestamp": 1570201125
    },
    {
        "content": "<p>I'm tempted to say, based on gut feeling, that the status quo will suffice for now</p>",
        "id": 177346929,
        "sender_full_name": "pnkfelix",
        "timestamp": 1570201152
    },
    {
        "content": "<p>but I think we should nonetheless discuss it on occasion going forward</p>",
        "id": 177346989,
        "sender_full_name": "pnkfelix",
        "timestamp": 1570201189
    },
    {
        "content": "<p>Yeah. I also do think this will be a theme that the project as a whole should be working on, and it's helpful to keep talking about it.</p>",
        "id": 177347004,
        "sender_full_name": "nikomatsakis",
        "timestamp": 1570201199
    },
    {
        "content": "<p>(I approve of bringing it out into the open, regardless)</p>",
        "id": 177347076,
        "sender_full_name": "nikomatsakis",
        "timestamp": 1570201209
    },
    {
        "content": "<p>i would be interested to know</p>",
        "id": 177347109,
        "sender_full_name": "pnkfelix",
        "timestamp": 1570201230
    },
    {
        "content": "<p>about people who did were volunteers and then had to stop due to their jobs</p>",
        "id": 177347132,
        "sender_full_name": "pnkfelix",
        "timestamp": 1570201241
    },
    {
        "content": "<p>Such as students who were able to participate but then lacked time/will after getting gainful employment.</p>",
        "id": 177347182,
        "sender_full_name": "pnkfelix",
        "timestamp": 1570201268
    },
    {
        "content": "<p>Basically I'm curious how many of those we've had, and whether we could have done something to keep them engaged in project.</p>",
        "id": 177347213,
        "sender_full_name": "pnkfelix",
        "timestamp": 1570201286
    },
    {
        "content": "<p>but its not a data-set I'm prepared to acquire in -1 minutes remaining in meeting</p>",
        "id": 177347252,
        "sender_full_name": "pnkfelix",
        "timestamp": 1570201314
    },
    {
        "content": "<p>OK, well, I guess that's a wrap</p>",
        "id": 177347426,
        "sender_full_name": "nikomatsakis",
        "timestamp": 1570201410
    },
    {
        "content": "<p>TBH my main take-away from this meeting is that the problems we identified are the main ones :)</p>",
        "id": 177347455,
        "sender_full_name": "nikomatsakis",
        "timestamp": 1570201428
    },
    {
        "content": "<p>I guess i'll highlight this</p>",
        "id": 177347545,
        "sender_full_name": "nikomatsakis",
        "timestamp": 1570201469
    },
    {
        "content": "<ul>\n<li>maintenance and triage work<br>\n    * we do a decent job of keeping up with work but work burden is unevenly distributed<br>\n    * non-urgent / non-regression bugs can \"pile up\" -- are we making progress on them?<br>\n    * (note absence of data here; maybe we <em>are</em> keeping up, relative to bug-report rate and/or bugs that actually matter...)<br>\n        * (simulacrum): we are not really keeping up<br>\n        * long-term trend is up; most current issues are fairly recently triaged,<br>\n          count has been going up: ~3000 last summer, up to 4900 now. Not all compiler team, but \"most\".</li>\n</ul>",
        "id": 177347547,
        "sender_full_name": "nikomatsakis",
        "timestamp": 1570201470
    },
    {
        "content": "<p>looking back over the docs, <span class=\"user-mention\" data-user-id=\"116122\">@simulacrum</span>'s comment is interesting</p>",
        "id": 177347562,
        "sender_full_name": "nikomatsakis",
        "timestamp": 1570201482
    },
    {
        "content": "<p>anyway, I gotta run, thanks &lt;3 for participating</p>",
        "id": 177347569,
        "sender_full_name": "nikomatsakis",
        "timestamp": 1570201488
    }
]