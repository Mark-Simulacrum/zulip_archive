[
    {
        "content": "<p>Hey <span class=\"user-mention\" data-user-id=\"232957\">@Jack Huey</span>  do you think you’ll get a chance in the near future to follow up on <a href=\"https://github.com/rust-lang/rust/issues/89639\">#89639</a>? If not, I’m happy to take a stab at it for you. (I tend to make debug builds locally, and thus I end up hitting issues like this when I run the test suite.)</p>",
        "id": 257218830,
        "sender_full_name": "pnkfelix",
        "timestamp": 1634051371
    },
    {
        "content": "<p>I can open up a PR later today, but I'm pretty confident it just needs the + and - terms to be switched</p>",
        "id": 257219106,
        "sender_full_name": "Jack Huey",
        "timestamp": 1634051479
    },
    {
        "content": "<p>Okay, great. Let me know if you run out of time.</p>",
        "id": 257219243,
        "sender_full_name": "pnkfelix",
        "timestamp": 1634051528
    },
    {
        "content": "<p>I wonder if it makes sense to enable debug assertions on some of the merge tests</p>",
        "id": 257219363,
        "sender_full_name": "Joshua Nelson",
        "timestamp": 1634051591
    },
    {
        "content": "<p>I think someone linked a proposal to enable <em>just</em> the overflow checks in CI</p>",
        "id": 257219422,
        "sender_full_name": "pnkfelix",
        "timestamp": 1634051617
    },
    {
        "content": "<p>The Linux builders don't take much time compared to the apple ones</p>",
        "id": 257219437,
        "sender_full_name": "Joshua Nelson",
        "timestamp": 1634051620
    },
    {
        "content": "<p>but I would definitely like <em>one</em> debug-enabled CI. I think I’ve suggested it a number of times.</p>",
        "id": 257219530,
        "sender_full_name": "pnkfelix",
        "timestamp": 1634051644
    },
    {
        "content": "<p>(did I make an MCP for it? I cannot remember.)</p>",
        "id": 257219570,
        "sender_full_name": "pnkfelix",
        "timestamp": 1634051660
    },
    {
        "content": "<p><a href=\"https://github.com/rust-lang/rust/pull/89776\">CI: Enable overflow checks for test (non-dist) builds</a></p>",
        "id": 257219686,
        "sender_full_name": "Urgau",
        "timestamp": 1634051716
    },
    {
        "content": "<p>I actually am just going to open a PR now</p>",
        "id": 257219760,
        "sender_full_name": "Jack Huey",
        "timestamp": 1634051754
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"116083\">@pnkfelix</span> I'll r? you</p>",
        "id": 257219775,
        "sender_full_name": "Jack Huey",
        "timestamp": 1634051761
    },
    {
        "content": "<p>running stage1 instead 2 for debug might be enough?</p>",
        "id": 257219909,
        "sender_full_name": "The 8472",
        "timestamp": 1634051815
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"116083\">@pnkfelix</span> you made an MCP for testing stage1, I don't think you mentioned debug assertions</p>",
        "id": 257223874,
        "sender_full_name": "Joshua Nelson",
        "timestamp": 1634053287
    },
    {
        "content": "<p>I opened the overflow checks PR (as a delayed follow-up to adding the options in <a href=\"https://github.com/rust-lang/rust/issues/87784\">#87784</a>). Debug assertions are already enabled for all non-dist non-Apple builds so I think after enabling overflow checks we essentially have full debug CIs?</p>",
        "id": 257233280,
        "sender_full_name": "Hans Kratz",
        "timestamp": 1634056742
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"407656\">Hans Kratz</span> <a href=\"#narrow/stream/131828-t-compiler/topic/overflow.20checks.20asserting.20in.20rustc.20.2389639/near/257233280\">said</a>:</p>\n<blockquote>\n<p>I opened the overflow checks PR (as a delayed follow-up to adding the options in <a href=\"https://github.com/rust-lang/rust/issues/87784\">#87784</a>). Debug assertions are already enabled for all non-dist non-Apple builds so I think after enabling overflow checks we essentially have full debug CIs?</p>\n</blockquote>\n<p>from discussion on <a href=\"https://github.com/rust-lang/rust/issues/73288\">#73288</a>, namely <a href=\"https://github.com/rust-lang/rust/issues/73288#issuecomment-643556753\">this comment</a>, I think we need to go a step further and have a build where <code>libstd</code> itself is built with debug assertions?</p>",
        "id": 257234604,
        "sender_full_name": "pnkfelix",
        "timestamp": 1634057287
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"116083\">pnkfelix</span> <a href=\"#narrow/stream/131828-t-compiler/topic/overflow.20checks.20asserting.20in.20rustc.20.2389639/near/257234604\">said</a>:</p>\n<blockquote>\n<p>from discussion on <a href=\"https://github.com/rust-lang/rust/issues/73288\">#73288</a>, namely <a href=\"https://github.com/rust-lang/rust/issues/73288#issuecomment-643556753\">this comment</a>, I think we need to go a step further and have a build where <code>libstd</code> itself is built with debug assertions?</p>\n</blockquote>\n<p>AFAICS std is already built with debug assertions. The <a href=\"https://github.com/rust-lang/rust/blob/9475e609b8458fff9e444934a6017d2e590642cf/src/bootstrap/config.rs#L982\">default</a> for <code>rust.debug-assertions-std</code> is <code>rust.debug-assertions</code> which seems to be already <a href=\"https://github.com/rust-lang/rust/blob/9475e609b8458fff9e444934a6017d2e590642cf/src/ci/run.sh#L89\">enabled for non-dist non-apple builds</a>.</p>",
        "id": 257236511,
        "sender_full_name": "Hans Kratz",
        "timestamp": 1634058017
    },
    {
        "content": "<p>Hmm. I had thought there was still a recurring issue where my local attempts to build with <code>debug=true</code> would not pass the test suite. (And I still suspect I do run into that.) But its possible my issues are apple-specific (though I had thought they plauged other targets as well.)</p>",
        "id": 257679063,
        "sender_full_name": "pnkfelix",
        "timestamp": 1634295376
    },
    {
        "content": "<p>But the evidence presented by <span class=\"user-mention\" data-user-id=\"407656\">@Hans Kratz</span> seems to indicate that there is at least an <em>intent</em> to have some CI’s that build with debug-assertions turned on. That’s not necessarily everything that <em>I</em> want (since I often want debuginfo too), but it sounds better than what I had thought the status quo was.</p>",
        "id": 257679126,
        "sender_full_name": "pnkfelix",
        "timestamp": 1634295431
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"116083\">pnkfelix</span> <a href=\"#narrow/stream/131828-t-compiler/topic/overflow.20checks.20asserting.20in.20rustc.20.2389639/near/257679063\">said</a>:</p>\n<blockquote>\n<p>Hmm. I had thought there was still a recurring issue where my local attempts to build with <code>debug=true</code> would not pass the test suite. (And I still suspect I do run into that.) But its possible my issues are apple-specific (though I had thought they plauged other targets as well.)</p>\n</blockquote>\n<p>Macos Intel or Macos ARM? There were a few Macos ARM-specific issues. I fixed/worked around some of those, for the latest one I submitted a PR earlier today:</p>\n<ul>\n<li><a href=\"https://github.com/rust-lang/rust/issues/89170\">#89170</a> (merged)</li>\n<li><a href=\"https://github.com/rust-lang/rust/issues/89171\">#89171</a> (merged)</li>\n<li><a href=\"https://github.com/rust-lang/rust/issues/89902\">#89902</a> (submitted today)</li>\n</ul>\n<p>With that last one fixed <code>./x.py test --stage 2</code> passes for me locally on an M1 mac with <code>debug = true</code> + <code>overflow-checks = true</code>.</p>",
        "id": 257689994,
        "sender_full_name": "Hans Kratz",
        "timestamp": 1634301223
    },
    {
        "content": "<p>Mac OS Intel, at the moment</p>",
        "id": 257694432,
        "sender_full_name": "pnkfelix",
        "timestamp": 1634303218
    },
    {
        "content": "<p>but, like, here is my latest instance of a <code>debug=true</code> problem</p>",
        "id": 257694475,
        "sender_full_name": "pnkfelix",
        "timestamp": 1634303240
    },
    {
        "content": "<p>(this time on Linux)</p>",
        "id": 257694485,
        "sender_full_name": "pnkfelix",
        "timestamp": 1634303244
    },
    {
        "content": "<p>\"reproducible-build-2 fails if debug=true (on Linux this time)” <a href=\"https://github.com/rust-lang/rust/issues/89911\">#89911</a></p>",
        "id": 257694499,
        "sender_full_name": "pnkfelix",
        "timestamp": 1634303251
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"116083\">pnkfelix</span> <a href=\"#narrow/stream/131828-t-compiler/topic/overflow.20checks.20asserting.20in.20rustc.20.2389639/near/257219530\">said</a>:</p>\n<blockquote>\n<p>but I would definitely like <em>one</em> debug-enabled CI. I think I’ve suggested it a number of times.</p>\n</blockquote>\n<p>its possible that I wasn’t clear about what I was asking for when I said this. I believe that <code>debug=true</code> is a broader change than just turning on debug-assertions...</p>",
        "id": 257694622,
        "sender_full_name": "pnkfelix",
        "timestamp": 1634303305
    }
]