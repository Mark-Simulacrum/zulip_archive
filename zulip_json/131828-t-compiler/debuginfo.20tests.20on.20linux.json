[
    {
        "content": "<p>I see failures here:</p>\n<div class=\"codehilite\"><pre><span></span><code>failures:\n    [debuginfo-gdb] debuginfo/function-names.rs\n</code></pre></div>\n<p>Any idea what's going on, dear rustc world?</p>",
        "id": 253812195,
        "sender_full_name": "nikomatsakis",
        "timestamp": 1631915392
    },
    {
        "content": "<div class=\"codehilite\"><pre><span></span><code>---- [debuginfo-gdb] debuginfo/function-names.rs stdout ----\nNOTE: compiletest thinks it is using GDB with native rust support\nNOTE: compiletest thinks it is using GDB version 10001090\n\nerror: line not found in debugger output: [...]static fn function_names::generic_func(i32) -&gt; i32;\nstatus: exit status: 0\ncommand: &quot;/usr/bin/gdb&quot; &quot;-quiet&quot; &quot;-batch&quot; &quot;-nx&quot; &quot;-command=/home/nmatsakis/versioned/rust-5/build/x86_64-unknown-linux-gnu/test/debuginfo/function-names.gdb/function-names.debugger.script&quot;\nstdout:\n------------------------------------------\nGNU gdb (Debian 10.1-1.7) 10.1.90.20210103-git\nCopyright (C) 2021 Free Software Foundation, Inc.\nLicense GPLv3+: GNU GPL version 3 or later &lt;http://gnu.org/licenses/gpl.html&gt;\nThis is free software: you are free to change and redistribute it.\nThere is NO WARRANTY, to the extent permitted by law.\nType &quot;show copying&quot; and &quot;show warranty&quot; for details.\nThis GDB was configured as &quot;x86_64-linux-gnu&quot;.\nType &quot;show configuration&quot; for configuration details.\nFor bug reporting instructions, please see:\n&lt;https://www.gnu.org/software/gdb/bugs/&gt;.\nFind the GDB manual and other documentation resources online at:\n    &lt;http://www.gnu.org/software/gdb/documentation/&gt;.\n\nFor help, type &quot;help&quot;.\nType &quot;apropos word&quot; to search for commands related to &quot;word&quot;.\n\nFile /home/nmatsakis/versioned/rust-5/src/test/debuginfo/function-names.rs:\n92:     static fn function_names::main();\n109:    static fn function_names::main::{closure#0}(*mut function_names::main::{closure#0});\n113:    static fn function_names::main::{generator#1}(core::pin::Pin&lt;&amp;mut function_names::main::{generator#1}&gt;, ()) -&gt; core::ops::generator::GeneratorState;\n\nFile /home/nmatsakis/versioned/rust-5/src/test/debuginfo/function-names.rs:\n192:    static fn function_names::generic_func::{closure#0}&lt;i32&gt;(*mut function_names::generic_func::{closure#0});\n190:    static fn function_names::generic_func&lt;i32&gt;(i32) -&gt; i32;\n\nFile /home/nmatsakis/versioned/rust-5/src/test/debuginfo/function-names.rs:\n158:    static fn function_names::GenericStruct&lt;i32, i32&gt;::impl_function&lt;i32, i32&gt;();\n146:    static fn function_names::Mod1::TestStruct2::impl_function();\n130:    static fn function_names::TestStruct1::impl_function();\n160:    static fn function_names::{impl#2}::impl_function::{closure#0}&lt;i32, i32&gt;(*mut function_names::{impl#2}::impl_function::{closure#0});\n\nFile /home/nmatsakis/versioned/rust-5/src/test/debuginfo/function-names.rs:\n150:    static fn function_names::Mod1::{impl#1}::trait_function();\n135:    static fn function_names::{impl#1}::trait_function();\n167:    static fn function_names::{impl#3}::trait_function&lt;i32&gt;();\n181:    static fn function_names::{impl#5}::trait_function3&lt;function_names::TestStruct1&gt;();\n186:    static fn function_names::{impl#6}::trait_function&lt;i32, 1&gt;();\n\nFile /home/nmatsakis/versioned/rust-5/src/test/debuginfo/function-names.rs:\n198:    static fn function_names::const_generic_fn_bool&lt;false&gt;();\n199:    static fn function_names::const_generic_fn_non_int&lt;{CONST#fe3cfa0214ac55c7}&gt;();\n200:    static fn function_names::const_generic_fn_signed_int&lt;-7&gt;();\n201:    static fn function_names::const_generic_fn_unsigned_int&lt;14&gt;();\n\n------------------------------------------\nstderr:\n------------------------------------------\n\n------------------------------------------\n\n\n\nfailures:\n    [debuginfo-gdb] debuginfo/function-names.rs\n\ntest result: FAILED. 102 passed; 1 failed; 30 ignored; 0 measured; 0 filtered out; finished in 3.07s\n\nSome tests failed in compiletest suite=debuginfo mode=debuginfo host=x86_64-unknown-linux-gnu target=x86_64-unknown-linux-gnu\n</code></pre></div>",
        "id": 253812250,
        "sender_full_name": "nikomatsakis",
        "timestamp": 1631915410
    },
    {
        "content": "<p>Highly doubt it's my patch :)</p>",
        "id": 253812273,
        "sender_full_name": "nikomatsakis",
        "timestamp": 1631915426
    },
    {
        "content": "<p>locally or in CI?</p>",
        "id": 253813389,
        "sender_full_name": "The 8472",
        "timestamp": 1631916103
    },
    {
        "content": "<p>oh yeah, paths imply locally.</p>",
        "id": 253813574,
        "sender_full_name": "The 8472",
        "timestamp": 1631916215
    },
    {
        "content": "<p>In that case I guess you turned on debuginfo? that breaks a few tests.</p>",
        "id": 253813602,
        "sender_full_name": "The 8472",
        "timestamp": 1631916230
    },
    {
        "content": "<p>or it could be a wrong gdb version. you could try using the docker scripts for testing instead, those should have the right ones</p>",
        "id": 253813791,
        "sender_full_name": "The 8472",
        "timestamp": 1631916327
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"330154\">The 8472</span> <a href=\"#narrow/stream/131828-t-compiler/topic/debuginfo.20tests.20on.20linux/near/253813602\">said</a>:</p>\n<blockquote>\n<p>In that case I guess you turned on debuginfo? that breaks a few tests.</p>\n</blockquote>\n<p>(probably turned _off_ debuginfo given the other zulip thread)</p>",
        "id": 253813941,
        "sender_full_name": "Joshua Nelson",
        "timestamp": 1631916397
    },
    {
        "content": "<p>Do you have new-symbol-mangling turned on perhaps?</p>",
        "id": 253814000,
        "sender_full_name": "simulacrum",
        "timestamp": 1631916439
    },
    {
        "content": "<p>190:    static fn function_names::generic_func&lt;i32&gt;(i32) -&gt; i32; is the line corresponding to the one we're looking for, I think</p>",
        "id": 253814016,
        "sender_full_name": "simulacrum",
        "timestamp": 1631916451
    },
    {
        "content": "<blockquote>\n<p>2021-09-17T19:14:22.9895426Z test [debuginfo-gdb] debuginfo/function-names.rs ... \u001b[33mignored\u001b(B\u001b[m</p>\n</blockquote>",
        "id": 253814211,
        "sender_full_name": "simulacrum",
        "timestamp": 1631916561
    },
    {
        "content": "<p>hm. we might just not even be checking that test in CI</p>",
        "id": 253814235,
        "sender_full_name": "simulacrum",
        "timestamp": 1631916583
    },
    {
        "content": "<p>yeah, spot checking a few builders, I don't think we have gdb &gt;= 10.1 anywhere</p>",
        "id": 253814493,
        "sender_full_name": "simulacrum",
        "timestamp": 1631916708
    },
    {
        "content": "<p>So <span class=\"user-mention\" data-user-id=\"116009\">@nikomatsakis</span> that test is just broken, probably</p>",
        "id": 253814507,
        "sender_full_name": "simulacrum",
        "timestamp": 1631916719
    },
    {
        "content": "<p>and indeed probably <a href=\"https://github.com/rust-lang/rust/commit/f60d333affb62b5aaec52efddc54db46ead9cf5e\">f60d333affb62b5aaec52efddc54db46ead9cf5e</a> just \"fixed\" function-names and <a href=\"http://function-call.rs\">function-call.rs</a> by no longer testing them in CI</p>",
        "id": 253814661,
        "sender_full_name": "simulacrum",
        "timestamp": 1631916791
    },
    {
        "content": "<p>it would be nice to have a tidy check that tests get run in at least <em>one</em> CI builder</p>",
        "id": 253814781,
        "sender_full_name": "Joshua Nelson",
        "timestamp": 1631916846
    },
    {
        "content": "<p>not sure how you could implement it though, it would have to have pretty deep knowledge of what's installed</p>",
        "id": 253814819,
        "sender_full_name": "Joshua Nelson",
        "timestamp": 1631916867
    },
    {
        "content": "<p>it's not really tidy that would check that</p>",
        "id": 253814832,
        "sender_full_name": "simulacrum",
        "timestamp": 1631916880
    },
    {
        "content": "<p>we've long wanted to collect which tests/steps were run on each builder precisely for this kind of testing</p>",
        "id": 253814856,
        "sender_full_name": "simulacrum",
        "timestamp": 1631916898
    },
    {
        "content": "<p>but it's a pretty big task and there's not much infra bandwidth these days</p>",
        "id": 253814885,
        "sender_full_name": "simulacrum",
        "timestamp": 1631916916
    },
    {
        "content": "<p>FWIW that test fails in Fedora rpm builds too</p>",
        "id": 253820969,
        "sender_full_name": "cuviper",
        "timestamp": 1631921509
    },
    {
        "content": "<p>(<code>GNU gdb (GDB) Fedora 10.2-6.fc35</code>)</p>",
        "id": 253821000,
        "sender_full_name": "cuviper",
        "timestamp": 1631921522
    },
    {
        "content": "<p>Oh I see what you mean now, <code>min-gdb-version: 10.1</code> has been gating it on older CI configs</p>",
        "id": 253821293,
        "sender_full_name": "cuviper",
        "timestamp": 1631921683
    }
]