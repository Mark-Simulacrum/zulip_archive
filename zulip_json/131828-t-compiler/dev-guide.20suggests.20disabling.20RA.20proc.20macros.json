[
    {
        "content": "<p><a href=\"https://rustc-dev-guide.rust-lang.org/building/suggested.html#configuring-rust-analyzer-for-rustc\">https://rustc-dev-guide.rust-lang.org/building/suggested.html#configuring-rust-analyzer-for-rustc</a><br>\ncontains this line:</p>\n<div class=\"codehilite\" data-code-language=\"JSON\"><pre><span></span><code><span class=\"nt\">\"rust-analyzer.procMacro.enable\"</span><span class=\"p\">:</span> <span class=\"kc\">false</span>\n</code></pre></div>",
        "id": 269033065,
        "sender_full_name": "eddyb",
        "timestamp": 1642963932
    },
    {
        "content": "<p>this breaks anything involving queries, because that (unfortunately) goes through a proc macro</p>",
        "id": 269033091,
        "sender_full_name": "eddyb",
        "timestamp": 1642963980
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"326176\">@Boxy [she/her]</span> mentioned it to me in the past, but I didn't really understand what going on until I was looking closer, while trying to use RA myself</p>",
        "id": 269033151,
        "sender_full_name": "eddyb",
        "timestamp": 1642964055
    },
    {
        "content": "<p>cc <span class=\"user-mention\" data-user-id=\"133247\">@bjorn3</span> <span class=\"user-mention\" data-user-id=\"200146\">@Daniel Mcnab</span> what was the intention here?</p>",
        "id": 269033241,
        "sender_full_name": "eddyb",
        "timestamp": 1642964176
    },
    {
        "content": "<p>enabling proc macros doesn't outright work by itself, because it enables build scripts, that won't run for some reason, but this sounds like a different problem that should be fixed instead of worked around?</p>",
        "id": 269033255,
        "sender_full_name": "eddyb",
        "timestamp": 1642964215
    },
    {
        "content": "<p>it seems to be getting stuck on compiling <code>library</code> crates, and not making progress from there</p>",
        "id": 269033449,
        "sender_full_name": "eddyb",
        "timestamp": 1642964429
    },
    {
        "content": "<p>it's really frustrating that RA seems to be losing the messages so I don't even know what's wrong with those unrelated build scripts</p>",
        "id": 269033750,
        "sender_full_name": "eddyb",
        "timestamp": 1642964763
    },
    {
        "content": "<p>the <code>core</code> errors that it's not showing, seem to go away if I update nightly, so that might be one workaround</p>",
        "id": 269034146,
        "sender_full_name": "eddyb",
        "timestamp": 1642965325
    },
    {
        "content": "<div class=\"codehilite\"><pre><span></span><code>[ERROR rust_analyzer::reload] failed to switch build data: rust-analyzer failed to run build scripts:\nerror: could not compile `crc32fast` due to 138 previous errors\nerror: build failed\n</code></pre></div>",
        "id": 269034364,
        "sender_full_name": "eddyb",
        "timestamp": 1642965580
    },
    {
        "content": "<p>it would be useful if the rest of that wasn't lost :/</p>",
        "id": 269034367,
        "sender_full_name": "eddyb",
        "timestamp": 1642965587
    },
    {
        "content": "<p>hmm I can run <code>cargo check -p crc32fast</code> to see the failure. so it is the <code>rustc-std-workspace-core</code> stuff that's causing issues</p>",
        "id": 269034466,
        "sender_full_name": "eddyb",
        "timestamp": 1642965693
    },
    {
        "content": "<p>heh, <code>compiler_builtins</code> breaks if I comment out the <code>rustc-std-workspace-*</code> overrides in <code>Cargo.toml</code></p>",
        "id": 269034525,
        "sender_full_name": "eddyb",
        "timestamp": 1642965758
    },
    {
        "content": "<p>oh, I finally found <a href=\"https://github.com/rust-analyzer/rust-analyzer/issues/9201\">https://github.com/rust-analyzer/rust-analyzer/issues/9201</a></p>",
        "id": 269034979,
        "sender_full_name": "eddyb",
        "timestamp": 1642966343
    },
    {
        "content": "<p>(couldn't find it when I was searching for what I thought was the problem)</p>",
        "id": 269034989,
        "sender_full_name": "eddyb",
        "timestamp": 1642966362
    },
    {
        "content": "<p>this worked for me:</p>\n<div class=\"codehilite\" data-code-language=\"Bash\"><pre><span></span><code>env <span class=\"nv\">CFG_RELEASE</span><span class=\"o\">=</span> <span class=\"nv\">CFG_RELEASE_CHANNEL</span><span class=\"o\">=</span> <span class=\"nv\">RUSTC_INSTALL_BINDIR</span><span class=\"o\">=</span> cargo check -p rustc_driver\n</code></pre></div>",
        "id": 269035233,
        "sender_full_name": "eddyb",
        "timestamp": 1642966687
    },
    {
        "content": "<p>left a comment at <a href=\"https://github.com/rust-analyzer/rust-analyzer/issues/9201#issuecomment-1019554086\">https://github.com/rust-analyzer/rust-analyzer/issues/9201#issuecomment-1019554086</a></p>",
        "id": 269035598,
        "sender_full_name": "eddyb",
        "timestamp": 1642967199
    },
    {
        "content": "<p>I don't know what happens, but I agree it's annoying<br>\nFwiw, this also affects working in rust-gpu, specifically because Providers doesn't get expanded for some reason<br>\nI haven't tried to root cause it</p>",
        "id": 269077592,
        "sender_full_name": "Daniel Mcnab",
        "timestamp": 1643016003
    },
    {
        "content": "<p>yupp, that is indeed how I first noticed it myself</p>",
        "id": 269086225,
        "sender_full_name": "eddyb",
        "timestamp": 1643020726
    }
]