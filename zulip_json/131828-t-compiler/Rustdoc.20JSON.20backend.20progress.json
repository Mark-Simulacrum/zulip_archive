[
    {
        "content": "<blockquote>\n<p>oh? I thought it was very close to landing.. but we can talk in another thread</p>\n</blockquote>\n<p><span class=\"user-mention\" data-user-id=\"116883\">@tmandry</span> here is the current status: <a href=\"https://github.com/rust-lang/rust/pull/75114#issuecomment-673964362\">https://github.com/rust-lang/rust/pull/75114#issuecomment-673964362</a></p>",
        "id": 213236993,
        "sender_full_name": "Joshua Nelson",
        "timestamp": 1602638045
    },
    {
        "content": "<p>and pineapple seems to have disappeared, I think he got busy with school</p>",
        "id": 213237001,
        "sender_full_name": "Joshua Nelson",
        "timestamp": 1602638058
    },
    {
        "content": "<p>there hasn't been any change in 2 months</p>",
        "id": 213237013,
        "sender_full_name": "Joshua Nelson",
        "timestamp": 1602638082
    },
    {
        "content": "<p>yeah, I think it needs a ping. I can also ping him</p>",
        "id": 213237016,
        "sender_full_name": "tmandry",
        "timestamp": 1602638093
    },
    {
        "content": "<p>I've pinged him a couple times</p>",
        "id": 213237022,
        "sender_full_name": "Joshua Nelson",
        "timestamp": 1602638103
    },
    {
        "content": "<p>but there is a test suite I think</p>",
        "id": 213237027,
        "sender_full_name": "tmandry",
        "timestamp": 1602638109
    },
    {
        "content": "<p>it sounds like he's <em>working</em> on it intermittently, he's just not pushing any of the code so people can see it</p>",
        "id": 213237031,
        "sender_full_name": "Joshua Nelson",
        "timestamp": 1602638117
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"116883\">tmandry</span> <a href=\"#narrow/stream/131828-t-compiler/topic/Rustdoc.20JSON.20backend.20progress/near/213237027\">said</a>:</p>\n<blockquote>\n<p>but there is a test suite I think</p>\n</blockquote>\n<p>well. the python tests are pretty hacky</p>",
        "id": 213237039,
        "sender_full_name": "Joshua Nelson",
        "timestamp": 1602638129
    },
    {
        "content": "<p>I think the compare tests look pretty good</p>",
        "id": 213237108,
        "sender_full_name": "tmandry",
        "timestamp": 1602638196
    },
    {
        "content": "<p>here was my last conversation with him a month ago: <a href=\"https://discordapp.com/channels/273534239310479360/273539705595756544/756004270758690836\">https://discordapp.com/channels/273534239310479360/273539705595756544/756004270758690836</a></p>",
        "id": 213237117,
        "sender_full_name": "Joshua Nelson",
        "timestamp": 1602638213
    },
    {
        "content": "<p>check_missing_items names a bunch of keys but it sounded like he didn't think there was a simpler way</p>",
        "id": 213237122,
        "sender_full_name": "tmandry",
        "timestamp": 1602638221
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"116883\">tmandry</span> <a href=\"#narrow/stream/131828-t-compiler/topic/Rustdoc.20JSON.20backend.20progress/near/213237122\">said</a>:</p>\n<blockquote>\n<p>check_missing_items names a bunch of keys but it sounded like he didn't think there was a simpler way</p>\n</blockquote>\n<p>I kind of agree there I think, it's a really large API</p>",
        "id": 213237149,
        "sender_full_name": "Joshua Nelson",
        "timestamp": 1602638274
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"232545\">Joshua Nelson</span> <a href=\"#narrow/stream/131828-t-compiler/topic/Rustdoc.20JSON.20backend.20progress/near/213237117\">said</a>:</p>\n<blockquote>\n<p>here was my last conversation with him a month ago: <a href=\"https://discordapp.com/channels/273534239310479360/273539705595756544/756004270758690836\">https://discordapp.com/channels/273534239310479360/273539705595756544/756004270758690836</a></p>\n</blockquote>\n<p>I can't seem to access that URL</p>",
        "id": 213237190,
        "sender_full_name": "tmandry",
        "timestamp": 1602638288
    },
    {
        "content": "<p>which I kind of wish was smaller :/ but since it's unstable I don't care enough to block on it</p>",
        "id": 213237199,
        "sender_full_name": "Joshua Nelson",
        "timestamp": 1602638298
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"116883\">tmandry</span> <a href=\"#narrow/stream/131828-t-compiler/topic/Rustdoc.20JSON.20backend.20progress/near/213237190\">said</a>:</p>\n<blockquote>\n<p><span class=\"user-mention silent\" data-user-id=\"232545\">Joshua Nelson</span> <a href=\"#narrow/stream/131828-t-compiler/topic/Rustdoc.20JSON.20backend.20progress/near/213237117\">said</a>:</p>\n<blockquote>\n<p>here was my last conversation with him a month ago: <a href=\"https://discordapp.com/channels/273534239310479360/273539705595756544/756004270758690836\">https://discordapp.com/channels/273534239310479360/273539705595756544/756004270758690836</a></p>\n</blockquote>\n<p>I can't seem to access that URL</p>\n</blockquote>\n<p>you may neede to join the discord community server</p>",
        "id": 213237207,
        "sender_full_name": "Joshua Nelson",
        "timestamp": 1602638306
    },
    {
        "content": "<p>it's a long conversation, mostly he was trying to get it to work on the standard library itself</p>",
        "id": 213237214,
        "sender_full_name": "Joshua Nelson",
        "timestamp": 1602638319
    },
    {
        "content": "<p>oh, yeah, I left that one awhile back</p>",
        "id": 213237215,
        "sender_full_name": "tmandry",
        "timestamp": 1602638323
    },
    {
        "content": "<p>lots of messing with bootstrap</p>",
        "id": 213237217,
        "sender_full_name": "Joshua Nelson",
        "timestamp": 1602638324
    },
    {
        "content": "<p>but yeah it <em>sounds</em> like he has a ton of local changes he hasn't pushed</p>",
        "id": 213237237,
        "sender_full_name": "Joshua Nelson",
        "timestamp": 1602638348
    },
    {
        "content": "<p>mm sounds like we should just merge what we have</p>",
        "id": 213237238,
        "sender_full_name": "tmandry",
        "timestamp": 1602638349
    },
    {
        "content": "<p>which is very frustrating</p>",
        "id": 213237241,
        "sender_full_name": "Joshua Nelson",
        "timestamp": 1602638351
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"116883\">tmandry</span> <a href=\"#narrow/stream/131828-t-compiler/topic/Rustdoc.20JSON.20backend.20progress/near/213237238\">said</a>:</p>\n<blockquote>\n<p>mm sounds like we should just merge what we have</p>\n</blockquote>\n<p>this is my opinion too</p>",
        "id": 213237246,
        "sender_full_name": "Joshua Nelson",
        "timestamp": 1602638359
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"210316\">@GuillaumeGomez</span> what do you think?</p>",
        "id": 213237257,
        "sender_full_name": "Joshua Nelson",
        "timestamp": 1602638399
    },
    {
        "content": "<p>and there are  tests</p>",
        "id": 213237300,
        "sender_full_name": "tmandry",
        "timestamp": 1602638420
    },
    {
        "content": "<p>we do have <em>a</em> test, the consistency test that makes sure there's no invalid ids</p>",
        "id": 213237301,
        "sender_full_name": "Joshua Nelson",
        "timestamp": 1602638421
    },
    {
        "content": "<p>not only that, but a couple golden tests too</p>",
        "id": 213237306,
        "sender_full_name": "tmandry",
        "timestamp": 1602638434
    },
    {
        "content": "<p>I'm not sure what you mean by hacky</p>",
        "id": 213237388,
        "sender_full_name": "tmandry",
        "timestamp": 1602638524
    },
    {
        "content": "<p>the test code was designed to minimize noise in the golden test output</p>",
        "id": 213237391,
        "sender_full_name": "tmandry",
        "timestamp": 1602638527
    },
    {
        "content": "<p>which seems like a good approach</p>",
        "id": 213237407,
        "sender_full_name": "tmandry",
        "timestamp": 1602638557
    },
    {
        "content": "<p>maybe I'm thinking of a different approach he abandoned</p>",
        "id": 213237424,
        "sender_full_name": "Joshua Nelson",
        "timestamp": 1602638585
    },
    {
        "content": "<p>also the tests are not working right now <a href=\"https://github.com/rust-lang/rust/pull/75114#discussion_r480605026\">https://github.com/rust-lang/rust/pull/75114#discussion_r480605026</a></p>",
        "id": 213237447,
        "sender_full_name": "Joshua Nelson",
        "timestamp": 1602638641
    },
    {
        "content": "<p>okay, left a comment</p>",
        "id": 213237630,
        "sender_full_name": "tmandry",
        "timestamp": 1602638833
    },
    {
        "content": "<p>Well, I was hoping they would send their local changes first...</p>",
        "id": 213259243,
        "sender_full_name": "GuillaumeGomez",
        "timestamp": 1602664248
    },
    {
        "content": "<p>They said they'll try to send them sometime this week</p>",
        "id": 213284673,
        "sender_full_name": "Joshua Nelson",
        "timestamp": 1602680618
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"116883\">@tmandry</span> left a bunch of comments on the PR, maybe you're interested in reviewing?</p>",
        "id": 216024485,
        "sender_full_name": "Joshua Nelson",
        "timestamp": 1604868302
    },
    {
        "content": "<p>mostly questions about what the format should look like</p>",
        "id": 216024491,
        "sender_full_name": "Joshua Nelson",
        "timestamp": 1604868310
    },
    {
        "content": "<p>the implementation I'm not too worried about other than ICEs, we can always fix bugs later</p>",
        "id": 216024500,
        "sender_full_name": "Joshua Nelson",
        "timestamp": 1604868336
    },
    {
        "content": "<p>I worked pretty closely with Joseph on the format spec and I think it's ready</p>",
        "id": 216027239,
        "sender_full_name": "tmandry",
        "timestamp": 1604872483
    },
    {
        "content": "<p>I'd be willing to r+ if there are no objections</p>",
        "id": 216027243,
        "sender_full_name": "tmandry",
        "timestamp": 1604872499
    },
    {
        "content": "<p>hmm I'm not super happy with the format :/</p>",
        "id": 216027915,
        "sender_full_name": "Joshua Nelson",
        "timestamp": 1604873408
    },
    {
        "content": "<p>mostly because there's so much duplicate data</p>",
        "id": 216027926,
        "sender_full_name": "Joshua Nelson",
        "timestamp": 1604873436
    },
    {
        "content": "<p>and it's hard to work with jq because the objects are not lists, instead it's a key/value dict where you don't know the keys ahead of time</p>",
        "id": 216027931,
        "sender_full_name": "Joshua Nelson",
        "timestamp": 1604873459
    },
    {
        "content": "<p>also I still want to get rid of stripped items</p>",
        "id": 216028002,
        "sender_full_name": "Joshua Nelson",
        "timestamp": 1604873529
    },
    {
        "content": "<p>but I have a sinking feeling that will break what little test suite we have</p>",
        "id": 216028006,
        "sender_full_name": "Joshua Nelson",
        "timestamp": 1604873539
    },
    {
        "content": "<p>the problem is that rustdoc <em>doesn't</em> guarentee there's links between all items</p>",
        "id": 216028012,
        "sender_full_name": "Joshua Nelson",
        "timestamp": 1604873550
    },
    {
        "content": "<p>you can have <code>fn f(x: impl PrivateTrait)</code> where <code>PrivateTrait</code> is <em>not</em> exported</p>",
        "id": 216028020,
        "sender_full_name": "Joshua Nelson",
        "timestamp": 1604873569
    },
    {
        "content": "<p>(plus there are various bugs IIRC)</p>",
        "id": 216028022,
        "sender_full_name": "Joshua Nelson",
        "timestamp": 1604873580
    },
    {
        "content": "<p>I guess for an initial impl this is ok</p>",
        "id": 216028102,
        "sender_full_name": "Joshua Nelson",
        "timestamp": 1604873729
    },
    {
        "content": "<p>I just want to avoid another situation like intra-doc links where people depend on something that's unstable</p>",
        "id": 216028105,
        "sender_full_name": "Joshua Nelson",
        "timestamp": 1604873746
    },
    {
        "content": "<p>because I really do want to change the format and if people are depending on it everything gets complicated</p>",
        "id": 216028107,
        "sender_full_name": "Joshua Nelson",
        "timestamp": 1604873760
    },
    {
        "content": "<p>I think people have to start using it before it becomes obvious what the best format is</p>",
        "id": 216029929,
        "sender_full_name": "tmandry",
        "timestamp": 1604876439
    },
    {
        "content": "<p>intra doc links were a bit different in that <a href=\"http://docs.rs\">docs.rs</a> just supported them even though they were unstable</p>",
        "id": 216030031,
        "sender_full_name": "tmandry",
        "timestamp": 1604876625
    },
    {
        "content": "<p>and this feature is definitely more niche than that was</p>",
        "id": 216030078,
        "sender_full_name": "tmandry",
        "timestamp": 1604876648
    },
    {
        "content": "<p>and yeah I’d be fine with using arrays, but it’s probably a nontrivial change to the code. you have to traverse the graph and create a mapping between DefIds and integer indices before serializing anything</p>",
        "id": 216030111,
        "sender_full_name": "tmandry",
        "timestamp": 1604876723
    },
    {
        "content": "<p>so it probably should go in a follow up change</p>",
        "id": 216030118,
        "sender_full_name": "tmandry",
        "timestamp": 1604876735
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"116883\">tmandry</span> <a href=\"#narrow/stream/131828-t-compiler/topic/Rustdoc.20JSON.20backend.20progress/near/216030078\">said</a>:</p>\n<blockquote>\n<p>and this feature is definitely more niche than that was</p>\n</blockquote>\n<p>see I think I disagree about that</p>",
        "id": 216030345,
        "sender_full_name": "Joshua Nelson",
        "timestamp": 1604877071
    },
    {
        "content": "<p>I see this as the future of rustdoc in some sense</p>",
        "id": 216030348,
        "sender_full_name": "Joshua Nelson",
        "timestamp": 1604877078
    },
    {
        "content": "<p>rustdoc is so hard to modify that it's not really feasible to add major new features currently</p>",
        "id": 216030358,
        "sender_full_name": "Joshua Nelson",
        "timestamp": 1604877092
    },
    {
        "content": "<p>like, realistically <a href=\"https://github.com/rust-lang/rust/issues/74758\">https://github.com/rust-lang/rust/issues/74758</a> is ~never going to get implemented currently</p>",
        "id": 216030407,
        "sender_full_name": "Joshua Nelson",
        "timestamp": 1604877132
    },
    {
        "content": "<p>the json backend lets you write new frontends on top, without having to go through x.py and resolve and all the other things</p>",
        "id": 216030413,
        "sender_full_name": "Joshua Nelson",
        "timestamp": 1604877148
    },
    {
        "content": "<p>like, people are already lining up to use this and it hasn't even been merged yet <a href=\"https://github.com/oberien/heradoc/issues/154\">https://github.com/oberien/heradoc/issues/154</a></p>",
        "id": 216030448,
        "sender_full_name": "Joshua Nelson",
        "timestamp": 1604877211
    },
    {
        "content": "<p>hmm I was going to say I want to get rid of stripped items in the first pass, but I guess you can get those anyway with <code>--document-private-items</code></p>",
        "id": 216030526,
        "sender_full_name": "Joshua Nelson",
        "timestamp": 1604877295
    },
    {
        "content": "<p>so it's fine to delay that until later too</p>",
        "id": 216030530,
        "sender_full_name": "Joshua Nelson",
        "timestamp": 1604877301
    },
    {
        "content": "<p>oh I just realized I broke the tests when I moved them to <code>rustdoc/</code> because they use a makefile</p>",
        "id": 216031573,
        "sender_full_name": "Joshua Nelson",
        "timestamp": 1604878679
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"116122\">@simulacrum</span> I tried moving them to <code>run-make</code> but they fail because <code>RUSTDOC</code> isn't defined - should compiletest be setting that?</p>\n<div class=\"codehilite\"><pre><span></span><code>$ cat Makefile\n-include ../tools.mk\n\ntests: *.rs\n    $(RUSTDOC) $&lt; -o $(TMPDIR) --output-format json\n    $(PYTHON) check_missing_items.py $(TMPDIR)/$(basename $&lt;).json\n    $(PYTHON) compare.py $(basename $&lt;).expected $(TMPDIR)/$(basename $&lt;).json\n$ make\nstructs.rs -o  --output-format json\nmake: structs.rs: Command not found\n</code></pre></div>",
        "id": 216031618,
        "sender_full_name": "Joshua Nelson",
        "timestamp": 1604878717
    },
    {
        "content": "<p>Hm I would prefer to avoid a rustdoc dependency for run-make tests</p>",
        "id": 216031636,
        "sender_full_name": "simulacrum",
        "timestamp": 1604878764
    },
    {
        "content": "<p>how would you suggest to do this?</p>",
        "id": 216031641,
        "sender_full_name": "Joshua Nelson",
        "timestamp": 1604878781
    },
    {
        "content": "<p>Can we have a separate folder and wire that up?</p>",
        "id": 216031642,
        "sender_full_name": "simulacrum",
        "timestamp": 1604878785
    },
    {
        "content": "<p>sure</p>",
        "id": 216031653,
        "sender_full_name": "Joshua Nelson",
        "timestamp": 1604878797
    },
    {
        "content": "<p>I won't get around to it tonight though</p>",
        "id": 216031697,
        "sender_full_name": "Joshua Nelson",
        "timestamp": 1604878806
    },
    {
        "content": "<p>but yeah that seems like the best plan long-term anyway</p>",
        "id": 216031706,
        "sender_full_name": "Joshua Nelson",
        "timestamp": 1604878844
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"232545\">@Joshua Nelson</span> Yeah there's a lot of people who want to use it, but they know the risks :) I have a feeling that this feature is a lot less \"infectious\" than intra-doc links was, since removing it wouldn't mean you have to change the documentation for a bunch of crates</p>",
        "id": 216160784,
        "sender_full_name": "tmandry",
        "timestamp": 1604968687
    },
    {
        "content": "<p>But yeah, being in popular demand is a good reason to push for stabilization and try to get the kinks out early</p>",
        "id": 216160818,
        "sender_full_name": "tmandry",
        "timestamp": 1604968727
    },
    {
        "content": "<p>but by \"push for stabilization\" I mean \"spend many months responding to feedback until we feel it's ready and then we can write an RFC to maybe stabilize\"</p>",
        "id": 216161116,
        "sender_full_name": "tmandry",
        "timestamp": 1604968959
    },
    {
        "content": "<p>since we don't want to do that prematurely</p>",
        "id": 216161124,
        "sender_full_name": "tmandry",
        "timestamp": 1604968965
    },
    {
        "content": "<p>although now I'm remembering some conversation with <span class=\"user-mention\" data-user-id=\"132040\">@Manish Goregaokar</span> I think about how we should never stabilize the <em>format</em>, and instead just keep a version number that we increment when breaking changes are made</p>",
        "id": 216161267,
        "sender_full_name": "tmandry",
        "timestamp": 1604969124
    },
    {
        "content": "<p>which I think would be fine</p>",
        "id": 216161339,
        "sender_full_name": "tmandry",
        "timestamp": 1604969180
    },
    {
        "content": "<p>as long as we stabilize its <em>existence</em> at some point</p>",
        "id": 216161355,
        "sender_full_name": "tmandry",
        "timestamp": 1604969204
    },
    {
        "content": "<p>hmm, I'm wondering if I should leave the test refactors for later and just keep them in run-make-fulldeps for now</p>",
        "id": 216162329,
        "sender_full_name": "Joshua Nelson",
        "timestamp": 1604970136
    },
    {
        "content": "<p>building the compiler twice to test is really annoying though :/</p>",
        "id": 216162349,
        "sender_full_name": "Joshua Nelson",
        "timestamp": 1604970148
    }
]