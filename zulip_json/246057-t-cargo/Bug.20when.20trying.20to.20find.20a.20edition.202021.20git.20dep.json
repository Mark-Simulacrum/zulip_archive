[
    {
        "content": "<p>When trying to add a git dependency that is a edition 2021 crate to a edition 2018 crate, you get this error message:</p>\n<div class=\"codehilite\"><pre><span></span><code>cargo update -p clippy_lints\n    Updating git repository `https://github.com/rust-lang/rust-clippy`\n    Updating crates.io index\n    Updating git repository `https://github.com/rust-lang/rust-clippy`\nerror: no matching package named `clippy_lints` found\nlocation searched: https://github.com/rust-lang/rust-clippy?rev=0c8799da5aabf72aee26053075d2bd73ef9f7789\nrequired by package `rls v1.41.0 (/home/pkrones/rust-lang/rls)`\n</code></pre></div>\n<p><code>0c8799da5aabf72aee26053075d2bd73ef9f7789</code> is the commit the edition of <code>clippy_lints</code> was bumped to 2021. The commit before that works. </p>\n<p>I was under the impression, that you should be able to use 2021 dependencies even when your crate uses edition 2018. If I'm mistaken here, then the error message should be improved. I can also open an issue about this, but first wanted to ask here, what this is about.</p>\n<p>I found this while trying to update the <code>clippy_lints</code> version in RLS to get our Clippy sync through (<a href=\"https://github.com/rust-lang/rust/issues/91154\">#91154</a>).</p>",
        "id": 262609533,
        "sender_full_name": "flip1995",
        "timestamp": 1637770818
    },
    {
        "content": "<p><a href=\"https://github.com/rust-lang/rust/commit/0c8799da5aabf72aee26053075d2bd73ef9f7789\">https://github.com/rust-lang/rust/commit/0c8799da5aabf72aee26053075d2bd73ef9f7789</a> literally only bumped to 2021.<br>\nI don't know why this is not working, but it should work.</p>",
        "id": 262609942,
        "sender_full_name": "Eh2406",
        "timestamp": 1637771005
    },
    {
        "content": "<p>Minimizing the example would be extremely helpful.</p>",
        "id": 262610065,
        "sender_full_name": "Eh2406",
        "timestamp": 1637771055
    },
    {
        "content": "<p>But yes, file a bug!</p>",
        "id": 262610099,
        "sender_full_name": "Eh2406",
        "timestamp": 1637771070
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"264664\">@flip1995</span> Can you say more about exactly which steps you used?  I'm able to update <code>clippy_lints</code> in the RLS repo.  Did you update both the root and <code>rls-rustc</code>?</p>",
        "id": 262614583,
        "sender_full_name": "Eric Huss",
        "timestamp": 1637772991
    },
    {
        "content": "<p>I just noticed that this only happens when you use an old cargo version: 1.54.0 or 1.55.0 and earlier. I can update it with <code>cargo +stable update -p clippy_lints</code></p>",
        "id": 262614876,
        "sender_full_name": "flip1995",
        "timestamp": 1637773121
    },
    {
        "content": "<p>So not sure if there's anything cargo can do here.</p>",
        "id": 262614919,
        "sender_full_name": "flip1995",
        "timestamp": 1637773141
    },
    {
        "content": "<p>I guess this is because older cargo versions don't know what <code>edition 2021</code> crates are? <span aria-label=\"thinking\" class=\"emoji emoji-1f914\" role=\"img\" title=\"thinking\">:thinking:</span></p>",
        "id": 262614982,
        "sender_full_name": "flip1995",
        "timestamp": 1637773174
    },
    {
        "content": "<p>Oh, yea.  When cargo scans a git repo, it ignores <code>Cargo.toml</code> files that it can't parse. Older versions can't handle 2021 edition.  I think we can do better with the error message.</p>\n<p>I believe this exact same issue is tracked in <a href=\"https://github.com/rust-lang/cargo/issues/6211\">https://github.com/rust-lang/cargo/issues/6211</a></p>",
        "id": 262616337,
        "sender_full_name": "Eric Huss",
        "timestamp": 1637773772
    },
    {
        "content": "<p>So this happens with nightly-2021-09-01 and earlier, but not from 2021-09-02 and onwards. This issue looks like it's the same cause</p>",
        "id": 262616503,
        "sender_full_name": "flip1995",
        "timestamp": 1637773851
    }
]