[
    {
        "content": "<p>Hi <span class=\"user-group-mention\" data-user-group-id=\"897\">@T-compiler/meeting</span> ; we'll be holding the steering meeting for planning our first sprint of 2021 in about 14 minutes, in this topic.</p>",
        "id": 224479767,
        "sender_full_name": "pnkfelix",
        "timestamp": 1611931573
    },
    {
        "content": "<p>Okay, hi <span class=\"user-group-mention\" data-user-group-id=\"897\">@T-compiler/meeting</span> ! Its sprint planning meeting time!</p>",
        "id": 224481809,
        "sender_full_name": "pnkfelix",
        "timestamp": 1611932424
    },
    {
        "content": "<p>But first, I'm going to yield 5 minutes for</p>\n<h2>Announcements</h2>",
        "id": 224481856,
        "sender_full_name": "pnkfelix",
        "timestamp": 1611932439
    },
    {
        "content": "<p><a href=\"https://twitter.com/wesleywiser/status/1354896012113022984\">https://twitter.com/wesleywiser/status/1354896012113022984</a></p>\n<div class=\"inline-preview-twitter\"><div class=\"twitter-tweet\"><a href=\"https://twitter.com/wesleywiser/status/1354896012113022984\"><img class=\"twitter-avatar\" src=\"https://pbs.twimg.com/profile_images/1337523020395671553/ZhLGJjgE_normal.jpg\"></a><p>I'm very pleased to announce that I will be joining <a href=\"https://twitter.com/Microsoft\">@Microsoft</a> to work on the <a href=\"https://twitter.com/rustlang\">@rustlang</a> compiler team they are forming!</p><span>- Wesley Wiser (@wesleywiser)</span></div></div>",
        "id": 224481902,
        "sender_full_name": "Wesley Wiser",
        "timestamp": 1611932461
    },
    {
        "content": "<p>Yay!!! ðŸ¥°ðŸ¥°ðŸ¥°ðŸŽ‰ðŸŽ‰ðŸŽ‰</p>",
        "id": 224481944,
        "sender_full_name": "rylev",
        "timestamp": 1611932481
    },
    {
        "content": "<p>lets get those likes and retweet counts pumped up on that!</p>",
        "id": 224481959,
        "sender_full_name": "pnkfelix",
        "timestamp": 1611932491
    },
    {
        "content": "<p>congrats :)</p>",
        "id": 224482119,
        "sender_full_name": "Joshua Nelson",
        "timestamp": 1611932542
    },
    {
        "content": "<p>(wait a minute, 2K likes ... /me scrolls back to his own job announcement for comparison...)</p>",
        "id": 224482171,
        "sender_full_name": "pnkfelix",
        "timestamp": 1611932567
    },
    {
        "content": "<p>(me too)</p>",
        "id": 224482216,
        "sender_full_name": "Esteban KÃ¼ber",
        "timestamp": 1611932584
    },
    {
        "content": "<p>Thanks all! I'm really excited about the investments Microsoft has made in the Rust project and is continuing to make. 2021 is going to be a great year! <span aria-label=\"tada\" class=\"emoji emoji-1f389\" role=\"img\" title=\"tada\">:tada:</span></p>",
        "id": 224482235,
        "sender_full_name": "Wesley Wiser",
        "timestamp": 1611932594
    },
    {
        "content": "<p>/me humbled</p>",
        "id": 224482263,
        "sender_full_name": "Esteban KÃ¼ber",
        "timestamp": 1611932600
    },
    {
        "content": "<p>anything else to announce? The 1.50 release is February 11, which is not that far away at all.</p>",
        "id": 224482439,
        "sender_full_name": "pnkfelix",
        "timestamp": 1611932661
    },
    {
        "content": "<p>(somehow I think I failed to mention that yesterday)</p>",
        "id": 224482474,
        "sender_full_name": "pnkfelix",
        "timestamp": 1611932677
    },
    {
        "content": "<p>okay then, lets get started</p>",
        "id": 224482539,
        "sender_full_name": "pnkfelix",
        "timestamp": 1611932705
    },
    {
        "content": "<p>so as most of you know, I sent out a survey about the sprint timing and goals</p>",
        "id": 224482587,
        "sender_full_name": "pnkfelix",
        "timestamp": 1611932725
    },
    {
        "content": "<p>the survey got 12 responses via email, and I checked in with people over zulip shortly before this meeting</p>",
        "id": 224482732,
        "sender_full_name": "pnkfelix",
        "timestamp": 1611932771
    },
    {
        "content": "<p>There were many people who said they could not commit right now to any time at all, and that is <em>fine</em>; this is largely a volunteer project, so we cannot expect full-time participation from everyone</p>",
        "id": 224482823,
        "sender_full_name": "pnkfelix",
        "timestamp": 1611932818
    },
    {
        "content": "<p>among the people who did express timing constraints, the main outcome was that there was a strong preference for march over february.</p>",
        "id": 224482977,
        "sender_full_name": "pnkfelix",
        "timestamp": 1611932882
    },
    {
        "content": "<p>specifically, there was a tie between March 1-7 vs March 15-21 for when the sprint week should be.</p>",
        "id": 224483054,
        "sender_full_name": "pnkfelix",
        "timestamp": 1611932909
    },
    {
        "content": "<p>(I am currently planning for the sprint to be a week long. It could be that is too short for the kind of work we do and future sprints could be longer, but for now, its a week.)</p>",
        "id": 224483156,
        "sender_full_name": "pnkfelix",
        "timestamp": 1611932955
    },
    {
        "content": "<p>(is this something where people who are just starting to contribute more to the compiler can be involved or is it reserved for those already deemed as contributors?)</p>",
        "id": 224483227,
        "sender_full_name": "rylev",
        "timestamp": 1611932985
    },
    {
        "content": "<p>My intention is that people just starting out should be welcomed</p>",
        "id": 224483254,
        "sender_full_name": "pnkfelix",
        "timestamp": 1611933002
    },
    {
        "content": "<p>Or at least, I would like it to be something where part of the active participation is active mentorship</p>",
        "id": 224483325,
        "sender_full_name": "pnkfelix",
        "timestamp": 1611933021
    },
    {
        "content": "<p>In an ideal world, we would have the workforce to actively mentor, and advertise the sprint well ahead of time in order to get that influx of new contributors</p>",
        "id": 224483433,
        "sender_full_name": "pnkfelix",
        "timestamp": 1611933064
    },
    {
        "content": "<p>but I do not want to assume that will happen</p>",
        "id": 224483469,
        "sender_full_name": "pnkfelix",
        "timestamp": 1611933078
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"116083\">pnkfelix</span> <a href=\"#narrow/stream/238009-t-compiler.2Fmeetings/topic/.5Bsteering.20meeting.5D.202021-01-29/near/224483433\">said</a>:</p>\n<blockquote>\n<p>In an ideal world, we would have the workforce to actively mentor, and advertise the sprint well ahead of time in order to get that influx of new contributors</p>\n</blockquote>\n<p>I think a blog post would get you most of the way there</p>",
        "id": 224483503,
        "sender_full_name": "Joshua Nelson",
        "timestamp": 1611933096
    },
    {
        "content": "<p>So I want to make plans based on expectation that the contributions will largely come from the current contributors</p>",
        "id": 224483517,
        "sender_full_name": "pnkfelix",
        "timestamp": 1611933099
    },
    {
        "content": "<p>while also do the best we can to also welcome new people to the fold</p>",
        "id": 224483555,
        "sender_full_name": "pnkfelix",
        "timestamp": 1611933116
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"232545\">Joshua Nelson</span> <a href=\"#narrow/stream/238009-t-compiler.2Fmeetings/topic/.5Bsteering.20meeting.5D.202021-01-29/near/224483503\">said</a>:</p>\n<blockquote>\n<p>I think a blog post would get you most of the way there</p>\n</blockquote>\n<p>This is a good point</p>",
        "id": 224483615,
        "sender_full_name": "pnkfelix",
        "timestamp": 1611933129
    },
    {
        "content": "<p>I totally understand wanting to plan around folks where you know what kind of output you can expect.</p>",
        "id": 224483634,
        "sender_full_name": "rylev",
        "timestamp": 1611933135
    },
    {
        "content": "<p>Publishing in irlo as well would likely get some people involved with the promise of mentorship</p>",
        "id": 224483638,
        "sender_full_name": "Esteban KÃ¼ber",
        "timestamp": 1611933137
    },
    {
        "content": "<p>Anyway, in case you cannot tell, I also expect this first sprint to be a big learning experience for us</p>",
        "id": 224483693,
        "sender_full_name": "pnkfelix",
        "timestamp": 1611933161
    },
    {
        "content": "<p>So in the interest of learning as much as we can as soon as we can</p>",
        "id": 224483723,
        "sender_full_name": "pnkfelix",
        "timestamp": 1611933178
    },
    {
        "content": "<p>I'm inclined to schedule the sprint for March 1-7</p>",
        "id": 224483745,
        "sender_full_name": "pnkfelix",
        "timestamp": 1611933184
    },
    {
        "content": "<p>because I don't think we'll get much benefit from two extra weeks of planning time</p>",
        "id": 224483777,
        "sender_full_name": "pnkfelix",
        "timestamp": 1611933202
    },
    {
        "content": "<p>It might be good to try to estimate how much mentoring capacity we think we'll have. I'm a bit concerned we might end up with 50 people wanting to be mentored and only 5 or 6 people available to do so.</p>",
        "id": 224483811,
        "sender_full_name": "Wesley Wiser",
        "timestamp": 1611933215
    },
    {
        "content": "<p>That is also a good point</p>",
        "id": 224483843,
        "sender_full_name": "pnkfelix",
        "timestamp": 1611933225
    },
    {
        "content": "<p>I can help with basic \"how do I build the compiler stuff\" if you like</p>",
        "id": 224483863,
        "sender_full_name": "Joshua Nelson",
        "timestamp": 1611933233
    },
    {
        "content": "<p>and maybe a reason to push back on the idea that we be as welcoming as possible</p>",
        "id": 224483877,
        "sender_full_name": "pnkfelix",
        "timestamp": 1611933237
    },
    {
        "content": "<p>I can't promise to have time to dive into things like how the trait system works</p>",
        "id": 224483932,
        "sender_full_name": "Joshua Nelson",
        "timestamp": 1611933246
    },
    {
        "content": "<p>I'm also not sure we have enough work in this area to distribute it meaningfully to more than a dozen or so people at the same time.</p>",
        "id": 224483948,
        "sender_full_name": "Wesley Wiser",
        "timestamp": 1611933258
    },
    {
        "content": "<p>Yes, I'm also happy to help with how to start from nothing since I'm now past that phase.</p>",
        "id": 224483949,
        "sender_full_name": "rylev",
        "timestamp": 1611933258
    },
    {
        "content": "<p>\"in this area\": Wesley, to which area are you referring?</p>",
        "id": 224484013,
        "sender_full_name": "pnkfelix",
        "timestamp": 1611933284
    },
    {
        "content": "<p>Improving bootstrap performance.</p>",
        "id": 224484048,
        "sender_full_name": "Wesley Wiser",
        "timestamp": 1611933300
    },
    {
        "content": "<p>(I have previously stated my intended goal for the sprint)</p>",
        "id": 224484072,
        "sender_full_name": "pnkfelix",
        "timestamp": 1611933305
    },
    {
        "content": "<p>okay just double-checking, I don't think I had said that yet in this meeting. :)</p>",
        "id": 224484111,
        "sender_full_name": "pnkfelix",
        "timestamp": 1611933320
    },
    {
        "content": "<p>I mean that there is a lot of work to do but I'm not sure how much of it can be done simultaneously.</p>",
        "id": 224484115,
        "sender_full_name": "Wesley Wiser",
        "timestamp": 1611933321
    },
    {
        "content": "<p>So, let me just tie off the timing topic: Does anyone <em>object</em> to March 1-7 for the sprint week?</p>",
        "id": 224484197,
        "sender_full_name": "pnkfelix",
        "timestamp": 1611933350
    },
    {
        "content": "<p>okay, looks good</p>",
        "id": 224484287,
        "sender_full_name": "pnkfelix",
        "timestamp": 1611933375
    },
    {
        "content": "<p>so now lets talk about goals</p>",
        "id": 224484299,
        "sender_full_name": "pnkfelix",
        "timestamp": 1611933381
    },
    {
        "content": "<p>A big theme for 2021 overall, if I recall correctly, is improving performance in terms of the new contributor experience</p>",
        "id": 224484483,
        "sender_full_name": "pnkfelix",
        "timestamp": 1611933467
    },
    {
        "content": "<p>improving bootstrap performance is a big tier of that</p>",
        "id": 224484581,
        "sender_full_name": "pnkfelix",
        "timestamp": 1611933493
    },
    {
        "content": "<p>by bootstrap, I personally mean the experience of (re)building the compiler itself, as a contributor.</p>",
        "id": 224484666,
        "sender_full_name": "pnkfelix",
        "timestamp": 1611933528
    },
    {
        "content": "<p>Should we talk about the relative importance of rebuilding vs initial full builds?</p>",
        "id": 224484714,
        "sender_full_name": "rylev",
        "timestamp": 1611933554
    },
    {
        "content": "<p>(we've also discussed generalizing that to also include contributions to libstd, if I recall correctly)</p>",
        "id": 224484724,
        "sender_full_name": "pnkfelix",
        "timestamp": 1611933558
    },
    {
        "content": "<p>Right, I was going to get into that</p>",
        "id": 224484735,
        "sender_full_name": "pnkfelix",
        "timestamp": 1611933561
    },
    {
        "content": "<p>in my survey, I said that I was proposing focusing on incremental build performance</p>",
        "id": 224484762,
        "sender_full_name": "pnkfelix",
        "timestamp": 1611933575
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"224872\">rylev</span> <a href=\"#narrow/stream/238009-t-compiler.2Fmeetings/topic/.5Bsteering.20meeting.5D.202021-01-29/near/224484714\">said</a>:</p>\n<blockquote>\n<p>Should we talk about the relative importance of rebuilding vs initial full builds?</p>\n</blockquote>\n<p>I think these are linked, since whenever you rebase you have to rebuild most of the compiler</p>",
        "id": 224484789,
        "sender_full_name": "Joshua Nelson",
        "timestamp": 1611933586
    },
    {
        "content": "<p>namely, the contributor experience if we assume they've already invested the effort in making the initial build</p>",
        "id": 224484810,
        "sender_full_name": "pnkfelix",
        "timestamp": 1611933594
    },
    {
        "content": "<p>and a number of people responded</p>",
        "id": 224484830,
        "sender_full_name": "pnkfelix",
        "timestamp": 1611933601
    },
    {
        "content": "<p>that they were equally or in some cases more concerned about from-scratch build times</p>",
        "id": 224484916,
        "sender_full_name": "pnkfelix",
        "timestamp": 1611933618
    },
    {
        "content": "<p>the rebasing point is noteworthy, i didn't separate that out as a concern and perhaps i should have.</p>",
        "id": 224484953,
        "sender_full_name": "pnkfelix",
        "timestamp": 1611933635
    },
    {
        "content": "<p>(cc <a href=\"https://github.com/rust-lang/rust/pull/79540\">https://github.com/rust-lang/rust/pull/79540</a>)</p>",
        "id": 224484992,
        "sender_full_name": "Joshua Nelson",
        "timestamp": 1611933647
    },
    {
        "content": "<p>In my experience, downloading LLVM from CI was already a big advancement for initial build</p>",
        "id": 224484994,
        "sender_full_name": "LÃ©o Lanteri Thauvin",
        "timestamp": 1611933647
    },
    {
        "content": "<p>the other big thing I want to do for first-time builds is <a href=\"https://github.com/rust-lang/rust/issues/76653\">https://github.com/rust-lang/rust/issues/76653</a></p>",
        "id": 224485047,
        "sender_full_name": "Joshua Nelson",
        "timestamp": 1611933667
    },
    {
        "content": "<p>Now, I <em>do</em> think we will want to deal with from-scratch build performance</p>",
        "id": 224485083,
        "sender_full_name": "pnkfelix",
        "timestamp": 1611933677
    },
    {
        "content": "<p>and I think we could benefit from a whole sprint dedicated to it</p>",
        "id": 224485116,
        "sender_full_name": "pnkfelix",
        "timestamp": 1611933689
    },
    {
        "content": "<p>the thing I'm not sure about is whether its a good choice for our <em>first</em> sprint</p>",
        "id": 224485150,
        "sender_full_name": "pnkfelix",
        "timestamp": 1611933697
    },
    {
        "content": "<p>(in case its not clear: My hope is that we will have multiple sprints over the course of the year. I had been thinking one sprint every two months; Wesley suggested one sprint every three months or so. Its up in the air at this point.)</p>",
        "id": 224485362,
        "sender_full_name": "pnkfelix",
        "timestamp": 1611933758
    },
    {
        "content": "<p>So I'm of two minds here. I do think there is low-hanging fruit for incremental. If we can grab such fruits, we can make the iterative development experience much much better for local experimentation</p>",
        "id": 224485508,
        "sender_full_name": "pnkfelix",
        "timestamp": 1611933814
    },
    {
        "content": "<p>what do you see as low-hanging fruit?</p>",
        "id": 224485605,
        "sender_full_name": "Joshua Nelson",
        "timestamp": 1611933842
    },
    {
        "content": "<p>(I thought most of the easy things have already been done, but I could be wrong)</p>",
        "id": 224485674,
        "sender_full_name": "Joshua Nelson",
        "timestamp": 1611933863
    },
    {
        "content": "<p>well, maybe its not so low-hanging</p>",
        "id": 224485710,
        "sender_full_name": "pnkfelix",
        "timestamp": 1611933879
    },
    {
        "content": "<p>I'm slightly concerned about some efforts to split crates that positively impacted compile times that were canned because of perf regressions. What's our thinking there?</p>",
        "id": 224485761,
        "sender_full_name": "Esteban KÃ¼ber",
        "timestamp": 1611933897
    },
    {
        "content": "<p>I think we should aim for fruit we are fairly confident in picking for the first sprint; it would be great for it to be a success, I think</p>",
        "id": 224485767,
        "sender_full_name": "simulacrum",
        "timestamp": 1611933900
    },
    {
        "content": "<p>(comparatively to later sprints)</p>",
        "id": 224485805,
        "sender_full_name": "simulacrum",
        "timestamp": 1611933919
    },
    {
        "content": "<p>my impressions from the contributor survey discussion was that areas like the<br>\nbuild and everything that isn't compiler related has less traction, the solution<br>\nto that hasn't been formalized afaik</p>",
        "id": 224485850,
        "sender_full_name": "oliver",
        "timestamp": 1611933937
    },
    {
        "content": "<p>My thinking was that there were some tasks,s such as some of the experiments that cjgillot's done, that we could push over the finish line</p>",
        "id": 224485899,
        "sender_full_name": "pnkfelix",
        "timestamp": 1611933956
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"116083\">pnkfelix</span> <a href=\"#narrow/stream/238009-t-compiler.2Fmeetings/topic/.5Bsteering.20meeting.5D.202021-01-29/near/224485899\">said</a>:</p>\n<blockquote>\n<p>My thinking was that there were some tasks,s such as some of the experiments that cjgillot's done, that we could push over the finish line</p>\n</blockquote>\n<p>if you mean the 'move queries to a separate crate' PR, I don't know if that actually helped compile times</p>",
        "id": 224485993,
        "sender_full_name": "Joshua Nelson",
        "timestamp": 1611933984
    },
    {
        "content": "<p>it just moved them around</p>",
        "id": 224486004,
        "sender_full_name": "Joshua Nelson",
        "timestamp": 1611933989
    },
    {
        "content": "<p><a href=\"https://github.com/rust-lang/rust/pull/70951#issuecomment-766292996\">https://github.com/rust-lang/rust/pull/70951#issuecomment-766292996</a></p>\n<p>Shows a 2 minute wall-clock time improvement of bootstrap performance.</p>",
        "id": 224486038,
        "sender_full_name": "Wesley Wiser",
        "timestamp": 1611934007
    },
    {
        "content": "<p>IMO, the worst pain point is on memory usage: using incremental un rustc makes my (4G RAM) computer swap itself to death. A sprint dedicated to this memory usage issue could be worthwhile (opposed to wall-time perf).</p>",
        "id": 224486042,
        "sender_full_name": "cjgillot",
        "timestamp": 1611934008
    },
    {
        "content": "<p>oh huh, that must be recent. Ignore me, sorry</p>",
        "id": 224486151,
        "sender_full_name": "Joshua Nelson",
        "timestamp": 1611934053
    },
    {
        "content": "<p>hMm</p>",
        "id": 224486204,
        "sender_full_name": "pnkfelix",
        "timestamp": 1611934076
    },
    {
        "content": "<p>On <a href=\"https://github.com/rust-lang/rust/issues/70951\">#70951</a>, there is an actual gain in compile time, because the compiler has less code to eat and encode trans-crates.</p>",
        "id": 224486215,
        "sender_full_name": "cjgillot",
        "timestamp": 1611934080
    },
    {
        "content": "<p>So let me take a step back</p>",
        "id": 224486274,
        "sender_full_name": "pnkfelix",
        "timestamp": 1611934087
    },
    {
        "content": "<p>instead of debating the pro's/con's of focusing on incr-comp for the first sprint</p>",
        "id": 224486331,
        "sender_full_name": "pnkfelix",
        "timestamp": 1611934105
    },
    {
        "content": "<p>let me give a full overview of what people suggested as alternative focus areaws</p>",
        "id": 224486352,
        "sender_full_name": "pnkfelix",
        "timestamp": 1611934116
    },
    {
        "content": "<p>So as cjgillot already sad, memory usage is one potential focus area</p>",
        "id": 224486527,
        "sender_full_name": "pnkfelix",
        "timestamp": 1611934176
    },
    {
        "content": "<p>extending perf to get more comprehensive data about compiling rustc itself was another proposal</p>",
        "id": 224486648,
        "sender_full_name": "pnkfelix",
        "timestamp": 1611934209
    },
    {
        "content": "<p>(so that we might know better <em>what</em> to focus on)</p>",
        "id": 224486677,
        "sender_full_name": "pnkfelix",
        "timestamp": 1611934222
    },
    {
        "content": "<p>though that may be too specific to decidate a whole sprint to</p>",
        "id": 224486720,
        "sender_full_name": "pnkfelix",
        "timestamp": 1611934237
    },
    {
        "content": "<p>(there were some other specific ideas for improving compile-times, such as wg-polymorphization. I'm going to skip that as I dont' think its ideal for the first sprint, as a massive team  effort. But potentially an excellent project for a pair or similarly small group.)</p>",
        "id": 224486892,
        "sender_full_name": "pnkfelix",
        "timestamp": 1611934294
    },
    {
        "content": "<p>there were some suggestions about changes to x.py itself: Add self-profiling support to x.py, provide a different optimization level in x.py (where we might turn off ThinLTO or cross-module inlining)</p>",
        "id": 224487094,
        "sender_full_name": "pnkfelix",
        "timestamp": 1611934365
    },
    {
        "content": "<p>Another potential improvement would be to use our split dwarf support in bootstrap to reduce link times/memory usage (there are some things blocking that, but entirely achievable)</p>",
        "id": 224487188,
        "sender_full_name": "davidtwco",
        "timestamp": 1611934396
    },
    {
        "content": "<p>likewise, utilize self-profiling to understand how the query system is making rustc_middle so costly. That ties into what was noted up above.</p>",
        "id": 224487206,
        "sender_full_name": "pnkfelix",
        "timestamp": 1611934400
    },
    {
        "content": "<p>On x.py specifically, allow to run tests without first compiling <code>core</code>.</p>",
        "id": 224487371,
        "sender_full_name": "cjgillot",
        "timestamp": 1611934449
    },
    {
        "content": "<p>Niko also mentioned a desire to push chalk-ty and type library forward. I hadn't considered either of those as candidates for the initial sprint.</p>",
        "id": 224487407,
        "sender_full_name": "pnkfelix",
        "timestamp": 1611934461
    },
    {
        "content": "<p>or something related to out of tree crates which are essentially experimental<br>\ncompiler features/RFCs?</p>",
        "id": 224487443,
        "sender_full_name": "oliver",
        "timestamp": 1611934478
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"248906\">cjgillot</span> <a href=\"#narrow/stream/238009-t-compiler.2Fmeetings/topic/.5Bsteering.20meeting.5D.202021-01-29/near/224487371\">said</a>:</p>\n<blockquote>\n<p>On x.py specifically, allow to run tests without first compiling <code>core</code>.</p>\n</blockquote>\n<p>it would be nice to be able to compile core without compiling std, that would get most of the tests I think</p>",
        "id": 224487489,
        "sender_full_name": "Joshua Nelson",
        "timestamp": 1611934495
    },
    {
        "content": "<p>So, okay, that's the top level summary of what people mentioned as alternatives to what I had said of just focusing on incremental compilation</p>",
        "id": 224487536,
        "sender_full_name": "pnkfelix",
        "timestamp": 1611934510
    },
    {
        "content": "<p>has anyone looked into the 40% compile time regression for core a few weeks ago?</p>",
        "id": 224487549,
        "sender_full_name": "Joshua Nelson",
        "timestamp": 1611934515
    },
    {
        "content": "<p>it was reasonably fast before that</p>",
        "id": 224487576,
        "sender_full_name": "Joshua Nelson",
        "timestamp": 1611934526
    },
    {
        "content": "<p>Investigating recent regressions more generally is an interesting thing to consider</p>",
        "id": 224487655,
        "sender_full_name": "davidtwco",
        "timestamp": 1611934560
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"232545\">Joshua Nelson</span> <a href=\"#narrow/stream/238009-t-compiler.2Fmeetings/topic/.5Bsteering.20meeting.5D.202021-01-29/near/224487489\">said</a>:</p>\n<blockquote>\n<p><span class=\"user-mention silent\" data-user-id=\"248906\">cjgillot</span> <a href=\"#narrow/stream/238009-t-compiler.2Fmeetings/topic/.5Bsteering.20meeting.5D.202021-01-29/near/224487371\">said</a>:</p>\n<blockquote>\n<p>On x.py specifically, allow to run tests without first compiling <code>core</code>.</p>\n</blockquote>\n<p>it would be nice to be able to compile core without compiling std, that would get most of the tests I think</p>\n</blockquote>\n<p>this is interesting. I don't know if I believe it, but maybe its true.</p>",
        "id": 224487659,
        "sender_full_name": "pnkfelix",
        "timestamp": 1611934561
    },
    {
        "content": "<p>is building libstd <em>that</em> big a cost today to the cycle time?</p>",
        "id": 224487800,
        "sender_full_name": "pnkfelix",
        "timestamp": 1611934606
    },
    {
        "content": "<p>building libcore + libstd takes about as long as rustdoc for me, so about 30 seconds</p>",
        "id": 224487826,
        "sender_full_name": "Joshua Nelson",
        "timestamp": 1611934621
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"232545\">Joshua Nelson</span> <a href=\"#narrow/stream/238009-t-compiler.2Fmeetings/topic/.5Bsteering.20meeting.5D.202021-01-29/near/224487489\">said</a>:</p>\n<blockquote>\n<p><span class=\"user-mention silent\" data-user-id=\"248906\">cjgillot</span> <a href=\"#narrow/stream/238009-t-compiler.2Fmeetings/topic/.5Bsteering.20meeting.5D.202021-01-29/near/224487371\">said</a>:</p>\n<blockquote>\n<p>On x.py specifically, allow to run tests without first compiling <code>core</code>.</p>\n</blockquote>\n<p>it would be nice to be able to compile core without compiling std, that would get most of the tests I think</p>\n</blockquote>\n<p>Also, tests without libcore can be useful to isolate and debug a newly added ICE.</p>",
        "id": 224487828,
        "sender_full_name": "cjgillot",
        "timestamp": 1611934621
    },
    {
        "content": "<p>it would be really nice not to have to pay that each and every build</p>",
        "id": 224487855,
        "sender_full_name": "Joshua Nelson",
        "timestamp": 1611934633
    },
    {
        "content": "<p>In my experience, <code>#![no_core]</code> tests are a real pain to write.</p>",
        "id": 224487881,
        "sender_full_name": "pnkfelix",
        "timestamp": 1611934644
    },
    {
        "content": "<p>They are super valuable once you have them</p>",
        "id": 224487900,
        "sender_full_name": "pnkfelix",
        "timestamp": 1611934652
    },
    {
        "content": "<p>but I wouldn't want to put a ton of effort into trying to port our current tests to be <code>#![no_core]</code></p>",
        "id": 224487941,
        "sender_full_name": "pnkfelix",
        "timestamp": 1611934666
    },
    {
        "content": "<p>if we could make them <code>#![no_std]</code> by default I think that would have the biggest impact and not too hard to do</p>",
        "id": 224488028,
        "sender_full_name": "Joshua Nelson",
        "timestamp": 1611934691
    },
    {
        "content": "<p><code>#![no_std]</code> on the other hand, <em>that</em> does sound intriguing. If I had some confidence that it could really help cycle times for local development, it could be interesting.</p>",
        "id": 224488042,
        "sender_full_name": "pnkfelix",
        "timestamp": 1611934695
    },
    {
        "content": "<p>But our current setup, one cannot easily see the time spent building libstd separate from libcore, right?</p>",
        "id": 224488113,
        "sender_full_name": "pnkfelix",
        "timestamp": 1611934726
    },
    {
        "content": "<p>(Or am I just wrong  about that?)</p>",
        "id": 224488128,
        "sender_full_name": "pnkfelix",
        "timestamp": 1611934731
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"116083\">pnkfelix</span> <a href=\"#narrow/stream/238009-t-compiler.2Fmeetings/topic/.5Bsteering.20meeting.5D.202021-01-29/near/224488113\">said</a>:</p>\n<blockquote>\n<p>But our current setup, one cannot easily see the time spent building libstd separate from libcore, right?</p>\n</blockquote>\n<p>you can use <code>CARGOFLAGS_NOT_BOOTSTRAP=-Ztimings</code> (or something like that, not sure the exact env var)</p>",
        "id": 224488145,
        "sender_full_name": "Joshua Nelson",
        "timestamp": 1611934738
    },
    {
        "content": "<p>okay</p>",
        "id": 224488177,
        "sender_full_name": "pnkfelix",
        "timestamp": 1611934754
    },
    {
        "content": "<p>This actually ties into a slightly related topic</p>",
        "id": 224488203,
        "sender_full_name": "pnkfelix",
        "timestamp": 1611934766
    },
    {
        "content": "<p>earlier in the week, some of us were discussing gathering timing info from contributors</p>",
        "id": 224488260,
        "sender_full_name": "pnkfelix",
        "timestamp": 1611934793
    },
    {
        "content": "<p>i.e. sending out a survey with a little script that downloads a certain commit from github and does a build, makes  a change, rebuilds, makes another changes, rebuilds</p>",
        "id": 224488362,
        "sender_full_name": "pnkfelix",
        "timestamp": 1611934821
    },
    {
        "content": "<p>reports timings</p>",
        "id": 224488387,
        "sender_full_name": "pnkfelix",
        "timestamp": 1611934827
    },
    {
        "content": "<p>and then have them send the transcript back to us</p>",
        "id": 224488400,
        "sender_full_name": "pnkfelix",
        "timestamp": 1611934832
    },
    {
        "content": "<p>I like that idea :)</p>",
        "id": 224488434,
        "sender_full_name": "Joshua Nelson",
        "timestamp": 1611934845
    },
    {
        "content": "<p>with the intent of us to better understand what experience is like for real world developers</p>",
        "id": 224488447,
        "sender_full_name": "pnkfelix",
        "timestamp": 1611934850
    },
    {
        "content": "<p>I am now realizing that part of that should be getting the breakdown for libcore vs libstd</p>",
        "id": 224488513,
        "sender_full_name": "pnkfelix",
        "timestamp": 1611934874
    },
    {
        "content": "<p>because that <em>would</em> help inform this question of \"is there a benefit to such a separation\"</p>",
        "id": 224488552,
        "sender_full_name": "pnkfelix",
        "timestamp": 1611934894
    },
    {
        "content": "<p>I also want to reiterate that core until recently was <em>much</em> faster than libstd to build</p>",
        "id": 224488559,
        "sender_full_name": "Joshua Nelson",
        "timestamp": 1611934897
    },
    {
        "content": "<p>and only recently has it become slower</p>",
        "id": 224488578,
        "sender_full_name": "Joshua Nelson",
        "timestamp": 1611934903
    },
    {
        "content": "<p>right. We <em>should</em> look into that too</p>",
        "id": 224488601,
        "sender_full_name": "pnkfelix",
        "timestamp": 1611934913
    },
    {
        "content": "<p>so the info you collect in the survey won't pick up on that difference</p>",
        "id": 224488629,
        "sender_full_name": "Joshua Nelson",
        "timestamp": 1611934920
    },
    {
        "content": "<p>Similarly, could we add something to bootstrap which would collect the diffs applied to commits and the incremental timings afterwards - retrospectively, could say \"that diff was small and incremental took a while, why was that?\" - or something to identify real-world cases where incremental was doing more work than would be expected.</p>",
        "id": 224488709,
        "sender_full_name": "davidtwco",
        "timestamp": 1611934939
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"232545\">Joshua Nelson</span> <a href=\"#narrow/stream/238009-t-compiler.2Fmeetings/topic/.5Bsteering.20meeting.5D.202021-01-29/near/224488629\">said</a>:</p>\n<blockquote>\n<p>so the info you collect in the survey won't pick up on that difference</p>\n</blockquote>\n<p>well it will if we pick a sufficient old point in the repo</p>",
        "id": 224488738,
        "sender_full_name": "pnkfelix",
        "timestamp": 1611934954
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"116107\">davidtwco</span> <a href=\"#narrow/stream/238009-t-compiler.2Fmeetings/topic/.5Bsteering.20meeting.5D.202021-01-29/near/224488709\">said</a>:</p>\n<blockquote>\n<p>Similarly, could we add something to bootstrap which would collect the diffs applied to commits and the incremental timings afterwards - retrospectively, could say \"that diff was small and incremental took a while, why was that?\" - or something to identify real-world cases where incremental was doing more work than would be expected.</p>\n</blockquote>\n<p>That's a <em>really</em> interesting idea.</p>",
        "id": 224488844,
        "sender_full_name": "pnkfelix",
        "timestamp": 1611934994
    },
    {
        "content": "<p>Its one thing to try to add that to <em>everyone's</em> project by making it e.g. built into cargo</p>",
        "id": 224488890,
        "sender_full_name": "pnkfelix",
        "timestamp": 1611935011
    },
    {
        "content": "<p>(like, all kinds of problemantic issues there, I mean)</p>",
        "id": 224488925,
        "sender_full_name": "pnkfelix",
        "timestamp": 1611935027
    },
    {
        "content": "<p>but adding it to our own makes a heck of a lot of sense.</p>",
        "id": 224488955,
        "sender_full_name": "pnkfelix",
        "timestamp": 1611935041
    },
    {
        "content": "<p>Yeah, this almost sounds more interesting to me as a general tool.</p>",
        "id": 224488969,
        "sender_full_name": "Wesley Wiser",
        "timestamp": 1611935042
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"125250\">Wesley Wiser</span> <a href=\"#narrow/stream/238009-t-compiler.2Fmeetings/topic/.5Bsteering.20meeting.5D.202021-01-29/near/224488969\">said</a>:</p>\n<blockquote>\n<p>Yeah, this almost sounds more interesting to me as a general tool.</p>\n</blockquote>\n<p>something like cargo-bisect-rustc, maybe? a cargo plugin, but 'blessed' by the rust-lang org?</p>",
        "id": 224489099,
        "sender_full_name": "Joshua Nelson",
        "timestamp": 1611935086
    },
    {
        "content": "<p>We need to be very careful around anything that auto collects metrics and auto sends them to a third party (us)</p>",
        "id": 224489110,
        "sender_full_name": "Esteban KÃ¼ber",
        "timestamp": 1611935089
    },
    {
        "content": "<p>A problem with doing a survey like this, is that we will either have to delay choosing the sprint topic until after we get the survey results</p>",
        "id": 224489123,
        "sender_full_name": "pnkfelix",
        "timestamp": 1611935094
    },
    {
        "content": "<p>or we have to choose a topic that will work <em>independently</em> of the survey  results</p>",
        "id": 224489159,
        "sender_full_name": "pnkfelix",
        "timestamp": 1611935108
    },
    {
        "content": "<p>When working on rustc, I found using incremental to be often counter-productive due to frequent linking errors like those described in <a href=\"#narrow/stream/182449-t-compiler.2Fhelp/topic/Spurious.20linker.20errors.20building.20rustc\">https://rust-lang.zulipchat.com/#narrow/stream/182449-t-compiler.2Fhelp/topic/Spurious.20linker.20errors.20building.20rustc</a> , since only reliable way I know to fix them is to start build from scratch.</p>",
        "id": 224489172,
        "sender_full_name": "tm",
        "timestamp": 1611935115
    },
    {
        "content": "<p>There might be some overlap with the tool wg-incr-comp has talked about for a while now that would try to give us more reproducible ICE's from incremental issues.</p>",
        "id": 224489174,
        "sender_full_name": "Wesley Wiser",
        "timestamp": 1611935116
    },
    {
        "content": "<p>There is plenty of work to be done. Don't think we need to delay.</p>",
        "id": 224489228,
        "sender_full_name": "Esteban KÃ¼ber",
        "timestamp": 1611935135
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"119031\">Esteban KÃ¼ber</span> <a href=\"#narrow/stream/238009-t-compiler.2Fmeetings/topic/.5Bsteering.20meeting.5D.202021-01-29/near/224489110\">said</a>:</p>\n<blockquote>\n<p>We need to be very careful around anything that auto collects metrics and auto sends them to a third party (us)</p>\n</blockquote>\n<p>This was part of what I was alluding to when I said \"problematic.\" But adding something to x.py that says \"Hey would you mind cut-and-pasting the following into an issue on rust-lang/rust\" sounds doable to me.</p>",
        "id": 224489280,
        "sender_full_name": "pnkfelix",
        "timestamp": 1611935155
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"119031\">Esteban KÃ¼ber</span> <a href=\"#narrow/stream/238009-t-compiler.2Fmeetings/topic/.5Bsteering.20meeting.5D.202021-01-29/near/224489228\">said</a>:</p>\n<blockquote>\n<p>There is plenty of work to be done. Don't think we need to delay.</p>\n</blockquote>\n<p>Right, I'm just saying: There are some great ideas here that I think would be best informed by such a survey</p>",
        "id": 224489418,
        "sender_full_name": "pnkfelix",
        "timestamp": 1611935202
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"116083\">pnkfelix</span> <a href=\"#narrow/stream/238009-t-compiler.2Fmeetings/topic/.5Bsteering.20meeting.5D.202021-01-29/near/224489418\">said</a>:</p>\n<blockquote>\n<p><span class=\"user-mention silent\" data-user-id=\"119031\">Esteban KÃ¼ber</span> <a href=\"#narrow/stream/238009-t-compiler.2Fmeetings/topic/.5Bsteering.20meeting.5D.202021-01-29/near/224489228\">said</a>:</p>\n<blockquote>\n<p>There is plenty of work to be done. Don't think we need to delay.</p>\n</blockquote>\n<p>Right, I'm just saying: There are some great ideas here that I think would be best informed by such a survey</p>\n</blockquote>\n<p>since we're planning multiple sprints, I think it's fine to address them later</p>",
        "id": 224489483,
        "sender_full_name": "Joshua Nelson",
        "timestamp": 1611935227
    },
    {
        "content": "<p>Which means we can just do them in a later sprint, (or independently of the sprint)</p>",
        "id": 224489484,
        "sender_full_name": "pnkfelix",
        "timestamp": 1611935228
    },
    {
        "content": "<p>oh heh I wish zulip has 'typing' notifications <span aria-label=\"laughing\" class=\"emoji emoji-1f606\" role=\"img\" title=\"laughing\">:laughing:</span></p>",
        "id": 224489515,
        "sender_full_name": "Joshua Nelson",
        "timestamp": 1611935242
    },
    {
        "content": "<p>but we have 13 minutes minutes left in this meeting</p>",
        "id": 224489522,
        "sender_full_name": "pnkfelix",
        "timestamp": 1611935247
    },
    {
        "content": "<p>So, there's a lot of good ideas here but I think we should try to make sure that whatever we decide to do during the sprint is something that can reasonably be completed within the sprint.</p>",
        "id": 224489541,
        "sender_full_name": "Wesley Wiser",
        "timestamp": 1611935256
    },
    {
        "content": "<p>so there are two main things I want to try to figure out in time remaiing</p>",
        "id": 224489560,
        "sender_full_name": "pnkfelix",
        "timestamp": 1611935266
    },
    {
        "content": "<ol>\n<li>should we do a survey; if so, who wants to help and what is its timeline.</li>\n</ol>",
        "id": 224489647,
        "sender_full_name": "pnkfelix",
        "timestamp": 1611935289
    },
    {
        "content": "<ol start=\"2\">\n<li>what <em>is</em> the sprint focus</li>\n</ol>",
        "id": 224489660,
        "sender_full_name": "pnkfelix",
        "timestamp": 1611935299
    },
    {
        "content": "<p>To be honest, I'm half-way tempted to make the sprint topic be memory usage</p>",
        "id": 224489676,
        "sender_full_name": "pnkfelix",
        "timestamp": 1611935307
    },
    {
        "content": "<p>I am happy to help with the survey.</p>",
        "id": 224489712,
        "sender_full_name": "Joshua Nelson",
        "timestamp": 1611935322
    },
    {
        "content": "<p>becasuse I think we <em>can</em>  get huge wins there, and based on my expectations of typical machines, it will reap big benefits</p>",
        "id": 224489746,
        "sender_full_name": "pnkfelix",
        "timestamp": 1611935342
    },
    {
        "content": "<p>memory usage concerns me, because we don't have reliable measurement yet, but it may be possible to try to get that implemented before then. I don't really know where to start on that though.</p>",
        "id": 224489800,
        "sender_full_name": "simulacrum",
        "timestamp": 1611935369
    },
    {
        "content": "<p>(plus if we generalize focus to more cache-friendly behavior overall, <em>everyone</em> will benefit.)</p>",
        "id": 224489810,
        "sender_full_name": "pnkfelix",
        "timestamp": 1611935370
    },
    {
        "content": "<p>Would a week focused on perf-related work cause the perf queue to become so long as to cause problems?</p>",
        "id": 224489818,
        "sender_full_name": "davidtwco",
        "timestamp": 1611935374
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"116107\">davidtwco</span> <a href=\"#narrow/stream/238009-t-compiler.2Fmeetings/topic/.5Bsteering.20meeting.5D.202021-01-29/near/224489818\">said</a>:</p>\n<blockquote>\n<p>Would a week focused on perf-related work cause the perf queue to become so long as to cause problems?</p>\n</blockquote>\n<p>it would be nice to figure out how to measure perf locally</p>",
        "id": 224489854,
        "sender_full_name": "Joshua Nelson",
        "timestamp": 1611935390
    },
    {
        "content": "<p>personally I would hate to have to wait 3+ hours to see if a change helps</p>",
        "id": 224489878,
        "sender_full_name": "Joshua Nelson",
        "timestamp": 1611935399
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"116107\">davidtwco</span> <a href=\"#narrow/stream/238009-t-compiler.2Fmeetings/topic/.5Bsteering.20meeting.5D.202021-01-29/near/224489818\">said</a>:</p>\n<blockquote>\n<p>Would a week focused on perf-related work cause the perf queue to become so long as to cause problems?</p>\n</blockquote>\n<p><span class=\"user-mention\" data-user-id=\"116122\">@simulacrum</span> told me yesteday that perf is cheap, so that means it free, right? <span aria-label=\"wink\" class=\"emoji emoji-1f609\" role=\"img\" title=\"wink\">:wink:</span></p>",
        "id": 224489938,
        "sender_full_name": "pnkfelix",
        "timestamp": 1611935408
    },
    {
        "content": "<p>I think an excellent project for leading up to the sprint then</p>",
        "id": 224490013,
        "sender_full_name": "pnkfelix",
        "timestamp": 1611935437
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"232545\">Joshua Nelson</span> <a href=\"#narrow/stream/238009-t-compiler.2Fmeetings/topic/.5Bsteering.20meeting.5D.202021-01-29/near/224489854\">said</a>:</p>\n<blockquote>\n<p><span class=\"user-mention silent\" data-user-id=\"116107\">davidtwco</span> <a href=\"#narrow/stream/238009-t-compiler.2Fmeetings/topic/.5Bsteering.20meeting.5D.202021-01-29/near/224489818\">said</a>:</p>\n<blockquote>\n<p>Would a week focused on perf-related work cause the perf queue to become so long as to cause problems?</p>\n</blockquote>\n<p>it would be nice to figure out how to measure perf locally</p>\n</blockquote>\n<p>Is stage 1 build time/memory a reliable indicator?</p>",
        "id": 224490036,
        "sender_full_name": "cjgillot",
        "timestamp": 1611935447
    },
    {
        "content": "<p>might be to actually standardize on some tooling + methodology</p>",
        "id": 224490037,
        "sender_full_name": "pnkfelix",
        "timestamp": 1611935447
    },
    {
        "content": "<p>I've found that measuring perf locally is frustrating for three reasons: 1) it takes a while and I don't want to use the computer much during it, as that could impact the results, 2) I use NixOS and that makes everything difficult, 3) I need to do a another run as a baseline</p>",
        "id": 224490042,
        "sender_full_name": "davidtwco",
        "timestamp": 1611935448
    },
    {
        "content": "<p>for local measurement</p>",
        "id": 224490045,
        "sender_full_name": "pnkfelix",
        "timestamp": 1611935449
    },
    {
        "content": "<p>of memory uage</p>",
        "id": 224490065,
        "sender_full_name": "pnkfelix",
        "timestamp": 1611935457
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"116107\">davidtwco</span> <a href=\"#narrow/stream/238009-t-compiler.2Fmeetings/topic/.5Bsteering.20meeting.5D.202021-01-29/near/224490042\">said</a>:</p>\n<blockquote>\n<p>I've found that measuring perf locally is frustrating for two reasons: 1) it takes a while and I don't want to use the computer much to influence the results and 2) I use NixOS and that makes everything difficult</p>\n</blockquote>\n<p>(+) it's never obvious what the difference is that makes a difference</p>",
        "id": 224490136,
        "sender_full_name": "oliver",
        "timestamp": 1611935485
    },
    {
        "content": "<p>Memory usage results should tend to be insensitive to concurrent usage of the workstationk, right <span class=\"user-mention\" data-user-id=\"116107\">@davidtwco</span> ?</p>",
        "id": 224490159,
        "sender_full_name": "pnkfelix",
        "timestamp": 1611935492
    },
    {
        "content": "<p>eh, even e.g. fragmentation of memory space could affect those, in theory, but I suppose it depends on how you measure</p>",
        "id": 224490273,
        "sender_full_name": "simulacrum",
        "timestamp": 1611935526
    },
    {
        "content": "<p>As I recall, it's also one of the least consistent perf metrics we track</p>",
        "id": 224490277,
        "sender_full_name": "Wesley Wiser",
        "timestamp": 1611935528
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"116083\">pnkfelix</span> <a href=\"#narrow/stream/238009-t-compiler.2Fmeetings/topic/.5Bsteering.20meeting.5D.202021-01-29/near/224490159\">said</a>:</p>\n<blockquote>\n<p>Memory usage results should tend to be insensitive to concurrent usage of the workstationk, right <span class=\"user-mention silent\" data-user-id=\"116107\">davidtwco</span> ?</p>\n</blockquote>\n<p>Assuming we made our memory measurement less impacted by noise, I would imagine so.</p>",
        "id": 224490295,
        "sender_full_name": "davidtwco",
        "timestamp": 1611935537
    },
    {
        "content": "<p>I've never gotten deterministic measurements of memory usage</p>",
        "id": 224490320,
        "sender_full_name": "simulacrum",
        "timestamp": 1611935546
    },
    {
        "content": "<p>yes, if we were talking about measuring cache misses and what not</p>",
        "id": 224490335,
        "sender_full_name": "pnkfelix",
        "timestamp": 1611935551
    },
    {
        "content": "<p>then you might have issues</p>",
        "id": 224490341,
        "sender_full_name": "pnkfelix",
        "timestamp": 1611935554
    },
    {
        "content": "<p>ideally you have a bunch of very similar systems with only minor differences</p>",
        "id": 224490385,
        "sender_full_name": "oliver",
        "timestamp": 1611935572
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"125250\">Wesley Wiser</span> <a href=\"#narrow/stream/238009-t-compiler.2Fmeetings/topic/.5Bsteering.20meeting.5D.202021-01-29/near/224490277\">said</a>:</p>\n<blockquote>\n<p>As I recall, it's also one of the least consistent perf metrics we track</p>\n</blockquote>\n<p>interesting. Okay then I need to learn more about why this is</p>",
        "id": 224490407,
        "sender_full_name": "pnkfelix",
        "timestamp": 1611935581
    },
    {
        "content": "<p>and if swapping in a different allocator could help</p>",
        "id": 224490440,
        "sender_full_name": "pnkfelix",
        "timestamp": 1611935594
    },
    {
        "content": "<p>We probably measure <code>peak rss</code>, don't we? If we measure amount of memory allocated/deallocated then it would probably give more deterministic results, but also would require a separate run and maybe build so that the perf results are not affected.</p>",
        "id": 224490455,
        "sender_full_name": "nagisa",
        "timestamp": 1611935599
    },
    {
        "content": "<p>So, seven minuts left</p>",
        "id": 224490487,
        "sender_full_name": "pnkfelix",
        "timestamp": 1611935618
    },
    {
        "content": "<p>we measure max-rss as reported by <code>perf stat</code>, probably peak rss yeah</p>",
        "id": 224490488,
        "sender_full_name": "simulacrum",
        "timestamp": 1611935618
    },
    {
        "content": "<p>/me wonders if eddyb's work on perf-counters profiling landed.</p>",
        "id": 224490510,
        "sender_full_name": "nagisa",
        "timestamp": 1611935626
    },
    {
        "content": "<p>Does anyone <em>object</em> to the first sprint being dedicated to memory usage?</p>",
        "id": 224490518,
        "sender_full_name": "pnkfelix",
        "timestamp": 1611935629
    },
    {
        "content": "<p>wg-incr-comp has discussed before filesystem related issues that, for example, affect specific platforms where soft/hard links are more expensive - issues like those, that might not be measured by perf (as it only tests Linux), could be worth looking into</p>",
        "id": 224490540,
        "sender_full_name": "davidtwco",
        "timestamp": 1611935638
    },
    {
        "content": "<p>Would compiling some crate inside valgrind be sufficient?</p>",
        "id": 224490608,
        "sender_full_name": "cjgillot",
        "timestamp": 1611935649
    },
    {
        "content": "<p>I am worried about it not being clear to me what the fruit to pick there is, but not really <em>object</em> I guess</p>",
        "id": 224490631,
        "sender_full_name": "simulacrum",
        "timestamp": 1611935656
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"248906\">cjgillot</span> <a href=\"#narrow/stream/238009-t-compiler.2Fmeetings/topic/.5Bsteering.20meeting.5D.202021-01-29/near/224490608\">said</a>:</p>\n<blockquote>\n<p>Would compiling some crate inside valgrind be sufficient?</p>\n</blockquote>\n<p>I believe rustc uses jemalloc, which, last I checked, is not compatible with valgrind.</p>",
        "id": 224490709,
        "sender_full_name": "nagisa",
        "timestamp": 1611935687
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"123586\">nagisa</span> <a href=\"#narrow/stream/238009-t-compiler.2Fmeetings/topic/.5Bsteering.20meeting.5D.202021-01-29/near/224490709\">said</a>:</p>\n<blockquote>\n<p><span class=\"user-mention silent\" data-user-id=\"248906\">cjgillot</span> <a href=\"#narrow/stream/238009-t-compiler.2Fmeetings/topic/.5Bsteering.20meeting.5D.202021-01-29/near/224490608\">said</a>:</p>\n<blockquote>\n<p>Would compiling some crate inside valgrind be sufficient?</p>\n</blockquote>\n<p>I believe rustc uses jemalloc, which, last I checked is not compatible with valgrind.</p>\n</blockquote>\n<p>jemalloc is off by default IIRC</p>",
        "id": 224490737,
        "sender_full_name": "Joshua Nelson",
        "timestamp": 1611935698
    },
    {
        "content": "<p>at one time rustc was turning it back on</p>",
        "id": 224490772,
        "sender_full_name": "pnkfelix",
        "timestamp": 1611935717
    },
    {
        "content": "<p>CI builds are jemalloc'd for sure</p>",
        "id": 224490777,
        "sender_full_name": "simulacrum",
        "timestamp": 1611935719
    },
    {
        "content": "<p>it is possible that it is the cause of noise; I don't know.</p>",
        "id": 224490796,
        "sender_full_name": "simulacrum",
        "timestamp": 1611935733
    },
    {
        "content": "<p>Okay so the only objection I heard was <span class=\"user-mention\" data-user-id=\"116122\">@simulacrum</span> 's concern about whether there would be sufficient fruit to pick there</p>",
        "id": 224490850,
        "sender_full_name": "pnkfelix",
        "timestamp": 1611935753
    },
    {
        "content": "<p>I think the reality is that the memory usage <em>is</em> driving away some contributors</p>",
        "id": 224490916,
        "sender_full_name": "pnkfelix",
        "timestamp": 1611935767
    },
    {
        "content": "<p><a href=\"https://github.com/jemalloc/jemalloc/wiki/Use-Case%3A-Heap-Profiling\">https://github.com/jemalloc/jemalloc/wiki/Use-Case%3A-Heap-Profiling</a></p>",
        "id": 224490922,
        "sender_full_name": "nagisa",
        "timestamp": 1611935769
    },
    {
        "content": "<p>so if there isn't fruit to pick, we're in big trouble.</p>",
        "id": 224490940,
        "sender_full_name": "pnkfelix",
        "timestamp": 1611935774
    },
    {
        "content": "<p>well, sufficient, not so much, but more like I'd like to go in with:</p>\n<ul>\n<li>measurement plan </li>\n<li>5-10 pretty concrete issues</li>\n</ul>",
        "id": 224490970,
        "sender_full_name": "simulacrum",
        "timestamp": 1611935786
    },
    {
        "content": "<p>to any sprint, I think</p>",
        "id": 224490988,
        "sender_full_name": "simulacrum",
        "timestamp": 1611935792
    },
    {
        "content": "<p>Not everyone may know this, but my recollection is that when eddyb first started contributing</p>",
        "id": 224490989,
        "sender_full_name": "pnkfelix",
        "timestamp": 1611935793
    },
    {
        "content": "<p>their primary focus was memory usage</p>",
        "id": 224491004,
        "sender_full_name": "pnkfelix",
        "timestamp": 1611935799
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"116083\">pnkfelix</span> <a href=\"#narrow/stream/238009-t-compiler.2Fmeetings/topic/.5Bsteering.20meeting.5D.202021-01-29/near/224490916\">said</a>:</p>\n<blockquote>\n<p>I think the reality is that the memory usage <em>is</em> driving away some contributors</p>\n</blockquote>\n<p>bootstrap memory use or memory use in general?</p>",
        "id": 224491008,
        "sender_full_name": "nagisa",
        "timestamp": 1611935800
    },
    {
        "content": "<p>/me is very happy to be back on his PC with 32 GB of RAM vs his macbook with 16 GB</p>",
        "id": 224491028,
        "sender_full_name": "rylev",
        "timestamp": 1611935807
    },
    {
        "content": "<p>bootstrap memory usage</p>",
        "id": 224491032,
        "sender_full_name": "pnkfelix",
        "timestamp": 1611935808
    },
    {
        "content": "<p>but good point to clarify</p>",
        "id": 224491050,
        "sender_full_name": "pnkfelix",
        "timestamp": 1611935815
    },
    {
        "content": "<p>/me only has 8 GB RAM <span aria-label=\"sob\" class=\"emoji emoji-1f62d\" role=\"img\" title=\"sob\">:sob:</span></p>",
        "id": 224491066,
        "sender_full_name": "Joshua Nelson",
        "timestamp": 1611935823
    },
    {
        "content": "<p>/me has 4G</p>",
        "id": 224491095,
        "sender_full_name": "cjgillot",
        "timestamp": 1611935834
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"116122\">simulacrum</span> <a href=\"#narrow/stream/238009-t-compiler.2Fmeetings/topic/.5Bsteering.20meeting.5D.202021-01-29/near/224490970\">said</a>:</p>\n<blockquote>\n<p>well, sufficient, not so much, but more like I'd like to go in with:</p>\n<ul>\n<li>measurement plan </li>\n<li>5-10 pretty concrete issues</li>\n</ul>\n</blockquote>\n<p>yes. I think part of the work leading up to the sprint</p>",
        "id": 224491115,
        "sender_full_name": "pnkfelix",
        "timestamp": 1611935842
    },
    {
        "content": "<p>needs to be acquriing those things</p>",
        "id": 224491134,
        "sender_full_name": "pnkfelix",
        "timestamp": 1611935851
    },
    {
        "content": "<p>I don't think I would contribute if I had so little RAM. It was already painful with 16...</p>",
        "id": 224491153,
        "sender_full_name": "rylev",
        "timestamp": 1611935859
    },
    {
        "content": "<p>yeah this mostly works because I only compile rustdoc and need only compile rustc once in a while</p>",
        "id": 224491293,
        "sender_full_name": "Joshua Nelson",
        "timestamp": 1611935893
    },
    {
        "content": "<p>so the other topic</p>",
        "id": 224491352,
        "sender_full_name": "pnkfelix",
        "timestamp": 1611935911
    },
    {
        "content": "<p>is the survey</p>",
        "id": 224491358,
        "sender_full_name": "pnkfelix",
        "timestamp": 1611935913
    },
    {
        "content": "<p>Has bootstrapping rustc memory usage gotten a lot worse over the last few years? I don't remember having issues with 16G when I started, but been on 64G in the last year and a half.</p>",
        "id": 224491376,
        "sender_full_name": "davidtwco",
        "timestamp": 1611935919
    },
    {
        "content": "<p>which I don't think <em>has</em> to happen before the sprint</p>",
        "id": 224491397,
        "sender_full_name": "pnkfelix",
        "timestamp": 1611935926
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"116107\">davidtwco</span> <a href=\"#narrow/stream/238009-t-compiler.2Fmeetings/topic/.5Bsteering.20meeting.5D.202021-01-29/near/224491376\">said</a>:</p>\n<blockquote>\n<p>Has bootstrapping rustc memory usage gotten a lot worse over the last few years? I don't remember having issues with 16G when I started, but been on 64G in the last year and a half.</p>\n</blockquote>\n<p>I think part of the problem is this isn't tracked very well</p>",
        "id": 224491424,
        "sender_full_name": "Joshua Nelson",
        "timestamp": 1611935937
    },
    {
        "content": "<p>but it would probably be really cool to have the info at the start</p>",
        "id": 224491449,
        "sender_full_name": "pnkfelix",
        "timestamp": 1611935946
    },
    {
        "content": "<p>bootstrap requirements definitely gotten worse which is a natural consequence of rustc becoming larger</p>",
        "id": 224491450,
        "sender_full_name": "nagisa",
        "timestamp": 1611935947
    },
    {
        "content": "<p>there is a lot of focus on instruction counts, which are important, but at the detriment of other metrics</p>",
        "id": 224491474,
        "sender_full_name": "Joshua Nelson",
        "timestamp": 1611935956
    },
    {
        "content": "<p>(and maybe also the developers investing more money into their development machines)</p>",
        "id": 224491508,
        "sender_full_name": "pnkfelix",
        "timestamp": 1611935971
    },
    {
        "content": "<p>(i.e. I know my memory capacity has exploded, in part because I anticipated absurd needs if I wanted to run rustc in parallel)</p>",
        "id": 224491650,
        "sender_full_name": "pnkfelix",
        "timestamp": 1611936005
    },
    {
        "content": "<p>people are still able build using uploads to CI/CD if their systems aren't working?</p>",
        "id": 224491660,
        "sender_full_name": "oliver",
        "timestamp": 1611936006
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"281739\">@oliver</span> yes but that doesn't allow you to test things out locally</p>",
        "id": 224491761,
        "sender_full_name": "Joshua Nelson",
        "timestamp": 1611936030
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"232545\">Joshua Nelson</span> <a href=\"#narrow/stream/238009-t-compiler.2Fmeetings/topic/.5Bsteering.20meeting.5D.202021-01-29/near/224491474\">said</a>:</p>\n<blockquote>\n<p>there is a lot of focus on instruction counts, which are important, but at the detriment of other metrics</p>\n</blockquote>\n<p>(a lot of people would argue they aren't nearly as important as other metrics, like cache misses)</p>",
        "id": 224491793,
        "sender_full_name": "pnkfelix",
        "timestamp": 1611936036
    },
    {
        "content": "<p>at very least it introduces an hour delay between making a change and having the build available to test</p>",
        "id": 224491808,
        "sender_full_name": "Joshua Nelson",
        "timestamp": 1611936039
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"116107\">davidtwco</span> <a href=\"#narrow/stream/238009-t-compiler.2Fmeetings/topic/.5Bsteering.20meeting.5D.202021-01-29/near/224491376\">said</a>:</p>\n<blockquote>\n<p>Has bootstrapping rustc memory usage gotten a lot worse over the last few years? I don't remember having issues with 16G when I started, but been on 64G in the last year and a half.</p>\n</blockquote>\n<p>My very uninformed opinion is that with the librarification efforts, we're running a lot more concurrent jobs than we used to and that leads to higher memory peaks.</p>",
        "id": 224491824,
        "sender_full_name": "Wesley Wiser",
        "timestamp": 1611936042
    },
    {
        "content": "<p>We're at the hour</p>",
        "id": 224491922,
        "sender_full_name": "pnkfelix",
        "timestamp": 1611936060
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"232545\">Joshua Nelson</span> <a href=\"#narrow/stream/238009-t-compiler.2Fmeetings/topic/.5Bsteering.20meeting.5D.202021-01-29/near/224491761\">said</a>:</p>\n<blockquote>\n<p><span class=\"user-mention silent\" data-user-id=\"281739\">oliver</span> yes but that doesn't allow you to test things out locally</p>\n</blockquote>\n<p>wish I could ssh you into my computer</p>",
        "id": 224491952,
        "sender_full_name": "oliver",
        "timestamp": 1611936065
    },
    {
        "content": "<p>I'm going o open up a fresh topic for discussing the survey</p>",
        "id": 224491992,
        "sender_full_name": "pnkfelix",
        "timestamp": 1611936072
    },
    {
        "content": "<p><a class=\"stream-topic\" data-stream-id=\"131828\" href=\"/#narrow/stream/131828-t-compiler/topic/contributor.20survey.20in.20advance.20of.202021.20sprint.201\">#t-compiler &gt; contributor survey in advance of 2021 sprint 1</a></p>",
        "id": 224492258,
        "sender_full_name": "pnkfelix",
        "timestamp": 1611936121
    },
    {
        "content": "<p>if you want to help with the survey or just have thoughts you think we should incorporate, please go <span aria-label=\"up\" class=\"emoji emoji-2b06\" role=\"img\" title=\"up\">:up:</span></p>",
        "id": 224492388,
        "sender_full_name": "pnkfelix",
        "timestamp": 1611936148
    },
    {
        "content": "<p>Beyond that, I think we're settled: Sprint 1: 2021 March 1-7, Bootstrap Memory Usage.</p>",
        "id": 224492467,
        "sender_full_name": "pnkfelix",
        "timestamp": 1611936172
    },
    {
        "content": "<p>Thanks to everyone in the meeting for attending!</p>",
        "id": 224492543,
        "sender_full_name": "pnkfelix",
        "timestamp": 1611936193
    },
    {
        "content": "<p>(maybe another sprint will be dedicated to disk space usage. especially for incremental.)</p>",
        "id": 224492629,
        "sender_full_name": "pnkfelix",
        "timestamp": 1611936212
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"232545\">Joshua Nelson</span> <a href=\"#narrow/stream/238009-t-compiler.2Fmeetings/topic/.5Bsteering.20meeting.5D.202021-01-29/near/224485047\">said</a>:</p>\n<blockquote>\n<p>the other big thing I want to do for first-time builds is <a href=\"https://github.com/rust-lang/rust/issues/76653\">https://github.com/rust-lang/rust/issues/76653</a></p>\n</blockquote>\n<p>opened <a href=\"https://github.com/rust-lang/rust/pull/81520\">https://github.com/rust-lang/rust/pull/81520</a></p>",
        "id": 224506409,
        "sender_full_name": "Joshua Nelson",
        "timestamp": 1611941472
    }
]