[
    {
        "content": "<p><a href=\"https://github.blog/2021-09-23-github-advisory-database-now-supports-rust/\">https://github.blog/2021-09-23-github-advisory-database-now-supports-rust/</a></p>",
        "id": 254578758,
        "sender_full_name": "Eh2406",
        "timestamp": 1632420386
    },
    {
        "content": "<p>Tony and me have been in touch with Github folks about this. Curiously, most of the Rust advisories on GHSA actually originate from RustSec right now. We're also looking into syncing data in the other direction, so that anything published on GHSA is also available via RustSec.</p>",
        "id": 254580005,
        "sender_full_name": "Shnatsel",
        "timestamp": 1632420906
    },
    {
        "content": "<p>\"We're looking into\" actually means that now that Rust is a first-class citizen, this data can be accessed via their GraphQL API, and I'll try throwing together a prototype of importing to RustSec over the weekend.</p>",
        "id": 254580238,
        "sender_full_name": "Shnatsel",
        "timestamp": 1632421008
    },
    {
        "content": "<p>Okay, I've looked into it and hit a snag. It appears that RustSec URLs in the <code>references</code> field are listed on the web UI but are not returned via the GraphQL endpoint. <br>\nFor example, this links to RustSec: <a href=\"https://github.com/advisories/GHSA-6gvc-4jvj-pwq4\">https://github.com/advisories/GHSA-6gvc-4jvj-pwq4</a><br>\nBut requesting the same thing via GraphQL only lists this:</p>\n<div class=\"codehilite\"><pre><span></span><code>          &quot;references&quot;: [\n            {\n              &quot;url&quot;: &quot;https://nvd.nist.gov/vuln/detail/CVE-2018-25001&quot;\n            },\n            {\n              &quot;url&quot;: &quot;https://github.com/advisories/GHSA-6gvc-4jvj-pwq4&quot;\n            }\n          ],\n</code></pre></div>\n<p>I've reached out to a developer at Github about this, hopefully this will be resolved soon. Otherwise it's diffucult to avoid importing advisories that originated from RustSec.</p>",
        "id": 254842568,
        "sender_full_name": "Shnatsel",
        "timestamp": 1632578857
    },
    {
        "content": "<p>I've submitted a couple minor improvements in the meanwhile: <a href=\"https://github.com/rustsec/rustsec/pull/440\">https://github.com/rustsec/rustsec/pull/440</a> <a href=\"https://github.com/rustsec/rustsec/pull/441\">https://github.com/rustsec/rustsec/pull/441</a></p>",
        "id": 254843131,
        "sender_full_name": "Shnatsel",
        "timestamp": 1632579331
    },
    {
        "content": "<p>is this sync happening yet? I filed my first GHSA for num-bigint yesterday:<br>\n<a href=\"https://github.com/rust-num/num-bigint/security/advisories/GHSA-v935-pqmr-g8v9\">https://github.com/rust-num/num-bigint/security/advisories/GHSA-v935-pqmr-g8v9</a></p>",
        "id": 260204782,
        "sender_full_name": "cuviper",
        "timestamp": 1635977576
    },
    {
        "content": "<p>(feedback on the advisory itself is also welcome!)</p>",
        "id": 260204807,
        "sender_full_name": "cuviper",
        "timestamp": 1635977594
    },
    {
        "content": "<p>Not automatically AFAIK. Someone from GH may come by and submit it manually though, that's what happened last time.</p>",
        "id": 260206905,
        "sender_full_name": "Alex Gaynor",
        "timestamp": 1635979013
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"138448\">@cuviper</span> the sync is not happening - the implementation is blocked by a Github API bug. <br>\nGithub developers are aware of the issue, but it is understandably a low priority for them, since their business model revolves around people relying on their products rather than using the data independently.<br>\nAfter that's resolved, code will still need to be written to perform the actual import, but that should be relatively trivial.</p>",
        "id": 260583150,
        "sender_full_name": "Shnatsel",
        "timestamp": 1636302701
    },
    {
        "content": "<p>Just to chime in; that bug should be resolved now. If not ping me and I'd be happy to do a manual sync for anything missing :)</p>",
        "id": 261967648,
        "sender_full_name": "Darakian",
        "timestamp": 1637259390
    },
    {
        "content": "<p>I've started working on GHSA =&gt; RustSec import, the beginnings of it can be found in the <code>ghsa</code> branch: <a href=\"https://github.com/rustsec/rustsec/tree/ghsa\">https://github.com/rustsec/rustsec/tree/ghsa</a><br>\nFor now I'm targeting simply importing GHSA IDs for advisories imported from RustSec. This is an uncontroversial first step that does not create any licensing issues, and lets me prove the concept. However, we <strong>will</strong> have to tackle the license discrepancy one way or another - with GHSA being under CC-BY 4.0 with a specific attribution clause, and RustSec being presently in the public domain.<br>\nI understand our options are:</p>\n<ol>\n<li>Relicense to CC-BY 4.0</li>\n<li>Keep track of which advisories have been imported from GHSA and add some sort of marker on those</li>\n<li>Try to work out some special arrangement with Github - they already ingest data in public domain so they could submit it to NVD, etc.</li>\n</ol>",
        "id": 262272682,
        "sender_full_name": "Shnatsel",
        "timestamp": 1637546083
    },
    {
        "content": "<p>Also, it appears the implementation will be more difficult than I expected because there doesn't seem to be any pre-existing code to modify the DB entries, so I'm going to have to introduce all-new codepaths for mutable access to the advisories.</p>",
        "id": 262275737,
        "sender_full_name": "Shnatsel",
        "timestamp": 1637550647
    },
    {
        "content": "<p>I think a GHSA reference suffices for attribution. I'll ask and try to get some official language for you</p>",
        "id": 262346266,
        "sender_full_name": "Darakian",
        "timestamp": 1637599927
    },
    {
        "content": "<p>From <a href=\"https://docs.github.com/en/github/site-policy/github-terms-for-additional-products-and-features#advisory-database\">https://docs.github.com/en/github/site-policy/github-terms-for-additional-products-and-features#advisory-database</a> :</p>\n<blockquote>\n<p>The GitHub Advisory Database is licensed under the Creative Commons Attribution 4.0 license. The attribution term may be fulfilled by linking to the GitHub Advisory Database at <a href=\"https://github.com/advisories\">https://github.com/advisories</a> or to individual GitHub Advisory Database records used, prefixed by <a href=\"https://github.com/advisories\">https://github.com/advisories</a>.</p>\n</blockquote>",
        "id": 262346982,
        "sender_full_name": "Shnatsel",
        "timestamp": 1637600252
    },
    {
        "content": "<p>And there it is <span aria-label=\"+1\" class=\"emoji emoji-1f44d\" role=\"img\" title=\"+1\">:+1:</span></p>",
        "id": 262347271,
        "sender_full_name": "Darakian",
        "timestamp": 1637600397
    },
    {
        "content": "<p>This still takes us from \"RustSec database is in the public domain\" to \"Some advisories in the public domain while others are under CC-BY 4.0 and you have to look at this specific field to check which one it is\"<br>\nThe presence of GHSA reference alone is not informative because right now GHSA has 323 advisories imported from RustSec (public domain) and 28 advisories that RustSec does not carry (CC-BY 4.0)</p>",
        "id": 262347735,
        "sender_full_name": "Shnatsel",
        "timestamp": 1637600569
    },
    {
        "content": "<p>Some of those 28 don't even list the package (e.g. <code>GHSA-v666-6w97-pcwm</code>) and presumably do not apply to <a href=\"http://crates.io\">crates.io</a>, so the actual number would be even lower.</p>",
        "id": 262348110,
        "sender_full_name": "Shnatsel",
        "timestamp": 1637600736
    },
    {
        "content": "<p>Oh and I got a prototype working btw. It successfully pulls all Rust advisories from GHSA via the GraphQL API and matches them to RustSec advisories. This is how I got the numbers above. The code is in <code>ghsa</code> branch</p>",
        "id": 262348391,
        "sender_full_name": "Shnatsel",
        "timestamp": 1637600866
    },
    {
        "content": "<p>I'm seeing the crate <code>ckb</code> for <code>GHSA-v666-6w97-pcwm</code>. We should have crates on each ghsa</p>",
        "id": 262349728,
        "sender_full_name": "Darakian",
        "timestamp": 1637601459
    },
    {
        "content": "<p>on the license issue; I see your point now. Not sure I can help on that :(</p>",
        "id": 262349893,
        "sender_full_name": "Darakian",
        "timestamp": 1637601529
    },
    {
        "content": "<p><a href=\"https://github.com/nervosnetwork/ckb/security/advisories/GHSA-v666-6w97-pcwm\">https://github.com/nervosnetwork/ckb/security/advisories/GHSA-v666-6w97-pcwm</a> shows \"No package listed\" for me in the web UI.</p>",
        "id": 262350083,
        "sender_full_name": "Shnatsel",
        "timestamp": 1637601612
    },
    {
        "content": "<p><a href=\"https://github.com/advisories/GHSA-v666-6w97-pcwm\">https://github.com/advisories/GHSA-v666-6w97-pcwm</a></p>",
        "id": 262350122,
        "sender_full_name": "Darakian",
        "timestamp": 1637601636
    },
    {
        "content": "<p>in general the <code>github/advisories/#</code> path will be the curated data while the <code>github/repo/.../#</code> path will be the raw user data</p>",
        "id": 262350197,
        "sender_full_name": "Darakian",
        "timestamp": 1637601678
    },
    {
        "content": "<p>Well that's fun. When I type that ID into Google I only see the long link to the raw user data. No mentions of the short curated one.</p>",
        "id": 262350345,
        "sender_full_name": "Shnatsel",
        "timestamp": 1637601746
    },
    {
        "content": "<p>Also, the version specifications on the raw one and curated one are different.</p>",
        "id": 262350365,
        "sender_full_name": "Shnatsel",
        "timestamp": 1637601760
    },
    {
        "content": "<p>So you have the exact same ID pointing to different data <span aria-label=\"stuck out tongue closed eyes\" class=\"emoji emoji-1f61d\" role=\"img\" title=\"stuck out tongue closed eyes\">:stuck_out_tongue_closed_eyes:</span></p>",
        "id": 262350585,
        "sender_full_name": "Shnatsel",
        "timestamp": 1637601864
    },
    {
        "content": "<p>ya, looking at the log on that one I changed the versions to correspond to crates which are actually published on <a href=\"http://crates.io\">crates.io</a></p>\n<p><a href=\"https://crates.io/crates/ckb/versions\">https://crates.io/crates/ckb/versions</a></p>",
        "id": 262350614,
        "sender_full_name": "Darakian",
        "timestamp": 1637601881
    },
    {
        "content": "<blockquote>\n<p>So you have the exact same ID pointing to different data </p>\n</blockquote>\n<p>Ya.... that'll happen sometimes</p>",
        "id": 262350699,
        "sender_full_name": "Darakian",
        "timestamp": 1637601927
    },
    {
        "content": "<p>That's unfortunate. Especially since it's the non-curated version that shows up in Google Search for me.</p>",
        "id": 262351376,
        "sender_full_name": "Shnatsel",
        "timestamp": 1637602233
    },
    {
        "content": "<p>As well as DuckDuckGo.</p>",
        "id": 262351387,
        "sender_full_name": "Shnatsel",
        "timestamp": 1637602238
    },
    {
        "content": "<p>Conflicting or confusing information is just about the last thing people want from security advisories. Perhaps the original link could be superseded by the curated version as soon as that's published, and people would be required to click through to view the non-curated version?</p>",
        "id": 262351688,
        "sender_full_name": "Shnatsel",
        "timestamp": 1637602357
    },
    {
        "content": "<p>At the moment we don't want to force changes on repo maintainers. The rational being that the advisory feature is a method for a maintainer to communicate with their users. The advisory database is essentially an enriched version of that data which adds package references, more references, etc...</p>",
        "id": 262352007,
        "sender_full_name": "Darakian",
        "timestamp": 1637602542
    },
    {
        "content": "<p>I did make a <code>!</code> request to ddg for <code>!ghsa</code> to map to our database, but it doesn't look like it's been accepted</p>",
        "id": 262352175,
        "sender_full_name": "Darakian",
        "timestamp": 1637602621
    },
    {
        "content": "<p>That's all fair, but then we're back to square one and conflicting information for the same advisory ID</p>",
        "id": 262352669,
        "sender_full_name": "Shnatsel",
        "timestamp": 1637602892
    },
    {
        "content": "<p>with respect to the ckb crate specifically or in general?</p>",
        "id": 262352779,
        "sender_full_name": "Darakian",
        "timestamp": 1637602939
    },
    {
        "content": "<p>In general. ckb is just one instance of this, and not a particularly important one in the grand scheme of things.</p>",
        "id": 262352848,
        "sender_full_name": "Shnatsel",
        "timestamp": 1637602982
    },
    {
        "content": "<p>I feel that the purpose of a security advisory database is providing unambiguous and actionable information. A database that does not do that feels deeply weird to me, and I immediately want to question its purpose.</p>",
        "id": 262353086,
        "sender_full_name": "Shnatsel",
        "timestamp": 1637603088
    },
    {
        "content": "<p>I mean, I would argue that's what we're doing.</p>",
        "id": 262353125,
        "sender_full_name": "Darakian",
        "timestamp": 1637603109
    },
    {
        "content": "<p>in the ckb case I mapped their range to a package which exists on crates rather than what is tagged in their repo</p>",
        "id": 262353175,
        "sender_full_name": "Darakian",
        "timestamp": 1637603146
    },
    {
        "content": "<p>the fundamental problem is that any repo can submit a security advisory for anything. Any package, any ecosystem, any versions</p>",
        "id": 262353306,
        "sender_full_name": "Darakian",
        "timestamp": 1637603199
    },
    {
        "content": "<p>ignoring malicious vectors we see typos, package omissions, one sentence descriptions, and plain old spam</p>",
        "id": 262353431,
        "sender_full_name": "Darakian",
        "timestamp": 1637603277
    },
    {
        "content": "<p>so, the general problem is not going away sadly</p>",
        "id": 262353564,
        "sender_full_name": "Darakian",
        "timestamp": 1637603347
    },
    {
        "content": "<p>Naturally. We're seeing similar things too - humans are bound to make mistakes. What we do, however, is make the edited version authoritative, so that it entirely supersedes the initial submission.</p>",
        "id": 262353577,
        "sender_full_name": "Shnatsel",
        "timestamp": 1637603357
    },
    {
        "content": "<p>in that case I would consider the <code>github/advisories/#</code> path authoritative</p>",
        "id": 262353671,
        "sender_full_name": "Darakian",
        "timestamp": 1637603404
    },
    {
        "content": "<p>we do not yet have a mechanism to suggest edits back to the root repo advisory</p>",
        "id": 262353739,
        "sender_full_name": "Darakian",
        "timestamp": 1637603430
    },
    {
        "content": "<p>That's great, but the rest of the world (e.g. search engines) does not view it that way.<br>\nPerhaps accessing the original should redirect to the curated version, if one is present? There is already a link back to the original in the curated version, in case anyone wants to peruse that.</p>",
        "id": 262353840,
        "sender_full_name": "Shnatsel",
        "timestamp": 1637603484
    },
    {
        "content": "<p>Oh, so you're concern is that the repo version comes up before the advisory db in search results?</p>",
        "id": 262354071,
        "sender_full_name": "Darakian",
        "timestamp": 1637603548
    },
    {
        "content": "<p>Both that, and the existence of two different data points for the same GHSA ID without one being clearly flagged as authoritative in the IU.</p>",
        "id": 262354247,
        "sender_full_name": "Shnatsel",
        "timestamp": 1637603599
    },
    {
        "content": "<p>I'm not sure there's much we can do about search results</p>",
        "id": 262354465,
        "sender_full_name": "Darakian",
        "timestamp": 1637603659
    },
    {
        "content": "<p>You can make accessing the original advisory URL redirect to the curated version, if one is present.</p>",
        "id": 262354561,
        "sender_full_name": "Shnatsel",
        "timestamp": 1637603696
    },
    {
        "content": "<p>sure, but that effectively deletes the maintainers advisory</p>",
        "id": 262354635,
        "sender_full_name": "Darakian",
        "timestamp": 1637603721
    },
    {
        "content": "<p>perhaps that's a behavior we can provide an opt-in option for</p>",
        "id": 262354709,
        "sender_full_name": "Darakian",
        "timestamp": 1637603750
    },
    {
        "content": "<p>Well, the curated version is meant to supersede it, so IMO \"effectively deleting\" it would work as intended.</p>",
        "id": 262355022,
        "sender_full_name": "Shnatsel",
        "timestamp": 1637603863
    },
    {
        "content": "<p>The curated version already links to the original, I imagine it would also pass a parameter suppressing the redirection. So the original would not be entirely deleted, but require an extra click to access.</p>",
        "id": 262355038,
        "sender_full_name": "Shnatsel",
        "timestamp": 1637603868
    },
    {
        "content": "<p>That way you get the most up-to-date version <strong>by default</strong> and can click through to view the original submission if you so desire.</p>",
        "id": 262355618,
        "sender_full_name": "Shnatsel",
        "timestamp": 1637604084
    },
    {
        "content": "<p>I can certainly bring that up for discussion, but don't expect quick movement on it</p>",
        "id": 262355826,
        "sender_full_name": "Darakian",
        "timestamp": 1637604186
    },
    {
        "content": "<p>It's not blocking anything for RustSec, fortunately. Just something I found weird from the HCI perspective.</p>",
        "id": 262355878,
        "sender_full_name": "Shnatsel",
        "timestamp": 1637604217
    },
    {
        "content": "<p>ya, I get that</p>",
        "id": 262355901,
        "sender_full_name": "Darakian",
        "timestamp": 1637604225
    },
    {
        "content": "<p>I do see your point to be clear</p>",
        "id": 262355923,
        "sender_full_name": "Darakian",
        "timestamp": 1637604237
    },
    {
        "content": "<p>but the contrasting point is that we want to provide an unadulterated channel for the maintainers as well</p>",
        "id": 262355999,
        "sender_full_name": "Darakian",
        "timestamp": 1637604265
    },
    {
        "content": "<p>though perhaps some would opt-in to this if it were offered</p>",
        "id": 262356043,
        "sender_full_name": "Darakian",
        "timestamp": 1637604288
    },
    {
        "content": "<p>Perhaps you should get maintainer buy-in on this, then?<br>\nAfter all, this is objective information, and in case of any discrepancies I assume only one version of it to be true. Therefore, if you keep two separate versions, one of them is misleading.</p>",
        "id": 262356194,
        "sender_full_name": "Shnatsel",
        "timestamp": 1637604366
    },
    {
        "content": "<p>ya, I think there's something we can build there for sure</p>",
        "id": 262356266,
        "sender_full_name": "Darakian",
        "timestamp": 1637604412
    },
    {
        "content": "<p>FWIW we usually get sign-off from the submitter for any non-trivial edits to our DB entries.</p>",
        "id": 262356282,
        "sender_full_name": "Shnatsel",
        "timestamp": 1637604420
    },
    {
        "content": "<p>We should have a repo version of the advisory DB soom <span aria-label=\"tm\" class=\"emoji emoji-2122\" role=\"img\" title=\"tm\">:tm:</span> <br>\nThe issue tracker on that will probably be the best place for feature requests</p>",
        "id": 262356501,
        "sender_full_name": "Darakian",
        "timestamp": 1637604533
    },
    {
        "content": "<p>I think maintainer pushback would be WAI. If the edits were correct, then there is no reason for maintainers to protest; and if they were not, then it's far better to have the maintainer correct it rather than carry a misleading advisory.</p>",
        "id": 262356537,
        "sender_full_name": "Shnatsel",
        "timestamp": 1637604549
    },
    {
        "content": "<p>WAI?</p>",
        "id": 262356555,
        "sender_full_name": "Darakian",
        "timestamp": 1637604560
    },
    {
        "content": "<p>Working As Intended</p>",
        "id": 262356588,
        "sender_full_name": "Shnatsel",
        "timestamp": 1637604578
    },
    {
        "content": "<p>Ah, ya I'm not 100% on that</p>",
        "id": 262356622,
        "sender_full_name": "Darakian",
        "timestamp": 1637604597
    },
    {
        "content": "<p>but I do agree that in the common case it will likely be a non-issue</p>",
        "id": 262356676,
        "sender_full_name": "Darakian",
        "timestamp": 1637604610
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"132721\">@Tony Arcieri</span> do you have any examples of RustSec advisories being programmatically written? I see the <code>Advisory</code> struct derives <code>Serialize</code> but the loading implementation <a href=\"https://github.com/rustsec/rustsec/blob/625c965c951b81f74d0367df82bae78745147e1f/rustsec/src/advisory.rs#L88\">seems to be custom</a> (not surprising, given the markdown + TOML front matter format). Am I correct in assuming that no codepaths for writing new advisories currently exist?</p>",
        "id": 262360478,
        "sender_full_name": "Shnatsel",
        "timestamp": 1637606519
    },
    {
        "content": "<p>there is presently nothing like that, no</p>",
        "id": 262360637,
        "sender_full_name": "Tony Arcieri",
        "timestamp": 1637606592
    },
    {
        "content": "<p>a mutable \"advisory builder/factory\" type would be an interesting and useful addition</p>",
        "id": 262360656,
        "sender_full_name": "Tony Arcieri",
        "timestamp": 1637606604
    },
    {
        "content": "<p>I see. Well, at least the fields on the structs are already <code>pub</code> so I wouldn't have to write too much boilerplate, probably can just construct the structs directly.</p>",
        "id": 262360914,
        "sender_full_name": "Shnatsel",
        "timestamp": 1637606748
    },
    {
        "content": "<p>The thing that assigns IDs is the closest thing I can think of</p>",
        "id": 262394953,
        "sender_full_name": "Alex Gaynor",
        "timestamp": 1637625600
    },
    {
        "content": "<p>github advisory database is now open to contributions:  <a href=\"https://github.blog/2022-02-22-github-advisory-database-now-open-to-community-contributions/\">https://github.blog/2022-02-22-github-advisory-database-now-open-to-community-contributions/</a></p>",
        "id": 272898161,
        "sender_full_name": "DPC",
        "timestamp": 1645584561
    },
    {
        "content": "<p>Nice to see them use OSV format instead of rolling their own thing. Even though OSV largely defers to \"ecosystem specific\" fields, the precise specification of affected versions is super useful.</p>",
        "id": 272904568,
        "sender_full_name": "Shnatsel",
        "timestamp": 1645591523
    },
    {
        "content": "<p>Although I might be biased because I got paid to add OSV export to RustSec, heh</p>",
        "id": 272904581,
        "sender_full_name": "Shnatsel",
        "timestamp": 1645591555
    },
    {
        "content": "<p>Also, nobody actually calls that format OpenSSF even though that's the official name now <span aria-label=\"laughing\" class=\"emoji emoji-1f606\" role=\"img\" title=\"laughing\">:laughing:</span></p>",
        "id": 272904641,
        "sender_full_name": "Shnatsel",
        "timestamp": 1645591591
    }
]