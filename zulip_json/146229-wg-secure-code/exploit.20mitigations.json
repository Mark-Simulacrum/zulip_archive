[
    {
        "content": "<p>There seems to be no docs on what exploit mitigations - which are applied to Rust code by default, and which ones can be enabled manually. I've only found closed issues and a few scattered PRs myself. I've opened a bug on rust-lang/rust about this: <a href=\"https://github.com/rust-lang/rust/issues/71098\" title=\"https://github.com/rust-lang/rust/issues/71098\">https://github.com/rust-lang/rust/issues/71098</a></p>",
        "id": 193781628,
        "sender_full_name": "Shnatsel",
        "timestamp": 1586790789
    },
    {
        "content": "<p>I'm currently working on a document for a project and I've been able to document almost all mitigations, how they apply to Rust, and their story with it (with comprehensive references, including all relevant GitHub issues and pull requests). However, I couldn't find any information about control flow enforcement, safe stack, and speculative load hardening (besides <a href=\"https://internals.rust-lang.org/t/thoughts-on-hardening/4771\">https://internals.rust-lang.org/t/thoughts-on-hardening/4771</a>). What is the Secure Code WG stance on these? Where would be the best place to contribute it to? The Nomicon?</p>",
        "id": 199695166,
        "sender_full_name": "Ramon de C Valle",
        "timestamp": 1591231978
    },
    {
        "content": "<p>I also couldn't find an official stance on stack smashing protection but brson's comment at <a href=\"https://github.com/rust-lang/rust/pull/30859#issuecomment-172148714\">https://github.com/rust-lang/rust/pull/30859#issuecomment-172148714</a>. Is it the official and still the Secure Code WG stance on it?</p>",
        "id": 199695922,
        "sender_full_name": "Ramon de C Valle",
        "timestamp": 1591232919
    },
    {
        "content": "<p>Oh wow, that's great! I'm not 100% sure a great place for it currently exists. Perhaps <a href=\"https://doc.rust-lang.org/rustc/\">https://doc.rust-lang.org/rustc/</a> or <a href=\"https://doc.rust-lang.org/unstable-book/\">https://doc.rust-lang.org/unstable-book/</a></p>",
        "id": 199801994,
        "sender_full_name": "Shnatsel",
        "timestamp": 1591301137
    },
    {
        "content": "<p>I can't speak for the whole group, but stack smashing protection sounds like a good thing to have on by default. I believe most Linux distros either recommend it or have it on by default. On the other hand, I've skimmed through the RustSec advisory DB and I cannot see any stack buffer overflows, so I'm not 100% sure it's going to be actually useful.<br>\nI won't speculate about the performance impact of that - a Crater run can give us actual data on that.</p>",
        "id": 199802777,
        "sender_full_name": "Shnatsel",
        "timestamp": 1591301571
    },
    {
        "content": "<p>I believe the compiler team would be your best contact for this; check <a class=\"stream\" data-stream-id=\"131828\" href=\"/#narrow/stream/131828-t-compiler\">#t-compiler</a></p>",
        "id": 199802856,
        "sender_full_name": "Shnatsel",
        "timestamp": 1591301620
    },
    {
        "content": "<p>Also brson's comment in  <a href=\"https://github.com/rust-lang/rust/pull/30859#issuecomment-172148714\">https://github.com/rust-lang/rust/pull/30859#issuecomment-172148714</a> talks about stack <em>overflow</em> protection, not stack <em>smashing</em> protection. Stack smashing is corrupting the contents of the stack in the middle of it; stack overflow is the stack growing uncontrollably and potentially overwriting parts of the heap. Rust currently guarantees protection against stack overflow only on <em>some</em> platforms, which is implemented via guard pages.</p>",
        "id": 199803126,
        "sender_full_name": "Shnatsel",
        "timestamp": 1591301774
    },
    {
        "content": "<p>Many years ago <code>-fstack-protector-strong</code> was introduced to clang/GCC, which tried to limit which functions got stack protection intelligently, to limit performance impact. I guess you could do an even more intelligent version for rust!</p>",
        "id": 199803518,
        "sender_full_name": "Alex Gaynor",
        "timestamp": 1591302008
    },
    {
        "content": "<p>Only do it for the functions that have unsafe in them or in functions that have been inlined? That's... interesting.</p>",
        "id": 199804110,
        "sender_full_name": "Shnatsel",
        "timestamp": 1591302341
    },
    {
        "content": "<p>Or pass the address/reference to a stack buffer to something that does that, yeah.</p>",
        "id": 199805691,
        "sender_full_name": "Alex Gaynor",
        "timestamp": 1591303235
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"127617\">Shnatsel</span> <a href=\"#narrow/stream/146229-wg-secure-code/topic/exploit.20mitigations/near/199801994\">said</a>:</p>\n<blockquote>\n<p>Oh wow, that's great! I'm not 100% sure a great place for it currently exists. Perhaps <a href=\"https://doc.rust-lang.org/rustc/\">https://doc.rust-lang.org/rustc/</a> or <a href=\"https://doc.rust-lang.org/unstable-book/\">https://doc.rust-lang.org/unstable-book/</a></p>\n</blockquote>\n<p>Thanks! I'll take a look at them and submit a PR after I finish it.</p>",
        "id": 199809700,
        "sender_full_name": "Ramon de C Valle",
        "timestamp": 1591305518
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"127617\">Shnatsel</span> <a href=\"#narrow/stream/146229-wg-secure-code/topic/exploit.20mitigations/near/199802856\">said</a>:</p>\n<blockquote>\n<p>I believe the compiler team would be your best contact for this; check <a class=\"stream\" data-stream-id=\"131828\" href=\"/#narrow/stream/131828-t-compiler\">#t-compiler</a></p>\n</blockquote>\n<p>Thanks! I'll reach out to them.</p>",
        "id": 199809743,
        "sender_full_name": "Ramon de C Valle",
        "timestamp": 1591305547
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"127617\">Shnatsel</span> <a href=\"#narrow/stream/146229-wg-secure-code/topic/exploit.20mitigations/near/199803126\">said</a>:</p>\n<blockquote>\n<p>Also brson's comment in  <a href=\"https://github.com/rust-lang/rust/pull/30859#issuecomment-172148714\">https://github.com/rust-lang/rust/pull/30859#issuecomment-172148714</a> talks about stack <em>overflow</em> protection, not stack <em>smashing</em> protection. Stack smashing is corrupting the contents of the stack in the middle of it; stack overflow is the stack growing uncontrollably and potentially overwriting parts of the heap. Rust currently guarantees protection against stack overflow only on <em>some</em> platforms, which is implemented via guard pages.</p>\n</blockquote>\n<p>Sorry. I thought he was referring to stack smashing protection and not stack clashing protection--I've the latter covered already.</p>",
        "id": 199809784,
        "sender_full_name": "Ramon de C Valle",
        "timestamp": 1591305583
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"130046\">Alex Gaynor</span> <a href=\"#narrow/stream/146229-wg-secure-code/topic/exploit.20mitigations/near/199803518\">said</a>:</p>\n<blockquote>\n<p>Many years ago <code>-fstack-protector-strong</code> was introduced to clang/GCC, which tried to limit which functions got stack protection intelligently, to limit performance impact. I guess you could do an even more intelligent version for rust!</p>\n</blockquote>\n<p>If possible, having better heuristics than <code>-fstack-protector-strong</code> has already would be great indeed.</p>",
        "id": 199810046,
        "sender_full_name": "Ramon de C Valle",
        "timestamp": 1591305733
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"295814\">@Ramon de C Valle</span> you'll probably be interested in this: <a href=\"https://harald.hoyer.xyz/rust-static-pie/\">https://harald.hoyer.xyz/rust-static-pie/</a></p>",
        "id": 201791553,
        "sender_full_name": "Shnatsel",
        "timestamp": 1592950987
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"127617\">Shnatsel</span> <a href=\"#narrow/stream/146229-wg-secure-code/topic/exploit.20mitigations/near/201791553\">said</a>:</p>\n<blockquote>\n<p><span class=\"user-mention silent\" data-user-id=\"295814\">Ramon de C Valle</span> you'll probably be interested in this: <a href=\"https://harald.hoyer.xyz/rust-static-pie/\">https://harald.hoyer.xyz/rust-static-pie/</a></p>\n</blockquote>\n<p>Thanks for sending it out!</p>",
        "id": 204262163,
        "sender_full_name": "Ramon de C Valle",
        "timestamp": 1595021587
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"295814\">@Ramon de C Valle</span> By the way, do you have the results of your analysis so far written down anywhere? I'd be interested in getting an overview of the current situation, even if it's incomplete.</p>",
        "id": 204310592,
        "sender_full_name": "Shnatsel",
        "timestamp": 1595094765
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"127617\">Shnatsel</span> <a href=\"#narrow/stream/146229-wg-secure-code/topic/exploit.20mitigations/near/204310592\">said</a>:</p>\n<blockquote>\n<p><span class=\"user-mention silent\" data-user-id=\"295814\">Ramon de C Valle</span> By the way, do you have the results of your analysis so far written down anywhere? I'd be interested in getting an overview of the current situation, even if it's incomplete.</p>\n</blockquote>\n<p>Sure. Just sent you. There are a few things I want to finish before sending a PR to the rustc book though.</p>",
        "id": 204458884,
        "sender_full_name": "Ramon de C Valle",
        "timestamp": 1595270244
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"130046\">@Alex Gaynor</span> I just wanted to say <a href=\"https://github.com/rust-lang/rfcs/pull/2635\">https://github.com/rust-lang/rfcs/pull/2635</a> is great and I'm glad someone is working on this</p>",
        "id": 205422708,
        "sender_full_name": "Shnatsel",
        "timestamp": 1596062848
    },
    {
        "content": "<p>Also it's now possible to fuzz stdlib data structures rather easily via <a href=\"https://github.com/jakubadamw/rutenspitz\">https://github.com/jakubadamw/rutenspitz</a> and I expect to find more bugs like <a href=\"https://github.com/rust-lang/rust/issues/72237\">https://github.com/rust-lang/rust/issues/72237</a></p>",
        "id": 205422878,
        "sender_full_name": "Shnatsel",
        "timestamp": 1596062973
    },
    {
        "content": "<p>Fortunately this particular bug is benign, but I also expect more of <a href=\"https://blog.rust-lang.org/2018/09/21/Security-advisory-for-std.html\">https://blog.rust-lang.org/2018/09/21/Security-advisory-for-std.html</a></p>",
        "id": 205423045,
        "sender_full_name": "Shnatsel",
        "timestamp": 1596063075
    },
    {
        "content": "<p>Heh, working on it very very slowly.</p>",
        "id": 205423709,
        "sender_full_name": "Alex Gaynor",
        "timestamp": 1596063660
    },
    {
        "content": "<p>I should get around to fuzzing <code>std::String</code> properly now that rutenspitz exists</p>",
        "id": 205425183,
        "sender_full_name": "Shnatsel",
        "timestamp": 1596064983
    },
    {
        "content": "<p>Yet another item on the long list of stuff I should get around to</p>",
        "id": 205425189,
        "sender_full_name": "Shnatsel",
        "timestamp": 1596064996
    },
    {
        "content": "<p>if you need any help from the libs or compiler teams feel free to ping me <span aria-label=\"smile\" class=\"emoji emoji-1f642\" role=\"img\" title=\"smile\">:smile:</span></p>",
        "id": 205425324,
        "sender_full_name": "DPC",
        "timestamp": 1596065097
    }
]