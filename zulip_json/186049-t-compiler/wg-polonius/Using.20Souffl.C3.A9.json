[
    {
        "content": "<p>I've decided that it's easier for me to experiment with polonius using Soufflé than datafrog. I have a hard time translating between datalog rules and calls to the datafrog API. The comments are quite helpful, and I assume the little things like swapping indexes gets easier with time. However, using a full-featured datalog engine has other benefits (rules can't get out of sync, etc.) and seems better for prototyping. Judging from the initial blog post, Niko switched away from Soufflé pretty early on. This makes me somewhat less confident, but still confident enough to proceed.</p>",
        "id": 221584329,
        "sender_full_name": "Dylan MacKenzie (ecstatic-morse)",
        "timestamp": 1609796206
    },
    {
        "content": "<p>I did this on Sunday using the rules from a HackMD floating out in the ether: <a href=\"https://github.com/ecstatic-morse/polonius/tree/souffle\">https://github.com/ecstatic-morse/polonius/tree/souffle</a></p>",
        "id": 221584478,
        "sender_full_name": "Dylan MacKenzie (ecstatic-morse)",
        "timestamp": 1609796297
    },
    {
        "content": "<p><a href=\"https://github.com/rust-lang/polonius/pull/126\">https://github.com/rust-lang/polonius/pull/126</a></p>",
        "id": 221584526,
        "sender_full_name": "lqd",
        "timestamp": 1609796336
    },
    {
        "content": "<p>Ah damn, I wish I would have seen that. I had to choose between writing \"literate Prolog\" markdown files and extensively commented <code>.dl</code> files. I probably would have gone the other way if I would have known.</p>",
        "id": 221584739,
        "sender_full_name": "Dylan MacKenzie (ecstatic-morse)",
        "timestamp": 1609796449
    },
    {
        "content": "<p>the automatic conversion is interesting</p>",
        "id": 221584742,
        "sender_full_name": "lqd",
        "timestamp": 1609796451
    },
    {
        "content": "<p>(we probably still have the original .dl from way back when :)</p>",
        "id": 221584917,
        "sender_full_name": "lqd",
        "timestamp": 1609796540
    },
    {
        "content": "<p>(I did see your renaming PR. Mine uses the new names.)</p>",
        "id": 221584921,
        "sender_full_name": "Dylan MacKenzie (ecstatic-morse)",
        "timestamp": 1609796542
    },
    {
        "content": "<p>nice !</p>",
        "id": 221584933,
        "sender_full_name": "lqd",
        "timestamp": 1609796551
    },
    {
        "content": "<p>(so does this PR, I've updated it recently)</p>",
        "id": 221584961,
        "sender_full_name": "lqd",
        "timestamp": 1609796572
    },
    {
        "content": "<p>using your script could be nice as well</p>",
        "id": 221585058,
        "sender_full_name": "lqd",
        "timestamp": 1609796630
    },
    {
        "content": "<p>Anyways, I fixed up some typos and some missing rules and it compiles. However, it seems something is still missing, since it's not outputting any errors.</p>",
        "id": 221585085,
        "sender_full_name": "Dylan MacKenzie (ecstatic-morse)",
        "timestamp": 1609796642
    },
    {
        "content": "<p>what input are you testing ?</p>",
        "id": 221585143,
        "sender_full_name": "lqd",
        "timestamp": 1609796664
    },
    {
        "content": "<p>(I tried on the <code>vec-push-ref</code> test cases)</p>",
        "id": 221585145,
        "sender_full_name": "Dylan MacKenzie (ecstatic-morse)",
        "timestamp": 1609796667
    },
    {
        "content": "<p>ok</p>",
        "id": 221585155,
        "sender_full_name": "lqd",
        "timestamp": 1609796672
    },
    {
        "content": "<p><code>foo1</code> and <code>foo2</code></p>",
        "id": 221585156,
        "sender_full_name": "Dylan MacKenzie (ecstatic-morse)",
        "timestamp": 1609796673
    },
    {
        "content": "<p>the thing with this hackmd is that some of it still uses placeholder loans IIRC</p>",
        "id": 221585191,
        "sender_full_name": "lqd",
        "timestamp": 1609796699
    },
    {
        "content": "<p>it probably shouldn't matter to the errors in vec-push-ref as IIRC they were regular errors</p>",
        "id": 221585218,
        "sender_full_name": "lqd",
        "timestamp": 1609796717
    },
    {
        "content": "<p>It does have the placeholder rules.</p>",
        "id": 221585252,
        "sender_full_name": "Dylan MacKenzie (ecstatic-morse)",
        "timestamp": 1609796741
    },
    {
        "content": "<p>yeah but which ones</p>",
        "id": 221585265,
        "sender_full_name": "lqd",
        "timestamp": 1609796750
    },
    {
        "content": "<p>I've switched away from computing subset errors with placeholder loans in 2/3 variants</p>",
        "id": 221585330,
        "sender_full_name": "lqd",
        "timestamp": 1609796772
    },
    {
        "content": "<div class=\"codehilite\" data-code-language=\"Prolog\"><pre><span></span><code><span class=\"nf\">origin_contains_loan_on_entry</span><span class=\"p\">(</span><span class=\"s s-Atom\">origin</span><span class=\"p\">,</span> <span class=\"s s-Atom\">loan</span><span class=\"p\">,</span> <span class=\"s s-Atom\">targetNode</span><span class=\"p\">)</span> <span class=\"p\">:-</span>\n  <span class=\"nf\">origin_contains_loan_on_entry</span><span class=\"p\">(</span><span class=\"s s-Atom\">origin</span><span class=\"p\">,</span> <span class=\"s s-Atom\">loan</span><span class=\"p\">,</span> <span class=\"s s-Atom\">sourceNode</span><span class=\"p\">),</span>\n  <span class=\"p\">!</span><span class=\"nf\">loan_killed_at</span><span class=\"p\">(</span><span class=\"s s-Atom\">loan</span><span class=\"p\">,</span> <span class=\"s s-Atom\">sourceNode</span><span class=\"p\">),</span>\n  <span class=\"nf\">cfg_edge</span><span class=\"p\">(</span><span class=\"s s-Atom\">sourceNode</span><span class=\"p\">,</span> <span class=\"s s-Atom\">targetNode</span><span class=\"p\">),</span>\n  <span class=\"p\">(</span><span class=\"nf\">origin_live_on_entry</span><span class=\"p\">(</span><span class=\"s s-Atom\">origin</span><span class=\"p\">,</span> <span class=\"s s-Atom\">targetNode</span><span class=\"p\">);</span> <span class=\"nf\">placeholder</span><span class=\"p\">(</span><span class=\"s s-Atom\">origin</span><span class=\"p\">,</span> <span class=\"k\">_</span><span class=\"p\">)).</span>\n</code></pre></div>",
        "id": 221585363,
        "sender_full_name": "Dylan MacKenzie (ecstatic-morse)",
        "timestamp": 1609796804
    },
    {
        "content": "<p>yeah placeholder loans are something else than this one</p>",
        "id": 221585420,
        "sender_full_name": "lqd",
        "timestamp": 1609796852
    },
    {
        "content": "<p>This one? It's whatever was in here <a href=\"https://hackmd.io/CGMNjt1hR_qYtsR9hgdGmw?view\">https://hackmd.io/CGMNjt1hR_qYtsR9hgdGmw?view</a></p>",
        "id": 221585429,
        "sender_full_name": "Dylan MacKenzie (ecstatic-morse)",
        "timestamp": 1609796856
    },
    {
        "content": "<p>I'll look them up</p>",
        "id": 221585431,
        "sender_full_name": "lqd",
        "timestamp": 1609796859
    },
    {
        "content": "<p>I'm not exactly sure whether the rules in the hackmd are up to date for move/init and liveness, I would hope so but I'm not sure :/</p>",
        "id": 221585478,
        "sender_full_name": "lqd",
        "timestamp": 1609796877
    },
    {
        "content": "<p>yes that's the one</p>",
        "id": 221585547,
        "sender_full_name": "lqd",
        "timestamp": 1609796896
    },
    {
        "content": "<p>I did a sanity check and all the rules seem fine. I have a few questions about liveness but it all seems reasonable.</p>",
        "id": 221585555,
        "sender_full_name": "Dylan MacKenzie (ecstatic-morse)",
        "timestamp": 1609796904
    },
    {
        "content": "<p>I might just be using the wrong input facts, since I had to rename them.</p>",
        "id": 221585618,
        "sender_full_name": "Dylan MacKenzie (ecstatic-morse)",
        "timestamp": 1609796949
    },
    {
        "content": "<p>eg the second rule here <a href=\"https://hackmd.io/CGMNjt1hR_qYtsR9hgdGmw?view#Error-reporting\">https://hackmd.io/CGMNjt1hR_qYtsR9hgdGmw?view#Error-reporting</a> is no more</p>",
        "id": 221585639,
        "sender_full_name": "lqd",
        "timestamp": 1609796965
    },
    {
        "content": "<div class=\"codehilite\" data-code-language=\"Bash\"><pre><span></span><code>mv borrow_region.facts loan_issued_at.facts\nmv killed.facts loan_killed_at.facts\nmv invalidates.facts loan_invalidated_at.facts\n\nmv child_path.facts parent_path.facts\n\nmv known_subset.facts known_placeholder_subset.facts\nmv outlives.facts subset_base.facts\n</code></pre></div>",
        "id": 221585648,
        "sender_full_name": "Dylan MacKenzie (ecstatic-morse)",
        "timestamp": 1609796975
    },
    {
        "content": "<p>at least, there's a PR to change it</p>",
        "id": 221585657,
        "sender_full_name": "lqd",
        "timestamp": 1609796981
    },
    {
        "content": "<p>or am I spewing random bs, I have updated the hackmd recently</p>",
        "id": 221585845,
        "sender_full_name": "lqd",
        "timestamp": 1609797065
    },
    {
        "content": "<p>(sorry dylan, I'm a bit tired from work and trying to make progress on const generics defaults during the holidays)</p>",
        "id": 221585909,
        "sender_full_name": "lqd",
        "timestamp": 1609797102
    },
    {
        "content": "<p>another point of difference</p>",
        "id": 221586062,
        "sender_full_name": "lqd",
        "timestamp": 1609797174
    },
    {
        "content": "<p>the rules use soufflé's alternative <code>;</code> combinator</p>",
        "id": 221586095,
        "sender_full_name": "lqd",
        "timestamp": 1609797192
    },
    {
        "content": "<p>but the code does not, it does a similar thing, by materializing liveness for the universal regions / placeholders at all points in the cfg</p>",
        "id": 221586172,
        "sender_full_name": "lqd",
        "timestamp": 1609797237
    },
    {
        "content": "<p>No worries. I was planning to work on my own since you're busy for this month at least and Niko is presumably <strong>super</strong> busy. Figuring this stuff out means I reach competency faster.</p>",
        "id": 221586342,
        "sender_full_name": "Dylan MacKenzie (ecstatic-morse)",
        "timestamp": 1609797338
    },
    {
        "content": "<p>Although I do wish I had known about the rules documentation PR XD</p>",
        "id": 221586371,
        "sender_full_name": "Dylan MacKenzie (ecstatic-morse)",
        "timestamp": 1609797355
    },
    {
        "content": "<p>Yes. You have a PR that adds the placeholder disjunction to the datafrog rules correct?</p>",
        "id": 221586502,
        "sender_full_name": "Dylan MacKenzie (ecstatic-morse)",
        "timestamp": 1609797416
    },
    {
        "content": "<p>yeah</p>",
        "id": 221586514,
        "sender_full_name": "lqd",
        "timestamp": 1609797423
    },
    {
        "content": "<p>it's still WIP because of the Opt variant which are the only ones using antijoins on liveness</p>",
        "id": 221586544,
        "sender_full_name": "lqd",
        "timestamp": 1609797443
    },
    {
        "content": "<p>and I wanted to discuss this a bit, but I expect we'd just need to add the implicit antijoins and that it should work</p>",
        "id": 221586585,
        "sender_full_name": "lqd",
        "timestamp": 1609797474
    },
    {
        "content": "<p>it's just ... verbose</p>",
        "id": 221586635,
        "sender_full_name": "lqd",
        "timestamp": 1609797483
    },
    {
        "content": "<p>and maybe something datafrog could/should help with</p>",
        "id": 221586660,
        "sender_full_name": "lqd",
        "timestamp": 1609797496
    },
    {
        "content": "<p>(I assumed that none of that would affect <code>vec_push_ref</code>):</p>\n<div class=\"codehilite\" data-code-language=\"Rust\"><pre><span></span><code><span class=\"k\">fn</span> <span class=\"nf\">foo1</span><span class=\"p\">()</span><span class=\"w\"> </span><span class=\"p\">{</span><span class=\"w\"></span>\n<span class=\"w\">    </span><span class=\"kd\">let</span><span class=\"w\"> </span><span class=\"k\">mut</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"mi\">22</span><span class=\"p\">;</span><span class=\"w\"></span>\n<span class=\"w\">    </span><span class=\"kd\">let</span><span class=\"w\"> </span><span class=\"k\">mut</span><span class=\"w\"> </span><span class=\"n\">v</span><span class=\"w\"> </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"fm\">vec!</span><span class=\"p\">[];</span><span class=\"w\"></span>\n<span class=\"w\">    </span><span class=\"kd\">let</span><span class=\"w\"> </span><span class=\"n\">p</span><span class=\"w\"> </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"o\">&amp;</span><span class=\"n\">x</span><span class=\"p\">;</span><span class=\"w\"></span>\n\n<span class=\"w\">    </span><span class=\"k\">if</span><span class=\"w\"> </span><span class=\"n\">something</span><span class=\"p\">()</span><span class=\"w\"> </span><span class=\"p\">{</span><span class=\"w\"></span>\n<span class=\"w\">        </span><span class=\"n\">v</span><span class=\"p\">.</span><span class=\"n\">push</span><span class=\"p\">(</span><span class=\"n\">p</span><span class=\"p\">);</span><span class=\"w\"></span>\n<span class=\"w\">        </span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"o\">+=</span><span class=\"w\"> </span><span class=\"mi\">1</span><span class=\"p\">;</span><span class=\"w\"> </span><span class=\"c1\">//~ ERROR</span>\n<span class=\"w\">    </span><span class=\"p\">}</span><span class=\"w\"> </span><span class=\"k\">else</span><span class=\"w\"> </span><span class=\"p\">{</span><span class=\"w\"></span>\n<span class=\"w\">        </span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"o\">+=</span><span class=\"w\"> </span><span class=\"mi\">1</span><span class=\"p\">;</span><span class=\"w\"></span>\n<span class=\"w\">    </span><span class=\"p\">}</span><span class=\"w\"></span>\n\n<span class=\"w\">    </span><span class=\"nb\">drop</span><span class=\"p\">(</span><span class=\"n\">v</span><span class=\"p\">);</span><span class=\"w\"></span>\n<span class=\"p\">}</span><span class=\"w\"></span>\n</code></pre></div>",
        "id": 221586679,
        "sender_full_name": "Dylan MacKenzie (ecstatic-morse)",
        "timestamp": 1609797508
    },
    {
        "content": "<p>yeah same</p>",
        "id": 221586756,
        "sender_full_name": "lqd",
        "timestamp": 1609797550
    },
    {
        "content": "<p>I'm not sure how to debug that apart from comparing the relations contents first between the 3 phases</p>",
        "id": 221586862,
        "sender_full_name": "lqd",
        "timestamp": 1609797604
    },
    {
        "content": "<p>and if that doesn't help, see the tuples emitted each round as well</p>",
        "id": 221586911,
        "sender_full_name": "lqd",
        "timestamp": 1609797634
    },
    {
        "content": "<p>Yep. That was my next step but I ran out of time over the weekend. I'll let you know how it goes when I pick it up again, but I'm also busy.</p>",
        "id": 221586925,
        "sender_full_name": "Dylan MacKenzie (ecstatic-morse)",
        "timestamp": 1609797638
    },
    {
        "content": "<p>I'll try to look at it if I find the time as well</p>",
        "id": 221587006,
        "sender_full_name": "lqd",
        "timestamp": 1609797673
    },
    {
        "content": "<p>I wasn't gonna post at all, but you nerd-sniped me with vEB trees. And anyone who has time to think about vEB trees has too much time.</p>",
        "id": 221587058,
        "sender_full_name": "Dylan MacKenzie (ecstatic-morse)",
        "timestamp": 1609797702
    },
    {
        "content": "<p>haha <span aria-label=\"joy\" class=\"emoji emoji-1f602\" role=\"img\" title=\"joy\">:joy:</span></p>",
        "id": 221587071,
        "sender_full_name": "lqd",
        "timestamp": 1609797713
    },
    {
        "content": "<p>there's always time to read on the toilet, like Muchnick's book :p</p>",
        "id": 221587199,
        "sender_full_name": "lqd",
        "timestamp": 1609797773
    },
    {
        "content": "<p>you've done a great job on commenting the rules in your branch</p>",
        "id": 221589455,
        "sender_full_name": "lqd",
        "timestamp": 1609799010
    },
    {
        "content": "<p>or maybe those are from the hackmd (pretty sure you did add some of your own tho)</p>",
        "id": 221589595,
        "sender_full_name": "lqd",
        "timestamp": 1609799099
    },
    {
        "content": "<p>(it shows that I'm not familiar with the comments on the hackmd's move/init and liveness rules, obviously ... they work in rustc == I'm happy)</p>",
        "id": 221589788,
        "sender_full_name": "lqd",
        "timestamp": 1609799222
    },
    {
        "content": "<p>Nah those are all verbatim from the HackMD. Thank Albin. I will add to them eventually though.</p>",
        "id": 221613375,
        "sender_full_name": "Dylan MacKenzie (ecstatic-morse)",
        "timestamp": 1609823114
    },
    {
        "content": "<p>I found the critical differences in my transcribed version. Two relations had their arguments flipped from how they appeared in the fact file, and liveness was manually adding some facts <a href=\"https://github.com/rust-lang/polonius/blob/2cf8336f7ff9932270160a392ca5be3c804b7f41/polonius-engine/src/output/liveness.rs#L157-L170\">here</a>. Tuple counts now match up for examples without placeholders.</p>",
        "id": 221613533,
        "sender_full_name": "Dylan MacKenzie (ecstatic-morse)",
        "timestamp": 1609823365
    },
    {
        "content": "<p>Naive souffle can run the clap-rs benchmark in 2 minutes without using a crazy amount of RAM, so it's definitely usable.  Running on 8 cores helps of course (<code>-j8</code>).</p>",
        "id": 221613667,
        "sender_full_name": "Dylan MacKenzie (ecstatic-morse)",
        "timestamp": 1609823598
    },
    {
        "content": "<p>That's enough for tonight though.</p>",
        "id": 221613769,
        "sender_full_name": "Dylan MacKenzie (ecstatic-morse)",
        "timestamp": 1609823694
    },
    {
        "content": "<p>ah dang I now remember the different ordering in the loan invalidations relation <a href=\"https://github.com/rust-lang/polonius/blob/f2c0fcafdcd341486f7c2225824b26feb0d6b9ce/polonius-engine/src/output/mod.rs#L222\">https://github.com/rust-lang/polonius/blob/f2c0fcafdcd341486f7c2225824b26feb0d6b9ce/polonius-engine/src/output/mod.rs#L222</a></p>",
        "id": 221620490,
        "sender_full_name": "lqd",
        "timestamp": 1609833183
    },
    {
        "content": "<p>and the liveness one is the one I mentioned above, that should have been taken care of by all the \"origin is live ; origin is placeholder\" joins in the loan analysis rules though</p>",
        "id": 221620617,
        "sender_full_name": "lqd",
        "timestamp": 1609833359
    },
    {
        "content": "<p>maybe we missed one in the hackmd ?</p>",
        "id": 221620873,
        "sender_full_name": "lqd",
        "timestamp": 1609833617
    },
    {
        "content": "<p>btw RE: <a href=\"https://github.com/ecstatic-morse/polonius/commit/3e00d634ccb1026a6d04a6cebb379541b27a9eed\">https://github.com/ecstatic-morse/polonius/commit/3e00d634ccb1026a6d04a6cebb379541b27a9eed</a> the updated names and facts should already be updated in <a href=\"https://github.com/rust-lang/polonius/pull/155\">https://github.com/rust-lang/polonius/pull/155</a> (with the caveat <a href=\"https://github.com/rust-lang/polonius/pull/156#issuecomment-751460154\">https://github.com/rust-lang/polonius/pull/156#issuecomment-751460154</a> where I forgot to rename two internal relations in that PR, but that shouldn't matter to use the repository facts with soufflé)</p>",
        "id": 221758926,
        "sender_full_name": "lqd",
        "timestamp": 1609934007
    },
    {
        "content": "<p>Prototype is up at <a href=\"https://github.com/rust-lang/polonius/issues/179\">rust-lang/polonius#179</a>.</p>",
        "id": 250056329,
        "sender_full_name": "Dylan MacKenzie (ecstatic-morse)",
        "timestamp": 1629411482
    },
    {
        "content": "<p>I decided to bind to  the C++ interface using cxx. The result is pretty gnarly.</p>",
        "id": 250056399,
        "sender_full_name": "Dylan MacKenzie (ecstatic-morse)",
        "timestamp": 1629411518
    },
    {
        "content": "<p><a href=\"https://github.com/ecstatic-morse/polonius/blob/0546a6543d245fe9396c9cd9d6cd70865e5818e2/polonius-souffle/build.rs#L55-L62\">https://github.com/ecstatic-morse/polonius/blob/0546a6543d245fe9396c9cd9d6cd70865e5818e2/polonius-souffle/build.rs#L55-L62</a></p>",
        "id": 250056480,
        "sender_full_name": "Dylan MacKenzie (ecstatic-morse)",
        "timestamp": 1629411582
    },
    {
        "content": "<p>I'll do some tweaking and add some more <code>FIXME</code>s in the coming days. I'm pretty over it at the moment.</p>",
        "id": 250059672,
        "sender_full_name": "Dylan MacKenzie (ecstatic-morse)",
        "timestamp": 1629414271
    },
    {
        "content": "<p>This is so cool</p>",
        "id": 250749416,
        "sender_full_name": "Amanda Stjerna",
        "timestamp": 1629972450
    },
    {
        "content": "<p>Finally picked this up again and fixed the bug (<code>loan_invalidated_at</code> was in the wrong order). My plan is to add some <code>Algorithm</code> variants so we can keep the existing interface (<code>Output::compute</code>). Unfortunately, I'll need to change how crates are split up (likely by moving <code>Output</code> into the root).</p>",
        "id": 254427626,
        "sender_full_name": "Dylan MacKenzie (ecstatic-morse)",
        "timestamp": 1632340187
    },
    {
        "content": "<p><code>loan_invalidated_at</code> is <em>always</em> in the wrong order</p>",
        "id": 254428132,
        "sender_full_name": "lqd",
        "timestamp": 1632340379
    },
    {
        "content": "<p>refactoring the splitting or the interface seems fine, as long as we know the impact on rustc, which only uses the <code>polonius-engine</code> crate</p>",
        "id": 254428362,
        "sender_full_name": "lqd",
        "timestamp": 1632340462
    },
    {
        "content": "<p>Hm another choice is to add a <code>polonius_facts</code> crate and re-export that from <code>polonius_engine</code>. The issue is a circular dependency when calling <code>polonius_souffle</code> from <code>Output::compute</code>, since <code>polonius_souffle</code> depends on <code>polonius_engine</code> for <code>AllFacts</code> and <code>FactTypes</code>. I'll try to find the least invasive option, but this PR is going to be a bit of a mess.</p>",
        "id": 254429084,
        "sender_full_name": "Dylan MacKenzie (ecstatic-morse)",
        "timestamp": 1632340745
    },
    {
        "content": "<p>interesting yeah</p>",
        "id": 254430642,
        "sender_full_name": "lqd",
        "timestamp": 1632341271
    },
    {
        "content": "<p>splitting the facts could work indeed</p>",
        "id": 254430788,
        "sender_full_name": "lqd",
        "timestamp": 1632341321
    },
    {
        "content": "<p>awesome that you were able to find the issue ^^</p>",
        "id": 254430917,
        "sender_full_name": "lqd",
        "timestamp": 1632341369
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"118594\">Dylan MacKenzie (ecstatic-morse)</span> <a href=\"#narrow/stream/186049-t-compiler.2Fwg-polonius/topic/Using.20Souffl.C3.A9/near/221613533\">said</a>:</p>\n<blockquote>\n<p>I found the critical differences in my transcribed version. Two relations had their arguments flipped from how they appeared in the fact file, and liveness was manually adding some facts <a href=\"https://github.com/rust-lang/polonius/blob/2cf8336f7ff9932270160a392ca5be3c804b7f41/polonius-engine/src/output/liveness.rs#L157-L170\">here</a>. Tuple counts now match up for examples without placeholders.</p>\n</blockquote>\n<p><span aria-label=\"head bandage\" class=\"emoji emoji-1f915\" role=\"img\" title=\"head bandage\">:head_bandage:</span></p>",
        "id": 254431171,
        "sender_full_name": "Dylan MacKenzie (ecstatic-morse)",
        "timestamp": 1632341450
    },
    {
        "content": "<p>I found it a month ago, then forgot about it, which takes some of the shine off TBH</p>",
        "id": 254431283,
        "sender_full_name": "Dylan MacKenzie (ecstatic-morse)",
        "timestamp": 1632341497
    },
    {
        "content": "<p>maybe we should change the rule to match this order, just so it doesn't happen again</p>",
        "id": 254431493,
        "sender_full_name": "lqd",
        "timestamp": 1632341568
    },
    {
        "content": "<p>Yes. I'll do that later, since it requires <code>rustc</code> changes/ What would be even more helpful is a sanity check for fact names. e.g. all CFG points should start with \"Before\" or \"Mid\", etc.</p>",
        "id": 254432353,
        "sender_full_name": "Dylan MacKenzie (ecstatic-morse)",
        "timestamp": 1632341932
    },
    {
        "content": "<p>I meant we could flip the order of the relation in our soufflé files, to match the current rustc layout, in order to not change rustc</p>",
        "id": 254433556,
        "sender_full_name": "lqd",
        "timestamp": 1632342467
    },
    {
        "content": "<p>scratch that</p>",
        "id": 254433667,
        "sender_full_name": "lqd",
        "timestamp": 1632342499
    },
    {
        "content": "<p>it's the one we wanted to flip in rustc <a href=\"https://github.com/rust-lang/polonius/blob/0cbbb7c6b2f9dd713266b77c0c13903ac16e1679/polonius-engine/src/output/mod.rs#L229-L237\">https://github.com/rust-lang/polonius/blob/0cbbb7c6b2f9dd713266b77c0c13903ac16e1679/polonius-engine/src/output/mod.rs#L229-L237</a></p>",
        "id": 254433754,
        "sender_full_name": "lqd",
        "timestamp": 1632342538
    },
    {
        "content": "<p>Have you considered using <a href=\"https://github.com/vmware/differential-datalog\">Differential Datalog</a> instead of Souffle?</p>",
        "id": 254936852,
        "sender_full_name": "Chase Wilson",
        "timestamp": 1632667917
    },
    {
        "content": "<p>hi kix <span aria-label=\"wave\" class=\"emoji emoji-1f44b\" role=\"img\" title=\"wave\">:wave:</span>, we're only using soufflé for prototyping now, and datafrog otherwise. We were using timely and differential dataflow 3 years ago at the beginning, before Frank made datafrog to improve the runtime performance and compile times we were seeing. (So I guess the answer to this question is \"no but we were using the same building blocks you are using\" :)</p>",
        "id": 254952351,
        "sender_full_name": "lqd",
        "timestamp": 1632681816
    },
    {
        "content": "<p>for those following at home, CI is green on <a href=\"https://github.com/rust-lang/polonius/pull/179\">https://github.com/rust-lang/polonius/pull/179</a></p>",
        "id": 255492949,
        "sender_full_name": "lqd",
        "timestamp": 1632958594
    },
    {
        "content": "<p>My thought was that I would host something temporarily until their next release.</p>",
        "id": 256788130,
        "sender_full_name": "Dylan MacKenzie (ecstatic-morse)",
        "timestamp": 1633719293
    },
    {
        "content": "<p>But that would mean building an ubuntu/debian package, which I'm not equipped to do, and I don't have the old one in cache anywhere.</p>",
        "id": 256788219,
        "sender_full_name": "Dylan MacKenzie (ecstatic-morse)",
        "timestamp": 1633719326
    },
    {
        "content": "<p>I haven't looked too hard.</p>",
        "id": 256788244,
        "sender_full_name": "Dylan MacKenzie (ecstatic-morse)",
        "timestamp": 1633719340
    },
    {
        "content": "<p>I was wondering if their release process was automated, e.g. we'd fork their repo, have GHA build a release and publish that on the fork</p>",
        "id": 256788448,
        "sender_full_name": "lqd",
        "timestamp": 1633719411
    },
    {
        "content": "<p>that's probably too optimistic</p>",
        "id": 256788486,
        "sender_full_name": "lqd",
        "timestamp": 1633719424
    },
    {
        "content": "<p>I'll try to see if I happen to still have the deb package</p>",
        "id": 256788552,
        "sender_full_name": "lqd",
        "timestamp": 1633719454
    },
    {
        "content": "<p>No that's exactly right. They do it in a container in GHA, so I could totally do it that way, or even locally</p>",
        "id": 256788719,
        "sender_full_name": "Dylan MacKenzie (ecstatic-morse)",
        "timestamp": 1633719524
    },
    {
        "content": "<p>As an aside, I wish there was a way to just run a GHA job locally.</p>",
        "id": 256788774,
        "sender_full_name": "Dylan MacKenzie (ecstatic-morse)",
        "timestamp": 1633719549
    },
    {
        "content": "<p>ah interesting</p>",
        "id": 256789040,
        "sender_full_name": "lqd",
        "timestamp": 1633719636
    },
    {
        "content": "<p>I thought I saw some people doing that, eg <a href=\"https://github.com/nektos/act\">https://github.com/nektos/act</a> but I've never tried to see if it'd work ^^</p>",
        "id": 256789102,
        "sender_full_name": "lqd",
        "timestamp": 1633719658
    },
    {
        "content": "<p>Ah, thanks for the link, although I'm a podperson, so I'll probably just end up copying the relevant parts our of the task.</p>",
        "id": 256789386,
        "sender_full_name": "Dylan MacKenzie (ecstatic-morse)",
        "timestamp": 1633719770
    },
    {
        "content": "<p>I also took a little temporary break from .next and started looking at this PR and trying it out</p>",
        "id": 260469725,
        "sender_full_name": "lqd",
        "timestamp": 1636149585
    },
    {
        "content": "<p>though I wonder, are you more and more liking DDLog compared to Soufflé ? :)</p>",
        "id": 260475494,
        "sender_full_name": "lqd",
        "timestamp": 1636153825
    },
    {
        "content": "<p>I'm undecided. Souffle lacks first-class data types, has a C++ interface and has incomplete aggregates, but it also has a nice profiler and built-in provenance. DDLog lacks disjunction and probably has some overhead due to its incremental capabilities, but the fact that it compiles to Rust and has better extensions (functions and data structures) makes me think it would be easier to work with, at least until something goes wrong.</p>",
        "id": 260476094,
        "sender_full_name": "Dylan MacKenzie (ecstatic-morse)",
        "timestamp": 1636154338
    },
    {
        "content": "<p>I see yes, they're both good and interesting but have cons that prevent them from being a clear winner over the other</p>",
        "id": 260476472,
        "sender_full_name": "lqd",
        "timestamp": 1636154690
    },
    {
        "content": "<p>at least in our situation</p>",
        "id": 260476496,
        "sender_full_name": "lqd",
        "timestamp": 1636154705
    },
    {
        "content": "<p>Personally I would prefer a pure rust based datalog implementation. It makes rustc easier to cross-compile and makes it possible to compile rustc+cg_clif for wasm. (currently only needs a few tiny patches as no C/C++ compiler is needed by rustc itself)</p>",
        "id": 260505737,
        "sender_full_name": "bjorn3",
        "timestamp": 1636194747
    },
    {
        "content": "<p>just to be clear, this is currently for prototyping purposes, iterating and testing rules. and even pure rust based implementations are not a slam dunk for rustc usage anyways.</p>",
        "id": 260509162,
        "sender_full_name": "lqd",
        "timestamp": 1636199838
    },
    {
        "content": "<p>and I believe we all agree with the sentiment and constraints you mention</p>",
        "id": 260509217,
        "sender_full_name": "lqd",
        "timestamp": 1636199903
    }
]