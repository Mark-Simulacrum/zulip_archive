[
    {
        "content": "<p>Are there any particularly pressing tasks that stand out as things to do in the mir-opt area? I've been working on fixing broken passes recently (dest prop is next, although that is currently blocked), and am wondering if this is the best way I can help. One thing I do want to do is write a new pass manager in the not so distant future (I have some ideas here already). Is that blocked on anything? Are there more important things that need doing?</p>",
        "id": 274187279,
        "sender_full_name": "Jake",
        "timestamp": 1646427481
    },
    {
        "content": "<p>We recently got a new pass manager already in <a href=\"https://github.com/rust-lang/rust/pull/91475\">https://github.com/rust-lang/rust/pull/91475</a></p>",
        "id": 274187735,
        "sender_full_name": "bjorn3",
        "timestamp": 1646427647
    },
    {
        "content": "<p>Ah, well, \"new\" might be the wrong word, but there are at least things I'm looking to add. <span class=\"user-mention\" data-user-id=\"124288\">@oli</span> also mentioned a need for the ability to run only some passes, and I'd like to be able to harness that particularly for <code>src/test/mir-opt</code></p>",
        "id": 274188324,
        "sender_full_name": "Jake",
        "timestamp": 1646428012
    },
    {
        "content": "<p>The other thing that I think makes sense is letting passes report whether they need a <code>SimplifyCFG</code>/<code>SimplifyLocals</code> to run before/after them (and then possibly extending this to more general analyses that might get invalidated)</p>",
        "id": 274188482,
        "sender_full_name": "Jake",
        "timestamp": 1646428100
    },
    {
        "content": "<p>On the theoretical side, we probably need to better document the semantics of MIR, so our optimizations and codegen are composable.</p>",
        "id": 274189880,
        "sender_full_name": "cjgillot",
        "timestamp": 1646428855
    },
    {
        "content": "<p>On the practical side, we may need so have a definition of clean-ish MIR.</p>",
        "id": 274189929,
        "sender_full_name": "cjgillot",
        "timestamp": 1646428882
    },
    {
        "content": "<p>ie. on which we don't need to run SimplifyLocals/SimplifyCFG to have subsequent optimizations trigger.</p>",
        "id": 274189987,
        "sender_full_name": "cjgillot",
        "timestamp": 1646428918
    },
    {
        "content": "<p>About specific opts: inlining is almost ready, but it triggers weird type normalization ICEs.</p>",
        "id": 274190290,
        "sender_full_name": "cjgillot",
        "timestamp": 1646429092
    },
    {
        "content": "<p>Having an SROA pass may be helpful too.</p>",
        "id": 274192563,
        "sender_full_name": "cjgillot",
        "timestamp": 1646430218
    },
    {
        "content": "<p>I've linked this at a few different people today so I'll do it again: <a href=\"https://github.com/rust-lang/rust/issues/86299\">https://github.com/rust-lang/rust/issues/86299</a></p>\n<blockquote>\n<p><strong>Better documentation of our MIR dialects</strong><br>\nWe like to pretend that MIR is a single language, but that is not actually true. There are at least two different languages represented by MIR; I will call them MIR \"dialects\" in the following:</p>\n</blockquote>",
        "id": 274193160,
        "sender_full_name": "Jubilee",
        "timestamp": 1646430549
    },
    {
        "content": "<p>Regarding the MIR semantics (both in general and with respect to dialects), this is absolutely something I'd be super willing to contribute to. Unfortunately, it doesn't seem like it's the kind of thing that a single person can drive (especially not someone like me with absolutely no standing to ask others to allocate resources). If there are things that a single person can do in this area (or a wider initiative to be a part of), I'd be super happy to help though.</p>",
        "id": 274195741,
        "sender_full_name": "Jake",
        "timestamp": 1646432054
    },
    {
        "content": "<p>One thing I've noticed is that there is no documentation (that I've found anyway) regarding which <code>StatementKind</code>s we can expect at which phases of MIR. I can try putting up a PR that makes this explicit in the <code>StatementKind</code> documentation</p>",
        "id": 274195788,
        "sender_full_name": "Jake",
        "timestamp": 1646432095
    },
    {
        "content": "<p>we also have around 50 issues tagged with ICE that might be related to mir opts (just search for the tag + mir-opt-level) <span aria-label=\"thinking\" class=\"emoji emoji-1f914\" role=\"img\" title=\"thinking\">:thinking:</span></p>",
        "id": 274196814,
        "sender_full_name": "matthiaskrgr",
        "timestamp": 1646432742
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"310518\">Jake</span> <a href=\"#narrow/stream/189540-t-compiler.2Fwg-mir-opt/topic/Things.20to.20do/near/274195788\">said</a>:</p>\n<blockquote>\n<p>One thing I've noticed is that there is no documentation (that I've found anyway) regarding which <code>StatementKind</code>s we can expect at which phases of MIR. I can try putting up a PR that makes this explicit in the <code>StatementKind</code> documentation</p>\n</blockquote>\n<p>yeah I disagree (somewhat, gently) with the \"(not) the kind of thing that a single person can drive\" because that kind of PR clearly is exactly the kind of thing that is needed and is within scope for 1 person to do. It might just kick off a big discussion tho'.</p>",
        "id": 274197159,
        "sender_full_name": "Jubilee",
        "timestamp": 1646432919
    },
    {
        "content": "<p>but like<br>\nsometimes what you do is do a bunch of things which kick off big discussions</p>",
        "id": 274197223,
        "sender_full_name": "Jubilee",
        "timestamp": 1646432956
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"281757\">Jubilee</span> <a href=\"#narrow/stream/189540-t-compiler.2Fwg-mir-opt/topic/Things.20to.20do/near/274197159\">said</a>:</p>\n<blockquote>\n<p><span class=\"user-mention silent\" data-user-id=\"310518\">Jake</span> <a href=\"#narrow/stream/189540-t-compiler.2Fwg-mir-opt/topic/Things.20to.20do/near/274195788\">said</a>:</p>\n<blockquote>\n<p>One thing I've noticed is that there is no documentation (that I've found anyway) regarding which <code>StatementKind</code>s we can expect at which phases of MIR. I can try putting up a PR that makes this explicit in the <code>StatementKind</code> documentation</p>\n</blockquote>\n<p>yeah I disagree (somewhat, gently) with the \"(not) the kind of thing that a single person can drive\" because that kind of PR clearly is exactly the kind of thing that is needed and is within scope for 1 person to do. It might just kick off a big discussion tho'.</p>\n</blockquote>\n<p>Sorry, I should have been more clear. I meant that clarifying MIR semantics requires input from a lot of people, and I don't want to assign these people work. If it's just a matter of having someone start writing documentation or whatever, I can do that. Maybe I'm overestimating the amount of design work there is to do here</p>",
        "id": 274202430,
        "sender_full_name": "Jake",
        "timestamp": 1646436080
    },
    {
        "content": "<blockquote>\n<p>I don't want to assign these people work.</p>\n</blockquote>\n<p>I recommend you don't worry about it.  Just continue the good work you've been doing, and people will follow your lead.  Some may even be happy somebody is taking the lead in that subject <span aria-label=\"smile\" class=\"emoji emoji-1f642\" role=\"img\" title=\"smile\">:smile:</span>.</p>",
        "id": 274267970,
        "sender_full_name": "cjgillot",
        "timestamp": 1646518663
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"310518\">Jake</span> <a href=\"#narrow/stream/189540-t-compiler.2Fwg-mir-opt/topic/Things.20to.20do/near/274202430\">said</a>:</p>\n<blockquote>\n<p>If it's just a matter of having someone start writing documentation or whatever, I can do that. Maybe I'm overestimating the amount of design work there is to do here</p>\n</blockquote>\n<p>It is definitely not going to happen <strong>before</strong> someone starts extensively documenting how things are.</p>",
        "id": 274269499,
        "sender_full_name": "Jubilee",
        "timestamp": 1646519889
    },
    {
        "content": "<p><a href=\"https://github.com/rust-lang/rust/issues/94655\">#94655</a> is up <span aria-label=\"smile\" class=\"emoji emoji-1f642\" role=\"img\" title=\"smile\">:smile:</span></p>",
        "id": 274277558,
        "sender_full_name": "Jake",
        "timestamp": 1646531377
    }
]