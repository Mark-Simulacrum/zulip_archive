[
    {
        "content": "<p>Is it possible to write a single test that runs in both the default configuration and with a certain feature enabled?</p>",
        "id": 253652633,
        "sender_full_name": "eholk",
        "timestamp": 1631827054
    },
    {
        "content": "<p>I'm working on a change where I want to make sure that enabling the new feature keeps the same behavior on the existing tests, and then add tests that cover the new desired behavior as well</p>",
        "id": 253652778,
        "sender_full_name": "eholk",
        "timestamp": 1631827115
    },
    {
        "content": "<p>The obvious option is to duplicated all the tests and add <code>#![feature(my_feature)]</code> to the top, but it'd be nice not to have to do this.</p>",
        "id": 253652827,
        "sender_full_name": "eholk",
        "timestamp": 1631827138
    },
    {
        "content": "<p>Revisions should do this, I think</p>",
        "id": 253652940,
        "sender_full_name": "simulacrum",
        "timestamp": 1631827197
    },
    {
        "content": "<p>Ah, cool. Where can I find out more about that?</p>",
        "id": 253653014,
        "sender_full_name": "eholk",
        "timestamp": 1631827219
    },
    {
        "content": "<p><a href=\"https://github.com/rust-lang/rust/blob/master/src/test/ui/meta/revision-ok.rs\">https://github.com/rust-lang/rust/blob/master/src/test/ui/meta/revision-ok.rs</a> is an example</p>",
        "id": 253653024,
        "sender_full_name": "simulacrum",
        "timestamp": 1631827224
    },
    {
        "content": "<p>but it's pretty simple</p>",
        "id": 253653036,
        "sender_full_name": "simulacrum",
        "timestamp": 1631827228
    },
    {
        "content": "<p>revision -&gt; pass compile flags -&gt; add <code>--cfg</code></p>",
        "id": 253653085,
        "sender_full_name": "The 8472",
        "timestamp": 1631827257
    },
    {
        "content": "<p>there's even docs (!) <a href=\"https://rustc-dev-guide.rust-lang.org/tests/adding.html#revisions\">https://rustc-dev-guide.rust-lang.org/tests/adding.html#revisions</a></p>",
        "id": 253653090,
        "sender_full_name": "simulacrum",
        "timestamp": 1631827258
    },
    {
        "content": "<p>Awesome!</p>",
        "id": 253653111,
        "sender_full_name": "eholk",
        "timestamp": 1631827266
    },
    {
        "content": "<p>So it looks like I can add a <code>cfg_attr</code> or whatever it is to enable the feature for certain revisions. That should work</p>",
        "id": 253653147,
        "sender_full_name": "eholk",
        "timestamp": 1631827292
    },
    {
        "content": "<p>Oh, interesting, the docs say that compile-pass tests aren't supported yet</p>",
        "id": 253653269,
        "sender_full_name": "eholk",
        "timestamp": 1631827339
    },
    {
        "content": "<p>I'd... be a little surprised if they aren't</p>",
        "id": 253653318,
        "sender_full_name": "simulacrum",
        "timestamp": 1631827360
    },
    {
        "content": "<p>I'd check</p>",
        "id": 253653322,
        "sender_full_name": "simulacrum",
        "timestamp": 1631827362
    },
    {
        "content": "<p>I'll try it out. Good chance the docs are just out of date or imprecise</p>",
        "id": 253653381,
        "sender_full_name": "eholk",
        "timestamp": 1631827399
    },
    {
        "content": "<p>It's probably not too hard to add if needed anyway :)</p>",
        "id": 253653417,
        "sender_full_name": "simulacrum",
        "timestamp": 1631827417
    },
    {
        "content": "<p>there are run-pass tests with revisions, so it would be odd if compile-pass doesn't work</p>",
        "id": 253653520,
        "sender_full_name": "The 8472",
        "timestamp": 1631827453
    },
    {
        "content": "<p>Actually, I guess the wording is actually meant to be non-exhaustive. Oh well, I'll try it out and know for sure.</p>",
        "id": 253653882,
        "sender_full_name": "eholk",
        "timestamp": 1631827645
    },
    {
        "content": "<p>Okay, I did a quick check and revisions seem to work for run-pass at least</p>",
        "id": 253654394,
        "sender_full_name": "eholk",
        "timestamp": 1631827888
    }
]