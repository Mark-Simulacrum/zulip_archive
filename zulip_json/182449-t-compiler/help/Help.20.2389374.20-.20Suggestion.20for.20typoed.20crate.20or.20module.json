[
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"343125\">@Takayuki Maeda</span> just running <code>x.py test --bless src/test/ui/hygiene</code> is probably enough, but you may want to fix the bug where the same error is emitted twice since it doesn't look like it's being deduplicated</p>",
        "id": 255387835,
        "sender_full_name": "Joshua Nelson",
        "timestamp": 1632917714
    },
    {
        "content": "<p>Error deduplication is disabled for tests AFAIK.</p>",
        "id": 255397102,
        "sender_full_name": "bjorn3",
        "timestamp": 1632921611
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"232545\">@Joshua Nelson</span> <br>\nI'm sorry.  I didn't add enough information. What I want to solve is that the compiler suggests like the following. This suggestion causes compilation errors. I think this is due to the decl_macro feature, but I have no idea in solving the problem.</p>\n<div class=\"codehilite\"><pre><span></span><code>error[E0432]: unresolved import `my_core`\n  --&gt; $DIR/extern-prelude-from-opaque-fail.rs:20:9\n   |\nLL |     use my_core;\n   |         ^^^^^^^\n   |         |\n   |         no `my_core` in the root\n   |         help: a similar name exists in the module: `my_core`\n\nerror[E0432]: unresolved import `my_core`\n  --&gt; $DIR/extern-prelude-from-opaque-fail.rs:7:13\n   |\nLL |         use my_core;\n   |             ^^^^^^^ no `my_core` in the root\n...\nLL | a!();\n   | ----- in this macro invocation\n   |\n   = note: this error originates in the macro `a` (in Nightly builds, run with -Z macro-backtrace for more info)\n\nerror[E0433]: failed to resolve: use of undeclared crate or module `my_core`\n  --&gt; $DIR/extern-prelude-from-opaque-fail.rs:11:18\n   |\nLL |         fn f() { my_core::mem::drop(0); }\n   |                  ^^^^^^^\n   |                  |\n   |                  use of undeclared crate or module `my_core`\n   |                  help: a similar crate or module exists: `my_core`\n...\nLL | a!();\n   | ----- in this macro invocation\n   |\n   = note: this error originates in the macro `a` (in Nightly builds, run with -Z macro-backtrace for more info)\n\nerror[E0433]: failed to resolve: use of undeclared crate or module `my_core`\n  --&gt; $DIR/extern-prelude-from-opaque-fail.rs:24:14\n   |\nLL |     fn f() { my_core::mem::drop(0); }\n   |              ^^^^^^^\n   |              |\n   |              use of undeclared crate or module `my_core`\n   |              help: a similar crate or module exists: `my_core`\n\nerror: aborting due to 4 previous errors\n\nSome errors have detailed explanations: E0432, E0433.\nFor more information about an error, try `rustc --explain E0432`.\n</code></pre></div>",
        "id": 255408251,
        "sender_full_name": "Takayuki Maeda",
        "timestamp": 1632925560
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"343125\">@Takayuki Maeda</span> I don't know what's going on with that error, but a simple fix is not to give the suggestion if the new module name is the same as the one being replaced</p>",
        "id": 255408537,
        "sender_full_name": "Joshua Nelson",
        "timestamp": 1632925655
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"232545\">@Joshua Nelson</span> </p>\n<p>Thank you! In this file a decl_macro <code>a</code> declares <code>extern crate core as my_core</code> internally and <code>my_core::mem::drop(0)</code> is called in a <code>f()</code> function outside the decl_macro.  So <code>my_core::mem::drop(0)</code> causes a <code>failed to resolve</code> error, but the compiler suggests a similar crate name which the function cannot use.</p>",
        "id": 255410825,
        "sender_full_name": "Takayuki Maeda",
        "timestamp": 1632926448
    },
    {
        "content": "<p>So if I apply your simple fix, the compiler suggests a similar crate name like the following when I use a typoed crate name.</p>\n<div class=\"codehilite\"><pre><span></span><code>error[E0433]: failed to resolve: use of undeclared crate or module `my_cor`\n  --&gt; /Users/tako8ki/GitHub/rust/rust/src/test/ui/hygiene/extern-prelude-from-opaque-fail.rs:24:14\n   |\nLL |     fn f() { my_cor::mem::drop(0); }\n   |              ^^^^^^\n   |              |\n   |              use of undeclared crate or module `my_cor`\n   |              help: a similar crate or module exists: `my_core`\n</code></pre></div>",
        "id": 255411337,
        "sender_full_name": "Takayuki Maeda",
        "timestamp": 1632926630
    }
]