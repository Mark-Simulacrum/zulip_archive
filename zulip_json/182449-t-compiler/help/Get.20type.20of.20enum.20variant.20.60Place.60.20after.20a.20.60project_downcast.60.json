[
    {
        "content": "<p>Hi, during codegen, how do I get the type of an enum variant from the <code>Place</code> after a <code>place.project_downcast(builder, vidx)</code> call? </p>\n<p>For example:</p>\n<div class=\"codehilite\"><pre><span></span><code>let variant_place = place.project_downcast(builder, variant_index);\nlet variant_ty = variant_place.layout.ty.subst(builder.tcx, adt_substs);\n</code></pre></div>\n<p><code>variant_ty</code> seems to return the type of the enum adt, not the type of the variant. What am I doing wrong here?</p>",
        "id": 275428981,
        "sender_full_name": "Jake Hughes",
        "timestamp": 1647375084
    },
    {
        "content": "<p>Enum variants don't have types. The closest to what you want I think is <code>mir::Place::ty</code> (<a href=\"https://doc.rust-lang.org/nightly/nightly-rustc/rustc_middle/mir/struct.Place.html#method.ty\">https://doc.rust-lang.org/nightly/nightly-rustc/rustc_middle/mir/struct.Place.html#method.ty</a>) which returns a <code>PlaceTy</code> which is a combination of a <code>Ty</code> and an optional variant index. Note that this method is on <code>mir::Place</code> and not on the <code>Place</code> of cg_ssa.</p>",
        "id": 275429403,
        "sender_full_name": "bjorn3",
        "timestamp": 1647375298
    },
    {
        "content": "<p>thanks bjorn, that looks like it might be what i'm after</p>",
        "id": 275431620,
        "sender_full_name": "Jake Hughes",
        "timestamp": 1647376494
    }
]