[
    {
        "content": "<p>I'm wanting to make a new Firefox for SPARC Solaris.  This apparently requires Rust.  But there is no Rust compiler for SPARC Solaris nor apparently any way to get one so now I'm trying to cross compile Firefox using an x64 Ubuntu host.  I <em>think</em> the first step is to install Rust in Ubuntu so I did </p>\n<h1>git clone <a href=\"https://github.com/rust-lang/rust.git\">https://github.com/rust-lang/rust.git</a></h1>\n<p>and then<br>\nx.py setup<br>\nThat went great until I reached the multiple choice quiz:<br>\nWelcome to the Rust project! What do you want to do with x.py?<br>\na) library: Contribute to the standard library<br>\nb) compiler: Contribute to the compiler or rustdoc<br>\nc) codegen: Contribute to the compiler, and also modify LLVM or codegen<br>\nd) user: Install Rust from source<br>\nPlease choose one (a/b/c/d): d</p>\n<p>Couldn't find required command: ninja<br>\nYou should install ninja, or set ninja=false in config.toml</p>\n<p>failed to run: /home/michele/rust/build/bootstrap/debug/bootstrap setup<br>\nBuild completed unsuccessfully in 0:21:30</p>\n<p>What, wrong answer?  All I want to do is install Rust on Ubuntu.  What is \"ninja\"?  Where do I get it?  Or is the offered alternative a better choice?</p>",
        "id": 221370184,
        "sender_full_name": "Michele",
        "timestamp": 1609537068
    },
    {
        "content": "<p>Ninja is a build tool, like make (you would have gotten the error no matter what you picked). If it's not available on solaris you can turn it off in config.toml with <code>ninja = false</code>.</p>",
        "id": 221370564,
        "sender_full_name": "Joshua Nelson",
        "timestamp": 1609537656
    },
    {
        "content": "<p>You might want to consider using a system llvm too - I assume you're packaging this for Solaris?</p>",
        "id": 221370615,
        "sender_full_name": "Joshua Nelson",
        "timestamp": 1609537725
    },
    {
        "content": "<p>Yes, the hope is to use x64 Ubuntu to cross compile a new Firefox for the target sunv9-sparc-solaris.  I don't have a config.toml file in my rust directory.  Should I copy config.toml.example to config.toml and add ninja - false to it?</p>",
        "id": 221370869,
        "sender_full_name": "Michele",
        "timestamp": 1609538140
    },
    {
        "content": "<p>sure, that would work</p>",
        "id": 221370942,
        "sender_full_name": "Joshua Nelson",
        "timestamp": 1609538250
    },
    {
        "content": "<p>personally I don't like copying config.toml.example because it's so giant, but it works fine</p>",
        "id": 221370946,
        "sender_full_name": "Joshua Nelson",
        "timestamp": 1609538266
    },
    {
        "content": "<p>Would it be better then to just make a one-line config.toml with \" ninja=false\" in it?</p>",
        "id": 221371009,
        "sender_full_name": "Michele",
        "timestamp": 1609538330
    },
    {
        "content": "<p>that's what I would do, yeah. It goes in the <code>build</code> section I think:</p>\n<div class=\"codehilite\" data-code-language=\"TOML\"><pre><span></span><code><span class=\"k\">[build]</span>\n<span class=\"n\">ninja</span> <span class=\"o\">=</span> <span class=\"kc\">false</span>\n</code></pre></div>",
        "id": 221371020,
        "sender_full_name": "Joshua Nelson",
        "timestamp": 1609538353
    },
    {
        "content": "<p>OK, that's done.  Now I'm back to the multiple choice quiz.  What answer should I give?  I'm not too proud to cheat :-)</p>",
        "id": 221371203,
        "sender_full_name": "Michele",
        "timestamp": 1609538629
    },
    {
        "content": "<p><span aria-label=\"laughing\" class=\"emoji emoji-1f606\" role=\"img\" title=\"laughing\">:laughing:</span> d was right before</p>",
        "id": 221371204,
        "sender_full_name": "Joshua Nelson",
        "timestamp": 1609538638
    },
    {
        "content": "<p>I wrote the quiz by the way, I'm the author of your misery :P</p>",
        "id": 221371246,
        "sender_full_name": "Joshua Nelson",
        "timestamp": 1609538650
    },
    {
        "content": "<p>Then I guess I came to the right place :-)  Anyway, I still flunked:</p>\n<p>Please choose one (a/b/c/d): d<br>\nfailed to parse TOML configuration 'config.toml': unknown field <code>ninja</code>, expected one of <code>build</code>, <code>host</code>, <code>target</code>, <code>build-dir</code>, <code>cargo</code>, <code>rustc</code>, <code>rustfmt</code>, <code>docs</code>, <code>compiler-docs</code>, <code>submodules</code>, <code>fast-submodules</code>, <code>gdb</code>, <code>nodejs</code>, <code>python</code>, <code>locked-deps</code>, <code>vendor</code>, <code>full-bootstrap</code>, <code>extended</code>, <code>tools</code>, <code>verbose</code>, <code>sanitizers</code>, <code>profiler</code>, <code>cargo-native-static</code>, <code>low-priority</code>, <code>configure-args</code>, <code>local-rebuild</code>, <code>print-step-timings</code>, <code>doc-stage</code>, <code>build-stage</code>, <code>test-stage</code>, <code>install-stage</code>, <code>dist-stage</code>, <code>bench-stage</code> for key <code>build</code> at line 1 column 1<br>\nfailed to run: /home/michele/rust/build/bootstrap/debug/bootstrap setup<br>\nBuild completed unsuccessfully in 0:01:21</p>",
        "id": 221371258,
        "sender_full_name": "Michele",
        "timestamp": 1609538714
    },
    {
        "content": "<p>oh I guessed wrong, sorry, <code>[llvm]</code> and not <code>[build]</code></p>",
        "id": 221371264,
        "sender_full_name": "Joshua Nelson",
        "timestamp": 1609538742
    },
    {
        "content": "<p>(you can tell by looking at config.toml.example)</p>",
        "id": 221371267,
        "sender_full_name": "Joshua Nelson",
        "timestamp": 1609538748
    },
    {
        "content": "<p>Well at least it's a different error this time:<br>\nPlease choose one (a/b/c/d): d<br>\nerror: you asked <code>x.py</code> to setup a new config file, but one already exists at <code>config.toml</code><br>\nhelp: try adding <code>profile = \"user\"</code> at the top of config.toml<br>\nnote: this will use the configuration in /home/michele/rust/src/bootstrap/defaults/config.user.toml<br>\nfailed to run: /home/michele/rust/build/bootstrap/debug/bootstrap setup<br>\nBuild completed unsuccessfully in 0:00:04</p>",
        "id": 221371418,
        "sender_full_name": "Michele",
        "timestamp": 1609538962
    },
    {
        "content": "<p>that means the error handling in <code>setup</code> is bad and it's not atomic <span aria-label=\"upside down\" class=\"emoji emoji-1f643\" role=\"img\" title=\"upside down\">:upside_down:</span> I need to fix it</p>",
        "id": 221371471,
        "sender_full_name": "Joshua Nelson",
        "timestamp": 1609539019
    },
    {
        "content": "<p><code>x.py build</code> should work now though</p>",
        "id": 221371473,
        "sender_full_name": "Joshua Nelson",
        "timestamp": 1609539025
    },
    {
        "content": "<p>err actually maybe <code>x.py dist</code>? I've never actually tried to install from source</p>",
        "id": 221371495,
        "sender_full_name": "Joshua Nelson",
        "timestamp": 1609539066
    },
    {
        "content": "<p>that will take a very long time unfortunately :/ <a href=\"https://github.com/rust-lang/rust/issues/65031\">https://github.com/rust-lang/rust/issues/65031</a></p>",
        "id": 221371722,
        "sender_full_name": "Joshua Nelson",
        "timestamp": 1609539459
    },
    {
        "content": "<p>Indeed. x.py build is underway but very slowly.  I'll have to get bbbbbbback to this later.  Thanks so much for your help.  Tht was like two weeks of help in 10 miiiiiiiiiiiinutes.</p>",
        "id": 221371772,
        "sender_full_name": "Michele",
        "timestamp": 1609539552
    },
    {
        "content": "<p>you're very welcome!</p>",
        "id": 221371775,
        "sender_full_name": "Joshua Nelson",
        "timestamp": 1609539564
    },
    {
        "content": "<p>Machine is soooo bogged the key debounce isn't working.</p>",
        "id": 221371779,
        "sender_full_name": "Michele",
        "timestamp": 1609539581
    },
    {
        "content": "<p>if you're swapping you probably want to add <code>-j2</code> or something</p>",
        "id": 221371784,
        "sender_full_name": "Joshua Nelson",
        "timestamp": 1609539599
    },
    {
        "content": "<p>rustc is a giant memory hog</p>",
        "id": 221371830,
        "sender_full_name": "Joshua Nelson",
        "timestamp": 1609539613
    },
    {
        "content": "<p>wrt firefox on Solaris SPARC, check out <a href=\"https://github.com/rust-lang/rust/issues/74551\">#74551</a></p>",
        "id": 221376151,
        "sender_full_name": "Nixon Enraght-Moony",
        "timestamp": 1609546891
    },
    {
        "content": "<p>Well at least this finally worked: <br>\n    Finished release [optimized] target(s) in 3m 27s<br>\nwarning: x.py has made several changes recently you may want to look at<br>\nhelp: consider looking at the changes in <code>src/bootstrap/CHANGELOG.md</code><br>\nnote: to silence this warning, add <code>changelog-seen = 2</code> at the top of <code>config.toml</code><br>\nnote: this message was printed twice to make it more likely to be seen<br>\nBuild completed successfully in 2:16:32</p>\n<p>But this:  </p>\n<p>\"wrt firefox on Solaris SPARC, check out <a href=\"https://github.com/rust-lang/rust/issues/74551\">#74551</a>\"</p>\n<p>is discouraging to say the least.  Am I correct in assuming that a bunch of people much smarter than me have been unable to achieve Firefox for SPARC Solaaris?</p>",
        "id": 221378044,
        "sender_full_name": "Michele",
        "timestamp": 1609550492
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"232545\">Joshua Nelson</span> <a href=\"#narrow/stream/182449-t-compiler.2Fhelp/topic/Building.20Rust.20cross.20compiler/near/221370946\">said</a>:</p>\n<blockquote>\n<p>personally I don't like copying config.toml.example because it's so giant, but it works fine</p>\n</blockquote>\n<div class=\"codehilite\" data-code-language=\"Bash\"><pre><span></span><code>β du -h ./config.toml.example\n28K     ./config.toml.example\n</code></pre></div>\n<p>am I missing something? <span aria-label=\"joy\" class=\"emoji emoji-1f602\" role=\"img\" title=\"joy\">:joy:</span></p>",
        "id": 221384932,
        "sender_full_name": "oliver",
        "timestamp": 1609564706
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"281739\">@oliver</span> not as an absolute file size, it's just really hard to find what you're changed and what's a default</p>",
        "id": 221385589,
        "sender_full_name": "Joshua Nelson",
        "timestamp": 1609566035
    },
    {
        "content": "<p>It's like 400 lines long</p>",
        "id": 221385592,
        "sender_full_name": "Joshua Nelson",
        "timestamp": 1609566045
    },
    {
        "content": "<p>Simple <code>diff</code> doesn't always work because the example file occasionally gets updated</p>",
        "id": 221385607,
        "sender_full_name": "Joshua Nelson",
        "timestamp": 1609566106
    },
    {
        "content": "<p>instead of this random i.e</p>\n<div class=\"codehilite\" data-code-language=\"Bash\"><pre><span></span><code><span class=\"c1\"># See `src/bootstrap/CHANGELOG.md` for more information.</span>\nchangelog-seen <span class=\"o\">=</span> <span class=\"m\">2</span>\n</code></pre></div>\n<p>it might be nice to have</p>\n<div class=\"codehilite\" data-code-language=\"Bash\"><pre><span></span><code><span class=\"c1\"># See `src/bootstrap/CHANGELOG.md` for more information.</span>\n<span class=\"c1\"># changelog-seen = 2</span>\nchangelog-seen <span class=\"o\">=</span> <span class=\"m\">2</span>\n</code></pre></div>\n<p>where the last comment line carries the default</p>",
        "id": 221385722,
        "sender_full_name": "oliver",
        "timestamp": 1609566354
    },
    {
        "content": "<p>Actually, in <a href=\"https://github.com/rust-lang/rust/issues/74551\">#74551</a>, @psumbera claims to have achieved a Firefox for SPARC:<br>\n\"Latest version I have tested is Rust 1.44.1. I can revert the commit and I can use it to build Firefox.\"<br>\nSo in the absence of hearing anything further, I will attempt to press on.  Now that I have managed to install Rust on my x64 Ubuntu, how do I set it up to cross compile to SPARC?  Is the following the correct spell?<br>\n$ rustup target add sparcv9-sun-solaris<br>\n$ ./configure --host=sparcv9-sun-solaris</p>",
        "id": 221407184,
        "sender_full_name": "Michele",
        "timestamp": 1609606342
    },
    {
        "content": "<p>if you have rustup already you don't need to compile from source</p>",
        "id": 221407201,
        "sender_full_name": "Joshua Nelson",
        "timestamp": 1609606422
    },
    {
        "content": "<p>Oh.  Well apparently I don't have rustup:</p>\n<p>root@michele-VirtualBox:/home/michele/rust# which rustup<br>\nroot@michele-VirtualBox:/home/michele/rust# echo $PATH<br>\n/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin:/usr/games:/usr/local/games:/snap/bin:.<br>\nroot@michele-VirtualBox:/home/michele/rust# <br>\nUnless it's hiding somewhere else.  How do I get rustup?</p>",
        "id": 221407308,
        "sender_full_name": "Michele",
        "timestamp": 1609606563
    },
    {
        "content": "<p>I would not combine building from source and rustup</p>",
        "id": 221407315,
        "sender_full_name": "Joshua Nelson",
        "timestamp": 1609606588
    },
    {
        "content": "<p>if you want to build from source, you can use <code>x.py build --target sparcv9-sun-solaris</code> (I think? <span class=\"user-mention\" data-user-id=\"332271\">@Grommish</span> would know better)</p>",
        "id": 221407324,
        "sender_full_name": "Joshua Nelson",
        "timestamp": 1609606616
    },
    {
        "content": "<p>When you say \"build from source\", you're referring to building rust, rustup, or Firefox?<br>\nI guess I want whatever's going to be the easiest with the highest probability of success.</p>",
        "id": 221407396,
        "sender_full_name": "Michele",
        "timestamp": 1609606730
    },
    {
        "content": "<p>... did you not care about whether rust is installed from source or not?</p>",
        "id": 221407412,
        "sender_full_name": "Joshua Nelson",
        "timestamp": 1609606791
    },
    {
        "content": "<p>you didn't need to spend the 2 hours compiling <span aria-label=\"laughing\" class=\"emoji emoji-1f606\" role=\"img\" title=\"laughing\">:laughing:</span></p>",
        "id": 221407430,
        "sender_full_name": "Joshua Nelson",
        "timestamp": 1609606802
    },
    {
        "content": "<p>'s OK, the CPU cycles are free and they help warm the room :-).  And I've already spent the two hours to build rust itself.  Or is that already capable of cross compiling just by giving it the appropriate target flag?  I'm afraid it is impossible to underestimate how little I know about all this.  I've tried looking things up but hit a mass of confusing and sometimes outdated information on the web.</p>",
        "id": 221407569,
        "sender_full_name": "Michele",
        "timestamp": 1609606981
    },
    {
        "content": "<p>but yeah the easiest way to do this is probably to install rustup (<a href=\"https://rustup.rs/\">https://rustup.rs/</a>) then <code>rustup target add</code> the sparc target and cross compile firefox</p>",
        "id": 221407579,
        "sender_full_name": "Joshua Nelson",
        "timestamp": 1609606990
    },
    {
        "content": "<p>assuming sparc is tier 2, I don't remember. you might need <code>-Z build-std</code></p>",
        "id": 221407596,
        "sender_full_name": "Joshua Nelson",
        "timestamp": 1609607030
    },
    {
        "content": "<p>No, sadly sparcv9-sun-solaris is in the third sub basement Tier 3.  If it wasn't I'd try building a rust compiler on the Sun and then building Firefox directly there.  So where should rustup live?  In the rust directory or does it figure out where to go itself?</p>",
        "id": 221407673,
        "sender_full_name": "Michele",
        "timestamp": 1609607142
    },
    {
        "content": "<p>it's a userland program, it doesn't install systemwide</p>",
        "id": 221407729,
        "sender_full_name": "Joshua Nelson",
        "timestamp": 1609607187
    },
    {
        "content": "<p>it figures out where to go itself</p>",
        "id": 221407739,
        "sender_full_name": "Joshua Nelson",
        "timestamp": 1609607206
    },
    {
        "content": "<p>OK then let me give that a try (installing rustup).  Thanks.</p>",
        "id": 221407754,
        "sender_full_name": "Michele",
        "timestamp": 1609607232
    },
    {
        "content": "<p>Uh oh:</p>\n<p>michele@michele-VirtualBox:~$ curl --proto '=https' --tlsv1.2 -sSf <a href=\"https://sh.rustup.rs\">https://sh.rustup.rs</a> | sh<br>\ninfo: downloading installer<br>\nwarning: it looks like you have an existing installation of Rust<br>\nwarning: rustup cannot be installed alongside Rust. Please uninstall first<br>\nwarning: run <code>/usr/local/lib/rustlib/uninstall.sh</code> as root to uninstall Rust<br>\nerror: cannot install while Rust is installed</p>\n<p>Continue? (y/N) </p>\n<p>What sayest thou, oh great Rustian?  Yay or nay?</p>",
        "id": 221407904,
        "sender_full_name": "Michele",
        "timestamp": 1609607451
    },
    {
        "content": "<p>I would remove your installed copy of rust and then install rustup</p>",
        "id": 221407916,
        "sender_full_name": "Joshua Nelson",
        "timestamp": 1609607503
    },
    {
        "content": "<p>Rustup is great as long as it meets the requirements you need, and is certainly easier than building from source.  Source built just gives you greater control over what it actuallly can do.  And yes, compiling Rust from source will take a while, BUT most people only need to do it once.  </p>\n<p>I use <code>x.py</code>, but only after using <code>./configure</code> to build out the config.toml using flags.. </p>\n<p><code>./configure --host=x86_64-unknown-linux-gnu --build=x86_64-unknown-linux-gnu --target=mips64-openwrt-linux-musl  --release-channel=nightly  --enable-lld --enable-option-checking --enable-ninja --enable-full-tools --enable-manage-submodules --enable-full-bootstrap</code> </p>\n<p>then I call <code>RUST_BACKTRACE=full python x.py --config ./config.toml dist cargo extended library/std llvm-tools miri rust-dev rustc-dev</code></p>\n<p>This leaves me with compiled binaries I can then save.  I need to go this route because of the unique environment I'm doing this in, and you probably wouldn't need as much.</p>",
        "id": 221407920,
        "sender_full_name": "Grommish",
        "timestamp": 1609607507
    },
    {
        "content": "<p>(why enable-full-bootstrap??)</p>",
        "id": 221407963,
        "sender_full_name": "Joshua Nelson",
        "timestamp": 1609607528
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"232545\">Joshua Nelson</span> <a href=\"#narrow/stream/182449-t-compiler.2Fhelp/topic/Building.20Rust.20cross.20compiler/near/221407963\">said</a>:</p>\n<blockquote>\n<p>(why enable-full-bootstrap??)</p>\n</blockquote>\n<p>Well.. Because I need Stage 1 and Stage 2 artifacts for the target device and that's the only way I've seen it created.  I also only use the prebuilt to kick off stage 0 because of people not liking \"precompiled\" in the OpenWrt environent.  It was this, or try and build every iteration of Rust from the beginning and using that one to bounce thru the next.. that would take DAYS and about 150GB footprint. :(</p>\n<p>If you have a better way, I'm all eyes :D  You know I'm always looking for ways to make this easier on myself!</p>",
        "id": 221408043,
        "sender_full_name": "Grommish",
        "timestamp": 1609607668
    },
    {
        "content": "<p>Why do you need both stage 1 and stage 2 artifacts?</p>",
        "id": 221408076,
        "sender_full_name": "bjorn3",
        "timestamp": 1609607708
    },
    {
        "content": "<p>enable-full-bootstrap means to build the compiler three times instead of reusing stage2 libraries</p>",
        "id": 221408090,
        "sender_full_name": "Joshua Nelson",
        "timestamp": 1609607746
    },
    {
        "content": "<p>I can't imagine why you would need that</p>",
        "id": 221408094,
        "sender_full_name": "Joshua Nelson",
        "timestamp": 1609607753
    },
    {
        "content": "<p>Because I'm cross compiling inside the fakeroot OpenWrt build environment, so it spends half the time thinking its x86 and half the time thinking its mips64 Octeon3</p>",
        "id": 221408134,
        "sender_full_name": "Grommish",
        "timestamp": 1609607763
    },
    {
        "content": "<p>Umm... well my requirements are to be able to cross-compile Firefox sources to a target of sparcv9-sun-solaris.  Keep what I have (my Rust build form yesterday) or start over with rustup?  The compile time isn't really an issue.  I can do other things while I'm waiting.</p>",
        "id": 221408141,
        "sender_full_name": "Michele",
        "timestamp": 1609607795
    },
    {
        "content": "<p>rustup will fail quickly if it fails so I would try that first</p>",
        "id": 221408168,
        "sender_full_name": "Joshua Nelson",
        "timestamp": 1609607853
    },
    {
        "content": "<p>x.py is a tarpit <span aria-label=\"sweat smile\" class=\"emoji emoji-1f605\" role=\"img\" title=\"sweat smile\">:sweat_smile:</span></p>",
        "id": 221408170,
        "sender_full_name": "Joshua Nelson",
        "timestamp": 1609607857
    },
    {
        "content": "<p>Rustup will be your best bet I think.  You are doing standard things and Rustup is usually very very good it.  I couldn't use it because of some specialized things I have to do, otherwise, I'd use Rustup</p>",
        "id": 221408176,
        "sender_full_name": "Grommish",
        "timestamp": 1609607880
    },
    {
        "content": "<p>What kind of specialized things?</p>",
        "id": 221408228,
        "sender_full_name": "bjorn3",
        "timestamp": 1609607929
    },
    {
        "content": "<p>OK, so I'm about to run<br>\n/usr/local/lib/rustlib/uninstall.sh`</p>",
        "id": 221408236,
        "sender_full_name": "Michele",
        "timestamp": 1609607945
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"372827\">Michele</span> <a href=\"#narrow/stream/182449-t-compiler.2Fhelp/topic/Building.20Rust.20cross.20compiler/near/221408236\">said</a>:</p>\n<blockquote>\n<p>OK, so I'm about to run<br>\n/usr/local/lib/rustlib/uninstall.sh`</p>\n</blockquote>\n<p>this saves your build cache btw, it will be quick to reinstall if you need to</p>",
        "id": 221408241,
        "sender_full_name": "Joshua Nelson",
        "timestamp": 1609607977
    },
    {
        "content": "<p>root@michele-VirtualBox:/home/michele# /usr/local/lib/rustlib/uninstall.sh<br>\ninstall: uninstalling component 'rust-docs'<br>\ninstall: uninstalling component 'rust-std-x86_64-unknown-linux-gnu'<br>\ninstall: uninstalling component 'rust-std-sparcv9-sun-solaris'<br>\ninstall: uninstalling component 'rustc'</p>\n<div class=\"codehilite\"><pre><span></span><code>Rust is uninstalled.\n</code></pre></div>\n\n<p>root@michele-VirtualBox:/home/michele#</p>",
        "id": 221408248,
        "sender_full_name": "Michele",
        "timestamp": 1609607990
    },
    {
        "content": "<p>Rustup defaults to Hard-float and Statically linksed.  OpenWrt MUSL is Soft-float and Dynamically linked.  I also have to account for custom triple defines on the backend for the various OpenWrt builds that can or might happen <span class=\"user-mention\" data-user-id=\"133247\">@bjorn3</span> I built this for inclusion into the OpenWrt build system and has to cover multiple hosts and target combinations, all cross-compiling</p>",
        "id": 221408296,
        "sender_full_name": "Grommish",
        "timestamp": 1609608032
    },
    {
        "content": "<p>So now try again<br>\ncurl --proto '=https' --tlsv1.2 -sSf <a href=\"https://sh.rustup.rs\">https://sh.rustup.rs</a> | sh   ?</p>",
        "id": 221408299,
        "sender_full_name": "Michele",
        "timestamp": 1609608043
    },
    {
        "content": "<p>Would <code>cargo build -Zbuild-std</code> work <span class=\"user-mention\" data-user-id=\"332271\">@Grommish</span>? You may even be able to copy the sysroot for mips64 that will be compiled by cargo to the default sysroot dir of your rustc installation.</p>",
        "id": 221408371,
        "sender_full_name": "bjorn3",
        "timestamp": 1609608145
    },
    {
        "content": "<p>Arrgh, another multiple choice quiz.  Recalling that I want Rust to target sparcv9-sun-solaris, do I want option 1 or 2?</p>\n<p>Current installation options:</p>\n<p>default host triple: x86_64-unknown-linux-gnu<br>\n     default toolchain: stable (default)<br>\n               profile: default<br>\n  modify PATH variable: yes</p>\n<p>1) Proceed with installation (default)<br>\n2) Customize installation<br>\n3) Cancel installation<br>\n&gt;</p>",
        "id": 221408395,
        "sender_full_name": "Michele",
        "timestamp": 1609608187
    },
    {
        "content": "<p>that should be fine</p>",
        "id": 221408406,
        "sender_full_name": "Joshua Nelson",
        "timestamp": 1609608205
    },
    {
        "content": "<p>Use 1. You can add the target later.</p>",
        "id": 221408411,
        "sender_full_name": "bjorn3",
        "timestamp": 1609608210
    },
    {
        "content": "<p>The host arch needs to be one that the system you are running rustc on can run.</p>",
        "id": 221408458,
        "sender_full_name": "bjorn3",
        "timestamp": 1609608249
    },
    {
        "content": "<p>It's going.  And somehow it already knew about my target:<br>\n...<br>\ninfo: downloading component 'rust-std' for 'sparcv9-sun-solaris'</p>",
        "id": 221408467,
        "sender_full_name": "Michele",
        "timestamp": 1609608275
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"133247\">@bjorn3</span> cargo is built out when I compile.  as far as rustup for it, I'm not sure.  Between the adversity to precompiled and the hard-float/linked issues, I dead-ended on rustup as an option a while ago and settled on just making source work (and it does, btw, finally! With many thanks to <span class=\"user-mention\" data-user-id=\"232545\">@Joshua Nelson</span> :D)</p>",
        "id": 221408552,
        "sender_full_name": "Grommish",
        "timestamp": 1609608424
    },
    {
        "content": "<p>Well this seems to have Just Worked :-)</p>\n<hr>\n<p>Rust is installed now. Great!</p>\n<p>To get started you need Cargo's bin directory ($HOME/.cargo/bin) in your PATH<br>\nenvironment variable. Next time you log in this will be done<br>\nautomatically.</p>\n<p>To configure your current shell, run:<br>\nsource $HOME/.cargo/env<br>\nmichele@michele-VirtualBox:~$ source $HOME/.cargo/env<br>\nmichele@michele-VirtualBox:~$ </p>\n<p>What spells do I need to cast now to make it cross compile to SPARC?</p>",
        "id": 221409210,
        "sender_full_name": "Michele",
        "timestamp": 1609609329
    },
    {
        "content": "<p>On your Firefox compile, you'll need to set the --host/build and --target flags I'd assume, so it knows to pass that on.  I don't use Rustup, but there was a way to list the installed toolchains</p>",
        "id": 221409359,
        "sender_full_name": "Grommish",
        "timestamp": 1609609591
    },
    {
        "content": "<p>Oh hold it, maybe I can answer my own question for once.   In <a href=\"https://blog.rust-lang.org/2016/05/13/rustup.html\">https://blog.rust-lang.org/2016/05/13/rustup.html</a> it says to say<br>\n$ rustup target add [target-name]<br>\nDoes that sound right?</p>",
        "id": 221409431,
        "sender_full_name": "Michele",
        "timestamp": 1609609708
    },
    {
        "content": "<p>Oh OK so now I can just switch over to my Firefox source directory and have a go at it?</p>",
        "id": 221409457,
        "sender_full_name": "Michele",
        "timestamp": 1609609764
    },
    {
        "content": "<p>Ah, never mind - I see:<br>\nmichele@michele-VirtualBox:~$ rustup show<br>\nDefault host: x86_64-unknown-linux-gnu<br>\nrustup home:  /home/michele/.rustup</p>\n<p>installed targets for active toolchain</p>\n<hr>\n<p>sparcv9-sun-solaris<br>\nx86_64-unknown-linux-gnu</p>\n<p>active toolchain</p>\n<hr>\n<p>stable-x86_64-unknown-linux-gnu (default)<br>\nrustc 1.49.0 (e1884a8e3 2020-12-29)</p>\n<p>michele@michele-VirtualBox:~$</p>",
        "id": 221409518,
        "sender_full_name": "Michele",
        "timestamp": 1609609829
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"332271\">Grommish</span> <a href=\"#narrow/stream/182449-t-compiler.2Fhelp/topic/Building.20Rust.20cross.20compiler/near/221408134\">said</a>:</p>\n<blockquote>\n<p>Because I'm cross compiling inside the fakeroot OpenWrt build environment, so it spends half the time thinking its x86 and half the time thinking its mips64 Octeon3</p>\n</blockquote>\n<p>I would not expect this to require enable-full-bootstrap though</p>",
        "id": 221409588,
        "sender_full_name": "Joshua Nelson",
        "timestamp": 1609609993
    },
    {
        "content": "<p>the stage1 artifacts should work fine for linking against</p>",
        "id": 221409591,
        "sender_full_name": "Joshua Nelson",
        "timestamp": 1609610001
    },
    {
        "content": "<p>Looks right, the host toolchain should be defaulted, but that's why you pass the --target into the Firefox</p>",
        "id": 221409595,
        "sender_full_name": "Grommish",
        "timestamp": 1609610004
    },
    {
        "content": "<p>(recall that 'stage 1 artifacts' means 'built by stage 1', not 'part of the stage 1 toolchain')</p>",
        "id": 221409606,
        "sender_full_name": "Joshua Nelson",
        "timestamp": 1609610035
    },
    {
        "content": "<p>Stage 1 is HOST though, not target, correct?  Stage 2 is where the target versions are kept?</p>",
        "id": 221409648,
        "sender_full_name": "Grommish",
        "timestamp": 1609610067
    },
    {
        "content": "<p><a href=\"https://rustc-dev-guide.rust-lang.org/building/bootstrapping.html#understanding-stages-of-bootstrap\">https://rustc-dev-guide.rust-lang.org/building/bootstrapping.html#understanding-stages-of-bootstrap</a></p>",
        "id": 221409680,
        "sender_full_name": "Joshua Nelson",
        "timestamp": 1609610138
    },
    {
        "content": "<p>stage1 <em>toolchain</em> is the host</p>",
        "id": 221409681,
        "sender_full_name": "Joshua Nelson",
        "timestamp": 1609610142
    },
    {
        "content": "<p>stage1 <em>artifacts</em> are uplifted to stage2</p>",
        "id": 221409686,
        "sender_full_name": "Joshua Nelson",
        "timestamp": 1609610149
    },
    {
        "content": "<p>Thanks for looking at it.  I guess now I'm off to Mozilla's directions and see what happens there:<br>\n<a href=\"https://developer.mozilla.org/en-US/docs/Mozilla/Developer_guide/Build_Instructions/Cross-compiling_Mozilla\">https://developer.mozilla.org/en-US/docs/Mozilla/Developer_guide/Build_Instructions/Cross-compiling_Mozilla</a></p>",
        "id": 221409753,
        "sender_full_name": "Michele",
        "timestamp": 1609610234
    },
    {
        "content": "<p>Well sadly, my first attempt at cross compiling Firefox never got out of config:</p>\n<p>michele@michele-VirtualBox:~/firefox-69.0.3/build$ ../configure --target=sparcv9-sun-solaris<br>\n...<br>\nDEBUG: configure:4062: /usr/bin/clang -std=gnu99 --target=sparcv9-solaris2 -o conftest  -Qunused-arguments    conftest.c  1&gt;&amp;5<br>\nDEBUG: /usr/bin/ld: unrecognized option '-C'<br>\nDEBUG: /usr/bin/ld: use the --help option for usage information<br>\nDEBUG: clang: error: linker command failed with exit code 1 (use -v to see invocation)<br>\nDEBUG: configure: failed program was:<br>\nDEBUG: #line 4055 \"configure\"<br>\nDEBUG: #include \"confdefs.h\"<br>\nDEBUG: <br>\nDEBUG: int main() {<br>\nDEBUG: <br>\nDEBUG: ; return 0; }<br>\nDEBUG: configure: error: compiler is incompatible with sanitize options<br>\nERROR: old-configure failedI</p>\n<p>I don't know if this is still a Rust issue but everyone here is so nice and so smart I thought I'd ask.  I'm guessing that configure is using the wrong ld.   It's using /usr/bin/ld but -C is not a Linux ld option though  it is a Solaris 11.4 ld option.  How do I point it to my Solaris ld which is in /usr/sparcv9-solaris/solaris/cross/bin/ld?  (I checked ./configure --help but there's no options for ld in there)</p>",
        "id": 221418917,
        "sender_full_name": "Michele",
        "timestamp": 1609623832
    },
    {
        "content": "<p>It is Rust Tangent.  You need to set environmentals for your compiler I believe.  You can do this in the configure flags</p>\n<div class=\"codehilite\"><pre><span></span><code>  --set=target.$(RUSTC_TARGET_ARCH).linker=$(TARGET_CC_NOCACHE) \\\n  --set=target.$(RUSTC_TARGET_ARCH).cc=$(TARGET_CC_NOCACHE) \\\n  --set=target.$(RUSTC_TARGET_ARCH).cxx=$(TARGET_CXX_NOCACHE) \\\n  --set=target.$(RUSTC_TARGET_ARCH).ar=$(TARGET_AR) \\\n  --set=target.$(RUSTC_TARGET_ARCH).ranlib=$(TARGET_RANLIB)\n</code></pre></div>\n<p>See if that doesn't help..</p>",
        "id": 221419079,
        "sender_full_name": "Grommish",
        "timestamp": 1609624050
    },
    {
        "content": "<p>Or, similar to Mozilla I guess. sorry, I forgot you went with Rustup.. check Moz's configure and see if you can set those type in their config or maybe pass in environentals before?<br>\n You are trying to tell it to use the cross-compiled linker, not the HOSTs</p>",
        "id": 221419229,
        "sender_full_name": "Grommish",
        "timestamp": 1609624250
    },
    {
        "content": "<p>Yes, I looked for \"ld\" and \"link\" in the Firefox's configure --help but there's nothing for that.  They also have a mozconfig file (and/or a .mozconfig) so I'll look there too.</p>",
        "id": 221419406,
        "sender_full_name": "Michele",
        "timestamp": 1609624508
    },
    {
        "content": "<p>Oh - is there a pm function in this board?  If I could contact @psumbera directly maybe he could tell me how he did it.</p>",
        "id": 221419456,
        "sender_full_name": "Michele",
        "timestamp": 1609624570
    },
    {
        "content": "<p>One last thing you can try is</p>\n<div class=\"codehilite\"><pre><span></span><code>RUSTFLAGS=&quot;-C linker=$(TARGET_CC_NOCACHE) -C ar=$(TARGET_AR)&quot;\n</code></pre></div>\n<p>In your arg string.  Point those to the correct places.</p>",
        "id": 221419656,
        "sender_full_name": "Grommish",
        "timestamp": 1609624908
    },
    {
        "content": "<p>That sounded good but:<br>\nmichele@michele-VirtualBox:~/firefox-69.0.3/build$ ../configure --target=sparcv9-sun-solaris --RUSTFLAGS=\"-C linker=/usr/sparcv9-solaris/solaris/cross/bin/ld -C ar=/usr/sparcv9-solaris/solaris/cross/bin/sparcv9-solaris2.11-ar\"<br>\nTraceback (most recent call last):<br>\n  File \"../configure.py\", line 133, in &lt;module&gt;<br>\n    sys.exit(main(sys.argv))<br>\n  File \"../configure.py\", line 34, in main<br>\n    sandbox = ConfigureSandbox(config, os.environ, argv)<br>\n  File \"/home/michele/firefox-69.0.3/python/mozbuild/mozbuild/configure/__init__.py\", line 343, in __init__<br>\n    self._helper = CommandLineHelper(environ, argv)<br>\n  File \"/home/michele/firefox-69.0.3/python/mozbuild/mozbuild/configure/options.py\", line 438, in __init__<br>\n    self.add(arg, 'command-line', self._args)<br>\n  File \"/home/michele/firefox-69.0.3/python/mozbuild/mozbuild/configure/options.py\", line 442, in add<br>\n    prefix, name, values = Option.split_option(arg)<br>\n  File \"/home/michele/firefox-69.0.3/python/mozbuild/mozbuild/configure/options.py\", line 286, in split_option<br>\n    raise InvalidOptionError('Option must be all lowercase')<br>\nmozbuild.configure.options.InvalidOptionError: Option must be all lowercase</p>",
        "id": 221420866,
        "sender_full_name": "Michele",
        "timestamp": 1609626638
    },
    {
        "content": "<p>Oh, Sorry.. Not --RUSTFLAGS. Put it BEFORE the comand.</p>\n<p><code>RUSTFLAGS=\"-C linker=/usr/sparcv9-solaris/solaris/cross/bin/ld -C ar=/usr/sparcv9-solaris/solaris/cross/bin/sparcv9-solaris2.11-ar\" RUST_BACKTRACE=full ../configure --target=sparcv9-sun-solaris</code></p>",
        "id": 221431731,
        "sender_full_name": "Grommish",
        "timestamp": 1609645610
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"372827\">Michele</span> <a href=\"#narrow/stream/182449-t-compiler.2Fhelp/topic/Building.20Rust.20cross.20compiler/near/221419456\">said</a>:</p>\n<blockquote>\n<p>Oh - is there a pm function in this board?  If I could contact @psumbera directly maybe he could tell me how he did it.</p>\n</blockquote>\n<p>I don't think they're on this zulip</p>",
        "id": 221431795,
        "sender_full_name": "Joshua Nelson",
        "timestamp": 1609645721
    },
    {
        "content": "<p>I don't remember what chat platform mozilla moved to, Matrix maybe</p>",
        "id": 221431799,
        "sender_full_name": "Joshua Nelson",
        "timestamp": 1609645736
    },
    {
        "content": "<p>Yes, Matrix. It can be found at <a href=\"http://chat.mozilla.org\">chat.mozilla.org</a>.</p>",
        "id": 221446629,
        "sender_full_name": "bjorn3",
        "timestamp": 1609673132
    },
    {
        "content": "<p>No, I was referring to <a href=\"https://github.com/rust-lang/rust/issues/74551\">https://github.com/rust-lang/rust/issues/74551</a>.  Someone named Petr Sumbera (@psumbera) there claims to have cross-compiled Firefox.  I incorrectly thought that post was on this Zulip chat.  It's the github rust board but I don't see any way to send pm's there either.</p>",
        "id": 221466344,
        "sender_full_name": "Michele",
        "timestamp": 1609701654
    },
    {
        "content": "<p>Oh, OK.  It still didn't change anything though.<br>\nmichele@michele-VirtualBox:~/firefox-69.0.3/build$ echo $RUSTFLAGS<br>\n-C linker=/usr/sparcv9-solaris/solaris/cross/bin/ld -C ar=/usr/sparcv9-solaris/solaris/cross/bin/sparcv9-solaris2.11-ar<br>\nmichele@michele-VirtualBox:~/firefox-69.0.3/build$ echo $RUST_BACKTRACE<br>\nfull<br>\nmichele@michele-VirtualBox:~/firefox-69.0.3/build$ ../configure --target=sparcv9-sun-solaris<br>\n...<br>\nDEBUG: configure:4062: /usr/bin/clang -std=gnu99 --target=sparcv9-solaris2 -o conftest  -Qunused-arguments    conftest.c  1&gt;&amp;5<br>\nDEBUG: /usr/bin/ld: unrecognized option '-C'<br>\nDEBUG: /usr/bin/ld: use the --help option for usage information<br>\nDEBUG: clang: error: linker command failed with exit code 1 (use -v to see invocation)<br>\nDEBUG: configure: failed program was:<br>\nDEBUG: #line 4055 \"configure\"<br>\nDEBUG: #include \"confdefs.h\"<br>\nDEBUG: <br>\nDEBUG: int main() {<br>\nDEBUG: <br>\nDEBUG: ; return 0; }<br>\nDEBUG: configure: error: compiler is incompatible with sanitize options<br>\nERROR: old-configure failed</p>\n<p>It stubbornly insists on using /usr/bin/ld.  Hmm, since it's so hot on /usr/bin/ld maybe I should just ln -s /usr/bin/ld to /usr/sparcv9-solaris/solaris/cross/bin/ld.</p>",
        "id": 221466629,
        "sender_full_name": "Michele",
        "timestamp": 1609702177
    },
    {
        "content": "<p>Hmm, so I said<br>\nroot@michele-VirtualBox:/usr/sparcv9-solaris/solaris/cross/bin# cp /usr/bin/ld /usr/bin/ld.orig<br>\nroot@michele-VirtualBox:/usr/sparcv9-solaris/solaris/cross/bin# rm /usr/bin/ld<br>\nroot@michele-VirtualBox:/usr/sparcv9-solaris/solaris/cross/bin# cp ./ld /usr/bin/ld<br>\nroot@michele-VirtualBox:/usr/sparcv9-solaris/solaris/cross/bin# file ./ld<br>\n./ld: ELF 64-bit MSB shared object, SPARC V9, total store ordering, version 1 (Solaris), dynamically linked, interpreter /usr/lib/sparcv9/ld.so.1, not stripped<br>\nroot@michele-VirtualBox:/usr/sparcv9-solaris/solaris/cross/bin# <br>\n../configure --target=sparcv9-sun-solaris<br>\n...<br>\nDEBUG: configure:4062: /usr/bin/clang -std=gnu99 --target=sparcv9-solaris2 -o conftest  -Qunused-arguments    conftest.c  1&gt;&amp;5<br>\nDEBUG: clang: error: unable to execute command: posix_spawn failed: Exec format error<br>\nDEBUG: clang: error: linker command failed with exit code 1 (use -v to see invocation)<br>\nDEBUG: configure: failed program was:<br>\nDEBUG: #line 4055 \"configure\"<br>\nDEBUG: #include \"confdefs.h\"<br>\nDEBUG: <br>\nDEBUG: int main() {<br>\nDEBUG: <br>\nDEBUG: ; return 0; }<br>\nDEBUG: configure: error: compiler is incompatible with sanitize options<br>\nERROR: old-configure failed</p>\n<p>So at least now it's not complaining about -C.  But what the heck is \"posix_spawn\"?  There's not much that's very informative about this on the web (that I can find).</p>",
        "id": 221467177,
        "sender_full_name": "Michele",
        "timestamp": 1609702899
    },
    {
        "content": "<p>Oh wait - I see it's also using /usr/bin/clang.  Is ../configure supposed to be using the SPARC clang?  Honestly, this cross compile stuff is making my eyes cross.</p>",
        "id": 221467443,
        "sender_full_name": "Michele",
        "timestamp": 1609703266
    },
    {
        "content": "<p><code>posix_spawn</code> is used to spawn a new process. It can be faster than <code>fork</code>+<code>exec</code>.</p>",
        "id": 221469733,
        "sender_full_name": "bjorn3",
        "timestamp": 1609706113
    },
    {
        "content": "<p>it's essentially <code>vfork</code>+<code>exec</code>, which avoids duplicating the page tables for the interim fork</p>",
        "id": 221571317,
        "sender_full_name": "cuviper",
        "timestamp": 1609789668
    },
    {
        "content": "<blockquote>\n<p>vfork</p>\n</blockquote>\n<p><a href=\"https://youtu.be/FIaOmkqrVi0?t=132\">https://youtu.be/FIaOmkqrVi0?t=132</a></p>\n<div class=\"youtube-video message_inline_image\"><a data-id=\"FIaOmkqrVi0\" href=\"https://youtu.be/FIaOmkqrVi0?t=132\"><img src=\"https://i.ytimg.com/vi/FIaOmkqrVi0/default.jpg\"></a></div>",
        "id": 221572017,
        "sender_full_name": "Joshua Nelson",
        "timestamp": 1609789963
    },
    {
        "content": "<p>I see.  Right now I'm trying to nail down this ld issue.  I simplified the problem as much as I could and still get:</p>\n<p>michele@michele-VirtualBox:~$ clang helloworld.c --target=sparcv9-sun-solaris -I/usr/sparcv9-solaris/solaris/cross/sysroot/usr/include/sys --sysroot=/usr/sparcv9-solaris/solaris/cross/sysroot<br>\n/usr/bin/ld: unrecognized option '-C'<br>\n/usr/bin/ld: use the --help option for usage information<br>\nclang: error: linker command failed with exit code 1 (use -v to see invocation)</p>\n<p>I guess this is drifting a bit away from Rust now but thanks to all for your help so far.</p>",
        "id": 221587254,
        "sender_full_name": "Michele",
        "timestamp": 1609797793
    },
    {
        "content": "<p>Well it looks like I have officially stumped the Mozilla devs.  In doing my cross-compile I'm getting this error:<br>\nmichele@michele-VirtualBox:/usr/sparcv9-solaris/solaris/cross/bin$ /home/michele/.rustup/toolchains/stable-x86_64-unknown-linux-gnu/bin/rustc - --crate-name ___ --print=file-names -C --crate-type bin --crate-type rlib --crate-type dylib --crate-type cdylib --crate-type staticlib --crate-type proc-macro --print=sysroot --print=cfg<br>\nerror: unknown codegen option: <code>--crate-type</code></p>\n<p>This happened during Mozilla's mach build but I can reproduce it by itself from the command line in a different directory.  Any idea what this means?</p>",
        "id": 222366600,
        "sender_full_name": "Michele",
        "timestamp": 1610403813
    },
    {
        "content": "<p>What happens if you remove the <code>-C</code> between <code>--print=file-names</code> and <code>--crate-type bin</code>?</p>",
        "id": 222366797,
        "sender_full_name": "cjgillot",
        "timestamp": 1610403933
    },
    {
        "content": "<p>Very odd.  When I type<br>\nmichele@michele-VirtualBox:/usr/sparcv9-solaris/solaris/cross/bin$ /home/michele/.rustup/toolchains/stable-x86_64-unknown-linux-gnu/bin/rustc - --crate-name ___ --print=file-names --crate-type bin --crate-type rlib --crate-type dylib --crate-type cdylib --crate-type staticlib --crate-type proc-macro --print=sysroot --print=cfg</p>\n<p>nothing at all happens.  It's been sitting there for five minutes and hasn't generated any output at all.  What should happen?</p>",
        "id": 222379509,
        "sender_full_name": "Michele",
        "timestamp": 1610412792
    },
    {
        "content": "<p>It looks like you have a single - at the start, so it might be reading from stdin?</p>",
        "id": 222379561,
        "sender_full_name": "simulacrum",
        "timestamp": 1610412832
    },
    {
        "content": "<p>That shouldn't be necessary</p>",
        "id": 222379617,
        "sender_full_name": "simulacrum",
        "timestamp": 1610412861
    },
    {
        "content": "<p>I don't know.  That single dash after \"rustc\" is the way it appears in the mach build command that throws the error.  Should I complain to Mozilla about that?</p>",
        "id": 222379673,
        "sender_full_name": "Michele",
        "timestamp": 1610412920
    },
    {
        "content": "<p>hm, not sure - maybe try giving it an empty file instead?</p>",
        "id": 222379990,
        "sender_full_name": "simulacrum",
        "timestamp": 1610413186
    },
    {
        "content": "<p>Am I giving it a file name?  All I see is a bunch of dash dash options.</p>",
        "id": 222380130,
        "sender_full_name": "Michele",
        "timestamp": 1610413294
    },
    {
        "content": "<blockquote>\n<p>rustc - --crate-name ___ </p>\n</blockquote>\n<p>this means to compile stdin</p>",
        "id": 222380152,
        "sender_full_name": "Joshua Nelson",
        "timestamp": 1610413312
    },
    {
        "content": "<p>Oh.  I didn't know that.  Well then that seems to point the finger at a spurious -C option since it's not giving an error when I remove it.  I'm going back over to the Mozilla chat to see what they think about it.  If anyone's interested, it's <a href=\"https://chat.mozilla.org/#/room/#build:mozilla.org\">https://chat.mozilla.org/#/room/#build:mozilla.org</a></p>",
        "id": 222380304,
        "sender_full_name": "Michele",
        "timestamp": 1610413424
    },
    {
        "content": "<p>Cargo runs that rustc command at the start of a compilation to detect the target configuration. It probably just gives an empty source file on stdin, which you can simulate using ctrl-d to send eof on stdin.</p>",
        "id": 222393337,
        "sender_full_name": "bjorn3",
        "timestamp": 1610429442
    },
    {
        "content": "<p>Thanks!  CTRL-D did the trick and the command ran successfully.  Why do you suppose they've got that -C in there and why does that throw an error?</p>",
        "id": 222490354,
        "sender_full_name": "Michele",
        "timestamp": 1610483675
    }
]