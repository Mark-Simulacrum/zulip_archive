[
    {
        "content": "<p>Hi, I have defined a lint here: <a href=\"https://github.com/sexxi-goose/rust/pull/42/commits/a29dde10b5bfdd6c1f29095a6b5f824c8cb79106\">https://github.com/sexxi-goose/rust/pull/42/commits/a29dde10b5bfdd6c1f29095a6b5f824c8cb79106</a></p>\n<p>But the doc tests for it are failing when I run the tests locally:</p>\n<div class=\"codehilite\"><pre><span></span><code>error: failed to test example in lint docs for `disjoint_capture_drop_reorder` in /users/a52arora/rust/compiler/rustc_lint_defs/src/builtin.rs:2907: did not find lint `disjoint_capture_drop_reorder` in output of example, got:\n</code></pre></div>\n<p>The lint is set to be <code>[allow]</code> by default because this is just the first step and it isn't quite there yet.</p>\n<p>When I test this with <code>deny(disjoint_capture_drop_reorder)</code> it does work, so I'm not sure if it needs to deny/warn by default to pass the test or if I'm misisng something?</p>",
        "id": 221319921,
        "sender_full_name": "Aman Arora",
        "timestamp": 1609452194
    },
    {
        "content": "<p>Also is there a way to get around not having to use <code>_y</code> as the name of the field, without triggering an unused code warning? <code>[allow(unused)]</code> didn't help</p>",
        "id": 221320074,
        "sender_full_name": "Aman Arora",
        "timestamp": 1609452320
    },
    {
        "content": "<p>And is there a way to run these tests without having to compile everything again? These run at the very end of stage1 testsuite <span aria-label=\"frown\" class=\"emoji emoji-1f641\" role=\"img\" title=\"frown\">:frown:</span></p>",
        "id": 221320894,
        "sender_full_name": "Aman Arora",
        "timestamp": 1609452937
    },
    {
        "content": "<p>I would expect <code>x.py test --stage 1 compiler/rustc_lint_defs</code> to work</p>",
        "id": 221320962,
        "sender_full_name": "Joshua Nelson",
        "timestamp": 1609452986
    },
    {
        "content": "<p>the rest I'm not sure off the top of my head, I'll look when I get off work</p>",
        "id": 221320972,
        "sender_full_name": "Joshua Nelson",
        "timestamp": 1609452999
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"232545\">Joshua Nelson</span> <a href=\"#narrow/stream/182449-t-compiler.2Fhelp/topic/lint.20docs/near/221320962\">said</a>:</p>\n<blockquote>\n<p>I would expect <code>x.py test --stage 1 compiler/rustc_lint_defs</code> to work</p>\n</blockquote>\n<p>I'll try that</p>",
        "id": 221320995,
        "sender_full_name": "Aman Arora",
        "timestamp": 1609453027
    },
    {
        "content": "<p>if that doesn't work, try looking around <code>src/bootstrap/*.rs</code> and see if you find something</p>",
        "id": 221321079,
        "sender_full_name": "Joshua Nelson",
        "timestamp": 1609453099
    },
    {
        "content": "<p>Sounds good</p>",
        "id": 221321395,
        "sender_full_name": "Aman Arora",
        "timestamp": 1609453426
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"281950\">@Aman Arora</span> If you have an allow-by-default lint, then the example needs to include <code>#![deny(disjoint_capture_drop_reorder)]</code> at the top in order to trigger it for the documentation.</p>\n<p>Also, the error should have come with some instructions on how to run the tests, did that not show up?</p>\n<div class=\"codehilite\"><pre><span></span><code>This error was generated by the lint-docs tool.\nThis tool extracts documentation for lints from the source code and places\nthem in the rustc book. See the declare_lint! documentation\nhttps://doc.rust-lang.org/nightly/nightly-rustc/rustc_lint_defs/macro.declare_lint.html\nfor an example of the format of documentation this tool expects.\n\nTo re-run these tests, run: ./x.py test --keep-stage=0 src/tools/lint-docs\nThe --keep-stage flag should be used if you have already built the compiler\nand are only modifying the doc comments to avoid rebuilding the compiler.\n</code></pre></div>\n<p>I think re-running the test should take less than a minute.</p>\n<p>You should be able to use <code>#![allow(unused)]</code> at the top.  I recommend prefixing it with a # to hide it, like this: <a href=\"https://github.com/rust-lang/rust/blob/44e3daf5eee8263dfc3a2509e78ddd1f6f783a0e/compiler/rustc_lint/src/builtin.rs#L2311\">https://github.com/rust-lang/rust/blob/44e3daf5eee8263dfc3a2509e78ddd1f6f783a0e/compiler/rustc_lint/src/builtin.rs#L2311</a></p>",
        "id": 221323723,
        "sender_full_name": "Eric Huss",
        "timestamp": 1609456317
    },
    {
        "content": "<p>Thanks <span aria-label=\"smile\" class=\"emoji emoji-1f642\" role=\"img\" title=\"smile\">:smile:</span></p>",
        "id": 221323775,
        "sender_full_name": "Aman Arora",
        "timestamp": 1609456369
    },
    {
        "content": "<p>This worked like a charm, thank you:)</p>",
        "id": 221353590,
        "sender_full_name": "Aman Arora",
        "timestamp": 1609510796
    },
    {
        "content": "<p>Not sure if this is expected but  <code>./x.py test --keep-stage=0 src/tools/lint-docs</code> didn't fail because an error was being emitted because of the lint, which does happen when the ustdoc test runs.</p>\n<p>Eg: <a href=\"https://github.com/rust-lang/rust/pull/80629#issuecomment-753529406\">https://github.com/rust-lang/rust/pull/80629#issuecomment-753529406</a></p>",
        "id": 221429485,
        "sender_full_name": "Aman Arora",
        "timestamp": 1609641229
    }
]