[
    {
        "content": "<p>I'm trying to call <code>is_copy_modulo_regions</code> in a compiler driver</p>\n<div class=\"codehilite\"><pre><span></span><code>let span = self.mir.source_info(location).span;\nlet param_env = self.tcx.param_env(self.def_id);\nlet is_copy = ty.is_copy_modulo_regions(self.tcx.at(span), param_env);\n</code></pre></div>\n<p>but I get a panic</p>\n<div class=\"codehilite\"><pre><span></span><code>thread &#39;rustc&#39; panicked at &#39;index out of bounds: the len is 0 but the index is 8&#39;, /cargo/registry/src/github.com-1ecc6299db9ec823/ena-0.14.0/src/snapshot_vec.rs:199:10\nstack backtrace:\n   0: rust_begin_unwind\n             at /rustc/ad442399756573dccacb314b6bf8079964bcc72a/library/std/src/panicking.rs:498:5\n   1: core::panicking::panic_fmt\n             at /rustc/ad442399756573dccacb314b6bf8079964bcc72a/library/core/src/panicking.rs:106:14\n   2: core::panicking::panic_bounds_check\n             at /rustc/ad442399756573dccacb314b6bf8079964bcc72a/library/core/src/panicking.rs:74:5\n   3: &lt;ena::unify::UnificationTable&lt;ena::unify::backing_vec::InPlace&lt;rustc_middle::infer::unify_key::RegionVidKey, &amp;mut alloc::vec::Vec&lt;ena::unify::VarValue&lt;rustc_middle::infer::unify_key::RegionVidKey&gt;&gt;, &amp;mut rustc_infer::infer::undo_log::InferCtxtUndoLogs&gt;&gt;&gt;::uninlined_get_root_key\n   4: &lt;&amp;rustc_middle::ty::TyS as rustc_middle::ty::fold::TypeFoldable&gt;::super_fold_with::&lt;rustc_infer::infer::canonical::canonicalizer::Canonicalizer&gt;\n   5: &lt;rustc_middle::ty::Predicate as rustc_middle::ty::fold::TypeFoldable&gt;::super_fold_with::&lt;rustc_infer::infer::canonical::canonicalizer::Canonicalizer&gt;\n   6: &lt;rustc_infer::infer::InferCtxt as rustc_trait_selection::traits::query::evaluate_obligation::InferCtxtExt&gt;::predicate_must_hold_modulo_regions\n   7: rustc_trait_selection::traits::type_known_to_meet_bound_modulo_regions\n   8: &lt;rustc_infer::infer::InferCtxtBuilder&gt;::enter::&lt;bool, rustc_ty_utils::common_traits::is_item_raw::{closure#0}&gt;\n   9: rustc_ty_utils::common_traits::is_copy_raw\n  10: rustc_query_system::query::plumbing::try_execute_query::&lt;rustc_query_impl::plumbing::QueryCtxt, rustc_query_system::query::caches::DefaultCache&lt;rustc_middle::ty::ParamEnvAnd&lt;&amp;rustc_middle::ty::TyS&gt;, bool&gt;&gt;\n  11: &lt;rustc_query_impl::Queries as rustc_middle::ty::query::QueryEngine&gt;::is_copy_raw\n  12: &lt;rustc_middle::ty::TyS&gt;::is_copy_modulo_regions\n</code></pre></div>\n<p>Do you know what might be the reason? Am I calling that method incorrectly?</p>",
        "id": 262049586,
        "sender_full_name": "Federico Poli",
        "timestamp": 1637317683
    },
    {
        "content": "<p>I'm puzzled by the <code>span</code> argument. Why is it required? To see which trait <code>impl</code> are in scope?</p>",
        "id": 262049665,
        "sender_full_name": "Federico Poli",
        "timestamp": 1637317761
    }
]