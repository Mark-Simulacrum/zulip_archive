[
    {
        "content": "<p>I’ve been thinking about getting into some rustc development, and <a href=\"https://github.com/rust-lang/rust/issues/89856\">https://github.com/rust-lang/rust/issues/89856</a> looks like a not terribly complicated issue to solve.</p>\n<p>Just making sure: is <a href=\"https://rustc-dev-guide.rust-lang.org/diagnostics/sessiondiagnostic.html#optional-diagnostic-attributes\">https://rustc-dev-guide.rust-lang.org/diagnostics/sessiondiagnostic.html#optional-diagnostic-attributes</a> the right documentation to be looking at?</p>",
        "id": 257847625,
        "sender_full_name": "Winter",
        "timestamp": 1634405622
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"119031\">@Esteban Küber</span>: Hi, I have a question: where exactly is the error talked about in the issue (E0308) emitted? Is it not in <code>typeck</code>? I ask since I'm trying to find the <code>#[error = \"E0308\"]</code> attribute, but can't. Or am I going about this the wrong way? Thanks!</p>",
        "id": 257858853,
        "sender_full_name": "Winter",
        "timestamp": 1634415979
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"450762\">@Winter</span> it is in typeck, but you won't find it with that attribute, because it doesn't use it yet. You can use -Ztreat-err-as-bug to find where it is. I'll try to remember to follow up with you once I'm in my computer to give you the exact link.</p>",
        "id": 257903843,
        "sender_full_name": "Esteban Küber",
        "timestamp": 1634462542
    },
    {
        "content": "<p>Ah, got it, will give that a try. Thanks :)</p>",
        "id": 257918697,
        "sender_full_name": "Winter",
        "timestamp": 1634476985
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"119031\">@Esteban Küber</span> So it seems that I should add this in <code>typeck::check::expr::FnCtxt::check_expr_with_expectation_and_args</code>, but I'm admittedly a bit lost on how to actually:</p>\n<ul>\n<li>check if <code>ty</code> and <code>expected</code> are <code>Option</code>s</li>\n<li>how to check if the expected <code>Deref</code> impl exists to be able to emit this suggestion</li>\n</ul>\n<p>Do you have any pointers on where to look for similar code or the module that those kind of things would exist in, or something like that? Thanks!</p>",
        "id": 257966110,
        "sender_full_name": "Winter",
        "timestamp": 1634522230
    },
    {
        "content": "<p>For the first part, you can look at the <code>ty.kind()</code> of both to see if it is an <code>Adt</code>, from which you can take the <code>DefId</code> to check if they are <code>Option</code> types (you might also want to \"peel\" out the references in case you have something like <code>&amp;Option&lt;T&gt;</code>.</p>",
        "id": 258003763,
        "sender_full_name": "Esteban Küber",
        "timestamp": 1634551149
    },
    {
        "content": "<p>for the second it's a bit trickier, but there's code doing that already</p>",
        "id": 258003780,
        "sender_full_name": "Esteban Küber",
        "timestamp": 1634551163
    },
    {
        "content": "<blockquote>\n<p>there’s code doing that already</p>\n</blockquote>\n<p>in that method you mean?</p>",
        "id": 258008731,
        "sender_full_name": "Winter",
        "timestamp": 1634553791
    },
    {
        "content": "<p>My apologies for all of the questions <span class=\"user-mention\" data-user-id=\"119031\">@Esteban Küber</span>, but I can't figure out how I'd create the <code>DefId</code> for <code>Option&lt;T&gt;</code> to compare against, and I've been looking in various crates to find where something similar is done, but I can't. :/</p>",
        "id": 258105187,
        "sender_full_name": "Winter",
        "timestamp": 1634593295
    }
]