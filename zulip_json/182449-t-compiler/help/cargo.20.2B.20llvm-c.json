[
    {
        "content": "<p>Heya. Kind of fringe, but I have a target I want to run Rust on (Blackfin) which LLVM cannot target, however I can use <code>rustc</code> to emit LLVM bitcode or IR and use llvm-c to generate C code and use GCC to build that code for my target. Would there be a good way to use this workflow with cargo? Effectively, I would want cargo to invoke llvm-c on the LLVM bitcode to create the C files, compile it with the GCC I specify, and then it can continue on with the object files as it normally would (or just give them to me so I can link them)</p>",
        "id": 273376589,
        "sender_full_name": "Brandon Falk",
        "timestamp": 1645928925
    },
    {
        "content": "<p>I do have it working if I manually invoke rustc, but that's a bit \"annoying\" when I have multiple codegen units and object files, especially with building something like libcore</p>",
        "id": 273376597,
        "sender_full_name": "Brandon Falk",
        "timestamp": 1645928955
    },
    {
        "content": "<p>Wow! Got it!</p>\n<div class=\"codehilite\"><pre><span></span><code>pleb@gamey ~/foopietest $ make\nRUSTFLAGS=&quot;--emit=llvm-ir&quot; cargo build --target riscv32i-unknown-none-elf -Zbuild-std=core --release\n   Compiling core v0.0.0 (/home/pleb/.rustup/toolchains/nightly-x86_64-unknown-linux-gnu/lib/rustlib/src/rust/library/core)\n   Compiling compiler_builtins v0.1.70\n   Compiling rustc-std-workspace-core v1.99.0 (/home/pleb/.rustup/toolchains/nightly-x86_64-unknown-linux-gnu/lib/rustlib/src/rust/library/rustc-std-workspace-core)\n   Compiling foopietest v0.1.0 (/home/pleb/foopietest)\n    Finished release [optimized] target(s) in 12.00s\nllvm-link target/riscv32i-unknown-none-elf/release/deps/*.ll -o=whole_image.bc\nllvm-extract whole_image.bc --func=_start --recursive -o=dced.bc\n~/llvm-cbe/build/tools/llvm-cbe/llvm-cbe dced.bc\n</code></pre></div>\n<div class=\"codehilite\" data-code-language=\"Rust\"><pre><span></span><code><span class=\"cp\">#![no_std]</span><span class=\"w\"></span>\n<span class=\"cp\">#![no_main]</span><span class=\"w\"></span>\n\n<span class=\"cp\">#[panic_handler]</span><span class=\"w\"></span>\n<span class=\"k\">fn</span> <span class=\"nf\">panic</span><span class=\"p\">(</span><span class=\"n\">_</span>: <span class=\"kp\">&amp;</span><span class=\"nc\">core</span>::<span class=\"n\">panic</span>::<span class=\"n\">PanicInfo</span><span class=\"p\">)</span><span class=\"w\"> </span>-&gt; <span class=\"o\">!</span><span class=\"w\"> </span><span class=\"p\">{</span><span class=\"w\"></span>\n<span class=\"w\">    </span><span class=\"k\">loop</span><span class=\"w\"> </span><span class=\"p\">{}</span><span class=\"w\"></span>\n<span class=\"p\">}</span><span class=\"w\"></span>\n\n<span class=\"cp\">#[no_mangle]</span><span class=\"w\"></span>\n<span class=\"k\">fn</span> <span class=\"nf\">_start</span><span class=\"p\">()</span><span class=\"w\"> </span><span class=\"p\">{</span><span class=\"w\"></span>\n<span class=\"w\">    </span><span class=\"k\">unsafe</span><span class=\"w\"> </span><span class=\"p\">{</span><span class=\"w\"></span>\n<span class=\"w\">        </span><span class=\"n\">core</span>::<span class=\"n\">ptr</span>::<span class=\"n\">write_volatile</span><span class=\"p\">(</span><span class=\"mh\">0x1337</span><span class=\"w\"> </span><span class=\"k\">as</span><span class=\"w\"> </span><span class=\"o\">*</span><span class=\"k\">mut</span><span class=\"w\"> </span><span class=\"kt\">u8</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"mh\">0x69</span><span class=\"p\">);</span><span class=\"w\"></span>\n<span class=\"w\">    </span><span class=\"p\">}</span><span class=\"w\"></span>\n<span class=\"p\">}</span><span class=\"w\"></span>\n</code></pre></div>\n<div class=\"codehilite\" data-code-language=\"C\"><pre><span></span><code><span class=\"cm\">/* Provide Declarations */</span><span class=\"w\"></span>\n<span class=\"cp\">#include</span><span class=\"w\"> </span><span class=\"cpf\">&lt;stdint.h&gt;</span><span class=\"cp\"></span>\n<span class=\"cp\">#ifndef __cplusplus</span>\n<span class=\"k\">typedef</span><span class=\"w\"> </span><span class=\"kt\">unsigned</span><span class=\"w\"> </span><span class=\"kt\">char</span><span class=\"w\"> </span><span class=\"kt\">bool</span><span class=\"p\">;</span><span class=\"w\"></span>\n<span class=\"cp\">#endif</span>\n\n<span class=\"cp\">#if defined(__GNUC__)</span>\n<span class=\"cp\">#define  __ATTRIBUTELIST__(x) __attribute__(x)</span>\n<span class=\"cp\">#else</span>\n<span class=\"cp\">#define  __ATTRIBUTELIST__(x)</span>\n<span class=\"cp\">#endif</span>\n\n<span class=\"cp\">#ifdef _MSC_VER  </span><span class=\"cm\">/* Can only support \"linkonce\" vars with GCC */</span><span class=\"cp\"></span>\n<span class=\"cp\">#define __attribute__(X)</span>\n<span class=\"cp\">#endif</span>\n\n\n\n<span class=\"cm\">/* Global Declarations */</span><span class=\"w\"></span>\n\n<span class=\"cm\">/* Types Declarations */</span><span class=\"w\"></span>\n\n<span class=\"cm\">/* Function definitions */</span><span class=\"w\"></span>\n<span class=\"k\">typedef</span><span class=\"w\"> </span><span class=\"kt\">void</span><span class=\"w\"> </span><span class=\"nf\">l_fptr_1</span><span class=\"p\">(</span><span class=\"kt\">void</span><span class=\"p\">);</span><span class=\"w\"></span>\n\n\n<span class=\"cm\">/* Types Definitions */</span><span class=\"w\"></span>\n\n<span class=\"cm\">/* Function Declarations */</span><span class=\"w\"></span>\n<span class=\"kt\">void</span><span class=\"w\"> </span><span class=\"nf\">_start</span><span class=\"p\">(</span><span class=\"kt\">void</span><span class=\"p\">)</span><span class=\"w\"> </span><span class=\"n\">__ATTRIBUTELIST__</span><span class=\"p\">((</span><span class=\"n\">nothrow</span><span class=\"p\">));</span><span class=\"w\"></span>\n\n\n<span class=\"cm\">/* LLVM Intrinsic Builtin Function Bodies */</span><span class=\"w\"></span>\n\n\n<span class=\"cm\">/* Function Bodies */</span><span class=\"w\"></span>\n\n<span class=\"kt\">void</span><span class=\"w\"> </span><span class=\"nf\">_start</span><span class=\"p\">(</span><span class=\"kt\">void</span><span class=\"p\">)</span><span class=\"w\"> </span><span class=\"p\">{</span><span class=\"w\"></span>\n<span class=\"w\">  </span><span class=\"o\">*</span><span class=\"p\">(</span><span class=\"k\">volatile</span><span class=\"w\"> </span><span class=\"kt\">uint8_t</span><span class=\"o\">*</span><span class=\"p\">)((</span><span class=\"kt\">uint8_t</span><span class=\"o\">*</span><span class=\"p\">)(</span><span class=\"kt\">uintptr_t</span><span class=\"p\">)</span><span class=\"mi\">4919</span><span class=\"p\">)</span><span class=\"w\"> </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"mi\">105u</span><span class=\"p\">;</span><span class=\"w\"></span>\n<span class=\"p\">}</span><span class=\"w\"></span>\n</code></pre></div>\n<div class=\"codehilite\"><pre><span></span><code>\n</code></pre></div>",
        "id": 273378440,
        "sender_full_name": "Brandon Falk",
        "timestamp": 1645931728
    },
    {
        "content": "<p>maybe mrustc could also work for your case. <a href=\"https://github.com/thepowersgang/mrustc\">https://github.com/thepowersgang/mrustc</a></p>",
        "id": 273378876,
        "sender_full_name": "The 8472",
        "timestamp": 1645932387
    },
    {
        "content": "<p>I don't have an answer for you (I suspect there's no clean way to do this), but I'm interested in llvm-c, are you doing this with <a href=\"https://github.com/JuliaComputingOSS/llvm-cbe\">https://github.com/JuliaComputingOSS/llvm-cbe</a> ? I hadn't realized that had gotten to the point where it was broadly usable, neat</p>",
        "id": 273378885,
        "sender_full_name": "Thom Chiovoloni",
        "timestamp": 1645932420
    },
    {
        "content": "<p>Also yeah, mrustc targets C, although it is of course less flexible than rustc in several ways.</p>",
        "id": 273378894,
        "sender_full_name": "Thom Chiovoloni",
        "timestamp": 1645932447
    },
    {
        "content": "<p>Wild! Safe language on a \"weird\" architecture</p>\n<div class=\"codehilite\" data-code-language=\"Rust\"><pre><span></span><code><span class=\"cp\">#![no_std]</span><span class=\"w\"></span>\n<span class=\"cp\">#![no_main]</span><span class=\"w\"></span>\n\n<span class=\"cp\">#[panic_handler]</span><span class=\"w\"></span>\n<span class=\"k\">fn</span> <span class=\"nf\">panic</span><span class=\"p\">(</span><span class=\"n\">_</span>: <span class=\"kp\">&amp;</span><span class=\"nc\">core</span>::<span class=\"n\">panic</span>::<span class=\"n\">PanicInfo</span><span class=\"p\">)</span><span class=\"w\"> </span>-&gt; <span class=\"o\">!</span><span class=\"w\"> </span><span class=\"p\">{</span><span class=\"w\"></span>\n<span class=\"w\">    </span><span class=\"k\">loop</span><span class=\"w\"> </span><span class=\"p\">{}</span><span class=\"w\"></span>\n<span class=\"p\">}</span><span class=\"w\"></span>\n\n<span class=\"cp\">#[no_mangle]</span><span class=\"w\"></span>\n<span class=\"k\">fn</span> <span class=\"nf\">_start</span><span class=\"p\">(</span><span class=\"n\">idx</span>: <span class=\"kt\">usize</span><span class=\"p\">)</span><span class=\"w\"> </span>-&gt; <span class=\"kt\">i32</span> <span class=\"p\">{</span><span class=\"w\"></span>\n<span class=\"w\">    </span><span class=\"kd\">let</span><span class=\"w\"> </span><span class=\"n\">test_arr</span><span class=\"w\"> </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"p\">[</span><span class=\"mi\">1</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"mi\">2</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"mi\">3</span><span class=\"p\">];</span><span class=\"w\"></span>\n<span class=\"w\">    </span><span class=\"n\">test_arr</span><span class=\"p\">[</span><span class=\"n\">idx</span><span class=\"p\">]</span><span class=\"w\"></span>\n<span class=\"p\">}</span><span class=\"w\"></span>\n</code></pre></div>\n<div class=\"codehilite\"><pre><span></span><code>00000004 &lt;__start&gt;:\n   4:   10 32           P2 = R0;\n   6:   49 e1 00 00     P1.H = 0x0;             /* (  0)        P1=0x0 &lt;_rust_begin_unwind&gt; */\n   a:   67 01           [--SP] = RETS;\n   c:   09 e1 00 00     P1.L = 0x0;             /* (  0)        P1=0x0 &lt;_rust_begin_unwind&gt; */\n  10:   26 6f           SP += -0x1c;            /* (-28) */\n  12:   08 91           R0 = [P1];\n  14:   b0 b1           [SP + 0x18] = R0;\n  16:   08 60           R0 = 0x1 (X);           /*              R0=0x1(  1) */\n  18:   f0 b0           [SP + 0xc] = R0;\n  1a:   10 60           R0 = 0x2 (X);           /*              R0=0x2(  2) */\n  1c:   30 b1           [SP + 0x10] = R0;\n  1e:   52 0e           CC = P2 &lt;= 0x2 (IU);\n  20:   18 60           R0 = 0x3 (X);           /*              R0=0x3(  3) */\n  22:   70 b1           [SP + 0x14] = R0;\n  24:   0c 10           IF !CC JUMP 0x3c &lt;__start+0x38&gt;;\n  26:   e0 68           P0 = 0x1c (X);          /*              P0=0x1c( 28) */\n  28:   b2 a1           R2 = [SP + 0x18];\n  2a:   30 5a           P0 = P0 + SP;\n  2c:   09 91           R1 = [P1];\n  2e:   90 5e           P2 = P0 + (P2 &lt;&lt; 0x2);\n  30:   0a 08           CC = R2 == R1;\n  32:   10 e4 fc ff     R0 = [P2 + -0x10];\n  36:   0b 1c           IF CC JUMP 0x4c &lt;__start+0x48&gt; (BP);\n  38:   ff e3 e4 ff     CALL 0x0 &lt;_rust_begin_unwind&gt;;\n  3c:   42 e1 00 00     R2.H = 0x0;             /* (  0)        R2=0x0 &lt;_rust_begin_unwind&gt;(  0) */\n  40:   02 e1 00 00     R2.L = 0x0;             /* (  0)        R2=0x0 &lt;_rust_begin_unwind&gt;(  0) */\n  44:   19 60           R1 = 0x3 (X);           /*              R1=0x3(  3) */\n  46:   42 30           R0 = P2;\n  48:   ff e3 e0 ff     CALL 0x8 &lt;__start+0x4&gt;;\n  4c:   e6 6c           SP += 0x1c;             /* ( 28) */\n  4e:   27 01           RETS = [SP++];\n  50:   10 00           RTS;\n        ...\n\nDisassembly of section .text.unlikely:\n\n00000000 &lt;__ZN4core9panicking9panic_fmt17h364a8c8c4589d4d7E.constprop.0&gt;:\n   0:   00 20           JUMP.S 0x0 &lt;__ZN4core9panicking9panic_fmt17h364a8c8c4589d4d7E.constprop.0&gt;;\n        ...\n\n00000004 &lt;__ZN4core9panicking9panic_fmt17h364a8c8c4589d4d7E&gt;:\n   4:   00 20           JUMP.S 0x4 &lt;__ZN4core9panicking9panic_fmt17h364a8c8c4589d4d7E&gt;;\n        ...\n\n00000008 &lt;__ZN4core9panicking18panic_bounds_check17ha97f2ab1edbcca49E&gt;:\n   8:   67 01           [--SP] = RETS;\n   a:   a6 6f           SP += -0xc;             /* (-12) */\n   c:   ff e3 fa ff     CALL 0x0 &lt;__ZN4core9panicking9panic_fmt17h364a8c8c4589d4d7E.constprop.0&gt;;\n</code></pre></div>",
        "id": 273379296,
        "sender_full_name": "Brandon Falk",
        "timestamp": 1645932871
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"209168\">Thom Chiovoloni</span> <a href=\"#narrow/stream/182449-t-compiler.2Fhelp/topic/cargo.20.2B.20llvm-c/near/273378885\">said</a>:</p>\n<blockquote>\n<p>I don't have an answer for you (I suspect there's no clean way to do this), but I'm interested in llvm-c, are you doing this with <a href=\"https://github.com/JuliaComputingOSS/llvm-cbe\">https://github.com/JuliaComputingOSS/llvm-cbe</a> ? I hadn't realized that had gotten to the point where it was broadly usable, neat</p>\n</blockquote>\n<p>Yep, exactly! It fails on _many_ intrinsics, so the only reason this is really working is because of <code>llvm-extract</code> which removes anything that isn't used. I would suspect there would be early failure if you were to just dev normally, but if you're okay with dodging certain code shapes that result in certain intrinsics being emit you might be fine</p>",
        "id": 273379323,
        "sender_full_name": "Brandon Falk",
        "timestamp": 1645932938
    },
    {
        "content": "<p>I don't think that <code>llvm-extract</code> works exactly as I expect here, but I could write something pretty fast to manually DCE the LLVM IR. <code>llvm-link</code> will produce one massive IR blob of the Rust code, and up to that point it should be universally supportive of anything done in Rust. The main part is pruning that down such that it doesn't use any unimplemented opcodes/intrinsics when it's passed to llvm-cbe</p>",
        "id": 273379430,
        "sender_full_name": "Brandon Falk",
        "timestamp": 1645933087
    },
    {
        "content": "<p>By default, the resulting IL after <code>llvm-link</code> is pretty massive (contains all of core and compiler-builtins). I'm sure there's a good tool to remove anything that isn't used (perhaps it's a problem with functions being marked <code>no_mangle</code> and thus they don't get removed from the IL). Ultimately, for basic operations I think this should work fine. As long as you just use Rust as effectively... C with bounds checking :P</p>",
        "id": 273379444,
        "sender_full_name": "Brandon Falk",
        "timestamp": 1645933149
    },
    {
        "content": "<p>I'm not familiar with LLVM IR, but if I try to <code>llvm-cbe</code> the whole blob, I get <code>LLVM ERROR: Code generator does not support intrinsic function 'llvm.abs.i32'</code>. This is technically never actually used if I were to DCE the entire IL, so I'm hoping there's some tool/thing I can do to rip this out (even if it's a regex to remove a \"do not remove\" flag or something on the IL)</p>",
        "id": 273379526,
        "sender_full_name": "Brandon Falk",
        "timestamp": 1645933279
    },
    {
        "content": "<p>I'm not sure if there's a way to do <code>-Zbuild-std=core</code> _without_ having it pull in compiler builtins anymore, but that seems to be the main issue here</p>",
        "id": 273379580,
        "sender_full_name": "Brandon Falk",
        "timestamp": 1645933349
    },
    {
        "content": "<div class=\"codehilite\"><pre><span></span><code>; Function Attrs: minsize nofree nosync nounwind optsize readnone\ndefine hidden double @__powidf2(double %a, i32 %b) unnamed_addr #4 {\nstart:\n  %0 = tail call double @_ZN17compiler_builtins5float3pow9__powidf217h9848cde383b918e7E(double %a, i32 %b) #33\n  ret double %0\n}\n</code></pre></div>\n<p>This is the top-level function which results in <code>abs</code> being pulled in, and this function isn't used, nor is it referenced in a global anywhere. I'm not quite sure at what stage LLVM would be okay with removing a function like this</p>",
        "id": 273379593,
        "sender_full_name": "Brandon Falk",
        "timestamp": 1645933408
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"356799\">@Brandon Falk</span> If LLVM can't target your architecture but GCC can, I think it'd be easier to port <code>rustc_codegen_gcc</code> to your architecture.</p>",
        "id": 273380124,
        "sender_full_name": "Josh Triplett",
        "timestamp": 1645934221
    },
    {
        "content": "<p>Ah, I was offput by it being a WIP, didn't know if it would be able to generate code yet, wasn't sure of its stage of dev</p>",
        "id": 273380184,
        "sender_full_name": "Brandon Falk",
        "timestamp": 1645934309
    },
    {
        "content": "<p>It generates code, and passes almost all of the testsuite.</p>",
        "id": 273380445,
        "sender_full_name": "Josh Triplett",
        "timestamp": 1645934483
    },
    {
        "content": "<p>I wouldn't call it production-ready, but I think it's likely to produce usable results more easily than trying to go by way of an LLVM C backend (which would <em>still</em> require porting Rust to understand your architecture's nuances).</p>",
        "id": 273380460,
        "sender_full_name": "Josh Triplett",
        "timestamp": 1645934515
    },
    {
        "content": "<p>Oh awesome. How much needs to be ported to a new architecture, given I can already build a gcc toolchain and such for my target?</p>",
        "id": 273380461,
        "sender_full_name": "Brandon Falk",
        "timestamp": 1645934519
    },
    {
        "content": "<p>Can you build libgccjit for your target?</p>",
        "id": 273380499,
        "sender_full_name": "Josh Triplett",
        "timestamp": 1645934531
    },
    {
        "content": "<p>Yeah, for sure. In this case it's just for a small hobby project</p>",
        "id": 273380502,
        "sender_full_name": "Brandon Falk",
        "timestamp": 1645934534
    },
    {
        "content": "<p>Not sure, trying now</p>",
        "id": 273380505,
        "sender_full_name": "Brandon Falk",
        "timestamp": 1645934540
    },
    {
        "content": "<p>cc <span class=\"user-mention\" data-user-id=\"404242\">@antoyo</span></p>",
        "id": 273380509,
        "sender_full_name": "Josh Triplett",
        "timestamp": 1645934551
    },
    {
        "content": "<p>I tried to backpotr old LLVM blackfin codegen to modern LLVM and it was a mess :P I got LLVM to build, but it was definitely not \"working\"</p>",
        "id": 273380523,
        "sender_full_name": "Brandon Falk",
        "timestamp": 1645934580
    },
    {
        "content": "<p>What is the <code>jit</code> option for GCC? Is that emitting some form of IL from GCC which this consumes? I've never seen that option for <code>--enable-languages</code></p>",
        "id": 273380570,
        "sender_full_name": "Brandon Falk",
        "timestamp": 1645934630
    },
    {
        "content": "<p>Despite the name <code>libgccjit</code>, it's not JIT-specific; it's just the GCC code generation facilities pulled out into a library.</p>",
        "id": 273380577,
        "sender_full_name": "Josh Triplett",
        "timestamp": 1645934638
    },
    {
        "content": "<p>It's not a language, it's a separate library.</p>",
        "id": 273380632,
        "sender_full_name": "Josh Triplett",
        "timestamp": 1645934689
    },
    {
        "content": "<p>Ahhh, I see</p>",
        "id": 273380634,
        "sender_full_name": "Brandon Falk",
        "timestamp": 1645934699
    },
    {
        "content": "<p>You'll need to build your toolchain with <code>--enable-host-shared</code> if you haven't already.</p>",
        "id": 273380646,
        "sender_full_name": "Josh Triplett",
        "timestamp": 1645934747
    },
    {
        "content": "<p>No problem building with <code>--enable-host-shared</code> and <code>--enable-languages=c,jit</code>. Haven't tried the patches yet</p>",
        "id": 273381246,
        "sender_full_name": "Brandon Falk",
        "timestamp": 1645935726
    },
    {
        "content": "<p>Seems to build fine with the patches, getting an error with <code>error occurred: Failed to find tool. Is </code>mips-linux-gnu-gcc<code> installed?</code> but I think it's due to some hackiness around using the MIPS target spec, so I'm installing that toolchain now</p>",
        "id": 273383285,
        "sender_full_name": "Brandon Falk",
        "timestamp": 1645938509
    },
    {
        "content": "<p>I thought you were using blackfin, not MIPS?</p>",
        "id": 273383357,
        "sender_full_name": "Josh Triplett",
        "timestamp": 1645938669
    },
    {
        "content": "<p>just following <a href=\"https://github.com/rust-lang/rustc_codegen_gcc#configuring-rustc_codegen_gcc\">https://github.com/rust-lang/rustc_codegen_gcc#configuring-rustc_codegen_gcc</a></p>",
        "id": 273383415,
        "sender_full_name": "Brandon Falk",
        "timestamp": 1645938750
    },
    {
        "content": "<p>my target is still bfin for the linker, the m68k example also sets it as mips in <a href=\"http://config.sh\">config.sh</a></p>",
        "id": 273383428,
        "sender_full_name": "Brandon Falk",
        "timestamp": 1645938791
    },
    {
        "content": "<p>Yeah, you might prefer a <a href=\"https://book.avr-rust.com/005.1-the-target-specification-json-file.html\">target spec JSON file</a>.<br>\nAlso, those instructions might be a bit outdated, but the general idea is there.<br>\nFeel free to ask any question.</p>",
        "id": 273383684,
        "sender_full_name": "antoyo",
        "timestamp": 1645939197
    },
    {
        "content": "<p>How would I go about building only core in this case, the target I have is technically <code>bfin-elf</code> where it's not actually Linux</p>",
        "id": 273383801,
        "sender_full_name": "Brandon Falk",
        "timestamp": 1645939330
    },
    {
        "content": "<p><code>libgccjit.so: error: gcc_jit_context_new_call: mismatching types for argument 1 of function \"__builtin_usub_overflow\": assignment to param arg0 (type: unsigned int) from (unsigned long long)39 (type: unsigned long long)</code></p>",
        "id": 273383869,
        "sender_full_name": "Brandon Falk",
        "timestamp": 1645939459
    },
    {
        "content": "<p>Seems to be the first error I'm hitting now that I'm starting to build the sysroot (past the mips error). Technically I haven't built a libc for the target in this case (just gcc) but I don't think that would cause this yet</p>",
        "id": 273383973,
        "sender_full_name": "Brandon Falk",
        "timestamp": 1645939667
    },
    {
        "content": "<p>feels like a host vs target confusion</p>",
        "id": 273384800,
        "sender_full_name": "Brandon Falk",
        "timestamp": 1645940927
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"356799\">Brandon Falk</span> <a href=\"#narrow/stream/182449-t-compiler.2Fhelp/topic/cargo.20.2B.20llvm-c/near/273384800\">said</a>:</p>\n<blockquote>\n<p>feels like a host vs target confusion</p>\n</blockquote>\n<p>Indeed. Can you please open an issue about this?</p>",
        "id": 273418972,
        "sender_full_name": "antoyo",
        "timestamp": 1645987763
    },
    {
        "content": "<p>Done <a href=\"https://github.com/rust-lang/rustc_codegen_gcc/issues/134\">https://github.com/rust-lang/rustc_codegen_gcc/issues/134</a></p>",
        "id": 273428177,
        "sender_full_name": "Brandon Falk",
        "timestamp": 1645999975
    },
    {
        "content": "<p>Building a toolchain for <code>m68k-unknown-linux-gnu</code> now so I can make sure it's not a weird issue in my environment. It sounds like this target should work?</p>",
        "id": 273428194,
        "sender_full_name": "Brandon Falk",
        "timestamp": 1646000025
    },
    {
        "content": "<p>How important is a linux target with linux headers + glibc for this setup? Ideally I want to target embedded systems with just libcore + alloc</p>",
        "id": 273428321,
        "sender_full_name": "Brandon Falk",
        "timestamp": 1646000193
    },
    {
        "content": "<p>It appears I have the same issue with m68k, so it must be some environment issue</p>",
        "id": 273428539,
        "sender_full_name": "Brandon Falk",
        "timestamp": 1646000574
    },
    {
        "content": "<p>I'm building a very partial toolchain, only binutils <code>make &amp;&amp; make install</code> and then GCC with <code>make -j40 all-gcc &amp;&amp; make install-gcc</code>. Not sure if the lack of Linux headers, libc, etc would be the cause of this? I should have a complete m68k, I don't think that would lead to this problem</p>",
        "id": 273429328,
        "sender_full_name": "Brandon Falk",
        "timestamp": 1646001718
    }
]