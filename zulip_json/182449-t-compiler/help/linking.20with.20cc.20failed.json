[
    {
        "content": "<p>Okay, any idea why I might be getting this error when building rustc? <a href=\"https://gist.github.com/jackh726/63cc23aeaf66785f73f1cada39a0d2bc\">https://gist.github.com/jackh726/63cc23aeaf66785f73f1cada39a0d2bc</a></p>\n<p>This doesn't happen every build. But it does happen fairly frequently. Doing <code>./x.py clean</code> fixes it (but of course I have to rebuild everything)</p>",
        "id": 267328433,
        "sender_full_name": "Jack Huey",
        "timestamp": 1641692880
    },
    {
        "content": "<p>If it matters, I'm using WSL2</p>",
        "id": 267328478,
        "sender_full_name": "Jack Huey",
        "timestamp": 1641692901
    },
    {
        "content": "<p>Could this be <a href=\"https://github.com/rust-lang/rust/issues/43587\">#43587</a></p>",
        "id": 267328803,
        "sender_full_name": "Jack Huey",
        "timestamp": 1641693223
    },
    {
        "content": "<p>Adding a data point: I've never encountered this, though I'm on macOS.</p>",
        "id": 267328906,
        "sender_full_name": "Noah Lev",
        "timestamp": 1641693350
    },
    {
        "content": "<p>It's honestly getting pretty annoying; I can usually tolerate it. I've literally had to clean and rebuild like 4 times tonight</p>",
        "id": 267329061,
        "sender_full_name": "Jack Huey",
        "timestamp": 1641693563
    },
    {
        "content": "<p>Hmm, sounds like something in rust-lang/rust or something in your system changed then</p>",
        "id": 267329187,
        "sender_full_name": "Noah Lev",
        "timestamp": 1641693640
    },
    {
        "content": "<p>I see some stuff in the error about relocations; maybe something changed with that?</p>",
        "id": 267329296,
        "sender_full_name": "Noah Lev",
        "timestamp": 1641693743
    },
    {
        "content": "<p>Ah, I wonder if it could be <a href=\"https://github.com/rust-lang/rust/issues/92153\">#92153</a> (because your error also mentions <code>extern</code> blocks)?</p>",
        "id": 267329304,
        "sender_full_name": "Noah Lev",
        "timestamp": 1641693764
    },
    {
        "content": "<p>I mean, this has been happening for a while now - months.</p>",
        "id": 267329331,
        "sender_full_name": "Jack Huey",
        "timestamp": 1641693838
    },
    {
        "content": "<p>It's just particularly bad tonight, for whatever reason.</p>",
        "id": 267329370,
        "sender_full_name": "Jack Huey",
        "timestamp": 1641693849
    },
    {
        "content": "<p>Hmm, weird</p>",
        "id": 267329377,
        "sender_full_name": "Noah Lev",
        "timestamp": 1641693860
    },
    {
        "content": "<p>Yeah, I have no clue <span aria-label=\"upside down\" class=\"emoji emoji-1f643\" role=\"img\" title=\"upside down\">:upside_down:</span></p>",
        "id": 267329380,
        "sender_full_name": "Noah Lev",
        "timestamp": 1641693866
    },
    {
        "content": "<p>Thanks anyways <span aria-label=\"hearts\" class=\"emoji emoji-2665\" role=\"img\" title=\"hearts\">:hearts:</span></p>",
        "id": 267329433,
        "sender_full_name": "Jack Huey",
        "timestamp": 1641693952
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"232957\">@Jack Huey</span> Are you maybe using check-on-save or any sort of editor integration that might cause frequent interrupts of the build process?</p>\n<p>I've seen lots of issues opened for this problem, but I don't think anyone has found a specific cause.</p>",
        "id": 267330969,
        "sender_full_name": "Eric Huss",
        "timestamp": 1641696071
    },
    {
        "content": "<p>I'm using rust-analyzer, but I have check-on-save disabled</p>",
        "id": 267331411,
        "sender_full_name": "Jack Huey",
        "timestamp": 1641696667
    },
    {
        "content": "<p>I also get a maybe related error sometimes: <a href=\"https://gist.github.com/jackh726/f4531e1d387ecd7ce86467d18b9aa209\">https://gist.github.com/jackh726/f4531e1d387ecd7ce86467d18b9aa209</a></p>",
        "id": 267332809,
        "sender_full_name": "Jack Huey",
        "timestamp": 1641698743
    },
    {
        "content": "<p>This just stops the build process</p>",
        "id": 267332820,
        "sender_full_name": "Jack Huey",
        "timestamp": 1641698757
    },
    {
        "content": "<p>but doesn't require a clean to continue</p>",
        "id": 267332858,
        "sender_full_name": "Jack Huey",
        "timestamp": 1641698766
    },
    {
        "content": "<p>Would you look at that!</p>\n<div class=\"codehilite\"><pre><span></span><code>error: linking with `cc` failed: exit status: 1\n[...]\n          ld: symbol(s) not found for architecture arm64\n          clang: error: linker command failed with exit code 1 (use -v to see invocation)\nerror: could not compile `rustc_driver` due to previous error\nBuild completed unsuccessfully in 0:00:07\n</code></pre></div>",
        "id": 267481654,
        "sender_full_name": "Noah Lev",
        "timestamp": 1641840183
    },
    {
        "content": "<p>Maybe I spoke too soon before ;)</p>",
        "id": 267481943,
        "sender_full_name": "Noah Lev",
        "timestamp": 1641840316
    },
    {
        "content": "<p>I've gotten those repeatedly as well</p>",
        "id": 267485335,
        "sender_full_name": "Aaron Hill",
        "timestamp": 1641841824
    },
    {
        "content": "<p>It's some kind of incremental compilation problem</p>",
        "id": 267485353,
        "sender_full_name": "Aaron Hill",
        "timestamp": 1641841833
    },
    {
        "content": "<p>However, I've never managed to reproduce it by replaying my commit history</p>",
        "id": 267485381,
        "sender_full_name": "Aaron Hill",
        "timestamp": 1641841849
    },
    {
        "content": "<p>I suspect that there's some kind of non-dererminism in llvm</p>",
        "id": 267485403,
        "sender_full_name": "Aaron Hill",
        "timestamp": 1641841862
    },
    {
        "content": "<p>or we're not tracking some information properly when determining post-lto cgu reuse</p>",
        "id": 267485441,
        "sender_full_name": "Aaron Hill",
        "timestamp": 1641841886
    },
    {
        "content": "<p>Yeah, <code>x clean</code> fixes it (thankfully!)</p>",
        "id": 267486089,
        "sender_full_name": "Noah Lev",
        "timestamp": 1641842165
    },
    {
        "content": "<p>For a while, I've been hoping that this will just disappear as I make more fixes to the incr comp system</p>",
        "id": 267487420,
        "sender_full_name": "Aaron Hill",
        "timestamp": 1641842754
    },
    {
        "content": "<p>However, that's starting to seem increasingly unlikely</p>",
        "id": 267487479,
        "sender_full_name": "Aaron Hill",
        "timestamp": 1641842768
    },
    {
        "content": "<p>at least after my latest round of incr comp PRs is merged, we'll have a better idea of what's <em>not</em> causing this</p>",
        "id": 267487544,
        "sender_full_name": "Aaron Hill",
        "timestamp": 1641842796
    },
    {
        "content": "<p>FWIW, just ran into this again</p>",
        "id": 268476499,
        "sender_full_name": "Noah Lev",
        "timestamp": 1642552119
    }
]