[
    {
        "content": "<p>Hello, first cloned the rust repo to try and get a build working. Backtrace says the error is cmake::fail, so it might be the unresolved symbols? I'm on windows 10 with VS 2019 and the cmake tools installed.</p>\n<div class=\"codehilite\"><pre><span></span><code>stack backtrace:\n   0: backtrace::backtrace::trace_unsynchronized\n             at C:\\Users\\VssAdministrator\\.cargo\\registry\\src\\github.com-1ecc6299db9ec823\\backtrace-0.3.46\\src\\backtrace\\mod.rs:66\n   1: std::sys_common::backtrace::_print_fmt\n             at /rustc/e51b714db8ff82ac38ea7c6742d6f5480e2e77bd\\/src\\libstd\\sys_common\\backtrace.rs:78\n   2: std::sys_common::backtrace::_print::{{impl}}::fmt\n             at /rustc/e51b714db8ff82ac38ea7c6742d6f5480e2e77bd\\/src\\libstd\\sys_common\\backtrace.rs:59\n   3: core::fmt::write\n             at /rustc/e51b714db8ff82ac38ea7c6742d6f5480e2e77bd\\/src\\libcore\\fmt\\mod.rs:1076\n   4: std::io::Write::write_fmt&lt;std::sys::windows::stdio::Stderr&gt;\n             at /rustc/e51b714db8ff82ac38ea7c6742d6f5480e2e77bd\\/src\\libstd\\io\\mod.rs:1537\n   5: std::sys_common::backtrace::_print\n             at /rustc/e51b714db8ff82ac38ea7c6742d6f5480e2e77bd\\/src\\libstd\\sys_common\\backtrace.rs:62\n   6: std::sys_common::backtrace::print\n             at /rustc/e51b714db8ff82ac38ea7c6742d6f5480e2e77bd\\/src\\libstd\\sys_common\\backtrace.rs:49\n   7: std::panicking::default_hook::{{closure}}\n             at /rustc/e51b714db8ff82ac38ea7c6742d6f5480e2e77bd\\/src\\libstd\\panicking.rs:198\n   8: std::panicking::default_hook\n             at /rustc/e51b714db8ff82ac38ea7c6742d6f5480e2e77bd\\/src\\libstd\\panicking.rs:217\n   9: std::panicking::rust_panic_with_hook\n             at /rustc/e51b714db8ff82ac38ea7c6742d6f5480e2e77bd\\/src\\libstd\\panicking.rs:526\n  10: std::panicking::begin_panic_handler\n             at /rustc/e51b714db8ff82ac38ea7c6742d6f5480e2e77bd\\/src\\libstd\\panicking.rs:437\n  11: std::panicking::begin_panic_fmt\n             at /rustc/e51b714db8ff82ac38ea7c6742d6f5480e2e77bd\\/src\\libstd\\panicking.rs:391\n  12: cmake::fail\n             at C:\\Users\\quydx\\.cargo\\registry\\src\\github.com-1ecc6299db9ec823\\cmake-0.1.42\\src\\lib.rs:861\n  13: cmake::run\n             at C:\\Users\\quydx\\.cargo\\registry\\src\\github.com-1ecc6299db9ec823\\cmake-0.1.42\\src\\lib.rs:839\n  14: cmake::Config::build\n             at C:\\Users\\quydx\\.cargo\\registry\\src\\github.com-1ecc6299db9ec823\\cmake-0.1.42\\src\\lib.rs:745\n  15: bootstrap::native::{{impl}}::run\n             at .\\src\\bootstrap\\native.rs:333\n  16: bootstrap::builder::Builder::ensure&lt;bootstrap::native::Llvm&gt;\n             at .\\src\\bootstrap\\builder.rs:1379\n  17: bootstrap::compile::rustc_cargo_env\n             at .\\src\\bootstrap\\compile.rs:576\n  18: bootstrap::compile::rustc_cargo\n             at .\\src\\bootstrap\\compile.rs:528\n  19: bootstrap::compile::{{impl}}::run\n             at .\\src\\bootstrap\\compile.rs:499\n  20: bootstrap::builder::Builder::ensure&lt;bootstrap::compile::Rustc&gt;\n             at .\\src\\bootstrap\\builder.rs:1379\n  21: bootstrap::compile::{{impl}}::run\n             at .\\src\\bootstrap\\compile.rs:780\n  22: bootstrap::builder::Builder::ensure&lt;bootstrap::compile::Assemble&gt;\n             at .\\src\\bootstrap\\builder.rs:1379\n  23: bootstrap::builder::Builder::compiler\n             at .\\src\\bootstrap\\builder.rs:582\n  24: bootstrap::compile::{{impl}}::run\n             at .\\src\\bootstrap\\compile.rs:773\n  25: bootstrap::builder::Builder::ensure&lt;bootstrap::compile::Assemble&gt;\n             at .\\src\\bootstrap\\builder.rs:1379\n  26: bootstrap::builder::Builder::compiler\n             at .\\src\\bootstrap\\builder.rs:582\n  27: bootstrap::compile::{{impl}}::make_run\n             at .\\src\\bootstrap\\compile.rs:48\n  28: bootstrap::builder::StepDescription::maybe_run\n             at .\\src\\bootstrap\\builder.rs:189\n  29: bootstrap::builder::StepDescription::run\n             at .\\src\\bootstrap\\builder.rs:211\n  30: bootstrap::builder::Builder::run_step_descriptions\n             at .\\src\\bootstrap\\builder.rs:574\n  31: bootstrap::builder::Builder::execute_cli\n             at .\\src\\bootstrap\\builder.rs:565\n  32: bootstrap::Build::build\n             at .\\src\\bootstrap\\lib.rs:491\n  33: bootstrap::main\n             at .\\src\\bootstrap\\bin\\main.rs:15\n  34: std::rt::lang_start::{{closure}}&lt;tuple&lt;&gt;&gt;\n             at /rustc/e51b714db8ff82ac38ea7c6742d6f5480e2e77bd\\src\\libstd\\rt.rs:67\n  35: std::rt::lang_start_internal::{{closure}}\n             at /rustc/e51b714db8ff82ac38ea7c6742d6f5480e2e77bd\\/src\\libstd\\rt.rs:52\n  36: std::panicking::try::do_call\n             at /rustc/e51b714db8ff82ac38ea7c6742d6f5480e2e77bd\\/src\\libstd\\panicking.rs:348\n  37: std::panicking::try\n             at /rustc/e51b714db8ff82ac38ea7c6742d6f5480e2e77bd\\/src\\libstd\\panicking.rs:325\n  38: std::panic::catch_unwind\n             at /rustc/e51b714db8ff82ac38ea7c6742d6f5480e2e77bd\\/src\\libstd\\panic.rs:394\n  39: std::rt::lang_start_internal\n             at /rustc/e51b714db8ff82ac38ea7c6742d6f5480e2e77bd\\/src\\libstd\\rt.rs:51\n  40: std::rt::lang_start&lt;tuple&lt;&gt;&gt;\n             at /rustc/e51b714db8ff82ac38ea7c6742d6f5480e2e77bd\\src\\libstd\\rt.rs:67\n  41: main\n  42: invoke_main\n             at d:\\A01\\_work\\6\\s\\src\\vctools\\crt\\vcstartup\\src\\startup\\exe_common.inl:78\n  43: __scrt_common_main_seh\n             at d:\\A01\\_work\\6\\s\\src\\vctools\\crt\\vcstartup\\src\\startup\\exe_common.inl:288\n  44: BaseThreadInitThunk\n  45: RtlUserThreadStart\nnote: Some details are omitted, run with `RUST_BACKTRACE=full` for a verbose backtrace.\n</code></pre></div>\n\n\n<p><a href=\"https://hastebin.com/yilokumeqa.coffeescript\">https://hastebin.com/yilokumeqa.coffeescript</a></p>",
        "id": 204967368,
        "sender_full_name": "Quy Nguyen",
        "timestamp": 1595625059
    },
    {
        "content": "<p>This is an error building llvm from source. Have you considered using a system llvm instead? Not sure how hard that is on windows: <a href=\"https://rustc-dev-guide.rust-lang.org/building/suggested.html#building-with-system-llvm\">https://rustc-dev-guide.rust-lang.org/building/suggested.html#building-with-system-llvm</a></p>",
        "id": 204968792,
        "sender_full_name": "Joshua Nelson",
        "timestamp": 1595626007
    },
    {
        "content": "<p>the relevant error message looks like <a href=\"https://hastebin.com/cagireyafu.rb\">https://hastebin.com/cagireyafu.rb</a></p>",
        "id": 204968845,
        "sender_full_name": "Joshua Nelson",
        "timestamp": 1595626063
    },
    {
        "content": "<p>Can I just grab llvm 10 from their website?</p>",
        "id": 204969471,
        "sender_full_name": "Quy Nguyen",
        "timestamp": 1595626530
    },
    {
        "content": "<p>possibly, as long as you can get <code>llvm-config</code> in your environment I _think_ things will just work</p>",
        "id": 204969574,
        "sender_full_name": "Joshua Nelson",
        "timestamp": 1595626605
    },
    {
        "content": "<p>Had to do some stuff with vcpkg, but it works now, thanks! LLVM doesn't ship the config in the precompiled bins sadly.</p>",
        "id": 204980996,
        "sender_full_name": "Quy Nguyen",
        "timestamp": 1595639336
    },
    {
        "content": "<p>yay! glad it's working :)</p>",
        "id": 204981067,
        "sender_full_name": "Joshua Nelson",
        "timestamp": 1595639421
    },
    {
        "content": "<p>I lied :(<br>\nActually linking it gives me a bunch of notes</p>\n<div class=\"codehilite\"><pre><span></span><code>  = note: librustc_llvm-1e5f6b2d41c05068.rlib(X86Disassembler.cpp.obj) : error LNK2038: mismatch detected for &#39;RuntimeLibrary&#39;: value &#39;MD_DynamicRelease&#39; doesn&#39;t match value &#39;MT_StaticRelease&#39; in librustc_llvm-1e5f6b2d41c05068.rlib(Linker.o)\n          librustc_llvm-1e5f6b2d41c05068.rlib(X86AsmParser.cpp.obj) : error LNK2038: mismatch detected for &#39;RuntimeLibrary&#39;: value &#39;MD_DynamicRelease&#39; doesn&#39;t match value &#39;MT_StaticRelease&#39; in librustc_llvm-1e5f6b2d41c05068.rlib(Linker.o)\n          librustc_llvm-1e5f6b2d41c05068.rlib(X86WinEHState.cpp.obj) : error LNK2038: mismatch detected for &#39;RuntimeLibrary&#39;: value &#39;MD_DynamicRelease&#39; doesn&#39;t match value &#39;MT_StaticRelease&#39; in librustc_llvm-1e5f6b2d41c05068.rlib(Linker.o)\n</code></pre></div>\n\n\n<p>And errors</p>\n<div class=\"codehilite\"><pre><span></span><code>          librustc_llvm-1e5f6b2d41c05068.rlib(MachineBasicBlock.cpp.obj) : error LNK2019: unresolved external symbol __imp_rint referenced in function &quot;public: void __cdecl llvm::MachineBasicBlock::print(class llvm::raw_ostream &amp;,class llvm::ModuleSlotTracker &amp;,class llvm::SlotIndexes const *,bool)const &quot; (?print@MachineBasicBlock@llvm@@QEBAXAEAVraw_ostream@2@AEAVModuleSlotTracker@2@PEBVSlotIndexes@2@_N@Z)\n          librustc_llvm-1e5f6b2d41c05068.rlib(BranchProbability.cpp.obj) : error LNK2001: unresolved external symbol __imp_rint\n          librustc_llvm-1e5f6b2d41c05068.rlib(SimplifyLibCalls.cpp.obj) : error LNK2019: unresolved external symbol __imp_log2 referenced in function &quot;private: class llvm::Value * __cdecl llvm::LibCallSimplifier::replacePowWithExp(class llvm::CallInst *,class llvm::IRBuilder&lt;class llvm::ConstantFolder,class llvm::IRBuilderDefaultInserter&gt; &amp;)&quot; (?replacePowWithExp@LibCallSimplifier@llvm@@AEAAPEAVValue@2@PEAVCallInst@2@AEAV?$IRBuilder@VConstantFolder@llvm@@VIRBuilderDefaultInserter@2@@2@@Z)\n          librustc_llvm-1e5f6b2d41c05068.rlib(ConstantFolding.cpp.obj) : error LNK2001: unresolved external symbol __imp_log2\n          librustc_llvm-1e5f6b2d41c05068.rlib(SimplifyLibCalls.cpp.obj) : error LNK2019: unresolved external symbol __imp_log2f referenced in function &quot;private: class llvm::Value * __cdecl llvm::LibCallSimplifier::replacePowWithExp(class llvm::CallInst *,class llvm::IRBuilder&lt;class llvm::ConstantFolder,class llvm::IRBuilderDefaultInserter&gt; &amp;)&quot; (?replacePowWithExp@LibCallSimplifier@llvm@@AEAAPEAVValue@2@PEAVCallInst@2@AEAV?$IRBuilder@VConstantFolder@llvm@@VIRBuilderDefaultInserter@2@@2@@Z)\n          librustc_llvm-1e5f6b2d41c05068.rlib(ConstantFolding.cpp.obj) : error LNK2019: unresolved external symbol __imp_feclearexcept referenced in function &quot;class llvm::Constant * __cdecl `anonymous namespace&#39;::ConstantFoldBinaryFP(double (__cdecl*)(double,double),double,double,class llvm::Type *)&quot; (?ConstantFoldBinaryFP@?A0xa3245e41@@YAPEAVConstant@llvm@@P6ANNN@ZNNPEAVType@3@@Z)\n          librustc_llvm-1e5f6b2d41c05068.rlib(InstrProf.cpp.obj) : error LNK2019: unresolved external symbol __imp_strncpy referenced in function &quot;public: void __cdecl llvm::OverlapStats::dump(class llvm::raw_fd_ostream &amp;)const &quot; (?dump@OverlapStats@llvm@@QEBAXAEAVraw_fd_ostream@2@@Z)\n          librustc_llvm-1e5f6b2d41c05068.rlib(WindowsResource.cpp.obj) : error LNK2001: unresolved external symbol __imp_strncpy\n          librustc_llvm-1e5f6b2d41c05068.rlib(XCOFFObjectWriter.cpp.obj) : error LNK2001: unresolved external symbol __imp_strncpy\n          librustc_llvm-1e5f6b2d41c05068.rlib(WinCOFFObjectWriter.cpp.obj) : error LNK2019: unresolved external symbol __imp__time64 referenced in function &quot;public: virtual unsigned __int64 __cdecl `anonymous namespace&#39;::WinCOFFObjectWriter::writeObject(class llvm::MCAssembler &amp;,class llvm::MCAsmLayout const &amp;)&quot; (?writeObject@WinCOFFObjectWriter@?A0x108a2793@@UEAA_KAEAVMCAssembler@llvm@@AEBVMCAsmLayout@4@@Z)\n          librustc_llvm-1e5f6b2d41c05068.rlib(Program.cpp.obj) : error LNK2019: unresolved external symbol __imp__setmode referenced in function &quot;class std::error_code __cdecl llvm::sys::ChangeStdinToBinary(void)&quot; (?ChangeStdinToBinary@sys@llvm@@YA?AVerror_code@std@@XZ)\n          librustc_llvm-1e5f6b2d41c05068.rlib(Process.cpp.obj) : error LNK2019: unresolved external symbol __imp__heapwalk referenced in function &quot;public: static unsigned __int64 __cdecl llvm::sys::Process::GetMallocUsage(void)&quot; (?GetMallocUsage@Process@sys@llvm@@SA_KXZ)\n          librustc_llvm-1e5f6b2d41c05068.rlib(Process.cpp.obj) : error LNK2019: unresolved external symbol __imp_close referenced in function &quot;public: static class std::error_code __cdecl llvm::sys::Process::SafelyCloseFileDescriptor(int)&quot; (?SafelyCloseFileDescriptor@Process@sys@llvm@@SA?AVerror_code@std@@H@Z)\n          librustc_llvm-1e5f6b2d41c05068.rlib(Path.cpp.obj) : error LNK2001: unresolved external symbol __imp_close\n          OLDNAMES.lib(close.obi) : error LNK2001: unresolved external symbol __imp_close\n          librustc_llvm-1e5f6b2d41c05068.rlib(Path.cpp.obj) : error LNK2019: unresolved external symbol __imp__chsize_s referenced in function &quot;class std::error_code __cdecl llvm::sys::fs::resize_file(int,unsigned __int64)&quot; (?resize_file@fs@sys@llvm@@YA?AVerror_code@std@@H_K@Z)\n          librustc_llvm-1e5f6b2d41c05068.rlib(Path.cpp.obj) : error LNK2019: unresolved external symbol __imp_read referenced in function &quot;class std::error_code __cdecl llvm::sys::fs::copy_file_internal(int,int)&quot; (?copy_file_internal@fs@sys@llvm@@YA?AVerror_code@std@@HH@Z)\n          OLDNAMES.lib(read.obi) : error LNK2001: unresolved external symbol __imp_read\n          librustc_llvm-1e5f6b2d41c05068.rlib(Path.cpp.obj) : error LNK2019: unresolved external symbol __imp_write referenced in function &quot;class std::error_code __cdecl llvm::sys::fs::copy_file_internal(int,int)&quot; (?copy_file_internal@fs@sys@llvm@@YA?AVerror_code@std@@HH@Z)\n          librustc_llvm-1e5f6b2d41c05068.rlib(raw_ostream.cpp.obj) : error LNK2001: unresolved external symbol __imp_write\n          librustc_llvm-1e5f6b2d41c05068.rlib(ErrorHandling.cpp.obj) : error LNK2001: unresolved external symbol __imp_write\n          OLDNAMES.lib(write.obi) : error LNK2001: unresolved external symbol __imp_write\n          librustc_llvm-1e5f6b2d41c05068.rlib(Errno.cpp.obj) : error LNK2019: unresolved external symbol __imp_strerror_s referenced in function &quot;class std::basic_string&lt;char,struct std::char_traits&lt;char&gt;,class std::allocator&lt;char&gt; &gt; __cdecl llvm::sys::StrError(int)&quot; (?StrError@sys@llvm@@YA?AV?$basic_string@DU?$char_traits@D@std@@V?$allocator@D@2@@std@@H@Z)\n          librustc_llvm-1e5f6b2d41c05068.rlib(raw_ostream.cpp.obj) : error LNK2019: unresolved external symbol __imp_lseek referenced in function &quot;public: __cdecl llvm::raw_fd_ostream::raw_fd_ostream(int,bool,bool)&quot; (??0raw_fd_ostream@llvm@@QEAA@H_N0@Z)\n          OLDNAMES.lib(lseek.obi) : error LNK2001: unresolved external symbol __imp_lseek\n          librustc_llvm-1e5f6b2d41c05068.rlib(NativeFormatting.cpp.obj) : error LNK2019: unresolved external symbol __imp__fpclass referenced in function &quot;void __cdecl llvm::write_double(class llvm::raw_ostream &amp;,double,enum llvm::FloatStyle,class llvm::Optional&lt;unsigned __int64&gt;)&quot; (?write_double@llvm@@YAXAEAVraw_ostream@1@NW4FloatStyle@1@V?$Optional@_K@1@@Z)\n          librustc_llvm-1e5f6b2d41c05068.rlib(JSON.cpp.obj) : error LNK2019: unresolved external symbol __imp_modf referenced in function &quot;public: class llvm::Optional&lt;__int64&gt; __cdecl llvm::json::Value::getAsInteger(void)const &quot; (?getAsInteger@Value@json@llvm@@QEBA?AV?$Optional@_J@3@XZ)\n          librustc_llvm-1e5f6b2d41c05068.rlib(Chrono.cpp.obj) : error LNK2019: unresolved external symbol __imp__localtime64_s referenced in function &quot;class llvm::raw_ostream &amp; __cdecl llvm::operator&lt;&lt;(class llvm::raw_ostream &amp;,class std::chrono::time_point&lt;struct std::chrono::system_clock,class std::chrono::duration&lt;__int64,struct std::ratio&lt;1,1000000000&gt; &gt; &gt;)&quot; (??6llvm@@YAAEAVraw_ostream@0@AEAV10@V?$time_point@Usystem_clock@chrono@std@@V?$duration@_JU?$ratio@$00$0DLJKMKAA@@std@@@23@@chrono@std@@@Z)\n          C:\\Users\\quydx\\Documents\\Code\\rust\\build\\x86_64-pc-windows-msvc\\stage0-rustc\\x86_64-pc-windows-msvc\\release\\deps\\rustc_driver-f94565c51c798522.dll : fatal error LNK1120: 17 unresolved externals\n</code></pre></div>",
        "id": 204982007,
        "sender_full_name": "Quy Nguyen",
        "timestamp": 1595641045
    },
    {
        "content": "<p>that looks like the same error as before <span aria-label=\"thinking\" class=\"emoji emoji-1f914\" role=\"img\" title=\"thinking\">:thinking:</span></p>",
        "id": 204982161,
        "sender_full_name": "Joshua Nelson",
        "timestamp": 1595641316
    },
    {
        "content": "<p>I don't use windows so I'm not sure how much I can help :/ can you compile normal C programs?</p>",
        "id": 204982222,
        "sender_full_name": "Joshua Nelson",
        "timestamp": 1595641388
    },
    {
        "content": "<p>it seems like the llvm build is success but installation step is not</p>",
        "id": 204984328,
        "sender_full_name": "lzutao",
        "timestamp": 1595645138
    },
    {
        "content": "<p>So it looks like the vcpkg install doesn't support shared libs for LLVM, and they provide <a href=\"https://github.com/llvm/llvm-project/blob/33d9c4109ac234bcf17501ba16880ce80622cc9c/llvm/CMakeLists.txt#L579\">this link</a>, which just confuses me hmm.</p>",
        "id": 204985495,
        "sender_full_name": "Quy Nguyen",
        "timestamp": 1595647089
    },
    {
        "content": "<p>Ok, I got it to work on wsl, but <code>python3 x.py test</code> gives me a bunch of tidy errors.</p>\n<div class=\"codehilite\"><pre><span></span><code>tidy error: binary checked into source: /mnt/c/Users/quydx/rust/src/doc/guide-ffi.md\ntidy error: binary checked into source: /mnt/c/Users/quydx/rust/src/doc/guide-macros.md\ntidy error: binary checked into source: /mnt/c/Users/quydx/rust/src/doc/guide-ownership.md\ntidy error: binary checked into source: /mnt/c/Users/quydx/rust/src/doc/guide-plugins.md\ntidy error: binary checked into source: /mnt/c/Users/quydx/rust/src/doc/guide-pointers.md\ntidy error: binary checked into source: /mnt/c/Users/quydx/rust/src/doc/guide-strings.md\ntidy error: binary checked into source: /mnt/c/Users/quydx/rust/src/doc/guide-tasks.md\ntidy error: binary checked into source: /mnt/c/Users/quydx/rust/src/doc/guide-testing.md\ntidy error: binary checked into source: /mnt/c/Users/quydx/rust/src/doc/guide-unsafe.md\ntidy error: binary checked into source: /mnt/c/Users/quydx/rust/src/doc/guide.md\ntidy error: binary checked into source: /mnt/c/Users/quydx/rust/src/doc/index.md\ntidy error: binary checked into source: /mnt/c/Users/quydx/rust/src/doc/intro.md\ntidy error: binary checked into source: /mnt/c/Users/quydx/rust/src/doc/man/rustc.1\ntidy error: binary checked into source: /mnt/c/Users/quydx/rust/src/doc/man/rustdoc.1\ntidy error: binary checked into source: /mnt/c/Users/quydx/rust/src/doc/not_found.md\ntidy error: binary checked into source: /mnt/c/Users/quydx/rust/src/doc/redirect.inc\ntidy error: binary checked into source: /mnt/c/Users/quydx/rust/src/doc/reference.md\n</code></pre></div>",
        "id": 205014648,
        "sender_full_name": "Quy Nguyen",
        "timestamp": 1595700456
    },
    {
        "content": "<p>Hmm ok found the bug and made a PR. Seems like Windows is not used often around here :P</p>",
        "id": 205015054,
        "sender_full_name": "Quy Nguyen",
        "timestamp": 1595700950
    }
]