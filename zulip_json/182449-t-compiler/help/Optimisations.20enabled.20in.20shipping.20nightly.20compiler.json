[
    {
        "content": "<p>Hello,</p>\n<p>When building a local stage2 compiler, the results are noticeably slower than the shipped nightly compiler. I was wondering if there's a place where I can find what <code>config.toml</code> or other parameters are used for building Real rust builds? From looking at the code it seems like there's a bunch of stuff that isn't being inlined that should be, so I was kind of thinking that there might be LTO enabled for the real builds?</p>",
        "id": 267313406,
        "sender_full_name": "Josh Simmons",
        "timestamp": 1641673042
    },
    {
        "content": "<p>Maybe it's PGO</p>",
        "id": 267315124,
        "sender_full_name": "Nick12",
        "timestamp": 1641675536
    },
    {
        "content": "<p>Dist CI builds created for each accepted PR notably use jemalloc and, on x86-64, use profile-guided optimization, see <a href=\"https://github.com/rust-lang/rust/blob/488acf86a75c56d30b16822e953c505a9e4901a7/src/ci/docker/host-x86_64/dist-x86_64-linux/Dockerfile#L114\">Dockerfile</a> and <a href=\"https://github.com/rust-lang/rust/blob/488acf86a75c56d30b16822e953c505a9e4901a7/src/ci/pgo.sh\">pgo.sh</a>.  Each day one of the successful ones is promoted to nightly. The easiest (but also quite time-consuming) way to produce one with similar performance characteristics is to use the same build process via <code>DEPLOY=1 ./src/ci/docker/run.sh dist-x86_64-linux</code>.</p>",
        "id": 267316344,
        "sender_full_name": "Hans Kratz",
        "timestamp": 1641676448
    },
    {
        "content": "<p>Another notable difference is that <code>codegen-units-std=1</code> is set.  If you want to see what the configure arguments are, you can look at the build logs. For example:</p>\n<ol>\n<li>Go to <a href=\"https://github.com/rust-lang-ci/rust/actions?query=branch%3Aauto\">https://github.com/rust-lang-ci/rust/actions?query=branch%3Aauto</a></li>\n<li>Click on a recently finished build</li>\n<li>Click on the build target you are interested in. For example, dist-x86_64-linux.</li>\n<li>Click the wheel and then \"View raw logs\"</li>\n<li>Look for the lines near the top that say <code>configure:</code></li>\n</ol>",
        "id": 267316613,
        "sender_full_name": "Eric Huss",
        "timestamp": 1641676874
    }
]