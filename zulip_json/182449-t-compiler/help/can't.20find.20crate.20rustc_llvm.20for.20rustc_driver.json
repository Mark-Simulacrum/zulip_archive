[
    {
        "content": "<p>So why can it be that the rustc_llvm crate cannot be found ?</p>",
        "id": 250238056,
        "sender_full_name": "hannahE2",
        "timestamp": 1629581423
    },
    {
        "content": "<p>rustc_codegen_llvm was compiled</p>",
        "id": 250238070,
        "sender_full_name": "hannahE2",
        "timestamp": 1629581465
    },
    {
        "content": "<p>llvm is succesfully compiled in rust/build/x86_64-unknown-linux-gnu/llvm</p>",
        "id": 250238079,
        "sender_full_name": "hannahE2",
        "timestamp": 1629581498
    },
    {
        "content": "<p>I don't know, sorry</p>",
        "id": 250238123,
        "sender_full_name": "Joshua Nelson",
        "timestamp": 1629581542
    },
    {
        "content": "<p>note that rustc_codegen_llvm and rustc_llvm are different</p>",
        "id": 250238125,
        "sender_full_name": "Joshua Nelson",
        "timestamp": 1629581551
    },
    {
        "content": "<p>but indeed the rustc_llvm crate is not compiled anywhere</p>",
        "id": 250238126,
        "sender_full_name": "hannahE2",
        "timestamp": 1629581554
    },
    {
        "content": "<p>rustc_llvm is basically the <code>-sys</code> version</p>",
        "id": 250238130,
        "sender_full_name": "Joshua Nelson",
        "timestamp": 1629581559
    },
    {
        "content": "<p>yep, that's missing</p>",
        "id": 250238131,
        "sender_full_name": "hannahE2",
        "timestamp": 1629581568
    },
    {
        "content": "<p>you could try touching the <a href=\"http://build.rs\">build.rs</a> maybe? <span aria-label=\"shrug\" class=\"emoji emoji-1f937\" role=\"img\" title=\"shrug\">:shrug:</span></p>",
        "id": 250238132,
        "sender_full_name": "Joshua Nelson",
        "timestamp": 1629581577
    },
    {
        "content": "<p>ok so rustc_llvm is built as part of stage0</p>",
        "id": 250238184,
        "sender_full_name": "hannahE2",
        "timestamp": 1629581648
    },
    {
        "content": "<p>should rustdoc pick the stage0 version ?</p>",
        "id": 250238208,
        "sender_full_name": "hannahE2",
        "timestamp": 1629581729
    },
    {
        "content": "<p>yes, it does normally</p>",
        "id": 250238210,
        "sender_full_name": "Joshua Nelson",
        "timestamp": 1629581735
    },
    {
        "content": "<p>actually, just to make sure your build environment isn't cursed - if you remove absolutely all those configs from your config.toml, do you get the same error?</p>",
        "id": 250238223,
        "sender_full_name": "Joshua Nelson",
        "timestamp": 1629581756
    },
    {
        "content": "<p>its a dependency of rustc_driver, and touching the rustc_llvm/build.rs also rebuilds rustc_driver</p>",
        "id": 250238266,
        "sender_full_name": "hannahE2",
        "timestamp": 1629581780
    },
    {
        "content": "<p>yup that sounds right</p>",
        "id": 250238287,
        "sender_full_name": "Joshua Nelson",
        "timestamp": 1629581798
    },
    {
        "content": "<p>I hit this recently - setting llvm.optimize to false is enough to reproduce it I think. other stages use this LLVM build fine, but rustdoc doesn't like it (<code>x.py build</code>, so with stage 1)</p>",
        "id": 251556031,
        "sender_full_name": "Adam Gemmell",
        "timestamp": 1630502304
    },
    {
        "content": "<p>Not sure there's a much of a reason to build rustdoc with a debug llvm so something like <code>x.py build library/std</code> works around this fine of course</p>",
        "id": 251556114,
        "sender_full_name": "Adam Gemmell",
        "timestamp": 1630502343
    },
    {
        "content": "<p>Actually, <span class=\"user-mention\" data-user-id=\"409057\">@hannahE2</span>'s config just turns on debuginfo for the release build instead.<br>\nllvm assertions and rust debug alone don't cause a problem.</p>",
        "id": 251557981,
        "sender_full_name": "Adam Gemmell",
        "timestamp": 1630503010
    },
    {
        "content": "<p>thanks! <code>llvm.optimize</code> was it!</p>",
        "id": 251730905,
        "sender_full_name": "hannahE2",
        "timestamp": 1630595351
    }
]