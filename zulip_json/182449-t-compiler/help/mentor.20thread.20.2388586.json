[
    {
        "content": "<p>For <a href=\"https://github.com/rust-lang/rust/issues/88586\">https://github.com/rust-lang/rust/issues/88586</a></p>\n<p>I'm gonna spend some time in the code to get my bearings. </p>\n<p>For the record, this will be my first substantive contribution to rustc. I have spent a little bit of time in some of the MIR parts of the compiler like trait_selection and infer, but the AST and HIR stuff is all new to me still.</p>",
        "id": 262858748,
        "sender_full_name": "Ben Reeves",
        "timestamp": 1637996607
    },
    {
        "content": "<p>Ok, some random questions/thoughts before I go to bed:</p>\n<p>1) Conceptually, what does the \"poly\" mean in PolyTraitRef?</p>\n<p>2) The following example does <em>not</em> ICE with debug_assertions:</p>\n<div class=\"codehilite\" data-code-language=\"Rust\"><pre><span></span><code><span class=\"k\">fn</span> <span class=\"nf\">foo</span><span class=\"o\">&lt;</span><span class=\"n\">T</span><span class=\"o\">&gt;</span><span class=\"p\">(</span><span class=\"n\">t</span>: <span class=\"nc\">T</span><span class=\"p\">)</span><span class=\"w\"></span>\n<span class=\"k\">where</span><span class=\"w\"></span>\n<span class=\"w\">    </span><span class=\"k\">for</span><span class=\"o\">&lt;'</span><span class=\"na\">b</span><span class=\"o\">&gt;</span><span class=\"w\"> </span><span class=\"n\">T</span>: <span class=\"o\">'</span><span class=\"na\">b</span><span class=\"p\">,</span><span class=\"w\"></span>\n<span class=\"p\">{</span><span class=\"w\"></span>\n<span class=\"p\">}</span><span class=\"w\"></span>\n</code></pre></div>\n<p>What makes this example different from the one that does ICE? I tried doing some debug logging, and it seems that the difference lies somewhere above <code>AstConv::add_bounds</code>:</p>\n<p>ICE example (empty <code>bound_vars</code>):</p>\n<div class=\"codehilite\"><pre><span></span><code>┐rustc_typeck::astconv::add_bounds param_ty=Self, bound_vars=[]\n┘\n┐rustc_typeck::astconv::add_bounds param_ty=Self, bound_vars=[]\n├─┐rustc_typeck::astconv::ast_region_to_region lifetime=lifetime(HirId { owner: DefId(0:9 ~ issue_88586[e2ea]::A), local_id: 4 }: &#39;a), def=None\n...\n├─┐rustc_middle::ty::sty::bind_with_vars value=ReLateBound(DebruijnIndex(0), BoundRegion { var: 0, kind: BrNamed(DefId(0:10 ~ issue_88586[e2ea]::A::&#39;a), &#39;a) }), vars=[]\n</code></pre></div>\n<p>No-ICE example (non-empty <code>bound_vars</code>):</p>\n<div class=\"codehilite\"><pre><span></span><code>┐rustc_typeck::astconv::add_bounds param_ty=T, bound_vars=[]\n┘\n┐rustc_typeck::astconv::add_bounds param_ty=T, bound_vars=[Region(BrNamed(DefId(0:12 ~ issue_88586[e2ea]::foo::&#39;b), &#39;b))]\n├─┐rustc_typeck::astconv::ast_region_to_region lifetime=lifetime(HirId { owner: DefId(0:10 ~ issue_88586[e2ea]::foo), local_id: 9 }: &#39;b), def=None\n...\n├─┐rustc_middle::ty::sty::bind_with_vars value=ReLateBound(DebruijnIndex(0), BoundRegion { var: 0, kind: BrNamed(DefId(0:12 ~ issue_88586[e2ea]::foo::&#39;b), &#39;b) }), vars=[Region(BrNamed(DefId(0:12 ~ issue_88586[e2ea]::foo::&#39;b), &#39;b))]\n</code></pre></div>",
        "id": 262862699,
        "sender_full_name": "Ben Reeves",
        "timestamp": 1638003280
    },
    {
        "content": "<p>1) <code>Poly*</code> generally means it's a type alias for <code>Binder&lt;'tcx, *&gt;</code></p>",
        "id": 262882486,
        "sender_full_name": "Jack Huey",
        "timestamp": 1638032023
    },
    {
        "content": "<p>2) The difference here really does lie with the bound vars that get passed to <code>add_bounds</code></p>",
        "id": 262882587,
        "sender_full_name": "Jack Huey",
        "timestamp": 1638032134
    },
    {
        "content": "<p>1) sure, I get that, but I'm having a hard time understanding how \"poly\" and \"binder\" are related conceptually.</p>\n<p>2) ok, so is that relevant to this issue do you think? Or a red herring?</p>",
        "id": 262888223,
        "sender_full_name": "Ben Reeves",
        "timestamp": 1638040244
    },
    {
        "content": "<p>I think I got it</p>",
        "id": 262910457,
        "sender_full_name": "Ben Reeves",
        "timestamp": 1638076459
    }
]