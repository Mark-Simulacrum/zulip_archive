[
    {
        "content": "<p>I'm trying to continue working on an older PR (Jan. 21). I fetched that PR, rebased and then tried to compile, but the repo now doesn't have a cargo-util directory anymore?! I get the following error while trying to build:</p>\n<div class=\"codehilite\"><pre><span></span><code>Updating only changed submodules\nSubmodules updated in 0.06 seconds\ndownloading https://static.rust-lang.org/dist/2021-10-22/rust-std-beta-x86_64-apple-darwin.tar.xz\n######################################################################## 100.0%\nextracting /Users/bn/Documents/rust-local-fork/temp/build/cache/2021-10-22/rust-std-beta-x86_64-apple-darwin.tar.xz\ndownloading https://static.rust-lang.org/dist/2021-10-22/rustc-beta-x86_64-apple-darwin.tar.xz\n######################################################################## 100.0%\nextracting /Users/bn/Documents/rust-local-fork/temp/build/cache/2021-10-22/rustc-beta-x86_64-apple-darwin.tar.xz\ndownloading https://static.rust-lang.org/dist/2021-10-22/cargo-beta-x86_64-apple-darwin.tar.xz\n######################################################################## 100.0%\nextracting /Users/bn/Documents/rust-local-fork/temp/build/cache/2021-10-22/cargo-beta-x86_64-apple-darwin.tar.xz\ndownloading https://static.rust-lang.org/dist/2021-10-23/rustfmt-nightly-x86_64-apple-darwin.tar.xz\n######################################################################## 100.0%\nextracting /Users/bn/Documents/rust-local-fork/temp/build/cache/2021-10-23/rustfmt-nightly-x86_64-apple-darwin.tar.xz\nerror: failed to resolve patches for `https://github.com/rust-lang/cargo`\n\nCaused by:\n  failed to load source for dependency `cargo-util`\n\nCaused by:\n  Unable to update /Users/bn/Documents/rust-local-fork/temp/src/tools/cargo/crates/cargo-util\n\nCaused by:\n  failed to read `/Users/bn/Documents/rust-local-fork/temp/src/tools/cargo/crates/cargo-util/Cargo.toml`\n\nCaused by:\n  No such file or directory (os error 2)\nfailed to run: /Users/bn/Documents/rust-local-fork/temp/build/x86_64-apple-darwin/stage0/bin/cargo build --manifest-path /Users/bn/Documents/rust-local-fork/temp/src/bootstrap/Cargo.toml\nBuild completed unsuccessfully in 0:00:45\n</code></pre></div>\n<p>Does anybody know how to fix this?</p>",
        "id": 259858413,
        "sender_full_name": "BN",
        "timestamp": 1635770338
    },
    {
        "content": "<p>Does a manual <code>git submodule update</code> help?</p>",
        "id": 259859876,
        "sender_full_name": "Hans Kratz",
        "timestamp": 1635771372
    },
    {
        "content": "<p>No it doesnt, unfortunately</p>",
        "id": 259860195,
        "sender_full_name": "BN",
        "timestamp": 1635771589
    },
    {
        "content": "<p>Weird, did this PR touch submodules? What is the output of <code>git status; git submodule status; (cd src/tools/cargo; git status)</code> (in git bash)</p>",
        "id": 259861123,
        "sender_full_name": "Hans Kratz",
        "timestamp": 1635772130
    },
    {
        "content": "<p>I'd recommend rebasing on latest master and a git submodule update --init</p>",
        "id": 259861281,
        "sender_full_name": "simulacrum",
        "timestamp": 1635772252
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"407656\">Hans Kratz</span> <a href=\"#narrow/stream/182449-t-compiler.2Fhelp/topic/cant.20compile.20older.20PR.20fetch/near/259861123\">said</a>:</p>\n<blockquote>\n<p>Weird, did this PR touch submodules? What is the output of <code>git status; git submodule status; (cd src/tools/cargo; git status)</code> (in git bash)</p>\n</blockquote>\n<p><code>git status</code> yields nothing to commit, <code>git submodule status</code> output is:</p>\n<div class=\"codehilite\"><pre><span></span><code> 9c732a56f67f54d12a0b4fd99993154906c95ea6 library/stdarch (0.0.3-872-g9c732a56)\n ac57a0ddd23d173b26731ccf939f3ba729753275 src/doc/book (one-book-to-rule-them-all-818-gac57a0dd)\n b91a9a881ee007c12e74e844460ec407cf07a50f src/doc/edition-guide (b91a9a8)\n ceec19e873be87c6ee5666b030c6bb612f889a96 src/doc/embedded-book (remotes/origin/patches/#98-204-gceec19e)\n a8584998eacdea7106a1dfafcbf6c1c06fcdf925 src/doc/nomicon (a858499)\n 50af691f838937c300b47812d0507c6d88c14f97 src/doc/reference (remotes/origin/update-recursion_limit-461-g50af691)\n 03e23af01f0b4f83a3a513da280e1ca92587f2ec src/doc/rust-by-example (03e23af)\n 7adfab42bab045a848126895c2f1e09927c1331a src/doc/rustc-dev-guide (7adfab4)\n f9a8d70b6e0365ac2172ca6b7f1de0341297458d src/llvm-project  (rustc-1.51.0~4)\n 783bc43c660bf39c1e562c8c429b32078ad3099b src/tools/cargo (0.43.0-1344-g783bc43c6)\n 1cf1a2e40a6867948db84f806085a875fbefce3c src/tools/miri (1cf1a2e4)\n 88a58d1f484af31d87b75e1d17655b59910f41fe src/tools/rls (1.31.6-732-g88a58d1)\n 0d03fe6ef57d3956e92382e0e1f1a916015191cb src/tools/rust-analyzer (2020-09-07-58-g0d03fe6ef)\n 5254dbfd25d5284728ab624dca1969d61427a0db src/tools/rust-installer (heads/master)\n</code></pre></div>\n<p><code>git status</code> output inside <code>src/tools/cargo</code> is: </p>\n<div class=\"codehilite\"><pre><span></span><code>HEAD detached at 783bc43c6\nnothing to commit, working tree clean\n</code></pre></div>\n<p>which looks like it might be the root of this problem.</p>\n<p>This is detached at the first rebase I did, which wasn't the current master, but close to current (maybe a week old). After I updated to the current master and ran <code>git submodule update --init</code> I also got:</p>\n<div class=\"codehilite\"><pre><span></span><code>git submodule update --init\nSubmodule path &#39;src/tools/cargo&#39;: checked out &#39;783bc43c660bf39c1e562c8c429b32078ad3099b&#39;\n</code></pre></div>\n<p>I guess the question is how do I re-attach HEAD of  <code>src/tools/cargo</code>?</p>",
        "id": 259863357,
        "sender_full_name": "BN",
        "timestamp": 1635773442
    },
    {
        "content": "<p>The HEAD being detached is normal for submodules, they are pinned to a specific revision and can only be updated with a main repo commit. It seems you have not rebased on the latest master. I suggest rebasing on the very latest master as Marc said.</p>",
        "id": 259865470,
        "sender_full_name": "Hans Kratz",
        "timestamp": 1635774593
    },
    {
        "content": "<p>Afterwards you might need to run <code>git submodule update --init</code> again.</p>",
        "id": 259865980,
        "sender_full_name": "Hans Kratz",
        "timestamp": 1635774874
    },
    {
        "content": "<p>I must have messed something up during the previous rebase. I fetched the branch again and rebased it and now it works. Thanks for your help <span class=\"user-mention\" data-user-id=\"407656\">@Hans Kratz</span> and <span class=\"user-mention\" data-user-id=\"116122\">@simulacrum</span></p>",
        "id": 259889394,
        "sender_full_name": "BN",
        "timestamp": 1635785718
    }
]