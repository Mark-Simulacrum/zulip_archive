[
    {
        "content": "<p>I'm working on a large change to rustc. It's affecting chalk now. Is there a way I can hook up a local copy with my edits of chalk to my rust build? I tried using a local path in  specific crates' Config.toml, but that wasn't enough to get things work IIRC..</p>",
        "id": 261042224,
        "sender_full_name": "pierwill",
        "timestamp": 1636572719
    },
    {
        "content": "<p>You can use the <code>[patch.crates-io]</code> section in the root <code>Cargo.toml</code>.</p>",
        "id": 261043507,
        "sender_full_name": "bjorn3",
        "timestamp": 1636573298
    },
    {
        "content": "<p>Ah great! Will try that</p>",
        "id": 261043549,
        "sender_full_name": "pierwill",
        "timestamp": 1636573320
    },
    {
        "content": "<p>See <a href=\"https://doc.rust-lang.org/cargo/reference/overriding-dependencies.html#the-patch-section\">https://doc.rust-lang.org/cargo/reference/overriding-dependencies.html#the-patch-section</a> for the docs if you need it.</p>",
        "id": 261043603,
        "sender_full_name": "bjorn3",
        "timestamp": 1636573332
    },
    {
        "content": "<p>Related: why does rustc use such an old version of chalk?</p>",
        "id": 261044663,
        "sender_full_name": "pierwill",
        "timestamp": 1636573810
    },
    {
        "content": "<p>Would changes to chalk even take affect before an upgrade?</p>",
        "id": 261044709,
        "sender_full_name": "pierwill",
        "timestamp": 1636573836
    },
    {
        "content": "<p>I'm getting </p>\n<div class=\"codehilite\"><pre><span></span><code>warning: Patch `chalk-ir v0.74.0-dev.0 (/Users/user/repos/chalk/chalk-ir)` was not used in the crate graph.\nCheck that the patched package version and available features are compatible\nwith the dependency requirements. If the patch has a different version from\nwhat is locked in the Cargo.lock file, run `cargo update` to use the new\nversion. This may also occur with an optional dependency that is not enabled.\n</code></pre></div>\n<p><code>cargo update</code> gives the same error. Should I have version 0.55.0 checkout out, then add my patch to that? <span aria-label=\"thinking\" class=\"emoji emoji-1f914\" role=\"img\" title=\"thinking\">:thinking:</span></p>",
        "id": 261045850,
        "sender_full_name": "pierwill",
        "timestamp": 1636574307
    },
    {
        "content": "<p>I think so</p>",
        "id": 261045974,
        "sender_full_name": "lqd",
        "timestamp": 1636574363
    },
    {
        "content": "<p>IIRC patching it this way requires that your local checkout has the same version</p>",
        "id": 261046009,
        "sender_full_name": "lqd",
        "timestamp": 1636574381
    },
    {
        "content": "<p>(or a somewhat compatible one, say)</p>",
        "id": 261046022,
        "sender_full_name": "lqd",
        "timestamp": 1636574393
    },
    {
        "content": "<p>those warnings are normal when doing x.py because it builds some components which don't have chalk in their dependency graph.</p>",
        "id": 261046238,
        "sender_full_name": "The 8472",
        "timestamp": 1636574436
    },
    {
        "content": "<p>Checked out v0.55.0 locally, now I'm getting deprecation warnings <span aria-label=\"laughter tears\" class=\"emoji emoji-1f602\" role=\"img\" title=\"laughter tears\">:laughter_tears:</span></p>",
        "id": 261047913,
        "sender_full_name": "pierwill",
        "timestamp": 1636575149
    },
    {
        "content": "<p>Ah. <code>#![allow(warnings)]</code> fixed that.</p>",
        "id": 261049612,
        "sender_full_name": "pierwill",
        "timestamp": 1636575847
    },
    {
        "content": "<p>When I'm testing a Chalk change, I'll generally just push to a branch and then switch the dependencies to git</p>",
        "id": 261050353,
        "sender_full_name": "Jack Huey",
        "timestamp": 1636576213
    },
    {
        "content": "<p>I don't think rustc uses <em>that old</em> of a Chalk version</p>",
        "id": 261050400,
        "sender_full_name": "Jack Huey",
        "timestamp": 1636576242
    },
    {
        "content": "<p>but PRs to update are welcome</p>",
        "id": 261050428,
        "sender_full_name": "Jack Huey",
        "timestamp": 1636576255
    },
    {
        "content": "<p>just r? me</p>",
        "id": 261050440,
        "sender_full_name": "Jack Huey",
        "timestamp": 1636576258
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"232957\">Jack Huey</span> <a href=\"#narrow/stream/182449-t-compiler.2Fhelp/topic/Work.20with.20local.20chalk.3F/near/261050353\">said</a>:</p>\n<blockquote>\n<p>When I'm testing a Chalk change, I'll generally just push to a branch and then switch the dependencies to git</p>\n</blockquote>\n<p>Are you able to use the current master of chalk with rustc builds?</p>",
        "id": 261050563,
        "sender_full_name": "pierwill",
        "timestamp": 1636576316
    },
    {
        "content": "<p>I haven't checked anytime recently</p>",
        "id": 261050637,
        "sender_full_name": "Jack Huey",
        "timestamp": 1636576340
    },
    {
        "content": "<p>I guess it's 55 vs 74</p>",
        "id": 261050700,
        "sender_full_name": "Jack Huey",
        "timestamp": 1636576382
    },
    {
        "content": "<p>Last update was Februrary: <a href=\"https://github.com/rust-lang/rust/issues/80593\">#80593</a></p>",
        "id": 261050758,
        "sender_full_name": "Jack Huey",
        "timestamp": 1636576421
    },
    {
        "content": "<p>Looks like the only real changes since then are related to generators</p>",
        "id": 261051171,
        "sender_full_name": "Jack Huey",
        "timestamp": 1636576636
    }
]